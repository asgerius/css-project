[{"tags": ["c++", "c++11", "language-lawyer", "constexpr", "linkage"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1450914480, "post_id": 34445336, "comment_id": 56632820, "body": "Constants at namespace scope have internal linkage. The problem arises when you evaluate such constants in <code>inline</code> functions."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1450927795, "post_id": 34445336, "comment_id": 56635743, "body": "What platform are you on?"}, {"owner": {"reputation": 13936, "user_id": 3598119, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/6c9c7dfa28a57e8011d12208a7c86d20?s=128&d=identicon&r=PG", "display_name": "Chris Beck", "link": "https://stackoverflow.com/users/3598119/chris-beck"}, "edited": false, "score": 1, "creation_date": 1450938573, "post_id": 34445336, "comment_id": 56638459, "body": "@JohnB: You may want to mark it <code>constexpr char const * const kHello = &quot;Hello&quot;;</code> instead -- in c++11, <code>constexpr</code> implies <code>const</code>, but in c++14 it doesn&#39;t. I&#39;m not sure if the ODR is substantially different in c++14 on this issue, but anyways you can get a compiler warning about this, in my experience."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 13936, "user_id": 3598119, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/6c9c7dfa28a57e8011d12208a7c86d20?s=128&d=identicon&r=PG", "display_name": "Chris Beck", "link": "https://stackoverflow.com/users/3598119/chris-beck"}, "edited": false, "score": 5, "creation_date": 1450939174, "post_id": 34445336, "comment_id": 56638661, "body": "@ChrisBeck You are confusing <code>constexpr</code> on member functions and <code>constexpr</code> on variables."}, {"owner": {"reputation": 11973, "user_id": 1419315, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e13603f86a9561d16a944963943fb8a9?s=128&d=identicon&r=PG", "display_name": "JohnB", "link": "https://stackoverflow.com/users/1419315/johnb"}, "reply_to_user": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1450945724, "post_id": 34445336, "comment_id": 56640877, "body": "@Nir Friedman: VS2015."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 1, "creation_date": 1450960003, "post_id": 34445336, "comment_id": 56647005, "body": "This is just an academic issue. In practice nothing wrong is going to happen, because (for the cases where calls to an <code>inline</code> function are not inlined) the linker just selects one arbitrary (inline) function definition among the discardable multitude, and that single one <i>does what you want</i>. Except if you intentionally introduce a dependency on address of constant or such silliness. In other words, no practical problem."}, {"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1450960189, "post_id": 34445336, "comment_id": 56647083, "body": "@Cheersandhth.-Alf Exactly, I would never ever think of passing a constant to a forwarding function template"}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "reply_to_user": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "edited": false, "score": 0, "creation_date": 1450960435, "post_id": 34445336, "comment_id": 56647169, "body": "@Columbo: Not sure what you mean. Do you think there&#39;s a practical problem with passing a constant defined in a header, to a function template?"}, {"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 1, "creation_date": 1450960530, "post_id": 34445336, "comment_id": 56647209, "body": "@Cheersandhth.-Alf Forwarding function template. Yes, there is, since that would constitute an odr-use. (If you do it inside e.g. an inline function in a header.)"}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "reply_to_user": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "edited": false, "score": 0, "creation_date": 1450960668, "post_id": 34445336, "comment_id": 56647268, "body": "@Columbo: Well if you can provide an example (of the complete minimal kind) where things go wrong in practice, and the code isn&#39;t silly, I&#39;ll change my view."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 13936, "user_id": 3598119, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/6c9c7dfa28a57e8011d12208a7c86d20?s=128&d=identicon&r=PG", "display_name": "Chris Beck", "link": "https://stackoverflow.com/users/3598119/chris-beck"}, "edited": false, "score": 0, "creation_date": 1450960711, "post_id": 34445336, "comment_id": 56647284, "body": "@ChrisBeck <code>constexpr</code> on a variable always implies <code>const</code>, no need to type the latter (unless it&#39;s for a separate element of the declaration, i.e. a pointer or ref&#39;s underlying object). That is: <code>static MyType constexpr myVar</code> indicates compile-time evaluation capability but otherwise acts like <code>static MyType const myVar</code> at runtime. As mentioned, function <code>const</code> is very different, and that&#39;s what was implied by <code>constexpr</code> in C++11 but is not in C++14 (a very important change)."}, {"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1450960910, "post_id": 34445336, "comment_id": 56647364, "body": "@Cheersandhth.-Alf Put <a href=\"http://coliru.stacked-crooked.com/a/7e7c2e7bfd29c595\" rel=\"nofollow noreferrer\">this</a> into a header file and include it in two TUs. (NB: Using a bog-standard for loop with indices would be fine!)"}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "reply_to_user": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "edited": false, "score": 0, "creation_date": 1450961189, "post_id": 34445336, "comment_id": 56647468, "body": "@Columbo: I did, except 3 TUs (including a main) and it worked fine with g++ 5.1.0. Que?"}, {"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1450961201, "post_id": 34445336, "comment_id": 56647474, "body": "@Cheersandhth.-Alf What do you mean with &quot;go wrong in practice&quot;? That&#39;s interesting but not the optimal goal. We want code to be portable in the first place, and the above isn&#39;t."}, {"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1450961806, "post_id": 34445336, "comment_id": 56647739, "body": "@Cheersandhth.-Alf This is a language-lawyer question. Not tagged g++, but C++. If it works for you, kudos, but that isn&#39;t something the asker or any prudent C++ programmer goes for."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "reply_to_user": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "edited": false, "score": 0, "creation_date": 1450962021, "post_id": 34445336, "comment_id": 56647818, "body": "@Columbo: I see the language lawyer tag, but the OP asks for &quot;preferable&quot;. That&#39;s an in-practice thing. The in-practice should therefore (also) be considered. And I think, for the language view, the only interesting aspect to me is why the language requires compilers to have the mechanisms in place for inline data, but lacks any way to express it directly. But anyway, not a practical problem. If you think the code isn&#39;t portable for compilers that support the syntax, you&#39;d have to provide an <b>example</b>; at least 1 case demonstrating the problem."}, {"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1450962500, "post_id": 34445336, "comment_id": 56648009, "body": "@Cheersandhth.-Alf What&#39;s the link between &quot;preferable&quot; and &quot;purely practical&quot;? AFAICS, the asker wants the solution that&#39;s preferable in terms of both practicability and theory/portability (especially since he quoted a relevant paper!). The code as is invokes undefined behavior\u2026 I wouldn&#39;t ignore that because it works on GCC and/or Clang right now (although I do agree that the common aversion against UB is partly unjustified). I&#39;ll try to think of a practically failing example."}, {"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "edited": false, "score": 0, "creation_date": 1450963661, "post_id": 34445336, "comment_id": 56648463, "body": "(Sorry, I meant to say the code as is, when included in two translation units combined into one program, invokes UB)"}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "reply_to_user": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "edited": false, "score": 1, "creation_date": 1450966182, "post_id": 34445336, "comment_id": 56649508, "body": "@Columbo: well, anyway :) Have a Merry Christmas. It&#39;s that time again! Yikes. OK, starting preparations..."}, {"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 1, "creation_date": 1450967483, "post_id": 34445336, "comment_id": 56650078, "body": "@Cheersandhth.-Alf Absolutely! Merry Christmas to you, pig! (In the style of Tuco, if you&#39;ve seen the movie your avatar is from :D) :-)"}], "answers": [{"comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1450926915, "post_id": 34446445, "comment_id": 56635569, "body": "&quot;you&#39;ve basically performed operations you couldn&#39;t have done with the return value of the corresponding constexpr function,&quot; Not really. Reference binding (to forwarding references or const lvalue references) is really the major issue."}, {"owner": {"reputation": 11973, "user_id": 1419315, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e13603f86a9561d16a944963943fb8a9?s=128&d=identicon&r=PG", "display_name": "JohnB", "link": "https://stackoverflow.com/users/1419315/johnb"}, "edited": false, "score": 0, "creation_date": 1450945691, "post_id": 34446445, "comment_id": 56640862, "body": "Hence, if I understand you correctly, my assumption that I have to think less if I use the &quot;function returning the value&quot; approach is correct? My problem is: I think I understand the issue, yet I do not feel fluent enough to avoid accidental mistakes."}, {"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1450958456, "post_id": 34446445, "comment_id": 56646393, "body": "@T.C. Well, to be precise, the operation would be &quot;binding a reference to an lvalue&quot; vs &quot;&#180;&#180; to an rvalue&quot;, although I agree it&#39;s unclear :o)"}, {"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "reply_to_user": {"reputation": 11973, "user_id": 1419315, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e13603f86a9561d16a944963943fb8a9?s=128&d=identicon&r=PG", "display_name": "JohnB", "link": "https://stackoverflow.com/users/1419315/johnb"}, "edited": false, "score": 0, "creation_date": 1450960423, "post_id": 34446445, "comment_id": 56647160, "body": "@JohnB Well, if you&#39;re reasonably careful (i.e. swiftly check every use when you introduce it inside an inline function or the like), nothing should go wrong. If you don&#39;t want to care about this at all, go with <code>constexpr</code> functions. That&#39;s ultimately your decision."}, {"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1451055984, "post_id": 34446445, "comment_id": 56669649, "body": "I don&#39;t quite understand what you think is defective in [basic.def.odr]p2.2. Have you seen <a href=\"http://stackoverflow.com/a/23436665/\">stackoverflow.com/a/23436665</a> and the discussion below?"}, {"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "reply_to_user": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1451136645, "post_id": 34446445, "comment_id": 56684804, "body": "@dyp Actually, that very bullet point has been discussed thoroughly by the CWG, and is not defective. Nevermind, I adjusted the answer."}], "tags": [], "owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "is_accepted": true, "score": 16, "last_activity_date": 1499083811, "last_edit_date": 1499083811, "creation_date": 1450923467, "answer_id": 34446445, "question_id": 34445336, "link": "https://stackoverflow.com/questions/34445336/constexpr-global-constants-in-a-header-file-and-odr/34446445#34446445", "title": "constexpr global constants in a header file and odr", "body": "<p>Note: as of C++17, you can declare your <a href=\"http://en.cppreference.com/w/cpp/language/inline\" rel=\"noreferrer\">variables as inline</a>. </p>\n\n<hr>\n\n<p><strong>TL;DR</strong>: If you want to be on the (very) safe side, go with constexpr functions. It isn't inherently necessary though, and certainly won't be if you're performing trivial operations on these objects and are solely interested in their value, or simply don't use them in the dangerous scenarios listed below. </p>\n\n<p>The fundamental issue is that <code>const</code> variables at namespace scope such as yours (generally) have internal linkage (<a href=\"http://eel.is/c++draft/basic.link#3\" rel=\"noreferrer\">[basic.link]/(3.2)</a>). This implies that <strong>each translation unit compiling the corresponding header will observe a different entity</strong> (i.e. symbol).</p>\n\n<p>Now imagine we have a template or inline function in a header using those objects. The ODR is very precise about this scenario - <a href=\"http://eel.is/c++draft/basic.def.odr#6\" rel=\"noreferrer\">[basic.def.odr]/6</a>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XuRPp.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/XuRPp.png\" alt=\"enter image description here\"></a></p>\n\n<p><em>\"initialized with a constant expression\"</em> is certainly met, since we're talking <code>constexpr</code>. So is <em>\"the object has the same value in all definitions of <code>D</code>\"</em> if you don't monkey about.</p>\n\n<p><em>\"the object isn't odr-used\"</em> is probably the only questionable condition. Basically, it requires that you don't necessitate the variables runtime existence as a symbol, which in turn implies that</p>\n\n<ul>\n<li><p>You don't bind it to a reference (=> you don't forward it!)</p></li>\n<li><p>You don't (neither explicitly nor implicitly) take its address. </p></li>\n</ul>\n\n<p>The only exception to the second rule are arrays, which can be taken the address of implicitly inside a subscript operation as long as the two above rules aren't violated for the yielded glvalue.</p>\n\n<p>More precisely, odr-use is governed by <a href=\"http://eel.is/c++draft/basic.def.odr#3\" rel=\"noreferrer\">[basic.def.odr]/3</a>:</p>\n\n<blockquote>\n  <p>A variable <code>x</code> whose name appears as a potentially-evaluated expression <code>ex</code> is odr-used by <code>ex</code> unless applying\n  the lvalue-to-rvalue conversion (4.1) to <code>x</code> yields a constant expression (5.20) that does not invoke any non-trivial functions and, if <code>x</code> is an object, <code>ex</code> is an element of the set of potential results of an expression <code>e</code>, where either the lvalue-to-rvalue conversion (4.1) is applied to <code>e</code>, or <code>e</code> is a discarded-value expression (Clause\n  5).</p>\n</blockquote>\n\n<p>Applying l-t-r to any <code>constexpr</code> variable will behave as required by the first part. The second part requires that the variable be used as a <em>value</em> rather than an actual <em>object</em>; that is, it's eventually either discarded or directly evaluated, giving the above rules of thumb.</p>\n\n<p>If you avoid odr-use of the variable inside inline functions, templates or the like, you're fine. But if you use the return value of a corresponding constexpr function, you won't have to worry, since prvalues are already behaving more like values/literals (not objects) and constexpr functions are inline and definitely won't violate the ODR (if you don't use <code>constexpr</code> variables inside there!).</p>\n"}], "owner": {"reputation": 11973, "user_id": 1419315, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e13603f86a9561d16a944963943fb8a9?s=128&d=identicon&r=PG", "display_name": "JohnB", "link": "https://stackoverflow.com/users/1419315/johnb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8448, "favorite_count": 8, "accepted_answer_id": 34446445, "answer_count": 1, "score": 20, "last_activity_date": 1499083811, "creation_date": 1450913725, "last_edit_date": 1450938655, "question_id": 34445336, "link": "https://stackoverflow.com/questions/34445336/constexpr-global-constants-in-a-header-file-and-odr", "title": "constexpr global constants in a header file and odr", "body": "<p>Unfortunately, I am somewhat confused about <code>constexpr</code>, global constants declared in header files, and the odr.</p>\n\n<p>In short: Can we conclude from here</p>\n\n<p><a href=\"https://isocpp.org/files/papers/n4147.pdf\">https://isocpp.org/files/papers/n4147.pdf</a></p>\n\n<p>that</p>\n\n<pre><code>constexpr MyClass const MyClassObj () { return MyClass {}; }\nconstexpr char const * Hello () { return \"Hello\"; }\n</code></pre>\n\n<p>is preferable over</p>\n\n<pre><code>constexpr MyClass const kMyClassObj = MyClass {};\nconstexpr char const * kHello = \"Hello\";\n</code></pre>\n\n<p>for defining globals in a header file\nif I want to \"just use\" those <em>globally</em> declared/defined entities and do not want to think about <em>how</em> I use them?</p>\n"}, {"tags": ["c++", "dictionary", "boost", "bimap", "boost-bimap"], "comments": [{"owner": {"reputation": 330, "user_id": 1431664, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f09995c3d759729d1624d93931eed078?s=128&d=identicon&r=PG&f=1", "display_name": "npp1993", "link": "https://stackoverflow.com/users/1431664/npp1993"}, "edited": false, "score": 0, "creation_date": 1450927556, "post_id": 34445230, "comment_id": 56635693, "body": "I&#39;ve actually found that it would be easiest/best for me to use a <code>std::multimap</code> from pointers to objects in Set A to references in Set B.  However the question still stands, if only for curiosity&#39;s sake."}], "answers": [{"comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1450918978, "post_id": 34445348, "comment_id": 56633970, "body": "Have an upboat. Me too, I sniffed that in the question."}], "tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": false, "score": 2, "last_activity_date": 1450913826, "creation_date": 1450913826, "answer_id": 34445348, "question_id": 34445230, "link": "https://stackoverflow.com/questions/34445230/c-data-structure-to-store-multiple-relationships-between-two-unique-sets-of-el/34445348#34445348", "title": "C++ data structure to store multiple relationships between two unique sets of elements", "body": "<p>This strikes me as more of graph problem, best modeled more directly:</p>\n\n<pre><code>struct nodeB;\n\nstruct nodeA {\n    char label;\n    std::vector&lt;nodeB *&gt; assocs;\n};\n\nstruct nodeB { \n    int label;\n    std::vector&lt;nodeA *&gt; assocs;\n};\n</code></pre>\n\n<p>From there, I guess you want a class to manage a collection of each type, and handle adding nodes to assure that your invariants are maintained properly.</p>\n"}, {"tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 4, "last_activity_date": 1450994477, "last_edit_date": 1450994477, "creation_date": 1450915282, "answer_id": 34445536, "question_id": 34445230, "link": "https://stackoverflow.com/questions/34445230/c-data-structure-to-store-multiple-relationships-between-two-unique-sets-of-el/34445536#34445536", "title": "C++ data structure to store multiple relationships between two unique sets of elements", "body": "<p>I completely agree with Jerry's answer. If you're trying to model a graph, consider using an adjacency list, edge list or matrix representation, for example.</p>\n\n<p>Paul's answer was a bit hand-wavy, so, here goes a sample using Boost Multi Index:</p>\n\n<p><strong><a href=\"http://coliru.stacked-crooked.com/a/ddff93a270799afd\" rel=\"nofollow\">Live On Coliru</a></strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;boost/multi_index_container.hpp&gt;\n#include &lt;boost/multi_index/mem_fun.hpp&gt;\n#include &lt;boost/multi_index/composite_key.hpp&gt;\n#include &lt;boost/multi_index/ordered_index.hpp&gt;\n\nstruct T1 {\n    std::string name;\n    bool operator&lt;(T1 const&amp; o) const { return name &lt; o.name; }\n};\nstruct T2 {\n    int id;   \n    bool operator&lt;(T2 const&amp; o) const { return id &lt; o.id; }\n};\n\nnamespace bmi = boost::multi_index;\n\nstruct Relation {\n    T1 const* key1;\n    T2 const* key2;\n\n    std::string const&amp; name() const { return key1-&gt;name; }\n    int                id  () const { return key2-&gt;id;   }\n\n    friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, Relation const&amp; r) {\n        return os &lt;&lt; \"(\" &lt;&lt; r.name() &lt;&lt; \", \" &lt;&lt; r.id() &lt;&lt; \")\";\n    }\n};\n\nusing RelationTable = bmi::multi_index_container&lt;Relation,\n      bmi::indexed_by&lt;\n        bmi::ordered_unique&lt;bmi::tag&lt;struct by_composite&gt;, \n            bmi::composite_key&lt;Relation, \n                bmi::const_mem_fun&lt;Relation, std::string const&amp;, &amp;Relation::name&gt;,\n                bmi::const_mem_fun&lt;Relation, int, &amp;Relation::id&gt;\n            &gt;\n        &gt;\n    &gt; &gt;;\n\n#include &lt;set&gt;\n\nint main() {\n    using namespace std;\n    set&lt;T1&gt; set1 { {\"A\"}, {\"B\"}, {\"C\"} };\n    set&lt;T2&gt; set2 { {1}, {2}, {3}, {4} };\n\n    // convenient data entry helpers\n    auto lookup1 = [&amp;set1](auto key) { return &amp;*set1.find(T1{key}); }; // TODO error check?\n    auto lookup2 = [&amp;set2](auto key) { return &amp;*set2.find(T2{key}); };\n    auto relate  = [=](auto name, auto id) { return Relation { lookup1(name), lookup2(id) }; };\n    // end helpers\n\n    RelationTable relations {\n        relate(\"A\", 1), relate(\"A\", 3),\n        relate(\"B\", 1), relate(\"B\", 4),\n        relate(\"C\", 1), relate(\"C\", 3), relate(\"C\", 4),\n    };\n\n    for (auto&amp; rel : relations)\n        std::cout &lt;&lt; rel &lt;&lt; \" \";\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>(A, 1) (A, 3) (B, 1) (B, 4) (C, 1) (C, 3) (C, 4) \n</code></pre>\n"}], "owner": {"reputation": 330, "user_id": 1431664, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f09995c3d759729d1624d93931eed078?s=128&d=identicon&r=PG&f=1", "display_name": "npp1993", "link": "https://stackoverflow.com/users/1431664/npp1993"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 772, "favorite_count": 0, "accepted_answer_id": 34445536, "answer_count": 2, "score": 3, "last_activity_date": 1450994477, "creation_date": 1450912948, "question_id": 34445230, "link": "https://stackoverflow.com/questions/34445230/c-data-structure-to-store-multiple-relationships-between-two-unique-sets-of-el", "title": "C++ data structure to store multiple relationships between two unique sets of elements", "body": "<p>I am working on a project where I have two unique sets of elements.  Any of the elements in one set may be related to any of the elements in the other set.</p>\n\n<p>Example:</p>\n\n<p>Set 1: {A, B, C}</p>\n\n<p>Set 2: {1, 2, 3, 4}</p>\n\n<p>Allowed relationships:</p>\n\n<p>(A, 1)     (A, 3)</p>\n\n<p>(B, 1)    (B, 4)</p>\n\n<p>(C, 1)    (C, 3)    (C, 4)</p>\n\n<p>A single relationship is represented as two set elements inside one pair of parentheses.</p>\n\n<p>In my particular project, the elements of both sets are objects, and I would like all references to all objects stored to resolve to one object (for example, all relationships containing A would all refer to the same object A, and the same goes for the references to other set on the other side of the relationship).</p>\n\n<p>I was thinking of using a Boost <code>bimap</code> to solve for this problem.  I was looking at the potential types of collections used for the left and right halves of the bimap and for the relationship between the two sets, and have been trying to decide which ones are correct.  </p>\n\n<p>For the left and right halves of the <code>bimap</code>, I was thinking that the <code>set_of</code> <code>CollectionType</code> would be correct, as my two sets of objects are, well, sets, and I do not want duplicate copies of any element in my <code>bimap</code>.  </p>\n\n<p>However, when I've tried this out in practice, I end up not being able to insert the relationship (B, 1) after I've inserted the relationship (A, 1), as the insertion must be valid in both the left and right views for it to occur.  To correct for this problem, I've changed the <code>CollectionType</code> of both halves to be <code>multiset_of</code>.  All values are properly inserted, however, does this mean that my <code>bimap</code> now has duplicate copies of the elements of my original sets?</p>\n\n<p>To try and correct for this, I started looking at changing the collection type of the relationship between the two halves of the <code>bimap</code>.  Since the collection type of the relationship type defaults to that of the left half of the <code>bimap</code>, I figured that <code>multiset_of</code> is incorrect, and specified it as <code>set_of</code>.  However, I'm not sure that this fixes my original problem of having multiple copies of my objects from my original sets.</p>\n\n<p>All I really need is to look at all objects from Set 2 that are related to an element from Set 1.  Is a Boost <code>bimap</code> the correct route for me?  Are the collection and relationship types I have selected the right ones?  As an aside, I am trying to customize my map to have quick search times, with no concern for insertion times (deletion and modification will never happen, the map is initialized and then is just used for lookups after that).  Should I just write a custom data structure instead?</p>\n"}, {"tags": ["c++", "windows", "qt", "process", "instance"], "comments": [{"owner": {"reputation": 7466, "user_id": 2146682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7120fc7548c43237662da906e3c84f43?s=128&d=identicon&r=PG", "display_name": "MrEricSir", "link": "https://stackoverflow.com/users/2146682/mrericsir"}, "edited": false, "score": 0, "creation_date": 1450915096, "post_id": 34445164, "comment_id": 56632985, "body": "Works for me on Qt 5.5.0."}, {"owner": {"reputation": 2740, "user_id": 4731718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2a262f4c7f71392806f969febe970961?s=128&d=identicon&r=PG&f=1", "display_name": "\u05e1\u05d8\u05e0\u05dc\u05d9 \u05d2\u05e8\u05d5\u05e0\u05df", "link": "https://stackoverflow.com/users/4731718/%d7%a1%d7%98%d7%a0%d7%9c%d7%99-%d7%92%d7%a8%d7%95%d7%a0%d7%9f"}, "reply_to_user": {"reputation": 7466, "user_id": 2146682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7120fc7548c43237662da906e3c84f43?s=128&d=identicon&r=PG", "display_name": "MrEricSir", "link": "https://stackoverflow.com/users/2146682/mrericsir"}, "edited": false, "score": 0, "creation_date": 1450915646, "post_id": 34445164, "comment_id": 56633147, "body": "Yup, used to work for me on Qt 5.5.0 too,,, So, I think maybe I did something wrong during development process, while playing, fiddling with it...?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1450922234, "post_id": 34445164, "comment_id": 56634655, "body": "If you need this on Windows only, use a name mutex (see <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682411.aspx\" rel=\"nofollow noreferrer\">CreateMutex</a>) instead of Qt&#39;s abominations. See <a href=\"http://stackoverflow.com/q/8799646/1889329\">Preventing multiple instances of my application</a> for possible implementations."}, {"owner": {"reputation": 4996, "user_id": 462639, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7019183695a9fbd1208d5f6e5fbc1794?s=128&d=identicon&r=PG", "display_name": "demonplus", "link": "https://stackoverflow.com/users/462639/demonplus"}, "edited": false, "score": 0, "creation_date": 1450947096, "post_id": 34445164, "comment_id": 56641415, "body": "You can use QtSingleApplication <a href=\"http://stackoverflow.com/questions/5006547/qt-best-practice-for-a-single-instance-app-protection\" title=\"qt best practice for a single instance app protection\">stackoverflow.com/questions/5006547/&hellip;</a>"}, {"owner": {"reputation": 2740, "user_id": 4731718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2a262f4c7f71392806f969febe970961?s=128&d=identicon&r=PG&f=1", "display_name": "\u05e1\u05d8\u05e0\u05dc\u05d9 \u05d2\u05e8\u05d5\u05e0\u05df", "link": "https://stackoverflow.com/users/4731718/%d7%a1%d7%98%d7%a0%d7%9c%d7%99-%d7%92%d7%a8%d7%95%d7%a0%d7%9f"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1450949173, "post_id": 34445164, "comment_id": 56642366, "body": "@IInspectable: That&#39;s a Microsoft stuff, I don&#39;t think it would work under Qt (minGW compiler)... would it?"}, {"owner": {"reputation": 2740, "user_id": 4731718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2a262f4c7f71392806f969febe970961?s=128&d=identicon&r=PG&f=1", "display_name": "\u05e1\u05d8\u05e0\u05dc\u05d9 \u05d2\u05e8\u05d5\u05e0\u05df", "link": "https://stackoverflow.com/users/4731718/%d7%a1%d7%98%d7%a0%d7%9c%d7%99-%d7%92%d7%a8%d7%95%d7%a0%d7%9f"}, "reply_to_user": {"reputation": 4996, "user_id": 462639, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7019183695a9fbd1208d5f6e5fbc1794?s=128&d=identicon&r=PG", "display_name": "demonplus", "link": "https://stackoverflow.com/users/462639/demonplus"}, "edited": false, "score": 0, "creation_date": 1450949511, "post_id": 34445164, "comment_id": 56642498, "body": "@demonplus : Well, it seems QtSingleApplication is not part of Qt&#39;s main/basic distribution. I suppose the issue can be solve without adding extra packages... Nowadays people tend to install as many extra packs as possible: QtExtra, Boost, etc-etc... I prefer to keep things minimal and simple (years of experience taught me so)."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1450951549, "post_id": 34445164, "comment_id": 56643374, "body": "Qt (for Windows) is implemented using <i>&quot;Microsoft stuff&quot;</i>. Anything in the Windows API is available to MinGW. No extra packages required."}], "answers": [{"tags": [], "owner": {"reputation": 2740, "user_id": 4731718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2a262f4c7f71392806f969febe970961?s=128&d=identicon&r=PG&f=1", "display_name": "\u05e1\u05d8\u05e0\u05dc\u05d9 \u05d2\u05e8\u05d5\u05e0\u05df", "link": "https://stackoverflow.com/users/4731718/%d7%a1%d7%98%d7%a0%d7%9c%d7%99-%d7%92%d7%a8%d7%95%d7%a0%d7%9f"}, "is_accepted": true, "score": 1, "last_activity_date": 1579885921, "last_edit_date": 1579885921, "creation_date": 1451301619, "answer_id": 34492563, "question_id": 34445164, "link": "https://stackoverflow.com/questions/34445164/qt5-preventing-another-instance-of-the-application-doesnt-work-anymore/34492563#34492563", "title": "Qt5: Preventing another instance of the application doesn&#39;t work anymore...!", "body": "<p>I <em>finally</em> discovered where the problem was... and it's not the antivirus to be blamed :)<br>\nWhen I upgraded the Qt (Creator v3.6.0) to the newest version (5.5.1), there is a setting in <strong>Tools->Options->Build&amp;Run</strong> named <code>[Stop app before building]</code>... that was set to <code>Current project</code> or something. Hence, the Qt Creator was killing the old instance before launching a new one(!).<br>\nSetting this option to <code>None</code> solved the issue.<br>\nSo, it seems the code was just fine, antivirus was fine, yet launching the app from within Qt Creator was somehow restricted to only one instance :)  </p>\n\n<p>I decided to share this, maybe it will be helpful for other folks as well.    </p>\n\n<p><strong>Remark</strong> : I checked again and now I can confirm: That setting didn't exist before, at least not in Qt Creator v3.3.2.</p>\n"}], "owner": {"reputation": 2740, "user_id": 4731718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2a262f4c7f71392806f969febe970961?s=128&d=identicon&r=PG&f=1", "display_name": "\u05e1\u05d8\u05e0\u05dc\u05d9 \u05d2\u05e8\u05d5\u05e0\u05df", "link": "https://stackoverflow.com/users/4731718/%d7%a1%d7%98%d7%a0%d7%9c%d7%99-%d7%92%d7%a8%d7%95%d7%a0%d7%9f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1889, "favorite_count": 2, "accepted_answer_id": 34492563, "answer_count": 1, "score": 5, "last_activity_date": 1579885921, "creation_date": 1450912539, "last_edit_date": 1451300510, "question_id": 34445164, "link": "https://stackoverflow.com/questions/34445164/qt5-preventing-another-instance-of-the-application-doesnt-work-anymore", "title": "Qt5: Preventing another instance of the application doesn&#39;t work anymore...!", "body": "<p>I am using Qt5 on a Windows7 platform.<br>\nMy application is some kind of TCP server listening on port 8002, so I only want one instance of it.<br>\nIn order to prevent multiple instances of my application, I use(d) the code below (found here on StackOverflow):    </p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    QApplication a(argc, argv);\n    QSharedMemory sharedMemory;\n\n    sharedMemory.setKey(\"TcpServer-Key\");\n    if(sharedMemory.create(1) == false)\n    {\n       QMessageBox::warning(NULL, \"Warning!\", \"Another instance already running!\");\n       a.exit(); // exit already a process running\n       return 0;\n    }\n...\n</code></pre>\n\n<p>Well, the code above used to work just fine, until I upgraded my Qt to 5.5.1.<br>\nNow, with Qt 5.5.1, I don't see the warning message-box anymore!... When I try to start another instance, the running app disappears/stops and a new app is started!!!    </p>\n\n<p>Please help, what should I do? But don't tell me to switch back to Qt 5.4.x  :(  </p>\n\n<p><strong>Remark</strong>: I forgot to mention that I set &amp; used msvc2012 compiler during tests (not minGW, as I wasn't able to build log4cxx for it).    </p>\n\n<p><strong>UPDATE</strong>: Could it be an issue related to the antivirus installed on that PC (at the office, i.e. McAfee)?... Now I'm at home (AVG antivirus and MinGW compiler and log4cxx removed) and I am unable to reproduce the above described issue :(</p>\n"}, {"tags": ["python", "c++", "swig"], "comments": [{"owner": {"reputation": 1271, "user_id": 4121210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/lLgLn.jpg?s=128&g=1", "display_name": "El Sampsa", "link": "https://stackoverflow.com/users/4121210/el-sampsa"}, "edited": false, "score": 0, "creation_date": 1450912377, "post_id": 34445045, "comment_id": 56632141, "body": "alas, in <a href=\"http://www.swig.org/Doc2.0/SWIGDocumentation.html#SWIG_nn30\" rel=\"nofollow noreferrer\">swig.org/Doc2.0/SWIGDocumentation.html#SWIG_nn30</a> it is said that &quot;SWIG provides full support for function pointers provided that the callback functions are defined in C and not in the target language&quot; .. so I guess its impossible.  Any ideas how to do the callback logic from python appreciated though.."}, {"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1450992409, "post_id": 34445045, "comment_id": 56658037, "body": "Definitely not impossible,  we can customise everything, but since you&#39;re using C++ not C why not use <code>std::function</code>? That makes writing a cleaner answer simpler - if you&#39;re happy with that change I&#39;ll write up a complete solution for you. (Essentially a Python version of <a href=\"http://stackoverflow.com/a/32668302/168175\">stackoverflow.com/a/32668302/168175</a>, or a generalised version of <a href=\"http://stackoverflow.com/a/11522655/168175\">stackoverflow.com/a/11522655/168175</a>)"}, {"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1450992699, "post_id": 34445045, "comment_id": 56658105, "body": "Failing that do the real callbacks get a <code>void*</code> argument that you get to set when you register them? That makes life much cleaner."}, {"owner": {"reputation": 383, "user_id": 4336936, "user_type": "registered", "accept_rate": 15, "profile_image": "https://lh4.googleusercontent.com/-NEZ6nCvuLNw/AAAAAAAAAAI/AAAAAAAAABQ/UFN7WEgEn3Q/photo.jpg?sz=128", "display_name": "Xingjun Wang", "link": "https://stackoverflow.com/users/4336936/xingjun-wang"}, "edited": false, "score": 0, "creation_date": 1526386658, "post_id": 34445045, "comment_id": 87715707, "body": "I meet the same problem and could you please show your final solution\uff1f"}, {"owner": {"reputation": 1271, "user_id": 4121210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/lLgLn.jpg?s=128&g=1", "display_name": "El Sampsa", "link": "https://stackoverflow.com/users/4121210/el-sampsa"}, "edited": false, "score": 0, "creation_date": 1526390489, "post_id": 34445045, "comment_id": 87718531, "body": "In my final solution, I decided not to pass python functions to the cpp level, but to do everything in the cpp level.  :)"}], "answers": [{"comments": [{"owner": {"reputation": 1271, "user_id": 4121210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/lLgLn.jpg?s=128&g=1", "display_name": "El Sampsa", "link": "https://stackoverflow.com/users/4121210/el-sampsa"}, "edited": false, "score": 0, "creation_date": 1454490645, "post_id": 34445425, "comment_id": 58062824, "body": "Thanks for informing me about the directors.. by now, I have found them very usefull.  .. but I still don&#39;t have the slightest idea how they work..!  Is the python code &quot;compiled&quot; at some stage and passed to C, or does swig embed the python &quot;runtime environment&quot; into the wrapped C-code (i.e. does it execute &quot;PyRun_SimpleString&quot; and the like from C).  I am baffled."}, {"owner": {"reputation": 2883, "user_id": 5162389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FTqjP.jpg?s=128&g=1", "display_name": "m7thon", "link": "https://stackoverflow.com/users/5162389/m7thon"}, "reply_to_user": {"reputation": 1271, "user_id": 4121210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/lLgLn.jpg?s=128&g=1", "display_name": "El Sampsa", "link": "https://stackoverflow.com/users/4121210/el-sampsa"}, "edited": false, "score": 0, "creation_date": 1454491780, "post_id": 34445425, "comment_id": 58063612, "body": "I also only know as much as it says in the SWIG manual. I am sure no python code is ever compiled. But python code is obviously being called from C. Does this require embedding the python runtime environment?"}, {"owner": {"reputation": 1271, "user_id": 4121210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/lLgLn.jpg?s=128&g=1", "display_name": "El Sampsa", "link": "https://stackoverflow.com/users/4121210/el-sampsa"}, "edited": false, "score": 0, "creation_date": 1455740864, "post_id": 34445425, "comment_id": 58629772, "body": "hmm.. I guess it calls the PyObject_CallMethod of the python C api in the wrapper"}], "tags": [], "owner": {"reputation": 2883, "user_id": 5162389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FTqjP.jpg?s=128&g=1", "display_name": "m7thon", "link": "https://stackoverflow.com/users/5162389/m7thon"}, "is_accepted": true, "score": 3, "last_activity_date": 1450914405, "creation_date": 1450914405, "answer_id": 34445425, "question_id": 34445045, "link": "https://stackoverflow.com/questions/34445045/passing-python-functions-to-swig-wrapped-c-code/34445425#34445425", "title": "Passing python functions to SWIG wrapped C++ code", "body": "<p>You can implement the callback logic in Python by using <a href=\"http://www.swig.org/Doc3.0/SWIGDocumentation.html#Python_directors\" rel=\"nofollow\">\"directors\"</a>.</p>\n\n<p>Basically, instead of passing callback functions, you pass callback objects instead. The base object can be defined in C++ and provide a <code>virtual</code> callback member function. This object can then be inherited from and the callback function overwritten in Python. The inherited object can then be passed to a C++ function instead of a callback function. For this to work, you need to enable the director feature for such a callback class.</p>\n\n<p>This does require changing the underlying C++ library, though.</p>\n"}, {"comments": [{"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 1, "creation_date": 1450993530, "post_id": 34457964, "comment_id": 56658321, "body": "I like using ctypes like that. I think you can make the SWIG/Python bit slightly neater by hiding all the ctypes bit inside a <code>%pythoncode %{ ... %}</code> block so that from the user of the Pyhton module&#39;s perspective they just call <code>use_callback</code> with a Python callable and everything else just happens under the hood."}, {"owner": {"reputation": 1748, "user_id": 99279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36ea76ee226b4cdb598055de1eb1d67a?s=128&d=identicon&r=PG", "display_name": "sterin", "link": "https://stackoverflow.com/users/99279/sterin"}, "reply_to_user": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1450994375, "post_id": 34457964, "comment_id": 56658497, "body": "@Flexo, good suggestion, I&#39;ve incoporated it into the example."}, {"owner": {"reputation": 1271, "user_id": 4121210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/lLgLn.jpg?s=128&g=1", "display_name": "El Sampsa", "link": "https://stackoverflow.com/users/4121210/el-sampsa"}, "edited": false, "score": 0, "creation_date": 1454490726, "post_id": 34457964, "comment_id": 58062882, "body": "A follow-up question: what happens at &quot;f = py_callback_type(py_callback)&quot; .. does the python code get converted to machine code or something like that..?  How does this thing work under the hood?"}, {"owner": {"reputation": 1748, "user_id": 99279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36ea76ee226b4cdb598055de1eb1d67a?s=128&d=identicon&r=PG", "display_name": "sterin", "link": "https://stackoverflow.com/users/99279/sterin"}, "edited": false, "score": 0, "creation_date": 1454537314, "post_id": 34457964, "comment_id": 58094592, "body": "The <code>ctypes</code> module uses <a href=\"https://en.wikipedia.org/wiki/Libffi\" rel=\"nofollow noreferrer\"><code>libffi</code></a> to do that. From the Wikipedia page:  libffi can produce a pointer to a function that can accept and decode any combination of arguments defined at run time."}, {"owner": {"reputation": 367, "user_id": 2321145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6447f6df923c9aaac74a3b47a1e81c?s=128&d=identicon&r=PG", "display_name": "hmaarrfk", "link": "https://stackoverflow.com/users/2321145/hmaarrfk"}, "edited": false, "score": 1, "creation_date": 1515781148, "post_id": 34457964, "comment_id": 83446176, "body": "Just a note, for python 3.6, you need to use the typecast: <code>PyLong_AsVoidPtr</code> instead of <code>PyInt_AsLong</code>"}, {"owner": {"reputation": 1748, "user_id": 99279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36ea76ee226b4cdb598055de1eb1d67a?s=128&d=identicon&r=PG", "display_name": "sterin", "link": "https://stackoverflow.com/users/99279/sterin"}, "reply_to_user": {"reputation": 367, "user_id": 2321145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6447f6df923c9aaac74a3b47a1e81c?s=128&d=identicon&r=PG", "display_name": "hmaarrfk", "link": "https://stackoverflow.com/users/2321145/hmaarrfk"}, "edited": false, "score": 0, "creation_date": 1515792350, "post_id": 34457964, "comment_id": 83450949, "body": "Thanks @user87746 , I&#39;ve incorporated your suggestion."}], "tags": [], "owner": {"reputation": 1748, "user_id": 99279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36ea76ee226b4cdb598055de1eb1d67a?s=128&d=identicon&r=PG", "display_name": "sterin", "link": "https://stackoverflow.com/users/99279/sterin"}, "is_accepted": false, "score": 4, "last_activity_date": 1515792258, "last_edit_date": 1515792258, "creation_date": 1450991743, "answer_id": 34457964, "question_id": 34445045, "link": "https://stackoverflow.com/questions/34445045/passing-python-functions-to-swig-wrapped-c-code/34457964#34457964", "title": "Passing python functions to SWIG wrapped C++ code", "body": "<p>Seems to me that a combination of <a href=\"https://docs.python.org/2/library/ctypes.html\" rel=\"nofollow noreferrer\"><code>ctypes</code></a> and a SWIG <a href=\"http://www.swig.org/Doc1.3/Typemaps.html\" rel=\"nofollow noreferrer\"><code>typemap</code></a> would be the easiest way to solve the problem. <code>ctypes</code> makes it easy to generate a C function that calls a Python callable. The Python code should be along the lines of:</p>\n\n<pre><code>import example\n\n# python callback\ndef py_callback(i, s):\n    print( 'py_callback(%d, %s)'%(i, s) )\n\nexample.use_callback(py_callback)\n</code></pre>\n\n<p>On the SWIG side we have: (1) a Python function <code>use_callback</code> that wraps the Python callback with a <code>ctypes</code> wrapper, and passes the address the wrapper as an integer to <code>_example.use_callback()</code>, and (2) a SWIG <code>typemap</code> that extracts the address and casts itto the appropriate function pointer. </p>\n\n<pre><code>%module example\n\n// a typemap for the callback, it expects the argument to be an integer\n// whose value is the address of an appropriate callback function\n%typemap(in) void (*f)(int, const char*) {\n    $1 = (void (*)(int i, const char*))PyLong_AsVoidPtr($input);;\n}\n\n%{\n    void use_callback(void (*f)(int i, const char* str));\n%}\n\n%inline\n%{\n\n// a C function that accepts a callback\nvoid use_callback(void (*f)(int i, const char* str))\n{\n    f(100, \"callback arg\");\n}\n\n%}\n\n%pythoncode\n%{\n\nimport ctypes\n\n# a ctypes callback prototype\npy_callback_type = ctypes.CFUNCTYPE(None, ctypes.c_int, ctypes.c_char_p)\n\ndef use_callback(py_callback):\n\n    # wrap the python callback with a ctypes function pointer\n    f = py_callback_type(py_callback)\n\n    # get the function pointer of the ctypes wrapper by casting it to void* and taking its value\n    f_ptr = ctypes.cast(f, ctypes.c_void_p).value\n\n    _example.use_callback(f_ptr)\n\n%}\n</code></pre>\n\n<p>You can find this complete example with a CMakeLists.txt file <a href=\"https://gist.github.com/sterin/32b5c7c42a177dacf455\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>edit: incorporated @Flexo suggestion to move the Python part into the %pythoncode block of the SWIG file.</p>\n\n<p>edit: incorporated @user87746 suggestion for Python 3.6+ compatibility.</p>\n"}], "owner": {"reputation": 1271, "user_id": 4121210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/lLgLn.jpg?s=128&g=1", "display_name": "El Sampsa", "link": "https://stackoverflow.com/users/4121210/el-sampsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2965, "favorite_count": 0, "accepted_answer_id": 34445425, "answer_count": 2, "score": 4, "last_activity_date": 1515792258, "creation_date": 1450911840, "question_id": 34445045, "link": "https://stackoverflow.com/questions/34445045/passing-python-functions-to-swig-wrapped-c-code", "title": "Passing python functions to SWIG wrapped C++ code", "body": "<p>I am trying to wrap a C++ library for python, using SWIG.  The library uses callback functions frequently, by passing <em>callback functions of certain type</em> to class methods.</p>\n\n<p>Now, after wrapping the code, I would like to create the callback logic from python.  Is this possible?  Here is an experiment I was doing to find it out .. does not work at the moment.</p>\n\n<p>The header and swig files are as follows:</p>\n\n<p>paska.h :</p>\n\n<pre><code>typedef void (handleri)(int code, char* codename);\n\n// handleri is now an alias to a function that eats int, string and returns void\n\nvoid wannabe_handleri(int i, char* blah);\n\nvoid handleri_eater(handleri* h);\n</code></pre>\n\n<p>paska.i :</p>\n\n<pre><code>%module paska\n\n%{ // this section is copied in the front of the wrapper file\n#define SWIG_FILE_WITH_INIT\n#include \"paska.h\"\n%}\n\n// from now on, what are we going to wrap ..\n\n%inline %{\n// helper functions here\n\nvoid wannabe_handleri(int i, char* blah) {\n};\n\nvoid handleri_eater(handleri* h) {\n};\n\n%}\n\n%include \"paska.h\"\n\n// in this case, we just put the actual .cpp code into the inline block ..\n</code></pre>\n\n<p>Finally, I test in python ..</p>\n\n<pre><code>import paska\n\ndef testfunc(i, st):\n  print i\n  print st\n\npaska.handleri_eater(paska.wannabe_handleri(1,\"eee\")) # THIS WORKS!\n\npaska.handleri_eater(testfunc) # THIS DOES NOT WORK!\n</code></pre>\n\n<p>The last line throws me \"TypeError: in method 'handleri_eater', argument 1 of type 'handleri *'\"</p>\n\n<p>Is there any way to \"cast\" the python function to a type accepted by the SWIG wrapper?</p>\n"}, {"tags": ["c++", "screenshot", "gdi+", "gdi"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1450910987, "post_id": 34444865, "comment_id": 56631690, "body": "Is the picture only the size of one monitor? Or is it bigger, but with black areas where the other monitors should be?"}, {"owner": {"reputation": 339, "user_id": 4854364, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1b2a106bc9fc101145fe09c2f1baeef9?s=128&d=identicon&r=PG&f=1", "display_name": "SujaM", "link": "https://stackoverflow.com/users/4854364/sujam"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1450912469, "post_id": 34444865, "comment_id": 56632172, "body": "It&#39;s the size of one monitor"}], "answers": [{"comments": [{"owner": {"reputation": 339, "user_id": 4854364, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1b2a106bc9fc101145fe09c2f1baeef9?s=128&d=identicon&r=PG&f=1", "display_name": "SujaM", "link": "https://stackoverflow.com/users/4854364/sujam"}, "edited": false, "score": 0, "creation_date": 1450914295, "post_id": 34445339, "comment_id": 56632769, "body": "The &#39;CreateDC(TEXT(&quot;DISPLAY&quot;),NULL,NULL,NULL)&#39; didn&#39;t work, I still get only one monitor."}], "tags": [], "owner": {"reputation": 10401, "user_id": 681044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OWZ3c.jpg?s=128&g=1", "display_name": "kwarunek", "link": "https://stackoverflow.com/users/681044/kwarunek"}, "is_accepted": false, "score": 1, "last_activity_date": 1450913737, "creation_date": 1450913737, "answer_id": 34445339, "question_id": 34444865, "link": "https://stackoverflow.com/questions/34444865/gdi-take-screenshot-multiple-monitors/34445339#34445339", "title": "Gdi+ Take Screenshot multiple monitors", "body": "<p><strong>Possible solution 1</strong></p>\n\n<p>With <code>GetDC(0)</code> you will get HDC only of primary monitor. From <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd183490%28v=vs.85%29.aspx\" rel=\"nofollow\">CreateDC</a> MSDN</p>\n\n<blockquote>\n  <p>If there are multiple monitors on the system, calling\n  <code>CreateDC(TEXT(\"DISPLAY\"),NULL,NULL,NULL)</code> will create a DC covering all\n  the monitors.</p>\n</blockquote>\n\n<p>It might do the trick, however it hasn't be tested.</p>\n\n<p><strong>Possible solution 2</strong></p>\n\n<p>Capture each desktop separately and then merge them. To get all displays use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd162610%28v=vs.85%29.aspx\" rel=\"nofollow\">EnumDisplayMonitors</a>. Some working example is in some codeproject's <a href=\"http://www.codeproject.com/Articles/101272/Creation-of-Multi-monitor-Screenshots-Using-WinAPI\" rel=\"nofollow\">article</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "is_accepted": true, "score": 4, "last_activity_date": 1450914461, "creation_date": 1450914461, "answer_id": 34445431, "question_id": 34444865, "link": "https://stackoverflow.com/questions/34444865/gdi-take-screenshot-multiple-monitors/34445431#34445431", "title": "Gdi+ Take Screenshot multiple monitors", "body": "<pre><code>    int Height = GetSystemMetrics(SM_CYSCREEN);\n</code></pre>\n\n<p>Quote from the MSDN docs: \"The height of the screen of the primary display monitor\".  You got <strong>exactly</strong> what you asked for, the primary display is one of your monitors.  The first one.</p>\n\n<p>Use <code>SM_CYVIRTUALSCREEN</code> instead.  Same for X.</p>\n"}], "owner": {"reputation": 339, "user_id": 4854364, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1b2a106bc9fc101145fe09c2f1baeef9?s=128&d=identicon&r=PG&f=1", "display_name": "SujaM", "link": "https://stackoverflow.com/users/4854364/sujam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1798, "favorite_count": 1, "accepted_answer_id": 34445431, "answer_count": 2, "score": 1, "last_activity_date": 1456786906, "creation_date": 1450910715, "question_id": 34444865, "link": "https://stackoverflow.com/questions/34444865/gdi-take-screenshot-multiple-monitors", "title": "Gdi+ Take Screenshot multiple monitors", "body": "<p>I've a routine to take a screenshot on windows platforms with gdi plus and c++, it works perfectly with only one monitor but when I run it in a machine o VM with 2 monitors it only takes the picture one the pictures.</p>\n\n<p>This it's what I'm doing:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;iostream&gt;\n#include &lt;GdiPlus.h&gt;\n#include &lt;wingdi.h&gt;\n#include &lt;fstream&gt;\n#include &lt;unistd.h&gt;\n\n#pragma comment(lib, \"gdiplus.lib\")\n#pragma comment(lib, \"ws2_32.lib\")\n\nusing namespace std;\n\n// Se encarga de configurar, por asi decirlo, el formato\n// de la imagen, este metodo es llamado en gdiscreen al\n// momento de guardar la imagen.\n\nint GetEncoderClsid(const WCHAR* format, CLSID* pClsid)\n{\n  using namespace Gdiplus;\n  UINT  num = 0;          // number of image encoders\n  UINT  size = 0;         // size of the image encoder array in bytes\n\n  ImageCodecInfo* pImageCodecInfo = NULL;\n\n  GetImageEncodersSize(&amp;num, &amp;size);\n  if(size == 0)\n    return -1;  // Failure\n\n  pImageCodecInfo = (ImageCodecInfo*)(malloc(size));\n  if(pImageCodecInfo == NULL)\n    return -1;  // Failure\n\n  GetImageEncoders(num, size, pImageCodecInfo);\n\n  for(UINT j = 0; j &lt; num; ++j)\n  {\n    if( wcscmp(pImageCodecInfo[j].MimeType, format) == 0 )\n    {\n      *pClsid = pImageCodecInfo[j].Clsid;\n      free(pImageCodecInfo);\n      return j;  // Success\n    }\n  }\n\n  free(pImageCodecInfo);\n  return 0;\n}\n\n// Este es el metodo que tomo la captura.\n// c es solo una variable que utilice para probar el\n// metodo en un loop, la puede quitar y remplazar c\n// por el log_sec_num.\n\ninline void take_screenshot(const std::string &amp; filename)\n{\n    using namespace Gdiplus;\n    GdiplusStartupInput gdiplusStartupInput;\n    ULONG_PTR gdiplusToken;\n    GdiplusStartup(&amp;gdiplusToken, &amp;gdiplusStartupInput, NULL);\n\n    {\n        HDC scrdc, memdc;\n        HBITMAP membit;\n        scrdc = ::GetDC(0);\n        int Height = GetSystemMetrics(SM_CYSCREEN);\n        int Width = GetSystemMetrics(SM_CXSCREEN);\n        memdc = CreateCompatibleDC(scrdc);\n        membit = CreateCompatibleBitmap(scrdc, Width, Height);\n        HBITMAP hOldBitmap =(HBITMAP) SelectObject(memdc, membit);\n        BitBlt(memdc, 0, 0, Width, Height, scrdc, 0, 0, SRCCOPY);\n\n        Gdiplus::Bitmap bitmap(membit, NULL);\n        CLSID clsid;\n        const char* name = filename.c_str();\n        const size_t cSize = strlen(name)+1;\n        wchar_t* wc = new wchar_t[cSize];\n        mbstowcs (wc, name, cSize);\n        GetEncoderClsid(L\"image/png\", &amp;clsid);\n        bitmap.Save(wc, &amp;clsid,NULL);\n\n        SelectObject(memdc, hOldBitmap);\n\n        DeleteObject(memdc);\n\n        DeleteObject(membit);\n\n        ::ReleaseDC(0,scrdc);\n    }\n\n    GdiplusShutdown(gdiplusToken);\n}\n\nint main ()\n{\n    const std::string &amp; filename = \"C:\\\\Screenshot.png\";\n    take_screenshot(filename);\n}\n</code></pre>\n\n<p>If try to get the entire screen but I end up with just have the picture. Can any one see where my error it's ??</p>\n"}, {"tags": ["c++", "function"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1450910140, "post_id": 34444755, "comment_id": 56631388, "body": "Which line is the error on?"}, {"owner": {"reputation": 1306, "user_id": 2807749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3884afad2069925c2c0ca50d49e4b093?s=128&d=identicon&r=PG&f=1", "display_name": "user0815", "link": "https://stackoverflow.com/users/2807749/user0815"}, "edited": false, "score": 1, "creation_date": 1450910283, "post_id": 34444755, "comment_id": 56631439, "body": "<code>choice</code> is not declared in <code>main</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1135, "user_id": 5063263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9dadb72e3e03e28dc7f64b43353f1e5?s=128&d=identicon&r=PG&f=1", "display_name": "ivan", "link": "https://stackoverflow.com/users/5063263/ivan"}, "edited": false, "score": 0, "creation_date": 1450910327, "post_id": 34444794, "comment_id": 56631457, "body": "i was late, 30 seconds late :c."}, {"owner": {"reputation": 91, "user_id": 5329644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-wI5adSpjN8U/AAAAAAAAAAI/AAAAAAAAAsQ/Lx9MELWkDx0/photo.jpg?sz=128", "display_name": "Twin Potato", "link": "https://stackoverflow.com/users/5329644/twin-potato"}, "edited": false, "score": 0, "creation_date": 1450911380, "post_id": 34444794, "comment_id": 56631835, "body": "Im a bit curious when you chain your function calls I assume this makes the program run faster or does it not make a difference?"}, {"owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "reply_to_user": {"reputation": 91, "user_id": 5329644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-wI5adSpjN8U/AAAAAAAAAAI/AAAAAAAAAsQ/Lx9MELWkDx0/photo.jpg?sz=128", "display_name": "Twin Potato", "link": "https://stackoverflow.com/users/5329644/twin-potato"}, "edited": false, "score": 1, "creation_date": 1450911512, "post_id": 34444794, "comment_id": 56631873, "body": "@Twin Less variables, more readable. It&#39;s good to put readability above everything else for beginners. It might not even result in a different binary in this case."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1450911951, "post_id": 34444794, "comment_id": 56632011, "body": "Frankly I&#39;m not convinced it&#39;s &quot;more readable&quot;. The variables could do with better names, though, and some <code>const</code>."}], "tags": [], "owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "is_accepted": true, "score": 1, "last_activity_date": 1450910437, "last_edit_date": 1450910437, "creation_date": 1450910276, "answer_id": 34444794, "question_id": 34444755, "link": "https://stackoverflow.com/questions/34444755/getting-identifier-choice-is-undefined/34444794#34444794", "title": "Getting identifier choice is undefined", "body": "<p><code>choice</code> is not declared in <code>main</code>, it's only in <code>getUserInput2</code>, which it returns. <code>getUserChoice</code> doesn't even take two arguments, so just do:</p>\n\n<pre><code>getUserChoice(input2);\n</code></pre>\n\n<p><sup>You could start chaining your function calls a bit, e.g.: <code>getUserChoice(getUserInput2());</code> and thus eliminate a few local variables.</sup></p>\n"}], "owner": {"reputation": 91, "user_id": 5329644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-wI5adSpjN8U/AAAAAAAAAAI/AAAAAAAAAsQ/Lx9MELWkDx0/photo.jpg?sz=128", "display_name": "Twin Potato", "link": "https://stackoverflow.com/users/5329644/twin-potato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "accepted_answer_id": 34444794, "answer_count": 1, "score": 0, "last_activity_date": 1451396761, "creation_date": 1450910042, "last_edit_date": 1451396761, "question_id": 34444755, "link": "https://stackoverflow.com/questions/34444755/getting-identifier-choice-is-undefined", "title": "Getting identifier choice is undefined", "body": "<p>I'm working on a calculator console app. I'm a beginner in C++ I want the program to ask a question after I'm done printing the previous result. I get the following error though and I have no idea how to fix it. </p>\n\n<blockquote>\n  <p>identifier \"choice\" is undefined</p>\n</blockquote>\n\n<p>Here is my source code:</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;iostream&gt;\n\nint getUserInput() {\n\n    std::cout &lt;&lt; \"Please enter an integer: \";\n    int value;\n    std::cin &gt;&gt; value;\n    return value;\n}\n\nint getConversionFormula() {\n\n    std::cout &lt;&lt; \"What do you want to convert? (1 for Meters to feet, 2 for kilometers to miles, 3 for kilagrams to pounds.): \";\n\n    int op;\n\n    std::cin &gt;&gt; op;\n\n    //user might select an invalid operation that isnt there\n    //Implement a way to avoid this. \n    return op;\n}\n\nint getUserInput2() {\n    std::cout &lt;&lt; \"Do you want to convert anything else? (hit 1 for yes, hit 2 for no): \";\n\n    int choice; //for the user if they hit yes or no to the question above.\n\n    std::cin &gt;&gt; choice;\n\n    return choice;\n}\n\nint getUserChoice(int choice) {\n\n    //If user selects 1 show the converstion formula screen\n    if (choice == 1)\n        getConversionFormula();\n    if (choice == 2)\n        std::exit;\n\n    return -1;\n}\n\nint calculateResult(int x, int op) {\n\n    //we will use == to compare two variables to see if they are true or not \n    if (op == 1)\n        return x * 3.280839895; //meters to feet\n    if (op == 2)\n        return x / 1.609344; //km to miles\n    if (op == 3)\n        return x * 2.2046; //kg to pounds\n\n    return -1; //If the user entered an invalid operation\n}\n\nvoid printResult(int result) {\n\n    std::cout &lt;&lt; \"Your result is: \" &lt;&lt; result &lt;&lt; std::endl;\n}\nint main()\n{\n    int input1 = getUserInput();   //Gets the users input\n\n    int op = getConversionFormula();\n\n    int result = calculateResult(input1, op);\n\n    printResult(result);\n\n    int input2 = getUserInput2(); //Asks the user if they want to convert anything else\n\n    int input3 = getUserChoice(input2, choice);\n    std::cin.clear(); // reset any error flags\n    std::cin.ignore(32767, '\\n'); // ignore any characters in the input buffer until we find an enter character\n    std::cin.get(); // get one more char from the user\n}\n</code></pre>\n\n<p>Can someone please tell me how I can fix it? I get the error in the main function just to let everyone know.</p>\n"}, {"tags": ["c++", "windows", "mingw-w64"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1450910468, "post_id": 34444751, "comment_id": 56631516, "body": "If you have a 32-bit Windows version you can&#39;t execute 64-bit apps. It sounds like you&#39;ve installed a 64-bit binary somehow.   Did you use the <a href=\"http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win32/Personal%20Builds/mingw-builds/installer/mingw-w64-install.exe/download\" rel=\"nofollow noreferrer\">official installer</a>, or did you download some random repackaged build?"}, {"owner": {"reputation": 31, "user_id": 5091100, "user_type": "registered", "profile_image": "https://graph.facebook.com/1869898646568923/picture?type=large", "display_name": "Denis Balaj", "link": "https://stackoverflow.com/users/5091100/denis-balaj"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1450910817, "post_id": 34444751, "comment_id": 56631630, "body": "I installed from this thread: <a href=\"http://stackoverflow.com/questions/31171979/enabling-std-c14-flag-in-codeblocks\" title=\"enabling std c14 flag in codeblocks\">stackoverflow.com/questions/31171979/&hellip;</a> , it seems that this mingw download link was x64 only, and I miss understood from the official site 64-32bit version, im trying this, thanks!"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1450910883, "post_id": 34444751, "comment_id": 56631656, "body": "OK, if you followed the link to the nuwen.net repackaging site, that page does indeed say that it only has 64-bit native binaries"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1450911746, "post_id": 34444751, "comment_id": 56631949, "body": "Why did you not follow the instructions, and check with the publisher? minGW-<b>w64</b> / Windows 10 <b>32-bit</b> hum maybe a problem here...!!"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1450911821, "post_id": 34444751, "comment_id": 56631975, "body": "@LightnessRacesinOrbit despite the name, it does actually publish 64-bit and 32-bit binaries (and also targets both 64-bit and 32-bit)"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1450911877, "post_id": 34444751, "comment_id": 56631987, "body": "@M.M: I said &quot;maybe&quot; - it&#39;s a big clue to the OP to check bitness <i>with the publisher</i> :)"}, {"owner": {"reputation": 31, "user_id": 5091100, "user_type": "registered", "profile_image": "https://graph.facebook.com/1869898646568923/picture?type=large", "display_name": "Denis Balaj", "link": "https://stackoverflow.com/users/5091100/denis-balaj"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1450966967, "post_id": 34444751, "comment_id": 56649827, "body": "@LightnessRacesinOrbit i just miss understood the publisher and the official installer."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1450967336, "post_id": 34444751, "comment_id": 56650000, "body": "@DenisBalaj: Okie doke"}], "answers": [{"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1450911959, "creation_date": 1450911959, "answer_id": 34445064, "question_id": 34444751, "link": "https://stackoverflow.com/questions/34444751/windows-10-32-bit-mingw-w64-doesnt-work/34445064#34445064", "title": "Windows 10 (32-bit): MinGW-w64 doesnt work", "body": "<p>There are two distinctions to make here:</p>\n\n<ul>\n<li>Whether gcc.exe is a 32-bit binary or a 64-bit binary</li>\n<li>Whether that binary will generate programs that target 32-bit or 64-bit</li>\n</ul>\n\n<p>mingw-w64 supports all four possible combinations here. But it sounds like you have downloaded a 64-bit binary.  32-bit Windows cannot run 64-bit binaries.</p>\n\n<p>To fix this, use the <a href=\"http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win32/Personal%20Builds/mingw-builds/installer/mingw-w64-install.exe/download\" rel=\"nofollow\">official installer</a>  (warning:Sourceforge, although it is not hosted anywhere else so far as I know), or look out when downloading prepackaged builds.</p>\n"}], "owner": {"reputation": 31, "user_id": 5091100, "user_type": "registered", "profile_image": "https://graph.facebook.com/1869898646568923/picture?type=large", "display_name": "Denis Balaj", "link": "https://stackoverflow.com/users/5091100/denis-balaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2026, "favorite_count": 1, "accepted_answer_id": 34445064, "answer_count": 1, "score": -1, "last_activity_date": 1450911959, "creation_date": 1450910001, "last_edit_date": 1450910698, "question_id": 34444751, "link": "https://stackoverflow.com/questions/34444751/windows-10-32-bit-mingw-w64-doesnt-work", "title": "Windows 10 (32-bit): MinGW-w64 doesnt work", "body": "<p>I've tried to compile my source files using minGW-w64, because of new C++14 standard but when i try to compile i got this error even all things and setup is allright i guess:</p>\n\n<p>Execution of 'g++.exe   -c C:\\Users\\Denis\\Desktop\\isocpp.cpp -o C:\\Users\\Denis\\Desktop\\isocpp.o' in 'C:\\Users\\Denis\\Desktop' failed.</p>\n\n<p><a href=\"http://i.stack.imgur.com/jB5XG.png\" rel=\"nofollow\">MinGW-w64 Screenshot</a></p>\n\n<p>My PC version is 32bit, from the official site i was notified that MinGW-w64 works for 64-32bit.</p>\n"}, {"tags": ["c++", "bison", "flex-lexer"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1450909972, "post_id": 34444719, "comment_id": 56631323, "body": "flex doesn&#39;t do that. Are you sure it&#39;s not something you&#39;re doing?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1450911585, "post_id": 34444719, "comment_id": 56631894, "body": "The counter needs to be in a <i>class</i>, not a namespace."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4266512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e75c907c3e568c5d6b892615e5e155c?s=128&d=identicon&r=PG&f=1", "display_name": "ananwos", "link": "https://stackoverflow.com/users/4266512/ananwos"}, "edited": false, "score": 0, "creation_date": 1450913393, "post_id": 34444799, "comment_id": 56632485, "body": "thank you for your helpful answer, it&#39;s working now."}], "tags": [], "owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "is_accepted": true, "score": 4, "last_activity_date": 1450911475, "last_edit_date": 1450911475, "creation_date": 1450910312, "answer_id": 34444799, "question_id": 34444719, "link": "https://stackoverflow.com/questions/34444719/why-does-flex-lex-reset-variable-of-c-code-to-its-initial-value/34444799#34444799", "title": "Why does Flex/Lex reset variable of c++ code to its initial value?", "body": "<p>The problem is almost certainly that you put a <code>namespace { ... }</code> into a header file.</p>\n\n<p>Each of your C++ translation units which includes this gets a copy of the raw text of the header file, and therefore has a <strong>copy</strong> of the namespace declaration.  Since the namespace is anonymous, each copy is independent; each translation unit which includes this <em>has its own</em> <code>counter</code>, as well as <code>dosomething</code> and <code>afterfinish</code>.</p>\n\n<p>This is very similar to a situation in the C language of placing some static definitions into a header, like this:</p>\n\n<pre><code>static int counter = 0;\nstatic void dosomething(void) { printf(\"%d\\n\", ++counter); }\nstatic void afterfinish(void) { printf(\"%d\\n\", counter); }\n</code></pre>\n\n<p>Each C unit which <code>#include</code>-s this header gets its own counter, along with a its own private pair of functions <code>dosomething</code> and <code>afterfinish</code> which operate on it.</p>\n\n<p>The lexer module operates on its own counter, and the <code>afterfinish</code> in the module which contains <code>main</code> operates on <em>its</em> own counter which is still zero.</p>\n\n<p>If you want a namespace which is shared by your modules, just give it a name.</p>\n\n<pre><code>// header file HelperCode.h\nnamespace parser_stuff {\n  // We no longer *define* the counter in the header, just declare it.\n  extern int counter;\n\n  // And we use inline on functions defined in the header, otherwise\n  // they will now be multiply defined!\n  inline void dosomething()\n  {\n     counter++;\n     // ... etc\n  }\n\n  // non-inline function\n  void afterfinish();\n}\n\n\n// In one .cpp file somewhere, perhaps HelperCode.cpp\n#include \"HelperCode.h\"\n\nnamespace parser_stuff {\n  int counter = 0; // One program-wide definition of parser_stuff::counter.\n\n  void afterfinish()\n  {\n    // ....\n  }\n}\n</code></pre>\n\n<p>Of course, we now have to do </p>\n\n<pre><code>%{\n    #include \"HelperCode.h\"     \n    // ... etc\n%}\n%option c++\n%option noyywrap\n%option yylineno\n%%\n\n[\\n]    { parser_stuff::dosomething();}\n\n// ...etc\n%%\n</code></pre>\n\n<p>Or else:</p>\n\n<pre><code>%{\n    #include \"HelperCode.h\"     \n    // ... etc\n\n    // one of these: bring in a specific identifier, or whole namespace:\n    using parser_stuff::dosomething;\n    using namespace parser_stuff;\n%}\n%option c++\n%option noyywrap\n%option yylineno\n%%\n\n[\\n]    { dosomething();}\n\n// ...etc\n%%\n</code></pre>\n\n<p>and similarly in the main module which refers to <code>afterfinish</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 4266512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e75c907c3e568c5d6b892615e5e155c?s=128&d=identicon&r=PG&f=1", "display_name": "ananwos", "link": "https://stackoverflow.com/users/4266512/ananwos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 34444799, "answer_count": 1, "score": 0, "last_activity_date": 1450911475, "creation_date": 1450909852, "last_edit_date": 1450910084, "question_id": 34444719, "link": "https://stackoverflow.com/questions/34444719/why-does-flex-lex-reset-variable-of-c-code-to-its-initial-value", "title": "Why does Flex/Lex reset variable of c++ code to its initial value?", "body": "<p>I was trying to create simple compiler using Flex and Bison with C++, but I can't understand why when Flex reaches end of file it will reset the variable that is declared in the C++ file to its initial value.</p>\n\n<p>in <strong>lex.l</strong> file:</p>\n\n<pre><code>%{\n    #include \"HelperCode.h\"     \n    // ... etc\n%}\n%option c++\n%option noyywrap\n%option yylineno\n%%\n\n[\\n]    { dosomething();}\n\n// ...etc\n%%\n</code></pre>\n\n<p>and the <strong>HelperCode.h</strong> file:</p>\n\n<pre><code>namespace\n{\n    int counter  = 0;\n\n    //rest of code\n\n    void dosomething()\n    {\n        counter++;\n        cout &lt;&lt; counter &lt;&lt; \" \";\n        // here it will print the correct values based on input\n        // ex: 1 2 3 4 5\n    }\n\n    void afterfinish()\n    {\n        cout &lt;&lt; endl &lt;&lt; counter;\n        // but here it will print '0', like if the counter reset to 0 \n    }\n}\n</code></pre>\n\n<p>and in <strong>yacc.y</strong> file:</p>\n\n<pre><code>// ... etc\n// ...\nvoid main(void)\n{\n    Parser* p = new Parser();\n    p-&gt;parse();\n\n    afterfinish(); \n}\n</code></pre>\n"}, {"tags": ["c++", "websocket"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1450908798, "post_id": 34444514, "comment_id": 56630853, "body": "This is a question about Poloniex, not about websockets themselves. (You need to find out what to send instead of &quot;test&quot;)"}, {"owner": {"reputation": 2402, "user_id": 4621142, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Pa0B7.jpg?s=128&g=1", "display_name": "Bobface", "link": "https://stackoverflow.com/users/4621142/bobface"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1450909001, "post_id": 34444514, "comment_id": 56630937, "body": "AH ok, I thought subscribing is a commonly used word with Websockets."}], "owner": {"reputation": 2402, "user_id": 4621142, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Pa0B7.jpg?s=128&g=1", "display_name": "Bobface", "link": "https://stackoverflow.com/users/4621142/bobface"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 874, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450915442, "creation_date": 1450908709, "last_edit_date": 1450915442, "question_id": 34444514, "link": "https://stackoverflow.com/questions/34444514/subscribe-to-websocket-feed", "title": "Subscribe to WebSocket feed", "body": "<p>I'm trying to access a WebSocket API using the <em>cpprestsdk</em>. The example code I have so far is:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cpprest/ws_client.h&gt;\n\nusing namespace std;\nusing namespace web;\nusing namespace web::websockets::client;\n\nint main() {\n  websocket_client client;\n  client.connect(\"wss://api.poloniex.com\").wait();\n\n  websocket_outgoing_message out_msg;\n  out_msg.set_utf8_message(\"test\");\n  client.send(out_msg).wait();\n\n  client.receive().then([](websocket_incoming_message in_msg) {\n    return in_msg.extract_string();\n  }).then([](string body) {\n    cout &lt;&lt; body &lt;&lt; endl; // test\n  }).wait();\n\n  client.close().wait();\n\n  return 0;\n}\n</code></pre>\n\n<p>The page (<a href=\"https://poloniex.com/support/api/\" rel=\"nofollow\">here</a>) gives the following information:</p>\n\n<blockquote>\n  <p>In order to use the push API, connect to wss://api.poloniex.com and\n  <strong>subscribe</strong> to the desired feed [...] In order to receive ticker\n  updates, <strong>subscribe</strong> to \"ticker\".</p>\n</blockquote>\n\n<p>I can't find out how to subscribe to a channel using this library.</p>\n"}, {"tags": ["c++", "move-assignment-operator"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1450907637, "post_id": 34444304, "comment_id": 56630363, "body": "Can you give an example of what you mean? (E.g. some code that you&#39;re not sure if it&#39;s correct or not)"}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 0, "creation_date": 1450908068, "post_id": 34444304, "comment_id": 56630554, "body": "I don&#39;t see how this has anything to do with move-assignment. If you have a reference to an object and then re-assign that object, sure, the reference remains usable but now refers to the changed object. Also note that for <code>int</code>s, moving and copying is just the same."}, {"owner": {"reputation": 273, "user_id": 4884156, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/992478580762224/picture?type=large", "display_name": "Cevik", "link": "https://stackoverflow.com/users/4884156/cevik"}, "reply_to_user": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 0, "creation_date": 1450908072, "post_id": 34444304, "comment_id": 56630558, "body": "@5gon12eder Ok. So you confirm that a default (compiler) move assignment is preserving the address ?"}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 0, "creation_date": 1450908114, "post_id": 34444304, "comment_id": 56630583, "body": "The address of <code>x</code>? How could it ever change? It&#39;s just an <code>int</code> on the stack."}, {"owner": {"reputation": 273, "user_id": 4884156, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/992478580762224/picture?type=large", "display_name": "Cevik", "link": "https://stackoverflow.com/users/4884156/cevik"}, "reply_to_user": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 0, "creation_date": 1450908174, "post_id": 34444304, "comment_id": 56630610, "body": "@5gon12eder yes of course"}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 0, "creation_date": 1450908297, "post_id": 34444304, "comment_id": 56630663, "body": "Sorry, I think that your question really isn&#39;t clear. Can you maybe come up with an example that is more closely related to what actual problem you have in mind? You&#39;re not really worried that <code>int x = 1; int&amp; ref = x; x = 2; std::cout &lt;&lt; ref;</code> could be invalid, are you?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1450908329, "post_id": 34444304, "comment_id": 56630676, "body": "&quot;change the address of a variable x&quot; - there is no such thing , variables have a fixed address their entire life"}, {"owner": {"reputation": 273, "user_id": 4884156, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/992478580762224/picture?type=large", "display_name": "Cevik", "link": "https://stackoverflow.com/users/4884156/cevik"}, "edited": false, "score": 0, "creation_date": 1450908342, "post_id": 34444304, "comment_id": 56630682, "body": "So if i resume, move assignment consist by moving recursively the members of an object until a copy of a fundamental type occurs ?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1450919633, "post_id": 34444304, "comment_id": 56634126, "body": "<code>move</code> doesn&#39;t mean &quot;move this thing&quot;, it means &quot;move the contents of this thing&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 4884156, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/992478580762224/picture?type=large", "display_name": "Cevik", "link": "https://stackoverflow.com/users/4884156/cevik"}, "edited": false, "score": 0, "creation_date": 1450908570, "post_id": 34444422, "comment_id": 56630772, "body": "Thank you. Simple and complete answer."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 10, "last_activity_date": 1450908259, "creation_date": 1450908259, "answer_id": 34444422, "question_id": 34444304, "link": "https://stackoverflow.com/questions/34444304/does-move-assignment-break-the-references/34444422#34444422", "title": "Does move assignment break the references?", "body": "<p>Moving to or from an object does not invalidate references or pointers to the object. The address of both objects remains the same.</p>\n"}, {"tags": [], "owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "is_accepted": false, "score": 2, "last_activity_date": 1450908308, "creation_date": 1450908308, "answer_id": 34444432, "question_id": 34444304, "link": "https://stackoverflow.com/questions/34444304/does-move-assignment-break-the-references/34444432#34444432", "title": "Does move assignment break the references?", "body": "<p>References are just alternate names to existing objects. That is, <code>x</code> and <code>ref</code> are entirely interchangable (although I'm not sure if <code>decltype(x)</code> and <code>decltype(ref)</code> are identical): when <code>x</code> changes using the other name <code>ref</code> will correspondingly see the same change. Likewise, the other way around. The same is true with pointers to objects.</p>\n\n<p>Invalidating references and pointers happens when the referenced entity somehow goes away. For example, when you have a reference to an element in a <code>std::vector&lt;T&gt;</code> and the capacity of the vector changes, the reference is invalidated because the underlying object moves away.</p>\n\n<p>Of course, for your example of <code>int</code> using <code>std::move(y)</code> is rather pointless anyway: the built-in types do not really have any move constructors, i.e., it is equivalent to a copy. However, even when using a class type, object and a reference to it still refer to the same object.</p>\n"}], "owner": {"reputation": 273, "user_id": 4884156, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/992478580762224/picture?type=large", "display_name": "Cevik", "link": "https://stackoverflow.com/users/4884156/cevik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1008, "favorite_count": 0, "accepted_answer_id": 34444422, "answer_count": 2, "score": 4, "last_activity_date": 1450908308, "creation_date": 1450907580, "last_edit_date": 1450907783, "question_id": 34444304, "link": "https://stackoverflow.com/questions/34444304/does-move-assignment-break-the-references", "title": "Does move assignment break the references?", "body": "<p>I don't understand if a move assignment is able/free to change the address of a variable x and invalidate all the pointers and references storing &amp;x.\nI figure that it's false because a default move assignment move each member and preserve the this pointer but is it guaranteed ?</p>\n\n<p>EDIT : Example</p>\n\n<pre><code>int x(1), y(2);\nint&amp; ref(x);\nx = std::move(y);\n// ref still valid ?\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 31, "user_id": 5701022, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5be0f8f50de10f05648e52b714387b33?s=128&d=identicon&r=PG&f=1", "display_name": "newmanadam", "link": "https://stackoverflow.com/users/5701022/newmanadam"}, "edited": false, "score": 0, "creation_date": 1450907364, "post_id": 34444191, "comment_id": 56630245, "body": "I messed up when indenting now program will not run. Should have checked first. Will do right away. Very sorry"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1450907367, "post_id": 34444191, "comment_id": 56630246, "body": "Side note:  this is actually a silly thing to check, and a waste of typing."}], "answers": [{"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 1, "last_activity_date": 1450908073, "last_edit_date": 1450908073, "creation_date": 1450907235, "answer_id": 34444240, "question_id": 34444191, "link": "https://stackoverflow.com/questions/34444191/what-is-purpose-of-condition-used-for-if-statement-c/34444240#34444240", "title": "what is purpose of condition used for if() statement? C++", "body": "<p><code>if()</code> works for one statement, in your case for one line:</p>\n\n<pre><code> if (pPi &amp;&amp; pRadius &amp;&amp; pArea)\n     *pArea = (*pPi) * (*pRadius) * (*pRadius);\n cout &lt;&lt; \"why am I seeing this?...\" &lt;&lt;endl; // cout is outside of if()\n</code></pre>\n\n<p>you need create block of code to make <code>cout</code> output conditional:</p>\n\n<pre><code> if (pPi &amp;&amp; pRadius &amp;&amp; pArea) {\n     *pArea = (*pPi) * (*pRadius) * (*pRadius);\n     cout &lt;&lt; \"why am I seeing this?...\" &lt;&lt;endl;\n }\n</code></pre>\n\n<p>Condition itself is used to check that none of three pointers are equal to <code>nullptr</code>, as dereferencing such pointer would lead to undefined behavior, in simple words to prevent program to crush on invalid input for this function.</p>\n"}, {"tags": [], "owner": {"reputation": 6455, "user_id": 2363967, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e456a6a8bd35a0e65c22d202b48ccfa4?s=128&d=identicon&r=PG", "display_name": "Andrew Williamson", "link": "https://stackoverflow.com/users/2363967/andrew-williamson"}, "is_accepted": false, "score": 3, "last_activity_date": 1450908224, "last_edit_date": 1450908224, "creation_date": 1450907237, "answer_id": 34444241, "question_id": 34444191, "link": "https://stackoverflow.com/questions/34444191/what-is-purpose-of-condition-used-for-if-statement-c/34444241#34444241", "title": "what is purpose of condition used for if() statement? C++", "body": "<p>Only the line immediately following the <em>if</em> depends on the evaluation.</p>\n\n<pre><code>if (condition)\n    statement\n</code></pre>\n\n<p>If you want both lines to only run if the condition holds, use curly braces.</p>\n\n<pre><code>if (condition)\n{\n    multiple\n    statements\n}\n</code></pre>\n\n<p>The if condition here simply checks that none of the references you give it are null. This can happen if you explicitly call your function with NULL</p>\n\n<pre><code>CalcArea(&amp;Pi, NULL, &amp;Area);\n</code></pre>\n\n<p>Or if you are using a pointer, which has previously been set to null. Since you are learning from a book, I would assume it will explain them to you soon enough.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 5701022, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5be0f8f50de10f05648e52b714387b33?s=128&d=identicon&r=PG&f=1", "display_name": "newmanadam", "link": "https://stackoverflow.com/users/5701022/newmanadam"}, "edited": false, "score": 0, "creation_date": 1450909156, "post_id": 34444252, "comment_id": 56631000, "body": "Thank you all very much, I appreciate it. And again I am sorry for having had to edit my post to correct the initially broken program caused by my indentation. From now on I will check to see if my posted program compiles. Also, see my small contribution to upgrading code blocks to c++14."}], "tags": [], "owner": {"reputation": 434, "user_id": 2735402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iuaLK.png?s=128&g=1", "display_name": "flederwiesel", "link": "https://stackoverflow.com/users/2735402/flederwiesel"}, "is_accepted": false, "score": 0, "last_activity_date": 1450907280, "creation_date": 1450907280, "answer_id": 34444252, "question_id": 34444191, "link": "https://stackoverflow.com/questions/34444191/what-is-purpose-of-condition-used-for-if-statement-c/34444252#34444252", "title": "what is purpose of condition used for if() statement? C++", "body": "<p>You want to brace the whole block which refers to the condition:</p>\n\n<pre><code>void CalcArea(const double* const pPi, \n const double* const pRadius, \n double* const pArea)\n {\n    if (pPi &amp;&amp; pRadius &amp;&amp; pArea)\n    {\n         *pArea = (*pPi) * (*pRadius) * (*pRadius);\n         cout &lt;&lt; \"why am I seeing this?...\" &lt;&lt;endl;\n         cout &lt;&lt; \"Because all pointers are != NULL\" &lt;&lt;endl;\n    }\n }\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5701022, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5be0f8f50de10f05648e52b714387b33?s=128&d=identicon&r=PG&f=1", "display_name": "newmanadam", "link": "https://stackoverflow.com/users/5701022/newmanadam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1450908587, "creation_date": 1450906996, "last_edit_date": 1450908587, "question_id": 34444191, "link": "https://stackoverflow.com/questions/34444191/what-is-purpose-of-condition-used-for-if-statement-c", "title": "what is purpose of condition used for if() statement? C++", "body": "<p>How can I send a NULL pointer from the caller, as any of the three parameters, to the CalcArea function, in the following program? No matter how I modify the condition (not content), of the if () statement, I still see the output from cout &lt;&lt; \"why am I seeing this...\" &lt;\n\n<pre><code> #include &lt;iostream&gt;\n using namespace std;\n\n void CalcArea(const double* const pPi,\n               const double* const pRadius,\n               double* const pArea)\n {\n     if (pPi &amp;&amp; pRadius &amp;&amp; pArea)\n     *pArea = (*pPi) * (*pRadius) * (*pRadius);\n     cout&lt;&lt; \"why am I seeing this?...\" &lt;&lt;endl;\n }\n\n int main()\n {\n     const double Pi = 3.1416;\n\n     cout&lt;&lt; \"enter radius of circle: \";\n     double Radius = 0;\n     cin&gt;&gt; Radius;\n\n     double Area = 0;\n     CalcArea (&amp;Pi, &amp;Radius, &amp;Area);\n\n     cout&lt;&lt; \"area is = \" &lt;&lt;Area&lt;&lt;endl;\n\n     cout&lt;&lt; \"press enter to continue...\" &lt;&lt;endl;\n     cin.ignore(10, '\\n');\n     cin.get();\n\n     return 0;\n }\n</code></pre>\n\n<p>Please help me to understand. It says in my book that \"you don't want the function to calculate the area if the caller inadvertently sends a NULL pointer as any of the three parameters\", but under what conditions exactly could this occure? What is the condition of the if() statement meant to prevent. Remember I am only beginning. Thank you all, sincerely, newmanadam</p>\n"}, {"tags": ["c++", "qt", "singleton", "warnings", "compiler-warnings"], "answers": [{"comments": [{"owner": {"reputation": 2740, "user_id": 4731718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2a262f4c7f71392806f969febe970961?s=128&d=identicon&r=PG&f=1", "display_name": "\u05e1\u05d8\u05e0\u05dc\u05d9 \u05d2\u05e8\u05d5\u05e0\u05df", "link": "https://stackoverflow.com/users/4731718/%d7%a1%d7%98%d7%a0%d7%9c%d7%99-%d7%92%d7%a8%d7%95%d7%a0%d7%9f"}, "edited": false, "score": 0, "creation_date": 1450907348, "post_id": 34444164, "comment_id": 56630241, "body": "What do you mean by &quot;not the default implementation. They do nothing&quot;? Please elaborate a little bit, I am beginner in C++ ..."}, {"owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "reply_to_user": {"reputation": 2740, "user_id": 4731718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2a262f4c7f71392806f969febe970961?s=128&d=identicon&r=PG&f=1", "display_name": "\u05e1\u05d8\u05e0\u05dc\u05d9 \u05d2\u05e8\u05d5\u05e0\u05df", "link": "https://stackoverflow.com/users/4731718/%d7%a1%d7%98%d7%a0%d7%9c%d7%99-%d7%92%d7%a8%d7%95%d7%a0%d7%9f"}, "edited": false, "score": 0, "creation_date": 1450907550, "post_id": 34444164, "comment_id": 56630327, "body": "When you&#39;re defining the special member functions yourself, you have to implement what you want them to do manually (copying, <code>return</code>ing <code>*this;</code>)."}, {"owner": {"reputation": 2740, "user_id": 4731718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2a262f4c7f71392806f969febe970961?s=128&d=identicon&r=PG&f=1", "display_name": "\u05e1\u05d8\u05e0\u05dc\u05d9 \u05d2\u05e8\u05d5\u05e0\u05df", "link": "https://stackoverflow.com/users/4731718/%d7%a1%d7%98%d7%a0%d7%9c%d7%99-%d7%92%d7%a8%d7%95%d7%a0%d7%9f"}, "edited": false, "score": 0, "creation_date": 1450907622, "post_id": 34444164, "comment_id": 56630357, "body": "1, Yes, no more warning on copy constructor.  And 2: stupid me, I forgot to return something there... Thanks! :)"}, {"owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "reply_to_user": {"reputation": 2740, "user_id": 4731718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2a262f4c7f71392806f969febe970961?s=128&d=identicon&r=PG&f=1", "display_name": "\u05e1\u05d8\u05e0\u05dc\u05d9 \u05d2\u05e8\u05d5\u05e0\u05df", "link": "https://stackoverflow.com/users/4731718/%d7%a1%d7%98%d7%a0%d7%9c%d7%99-%d7%92%d7%a8%d7%95%d7%a0%d7%9f"}, "edited": false, "score": 0, "creation_date": 1450908112, "post_id": 34444164, "comment_id": 56630581, "body": "Oh, yes, I forgot to mention that."}, {"owner": {"reputation": 2740, "user_id": 4731718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2a262f4c7f71392806f969febe970961?s=128&d=identicon&r=PG&f=1", "display_name": "\u05e1\u05d8\u05e0\u05dc\u05d9 \u05d2\u05e8\u05d5\u05e0\u05df", "link": "https://stackoverflow.com/users/4731718/%d7%a1%d7%98%d7%a0%d7%9c%d7%99-%d7%92%d7%a8%d7%95%d7%a0%d7%9f"}, "edited": false, "score": 1, "creation_date": 1450908254, "post_id": 34444164, "comment_id": 56630648, "body": "No problem... I added <code>CONFIG += c++11</code> in the .pro  file and now it compiles like a charm! :)"}, {"owner": {"reputation": 2740, "user_id": 4731718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2a262f4c7f71392806f969febe970961?s=128&d=identicon&r=PG&f=1", "display_name": "\u05e1\u05d8\u05e0\u05dc\u05d9 \u05d2\u05e8\u05d5\u05e0\u05df", "link": "https://stackoverflow.com/users/4731718/%d7%a1%d7%98%d7%a0%d7%9c%d7%99-%d7%92%d7%a8%d7%95%d7%a0%d7%9f"}, "edited": false, "score": 0, "creation_date": 1450994697, "post_id": 34444164, "comment_id": 56658549, "body": "I suppose this will work for me too: <code>DataBase(DataBase const &amp;) = delete;</code> and <code>DataBase &amp;operator=(DataBase const&amp;) = delete;</code>"}, {"owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "reply_to_user": {"reputation": 2740, "user_id": 4731718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2a262f4c7f71392806f969febe970961?s=128&d=identicon&r=PG&f=1", "display_name": "\u05e1\u05d8\u05e0\u05dc\u05d9 \u05d2\u05e8\u05d5\u05e0\u05df", "link": "https://stackoverflow.com/users/4731718/%d7%a1%d7%98%d7%a0%d7%9c%d7%99-%d7%92%d7%a8%d7%95%d7%a0%d7%9f"}, "edited": false, "score": 0, "creation_date": 1450994896, "post_id": 34444164, "comment_id": 56658587, "body": "Of course, if you don&#39;t need to copy the class, or you want to prevent yourself from doing so (the copy might be expensive or just a wrong thing to do)."}], "tags": [], "owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "is_accepted": true, "score": 1, "last_activity_date": 1450912307, "last_edit_date": 1495541747, "creation_date": 1450906866, "answer_id": 34444164, "question_id": 34444146, "link": "https://stackoverflow.com/questions/34444146/qt5-how-to-get-rid-of-the-compiler-warnings-for-this-singleton/34444164#34444164", "title": "Qt5: How to get rid of the compiler warnings for this Singleton?", "body": "<ol>\n<li><p>Try to initialize <code>QObject</code> base with the same parent as <code>other</code> has:</p>\n\n<pre><code>DataBase(DataBase const&amp; other) :\nQObject(other.parent())\n// copy-construct members\n{\n} \n</code></pre></li>\n<li><p>The <code>operator=</code> should look like:</p>\n\n<pre><code>DataBase &amp;operator=(DataBase const&amp; other)\n{\n    QObject::operator=(other);\n    // copy-assign members\n    return *this;\n}\n</code></pre>\n\n<p>The warning is about that <a href=\"https://stackoverflow.com/questions/3105798/why-must-the-copy-assignment-operator-return-a-reference-const-reference\">you forgot to <code>return *this;</code></a>.</p></li>\n</ol>\n\n<p>Note that what you're doing are not default implementations. They do nothing!</p>\n\n<p>You'll probably want to use <a href=\"https://stackoverflow.com/questions/6502828/what-does-default-mean-after-a-class-function-declaration\"><code>default</code></a> keyword (if you're compiling under C++11 or later) to leave the implementation of these function up to the compiler:</p>\n\n<pre><code>DataBase(DataBase const &amp;) = default;\nDataBase &amp;operator=(DataBase const&amp;) = default;\n</code></pre>\n"}], "owner": {"reputation": 2740, "user_id": 4731718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2a262f4c7f71392806f969febe970961?s=128&d=identicon&r=PG&f=1", "display_name": "\u05e1\u05d8\u05e0\u05dc\u05d9 \u05d2\u05e8\u05d5\u05e0\u05df", "link": "https://stackoverflow.com/users/4731718/%d7%a1%d7%98%d7%a0%d7%9c%d7%99-%d7%92%d7%a8%d7%95%d7%a0%d7%9f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 1, "accepted_answer_id": 34444164, "answer_count": 1, "score": 0, "last_activity_date": 1450912307, "creation_date": 1450906774, "last_edit_date": 1450908725, "question_id": 34444146, "link": "https://stackoverflow.com/questions/34444146/qt5-how-to-get-rid-of-the-compiler-warnings-for-this-singleton", "title": "Qt5: How to get rid of the compiler warnings for this Singleton?", "body": "<p>I am using Qt5 on a Windows 7 platform.<br>\nI've implemented a Singleton for a database I work with.<br>\nSo far it's ok, it works fine, but when I compile the code I always get 2 warnings related to copy constructor and to assignment operator.   </p>\n\n<p><strong>Here is the code:</strong>    </p>\n\n<pre><code>class DataBase : public QObject\n{\n    Q_OBJECT\n\npublic:\n    static DataBase * instance(QObject * parent = 0);\n    static void destroy();\n    //\n    QString openDataBaseConnection();\n    void closeDataBaseConnection(QString &amp; connectionName);\n\nprivate:\n    DataBase(QObject * parent);\n    ~DataBase();\n    DataBase(DataBase const &amp;){} // &lt;- copy constructor\n    DataBase &amp; operator = (DataBase const &amp;){} // &lt;- assignment operator\n    static DataBase * pInstance;\n};\n</code></pre>\n\n<p><strong>And here are the compiler warnings:</strong>    </p>\n\n<blockquote>\n  <p>1) Base class QObject should be explicitly initialized in the copy constructor<br>\n  2) No return statement in function returning non-void (that's for the assignment operator code line).</p>\n</blockquote>\n\n<p>Well, what can I do in order to finally get rid of these 2 warnings?    </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1450907093, "post_id": 34444126, "comment_id": 56630128, "body": "Why do you think <code>cin.width(5)</code> sets the field width to 4 instead of 5?"}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 0, "creation_date": 1450907414, "post_id": 34444126, "comment_id": 56630272, "body": "@Barmer: I guess, because it kind of does! :-) It specifies that there are 5 characters which can be stored for a formatted input but the last one will be used for a null terminator..."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1450907442, "post_id": 34444126, "comment_id": 56630279, "body": "OK, then his second comment &quot;input 5 more characters&quot; is wrong."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1450907940, "post_id": 34444126, "comment_id": 56630504, "body": "&quot;The book&quot;? Which book?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1450907994, "post_id": 34444126, "comment_id": 56630526, "body": "<code>cin.width(5); &#47;&#47; input 5 more characters from sentence</code> Nope. That&#39;s not what it does."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1450907221, "last_edit_date": 1592644375, "creation_date": 1450907221, "answer_id": 34444239, "question_id": 34444126, "link": "https://stackoverflow.com/questions/34444126/cs-cin-width-function-explanation/34444239#34444239", "title": "C++&#39;s cin.width function explanation", "body": "<p>From <a href=\"http://en.cppreference.com/w/cpp/io/basic_istream/operator_gtgt2\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/io/basic_istream/operator_gtgt2</a>:</p>\n<blockquote>\n<p>The extraction stops if one of the following conditions are met:</p>\n<ul>\n<li>a whitespace character (as determined by the ctype facet) is found. The whitespace character is not extracted.</li>\n<li>st.width() - 1 characters are extracted</li>\n<li>end of file occurs in the input sequence (this also sets eofbit)</li>\n</ul>\n</blockquote>\n<p>Hence, if your input is:</p>\n\n<pre><code>This is a line line.\n</code></pre>\n<p>the contents of <code>sentence</code> will be <code>&quot;is&quot;</code> in the second iteration of the loop.</p>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1450907630, "last_edit_date": 1450907630, "creation_date": 1450907291, "answer_id": 34444253, "question_id": 34444126, "link": "https://stackoverflow.com/questions/34444126/cs-cin-width-function-explanation/34444253#34444253", "title": "C++&#39;s cin.width function explanation", "body": "<p>Whenever you do a new <code>cin &gt;&gt; sentence</code> it overwrites whatever was in <code>sentence</code> before. Also the input stops at a space. Consequently the second loop will just give you <code>is</code></p>\n"}, {"tags": [], "owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "is_accepted": false, "score": 1, "last_activity_date": 1450907331, "creation_date": 1450907331, "answer_id": 34444259, "question_id": 34444126, "link": "https://stackoverflow.com/questions/34444126/cs-cin-width-function-explanation/34444259#34444259", "title": "C++&#39;s cin.width function explanation", "body": "<p>When you use formatted input with a <code>char*</code> the stream's <code>width()</code> determines the <em>maximum</em> number of character which fit into the corresponding array. Since the stream need to be null terminated, at most <code>s.width() - 1</code> will be read to allow for storing the terminating null character.</p>\n\n<p>The formatted input also starts with skipping leading whitespace and stops upon reaching the first whitespace. That is, input stopes when either <code>width()-1</code> character have been stored or a space is reached. Once the input is done, the current <code>width()</code> is reset to <code>0</code> (the <code>width()</code> is the only formatting flag which keeps getting reset; all other formatting flags keep their value until a new one is set).</p>\n\n<p>For output, the <code>width()</code> specifies the number of characters which should be printed. If the value to be printed doesn't produce enough character, the remaining characters are <em>padded</em>, i.e., the current fill character (accessed with the <code>fill()</code> members) is used to write, at least, <code>width()</code> characters. Again, the <code>width()</code> gets reset to <code>0</code> after use.</p>\n\n<p>The <code>width()</code> for input and output have <em>entirely</em> different purposes. Probably, different members should be used. In particular, formatted input into a <code>char</code> array is the only use of <code>width()</code> for input in the standard C++ library.</p>\n"}, {"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 3, "last_activity_date": 1450907359, "creation_date": 1450907359, "answer_id": 34444263, "question_id": 34444126, "link": "https://stackoverflow.com/questions/34444126/cs-cin-width-function-explanation/34444263#34444263", "title": "C++&#39;s cin.width function explanation", "body": "<p>When you set <code>width(w)</code> on <code>cin</code> and then read a C string from it, operator <code>&gt;&gt;</code> stops when one of the following happens:</p>\n\n<ul>\n<li><strong><code>w-1</code> characters have been read</strong> - <code>&gt;&gt;</code> needs one more character for null terminator, which is included in the count</li>\n<li><strong>a delimiter character is reached</strong> - in your case, whitespace is the delimiter</li>\n<li><strong>End of input is reached</strong> - There's nothing <code>&gt;&gt;</code> can do when there's no more data to read.</li>\n</ul>\n\n<p>Therefore, your loop partitions the input as follows:</p>\n\n<ul>\n<li>If a word is shorter than four characters in length, it would be read in its entirety</li>\n<li>Otherwise, the word would be read in four-character increments; the last part may have fewer than four characters.</li>\n</ul>\n\n<p>Printing is right-justified, with spaces pre-pended to each word or a portion of the word that was previously read from <code>cin</code>. The <code>widthValue++</code> expression controls the overall width, so each next word gets one extra space in front of it.</p>\n\n<p>Here is the <a href=\"http://ideone.com/Sx52eK\" rel=\"nofollow\">output</a> for <code>\"jackdaws love my big sphinx of quartz\"</code>, with <code>|</code> marks added to show the beginning and the end of each line:</p>\n\n<pre><code>|jack|\n| daws|\n|  love|\n|     my|\n|     big|\n|     sphi|\n|        nx|\n|         of|\n|        quar|\n|           tz|\n</code></pre>\n"}], "owner": {"reputation": 883, "user_id": 2987084, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/j8gAR.png?s=128&g=1", "display_name": "Shinji-san", "link": "https://stackoverflow.com/users/2987084/shinji-san"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2839, "favorite_count": 0, "answer_count": 4, "score": 3, "last_activity_date": 1450907630, "creation_date": 1450906672, "last_edit_date": 1450906882, "question_id": 34444126, "link": "https://stackoverflow.com/questions/34444126/cs-cin-width-function-explanation", "title": "C++&#39;s cin.width function explanation", "body": "<p>I've read this passage in the book(which barely explained) a dozen times but can't understand how this is really working. I'm trying to figure out how the functions are working.</p>\n\n<pre><code>int main() {\n     int widthValue = 4;\n     char sentence[ 10 ];\n\n     cout &lt;&lt; \"Enter a sentence:\" &lt;&lt; endl;\n     cin.width( 5 ); // input only 4 characters from sentence\n\n     // set field width, then display characters based on that width\n     while ( cin &gt;&gt; sentence )\n     {\n      cout.width( widthValue++ );\n      cout &lt;&lt; sentence &lt;&lt; endl;\n      cin.width(5); // input 5 more characters from sentence\n      } // end while\n      return 0;\n } // end main\n</code></pre>\n\n<p>Now the following output is produced, and here's my trouble. The first line says cin.width, and this line means that the first 4 characters, actually, will be read - namely, \"This\", but then you output a field width of 4, so when you execute the 'cout &lt;&lt; sentence &lt;&lt; endl statement you print 4 characters, namely - \"This\". After, you read 5 more characters from sentence. But I get lost on the next iteration of the loop because the width then becomes 5, yet you output \"   is\". I don't get the concept.</p>\n"}, {"tags": ["c++", "makefile"], "comments": [{"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 3, "creation_date": 1450908997, "post_id": 34444081, "comment_id": 56630936, "body": "Shouldn&#39;t you compile with the <code>-c</code> option?"}, {"owner": {"reputation": 2721, "user_id": 1710444, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/23fb7b17ea705c9454dfc41d75f578a4?s=128&d=identicon&r=PG", "display_name": "Catalyst", "link": "https://stackoverflow.com/users/1710444/catalyst"}, "edited": false, "score": 0, "creation_date": 1450911134, "post_id": 34444081, "comment_id": 56631748, "body": "As a side note, you can use a glob to get all of the filenames in a directory without explicitly listing them."}], "answers": [{"tags": [], "owner": {"reputation": 2098, "user_id": 425540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5fc21da5cd6a986180da38f33e41ff8?s=128&d=identicon&r=PG", "display_name": "levif", "link": "https://stackoverflow.com/users/425540/levif"}, "is_accepted": false, "score": 0, "last_activity_date": 1451490243, "last_edit_date": 1495541042, "creation_date": 1451490243, "answer_id": 34532590, "question_id": 34444081, "link": "https://stackoverflow.com/questions/34444081/makefile-implicit-entry-start-for-main-error/34532590#34532590", "title": "Makefile - implicit entry/start for main error", "body": "<p>As suggested by <a href=\"https://stackoverflow.com/users/1392132/5gon12eder\">@5gon12eder</a>, you should use '-c'.</p>\n\n<pre><code>.cpp.o:\n    $(CC) -c $(CFLAGS) -o $@ $&lt;\n</code></pre>\n\n<p>Debug is easier if you interpret <em>pkg-config</em> results earlier:</p>\n\n<pre><code>CFLAGS  := $(shell pkg-config --cflags opencv libexif)\nLDFLAGS := $(shell pkg-config --libs opencv libexif)\nSOURCES := $(wildcard *.cpp)\n</code></pre>\n\n<p>[...]  </p>\n\n<pre><code>.PHONY: clean\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 1035839, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/69fe76b04de213ade7c072b18b48ee24?s=128&d=identicon&r=PG", "display_name": "user1035839", "link": "https://stackoverflow.com/users/1035839/user1035839"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 493, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451490243, "creation_date": 1450906472, "last_edit_date": 1450908752, "question_id": 34444081, "link": "https://stackoverflow.com/questions/34444081/makefile-implicit-entry-start-for-main-error", "title": "Makefile - implicit entry/start for main error", "body": "<p>I am getting the following output from my makefile. My main goal is to compile everything in a directory. I expect to have many more cpp files in future. Any tips or advice is greatly appreciated!</p>\n\n<p>Output:</p>\n\n<pre><code>g++ `pkg-config --libs --cflags opencv libexif` main.cpp -o main.o\ng++ `pkg-config --libs --cflags opencv libexif` Image.cpp -o Image.o\nUndefined symbols for architecture x86_64:\n  \"_main\", referenced from:\n     implicit entry/start for main executable\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nmake: *** [Image.o] Error 1\n</code></pre>\n\n<p>Current list of files:\nmain.cpp, Image.h, Image.cpp</p>\n\n<p>Here's the makefile:</p>\n\n<pre><code>CC=g++\nCFLAGS= `pkg-config --libs --cflags opencv libexif`\nLDFLAGS= `pkg-config --libs --cflags opencv libexif`\nSOURCES=main.cpp Image.cpp\nOBJECTS=$(SOURCES:.cpp=.o)\nEXECUTABLE=CvHelloWorld\n\nall: $(SOURCES) $(EXECUTABLE)\n\n$(EXECUTABLE): $(OBJECTS) \n    $(CC) $(LDFLAGS) $(OBJECTS) -o $@\n\n.cpp.o:\n    $(CC) $(CFLAGS) $&lt; -o $@\n\nclean:\n    rm *.o\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1450906533, "post_id": 34444075, "comment_id": 56629854, "body": "You&#39;re using <code>=</code> (assignment) when you mean to use <code>==</code> (comparison)."}, {"owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "edited": false, "score": 1, "creation_date": 1450906536, "post_id": 34444075, "comment_id": 56629855, "body": "Your code can be more compact: <code>x = &quot;&#47;&quot;; y = 4;</code> (sarcasm)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1450906586, "post_id": 34444075, "comment_id": 56629883, "body": "And to make a character literal, you put it in SINGLE quotes. DOUBLE quotes are for strings. You really need to go back to your textbook and learn the basics."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1450906649, "post_id": 34444075, "comment_id": 56629909, "body": "When you have a sequence of mutually exclusive tests, you should use <code>else if</code> instead of just <code>if</code>."}], "answers": [{"tags": [], "owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "is_accepted": false, "score": 4, "last_activity_date": 1450906723, "creation_date": 1450906723, "answer_id": 34444137, "question_id": 34444075, "link": "https://stackoverflow.com/questions/34444075/controlling-variable-by-character/34444137#34444137", "title": "Controlling variable by character", "body": "<ol>\n<li>The comparison operator is <code>==</code>. <code>=</code> is for assignment or initialization.</li>\n<li><code>\"+\"</code> is a string literal a.k.a. <code>char[2]</code>; <code>2</code> because of the null byte. A character is <code>'+'</code>. Note that character literals in C++ are <code>char</code>s while in C <code>int</code>s.</li>\n<li>Use an <code>else if</code> or even better a <code>switch</code> control structure. <code>switch</code> leaves more room for optimization to the compiler like a jump table or a hash map.</li>\n<li>This numeric assignment to <code>y</code> does not look nice. Use an <code>enum</code> instead.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": false, "score": 0, "last_activity_date": 1450906792, "creation_date": 1450906792, "answer_id": 34444150, "question_id": 34444075, "link": "https://stackoverflow.com/questions/34444075/controlling-variable-by-character/34444150#34444150", "title": "Controlling variable by character", "body": "<p>Typically you'd want to use a <code>switch</code> statement, something on this general order:</p>\n\n<pre><code>switch (x) {\n    case '+': y = 1; break;\n    case '-': y = 2; break;\n    case '*': y = 3; break;\n    case '/': y = 4; break;\n}\n</code></pre>\n\n<p>If you had a larger number of possibilities (or might need to load possibilities from an external data file, etc.) you might want to consider using a <code>std::map</code> or <code>std::unordered_map</code> instead:</p>\n\n<pre><code>std::map&lt;char, int&gt; ops;\n\nops['+'] = 1;\nops['-'] = 2;\nops['*'] = 3;\nops['/'] = 4;\n\ny = ops.find(x)-&gt;second;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 338, "user_id": 4008060, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e34139aa6bf21e15255159022ab4b78?s=128&d=identicon&r=PG&f=1", "display_name": "LucaLumetti", "link": "https://stackoverflow.com/users/4008060/lucalumetti"}, "is_accepted": false, "score": 0, "last_activity_date": 1450906941, "creation_date": 1450906941, "answer_id": 34444177, "question_id": 34444075, "link": "https://stackoverflow.com/questions/34444075/controlling-variable-by-character/34444177#34444177", "title": "Controlling variable by character", "body": "<pre><code>if( x == '+' )    {y = 1}\nif( x == '-' )    {y = 2}\nif( x == '*' )    {y = 3}\nif( x == '/' )    {y = 4}\n</code></pre>\n\n<p>x = something mean assing to the variable x the value of something</p>\n\n<p>x == something mean if x contain the same value of something, then return true, else return false.</p>\n\n<p>for char variable, remember to use ' instead of \"</p>\n\n<p>Another way to do that is using switch</p>\n\n<pre><code>    switch(x){\n        case '+':\n            y = 1;\n            break;\n        case '*':\n            y = 2;\n            break;\netc...\n    }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5712631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fb6866571fdf7d399e330df32f7895c?s=128&d=identicon&r=PG&f=1", "display_name": "Krzesu0", "link": "https://stackoverflow.com/users/5712631/krzesu0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1450906941, "creation_date": 1450906455, "last_edit_date": 1450906540, "question_id": 34444075, "link": "https://stackoverflow.com/questions/34444075/controlling-variable-by-character", "title": "Controlling variable by character", "body": "<p>I am making calculator in c++ and i have a question. Is there a way to do someting like this?</p>\n\n<pre><code>if( x = \"+\" )    {y = 1}\nif( x = \"-\" )    {y = 2}\nif( x = \"*\" )    {y = 3}\nif( x = \"/\" )    {y = 4}\n</code></pre>\n\n<p>I need to control \"y\" by using characters \"+ - * /\" and its giving me errors like \"error: invalid conversion from 'const char*' to 'int' [-fpermissive]|\" I dont know what it means</p>\n\n<p>I am beginner. Thanks for any help :)</p>\n"}, {"tags": ["c++", "http"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1450906604, "post_id": 34444017, "comment_id": 56629892, "body": "... so what errors do they return?"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1450906647, "post_id": 34444017, "comment_id": 56629908, "body": "It might be worth mentioning what the errors were."}, {"owner": {"reputation": 1, "user_id": 5704726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb0572c4f8b4f4be6edd1ba37a77622?s=128&d=identicon&r=PG&f=1", "display_name": "jmp1212", "link": "https://stackoverflow.com/users/5704726/jmp1212"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1450906670, "post_id": 34444017, "comment_id": 56629920, "body": "@immibis I didn&#39;t specify that because sometimes I get <code>HTTP&#47;1.1 504 Gateway Timeout</code> and sometimes something like <code>404 not found</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5704726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb0572c4f8b4f4be6edd1ba37a77622?s=128&d=identicon&r=PG&f=1", "display_name": "jmp1212", "link": "https://stackoverflow.com/users/5704726/jmp1212"}, "edited": false, "score": 0, "creation_date": 1450909461, "post_id": 34444636, "comment_id": 56631137, "body": "I&#39;ve just readed that document, but I still don&#39;t understand: what part of my question are you referring to?"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 1, "user_id": 5704726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb0572c4f8b4f4be6edd1ba37a77622?s=128&d=identicon&r=PG&f=1", "display_name": "jmp1212", "link": "https://stackoverflow.com/users/5704726/jmp1212"}, "edited": false, "score": 0, "creation_date": 1450910055, "post_id": 34444636, "comment_id": 56631350, "body": "@jmp1212 having followed the link in RFC 7230, answer updated. You could have done this..."}, {"owner": {"reputation": 1, "user_id": 5704726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb0572c4f8b4f4be6edd1ba37a77622?s=128&d=identicon&r=PG&f=1", "display_name": "jmp1212", "link": "https://stackoverflow.com/users/5704726/jmp1212"}, "edited": false, "score": 0, "creation_date": 1450910388, "post_id": 34444636, "comment_id": 56631485, "body": "I could have done what? Did you see I already send the following header <code>CONNECT http:&#47;&#47;icanhazip.com:80 HTTP&#47;1.1\\r\\n\\r\\n</code>?."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 1, "user_id": 5704726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb0572c4f8b4f4be6edd1ba37a77622?s=128&d=identicon&r=PG&f=1", "display_name": "jmp1212", "link": "https://stackoverflow.com/users/5704726/jmp1212"}, "edited": false, "score": 0, "creation_date": 1450910530, "post_id": 34444636, "comment_id": 56631532, "body": "You could have followed the link to RFC7231 (linked above) and read that you MUST send the <code>Host: </code> line (emphasis in the RFC, it&#39;s not mine)."}, {"owner": {"reputation": 1, "user_id": 5704726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb0572c4f8b4f4be6edd1ba37a77622?s=128&d=identicon&r=PG&f=1", "display_name": "jmp1212", "link": "https://stackoverflow.com/users/5704726/jmp1212"}, "edited": false, "score": 0, "creation_date": 1450910782, "post_id": 34444636, "comment_id": 56631615, "body": "so I need to  send <code>Host: http:&#47;&#47;icanhazip.com:80\\r\\n\\r\\n</code> instead of <code>CONNECT http:&#47;&#47;icanhazip.com:80 HTTP&#47;1.1\\r\\n\\r\\n</code>?"}, {"owner": {"reputation": 1, "user_id": 5704726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb0572c4f8b4f4be6edd1ba37a77622?s=128&d=identicon&r=PG&f=1", "display_name": "jmp1212", "link": "https://stackoverflow.com/users/5704726/jmp1212"}, "edited": false, "score": 0, "creation_date": 1450911811, "post_id": 34444636, "comment_id": 56631969, "body": "I still don&#39;t understand what you mean. I think all you said is wrong as you are wrong-informed (I&#39;m not criticizing nobody)."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 1, "user_id": 5704726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb0572c4f8b4f4be6edd1ba37a77622?s=128&d=identicon&r=PG&f=1", "display_name": "jmp1212", "link": "https://stackoverflow.com/users/5704726/jmp1212"}, "edited": false, "score": 0, "creation_date": 1450913251, "post_id": 34444636, "comment_id": 56632446, "body": "you need to send both!"}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 0, "last_activity_date": 1450910017, "last_edit_date": 1450910017, "creation_date": 1450909331, "answer_id": 34444636, "question_id": 34444017, "link": "https://stackoverflow.com/questions/34444017/http-errors-while-making-a-request-through-a-proxy/34444636#34444636", "title": "HTTP errors while making a request through a proxy", "body": "<p>Old Chinese proverb say, \"before writing code, better to read specification\"</p>\n\n<p><a href=\"https://tools.ietf.org/html/rfc7230\" rel=\"nofollow\">https://tools.ietf.org/html/rfc7230</a></p>\n\n<p>by following links in the document:</p>\n\n<blockquote>\n  <p>A client sending a CONNECT request MUST send the authority form of\n     request-target (Section 5.3 of [RFC7230]); i.e., the request-target\n     consists of only the host name and port number of the tunnel\n     destination, separated by a colon.  For example,</p>\n\n<pre><code>CONNECT server.example.com:80 HTTP/1.1\n Host: server.example.com:80\n</code></pre>\n</blockquote>\n\n<p>source: <a href=\"https://tools.ietf.org/html/rfc7231#section-4.3.6\" rel=\"nofollow\">https://tools.ietf.org/html/rfc7231#section-4.3.6</a></p>\n"}], "owner": {"reputation": 1, "user_id": 5704726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb0572c4f8b4f4be6edd1ba37a77622?s=128&d=identicon&r=PG&f=1", "display_name": "jmp1212", "link": "https://stackoverflow.com/users/5704726/jmp1212"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450910017, "creation_date": 1450906183, "last_edit_date": 1450906765, "question_id": 34444017, "link": "https://stackoverflow.com/questions/34444017/http-errors-while-making-a-request-through-a-proxy", "title": "HTTP errors while making a request through a proxy", "body": "<p>I want to know how to make an HTTP request through a proxy using Socket.</p>\n\n<p>I was looking through documentation on Internet, and many people said that to do it I must connect to the proxy server and send a packet with the following header:</p>\n\n<pre><code>send(Socket, \"CONNECT http://icanhazip.com:80 HTTP/1.0\\r\\n\\r\\n\", strlen(\"CONNECT http://icanhazip.com:80 HTTP/1.0\\r\\n\\r\\n\"), 0);\n</code></pre>\n\n<p>That website returns the current public IP, but, unfortunately, every proxy server I tried returned errors instead of the webpage's HTML source.</p>\n\n<p>This is my actual code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main()\n{\n    try {\n\n        int Socket = socket(AF_INET, SOCK_STREAM, 0);\n\n        sockaddr_in SockAddr;\n        memset(&amp;SockAddr, 0, sizeof(SockAddr));\n        SockAddr.sin_port = htons(80);\n        SockAddr.sin_family = AF_INET;\n        SockAddr.sin_addr.s_addr = inet_addr(\"198.169.246.30\");\n\n        int iResult = connect(Socket, (struct sockaddr *)&amp; SockAddr, sizeof(SockAddr));\n        if (iResult != 0) {\n            std::cout &lt;&lt; \"I can't connect :(.\";\n            getchar();\n            return 1;\n        }\n        std::cout &lt;&lt; \"Connected.\\n\";\nsend(Socket, \"CONNECT http://icanhazip.com:80 HTTP/1.1\\r\\n\\r\\n\", strlen(\"CONNECT http://icanhazip.com:80 HTTP/1.1\\r\\n\\r\\n\"), 0);\n\n char buffer[10000];\n        int nDataLength;\n        while ((nDataLength = recv(Socket, buffer, 10000, 0)) &gt; 0) {\n            int i = 0;\n            while (buffer[i] &gt;= 32 || buffer[i] == '\\n' || buffer[i] == '\\r') {\n                std::cout &lt;&lt; buffer[i];\n                i += 1;\n            }\n        }\n        iResult = close(Socket);\n    }\n    catch (...) {\n\n    }\n    return 0;\n}\n</code></pre>\n\n<p>What can I do to fix it? Or, what other solution should I look into?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1592, "user_id": 618951, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b867e8993ce4bf8205315e4a2e45e418?s=128&d=identicon&r=PG", "display_name": "RisingSun", "link": "https://stackoverflow.com/users/618951/risingsun"}, "edited": false, "score": 0, "creation_date": 1450906721, "post_id": 34444015, "comment_id": 56629954, "body": "What do you mean it broke? What is it doing? Does it give you any error messages? If so, post it here. With just your code and a claim that says something is broke will not help us help you."}, {"owner": {"reputation": 5, "user_id": 5712643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0434f7248bb54e05df06192f66d59b11?s=128&d=identicon&r=PG&f=1", "display_name": "frodo12311", "link": "https://stackoverflow.com/users/5712643/frodo12311"}, "reply_to_user": {"reputation": 1592, "user_id": 618951, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b867e8993ce4bf8205315e4a2e45e418?s=128&d=identicon&r=PG", "display_name": "RisingSun", "link": "https://stackoverflow.com/users/618951/risingsun"}, "edited": false, "score": 0, "creation_date": 1450908022, "post_id": 34444015, "comment_id": 56630537, "body": "Sorry about the lack of clarity will be more clear next time."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5712643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0434f7248bb54e05df06192f66d59b11?s=128&d=identicon&r=PG&f=1", "display_name": "frodo12311", "link": "https://stackoverflow.com/users/5712643/frodo12311"}, "edited": false, "score": 0, "creation_date": 1450907985, "post_id": 34444054, "comment_id": 56630522, "body": "Thank you for the help, did not see that ; . It works great now."}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "reply_to_user": {"reputation": 5, "user_id": 5712643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0434f7248bb54e05df06192f66d59b11?s=128&d=identicon&r=PG&f=1", "display_name": "frodo12311", "link": "https://stackoverflow.com/users/5712643/frodo12311"}, "edited": false, "score": 0, "creation_date": 1450908301, "post_id": 34444054, "comment_id": 56630664, "body": "@frodo12311 Then, as soon as your able to, accept an answer to mark this problem as solved and to give me some rep."}, {"owner": {"reputation": 5, "user_id": 5712643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0434f7248bb54e05df06192f66d59b11?s=128&d=identicon&r=PG&f=1", "display_name": "frodo12311", "link": "https://stackoverflow.com/users/5712643/frodo12311"}, "edited": false, "score": 0, "creation_date": 1451344030, "post_id": 34444054, "comment_id": 56746085, "body": "Really new to using any kind of forum, how do I do that?"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "reply_to_user": {"reputation": 5, "user_id": 5712643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0434f7248bb54e05df06192f66d59b11?s=128&d=identicon&r=PG&f=1", "display_name": "frodo12311", "link": "https://stackoverflow.com/users/5712643/frodo12311"}, "edited": false, "score": 0, "creation_date": 1451344197, "post_id": 34444054, "comment_id": 56746139, "body": "@frodo12311 There is a tick under the vote count of the answers. Click on the one of the answer you want to accept and it should turn green."}, {"owner": {"reputation": 5, "user_id": 5712643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0434f7248bb54e05df06192f66d59b11?s=128&d=identicon&r=PG&f=1", "display_name": "frodo12311", "link": "https://stackoverflow.com/users/5712643/frodo12311"}, "edited": false, "score": 0, "creation_date": 1451344261, "post_id": 34444054, "comment_id": 56746159, "body": "Awesome, Thank you again."}], "tags": [], "owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "is_accepted": true, "score": 4, "last_activity_date": 1450906357, "creation_date": 1450906357, "answer_id": 34444054, "question_id": 34444015, "link": "https://stackoverflow.com/questions/34444015/while-statement-breaking-loop/34444054#34444054", "title": "while Statement breaking loop", "body": "<p>Remove the semicolon after the <code>while</code> condition of the first loop. Only full statements are terminated by a <code>;</code>.</p>\n\n<hr>\n\n<p>Notes:</p>\n\n<ul>\n<li>Since C++11, better facilities for random number generation are provided in the <code>&lt;random&gt;</code> header. Use these!</li>\n</ul>\n"}], "owner": {"reputation": 5, "user_id": 5712643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0434f7248bb54e05df06192f66d59b11?s=128&d=identicon&r=PG&f=1", "display_name": "frodo12311", "link": "https://stackoverflow.com/users/5712643/frodo12311"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 34444054, "answer_count": 1, "score": 0, "last_activity_date": 1450906357, "creation_date": 1450906173, "question_id": 34444015, "link": "https://stackoverflow.com/questions/34444015/while-statement-breaking-loop", "title": "while Statement breaking loop", "body": "<p>I added a while statement around my code so that the user could repeat the process as my teacher instructed, the way I did it worked on other code but for some reason it broke this one I could use help making it work please and thank you. The point of the code is to just flip 10000 coins and output the number of heads and tails. Thanks for any and all help.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;ctime&gt;\n#include &lt;cstdlib&gt;\n#include &lt;string&gt;\nusing namespace std;\n\n// Keaton Graffis 12/22/2012\n\nint coin()\n{\n    int flip;\n    // assign random numbers\n    flip = rand() % 2 + 1;\n\n    return (flip);\n}\n\nint main()\n{\n    char choice = 'y';\n    while (choice == 'y' || choice == 'Y');\n    {\n        double numFlips = 10000;\n        int count, face, heads = 0, tails = 0;\n\n        // initialize the random number generator\n        srand(static_cast&lt;int&gt;(time(0)));\n\n        // generate and count the number of heads and tails\n        for (int count = 1; count &lt;= numFlips; count++)\n        {\n            face = coin();\n            if (face == 1)\n                heads++;\n            else\n                tails++;\n\n        }\n\n        cout &lt;&lt; \"The number flips: \" &lt;&lt; numFlips &lt;&lt; endl;\n        cout &lt;&lt; \"The number of heads: \" &lt;&lt; heads &lt;&lt; endl;\n        cout &lt;&lt; \"The number of tails: \" &lt;&lt; tails &lt;&lt; endl;\n\n        // Asks user if they would like to go again(makes cod enot run, not sure why, this works on all my other code)\n        while (1)\n        {\n            cout &lt;&lt; \"Would you like to play again [Y]es or [N]o?\\n\";\n            cin &gt;&gt; choice;\n            if (choice == 'y' || choice == 'Y' || choice == 'n' || choice == 'N')\n                break;\n        }\n    }\n}  \n</code></pre>\n"}, {"tags": ["python", "c++", "serial-port"], "owner": {"reputation": 11, "user_id": 5712622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c35add66dd247f0a8c74317be1f9c6b?s=128&d=identicon&r=PG&f=1", "display_name": "cracken", "link": "https://stackoverflow.com/users/5712622/cracken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450906125, "creation_date": 1450906125, "question_id": 34444005, "link": "https://stackoverflow.com/questions/34444005/file-reading-serial-communication-issue", "title": "File reading /Serial communication issue", "body": "<p>i have 2 programs, one reading data, and putting it into a file, the other reads that file and sends the data via serial.\nboth program runs parallel, and both of them is an infinite loop with a 200ms delay.\nthey puts/reads  7 characters in/from the file (6, but \" \" does not count).</p>\n\n<p>the one which write the file works good, but the sender gets really slow after the 165th loop. always at 165, it only sends one character/second, so it takes the program 6 seconds to send the array.</p>\n\n<p>this is in the file:</p>\n\n<pre><code>s5 1038\n</code></pre>\n\n<ol>\n<li>an 's' character, it has a function.</li>\n<li><p>then one number from 1-9.</p>\n\n<p>3-4-5-6-7 space (\" \") which c filereader dont count, then 4 number, 0000-9999.</p></li>\n</ol>\n\n<p>the file always have only one line.</p>\n\n<p>the senders loop:</p>\n\n<pre><code>while(SP-&gt;IsConnected()) //see if the usb connection is on.\n    {\n        fstream file;\n        file.open(\"c:/Python27/beki.txt\");\n        for(int i=0;i&lt;6;i++)\n        {\n            file &gt;&gt; incomingData[i];  //puts the read data from the file into an array, i did this but now i  dont know how this works, but it works.\n            cout &lt;&lt; incomingData[i];\n        }\n        file.close();\n        cout &lt;&lt;szam &lt;&lt; \"\\n\";\n        SP-&gt;WriteData(incomingData,dataLength);\n\n        szam++; //counting, thats why i know its always slows at 166.\n        Sleep(200);\n\n    }\n</code></pre>\n\n<p>it did the same in python. dont know if there's a limit or something. please help.</p>\n"}, {"tags": ["c++", "animation", "wallpaper", "kde"], "owner": {"reputation": 31, "user_id": 5712578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b05619d5f4315b7b5c641c5df1a3fd?s=128&d=identicon&r=PG&f=1", "display_name": "Unclechromedome", "link": "https://stackoverflow.com/users/5712578/unclechromedome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450905224, "creation_date": 1450905224, "question_id": 34443819, "link": "https://stackoverflow.com/questions/34443819/how-do-i-keep-my-own-animated-kde-wallpapers-from-running-together", "title": "How do I keep my own animated KDE wallpapers from running together?", "body": "<p>I recently tried writing animated wallpaper plugins for KDE4. When I switch among them, the animations get jumbled. That is, the previous animation doesn't stop, and the previous frames and the current frames get mixed together. I embed the frames into each program as image resources. Then I write code like the following for each wallpaper. Can anyone tell me what I'm missing (or if it's just a KDE bug)?</p>\n\n<p>dancingcoffee.h</p>\n\n<pre><code>#ifndef DANCINGCOFFEE_H\n#define DANCINGCOFFEE_H\n\n#include &lt;Plasma/Wallpaper&gt;\n#include &lt;QPainter&gt;\n#include &lt;QTimer&gt;\n\nclass DancingCoffee : public Plasma::Wallpaper\n{\n    Q_OBJECT\npublic:\n    DancingCoffee(QObject *parent, const QVariantList&amp; args);\n    void paint(QPainter *painter, const QRectF &amp;exposedRect);\n\nprivate slots:\n    void updateBackground();\n\n    private:\n    const int m_frames;\n    const int m_interval;\n\n    int m_frame_number;\n    QTimer m_timer;\n};\n\n#endif // DANCINGCOFFEE_H\n</code></pre>\n\n<p>dancingcoffee.cpp</p>\n\n<pre><code>#include \"dancingcoffee.h\"\n#include &lt;QImage&gt;\n\nK_EXPORT_PLASMA_WALLPAPER(coffee, DancingCoffee)\n\nDancingCoffee::DancingCoffee(QObject *parent, const QVariantList &amp;args) :\n    Plasma::Wallpaper(parent, args),\n    m_frames(2),\n    m_interval(1000 / m_frames)\n{\n    m_frame_number = 0;\n\n    m_timer.setSingleShot(true);\n    connect(&amp;m_timer, SIGNAL(timeout()), this, SLOT(updateBackground()));\n    m_timer.start(m_interval);\n}\n\nvoid DancingCoffee::paint(QPainter *painter, const QRectF &amp;exposedRect)\n{\n    QString name = QString(\":/images/frame-%1.png\").arg(m_frame_number);\n    QImage image(name);\n    painter-&gt;drawImage(exposedRect, image);\n}\n\nvoid DancingCoffee::updateBackground()\n{\n    ++m_frame_number;\n    m_frame_number %= m_frames;\n    m_timer.start(m_interval);\n    emit update(boundingRect());\n}\n</code></pre>\n\n<p>CMakeLists.txt</p>\n\n<pre><code>set(CMAKE_INSTALL_PREFIX /usr)\n\nproject(plasma-wallpaper-coffee)\ncmake_minimum_required(VERSION 2.8)\n\nfind_package(KDE4 REQUIRED)\nfind_package(KDE4Workspace REQUIRED)\ninclude(KDE4Defaults)\n\nadd_definitions(${KDE4_DEFINITIONS})\ninclude_directories(${CMAKE_SOURCE_DIR} ${CMAKE_BINARY_DIR} ${KDE4_INCLUDES})\n\nset(TARGET plasma_wallpaper_coffee)\nset(SRC_LIST dancingcoffee.cpp)\nqt4_add_resources(RCC_LIST dancingcoffee.qrc)\n\nkde4_add_plugin(${TARGET} ${SRC_LIST} ${RCC_LIST})\ntarget_link_libraries(${TARGET} ${KDE4_PLASMA_LIBS})\n\ninstall(TARGETS ${TARGET} DESTINATION ${PLUGIN_INSTALL_DIR})\ninstall(FILES plasma-wallpaper-coffee.desktop DESTINATION ${SERVICES_INSTALL_DIR})\n</code></pre>\n\n<p>plasma-wallpaper-coffee.desktop</p>\n\n<pre><code>[Desktop Entry]\nName=Coffee\nType=Service\nIcon=image-jpeg\nServiceTypes=Plasma/Wallpaper\n\nX-KDE-Library=plasma_wallpaper_coffee\nX-KDE-PluginInfo-Author=Chris French\nX-KDE-PluginInfo-Email=unclechromedome@gmail.com\nX-KDE-PluginInfo-Name=coffee\nX-KDE-PluginInfo-Version=0.1\nX-KDE-PluginInfo-Website=\nX-KDE-PluginInfo-Depends=\nX-KDE-PluginInfo-License=GPL\nX-KDE-PluginInfo-EnabledByDefault=true\n</code></pre>\n\n<p>And voila! Animated wallpaper on my desktop. But the wallpapers don't play well together. I have to kill the desktop and restart it when I switch wallpapers, and sometimes that doesn't even work. Sometimes I have to do a hard reboot. It's a pain for me, and unacceptable if I ever distribute the wallpapers.</p>\n"}, {"tags": ["c++", "templates", "boost"], "answers": [{"tags": [], "owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "is_accepted": true, "score": 2, "last_activity_date": 1450905846, "creation_date": 1450905846, "answer_id": 34443942, "question_id": 34443818, "link": "https://stackoverflow.com/questions/34443818/bgl-iteration-makros-typenames-and-templates/34443942#34443942", "title": "BGL iteration makros, typenames and templates", "body": "<p>With C++03 the <code>typename</code> keyword was allowed exactly where it was required. That is, if a dependent name referred to a type, it was necessary. If a type was not a dependent name, it was disallowed. Hence, depending on whether your are within a template or not, it may be allowed and required or not required and not allowed.</p>\n\n<p>With C++11 the <code>typename</code> keyword is always allowed when referring to a nested type, i.e., with C++11 there is no longer any need for two versions and the <code>_T</code>-version is sufficient.</p>\n"}], "owner": {"reputation": 6181, "user_id": 3322533, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/cbbd1b40887d19bc0c8fdd5ef42a05ed?s=128&d=identicon&r=PG", "display_name": "User1291", "link": "https://stackoverflow.com/users/3322533/user1291"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 34443942, "answer_count": 1, "score": 1, "last_activity_date": 1450905846, "creation_date": 1450905206, "question_id": 34443818, "link": "https://stackoverflow.com/questions/34443818/bgl-iteration-makros-typenames-and-templates", "title": "BGL iteration makros, typenames and templates", "body": "<p>In the bgl <a href=\"http://www.boost.org/doc/libs/1_59_0/boost/graph/iteration_macros.hpp\" rel=\"nofollow\">iteration_makros.hpp</a>, it says</p>\n\n<blockquote>\n  <p>Use the _T versions when the graph type is a template parameter or\n    dependent on a template parameter. Otherwise use the non _T versions.</p>\n</blockquote>\n\n<p>e.g:</p>\n\n<pre><code>#define BGL_FORALL_EDGES_T(ENAME, GNAME, GraphType) \\\nfor (std::pair&lt;typename boost::graph_traits&lt;GraphType&gt;::edge_iterator, \\\n               typename boost::graph_traits&lt;GraphType&gt;::edge_iterator&gt; BGL_RANGE(__LINE__) = edges(GNAME); \\\n  BGL_FIRST(__LINE__) != BGL_LAST(__LINE__); BGL_FIRST(__LINE__) = BGL_LAST(__LINE__)) \\\n  for (typename boost::graph_traits&lt;GraphType&gt;::edge_descriptor ENAME; \\\n    BGL_FIRST(__LINE__) != BGL_LAST(__LINE__) ? (ENAME = *BGL_FIRST(__LINE__), true):false; \\\n     ++BGL_FIRST(__LINE__))\n</code></pre>\n\n<p>vs.</p>\n\n<pre><code>#define BGL_FORALL_EDGES(ENAME, GNAME, GraphType) \\\nfor (std::pair&lt;boost::graph_traits&lt;GraphType&gt;::edge_iterator, \\\n               boost::graph_traits&lt;GraphType&gt;::edge_iterator&gt; BGL_RANGE(__LINE__) = edges(GNAME); \\\n  BGL_FIRST(__LINE__) != BGL_LAST(__LINE__); BGL_FIRST(__LINE__) = BGL_LAST(__LINE__)) \\\n  for (boost::graph_traits&lt;GraphType&gt;::edge_descriptor ENAME; \\\n     BGL_FIRST(__LINE__) != BGL_LAST(__LINE__) ? (ENAME = *BGL_FIRST(__LINE__), true):false; \\\n     ++BGL_FIRST(__LINE__))\n</code></pre>\n\n<p>The only difference I see - and stackoverflow is kind enough to highlight this in the code - are the <code>typename</code> modifiers in the _T versions.</p>\n\n<p>Now, I'm not terribly savvy about this whole typename and template thing, but why provide two versions at all? Why wouldn't the _T versions suffice? Could anybody give me an example where I cannot use the _T versions?</p>\n\n<p>Or if there is no such example, what's the reasoning behind this?</p>\n\n<p>On a related note, does using BGL's bundled properties count as the Graph's being \"dependent on a template parameter\"?</p>\n"}, {"tags": ["c++", "templates", "c++11"], "answers": [{"tags": [], "owner": {"reputation": 8744, "user_id": 4326278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/FzH4Z.png?s=128&g=1", "display_name": "bogdan", "link": "https://stackoverflow.com/users/4326278/bogdan"}, "is_accepted": true, "score": 4, "last_activity_date": 1450905421, "creation_date": 1450905421, "answer_id": 34443851, "question_id": 34443542, "link": "https://stackoverflow.com/questions/34443542/private-base-class-affects-member-access-via-template-friend-function-and-templa/34443851#34443851", "title": "Private base class affects member access via template friend function and template method in child class", "body": "<p>Name lookup is done before access checking. Unqualified name lookup for <code>PrivateBase</code> within a member function of <code>Child</code> finds the <a href=\"http://en.cppreference.com/w/cpp/language/unqualified_lookup#Injected_class_name\" rel=\"nofollow\"><em>injected class name</em></a> of the <code>PrivateBase</code> base class, which is then found to be private, hence the error.</p>\n\n<p>Using something like <code>GetPrivateBase&lt;::PrivateBase&gt;();</code> inside <code>SomeFunc()</code> fixes the problem, because qualified name lookup now finds <code>PrivateBase</code> as a member of the global namespace, where it is accessible.</p>\n\n<p>This is also why the calls in <code>main</code> work: <code>main</code> is not a member function, so unqualified name lookup for <code>PrivateBase</code> finds the namespace member.</p>\n"}], "owner": {"reputation": 43, "user_id": 1280653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fa89e96d58a1da2fa3f2095c098d068?s=128&d=identicon&r=PG", "display_name": "ignatz", "link": "https://stackoverflow.com/users/1280653/ignatz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 34443851, "answer_count": 1, "score": 3, "last_activity_date": 1450906730, "creation_date": 1450903920, "last_edit_date": 1450906730, "question_id": 34443542, "link": "https://stackoverflow.com/questions/34443542/private-base-class-affects-member-access-via-template-friend-function-and-templa", "title": "Private base class affects member access via template friend function and template method in child class", "body": "<p>First of all, sorry for the lengthy title. I encountered an issue, where the existence of a private base of the same type as a member shadows access to the member in a child class but not outside the child class definition. Look at the following code:</p>\n\n<pre><code> struct PrivateBase {};\n\n struct Base : private PrivateBase {\n   // Member accessors.\n   PrivateBase* GetPrivateBase() { return &amp;a; }\n\n   template&lt;typename T&gt;\n   T* GetPrivateBase() { return &amp;a; }\n\n   // Free function accessors.\n   friend PrivateBase* FreeGetPrivateBase(Base* b) { return &amp;(b-&gt;a); }\n\n   template&lt;typename T&gt;\n   friend T* FreeGetPrivateBase(Base* b);\n\n  private:\n   // This member has nothing to do with the PrivateBase base class.\n   PrivateBase a;\n };\n\n template&lt;typename T&gt;\n T* FreeGetPrivateBase(Base* b) { return &amp;(b-&gt;a); }\n\n struct Child : public Base {\n   void SomeFunc() {\n     // Works!1!!.\n     GetPrivateBase();\n\n     // Doesn't work.\n     //GetPrivateBase&lt;PrivateBase&gt;(); // (1)\n\n     // Works!1!!.\n     FreeGetPrivateBase(this);\n\n     // Doesn't work.\n     //FreeGetPrivateBase&lt;PrivateBase&gt;(this);\n   }\n };\n\n int main() {\n   Child c;\n\n   // Works!1!!.\n   c.GetPrivateBase&lt;PrivateBase&gt;();\n\n   // Works!1!!.\n   FreeGetPrivateBase&lt;PrivateBase&gt;(&amp;c);\n\n   return 0;\n }\n</code></pre>\n\n<p>I've tried to compile this both, with g++-4.8.4 and clang++-3.7.1. With clang and (1) uncommented I get:</p>\n\n<pre><code>minimal.cc:30:20: error: 'PrivateBase' is a private member of 'PrivateBase'\n    GetPrivateBase&lt;PrivateBase&gt;();\n                   ^\nminimal.cc:3:15: note: constrained by private inheritance here\nstruct Base : private PrivateBase {\n              ^~~~~~~~~~~~~~~~~~~\nminimal.cc:1:8: note: member is declared here\nstruct PrivateBase {};\n       ^\n</code></pre>\n\n<p>The fun fact is that access to <code>a</code> works outside of Child and inside Child with the non-templated accessors. It also works inside Child with the templated accessors if I get rid of the private base class.\nI would love to blame it on the compiler but unconventionally enough both contenders seem to agree. Could anybody explain the interplay between templated accessors, child scope and private base class? - Thanks.</p>\n"}, {"tags": ["c++", "visual-studio-2013"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1450903969, "post_id": 34443479, "comment_id": 56628786, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 140, "user_id": 5027575, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-iXvfesVuiiQ/AAAAAAAAAAI/AAAAAAAAAEk/pYZUEqrANbk/photo.jpg?sz=128", "display_name": "Pouyan Khodabakhsh", "link": "https://stackoverflow.com/users/5027575/pouyan-khodabakhsh"}, "is_accepted": true, "score": 0, "last_activity_date": 1450964737, "last_edit_date": 1450964737, "creation_date": 1450904113, "answer_id": 34443579, "question_id": 34443479, "link": "https://stackoverflow.com/questions/34443479/in-search-of-libraries-for-visual-studios-2013-where-how-to-obtain/34443579#34443579", "title": "in search of libraries for visual studios 2013, where &amp; how to obtain", "body": "<p>For starting the development process using libraries like OpenCV or OpenGL,you need to install some packages and do a bunch of configurations on your Visual Studio.From <a href=\"http://sourceforge.net/projects/opencvlibrary/files/opencv-win/3.1.0/opencv-3.1.0.exe/download\" rel=\"nofollow\">here</a> you can download the missing packages for windows,you can also have a <a href=\"http://opencv.org/quickstart.html\" rel=\"nofollow\">Quick start</a> on the website which will get you on the path for beginning,to be more specific <a href=\"http://docs.opencv.org/2.4/doc/tutorials/introduction/windows_visual_studio_Opencv/windows_visual_studio_Opencv.html\" rel=\"nofollow\">here</a> is a complete guide of building OpenCV apps inside Visual Studio</p>\n"}], "owner": {"reputation": 17, "user_id": 4447382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lDFvg.png?s=128&g=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/4447382/frank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 34443579, "answer_count": 1, "score": -8, "last_activity_date": 1450964737, "creation_date": 1450903675, "last_edit_date": 1450906667, "question_id": 34443479, "link": "https://stackoverflow.com/questions/34443479/in-search-of-libraries-for-visual-studios-2013-where-how-to-obtain", "title": "in search of libraries for visual studios 2013, where &amp; how to obtain", "body": "<p>i have found some source file online and the individual responsible for it hasn't reply back, i need to know how does one go about finding this particular libraries if one was to need in the near future? </p>\n\n<p>in processing its easy you just go to the library download manager and type the name of that library.</p>\n\n<p>is there a way to do this in Visual studios? </p>\n\n<p>below you can see what i think i need to fix my issue.</p>\n\n<pre><code>#include&lt;opencv/cvaux.h&gt;// in need of it \n#include&lt;opencv/cxcore.h&gt;//in need of it \n</code></pre>\n\n<p>this is why i think i need those files above, </p>\n\n<blockquote>\n  <p>ERRORS:\n  Error 4   error LNK2019: unresolved external symbol cvReleaseMemStorage\n  referenced in function\n  main  </p>\n  \n  <p>Error 2   error LNK2019: unresolved external symbol cvInRangeS\n  referenced in function\n  main  </p>\n  \n  <p>Error 5   error LNK2019: unresolved external symbol cvGetSeqElem\n  referenced in function\n  main  </p>\n  \n  <p>Error 3   error LNK2019: unresolved external symbol cvCreateMemStorage\n  referenced in function\n  main  </p>\n  \n  <p>Error 1   error LNK2019: unresolved external symbol cvCreateImage\n  referenced in function\n  main  </p>\n  \n  <p>Error 6   error LNK2019: unresolved external symbol cvCircle referenced\n  in function\n  main  </p>\n  \n  <p>Error 7   error LNK1120: 6 unresolved\n  externals </p>\n</blockquote>\n\n<pre><code>1&gt;Source.obj : error LNK2019: unresolved external symbol cvCreateMemStorage referenced in function main\n1&gt;Source.obj : error LNK2019: unresolved external symbol cvReleaseMemStorage referenced in function main\n1&gt;Source.obj : error LNK2019: unresolved external symbol cvGetSeqElem referenced in function main\n1&gt;Source.obj : error LNK2019: unresolved external symbol cvCircle referenced in function main\n</code></pre>\n\n<p>the funny thing is that there's no squiggly red lines in the code telling me that this! is whats wrong, this is why im guessing that the problem is cuz of the lacking of those files.</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1450903786, "post_id": 34443476, "comment_id": 56628709, "body": "Can you just make the function templated, so you can specialize for the types you want?"}, {"owner": {"reputation": 21, "user_id": 5363870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/527c9340446c64c252747c1cc7fc2d37?s=128&d=identicon&r=PG&f=1", "display_name": "Fran&#231;ois Lamirande", "link": "https://stackoverflow.com/users/5363870/fran%c3%a7ois-lamirande"}, "reply_to_user": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1450904087, "post_id": 34443476, "comment_id": 56628834, "body": "@Ben I don&#39;t think so. The function should do completely different things dependent on the type, so it would need to branch dependent on the template parameter, which I don&#39;t think is possible."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1450904150, "post_id": 34443476, "comment_id": 56628860, "body": "dynamic_cast is for polymorphism. I don&#39;t think I understand what you try to achieve, so it may or may not help you."}, {"owner": {"reputation": 13936, "user_id": 3598119, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/6c9c7dfa28a57e8011d12208a7c86d20?s=128&d=identicon&r=PG", "display_name": "Chris Beck", "link": "https://stackoverflow.com/users/3598119/chris-beck"}, "edited": false, "score": 0, "creation_date": 1450904179, "post_id": 34443476, "comment_id": 56628874, "body": "Here are my thoughts -- if you want to have a generic &quot;get_value()&quot; member function that you access from a pointer to the base, you could make it virtual and then override it in each of the derived instances. But then, it has to return a single fixed type for each version. So I think you are running up against an inherent limitation of C++, when you expose an API say via a base class, each function MUST have a known-at-compile-time type. My advice is, if you want to do compile-time polymorphism then do that and skip the base class. If you must have a base class then rethink approach."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1450904693, "post_id": 34443476, "comment_id": 56629106, "body": "In C++ we have <i>class templates</i>, not &quot;template classes&quot;. Class templates are not classes. <code>NumberNode</code> is a class template. <code>NumberNode&lt;int&gt;</code> is a class. <code>NumberNode&lt;float&gt;</code> is a completely different class. There is no such thing as <code>NumberNode*</code> because <code>NumberNode</code> is not a class."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1450906283, "post_id": 34443476, "comment_id": 56629746, "body": "Also, the standard prototype for <code>main</code> is <code>int main()</code> or <code>int main(int, char**)</code>."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1450922999, "post_id": 34443476, "comment_id": 56634780, "body": "@ n.m. I&#39;ve heard template class used to denote specific instantiations of class template."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1450934687, "post_id": 34443476, "comment_id": 56637291, "body": "@NirFriedman Yes, sometimes. I think it&#39;s a bit of a sloppy language. The standard mentions a &quot;template class&quot; once, probably by mistake. There are several mentions of &quot;non-template class&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1450905650, "creation_date": 1450905650, "answer_id": 34443901, "question_id": 34443476, "link": "https://stackoverflow.com/questions/34443476/how-to-use-a-pointer-to-a-generic-template-class-to-access-a-member-function-tha/34443901#34443901", "title": "How to use a pointer to a generic template class to access a member function that depends on the template parameter type", "body": "<p>This is the right thing to do:</p>\n\n<pre><code>class Node \n{\n public:\n  virtual void foo() = 0;\n};\n</code></pre>\n\n<p>Your loop becomes</p>\n\n<pre><code>for( Node* ptr_node : nodes )\n{\n    ptr_node-&gt;foo();\n}\n</code></pre>\n\n<p><code>foo</code> can be implemented in <code>NumberNode</code> like this:</p>\n\n<pre><code>template &lt;typename Type&gt; \nvoid NumberNode::foo() \n{\n  ::foo(_value);\n}\n</code></pre>\n\n<p>Perhaps <code>getValue()</code> is no longer needed with this design and you can get rid of it. It's a good thing. Getters are manifestations of a weak design. Objects should <em>do</em> stuff, not <em>have</em> stuff.</p>\n\n<p>If you don't want to have <code>foo</code> in <code>Node</code> for some reason (perhaps you have too many functions like <code>foo</code> and don't want to pollute the interface), the alternative approach is to implement the <em><a href=\"https://en.wikipedia.org/wiki/Visitor_pattern\" rel=\"nofollow\">VISITOR pattern</a></em> for <code>Node</code>. However Visitor has its own downsides, so I would only recommend using it as a last resort in this case.</p>\n"}], "owner": {"reputation": 21, "user_id": 5363870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/527c9340446c64c252747c1cc7fc2d37?s=128&d=identicon&r=PG&f=1", "display_name": "Fran&#231;ois Lamirande", "link": "https://stackoverflow.com/users/5363870/fran%c3%a7ois-lamirande"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1450905650, "creation_date": 1450903670, "last_edit_date": 1450903789, "question_id": 34443476, "link": "https://stackoverflow.com/questions/34443476/how-to-use-a-pointer-to-a-generic-template-class-to-access-a-member-function-tha", "title": "How to use a pointer to a generic template class to access a member function that depends on the template parameter type", "body": "<p>Is there a way to have a pointer to a generic template class and call a function whose return value depends on the template parameter? Here's what I'm trying to do:</p>\n\n<pre><code>class Node{...}\n\ntemplate &lt; typename Type &gt; class NumberNode : public Node\n{\n    public:\n        NumberNode( Type value ) : _value( value ) { }\n\n        Type getValue() { return _value; }\n\n    private:\n        Type _value;\n}\n\nvoid foo( int x )    { /* do something */ }\nvoid foo( float x )  { /* do something else */ }\n\nvoid main(...)\n{\n    std::vector&lt; Node* &gt; nodes;\n\n    nodes.push_back( new NumberNode&lt; int &gt;( 1 ) );\n    nodes.push_back( new NumberNode&lt; float &gt;( 1.f ) );\n\n    for( Node* ptr_node : nodes )\n    {\n        foo( static_cast&lt; NumberNode* &gt;( ptr_node )-&gt;getValue() );\n    }\n}\n</code></pre>\n\n<p>I can't do this because the <code>static_cast( Derived* )</code> should know the full template type, which varies. I can't have <code>Base</code> be a template type either, for other classes also derive from it. Does anyone know of a workaround?</p>\n"}, {"tags": ["c++", "c++builder", "c++builder-6"], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1450912255, "last_edit_date": 1450912255, "creation_date": 1450911796, "answer_id": 34445029, "question_id": 34443446, "link": "https://stackoverflow.com/questions/34443446/deleting-dynamically-created-control-borland-6-c-builder/34445029#34445029", "title": "Deleting dynamically created control borland 6 c++ builder", "body": "<p>There are two bugs in your code.</p>\n\n<ol>\n<li><p>the global <code>Form1</code> variable has not been assigned yet when the <code>TForm1</code> constructor is called, so your <code>Form1-&gt;InsertControl(but)</code> statement is invalid and likely to crash.  Use <code>this-&gt;</code> instead of <code>Form1-&gt;</code>.  However, you are not suppossed to call <code>InsertControl()</code> directly, set the button's <code>Parent</code> property instead:</p>\n\n<pre><code>but-&gt;Parent = this;\n</code></pre></li>\n<li><p>It is not safe to <code>delete</code> the <code>Sender</code> of an event while the event handler is running.  The RTL still needs access to the object after the handler has exited (as evident by your AccessViolation error).  You will have to delay the <code>delete</code>, such as with a short timer:</p>\n\n<pre><code>void __fastcall TForm1::DeleteButtonTimerElapsed(TObject *Sender)\n{\n    TObject *obj = reinterpret_cast&lt;TObject*&gt;(DeleteButtonTimer-&gt;Tag);\n    DeleteButtonTimer-&gt;Tag = 0;\n    DeleteButtonTimer-&gt;Enabled = false;\n    delete obj;\n}\n\nvoid __fastcall TForm1::click(TObject *Sender)\n{\n    DeleteButtonTimer-&gt;Tag = reinterpret_cast&lt;int&gt;(Sender);\n    DeleteButtonTimer-&gt;Enabled = true;\n}\n</code></pre>\n\n<p>Or post a custom message to yourself using <code>PostMessage()</code> (I prefer this approach):</p>\n\n<pre><code>#define WM_DELETE_OBJECT (WM_USER + 1)\n\nvoid __fastcall TForm1::WndProc(TMessage &amp;Message)\n{\n    if (Message.Msg == WM_DELETE_OBJECT)\n        delete reinterpret_cast&lt;TObject*&gt;(Message.LParam);\n    else\n        TForm::WndProc(Message);\n}\n\nvoid __fastcall TForm1::click(TObject *Sender)\n{\n    TButton *btn = static_cast&lt;TButton*&gt;(Sender);\n    btn-&gt;OnClick = NULL;\n    PostMessage(Handle, WM_DELETE_OBJECT, 0, reinterpret_cast&lt;LPARAM&gt;(Sender));\n}\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 3, "user_id": 5712539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15dff45d4f8d66e9edc2fe7c6f4254ad?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Marchenko", "link": "https://stackoverflow.com/users/5712539/ilya-marchenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1196, "favorite_count": 0, "accepted_answer_id": 34445029, "answer_count": 1, "score": 0, "last_activity_date": 1450912255, "creation_date": 1450903544, "last_edit_date": 1450911406, "question_id": 34443446, "link": "https://stackoverflow.com/questions/34443446/deleting-dynamically-created-control-borland-6-c-builder", "title": "Deleting dynamically created control borland 6 c++ builder", "body": "<p>I have a problem deleting a dynamically created button in Borland C++Builder 6.</p>\n\n<pre><code>__fastcall TForm1::TForm1(TComponent* Owner)\n    : TForm(Owner) {\n  TButton *but = new TButton(this);\n  but-&gt;Left = 100;\n  but-&gt;Top = 100;\n  but-&gt;OnClick = click;\n  Form1-&gt;InsertControl(but);\n}\n\nvoid __fastcall TForm1::click(TObject *Sender) {\n    delete Sender;\n}\n</code></pre>\n\n<p>When I click on a created button the error \"Access violation at address 40005905 in module 'rtl60.bpl', read of address 00000018\" appears</p>\n\n<p>I know its wrong to assign a method to button that delets it, but I really need deleting button by pressing on it</p>\n"}, {"tags": ["c++", "visual-studio-2015"], "comments": [{"owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "edited": false, "score": 1, "creation_date": 1450903498, "post_id": 34443414, "comment_id": 56628587, "body": "It has to save the executable, right? :D Check if you&#39;re not running an instance of it. That would be blocking it. Only if you read the filename: <code>c++thing.exe</code>."}, {"owner": {"reputation": 31, "user_id": 4635386, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8aa7acba333be508404bc5e0678f85e8?s=128&d=identicon&r=PG&f=1", "display_name": "guest1337", "link": "https://stackoverflow.com/users/4635386/guest1337"}, "reply_to_user": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "edited": false, "score": 0, "creation_date": 1450912151, "post_id": 34443414, "comment_id": 56632077, "body": "i cant close the process though"}, {"owner": {"reputation": 5455, "user_id": 4115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2688a9684db617a20f9da3959e5890d7?s=128&d=identicon&r=PG&f=1", "display_name": "Danh", "link": "https://stackoverflow.com/users/4115625/danh"}, "edited": false, "score": 0, "creation_date": 1450914833, "post_id": 34443414, "comment_id": 56632923, "body": "Sound likes you have Avast in your computer?"}, {"owner": {"reputation": 31, "user_id": 4635386, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8aa7acba333be508404bc5e0678f85e8?s=128&d=identicon&r=PG&f=1", "display_name": "guest1337", "link": "https://stackoverflow.com/users/4635386/guest1337"}, "edited": false, "score": 0, "creation_date": 1450939777, "post_id": 34443414, "comment_id": 56638902, "body": "I do not but my Windows 10 computer is slow at times"}], "answers": [{"tags": [], "owner": {"reputation": 1264, "user_id": 1665301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CzyeT.jpg?s=128&g=1", "display_name": "Pedro Reis", "link": "https://stackoverflow.com/users/1665301/pedro-reis"}, "is_accepted": false, "score": 2, "last_activity_date": 1476115418, "creation_date": 1476115418, "answer_id": 39962285, "question_id": 34443414, "link": "https://stackoverflow.com/questions/34443414/why-cannot-visual-studio-open-my-file-for-writing-when-building/39962285#39962285", "title": "Why cannot visual studio open my file for writing when building?", "body": "<p>Visual Studio (VS) 2015 is not managing to overwrite your application named \"c++thing.exe\".</p>\n\n<p>It must got hanged while running by VS debugger (possibly on a windows 10 PC), and this debugger lose itself from main VS. </p>\n\n<p>If SHIFT+F5 doesn't unlock the file (and terminate the process):</p>\n\n<ul>\n<li>try restarting VS</li>\n<li>[OR] terminate VS and then check the running processes list for \"c++thing.exe\" and kill it if still existing.</li>\n</ul>\n"}], "owner": {"reputation": 31, "user_id": 4635386, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8aa7acba333be508404bc5e0678f85e8?s=128&d=identicon&r=PG&f=1", "display_name": "guest1337", "link": "https://stackoverflow.com/users/4635386/guest1337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4012, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476115418, "creation_date": 1450903398, "question_id": 34443414, "link": "https://stackoverflow.com/questions/34443414/why-cannot-visual-studio-open-my-file-for-writing-when-building", "title": "Why cannot visual studio open my file for writing when building?", "body": "<p>I was building a c++ project when Visual Studio gave me an error saying the main file cannot be opened for writing, even though my program does not write to any files.</p>\n\n<pre><code>Severity    Code    Description Project File    Line\nError   LNK1168 cannot open C:\\Users\\Nathan\\documents\\visual studio 2015\\Projects\\c++thing\\Debug\\c++thing.exe for writing   c++thing    C:\\Users\\Nathan\\documents\\visual studio 2015\\Projects\\c++thing\\c++thing\\LINK    1\n</code></pre>\n"}, {"tags": ["c++", "binary", "fstream"], "comments": [{"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 0, "creation_date": 1450909503, "post_id": 34443252, "comment_id": 56631154, "body": "Aside from what other have pointed out, please note that you <i>shall</i> set the size of the underlying array when using formatted input with a <code>char</code> array! When you do <code>file &gt;&gt; data;</code> without having set <code>file.width()</code> there is a potential for a buffer overrun if the read doesn&#39;t stop before the size of the array is exhausted! Ideally, you&#39;d avoid using formatted input to <code>char</code> arrays directly and rather use a <code>std::string</code>. Of course, the answer to your actual question is that the third byte is interpreted as a space and you&#39;d use unformatted input instead."}], "answers": [{"comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1450903094, "post_id": 34443296, "comment_id": 56628393, "body": "<code>fstream.read()</code> is unformatted like <code>filebuf</code>, but they both still have the locale and facet character conversion stuff going on.  Indeed it&#39;s best to stick with <code>fopen</code> and <code>fread</code>."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1450903563, "post_id": 34443296, "comment_id": 56628615, "body": "@benvoight aah! Good to know. I&#39;ve only ever used it for unformatted text."}], "tags": [], "owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1450903720, "last_edit_date": 1450903720, "creation_date": 1450902917, "answer_id": 34443296, "question_id": 34443252, "link": "https://stackoverflow.com/questions/34443252/c-file-exe-reading-itself/34443296#34443296", "title": "C++ file (exe) reading itself", "body": "<p>You will need to read an executable unformatted, as well as opening it as binary. Use good old fread; a filebuf is superficially attractive, but it will still invoke locale conversions which you don't want. </p>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 5062925, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4e22c663feb80b32ceeeeac150bfb2b0?s=128&d=identicon&r=PG&f=1", "display_name": "user5062925", "link": "https://stackoverflow.com/users/5062925/user5062925"}, "edited": false, "score": 0, "creation_date": 1450926132, "post_id": 34443733, "comment_id": 56635432, "body": "Thanks that really helped. One more thing, right now the code is only reading the first 1000 bytes, how can I read the entire file? I&#39;ve tried some things, but since the char array needs a constant (hard-coded) value I really don&#39;t know how to do this."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 4, "last_activity_date": 1450953025, "last_edit_date": 1450953025, "creation_date": 1450904812, "answer_id": 34443733, "question_id": 34443252, "link": "https://stackoverflow.com/questions/34443252/c-file-exe-reading-itself/34443733#34443733", "title": "C++ file (exe) reading itself", "body": "<p>Some value in the file causes the stream input to end too early, e.g. a \\n</p>\n\n<p>Try something like</p>\n\n<pre><code>int main(int argc, char * argv[])\n{\n    char data[1000];\n    std::ifstream file(argv[0], std::ios::in | std::ios::binary);\n    int i = 0; \n    while (file.get(data[i])\n    {\n       i++;\n       if (i == 1000) break;\n    }\n\n    for (int j = 0; j &lt; i; j++)\n        std::cout &lt;&lt; std::hex &lt;&lt; data[j];\n\n    system(\"PAUSE\");\n    return 0;\n}\n</code></pre>\n\n<p>EDIT: Updated after comment from OP</p>\n\n<p>In C++ you should avoid c-style arrays. Use a vector instead. A vector has dynamic size and can grow when needed.</p>\n\n<pre><code>int main(int argc, char * argv[])\n{\n    char c;\n    vector&lt;char&gt; data;\n    std::ifstream file(argv[0], std::ios::in | std::ios::binary);\n    while (file.get(c)\n    {\n       data.push_back(c);\n    }\n\n    for (auto t : data)  // for each ...\n    {\n        std::cout &lt;&lt; std::hex &lt;&lt; t;\n    }\n\n    system(\"PAUSE\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 2, "last_activity_date": 1450905969, "creation_date": 1450905969, "answer_id": 34443972, "question_id": 34443252, "link": "https://stackoverflow.com/questions/34443252/c-file-exe-reading-itself/34443972#34443972", "title": "C++ file (exe) reading itself", "body": "<p>The C++ <code>operator &gt;&gt; (const char *)</code> stream function is only for C-style strings. It's not suitable for arbitrary binary data. You'll need to decide what you want the output to look like and write code to output raw, arbitrary binary data in your desired format.</p>\n\n<p>You also need to keep reading. And you need to use a read function that won't overrun your buffer.</p>\n"}], "owner": {"reputation": 65, "user_id": 5062925, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4e22c663feb80b32ceeeeac150bfb2b0?s=128&d=identicon&r=PG&f=1", "display_name": "user5062925", "link": "https://stackoverflow.com/users/5062925/user5062925"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1363, "favorite_count": 0, "accepted_answer_id": 34443733, "answer_count": 3, "score": 0, "last_activity_date": 1450953025, "creation_date": 1450902687, "question_id": 34443252, "link": "https://stackoverflow.com/questions/34443252/c-file-exe-reading-itself", "title": "C++ file (exe) reading itself", "body": "<p>I would like to my binary file to read itself, but I'm having some trouble. Right now this is what I got:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n\nint main(int argc, char * argv[])\n{\n    char data[1000];\n    std::fstream file(argv[0], std::ios::in | std::ios::binary);\n    file &gt;&gt; data;\n\n    std::cout &lt;&lt; data;\n\n    system(\"PAUSE\");\n    return 0;\n}\n</code></pre>\n\n<p>This only prints the first 3 characters, for some reason... that's it. I don't know why it isn't reading the whole file. Any help?</p>\n"}, {"tags": ["c++", "makefile", "cmake"], "answers": [{"tags": [], "owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "is_accepted": false, "score": 5, "last_activity_date": 1450905010, "creation_date": 1450905010, "answer_id": 34443770, "question_id": 34443128, "link": "https://stackoverflow.com/questions/34443128/cmake-install-targets-in-subdirectories/34443770#34443770", "title": "CMake install (TARGETS in subdirectories)", "body": "<p>Even though it would help seeing the <code>CMakeLists.txt</code> files contained in the subdirectories, I guess they contain <code>add_executable</code> and/or <code>add_library</code> statements to create your stuff.<br/>\nAlso, because of your example, I guess you are using the same name of your directories for your targets.<br/>\nThat said, you should know that symbols defined in a <code>CMakeLists.txt</code> file in a subdirectory are not visible by default within the context of the <code>CMakeLists.txt</code> file in the parent directory. Because of that, you should rather move your <code>install</code> statements within the <code>CMakeLists.txt</code> files within your subdirectories.<br/>\nThis should solve the problem, if my thoughts were right. Otherwise, I strongly suggest you to post in your question also the content of the other files above mentioned.</p>\n\n<p>Anyway, the error is quite clear.<br/>\nThe file that contains the <code>install</code> statement for the target named <code>X</code> does not contain a target creation statement (<code>add_executable</code> and the others) that gives birth to that target, so it goes on saying that that target does not exist in that directory.</p>\n"}, {"comments": [{"owner": {"reputation": 400, "user_id": 3386303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RnRMd.jpg?s=128&g=1", "display_name": "phcerdan", "link": "https://stackoverflow.com/users/3386303/phcerdan"}, "edited": false, "score": 2, "creation_date": 1541790052, "post_id": 34444949, "comment_id": 93350506, "body": "This is solved in 3.13: install: <a href=\"https://gitlab.kitware.com/cmake/cmake/merge_requests/2152\" rel=\"nofollow noreferrer\">Allow installing targets created in another directory</a>"}, {"owner": {"reputation": 417, "user_id": 4608037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2d9aeb2d17f5f2090b661c53709d319?s=128&d=identicon&r=PG&f=1", "display_name": "woodz", "link": "https://stackoverflow.com/users/4608037/woodz"}, "edited": false, "score": 0, "creation_date": 1613066693, "post_id": 34444949, "comment_id": 116968246, "body": "moving <code>add_library()</code>to top level is <b>not</b> enough"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 417, "user_id": 4608037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2d9aeb2d17f5f2090b661c53709d319?s=128&d=identicon&r=PG&f=1", "display_name": "woodz", "link": "https://stackoverflow.com/users/4608037/woodz"}, "edited": false, "score": 0, "creation_date": 1613071390, "post_id": 34444949, "comment_id": 116970396, "body": "@woodz: Could you elaborate, why this is not enough?"}, {"owner": {"reputation": 417, "user_id": 4608037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2d9aeb2d17f5f2090b661c53709d319?s=128&d=identicon&r=PG&f=1", "display_name": "woodz", "link": "https://stackoverflow.com/users/4608037/woodz"}, "edited": false, "score": 0, "creation_date": 1614596837, "post_id": 34444949, "comment_id": 117424238, "body": "@Tsyvarev: because the top level is not the same dir, if you have multiple subdirs and you wanna pick something from the one and something from the other"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1614599583, "post_id": 34444949, "comment_id": 117425268, "body": "If you have multiple subdirs, which contains libraries you want to install, then before CMake 3.13 you need to move <b>all</b> <code>add_library</code> calls, corresponding to the installed libraries, into the top-level. I see no specifics of the case with &quot;multiple subdirs&quot; against the case with a single subdir. Of course, moving <code>add_library</code> call is not convenient in some cases. But my answer doesn&#39;t imply that it will fit for any project."}], "tags": [], "owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "is_accepted": true, "score": 21, "last_activity_date": 1564380158, "last_edit_date": 1564380158, "creation_date": 1450911274, "answer_id": 34444949, "question_id": 34443128, "link": "https://stackoverflow.com/questions/34443128/cmake-install-targets-in-subdirectories/34444949#34444949", "title": "CMake install (TARGETS in subdirectories)", "body": "<p>According to <a href=\"https://cmake.org/Bug/view.php?id=14444\" rel=\"noreferrer\">this bugreport</a>, <code>install(TARGETS)</code> command flow accepts only targets <strong>created within the same directory</strong>.</p>\n\n<p>So you need either move the <code>add_library()</code> call into the top-level directory, or split <code>install(TARGETS)</code> call into per-target ones, and move each of them into the corresponding subdirectory.</p>\n\n<p>Since CMake 3.13 <code>install(TARGETS)</code> <a href=\"https://cmake.org/cmake/help/v3.13/command/install.html#targets\" rel=\"noreferrer\">can work</a> even with targets created in other directories.</p>\n\n<blockquote>\n  <p><code>install(TARGETS)</code> can install targets that were created in other directories. When using such cross-directory install rules, running <code>make install</code> (or similar) from a subdirectory will not guarantee that targets from other directories are up-to-date.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 574, "user_id": 2069115, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/fd0e34c7ef1b8bf70df41c2eb52f2c05?s=128&d=identicon&r=PG", "display_name": "AceFunk", "link": "https://stackoverflow.com/users/2069115/acefunk"}, "edited": false, "score": 0, "creation_date": 1596466961, "post_id": 48958597, "comment_id": 111812977, "body": "This sounds interesting... but without samples of what you&#39;re talking about... I just can&#39;t follow it."}], "tags": [], "owner": {"reputation": 865, "user_id": 1721409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e397ab0d4a7bc09d6029e656c9586d8c?s=128&d=identicon&r=PG", "display_name": "Alex Goldberg", "link": "https://stackoverflow.com/users/1721409/alex-goldberg"}, "is_accepted": false, "score": 5, "last_activity_date": 1540347352, "last_edit_date": 1540347352, "creation_date": 1519437655, "answer_id": 48958597, "question_id": 34443128, "link": "https://stackoverflow.com/questions/34443128/cmake-install-targets-in-subdirectories/48958597#48958597", "title": "CMake install (TARGETS in subdirectories)", "body": "<p>This still seems to be a pain point in CMake 3.11.</p>\n\n<p>In our codebase, we have many targets defined in subdirectories and need to create an assortment of installers with different configurations and (potentially overlapping) combinations of targets.</p>\n\n<p>Here's my solution:</p>\n\n<ul>\n<li>Before calling <code>add_subdirectory</code> in your root CMakeLists.txt file, create a <code>GLOBAL</code> property with the names of the target(s) you want to include in your installer.</li>\n<li>Wrap target creation functions (<code>add_executable</code>, etc.) in your own custom functions. Within those functions check if the target is present in the global property, and invoke <code>install</code> accordingly.</li>\n</ul>\n\n<p>That approach allows you to centralize installer configuration.</p>\n\n<p>Also: To support creation of multiple installers, we populate our global list along with other installer properties in separate .cmake files. When we invoke <code>cmake</code>, we pass the name of the installer configuration CMake file as a command-line argument. Our root CMakeLists.txt file simply calls <code>include</code> with that file.</p>\n"}], "owner": {"reputation": 13626, "user_id": 2697571, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cefd29d899fd6175ce401961e209a2a8?s=128&d=identicon&r=PG&f=1", "display_name": "Mendes", "link": "https://stackoverflow.com/users/2697571/mendes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22319, "favorite_count": 3, "accepted_answer_id": 34444949, "answer_count": 3, "score": 26, "last_activity_date": 1564380158, "creation_date": 1450902089, "last_edit_date": 1540065314, "question_id": 34443128, "link": "https://stackoverflow.com/questions/34443128/cmake-install-targets-in-subdirectories", "title": "CMake install (TARGETS in subdirectories)", "body": "<p>Consider the following <code>CMakeLists.txt</code> file:</p>\n\n<pre><code>add_subdirectory(execA)\nadd_subdirectory(libB)\n\ninstall(TARGETS execA libB\n        RUNTIME DESTINATION bin\n        LIBRARY DESTINATION lib\n        ARCHIVE DESTINATION lib)\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>install TARGETS given target \"execA\" which does not exist in this\n  directory\n</code></pre>\n\n<p><code>execA</code> and <code>libB</code> have their own <code>CMakeList.txt</code> files and are located under <code>project</code> directory, as well as the build directory I'm running <code>cmake</code> (<code>cmake ..</code>):</p>\n\n<pre><code>project\n  |------ CMakeList.txt (the one with the code)\n  |----execA\n  |      \\- .cpp, .hpp and CMakelist.txt\n  |----libB\n  |      \\- .cpp, .hpp and CMakelist.txt\n  |---- lib\n  |---- bin\n  \\---- build (where I\u00b4m commanding: $ cmake ..\n</code></pre>\n\n<p>How do I fix this error?</p>\n"}, {"tags": ["c++", "vector", "ifstream"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1450902245, "post_id": 34443097, "comment_id": 56628025, "body": "Do you get the same thing using one of <a href=\"http://stackoverflow.com/questions/7241871/loading-a-file-into-a-vectorchar\">thses</a> methods?"}], "answers": [{"tags": [], "owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "is_accepted": true, "score": 14, "last_activity_date": 1450902245, "creation_date": 1450902245, "answer_id": 34443154, "question_id": 34443097, "link": "https://stackoverflow.com/questions/34443097/reading-binary-file-into-vectorchar-reading-less-than-full-file/34443154#34443154", "title": "Reading binary file into vector&lt;char&gt; reading less than full file", "body": "<p>There are multiple stream iterators. The class template <code>std::istream_iterator&lt;T&gt;</code> is for <em>formatted</em> input, i.e., it is going go skip leading whitespace before trying to read an object of type <code>T</code>.</p>\n\n<p>From the looks of it you want <code>std::istreambuf_iterator&lt;char&gt;</code> which is used to iterate over the characters in a file, not doing any skipping.</p>\n"}], "owner": {"reputation": 1167, "user_id": 292807, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f2e239c6f02e87421124b2d01c337506?s=128&d=identicon&r=PG&f=1", "display_name": "Stan", "link": "https://stackoverflow.com/users/292807/stan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1349, "favorite_count": 1, "accepted_answer_id": 34443154, "answer_count": 1, "score": 11, "last_activity_date": 1450902245, "creation_date": 1450901971, "question_id": 34443097, "link": "https://stackoverflow.com/questions/34443097/reading-binary-file-into-vectorchar-reading-less-than-full-file", "title": "Reading binary file into vector&lt;char&gt; reading less than full file", "body": "<p>I have binary files whose contents I'm trying to read into a vector. All the files are the same size, yet using my code below, the final vector size is always a little bit smaller than the file size, and it's different from file to file (but same for each file). I'm confused at what is going on here...</p>\n\n<pre><code>#include &lt;fstream&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n#include &lt;iterator&gt;\nint main(int argc, char *argv[]) {\n  std::string filename(argv[1]);\n\n  // Get file size\n  std::ifstream ifs(filename, std::ios::binary | std::ios::ate);\n  int size = (int)ifs.tellg();\n  std::cout &lt;&lt; \"Detected \" &lt;&lt; filename &lt;&lt; \" size: \" &lt;&lt; size &lt;&lt; std::endl; // seems correct!\n\n  // Load file\n  ifs.seekg(0, std::ios::beg);\n  std::istream_iterator&lt;char unsigned&gt; start(ifs), end;\n  std::vector&lt;char unsigned&gt; v;\n  v.reserve(size);\n  v.assign(start, end);\n\n  std::cout &lt;&lt; \"Loaded data from \" &lt;&lt; filename &lt;&lt; \", with \" &lt;&lt; v.size() &lt;&lt; \" elements\" &lt;&lt; std::endl; \n}\n</code></pre>\n\n<p>Trying this on a file, I get this:</p>\n\n<pre><code>Detected foo_binary.bin size: 2113753\nLoaded data from foo_binary.bin, with 2099650 elements\n</code></pre>\n\n<p>The 2113753 number is the correct size of the file in bytes. </p>\n\n<p>Trying this on another file of the same size, the vector size will end up having 2100700 elements. A bit more, but again not the whole file.</p>\n\n<p>What's going on here?</p>\n"}, {"tags": ["c++", "c", "assembly"], "comments": [{"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 3, "creation_date": 1450901415, "post_id": 34442943, "comment_id": 56627646, "body": "Whoever wrote this code should be executed. This code takes the abuse of operator precedence to a new level."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1450901626, "post_id": 34442943, "comment_id": 56627741, "body": "Isn&#39;t this is just pseudo <code>C</code> code optimized by the compiler?"}, {"owner": {"reputation": 119371, "user_id": 1919155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7d26642f016f64f37619d209037dff?s=128&d=identicon&r=PG", "display_name": "Mats Petersson", "link": "https://stackoverflow.com/users/1919155/mats-petersson"}, "edited": false, "score": 1, "creation_date": 1450901788, "post_id": 34442943, "comment_id": 56627824, "body": "I suspect this is some kind of misunderstanding of the compiler-generated code. Like a sign-extend of a 32 -&gt; 64-bit number in an optimised form. Most likely (c &gt;&gt; 32) is zero."}, {"owner": {"reputation": 4309, "user_id": 3543233, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xivj6.jpg?s=128&g=1", "display_name": "MattAllegro", "link": "https://stackoverflow.com/users/3543233/mattallegro"}, "edited": false, "score": 0, "creation_date": 1450905804, "post_id": 34442943, "comment_id": 56629548, "body": "Can you please reference where did you find such code?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1450906162, "post_id": 34442943, "comment_id": 56629690, "body": "Decompiled code is not usually human readable. The decompiler is replicating all the bizarre edge quirks of the generated assembly in a high-level language, so it&#39;s going to look super weird. (Likely, here it&#39;s replicating odd overflow characteristics that the assembly happens to have.)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1450906373, "post_id": 34442943, "comment_id": 56629788, "body": "It would help if you tell us what <code>sizeof(int)</code> is on the machine in question, and what the type of <code>c</code> and <code>n</code> are"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 8, "creation_date": 1450906423, "post_id": 34442943, "comment_id": 56629807, "body": "@user3528438 apparently the code was generated by a decompiler -- so the decompiler must have been executed already !"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1450906725, "post_id": 34442943, "comment_id": 56629957, "body": "It might also be illuminating to see the original assembly, it&#39;s probably shorter than this C code"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1450930810, "post_id": 34442943, "comment_id": 56636360, "body": "This is so amazingly obfuscated yet valid that I&#39;m adding it to my secure coding course!"}], "answers": [{"comments": [{"owner": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "reply_to_user": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 1, "creation_date": 1450901651, "post_id": 34442983, "comment_id": 56627752, "body": "@ScottHunter With code like this, it&#39;s best not to think too much about it. If it works, fine. If it doesn&#39;t work, throw it all away and write something yourself. Don&#39;t try to understand it."}, {"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "reply_to_user": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 0, "creation_date": 1450901857, "post_id": 34442983, "comment_id": 56627862, "body": "@MrLister: The answer came from <i>somewhere</i>; its a pretty thin one w/o some elaboration."}, {"owner": {"reputation": 521, "user_id": 1646681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c55b9cbeb52f3f6a9ad14504e926b8c?s=128&d=identicon&r=PG", "display_name": "leo", "link": "https://stackoverflow.com/users/1646681/leo"}, "edited": false, "score": 0, "creation_date": 1450901872, "post_id": 34442983, "comment_id": 56627872, "body": "This code is generated by decompiler: this is C code corresponding to ASM code generated by x86 compiler. I am trying to understand why this code has been generated like this - would any malloc(N) expression in original program imply these additional alignments when compiled?"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 521, "user_id": 1646681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c55b9cbeb52f3f6a9ad14504e926b8c?s=128&d=identicon&r=PG", "display_name": "leo", "link": "https://stackoverflow.com/users/1646681/leo"}, "edited": false, "score": 0, "creation_date": 1450902482, "post_id": 34442983, "comment_id": 56628133, "body": "@leo it&#39;s a way of ensuring that any negative value will cause a failed allocation. The result of the expression for any negative value is 0xffffffffffffffff."}, {"owner": {"reputation": 521, "user_id": 1646681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c55b9cbeb52f3f6a9ad14504e926b8c?s=128&d=identicon&r=PG", "display_name": "leo", "link": "https://stackoverflow.com/users/1646681/leo"}, "edited": false, "score": 0, "creation_date": 1450903065, "post_id": 34442983, "comment_id": 56628371, "body": "Do I understand correctly that compiler would always generate code like this when malloc is called with signed int value? I can post original ASM code from disassembler if it helps, it&#39;s just less readable."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 521, "user_id": 1646681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c55b9cbeb52f3f6a9ad14504e926b8c?s=128&d=identicon&r=PG", "display_name": "leo", "link": "https://stackoverflow.com/users/1646681/leo"}, "edited": false, "score": 1, "creation_date": 1450903421, "post_id": 34442983, "comment_id": 56628553, "body": "@leo I can&#39;t say whether all compilers will do this. could it be that what you&#39;re actually seeing is inlined <code>calloc</code>? It&#39;s a good way of ensuring that asking for more blocks than can possibly fit in the memory model is refused."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1450909709, "post_id": 34442983, "comment_id": 56631226, "body": "To me the number <code>18446744073709551615</code> doesn&#39;t mean much, at a glance. Only after seeing it expressed in hex I went &quot;ah&quot;."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1450910417, "post_id": 34442983, "comment_id": 56631496, "body": "@Jongware thanks for pointing that out - answer updated accordingly."}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 1, "last_activity_date": 1450910397, "last_edit_date": 1450910397, "creation_date": 1450901391, "answer_id": 34442983, "question_id": 34442943, "link": "https://stackoverflow.com/questions/34442943/can-someone-explain-the-meaning-of-malloc20-c-20-unsigned-int64uns/34442983#34442983", "title": "Can someone explain the meaning of malloc(20 * c | -(20 * (unsigned __int64)(unsigned int)c &gt;&gt; 32 != 0))", "body": "<p><strike>it's rounding up to the nearest block size.</strike></p>\n\n<p>forgive me. What it's doing is calculating a multiple of c while simultaneously checking for a negative value (overflow):</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdint&gt;\n\n\nsize_t foo(char c)\n{\n    return 20 * c | -(20 * (std::uint64_t)(unsigned int)c &gt;&gt; 32 != 0);\n}\n\nint main()\n{\n    using namespace std;\n    for (char i = -4 ; i &lt; 4 ; ++i)\n    {\n        cout &lt;&lt; \"input is: \" &lt;&lt; int(i) &lt;&lt; \", result is \" &lt;&lt; foo(i) &lt;&lt; endl;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>results:</p>\n\n<pre><code>input is: -4, result is 18446744073709551615\ninput is: -3, result is 18446744073709551615\ninput is: -2, result is 18446744073709551615\ninput is: -1, result is 18446744073709551615\ninput is: 0, result is 0\ninput is: 1, result is 20\ninput is: 2, result is 40\ninput is: 3, result is 60\n</code></pre>\n\n<blockquote>\n  <p>To me the number 18446744073709551615 doesn't mean much, at a glance. Only after seeing it expressed in hex I went \"ah\". \u2013 Jongware</p>\n</blockquote>\n\n<p>adding &lt;&lt; hex:</p>\n\n<pre><code>input is: -1, result is ffffffffffffffff\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1450903674, "post_id": 34443299, "comment_id": 56628669, "body": "Ugh.  Hopefully that&#39;s from disassembling an optimized <code>if (...)</code> statement and someone didn&#39;t code that directly."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1450906543, "post_id": 34443299, "comment_id": 56629859, "body": "&quot;regardless the type of c&quot; - well, if <code>c</code> were a wider type than <code>unsigned int</code> then some information is lost"}], "tags": [], "owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "is_accepted": false, "score": 3, "last_activity_date": 1450917650, "last_edit_date": 1450917650, "creation_date": 1450902929, "answer_id": 34443299, "question_id": 34442943, "link": "https://stackoverflow.com/questions/34442943/can-someone-explain-the-meaning-of-malloc20-c-20-unsigned-int64uns/34443299#34443299", "title": "Can someone explain the meaning of malloc(20 * c | -(20 * (unsigned __int64)(unsigned int)c &gt;&gt; 32 != 0))", "body": "<p>Since this code is decompiled from ASM, so we can only guess what it actually does.</p>\n\n<p>Let's first format it so figure the precedence:</p>\n\n<pre><code>malloc(20 * c | -(20 * (unsigned __int64)(unsigned int)c &gt;&gt; 32 != 0))\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                       //this is first evaluated, promoting c to \n                       //64 bit unsigned int without doing sign\n                       //extension, regardless the type of c\n\nmalloc(20 * c | -(20 * (uint64_t)c &gt;&gt; 32 != 0))\n                  ^^^^^^^^^^^^^^^^\n                  //then, multiply by 20, with uint64 result\n\nmalloc(20 * c | -(20 * (uint64_t)c &gt;&gt; 32 != 0))\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                  //if 20c is greater than 2^32-1, then result is true,\n                  //use -1 to generate a mask of 0xffffffff,\n                  //bitwise operator | then masks 20c to 0xffffffff \n                  //(2^32-1, the maximum of size_t, input type to malloc)\n                  //regardless what 20c actually is\n\n                  //if 20c is smaller than 2^32-1, then result is false,\n                  //the mask is 0, bitwise operator | keeps the final    \n                  //input to malloc as 20c untouched\n</code></pre>\n\n<p><strong>What are 20 and 6?</strong></p>\n\n<p>Those probably come from the common usage of \n<code>malloc(sizeof(Something)*count)</code>. Those two calls to <code>malloc</code> are probably made with <code>sizeof(Something)</code> and <code>sizeof(SomethingElse)</code> evaluated to <code>20</code> and <code>6</code> at compile time.</p>\n\n<p><strong>So what this code actually does:</strong></p>\n\n<p>My guess, it's trying to prevent <code>sizeof(Something)*count</code> from overflowing and cause the <code>malloc</code> to succeed and cause buffer overflow when the memory is used.</p>\n\n<p>By evaluating the product in 64 bit unsigned <code>int</code> and test against <code>2^32-1</code>, when size is greater than <code>2^32-1</code>, the input to <code>malloc</code> is set to a very large value that makes it guaranteed to fail (No 32 bit system can allocate 2^32-1 bytes of memory).  </p>\n"}, {"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 1, "last_activity_date": 1450906818, "last_edit_date": 1450906818, "creation_date": 1450906458, "answer_id": 34444077, "question_id": 34442943, "link": "https://stackoverflow.com/questions/34442943/can-someone-explain-the-meaning-of-malloc20-c-20-unsigned-int64uns/34444077#34444077", "title": "Can someone explain the meaning of malloc(20 * c | -(20 * (unsigned __int64)(unsigned int)c &gt;&gt; 32 != 0))", "body": "<blockquote>\n  <p>Can someone explain the purpose of these calculations? </p>\n</blockquote>\n\n<p>It is important to understand that compiling changes the semantic meaning of code. Much unspecified behavior of the original code becomes specified by the compilation process.</p>\n\n<p>IDA has no idea whether things the generated assembly code just happens to do are important or not. To be safe, it tries to perfectly replicate the behavior of the assembly code, even in cases that cannot possibly happen given the way the code is used.</p>\n\n<p>Here, IDA is probably replicating the overflow characteristics that the conversion of types just happens to have on this platform. It can't just replicate the original C code because the original C code likely had unspecified behavior for some values of <code>c</code> or <code>n</code>, likely negative ones.</p>\n\n<p>For example, say I write this C code: <code>int f(unsigned j) { return j; }</code>. My compiler will likely turn that into very simple assembly code giving whatever behavior for negative values of <code>j</code> that my platform just happens to give.</p>\n\n<p>But if you decompile the generated assembly, you <em>cannot</em> decompile it to <code>int f(unsigned j) { return j; }</code> because that will not behave the same as the my assembly code did on platforms with different overflow behavior. That could compile to code (on other platforms) that returns different values than my assembly code does for negative values of <code>j</code>.</p>\n\n<p>So it is often literally impossible (in fact, incorrect) to decompile C code into the original code, it will often have these kinds of \"portably replicate this platform's behavior\" oddities.</p>\n"}, {"comments": [{"owner": {"reputation": 521, "user_id": 1646681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c55b9cbeb52f3f6a9ad14504e926b8c?s=128&d=identicon&r=PG", "display_name": "leo", "link": "https://stackoverflow.com/users/1646681/leo"}, "edited": false, "score": 0, "creation_date": 1450971180, "post_id": 34445284, "comment_id": 56651522, "body": "You are right, this code was compiled by MSVC and its disassembly listing is almost identical to yours. Thank you!"}], "tags": [], "owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "is_accepted": true, "score": 3, "last_activity_date": 1450913318, "creation_date": 1450913318, "answer_id": 34445284, "question_id": 34442943, "link": "https://stackoverflow.com/questions/34442943/can-someone-explain-the-meaning-of-malloc20-c-20-unsigned-int64uns/34445284#34445284", "title": "Can someone explain the meaning of malloc(20 * c | -(20 * (unsigned __int64)(unsigned int)c &gt;&gt; 32 != 0))", "body": "<p>I'm guessing that original source code used the C++ <code>new</code> operator to allocate an array and was compiled with Visual C++. As user3528438's answer indicates this code is meant to prevent overflows. Specifically it's a 32-bit unsigned saturating multiply. If the result of the multiplication would be greater than 4,294,967,295, the maximum value of a 32-bit unsigned number, the result is clamped or \"saturated\" to that maximum. </p>\n\n<p>Since Visual Studio 2005, Microsoft's C++ compiler has <a href=\"http://blogs.msdn.com/b/michael_howard/archive/2005/12/06/500629.aspx\" rel=\"nofollow\">generated code to protect against overflows</a>. For example, I can generate assembly code that could be decompiled into your examples by compiling the following with Visual C++:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nvoid *\noperator new[](size_t n) {\n        return malloc(n);\n}\n\nstruct S {\n        char a[20];\n};\n\nstruct T {\n        char a[6];\n};\n\nvoid\nfoo(int n, S **s, T **t) {\n        *s = new S[n];\n        *t = new T[n * 2];\n}\n</code></pre>\n\n<p>Which, with Visual Studio 2015's compiler generates the following assembly code:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>    mov esi, DWORD PTR _n$[esp]\n    xor ecx, ecx\n    mov eax, esi\n    mov edx, 20                 ; 00000014H\n    mul edx\n    seto    cl\n    neg ecx\n    or  ecx, eax\n    push    ecx\n    call    _malloc\n    mov ecx, DWORD PTR _s$[esp+4]\n; Line 19\n    mov edx, 6\n    mov DWORD PTR [ecx], eax\n    xor ecx, ecx\n    lea eax, DWORD PTR [esi+esi]\n    mul edx\n    seto    cl\n    neg ecx\n    or  ecx, eax\n    push    ecx\n    call    _malloc\n</code></pre>\n\n<p>Most of the decompiled expression is actually meant to handle just one assembly statement. The assembly instruction <code>seto cl</code> sets CL to 1 if the previous MUL instruction overflows, otherwise it sets CL to 0. Similarly the expression <code>20 * (unsigned __int64)(unsigned int)c &gt;&gt; 32 != 0</code> evaluates to 1 if the result of <code>20 * c</code> overflows, and evaluates to 0 otherwise.</p>\n\n<p>If this overflow protection wasn't there and the result of <code>20 * c</code> did actually overflow then the call to <code>malloc</code> would probably succeed, but allocate much less memory than the program intended.  The program would then likely write past the end of the memory actually allocated and trash other bits of memory. This would amount to a buffer overrun, one that could be potentially exploited by hackers.</p>\n"}], "owner": {"reputation": 521, "user_id": 1646681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c55b9cbeb52f3f6a9ad14504e926b8c?s=128&d=identicon&r=PG", "display_name": "leo", "link": "https://stackoverflow.com/users/1646681/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "accepted_answer_id": 34445284, "answer_count": 4, "score": 1, "last_activity_date": 1450974218, "creation_date": 1450901190, "last_edit_date": 1450974218, "question_id": 34442943, "link": "https://stackoverflow.com/questions/34442943/can-someone-explain-the-meaning-of-malloc20-c-20-unsigned-int64uns", "title": "Can someone explain the meaning of malloc(20 * c | -(20 * (unsigned __int64)(unsigned int)c &gt;&gt; 32 != 0))", "body": "<p>In decompiled code generated by IDA I see expressions like:</p>\n\n<pre><code>malloc(20 * c | -(20 * (unsigned __int64)(unsigned int)c &gt;&gt; 32 != 0))\nmalloc(6  * n | -(3  * (unsigned __int64)(unsigned int)(2 * n) &gt;&gt; 32 != 0))\n</code></pre>\n\n<p>Can someone explain the purpose of these calculations?\n<br/>c and n are int (signed integer) values.</p>\n\n<p><strong>Update.</strong>\n<br/>Original C++ code was compiled with MSVC for 32-bit platform.\n<br/>Here's assembly code for second line of decompiled C-code above (malloc(6 * ..)):</p>\n\n<pre><code>mov     ecx, [ebp+pThis]\nmov     [ecx+4], eax\nmov     eax, [ebp+pThis]\nmov     eax, [eax]\nshl     eax, 1\nxor     ecx, ecx\nmov     edx, 3\nmul     edx\nseto    cl\nneg     ecx\nor      ecx, eax\nmov     esi, esp\npush    ecx             ; Size\ncall    dword ptr ds:__imp__malloc\n</code></pre>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1450901262, "post_id": 34442903, "comment_id": 56627575, "body": "People keep adding the C++ tag to your C++11 questions. Please take the hint!"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1450901322, "post_id": 34442903, "comment_id": 56627601, "body": "If you get a crash the first thing you should do is to run your program in a debugger, and let the debugger catch the crash in action. That will tell you <i>where</i> the crash happened, and you will be able to examine the function call stack and go up it to your code (if the debugger doesn&#39;t stop in your code already), and then you can examine the values of all variables. At the very least you should edit your question to show us the location <i>in your code</i> of the crash, and preferably the values of the involved variables."}, {"owner": {"reputation": 1384, "user_id": 2916232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OTZpa.jpg?s=128&g=1", "display_name": "Pavel P&#225;ja Halbich", "link": "https://stackoverflow.com/users/2916232/pavel-p%c3%a1ja-halbich"}, "edited": false, "score": 0, "creation_date": 1450901484, "post_id": 34442903, "comment_id": 56627676, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/67273/how-do-you-iterate-through-every-file-directory-recursively-in-standard-c\">How do you iterate through every file/directory recursively in standard C++?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "is_accepted": false, "score": 1, "last_activity_date": 1450903039, "creation_date": 1450903039, "answer_id": 34443331, "question_id": 34442903, "link": "https://stackoverflow.com/questions/34442903/trouble-with-recursive-file-search/34443331#34443331", "title": "Trouble with recursive file search", "body": "<p>From the looks of it, you have implemented an infinite recursion which just won't run to infinite but rather only until you run out resources. Notably, at the bottom of <code>SearchDirectory()</code> you call <code>SearchDirectory()</code> with the same parameters as when you innitially call it. You need to make sure the recursion stops eventually.</p>\n"}, {"tags": [], "owner": {"reputation": 97, "user_id": 5234004, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/a824a14fbeebe5b61cc47bf3c4c8395e?s=128&d=identicon&r=PG&f=1", "display_name": "HB1963", "link": "https://stackoverflow.com/users/5234004/hb1963"}, "is_accepted": false, "score": 0, "last_activity_date": 1451579768, "creation_date": 1451579768, "answer_id": 34549117, "question_id": 34442903, "link": "https://stackoverflow.com/questions/34442903/trouble-with-recursive-file-search/34549117#34549117", "title": "Trouble with recursive file search", "body": "<p>OK, I found the answer. It all had to do with infinitive recursion. If anyone is interested, I have rewritten the code. It scan a 650GB harddrive (over 750k files) within 100 seconds and returns some nice data:</p>\n\n<pre><code>    #include &lt;windows.h&gt;\n    #include &lt;iostream&gt;\n    #include &lt;fstream&gt;\n    #include &lt;conio.h&gt;\n    #include &lt;ctype.h&gt;\n    #include &lt;string&gt;\n    #include &lt;string.h&gt;\n    #include &lt;stdio.h&gt;\n    #include &lt;direct.h&gt;\n    #include &lt;list&gt;\n    #include &lt;vector&gt;\n    #include &lt;ctime&gt;\n    #include &lt;iomanip&gt;\n\nusing namespace std;\n\n    vector &lt;string&gt; myList;\n\n       int siZe;\n       int siZekB;\n       bool  bSearchSubdirectories=true;\n       HANDLE handle;\n       LPCTSTR strPattern;\n       std::string temp;\n       std::string temp1;\n       std::string temp2;\n       std::string temp3;\n       WIN32_FIND_DATA search_data;\n       int DIRPlace;\n\n       int telDIR=0;\n       int telFILES=0;\n       int telFILESHidden=0;\n       double LargestFile=0;\n       double LargestFileHidden=0;\n       double TotalUsed=0;\n       double TotalUsedHidden=0;\n       string LargestFileName;\n       string LargestFileNameHidden;\n       string SDir;\n       string line,SearD, LineFiller,FrontString, BackString;\n       int SearchDirectory(string FileSearch ,string refvecFiles,\n                        bool bSearchSubdirectories);\n\n\nint main(int argc, char* argv[])\n    {   \n        system(\"mode CON: COLS=140 LINES=22\");\n        std::cout&lt;&lt; \"Enter directory to be explored: \";\n        getline(cin,SDir);\n        std::cout&lt;&lt; \"\\n\";\n\n  clock_t begin = clock();\n\n\n\n        SearchDirectory(\"\\\\*.*\",SDir, false);\n\n        while (!myList.empty()){\n\n            SearD=myList.back();\n            myList.pop_back();\n\n            SearchDirectory(\"\\\\*.*\",SearD.c_str(), false);\n        }\n\n\n        clock_t end = clock();\n        double elapsed_secs = double(end - begin) / CLOCKS_PER_SEC;\n\n        std::cout&lt;&lt; \"\\n\"&lt;&lt;\"\\n\";\n        system(\"cls\");\n        std::cout&lt;&lt;\"Directory explored in      : \"&lt;&lt;elapsed_secs&lt;&lt;\" seconds\\n\";\n        std::cout&lt;&lt;\"Explored (sub)directories  : \"&lt;&lt; telDIR&lt;&lt; \"\\n\";\n        std::cout&lt;&lt;\"Unexplored directories     : \"&lt;&lt;myList.size()&lt;&lt;\"\\n\\n\";\n        std::cout&lt;&lt;setprecision (2)&lt;&lt;fixed&lt;&lt;\"Files found                : \"&lt;&lt; telFILES&lt;&lt; \" using \"&lt;&lt;TotalUsed&lt;&lt;\" kB storage\\n\"; \n        std::cout&lt;&lt;setprecision (2)&lt;&lt;fixed&lt;&lt;\"Largest File               : \"&lt;&lt;LargestFileName &lt;&lt; \" (\"&lt;&lt; LargestFile &lt;&lt; \" kB)\"&lt;&lt;\"\\n\\n\";\n\n        std::cout&lt;&lt;setprecision (2)&lt;&lt;fixed&lt;&lt;\"Hidden Files found         : \"&lt;&lt; telFILESHidden&lt;&lt; \" using \"&lt;&lt;TotalUsedHidden&lt;&lt;\" kB storage\\n\"; \n        std::cout&lt;&lt;setprecision (2)&lt;&lt;fixed&lt;&lt;\"Largest Hidden File        : \"&lt;&lt;LargestFileNameHidden &lt;&lt; \" (\"&lt;&lt; LargestFileHidden &lt;&lt; \" kB)\"&lt;&lt;\"\\n\";\n\n        std::cout&lt;&lt;\"press any key\";\n        getch();       \n    }\n\n\n    int SearchDirectory(string FileSearch ,string refvecFiles,\n                        bool bSearchSubdirectories)\n    {  \n\n       WIN32_FIND_DATA search_data;\n       temp = refvecFiles+ \"\\\\\\\\\";\n       refvecFiles += \"\\\\\\\\*.*\";        \n\n\n       HANDLE handle = FindFirstFile(refvecFiles.c_str(), &amp;search_data);\n\n       if (INVALID_HANDLE_VALUE == handle) \n        {\n            return 0;\n        }\n\n        do{\n                    if((search_data.dwFileAttributes &amp; FILE_ATTRIBUTE_DIRECTORY))      //Directory\n                        {    string filePath =search_data.cFileName;\n                            if (strcmp(\".\", filePath.c_str()) &amp;&amp; strcmp(\"..\", filePath.c_str()))             \n                                {\n                                    if (filePath == \"$RECYCLE.BIN\" || filePath == \"$Recycle.Bin\")\n                                    continue;\n                                    temp1=search_data.cFileName;\n                                    temp2=search_data.dwFileAttributes;\n                                    myList.push_back(temp+temp1);\n                                    telDIR++;\n                            }\n                        }else{\n                                siZe=(search_data.nFileSizeHigh * (MAXDWORD+1)) + search_data.nFileSizeLow;\n                                siZekB=((search_data.nFileSizeHigh * (MAXDWORD+1)) + search_data.nFileSizeLow)/1024;\n                                temp1=search_data.cFileName;\n                                temp2=search_data.dwFileAttributes;\n                                if ((search_data.dwFileAttributes &amp; FILE_ATTRIBUTE_HIDDEN) == 0)\n                                {   TotalUsed=TotalUsed+siZekB;\n                                    if (siZekB&gt;LargestFile){\n                                        LargestFile=siZekB;\n                                        LargestFileName=temp.substr(0, temp.size()) + \"\\\\\" + temp1;\n                                    }\n                                    telFILES++;\n                                }else{\n                                    TotalUsedHidden=TotalUsedHidden+siZekB;\n                                    if (siZekB&gt;LargestFileHidden){\n                                        LargestFileHidden=siZekB;\n                                        LargestFileNameHidden=temp.substr(0, temp.size()) + \"\\\\\" + temp1;\n                                    }\n                                    telFILESHidden++;\n                                }\n                        }\n\n        }while      (FindNextFile(handle, &amp;search_data) != 0);\n       FindClose(handle);\n       return 0;\n    }\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 5234004, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/a824a14fbeebe5b61cc47bf3c4c8395e?s=128&d=identicon&r=PG&f=1", "display_name": "HB1963", "link": "https://stackoverflow.com/users/5234004/hb1963"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1451579768, "creation_date": 1450900998, "last_edit_date": 1450901862, "question_id": 34442903, "link": "https://stackoverflow.com/questions/34442903/trouble-with-recursive-file-search", "title": "Trouble with recursive file search", "body": "<p>I am trying to write a script to recursivly scan a disk and return the total numbers of directories, files and also display the largest file found.\nI know that there is much information to find on StackOverflow or on the web, but all the examples I found so far seem to have issues with really scan a disk recursivly. \nBelow script uses the FindFile and FindNextFile functions to scan for files. If the file atribute returns that the the function found a directory it writes the name into a list to be searched later. After the current directory has been searched the script takes the first item (being a directory to be scanned) of the list, removes that item from the list and scans this directory.</p>\n\n<p>My problem is that after scanning a few hundred directories and subdirectories the program end with an error</p>\n\n<pre><code>Unhandled exception at ..... (ntdll.dll) in File Lister 6.0.exe: .....: Stack overflow\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Unhandled exception at ..... (ntdll.dll) in File Lister 6.0.exe: ......: Access violation writing location 0x00f30fe8.\n</code></pre>\n\n<p>But the then scanned directory is never the same.</p>\n\n<p>I have been trying to solves this issue but can not find a clear reason for it. \nTherefore I would much appreciate if someone could help</p>\n\n<p>Below is my code. I know it's looking very novice, my apologises for that</p>\n\n<pre><code>    #include &lt;windows.h&gt;\n    #include &lt;iostream&gt;\n    #include &lt;fstream&gt;\n    #include &lt;conio.h&gt;\n    #include &lt;ctype.h&gt;\n    #include &lt;string&gt;\n    #include &lt;string.h&gt;\n    #include &lt;stdio.h&gt;\n    #include &lt;direct.h&gt;\n    #include &lt;list&gt;\n\n    using namespace std;\n\n\n    list &lt;string&gt; myList;\n    std::list&lt;string&gt;::iterator it;\n\n       int siZe;\n       int siZekB;\n       bool  bSearchSubdirectories=true;\n       HANDLE handle;\n       LPCTSTR strPattern;\n       std::string temp;\n       std::string temp1;\n       std::string temp2;\n       std::string temp3;\n       WIN32_FIND_DATA search_data;\n       int DIRPlace;\n       int MaxDir=400000000;\n\n       int telDIR=1;\n       int telFILES=1;\n       double LargestFile=0;\n       string LargestFileName;\n       string SDir;\n\n\n    std::string string_to_hex(const std::string&amp; input)\n    {\n        static const char* const lut = \"0123456789ABCDEF\";\n        size_t len = input.length();\n\n        std::string output;\n        output.reserve(2 * len);\n        for (size_t i = 0; i &lt; len; ++i)\n        {\n            const unsigned char c = input[i];\n            output.push_back(lut[c &gt;&gt; 4]);\n            output.push_back(lut[c &amp; 15]);\n        }\n        return output;\n    }\n\n\n\n    int SearchDirectory(string FileSearch ,string refvecFiles,\n                        bool bSearchSubdirectories)\n    {  \n\n       WIN32_FIND_DATA search_data;\n       memset(&amp;search_data, 0, sizeof(WIN32_FIND_DATA));\n       HANDLE handle = FindFirstFile((refvecFiles+FileSearch).c_str(), &amp;search_data);  \n       temp = refvecFiles;\n       while(handle != INVALID_HANDLE_VALUE)   {\n\n               do{\n                   if (search_data.cFileName[0]!='.'){  \n                           temp2=search_data.dwFileAttributes;\n                           temp3=string_to_hex(temp2);\n                           DIRPlace=strlen(temp3.c_str())-1;\n                       switch (temp3[DIRPlace-1])\n                       {\n                          case '1':    //Directory\n                               temp = refvecFiles;\n                               temp1=search_data.cFileName;\n                               temp2=search_data.dwFileAttributes;\n                               myList.push_back(temp+temp1);\n                               telDIR++;\n                               break; \n                         default:   //Other types (Files etc)\n                               siZe=(search_data.nFileSizeHigh * (MAXDWORD+1)) + search_data.nFileSizeLow;\n                               siZekB=((search_data.nFileSizeHigh * (MAXDWORD+1)) + search_data.nFileSizeLow)/1024;\n                               temp = refvecFiles;\n                               temp1=search_data.cFileName;\n                               temp2=search_data.dwFileAttributes;\n                               if (siZekB&gt;LargestFile){\n                                  LargestFile=siZekB;\n                                  LargestFileName=temp.substr(0, temp.size()) + \"\\\\\" + temp1;\n                               }\n                               telFILES++;\n                               break;\n                       }\n                   }  \n                }while      (FindNextFile(handle, &amp;search_data) != FALSE &amp;&amp; telDIR&lt;MaxDir);\n                                  string line,SearD, LineFiller,FrontString, BackString;\n\n\n                      it=myList.begin();\n                        SearD=*it+\"\\\\\\\\\";\n                        myList.remove(*it);\n                      if (SearD.length()&gt;60)\n                      {\n                          FrontString=SearD.substr(0,10);\n                          BackString=SearD.substr(SearD.length()-44);\n                          LineFiller=\"......\";\n                          FrontString=FrontString+LineFiller+BackString;\n                      }else{\n                        FrontString=SearD;\n                      }\n                      cout&lt;&lt;\"Exploring:                                                              \"&lt;&lt;\"\\r\";\n                      cout&lt;&lt;\"Exploring: \"&lt;&lt;FrontString&lt;&lt;\"\\r\\r\";\n                      SearchDirectory(\"\\\\*\",SearD, false);     \n       }\n       FindClose(handle);\n       return 0;\n\n    }\n\n\n\n\n\n    int main(int argc, char* argv[])\n    {   \n        std::cout&lt;&lt; \"Enter directory to be searched: \";\n        getline(cin,SDir);\n        std::cout&lt;&lt; \"\\n\";\n        try{\n        SearchDirectory(\"\\\\*\",SDir, false);\n        }catch (int e)\n  {\n    cout &lt;&lt; \"An exception occurred. Exception Nr. \" &lt;&lt; e &lt;&lt; '\\n';\n  }\n                std::cout&lt;&lt; \"\\n\"&lt;&lt;\"\\n\";\n        std::cout&lt;&lt;\"Directories found: \"&lt;&lt; telDIR&lt;&lt; \"\\n\";\n        std::cout&lt;&lt;\"Files found: \"&lt;&lt; telFILES&lt;&lt; \"\\n\"; \n        std::cout&lt;&lt;\"Largest File: \"&lt;&lt;LargestFileName &lt;&lt; \" (\"&lt;&lt; LargestFile &lt;&lt; \" kB)\"&lt;&lt;\"\\n\";     \n        std::cout&lt;&lt;\"press any key\";\n        getch();       \n    }\n</code></pre>\n\n<p>EDIT: Below is a snapshot from the debugger Call Stack</p>\n\n<pre><code>&gt;   File Lister 6.0.exe!std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt; &gt;(std::basic_ostream&lt;char,std::char_traits&lt;char&gt; &gt; &amp; _Ostr={...}, const char * _Val=0x000d51c8)  Line 791 + 0x20 bytes   C++\n    File Lister 6.0.exe!SearchDirectory(std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt; FileSearch=\"\\*\", std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt; refvecFiles=\"c:\\\\boost\\\\numeric\\\\interval\\\\\", bool bSearchSubdirectories=false)  Line 110 + 0x16 bytes   C++\n    File Lister 6.0.exe!SearchDirectory(std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt; FileSearch=\"\\*\", std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt; refvecFiles=\"c:\\\\boost\\\\numeric\\\\conversion\\\\\", bool bSearchSubdirectories=false)  Line 113  C++\n    File Lister 6.0.exe!SearchDirectory(std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt; FileSearch=\"\\*\", std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt; refvecFiles=\"c:\\\\boost\\\\multi_index\\\\detail\\\\\", bool bSearchSubdirectories=false)  Line 113  C++\n    File Lister 6.0.exe!SearchDirectory(std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt; FileSearch=\"\\*\", std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt; refvecFiles=\"c:\\\\boost\\\\multiprecision\\\\traits\\\\\", bool bSearchSubdirectories=false)  Line 113   C++\n    File Lister 6.0.exe!SearchDirectory(std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt; FileSearch=\"\\*\", std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt; refvecFiles=\"c:\\\\boost\\\\multiprecision\\\\detail\\\\\", bool bSearchSubdirectories=false)  Line 113   C++\n    File Lister 6.0.exe!SearchDirectory(std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt; FileSearch=\"\\*\", std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt; refvecFiles=\"c:\\\\boost\\\\multiprecision\\\\cpp_int\\\\\", bool bSearchSubdirectories=false)  Line 113  C++\n    File Lister 6.0.exe!SearchDirectory(std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt; FileSearch=\"\\*\", std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt; refvecFiles=\"c:\\\\boost\\\\multiprecision\\\\concepts\\\\\", bool bSearchSubdirectories=false)  Line 113 C++\n</code></pre>\n\n<p>The debugger stops in ostream at</p>\n\n<pre><code>if (_State == ios_base::goodbit\n    &amp;&amp; _Ostr.rdbuf()-&gt;sputn(_Val, _Count) != _Count)\n    _State |= ios_base::badbit;\n</code></pre>\n"}, {"tags": ["c#", "c++", "visual-studio", "win-universal-app"], "answers": [{"comments": [{"owner": {"reputation": 2042, "user_id": 4311889, "user_type": "registered", "accept_rate": 32, "profile_image": "https://lh4.googleusercontent.com/-zo-x1poYMvU/AAAAAAAAAAI/AAAAAAAAAEI/nz-roGykGrQ/photo.jpg?sz=128", "display_name": "Hamza Zafeer", "link": "https://stackoverflow.com/users/4311889/hamza-zafeer"}, "edited": false, "score": 0, "creation_date": 1466474403, "post_id": 37934412, "comment_id": 63318987, "body": "should be a comment."}], "tags": [], "owner": {"reputation": 1, "user_id": 6491764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31db25205009c2e44fe006a686327a39?s=128&d=identicon&r=PG&f=1", "display_name": "fatterbetter", "link": "https://stackoverflow.com/users/6491764/fatterbetter"}, "is_accepted": false, "score": 0, "last_activity_date": 1466474307, "creation_date": 1466474307, "answer_id": 37934412, "question_id": 34442777, "link": "https://stackoverflow.com/questions/34442777/application-crash-when-atlbase-h-header-is-included/37934412#37934412", "title": "Application crash when atlbase.h header is included", "body": "<p>I have the same problem.\nYou can add _ATL_NO_DEFAULT_LIBS to you project's Pre-Processor which include atlbase.h</p>\n"}], "owner": {"reputation": 21, "user_id": 5712409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e35ba718da067adc58093a31207b877?s=128&d=identicon&r=PG&f=1", "display_name": "Asruik", "link": "https://stackoverflow.com/users/5712409/asruik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1466474307, "creation_date": 1450900429, "question_id": 34442777, "link": "https://stackoverflow.com/questions/34442777/application-crash-when-atlbase-h-header-is-included", "title": "Application crash when atlbase.h header is included", "body": "<p>My application crash when I include atlbase.h header in my C++ static lib project A, which is added by reference to C++ dll project B, then added by reference to C++ Runtime Component project C. Project C is added by reference to C# universal application D. Let K be class form C project, which indirect way refer to functionality from project A in its constructor. When instance of class K is being created, D application throws exception with that message:</p>\n\n<p><em>\"System.IO.FileNotFoundException: The specified module could not be found. (Exception from HRESULT: 0x8007007E)\\r\\n   at System.StubHelpers.StubHelpers.GetWinRTFactoryObject(IntPtr pCPCMD)\\r\\n   at WindowsRuntimeComponent2.Class1..ctor()\\r\\n   at App5.MainPage..ctor()\\r\\n   at App5.App5_XamlTypeInfo.XamlTypeInfoProvider.Activate_0_MainPage()\\r\\n   at App5.App5_XamlTypeInfo.XamlUserType.ActivateInstance()\\r\\n   at Windows.UI.Xaml.Controls.Frame.Navigate(Type sourcePageType, Object parameter)\\r\\n   at App5.App.OnLaunched(La\"</em></p>\n\n<p>Message is understandable but I don't understand why it could not be found, because it works correct when project B is static lib instead of dll  or atlbase.h is not included. Does anybody know what I'm doing wrong?</p>\n\n<p>All projects are universal windows for windows 10 and I test my application on windows phone. </p>\n\n<p>Version of using tools:</p>\n\n<ul>\n<li>Microsoft Visual Studio Professional 2015 Version 14.0.247200.00 Update 1</li>\n<li>Microsoft .NET Fremework Version 4.6.01055</li>\n</ul>\n"}, {"tags": ["c++", "c", "zero"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 5, "creation_date": 1450900214, "post_id": 34442710, "comment_id": 56627110, "body": "Just keep track of the sign of the last non-zero sample. If the sign changes, you have a zero crossing."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1450900502, "post_id": 34442710, "comment_id": 56627240, "body": "Be aware that floating point values are rarely equal to zero.  You should compare against an <i>epsilon</i> or tolerance value, such as 1E-06; anything less than this value is considered zero."}, {"owner": {"reputation": 32649, "user_id": 316469, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/7b88514bd3cdfab33fa64342aa1fcdc9?s=128&d=identicon&r=PG", "display_name": "Duck", "link": "https://stackoverflow.com/users/316469/duck"}, "edited": false, "score": 0, "creation_date": 1450900572, "post_id": 34442710, "comment_id": 56627273, "body": "I did that and I ended with a bunch of zeros in a row, making it impossible to detect zero crossing."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1450900581, "post_id": 34442710, "comment_id": 56627277, "body": "You may want to consider using Fixed Point math to get better accuracy."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1450900917, "post_id": 34442710, "comment_id": 56627426, "body": "It would be interesting to know <i>why</i> you want to detect zero crossings. One reason is that&#39;s a good time to switch output routes, to avoid a sudden level change. If so that can be done when the signal is near zero, rather than when crossing."}, {"owner": {"reputation": 8138, "user_id": 821878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2vRIG.gif?s=128&g=1", "display_name": "Ryan Bemrose", "link": "https://stackoverflow.com/users/821878/ryan-bemrose"}, "edited": false, "score": 0, "creation_date": 1450902721, "post_id": 34442710, "comment_id": 56628230, "body": "An audio signal crosses zero thousands of times per second (twice the highest frequency in Hz).  It will be very difficult to get timing right for anything but the lowest frequency sounds.  It&#39;s better to switch outputs during a period of silence - a large number of identical (ideally zero, but not always) samples in a row."}, {"owner": {"reputation": 8138, "user_id": 821878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2vRIG.gif?s=128&g=1", "display_name": "Ryan Bemrose", "link": "https://stackoverflow.com/users/821878/ryan-bemrose"}, "edited": false, "score": 0, "creation_date": 1450902847, "post_id": 34442710, "comment_id": 56628281, "body": "Another thing to think about: A DC offset in your signal - being the signal not centered on zero - will throw a monkey wrench into all of these calculations.  Does it &quot;count&quot; if the signal drops from 0.4 to 0.1, and then starts going back up?  What if the signal never crosses zero?"}, {"owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "edited": false, "score": 0, "creation_date": 1450907144, "post_id": 34442710, "comment_id": 56630153, "body": "if you have an unsigned integer representation, you will never cross zero..."}], "answers": [{"comments": [{"owner": {"reputation": 32649, "user_id": 316469, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/7b88514bd3cdfab33fa64342aa1fcdc9?s=128&d=identicon&r=PG", "display_name": "Duck", "link": "https://stackoverflow.com/users/316469/duck"}, "edited": false, "score": 0, "creation_date": 1450901980, "post_id": 34442922, "comment_id": 56627920, "body": "Ok, I understand that this method is better than the other one, but suppose there are a lots of zeros in the middle, like -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 and it will detect a zero cross on the last 1, but a lot of time passed and the wave may be out of phase... I am just saying."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 32649, "user_id": 316469, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/7b88514bd3cdfab33fa64342aa1fcdc9?s=128&d=identicon&r=PG", "display_name": "Duck", "link": "https://stackoverflow.com/users/316469/duck"}, "edited": false, "score": 0, "creation_date": 1450902921, "post_id": 34442922, "comment_id": 56628306, "body": "@SpaceDog well, you can&#39;t possibly detect the crossing before the last sample since that&#39;s the sample on which the zero is finally crossed in the diginal signal. It&#39;s impossible to figure out on which time point of original signal the zero would have been crossed. I guess the best quess would be the middle zero, but in order to figure out whether you&#39;re currently at a middle zero, you must keep track of the index of the last non-zero sample and look ahead for the next crossing which requires buffering the signal."}, {"owner": {"reputation": 4718, "user_id": 172218, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Ulbsn.jpg?s=128&g=1", "display_name": "j b", "link": "https://stackoverflow.com/users/172218/j-b"}, "edited": false, "score": 0, "creation_date": 1541436828, "post_id": 34442922, "comment_id": 93208102, "body": "Why is this method better than the accepted answer?"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 2, "last_activity_date": 1450901532, "last_edit_date": 1450901532, "creation_date": 1450901115, "answer_id": 34442922, "question_id": 34442710, "link": "https://stackoverflow.com/questions/34442710/options-for-detecting-zero-cross-of-audio/34442922#34442922", "title": "Options for detecting zero cross of audio", "body": "<p>Keep record of the sign of last non-zero sample and only consider the result of the multiplication if the current sample is non-zero as well (zero samples are never crossings themselves).</p>\n\n<pre><code>for (int i=0, previous=sign(data[0]); i&lt;numFrames-1; i++) {\n    if(int current = sign(data[i])) {\n        if(sign(previous * current) == -1)\n            printf(\"zero cross\");\n        previous = current;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 0, "last_activity_date": 1451680676, "last_edit_date": 1451680676, "creation_date": 1450906953, "answer_id": 34444179, "question_id": 34442710, "link": "https://stackoverflow.com/questions/34442710/options-for-detecting-zero-cross-of-audio/34444179#34444179", "title": "Options for detecting zero cross of audio", "body": "<p>Ignore the value and only use the sign to detect crossing.</p>\n\n<pre><code>#include &lt;math.h&gt;\n\nfor (int i=0; i&lt;numFrames-1; i++) {\n  if (signbit(data[i+1]) != signbit(data[i])) printf(\"zero cross\");\n}\n</code></pre>\n\n<blockquote>\n  <p>The signbit macro reports the sign of all values, including infinities, zeros, and NaNs.</p>\n</blockquote>\n\n<p>[Edit]</p>\n\n<p><code>signbit()</code> returns a nonzero value if and only if the sign of its argument value is negative.  So it is possible that 2 different negative values may return different nonzero values.  Better to use:</p>\n\n<pre><code>  if (!signbit(data[i+1]) != !signbit(data[i])) printf(\"zero cross\");\n</code></pre>\n"}], "owner": {"reputation": 32649, "user_id": 316469, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/7b88514bd3cdfab33fa64342aa1fcdc9?s=128&d=identicon&r=PG", "display_name": "Duck", "link": "https://stackoverflow.com/users/316469/duck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2321, "favorite_count": 0, "accepted_answer_id": 34444179, "answer_count": 2, "score": 1, "last_activity_date": 1451680676, "creation_date": 1450900102, "last_edit_date": 1495540343, "question_id": 34442710, "link": "https://stackoverflow.com/questions/34442710/options-for-detecting-zero-cross-of-audio", "title": "Options for detecting zero cross of audio", "body": "<p>I have live audio coming in and I need to detect zero crossings.</p>\n\n<p>The simpler algorithm to do this, like stated by <a href=\"https://stackoverflow.com/questions/13504019/number-of-zero-crossings-equation\">this question</a> is not acceptable for what I need. This algorithm detects a zero crossing by taking the sign of the multiplication of the current item with the previous one.</p>\n\n<p>This is a simple example of this method failing:</p>\n\n<blockquote>\n  <p>-1, -0.5, 0, 0, 0.32, 0.5...</p>\n</blockquote>\n\n<p>Two zeros in a row and the algorithm will fail.</p>\n\n<p>This method is implemented by this:</p>\n\n<pre><code>int sign(float value) {\n  if (value &lt; 0) {\n    return -1;\n  } else if (value &gt; 0) {\n    return 1;\n  }\n  return 0;\n}\n\nfor (int i=0; i&lt;numFrames-1; i++) {\n    int signR = sign(data[i+1] * data[i]);        \n    if (signR == 0) printf(\"zero cross\");\n    // but this will fail for data[i+1] = data[i] = 0, for example\n\n}\n</code></pre>\n\n<p>What other options of algorithms do I have to detect zero crossings?</p>\n"}, {"tags": ["c++", "com", "win32com", "typelib"], "answers": [{"tags": [], "owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "is_accepted": true, "score": 4, "last_activity_date": 1450903053, "creation_date": 1450903053, "answer_id": 34443335, "question_id": 34442642, "link": "https://stackoverflow.com/questions/34442642/itypelib-getlibattr-and-releasetlibattr/34443335#34443335", "title": "ITypeLib: GetLibAttr and ReleaseTLibAttr", "body": "<p>The interface method was designed like this back in 1996 because they did not want to lose the opportunity to add members to the structure.  That did not in fact happen, TLIBATTR has been stable for 19 years.  And will never change again, Microsoft has moved away from the .tlb format and is now using the .winmd format.</p>\n\n<p>If it makes you feel any better, the .NET Framework <a href=\"http://referencesource.microsoft.com/#mscorlib/system/runtime/interopservices/typelibconverter.cs,762bcb79ece4ddb3\" rel=\"nofollow\">also copies the structure</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1803, "user_id": 873131, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9sMsd.jpg?s=128&g=1", "display_name": "skataben", "link": "https://stackoverflow.com/users/873131/skataben"}, "edited": false, "score": 1, "creation_date": 1450981312, "post_id": 34448764, "comment_id": 56654966, "body": "Thank you, this is very helpful! Just curious, is there a reason you linked the alexhenrie/wine repo as opposed to the wine-mirror/wine repo? Not a big deal, just curious. On the surface, this one seems more &quot;official&quot;: <a href=\"https://github.com/wine-mirror/wine/blob/master/dlls/oleaut32/typelib.c\" rel=\"nofollow noreferrer\">github.com/wine-mirror/wine/blob/master/dlls/oleaut32/typeli&zwnj;&#8203;b.c</a>"}, {"owner": {"reputation": 86, "user_id": 5698405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6ac9ce29ccfeeb0cf3aca562d02c365?s=128&d=identicon&r=PG&f=1", "display_name": "Nick K", "link": "https://stackoverflow.com/users/5698405/nick-k"}, "reply_to_user": {"reputation": 1803, "user_id": 873131, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9sMsd.jpg?s=128&g=1", "display_name": "skataben", "link": "https://stackoverflow.com/users/873131/skataben"}, "edited": false, "score": 0, "creation_date": 1450988683, "post_id": 34448764, "comment_id": 56657122, "body": "@skataben. Yes you are right, <b>official</b> link is more correct. There is no special reason for alexherie link here. It was just a first link to the wine project that i found."}], "tags": [], "owner": {"reputation": 86, "user_id": 5698405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6ac9ce29ccfeeb0cf3aca562d02c365?s=128&d=identicon&r=PG&f=1", "display_name": "Nick K", "link": "https://stackoverflow.com/users/5698405/nick-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1450941020, "creation_date": 1450941020, "answer_id": 34448764, "question_id": 34442642, "link": "https://stackoverflow.com/questions/34442642/itypelib-getlibattr-and-releasetlibattr/34448764#34448764", "title": "ITypeLib: GetLibAttr and ReleaseTLibAttr", "body": "<p>There are nothing wrong with you code.<br/>\nYou can check the source code of GetLibAttr at <a href=\"https://github.com/alexhenrie/wine/blob/master/dlls/oleaut32/typelib.c\" rel=\"nofollow\">https://github.com/alexhenrie/wine/blob/master/dlls/oleaut32/typelib.c</a> - ITypeLib2_fnGetLibAttr.<br/>\nSince you have loaded TypeLib, then guid, lcid, syskind, wMajorVerNum, wMinorVerNum, wLibFlags can not be changed till next load TLB file and only in case if that file was changed.</p>\n"}], "owner": {"reputation": 1803, "user_id": 873131, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9sMsd.jpg?s=128&g=1", "display_name": "skataben", "link": "https://stackoverflow.com/users/873131/skataben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 2, "accepted_answer_id": 34443335, "answer_count": 2, "score": 2, "last_activity_date": 1450941020, "creation_date": 1450899792, "question_id": 34442642, "link": "https://stackoverflow.com/questions/34442642/itypelib-getlibattr-and-releasetlibattr", "title": "ITypeLib: GetLibAttr and ReleaseTLibAttr", "body": "<p>Problem: The <code>ITypeLib::GetLibAttr()</code> method allocates a new <code>TLIBATTR</code> struct, requiring me to call <code>ITypeLib::ReleaseTLibAttr()</code>? This makes the code too verbose for my taste, and it has the potential for memory leaks if overlooked.</p>\n\n<p>If I cache the result, then call <code>ReleaseTLibAttr()</code>, are there any side effects or potential pitfalls when using the cached value?</p>\n\n<hr>\n\n<p>The TLIBATTR struct is just a set of simple values:\n</p>\n\n<pre><code>typedef struct tagTLIBATTR\n{\n    GUID guid;\n    LCID lcid;\n    SYSKIND syskind;\n    WORD wMajorVerNum;\n    WORD wMinorVerNum;\n    WORD wLibFlags;\n} TLIBATTR;\n</code></pre>\n\n<p>There are no members which are themselves dynamically allocated. Perhaps that is subject to change?</p>\n\n<hr>\n\n<p>I wrote a simple helper method to prevent the need to call <code>ReleaseTLibAttr()</code>.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>HRESULT MyGetLibAttr(ITypeLib* pTypeLib, TLIBATTR *pTLibAttr)\n{\n    TLIBATTR *pTLibAttrTemp;\n    HRESULT hr = pTypeLib-&gt;GetLibAttr( &amp;pTLibAttrTemp );\n    if ( SUCCEEDED(hr) )\n    {\n        memcpy( pTLibAttr, pTLibAttrTemp, sizeof(TLIBATTR) );\n        pTypeLib-&gt;ReleaseTLibAttr( pTLibAttrTemp );\n    }\n    return hr;\n}\n\nvoid main()\n{\n    ITypeLib *pTypeLib;\n    HRESULT hr = LoadTypeLibEx( ... , &amp;pTypeLib);\n    if ( SUCCEEDED(hr) )\n    {\n        TLIBATTR libAttr;\n        hr = MyGetLibAttr( pTypeLib, &amp;libAttr );\n        if ( SUCCEEDED(hr) )\n        {\n            // Now we have a TLIBATTR object that we don't have to free.\n        }\n        pTypeLib-&gt;Release();\n    }\n}\n</code></pre>\n\n<p>On a scale of 1 to 10, how future proof is <code>MyGetLibAttr()</code> (error handling aside)? Are there any side effects to using the cached result?</p>\n\n<p>I realize there is a small performance hit (the extra call to <code>memcpy()</code>), but the bigger concern for us is code maintenance and memory leaks.</p>\n"}, {"tags": ["c++", "objective-c", "macos", "avfoundation"], "comments": [{"owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "edited": false, "score": 0, "creation_date": 1450916784, "post_id": 34442579, "comment_id": 56633428, "body": "Do you need a single screenshot or a continuous stream?"}], "answers": [{"tags": [], "owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "is_accepted": true, "score": 2, "last_activity_date": 1450918434, "last_edit_date": 1450918434, "creation_date": 1450917722, "answer_id": 34445804, "question_id": 34442579, "link": "https://stackoverflow.com/questions/34442579/osx-screencapturing-using-avscreencaptureinput/34445804#34445804", "title": "OSX Screencapturing using AVScreenCaptureInput", "body": "<p>If you want a continuous stream of yuv images, you can do something like this:</p>\n\n<pre><code>#import &lt;AVFoundation/AVFoundation.h&gt;\n\n@interface ScreenCapture() &lt;AVCaptureVideoDataOutputSampleBufferDelegate&gt;\n\n@property (nonatomic) AVCaptureSession *captureSession;\n\n@end\n\n@implementation ScreenCapture\n\n- (instancetype)init\n{\n    self = [super init];\n    if (self) {\n        self.captureSession = [[AVCaptureSession alloc] init];\n\n        AVCaptureScreenInput *input = [[AVCaptureScreenInput alloc] initWithDisplayID:CGMainDisplayID()];\n        [self.captureSession addInput:input];\n\n        AVCaptureVideoDataOutput *output = [[AVCaptureVideoDataOutput alloc] init];\n        [self.captureSession addOutput:output];\n\n        // TODO: create a dedicated queue.\n        [output setSampleBufferDelegate:self queue:dispatch_get_main_queue()];\n\n        [self.captureSession startRunning];\n    }\n    return self;\n}\n\n- (void)captureOutput:(AVCaptureOutput *)captureOutput didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer fromConnection:(AVCaptureConnection *)connection {\n    // sampleBuffer contains screen cap, for me it's yuv\n}\n\n@end\n</code></pre>\n\n<p>This gives me about ~15fps. You can get higher frame rates by lowering the minimum frame rate:</p>\n\n<pre><code>input.minFrameDuration = CMTimeMake(1, 60);\n</code></pre>\n\n<p>For a more mature implementation, which more error checking, see Apple's <a href=\"https://developer.apple.com/library/mac/samplecode/AVScreenShack\" rel=\"nofollow\">AVScreenShack sample code</a>. </p>\n"}], "owner": {"reputation": 3723, "user_id": 1565490, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5d6cfa6d4f127bb486d0aef41db63da6?s=128&d=identicon&r=PG", "display_name": "Amitg2k12", "link": "https://stackoverflow.com/users/1565490/amitg2k12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 761, "favorite_count": 0, "accepted_answer_id": 34445804, "answer_count": 1, "score": 1, "last_activity_date": 1450918434, "creation_date": 1450899475, "question_id": 34442579, "link": "https://stackoverflow.com/questions/34442579/osx-screencapturing-using-avscreencaptureinput", "title": "OSX Screencapturing using AVScreenCaptureInput", "body": "<p>In my mac application i need to grab screen and send it to otherend, </p>\n\n<p>Is it possible by <a href=\"https://developer.apple.com/library/mac/documentation/AVFoundation/Reference/AVCaptureSession_Class/index.html#//apple_ref/occ/cl/AVCaptureSession\" rel=\"nofollow\">AVCaptureSession</a> ? </p>\n\n<p>if Yes, i just need RGB or YUV data not the audio , is it possible to configure it  ? </p>\n\n<p>if not AVFoundation class/framework , then which one is recommended ? </p>\n"}, {"tags": ["c++", "macros"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1450899256, "post_id": 34442450, "comment_id": 56626665, "body": "Maybe use <a href=\"http://en.cppreference.com/w/cpp/types/conjunction\" rel=\"nofollow noreferrer\"><code>std::conjunction</code></a>? You may need an intermediate trait that receives the type list."}], "answers": [{"tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": false, "score": 1, "last_activity_date": 1450899419, "creation_date": 1450899419, "answer_id": 34442562, "question_id": 34442450, "link": "https://stackoverflow.com/questions/34442450/appending-to-every-arg-in-variadic-c-macro/34442562#34442562", "title": "Appending to every arg in variadic C macro", "body": "<p>Maybe something like this:</p>\n\n<pre><code>#define WHERE(P, ...) join_predicate&lt;P, __VA_ARGS__&gt;::value\n\ntemplate &lt;template &lt;typename&gt; typename Pred, typename ...Args&gt;\nstruct join_predicate : std::conjunction&lt;Pred&lt;Args&gt;...&gt; {};\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>std::enable_if_t&lt;WHERE(std::is_default_constructible, Foo, Bar, Quz), int&gt;\n</code></pre>\n\n<p>I would probably not even bother with the macro and just use a real C++ construct, maybe:</p>\n\n<pre><code>template &lt;template &lt;typename&gt; typename P, typename ...Args&gt;\nconstexpr bool where_v = join_predicate&lt;P, Args...&gt;::value;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 3514205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2807d7b67a6e8b50fa0501131668cb66?s=128&d=identicon&r=PG&f=1", "display_name": "paladin324", "link": "https://stackoverflow.com/users/3514205/paladin324"}, "is_accepted": true, "score": 0, "last_activity_date": 1560231251, "creation_date": 1560231251, "answer_id": 56537088, "question_id": 34442450, "link": "https://stackoverflow.com/questions/34442450/appending-to-every-arg-in-variadic-c-macro/56537088#56537088", "title": "Appending to every arg in variadic C macro", "body": "<p>I am sorry to bring this question back from the dead after four years, but I think I have a better answer that does exactly what I was aiming for at the time. (Not needing to specify the argument for the predicates multiple times.) </p>\n\n<pre><code>template &lt;typename T, template &lt;typename&gt; class... Predicates&gt;\nusing where_t = std::enable_if_t&lt;std::conjunction_v&lt;Predicates&lt;T&gt;...&gt;&gt;;\n\ntemplate &lt;typename T, typename = where_t&lt;T, std::is_default_constructible, std::is_class&gt;&gt;\nstruct my_struct\n{\n};\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 3514205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2807d7b67a6e8b50fa0501131668cb66?s=128&d=identicon&r=PG&f=1", "display_name": "paladin324", "link": "https://stackoverflow.com/users/3514205/paladin324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56537088, "answer_count": 2, "score": 0, "last_activity_date": 1560231251, "creation_date": 1450898900, "question_id": 34442450, "link": "https://stackoverflow.com/questions/34442450/appending-to-every-arg-in-variadic-c-macro", "title": "Appending to every arg in variadic C macro", "body": "<p>I'm trying to create a macro that works like the \"where\" constraint in higher-level languages:</p>\n\n<pre><code>#define where(T, ...) typename std::enable_if&lt; /* tricky part */ &gt;::type \n// should expand like so: trait1&lt;T&gt;::value &amp;&amp; trait2&lt;T&gt;::value ... traitN&lt;T&gt;::value\n</code></pre>\n\n<p>So that <strong>VA_ARGS</strong> is list of traits and is used like so:</p>\n\n<pre><code>template&lt;class T,\n    where(T, std::is_default_constructible, std::is_class)&gt;\nclass A { };\n</code></pre>\n\n<p>Is that possible?</p>\n"}, {"tags": ["javascript", "c++", "node.js", "v8", "electron"], "comments": [{"owner": {"reputation": 588, "user_id": 1032608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/379754a0590881d7b8b295417d54c7dd?s=128&d=identicon&r=PG", "display_name": "ekarak", "link": "https://stackoverflow.com/users/1032608/ekarak"}, "edited": false, "score": 0, "creation_date": 1451902385, "post_id": 34442279, "comment_id": 56922466, "body": "This <i>could</i> be a duplicate of <a href=\"http://stackoverflow.com/questions/31207454/v8-multithreaded-function\" title=\"v8 multithreaded function\">stackoverflow.com/questions/31207454/v8-multithreaded-functi&zwnj;&#8203;on</a>"}, {"owner": {"reputation": 2866, "user_id": 5535550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/571c344652249fb589492f90fa277fa9?s=128&d=identicon&r=PG", "display_name": "mkrufky", "link": "https://stackoverflow.com/users/5535550/mkrufky"}, "edited": false, "score": 0, "creation_date": 1502478303, "post_id": 34442279, "comment_id": 78243965, "body": "This is not a duplicate.  Being able to access the Node.js <code>EventEmitter</code> from javascript within the c++ addon scope requires a specific procedure that I have explained in my answer below. Multithreading within a v8 c++ addon is an entirely different problem."}], "answers": [{"comments": [{"owner": {"reputation": 2866, "user_id": 5535550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/571c344652249fb589492f90fa277fa9?s=128&d=identicon&r=PG", "display_name": "mkrufky", "link": "https://stackoverflow.com/users/5535550/mkrufky"}, "edited": false, "score": 0, "creation_date": 1502912109, "post_id": 34588750, "comment_id": 78401399, "body": "&quot;emit&quot; is not a callback - it&#39;s a method from the <code>EventEmitter</code> which should only be accessed from javascript.  See my answer for the accepted common practice ..."}], "tags": [], "owner": {"reputation": 588, "user_id": 1032608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/379754a0590881d7b8b295417d54c7dd?s=128&d=identicon&r=PG", "display_name": "ekarak", "link": "https://stackoverflow.com/users/1032608/ekarak"}, "is_accepted": false, "score": 2, "last_activity_date": 1451902293, "last_edit_date": 1495540844, "creation_date": 1451902293, "answer_id": 34588750, "question_id": 34442279, "link": "https://stackoverflow.com/questions/34442279/send-events-from-nodejs-addon-to-javascript/34588750#34588750", "title": "Send events from nodejs addon to javascript", "body": "<p>You do not need a separate <code>v8::Isolate</code> to call V8 from your code, you'd only want one if you wanted multiple <code>v8 engines</code> to run multiple Javascript interpreters in parallel.</p>\n\n<p>I think the reason for your problem is that you're calling V8 from another thread, which is quite risky. Use an <code>uv_acync_t</code> struct to signal your 'main/V8' thread from your C++ addon thread. See <a href=\"https://stackoverflow.com/questions/31207454/v8-multithreaded-function/34400660#34400660\">this thread</a> for more details on how to do this.</p>\n\n<p>Besides, <code>MakeCallback</code> is <em>not</em> the proper way to fire off callbacks, see <a href=\"https://github.com/nodejs/nan/issues/284\" rel=\"nofollow noreferrer\">https://github.com/nodejs/nan/issues/284</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 2866, "user_id": 5535550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/571c344652249fb589492f90fa277fa9?s=128&d=identicon&r=PG", "display_name": "mkrufky", "link": "https://stackoverflow.com/users/5535550/mkrufky"}, "is_accepted": false, "score": 3, "last_activity_date": 1502912193, "last_edit_date": 1502912193, "creation_date": 1502469768, "answer_id": 45640006, "question_id": 34442279, "link": "https://stackoverflow.com/questions/34442279/send-events-from-nodejs-addon-to-javascript/45640006#45640006", "title": "Send events from nodejs addon to javascript", "body": "<p>The common practice for emitting events from a Node.js C++ addon module is to wrap the C++ component with a javascript component and ship them together as a single module.  The javascript component passes a callback into the c++ component.  When the C++ component receives an event, it should call the javascript callback, which should in turn, use an <code>EventEmitter</code> to <code>emit</code> the event.</p>\n\n<p>If you'd like to see an example of this in practice, I do this in my <code>node-dvbtee</code> addon module:  <a href=\"http://github.com/mkrufky/node-dvbtee\" rel=\"nofollow noreferrer\">http://github.com/mkrufky/node-dvbtee</a></p>\n\n<p>The C++ addon source is built from the <code>src/</code> directory.</p>\n\n<p>The javascript wrapper can be found in the <code>lib/</code> directory.</p>\n\n<p>Look inside <code>lib/parser.js</code> to find where the function <code>listenTables</code> is called with a callback function as it's parameter.  Depending on the module's configured <code>options</code>, that callback will either call <code>self.push()</code> (for streaming) or <code>self.emit()</code> to emit an event.</p>\n\n<p>To avoid link rot, the javascript sample looks like this:</p>\n\n<pre class=\"lang-javascript prettyprint-override\"><code>var _Dvbtee = require('bindings')('dvbtee.node')\nvar util    = require('util')\nvar stream  = require('stream')\n\nvar Parser = function (options) {\n\n    var self = this\n\n    if (!(this instanceof Parser)) {\n      return new Parser(options)\n    }\n\n    self.options = {}\n\n    if (typeof options === 'object') {\n      self.options.passThru = (options.hasOwnProperty('passThru') &amp;&amp; options.passThru)\n    } else {\n      self.options.passThru = false\n    }\n\n    var _parser       = new _Dvbtee.Parser\n\n    var _listenTables = _Dvbtee.Parser.prototype.listenTables\n    var listenTables  = _listenTables.bind(_parser)\n\n    stream.Transform.call(this, {\n      objectMode: !self.options.passThru\n    })\n\n    self._buffer = new Buffer(0)\n\n    listenTables(function(a,b,c) {\n          // arguments a &amp; b are ignored\n          self.emit('psip', c)\n    })\n}\n\nutil.inherits(Parser, stream.Transform)\n\nParser.prototype._transform = ...\n</code></pre>\n\n<p>The c++ addon component would have to store the supplied callback function in a persistent handle.  <em>NAN</em> provides a perfect structure for this: <code>Nan::Callback</code></p>\n\n<p>The c++ addon component code should look something like the following: </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void dvbteeParser::listenTables(const Nan::FunctionCallbackInfo&lt;v8::Value&gt;&amp; info) {\n  dvbteeParser* obj = ObjectWrap::Unwrap&lt;dvbteeParser&gt;(info.Holder());\n\n  int lastArg = info.Length() - 1;\n\n  if ((lastArg &gt;= 0) &amp;&amp; (info[lastArg]-&gt;IsFunction())) {\n    obj-&gt;m_tableReceiver.subscribe(info[lastArg].As&lt;v8::Function&gt;());\n  }\n\n  info.GetReturnValue().Set(info.Holder());\n}\n</code></pre>\n\n<p>...</p>\n\n<pre><code>void TableReceiver::subscribe(const v8::Local&lt;v8::Function&gt; &amp;fn) {\n  m_cb.SetFunction(fn);\n}\n</code></pre>\n\n<p>... where <code>m_cb</code> is a <code>Nan::Callback</code> inside my <code>TableReceiver</code> class.  You can actually call this callback in your native addon's event generating function like so:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>v8::Local&lt;v8::Value&gt; argv[] = {\n  a,\n  b,\n  c\n};\n\nm_cb.Call(3, argv);\n</code></pre>\n\n<p>where a, b and c are of type <code>v8::Local&lt;v8::Value&gt;</code>.  Of course, the <code>argv</code> array could have any size.  Each element corresponds to an argument supplied to the given callback function.</p>\n"}], "owner": {"reputation": 159, "user_id": 5148295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xg9jBA2POF0/AAAAAAAAAAI/AAAAAAAAACg/sOpP8_iOhOU/photo.jpg?sz=128", "display_name": "David Rego", "link": "https://stackoverflow.com/users/5148295/david-rego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2401, "favorite_count": 2, "answer_count": 2, "score": 7, "last_activity_date": 1502912193, "creation_date": 1450898140, "question_id": 34442279, "link": "https://stackoverflow.com/questions/34442279/send-events-from-nodejs-addon-to-javascript", "title": "Send events from nodejs addon to javascript", "body": "<p>I'm currently building an app (Electron) and i need to connect it with a c++ library. I have done most of the binding using the NodeJS c++ addons, but i'm missing an important part that is related with receiving the events generated by the c++ library on my Javascript code.</p>\n\n<pre><code>void Event1(int64_t id)\n{\n\n  ArrayBufferAllocator allocator;\n  Isolate::CreateParams create_params;\n  create_params.array_buffer_allocator = &amp;allocator;\n  Isolate* isolate = Isolate::New(create_params);\n  {\n\n    v8::Locker locker(isolate); \n    Isolate::Scope isolate_scope(isolate);\n\n    HandleScope handle_scope(isolate);\n    Local&lt;Context&gt; context = Context::New(isolate);\n    Context::Scope context_scope(context);\n\n    v8::Local&lt;v8::Value&gt; argv[1] = {\n      Nan::New(\"OnWillPlayTrack\").ToLocalChecked(),  // event name\n    };\n\n\n    Nan::MakeCallback(isolate-&gt;GetCurrentContext()-&gt;Global(),\"emit\", 1, argv); \n  }\n\n\n  isolate-&gt;Dispose();\n}\n</code></pre>\n\n<p>The Event1 is being called by the c++ lib, that has nothing to do with V8, and now I want to fire an event to JavaScript, back to Node (EventEmitter?).\nI think that the biggest problem is that most of the v8 functions now need an Isolate, and most of the examples found throughout the web are pretty old. </p>\n\n<p>The Event1 code crashes at MakeCallBack with:</p>\n\n<pre><code>Thread 24 Crashed:: App\n0   libnode.dylib                   0x000000010a81e35b v8::String::NewFromOneByte(v8::Isolate*, unsigned char const*, v8::String::NewStringType, int) + 43\n1   libnode.dylib                   0x000000010a4b042f node::OneByteString(v8::Isolate*, char const*, int) + 15\n2   libnode.dylib                   0x000000010a4ba1b2 node::MakeCallback(node::Environment*, v8::Local&lt;v8::Object&gt;, char const*, int, v8::Local&lt;v8::Value&gt;*) + 50\n3   libnode.dylib                   0x000000010a4ba240 node::MakeCallback(v8::Isolate*, v8::Local&lt;v8::Object&gt;, char const*, int, v8::Local&lt;v8::Value&gt;*) + 96\n4   addon.node                      0x0000000110e62e1f Event1(long long) + 291 (v8.h:6721)\n</code></pre>\n\n<p>Any help will be greatly appreciated!</p>\n"}, {"tags": ["c++", "opencv", "contour"], "comments": [{"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1450901681, "post_id": 34442277, "comment_id": 56627768, "body": "With contours you&#39;ll get only boundary points, while moments are computed on all (also internals) points. So it depends on your binary image, but in general they are not the same. You can use <code>findNonZero</code> to get all non-black pixels into a vector. A sample image a and a code snippet will be helpful for more precise answers."}, {"owner": {"reputation": 251, "user_id": 4182129, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/DB1k9.jpg?s=128&g=1", "display_name": "angel208", "link": "https://stackoverflow.com/users/4182129/angel208"}, "reply_to_user": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1450903084, "post_id": 34442277, "comment_id": 56628384, "body": "@Miki edited the question with an example"}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 1, "creation_date": 1450905764, "post_id": 34442277, "comment_id": 56629526, "body": "Result will be different, whether better or worse for your svm it&#39;s up to you."}], "owner": {"reputation": 251, "user_id": 4182129, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/DB1k9.jpg?s=128&g=1", "display_name": "angel208", "link": "https://stackoverflow.com/users/4182129/angel208"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1450903320, "creation_date": 1450898128, "last_edit_date": 1592644375, "question_id": 34442277, "link": "https://stackoverflow.com/questions/34442277/passing-the-contour-vector-to-moments-vs-passing-the-image-with-the-contour-to", "title": "passing the contour vector to moments() vs passing the image with the contour to moments()", "body": "<p>I want to get the descriptor of each symbol contained inside binary image so i can train/predict with an SVM. I figured that i needed to find the contours of each symbol in the image and then extract each descriptor (one for each contour). Im getting the descriptors of the symbols using <code>huMoments</code> and for that i need the moments of the symbol.</p>\n<p>The function <code>moments()</code> receives an image as a  <code>Mat</code> object or a vector of points. That means i can pass one the vectors of points returned by <code>contours()</code> as well as a binary image where i draw and fill that specific contour. So my question is:</p>\n<p>Is there any difference between the moments i get using the vector returned by  <code>contours()</code> as a parameter and the moments i would get using the image with the contour drawn? Is one option better than the other in terms of precision?</p>\n<h1>example:</h1>\n<p>Suppose that the vector of points i get from <code>contours()</code> is something like this (this is an example and are not real points calculated by the function):</p>\n<p><a href=\"https://i.stack.imgur.com/KDliO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KDliO.png\" alt=\"enter image description here\" /></a></p>\n<p>If i draw the contour formed by that vector of points in a <code>Mat</code> and fill the inside part i get an image like this:</p>\n<p><a href=\"https://i.stack.imgur.com/lmbgK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lmbgK.png\" alt=\"enter image description here\" /></a></p>\n<p>My question is if the second image's <code>moments()</code> brings more information at the time of SVM learning/predicting than the vector of points (the first image), Therefore improving the accuracy of the prediction?</p>\n"}, {"tags": ["c++", "function", "boolean"], "answers": [{"comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1450898188, "post_id": 34442274, "comment_id": 56626147, "body": "It decays to pointer if the function parameter is a pointer. It doesn&#39;t decay to pointer when passed to any old function."}, {"owner": {"reputation": 287, "user_id": 2770726, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/21405494d9a487a874f0a947e6d7b64b?s=128&d=identicon&r=PG&f=1", "display_name": "Plinth", "link": "https://stackoverflow.com/users/2770726/plinth"}, "edited": false, "score": 0, "creation_date": 1450898200, "post_id": 34442274, "comment_id": 56626152, "body": "@cad So is the only way to declare the size of the array?"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "reply_to_user": {"reputation": 287, "user_id": 2770726, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/21405494d9a487a874f0a947e6d7b64b?s=128&d=identicon&r=PG&f=1", "display_name": "Plinth", "link": "https://stackoverflow.com/users/2770726/plinth"}, "edited": false, "score": 0, "creation_date": 1450898240, "post_id": 34442274, "comment_id": 56626179, "body": "@Plinth I added something."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "reply_to_user": {"reputation": 287, "user_id": 2770726, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/21405494d9a487a874f0a947e6d7b64b?s=128&d=identicon&r=PG&f=1", "display_name": "Plinth", "link": "https://stackoverflow.com/users/2770726/plinth"}, "edited": false, "score": 1, "creation_date": 1450898272, "post_id": 34442274, "comment_id": 56626193, "body": "@Plinth You don&#39;t need to. <code>all_of(begin(Janmaat), end(Janmaat), [](bool b) { return b; });</code>"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1450898340, "post_id": 34442274, "comment_id": 56626234, "body": "3. Make the function a template and accept the array by reference so it doesn&#39;t decay."}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1450898464, "post_id": 34442274, "comment_id": 56626300, "body": "@juanchopanza Regarding your first comment, I added something in the first paragraph. Anyway, whadduya mean with &quot;any <b>old</b> function&quot;?"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1450898493, "post_id": 34442274, "comment_id": 56626319, "body": "@cad I mean any type of function."}, {"owner": {"reputation": 287, "user_id": 2770726, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/21405494d9a487a874f0a947e6d7b64b?s=128&d=identicon&r=PG&f=1", "display_name": "Plinth", "link": "https://stackoverflow.com/users/2770726/plinth"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1450899000, "post_id": 34442274, "comment_id": 56626559, "body": "@juanchopanza That&#39;s probably a lot easier. Thanks!"}], "tags": [], "owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "is_accepted": false, "score": 3, "last_activity_date": 1450899146, "last_edit_date": 1450899146, "creation_date": 1450898123, "answer_id": 34442274, "question_id": 34442248, "link": "https://stackoverflow.com/questions/34442248/c-returning-wrong-boolean-values-when-in-function/34442274#34442274", "title": "C++ returning wrong boolean values when in function", "body": "<p>When an array is passed to a function expecting a pointer, it automatically decays to a pointer. That means that arrays cannot be passed by value. <code>arr</code> from <code>all_true</code> <strong>is a pointer</strong>. <code>sizeof(arr)</code> will therefore yield the size of the <strong>pointer</strong>, not the whole array.</p>\n\n<p>Different ways to handle this:</p>\n\n<ol>\n<li><p>Pass the size as an argument. Chang the declaration to</p>\n\n<pre><code>bool all_true(bool arr[], size_t size)\n</code></pre>\n\n<p>and adjust the code accordingly.</p></li>\n<li><p>Pass an <code>std::array</code> or a <code>std::vector</code> (<code>std::bitset</code> is technically feasible too). As this is C++, this is surely the better option.</p></li>\n</ol>\n\n<hr>\n\n<p>Notes:</p>\n\n<ul>\n<li>If one element is <code>false</code>, <code>all_true</code> will definitely return <code>false</code>. To shorten the runtime you could <code>return false;</code> in the <code>if</code> statement immediately.</li>\n</ul>\n\n<hr>\n\n<p>Y'know Linus Torvalds? The guy who invented Linux and regularly insults Linux kernel \"developers\" (some deserve the double quotes; some don't)?<br>\n<strong><a href=\"https://lkml.org/lkml/2015/9/3/428\" rel=\"nofollow\">This</a> might interest you then.</strong> :-)</p>\n"}], "owner": {"reputation": 287, "user_id": 2770726, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/21405494d9a487a874f0a947e6d7b64b?s=128&d=identicon&r=PG&f=1", "display_name": "Plinth", "link": "https://stackoverflow.com/users/2770726/plinth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "closed_date": 1450898151, "answer_count": 1, "score": 0, "last_activity_date": 1450899146, "creation_date": 1450898014, "question_id": 34442248, "link": "https://stackoverflow.com/questions/34442248/c-returning-wrong-boolean-values-when-in-function", "closed_reason": "Duplicate", "title": "C++ returning wrong boolean values when in function", "body": "<p>I'm writing a function to check if all values of an array are true. If I write</p>\n\n<pre><code>int main(){\nbool Janmaat[3]={true, true, true};\n\nint size_arr=sizeof(Janmaat)/sizeof(Janmaat[0]);\nbool value=true;\nint i;\n\nfor(i=0;i&lt;size_arr;i++){\n    if(!Janmaat[i]){\n        value=false;\n    }\n}\ncout&lt;&lt;value;\nreturn 0;\n}\n</code></pre>\n\n<p>value stays true. If I encapsulate it into a function though</p>\n\n<pre><code>bool all_true(bool arr[]){\n\nint size_arr=sizeof(arr)/sizeof(arr[0]);\nbool value=true;\nint i;\n\nfor(i=0;i&lt;size_arr;i++){\n    if(!arr[i]){\n        value=false;\n    }\n}\n\nreturn value;\n\n}\n\nint main(){\n\nbool Janmaat[3]={true, true, true};\n\ncout&lt;&lt;all_true(Janmaat);\nreturn 0;\n}\n</code></pre>\n\n<p>it returns false. What's going on?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 2, "creation_date": 1450897295, "post_id": 34442084, "comment_id": 56625716, "body": "Time to investigate console GUI libraries. ncurses, anyone?"}, {"owner": {"reputation": 906, "user_id": 5322470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd703cc518f502bae92cb002a2f5f920?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden Deom", "link": "https://stackoverflow.com/users/5322470/aiden-deom"}, "edited": false, "score": 1, "creation_date": 1450897315, "post_id": 34442084, "comment_id": 56625727, "body": "The simple solution is to only print what you want, which is your example statement. Don&#39;t print the result of every coin flip."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 2, "creation_date": 1450897435, "post_id": 34442084, "comment_id": 56625777, "body": "Why not write it to a file? Then you can just print out the result followed by printing the file?"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 1, "creation_date": 1450897452, "post_id": 34442084, "comment_id": 56625782, "body": "<code>int main()</code>. Note the <code>int</code>. Or is this C? Under C99? Then it&#39;s alright but change tags then, please."}, {"owner": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 1, "creation_date": 1450897472, "post_id": 34442084, "comment_id": 56625790, "body": "Why not simply use an array with 10,000 elements?"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 1, "creation_date": 1450897613, "post_id": 34442084, "comment_id": 56625853, "body": "The... unorthodox (is that the right word?) way would be to store the string in a <code>std::string</code> or a stream and print it out later. Probably inefficient as hell but feasible and easy."}, {"owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 0, "creation_date": 1450898538, "post_id": 34442084, "comment_id": 56626343, "body": "So many coin toss questions on SO!  <a href=\"http://stackoverflow.com/questions/27218980/c-coin-toss-simulator-not-working?rq=1\" title=\"c coin toss simulator not working\">stackoverflow.com/questions/27218980/&hellip;</a>"}, {"owner": {"reputation": 267, "user_id": 5446068, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/6jjgs.png?s=128&g=1", "display_name": "SarpSTA", "link": "https://stackoverflow.com/users/5446068/sarpsta"}, "reply_to_user": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 0, "creation_date": 1450898894, "post_id": 34442084, "comment_id": 56626510, "body": "@Matt Yeah but my case isn&#39;t directly related to coin toss. I need it to analyse repeating patterns etc. to <i>statistically</i> prove how statistics about lotteries or roulette are completely unnecessary. The question you referred is simply a case of non-shuffled seed for rand()."}, {"owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 1, "creation_date": 1450899262, "post_id": 34442084, "comment_id": 56626672, "body": "I can see that.  But the number of coin toss questions on here suggests homework.  I&#39;d rather not give away a full answer just suggestions so you guys can learn."}, {"owner": {"reputation": 267, "user_id": 5446068, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/6jjgs.png?s=128&g=1", "display_name": "SarpSTA", "link": "https://stackoverflow.com/users/5446068/sarpsta"}, "reply_to_user": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 0, "creation_date": 1450899862, "post_id": 34442084, "comment_id": 56626958, "body": "@Matt Not <i>homework</i>. Yeah it is for academics but it is also it is good C++ practice. I am modifying the code. I will simulate the tosses and record the results into arrays and print them in a separate loop."}], "answers": [{"comments": [{"owner": {"reputation": 267, "user_id": 5446068, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/6jjgs.png?s=128&g=1", "display_name": "SarpSTA", "link": "https://stackoverflow.com/users/5446068/sarpsta"}, "edited": false, "score": 0, "creation_date": 1450897896, "post_id": 34442138, "comment_id": 56625983, "body": "I thought of that but I have more information for every result as well."}, {"owner": {"reputation": 514, "user_id": 1925789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb2080aa32e20b9936f4a403e720dbf?s=128&d=identicon&r=PG", "display_name": "Arthur Laks", "link": "https://stackoverflow.com/users/1925789/arthur-laks"}, "reply_to_user": {"reputation": 267, "user_id": 5446068, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/6jjgs.png?s=128&g=1", "display_name": "SarpSTA", "link": "https://stackoverflow.com/users/5446068/sarpsta"}, "edited": false, "score": 1, "creation_date": 1450898206, "post_id": 34442138, "comment_id": 56626154, "body": "What information do you want to display?  Can it be stored in an array or vector?  Would it take up too much memory?"}], "tags": [], "owner": {"reputation": 514, "user_id": 1925789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb2080aa32e20b9936f4a403e720dbf?s=128&d=identicon&r=PG", "display_name": "Arthur Laks", "link": "https://stackoverflow.com/users/1925789/arthur-laks"}, "is_accepted": false, "score": 2, "last_activity_date": 1450897496, "creation_date": 1450897496, "answer_id": 34442138, "question_id": 34442084, "link": "https://stackoverflow.com/questions/34442084/how-can-i-make-it-so-that-the-results-of-a-simulation-will-show-up-on-top-of-out/34442138#34442138", "title": "How can I make it so that the results of a simulation will show up on top of output?", "body": "<p>The simplest solution is to keep track of the results of the tosses in a bitset, display the numbers of heads and tails, and then iterate through the bitset, display head for each 1 and tails for each zero.</p>\n"}, {"comments": [{"owner": {"reputation": 267, "user_id": 5446068, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/6jjgs.png?s=128&g=1", "display_name": "SarpSTA", "link": "https://stackoverflow.com/users/5446068/sarpsta"}, "edited": false, "score": 0, "creation_date": 1450898692, "post_id": 34442324, "comment_id": 56626428, "body": "I need to print them, or stream them into a file. I need the results of every single toss individually as well for statistical patterns."}, {"owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "reply_to_user": {"reputation": 267, "user_id": 5446068, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/6jjgs.png?s=128&g=1", "display_name": "SarpSTA", "link": "https://stackoverflow.com/users/5446068/sarpsta"}, "edited": false, "score": 1, "creation_date": 1450899640, "post_id": 34442324, "comment_id": 56626843, "body": "I think you&#39;ve just answered your own question.  You do know the answer.  So get on with it. :)"}], "tags": [], "owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "is_accepted": false, "score": 2, "last_activity_date": 1450899108, "last_edit_date": 1450899108, "creation_date": 1450898353, "answer_id": 34442324, "question_id": 34442084, "link": "https://stackoverflow.com/questions/34442084/how-can-i-make-it-so-that-the-results-of-a-simulation-will-show-up-on-top-of-out/34442324#34442324", "title": "How can I make it so that the results of a simulation will show up on top of output?", "body": "<p>Do you really need to keep printing <code>Heads</code>, <code>Tails</code>?</p>\n\n<p>Why not just keep two counters.  i.e.</p>\n\n<pre><code>int main(argc, char* argv[])\n{\n    // Keep track of heads/tails counts\n    int heads = 0, \n    int tails = 0, \n\n    srand(time(NULL));\n    for (int x=0; x &lt; 10000; x++){\n      int result = rand()%2;\n      if (result == 0) heads++;\n      if (result == 1) tails++;\n    }\n\n    // print results    \n    printf(\"Heads=%d, Tails=%d otherstuff=TODO\\n\", heads, tails);\n    return 0;\n}\n</code></pre>\n\n<p>Keep track of tails or heads streak with other variables.  You'd need\nthe maximums of heads/tails inited to zero.  And a variable to say what the current streak length is, and whether you are currently looking at a head or tail streak.</p>\n\n<p>If you really want to be printing out head/tail you could do the bitset idea like @Arthur Laks suggests, or use an array of char's so that you don't need to deal with bitsets.  Or you could write the results to a file and read them back which is rather ugly.  There are many ways to do this.</p>\n\n<hr>\n\n<p>For the array method something like this.</p>\n\n<pre><code>char* results = new char[10000];\nchar* p = results;\n</code></pre>\n\n<p>Inside the loop.  To indicate heads:</p>\n\n<pre><code>p[x] = 'H';\n</code></pre>\n\n<p>For tails:</p>\n\n<pre><code>p[x] = 'T';\n</code></pre>\n\n<p>You can then run through the array again if needed to calculate other statistical patterns if required.</p>\n\n<p>This is about all I'm going to say because I think if I give you a full answer you've not learned anything.</p>\n"}, {"tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": true, "score": 2, "last_activity_date": 1450900131, "creation_date": 1450900131, "answer_id": 34442717, "question_id": 34442084, "link": "https://stackoverflow.com/questions/34442084/how-can-i-make-it-so-that-the-results-of-a-simulation-will-show-up-on-top-of-out/34442717#34442717", "title": "How can I make it so that the results of a simulation will show up on top of output?", "body": "<p>You will need to keep track (store) the results of each coin toss.  After the tossing is finished, print your summary then the results of each coin toss.</p>\n\n<p>Since each coin is either <code>heads</code> or <code>tails</code>, you could represent <code>heads</code> as <code>false</code> and <code>tails</code> as true.  This allows you to use a container of <code>bool</code>.  </p>\n\n<p>Also, there are only ever two values, so you can represent them as bits.  Let's say <em>heads</em> is 1 and <em>tails</em> is zero.  The C++ language has a structure called <code>bitset</code> which can efficiently store the bits until the tossing is completed.  </p>\n\n<p>When printing the results, <em>iterate</em> through the <code>bitset</code> container.  If the value is 1, print \"heads\"; otherwise print \"tails\".  Simple.  Fast.</p>\n"}], "owner": {"reputation": 267, "user_id": 5446068, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/6jjgs.png?s=128&g=1", "display_name": "SarpSTA", "link": "https://stackoverflow.com/users/5446068/sarpsta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 34442717, "answer_count": 3, "score": -1, "last_activity_date": 1450908567, "creation_date": 1450897257, "last_edit_date": 1450908567, "question_id": 34442084, "link": "https://stackoverflow.com/questions/34442084/how-can-i-make-it-so-that-the-results-of-a-simulation-will-show-up-on-top-of-out", "title": "How can I make it so that the results of a simulation will show up on top of output?", "body": "<p>Question looks a little weird I accept.</p>\n\n<p>What I want to ask is this:</p>\n\n<pre><code>int main(){\nsrand(time(NULL));\nfor(int x=0;x&lt;10000;x++){\nint result = rand()%2;\nif(result==0) cout &lt;&lt; \"Heads\" &lt;&lt; endl;\nif(result==1) cout &lt;&lt; \"Tails\" &lt;&lt; endl;\nreturn 0;\n}}\n</code></pre>\n\n<p>So what I want to do is to simulate a huge amount of coin tosses. The output will look like this:</p>\n\n<pre><code>Heads\nHeads\nHeads\nTails\nHeads\nTails\nTails\n.... \n</code></pre>\n\n<p>But I want a statement like</p>\n\n<blockquote>\n  <p>Total number of Heads= 4900, Tails= 5100 Longest Heads streak=7,Tails\n  streak=8</p>\n</blockquote>\n\n<p>at the <strong>top</strong> of the output. How can I do it? Since the loop involves <code>cout</code> best I have been able to do is to place the statement at the bottom of output.</p>\n\n<p><strong>EDIT</strong>: I managed to solve the problem by using arrays. I first used a loop and simulated the tosses and record them by assigning them to array elements, and then printed them using another loop, in the order I need them. Thanks for all answers, upvoted them all.</p>\n"}, {"tags": ["c++", "opengl", "glfw", "glew"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2547078"}, "edited": false, "score": 0, "creation_date": 1450979166, "post_id": 34442250, "comment_id": 56654323, "body": "Just to clarify: This is working code, and even though it uses vertex arrays it is still a VBO? <a href=\"http://pastebin.com/fBw007D0\" rel=\"nofollow noreferrer\">Link to Pastebin</a>"}, {"owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "edited": false, "score": 0, "creation_date": 1450981876, "post_id": 34442250, "comment_id": 56655126, "body": "@ZachGoethel: That question doesn&#39;t make sense. Apparently, this is <i>not</i> working code, and the answer explains why. The &quot; even though it uses vertex arrays it is still a VBO?&quot; part is totally beyond me. VBOs are VBOs because they <i>store</i> vertex arrays. Don&#39;t confuse vertex arrays with vertex array objects. The latter only store meta information, while the VBOs store the actual vertex arrays."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2547078"}, "edited": false, "score": 0, "creation_date": 1450982129, "post_id": 34442250, "comment_id": 56655213, "body": "&quot;This code&quot; refers to the link I gave.  And by &quot;Is it a VBO&quot; I meant to ask if the data is still stored on the GPU or if it is sent every frame."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2547078"}, "edited": false, "score": 0, "creation_date": 1450982845, "post_id": 34442250, "comment_id": 56655439, "body": "As part of another question, I renamed my class to MeshRenderer since it should not be referred to as a VBO."}, {"owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "edited": false, "score": 0, "creation_date": 1450983216, "post_id": 34442250, "comment_id": 56655532, "body": "The link you gave does not contain any VBO-related code. It just demonstrates creating a window with a GL context. You seem to be stack at the <i>middle</i> of the following tutorial, which explicitely states &quot;If you\u2019re on lucky, you can see the result (<b>don\u2019t panic if you don\u2019t</b>)&quot;. However, you skipped the VAO part at the beggining of that tutorial 2, so you won&#39;t see anything even if you add the shaders later. I don&#39;t really like that tutorial, but if you follow <i>all</i> of the steps to the end of the second tutorial, it should be working."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2547078"}, "edited": false, "score": 0, "creation_date": 1450983288, "post_id": 34442250, "comment_id": 56655555, "body": "The link in my comment.  The one that says &quot;Link to Pastebin&quot; and leads to <a href=\"http://pastebin.com/fBw007D0\" rel=\"nofollow noreferrer\">pastebin.com/fBw007D0</a>"}], "tags": [], "owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "is_accepted": true, "score": 2, "last_activity_date": 1450898028, "creation_date": 1450898028, "answer_id": 34442250, "question_id": 34441935, "link": "https://stackoverflow.com/questions/34441935/nothing-appears-on-screen-in-opengl-glfw-glew/34442250#34442250", "title": "Nothing appears on screen in OpenGL (GLFW/GLEW)", "body": "<p>You are using an OpenGL 3.3 core profile. In such a context, the use of <a href=\"https://www.opengl.org/wiki/Vertex_Specification#Vertex_Array_Object\" rel=\"nofollow\">Vertex Array Objects (VAO)</a> is <em>mandatory</em>. The same is true for program objects. You have to specify your own <a href=\"https://www.opengl.org/wiki/Shader\" rel=\"nofollow\">shaders</a> and cannot make use of the fixed function pipleline. The <code>glLoadIdentity</code> call refers to the deprecated matrix stack functionality which is also removed in core profiles.</p>\n\n<p>Your <code>glDrawArrays</code> call should generate a <code>GL_INVALID_OPERATION</code> because you have no program object and no VAO bound at the time of the draw call. I generally recommend to add GL error checks at least for debug builds. If the GL version you are targeting supports it, I recommend using a <a href=\"https://www.opengl.org/wiki/Debug_Output\" rel=\"nofollow\">debug context</a> instead. It will make spotting errors during development much easier.</p>\n\n<p>Also note that none of these issues a related to the switch from java with LWJGL to C++. If you used a legacy context /  core profile with java before, you could also do so in C++ (although I strongly advise you to learn modern GL instead), and you would have seen the same issues if you used a modern core profile context with LWJGL.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2547078"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 0, "accepted_answer_id": 34442250, "answer_count": 1, "score": 1, "last_activity_date": 1450898028, "creation_date": 1450896609, "question_id": 34441935, "link": "https://stackoverflow.com/questions/34441935/nothing-appears-on-screen-in-opengl-glfw-glew", "title": "Nothing appears on screen in OpenGL (GLFW/GLEW)", "body": "<p>Recently, I have been transitioning from LWJGL (which I am experienced with) to C++'s OpenGL API.  I fallowed <a href=\"http://www.opengl-tutorial.org/beginners-tutorials/tutorial-1-opening-a-window/\" rel=\"nofollow\" title=\"Opening a window\">this tutorial</a> since I could not get my vbo classes to work correctly.  The code is below:</p>\n\n<pre><code>#include \"GL/glew.h\"\n#include \"GLFW/glfw3.h\"\n\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nusing namespace std;\n\nGLFWwindow* window;\n\nvoid init()\n{\n\n}\n\nstatic const GLfloat g_vertex_buffer_data[] =\n{\n    -1.0f, -1.0f, 0.0f,\n    1.0f, -1.0f, 0.0f,\n    0.0f,  1.0f, 0.0f,\n};\n\nvoid render()\n{\n    glViewport(0, 0, 640, 480);\n    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n    glLoadIdentity();\n\n    GLuint vertexbuffer;\n    glGenBuffers(1, &amp;vertexbuffer);\n    glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer);\n    glBufferData(GL_ARRAY_BUFFER, sizeof(g_vertex_buffer_data), g_vertex_buffer_data, GL_STATIC_DRAW);\n    glEnableVertexAttribArray(0);\n    glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer);\n    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, (void*)0);\n    glDrawArrays(GL_TRIANGLES, 0, 3);\n    glDisableVertexAttribArray(0);\n    glDeleteBuffers(1, &amp;vertexbuffer);\n\n    glfwSwapBuffers(window);\n    glfwPollEvents();\n}\n\nstatic void errorCallback(int error, const char* desc)\n{\n    fputs(desc, stderr);\n}\n\nstatic void keyCallback(GLFWwindow* window, int key, int scanCode, int action, int mods)\n{\n    if (key == GLFW_KEY_ESCAPE &amp;&amp; action == GLFW_RELEASE)\n        glfwSetWindowShouldClose(window, GL_TRUE);\n}\n\nvoid initWindow()\n{\n    glfwSetErrorCallback(errorCallback);\n    if (!glfwInit())\n        exit(EXIT_FAILURE);\n    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 3);\n    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 3);\n    glfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);\n    glfwWindowHint(GLFW_RESIZABLE, GL_FALSE);\n    window = glfwCreateWindow(640, 480, \"Hello, world!\", NULL, NULL);\n\n    if (!window)\n    {\n        glfwTerminate();\n        exit(EXIT_FAILURE);\n    }\n\n    glfwMakeContextCurrent(window);\n    glfwSwapInterval(1);\n    glfwSetKeyCallback(window, keyCallback);\n\n    glewExperimental = true;\n    if (glewInit() != GLEW_OK)\n        exit(EXIT_FAILURE);\n}\n\nvoid destroyWindow()\n{\n    glfwDestroyWindow(window);\n    glfwTerminate();\n    exit(EXIT_SUCCESS);\n}\n\nint main(int argCount, char **args)\n{\n    initWindow();\n    init();\n    while (!glfwWindowShouldClose(window))\n        render();\n    destroyWindow();\n}\n</code></pre>\n\n<p>I have read through it over and over and looked around the internet.  However, other posts I've read are clearer mistakes.  I am probably making a really obvious mistake here, and I know how inefficient the fact that I create a buffer every frame is, however that is just to test and see if I can get it to work.  I would appreciate if somebody could tell me what I am doing wrong here!</p>\n"}, {"tags": ["c++", "pointers"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 2, "creation_date": 1450896710, "post_id": 34441930, "comment_id": 56625452, "body": "Think about which values of <code>curr</code> you&#39;re actually printing."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1450897145, "post_id": 34441930, "comment_id": 56625654, "body": "It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming.  Further reading: <b><a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a></b>"}], "answers": [{"tags": [], "owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "is_accepted": true, "score": 2, "last_activity_date": 1450896909, "creation_date": 1450896909, "answer_id": 34442001, "question_id": 34441930, "link": "https://stackoverflow.com/questions/34441930/why-my-incrementation-not-happening-to-the-last-element/34442001#34442001", "title": "Why my incrementation not happening to the last element?", "body": "<p>Let's explain this with the first iteration of the loop:</p>\n\n<ol>\n<li>Condition evaluates as <code>true</code>, body is executed.</li>\n<li>Increment value at <code>*curr</code> by one.</li>\n<li>Increment <code>curr</code> by one to point to the next array member.</li>\n<li>Print <strong>this next</strong> array member; <strong>the first member never gets printed!</strong></li>\n</ol>\n\n<p>The <code>0</code> is an instance of undefined behavior; while just <em>pointing</em> one beyond an array is well-defined, <em>accessing</em> the value at that address is undefined.</p>\n\n<p>The 3<sup>rd</sup> step is done too early. Exchange the 3<sup>rd</sup> with the 4<sup>th</sup> and you're fine.</p>\n"}], "owner": {"reputation": 83, "user_id": 3792934, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/7d6951e8cfde5c504b11d54dbe0f6651?s=128&d=identicon&r=PG&f=1", "display_name": "Greatgoing", "link": "https://stackoverflow.com/users/3792934/greatgoing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 34442001, "answer_count": 1, "score": -3, "last_activity_date": 1450896909, "creation_date": 1450896604, "question_id": 34441930, "link": "https://stackoverflow.com/questions/34441930/why-my-incrementation-not-happening-to-the-last-element", "title": "Why my incrementation not happening to the last element?", "body": "<p>This is my code trying to increment the elements by 1 using pointer. My last element is not getting incremented. Could you please tell me why</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n\nvoid print_all( int *start,  int *stop)\n { \n  int *curr = start;\n  while(curr != stop)\n      {\n    ++(*curr);\n    ++curr;\n    cout&lt;&lt; \"\\n\"&lt;&lt;\"content at address \"&lt;&lt;curr&lt;&lt;\" got incremented to \"&lt;&lt; *curr&lt;&lt;\"\\n\";    \n      }\n}\n\n\n int main()\n  { \n   int a[] = {3,4,5};\n   print_all(a, a+3);\n   return 0;\n\n  }\n</code></pre>\n\n<p>OUTPUT:</p>\n\n<pre><code>content at address 0x7ffe3ded3eb4 got incremented to 4\n\ncontent at address 0x7ffe3ded3eb8 got incremented to 5\n\ncontent at address 0x7ffe3ded3ebc got incremented to 0\n</code></pre>\n"}, {"tags": ["c++", "hashtable"], "comments": [{"owner": {"reputation": 7789, "user_id": 2357837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/035467770d62d867f62487dc025f043d?s=128&d=identicon&r=PG", "display_name": "ChronoTrigger", "link": "https://stackoverflow.com/users/2357837/chronotrigger"}, "edited": false, "score": 1, "creation_date": 1450896235, "post_id": 34441811, "comment_id": 56625196, "body": "<code>return it-&gt;second;</code>"}, {"owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "edited": false, "score": 0, "creation_date": 1450896349, "post_id": 34441811, "comment_id": 56625254, "body": "And you don&#39;t have all control paths covered. Please, show the precise type of <code>hTabTickets</code>."}], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 4888947, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/1kvko.jpg?s=128&g=1", "display_name": "Perseverance", "link": "https://stackoverflow.com/users/4888947/perseverance"}, "edited": false, "score": 0, "creation_date": 1450897332, "post_id": 34442038, "comment_id": 56625737, "body": "invalid conversion from &#39;const Ticket*&#39; to &#39;Ticket*&#39; [-fpermissive]"}, {"owner": {"reputation": 7789, "user_id": 2357837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/035467770d62d867f62487dc025f043d?s=128&d=identicon&r=PG", "display_name": "ChronoTrigger", "link": "https://stackoverflow.com/users/2357837/chronotrigger"}, "reply_to_user": {"reputation": 307, "user_id": 4888947, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/1kvko.jpg?s=128&g=1", "display_name": "Perseverance", "link": "https://stackoverflow.com/users/4888947/perseverance"}, "edited": false, "score": 0, "creation_date": 1450898030, "post_id": 34442038, "comment_id": 56626059, "body": "If <code>tickets</code> or <code>findTicketByFanID</code> is <code>const</code>, you can&#39;t (or shouldn&#39;t) return a non-const pointer. Change the return type of the function to <code>const Ticket*</code>."}], "tags": [], "owner": {"reputation": 7789, "user_id": 2357837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/035467770d62d867f62487dc025f043d?s=128&d=identicon&r=PG", "display_name": "ChronoTrigger", "link": "https://stackoverflow.com/users/2357837/chronotrigger"}, "is_accepted": false, "score": 0, "last_activity_date": 1450897054, "creation_date": 1450897054, "answer_id": 34442038, "question_id": 34441811, "link": "https://stackoverflow.com/questions/34441811/get-value-from-hash-table/34442038#34442038", "title": "get value from hash table", "body": "<p>Maybe you want this:</p>\n\n<pre><code>Ticket* Championship::findTicketByFanID(unsigned int id) {\n  for (hTabTickets::iterator it = tickets.begin(); it != tickets.end(); ++it) {\n      if(it-&gt;getOwnerID() == id)\n          return &amp;(*it);\n  }\n  return NULL;\n}\n</code></pre>\n\n<p>If you search for an id very frequently, you may want to change that <code>set</code> for a <code>map</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 388, "user_id": 5712286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcce814578cc59de0063da9b24fd0219?s=128&d=identicon&r=PG&f=1", "display_name": "Erobrere", "link": "https://stackoverflow.com/users/5712286/erobrere"}, "is_accepted": false, "score": 0, "last_activity_date": 1450897951, "last_edit_date": 1450897951, "creation_date": 1450897619, "answer_id": 34442155, "question_id": 34441811, "link": "https://stackoverflow.com/questions/34441811/get-value-from-hash-table/34442155#34442155", "title": "get value from hash table", "body": "<p>References come to a great use here. Typically returning a local pointer is not a good idea. An example for your case is given below. Two problems with your the code: (a) not all paths return value and (b) hash table should locate quickly (ideally O(1)), so looping is a bad idea. Further, <code>it</code> is not being incremented in the loop.</p>\n\n<pre><code>class Campeonato {\n    // Using STL hashmap\n    map&lt;unsigned int, int&gt; tickets;\n\n    public:       \n    // the return value tells you whether to use iterator or not.\n    bool findTicketByFanID(unsigned int id, map&lt;unsigned int, int&gt;::iterator &amp;it) {\n        // std::map provides method find\n        it = tickets.find(id);\n        if (it != tickets.end())\n            return true;\n\n        return false;\n    }\n};    \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 0, "last_activity_date": 1450898610, "creation_date": 1450898610, "answer_id": 34442386, "question_id": 34441811, "link": "https://stackoverflow.com/questions/34441811/get-value-from-hash-table/34442386#34442386", "title": "get value from hash table", "body": "<blockquote>\n  <p>I want to be able to do this so I can do Ticket t1 = findTicketByFan(id);</p>\n</blockquote>\n\n<p>If it is your intention, return type is not correct, it should return by value or (const) reference, not pointer. Another issue, you use <code>std::unordered::set</code> and try to search in a loop, but you should use <code>std::unordered_set::find()</code> instead:</p>\n\n<pre><code>Ticket Championship::findTicketByFanID(unsigned int id) \n{\n    hTabTickets::iterator it = tickets.find( Ticket( id ) );\n    if( it == tickets.end() ) // not found do something\n        throw std::runtime_error( \"Ticket not found\" );\n    return *it;\n}\n</code></pre>\n\n<p>if creating temporary ticket is too expensive, you should use <code>std::unordered_map&lt;int,Ticket&gt;</code> instead and use id as a key. Then this function would be:</p>\n\n<pre><code>Ticket Championship::findTicketByFanID(unsigned int id) \n{\n    hTabTickets::iterator it = tickets.find( id );\n    if( it == tickets.end() ) // not found do something\n        throw std::runtime_error( \"Ticket not found\" );\n    return it-&gt;second;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 862, "user_id": 3943956, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/491b0b6ba7087082a5b2ac071560373d?s=128&d=identicon&r=PG&f=1", "display_name": "ALEXANDER KONSTANTINOV", "link": "https://stackoverflow.com/users/3943956/alexander-konstantinov"}, "is_accepted": false, "score": 0, "last_activity_date": 1450902060, "creation_date": 1450902060, "answer_id": 34443119, "question_id": 34441811, "link": "https://stackoverflow.com/questions/34441811/get-value-from-hash-table/34443119#34443119", "title": "get value from hash table", "body": "<pre><code>hTabTickets::iterator it = tickets.begin()\n</code></pre>\n\n<p>'it' variable's type neither a Ticket, neither a Ticket*, it's a pair which contains key and value variables, you are using it wrong, probably you need to write:</p>\n\n<pre><code>it-&gt;second    \n</code></pre>\n\n<p>to access the Ticket itself</p>\n"}], "owner": {"reputation": 307, "user_id": 4888947, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/1kvko.jpg?s=128&g=1", "display_name": "Perseverance", "link": "https://stackoverflow.com/users/4888947/perseverance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 819, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1450902060, "creation_date": 1450896121, "last_edit_date": 1450896839, "question_id": 34441811, "link": "https://stackoverflow.com/questions/34441811/get-value-from-hash-table", "title": "get value from hash table", "body": "<pre><code>Ticket* Championship::findTicketByFanID(unsigned int id) {\n\n    hTabTickets::iterator it = tickets.begin();\n\n    while(it != tickets.end()) {\n        if(it-&gt;getOwnerID() == id)\n            return it;\n    }\n\n}\n</code></pre>\n\n<p>Hello there</p>\n\n<p>I'd like to return the object that is on <strong>iterator</strong> it. <strong>tickets</strong> is an hash table that holds objects of the type <strong>Ticket</strong>. When I search for that, there is any solution to return that object? </p>\n\n<p>I want to be able to do this so I can do <code>Ticket t1 = findTicketByFan(id);</code></p>\n\n<p>hTabTickets:</p>\n\n<pre><code>struct eqTicket {\n    bool operator() (const Ticket &amp;b1, const Ticket &amp;b2) const{\n        return b1.getID() == b2.getID();\n    }\n};\n\nstruct hTicket{\n    int operator() (const Ticket &amp;b1) const{\n        return b1.getID();\n    }\n\n\n};\n\ntypedef tr1::unordered_set&lt;Bilhete, hTicket, eqTicket&gt; hTabTickets;\n</code></pre>\n\n<p>Regards</p>\n"}, {"tags": ["c++", "nullptr"], "comments": [{"owner": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "edited": false, "score": 1, "creation_date": 1450894993, "post_id": 34441497, "comment_id": 56624627, "body": "Please don&#39;t edit &quot;Solved&quot; into question titles. Instead, accept the answer that was helpful to you (click the green check mark below the number of votes it has received)."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1450895794, "post_id": 34441497, "comment_id": 56625011, "body": "Almost a dupe: <a href=\"http://stackoverflow.com/q/21510121/179910\">stackoverflow.com/q/21510121/179910</a>"}], "answers": [{"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 15, "last_activity_date": 1450896485, "last_edit_date": 1495540429, "creation_date": 1450894778, "answer_id": 34441522, "question_id": 34441497, "link": "https://stackoverflow.com/questions/34441497/expected-unqualified-id-before-nullptr/34441522#34441522", "title": "Expected unqualified-id before \u2018nullptr\u2019", "body": "<p><a href=\"https://stackoverflow.com/q/21510121/179910\"><code>nullptr</code>, unlike <code>nullptr_t</code>, does not need <code>std::</code> prefix</a>. The reason for this is that nullptr is a literal, and is not defined in namespace <code>std</code>, same way 42 is not defined there. Nor it requires any include directives to be used.</p>\n\n<p>On the other hand, <code>nullptr_t</code> is a type, defined in namespace <code>std</code>, and requires <code>&lt;cstddef&gt;</code> to be included.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4833046"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2686, "favorite_count": 0, "accepted_answer_id": 34441522, "answer_count": 1, "score": 6, "last_activity_date": 1450896485, "creation_date": 1450894687, "last_edit_date": 1450895396, "question_id": 34441497, "link": "https://stackoverflow.com/questions/34441497/expected-unqualified-id-before-nullptr", "title": "Expected unqualified-id before \u2018nullptr\u2019", "body": "<p>I tried to implement BST but <code>std::nullptr</code> shows me an error:</p>\n\n<blockquote>\n  <p>error: expected unqualified-id before \u2018nullptr\u2019</p>\n</blockquote>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\n\ntemplate &lt;typename T&gt;\nclass BinTreeNode {\npublic: \n    BinTreeNode(T key): data {key} {\n        left = std::nullptr;\n        right = std::nullptr; \n    }\n    ~BinTreeNode() {}\n    T data;\n    BinTreeNode&lt;T&gt;* left;\n    BinTreeNode&lt;T&gt;* right;\n};\n\ntemplate &lt;typename T&gt;\nclass BinTree {\npublic:\n    BinTree(){ \n        root = std::nullptr;\n    }\n    ~BinTree() {}\n    BinTreeNode&lt;T&gt;* root;\n};\n\nint main(){\n    BinTree&lt;int&gt; tree;\n}\n</code></pre>\n\n<p>I have tried searching it up in Google but nothing meaningful came up related to <code>std::nullptr</code></p>\n"}, {"tags": ["c++", "rvalue-reference"], "comments": [{"owner": {"reputation": 41100, "user_id": 1938163, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/WV0Fi.png?s=128&g=1", "display_name": "Marco A.", "link": "https://stackoverflow.com/users/1938163/marco-a"}, "edited": false, "score": 1, "creation_date": 1450895019, "post_id": 34441456, "comment_id": 56624645, "body": "If you don&#39;t want an object to be &quot;stolen from&quot; when passed as parameter either don&#39;t pass it as a parameter or rely on the fact that lvalues don&#39;t bind to rvalue references (<a href=\"http://coliru.stacked-crooked.com/a/e05851d887896a53\" rel=\"nofollow noreferrer\">example</a>)"}, {"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "reply_to_user": {"reputation": 41100, "user_id": 1938163, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/WV0Fi.png?s=128&g=1", "display_name": "Marco A.", "link": "https://stackoverflow.com/users/1938163/marco-a"}, "edited": false, "score": 1, "creation_date": 1450895527, "post_id": 34441456, "comment_id": 56624879, "body": "@MarcoA.  I don&#39;t want a compile time error.  I want correctly working code.  (Actually I do want a compile time error when I incorrectly pass an object to a stealing function.  I think my design covers that.  But I want a correct way to pass those, meaning a way to make a copy for the purpose of having that copy stolen from)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 1, "creation_date": 1450896436, "post_id": 34441456, "comment_id": 56625304, "body": "How about defining <code>T&amp;&amp; merge_XYZ(T a, T b)</code> ? Would that work? With no move() it would create a temp, and with move() it would call &amp;&amp; version."}, {"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 1, "creation_date": 1450896768, "post_id": 34441456, "comment_id": 56625489, "body": "@Arkadiy, I think that expands into three extra versions of each of several functions:  <code>(T a, T&amp;&amp;b)</code> <code>(T&amp;&amp;a, T b)</code> etc. each forwarding to the real one.  Then if I make a call incorrectly, I silently get the inefficient version instead of a compile time error telling me what needs to be fixed."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 2, "creation_date": 1450897010, "post_id": 34441456, "comment_id": 56625592, "body": "Does your T have a move constructor? If so, then you may as well always pass by value and let T::T(T&amp;&amp;) take care of it."}, {"owner": {"reputation": 58446, "user_id": 84704, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/aEXJK.png?s=128&g=1", "display_name": "Warren  P", "link": "https://stackoverflow.com/users/84704/warren-p"}, "edited": false, "score": 1, "creation_date": 1450897460, "post_id": 34441456, "comment_id": 56625787, "body": "My head hurts. I guess I&#39;m glad I never ever want to do anything like this."}], "answers": [{"comments": [{"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1450897913, "post_id": 34441963, "comment_id": 56625994, "body": "I&#39;m almost ready to believe your answer combined with the comment Arkadily made combined with one more detail (maybe obvious) is workable:  Pass and return by value.  But typically forward with <code>std::move</code>.  Trust the combination of <code>T::T(T&amp;&amp;)</code> and copy elision to solve cases (recursive forwarding) that I&#39;m pretty sure copy elision alone can&#39;t solve.  I may need to test some optimized dummy code with <code>cout</code> side effects that should be elided to wrap my head around it."}, {"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1450898483, "post_id": 34441963, "comment_id": 56626314, "body": "But after a bit more thought, I&#39;m too bothered by the risk of silent accidental copies.  I prefer a design in which the copy constructor is never called unless you intended it to be.  I understand that trades off against the risk of dangling references.  I&#39;ll give that more thought."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1450899163, "post_id": 34441963, "comment_id": 56626624, "body": "@JSF I get the disconcerting feeling that you&#39;re going against the current state of the art. In a nutshell, what are you really trying to achieve?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1450905248, "post_id": 34441963, "comment_id": 56629330, "body": "it probably should be <code>return std::move( x );</code>"}, {"owner": {"reputation": 21240, "user_id": 951423, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/UlSg8.png?s=128&g=1", "display_name": "Pixelchemist", "link": "https://stackoverflow.com/users/951423/pixelchemist"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1450908494, "post_id": 34441963, "comment_id": 56630743, "body": "@Slava: The return value will be moved anyway, if possible."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1450910179, "post_id": 34441963, "comment_id": 56631400, "body": "@slava no, it should <i>never</i> be return <code>std::move(x)</code> because that defeats RVO."}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 4, "last_activity_date": 1450896711, "creation_date": 1450896711, "answer_id": 34441963, "question_id": 34441456, "link": "https://stackoverflow.com/questions/34441456/create-a-temporary-to-pass-to-rvalue-reference/34441963#34441963", "title": "Create a temporary to pass to rvalue reference", "body": "<blockquote>\n  <p>Main question: Is T(x) the right way to force a temporary copy to be created at that point? </p>\n</blockquote>\n\n<p>Yes</p>\n\n<blockquote>\n  <p>Is T temp = the correct way to make sure the call to merge_QRS in the above code occurs before the call to merge_MNO but otherwise inexpensively forward the temporary from that into the first operand of merge_XYZ?</p>\n</blockquote>\n\n<p>Yes</p>\n\n<blockquote>\n  <p>If I used T&amp;&amp; temp instead does it end up holding a pointer to modified T(x) after the life of T(x)?</p>\n</blockquote>\n\n<p>Yes. That's dangling reference which unfortunately the compiler won't catch.</p>\n\n<blockquote>\n  <p>Is T&amp;&amp; the right return type (as opposed to T) for chaining a lot of these together?</p>\n</blockquote>\n\n<p>To be honest, it doesn't smell good to me.</p>\n\n<p>You may want to reconsider your data model to be something more standard, i.e.:</p>\n\n<pre><code>T merge(T x, T y)\n{\n  // do some merging\n  return x;\n}\n</code></pre>\n\n<p>Copy-elision and RVO will eliminate any redundant copies. Now you can move items in, pass copies or pass temporaries. There's only one piece of logic to maintain and your code has value-semantics... which is <em>always better</em> (TM).</p>\n"}, {"tags": [], "owner": {"reputation": 21240, "user_id": 951423, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/UlSg8.png?s=128&g=1", "display_name": "Pixelchemist", "link": "https://stackoverflow.com/users/951423/pixelchemist"}, "is_accepted": false, "score": 0, "last_activity_date": 1450917757, "last_edit_date": 1450917757, "creation_date": 1450904137, "answer_id": 34443585, "question_id": 34441456, "link": "https://stackoverflow.com/questions/34441456/create-a-temporary-to-pass-to-rvalue-reference/34443585#34443585", "title": "Create a temporary to pass to rvalue reference", "body": "<p><strong>tl;dr:</strong> With value semantics you get:</p>\n\n<ul>\n<li>moves happening where possible </li>\n<li>No need to explictly copy arguments</li>\n<li>No dangling references in case of passing prvalues to the function</li>\n</ul>\n\n<p>Consider</p>\n\n<pre><code>struct X \n{ \n  X() = default;\n  X(int y) : a(y) {}\n  X(X &amp;&amp;r) : a(r.a) { std::cout &lt;&lt; \"move X...\"; }\n  X(X const &amp;r) : a(r.a) { std::cout &lt;&lt; \"copy X...\";  }\n  int a; \n}; \n</code></pre>\n\n<p>with <code>foo</code>:</p>\n\n<pre><code>X&amp;&amp; foo(X &amp;&amp;a) { return std::move(a); }\n</code></pre>\n\n<p>and and <code>bar</code>:</p>\n\n<pre><code>X bar(X a) { return a; }\n</code></pre>\n\n<p>Then when executing the following Code:</p>\n\n<pre><code>std::cout &lt;&lt; \"foo:\\n\";\nX x{ 55 };\nstd::cout &lt;&lt; \"a: \";\nX &amp;&amp; a = foo(std::move(x)); // fine\nstd::cout &lt;&lt; \"\\nb: \";\nX &amp;&amp; b = foo(X(x)); // !! dangling RV is not prvalue but xvalue\nstd::cout &lt;&lt; \"\\nc: \";\nX c = foo(std::move(x)); // fine, copy\nstd::cout &lt;&lt; \"\\nd: \";\nX d = foo(X(x)); // fine\nstd::cout &lt;&lt; \"\\ne: \";\nX &amp;&amp; e = foo(X{ 12 }); // !! dangling...\nstd::cout &lt;&lt; \"\\nf: \";\nX f = foo(X{ 12 }); // fine\n\nstd::cout &lt;&lt; \"\\n\\nbar:\\n\";\nX y{ 55 };\nstd::cout &lt;&lt; \"a: \";\nX &amp;&amp; q = bar(std::move(y)); // fine\nstd::cout &lt;&lt; \"\\nb: \";\nX &amp;&amp; r = bar(y); // no explict copy required, supported by syntax\nstd::cout &lt;&lt; \"\\nc: \";\nX s = bar(std::move(y)); // fine\nstd::cout &lt;&lt; \"\\nd: \";\nX t = bar(y); // fine, no explict copy required either\nstd::cout &lt;&lt; \"\\ne: \";\nX &amp;&amp; u = bar(X{ 12 }); // fine\nstd::cout &lt;&lt; \"\\nf: \";\nX v = bar(X{ 12 }); // fine\nstd::cout &lt;&lt; \"\\n\";\n</code></pre>\n\n<p>we obtain</p>\n\n<pre><code>foo:\na:\nb: copy X...\nc: move X...\nd: copy X...move X...\ne:\nf: move X...\n\nbar :\na: move X...move X...\nb: copy X...move X...\nc: move X...move X...\nd: copy X...move X...\ne: move X...\nf: move X...\n</code></pre>\n\n<p>on VS 2015 and g++ 5.2.</p>\n\n<p>So the only copies made (with <code>bar</code>) are in cases b and d, which is the desired behaviour anyway but you get rid of the possibly dangling references at the cost of 1-2 moves per operation (which afaik even may be optimized out in some cases as well).</p>\n"}], "owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 2, "answer_count": 2, "score": 5, "last_activity_date": 1450917757, "creation_date": 1450894465, "last_edit_date": 1450896504, "question_id": 34441456, "link": "https://stackoverflow.com/questions/34441456/create-a-temporary-to-pass-to-rvalue-reference", "title": "Create a temporary to pass to rvalue reference", "body": "<p>I want to code several recursively interacting merge functions, which I think should have signatures:  <code>T&amp;&amp; merge_XYZ(T&amp;&amp; a, T&amp;&amp; b);</code>  </p>\n\n<p>They will tend to be used recursively with lines such as:</p>\n\n<pre><code>return merge_XYZ( std::move(x), std::move(y) );\n</code></pre>\n\n<p>Each of these several merge functions will steal the contents of one of the inputs and inject those contents into the other input and return the result.  Typically, they will have <code>x</code> and <code>y</code> which are names for what were rvalue references and thus should be converted back to rvalue references by <code>std::move</code> (correct me if I'm wrong).  </p>\n\n<p>But rarely, they have <code>x</code> and or <code>y</code> that are references to objects whose contents must not be stolen.  I definitely don't want to write alternate non stealing versions of these functions.  Rather, I want the caller to deal with that in these rare cases.  So my main question is whether the correct way to do that is to explicitly invoke copy construction, such as:</p>\n\n<pre><code>T temp = merge_QRS( T(x), T(y) ); // use x and y without stealing yet\nreturn merge_XYZ( merge_MNO( std::move(x), std::move(y) ), std::move(temp) );\n</code></pre>\n\n<p>Main question:  Is <code>T(x)</code> the right way to force a temporary copy to be created at that point?</p>\n\n<p>Other questions:<br>\nIs <code>T temp =</code> the correct way to make sure the call to <code>merge_QRS</code> in the above code occurs before the call to <code>merge_MNO</code> but otherwise inexpensively forward the temporary from that into the first operand of <code>merge_XYZ</code>?  If I used <code>T&amp;&amp; temp</code> instead does it end up holding a pointer to modified <code>T(x)</code> after the life of <code>T(x)</code>?</p>\n\n<p>Is <code>T&amp;&amp;</code> the right return type (as opposed to <code>T</code>) for chaining a lot of these together?  </p>\n\n<p>How does the above compare to:</p>\n\n<pre><code>T tx = x;\nT&amp;&amp; temp = merge_QRS( std::move(tx), T(y) ); // use x and y without stealing yet\nreturn merge_XYZ( merge_MNO( std::move(x), std::move(y) ), std::move(temp) );\n</code></pre>\n\n<p>Assuming <code>merge_QRS</code> will be modifying tx and returning an rvalue reference to that, is that behavior all defined?  </p>\n\n<p>Writing this question may have helped me realize I could be mixing together two situations that ought not to be mixed:  Object you don't want to steal from vs. objects you don't want to steal from <strong>yet</strong>.  Is my original <code>merge_QRS( T(y), T(x))</code> right (only if consumed within the same expression) for objects I don't want to steal from?  But in the case I tried as an example should I have the following:  </p>\n\n<pre><code>T tx = x;  // Make copies which can be stolen from\nT ty = y;\nreturn merge_XYZ( merge_MNO( std::move(x), std::move(y) ),\n                  merge_QRS( std::move(tx), std::move(ty) ) );\n</code></pre>\n\n<p>I think I may still be confused about stealing the contents vs. stealing the identity.  If I return by <code>T&amp;&amp;</code> I'm stealing the identity of one input in addition to stealing the contents of the other.  When do I get away with stealing an identity?  If I return by <code>T</code> I'm never stealing an identity, and sometimes failing to steal an identity is inefficient.</p>\n"}, {"tags": ["c++", "c++11", "struct", "language-lawyer"], "comments": [{"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 1, "creation_date": 1450894490, "post_id": 34441422, "comment_id": 56624381, "body": "I don&#39;t know about the standard, but - some of this may be optimized away. In fact, if you don&#39;t use the 0&#39;s, maybe <i>all</i> of this is optimized away."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1450894499, "post_id": 34441422, "comment_id": 56624386, "body": "There&#39;s an explicit rule in there that allows braces on the right hand of an assignment. Your assumption is pretty much correct."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1450914164, "post_id": 34441422, "comment_id": 56632742, "body": "There is no such thing as &quot;re-initializing&quot;. You initialize something once. Just once. What you&#39;re doing is assignment and is very different in subtle and not-so-subtle ways."}, {"owner": {"reputation": 3682, "user_id": 179895, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5df4f9f84d4aefc2171d33bbc417106b?s=128&d=identicon&r=PG", "display_name": "TripShock", "link": "https://stackoverflow.com/users/179895/tripshock"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1450917651, "post_id": 34441422, "comment_id": 56633619, "body": "@LightnessRacesinOrbit I guess what I meant is &quot;resetting&quot;. Basically I want to set it back to the same state as an object that is initialized with <code>= {};</code>."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1450929237, "post_id": 34441422, "comment_id": 56636065, "body": "Another issue is padding. Zero-initialization will zero the padding, but assignment is not required to copy it."}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 20, "last_activity_date": 1450895106, "last_edit_date": 1450895106, "creation_date": 1450894798, "answer_id": 34441528, "question_id": 34441422, "link": "https://stackoverflow.com/questions/34441422/zero-reinitializing-a-struct-in-c/34441528#34441528", "title": "Zero-reinitializing a struct in C++", "body": "<p>What you are looking for is in [expr.ass]</p>\n\n<blockquote>\n  <p>A <em>braced-init-list</em> may appear on the right-hand side of</p>\n  \n  <ul>\n  <li>an assignment to a scalar, in which case the initializer list shall have at most a single element. The\n  meaning of <code>x={v}</code>, where T is the scalar type of the expression x, is that of <code>x=T{v}</code>. The meaning of\n  <code>x={}</code> is <code>x=T{}</code>.</li>\n  <li>an assignment to an object of class type, in which case the initializer list is passed as the argument to\n  the assignment operator function selected by overload resolution (13.5.3, 13.3).</li>\n  </ul>\n</blockquote>\n\n<p>So your guess is correct.  The compiler may be able to optimize things away but you can think of it as create a zero-initialized temporary and pass it to the <code>operator=</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 2, "creation_date": 1450907793, "post_id": 34442662, "comment_id": 56630441, "body": "Why not use your <code>hoped</code> for resolution explicitly. <code>s = SomeStruct{}</code>? That seems clearer than a function call to <code>reset()</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 1, "creation_date": 1450908251, "post_id": 34442662, "comment_id": 56630646, "body": "@LokiAstari well, we might be far from the declaration of <code>s</code> so it&#39;s not so easy to check that this actually does the right thing.  If we accidentally put <code>s = SomeOtherStruct{};</code> then other odd effects could happen.  I try to use code patterns that minimise the possibility for mistakes (particularly, non-obvious mistakes). I guess the <code>decltype</code> version is best really. I find that unaesthetic but perhaps I need to update my aesthetics"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1450917917, "post_id": 34442662, "comment_id": 56633709, "body": "I take your point about <code>SomeOtherStruct{}</code>. Then it does more sense for the <code>decltype</code> but that still looks ugly (and aesthetics are important)."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 13, "last_activity_date": 1450899878, "last_edit_date": 1495541342, "creation_date": 1450899878, "answer_id": 34442662, "question_id": 34441422, "link": "https://stackoverflow.com/questions/34441422/zero-reinitializing-a-struct-in-c/34442662#34442662", "title": "Zero-reinitializing a struct in C++", "body": "<p><code>s = {};</code> is not safe. </p>\n\n<p>The problem is that you <em>hope</em> it turns into <code>s = SomeStruct{};</code> . However, if <code>s</code> has another overload for <code>operator=</code> <a href=\"https://stackoverflow.com/questions/33511641/overload-resolution-assignment-of-empty-braces\">then that may be preferred by overload resolution</a>.</p>\n\n<p>So this is an anti-pattern, really.   As suggested on the other thread, you're better off writing a function, e.g.:</p>\n\n<pre><code>template&lt;typename T&gt; void reset(T &amp;t) { t = T{}; }\n</code></pre>\n\n<p>I guess you could also write <code>s = decltype(s){};</code>, so long as <code>s</code> was not a reference.</p>\n"}], "owner": {"reputation": 3682, "user_id": 179895, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5df4f9f84d4aefc2171d33bbc417106b?s=128&d=identicon&r=PG", "display_name": "TripShock", "link": "https://stackoverflow.com/users/179895/tripshock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1120, "favorite_count": 4, "accepted_answer_id": 34441528, "answer_count": 2, "score": 22, "last_activity_date": 1450899878, "creation_date": 1450894287, "last_edit_date": 1450896381, "question_id": 34441422, "link": "https://stackoverflow.com/questions/34441422/zero-reinitializing-a-struct-in-c", "title": "Zero-reinitializing a struct in C++", "body": "<p>A POD <code>struct</code> can be zero-initialized in C++11 as follows:</p>\n\n<pre><code>SomeStruct s{};\n</code></pre>\n\n<p>However, what do I do if I already have an instance of the struct and I want to re-initialize it to zeros? The following seems to work:</p>\n\n<pre><code>s = {};\n</code></pre>\n\n<p>Can someone point out the relevant standardese? I assume this is what is happening:</p>\n\n<ol>\n<li>A new zero-initialized instance gets created.</li>\n<li>The new instance is assigned to the existing instance, invoking the implicit assignment operator.</li>\n</ol>\n"}, {"tags": ["c++", "libuv"], "comments": [{"owner": {"reputation": 6642, "user_id": 434233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/y6HxN.png?s=128&g=1", "display_name": "Arunmu", "link": "https://stackoverflow.com/users/434233/arunmu"}, "edited": false, "score": 1, "creation_date": 1450896523, "post_id": 34441395, "comment_id": 56625352, "body": "I dont think its correct to pass a functor to a C API expecting a function pointer. You need to write wrappers to do the needful conversion. Having said that, you could use lambda function with &#39;no captures&#39; if you are using c++11. But considering the size of your callback, that doesnt make sense nor is a right thing to do."}, {"owner": {"reputation": 6642, "user_id": 434233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/y6HxN.png?s=128&g=1", "display_name": "Arunmu", "link": "https://stackoverflow.com/users/434233/arunmu"}, "edited": false, "score": 0, "creation_date": 1450896666, "post_id": 34441395, "comment_id": 56625429, "body": "Between, why do you want to use functor for this when you do not have any state to maintain, nor you are calling it within STL algorithm. Nor it seems likely that it would be a candidate for inlining."}, {"owner": {"reputation": 105, "user_id": 2663938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K7BR0.jpg?s=128&g=1", "display_name": "Paul Herman", "link": "https://stackoverflow.com/users/2663938/paul-herman"}, "reply_to_user": {"reputation": 6642, "user_id": 434233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/y6HxN.png?s=128&g=1", "display_name": "Arunmu", "link": "https://stackoverflow.com/users/434233/arunmu"}, "edited": false, "score": 0, "creation_date": 1450896678, "post_id": 34441395, "comment_id": 56625436, "body": "The reason I wanted to do this is because I needed some context in the function to call a different callback of my own. Is there any other way of providing some context in this callback?"}, {"owner": {"reputation": 105, "user_id": 2663938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K7BR0.jpg?s=128&g=1", "display_name": "Paul Herman", "link": "https://stackoverflow.com/users/2663938/paul-herman"}, "reply_to_user": {"reputation": 6642, "user_id": 434233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/y6HxN.png?s=128&g=1", "display_name": "Arunmu", "link": "https://stackoverflow.com/users/434233/arunmu"}, "edited": false, "score": 0, "creation_date": 1450896819, "post_id": 34441395, "comment_id": 56625516, "body": "I edited the question so that the state is explicit, even though it is a placeholder."}, {"owner": {"reputation": 6642, "user_id": 434233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/y6HxN.png?s=128&g=1", "display_name": "Arunmu", "link": "https://stackoverflow.com/users/434233/arunmu"}, "edited": false, "score": 1, "creation_date": 1450897201, "post_id": 34441395, "comment_id": 56625681, "body": "I am not familiar with libuv API&#39;s. Ideally such frameworks provide something equivalent to void* for callers to store their information. Please look for that. Else, you need to do something like <a href=\"http://stackoverflow.com/questions/1840029/passing-functor-as-function-pointer\" title=\"passing functor as function pointer\">stackoverflow.com/questions/1840029/&hellip;</a> and match the function signature as expected by libuv."}, {"owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 0, "creation_date": 1450897962, "post_id": 34441395, "comment_id": 56626023, "body": "I personally think that libuv is getting more attention then it should. consider to move into different library.."}, {"owner": {"reputation": 105, "user_id": 2663938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K7BR0.jpg?s=128&g=1", "display_name": "Paul Herman", "link": "https://stackoverflow.com/users/2663938/paul-herman"}, "reply_to_user": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 0, "creation_date": 1450898465, "post_id": 34441395, "comment_id": 56626301, "body": "Do you have any suggestions @david-haim? I&#39;m willing to switch as long as it supports both unix and Windows."}, {"owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 0, "creation_date": 1450898540, "post_id": 34441395, "comment_id": 56626348, "body": "what exactly is your goal? general async-io libray? server side library?"}, {"owner": {"reputation": 105, "user_id": 2663938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K7BR0.jpg?s=128&g=1", "display_name": "Paul Herman", "link": "https://stackoverflow.com/users/2663938/paul-herman"}, "edited": false, "score": 0, "creation_date": 1450898621, "post_id": 34441395, "comment_id": 56626392, "body": "I need a TCP async library - server side. Its performance doesn&#39;t really matter that much at this stage as it&#39;s just a prototype."}, {"owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 0, "creation_date": 1450898746, "post_id": 34441395, "comment_id": 56626450, "body": "hmmm.. it&#39;s a bit of a problem if it has to be both cross platform and asynchronous. look at zeromq and casablanca"}, {"owner": {"reputation": 6642, "user_id": 434233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/y6HxN.png?s=128&g=1", "display_name": "Arunmu", "link": "https://stackoverflow.com/users/434233/arunmu"}, "edited": false, "score": 0, "creation_date": 1450932594, "post_id": 34441395, "comment_id": 56636767, "body": "Why not Boost Asio ??"}, {"owner": {"reputation": 6642, "user_id": 434233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/y6HxN.png?s=128&g=1", "display_name": "Arunmu", "link": "https://stackoverflow.com/users/434233/arunmu"}, "reply_to_user": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 0, "creation_date": 1450934042, "post_id": 34441395, "comment_id": 56637115, "body": "@DavidHaim I am curious to know why you think libuv is getting more attention than in it should? I haven&#39;t personally used it, but googling around gives me a pretty good impression about it, even though its a C library (not apt for this question as its tagged C++)"}, {"owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 0, "creation_date": 1451028468, "post_id": 34441395, "comment_id": 56663787, "body": "1) Because it&#39;s C library, 2) Because people talk abot it as panacea just becasue of node.js 3) because it has nasty-old-callback style API 4)because it makes the impression that it gives you something new for things you could have done back in the 80&#39;s"}], "answers": [{"tags": [], "owner": {"reputation": 3189, "user_id": 4660481, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-ItEMC8arS-M/AAAAAAAAAAI/AAAAAAAAAj4/BpyDN7x-Wok/photo.jpg?sz=128", "display_name": "GaspardP", "link": "https://stackoverflow.com/users/4660481/gaspardp"}, "is_accepted": true, "score": 3, "last_activity_date": 1483679538, "creation_date": 1483679538, "answer_id": 41499313, "question_id": 34441395, "link": "https://stackoverflow.com/questions/34441395/using-libuv-with-functor-structure-instead-of-function-callback/41499313#41499313", "title": "Using libuv with functor structure instead of function callback", "body": "<p>The pasted code will not work because libuv expects a function pointer in <code>uv_listen</code> - what you are providing is a pointer to a structure. This structure happens to have an <code>operator()</code>, but that does not make the address of your structure an address where the processor can jump to and execute code. The <code>operator()</code> is just like any other method of your struct, but that you can call using simply <code>()</code> or <code>.operator()</code> to make the code more readable. Additionally, since the <code>operator()</code> is non-static, it expects an implicit reference to <code>this</code> which libuv will not provide since it does not expect to have to.</p>\n\n<p>To achieve what you are trying to do, you should provide a normal C function callback and store the extra context data in the <code>.data</code> field of your handle:</p>\n\n<p>Instead of:</p>\n\n<pre><code>    int r = uv_listen((uv_stream_t *) &amp;server, 128, (uv_connection_cb)&amp;cb);\n</code></pre>\n\n<p>Use:</p>\n\n<pre><code>    server.data = &amp;cb;\n    int r = uv_listen((uv_stream_t *) &amp;server, 128, [](uv_stream_t *server, int status){\n        (*(CB*)server-&gt;data)(server, status);\n    });\n</code></pre>\n\n<p>The <code>.data</code> field on uv handles is provided exactly for that purpose.</p>\n"}], "owner": {"reputation": 105, "user_id": 2663938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K7BR0.jpg?s=128&g=1", "display_name": "Paul Herman", "link": "https://stackoverflow.com/users/2663938/paul-herman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 658, "favorite_count": 1, "accepted_answer_id": 41499313, "answer_count": 1, "score": 1, "last_activity_date": 1483679538, "creation_date": 1450894158, "last_edit_date": 1450896790, "question_id": 34441395, "link": "https://stackoverflow.com/questions/34441395/using-libuv-with-functor-structure-instead-of-function-callback", "title": "Using libuv with functor structure instead of function callback", "body": "<p>Does anyone know why does libuv segfault when using a functor structure instead of an actual function as a callback. In my example below, I created the structure CB to use instead of connection_cb. The segfault happens when in the operator().</p>\n\n<pre><code>#include &lt;uv.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nuv_buf_t alloc_buffer(uv_handle_t * handle, size_t size);\nvoid connection_cb(uv_stream_t * server, int status);\nvoid read_cb(uv_stream_t * stream, ssize_t nread, uv_buf_t buf);\n\nstruct CB {\n    State *state_;\n    CB(State *state) : state_(state) {}\n    void operator()(uv_stream_t *server, int status) {\n        uv_tcp_t * client = (uv_tcp_t *)malloc(sizeof(uv_tcp_t));\n\n        /* if status not zero there was an error */\n        if (status == -1) {\n            printf(\"error 2\\n\");\n        }\n\n        /* initialize the new client */\n        uv_tcp_init(loop, client);\n\n        /* now let bind the client to the server to be used for incomings */\n        if (uv_accept(server, (uv_stream_t *) client) == 0) {\n            /* start reading from stream */\n            int r = uv_read_start((uv_stream_t *) client, (uv_alloc_cb)alloc_buffer, read_cb);\n\n            if (r) {\n                printf(\"error 3\\n\");\n            }\n            state_-&gt;onConnect();\n        } else {\n            /* close client stream on error */\n            uv_close((uv_handle_t *) client, NULL);\n        }\n    }\n};\n\nCB cb;\nuv_tcp_t server;\nuv_loop_t * loop;\n\nint main() {\n    loop = uv_default_loop();\n\n    /* convert a humanreadable ip address to a c struct */\n    struct sockaddr_in addr;\n    uv_ip4_addr(\"127.0.0.1\", 3005, &amp;addr);\n\n    /* initialize the server */\n    uv_tcp_init(loop, &amp;server);\n    /* bind the server to the address above */\n    uv_tcp_bind(&amp;server, (const struct sockaddr *)&amp;addr, 0);\n\n    /* let the server listen on the address for new connections */\n    int r = uv_listen((uv_stream_t *) &amp;server, 128, (uv_connection_cb)&amp;cb);\n\n    if (r) {\n        printf(\"error 1\\n\");\n        return -1;\n    }\n\n    /* execute all tasks in queue */\n    return uv_run(loop, UV_RUN_DEFAULT);\n}\n\n\n/**\n * Callback which is executed on each new connection.\n */\nvoid connection_cb(uv_stream_t * server, int status) {\n    /* dynamically allocate a new client stream object on conn */\n    uv_tcp_t * client = (uv_tcp_t *)malloc(sizeof(uv_tcp_t));\n\n    /* if status not zero there was an error */\n    if (status == -1) {\n        printf(\"error 2\\n\");\n    }\n\n    /* initialize the new client */\n    uv_tcp_init(loop, client);\n\n    /* now let bind the client to the server to be used for incomings */\n    if (uv_accept(server, (uv_stream_t *) client) == 0) {\n        /* start reading from stream */\n        //int r = uv_read_start((uv_stream_t *) client, (uv_alloc_cb)alloc_buffer, read_cb);\n        int r = 0;\n\n        if (r) {\n            printf(\"error 3\\n\");\n        }\n    } else {\n        /* close client stream on error */\n        uv_close((uv_handle_t *) client, NULL);\n    }\n}\n\n/**\n * Callback which is executed on each readable state.\n */\nvoid read_cb(uv_stream_t * stream, ssize_t nread, uv_buf_t buf) {\n    /* dynamically allocate memory for a new write task */\n    uv_write_t * req = (uv_write_t *) malloc(sizeof(uv_write_t));\n\n    /* if read bytes counter -1 there is an error or EOF */\n    if (nread == -1) {\n        printf(\"error 4\\n\");\n        uv_close((uv_handle_t *) stream, NULL);\n    }\n\n    /* write sync the incoming buffer to the socket */\n    int r = uv_write(req, stream, &amp;buf, 1, NULL);\n\n    if (r) {\n        printf(\"error 5\\n\");\n    }\n}\n\n/**\n * Allocates a buffer which we can use for reading.\n */\nuv_buf_t alloc_buffer(uv_handle_t * handle, size_t size) {\n        return uv_buf_init((char *) malloc(size), size);\n}\n</code></pre>\n"}, {"tags": ["c++", "xcode", "memory-leaks"], "comments": [{"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1450893905, "post_id": 34441298, "comment_id": 56624091, "body": "Have you seen <a href=\"http://stackoverflow.com/questions/3122617/memory-leak-checking-using-instruments-on-mac\">this</a>?"}, {"owner": {"reputation": 501, "user_id": 1655153, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5LVdR.jpg?s=128&g=1", "display_name": "Andrey Suvorov", "link": "https://stackoverflow.com/users/1655153/andrey-suvorov"}, "reply_to_user": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1450893983, "post_id": 34441298, "comment_id": 56624134, "body": "thanks for comment, but I already tried that too=( with function call and { } block"}, {"owner": {"reputation": 501, "user_id": 1655153, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5LVdR.jpg?s=128&g=1", "display_name": "Andrey Suvorov", "link": "https://stackoverflow.com/users/1655153/andrey-suvorov"}, "reply_to_user": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1450894300, "post_id": 34441298, "comment_id": 56624300, "body": "yes, I saw that post. my time delay interval is greater than Instruments delay"}], "answers": [{"comments": [{"owner": {"reputation": 501, "user_id": 1655153, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5LVdR.jpg?s=128&g=1", "display_name": "Andrey Suvorov", "link": "https://stackoverflow.com/users/1655153/andrey-suvorov"}, "edited": false, "score": 0, "creation_date": 1450894451, "post_id": 34441400, "comment_id": 56624362, "body": "Sounds strange, because I need to detect one mem leak, but I&#39;ve got no mem leak with Your example neither. Maybe I need to set some settings for c++ in Instruments or something else?"}, {"owner": {"reputation": 501, "user_id": 1655153, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5LVdR.jpg?s=128&g=1", "display_name": "Andrey Suvorov", "link": "https://stackoverflow.com/users/1655153/andrey-suvorov"}, "edited": false, "score": 0, "creation_date": 1450894590, "post_id": 34441400, "comment_id": 56624436, "body": "Why I will never be able to observe this leak? I can do it with crt marcos for MSVC.."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1474042899, "post_id": 34441400, "comment_id": 66386308, "body": "Since compiler is to smart and removes dummy code: <code>foo = new int[10];</code> :). You have to use this block of memory. See <a href=\"http://stackoverflow.com/a/14811858/1387438\">stackoverflow.com/a/14811858/1387438</a>"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 0, "last_activity_date": 1450894187, "creation_date": 1450894187, "answer_id": 34441400, "question_id": 34441298, "link": "https://stackoverflow.com/questions/34441298/xcode-7-2-instruments-memory-leak-not-working-for-c-code/34441400#34441400", "title": "Xcode 7.2 &amp; Instruments memory leak not working for c++ code", "body": "<p>Yes this is a memory leak as you will never be able to delete the memory but you will not be able to observe it unless you redo the operation.  If you had</p>\n\n<pre><code>int main()\n{\n    int* foo;\n    for (i = 0; i &lt; 10; i++)\n    {\n        foo = new int[10];\n        sleep(60);\n    }\n}\n</code></pre>\n\n<p>You would be able to observer the memory being consumed by the process increasing as we never release the memory we request before grabbing more memory.</p>\n"}], "owner": {"reputation": 501, "user_id": 1655153, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5LVdR.jpg?s=128&g=1", "display_name": "Andrey Suvorov", "link": "https://stackoverflow.com/users/1655153/andrey-suvorov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 747, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450895536, "creation_date": 1450893751, "last_edit_date": 1450895536, "question_id": 34441298, "link": "https://stackoverflow.com/questions/34441298/xcode-7-2-instruments-memory-leak-not-working-for-c-code", "title": "Xcode 7.2 &amp; Instruments memory leak not working for c++ code", "body": "<p>I use the following code: </p>\n\n<pre><code>int main()\n{\n    int* foo = new int[10];\n    foo = nullptr;\n    sleep(60);\n}\n</code></pre>\n\n<p>I build it inside XCode 7.2 and run instruments to see memory leak.\nI changed time delay differently and changed Instruments checking delay (from 10 to 2 sec). I tried to build project differently (Release, Debug) and also I tried to avoid compiler optimization:</p>\n\n<pre><code>int* foo = new int[10];\nfor (int i = 0; i &lt; 10; ++i)\n{\n    foo[i] = i*3 + i^2;\n}\n\nfor (int i = 0; i &lt; 10; ++i)\n{\n    cout &lt;&lt; foo[i] &lt;&lt; endl;;\n}\nfoo = nullptr;\nsleep(60);\n</code></pre>\n\n<p>but I still can't see any leak inside Instruments/leak bars. \nWhat I do wrong? </p>\n\n<p>Upd: I found a workaround, if I stop my console app at breakpoint and then, from the console, run </p>\n\n<pre><code>MacBook-Pro-andrey-2:~ owl$ leaks Ctrain\nProcess:         Ctrain [30305]\nPath:            /Users/owl/Library/Developer/Xcode/DerivedData/Ctrain-cuhszmbcsswlznetmyijwykgudlz/Build/Products/Debug/Ctrain\nLoad Address:    0x100000000\nIdentifier:      Ctrain\nVersion:         ???\nCode Type:       X86-64\nParent Process:  debugserver [30306]\n\nDate/Time:       2015-12-23 21:30:28.768 +0300\nLaunch Time:     2015-12-23 21:30:25.837 +0300\nOS Version:      Mac OS X 10.10.5 (14F27)\nReport Version:  7\nAnalysis Tool:   /Applications/Xcode.app/Contents/Developer/usr/bin/leaks\nAnalysis Tool Version:  Xcode 7.2 (7C68)\n----\n\nleaks Report Version:  2.0\nProcess 30305: 390 nodes malloced for 34 KB\nProcess 30305: 1 leak for 48 total leaked bytes.\nLeak: 0x1001054f0  size=48  zone: DefaultMallocZone_0x10006e000\n    0x00000002 0x00000006 0x0000000a 0x0000000e     ................\n    0x00000012 0x00000016 0x0000001a 0x0000001e     ................\n    0x00000022 0x00000026 0x93554c2c 0x00007fff     \"...&amp;...,LU.....\n</code></pre>\n\n<p>but it is just workaround and not the answer why Instruments can't catch this leak (or any leak in my case).</p>\n"}, {"tags": ["c++", "boost-spirit-qi"], "comments": [{"owner": {"reputation": 503, "user_id": 1280961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mtA9d.jpg?s=128&g=1", "display_name": "wonko realtime", "link": "https://stackoverflow.com/users/1280961/wonko-realtime"}, "reply_to_user": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "edited": false, "score": 0, "creation_date": 1450894394, "post_id": 34441164, "comment_id": 56624340, "body": "@GuyGreer i can&#39;t follow; when i replace &quot;start %= RealWithSeparatedSignValue&quot; with &quot;start %= qi::double_&quot; i don&#39;t get the double parsed. How can the &quot;global&quot; skipper be used to do that and wouldn&#39;t it hurt other parser sections?"}, {"owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "edited": false, "score": 0, "creation_date": 1450895428, "post_id": 34441164, "comment_id": 56624836, "body": "Disregard my comment, I tested it and what I said was wrong."}], "answers": [{"comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1450898581, "post_id": 34442257, "comment_id": 56626363, "body": "Added a more generic skipping policy (using <code>blank_type</code> by default): <a href=\"http://coliru.stacked-crooked.com/a/7d884bec98932d8f\" rel=\"nofollow noreferrer\">Live On Coliru</a>"}, {"owner": {"reputation": 503, "user_id": 1280961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mtA9d.jpg?s=128&g=1", "display_name": "wonko realtime", "link": "https://stackoverflow.com/users/1280961/wonko-realtime"}, "edited": false, "score": 0, "creation_date": 1450901777, "post_id": 34442257, "comment_id": 56627820, "body": "great answer! I especially like the added genericness after the edit. I tried to validate the backtracking and think you&#39;re right there as well:) Here&#39;s the code: <a href=\"http://ideone.com/QuBbcP\" rel=\"nofollow noreferrer\">ideone.com/QuBbcP</a>"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 5, "last_activity_date": 1450898542, "last_edit_date": 1450898542, "creation_date": 1450898038, "answer_id": 34442257, "question_id": 34441164, "link": "https://stackoverflow.com/questions/34441164/boostspirit-parsing-double-with-separated-sign/34442257#34442257", "title": "boost::spirit parsing double with separated sign", "body": "<p>I'd do this exactly like you did here. You should consider restoring the <code>first</code> iterator in case the further parsing fails.</p>\n\n<p>You might want to double check flush semantics on <code>multi_pass&lt;&gt;</code> adapted iterators (I think it's okay, because the wrapping <code>real_parser</code> must be able to backtrack on failure down the road anyways).</p>\n\n<hr>\n\n<p>Of course, given the simplicity of the grammar, the sample can be reduced, but that's hardly the point I suppose.</p>\n\n<p>Here's a shorter demo showing a more generic skipping policy (using <code>blank_type</code> by default):</p>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/7d884bec98932d8f\" rel=\"noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;boost/spirit/include/qi.hpp&gt;\n\nnamespace qi = boost::spirit::qi;\n\ntemplate &lt;typename T, typename Skipper = qi::blank_type&gt;\nstruct skip_after_sign_policies : boost::spirit::qi::real_policies&lt;T&gt; {\n    // allow skipping chars between a possible sign and a folling real number\n    template &lt;typename Iterator&gt;\n    static bool parse_sign(Iterator&amp; first, Iterator const&amp; last) {\n        return qi::extract_sign(first, last)\n            &amp;&amp; qi::phrase_parse(first, last, qi::eps, Skipper {});\n    }\n};\n\nint main() {\n    qi::real_parser&lt;double, skip_after_sign_policies&lt;double&gt; &gt; grammar;\n\n    std::string const str = \" -  1.234 \";\n\n    auto it = str.begin();\n    double value;\n    bool ok = phrase_parse(it, str.end(), grammar, qi::space, value);\n\n    std::cout &lt;&lt; std::boolalpha &lt;&lt; ok &lt;&lt; \" \" &lt;&lt; value;\n    if (it != str.end())\n        std::cout &lt;&lt; \"Remaining: '\" &lt;&lt; std::string(it, str.end()) &lt;&lt; \"'\\n\";\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>true -1.234\n</code></pre>\n"}], "owner": {"reputation": 503, "user_id": 1280961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mtA9d.jpg?s=128&g=1", "display_name": "wonko realtime", "link": "https://stackoverflow.com/users/1280961/wonko-realtime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 34442257, "answer_count": 1, "score": 2, "last_activity_date": 1450898542, "creation_date": 1450893132, "last_edit_date": 1450894093, "question_id": 34441164, "link": "https://stackoverflow.com/questions/34441164/boostspirit-parsing-double-with-separated-sign", "title": "boost::spirit parsing double with separated sign", "body": "<p>I'm using boost::spirit to parse text into doubles whose sings may be separated from the numbers by blanks.</p>\n\n<p>Using or misusing <a href=\"http://www.boost.org/doc/libs/1_60_0/libs/spirit/doc/html/spirit/qi/reference/numeric/real.html#spirit.qi.reference.numeric.real._code__phrase_role__identifier__realpolicies__phrase___code__expression_requirements\" rel=\"nofollow\">real_policies</a>, i found a solution but i'm not sure if there's a easier way to achieve it.\nCan someone please give me a hint?</p>\n\n<p><a href=\"http://ideone.com/0JNJFE\" rel=\"nofollow\">Live Example</a></p>\n\n<p>Here's the relevant code fragment:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct real_with_separated_sign_policies : boost::spirit::qi::real_policies&lt;T&gt;\n{\n    // allow skipping chars between a possible sign and a folling real number\n    template &lt;typename Iterator&gt;\n    static bool parse_sign(Iterator&amp; first, Iterator const&amp; last)\n    {\n        bool ret = qi::extract_sign(first, last);\n        if (ret)\n            qi::parse(first, last, *qi::lit(' '));\n        return ret;\n    }\n};\n\ntemplate &lt;typename Iterator, typename Skipper&gt;\nstruct RealWithSeparatedSignParser\n    : qi::grammar&lt;Iterator, double(), Skipper&gt;\n{\n    boost::spirit::qi::real_parser&lt;double, real_with_separated_sign_policies&lt;double&gt; &gt; RealWithSeparatedSignValue;\n\n    RealWithSeparatedSignParser() : RealWithSeparatedSignParser::base_type(start)\n    {\n        start %= RealWithSeparatedSignValue;\n    }\n\n    qi::rule&lt;Iterator, double(), Skipper&gt; start;\n};\n\nint main() {\n    std::string str = \" -  1.234 \";\n</code></pre>\n"}, {"tags": ["c++", "linux", "segmentation-fault", "gdb"], "answers": [{"comments": [{"owner": {"reputation": 905, "user_id": 5170218, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e746d5acb1323eea69830a11b4a12ef2?s=128&d=identicon&r=PG&f=1", "display_name": "SACHIN GOYAL", "link": "https://stackoverflow.com/users/5170218/sachin-goyal"}, "edited": false, "score": 1, "creation_date": 1450936684, "post_id": 34447634, "comment_id": 56637869, "body": "Thanks for your time .You are right , actually when i dissemble it , it has shown me the line of crash with the marker (&quot;=&gt;&quot; ) . with that i was able to figure that value of one of the register was null .still , I am not able to map that value to code as gdb fails to create a symbol correcpoding to that address ."}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 1, "last_activity_date": 1450934391, "creation_date": 1450934391, "answer_id": 34447634, "question_id": 34441131, "link": "https://stackoverflow.com/questions/34441131/segmentation-fault-has-occurred-on-a-code-which-was-not-compiled-using-debugger/34447634#34447634", "title": "segmentation fault has occurred on a code which was not compiled using debugger flags", "body": "<blockquote>\n  <p>What I tried I tried to dissemble and read complete frame 0 to identify the exact crash point but it didn't help</p>\n</blockquote>\n\n<p>You don't need to identify the exact crash point: GDB has <em>already</em> told you what it is: it's the instruction at address <code>0x7f8768c06cfb</code>.</p>\n\n<p>What you are <em>probably</em> saying is \"despite looking at disassembly, I still can't understand which source line caused the problem\". We could help you with that, but only if you actually show the source and the disassembly in your question.</p>\n\n<p>Your <em>only</em> other choices are:</p>\n\n<ol>\n<li>Find a local guru who you can show the source and the disassembly, and who will help you the same way we would, or</li>\n<li>Do what Lightness Races in Orbit told you to do: rebuild your binary with <em>exactly</em> the same flags, but add <code>-g</code> as well. Assuming you have a hermetic build and can rebuild your original binary in a close enough state (output from <code>nm new-binary</code> should match output from <code>nm old-binary</code>), GDB will then tell you <em>exactly</em> what line the address <code>0x7f8768c06cfb</code> corresponds to.</li>\n</ol>\n\n<p>Note: you don't actually have to rebuild the <em>entire</em> binary with <code>-g</code>. Rebuilding just the source containing <code>TestDummy::work()</code> and re-linking <code>libCont.so</code> should be enough.</p>\n"}, {"tags": [], "owner": {"reputation": 905, "user_id": 5170218, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e746d5acb1323eea69830a11b4a12ef2?s=128&d=identicon&r=PG&f=1", "display_name": "SACHIN GOYAL", "link": "https://stackoverflow.com/users/5170218/sachin-goyal"}, "is_accepted": true, "score": 0, "last_activity_date": 1451297124, "last_edit_date": 1451297124, "creation_date": 1451296797, "answer_id": 34491321, "question_id": 34441131, "link": "https://stackoverflow.com/questions/34441131/segmentation-fault-has-occurred-on-a-code-which-was-not-compiled-using-debugger/34491321#34491321", "title": "segmentation fault has occurred on a code which was not compiled using debugger flags", "body": "<p>I think there a way by which we can debug the core which is not compiled using debugger flags  . I would like to explain it with below example .</p>\n\n<pre><code>(gdb) disassemble \nDump of assembler code for function mystrcpy:  \n 0x0804852a &lt;+0&gt;:   push   %ebp  \n 0x0804852b &lt;+1&gt;:   mov    %esp,%ebp  \n 0x0804852d &lt;+3&gt;:   sub    $0x10,%esp  \n 0x08048530 &lt;+6&gt;:   mov    0x8(%ebp),%eax \n  0x08048533 &lt;+9&gt;:  mov    %eax,-0x4(%ebp)  \n 0x08048536 &lt;+12&gt;:  jmp    0x8048540 &lt;mystrcpy+22&gt;\n   0x08048538 &lt;+14&gt;:    addl   $0x1,0xc(%ebp)  \n 0x0804853c &lt;+18&gt;:  addl   $0x1,0x8(%ebp)\n   0x08048540 &lt;+22&gt;:    mov    0xc(%ebp),%eax \n  0x08048543 &lt;+25&gt;: movzbl (%eax),%edx \n  0x08048546 &lt;+28&gt;: mov    0x8(%ebp),%eax\n=&gt; 0x08048549 &lt;+31&gt;:    mov    %dl,(%eax)  \n 0x0804854b &lt;+33&gt;:  mov    0x8(%ebp),%eax  \n 0x0804854e &lt;+36&gt;:  movzbl (%eax),%eax\n   0x08048551 &lt;+39&gt;:    test   %al,%al \n  0x08048553 &lt;+41&gt;: jne  \n  0x8048538 &lt;mystrcpy+14&gt;  \n 0x08048555 &lt;+43&gt;:  mov    -0x4(%ebp),%eax\n   0x08048558 &lt;+46&gt;:    leave   \n  0x08048559 &lt;+47&gt;: \nret    End of assembler dump.\n</code></pre>\n\n<p><strong>Now , line which is actually showing \"=>\" symbol is the culprit .(=> 0x08048549 &lt;+31>:    mov    %dl,(%eax) )</strong></p>\n\n<p>We can use gdb commands to figure out what had happened with line which is showing the problem .</p>\n\n<pre><code>  gdb) print $eax //print command\n     $1 = 0\n    (gdb) print $dl\n     $2 = 118\n    (gdb) print/c $dl\n     $3 = 118 'v\u2018\n    (gdb) info frame //info frame command\n    Stack level 0, frame at 0xffbf8b90: eip = 0x8048549 in mystrcpy; saved eip =   0x80485cd called by frame at 0xffbf8bc0 Arglist at 0xffbf8b88, args:  Locals at 0xffbf8b88, Previous frame's sp is 0xffbf8b90 Saved registers:  ebp at 0xffbf8b88, eip at 0xffbf8b8c\n    (gdb) x/x $ebp+4 //base pointer + 4 \n    0xffbf8b8c: 0x080485cd\n    (gdb) info symbol 0x080485cd  //info symbol command \n     connect + 115 in section .text of /home/vmahajan/a.out\n     (gdb) x/x $ebp+4 \n     0xffbf8b8c:    0x080485cd\n    (gdb) x/x $ebp+8 \n     0xffbf8b90:    0x00000000\n    (gdb) x/x $ebp+12 \n     0xffbf8b94:    0xffbf91f3\n    (gdb) print/s (char *)0xffbf91f3\n     $5 = 0xffbf91f3 \"vishal\u201c\n</code></pre>\n"}], "owner": {"reputation": 905, "user_id": 5170218, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e746d5acb1323eea69830a11b4a12ef2?s=128&d=identicon&r=PG&f=1", "display_name": "SACHIN GOYAL", "link": "https://stackoverflow.com/users/5170218/sachin-goyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 34491321, "answer_count": 2, "score": 0, "last_activity_date": 1451297124, "creation_date": 1450892974, "last_edit_date": 1450933758, "question_id": 34441131, "link": "https://stackoverflow.com/questions/34441131/segmentation-fault-has-occurred-on-a-code-which-was-not-compiled-using-debugger", "title": "segmentation fault has occurred on a code which was not compiled using debugger flags", "body": "<p>one of process on my system has got segmentation fault .\nFrom core files , I got the below information .</p>\n\n<pre><code>#0  0x00007f8768c06cfb in TestDummy::work() () from libCont.so\n#1  0x00007f8768bfb5ee in Test::work() () from libCont.so\n#2  0x00007f8768c5fa7b in Test::worker_threads() () from libCont.so\n#3  0x00007f873fffe830 in ?? ()\n#4  0x0000000000000000 in ?? ()\n</code></pre>\n\n<p>Please note I am unable to re create this segmentation fault , all i have is this core file on a system to identify what went wrong .\nNote: code was not compiled using debugger flag i.e \"g++ -g\" , so debug information is not available .</p>\n\n<p><strong>What I tried</strong>\nI tried  to dissemble and read complete frame 0 to identify the exact crash point but it didn't help .</p>\n\n<p>can anybody let me know a way to debug it further? </p>\n"}, {"tags": ["c#", "c++", "visual-studio-2010", "ide", "intellisense"], "comments": [{"owner": {"reputation": 3040, "user_id": 681351, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/0o83I.jpg?s=128&g=1", "display_name": "Cubicle.Jockey", "link": "https://stackoverflow.com/users/681351/cubicle-jockey"}, "edited": false, "score": 3, "creation_date": 1450892918, "post_id": 34441010, "comment_id": 56623586, "body": "5k lines in a file. I smell code rot."}, {"owner": {"reputation": 241, "user_id": 5670139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/562b9d9bb1ffb968cb83f46ba8e04569?s=128&d=identicon&r=PG&f=1", "display_name": "HireThisMarine", "link": "https://stackoverflow.com/users/5670139/hirethismarine"}, "reply_to_user": {"reputation": 3040, "user_id": 681351, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/0o83I.jpg?s=128&g=1", "display_name": "Cubicle.Jockey", "link": "https://stackoverflow.com/users/681351/cubicle-jockey"}, "edited": false, "score": 1, "creation_date": 1450893370, "post_id": 34441010, "comment_id": 56623828, "body": "@Cubicle.Jockey 1.  This is nothing, my last job had a file that was exactly (2^15 - 1) lines long, with a 7k line long function, and a 1k line long &quot;if&quot; check where the indenting from nested &quot;if&quot;s brought it over a full screen...with a &quot;goto&quot; in the middle.  This project is rather pleasant and relaxing."}, {"owner": {"reputation": 3040, "user_id": 681351, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/0o83I.jpg?s=128&g=1", "display_name": "Cubicle.Jockey", "link": "https://stackoverflow.com/users/681351/cubicle-jockey"}, "edited": false, "score": 1, "creation_date": 1450893866, "post_id": 34441010, "comment_id": 56624066, "body": "Here is the documentation for Intellisense Options. You can turn it off while you are in the file or change how it is triggered.  <a href=\"https://msdn.microsoft.com/library/ecfczya1(v=vs.100).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/library/ecfczya1(v=vs.100).aspx</a>"}, {"owner": {"reputation": 1670, "user_id": 2881450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lgcdY.jpg?s=128&g=1", "display_name": "jHilscher", "link": "https://stackoverflow.com/users/2881450/jhilscher"}, "edited": false, "score": 0, "creation_date": 1450894072, "post_id": 34441010, "comment_id": 56624183, "body": "&quot;... 7k line long function, and a 1k line long &quot;if&quot; check where the indenting from nested &quot;if&quot;s brought it over a full ... &quot; how did VS handle that?"}, {"owner": {"reputation": 241, "user_id": 5670139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/562b9d9bb1ffb968cb83f46ba8e04569?s=128&d=identicon&r=PG&f=1", "display_name": "HireThisMarine", "link": "https://stackoverflow.com/users/5670139/hirethismarine"}, "reply_to_user": {"reputation": 1670, "user_id": 2881450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lgcdY.jpg?s=128&g=1", "display_name": "jHilscher", "link": "https://stackoverflow.com/users/2881450/jhilscher"}, "edited": false, "score": 1, "creation_date": 1450895100, "post_id": 34441010, "comment_id": 56624691, "body": "@jHilscher I don&#39;t recall VS2003 having any issues with it, IIRC the rough part was navigating through the virtual machine and through (hosted?) by ClearCase; once a day <i>something</i> would crash when I tried to compare items in the version tree.  If I had to guess I&#39;d say it was because .NET 1.1 had relatively few features and the code itself had relatively few relations whose statuses had to be kept up with."}, {"owner": {"reputation": 2113, "user_id": 4433546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fp46R.jpg?s=128&g=1", "display_name": "TriskalJM", "link": "https://stackoverflow.com/users/4433546/triskaljm"}, "edited": false, "score": 0, "creation_date": 1458763223, "post_id": 34441010, "comment_id": 60010429, "body": "IIRC, the development team completely rewrote how Intellisense works some time after VS2003, so it&#39;s not surprising that it works differently in VS2010."}], "owner": {"reputation": 241, "user_id": 5670139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/562b9d9bb1ffb968cb83f46ba8e04569?s=128&d=identicon&r=PG&f=1", "display_name": "HireThisMarine", "link": "https://stackoverflow.com/users/5670139/hirethismarine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1450893665, "creation_date": 1450892392, "last_edit_date": 1450893122, "question_id": 34441010, "link": "https://stackoverflow.com/questions/34441010/is-there-a-way-to-intentionally-slow-down-intellisense", "title": "Is there a way to intentionally slow down IntelliSense?", "body": "<p>I have a large C# source file (~5k lines) that I'm trying to wrangle.  I'm not always adding or removing curly braces, but when I do, IntelliSense gets way too excited populating the Error List pane with error notifications.  Though this doesn't cause more than a heartbeat of slowdown I find it irritating as a moment later I've rectified the extra <code>{</code> or missing <code>}</code> and the number climbs back down.  </p>\n\n<p>I know that if I move focus from the Error List pane this would not be an issue, but I prefer to keep it on screen.  Is there a way to retard IntelliSense's update cycle?</p>\n"}, {"tags": ["c++", "clang", "avx", "icc"], "comments": [{"owner": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "edited": false, "score": 0, "creation_date": 1450891978, "post_id": 34440850, "comment_id": 56623060, "body": "Did you see which line causes the segmentation fault?"}, {"owner": {"reputation": 9695, "user_id": 2581872, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/JVj4n.png?s=128&g=1", "display_name": "hichris123", "link": "https://stackoverflow.com/users/2581872/hichris123"}, "reply_to_user": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "edited": false, "score": 0, "creation_date": 1450892047, "post_id": 34440850, "comment_id": 56623098, "body": "@Paulo It&#39;s the last line - <code>table[99] = zeroes</code>."}, {"owner": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "edited": false, "score": 0, "creation_date": 1450892154, "post_id": 34440850, "comment_id": 56623165, "body": "Unrelated note: I believe <code>_mm256_set1_epi64x(0)</code> would be the same as <code>_mm256_set_epi64x(0, 0, 0, 0)</code>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1450892472, "post_id": 34440850, "comment_id": 56623351, "body": "4.8 is rather old. How does it look with 4.9.3 or 5.2?"}, {"owner": {"reputation": 9695, "user_id": 2581872, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/JVj4n.png?s=128&g=1", "display_name": "hichris123", "link": "https://stackoverflow.com/users/2581872/hichris123"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1450892968, "post_id": 34440850, "comment_id": 56623622, "body": "@SergeyA No segmentation fault with 5.3. So... I guess it is a compiler bug?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1450893592, "post_id": 34440850, "comment_id": 56623931, "body": "@hichris123, looks like it."}, {"owner": {"reputation": 9695, "user_id": 2581872, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/JVj4n.png?s=128&g=1", "display_name": "hichris123", "link": "https://stackoverflow.com/users/2581872/hichris123"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1450894345, "post_id": 34440850, "comment_id": 56624323, "body": "Strange @SergeyA - I think that may have been a fluke. If I bump the array size up to 10,000 or higher, I still get a segmentation fault - even in gcc 5.3. Perhaps something changed with my system, because even the earlier versions of clang/gcc now produce no segmentation faults with the code in the post."}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 1, "creation_date": 1450913443, "post_id": 34440850, "comment_id": 56632515, "body": "It is a well known issue that malloc/new can&#39;t handle overaligned types in C++. People are working on it for a future version of the standard..."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "edited": false, "score": 0, "creation_date": 1450914688, "post_id": 34440850, "comment_id": 56632873, "body": "@R_Kapp: The normal thing would be <code>_mm256_setzero_si256()</code>.  Modern compilers are smart enough to still compile <code>set1(0)</code> or <code>set(0,0,0,0)</code> to a <code>VPXOR xmm,xmm</code> instruction, though.  (non-zero constants tend to turn into a load from the .rodata section, except all-ones which can be generated by <code>PCMPEQB same,same</code>)."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1450914793, "post_id": 34440850, "comment_id": 56632907, "body": "Also, if you&#39;re going to post asm output, use <code>-Og</code> or <code>-O1</code> at least, unless it&#39;s a problem that only happens with <code>-O0</code>.  Nobody wants to read the braindead <code>-O0</code> output that buries the interesting part under stuff like 4x <code>movq $0, (stack)</code>.  And if you have the code on godbolt, click the &quot;permalink&quot; button and post that link to take people to the code on godbolt with your chosen compiler and options."}, {"owner": {"reputation": 9695, "user_id": 2581872, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/JVj4n.png?s=128&g=1", "display_name": "hichris123", "link": "https://stackoverflow.com/users/2581872/hichris123"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1450923049, "post_id": 34440850, "comment_id": 56634790, "body": "@PeterCordes Yeah, I probably should have done <code>O1</code>+, but I realized the compiler would optimize the good stuff right out. I&#39;ll make sure to do that next time."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1450923837, "post_id": 34440850, "comment_id": 56634947, "body": "@hichris123: You&#39;d still get an aligned store.  What &quot;good stuff&quot; are you referring to?  Oh right, you don&#39;t use <code>table</code>, and it&#39;s newly allocated so the compiler knows it has the only reference to it.  So it goes away with <code>-O1</code>, <a href=\"http://goo.gl/xLQGrB\" rel=\"nofollow noreferrer\">but not with <code>-Og</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 9695, "user_id": 2581872, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/JVj4n.png?s=128&g=1", "display_name": "hichris123", "link": "https://stackoverflow.com/users/2581872/hichris123"}, "edited": false, "score": 0, "creation_date": 1450911000, "post_id": 34444710, "comment_id": 56631697, "body": "This does indeed work. As you point out though, it&#39;s more of a C implementation than a C++ fix."}], "tags": [], "owner": {"reputation": 1306, "user_id": 2807749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3884afad2069925c2c0ca50d49e4b093?s=128&d=identicon&r=PG&f=1", "display_name": "user0815", "link": "https://stackoverflow.com/users/2807749/user0815"}, "is_accepted": false, "score": 2, "last_activity_date": 1450909802, "creation_date": 1450909802, "answer_id": 34444710, "question_id": 34440850, "link": "https://stackoverflow.com/questions/34440850/segmentation-fault-with-array-of-m256i-when-using-clang-g/34444710#34444710", "title": "Segmentation fault with array of __m256i when using clang/g++", "body": "<p>I guess the problem has to do with wrong memory alignment. <code>vmovaps</code> requires the memory location to start at a 32-byte boundary and <code>vmovdqu</code> does not. That's why the Intel version works whereas the clang/g++ code crashes. I don't know if this is a compiler bug, but you may want alignment anyway.</p>\n\n<p>The following code should work, although it's more C than C++.</p>\n\n<pre><code>int main() {\n  __m256i *table = (__m256i*) memalign( 32, 10000 * sizeof(__m256i) );\n  __m256i zeroes = _mm256_set_epi64x(0, 0, 0, 0);\n  table[99] = zeroes;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "is_accepted": false, "score": 3, "last_activity_date": 1490083158, "last_edit_date": 1495539981, "creation_date": 1451331193, "answer_id": 34499562, "question_id": 34440850, "link": "https://stackoverflow.com/questions/34440850/segmentation-fault-with-array-of-m256i-when-using-clang-g/34499562#34499562", "title": "Segmentation fault with array of __m256i when using clang/g++", "body": "<p>I have said many times before that implicit SIMD loads/stores are a bad idea. Stop using them. Use explicit loads/stores like this</p>\n\n<pre><code>int64_t* table = new int64_t[4*10000];\n__m256i zeroes = _mm256_set_epi64x(0, 0, 0, 0);\n_mm256_storeu_si256((__m256i*)&amp;table[4*99], zeroes);\n</code></pre>\n\n<p>or since this is POD use <a href=\"https://stackoverflow.com/questions/16376942/best-cross-platform-method-to-get-aligned-memory\">the cross-compiler/OS function <code>_mm_malloc</code></a></p>\n\n<pre><code>int64_t* table = (int64_t*)_mm_malloc(sizeof(int64_t)*4*10000, 32);\n__m256i zeroes = _mm256_set_epi64x(0, 0, 0, 0);\n_mm256_store_si256((__m256i*)&amp;table[4*99], zeroes);\n</code></pre>\n\n<p>You can use <code>_mm256_setzero_si256()</code> instead of <code>_mm256_set_epi64x(0, 0, 0, 0)</code> (note that <code>_mm256_set_epi64x</code> does not work in 32-bit mode on some version of MSVC) but GCC and Clang are smart enough to know they are the same thing.</p>\n\n<p>Since you're using intrinsics which are not part of the C/C++ specification <a href=\"https://stackoverflow.com/questions/24787268/how-to-implement-mm-storeu-epi64-without-aliasing-problems/24788226#24788226\">then some rules such as strict aliasing may be overlooked</a>.</p>\n"}], "owner": {"reputation": 9695, "user_id": 2581872, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/JVj4n.png?s=128&g=1", "display_name": "hichris123", "link": "https://stackoverflow.com/users/2581872/hichris123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 716, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1490083158, "creation_date": 1450891752, "last_edit_date": 1450895166, "question_id": 34440850, "link": "https://stackoverflow.com/questions/34440850/segmentation-fault-with-array-of-m256i-when-using-clang-g", "title": "Segmentation fault with array of __m256i when using clang/g++", "body": "<p>I'm attempting to generate arrays of <code>__m256i</code>'s to reuse in another computation. When I attempt to do that (even with a minimal testcase), I get a segmentation fault - but only if the code is compiled with g++ or clang. If I compile the code with the Intel compiler (version 16.0), no segmentation fault occurs. Here is a test case I created:</p>\n\n<pre><code>int main() {\n    __m256i *table = new __m256i[10000];\n    __m256i zeroes = _mm256_set_epi64x(0, 0, 0, 0);\n    table[99] = zeroes;\n}\n</code></pre>\n\n<p>When compiling the above with clang 3.6 and g++ 4.8, a segmentation fault occurs.</p>\n\n<p>Here's the assembly generated by the Intel compiler (from <a href=\"https://gcc.godbolt.org/\" rel=\"nofollow\">https://gcc.godbolt.org/</a>, icc 13.0):</p>\n\n<pre><code>pushq     %rbx                                          #3.12\nmovq      %rsp, %rbx                                    #3.12\nandq      $-32, %rsp                                    #3.12\npushq     %rbp                                          #3.12\npushq     %rbp                                          #3.12\nmovq      8(%rbx), %rbp                                 #3.12\nmovq      %rbp, 8(%rsp)                                 #3.12\nmovq      %rsp, %rbp                                    #3.12\nsubq      $112, %rsp                                    #3.12\nmovl      $3200, %eax                                   #4.38\nvzeroupper                                              #4.38\nmovq      %rax, %rdi                                    #4.38\ncall      operator new[](unsigned long)                 #4.38\nmovq      %rax, -112(%rbp)                              #4.38\nmovq      -112(%rbp), %rax                              #4.38\nmovq      %rax, -104(%rbp)                              #4.20\nvxorps    %ymm0, %ymm0, %ymm0                           #5.22\nvmovdqu   %ymm0, -80(%rbp)                              #5.22\nvmovdqu   -80(%rbp), %ymm0                              #5.22\nvmovdqu   %ymm0, -48(%rbp)                              #5.20\nmovl      $3168, %eax                                   #6.17\naddq      -104(%rbp), %rax                              #6.5\nvmovdqu   -48(%rbp), %ymm0                              #6.17\nvmovdqu   %ymm0, (%rax)                                 #6.5\nmovl      $0, %eax                                      #7.1\nvzeroupper                                              #7.1\nleave                                                   #7.1\nmovq      %rbx, %rsp                                    #7.1\npopq      %rbx                                          #7.1\nret                                                     #7.1\n</code></pre>\n\n<p>And here's from clang 3.7:</p>\n\n<pre><code>pushq   %rbp\nmovq    %rsp, %rbp\nandq    $-32, %rsp\nsubq    $192, %rsp\nxorl    %eax, %eax\nmovl    $3200, %ecx             # imm = 0xC80\nmovl    %ecx, %edi\nmovl    %eax, 28(%rsp)          # 4-byte Spill\ncallq   operator new[](unsigned long)\nmovq    %rax, 88(%rsp)\nmovq    $0, 168(%rsp)\nmovq    $0, 160(%rsp)\nmovq    $0, 152(%rsp)\nmovq    $0, 144(%rsp)\nvmovq   168(%rsp), %xmm0        # xmm0 = mem[0],zero\nvmovq   160(%rsp), %xmm1        # xmm1 = mem[0],zero\nvpunpcklqdq     %xmm0, %xmm1, %xmm0 # xmm0 = xmm1[0],xmm0[0]\nvmovq   152(%rsp), %xmm1        # xmm1 = mem[0],zero\nvpslldq $8, %xmm1, %xmm1        # xmm1 = zero,zero,zero,zero,zero,zero,zero,zero,xmm1[0,1,2,3,4,5,6,7]\nvmovaps %xmm1, %xmm2\nvinserti128     $1, %xmm0, %ymm2, %ymm2\nvmovaps %ymm2, 96(%rsp)\nvmovaps %ymm2, 32(%rsp)\nmovq    88(%rsp), %rax\nvmovaps %ymm2, 3168(%rax)\nmovl    28(%rsp), %eax          # 4-byte Reload\nmovq    %rbp, %rsp\npopq    %rbp\nvzeroupper\nretq\n</code></pre>\n\n<p>Am I running into a compiler bug in clang/g++? Or am I simply doing something wrong?</p>\n"}, {"tags": ["c++", "cmake"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1450892061, "post_id": 34440778, "comment_id": 56623106, "body": "I wonder if it is space between -D and the CMAKE_BUILD_TYPE which breaks it."}, {"owner": {"reputation": 2177, "user_id": 2570465, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/14da57290208c66d0846cfab5fbe3577?s=128&d=identicon&r=PG", "display_name": "user2570465", "link": "https://stackoverflow.com/users/2570465/user2570465"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1450892344, "post_id": 34440778, "comment_id": 56623276, "body": "@SergeyA I tried <code>-DCMAKE_BUILD_TYPE=Debug</code> and it unfortunately produces the same result.   I&#39;ve also renamed the executable from <code>test</code> to <code>test1</code> because I missed a warning saying that <code>test</code> was reserved."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1450892646, "post_id": 34440778, "comment_id": 56623441, "body": "Did you see if the proper make file was generated? Does it have -g in it?"}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 1, "creation_date": 1450892784, "post_id": 34440778, "comment_id": 56623522, "body": "Please note that the <code>CXX_STANDARD_REQUIRED</code> property has been introduced in CMake 3.1, so I recommend you to adjust your cmake_minimum_required version."}, {"owner": {"reputation": 2177, "user_id": 2570465, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/14da57290208c66d0846cfab5fbe3577?s=128&d=identicon&r=PG", "display_name": "user2570465", "link": "https://stackoverflow.com/users/2570465/user2570465"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1450893521, "post_id": 34440778, "comment_id": 56623900, "body": "@SergeyA I edited in the make all command that was generated. It has several variables and references other files. Could you let me know if there&#39;s any specific files you&#39;re interested in seeing?"}, {"owner": {"reputation": 2177, "user_id": 2570465, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/14da57290208c66d0846cfab5fbe3577?s=128&d=identicon&r=PG", "display_name": "user2570465", "link": "https://stackoverflow.com/users/2570465/user2570465"}, "reply_to_user": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1450893622, "post_id": 34440778, "comment_id": 56623949, "body": "@SirDarius Thanks for letting me know. I&#39;ve changed the property to 3.1"}, {"owner": {"reputation": 16953, "user_id": 2799037, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2uPVa.png?s=128&g=1", "display_name": "usr1234567", "link": "https://stackoverflow.com/users/2799037/usr1234567"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1450893628, "post_id": 34440778, "comment_id": 56623952, "body": "@SergeyA Looking into generated Makefiles is useless for CMake. It is done somewhere internally."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 16953, "user_id": 2799037, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2uPVa.png?s=128&g=1", "display_name": "usr1234567", "link": "https://stackoverflow.com/users/2799037/usr1234567"}, "edited": false, "score": 0, "creation_date": 1450893681, "post_id": 34440778, "comment_id": 56623980, "body": "@usr1234567, to the contrary, in my experience, it was enlightening. In tells you exactly what command is going to be ran. Look into CMakeFiles/Makefile2"}, {"owner": {"reputation": 2177, "user_id": 2570465, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/14da57290208c66d0846cfab5fbe3577?s=128&d=identicon&r=PG", "display_name": "user2570465", "link": "https://stackoverflow.com/users/2570465/user2570465"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1450893981, "post_id": 34440778, "comment_id": 56624132, "body": "@SergeyA I&#39;ve added in the <code>all</code> command that is in Makefile2. Hopefully that is the command your&#39;re interested in - my knowledge of makefiles is not too great either."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1450894222, "post_id": 34440778, "comment_id": 56624264, "body": "Now you need CMakeFiles/test1.dir/build.make"}, {"owner": {"reputation": 1243, "user_id": 400303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d56e1bcfb3878fd77d6379e4a98b573?s=128&d=identicon&r=PG", "display_name": "Mohammad", "link": "https://stackoverflow.com/users/400303/mohammad"}, "edited": false, "score": 0, "creation_date": 1450896095, "post_id": 34440778, "comment_id": 56625142, "body": "try <code>make VERBOSE=1</code> to see the complete list of passed arguments to g++"}, {"owner": {"reputation": 2177, "user_id": 2570465, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/14da57290208c66d0846cfab5fbe3577?s=128&d=identicon&r=PG", "display_name": "user2570465", "link": "https://stackoverflow.com/users/2570465/user2570465"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1450896393, "post_id": 34440778, "comment_id": 56625277, "body": "@SergeyA I added in the CMakeFiles/test1.dir/build.make in an edit."}, {"owner": {"reputation": 2177, "user_id": 2570465, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/14da57290208c66d0846cfab5fbe3577?s=128&d=identicon&r=PG", "display_name": "user2570465", "link": "https://stackoverflow.com/users/2570465/user2570465"}, "reply_to_user": {"reputation": 1243, "user_id": 400303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d56e1bcfb3878fd77d6379e4a98b573?s=128&d=identicon&r=PG", "display_name": "Mohammad", "link": "https://stackoverflow.com/users/400303/mohammad"}, "edited": false, "score": 0, "creation_date": 1450896540, "post_id": 34440778, "comment_id": 56625358, "body": "@Mohammad I used that command and I noticed that g++ does not appear, but it references Xcode. I remember linking CMake with Xcode a few weeks ago so that I could create an Xcode project using CMake. Is that a problem? I&#39;ll post the verbose output above."}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1450901606, "post_id": 34440778, "comment_id": 56627732, "body": "when trying the same thing, I get <code>--11687-- run: &#47;usr&#47;bin&#47;dsymutil &quot;.&#47;myprogram&quot;</code> the first time I invoke valgrind. This is on OSX 10.11.2 with all latest updates."}], "answers": [{"comments": [{"owner": {"reputation": 2177, "user_id": 2570465, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/14da57290208c66d0846cfab5fbe3577?s=128&d=identicon&r=PG", "display_name": "user2570465", "link": "https://stackoverflow.com/users/2570465/user2570465"}, "edited": false, "score": 2, "creation_date": 1450896803, "post_id": 34441574, "comment_id": 56625507, "body": "I tried this, but it didn&#39;t work, unfortunately. The .dSYM directory is still not there."}, {"owner": {"reputation": 610, "user_id": 5596200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad4f6608569fcbe4907bf196df92aa1?s=128&d=identicon&r=PG&f=1", "display_name": "shay", "link": "https://stackoverflow.com/users/5596200/shay"}, "reply_to_user": {"reputation": 2177, "user_id": 2570465, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/14da57290208c66d0846cfab5fbe3577?s=128&d=identicon&r=PG", "display_name": "user2570465", "link": "https://stackoverflow.com/users/2570465/user2570465"}, "edited": false, "score": 0, "creation_date": 1450899540, "post_id": 34441574, "comment_id": 56626799, "body": "Have you tried running Valgrind with the <code>--dsymutil=yes</code> option? I don&#39;t know much about build systems for osx, but according to <a href=\"http://valgrind.org/docs/manual/manual-core.html\" rel=\"nofollow noreferrer\">Valgrind&#39;s manual</a> that option should result in <code>dsymutil</code> being run to generate the .dSYM directory. This doesn&#39;t solve the larger problem of generating the .dSYM directory from cmake, but it seems like it should at least get Valgrind working"}, {"owner": {"reputation": 610, "user_id": 5596200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad4f6608569fcbe4907bf196df92aa1?s=128&d=identicon&r=PG&f=1", "display_name": "shay", "link": "https://stackoverflow.com/users/5596200/shay"}, "reply_to_user": {"reputation": 2177, "user_id": 2570465, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/14da57290208c66d0846cfab5fbe3577?s=128&d=identicon&r=PG", "display_name": "user2570465", "link": "https://stackoverflow.com/users/2570465/user2570465"}, "edited": false, "score": 0, "creation_date": 1450900338, "post_id": 34441574, "comment_id": 56627166, "body": "Another thing to try: From my rudimentary understanding of things the .dSYM directory contains debugging information for xcode projects. GCC doesn&#39;t actually create the .dSYM directory, that&#39;s created by an application called <code>dsymutil</code> using the debugging symbols provided by gcc, and called later in your makefile. With cmake you can specify the type of makefile that is being generated with the <code>-G</code> option, so perhaps something like   <code>cmake -G Xcode -D CMAKE_BUILD_TYPE=Debug ..</code> will include the dsymutil steps in the resulting makefile."}], "tags": [], "owner": {"reputation": 610, "user_id": 5596200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad4f6608569fcbe4907bf196df92aa1?s=128&d=identicon&r=PG&f=1", "display_name": "shay", "link": "https://stackoverflow.com/users/5596200/shay"}, "is_accepted": false, "score": 4, "last_activity_date": 1450895643, "last_edit_date": 1450895643, "creation_date": 1450894994, "answer_id": 34441574, "question_id": 34440778, "link": "https://stackoverflow.com/questions/34440778/cmake-debug-symbols-missing/34441574#34441574", "title": "CMake Debug Symbols Missing", "body": "<p>Try explicitly setting the -g flag for the debug configuration by adding<br>\n<code>set(CMAKE_CXX_FLAGS_DEBUG  \"-g\")</code> \nTo your CMakeLists.txt then re-running cmake with<br>\n<code>-DCMAKE_BUILD_TYPE=Debug</code></p>\n"}, {"tags": [], "owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1574249011, "creation_date": 1574249011, "answer_id": 58953195, "question_id": 34440778, "link": "https://stackoverflow.com/questions/34440778/cmake-debug-symbols-missing/58953195#58953195", "title": "CMake Debug Symbols Missing", "body": "<ol>\n<li><code>valgrind</code> + <code>leak-check</code> - AFAIK debug build is recommended</li>\n<li>Nowadays I would use compiler option address sanitizer instead of <code>valgrind</code> with <code>leak-check</code>. Sanitizes are faster and more reliable (<code>valgrind</code> has some technical limitation so it can't find all memory issues).</li>\n<li>Note that in <code>cmake</code> projects there are <a href=\"https://cmake.org/cmake/help/v3.0/variable/CMAKE_BUILD_TYPE.html\" rel=\"nofollow noreferrer\">4 default configurations</a>: <code>Debug</code>, <code>Release</code>, <code>RelWithDebInfo</code> and <code>MinSizeRel</code>. Configuration with <code>RelWithDebInfo</code> creates release build with symbol files (I'm trying to find if there are some drawbacks of this configuration, that is why I've encounter this SO question). So most probably you should build your project like this:</li>\n</ol>\n\n<pre><code>cd build_dir\ncmake .. -G &lt;YOUR GENERATOR&gt; &lt;other config options&gt;\ncmake --build . --config RelWithDebInfo\n</code></pre>\n"}], "owner": {"reputation": 2177, "user_id": 2570465, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/14da57290208c66d0846cfab5fbe3577?s=128&d=identicon&r=PG", "display_name": "user2570465", "link": "https://stackoverflow.com/users/2570465/user2570465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7216, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1574249011, "creation_date": 1450891392, "last_edit_date": 1495542196, "question_id": 34440778, "link": "https://stackoverflow.com/questions/34440778/cmake-debug-symbols-missing", "title": "CMake Debug Symbols Missing", "body": "<p>I recently started using CMake and I haven't been able to figure out how to get my debug symbols to work for Valgrind. So, I made a test project to demonstrate my problem. Without CMake, I would just compile with -g:</p>\n\n<pre><code>g++ -std=c++11 -g main.cpp -o test\n</code></pre>\n\n<p>and I get the <code>test.dSYM</code> directory that I want. According to <a href=\"https://stackoverflow.com/questions/10005982/how-do-you-set-gdb-debug-flag-with-cmake\">How do you set GDB debug flag with cmake?</a>, to get the -g flag, I should use the argument</p>\n\n<pre><code>-D CMAKE_BUILD_TYPE=Debug\n</code></pre>\n\n<p>So that is what I tried. In a folder named <code>Testing</code>, I created a test file <code>main.cpp</code> with the following contents:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing std::cout;\n\nint main( int argc , const char* argv[] ) {\n    int* leak = new int;\n    int arr[] = { 1 , 2 , 3 , 4 };\n    for ( int i : arr ) {\n        cout &lt;&lt; i &lt;&lt; \"\\n\";      \n    }\n    return 0;\n}\n</code></pre>\n\n<p>Inside <code>Testing</code>, I also created a file <code>CMakeLists.txt</code> with the following contents:</p>\n\n<pre><code>cmake_minimum_required( VERSION 3.1 )\nproject( Testing )\nadd_executable( test1 main.cpp )\nset_property(TARGET test1 PROPERTY CXX_STANDARD 11)\nset_property(TARGET test1 PROPERTY CXX_STANDARD_REQUIRED ON)\n</code></pre>\n\n<p>Then I created a new directory, <code>Testing/cmake_build</code> and in that directory I ran the following commands:</p>\n\n<pre><code>Testing/cmake_build$ cmake -D CMAKE_BUILD_TYPE=Debug ..\nTesting/cmake_build$ make\nTesting/cmake_build$ valgrind --leak-check=yes ./test\n</code></pre>\n\n<p>And Valgrind complains that the dSYM directory is missing. I looked around for it myself, and haven't found it. Thus, I don't get line numbers in the leak check output and I can't debug my project:</p>\n\n<pre><code>==2388== Using Valgrind-3.10.0 and LibVEX; rerun with -h for copyright info\n==2388== Command: ./test\n==2388== \n--2388-- ./test:\n--2388-- dSYM directory is missing; consider using --dsymutil=yes\n1\n2\n3\n4\n==2388== \n==2388== HEAP SUMMARY:\n==2388==     in use at exit: 29,443 bytes in 378 blocks\n==2388==   total heap usage: 472 allocs, 94 frees, 36,027 bytes allocated\n==2388== \n==2388== 4 bytes in 1 blocks are definitely lost in loss record 1 of 76\n==2388==    at 0x47F1: malloc (vg_replace_malloc.c:300)\n==2388==    by 0x4928D: operator new(unsigned long) (in /usr/lib/libc++.1.dylib)\n==2388==    by 0x1000012E5: main (in ./test)\n==2388== \n==2388== LEAK SUMMARY:\n==2388==    definitely lost: 4 bytes in 1 blocks\n==2388==    indirectly lost: 0 bytes in 0 blocks\n==2388==      possibly lost: 0 bytes in 0 blocks\n==2388==    still reachable: 4,096 bytes in 1 blocks\n==2388==         suppressed: 25,343 bytes in 376 blocks\n==2388== Reachable blocks (those to which a pointer was found) are not shown.\n==2388== To see them, rerun with: --leak-check=full --show-leak-kinds=all\n==2388== \n</code></pre>\n\n<p>It should say</p>\n\n<pre><code>==2530==    by 0x1000012E5: main (main.cpp:5)\n</code></pre>\n\n<p>Could anyone show me how I can use CMake so that I get the dSYM directory? Thanks.</p>\n\n<p>Edit 1 (make all command):</p>\n\n<p>Here is the make all command that was generated in my makefile:</p>\n\n<pre><code>all: cmake_check_build_system\n    $(CMAKE_COMMAND) -E cmake_progress_start &lt;Path&gt;/Testing/cmake_build/CMakeFiles &lt;Path&gt;/Testing/cmake_build/CMakeFiles/progress.marks\n    $(MAKE) -f CMakeFiles/Makefile2 all\n    $(CMAKE_COMMAND) -E cmake_progress_start &lt;Path&gt;/Testing/cmake_build/CMakeFiles 0\n</code></pre>\n\n<p>Edit 2 (Makefile2's all command):</p>\n\n<pre><code># Target rules for target CMakeFiles/test1.dir\n\n# All Build rule for target.\nCMakeFiles/test1.dir/all:\n    $(MAKE) -f CMakeFiles/test1.dir/build.make CMakeFiles/test1.dir/depend\n    $(MAKE) -f CMakeFiles/test1.dir/build.make CMakeFiles/test1.dir/build\n    @$(CMAKE_COMMAND) -E cmake_echo_color --switch=$(COLOR) --progress-dir=&lt;Path&gt;/Testing/cmake_build/CMakeFiles --progress-num=1,2 \"Built target test1\"\n.PHONY : CMakeFiles/test1.dir/all\n\n# Include target in all.\nall: CMakeFiles/test1.dir/all\n</code></pre>\n\n<p>Edit 3 (CmakeFiles/test1.dir/build.make):</p>\n\n<pre><code># CMAKE generated file: DO NOT EDIT!\n# Generated by \"Unix Makefiles\" Generator, CMake Version 3.4\n\n# Delete rule output on recipe failure.\n.DELETE_ON_ERROR:\n\n\n#=============================================================================\n# Special targets provided by cmake.\n\n# Disable implicit rules so canonical targets will work.\n.SUFFIXES:\n\n\n# Remove some rules from gmake that .SUFFIXES does not remove.\nSUFFIXES =\n\n.SUFFIXES: .hpux_make_needs_suffix_list\n\n\n# Suppress display of executed commands.\n$(VERBOSE).SILENT:\n\n\n# A target that is always out of date.\ncmake_force:\n\n.PHONY : cmake_force\n\n#=============================================================================\n# Set environment variables for the build.\n\n# The shell in which to execute make rules.\nSHELL = /bin/sh\n\n# The CMake executable.\nCMAKE_COMMAND = /usr/local/bin/cmake\n\n# The command to remove a file.\nRM = /usr/local/bin/cmake -E remove -f\n\n# Escaping for special characters.\nEQUALS = =\n\n# The top-level source directory on which CMake was run.\nCMAKE_SOURCE_DIR = &lt;Path&gt;/Desktop/Testing\n\n# The top-level build directory on which CMake was run.\nCMAKE_BINARY_DIR = &lt;Path&gt;/Desktop/Testing/cmake_build\n\n# Include any dependencies generated for this target.\ninclude CMakeFiles/test1.dir/depend.make\n\n# Include the progress variables for this target.\ninclude CMakeFiles/test1.dir/progress.make\n\n# Include the compile flags for this target's objects.\ninclude CMakeFiles/test1.dir/flags.make\n\nCMakeFiles/test1.dir/main.cpp.o: CMakeFiles/test1.dir/flags.make\nCMakeFiles/test1.dir/main.cpp.o: ../main.cpp\n    @$(CMAKE_COMMAND) -E cmake_echo_color --switch=$(COLOR) --green --progress-dir=&lt;Path&gt;/Desktop/Testing/cmake_build/CMakeFiles --progress-num=$(CMAKE_PROGRESS_1) \"Building CXX object CMakeFiles/test1.dir/main.cpp.o\"\n    /Applications/Xcode6-Beta5.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/c++   $(CXX_DEFINES) $(CXX_INCLUDES) $(CXX_FLAGS) -o CMakeFiles/test1.dir/main.cpp.o -c &lt;Path&gt;/Desktop/Testing/main.cpp\n\nCMakeFiles/test1.dir/main.cpp.i: cmake_force\n    @$(CMAKE_COMMAND) -E cmake_echo_color --switch=$(COLOR) --green \"Preprocessing CXX source to CMakeFiles/test1.dir/main.cpp.i\"\n    /Applications/Xcode6-Beta5.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/c++  $(CXX_DEFINES) $(CXX_INCLUDES) $(CXX_FLAGS) -E &lt;Path&gt;/Desktop/Testing/main.cpp &gt; CMakeFiles/test1.dir/main.cpp.i\n\nCMakeFiles/test1.dir/main.cpp.s: cmake_force\n    @$(CMAKE_COMMAND) -E cmake_echo_color --switch=$(COLOR) --green \"Compiling CXX source to assembly CMakeFiles/test1.dir/main.cpp.s\"\n    /Applications/Xcode6-Beta5.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/c++  $(CXX_DEFINES) $(CXX_INCLUDES) $(CXX_FLAGS) -S &lt;Path&gt;/Desktop/Testing/main.cpp -o CMakeFiles/test1.dir/main.cpp.s\n\nCMakeFiles/test1.dir/main.cpp.o.requires:\n\n.PHONY : CMakeFiles/test1.dir/main.cpp.o.requires\n\nCMakeFiles/test1.dir/main.cpp.o.provides: CMakeFiles/test1.dir/main.cpp.o.requires\n    $(MAKE) -f CMakeFiles/test1.dir/build.make CMakeFiles/test1.dir/main.cpp.o.provides.build\n.PHONY : CMakeFiles/test1.dir/main.cpp.o.provides\n\nCMakeFiles/test1.dir/main.cpp.o.provides.build: CMakeFiles/test1.dir/main.cpp.o\n\n\n# Object files for target test1\ntest1_OBJECTS = \\\n\"CMakeFiles/test1.dir/main.cpp.o\"\n\n# External object files for target test1\ntest1_EXTERNAL_OBJECTS =\n\ntest1: CMakeFiles/test1.dir/main.cpp.o\ntest1: CMakeFiles/test1.dir/build.make\ntest1: CMakeFiles/test1.dir/link.txt\n    @$(CMAKE_COMMAND) -E cmake_echo_color --switch=$(COLOR) --green --bold --progress-dir=&lt;Path&gt;/Desktop/Testing/cmake_build/CMakeFiles --progress-num=$(CMAKE_PROGRESS_2) \"Linking CXX executable test1\"\n    $(CMAKE_COMMAND) -E cmake_link_script CMakeFiles/test1.dir/link.txt --verbose=$(VERBOSE)\n\n# Rule to build all files generated by this target.\nCMakeFiles/test1.dir/build: test1\n\n.PHONY : CMakeFiles/test1.dir/build\n\nCMakeFiles/test1.dir/requires: CMakeFiles/test1.dir/main.cpp.o.requires\n\n.PHONY : CMakeFiles/test1.dir/requires\n\nCMakeFiles/test1.dir/clean:\n    $(CMAKE_COMMAND) -P CMakeFiles/test1.dir/cmake_clean.cmake\n.PHONY : CMakeFiles/test1.dir/clean\n\nCMakeFiles/test1.dir/depend:\n    cd &lt;Path&gt;/Desktop/Testing/cmake_build &amp;&amp; $(CMAKE_COMMAND) -E cmake_depends \"Unix Makefiles\" &lt;Path&gt;/Desktop/Testing &lt;Path&gt;/Desktop/Testing &lt;Path&gt;/Desktop/Testing/cmake_build &lt;Path&gt;/Desktop/Testing/cmake_build &lt;Path&gt;/Desktop/Testing/cmake_build/CMakeFiles/test1.dir/DependInfo.cmake --color=$(COLOR)\n.PHONY : CMakeFiles/test1.dir/depend\n</code></pre>\n\n<p>Edit 4 (make verbose output):</p>\n\n<pre><code>/usr/local/bin/cmake -H&lt;Path&gt;/Desktop/Testing -B&lt;Path&gt;/Desktop/Testing/cmake_build --check-build-system CMakeFiles/Makefile.cmake 0\n/usr/local/bin/cmake -E cmake_progress_start &lt;Path&gt;/Desktop/Testing/cmake_build/CMakeFiles &lt;Path&gt;/Desktop/Testing/cmake_build/CMakeFiles/progress.marks\n/Applications/Xcode6-Beta5.app/Contents/Developer/usr/bin/make -f CMakeFiles/Makefile2 all\n/Applications/Xcode6-Beta5.app/Contents/Developer/usr/bin/make -f CMakeFiles/test1.dir/build.make CMakeFiles/test1.dir/depend\ncd &lt;Path&gt;/Desktop/Testing/cmake_build &amp;&amp; /usr/local/bin/cmake -E cmake_depends \"Unix Makefiles\" &lt;Path&gt;/Desktop/Testing &lt;Path&gt;/Desktop/Testing &lt;Path&gt;/Desktop/Testing/cmake_build &lt;Path&gt;/Desktop/Testing/cmake_build &lt;Path&gt;/Desktop/Testing/cmake_build/CMakeFiles/test1.dir/DependInfo.cmake --color=\n/Applications/Xcode6-Beta5.app/Contents/Developer/usr/bin/make -f CMakeFiles/test1.dir/build.make CMakeFiles/test1.dir/build\n</code></pre>\n"}, {"tags": ["c++", "compiler-construction", "llvm"], "answers": [{"comments": [{"owner": {"reputation": 4347, "user_id": 2105636, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A8kiD.jpg?s=128&g=1", "display_name": "Matthew Sanders", "link": "https://stackoverflow.com/users/2105636/matthew-sanders"}, "edited": false, "score": 0, "creation_date": 1451917112, "post_id": 34585860, "comment_id": 56931429, "body": "Thank you!  I will probably start with that approach."}], "tags": [], "owner": {"reputation": 4894, "user_id": 1071273, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4A2ko.jpg?s=128&g=1", "display_name": "Michael Haidl", "link": "https://stackoverflow.com/users/1071273/michael-haidl"}, "is_accepted": true, "score": 1, "last_activity_date": 1548169359, "last_edit_date": 1548169359, "creation_date": 1451889320, "answer_id": 34585860, "question_id": 34440614, "link": "https://stackoverflow.com/questions/34440614/how-to-resolve-allocainst-from-a-value-that-was-a-result-of-a-loadinst-in-llvm/34585860#34585860", "title": "How to resolve AllocaInst from a Value that was a result of a LoadInst in LLVM?", "body": "<p>When you are returning a <code>llvm::Value*</code> (in your case it is a <code>LoadInst*</code>) you can cast the <code>llvm:Value*</code> to <code>llvm::LoadInst*</code> using the the LLVM RTTI system like this: </p>\n\n<pre><code>Value* val = someFunction(...); \nif (llvm::LoadInst* I = dyn_cast&lt;llvm::LoadInst&gt;(val)\n{\n     // do something with the load instruction I\n}\nelse // not a load instruction\n</code></pre>\n\n<p>When have your <code>llvm::LoadInst*</code> you can easily access the address where the load has happened with getPointerOperand(). \nNow you can try to cast the pointer operand back to an <code>AllocaInst*</code> as in the example above. If it succeeds you have your <code>AllocaInst</code>, when it failes it is something else (e.g. a <code>GetElementPtrInst</code>). </p>\n"}], "owner": {"reputation": 4347, "user_id": 2105636, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A8kiD.jpg?s=128&g=1", "display_name": "Matthew Sanders", "link": "https://stackoverflow.com/users/2105636/matthew-sanders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 950, "favorite_count": 1, "accepted_answer_id": 34585860, "answer_count": 1, "score": 4, "last_activity_date": 1548169359, "creation_date": 1450890673, "last_edit_date": 1495539946, "question_id": 34440614, "link": "https://stackoverflow.com/questions/34440614/how-to-resolve-allocainst-from-a-value-that-was-a-result-of-a-loadinst-in-llvm", "title": "How to resolve AllocaInst from a Value that was a result of a LoadInst in LLVM?", "body": "<p>Conceptually what I would like to do is pretty simple.  I am using the <a href=\"http://llvm.org/docs/tutorial/LangImpl7.html#memory-in-llvm\" rel=\"nofollow noreferrer\">Alloca technique described in the Kaleidoscope example</a> paired with <a href=\"http://llvm.org/docs/Passes.html#mem2reg-promote-memory-to-register\" rel=\"nofollow noreferrer\">mem2reg</a> to reduce the need to manually create Phi nodes.</p>\n\n<p>I have implemented several aspects of my custom language, but I have ran into a problem with implementing post increment/decrement in a generic way.  </p>\n\n<p>My AST node <code>PostIncrDecrNode</code> contains a token to denote <code>++</code> or <code>--</code> and an expression AST node that is codegened to return an <code>llvm::Value*</code> much like the Kaleidoscope example.  I have already noticed that I will likely need to return something other then an <code>llvm::Value*</code> as my language is very type safe and I need to know things such as signedness of integral types, but now I feel that I may also need to keep track of the <code>llvm::AllocaInst</code>.</p>\n\n<p>A simple example situation is code like this:</p>\n\n<pre><code>int myfunction(int i)\n{\n    return i++;\n}\n</code></pre>\n\n<p>My debug AST print looks like this:</p>\n\n<pre><code>- CompilationUnit:test.str\n    - FunctionDeclarationNode\n        - IdentifierNode:int\n        - IdentifierNode:myfunction\n        - FunctionParameterNode\n            - IdentifierNode:int\n            - IdentifierNode:i\n        - BlockNode\n            - ReturnNode\n                - PostIncrDecrNode\n                    - IdentifierNode:i\n</code></pre>\n\n<p>The last two lines are the relevant part here as I have a <code>PostIncrDecrNode</code> that contains an <code>IdentifierNode</code> that will be codegened like this:</p>\n\n<pre><code>Value* IdentifierNode::codeGenInternal(CodeGenContext&amp; context)\n{\n    Value* rtn = NULL;\n    SharedSymbolEntry entry = context.getSymbolInScopeByName(*value);\n    Value* val = entry ? entry-&gt;llvmVal : NULL;\n    if(val)\n    {\n        IRBuilder&lt;&gt;* builder = context.getIRBuilder();\n        rtn = builder-&gt;CreateLoad(val, value-&gt;c_str());\n    }\n    else\n    {\n        context.handleCodeGenError(*this, \"Unknown variable name: \" + Twine(value-&gt;c_str()));\n\n    }\n    return rtn;\n}\n</code></pre>\n\n<p>The line <code>SharedSymbolEntry entry = context.getSymbolInScopeByName(*value);</code> uses the stored <code>shared_ptr</code> to <code>std::String</code> 'value' member of the <code>IdentifierNode</code> (aka the variable name) to look up my <code>SharedSymbolEntry</code> (just a wrapper type to store language specific information along with the <code>llvm::Value*</code> which is the <code>llvm::AllocaInst*</code>) in the context stack which is populated with entry block allocas by function parameters or variable AST nodes.</p>\n\n<p>The problem is that the <code>PostIncrDecrNode</code> doesn't have access to the alloca, only the returned <code>llvm::Value*</code> from the load <code>rtn = builder-&gt;CreateLoad(val, value-&gt;c_str());</code>.</p>\n\n<p>Is there any way in LLVM to resolve the <code>llvm::AllocaInst*</code> from the <code>llvm::Value*</code> in order to use it in a store instruction (the store instruction needs a pointer and I only have the integral value in this case)?</p>\n\n<p>I ran into a few similar questions, but I'm not sure if they answer my question.\nThe last one seems to suggest that this may not be possible at all so I would be curious how others have solved this problem.</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/14503561/llvm-dependencies-alloca-load\">llvm-dependencies-alloca-load</a></li>\n<li><a href=\"https://stackoverflow.com/questions/26325698/llvm-pass-how-to-insert-a-variable-using-existing-variable-value\">llvm-pass-how-to-insert-a-variable-using-existing-variable-value</a></li>\n<li><a href=\"https://stackoverflow.com/questions/16692984/get-pointer-to-llvmvalue-previously-allocated-for-createload-function\">get-pointer-to-llvmvalue-previously-allocated-for-createload-function</a></li>\n</ul>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 2, "creation_date": 1450890109, "post_id": 34440431, "comment_id": 56622035, "body": "The only standard usage of a debugging macro is in <code>assert</code>, which uses <code>NDEBUG</code>."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 2, "creation_date": 1450890342, "post_id": 34440431, "comment_id": 56622165, "body": "Deciding whether to define <code>NDEBUG</code> is (intentionally, I believe) left up to you, not done automatically based on debug/release build. Quite a few people prefer to lead <code>assert</code>s active in release builds."}], "owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "closed_date": 1450890417, "answer_count": 0, "score": 0, "last_activity_date": 1450889981, "creation_date": 1450889981, "question_id": 34440431, "link": "https://stackoverflow.com/questions/34440431/ndebug-macro-is-never-defined-msvc-compiler-is-debug-standard", "closed_reason": "Duplicate", "title": "NDEBUG macro is never defined - MSVC compiler. Is _DEBUG standard?", "body": "<p>As I understand, whenever the compiler is building in release mode, the macro <code>NDEBUG</code> is defined, while in debug mode it isn't. That is how <code>assert</code> knows when to work.</p>\n\n<p>What I've noticed though is that with the MSVC compiler (2015), <code>NDEBUG</code> is never defined, regardless of the build mode. </p>\n\n<p>Anyway, <code>_DEBUG</code> is defined. Is this macro standard C++ or some MSVC thing? Should I use it if I'm aiming for compatibility? Does it work with other compilers? (couldn't check) Thanks!</p>\n"}, {"tags": ["c++", "batch-file", "windows-8"], "comments": [{"owner": {"reputation": 181, "user_id": 5658989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baa23e60815e22c46d844691b84677f5?s=128&d=identicon&r=PG&f=1", "display_name": "Koebmand STO", "link": "https://stackoverflow.com/users/5658989/koebmand-sto"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1450890914, "post_id": 34440427, "comment_id": 56622490, "body": "The difference between GUI and commandline commands (key sequences you need to remember) is big. Why would I install a program that does the same as the standard screensaver settings?"}, {"owner": {"reputation": 181, "user_id": 5658989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baa23e60815e22c46d844691b84677f5?s=128&d=identicon&r=PG&f=1", "display_name": "Koebmand STO", "link": "https://stackoverflow.com/users/5658989/koebmand-sto"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1450891462, "post_id": 34440427, "comment_id": 56622784, "body": "Users can&#39;t change the timeouts if you deny them that right.(see group policies). Your comments has nothing to do with my question and your suggestions are completely useless / wrong."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 1, "creation_date": 1450892113, "post_id": 34440427, "comment_id": 56623139, "body": "Sending a system message to the desktop window work (or should work), but just (1) process it via <code>DefWindowProc</code>, (2) use the symbolic name, not magic numbers, and (3) remember to add a little delay with consumption of any user input, lest mouse movements stop the screensaver as soon as it&#39;s started."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1450892255, "post_id": 34440427, "comment_id": 56623218, "body": "No prob. Deleting them. Excuse me for trying to help. I promise it won&#39;t happen again."}, {"owner": {"reputation": 181, "user_id": 5658989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baa23e60815e22c46d844691b84677f5?s=128&d=identicon&r=PG&f=1", "display_name": "Koebmand STO", "link": "https://stackoverflow.com/users/5658989/koebmand-sto"}, "edited": false, "score": 0, "creation_date": 1450895731, "post_id": 34440427, "comment_id": 56624978, "body": "Thank you Alf. I can&#39;t find any details on why I want DefWindowProc over SendMessage, is it possible to explain in short or provide a link? As for symbolic names, need to find them somewhere, and yeah it needs a delay."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 5658989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baa23e60815e22c46d844691b84677f5?s=128&d=identicon&r=PG&f=1", "display_name": "Koebmand STO", "link": "https://stackoverflow.com/users/5658989/koebmand-sto"}, "edited": false, "score": 0, "creation_date": 1450900938, "post_id": 34441940, "comment_id": 56627436, "body": "Is NULL not a better choice for LParam than 0? Since it represent cursor position if read. (thought I posted this once already but don&#39;t see it)."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 181, "user_id": 5658989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baa23e60815e22c46d844691b84677f5?s=128&d=identicon&r=PG&f=1", "display_name": "Koebmand STO", "link": "https://stackoverflow.com/users/5658989/koebmand-sto"}, "edited": false, "score": 0, "creation_date": 1450905227, "post_id": 34441940, "comment_id": 56629325, "body": "The <code>lParam</code> parameter is not a pointer, it is an integer (<code>LPARAM</code> is an alias for <code>LONG_PTR</code>, which is an alias for <code>long</code> in 32bit and <code>__int64</code> in 64bit). <code>NULL</code> is just an alias for 0. The <code>lParam</code> has no meaning in the <code>SC_SCREENSAVE</code> notification. Read the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms646360.aspx\" rel=\"nofollow noreferrer\"><code>WM_SYSCOMMAND</code> documentation</a>. Even if coordinates were specified, they are not passed as a pointer, the <code>lParam</code> value would have to be created using the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms632661.aspx\" rel=\"nofollow noreferrer\"><code>MAKELPARAM()</code></a> macro instead."}, {"owner": {"reputation": 181, "user_id": 5658989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baa23e60815e22c46d844691b84677f5?s=128&d=identicon&r=PG&f=1", "display_name": "Koebmand STO", "link": "https://stackoverflow.com/users/5658989/koebmand-sto"}, "edited": false, "score": 0, "creation_date": 1450913130, "post_id": 34441940, "comment_id": 56632409, "body": "&quot;lParam      The low-order word specifies the horizontal position of the cursor, in screen coordinates, if a window menu command is chosen with the mouse. Otherwise, this parameter is not used. &quot;"}, {"owner": {"reputation": 181, "user_id": 5658989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baa23e60815e22c46d844691b84677f5?s=128&d=identicon&r=PG&f=1", "display_name": "Koebmand STO", "link": "https://stackoverflow.com/users/5658989/koebmand-sto"}, "edited": false, "score": 0, "creation_date": 1450914011, "post_id": 34441940, "comment_id": 56632694, "body": "I did read that link, which is why I know its a location if its used. But I forgot c++ doesn&#39;t have a real NULL value. Still it shows the reader of the code the value is not meant to be used rather than have to go read the documentation to see why you send 0. But it is also true the NULL is sometimes recommended to not use in c++."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 0, "last_activity_date": 1450896632, "creation_date": 1450896632, "answer_id": 34441940, "question_id": 34440427, "link": "https://stackoverflow.com/questions/34440427/how-to-create-desktop-icon-button-to-start-users-windows-screensaver-with-opti/34441940#34441940", "title": "How to create desktop icon / button to start users Windows screensaver with options set", "body": "<p>There is no built-in batch command for running the user's screensaver (without using a 3rd party solution to facilitate it). The code you have come up with is the correct solution for starting the user's screen saver.  However, don't use magic number literals like you have shown. There are defines available for those values, use them:</p>\n\n<pre><code>#include &lt;windows.h&gt;\n\nint main(void)\n{\n    SendMessage(GetDesktopWindow(), WM_SYSCOMMAND, SC_SCREENSAVE, 0);\n    return 0;\n}\n</code></pre>\n\n<p>Compile your code into an <code>.exe</code> file, install it on the user's PC somewhere, and create a shortcut to it on the user's Desktop.</p>\n"}], "owner": {"reputation": 181, "user_id": 5658989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baa23e60815e22c46d844691b84677f5?s=128&d=identicon&r=PG&f=1", "display_name": "Koebmand STO", "link": "https://stackoverflow.com/users/5658989/koebmand-sto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 34441940, "answer_count": 1, "score": 0, "last_activity_date": 1450900788, "creation_date": 1450889954, "last_edit_date": 1450900788, "question_id": 34440427, "link": "https://stackoverflow.com/questions/34440427/how-to-create-desktop-icon-button-to-start-users-windows-screensaver-with-opti", "title": "How to create desktop icon / button to start users Windows screensaver with options set", "body": "<p>I need a button I can put on the users desktop/process bar in Windows 8 (any sub menu is unacceptable), that will start the users screensaver (with password protection, custom parameters etc). This can for example be a shortcut to a batch script.</p>\n\n<p>Some suggestions for solutions I have found:</p>\n\n<p><strong>Starting screensaver from /system32</strong>: Does not work</p>\n\n<ol>\n<li>Starts a specific screensaver you choose, not the users screensaver.</li>\n<li>Does not take parameters (ie wrong text/pic and no password protection).</li>\n</ol>\n\n<p><strong>WIN + L</strong>: Does not work.</p>\n\n<ol>\n<li>It is not a button on the users Desktop, and SendKeys does not seem to be able to do the WIN key, so a batch script for this is not possible.</li>\n<li>It goes to log in screen, not screensaver.</li>\n</ol>\n\n<p><strong>rundll32.exe user32.dll, LockWorkStation</strong>: Does not work.</p>\n\n<ol>\n<li>It corrupts the stack - <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20040115-00/?p=41043/\" rel=\"nofollow\">https://blogs.msdn.microsoft.com/oldnewthing/20040115-00/?p=41043/</a></li>\n</ol>\n\n<p><strong>C++ program</strong>: So far this is what I have that might work.</p>\n\n<pre><code>#include &lt;windows.h&gt;\n\nint WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPTSTR lpCmdLine, int cmdShow)\n{\n  HWND DeskWin = GetDesktopWindow();\n  Sleep(750);\n  PostMessage(DeskWin, WM_SYSCOMMAND, SC_SCREENSAVE, NULL);\n  return 0;\n}\n</code></pre>\n\n<p>I have never worked with Windows system messages before, so any comments / thoughts on if this will always work is appreciated.</p>\n\n<p>Or if someone just have a way they think is better.</p>\n\n<p>--\nReasons for the need: IT-scared users. They will laugh at you if you suggest remembering a hotkey combination, or going through multiple menus (like Start -> userName -> Lock), the latter is also a time problem as they might have to leave computer fast (hence the need for password protection).</p>\n\n<p>EDIT** C++ Code has been modified to reflect feedback. Sendmessage changed to Postmessage, don't want a blocking call in a codesnip like this (but don't see why it should be thrown at DefWindowProc when the window is known). Symbolic names found (<a href=\"http://wiki.winehq.org/List_Of_Windows_Messages\" rel=\"nofollow\">http://wiki.winehq.org/List_Of_Windows_Messages</a> , can't post more links, MSDN has the second parameters under WM_SYSCOMMAND), WinMain is a Visual Studio thing to avoid the console pop up, which some people find alarming.</p>\n"}, {"tags": ["c++", "xcode", "assembly"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1450890058, "post_id": 34440376, "comment_id": 56622002, "body": "@NathanOliver I don&#39;t think you have read the title. If you did you should have noticed it says <b>unoptimized</b>  :)"}, {"owner": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "edited": false, "score": 0, "creation_date": 1450900366, "post_id": 34440376, "comment_id": 56627184, "body": "Can you post the asm for the 4 int code as well? I&#39;m not familiar enough with the internals of the Xcode compiler but it&#39;s possible it might have something to do with padding (i.e. <code>sizeof(int)*4</code> can fit &#39;nicely&#39; in the registers vs. <code>sizeof(int)*3</code> which needs some extra work) ..?"}, {"owner": {"reputation": 11, "user_id": 5711914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be1b42f0912352403571e71a762c81b?s=128&d=identicon&r=PG&f=1", "display_name": "BennyM", "link": "https://stackoverflow.com/users/5711914/bennym"}, "edited": false, "score": 0, "creation_date": 1450901765, "post_id": 34440376, "comment_id": 56627813, "body": "I it is unoptimized but I would have thought the behaviour in each case would be fairly similar."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1450902451, "post_id": 34440376, "comment_id": 56628120, "body": "Unoptimized means &quot;don&#39;t care&quot;, so the compiler doesn&#39;t. Some things just happen and will be fixed by the optimizer later."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1450904136, "post_id": 34440376, "comment_id": 56628852, "body": "If the compiler was being as &quot;logical&quot; as it could be it wouldn&#39;t generate any code at all, as your code has no externally visible effect. My guess is that you crossed a threshold between different copying strategies for the struct, eg. from a member-wise copy to using <code>memcpy</code>, and the difference allowed the compiler to see one of the copies wasn&#39;t necessary. But who knows, unoptimized code is dumb code by design. It just needs to be correct, it doesn&#39;t need to make any sense."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5711914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be1b42f0912352403571e71a762c81b?s=128&d=identicon&r=PG&f=1", "display_name": "BennyM", "link": "https://stackoverflow.com/users/5711914/bennym"}, "edited": false, "score": 0, "creation_date": 1451210254, "post_id": 34444025, "comment_id": 56700363, "body": "Thanks, that&#39;s made things a bit clearer. But <code>struct A{long a; int b;};</code> produces the concise asm output that I would have expected from the struct with 3 <code>int</code> members. I guess I was expecting that all differences in output would be directly attributable to C++ language rules (even if superfluous)."}], "tags": [], "owner": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "is_accepted": false, "score": 0, "last_activity_date": 1450906238, "creation_date": 1450906238, "answer_id": 34444025, "question_id": 34440376, "link": "https://stackoverflow.com/questions/34440376/c-differences-in-the-unoptimized-assembly-generated-based-on-number-of-members/34444025#34444025", "title": "C++ Differences in the unoptimized assembly generated based on number of members", "body": "<p>As comments have pointed out, unoptimized code is just that; not optimized. That doesn't mean the compiler won't do <i>any</i> optimizations where it makes sense to do so, it just won't do any additional optimizations.</p>\n\n<p>In your code (assuming you're building for an <code>x86_64</code>), <code>sizeof(X)</code> where <code>X</code> has 3 <code>int</code> members would be <code>sizeof(int)*3</code>, which is 3 * 32-bits (or 1*64-bit + 1*32-bit), where as <code>sizeof(X)</code> with 4 <code>int</code> members would be <code>sizeof(int)*4</code>, which is 4 * 32-bits (or 2*64-bit).</p>\n\n<p>Since the 4 member <code>X</code> struct can fit nicely on 2 quad word boundaries, the compiler didn't need to preform any  'optimizations' and can thus do what it did:</p>\n\n<pre><code>; movq is a 64-bit instruction\n0x100000f0b &lt;+43&gt;: movq   -0x18(%rbp), %rdi ; X.a\n0x100000f0f &lt;+47&gt;: movq   -0x10(%rbp), %rsi ; X.b\n0x100000f13 &lt;+51&gt;: movq   -0x28(%rbp), %rdx ; X.c\n0x100000f17 &lt;+55&gt;: movq   -0x20(%rbp), %rcx ; X.d\n</code></pre>\n\n<p>But since the 3 member <code>X</code> struct can only fit nicely on 1 quad word boundary (with the remainder sitting on a double word), the compiler had to do some extra work to reference the proper locations of the struct within the registers and thus the output:</p>\n\n<pre><code>; movl is a 32-bit instruction\n0x100000efb &lt;+43&gt;:  movq   -0x18(%rbp), %rdi\n0x100000eff &lt;+47&gt;:  movq   %rdi, -0x38(%rbp)\n0x100000f03 &lt;+51&gt;:  movl   -0x10(%rbp), %esi ; 32-bit instruction\n0x100000f06 &lt;+54&gt;:  movl   %esi, -0x30(%rbp)\n0x100000f09 &lt;+57&gt;:  movq   -0x38(%rbp), %rdi\n0x100000f0d &lt;+61&gt;:  movl   -0x30(%rbp), %esi\n0x100000f10 &lt;+64&gt;:  movq   -0x28(%rbp), %rax\n0x100000f14 &lt;+68&gt;:  movq   %rax, -0x48(%rbp)\n0x100000f18 &lt;+72&gt;:  movl   -0x20(%rbp), %ecx\n0x100000f1b &lt;+75&gt;:  movl   %ecx, -0x40(%rbp)\n0x100000f1e &lt;+78&gt;:  movq   -0x48(%rbp), %rdx\n0x100000f22 &lt;+82&gt;:  movl   -0x40(%rbp), %ecx\n</code></pre>\n\n<p>Both cases are unoptimized since nothing extra was done to either sets of code; the 4 member struct might appear optimized, but it was not, and chances are that even with optimizations turn on, the assembly for that would probably be the same.</p>\n\n<p>If you enabled optimizations on this code there's a good chance the compiler would have added an extra hidden <code>int</code> member in the 3 member <code>X</code> so as to properly pad it to fit on the boundaries.</p>\n\n<p>You might also see similarly small asm output if you changed the last type in the 3 member struct to a <code>long</code>, example:</p>\n\n<pre><code>struct X {\n    int a, b; // assuming sizeof(int) === 4\n    long c;   // assuming sizeof(long) == 8\n};\n</code></pre>\n\n<p>Hope that can help.</p>\n"}], "owner": {"reputation": 11, "user_id": 5711914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be1b42f0912352403571e71a762c81b?s=128&d=identicon&r=PG&f=1", "display_name": "BennyM", "link": "https://stackoverflow.com/users/5711914/bennym"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450906238, "creation_date": 1450889718, "last_edit_date": 1450901554, "question_id": 34440376, "link": "https://stackoverflow.com/questions/34440376/c-differences-in-the-unoptimized-assembly-generated-based-on-number-of-members", "title": "C++ Differences in the unoptimized assembly generated based on number of members", "body": "<p>I am wondering why, for example, the assembly generated when passing an object with 3 int members appears to contain far more redundant copying than when passing an object with 4 int members. I am compiling on OS X and get roughly the same result using both Eclipse and Xcode.</p>\n\n<p>With 3 members:</p>\n\n<pre><code>struct X{\n    int a,b,c;\n    X(int i) : a{i}, b{i+1}, c{i+2} {}\n};\n\nint f(X p1, X p2){\n    int res = p1.b + p2.c + 22;\n    return res;\n}\n\nint main() {\n    int x = f(5,10);\n    return 0;\n}\n</code></pre>\n\n<p>The following assembly is produced in Xcode:</p>\n\n<pre><code>test`main:\n    0x100000ed0 &lt;+0&gt;:   pushq  %rbp\n    0x100000ed1 &lt;+1&gt;:   movq   %rsp, %rbp\n    0x100000ed4 &lt;+4&gt;:   subq   $0x50, %rsp\n    0x100000ed8 &lt;+8&gt;:   leaq   -0x18(%rbp), %rdi\n    0x100000edc &lt;+12&gt;:  movl   $0x5, %esi\n    0x100000ee1 &lt;+17&gt;:  movl   $0x0, -0x4(%rbp)\n-&gt;  0x100000ee8 &lt;+24&gt;:  callq  0x100000f40               ; X::X at main.cpp:14\n    0x100000eed &lt;+29&gt;:  leaq   -0x28(%rbp), %rdi\n    0x100000ef1 &lt;+33&gt;:  movl   $0xa, %esi\n    0x100000ef6 &lt;+38&gt;:  callq  0x100000f40               ; X::X at    main.cpp:14\n    0x100000efb &lt;+43&gt;:  movq   -0x18(%rbp), %rdi\n    0x100000eff &lt;+47&gt;:  movq   %rdi, -0x38(%rbp)\n    0x100000f03 &lt;+51&gt;:  movl   -0x10(%rbp), %esi\n    0x100000f06 &lt;+54&gt;:  movl   %esi, -0x30(%rbp)\n    0x100000f09 &lt;+57&gt;:  movq   -0x38(%rbp), %rdi\n    0x100000f0d &lt;+61&gt;:  movl   -0x30(%rbp), %esi\n    0x100000f10 &lt;+64&gt;:  movq   -0x28(%rbp), %rax\n    0x100000f14 &lt;+68&gt;:  movq   %rax, -0x48(%rbp)\n    0x100000f18 &lt;+72&gt;:  movl   -0x20(%rbp), %ecx\n    0x100000f1b &lt;+75&gt;:  movl   %ecx, -0x40(%rbp)\n    0x100000f1e &lt;+78&gt;:  movq   -0x48(%rbp), %rdx\n    0x100000f22 &lt;+82&gt;:  movl   -0x40(%rbp), %ecx\n    0x100000f25 &lt;+85&gt;:  callq  0x100000e80               ; f(X, X) at     main.cpp:17\n    0x100000f2a &lt;+90&gt;:  xorl   %ecx, %ecx\n    0x100000f2c &lt;+92&gt;:  movl   %eax, -0x8(%rbp)\n    0x100000f2f &lt;+95&gt;:  movl   %ecx, %eax\n    0x100000f31 &lt;+97&gt;:  addq   $0x50, %rsp\n    0x100000f35 &lt;+101&gt;: popq   %rbp\n    0x100000f36 &lt;+102&gt;: retq  \n</code></pre>\n\n<p>The two objects are constructed and then copied to another location before being placed in registers for passing to f(). When a fourth int member is added to X, the objects are constructed and then placed directly in the registers. This seems more logical. Just wondering what would account for the difference.</p>\n\n<p>Then with four members:</p>\n\n<pre><code>struct X{\n    int a,b,c,d;\n    X(int i) : a{i}, b{i+1}, c{i+2}, d{i+3} {}\n};\n\nint f(X p1, X p2){\n    int res = p1.b + p2.c + 22;\n    return res;\n}\n\nint main() {\n    int x = f(5,10);\n    return 0;\n}\n</code></pre>\n\n<p>The assembly looks like this: </p>\n\n<pre><code>test`main:\n    0x100000ee0 &lt;+0&gt;:  pushq  %rbp\n    0x100000ee1 &lt;+1&gt;:  movq   %rsp, %rbp\n    0x100000ee4 &lt;+4&gt;:  subq   $0x30, %rsp\n    0x100000ee8 &lt;+8&gt;:  leaq   -0x18(%rbp), %rdi\n    0x100000eec &lt;+12&gt;: movl   $0x5, %esi\n    0x100000ef1 &lt;+17&gt;: movl   $0x0, -0x4(%rbp)\n-&gt;  0x100000ef8 &lt;+24&gt;: callq  0x100000f30               ; X::X at main.cpp:14\n    0x100000efd &lt;+29&gt;: leaq   -0x28(%rbp), %rdi\n    0x100000f01 &lt;+33&gt;: movl   $0xa, %esi\n    0x100000f06 &lt;+38&gt;: callq  0x100000f30               ; X::X at main.cpp:14\n    0x100000f0b &lt;+43&gt;: movq   -0x18(%rbp), %rdi\n    0x100000f0f &lt;+47&gt;: movq   -0x10(%rbp), %rsi\n    0x100000f13 &lt;+51&gt;: movq   -0x28(%rbp), %rdx\n    0x100000f17 &lt;+55&gt;: movq   -0x20(%rbp), %rcx\n    0x100000f1b &lt;+59&gt;: callq  0x100000eb0               ; f(X, X) at main.cpp:17\n    0x100000f20 &lt;+64&gt;: xorl   %r8d, %r8d\n    0x100000f23 &lt;+67&gt;: movl   %eax, -0x8(%rbp)\n    0x100000f26 &lt;+70&gt;: movl   %r8d, %eax\n    0x100000f29 &lt;+73&gt;: addq   $0x30, %rsp\n    0x100000f2d &lt;+77&gt;: popq   %rbp\n    0x100000f2e &lt;+78&gt;: retq   \n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "callback", "pthreads", "this", "derived-class"], "comments": [{"owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 0, "creation_date": 1450889974, "post_id": 34440316, "comment_id": 56621947, "body": "Why are you storing <code>instancePtr</code> rather than just using <code>this</code>?"}, {"owner": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "reply_to_user": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 0, "creation_date": 1450890224, "post_id": 34440316, "comment_id": 56622107, "body": "@AlanStokes when the &quot;this&quot; pointer in the callback() function points to the base and not the derived object. So I was trying to verify if what I want gets passed on correctly. I agree it is now redundant code ."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1450890759, "post_id": 34440316, "comment_id": 56622398, "body": "So no join operation in main after all"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1450890774, "post_id": 34440316, "comment_id": 56622410, "body": "Btw why you do not use <code>std::thread</code> and all that nonsense with pthread?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1450890872, "post_id": 34440316, "comment_id": 56622468, "body": "In the future, you can just edit your original question, especially if you are just fixing your code sample and not <i>changing</i> the question and there are no valid answers to your original question."}, {"owner": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1450890890, "post_id": 34440316, "comment_id": 56622475, "body": "@Slava well because I come from a C background , and I also try to avoid using C++11 for this project, so I never really tried them."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1450890913, "post_id": 34440316, "comment_id": 56622489, "body": "@Slava, <code>pthread</code> is hardly nonsense. Neither as learning exercise or as the popular backend of <code>std::thread</code>"}, {"owner": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1450891059, "post_id": 34440316, "comment_id": 56622567, "body": "@StoryTeller I really though that a derived class acted as a monolithic class (base + derived). I did not know the derived can die while the base still lives on... This is something new to learn today."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1450891255, "post_id": 34440316, "comment_id": 56622668, "body": "@StoryTeller I did not say that <code>pthread</code> is nonsense. But wrapping C library in C++ when it has native library now is. Especially on Windows where pthread is wrapper by itself."}, {"owner": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1450892515, "post_id": 34440316, "comment_id": 56623376, "body": "@Slava I will take a look into <code>std::threads</code> as well. seems I was stuck with an old thing I read somewhere some time ago. I cannot find the link now, but more or less it said that if you want good threads either do <code>pthreads</code> or go for <code>boost::threads</code>. or something like that. it seems it is not the case anylonger."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1450892681, "post_id": 34440316, "comment_id": 56623469, "body": "@nass <code>boost::thread</code> is adopted by standard and became <code>std::thread</code>, usage is pretty much the same. It is very easy to switch from one to another."}], "answers": [{"comments": [{"owner": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "edited": false, "score": 0, "creation_date": 1450891139, "post_id": 34440584, "comment_id": 56622606, "body": "I really thought that a derived class acted as unified block class (base + derived). I did not know the derived can die while the base still lives on... I thought the <code>~ThreadWrite()</code>, also calls <code>~cppthread()</code>.  This is something new to learn today."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "edited": false, "score": 0, "creation_date": 1450891381, "post_id": 34440584, "comment_id": 56622737, "body": "@nass you do not understand the issue. Both destructors are called indeed, but that does not happen instantly, there is race condition - while <code>~ThreadWrite()</code> is working you call virtual function."}, {"owner": {"reputation": 905, "user_id": 5170218, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e746d5acb1323eea69830a11b4a12ef2?s=128&d=identicon&r=PG&f=1", "display_name": "SACHIN GOYAL", "link": "https://stackoverflow.com/users/5170218/sachin-goyal"}, "edited": false, "score": 0, "creation_date": 1450891534, "post_id": 34440584, "comment_id": 56622831, "body": "Thanks Alan for this great explanation ."}, {"owner": {"reputation": 905, "user_id": 5170218, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e746d5acb1323eea69830a11b4a12ef2?s=128&d=identicon&r=PG&f=1", "display_name": "SACHIN GOYAL", "link": "https://stackoverflow.com/users/5170218/sachin-goyal"}, "reply_to_user": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "edited": false, "score": 0, "creation_date": 1450891624, "post_id": 34440584, "comment_id": 56622879, "body": "@nass: i missed to tell you on previous link that i kept the main thread on sleep because of the same , I got the expected output ."}], "tags": [], "owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "is_accepted": true, "score": 5, "last_activity_date": 1450890556, "creation_date": 1450890556, "answer_id": 34440584, "question_id": 34440316, "link": "https://stackoverflow.com/questions/34440316/c-pthread-and-static-callbacks-this-returns-a-pointer-to-the-base-class-i/34440584#34440584", "title": "c++ , pthread and static callbacks. &quot;this&quot; returns a pointer to the base class inctead of the derived one (part 2)", "body": "<p>You need to wait for the thread to terminate before you return from <code>main</code>, because that destroys your object.</p>\n\n<p>Otherwise you have a race condition:</p>\n\n<ol>\n<li>The thread is started.</li>\n<li><code>thrrdupd</code> starts to be destoyed as you leave <code>main</code>.</li>\n<li><code>~ThreadedWrite</code> runs; at this point the object is no longer a <code>ThreadedWrite</code> but a <code>cppthread</code>.</li>\n<li><code>~cppthread</code> runs and waits for the thread.</li>\n<li>The thread calls the callback and because the object now has dynamic type <code>cppthread</code>, <code>cppthread::threadedFunc</code> is called.</li>\n</ol>\n\n<p>It is possible that 5. might happen before 3., in which case you will get the expected output.</p>\n\n<p>If you make sure you wait for the thread to finish at step 3. then it will work fine. Perhaps you could call <code>terminate</code> inside <code>~ThreadedWrite</code>?</p>\n"}], "owner": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 34440584, "answer_count": 1, "score": 1, "last_activity_date": 1450890556, "creation_date": 1450889524, "last_edit_date": 1495540324, "question_id": 34440316, "link": "https://stackoverflow.com/questions/34440316/c-pthread-and-static-callbacks-this-returns-a-pointer-to-the-base-class-i", "title": "c++ , pthread and static callbacks. &quot;this&quot; returns a pointer to the base class inctead of the derived one (part 2)", "body": "<p>this thread was started <a href=\"https://stackoverflow.com/questions/34438946/c-pthread-and-static-callbacks-this-returns-a-pointer-to-the-base-class-i\">here</a> but due to lack of an altogether good example (and in order to avoid delete all that question) it is re-written here.</p>\n\n<p>So, in the following example, the <code>void cppthread::ThreadedFunc()</code> gets spawned to execute as a separate thread . Instead I would prefer <code>void ThreadedWrite::ThreadedFunc()</code> to be executed. How can I do that? (some more details follow after the code)</p>\n\n<p>cppthread.hpp</p>\n\n<pre><code>#ifndef CPPTHREAD_HPP\n#define CPPTHREAD_HPP\n\n#include &lt;pthread.h&gt;\n\nusing namespace std;\n\nclass cppthread\n{\n    public:\n        cppthread();\n        virtual ~cppthread();\n\n        virtual void threadedFunc();\n        ///parentObj (ie \"this\" pte from caller\") is \n        ///necessary in order to execute the correct\n        ///threadedFunc() even when the derived class\n        ///wants to spawn a thread.\n        int spawn(void *parentObj = NULL);\n        void terminate();\n\n    protected:\n        pthread_mutex_t mtx;\n        bool exitThread;\n\n    private:\n        /* add your private declarations */\n        int join();\n\n        pthread_t threadId;\n};\n\n#endif /* CPPTHREAD_HPP */ \n</code></pre>\n\n<p>cppthread.cpp</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include \"cppthread.hpp\"\n\nvoid* threadCallback(void* obj);\n\ncppthread::cppthread()\n{\n    exitThread = false;\n    pthread_mutex_init(&amp;mtx, NULL);\n\n}\n\n\ncppthread::~cppthread()\n{\n    if (!exitThread)\n        terminate();\n    pthread_mutex_destroy(&amp;mtx);\n}\n\nvoid cppthread::threadedFunc()\n{\n    while ( !exitThread )\n    {\n        printf(\"Hello from cppthread::threadfunc. This should not be run once derived and redefined.\\n\");\n    }\n    if (exitThread)\n    {\n        printf(\"graceful exit from cppthread::threadfunc. This should not be run once derived and redefined.\\n\");\n    }\n    pthread_exit((void*)0);\n}\n\nint cppthread::spawn(void* parentObj)\n{\n    int ret;\n    printf(\"parentObj = %p\\n\", parentObj);\n    if (parentObj == NULL)\n    {\n        ret = pthread_create(&amp;threadId, 0, &amp;threadCallback, this);\n        printf(\"cppthread_create with \\\"this\\\" \\n\");\n    }\n    else\n    {\n        ret = pthread_create(&amp;threadId, 0, &amp;threadCallback, parentObj);\n        printf(\"cppthread_create with parentObj\\n\");\n    }\n\n    if (ret != 0)\n    {\n        printf(\"cppthread_create error\\n\");\n        exit(EXIT_FAILURE);\n    }\n    else\n    {\n        //printf(\"cppthread::threadID= %lu\\n\",threadId);\n    }\n    return ret;\n}\n\nvoid cppthread::terminate()\n{\n    exitThread = true;\n    join();\n}\n\nint cppthread::join()\n{\n    int status , ret;\n    //printf(\"cppthread::join_threadID= %lu\\n\",threadId);\n    ret = pthread_join(threadId,(void**)&amp;status);\n    if (ret != 0)\n    {\n        printf(\"cppthread_join error: \");\n        switch (ret)\n        {\n            case EDEADLK: printf(\"deadlock\\n\"); break;\n            case EINVAL: printf(\"thread not joinable\\n\"); break;\n            case ESRCH: printf(\"threadID not found\\n\"); break;\n            default : printf(\"unknown error\\n\"); break;\n        }\n    }\n    return status;\n}\n\n//----------------------------------------------------------------------\nvoid* threadCallback(void* obj)\n{\n    static_cast&lt;cppthread*&gt;(obj)-&gt;threadedFunc();\n    return(0);\n} // callback\n</code></pre>\n\n<p>threadedwrite.hpp</p>\n\n<pre><code>#ifndef THREADEDWRITE_HPP\n#define THREADEDWRITE_HPP\n\n#include \"cppthread.hpp\"\n\nusing namespace std;\n\nclass ThreadedWrite : public cppthread\n{\n    public:\n        ThreadedWrite(ThreadedWrite* mySelf);\n        virtual ~ThreadedWrite();\n\n        void threadedFunc();\n        void rrdupdate_thread();\n\n        ///inherited significant members: from cppthread\n        ///   int spawn();\n        ///   void terminate();\n        ///protected\n        ///   pthread_mutex_t mtx;\n        ///   bool exitThread;\n\n    private:\n        ThreadedWrite* instancePtr;\n};\n\n#endif /* THREADEDWRITE_HPP */ \n</code></pre>\n\n<p>threadedwrite.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"threadedwrite.hpp\"\n\n\nThreadedWrite::ThreadedWrite(ThreadedWrite* mySelf):instancePtr(mySelf)\n{\n    cout &lt;&lt; \"instancePtr = \" &lt;&lt; instancePtr &lt;&lt; endl;\n}\n\nThreadedWrite::~ThreadedWrite()\n{\n\n}\n\nvoid ThreadedWrite::threadedFunc()\n{\n    if ( !exitThread )\n    {\n        cout &lt;&lt; \"this is the ThreadedWrite::threadedFunc() running!\" &lt;&lt; endl;\n    }\n    else\n    {\n        cout &lt;&lt; \"ThreadedWrite::threadedFunc must exist now\" &lt;&lt; endl;\n    }\n\n    pthread_exit((void*)0);\n}\n\nvoid ThreadedWrite::rrdupdate_thread()\n{\n    cout &lt;&lt; \"about to spawn\" &lt;&lt; endl;\n    spawn(instancePtr);\n}\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n#include \"threadedwrite.hpp\"\n\nusing namespace std;\n\n//-------main body------------------------------------------------------\nint main(int argc, char* argv[])\n{\n    ThreadedWrite  thrrdupd(&amp;thrrdupd);\n    cout &lt;&lt; \"hello from main 1 \" &lt;&lt; &amp;thrrdupd &lt;&lt; endl;\n    thrrdupd.rrdupdate_thread();\n    cout &lt;&lt; \"hello from main 2 \" &lt;&lt; &amp;thrrdupd &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>The above produces the output (for me):</p>\n\n<pre><code>instancePtr = 0x7fff39d17860\nhello from main 1 0x7fff39d17860\nabout to spawn\nparentObj = 0x7fff39d17860\ncppthread_create with parentObj\nhello from main 2 0x7fff39d17860\ngraceful exit from cppthread::threadfunc. This should not be run once derived and redefined.\n</code></pre>\n\n<p>So executing the above <code>cppthread::spawn()</code> call from within the derived class \"ThreadedWrite\" , actually provides a \"this\" pointer to <code>callback()</code> function that points to <code>cppthread::ThreadedFunc()</code>, instead of <code>ThreadedWrite::ThreadedFunc()</code>. </p>\n\n<p>You can also see that I tried (through the \"instancePtr\" infrastructure) to pass a pointer to the instance of \"ThreadedWrite\" back to the callback function. But this failed too.</p>\n\n<p>Also, preferably I would like to keep cppthread class as generic as possible in order to be able to use it in may cases. </p>\n\n<p>Mind you, if I remove \"spawn(instancePtr)\" from threadedwrite.cpp , and call the spawn from main.cpp like this</p>\n\n<pre><code>int main(int argc, char* argv[])\n{\n        ThreadedWrite  thrrdupd(&amp;thrrdupd);\n        cout &lt;&lt; \"hello from main 1 \" &lt;&lt; &amp;thrrdupd &lt;&lt; endl;\n        thrrdupd.rrdupdate_thread();\n        thrrdupd.spawn();\n        cout &lt;&lt; \"hello from main 2 \" &lt;&lt; &amp;thrrdupd &lt;&lt; endl;\n        return 0;\n}\n</code></pre>\n\n<p>the output that I get Is the expected (and wanted) one and it looks like this:</p>\n\n<pre><code>instancePtr = 0x7ffd24b04ed0\nhello from main 1 0x7ffd24b04ed0\nabout to spawn\nparentObj = (nil)\ncppthread_create with \"this\" \nhello from main 2 0x7ffd24b04ed0\nthis is the ThreadedWrite::threadedFunc() running!\n</code></pre>\n"}, {"tags": ["c++", "file-io", "struct", "fread"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 6, "creation_date": 1450889390, "post_id": 34440185, "comment_id": 56621582, "body": "<code>tmp</code> goes out of scope when the function ends."}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1450889893, "post_id": 34440185, "comment_id": 56621900, "body": "You need to post a complete example of your problem.  Without that, any solution is really just a guess."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1450892386, "post_id": 34440185, "comment_id": 56623305, "body": "What is the point of reading to <code>tmp</code> and then doing nothing with it?  This function does little more than open and close a file for no apparent reason.  On its own I doubt that it is the cause of your problem."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 1, "creation_date": 1450892794, "post_id": 34440185, "comment_id": 56623526, "body": "You appear to have simplified your actual code when asking the question.  This is good, but I fear you have simplified the problem away.  Does this actual code show the problem?  Please include the code of main"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1450895023, "post_id": 34440185, "comment_id": 56624647, "body": "Not related to your problem, but I would nonetheless advise <code>FILE *fp = fopen(&quot;stu_dat&quot;, &quot;r&quot;) ;     if( fp == NULL )</code> and also <code>sizeof(tmp)</code> rather than <code>sizeof(struct student)</code>.  That not the only &quot;style&quot; comment I might make, but that&#39;s enough for starters."}, {"owner": {"reputation": 139, "user_id": 5555077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3u3jx.png?s=128&g=1", "display_name": "Kun Wu", "link": "https://stackoverflow.com/users/5555077/kun-wu"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1450936241, "post_id": 34440185, "comment_id": 56637739, "body": "@Martin Bonner Thank you. I&#39;ve added it to my post. And I&#39;ve found the problem occurs mainly when &#39;fread()&#39; operates on &#39;string&#39;. Still don&#39;t know what implement of &#39;fread()&#39; and &#39;string&#39; causes this problem."}], "answers": [{"tags": [], "owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "is_accepted": true, "score": 0, "last_activity_date": 1450945231, "creation_date": 1450945231, "answer_id": 34449538, "question_id": 34440185, "link": "https://stackoverflow.com/questions/34440185/access-violation-when-function-returns-after-fread-applyed-to-a-local-struct-v/34449538#34449538", "title": "Access Violation when function returns after fread() applyed to a local struct variable", "body": "<p>You can't <code>fread</code> into a <code>std::string</code> like <code>student.name</code> (or fwrite from it).  The crash occurred because you had a corrupted string and when the compiler attempted to copy it into the array it all went horribly wrong.  Reading straight into the array wouldn't have helped because presumably you were planning to access the members of the array at some point - at which point everything would have died again.</p>\n\n<p>You will need to read in the length of the string, then read the characters of the string in.</p>\n"}], "owner": {"reputation": 139, "user_id": 5555077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3u3jx.png?s=128&g=1", "display_name": "Kun Wu", "link": "https://stackoverflow.com/users/5555077/kun-wu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 34449538, "answer_count": 1, "score": -1, "last_activity_date": 1450945231, "creation_date": 1450889037, "last_edit_date": 1450935042, "question_id": 34440185, "link": "https://stackoverflow.com/questions/34440185/access-violation-when-function-returns-after-fread-applyed-to-a-local-struct-v", "title": "Access Violation when function returns after fread() applyed to a local struct variable", "body": "<p>This is a part from my program.</p>\n\n<pre><code>void LookUpStuInfo(student stu[], int size, int ID) \n{   \n    FILE *fp; \n    if((fp = fopen(\"stu_dat\", \"r\")) == NULL)\n    { \n        cout &lt;&lt; \"cannot open file\" &lt;&lt; endl;\n        return; \n    } \n\n    struct student tmp;\n    fread(&amp;tmp, sizeof(struct student), 1, fp);\n    fclose(fp);\n}\n</code></pre>\n\n<p>stu_dat(created by <code>fwrite()</code>) stores information of several <code>struct student</code>. When this function ends and returns to <code>main()</code> function, access violation occurs.</p>\n\n<p>However if I don't use a local struct variable in this case, instead using a student <code>stu[]</code> and apply <code>fread()</code> to <code>&amp;stu[0]</code>, it works fine. So what's wrong?</p>\n\n<p>Well, the code above is enough to produce an access violation. I've tested to delete all the other code in this LookUpStuInfo() until only basic read and close is left, still won't work.</p>\n\n<p>So the following is the complete code of this project.It may help if you want to know details about <code>main()</code> and <code>struct student</code>.</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;string&gt;\n#include \"stdio.h\"\n#define num 3\nusing namespace std;\nstruct student\n{\n    int ID;\n    string name;\n    string sex;\n    string birthday;\n    float score;\n};\nvoid SortStuArr(student stu[], int size)\n{\n    student tmp;\n    for (int i = 0; i &lt; size; i++)\n        for (int j = (i + 1); j &lt; size; j++)\n        {\n            if (stu[i].score &lt; stu[j].score)\n            {\n                tmp = stu[i];\n                stu[i] = stu[j];\n                stu[j] = tmp;\n            }\n        }\n    cout &lt;&lt; \"ID\" &lt;&lt; \"    \" &lt;&lt; \"Score\" &lt;&lt; endl;\n    for (int i = 0; i &lt; size; i++)\n        cout &lt;&lt; stu[i].ID &lt;&lt; \"\\t\" &lt;&lt; stu[i].score &lt;&lt; endl;\n}\nfloat GetAvgScr(student stu[], int size)\n{\n    float avg=0;\n    for (int i = 0; i &lt; size; i++)\n        avg += (stu[i].score);\n    avg = avg / size;\n    return avg;\n}\nvoid LookUpStuInfo(const char* locat, int size, int ID)\n{\n    FILE *fp;\n    if((fp=fopen(\"stu_dat\",\"r\"))==NULL)\n    {\n        cout &lt;&lt; \"cannot open file\" &lt;&lt; endl;\n        return;\n    }\n    struct student tmp;\n    for (int i = 0; i &lt; size; i++)\n    {\n        fread(&amp;tmp, sizeof(struct student), 1, fp);\n        if (tmp.ID == ID)\n        {\n            cout &lt;&lt; tmp.name &lt;&lt; tmp.ID &lt;&lt; tmp.sex &lt;&lt; tmp.birthday &lt;&lt; tmp.score &lt;&lt; endl;\n            fclose(fp);\n        }\n    }\n    cout &lt;&lt; \"Not Found!\" &lt;&lt; endl;\n    fclose(fp);\n}\nvoid WritetoFile(student stu[], int size)\n{\n    FILE *fp;\n    if((fp=fopen(\"stu_dat\",\"w+\"))==NULL)\n    {\n        cout &lt;&lt; \"cannot open file\" &lt;&lt; endl;\n        return;\n    }\n    for (int i = 0; i &lt; size; i++)\n        fwrite(&amp;stu[i], sizeof(struct student), 1, fp);\n    fclose(fp);\n}\n\n\n\nint main()\n{\n    student stu[num];\n    for (int i = 0; i &lt; num; i++)\n    {\n        cin &gt;&gt; stu[i].name &gt;&gt; stu[i].ID &gt;&gt; stu[i].sex &gt;&gt; stu[i].birthday &gt;&gt; stu[i].score;\n    }\n    cout &lt;&lt; GetAvgScr(stu, num) &lt;&lt; endl;\n    WritetoFile(stu, num);\n\n        LookUpStuInfo(\"stu_dat\", num, 1000);\n    return 0;\n}\n</code></pre>\n\n<p>Well I've tested to remove all <code>string</code> in my program and it works fine. It seems <code>fread()</code> will go wrong in a function with the operation on <code>string</code>.</p>\n"}, {"tags": ["c++", "pointers", "reference", "smart-pointers"], "comments": [{"owner": {"reputation": 5455, "user_id": 4115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2688a9684db617a20f9da3959e5890d7?s=128&d=identicon&r=PG&f=1", "display_name": "Danh", "link": "https://stackoverflow.com/users/4115625/danh"}, "edited": false, "score": 2, "creation_date": 1450889000, "post_id": 34440157, "comment_id": 56621343, "body": "<code>std::weak_ptr</code> don&#39;t own the ownership"}, {"owner": {"reputation": 8891, "user_id": 4505712, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h9W5W.png?s=128&g=1", "display_name": "James Adkison", "link": "https://stackoverflow.com/users/4505712/james-adkison"}, "reply_to_user": {"reputation": 5455, "user_id": 4115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2688a9684db617a20f9da3959e5890d7?s=128&d=identicon&r=PG&f=1", "display_name": "Danh", "link": "https://stackoverflow.com/users/4115625/danh"}, "edited": false, "score": 0, "creation_date": 1450889920, "post_id": 34440157, "comment_id": 56621916, "body": "@Danh Doesn&#39;t <code>std::weak_ptr</code> enforce a requirement to use <code>std::shared_ptr</code> for the same resource?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 8891, "user_id": 4505712, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h9W5W.png?s=128&g=1", "display_name": "James Adkison", "link": "https://stackoverflow.com/users/4505712/james-adkison"}, "edited": false, "score": 1, "creation_date": 1450890154, "post_id": 34440157, "comment_id": 56622069, "body": "@JamesAdkison, it does and this is why I do not advocate it for this. See my answer."}, {"owner": {"reputation": 5455, "user_id": 4115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2688a9684db617a20f9da3959e5890d7?s=128&d=identicon&r=PG&f=1", "display_name": "Danh", "link": "https://stackoverflow.com/users/4115625/danh"}, "edited": false, "score": 0, "creation_date": 1450890525, "post_id": 34440157, "comment_id": 56622268, "body": "Yes, it does. However, it should be good in some case to use weak_ptr for checking its state is valid or not"}, {"owner": {"reputation": 5455, "user_id": 4115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2688a9684db617a20f9da3959e5890d7?s=128&d=identicon&r=PG&f=1", "display_name": "Danh", "link": "https://stackoverflow.com/users/4115625/danh"}, "edited": false, "score": 0, "creation_date": 1450891323, "post_id": 34440157, "comment_id": 56622707, "body": "And I also recommend the <a href=\"http://stackoverflow.com/a/34440222/4505712\">answer</a> of SergeyA"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1450892066, "post_id": 34440157, "comment_id": 56623108, "body": "See also <a href=\"http://en.cppreference.com/w/cpp/experimental/observer_ptr\" rel=\"nofollow noreferrer\">observer_ptr</a>."}], "answers": [{"comments": [{"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 2, "creation_date": 1450889104, "post_id": 34440196, "comment_id": 56621415, "body": "...but does temporarily own the object while it&#39;s actually examining it."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1450890197, "post_id": 34440196, "comment_id": 56622091, "body": "What&#39;s even worse, it requires a shared_ptr to exist somewhere."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 1, "last_activity_date": 1450889243, "last_edit_date": 1450889243, "creation_date": 1450889056, "answer_id": 34440196, "question_id": 34440157, "link": "https://stackoverflow.com/questions/34440157/how-to-express-in-modern-c-the-referes-to-relationship-without-expressing-owne/34440196#34440196", "title": "How to express in Modern C++ the referes-to relationship without expressing ownership?", "body": "<p>This is what a <a href=\"http://en.cppreference.com/w/cpp/memory/weak_ptr\" rel=\"nofollow\"><code>std::weak_ptr</code></a> is for.  It expresses that it refers to something but it does not own it and that thing may go away before the object referring to it goes away.</p>\n\n<p>If you decide you need the referred to object you can use <a href=\"http://en.cppreference.com/w/cpp/memory/weak_ptr/lock\" rel=\"nofollow\"><code>lock()</code></a> which will return a <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr\" rel=\"nofollow\">shared_ptr</a> to the object and extend the lifetime of it until the <code>shared_ptr</code> goes out of scope.</p>\n"}, {"comments": [{"owner": {"reputation": 520, "user_id": 243879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41e6aedad6381c9d35a9f5f0b8fe1915?s=128&d=identicon&r=PG", "display_name": "MartinP", "link": "https://stackoverflow.com/users/243879/martinp"}, "edited": false, "score": 0, "creation_date": 1515586569, "post_id": 34440222, "comment_id": 83354094, "body": "But a raw pointer looks like it might be a bad smell. The reader cant distinguish bad/lazy/leaky code from the intention of an assignable/nullabale/non-owning reference.  I wish i could find in GSL non_owning&lt;T&gt;."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 13, "last_activity_date": 1450889750, "last_edit_date": 1450889750, "creation_date": 1450889182, "answer_id": 34440222, "question_id": 34440157, "link": "https://stackoverflow.com/questions/34440157/how-to-express-in-modern-c-the-referes-to-relationship-without-expressing-owne/34440222#34440222", "title": "How to express in Modern C++ the referes-to relationship without expressing ownership?", "body": "<p>There is no such thing as <em>'one should not use raw pointers'</em>. It is <em>'one should not use <strong>owning</strong> raw pointers'</em>. There is nothing wrong with having a raw pointer for refers-to idiom. Smart pointers are just an overkill for this. Especially <code>std::weak_ptr</code> :)</p>\n"}, {"comments": [{"owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "edited": false, "score": 0, "creation_date": 1450891100, "post_id": 34440616, "comment_id": 56622589, "body": "But we already have <a href=\"http://en.cppreference.com/w/cpp/utility/functional/reference_wrapper\" rel=\"nofollow noreferrer\"><code>std::reference_wrapper</code></a>. Or is it too heavy?"}, {"owner": {"reputation": 8891, "user_id": 4505712, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h9W5W.png?s=128&g=1", "display_name": "James Adkison", "link": "https://stackoverflow.com/users/4505712/james-adkison"}, "reply_to_user": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "edited": false, "score": 1, "creation_date": 1450891214, "post_id": 34440616, "comment_id": 56622638, "body": "@LogicStuff I cannot answer. I&#39;m just not fully aware of all the new <code>C++</code> stuff so perhaps I&#39;ve unintentionally reinvented the wheel. Thanks, I&#39;ll take a look at <code>std::reference_wrapper</code>."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1450892124, "post_id": 34440616, "comment_id": 56623147, "body": "There&#39;s also <a href=\"http://en.cppreference.com/w/cpp/experimental/observer_ptr\" rel=\"nofollow noreferrer\"><code>observer_ptr</code></a>, although I don&#39;t know if it will make it into the standard library."}], "tags": [], "owner": {"reputation": 8891, "user_id": 4505712, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h9W5W.png?s=128&g=1", "display_name": "James Adkison", "link": "https://stackoverflow.com/users/4505712/james-adkison"}, "is_accepted": false, "score": 1, "last_activity_date": 1450891005, "last_edit_date": 1495542705, "creation_date": 1450890684, "answer_id": 34440616, "question_id": 34440157, "link": "https://stackoverflow.com/questions/34440157/how-to-express-in-modern-c-the-referes-to-relationship-without-expressing-owne/34440616#34440616", "title": "How to express in Modern C++ the referes-to relationship without expressing ownership?", "body": "<p>I think the <a href=\"https://stackoverflow.com/a/34440222/4505712\">answer</a> provided by <a href=\"https://stackoverflow.com/users/5245033/sergeya\">@SergeyA</a> is great and voted for it myself.</p>\n\n<p>However, if you truly don't want to see raw pointers in the code then you can always create a wrapper class that is used to communicate the desired semantics.</p>\n\n<p>For example:</p>\n\n<pre><code>/**\n * A class that refers to an existing object instance. This class does not own\n * the existing object instance and the lifetime of the existing object instance\n * must be greater than the lifetime of instantiations of this class.\n */\ntemplate&lt;typename T&gt;\nclass Handle\n{\npublic:\n    Handle(T&amp; object) : mObject(&amp;object) {}\n\n    // ... other functions necessary to use this object ...\n\nprivate:\n    T* mObject;\n};\n</code></pre>\n"}], "owner": {"reputation": 4621, "user_id": 3074280, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8pIgB.jpg?s=128&g=1", "display_name": "nyarlathotep108", "link": "https://stackoverflow.com/users/3074280/nyarlathotep108"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 34440222, "answer_count": 3, "score": 1, "last_activity_date": 1450891005, "creation_date": 1450888929, "question_id": 34440157, "link": "https://stackoverflow.com/questions/34440157/how-to-express-in-modern-c-the-referes-to-relationship-without-expressing-owne", "title": "How to express in Modern C++ the referes-to relationship without expressing ownership?", "body": "<p>Starting from the \"one should not use raw pointers\" idiom point of view, I was looking at smart pointers to find which one best fits the refers-to relationship.</p>\n\n<p>By refers-to relationship, I mean the same as this code:</p>\n\n<pre><code>class A\n{\npublic:\n\n    A(B &amp; b) : \n        m_refB( b ) \n    {   }\n\nprivate:\n\n    B &amp; m_refB;    // A refers to B\n};\n</code></pre>\n\n<p>But without all the drawbacks of using references (cannot be later binded, cannot be reassigned, A can no longer be default constructible etc).</p>\n\n<p>Every smart pointer however, in its own semantic is expressing an ownership concept. They are even named around this ownership concept (unique pointer when the ownership is unique to only one object, shared pointer when the ownership is shared amongst more objects etc).</p>\n\n<p>I would like to express that A is referring to B, but A does not own B.\nCan <code>std::reference_wrapper&lt; B &gt;</code> do the job, or that would be a wrong usage of it?</p>\n"}, {"tags": ["android", "c++", "in-app-purchase", "google-play-services", "cocos2d-x"], "comments": [{"owner": {"reputation": 1416, "user_id": 5653411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33328e4cbdd36cc8273e9875fd3085e?s=128&d=identicon&r=PG&f=1", "display_name": "gerardnimo", "link": "https://stackoverflow.com/users/5653411/gerardnimo"}, "edited": false, "score": 0, "creation_date": 1451218140, "post_id": 34440117, "comment_id": 56702075, "body": "Could you provide your <code>build.gradle</code> file and<code>AndroidManifest.xml</code> file?"}, {"owner": {"reputation": 452, "user_id": 4342776, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/945daf9d14631631575f80f72d6fbc9c?s=128&d=identicon&r=PG&f=1", "display_name": "v_johan", "link": "https://stackoverflow.com/users/4342776/v-johan"}, "reply_to_user": {"reputation": 1416, "user_id": 5653411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33328e4cbdd36cc8273e9875fd3085e?s=128&d=identicon&r=PG&f=1", "display_name": "gerardnimo", "link": "https://stackoverflow.com/users/5653411/gerardnimo"}, "edited": false, "score": 0, "creation_date": 1451296777, "post_id": 34440117, "comment_id": 56724264, "body": "@gerardnimo I&#39;m using proj.android when building. Could that be a problem?"}], "owner": {"reputation": 452, "user_id": 4342776, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/945daf9d14631631575f80f72d6fbc9c?s=128&d=identicon&r=PG&f=1", "display_name": "v_johan", "link": "https://stackoverflow.com/users/4342776/v-johan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 202, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453987669, "creation_date": 1450888771, "last_edit_date": 1450892978, "question_id": 34440117, "link": "https://stackoverflow.com/questions/34440117/missing-resources-when-building-cocos2d-x-game-with-sdkboxs-iap", "title": "Missing resources when building cocos2d-x game with sdkbox&#39;s IAP", "body": "<p>I am creating a game using cocos2d-x, it requires IAP so I imported sdkbox's IAP. However, when building it for Android I get the following error:</p>\n\n<pre><code>/home/jf/Android/Sdk/extras/google/google_play_services/libproject/google-play-services_lib/res/values-v21/appinvite_styles.xml:5: error: Error retrieving parent for item: No resource found that matches the given name '@android:style/Theme.Material.Light.DialogWhenLarge.NoActionBar\nBUILD FAILED\n/home/jf/Android/Sdk/tools/ant/build.xml:597: The following error occurred while executing this line:\n/home/jf/Android/Sdk/tools/ant/build.xml:649: The following error occurred while executing this line:\n/home/jf/Android/Sdk/tools/ant/build.xml:694: null returned: 1\n</code></pre>\n\n<p>I tried changing SDK version in my AndroidManifest to 21, 19, 9 and it never worked (Yes I have downloaded them in Android Studio's SDK manager).\n<br>I tried creating a whole new project <code>cocos new \"Name\" -l cpp -p com.Company.Name</code>, and doing sdkbox import and compiling without changing anything else.</p>\n\n<p>I don't know what else to try, I'm completely lost.<br>\nThank You!</p>\n\n<p>EDIT: This happens when it\ns building the .apk</p>\n"}, {"tags": ["c++", "opencv"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5678856, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/673dc276b02d83cc2faf293e151e2019?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/5678856/dylan"}, "edited": false, "score": 0, "creation_date": 1450889674, "post_id": 34440212, "comment_id": 56621764, "body": "When you draw a rectangle ( rectangle(src, Point(x, y), Point(x + h, y + h), Scalar(0, 255, 0), 1, 8); )"}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "reply_to_user": {"reputation": 33, "user_id": 5678856, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/673dc276b02d83cc2faf293e151e2019?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/5678856/dylan"}, "edited": false, "score": 0, "creation_date": 1450889779, "post_id": 34440212, "comment_id": 56621829, "body": "Yes, that&#39;s the same as using constructor: <code>Rect region(Point(x,y), Point(x+h, y+h));</code>. You can also draw like: <code>rectangle(src, Rect(x,y,h,h), ...</code>"}], "tags": [], "owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "is_accepted": true, "score": 2, "last_activity_date": 1450889880, "last_edit_date": 1450889880, "creation_date": 1450889120, "answer_id": 34440212, "question_id": 34440066, "link": "https://stackoverflow.com/questions/34440066/opencv-assertion-failed-with-roi/34440212#34440212", "title": "OpenCV Assertion failed with ROI", "body": "<p>The error means that your rectangle <code>region</code> goes out of the bounds of the image <code>src</code>.</p>\n\n<p>In fact you're constructing the rectangle with wrong values, it should be:</p>\n\n<pre><code>Rect region(x, y, h, h);\n</code></pre>\n\n<p>since 3rd and 4th arguments are width and height, not the coordinates of the bottom right point.</p>\n\n<p>Or you can use the constructor that accepts top-left and bottom-right points:</p>\n\n<pre><code>Rect region(Point(x,y), Point(x+h, y+h));\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5678856, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/673dc276b02d83cc2faf293e151e2019?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/5678856/dylan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 34440212, "answer_count": 1, "score": 2, "last_activity_date": 1450889880, "creation_date": 1450888560, "last_edit_date": 1592644375, "question_id": 34440066, "link": "https://stackoverflow.com/questions/34440066/opencv-assertion-failed-with-roi", "title": "OpenCV Assertion failed with ROI", "body": "<p>I'm trying to get every circle in a new window, however I get this error;\n<a href=\"https://i.stack.imgur.com/Qxd0t.jpg\" rel=\"nofollow noreferrer\">the error</a></p>\n<p>I don't know why that happends. The Rect object gives normal values:\n<a href=\"https://i.stack.imgur.com/oBwGs.png\" rel=\"nofollow noreferrer\">rect values</a></p>\n<p>Code:</p>\n<pre><code>void scanCircle(int x, int y, int h, Mat src, int rad) {\ntry {\n    Rect region = Rect(x, y, x + h, y + h);\n    Mat roi = src(region).clone();\n}\ncatch (...) {\n    cout &lt;&lt; &quot;Error&quot;;\n}\n</code></pre>\n<p>}</p>\n<p>With Google I found this one: <a href=\"https://stackoverflow.com/questions/21248611/opencv-assertion-failed\">OpenCv assertion failed</a></p>\n<p>However I don't see whats wrong.</p>\n"}, {"tags": ["java", "android", "c++", "java-native-interface", "crypto++"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1450916639, "post_id": 34439990, "comment_id": 56633389, "body": "This is kind of coming to a head for us... I reached out to David Hook from Bouncy Castle and hope to have some good Java/Crypto++ interop examples for users soon."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1450916775, "post_id": 34439990, "comment_id": 56633425, "body": "In the meantime... <i>&quot;// TODO: Figure out how big the public and private keys are...&quot;</i> - take a look at <a href=\"https://www.cryptopp.com/wiki/Elliptic_Curve_Diffie-Hellman#Ephemeral_Key_as_.28x.2Cy.29_Coordinate\" rel=\"nofollow noreferrer\">Ephemeral Key as (x,y) Coordinate</a>. The Public/Private key exchanged by users and the ephemeral keys used in the exchange are similar, but different formats. Both are ASN.1 encoded. The former (the static keys) are a subject {public|private} key with an OID. The latter (the ephemeral keys) are just the inner {public|private}. Use an ASN.1 dumper, like Gutmann&#39;s <code>dumpasn1</code>, to view them."}, {"owner": {"reputation": 161, "user_id": 5655109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd7d7c374d0587bf0b16a813c4cb7c0f?s=128&d=identicon&r=PG&f=1", "display_name": "T. Colligan", "link": "https://stackoverflow.com/users/5655109/t-colligan"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1451851714, "post_id": 34439990, "comment_id": 56907148, "body": "Sorry that is has taken me so long to post a reply. Honestly I am pretty new to all of this and I have no clue how to use that ASN.1 dumper.  What I can tell based on my own Java code right now is that my Public Keys are 33 bytes and the private keys are 32 bytes. Here is an example in Hexadecimal:  Alice Key Pair  Public Key: 03E81B8252352EBE8EF941A8D01260066D2351D90D32C2005C4DF7F1DDF7&zwnj;&#8203;EC8C74   Private Key: 560ECB9D777359C5FF6B8E5FBA21D57AA01C9DD302FCFD40BF8672CE893C&zwnj;&#8203;898C"}], "answers": [{"comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1453148090, "post_id": 34583206, "comment_id": 57465837, "body": "Good job. I&#39;m going to start citing this until I can get a decent example put up on the web."}], "tags": [], "owner": {"reputation": 161, "user_id": 5655109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd7d7c374d0587bf0b16a813c4cb7c0f?s=128&d=identicon&r=PG&f=1", "display_name": "T. Colligan", "link": "https://stackoverflow.com/users/5655109/t-colligan"}, "is_accepted": true, "score": 1, "last_activity_date": 1451866930, "creation_date": 1451866930, "answer_id": 34583206, "question_id": 34439990, "link": "https://stackoverflow.com/questions/34439990/ecdh-shared-secret-does-not-match-between-crypto-and-android/34583206#34583206", "title": "ECDH Shared Secret does not match between Crypto++ and Android", "body": "<p>I was able to figure it out with some help from a friend. The issue was the retrieveSharedSecret method and the fact that it was directly returning a byte buffer, which was pointing to a memory address that was in scope during the C++ method call, but then out of scope as soon it got back out into the Java code. So I was essentially getting garbage memory as my shared secret.</p>\n\n<p>I tweaked the code so that the method returns a custom SharedSecret Java object, just like the keyGeneration method does. Doing that allows all the info I need to be copied over properly I and don't have to worry about this scope issue.</p>\n\n<p>Revised method code is below. I will also update the <a href=\"https://github.com/tcolligan-ap/ECDHTest\" rel=\"nofollow\">Github</a> project so that it can exist as a working example of how to use Android Studio with the NDK (non-experimental) and CryptoPP.</p>\n\n<pre><code>// Use the same ECDH Setup that is specified in the generateKeyPair method above\nOID CURVE = secp256r1();\nDL_GroupParameters_EC&lt;ECP&gt; params(CURVE);\nECDH&lt;ECP&gt;::Domain dhAgreement(params);\ndhAgreement.AccessGroupParameters().SetPointCompression(true);\n\n// Figure out how big the public and private keys are\n// Public Key: This belongs to the other user\n// Private Key: This is out personal private key\nint pubLen = (int)(*env).GetArrayLength(publicKeyArray);\nint privLen = (int)(*env).GetArrayLength(privateKeyArray);\n\n// Convert the keys from a jbyteArray to a SecByteBlock so that they can be passed\n// into the CryptoPP Library functions.\nunsigned char* pubData = new unsigned char[pubLen];\n(*env).GetByteArrayRegion(publicKeyArray, 0, pubLen, reinterpret_cast&lt;jbyte*&gt;(pubData));\n\nunsigned char* privData = new unsigned char[privLen];\n(*env).GetByteArrayRegion(privateKeyArray, 0, privLen, reinterpret_cast&lt;jbyte*&gt;(privData));\n\nSecByteBlock pubB(pubData, pubLen) , privA(privData, privLen);\n\n// Now extract shared secret between the two keys\nSecByteBlock sharedSecretByteBlock(dhAgreement.AgreedValueLength());\nALOG(\"Shared Agreed Value Length: %d\", dhAgreement.AgreedValueLength());\n\nbool didWork = dhAgreement.Agree(sharedSecretByteBlock, privA, pubB);\n\nALOG(\"Key Agreement: %s\", didWork ? \"It Worked\" : \"It Failed\");\nALOG(\"Shared Secret Byte Size: %d\", sharedSecretByteBlock.SizeInBytes());\n\n// Return the shared secret as a Java ByteBuffer\njobject sharedSecretByteBuffer = (*env).NewDirectByteBuffer(sharedSecretByteBlock.BytePtr(), sharedSecretByteBlock.SizeInBytes());\n\n// Return the ECDH Key Pair back as a Java ECDHKeyPair object\njclass keyPairClass = (*env).FindClass(\"com/tcolligan/ecdhtest/SharedSecret\");\njmethodID midConstructor = (*env).GetMethodID(keyPairClass, \"&lt;init&gt;\", \"(Ljava/nio/ByteBuffer;)V\");\njobject sharedSecretObject = (*env).NewObject(keyPairClass, midConstructor, sharedSecretByteBuffer);\n\nreturn sharedSecretObject;\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 5655109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd7d7c374d0587bf0b16a813c4cb7c0f?s=128&d=identicon&r=PG&f=1", "display_name": "T. Colligan", "link": "https://stackoverflow.com/users/5655109/t-colligan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 875, "favorite_count": 1, "accepted_answer_id": 34583206, "answer_count": 1, "score": 2, "last_activity_date": 1451866930, "creation_date": 1450888237, "last_edit_date": 1451852066, "question_id": 34439990, "link": "https://stackoverflow.com/questions/34439990/ecdh-shared-secret-does-not-match-between-crypto-and-android", "title": "ECDH Shared Secret does not match between Crypto++ and Android", "body": "<p>So I am writing an ECDH implementation on Android using Java and the Crypto++ 5.6.3 Library.</p>\n\n<p>I wrote some C++ JNI code to call Crypto++ functions, I have one function to generate the public/private key pair, and another function to extract the shared secret. There seems to be an issue however with the shared secrets not matching.</p>\n\n<p>Th situation is as follows. Alice and Bob both generate their own Public and Private Key Pairs. They exchange public keys successfully.</p>\n\n<p>To get the shared secret Alice does the following :</p>\n\n<pre><code>byte[] sharedSecret = getSharedSecret(bobPublicKey, alicePrivateKey);\n</code></pre>\n\n<p>Bob does a similar operation :</p>\n\n<pre><code>byte[] sharedSecret = getSharedSecret(alicePublicKey, bobPrivateKey);\n</code></pre>\n\n<p>The issue I am seeing is, the two shared secrets do not match each other. Is there some misunderstanding on my part on how this is supposed to work?</p>\n\n<p>I am assuming there is just a specific implementation issue on my side relating to the shared secret but I am not sure. The C++ JNI implementation is below. The retrieveSharedSecret function always outputs \"It Worked\". Any ideas on what I am doing wrong here?</p>\n\n<pre><code>JNIEXPORT jobject JNICALL Java_com_myproject_test_cryptopp_ECDHLibrary_generateKeyPair\n        (JNIEnv *env, jclass)\n{\n    // Generate a public private key pair using ECDH (Elliptic Curve Diffie Hellman)\n    OID CURVE = secp256r1(); // the key is 256 bits (32 bytes) long\n    AutoSeededRandomPool rng;\n\n    // Because we are using point compression\n    // Private Key 32 bytes\n    // Public Key 33 bytes\n    // If compression was not used the public key would be 65 bytes long\n    ECDH &lt; ECP &gt;::Domain dhA( CURVE );\n    dhA.AccessGroupParameters().SetPointCompression(true);\n\n    SecByteBlock privA(dhA.PrivateKeyLength()), pubA(dhA.PublicKeyLength());\n    dhA.GenerateKeyPair(rng, privA, pubA);\n\n    jobject publicKeyByteBuffer = (*env).NewDirectByteBuffer(pubA.BytePtr(), pubA.SizeInBytes());\n    jobject privateKeyByteBuffer = (*env).NewDirectByteBuffer(privA.BytePtr(), privA.SizeInBytes());\n\n    // Return the ECDH Key Pair back as our custom Java ECDHKeyPair class object\n    jclass keyPairClass = (*env).FindClass(\"com/myproject/test/cryptopp/ECDHKeyPair\");\n    jmethodID midConstructor = (*env).GetMethodID(keyPairClass, \"&lt;init&gt;\", \"(Ljava/nio/ByteBuffer;Ljava/nio/ByteBuffer;)V\");\n    jobject keyPairObject = (*env).NewObject(keyPairClass, midConstructor, publicKeyByteBuffer, privateKeyByteBuffer);\n\n    return keyPairObject;\n}\n\nJNIEXPORT jobject JNICALL Java_com_myproject_test_cryptopp_ECDHLibrary_retrieveSharedSecret\n        (JNIEnv *env, jclass, jbyteArray publicKeyArray, jbyteArray privateKeyArray)\n{\n    // Use the same ECDH Setup that is specified in the generateKeyPair method above\n    OID CURVE = secp256r1();\n    DL_GroupParameters_EC&lt;ECP&gt; params(CURVE);\n    ECDH&lt;ECP&gt;::Domain dhAgreement(params);\n    dhAgreement.AccessGroupParameters().SetPointCompression(true);\n\n    // Figure out how big the public and private keys are\n    // Public Key: This belongs to the other user\n    // Private Key: This is out personal private key\n    int pubLen = (int)(*env).GetArrayLength(publicKeyArray);\n    int privLen = (int)(*env).GetArrayLength(privateKeyArray);\n\n    // Convert the keys from a jbyteArray to a SecByteBlock so that they can be passed\n    // into the CryptoPP Library functions.\n    unsigned char* pubData = new unsigned char[pubLen];\n    (*env).GetByteArrayRegion(publicKeyArray, 0, pubLen, reinterpret_cast&lt;jbyte*&gt;(pubData));\n\n    unsigned char* privData = new unsigned char[privLen];\n    (*env).GetByteArrayRegion(privateKeyArray, 0, privLen, reinterpret_cast&lt;jbyte*&gt;(privData));\n\n    SecByteBlock pubB(pubData, pubLen) , privA(privData, privLen);\n\n    // Now extract shared secret between the two keys\n    SecByteBlock sharedSecretByteBlock(dhAgreement.AgreedValueLength());\n    ALOG(\"Shared Agreed Value Length: %d\", dhAgreement.AgreedValueLength());\n\n    bool didWork = dhAgreement.Agree(sharedSecretByteBlock, privA, pubB);\n\n    ALOG(\"Key Agreement: %s\", didWork ? \"It Worked\" : \"It Failed\");\n    ALOG(\"Shared Secret Byte Size: %d\", sharedSecretByteBlock.SizeInBytes());\n\n    // Return the shared secret as a Java ByteBuffer\n    jobject publicKeyByteBuffer = (*env).NewDirectByteBuffer(sharedSecretByteBlock.BytePtr(), sharedSecretByteBlock.SizeInBytes());\n\n    return publicKeyByteBuffer;\n}\n</code></pre>\n\n<p><strong>EDIT:</strong>\nI put my test project up on Github <a href=\"https://github.com/tcolligan-ap/ECDHTest\" rel=\"nofollow\">here</a> so that others can take a look and try their own luck. Contains some instructions in the README on how to get it up and running.</p>\n"}, {"tags": ["c++", "opengl", "egl", "wayland"], "comments": [{"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1450887891, "post_id": 34439832, "comment_id": 56620647, "body": "Does EGL impose the limit at 3.3, or does its documentation say it&#39;ll support any version?"}, {"owner": {"reputation": 397, "user_id": 4814459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60afb4c713089d7bdc658c3866ad91d8?s=128&d=identicon&r=PG&f=1", "display_name": "thefunkyjunky", "link": "https://stackoverflow.com/users/4814459/thefunkyjunky"}, "reply_to_user": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1450888269, "post_id": 34439832, "comment_id": 56620902, "body": "I have never seen such a restriction, but I couldn&#39;t find any function or parameter to let me control the version of the created OpenGL context. Such options exist for OpenGL ES, though. That&#39;s what made me think that there might be an option for OpenGL, too."}], "answers": [{"tags": [], "owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "is_accepted": true, "score": 12, "last_activity_date": 1450926387, "last_edit_date": 1450926387, "creation_date": 1450911526, "answer_id": 34444984, "question_id": 34439832, "link": "https://stackoverflow.com/questions/34439832/how-to-create-an-opengl-3-3-or-4-x-context-through-egl/34444984#34444984", "title": "How to create an OpenGL 3.3 or 4.x context through EGL", "body": "<p>EGL was initially developed for OpenGL ES only. The support for desktop OpenGL was added with EGL 1.4 (released 2008). However, at that time, the distinction between \"legacy\" GL contexts, forward compatible contexts and OpenGL profiles like core and compatibility did not yet exist, so EGL 1.4 does not include means to request any of these. The only thing you can rely on is that you get a GL context which is compatible to the \"legacy\" GL 1.x/2.x. This does not imply that it cannot also create a compatibility profile of a higher version, though - you just can't rely on that, and have no way to control it.</p>\n\n<p>The ability to request a GL context compatible to a specific version, or implementing a certain profile, was first provided by the <a href=\"https://www.khronos.org/registry/egl/extensions/KHR/EGL_KHR_create_context.txt\" rel=\"noreferrer\"><code>EGL_KHR_create_context</code></a> EGL extension in 2012, which is functionally quite similiar to the <a href=\"https://www.opengl.org/registry/specs/ARB/wgl_create_context.txt\" rel=\"noreferrer\">WGL</a>/<a href=\"https://www.opengl.org/registry/specs/ARB/glx_create_context.txt\" rel=\"noreferrer\">glX</a> counterparts for the classical desktop GL binding APIs. This functionality also has been added to core <a href=\"https://www.khronos.org/registry/egl/specs/eglspec.1.5.pdf\" rel=\"noreferrer\">EGL version 1.5</a>.</p>\n\n<p>This means you need an implementation supporting either EGL 1.5 or 1.4 with that extension to be able to reliably create modern OpenGL contexts in a controlled way by specifying the </p>\n\n<ul>\n<li><code>EGL_CONTEXT_MAJOR_VERSION</code>, <code>EGL_CONTEXT_MINOR_VERSION</code></li>\n<li><code>EGL_CONTEXT_FLAGS</code></li>\n<li><code>EGL_CONTEXT_OPENGL_PROFILE_MASK</code></li>\n</ul>\n\n<p>attributes (or their extension counterparts with the <code>_KHR</code> suffix, which end up having the same values - the latter are just defined in <code>elgext.h</code>, while the core versions are in <code>egl.h</code> for version 1.5) at context creation.</p>\n"}], "owner": {"reputation": 397, "user_id": 4814459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60afb4c713089d7bdc658c3866ad91d8?s=128&d=identicon&r=PG&f=1", "display_name": "thefunkyjunky", "link": "https://stackoverflow.com/users/4814459/thefunkyjunky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4192, "favorite_count": 2, "accepted_answer_id": 34444984, "answer_count": 1, "score": 7, "last_activity_date": 1479031136, "creation_date": 1450887681, "last_edit_date": 1479031136, "question_id": 34439832, "link": "https://stackoverflow.com/questions/34439832/how-to-create-an-opengl-3-3-or-4-x-context-through-egl", "title": "How to create an OpenGL 3.3 or 4.x context through EGL", "body": "<p>I am interested in making an OpenGL app which doesn't depend on X11. As I have seen, this should be possible through EGL. There are even examples on the internet. But how can I control the context version? The sample code below creates an OpenGL context(on wayland) with version 2.1, but on my computer it shows that the highest OpenGL version supported is 3.3(such context can be created with glXCreateContextAttribsARB using GLX and xlib in the X server). So my question is: Can I somehow create an OpenGL context with higher version through EGL and if yes, how?</p>\n\n<p>Example code:</p>\n\n<pre><code>#include &lt;wayland-client.h&gt;\n#include &lt;wayland-egl.h&gt;\n#include &lt;EGL/egl.h&gt;\n#include &lt;GL/gl.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n\n#define WIDTH 256\n#define HEIGHT 256\n\nstatic struct wl_display *display;\nstatic struct wl_compositor *compositor = NULL;\nstatic struct wl_shell *shell = NULL;\nstatic EGLDisplay egl_display;\nstatic char running = 1;\n\nstruct window {\n    EGLContext egl_context;\n    struct wl_surface *surface;\n    struct wl_shell_surface *shell_surface;\n    struct wl_egl_window *egl_window;\n    EGLSurface egl_surface;\n};\n\n// listeners\nstatic void registry_add_object (void *data, struct wl_registry *registry, uint32_t name, const char *interface, uint32_t version) {\n    if (!strcmp(interface,\"wl_compositor\")) {\n        compositor = wl_registry_bind (registry, name, &amp;wl_compositor_interface, 0);\n    }\n    else if (!strcmp(interface,\"wl_shell\")) {\n        shell = wl_registry_bind (registry, name, &amp;wl_shell_interface, 0);\n    }\n}\nstatic void registry_remove_object (void *data, struct wl_registry *registry, uint32_t name) {\n\n}\nstatic struct wl_registry_listener registry_listener = {&amp;registry_add_object, &amp;registry_remove_object};\n\nstatic void shell_surface_ping (void *data, struct wl_shell_surface *shell_surface, uint32_t serial) {\n    wl_shell_surface_pong (shell_surface, serial);\n}\nstatic void shell_surface_configure (void *data, struct wl_shell_surface *shell_surface, uint32_t edges, int32_t width, int32_t height) {\n    struct window *window = data;\n    wl_egl_window_resize (window-&gt;egl_window, width, height, 0, 0);\n}\nstatic void shell_surface_popup_done (void *data, struct wl_shell_surface *shell_surface) {\n\n}\nstatic struct wl_shell_surface_listener shell_surface_listener = {&amp;shell_surface_ping, &amp;shell_surface_configure, &amp;shell_surface_popup_done};\n\nstatic void create_window (struct window *window, int32_t width, int32_t height) {\n    eglBindAPI (EGL_OPENGL_API);\n    EGLint attributes[] = {\n        EGL_RED_SIZE, 8,\n        EGL_GREEN_SIZE, 8,\n        EGL_BLUE_SIZE, 8,\n    EGL_NONE};\n    EGLConfig config;\n    EGLint num_config;\n    eglChooseConfig (egl_display, attributes, &amp;config, 1, &amp;num_config);\n    window-&gt;egl_context = eglCreateContext (egl_display, config, EGL_NO_CONTEXT, NULL);\n\n    window-&gt;surface = wl_compositor_create_surface (compositor);\n    window-&gt;shell_surface = wl_shell_get_shell_surface (shell, window-&gt;surface);\n    wl_shell_surface_add_listener (window-&gt;shell_surface, &amp;shell_surface_listener, window);\n    wl_shell_surface_set_toplevel (window-&gt;shell_surface);\n    window-&gt;egl_window = wl_egl_window_create (window-&gt;surface, width, height);\n    window-&gt;egl_surface = eglCreateWindowSurface (egl_display, config, window-&gt;egl_window, NULL);\n    eglMakeCurrent (egl_display, window-&gt;egl_surface, window-&gt;egl_surface, window-&gt;egl_context);\n}\nstatic void delete_window (struct window *window) {\n    eglDestroySurface (egl_display, window-&gt;egl_surface);\n    wl_egl_window_destroy (window-&gt;egl_window);\n    wl_shell_surface_destroy (window-&gt;shell_surface);\n    wl_surface_destroy (window-&gt;surface);\n    eglDestroyContext (egl_display, window-&gt;egl_context);\n}\nstatic void draw_window (struct window *window) {\n    glClearColor (0.0, 1.0, 0.0, 1.0);\n    glClear (GL_COLOR_BUFFER_BIT);\n\n    printf(\"%s\\n\", glGetString(GL_VERSION));\n\n    eglSwapBuffers (egl_display, window-&gt;egl_surface);\n}\n\nint main () {\n    display = wl_display_connect (NULL);\n    struct wl_registry *registry = wl_display_get_registry (display);\n    wl_registry_add_listener (registry, &amp;registry_listener, NULL);\n    wl_display_dispatch (display);\n\n    egl_display = eglGetDisplay (display);\n    eglInitialize (egl_display, NULL, NULL);\n\n    struct window window;\n    create_window (&amp;window, WIDTH, HEIGHT);\n\n    while (running) {\n        wl_display_dispatch_pending (display);\n        draw_window (&amp;window);\n    }\n\n    delete_window (&amp;window);\n    eglTerminate (egl_display);\n    wl_display_disconnect (display);\n    return 0;\n}\n</code></pre>\n\n<p>Source: <a href=\"https://github.com/eyelash/tutorials\" rel=\"nofollow noreferrer\">https://github.com/eyelash/tutorials</a></p>\n"}, {"tags": ["c++", "class", "constructor"], "comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1450887557, "post_id": 34439707, "comment_id": 56620438, "body": "Since <code>m_x</code> is declared <i>before</i>  <code>m_a</code> in the <code>B</code> class, <code>B(int n = 5) : m_a(new A[2]), m_x(++m_i)</code> is ill-formed and should be <code>B(int n = 5) : m_x(++m_i), m_a(new A[2])</code>."}, {"owner": {"reputation": 5455, "user_id": 4115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2688a9684db617a20f9da3959e5890d7?s=128&d=identicon&r=PG&f=1", "display_name": "Danh", "link": "https://stackoverflow.com/users/4115625/danh"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1450887625, "post_id": 34439707, "comment_id": 56620468, "body": "@YSC is correct, at least, you will get a ton of warning when compile with gcc (I&#39;m not sure about the others)"}, {"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1450887753, "post_id": 34439707, "comment_id": 56620550, "body": "@YSC <code>B(int n = 5) : m_a(new A[2]), m_x(++m_i)</code> is not ill-formed. Perhaps it should be made ill-formed, but unfortunately it isn&#39;t."}, {"owner": {"reputation": 541, "user_id": 4625372, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dbb132efb10fec398fe155bffd5384d2?s=128&d=identicon&r=PG&f=1", "display_name": "Ptiseb", "link": "https://stackoverflow.com/users/4625372/ptiseb"}, "edited": false, "score": 0, "creation_date": 1450888558, "post_id": 34439707, "comment_id": 56621067, "body": "you&#39;re right, with warnings i get: &quot;test.cpp:27: warning: \u2018B::m_a\u2019 will be initialized after&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 541, "user_id": 4625372, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dbb132efb10fec398fe155bffd5384d2?s=128&d=identicon&r=PG&f=1", "display_name": "Ptiseb", "link": "https://stackoverflow.com/users/4625372/ptiseb"}, "edited": false, "score": 0, "creation_date": 1450887867, "post_id": 34439822, "comment_id": 56620622, "body": "Thx for the answer ! I just understood why 2 and not 3. i also add one more incrementation during the construction of m_x."}, {"owner": {"reputation": 3452, "user_id": 2194193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/WHD9t.gif?s=128&g=1", "display_name": "Resurrection", "link": "https://stackoverflow.com/users/2194193/resurrection"}, "reply_to_user": {"reputation": 541, "user_id": 4625372, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dbb132efb10fec398fe155bffd5384d2?s=128&d=identicon&r=PG&f=1", "display_name": "Ptiseb", "link": "https://stackoverflow.com/users/4625372/ptiseb"}, "edited": false, "score": 0, "creation_date": 1466959073, "post_id": 34439822, "comment_id": 63521296, "body": "@Ptiseb Some compilers (MingW and VC) issues warnings if you initialize members in different order than you declared them."}], "tags": [], "owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "is_accepted": true, "score": 12, "last_activity_date": 1466959246, "last_edit_date": 1495535348, "creation_date": 1450887656, "answer_id": 34439822, "question_id": 34439707, "link": "https://stackoverflow.com/questions/34439707/c-order-of-member-initialization-and-incrementation/34439822#34439822", "title": "C++ - order of member initialization and incrementation", "body": "<blockquote>\n  <p>Why is the final value of <code>m_i</code> <code>2</code> and not <code>3</code>?</p>\n</blockquote>\n\n<p>Because <code>new A[2]</code> creates two separate instances having nothing to do with <code>*this</code>. <code>m_i</code> of the <code>b</code> instance is only incremented in <code>A::A</code> and <code>B::B</code> (twice).</p>\n\n<p><sup>If incrementation of <code>m_i</code> should be performed on the same instance (<code>m_i</code> being a reference, for example), it would be more reasonable to think that the final value of <code>m_i</code> should be <code>4</code> (there are two objects in the array - two additional increments).</sup></p>\n\n<blockquote>\n  <p>Why is the construction of <code>m_x(++m_i)</code> done before the one of <code>m_a(new A[2])</code>?</p>\n</blockquote>\n\n<p>Because <a href=\"https://stackoverflow.com/questions/2669888/c-initialization-order-for-member-classes\">the order of initialization depends on the order of declaration of the data members</a>, not the order in which you write initializations in the member initializer list.</p>\n"}, {"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 4, "last_activity_date": 1450888626, "last_edit_date": 1450888626, "creation_date": 1450887740, "answer_id": 34439842, "question_id": 34439707, "link": "https://stackoverflow.com/questions/34439707/c-order-of-member-initialization-and-incrementation/34439842#34439842", "title": "C++ - order of member initialization and incrementation", "body": "<p>When you construct <code>b</code> the <code>A</code> part of <code>B</code> is constructed first.  This gives the <code>0</code> in the output.  Then we get the <code>2</code> because <code>m_x(++m_i)</code> happens first since <code>m_x</code> is listed first in the class.  Since <code>m_i</code> is 1 from the <code>A</code> part of <code>B</code> being constructed <code>++m_i</code> gives <code>2</code> and now we have <code>02</code>.  Then <code>m_a(new A[2])</code> is ran which gives us 2 <code>0</code>(one for each memeber of the array).  That puts us at <code>0200</code>.  We then get the final <code>2</code> from <code>{ std::cout &lt;&lt; m_i; }</code> since <code>m_i</code> is still <code>2</code> from <code>m_x(++m_i)</code>.</p>\n"}], "owner": {"reputation": 541, "user_id": 4625372, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dbb132efb10fec398fe155bffd5384d2?s=128&d=identicon&r=PG&f=1", "display_name": "Ptiseb", "link": "https://stackoverflow.com/users/4625372/ptiseb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 2, "accepted_answer_id": 34439822, "answer_count": 2, "score": 8, "last_activity_date": 1466959246, "creation_date": 1450887317, "last_edit_date": 1466958376, "question_id": 34439707, "link": "https://stackoverflow.com/questions/34439707/c-order-of-member-initialization-and-incrementation", "title": "C++ - order of member initialization and incrementation", "body": "<p>I was looking for some tests to improve my C++ knowledge. Here is one of the exercises: What is the output of the following program?</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass A\n{\npublic:\n    A(int n = 0) : m_i(n)\n    {\n        std::cout &lt;&lt; m_i;\n        ++m_i;\n    }\n\nprotected:\n    int m_i;\n};\n\nclass B : public A\n{\npublic:\n    B(int n = 5) : m_a(new A[2]), m_x(++m_i) { std::cout &lt;&lt; m_i; }\n\n    ~B() { delete [] m_a; }\n\nprivate:\n    A m_x;\n    A *m_a;\n};\n\nint main()\n{\n    B b;\n    std::cout &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>Well, I tried this code, and the answer is <code>02002</code>. I come here to have some explanation because I don't understand why <code>02002</code> is the result.\nI will explain my reasoning, but could some tell me where am I wrong please?</p>\n\n<p>Let's call \"str\" the current string to print. When the <code>b</code> object is built:</p>\n\n<ol>\n<li>The constructor of <code>A</code> is called. str => <code>0</code>, <code>m_i</code> => <code>1</code></li>\n<li>Construction of <code>m_a(new A[2])</code>. str => <code>000</code></li>\n<li>Construction of <code>m_x(++m_i)</code>. str => <code>0002</code>, <code>m_i</code> => <code>3</code></li>\n<li>Last update of str (in <code>B</code>'s constructor) => str => <code>00023</code></li>\n</ol>\n\n<p><strong>Here are my questions:</strong></p>\n\n<ul>\n<li>Why is the final value of <code>m_i</code> <code>2</code> and not <code>3</code>?</li>\n<li>Why is the construction of <code>m_x(++m_i)</code> done before the one of <code>m_a(new A[2])</code>? I tried to exchange the position of the initialization of m_x and m_a and the answer is still the same : <code>02002</code>.</li>\n</ul>\n"}, {"tags": ["c++", "linker", "undefined-reference", "gsoap"], "comments": [{"owner": {"reputation": 5455, "user_id": 4115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2688a9684db617a20f9da3959e5890d7?s=128&d=identicon&r=PG&f=1", "display_name": "Danh", "link": "https://stackoverflow.com/users/4115625/danh"}, "edited": false, "score": 1, "creation_date": 1450887385, "post_id": 34439502, "comment_id": 56620326, "body": "It seems like it try to link again C-style function, but you compiled it as a C++ one. This error &quot;undefined reference to `soap_wsa_sender_fault_subcode&#39;&quot; looks like a C function signature"}, {"owner": {"reputation": 388, "user_id": 2121441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8e6deaa4f666ea8df498dfacb954062?s=128&d=identicon&r=PG", "display_name": "Sheric", "link": "https://stackoverflow.com/users/2121441/sheric"}, "reply_to_user": {"reputation": 5455, "user_id": 4115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2688a9684db617a20f9da3959e5890d7?s=128&d=identicon&r=PG&f=1", "display_name": "Danh", "link": "https://stackoverflow.com/users/4115625/danh"}, "edited": false, "score": 0, "creation_date": 1450887776, "post_id": 34439502, "comment_id": 56620566, "body": "Maybe! There are two files over there provided by gsoap, one of them is c and the other is cpp file for the same functionality, maybe there&#39;s some changes missing from the conversion to cpp."}, {"owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 0, "creation_date": 1450888708, "post_id": 34439502, "comment_id": 56621157, "body": "What command line are you using to compile &amp; link?"}, {"owner": {"reputation": 388, "user_id": 2121441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8e6deaa4f666ea8df498dfacb954062?s=128&d=identicon&r=PG", "display_name": "Sheric", "link": "https://stackoverflow.com/users/2121441/sheric"}, "edited": false, "score": 0, "creation_date": 1450889207, "post_id": 34439502, "comment_id": 56621477, "body": "Bash! I&#39;m compiling the code with qbuild, g++ and in Ubuntu 14.04"}, {"owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 1, "creation_date": 1450889441, "post_id": 34439502, "comment_id": 56621609, "body": "Are you sure <code>soap_wsa_sender_fault_subcode</code> is defined in the same file? In the current source at github it is defined in <a href=\"https://github.com/stoneyrh/gSOAP/blob/af73ab8e55c00b43556876de39bef5dd200d4ba9/gsoap/plugin/wsaapi.c#L1035\" rel=\"nofollow noreferrer\">wsapi.c</a> but not in <a href=\"https://github.com/stoneyrh/gSOAP/blob/af73ab8e55c00b43556876de39bef5dd200d4ba9/gsoap/plugin/wsseapi.cpp\" rel=\"nofollow noreferrer\">wsseapi.cpp</a>."}, {"owner": {"reputation": 388, "user_id": 2121441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8e6deaa4f666ea8df498dfacb954062?s=128&d=identicon&r=PG", "display_name": "Sheric", "link": "https://stackoverflow.com/users/2121441/sheric"}, "edited": false, "score": 0, "creation_date": 1450890823, "post_id": 34439502, "comment_id": 56622436, "body": "You&#39;re right, the last function is defined in <code>wssapi.c</code>! It was my mistake. But when I include it there come up a lot of multiple definition errors."}, {"owner": {"reputation": 388, "user_id": 2121441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8e6deaa4f666ea8df498dfacb954062?s=128&d=identicon&r=PG", "display_name": "Sheric", "link": "https://stackoverflow.com/users/2121441/sheric"}, "edited": false, "score": 0, "creation_date": 1450891185, "post_id": 34439502, "comment_id": 56622624, "body": "Sorry, when I include it another problem arises! In the C source file, there&#39;s a header file included, which is a c++ header and uses std::vector."}], "answers": [{"comments": [{"owner": {"reputation": 388, "user_id": 2121441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8e6deaa4f666ea8df498dfacb954062?s=128&d=identicon&r=PG", "display_name": "Sheric", "link": "https://stackoverflow.com/users/2121441/sheric"}, "edited": false, "score": 0, "creation_date": 1450889113, "post_id": 34439767, "comment_id": 56621420, "body": "Doing so around the whole cpp file will give me a lot of error like  <code>&#47;usr&#47;include&#47;c++&#47;4.8&#47;bits&#47;istream.tcc:83:3: error: template with C linkage    template&lt;typename _CharT, typename _Traits&gt;</code>.  On the other hand, I don&#39;t want to change a library file! Any better way? The source file is named .cpp and there is another .c file with the same name there, but when I include it, in another header (generated with a script) there&#39;s vector library included and it gives me an unresolved include error."}, {"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "reply_to_user": {"reputation": 388, "user_id": 2121441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8e6deaa4f666ea8df498dfacb954062?s=128&d=identicon&r=PG", "display_name": "Sheric", "link": "https://stackoverflow.com/users/2121441/sheric"}, "edited": false, "score": 3, "creation_date": 1450889520, "post_id": 34439767, "comment_id": 56621663, "body": "You must not do it around the whole CPP file, you must do it around the forward declaration of the methods which come from the C environment. This is the correct solution, I never minded finding an hacky workaround since there is no need for one."}, {"owner": {"reputation": 388, "user_id": 2121441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8e6deaa4f666ea8df498dfacb954062?s=128&d=identicon&r=PG", "display_name": "Sheric", "link": "https://stackoverflow.com/users/2121441/sheric"}, "edited": false, "score": 0, "creation_date": 1450890405, "post_id": 34439767, "comment_id": 56622201, "body": "Well, the function that I miss is defined in cpp!"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 388, "user_id": 2121441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8e6deaa4f666ea8df498dfacb954062?s=128&d=identicon&r=PG", "display_name": "Sheric", "link": "https://stackoverflow.com/users/2121441/sheric"}, "edited": false, "score": 1, "creation_date": 1450917471, "post_id": 34439767, "comment_id": 56633578, "body": "@Sheric you only need to <code>extern &quot;C&quot;</code> the function declaration ;; that then applies to the definition automatically"}], "tags": [], "owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "is_accepted": true, "score": 3, "last_activity_date": 1450887471, "last_edit_date": 1495535242, "creation_date": 1450887471, "answer_id": 34439767, "question_id": 34439502, "link": "https://stackoverflow.com/questions/34439502/undefined-reference-to-a-function-defined-in-the-same-file/34439767#34439767", "title": "Undefined reference to a function defined in the same file", "body": "<p>The problem I suspect is that you are trying to link some C code with C++. This can lead to linking errors caused by how names are mangled in C++ compared to C.</p>\n\n<p>To resolve such issues you should wrap the functions that are compiled from a C source file in an <code>extern</code> scope:</p>\n\n<pre><code>extern \"C\" {\n  int soap_wsa_sender_fault_subcode(struct soap *soap, const char *faultsubcode, const char *faultstring, const char *faultdetail);\n}\n</code></pre>\n\n<p>This would prevent the enclosed functions to be mangled so that their reference in the object file can be correctly found and linked. You can find additional information <a href=\"https://stackoverflow.com/questions/1041866/in-c-source-what-is-the-effect-of-extern-c\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 5455, "user_id": 4115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2688a9684db617a20f9da3959e5890d7?s=128&d=identicon&r=PG&f=1", "display_name": "Danh", "link": "https://stackoverflow.com/users/4115625/danh"}, "is_accepted": false, "score": 1, "last_activity_date": 1450914252, "creation_date": 1450914252, "answer_id": 34445404, "question_id": 34439502, "link": "https://stackoverflow.com/questions/34439502/undefined-reference-to-a-function-defined-in-the-same-file/34445404#34445404", "title": "Undefined reference to a function defined in the same file", "body": "<p>This problem occurred because you tried to link C code with C++ code. </p>\n\n<p>Let's say you have <code>wssapi.c</code> <code>wssapi.h</code> <code>main.cpp</code>. In your <code>main.cpp</code> do this</p>\n\n<pre><code>extern \"C\" {\n    #include \"wssapi.h\"\n}\n</code></pre>\n\n<p>Instead of only</p>\n\n<pre><code>#include \"wssapi.h\"\n</code></pre>\n"}], "owner": {"reputation": 388, "user_id": 2121441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8e6deaa4f666ea8df498dfacb954062?s=128&d=identicon&r=PG", "display_name": "Sheric", "link": "https://stackoverflow.com/users/2121441/sheric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1489, "favorite_count": 0, "accepted_answer_id": 34439767, "answer_count": 2, "score": 0, "last_activity_date": 1450950925, "creation_date": 1450886556, "last_edit_date": 1450950925, "question_id": 34439502, "link": "https://stackoverflow.com/questions/34439502/undefined-reference-to-a-function-defined-in-the-same-file", "title": "Undefined reference to a function defined in the same file", "body": "<p>I am compiling a code generated with gsoap, and I should compile some files provided by gsoap in <code>/usr/share/gsoap/plugin/</code> too.</p>\n\n<p>The problem is that in linking step, I get undefined reference error:</p>\n\n<pre><code>wsseapi.o: In function `soap_wsse_verify_Timestamp':\nwsseapi.cpp:(.text+0xf64): undefined reference to `soap_wsa_sender_fault_subcode'\n</code></pre>\n\n<p>... and a lot more to the same symbol.</p>\n\n<p>The symbol however is defined in the same file as <code>soap_wsse_verify_Timestamp</code> that uses it and when I check the object file with readelf, the symbol is defined in it:</p>\n\n<pre><code>$ readelf -Ws wsseapi.o |grep soap_wsa_sender_fault_subcode\n   164: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND soap_wsa_sender_fault_subcode\n</code></pre>\n\n<p>Here is the function definitions in the original file:</p>\n\n<pre><code>/**\n@fn int soap_wsse_verify_Timestamp(struct soap *soap)\n@brief Verifies the Timestamp/Expires element against the current time.\n@param soap context\n@return SOAP_OK or SOAP_FAULT with wsse:FailedAuthentication fault\n\nSets wsse:FailedAuthentication fault if wsu:Timestamp is expired. The\nSOAP_WSSE_CLKSKEW value is used as a margin to mitigate clock skew. Keeps\nsilent when no timestamp is supplied or no expiration date is included in the\nwsu:Timestamp element.\n*/\nint\nsoap_wsse_verify_Timestamp(struct soap *soap)\n{ _wsu__Timestamp *timestamp = soap_wsse_Timestamp(soap);\n  DBGFUN(\"soap_wsse_verify_Timestamp\");\n  /* if we have a timestamp with an expiration date, check it */\n  if (timestamp &amp;&amp; timestamp-&gt;Expires)\n  { time_t now = time(NULL), expired;\n    soap_s2dateTime(soap, timestamp-&gt;Expires, &amp;expired);\n    if (expired + SOAP_WSSE_CLKSKEW &lt;= now)\n    { const char *code = soap_wsu__tTimestampFault2s(soap, wsu__MessageExpired);\n      return soap_wsse_sender_fault_subcode(soap, code, \"Message has expired\", timestamp-&gt;Expires);\n    }\n  }\n  return SOAP_OK;\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>/**\n@fn int soap_wsse_sender_fault_subcode(struct soap *soap, const char *faultsubcode, const char *faultstring, const char *faultdetail)\n@brief Sets sender SOAP Fault (sub)code for server fault response.\n@param soap context\n@param[in] faultsubcode sub code string\n@param[in] faultstring fault string\n@param[in] faultdetail detail string\n@return SOAP_FAULT\n*/\nint\nsoap_wsse_sender_fault_subcode(struct soap *soap, const char *faultsubcode, const char *faultstring, const char *faultdetail)\n{\n#if defined(SOAP_WSA_2003) || defined(SOAP_WSA_2004) || defined(SOAP_WSA_200408) || defined(SOAP_WSA_2005)\n  return soap_wsa_sender_fault_subcode(soap, faultsubcode, faultstring, faultdetail);\n#else\n  return soap_sender_fault_subcode(soap, faultsubcode, faultstring, faultdetail);\n#endif\n}\n</code></pre>\n\n<p>finally,</p>\n\n<pre><code>/**\n@fn int soap_wsa_sender_fault_subcode(struct soap *soap, const char *faultsubcode, const char *faultstring, const char *faultdetail)\n@brief Sets sender SOAP Fault (sub)code for server fault response.\n@param soap context\n@param[in] faultsubcode sub code string\n@param[in] faultstring fault string\n@param[in] faultdetail detail string\n@return SOAP_FAULT\n*/\nint\nsoap_wsa_sender_fault_subcode(struct soap *soap, const char *faultsubcode, const char *faultstring, const char *faultdetail)\n{ return soap_wsa_fault_subcode(soap, 1, faultsubcode, faultstring, faultdetail);\n}\n</code></pre>\n\n<p>My question is how can an undefined reference error occur when the symbol is defined in the same file and can be find in the same object file.</p>\n\n<p>Thanks.</p>\n\n<p><strong>EDIT:</strong>\nHere is the definition part in a header file included in the top of the cpp file:</p>\n\n<pre><code>int soap_wsa_request(struct soap *soap, const char *id, const char *to, const char *action);\nint soap_wsa_add_From(struct soap *soap, const char *endpoint);\nint soap_wsa_add_NoReply(struct soap *soap);\nint soap_wsa_add_ReplyTo(struct soap *soap, const char *endpoint);\nint soap_wsa_add_FaultTo(struct soap *soap, const char *endpoint);\nint soap_wsa_add_RelatesTo(struct soap *soap, const char *endpoint);\nconst char *soap_wsa_From(struct soap *soap);\nconst char *soap_wsa_ReplyTo(struct soap *soap);\nconst char *soap_wsa_FaultTo(struct soap *soap);\nconst char *soap_wsa_RelatesTo(struct soap *soap);\n\nint soap_wsa_check(struct soap *soap);\nint soap_wsa_reply(struct soap *soap, const char *id, const char *action);\nint soap_wsa_fault_subcode(struct soap *soap, int flag, const char *faultsubcode, const char *faultstring, const char *faultdetail);\nint soap_wsa_fault_subcode_action(struct soap *soap, int flag, const char *faultsubcode, const char *faultstring, const char *faultdetail, const char *action);\nint soap_wsa_sender_fault_subcode(struct soap *soap, const char *faultsubcode, const char *faultstring, const char *faultdetail);\nint soap_wsa_sender_fault_subcode_action(struct soap *soap, const char *faultsubcode, const char *faultstring, const char *faultdetail, const char *action);\nint soap_wsa_receiver_fault_subcode(struct soap *soap, const char *faultsubcode, const char *faultstring, const char *faultdetail);\nint soap_wsa_receiver_fault_subcode_action(struct soap *soap, const char *faultsubcode, const char *faultstring, const char *faultdetail, const char *action);\nint soap_wsa_sender_fault(struct soap *soap, const char *faultstring, const char *faultdetail);\nint soap_wsa_receiver_fault(struct soap *soap, const char *faultstring, const char *faultdetail);\n</code></pre>\n\n<p><strong>UPDATE:</strong>\nThe problem seems to be due the linking problem between C++ and C (As you can see in the answers). And there's a paradox in gsoap files, because there's an autogenerated header file being used in a C source, <code>wsseapi.c</code> which uses C++ features. If I could solve this problem, then I think compiling and linking wsseapi.c as well could fix the problem (As someone in the comments mentioned, the missing function is actually defined in the C source file.)</p>\n\n<p>However, I am giving up in this whole solution, because I have found a simpler way to get data from my IP camera using <code>OpenCV</code> and <code>ffmpeg</code>. So I'm not gonna test anymore.</p>\n\n<p>Thank you all for helping.</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1450885961, "post_id": 34439284, "comment_id": 56619470, "body": "You cannot copy-initialize arrays. Returning references to arrays is a red herring; that is allowed and works fine."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 4, "creation_date": 1450886122, "post_id": 34439284, "comment_id": 56619564, "body": "name of the array is not a pointer to the first element, but can be implicitly converted to. There is a difference and this common mistake leads to errors. Anyway you better use <code>std::array</code> to avoid confusion."}, {"owner": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "edited": false, "score": 2, "creation_date": 1450886241, "post_id": 34439284, "comment_id": 56619633, "body": "<i>&quot;I know the name of the array is a pointer to the first element in that array&quot;</i> - this is wrong. Read <a href=\"http://en.cppreference.com/w/cpp/language/array#Array_to_pointer_decay\" rel=\"nofollow noreferrer\">this</a>. EDIT: Ah, Slava beat me to it. The link is still a good read, though."}, {"owner": {"reputation": 1663, "user_id": 5340808, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/886783f7e1ae0b7e2c394d2a8688e7af?s=128&d=identicon&r=PG&f=1", "display_name": "Jaege", "link": "https://stackoverflow.com/users/5340808/jaege"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1450886829, "post_id": 34439284, "comment_id": 56619993, "body": "Oh, you mean in the class version? I&#39;ve compiled the code in VS2015 and no error occurred (except the line I commented error), then how can I initialize the array? @KerrekSB"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1450886915, "post_id": 34439284, "comment_id": 56620042, "body": "@Jaege: You can only copy-list-initialize, direct-list-initialize, value-initialize and default-initialize arrays, I think."}, {"owner": {"reputation": 1663, "user_id": 5340808, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/886783f7e1ae0b7e2c394d2a8688e7af?s=128&d=identicon&r=PG&f=1", "display_name": "Jaege", "link": "https://stackoverflow.com/users/5340808/jaege"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1450887559, "post_id": 34439284, "comment_id": 56620439, "body": "@KerrekSB I think the new feature <i>list initialization</i> in C++11 is what happened in the code. See: <a href=\"http://stackoverflow.com/a/10694479/5340808\">answer here</a>. Also <a href=\"http://en.cppreference.com/w/cpp/language/list_initialization\" rel=\"nofollow noreferrer\">list initialization</a>."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1450888204, "post_id": 34439284, "comment_id": 56620866, "body": "@Jaege: Sorry, my comment was too unspecific. I meant specifically that <code>int a[3] = f();</code> is not valid."}, {"owner": {"reputation": 1663, "user_id": 5340808, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/886783f7e1ae0b7e2c394d2a8688e7af?s=128&d=identicon&r=PG&f=1", "display_name": "Jaege", "link": "https://stackoverflow.com/users/5340808/jaege"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1450888417, "post_id": 34439284, "comment_id": 56620989, "body": "@KerrekSB Oh yes, you&#39;re right. I got the point now :)"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1451727558, "post_id": 34439284, "comment_id": 56872390, "body": "Use <code>std::array</code>  or <code>std::vector</code>"}], "answers": [{"comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 2, "creation_date": 1450887005, "post_id": 34439555, "comment_id": 56620092, "body": "This is quite misleading because it gives the impression that a reference to an array cannot be returned, or that the return value cannot be used."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 2, "creation_date": 1450887187, "post_id": 34439555, "comment_id": 56620206, "body": "@juanchopanza Where did I say that?"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 2, "creation_date": 1450888025, "post_id": 34439555, "comment_id": 56620743, "body": "I didn&#39;t mean that you say it. Just that by concentrating on an <code>std::array</code> solution without mentioning that it is perfectly fin to return and use a reference to an array this gives the impression that you can&#39;t do it."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 2, "creation_date": 1450888080, "post_id": 34439555, "comment_id": 56620779, "body": "It is not perfectly fine to return reference to array, as this leads to poor and difficult to understand code. This is C++ first of all, C arrays are clunky as you mentioned in your answer"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5560811"}, "edited": false, "score": 0, "creation_date": 1525930009, "post_id": 34439555, "comment_id": 87549954, "body": "std::array is a complete native array encapsulation. It is difficult to use it  on algorithms/functions declared with arguments as native array references."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1525959243, "post_id": 34439555, "comment_id": 87565050, "body": "@DusanJovanovic I hope you never create algorithms/functions that use native array reference. And if you see a such library - it is a good sign not to use it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5560811"}, "edited": false, "score": 0, "creation_date": 1526032527, "post_id": 34439555, "comment_id": 87595376, "body": "@Slava, no problem ... I might also suggest you send a proposal to ISO C++ committee to banish references to native arrays, too. If you are quick enough your proposal might become part of C++20."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5560811"}, "edited": false, "score": 0, "creation_date": 1526033046, "post_id": 34439555, "comment_id": 87595694, "body": "@Slava, contrary to your code comment, one can iterate over a native array, if we understood you right? <a href=\"https://wandbox.org/permlink/uY1Bf4z8gQF0BAWo\" rel=\"nofollow noreferrer\">wandbox.org/permlink/uY1Bf4z8gQF0BAWo</a>"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1526046555, "post_id": 34439555, "comment_id": 87603933, "body": "@DusanJovanovic I did not say it must be removed from the language. But I cannot imagine a good design that would only accept native array by reference."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1526130916, "post_id": 34439555, "comment_id": 87629232, "body": "@DusanJovanovic I repeat bad design is when a function(s) accepts <b>ONLY</b> native array by reference. What is not clear in my statement?"}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 12, "last_activity_date": 1450889703, "last_edit_date": 1450889703, "creation_date": 1450886743, "answer_id": 34439555, "question_id": 34439284, "link": "https://stackoverflow.com/questions/34439284/c-function-returning-reference-to-array/34439555#34439555", "title": "C++ function returning reference to array", "body": "<p>You should use <a href=\"http://en.cppreference.com/w/cpp/container/array\">std::array</a> to avoid confusion and make cleaner, safer and less clunky code:</p>\n\n<pre><code>class A {\npublic:\n    typedef std::array&lt;int,3&gt; array;\n    A() : ia{1, 2, 3} {}\n    array &amp;foo(){ return ia; }\nprivate:\n    array ia;\n};\n\nint main() {\n    A a;\n    auto i1 = a.foo();      // ok, type of i1 is A::array, it is a copy and visit array by i1[0]\n    for ( int i : i1 ) {}   // you can iterate now, with C array you cannot anymore\n    auto &amp;i2 = a.foo();     // ok, type of i2 is A::array&amp;, you can change original by i2[0] = 123 \n    A::array i3 = a.foo();  // fine, i3 is now a copy and visit array by i3[0]\n    A::array &amp;i4 = a.foo(); // fine, you can change original by i4[0] = 123\n    int *i5 = a.foo().data();  // if you want old way to pass to c function for example, it is safer you explicitly show your intention\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>I know the name of the array is a pointer to the first element in that array</p>\n</blockquote>\n\n<p>This is incorrect, array can be implicitly converted to a pointer to the first element. It is not the same.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1507613131, "post_id": 34439639, "comment_id": 80266922, "body": "<code>auto&amp; ref = a.foo();</code> is also possible"}], "tags": [], "owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "is_accepted": true, "score": 14, "last_activity_date": 1450887707, "last_edit_date": 1450887707, "creation_date": 1450887063, "answer_id": 34439639, "question_id": 34439284, "link": "https://stackoverflow.com/questions/34439284/c-function-returning-reference-to-array/34439639#34439639", "title": "C++ function returning reference to array", "body": "<blockquote>\n  <p>Is there any other way to receive a reference to an array from function returning except using a pointer?</p>\n</blockquote>\n\n<p>Yes, using a reference to an array, like with any other type:</p>\n\n<pre><code>int (&amp;ref)[3] = a.foo();\n</code></pre>\n\n<p>To avoid the clunky syntax, you could use a <code>typedef</code> instead.</p>\n\n<pre><code>typedef int int_array3[3];\n\n...\nint_array3&amp; foo() { return ia; }\n\n...\n\nint_array3&amp; ref = a.foo();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1557, "user_id": 762809, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8eff37e1cc4a7955125df2124d9be5a0?s=128&d=identicon&r=PG", "display_name": "Ricky65", "link": "https://stackoverflow.com/users/762809/ricky65"}, "is_accepted": false, "score": 0, "last_activity_date": 1507462960, "creation_date": 1507462960, "answer_id": 46630708, "question_id": 34439284, "link": "https://stackoverflow.com/questions/34439284/c-function-returning-reference-to-array/46630708#46630708", "title": "C++ function returning reference to array", "body": "<p>Some alternatives I think are superior in C++14 onwards:</p>\n\n<p>auto and array reference trailing return type:</p>\n\n<pre><code>template &lt;typename T, std::size_t N&gt;\nauto array_ref_test(T(&amp;array)[N]) -&gt; T(&amp;)[N]\n{\n    return array;\n}\n</code></pre>\n\n<p>decltype(auto):</p>\n\n<pre><code>template &lt;typename T, std::size_t N&gt;\ndecltype(auto) array_ref_test(T(&amp;array)[N])\n{\n    return array;\n}\n</code></pre>\n\n<p>Example usage: </p>\n\n<pre><code>int array_ref_ [] = { 1, 2, 3, 4, 5 };   \ndecltype(auto) array_ref_result = array_ref_test(array_ref_); //'decltype(auto)' preserves reference unlike 'auto'\nstd::cout &lt;&lt; std::size(array_ref_result);\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5560811"}, "is_accepted": false, "score": 0, "last_activity_date": 1525795267, "last_edit_date": 1525795267, "creation_date": 1520258217, "answer_id": 49112075, "question_id": 34439284, "link": "https://stackoverflow.com/questions/34439284/c-function-returning-reference-to-array/49112075#49112075", "title": "C++ function returning reference to array", "body": "<p>To answer this question one can design a solution around std::reference_wrapper. This code compiles and runs.</p>\n\n<pre><code>#pragma once\n#include &lt;array&gt;\n#include &lt;functional&gt;\n#include &lt;cstdlib&gt;\n#include &lt;ctime&gt;\n\nnamespace {\n\n/// &lt;summary&gt;\n/// some generic utility function \n/// with argument declared as \n/// native array reference\n/// for testing purposes only\n/// &lt;/summary&gt;\ntemplate&lt;typename T, std::size_t N &gt;\ninline void array_util_function( T (&amp;arr_ref) [N] ) {\n    auto random = [](int max_val, int min_val = 1) -&gt; int {\n        // use current time as seed for \n        // random generator, but only once\n        static auto initor = []() { \n            std::srand((unsigned)std::time(nullptr)); return 0; \n        }();\n\n        return min_val + std::rand() / ((RAND_MAX + 1u) / max_val);\n    };\n\n    for (auto &amp; element : arr_ref) {\n        element = random(N);\n    }\n}\n\n// the key abstraction\ntemplate &lt;typename T, std::size_t N&gt;\nusing native_arr_ref_wrapper = std::reference_wrapper&lt;T[N]&gt;;\n\ntemplate&lt;typename T, std::size_t N &gt;\nconstexpr std::size_t array_size(T(&amp;arr_ref)[N]) {\n    return N;\n}\n\n// return the size of the native array\n// contained within\ntemplate&lt;typename T, std::size_t N &gt;\nconstexpr std::size_t array_size(native_arr_ref_wrapper&lt;T,N&gt; &amp; narw_) {\n    return array_size(narw_.get());\n}\n\n/// &lt;summary&gt;\n/// returns std::reference_wrapper copy\n/// that contains reference to native array \n/// in turn contained inside the std::array\n/// argument\n/// &lt;/summary&gt;\ntemplate&lt;typename T, std::size_t N &gt;\n    inline auto\n        native_arr_ref(const std::array&lt;T, N&gt; &amp; std_arr)\n        -&gt; native_arr_ref_wrapper&lt;T,N&gt;\n{\n    using nativarref = T(&amp;)[N];\n\n    return std::ref(\n            (nativarref)*(std_arr.data())\n        );\n}\n\n    /// &lt;summary&gt;\n    /// returns std::reference_wrapper copy\n    /// that contains reference to native array \n    /// &lt;/summary&gt;\n    template&lt;typename T, std::size_t N &gt;\n    inline auto\n        native_arr_ref(const T (&amp; native_arr)[N] )\n        -&gt; native_arr_ref_wrapper&lt;T, N&gt;\n    {\n        using nativarref = T(&amp;)[N];\n\n        return std::ref(\n            (nativarref)*(native_arr)\n        );\n    }\n\n    auto printarr = [](auto arr_ref, const char * prompt = \"Array :\") {\n        printf(\"\\n%s:\\n{ \", prompt);\n        int j = 0;\n        // use the array reference \n        // to see the contents \n        for (const auto &amp; element : arr_ref.get()) {\n            printf(\" %d:%d \", j++, element);\n        }\n        printf(\" }\\n\");\n    };\n\n// arf == native array reference\nvoid test_ () {\n\nusing std::array;\n// the arf type is \n// std::reference_wrapper&lt;int[10]&gt; \nauto arf  = native_arr_ref(array&lt;int, 10&gt;{});\n// the arf type is same here \n// but made from a native array\nauto ar2 = native_arr_ref({ 0,1,2,3,4,5,6,7,8,9 });\nprintarr(ar2);\n\n// notice how argument to native_arr_ref()\n// does not exist here any more\n// but, wrapper contains the copy \n// of the native array  \n\n// type is here: int[10]&amp;\nauto &amp; native_arr_ref = arf.get();\n\n// due to array type decay \n// the type is here: int *\nauto native_arr_ptr = arf.get();\n\n// size_t\nconst auto size = array_size(arf);\n\n// this function requires\n// native array as argument\n// this is how we use arf in place of \n// native arrays\narray_util_function(arf.get());\n\nprintarr(arf);\n\n    }\n  }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 444, "user_id": 2953356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/baleC.jpg?s=128&g=1", "display_name": "Quinn Carver", "link": "https://stackoverflow.com/users/2953356/quinn-carver"}, "is_accepted": false, "score": 0, "last_activity_date": 1603374087, "creation_date": 1603374087, "answer_id": 64483550, "question_id": 34439284, "link": "https://stackoverflow.com/questions/34439284/c-function-returning-reference-to-array/64483550#64483550", "title": "C++ function returning reference to array", "body": "<p>Your functions signature would look like this:</p>\n<pre><code>int(&amp;A::adapter(/*input_args_or_empty*/))[3]{\n   return ia;\n}\n</code></pre>\n"}], "owner": {"reputation": 1663, "user_id": 5340808, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/886783f7e1ae0b7e2c394d2a8688e7af?s=128&d=identicon&r=PG&f=1", "display_name": "Jaege", "link": "https://stackoverflow.com/users/5340808/jaege"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12829, "favorite_count": 2, "accepted_answer_id": 34439639, "answer_count": 5, "score": 14, "last_activity_date": 1603374087, "creation_date": 1450885852, "last_edit_date": 1451727387, "question_id": 34439284, "link": "https://stackoverflow.com/questions/34439284/c-function-returning-reference-to-array", "title": "C++ function returning reference to array", "body": "<p>Is there any other way to receive a reference to an array from function returning except using a pointer?</p>\n\n<p>Here is my code.</p>\n\n<pre><code>int ia[] = {1, 2, 3};\ndecltype(ia) &amp;foo() {   // or, int (&amp;foo())[3]\n    return ia;\n}\n\nint main() {\n    int *ip1 = foo();   // ok, and visit array by ip1[0] or *(ip1 + 0)\n    auto ip2 = foo();   // ok, the type of ip2 is int *\n    int ar[] = foo();   // error\n    int ar[3] = foo();  // error\n    return 0;\n}\n</code></pre>\n\n<p>And a class version.</p>\n\n<pre><code>class A {\npublic:\n    A() : ia{1, 2, 3} {}\n    int (&amp;foo())[3]{ return ia; }\nprivate:\n    int ia[3];\n};\n\nint main() {\n    A a;\n    auto i1 = a.foo();    // ok, type of i1 is int *, and visit array by i1[0]\n    int i2[3] = a.foo();  // error\n    return 0;\n}\n</code></pre>\n\n<p>Note: <code>const</code> qualifier is omitted in code.</p>\n\n<p><strike>I know the name of the array is a pointer to the first element in that array, so using a pointer to receive is totally viable.</strike></p>\n\n<p>Sorry, I made a mistake. From <a href=\"http://en.cppreference.com/w/cpp/language/array#Array_to_pointer_decay\" rel=\"noreferrer\">Array to pointer decay</a></p>\n\n<blockquote>\n  <p>There is an implicit conversion from lvalues and rvalues of array type to rvalues of pointer type: it constructs a pointer to the first element of an array.</p>\n</blockquote>\n\n<p>Please ignore that XD</p>\n\n<p>I'm just curious about the question I asked at the beginning :)</p>\n"}, {"tags": ["c++", "gcc"], "comments": [{"owner": {"reputation": 8891, "user_id": 4505712, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h9W5W.png?s=128&g=1", "display_name": "James Adkison", "link": "https://stackoverflow.com/users/4505712/james-adkison"}, "edited": false, "score": 0, "creation_date": 1450886400, "post_id": 34439233, "comment_id": 56619738, "body": "Is <code>MyClass</code> copyable? Related, I would really consider whether you want to make a global instance ... However, if it&#39;s copyable then I think there is an easy solution."}, {"owner": {"reputation": 5455, "user_id": 4115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2688a9684db617a20f9da3959e5890d7?s=128&d=identicon&r=PG&f=1", "display_name": "Danh", "link": "https://stackoverflow.com/users/4115625/danh"}, "edited": false, "score": 1, "creation_date": 1450886957, "post_id": 34439233, "comment_id": 56620065, "body": "Please stop using <code>void main</code>, ISO C++ permits <code>int main()</code> or <code>int main(int, char**)</code> only"}, {"owner": {"reputation": 10308, "user_id": 1738915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/YXjto.jpg?s=128&g=1", "display_name": "Kolban", "link": "https://stackoverflow.com/users/1738915/kolban"}, "reply_to_user": {"reputation": 5455, "user_id": 4115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2688a9684db617a20f9da3959e5890d7?s=128&d=identicon&r=PG&f=1", "display_name": "Danh", "link": "https://stackoverflow.com/users/4115625/danh"}, "edited": false, "score": 0, "creation_date": 1450887045, "post_id": 34439233, "comment_id": 56620116, "body": "@Danh - Sorry Danh ... it was meant to be pseudo code as opposed to a real app.  However I changed the text as requested."}], "answers": [{"tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": false, "score": 3, "last_activity_date": 1450887250, "last_edit_date": 1450887250, "creation_date": 1450886713, "answer_id": 34439544, "question_id": 34439233, "link": "https://stackoverflow.com/questions/34439233/deferring-c-static-object-construction-gcc-on-linux/34439544#34439544", "title": "Deferring C++ static object construction - GCC on Linux", "body": "<p>Does it suit your needs?</p>\n\n<pre><code>namespace\n{\n    int doStaticGlobalSetup()\n    {\n        doGlobalSetup();\n        return 0;\n    }\n}\nMyClass myInstance(doStaticGlobalSetup() + 1,2,3);\n\nint main() {\n   myInstance.doSomething();\n   return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8891, "user_id": 4505712, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h9W5W.png?s=128&g=1", "display_name": "James Adkison", "link": "https://stackoverflow.com/users/4505712/james-adkison"}, "edited": false, "score": 0, "creation_date": 1450914110, "post_id": 34439579, "comment_id": 56632723, "body": "@Arkadiy Yes, it does assume the <code>MyClass</code> is copyable and the question does not list a constraint stating otherwise. I also asked the OP about this but didn&#39;t get an answer."}], "tags": [], "owner": {"reputation": 8891, "user_id": 4505712, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h9W5W.png?s=128&g=1", "display_name": "James Adkison", "link": "https://stackoverflow.com/users/4505712/james-adkison"}, "is_accepted": false, "score": 5, "last_activity_date": 1570042905, "last_edit_date": 1570042905, "creation_date": 1450886817, "answer_id": 34439579, "question_id": 34439233, "link": "https://stackoverflow.com/questions/34439233/deferring-c-static-object-construction-gcc-on-linux/34439579#34439579", "title": "Deferring C++ static object construction - GCC on Linux", "body": "<p>Since you've constrained the problem such that <code>new</code> cannot be used, you should be able to create the object as always and copy it to the global instance. For example:</p>\n\n<pre><code>MyClass createMyClass()\n{\n    doGlobalSetup();\n    return MyClass(1, 2, 3);\n}\n\nMyClass myInstance = createMyClass();\n\nint main()\n{\n    myInstance.doSomething();\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1450886879, "post_id": 34439588, "comment_id": 56620019, "body": "I&#39;m not sure it answers the question. Does it?"}, {"owner": {"reputation": 8891, "user_id": 4505712, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h9W5W.png?s=128&g=1", "display_name": "James Adkison", "link": "https://stackoverflow.com/users/4505712/james-adkison"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 2, "creation_date": 1450887075, "post_id": 34439588, "comment_id": 56620126, "body": "@YSC Why doesn&#39;t it: Placement new sounds like a great idea, especially if the object isn&#39;t copyable."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1450887212, "post_id": 34439588, "comment_id": 56620218, "body": "Ho I get it. It wasn&#39;t obvious at first how the placement new answered the question. It does."}, {"owner": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "edited": false, "score": 0, "creation_date": 1450887876, "post_id": 34439588, "comment_id": 56620632, "body": "I think this is the best answer. I would change just a little: make <code>create()</code> and <code>destroy()</code> the constructor and destructor of a proxy class, and create an instance of this class in the start of <code>main()</code>(and after calling <code>doGlobalSetup()</code>). That way I could still have automatic lifetime management for the instance."}], "tags": [], "owner": {"reputation": 7737, "user_id": 3410396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc26b280cedaa721d90828a80e39706?s=128&d=identicon&r=PG&f=1", "display_name": "Revolver_Ocelot", "link": "https://stackoverflow.com/users/3410396/revolver-ocelot"}, "is_accepted": false, "score": 3, "last_activity_date": 1450888930, "last_edit_date": 1450888930, "creation_date": 1450886839, "answer_id": 34439588, "question_id": 34439233, "link": "https://stackoverflow.com/questions/34439233/deferring-c-static-object-construction-gcc-on-linux/34439588#34439588", "title": "Deferring C++ static object construction - GCC on Linux", "body": "<p>If you absolutely have to defer <strong>any</strong> constructor calls until after global initialization is done, and want to be sure that no static order initialization fiasco happens, there is a way: make <code>myInstance</code> a reference to uninitialized block of memory and create object in it using placement new after global initializaton.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\nstruct foo\n{\n    foo() { std::cout &lt;&lt; \"created\\n\"; }\n    void meow() { std::cout &lt;&lt; \"used\\n\"; }\n    ~foo() { std::cout &lt;&lt; \"destroyed\\n\"; }\n};\nvoid doGlobalSetup() { std::cout &lt;&lt; \"Global setup\\n\"; }\n\n\n//Actual implementation\nnamespace {\n    typename std::aligned_storage&lt;sizeof(foo), alignof(foo)&gt;::type bar;\n}\nfoo&amp; instance = reinterpret_cast&lt;foo&amp;&gt;(bar);\n\n//Allows automatic creation and destruction\nstruct initializer\n{\n    initializer()\n    {\n        if (!initialized)\n            new (&amp;instance) foo();\n        initialized = true;\n    }\n    ~initializer()\n    {\n        if(initialized)\n            instance.~foo();\n        initialized = false;\n    }\n    private:\n        static bool initialized;\n};\nbool initializer::initialized = false;\n\nint main()\n{\n    doGlobalSetup();\n    initializer _;\n    instance.meow();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "is_accepted": false, "score": 2, "last_activity_date": 1450890691, "last_edit_date": 1450890691, "creation_date": 1450887030, "answer_id": 34439628, "question_id": 34439233, "link": "https://stackoverflow.com/questions/34439233/deferring-c-static-object-construction-gcc-on-linux/34439628#34439628", "title": "Deferring C++ static object construction - GCC on Linux", "body": "<p>Use a static variable inside a function.</p>\n\n<pre><code>MyClass &amp;myInstance() {\n   doGlobalSetup();\n   static MyClass myInstance(1,2,3);\n   return myInstance;\n}\n\nvoid func() {\n   myInstance().doSomething();\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 10308, "user_id": 1738915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/YXjto.jpg?s=128&g=1", "display_name": "Kolban", "link": "https://stackoverflow.com/users/1738915/kolban"}, "edited": false, "score": 0, "creation_date": 1450889018, "post_id": 34439878, "comment_id": 56621357, "body": "Errr ... NO this is EXACTLY what I was looking for.  In my real-world puzzle, I happen not to have control over actually calling doGlobalSetup().   Imagine I am working in a framework where I have to write a C++ function that has a well known name.  In my C++ function, I have the global state class instance.  When I link my C++ function with the framework, the global class object is intantiated before the framework is ready and before my linked in user code function is given control."}], "tags": [], "owner": {"reputation": 7447, "user_id": 602372, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/q6bLu.jpg?s=128&g=1", "display_name": "Yam Marcovic", "link": "https://stackoverflow.com/users/602372/yam-marcovic"}, "is_accepted": false, "score": 1, "last_activity_date": 1450892104, "last_edit_date": 1450892104, "creation_date": 1450887844, "answer_id": 34439878, "question_id": 34439233, "link": "https://stackoverflow.com/questions/34439233/deferring-c-static-object-construction-gcc-on-linux/34439878#34439878", "title": "Deferring C++ static object construction - GCC on Linux", "body": "<p>You probably already got the answer you wanted. But just to cover the whole spectrum: if, for some reason, you want to make sure that other places in the code don't accidentally construct MyClass independently of your global variable--and before the global setup has been made--you need to solve this with linking.</p>\n\n<p>If you're on Linux, you can LD_PRELOAD a shared-object containing just the symbol for MyClass's constructor. In it, you declare the setup function accordingly, and let the dynamic linker do the job for you. Then, inside the constructor, you call the setup function, and then do a <code>dlsym(\"...\", RTLD_NEXT)</code> to get the pointer to the original constructor, and you call it, passing it the arguments you got. Of course, you maintain and check a static flag for whether setup has already been performed.</p>\n\n<p>Again, this is probably overkill for you, but I'm posting it just in case someone needs (and is able to use) this kind of solution.</p>\n\n<p>P.S. This is what you get when you rely on global state! :)</p>\n"}, {"tags": [], "owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1450902058, "creation_date": 1450902058, "answer_id": 34443118, "question_id": 34439233, "link": "https://stackoverflow.com/questions/34439233/deferring-c-static-object-construction-gcc-on-linux/34443118#34443118", "title": "Deferring C++ static object construction - GCC on Linux", "body": "<p>First, bear in mind that given a library init function like <code>doGlobalSetup</code> there is a distinct nonzero chance the library <em>will just not work</em> if you create a global instance.</p>\n\n<p>Otherwise it's super easy to create an initializer with the comma operator:</p>\n\n<pre><code>bool do_my_setup = (doGlobalSetup(), true);\nMyClass myInstance(1,2,3);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10308, "user_id": 1738915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/YXjto.jpg?s=128&g=1", "display_name": "Kolban", "link": "https://stackoverflow.com/users/1738915/kolban"}, "is_accepted": true, "score": 0, "last_activity_date": 1450950320, "creation_date": 1450950320, "answer_id": 34450672, "question_id": 34439233, "link": "https://stackoverflow.com/questions/34439233/deferring-c-static-object-construction-gcc-on-linux/34450672#34450672", "title": "Deferring C++ static object construction - GCC on Linux", "body": "<p>Within the GCC compiler environment there is a function attribute capability called <code>constructor</code>.  This allows us to flag a function definition with the ability for it to be automatically invoked <strong>before</strong> main is called and, most importantly <strong>before</strong> any class constructors are invoked.</p>\n\n<p>Referring back to the original problem definition ... if the <code>doGlobalSetup()</code> function is modified from:</p>\n\n<pre><code>void doGlobalSetup() { ... }\n</code></pre>\n\n<p>to</p>\n\n<pre><code>__attribute__((constructor)) void doGlobalSetup() { ... }\n</code></pre>\n\n<p>then its invocation will occur before main is called and <em>also</em> before any static class instance constructors are called.  The explicit call to this function would also be removed from main() as its work has been performed implicitly.</p>\n"}], "owner": {"reputation": 10308, "user_id": 1738915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/YXjto.jpg?s=128&g=1", "display_name": "Kolban", "link": "https://stackoverflow.com/users/1738915/kolban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 702, "favorite_count": 0, "accepted_answer_id": 34450672, "answer_count": 7, "score": 8, "last_activity_date": 1570042905, "creation_date": 1450885715, "last_edit_date": 1450887002, "question_id": 34439233, "link": "https://stackoverflow.com/questions/34439233/deferring-c-static-object-construction-gcc-on-linux", "title": "Deferring C++ static object construction - GCC on Linux", "body": "<p>Imagine I have a C++ class called <code>MyClass</code>.</p>\n\n<p>Imagine that I have no access to the source code of <code>MyClass</code> ... it is contained in a library and I am supplied only the library and the header file for <code>MyClass</code>.</p>\n\n<p>Imagine that the class itself requires environment pre-configuration ... for example ... before the constructor of the class can be called, I need to do some setup.   The class is normally meant to be used as follows:</p>\n\n<pre><code>void func() {\n   doGlobalSetup();\n   MyClass myInstance(1,2,3);\n   myInstance.doSomething();\n   ...\n}\n</code></pre>\n\n<p>Now I have the situation where we need to create a global instance of the class such as:</p>\n\n<pre><code>MyClass myInstance(1,2,3);\n\nint main(int argc, char *argv[]) {\n   doGlobalSetup();\n   myInstance.doSomething();\n}\n</code></pre>\n\n<p>The problem is that in this story, the instance of <code>MyClass</code> is created <strong>before</strong> the call to <code>doGlobalSetup()</code>.  It is instantiated before <code>main()</code> is called.  What I want to do is either defer the creation of <code>myInstance()</code>  till later <strong>or</strong> be able to run <code>doGlobalSetup()</code> somehow before the instantiation of the class.</p>\n\n<p>This is a simplification of the actual story ... so let us assume:</p>\n\n<ol>\n<li>I can't change the internals of <code>MyClass</code>.</li>\n<li>There must be an instance variable called <code>myInstance</code> of type <code>MyClass</code> (I can't change the logic to <code>MyClass *pMyInstance</code>).</li>\n</ol>\n\n<p>Many thanks for reading.</p>\n"}, {"tags": ["c++", "opencv", "integer", "unsigned"], "comments": [{"owner": {"reputation": 12286, "user_id": 1607442, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/18451ad16ed8ad45b0a18bf70b2aa002?s=128&d=identicon&r=PG", "display_name": "Ivan Aksamentov - Drop", "link": "https://stackoverflow.com/users/1607442/ivan-aksamentov-drop"}, "edited": false, "score": 0, "creation_date": 1450885887, "post_id": 34439055, "comment_id": 56619419, "body": "There is a question on opencv.org: <a href=\"http://answers.opencv.org/question/66230/is-there-a-reason-why-opencv-does-not-support-cv_32u-32-bit-depth-unsigned-integer-mat/\" rel=\"nofollow noreferrer\">Is there a reason why OpenCV does not support (CV_32U) 32 bit depth unsigned integer Mat?</a> and no answer. Maybe they just forgot?"}], "owner": {"reputation": 8115, "user_id": 369009, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/001cc37902a582ddb930a1ab817517bc?s=128&d=identicon&r=PG", "display_name": "Jan R&#252;egg", "link": "https://stackoverflow.com/users/369009/jan-r%c3%bcegg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "closed_date": 1450886107, "answer_count": 0, "score": 2, "last_activity_date": 1450885133, "creation_date": 1450885133, "question_id": 34439055, "link": "https://stackoverflow.com/questions/34439055/why-is-there-no-cv-32u", "closed_reason": "Duplicate", "title": "Why is there no CV_32U?", "body": "<p>Why is no 32bit unsigned integer datatype defined in OpenCV?</p>\n\n<p>There exists an 8 and 16-bit unsigned datatype: <code>CV_8U</code> and <code>CV_16U</code></p>\n\n<p>As well as a 32bit signed datatype: <code>CV_32S</code></p>\n"}, {"tags": ["c++", "tensorflow"], "answers": [{"tags": [], "owner": {"reputation": 119710, "user_id": 3574081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LIW6C.jpg?s=128&g=1", "display_name": "mrry", "link": "https://stackoverflow.com/users/3574081/mrry"}, "is_accepted": true, "score": 4, "last_activity_date": 1456494953, "last_edit_date": 1456494953, "creation_date": 1450890619, "answer_id": 34440598, "question_id": 34439045, "link": "https://stackoverflow.com/questions/34439045/tensorflow-setup-for-distributed-computing/34440598#34440598", "title": "Tensorflow Setup for Distributed Computing", "body": "<p>The open-source version (currently 0.6.0) of TensorFlow supports single-process execution only: in particular, the only valid target in the <code>tensorflow::SessionOptions</code> is the empty string, which means \"current process.\"</p>\n\n<p>The <a href=\"http://download.tensorflow.org/paper/whitepaper2015.pdf\" rel=\"nofollow\">TensorFlow whitepaper</a> describes the structure of the distributed implementation (see Figure 3) that we use inside Google. The basic idea is that the Session interface can be implemented using RPC to a <em>master</em>; and the master can partition the computation across a set of devices in multiple <em>worker</em> processes, which also communicate using RPC. Alas, the current version depends heavily on Google-internal technologies (like <a href=\"http://static.googleusercontent.com/media/research.google.com/en//pubs/archive/43438.pdf\" rel=\"nofollow\">Borg</a>), so a lot of work remains to make it ready for external consumption. We are currently working on this, and you can follow the progress on <a href=\"https://github.com/tensorflow/tensorflow/issues/23\" rel=\"nofollow\">this GitHub issue</a>.</p>\n\n<p><strong>EDIT on 2/26/2016:</strong> Today we released an <a href=\"https://github.com/tensorflow/tensorflow/tree/master/tensorflow/core/distributed_runtime\" rel=\"nofollow\">initial version of the distributed runtime</a> to GitHub. It supports multiple machines and multiple GPUs.</p>\n"}], "owner": {"reputation": 1012, "user_id": 1971872, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19441d76ff348bce73a9f7e408144a91?s=128&d=identicon&r=PG", "display_name": "SystemFun", "link": "https://stackoverflow.com/users/1971872/systemfun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1018, "favorite_count": 1, "accepted_answer_id": 34440598, "answer_count": 1, "score": 3, "last_activity_date": 1456494953, "creation_date": 1450885104, "question_id": 34439045, "link": "https://stackoverflow.com/questions/34439045/tensorflow-setup-for-distributed-computing", "title": "Tensorflow Setup for Distributed Computing", "body": "<p>Can anyone provide guidance on how to setup tensorflow to work on many CPUs across a network? All of the examples I have found thus far use only one local box and multi-gpus at best. I have found that I can pass in a list of targets in the session_opts, but I'm not sure how to setup tensorflow on each box to listen for networked nodes/tasks. Any example would be greatly appreciated!</p>\n"}, {"tags": ["c++", "fopen", "cstdio"], "comments": [{"owner": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "edited": false, "score": 1, "creation_date": 1450885192, "post_id": 34438998, "comment_id": 56618958, "body": "Could you try <code>fseek(file, 0L, SEEK_END);</code> and <code>size = ftell(file);</code> instead of only <code>int size = fseek(file, 0, SEEK_END);</code>? In order to rewind, could you try <code>fseek(file, 0L, SEEK_SET);</code>"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1450885276, "post_id": 34438998, "comment_id": 56619012, "body": "How do you call <code>tagFile</code>?"}, {"owner": {"reputation": 10784, "user_id": 620863, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-Mqgo9PO_taA/AAAAAAAAAAI/AAAAAAAAABM/8h3wY8pcFbg/photo.jpg?sz=128", "display_name": "Anne Quinn", "link": "https://stackoverflow.com/users/620863/anne-quinn"}, "edited": false, "score": 1, "creation_date": 1450885701, "post_id": 34438998, "comment_id": 56619285, "body": "I feel like a total fool... the problem was a lot simpler than I thought.  <code>feof(file)</code> should be <code>feof(file) == 0</code>  the things you spot 2 minutes after asking... thank you for the help though!"}, {"owner": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "edited": false, "score": 1, "creation_date": 1450886390, "post_id": 34438998, "comment_id": 56619732, "body": "Oh, God. I missed that part. You can still use !feof(file) (that&#39;s the way I use it)."}], "answers": [{"tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 0, "last_activity_date": 1450885412, "creation_date": 1450885412, "answer_id": 34439143, "question_id": 34438998, "link": "https://stackoverflow.com/questions/34438998/c-fopen-returns-handle-to-empty-file/34439143#34439143", "title": "C++: fopen() returns handle to empty file", "body": "<p>The most common cause of this is simply opening a file which is empty. There are no bytes to read so EOF is immediate, but the file exists so <code>fopen</code> can't return NULL.</p>\n"}], "owner": {"reputation": 10784, "user_id": 620863, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-Mqgo9PO_taA/AAAAAAAAAAI/AAAAAAAAABM/8h3wY8pcFbg/photo.jpg?sz=128", "display_name": "Anne Quinn", "link": "https://stackoverflow.com/users/620863/anne-quinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1468, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1450885412, "creation_date": 1450884945, "question_id": 34438998, "link": "https://stackoverflow.com/questions/34438998/c-fopen-returns-handle-to-empty-file", "title": "C++: fopen() returns handle to empty file", "body": "<p>I'm getting a strange file handle from <code>fopen</code>; the pointer itself isn't NULL, but the file it represents has no size, and <code>feof(file)</code> is already set...  what could be causing this?</p>\n\n<p>(I triple checked the file itself, it exists, has data, and the file's permissions are okay... and <code>filename</code> is set to \"source/test_file.object.txt\")</p>\n\n<pre><code>bool tagFile(const char * filename){\n    FILE * file = fopen(filename, \"r\");\n    if(file == NULL){                        // file is not NULL\n        printf(\"   Couldn't open the file %s\", filename);\n        return false;\n    }\n    int size = fseek(file, 0, SEEK_END); // size is 0\n    rewind(file);\n    while(feof(file)){\n\n        ....  // never executes because feof(file) fails\n    }\n}\n0x002cc410  // value of 'file' in the debugger\n    _ptr=0x00000000 &lt;Bad Ptr&gt; \n    _cnt=0 \n    _base=0x00000000 &lt;Bad Ptr&gt;\n    _flag = 1\n    _file = 3\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "class", "this", "derived-class"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1450885081, "post_id": 34438946, "comment_id": 56618873, "body": "Make the functions you intend to override <b>virtual</b>. C++ doesn&#39;t do dynamic binding by default."}, {"owner": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1450885138, "post_id": 34438946, "comment_id": 56618913, "body": "@StoryTeller sorry, they are virtual in the base class. I edited the question."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1450885409, "post_id": 34438946, "comment_id": 56619103, "body": "Okay, than. Do you have a join operation someplace towards the end of main?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 2, "creation_date": 1450885517, "post_id": 34438946, "comment_id": 56619169, "body": "Your failure to actually post the code you are working on, and then editing in changes, removes any faith I have that the code above will reproduce your problem.  Can you produce an actual <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> and test it yourself to confirm it produces the effect you are discussing?  Then post that MCVE?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1450885619, "post_id": 34438946, "comment_id": 56619224, "body": "Well the only thing I see in your snippets is that <code>otherThreadClass</code> doesn&#39;t override <code>main()</code>, so naturally <code>Thread::main</code> is called. You can catch such errors at compile time by making <code>main</code> pure virtual."}, {"owner": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1450885773, "post_id": 34438946, "comment_id": 56619329, "body": "@StoryTeller ok I see this is confusing. I will return with a MCVE example as Yakk suggested."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1450885919, "post_id": 34438946, "comment_id": 56619436, "body": "I bet <code>otherThreadClass::main()</code> signature does not match parent. There are enough ways to prevent such errors in C++ - pure virtual, override, and use <code>std::thread</code> instead of <code>pthread</code>"}, {"owner": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1450887883, "post_id": 34438946, "comment_id": 56620640, "body": "@Slava nope this is not it."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1450887982, "post_id": 34438946, "comment_id": 56620711, "body": "@nass then just make <code>Thread::main()</code> pure virtual and see what compiler will tell you. It should be pure virtual anyway."}, {"owner": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1450890326, "post_id": 34438946, "comment_id": 56622157, "body": "@Slava please see this question for a clear case of what is going on <a href=\"http://stackoverflow.com/questions/34440316/c-pthread-and-static-callbacks-this-returns-a-pointer-to-the-base-class-i?noredirect=1#comment56621947_34440316\" title=\"c pthread and static callbacks this returns a pointer to the base class i\">stackoverflow.com/questions/34440316/&hellip;</a>"}, {"owner": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1450890362, "post_id": 34438946, "comment_id": 56622176, "body": "@StoryTeller ok Here is the MCVE <a href=\"http://stackoverflow.com/questions/34440316/c-pthread-and-static-callbacks-this-returns-a-pointer-to-the-base-class-i?noredirect=1#comment56621947_34440316\" title=\"c pthread and static callbacks this returns a pointer to the base class i\">stackoverflow.com/questions/34440316/&hellip;</a>"}, {"owner": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1450890386, "post_id": 34438946, "comment_id": 56622189, "body": "@Yakk this may be easier to follow through and test <a href=\"http://stackoverflow.com/questions/34440316/c-pthread-and-static-callbacks-this-returns-a-pointer-to-the-base-class-i?noredirect=1#comment56621947_34440316\" title=\"c pthread and static callbacks this returns a pointer to the base class i\">stackoverflow.com/questions/34440316/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "edited": false, "score": 0, "creation_date": 1450887922, "post_id": 34439522, "comment_id": 56620669, "body": "main is virtual. I wish that would have been the solution :)"}, {"owner": {"reputation": 905, "user_id": 5170218, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e746d5acb1323eea69830a11b4a12ef2?s=128&d=identicon&r=PG&f=1", "display_name": "SACHIN GOYAL", "link": "https://stackoverflow.com/users/5170218/sachin-goyal"}, "reply_to_user": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "edited": false, "score": 0, "creation_date": 1450889472, "post_id": 34439522, "comment_id": 56621639, "body": "@ nass : did you even try to run the program as i got desired output ?In my program it will call the main function of other class .check it again !"}, {"owner": {"reputation": 905, "user_id": 5170218, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e746d5acb1323eea69830a11b4a12ef2?s=128&d=identicon&r=PG&f=1", "display_name": "SACHIN GOYAL", "link": "https://stackoverflow.com/users/5170218/sachin-goyal"}, "reply_to_user": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "edited": false, "score": 0, "creation_date": 1450889854, "post_id": 34439522, "comment_id": 56621880, "body": "@nass: To sum up , if main is virtual ..derived class version will be called(if object is of dervied type ) .If main is not virtual , always base class version will get called .If main is virtual in your code then there is no way by which base class version of &quot;main&quot; would be called using derived object .double check it .If you are still facing problem ,paste your code here."}, {"owner": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "edited": false, "score": 0, "creation_date": 1450890291, "post_id": 34439522, "comment_id": 56622140, "body": "hi there, which compiler are you using , <code>g++</code>? Thank you for wanting to help. Here is a clear example of what is going on. Perhaps you can pin point the problem in this one?  <a href=\"http://stackoverflow.com/questions/34440316/c-pthread-and-static-callbacks-this-returns-a-pointer-to-the-base-class-i?noredirect=1#comment56621947_34440316\" title=\"c pthread and static callbacks this returns a pointer to the base class i\">stackoverflow.com/questions/34440316/&hellip;</a>"}, {"owner": {"reputation": 905, "user_id": 5170218, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e746d5acb1323eea69830a11b4a12ef2?s=128&d=identicon&r=PG&f=1", "display_name": "SACHIN GOYAL", "link": "https://stackoverflow.com/users/5170218/sachin-goyal"}, "reply_to_user": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "edited": false, "score": 0, "creation_date": 1450890388, "post_id": 34439522, "comment_id": 56622191, "body": "@nass : yes nass , I am using g++ and code is working fine on g++ and i believe it should work fine on other compilers too :) .Ok let me check the link"}, {"owner": {"reputation": 905, "user_id": 5170218, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e746d5acb1323eea69830a11b4a12ef2?s=128&d=identicon&r=PG&f=1", "display_name": "SACHIN GOYAL", "link": "https://stackoverflow.com/users/5170218/sachin-goyal"}, "reply_to_user": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "edited": false, "score": 0, "creation_date": 1450891831, "post_id": 34439522, "comment_id": 56622996, "body": "@nass:just edited the complete working example .hope it will help :)"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1450891932, "post_id": 34439522, "comment_id": 56623041, "body": "@SACHINGOYAL, <code>sleep</code> is no alternative at all to a proper thread join operation. This is unsafe still."}, {"owner": {"reputation": 905, "user_id": 5170218, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e746d5acb1323eea69830a11b4a12ef2?s=128&d=identicon&r=PG&f=1", "display_name": "SACHIN GOYAL", "link": "https://stackoverflow.com/users/5170218/sachin-goyal"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1450892061, "post_id": 34439522, "comment_id": 56623107, "body": "@StoryTeller: Agree .The idea was to keep main thread on wait for some time such that other thread can do its work .&quot;pthread_join&quot; is anyway a far better option ."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1450892497, "post_id": 34439522, "comment_id": 56623366, "body": "I&#39;m glad you concur, but your example code is still an anti-pattern. It makes the answer bad for any novice that reads it."}], "tags": [], "owner": {"reputation": 905, "user_id": 5170218, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e746d5acb1323eea69830a11b4a12ef2?s=128&d=identicon&r=PG&f=1", "display_name": "SACHIN GOYAL", "link": "https://stackoverflow.com/users/5170218/sachin-goyal"}, "is_accepted": false, "score": 0, "last_activity_date": 1450891737, "last_edit_date": 1450891737, "creation_date": 1450886622, "answer_id": 34439522, "question_id": 34438946, "link": "https://stackoverflow.com/questions/34438946/c-pthread-and-static-callbacks-this-returns-a-pointer-to-the-base-class-i/34439522#34439522", "title": "c++ , pthread and static callbacks. &quot;this&quot; returns a pointer to the base class inctead of the derived one", "body": "<p>If you will try to call a function using base class ptr , everytime base class version gets called as long as function is not virtual .\nso simpler solution to your problem would be to make main virtual as below :</p>\n\n<pre><code>  #include &lt;iostream&gt;\n#include&lt;pthread.h&gt;\n#include&lt;unistd.h?\nusing namespace std;\nvoid* callback(void* obj);\nclass Thread {\npublic:\n  virtual  int main()\n    {\n        cout &lt;&lt; \"Hi there Base class\" &lt;&lt; endl;\n        return(0);\n    }\n\n    void run()\n    {\n        pthread_create(&amp;thread, 0, &amp;callback, this);\n    }\n\n    pthread_t thread;\n};\n\nclass otherThreadClass : public Thread{\npublic:\nvirtual  int main()\n    {\n        cout &lt;&lt; \"Hi there other class\" &lt;&lt; endl;\n        return(0);\n    }\n\n\n   void writeToDiskAsync(string str){\n\n\n       //spawn a thread to carry the write without blocking execution\n       run();\n    }\n};\n\nclass Thread;\nvoid* callback(void* obj)\n{\n    static_cast&lt;Thread*&gt;(obj)-&gt;main();\n    return(0);\n} // callback\n\n\nint main() {\n    // your code goes here\n    otherThreadClass thr;\n    thr.writeToDiskAsync(string(\"aS\"));\nsleep(10);//it is neccessary as main thread can exit before .\n    return 0;\n}\noutput : Hi there other class\n</code></pre>\n\n<p>Whereas if main is not virtual , it will always call base class version of main as you are calling through a base class ptr (static binding will happen )</p>\n"}], "owner": {"reputation": 1271, "user_id": 959179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/695402d9a3f42056c84787ef2c944496?s=128&d=identicon&r=PG", "display_name": "nass", "link": "https://stackoverflow.com/users/959179/nass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 660, "favorite_count": 0, "closed_date": 1450890815, "answer_count": 1, "score": 0, "last_activity_date": 1450891737, "creation_date": 1450884793, "last_edit_date": 1450885183, "question_id": 34438946, "link": "https://stackoverflow.com/questions/34438946/c-pthread-and-static-callbacks-this-returns-a-pointer-to-the-base-class-i", "closed_reason": "Duplicate", "title": "c++ , pthread and static callbacks. &quot;this&quot; returns a pointer to the base class inctead of the derived one", "body": "<p>I am using as basis <a href=\"http://ubuntuforums.org/archive/index.php/t-169477.html\" rel=\"nofollow\">this</a> cpp thread class. This I use as a base class for threads. Note that in my case Thread::main() is  a virtual function (unlike in the link). So I basically use:</p>\n\n<pre><code>class Thread {\npublic:\n    virtual void main()\n    {\n        cout &lt;&lt; \"This should not be run once derived and redefined.\" &lt;&lt; endl;\n    }\n\n    void run()\n    {\n        pthread_create(&amp;thread, 0, &amp;callback, this);\n    }\n\n    pthread_t thread;\n}; // class Thread\n\n\nvoid* callback(void* obj)\n{\n    static_cast&lt;Thread*&gt;(obj)-&gt;main();\n    return(0);\n} // callback\n</code></pre>\n\n<p>Then I create a derived class and re-define the <code>myThreadedClass::main()</code> member to actually do something meaningful.</p>\n\n<p>Finally, I instantiate the myThreadedClass object from other classes or my main function call as follows:</p>\n\n<pre><code>main(int argc, char** argv){\n    myThreadedClass thr;\n    thr.run();\n\n    //do other stuff\n}\n</code></pre>\n\n<p>This works fine; The callback function gets a pointer to the derived class instantiation, so the <code>myThreadedClass::main()</code> gets executed.</p>\n\n<p>However, I now try to create a different derived class <code>class otherThreadClass : public Thread</code>. Again I re-define my <code>otherThreadClass::main()</code> , but now I have a member function in the derived class which (unlike before) calls Thread::run().</p>\n\n<pre><code>class otherThreadClass : public Thread{\npublic:\n    writeToDiskAsync(string&amp; str){\n       prepareString(str);\n\n       //spawn a thread to carry the write without blocking execution\n       run();\n    }\n};\n</code></pre>\n\n<p>in this case from my main function I do</p>\n\n<pre><code>main(int argc, char** argv){\n    otherThreadClass thr;\n    thr.writeToDiskAsync(aString);\n\n    //do other stuff\n}\n</code></pre>\n\n<p>The problem in this case is that the callback function gets a pointer to the Thread class and the Thread::main() ends up being executed instead of the otherThreadClass::main().</p>\n\n<p>I tried passing a pointer to the instantiated myThreadedClass object during instantiation (using initialisation lists and an altered call to Thread::run(void* instance)) as follows</p>\n\n<pre><code>//in main function\notherThreadClass thr(&amp;thr);\n\n//in class\notherThreadClass::otherThreadClass(otherThreadClass* ptr):instancePtr(ptr)\n{}\n\notherThreadClass::writeToDiskAsync(string&amp; str)\n{\n    //do stuff\n    run(instancePtr);\n}\n\n//and finally\n\nThread::run(void* parentObj)\n{\n    pthread_create(&amp;thread, 0, &amp;callback, parentObj);\n}\n</code></pre>\n\n<p>but it does not work. And I think this is probably not a nice way to do it anyway. So what can I do to let the callback function get apointer to the derived class instance instead of the base class ?</p>\n\n<p>thank you</p>\n"}, {"tags": ["c++", "mpi", "contiguous"], "answers": [{"comments": [{"owner": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "edited": false, "score": 0, "creation_date": 1450887546, "post_id": 34439598, "comment_id": 56620436, "body": "<code>M</code> is contiguous but I would like to make number of <code>face.M</code>s to be contiguous to send/receive as a bunch instead of doing that one by one."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "edited": false, "score": 0, "creation_date": 1450887742, "post_id": 34439598, "comment_id": 56620540, "body": "At least as of C++03, <a href=\"http://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\"><code>std::vector</code> is also guaranteed to be contiguous</a>: &quot;The elements are stored contiguously, which means that elements can be accessed not only through iterators, but also using offsets on regular pointers to elements. This means that a pointer to an element of a vector may be passed to any function that expects a pointer to an element of an array.&quot; So the only reason the <code>M</code>s wouldn&#39;t be contiguous is if the structure required padding for alignment related reasons (which seems unlikely given the design)."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "edited": false, "score": 0, "creation_date": 1450887902, "post_id": 34439598, "comment_id": 56620655, "body": "@Shibli: Since the <code>std::vector</code> stores the elements in line, you&#39;ve got contiguous <code>vector</code> of contiguous <code>struct</code> of contiguous <code>array</code> of contiguous <code>Matrixd</code>. You&#39;re already golden (just don&#39;t change the vector&#39;s size or call <code>reserve</code> when you&#39;re using the values in it, or a reallocation could invalidate pointers into the <code>vector</code>). You&#39;d only lose contiguous behavior if the <code>vector</code> stored <code>Face*</code> or <code>Face&amp;</code> instead of actual <code>Face</code>."}, {"owner": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "edited": false, "score": 0, "creation_date": 1450888256, "post_id": 34439598, "comment_id": 56620893, "body": "So when I use say <code>MPI_Send,</code> if I give pointer to <code>face[0].M[0][0][0]</code> as a parameter and give number of elements as another parameter etc., will the function work fine?"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "edited": false, "score": 0, "creation_date": 1450888375, "post_id": 34439598, "comment_id": 56620964, "body": "@Shibli: Again, alignment/padding issues could occur, so you need to compute the number of bytes to transfer in terms of the compile time calculated size of a single <code>Face</code>, but if you pass <code>&amp;face[0].M[0][0][0]</code> and a length of <code>numelements * sizeof(face[0])</code> or whatever, that should take care of that. Heck, passing <code>&amp;face[0]</code> should work, no need for <code>.M[0][0][0]</code>."}, {"owner": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "edited": false, "score": 0, "creation_date": 1450903915, "post_id": 34439598, "comment_id": 56628762, "body": "I don&#39;t resize <code>face</code> later so if understood correctly passing <code>face[0].M</code> should suffice. Also, if struct <code>Face</code> has more members and <code>M</code> is not the first one then passing <code>&amp;face[0]</code> would NOT work, right?"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "edited": false, "score": 0, "creation_date": 1450904193, "post_id": 34439598, "comment_id": 56628880, "body": "If <code>Face</code> is just the <code>std::array</code> as described (no virtual methods or other members), then <code>&amp;face[0]</code> and <code>&amp;face[0].M</code> are equivalent. If it has other members, or has virtual methods, then no, it won&#39;t work."}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 1, "last_activity_date": 1450886903, "creation_date": 1450886903, "answer_id": 34439598, "question_id": 34438799, "link": "https://stackoverflow.com/questions/34438799/efficient-way-of-making-data-contiguous-to-transfer-it-among-nodes/34439598#34439598", "title": "Efficient way of making data contiguous to transfer it among nodes", "body": "<p>A true 2D array in C/C++, e.g. <code>int foo[5][5]</code> is already contiguous in memory; it's basically just syntactic sugar for <code>int foo[25]</code> where accesses like <code>foo[3][2]</code> implicitly look up <code>foo[3*5 + 2]</code> in the flat equivalent. Switching to a <code>Matrixd</code> defined in a single dimension won't change the actual memory layout.</p>\n\n<p><code>std::array</code> is (mostly) just a wrapper for C-style arrays as well; with no virtual members, and compile time defined size with no internal pointers (just the raw array), it's also going to be contiguous. I strongly suspect if you checked the assembly produced, you'd find that the <code>array</code> of <code>Matrixd</code>s is already contiguous.</p>\n\n<p>In short, I don't think you need to change anything; you're already contiguous, so MPI should be fine.</p>\n"}], "owner": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 34439598, "answer_count": 1, "score": 1, "last_activity_date": 1450886903, "creation_date": 1450884272, "question_id": 34438799, "link": "https://stackoverflow.com/questions/34438799/efficient-way-of-making-data-contiguous-to-transfer-it-among-nodes", "title": "Efficient way of making data contiguous to transfer it among nodes", "body": "<pre><code>struct Face\n{\n    // Matrixd is 1D representation of 2D matrix\n    std::array &lt; Matrixd&lt;5,5&gt;, 2 &gt; M;\n};\n\nstd::vector &lt;Face&gt; face;\n</code></pre>\n\n<p>I have a distributed for-loop among nodes. After all nodes finish working on their elements I would like to transfer corresponding elements among nodes. But AFAIK to use <code>MPI_Allgatherv</code> the data should be contiguous. First of all, I switched to 1D representation of 2D matrices (I was using [][] notation before). Now I want to make <code>face.M</code> to be contiguous. I am thinking to copy all elements of say, M[0] to an <code>std::array</code> an transfer that among nodes. Is this way efficient? To give an idea of number of data I work with, if I have 20k cells, at maximum I have 20k*3=60k faces. I might have a million of cells, too.</p>\n"}, {"tags": ["c++", "visual-studio", "memory-dump"], "comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 2, "creation_date": 1450882962, "post_id": 34438360, "comment_id": 56617608, "body": "What is the specific failure you are getting?  A symbol mismatch?"}], "owner": {"reputation": 749, "user_id": 489955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a24808c7c90a549ed4e760215463494?s=128&d=identicon&r=PG", "display_name": "CodeVomit", "link": "https://stackoverflow.com/users/489955/codevomit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1450882737, "creation_date": 1450882737, "question_id": 34438360, "link": "https://stackoverflow.com/questions/34438360/signing-our-executable-seems-to-makes-any-memory-dump-from-a-customer-crash-usel", "title": "Signing our executable seems to makes any memory dump from a customer crash useless to us", "body": "<p>We've been getting memory dumps that are unusable, despite storing the pdb for those particular builds we cannot view the call stack. We have tested that our pdb files work do work, but they cease to work after the executable has been signed. Is there anyway of remedy this?</p>\n"}, {"tags": ["c++", "makefile", "cmake"], "answers": [{"tags": [], "owner": {"reputation": 2533, "user_id": 2925287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/821554321/picture?type=large", "display_name": "Pierre Emmanuel Lallemant", "link": "https://stackoverflow.com/users/2925287/pierre-emmanuel-lallemant"}, "is_accepted": false, "score": 3, "last_activity_date": 1450883670, "creation_date": 1450883670, "answer_id": 34438627, "question_id": 34438357, "link": "https://stackoverflow.com/questions/34438357/cmake-one-build-directory-for-multiple-projects/34438627#34438627", "title": "CMake one build directory for multiple projects", "body": "<p>A) You can do 1 CMakeLists.txt for N projects. When you define a library, you can use it in an executable defined in the cmake (add_executable and  target_link_libraries to see).</p>\n\n<p>B) see target_include_directories</p>\n\n<p>C) it seems you can call <code>cmake --target target</code> to generate the Makefile for only one of the target of your cmakelists.txt file. </p>\n"}, {"comments": [{"owner": {"reputation": 13626, "user_id": 2697571, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cefd29d899fd6175ce401961e209a2a8?s=128&d=identicon&r=PG&f=1", "display_name": "Mendes", "link": "https://stackoverflow.com/users/2697571/mendes"}, "edited": false, "score": 0, "creation_date": 1450887544, "post_id": 34439276, "comment_id": 56620433, "body": "Sir, thanks for help... what if I need to generate the lib and bin files in the target foldert without needing to <code>make install</code> ?"}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "reply_to_user": {"reputation": 13626, "user_id": 2697571, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cefd29d899fd6175ce401961e209a2a8?s=128&d=identicon&r=PG&f=1", "display_name": "Mendes", "link": "https://stackoverflow.com/users/2697571/mendes"}, "edited": false, "score": 0, "creation_date": 1450887921, "post_id": 34439276, "comment_id": 56620668, "body": "While it is possible by using the <code>CMAKE_*_OUTPUT_DIRECTORY</code> variables, I wouldn&#39;t recommend doing this, because you may have several build directories with several configurations (Debug vs. Release, different compiler, etc) and it is always good to be able to test them in parallel without overwriting files when compiling. Why do you need bin/lib at the root of your project ?"}, {"owner": {"reputation": 13626, "user_id": 2697571, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cefd29d899fd6175ce401961e209a2a8?s=128&d=identicon&r=PG&f=1", "display_name": "Mendes", "link": "https://stackoverflow.com/users/2697571/mendes"}, "edited": false, "score": 0, "creation_date": 1450889540, "post_id": 34439276, "comment_id": 56621677, "body": "Good point. <code>bin</code> is where all executables will be installed. `lib&#180; will hold all libraries."}, {"owner": {"reputation": 13626, "user_id": 2697571, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cefd29d899fd6175ce401961e209a2a8?s=128&d=identicon&r=PG&f=1", "display_name": "Mendes", "link": "https://stackoverflow.com/users/2697571/mendes"}, "edited": false, "score": 0, "creation_date": 1450901652, "post_id": 34439276, "comment_id": 56627754, "body": "<code>install (TARGETS projectA, projectB...</code> is issuing <code>install TARGETS given target &quot;projectA&quot; which does not exist in this   directory</code>... Not working because of the subdirectory"}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "reply_to_user": {"reputation": 13626, "user_id": 2697571, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cefd29d899fd6175ce401961e209a2a8?s=128&d=identicon&r=PG&f=1", "display_name": "Mendes", "link": "https://stackoverflow.com/users/2697571/mendes"}, "edited": false, "score": 0, "creation_date": 1450901907, "post_id": 34439276, "comment_id": 56627898, "body": "Does it work if you put one <code>install</code> call in each of the two specific CMakeLists.txt files right after declaring the target ?"}, {"owner": {"reputation": 13626, "user_id": 2697571, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cefd29d899fd6175ce401961e209a2a8?s=128&d=identicon&r=PG&f=1", "display_name": "Mendes", "link": "https://stackoverflow.com/users/2697571/mendes"}, "edited": false, "score": 0, "creation_date": 1450902330, "post_id": 34439276, "comment_id": 56628063, "body": "No. It seens not to recognize subdirectories: <a href=\"https://cmake.org/Bug/view.php?id=14444\" rel=\"nofollow noreferrer\">Check here</a>"}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "reply_to_user": {"reputation": 13626, "user_id": 2697571, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cefd29d899fd6175ce401961e209a2a8?s=128&d=identicon&r=PG&f=1", "display_name": "Mendes", "link": "https://stackoverflow.com/users/2697571/mendes"}, "edited": false, "score": 0, "creation_date": 1450902952, "post_id": 34439276, "comment_id": 56628321, "body": "well then, like I just said, put the install directives in each subdirectory :)"}], "tags": [], "owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "is_accepted": true, "score": 44, "last_activity_date": 1450903308, "last_edit_date": 1450903308, "creation_date": 1450885822, "answer_id": 34439276, "question_id": 34438357, "link": "https://stackoverflow.com/questions/34438357/cmake-one-build-directory-for-multiple-projects/34439276#34439276", "title": "CMake one build directory for multiple projects", "body": "<p>First of all, it doesn't look like the CMake code you posted belongs to the top CMakeList.txt file, since it directly references .cpp files, and \"projectA\".\nThere are also a few things that are not idiomatic:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.2.2.)\n</code></pre>\n\n<p>why the trailing dot here ? Not sure whether cmake will complain, but it is useless either way.</p>\n\n<pre><code>set(CMAKE_BUILD_TYPE Debug)\n</code></pre>\n\n<p>Don't do that. Instead invoke cmake using the <code>-DCMAKE_BUILD_TYPE=Debug</code> command line flag, or use ccmake, or a GUI, or edit the CMakeCache.txt file.</p>\n\n<pre><code>file(GLOB SOURCES \"*.cpp\")\n</code></pre>\n\n<p>Don't do that either. It is good practice to explicitely list source files in CMake, because globbing will not make cmake detect newly added or deleted files automatically. Some people might disagree though.</p>\n\n<p>Now for the heart of the topic, here is how things are usually done:</p>\n\n<p>Top CMakeLists.txt file:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.2.2)\nproject(globalProject)\n\nadd_subdirectory(projectA)\nadd_subdirectory(projectB)\n</code></pre>\n\n<p>ProjectA CMakeLists.txt file (assuming projectA is an executable):</p>\n\n<pre><code>add_executable(projectA file1.cpp file2.cpp ... )\ninclude_directories(${CMAKE_SOURCE_DIR}/projectB) # include files from ProjectB\ntarget_link_libraries(projectA projectB)\n\ninstall(TARGETS projectA RUNTIME DESTINATION bin)\n</code></pre>\n\n<p>ProjectB CMakeLists.txt file (assuming projectB is a library):</p>\n\n<pre><code>add_library(projectB file1.cpp file2.cpp ... )\n\ninstall(TARGETS projectB\n    LIBRARY DESTINATION lib\n    ARCHIVE DESTINATION lib)\n</code></pre>\n\n<p>Please note that this setup needs the <code>make install</code> step to create bin and lib at the location of your choice as given in the command line invocation of cmake <code>-DCMAKE_INSTALL_PREFIX=..</code> (assuming make is run from the build dir).</p>\n\n<p>Also, this setup lets you choose if you want to build static or shared libraries, by using: <code>-DBUILD_SHARED_LIBS=ON</code>. To build both, you need to have two <code>add_library</code> calls with two different names, one STATIC, the other SHARED.</p>\n\n<p>To sum up the steps required to make this work:</p>\n\n<pre><code>$ mkdir build &amp;&amp; cd build\n$ cmake .. -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX=.. -DBUILD_SHARED_LIBS=ON\n$ make\n$ make install\n</code></pre>\n\n<p>You could put these commands in a script for reusability.</p>\n\n<p>Now, your questions can be answered:</p>\n\n<p>A) it is possible and recommended, see the code above, only one build directory is necessary.</p>\n\n<p>B) See the code for the projectA/CMakeLists.txt, you have to call <code>include_directories()</code></p>\n\n<p>C) Yes it is possible. Each target in your project can be built individually from the build directory by using make and the target name: <code>make projectB</code> and <code>make projectA</code></p>\n"}], "owner": {"reputation": 13626, "user_id": 2697571, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cefd29d899fd6175ce401961e209a2a8?s=128&d=identicon&r=PG&f=1", "display_name": "Mendes", "link": "https://stackoverflow.com/users/2697571/mendes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34116, "favorite_count": 18, "accepted_answer_id": 34439276, "answer_count": 2, "score": 29, "last_activity_date": 1509037335, "creation_date": 1450882727, "last_edit_date": 1509037335, "question_id": 34438357, "link": "https://stackoverflow.com/questions/34438357/cmake-one-build-directory-for-multiple-projects", "title": "CMake one build directory for multiple projects", "body": "<p>I\u00b4m a beginner user of CMake. My environment has several projects like:</p>\n\n<pre><code>project\n  |------ CMakeLists.txt (The main Cmake)\n  |------ ProjectA\n  |          |----- .cpp files\n  |          |----- .hpp files\n  |          |----- CMakeList.txt\n  |------ ProjectB\n  |          |----- .cpp files\n  |          |----- .hpp files\n  |          |----- CMakeList.txt\n  | \n  |------ build\n  |         |-----  CMakeStuff\n  |------ bin\n  |        |---- executables\n  |------ lib\n  |        |---- libwhatever.a\n  |------ db \n           |---- Database stuff\n</code></pre>\n\n<p>I would like to use a single build directory for every project, as showed above. Preferrably that It can be divided into multiple subprojects, like <code>build/projectA</code>, <code>build/ProjectB</code> so that if I need to rebuild a single project I can delete the whole <code>build/Project</code> file and all is gone and a new <code>Cmake</code> will build it again.</p>\n\n<p>I\u00b4m having difficulties configuring CMAKE. </p>\n\n<p>My original CMakeList.txt on the project folder:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.2.2.)\nset(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/../lib)\nset(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/../lib)\nset(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/../bin)\n\nproject(projectA)\nset(CMAKE_BUILD_TYPE Debug)\n\nfile(GLOB SOURCES \"*.cpp\")\n\nadd_library(commonmessage SHARED ${SOURCES})\n\ninstall(TARGETS commonmessage DESTINATION ../lib)\n</code></pre>\n\n<p>My questions are: </p>\n\n<p>A) What will happen if I run cmake on a single build directory - is that possible and what would be the correct CMAKE configuration ?</p>\n\n<p>B) My compilation for <code>ProjectA</code> needs to include files from <code>ProjectB</code> - how can I set that in the <code>CMakeLists.txt</code> for each individual project ?</p>\n\n<p>C) At the end I need a single makefile to build all, as well as the option to build each project individually. Will that be possible with a single build directory ?</p>\n\n<p>Thanks for helping.</p>\n"}, {"tags": ["c++", "visual-studio", "visual-c++", "visual-studio-2013", "visual-studio-2015"], "comments": [{"owner": {"reputation": 13686, "user_id": 1663919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0abe37f1cd26ea99091568cf4edf448?s=128&d=identicon&r=PG", "display_name": "Zdeslav Vojkovic", "link": "https://stackoverflow.com/users/1663919/zdeslav-vojkovic"}, "edited": false, "score": 1, "creation_date": 1450882835, "post_id": 34438047, "comment_id": 56617524, "body": "Third party component was also built with debug settings (debug allocator)?"}, {"owner": {"reputation": 1009, "user_id": 1442731, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/32ff845da1e897b7c1f8b38f84824d2c?s=128&d=identicon&r=PG", "display_name": "wdtj", "link": "https://stackoverflow.com/users/1442731/wdtj"}, "reply_to_user": {"reputation": 13686, "user_id": 1663919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0abe37f1cd26ea99091568cf4edf448?s=128&d=identicon&r=PG", "display_name": "Zdeslav Vojkovic", "link": "https://stackoverflow.com/users/1663919/zdeslav-vojkovic"}, "edited": false, "score": 0, "creation_date": 1450893884, "post_id": 34438047, "comment_id": 56624080, "body": "Yes.  The issue was definitely due to the compiler mismatch, I ran through the code with the disassembler until I found the problem in the header.  I am aware of the problems when mixing Debug and Release code, that was the first thing I checked."}, {"owner": {"reputation": 6920, "user_id": 4394169, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aETL5.jpg?s=128&g=1", "display_name": "Vlad Feinstein", "link": "https://stackoverflow.com/users/4394169/vlad-feinstein"}, "edited": false, "score": 0, "creation_date": 1450901846, "post_id": 34438047, "comment_id": 56627857, "body": "Are you allocating memory on one module and freeing / reallocating it in another? Even with the same version of the compiler, how is it supposed to work?"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "reply_to_user": {"reputation": 6920, "user_id": 4394169, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aETL5.jpg?s=128&g=1", "display_name": "Vlad Feinstein", "link": "https://stackoverflow.com/users/4394169/vlad-feinstein"}, "edited": false, "score": 0, "creation_date": 1450912441, "post_id": 34438047, "comment_id": 56632161, "body": "@VladFeinstein It works if all modules use the same version and flavor of CRT DLL (as opposed to linking to CRT statically). Then, they all share the same heap manager."}, {"owner": {"reputation": 1009, "user_id": 1442731, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/32ff845da1e897b7c1f8b38f84824d2c?s=128&d=identicon&r=PG", "display_name": "wdtj", "link": "https://stackoverflow.com/users/1442731/wdtj"}, "edited": false, "score": 0, "creation_date": 1450924271, "post_id": 34438047, "comment_id": 56635035, "body": "Right, the question has to do with being able to verify that I have the right DLLs"}], "owner": {"reputation": 1009, "user_id": 1442731, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/32ff845da1e897b7c1f8b38f84824d2c?s=128&d=identicon&r=PG", "display_name": "wdtj", "link": "https://stackoverflow.com/users/1442731/wdtj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450882140, "creation_date": 1450881645, "question_id": 34438047, "link": "https://stackoverflow.com/questions/34438047/compiler-fingerprint-in-object", "title": "Compiler fingerprint in object", "body": "<p>I just spent the better part of a day trying to figure out why I was getting the error:</p>\n\n<blockquote>\n  <p>Expression: is_block_type_valid(header->_block_use)</p>\n</blockquote>\n\n<p>Turns out that one of my third party packages (Apache Log4CXX) was compiled with Visual Studio 2013 (VC120) and my application was compiled with Visual Studio 2015.  The build was accidentally pulling DLLs from the the wrong library.  </p>\n\n<p>The debug_heap uses a different format for the memory header between the two (thus the invalid _block_use) and bad things happen when you attempt to release memory.</p>\n\n<p>Now for the question, I know Java has the compiler's version number compiled into it's class files (yah Java).  Does Visual Studio mark it's object, lib or dll files with some sort of fingerprint that identified what version of Visual C++ compiled the file?</p>\n\n<p>I've tried dumping out the headers with dumpbin and objdump but nothing stands out as a compiler fingerprint.</p>\n"}, {"tags": ["c++", "flex-lexer", "openfoam"], "comments": [{"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 0, "creation_date": 1450882658, "post_id": 34438023, "comment_id": 56617432, "body": "I don&#39;t know anything about this version of flex but it seems <code>yyin</code> is a pointer. Try to use <code>yyin-&gt;rdbuf(std::cin.rdbuf());</code>."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1450883113, "post_id": 34438023, "comment_id": 56617696, "body": "On stackoverflow, <a href=\"http://stackoverflow.com/help/self-answer\">answering its own question is encouraged</a>, <a href=\"http://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/\">as long as you pretend you\u2019re on Jeopardy!</a> -- phrase it in the form of a question."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1450890718, "post_id": 34438023, "comment_id": 56622375, "body": "Really, it would be more effective to <a href=\"http://www.openfoam.org/bugs/\" rel=\"nofollow noreferrer\">report an OpenFOAM bug directly</a>; which might help get the problem fixed. It&#39;s possible that this question might help some potential openfoam user who is able to search StackOverflow for their problem, but there are probably many potential users who would miss it."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1480865915, "post_id": 34438023, "comment_id": 69129748, "body": "Thank you very much, this helped! (not for OpenFOAM btw. I had trouble with a completely unrelated package)"}, {"owner": {"reputation": 681, "user_id": 5037235, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Kfi9n.jpg?s=128&g=1", "display_name": "ArtificiallyIntelligence", "link": "https://stackoverflow.com/users/5037235/artificiallyintelligence"}, "edited": false, "score": 0, "creation_date": 1565056848, "post_id": 34438023, "comment_id": 101221728, "body": "installing OpenFOAM-7 same issues, solved by using 2.5.xx flex."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 5300657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a466e193300314055c3f71f953641b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex H.", "link": "https://stackoverflow.com/users/5300657/alex-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1486163724, "creation_date": 1486163724, "answer_id": 42034526, "question_id": 34438023, "link": "https://stackoverflow.com/questions/34438023/openfoam-flex-yyin-rdbufstdcin-rdbuf-error/42034526#42034526", "title": "openfoam: flex yyin.rdbuf(std::cin.rdbuf() error", "body": "<p>I think this might be a bit of a late answer, but I believe the issue is an out of sync \"FlexLexer.h\". Flex 2.6.0 changed the storage definition of yyin storage for C++ scanners for both the header and the generated source. However I suppose the mac port package is including an out-of-date FlexLexer.h, even though flex itself has been updated. This leads to the mismatch you are seeing as compilation errors. </p>\n\n<p>Instead of downgrading your flex install, you might be able to just use a newer \"FlexLexer.h\" (for example the one from here: <a href=\"https://github.com/westes/flex/blob/master/src/FlexLexer.h\" rel=\"nofollow noreferrer\">https://github.com/westes/flex/blob/master/src/FlexLexer.h</a>)</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10358283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49e9e5dec36107fe2ca7a559f24c41b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikkel K.&#216;.", "link": "https://stackoverflow.com/users/10358283/mikkel-k-%c3%98"}, "is_accepted": false, "score": 1, "last_activity_date": 1558719546, "last_edit_date": 1558719546, "creation_date": 1536840370, "answer_id": 52313404, "question_id": 34438023, "link": "https://stackoverflow.com/questions/34438023/openfoam-flex-yyin-rdbufstdcin-rdbuf-error/52313404#52313404", "title": "openfoam: flex yyin.rdbuf(std::cin.rdbuf() error", "body": "<p>I just compiled OpenFOAM v6 from the source code and got the same error - so this issue is still relevant. The error arised in <code>wmake surfmesh</code> where the first error was something like this</p>\n\n<pre><code>flex -+ ..........  \n.../OpenFOAM/OpenFOAM- 6/platforms/linux64GccDPInt32Opt/src/surfMesh/surfaceFormats/stl/STLsurfaceFormatASCII.L.C: In member function \u2018int STLASCIILexer::lex()\u2019:  \n.../OpenFOAM/OpenFOAM-6/platforms/linux64GccDPInt32Opt/src/surfMesh/surfaceFormats/stl/STLsurfaceFormatASCII.L.C:5494:9: error: request for member \u2018rdbuf\u2019 in \u2018((STLASCIILexer*)this)-&gt;STLASCIILexer::&lt;anonymous&gt;.yyFlexLexer::yyin\u2019, which is of pointer type \u2018std::istream* {aka std::basic_istream&lt;char&gt;*}\u2019 (maybe you meant to use \u2018-&gt;\u2019 ?)\nyyin.rdbuf(std::cin.rdbuf());\n</code></pre>\n\n<p>The solution provided by changing <code>flex</code> to <code>/usr/bin/flex</code> in <code>$HOME/OpenFOAM/OpenFOAM-6/wmake/rules/General/flex++</code> worked out for me.</p>\n"}], "owner": {"reputation": 39, "user_id": 4700969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de33302ff01fd3b1bee4c15bb205f23?s=128&d=identicon&r=PG&f=1", "display_name": "Murilo Pereira de Almeida", "link": "https://stackoverflow.com/users/4700969/murilo-pereira-de-almeida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1120, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1558719546, "creation_date": 1450881585, "last_edit_date": 1450889737, "question_id": 34438023, "link": "https://stackoverflow.com/questions/34438023/openfoam-flex-yyin-rdbufstdcin-rdbuf-error", "title": "openfoam: flex yyin.rdbuf(std::cin.rdbuf() error", "body": "<p>I want to report a solution to an error I\ngot while installing OpenFOAM 3.0.1 in Mac OS X El Capitan Version 10.11.2\nThe error was:</p>\n\n<blockquote>\n  <p>\"error: member reference type 'std::istream *' (aka\n  'basic_istream *') is a pointer; maybe you meant to use '->'?\n                          yyin.rdbuf(std::cin.rdbuf());\"</p>\n</blockquote>\n\n<p>This problem is related to <code>flex version 2.6.0</code>. which I installed using macports.</p>\n\n<p>I could overcome the problem by using \"<code>flex 2.5.35 Apple(flex-31)</code>\" which is at <code>/usr/bin/flex</code> (instead of <code>/opt/local/flex</code>).</p>\n\n<p>Just change \"flex\" to \"/usr/bin/flex\" in the file\n$(WM_DIR)/rules/General/flex++\nof your openfoam source distribution.</p>\n"}, {"tags": ["c++", "qt", "qgraphicsitem", "qpropertyanimation"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 2911792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba9a59d7e5ec653abf73aabe056a7c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Dach Boden", "link": "https://stackoverflow.com/users/2911792/dach-boden"}, "is_accepted": true, "score": 0, "last_activity_date": 1450886611, "creation_date": 1450886611, "answer_id": 34439518, "question_id": 34437873, "link": "https://stackoverflow.com/questions/34437873/easiest-way-to-animate-qgraphicspixmapitem/34439518#34439518", "title": "Easiest way to animate QGraphicsPixmapItem?", "body": "<p>Okay, got it.</p>\n\n<p>I had to instantiate my <code>AnimatedGraphicsItem</code> object, then <code>setPixmap</code>, <code>setFlag</code>, \u2026 and <code>addItem</code> to my scene (and it was important to use <code>new</code>).</p>\n"}], "owner": {"reputation": 11, "user_id": 2911792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba9a59d7e5ec653abf73aabe056a7c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Dach Boden", "link": "https://stackoverflow.com/users/2911792/dach-boden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 505, "favorite_count": 0, "accepted_answer_id": 34439518, "answer_count": 1, "score": 1, "last_activity_date": 1450886611, "creation_date": 1450881083, "question_id": 34437873, "link": "https://stackoverflow.com/questions/34437873/easiest-way-to-animate-qgraphicspixmapitem", "title": "Easiest way to animate QGraphicsPixmapItem?", "body": "<p>I want to animate a <code>QGraphicsPixmapItem</code> in my <code>QGraphicsScene</code>, with <code>QPropertyAnimation</code>.</p>\n\n<pre><code>QPixmap pixmap(filePath);\nQGraphicsItem *pixmapItem = graphicsScene-&gt;addPixmap(pixmap);\n\nQPropertyAnimation animation(pixmapItem, \"x\"); // here lies the problem\nanimation.setDuration(30000);\n// ...\nanimation.start();\n</code></pre>\n\n<p>I checked the doc, so I already know that <code>QGraphicsPixmapItem</code> and its parent <code>QGraphicsItem</code> are no <code>QObject</code>, and that a <code>QPropertyAnimation</code> constructor with a <code>QGraphicsItem</code> does not exist. According to various sources, the best way is to create a new class, e.g. <code>AnimatedGraphicsItem</code> which inherits from <code>QObject</code> and <code>QGraphicsItem</code> OR I can simply inherit from <code>QGraphicsObject</code>.</p>\n\n<pre><code>class AnimatedGraphicsItem : public QObject, public QGraphicsItem // or public QGraphicsObject\n{\n    Q_OBJECT\n    Q_INTERFACES(QGraphicsItem) // not needed if I inherit from QGraphicsObject, right?\n};\n</code></pre>\n\n<p>What do I need to include exactly in the header and source files of my <code>AnimatedGraphicsItem</code> class? One source told me to include this in the header file too, but I thought, this is already inherited?</p>\n\n<pre><code>public:\n    AnimatedGraphicsItem(QGraphicsItem *parent = 0);\n\nprivate:\n     virtual QRectF boundingRect() const;\n     virtual void paint(QPainter *painter, const QStyleOptionGraphicsItem *option, QWidget *widget);\n</code></pre>\n\n<p>And how do I have to use my <code>AnimatedGraphicsItem</code> class?</p>\n\n<p>Do I have to cast my <code>QGraphicsItem *pixmapItem</code> to <code>AnimatedGraphicsItem</code>? (If yes, how?) Do I have to create a new instance of <code>AnimatedGraphicsItem</code>?</p>\n\n<p>I haven't found a good example on the Internet.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 5, "creation_date": 1450880930, "post_id": 34437756, "comment_id": 56616406, "body": "What do you want to happen if the filename is not valid?"}, {"owner": {"reputation": 2721, "user_id": 880984, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/65f4fa9056d1884b419463410e92c5be?s=128&d=identicon&r=PG", "display_name": "Tim Seguine", "link": "https://stackoverflow.com/users/880984/tim-seguine"}, "edited": false, "score": 0, "creation_date": 1450881225, "post_id": 34437756, "comment_id": 56616583, "body": "You could check it in the body of the constructor if you find it acceptable to throw an exception on failure."}, {"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 1, "creation_date": 1450881330, "post_id": 34437756, "comment_id": 56616642, "body": "What do you mean by &quot;valid&quot; - the file exists, or something else?"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1450881515, "post_id": 34437756, "comment_id": 56616737, "body": "Ask yourself which part actually requires that the filename is some kind of &quot;valid&quot;? If it&#39;s <code>Class1</code>, let that class do the validation. If <code>Class2</code> imposes some additional constraints, you could use Martin&#39;s solution. If <code>Class2</code> is the only one that requires it, you can forward it to <code>Class1</code> and perform the check in the constructor body. If neither of them actually requires it, I wonder where the code is that actually does..."}, {"owner": {"reputation": 73, "user_id": 4207427, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fxv2yJtLJfU/AAAAAAAAAAI/AAAAAAAAAEU/cVMW6UIqeCo/photo.jpg?sz=128", "display_name": "Nadjib Dz", "link": "https://stackoverflow.com/users/4207427/nadjib-dz"}, "edited": false, "score": 0, "creation_date": 1450881722, "post_id": 34437756, "comment_id": 56616857, "body": "@ChrisDrewqsd : If the file doesn&#39;t exist or not valid (call a member function to check it) so it creates a new one"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 1, "creation_date": 1451146076, "post_id": 34437756, "comment_id": 56687199, "body": "That&#39;s introducing a race condition. Nothing guarantees that between checking if the file is there and opening the file nobody deleted the file or created one in place. A much better approach is to just open the file and handle failures accordingly."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 4207427, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fxv2yJtLJfU/AAAAAAAAAAI/AAAAAAAAAEU/cVMW6UIqeCo/photo.jpg?sz=128", "display_name": "Nadjib Dz", "link": "https://stackoverflow.com/users/4207427/nadjib-dz"}, "edited": false, "score": 0, "creation_date": 1450882918, "post_id": 34437932, "comment_id": 56617573, "body": "well its a good idea to pass <b>validate_filename(filename)</b> as a parameter, I wonder why I didn&#39;t think about it. Thanks Martin you saved my day."}], "tags": [], "owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "is_accepted": false, "score": 8, "last_activity_date": 1450881811, "last_edit_date": 1450881811, "creation_date": 1450881290, "answer_id": 34437932, "question_id": 34437756, "link": "https://stackoverflow.com/questions/34437756/c-class-verify-a-parameter-before-passing-it-to-a-member-object/34437932#34437932", "title": "C++ Class - Verify a parameter before passing it to a member object", "body": "<p>Just invoke a static function to do the validation, but otherwise forward it's argument:</p>\n\n<pre><code>class Class2\n{\n    Class1 C1;\n    static const std::string&amp; validate_filename(const std::string&amp; filename);\npublic:\n    Class2(const string &amp; filename)\n};\n\nconst std::string&amp; Class2::validate_filename(const std::string&amp; filename)\n{\n   if (filename.size() &lt; 2)\n      throw std::runtime_error(\"filename too short\");\n   return filename;\n}\n\nClass2::Class2(const string &amp; filename)\n: C1(validate_filename(filename), some_other_parameters){\n}\n</code></pre>\n\n<p>Note that you can use a similar technique if you want to transform the argument.  So you can convert from wide char to utf8 and force the path to be in a canonical format, ... and still have the member variable be const.</p>\n\n<p>You should also consider which class should be responsible for the validation.  If C1 has constraints on its arguments, then it should check them.  If on the other hand it would be fine with any string, but C2 has constraints, then it must do the checking.</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 2295923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6242d0995fc6bd62dd1ca47bd1bbe78a?s=128&d=identicon&r=PG&f=1", "display_name": "noname", "link": "https://stackoverflow.com/users/2295923/noname"}, "is_accepted": true, "score": 1, "last_activity_date": 1450888343, "creation_date": 1450888343, "answer_id": 34440012, "question_id": 34437756, "link": "https://stackoverflow.com/questions/34437756/c-class-verify-a-parameter-before-passing-it-to-a-member-object/34440012#34440012", "title": "C++ Class - Verify a parameter before passing it to a member object", "body": "<p>You can just used a pointer for Class1</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;string&gt;\n\nclass Class1\n{\npublic:\n    Class1(const std::string &amp; filename, int a)\n    {\n        // ...\n    }\n};\n\nclass Class2\n{\n    Class1 * p_C1;\npublic:\n    Class2(const std::string &amp; filename)\n    {\n        // ------------------------------------\n        // Check the file before p_C1 creation\n        // ------------------------------------\n        p_C1 = new Class1(filename, 1);\n    }\n    ~Class2(void)\n    {\n        if (p_C1 != NULL) delete p_C1;\n    }\n};\n\nint main()\n{\n    Class2 myClass(\"file.txt\");\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 4207427, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fxv2yJtLJfU/AAAAAAAAAAI/AAAAAAAAAEU/cVMW6UIqeCo/photo.jpg?sz=128", "display_name": "Nadjib Dz", "link": "https://stackoverflow.com/users/4207427/nadjib-dz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 668, "favorite_count": 0, "accepted_answer_id": 34440012, "answer_count": 2, "score": 3, "last_activity_date": 1450888343, "creation_date": 1450880726, "question_id": 34437756, "link": "https://stackoverflow.com/questions/34437756/c-class-verify-a-parameter-before-passing-it-to-a-member-object", "title": "C++ Class - Verify a parameter before passing it to a member object", "body": "<p>I want to write a class (<strong>Class2</strong>) that uses another class (<strong>Class1</strong>).</p>\n\n<ul>\n<li><strong>Class1</strong> requires 2 parameters (the 2nd parameter is always the same so no need to talk about it).</li>\n<li><strong>Class2</strong> require 1 parameter, and I want to check this parameter if its valid before passing it to an object created from <strong>Class1</strong></li>\n</ul>\n\n<p>So my code looks like this :</p>\n\n<pre><code>class Class1\n{\npublic:\n    Class1(const string &amp; filename, some_other_parameters);\n    ...\n};\n\nclass Class2\n{\n    Class1 C1;\npublic:\n    Class2(const string &amp; filename) // I want to verify this filename before passing it to C1 object\n};\n\nClass2::Class2(const string &amp; filename)\n: C1(filename, some_other_parameters){\n\n}\n\n\n\nint main()\n{\n    Class2 myClass(\"file.txt\");\n}\n</code></pre>\n\n<p>So is there a way to check the <strong>filename</strong> before passing it to <strong>C1</strong> or should I do it in the <strong>main()</strong> ?</p>\n"}, {"tags": ["c++", "recursion", "logic", "boost-spirit", "conjunctive-normal-form"], "comments": [{"owner": {"reputation": 66, "user_id": 5222345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b87446f2250a2eeae203be9c5c1ba3?s=128&d=identicon&r=PG", "display_name": "Eric Tsai", "link": "https://stackoverflow.com/users/5222345/eric-tsai"}, "reply_to_user": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1450886180, "post_id": 34437723, "comment_id": 56619596, "body": "@JSF oh so my question is not easy to read? Sorry for my poor English, which part is not clear enough? I&#39;ll try to explain it more!"}, {"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1450886374, "post_id": 34437723, "comment_id": 56619718, "body": "@EricTsai, No I did not think your question was hard to read.  I just thought a link to the definition would be more convenient for many people who might read it, so I added that for you."}, {"owner": {"reputation": 66, "user_id": 5222345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b87446f2250a2eeae203be9c5c1ba3?s=128&d=identicon&r=PG", "display_name": "Eric Tsai", "link": "https://stackoverflow.com/users/5222345/eric-tsai"}, "reply_to_user": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1450887154, "post_id": 34437723, "comment_id": 56620186, "body": "@JSF ah, thank you very much! And also thank for your answer. However I know the rules, it&#39;s hard for me to write it down..."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 1, "creation_date": 1451003007, "post_id": 34437723, "comment_id": 56660201, "body": "I recognize that code :)"}, {"owner": {"reputation": 66, "user_id": 5222345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b87446f2250a2eeae203be9c5c1ba3?s=128&d=identicon&r=PG", "display_name": "Eric Tsai", "link": "https://stackoverflow.com/users/5222345/eric-tsai"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1451021362, "post_id": 34437723, "comment_id": 56662627, "body": "@sehe, Yes I take a look at your <a href=\"http://stackoverflow.com/questions/8706356/boolean-expression-grammar-parser-in-c?answertab=votes#tab-top\">old post</a> and modify it a little bit, trying to make a CNF generator. It gives me a good direction :)"}], "answers": [{"comments": [{"owner": {"reputation": 66, "user_id": 5222345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b87446f2250a2eeae203be9c5c1ba3?s=128&d=identicon&r=PG", "display_name": "Eric Tsai", "link": "https://stackoverflow.com/users/5222345/eric-tsai"}, "edited": false, "score": 0, "creation_date": 1450887526, "post_id": 34438762, "comment_id": 56620419, "body": "Yes you&#39;re right. OK I&#39;ll take your advice and try it tomorrow. Thx again, maybe it&#39;s just what I need!"}, {"owner": {"reputation": 66, "user_id": 5222345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b87446f2250a2eeae203be9c5c1ba3?s=128&d=identicon&r=PG", "display_name": "Eric Tsai", "link": "https://stackoverflow.com/users/5222345/eric-tsai"}, "edited": false, "score": 0, "creation_date": 1451021485, "post_id": 34438762, "comment_id": 56662649, "body": "Hi JSF, it\u2019s kind that you point out the mistake I made and give a good advice. Take parsing, transforming and printing apart makes the code more readable(although I still use the old way, not std::set to take any number of operands). The design you give is very clear, thank you for explaining it step by step."}, {"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "reply_to_user": {"reputation": 66, "user_id": 5222345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b87446f2250a2eeae203be9c5c1ba3?s=128&d=identicon&r=PG", "display_name": "Eric Tsai", "link": "https://stackoverflow.com/users/5222345/eric-tsai"}, "edited": false, "score": 0, "creation_date": 1451043681, "post_id": 34438762, "comment_id": 56666707, "body": "I also wrote a version (because I was curious about something).  What kinds of redundancies did you take out and what kinds were you supposed to take out?  If you had used <code>set</code> that automatically removes a few trivial redundancies.  But most remain.  See example in next comment.  My version uses only single character tokens (to focus on transforming not tokenizing) so I used <code>=</code> for <code>IFF</code> and other obvious substitutions."}, {"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "reply_to_user": {"reputation": 66, "user_id": 5222345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b87446f2250a2eeae203be9c5c1ba3?s=128&d=identicon&r=PG", "display_name": "Eric Tsai", "link": "https://stackoverflow.com/users/5222345/eric-tsai"}, "edited": false, "score": 2, "creation_date": 1451044057, "post_id": 34438762, "comment_id": 56666791, "body": "From input <code>(a=(b=c))</code> my version generates: <code>(a|b|!b)&amp;(a|b|c)&amp;(a|!b|!c)&amp;(a|c|!c)&amp;(!a|b|!c)&amp;(!a|!b|c)</code> which is redundant.  A better answer would be<code>(a|b|c)&amp;(a|!b|!c)&amp;(!a|b|!c)&amp;(!a|!b|c)</code>.  Using <code>set</code> and a little extra code, redundancies like that one can be easily dropped.  But many others are arbitrarily more difficult.  Some cases where the whole expression could be replaced by <code>false</code> can&#39;t be detected with less work than examining all <code>2**n</code> combinations of the primitives."}], "tags": [], "owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "is_accepted": false, "score": 4, "last_activity_date": 1451002952, "last_edit_date": 1451002952, "creation_date": 1450884144, "answer_id": 34438762, "question_id": 34437723, "link": "https://stackoverflow.com/questions/34437723/convert-logic-formula-to-conjunctive-normal-form-in-c/34438762#34438762", "title": "Convert logic formula to conjunctive normal form in C++", "body": "<p>Moving NOT inward should be done before distributing OR across AND:</p>\n\n<pre><code>!(A AND B) ==&gt; (!A OR !B)\n!(A OR B) ==&gt; (!A AND !B)\n</code></pre>\n\n<p>remember to cancel any <code>!!X</code> that occurs while doing that.</p>\n\n<p>Also drop redundant <code>(</code> <code>)</code></p>\n\n<p>OR distributes across AND:</p>\n\n<pre><code>A OR (B AND C) ==&gt; (A OR B) AND (A OR C)\n</code></pre>\n\n<p>You Probably need to reduce some other redundancies that will creep in as you do all that, such as (X OR X)</p>\n\n<p><code>(A or</code><strong><code>not</code></strong><code>( not B or C)) and ( not A or ( not B or C)) ==&gt;</code><br/>\n<code>(A or (</code><strong><code>not</code></strong><code>not B and</code><strong><code>not</code></strong><code>C)) and ( not A or</code><strong><code>(</code></strong><code>not B or C</code><strong><code>)</code></strong><code>) ==&gt;</code><br/>\n<code>(A</code><strong><code>or</code></strong><code>( B and not C)) and ( not A or not B or C) ==&gt;</code><br/>\n<strong><code>(</code></strong>(\u200b<code>A</code><strong><code>or</code></strong><code>B) and (A</code><strong><code>or</code></strong><code>not C)</code><strong><code>)</code></strong><code>and ( not A or not B or C) ==&gt;</code><br/>\n<code>(A or B) and (A or not C) and ( not A or not B or C)</code><br/></p>\n\n<p>Maybe I misunderstood your question and you already understood all the above transformations, and you are having trouble with the mechanics of doing that inside the structure you have created.</p>\n\n<p>You certainly have made things hard for yourself (maybe impossible) by trying to accomplish all the transformations inside the print routine. I would have parsed, then transformed, then printed.</p>\n\n<p>If you insist on transforming in the print routine, then you likely miss some simplifications and you need print to be more aware of the rules of CNF. An AND node can simply print its two sides recursively with AND in between. But any other node most first inspect its children and conditionally transform enough to pull an AND up to the top before recursively calling.</p>\n\n<p>You had:</p>\n\n<pre><code>void eliminate_iff(const expr&amp; l, const expr&amp; r) const\n{\n    _os &lt;&lt; \"(\";\n    boost::apply_visitor(*this, l);\n    _os &lt;&lt; \" or not \";\n    boost::apply_visitor(*this, r);\n    _os &lt;&lt; \") and ( not \";\n    boost::apply_visitor(*this, l);\n    _os &lt;&lt; \" or \";\n    boost::apply_visitor(*this, r);\n    _os &lt;&lt; \")\";\n}\n</code></pre>\n\n<p>But you can't recurse all the way into <code>l</code> or <code>r</code> from iff and you can't directly generate any <code>\"not\"</code> or <code>\"or\"</code> text until you have recursively reached the bottom. So with the mis design of transforming while printing, the iff routine would need to generate a temp object representing (<code>l</code> or not <code>r</code>) and then call the <code>or</code> processing routine to handle it, then output <code>\"AND\"</code> then create a temp object representing (not <code>l</code> or <code>r</code>) and call the <code>or</code> processing routine to handle it.</p>\n\n<p>Similarly, the <code>or</code> processing routine would need to look at each operand. If each is simply a final variable or <code>not</code> of a final variable, <code>or</code> can simply emit itself to the stream. But if any operand is more complicated, <code>or</code> must do something more complicated.</p>\n\n<p>In addition to doing transformation before you start printing, there are a couple other things you might change in order to make the code simpler:</p>\n\n<p>First, you could avoid a lot of trouble by having <code>or</code> and <code>and</code> objects each hold a <code>std::set</code> of any number of operands, rather than a pair of operands. The big cost of that is you need a decent comparison function for the objects. But the pay back is worth the trouble of having a comparison function.\nNext, you might <strong>consider</strong> having a single type for all subexpressions, rather than having a type for each operator. So each object must store an operator and a <code>std::set</code> of operands. There are some pretty big and obvious disadvantages to that design choice, but there is one big advantage: <strong>A subexpression can transform itself into a different kind.</strong></p>\n\n<p>The more common subexpression transformation scheme (which might still be best, just consider alternatives) is for the owner of a subexpression to ask the subexpression to conditionally generate a transformed clone of itself. That is more efficient than having objects able to directly transform themselves. But getting the coding details right requires more thought.</p>\n\n<p>Another good choice for this grammar is to do all the transformations while parsing. More complicated problems really deserve the full split of parse, transform, print. But in this case transform fits beautifully into parsing if you think through your factory function:</p>\n\n<p>The factory takes an operator and one (for <code>NOT</code>) or two subexpressions that are <strong>already CNF</strong>. It produces a new CNF expression:</p>\n\n<ul>\n<li><p><code>AND</code>: </p>\n\n<ul>\n<li>a) Both inputs are <code>AND</code>'s, form the union of their sets. </li>\n<li>b) One input is an <code>AND</code>, insert the other input into that one's set. </li>\n<li>c) Neither input is an <code>AND</code>, create a new <code>AND</code> with those two inputs.</li>\n</ul></li>\n<li><p><code>OR</code>: </p>\n\n<ul>\n<li>a) Both inputs are <code>OR</code>'s, form the union of their sets. </li>\n<li>b) One input is an <code>OR</code> and the other is primitive or <code>NOT</code>, insert the other input into the <code>OR</code>'s set. </li>\n<li>c) At least one input is an <code>AND</code>, distribute the other input across that <code>AND</code> (the distribute function must handle the ugly sub cases).</li>\n</ul></li>\n<li><p><code>NOT</code>: </p>\n\n<ul>\n<li>Inversion of a primitive is trivial. Inversion of a <code>NOT</code> is trivial. Inversion of an <code>OR</code> is pretty trivial. Inversion of an <code>AND</code> is the ugliest thing in this whole design (you need to turn the whole thing inside out) but is doable. To keep your sanity, you could forget about efficiency and use the factory recursively for the <code>NOT</code> and <code>OR</code> operations that a <code>NOT AND</code> trivially transforms to (but which need further transformation to get back to CNF). </li>\n</ul></li>\n<li><code>IFF</code> and <code>IMP</code>: Just make the appropriate several calls to the basic factories.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 66, "user_id": 5222345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b87446f2250a2eeae203be9c5c1ba3?s=128&d=identicon&r=PG", "display_name": "Eric Tsai", "link": "https://stackoverflow.com/users/5222345/eric-tsai"}, "edited": false, "score": 1, "creation_date": 1451026054, "post_id": 34453068, "comment_id": 56663332, "body": "I check the outputs &quot;original: formula&quot;, they are correct obviously. Then I look at the outputs &quot;CNF: formula&quot;, they are conjunctive normal form exactly after dropping redundant parentheses(that&#39;s mean, this program gives the correct solution). I modify the printer a little bit to make final output as CNF(maybe there are more better way). Thanks for your help, and BIG THANKS for clear explanation!"}, {"owner": {"reputation": 155, "user_id": 2417774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3e28fcff33afd3cfb2242c4ae49b72c?s=128&d=identicon&r=PG", "display_name": "llonesmiz", "link": "https://stackoverflow.com/users/2417774/llonesmiz"}, "reply_to_user": {"reputation": 66, "user_id": 5222345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b87446f2250a2eeae203be9c5c1ba3?s=128&d=identicon&r=PG", "display_name": "Eric Tsai", "link": "https://stackoverflow.com/users/5222345/eric-tsai"}, "edited": false, "score": 0, "creation_date": 1451028102, "post_id": 34453068, "comment_id": 56663710, "body": "<a href=\"http://ideone.com/mY7QSf\" rel=\"nofollow noreferrer\">Here</a> is a version that tries to be smarter with  the printing of the parentheses. It relies on the fact that the elements on the variant are ordered by priority (so if you change the definition of the variant it will break)."}, {"owner": {"reputation": 155, "user_id": 2417774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3e28fcff33afd3cfb2242c4ae49b72c?s=128&d=identicon&r=PG", "display_name": "llonesmiz", "link": "https://stackoverflow.com/users/2417774/llonesmiz"}, "reply_to_user": {"reputation": 66, "user_id": 5222345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b87446f2250a2eeae203be9c5c1ba3?s=128&d=identicon&r=PG", "display_name": "Eric Tsai", "link": "https://stackoverflow.com/users/5222345/eric-tsai"}, "edited": false, "score": 1, "creation_date": 1451028695, "post_id": 34453068, "comment_id": 56663832, "body": "Btw, should <code>imp</code>s (and I guess <code>iff</code>s) be left associative? Or is <a href=\"http://ideone.com/x9wQMY\" rel=\"nofollow noreferrer\">this</a> correct?"}, {"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1451044695, "post_id": 34453068, "comment_id": 56666918, "body": "@cv_and_he It is convenient for the final output to drop redundant <code>( )</code> for <code>AND</code> of <code>AND</code> or <code>OR</code> of <code>OR</code>.  But having your parsed intermediate output drop non redundant <code>( )</code> is inconvenient.  If anything was right associative, that should have been specified in the original problem statement."}, {"owner": {"reputation": 155, "user_id": 2417774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3e28fcff33afd3cfb2242c4ae49b72c?s=128&d=identicon&r=PG", "display_name": "llonesmiz", "link": "https://stackoverflow.com/users/2417774/llonesmiz"}, "reply_to_user": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 1, "creation_date": 1451045047, "post_id": 34453068, "comment_id": 56667006, "body": "@JSF with the parser he provided everything IS right associative. I think that is not a problem for <code>and</code> and <code>or</code>, but I imagine it could be for <code>imp</code> and <code>iff</code>. My comment was to make sure he was aware of that possible problem."}, {"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1451045268, "post_id": 34453068, "comment_id": 56667055, "body": "I missed that detail.  I didn&#39;t look into the behavior of his parser or your parser.  I focused on the transformation aspect and foolishly assumed the grammar was simple enough to not have issues.  So you make a very important point.  The decision of whether IMP and IFF are right or left associative should be by design, not by accident."}, {"owner": {"reputation": 66, "user_id": 5222345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b87446f2250a2eeae203be9c5c1ba3?s=128&d=identicon&r=PG", "display_name": "Eric Tsai", "link": "https://stackoverflow.com/users/5222345/eric-tsai"}, "edited": false, "score": 0, "creation_date": 1451055284, "post_id": 34453068, "comment_id": 56669482, "body": "@cv_and_he No!!! I didn&#39;t aware they should be left associative!!! So I guess it&#39;s necessary to rewrite the parser, but I can only tell the code in parser part dealing with precedence issue. How to make it left associative?"}, {"owner": {"reputation": 155, "user_id": 2417774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3e28fcff33afd3cfb2242c4ae49b72c?s=128&d=identicon&r=PG", "display_name": "llonesmiz", "link": "https://stackoverflow.com/users/2417774/llonesmiz"}, "reply_to_user": {"reputation": 66, "user_id": 5222345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b87446f2250a2eeae203be9c5c1ba3?s=128&d=identicon&r=PG", "display_name": "Eric Tsai", "link": "https://stackoverflow.com/users/5222345/eric-tsai"}, "edited": false, "score": 1, "creation_date": 1451084706, "post_id": 34453068, "comment_id": 56676342, "body": "@EricTsai I&#39;m not 100% certain, but I think the <code>fix_associativity</code> transformation <a href=\"http://ideone.com/nL0zte\" rel=\"nofollow noreferrer\">here</a> solves the problem."}, {"owner": {"reputation": 66, "user_id": 5222345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b87446f2250a2eeae203be9c5c1ba3?s=128&d=identicon&r=PG", "display_name": "Eric Tsai", "link": "https://stackoverflow.com/users/5222345/eric-tsai"}, "edited": false, "score": 0, "creation_date": 1451101688, "post_id": 34453068, "comment_id": 56678564, "body": "I checkout some tests like <code>a imp b imp c</code> , <code>(a iff b) iff c</code> by hand, the final CNF are as same as outputs <code>CNF fixed?: formula</code>. They are left associative now. I&#39;m going to imagining how <code>fix_associativity</code> do and then tests more example formulas, but I think your code is already right =)"}], "tags": [], "owner": {"reputation": 155, "user_id": 2417774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3e28fcff33afd3cfb2242c4ae49b72c?s=128&d=identicon&r=PG", "display_name": "llonesmiz", "link": "https://stackoverflow.com/users/2417774/llonesmiz"}, "is_accepted": false, "score": 3, "last_activity_date": 1451029737, "last_edit_date": 1451029737, "creation_date": 1450961339, "answer_id": 34453068, "question_id": 34437723, "link": "https://stackoverflow.com/questions/34437723/convert-logic-formula-to-conjunctive-normal-form-in-c/34453068#34453068", "title": "Convert logic formula to conjunctive normal form in C++", "body": "<p>Inspired by what little I know about Boost.Proto I've tried to modify your code to allow for independent ast transformations. This approach uses 4 passes (eliminate_iff, eliminate_imp, distribute_nots and distribute_ors) and in each one it rebuilds the ast. There may be a way to do the same in a single pass, probably with better performance, but I think that approach would be (even) harder to understand.</p>\n\n<h2>Explanation of the changes:</h2>\n\n<p>The first change is a little gratuitous but I really think that all the <code>phx::construct...</code>s make the grammar harder to read. The grammar I use is:</p>\n\n<pre><code>    iff_ = as_iff[imp_ &gt;&gt; \"iff\" &gt;&gt; iff_] | imp_;\n    imp_ = as_imp[or_ &gt;&gt; \"imp\" &gt;&gt; imp_] | or_;\n    or_ = as_or[and_ &gt;&gt; \"or\" &gt;&gt; or_] | and_;\n    and_ = as_and[not_ &gt;&gt; \"and\" &gt;&gt; and_] | not_;\n    not_ = as_not[\"not\" &gt; simple] | simple;\n</code></pre>\n\n<p>In order to be able to use this you need to adapt <code>unop</code> and <code>binop</code> using <code>BOOST_FUSION_ADAPT_TPL_STRUCT</code> and declare <code>as_xxx</code> as:</p>\n\n<pre><code>const as&lt;binop&lt;op_xxx&gt;&gt; as_xxx={};\n</code></pre>\n\n<p>If you don't like this change your original grammar should also work (if you add a <code>using namespace ast;</code>).</p>\n\n<hr>\n\n<p>I've put everything related to the AST inside <code>namespace ast</code> and made a few additions:</p>\n\n<ul>\n<li><code>enum class expr_type</code>: the order of its enumerators needs to be kept in synch with the parameters in the variant. It is used to check whether one of a node's children has a particular type.</li>\n<li><code>get_expr_type</code>: simply returns what is the type of the expression.</li>\n<li><code>printer</code>: now it just prints the expression passed, without making any transformation. Maybe it could be changed to be smarter about the placing of parentheses.</li>\n<li>operators <code>!</code>, <code>&amp;&amp;</code> and <code>||</code>: they are used to make the rebuilding of the AST easier.</li>\n</ul>\n\n<hr>\n\n<p>And finally the transformations. Every transformation uses <code>ast_helper&lt;Transformation&gt;</code> as its base. This struct has several reused member functions:</p>\n\n<ul>\n<li><code>pass_through</code>: creates a node of the same type that has as members, the result of transforming the original members.</li>\n<li><code>recurse</code>: applies the transformation to the current node.</li>\n<li><code>left</code>: gets the first member of a node independently of the type of the node. Gets used in the more complex transformations to slightly help with readability.</li>\n<li><code>child0</code>: exactly the same as <code>left</code>, but the name makes more sense in unary nodes.</li>\n<li><code>right</code>: gets the second member of a node.</li>\n</ul>\n\n<hr>\n\n<p><em>eliminate_imp</em> :<br>\nThis one is really easy:</p>\n\n<ul>\n<li>If you get a <code>binop&lt;op_imp&gt;</code> return <code>!p || q</code>. Where <code>p</code> and <code>q</code> are the result of applying the transformation to the first and second operands respectively.</li>\n<li>If you get anything else return a node of the same kind applying the transformation to its operands(pass_through).</li>\n</ul>\n\n<p><em>eliminate_iff</em> :<br>\nIt's basically the same, changing <code>binop&lt;op_iff&gt;</code> with <code>(p || !q)&amp;&amp;(!p || q)</code>.</p>\n\n<p><em>distribute_nots</em> :</p>\n\n<ul>\n<li>If you get anything that is not a <code>unop&lt;op_not&gt;</code> simply pass_through.</li>\n<li><p>If you get a <code>unop&lt;op_not&gt;</code>, first check the type of its operand:</p>\n\n<ul>\n<li>If it's an and, substitute with <code>!p || !q</code>.</li>\n<li>If it's an or, substitute with <code>!p &amp;&amp; !q</code>.</li>\n<li>If it's a not, substitute with <code>p</code>.</li>\n</ul></li>\n</ul>\n\n<p><em>distribute_ors</em> :</p>\n\n<ul>\n<li>If it's anything but an or, pass_through.</li>\n<li>If it's an or:\n\n<ul>\n<li>Check whether its first operand is an <code>and</code>. If it is distribute the <code>or</code>s and apply the transformation again in case another <code>or-&gt;and</code> is there.</li>\n<li>Check whether its second operand is an <code>and</code>. Do the analogous work.</li>\n<li>If neither direct child is an <code>and</code>, check recursively if there is any <code>and</code> in the subtree starting with this node. If there is it'll end up floating to the top so we'll need to recurse on the pass_through.</li>\n<li>If there isn't any <code>and</code> in the subtree, it is already in CNF and simply pass_through.</li>\n</ul></li>\n</ul>\n\n<p><a href=\"http://ideone.com/LByavz\" rel=\"nofollow\">Running on Ideone</a></p>\n\n<p><strong>Full Code:</strong>  </p>\n\n<pre><code>#include &lt;boost/spirit/include/qi.hpp&gt;\n#include &lt;boost/fusion/include/adapt_struct.hpp&gt;\n\n#include &lt;boost/variant/recursive_wrapper.hpp&gt;\n\nnamespace qi = boost::spirit::qi;\n\n\n\n// Abstract data type\n\nstruct op_or {};\nstruct op_and {};\nstruct op_imp {};\nstruct op_iff {};\nstruct op_not {};\n\nnamespace ast\n{\n    typedef std::string var;\n    template &lt;typename tag&gt; struct binop;\n    template &lt;typename tag&gt; struct unop;\n\n    enum class expr_type { var = 0, not_, and_, or_, imp, iff };\n    typedef boost::variant&lt;var,\n        boost::recursive_wrapper&lt;unop &lt;op_not&gt; &gt;,\n        boost::recursive_wrapper&lt;binop&lt;op_and&gt; &gt;,\n        boost::recursive_wrapper&lt;binop&lt;op_or&gt; &gt;,\n        boost::recursive_wrapper&lt;binop&lt;op_imp&gt; &gt;,\n        boost::recursive_wrapper&lt;binop&lt;op_iff&gt; &gt;\n    &gt; expr;\n\n    expr_type get_expr_type(const expr&amp; expression)\n    {\n        return static_cast&lt;expr_type&gt;(expression.which());\n    }\n\n    template &lt;typename tag&gt; struct binop\n    {\n        expr oper1, oper2;\n    };\n\n    template &lt;typename tag&gt; struct unop\n    {\n        expr oper1;\n    };\n\n    struct printer : boost::static_visitor&lt;void&gt;\n    {\n        printer(std::ostream&amp; os) : _os(os) {}\n        std::ostream&amp; _os;\n        mutable bool first{ true };\n\n        //\n        void operator()(const ast::var&amp; v) const { _os &lt;&lt; v; }\n\n\n        void operator()(const ast::binop&lt;op_and&gt;&amp; b) const { print(\" and \", b.oper1, b.oper2); }\n        void operator()(const ast::binop&lt;op_or&gt;&amp; b) const { print(\" or \", b.oper1, b.oper2); }\n        void operator()(const ast::binop&lt;op_iff&gt;&amp; b) const { print(\" iff \", b.oper1, b.oper2); }\n        void operator()(const ast::binop&lt;op_imp&gt;&amp; b) const { print(\" imp \", b.oper1, b.oper2); }\n\n        void print(const std::string&amp; op, const ast::expr&amp; l, const ast::expr&amp; r) const\n        {\n            _os &lt;&lt; \"(\";\n            boost::apply_visitor(*this, l);\n            _os &lt;&lt; op;\n            boost::apply_visitor(*this, r);\n            _os &lt;&lt; \")\";\n        }\n\n        void operator()(const ast::unop&lt;op_not&gt;&amp; u) const\n        {\n            _os &lt;&lt; \"not(\";\n            boost::apply_visitor(*this, u.oper1);\n            _os &lt;&lt; \")\";\n        }\n    };\n\n    std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, const expr&amp; e)\n    {\n        boost::apply_visitor(printer(os), e); return os;\n    }\n\n    expr operator!(const expr&amp; e)\n    {\n        return unop&lt;op_not&gt;{e};\n    }\n\n    expr operator||(const expr&amp; l, const expr&amp; r)\n    {\n        return binop&lt;op_or&gt;{l, r};\n    }\n\n    expr operator&amp;&amp;(const expr&amp; l, const expr&amp; r)\n    {\n        return binop&lt;op_and&gt;{l, r};\n    }\n\n}\n\nBOOST_FUSION_ADAPT_TPL_STRUCT(\n    (Tag),\n    (ast::binop) (Tag),\n    (ast::expr, oper1)\n    (ast::expr, oper2)\n)\n\nBOOST_FUSION_ADAPT_TPL_STRUCT(\n    (Tag),\n    (ast::unop) (Tag),\n    (ast::expr, oper1)\n)\n\n\n// Grammar rules\n\ntemplate &lt;typename It, typename Skipper = qi::space_type&gt;\nstruct parser : qi::grammar&lt;It, ast::expr(), Skipper&gt;\n{\n    parser() : parser::base_type(expr_)\n    {\n        using namespace qi;\n        const as&lt;ast::binop&lt;op_iff&gt; &gt; as_iff = {};\n        const as&lt;ast::binop&lt;op_imp&gt; &gt; as_imp = {};\n        const as&lt;ast::binop&lt;op_or&gt; &gt; as_or = {};\n        const as&lt;ast::binop&lt;op_and&gt; &gt; as_and = {};\n        const as&lt;ast::unop&lt;op_not&gt; &gt; as_not = {};\n\n        expr_ = iff_.alias();\n\n        iff_ = as_iff[imp_ &gt;&gt; \"iff\" &gt;&gt; iff_] | imp_;\n        imp_ = as_imp[or_ &gt;&gt; \"imp\" &gt;&gt; imp_] | or_;\n        or_ = as_or[and_ &gt;&gt; \"or\" &gt;&gt; or_] | and_;\n        and_ = as_and[not_ &gt;&gt; \"and\" &gt;&gt; and_] | not_;\n        not_ = as_not[\"not\" &gt; simple] | simple;\n\n        simple = (('(' &gt; expr_ &gt; ')') | var_);\n        var_ = qi::lexeme[+alpha];\n\n        BOOST_SPIRIT_DEBUG_NODE(expr_);\n        BOOST_SPIRIT_DEBUG_NODE(iff_);\n        BOOST_SPIRIT_DEBUG_NODE(imp_);\n        BOOST_SPIRIT_DEBUG_NODE(or_);\n        BOOST_SPIRIT_DEBUG_NODE(and_);\n        BOOST_SPIRIT_DEBUG_NODE(not_);\n        BOOST_SPIRIT_DEBUG_NODE(simple);\n        BOOST_SPIRIT_DEBUG_NODE(var_);\n    }\n\nprivate:\n    qi::rule&lt;It, ast::var(), Skipper&gt; var_;\n    qi::rule&lt;It, ast::expr(), Skipper&gt; not_, and_, or_, imp_, iff_, simple, expr_;\n};\n\ntemplate &lt;typename Transform&gt;\nstruct ast_helper : boost::static_visitor&lt;ast::expr&gt;\n{\n\n    template &lt;typename Tag&gt;\n    ast::expr pass_through(const ast::binop&lt;Tag&gt;&amp; op) const\n    {\n        return ast::binop&lt;Tag&gt;{recurse(op.oper1), recurse(op.oper2)};\n    }\n\n    template &lt;typename Tag&gt;\n    ast::expr pass_through(const ast::unop&lt;Tag&gt;&amp; op) const\n    {\n        return ast::unop&lt;Tag&gt;{recurse(op.oper1)};\n    }\n\n    ast::expr pass_through(const ast::var&amp; variable) const\n    {\n        return variable;\n    }\n\n    ast::expr recurse(const ast::expr&amp; expression) const\n    {\n        return boost::apply_visitor(Transform{}, expression);\n    }\n\n    struct left_getter:boost::static_visitor&lt;ast::expr&gt;\n    {\n        template&lt; template&lt;class&gt; class Op,typename Tag&gt;\n        ast::expr operator()(const Op&lt;Tag&gt;&amp; op) const\n        {\n            return op.oper1;\n        }\n\n        ast::expr operator()(const ast::var&amp;) const\n        {\n            return{};//throw something?\n        }\n    };\n\n\n    ast::expr left(const ast::expr&amp; expression) const\n    {\n        return boost::apply_visitor(left_getter{}, expression);\n    }\n\n    ast::expr child0(const ast::expr&amp; expression) const\n    {\n        return left(expression);\n    }\n\n    struct right_getter :boost::static_visitor&lt;ast::expr&gt;\n    {\n        template&lt;typename Tag&gt;\n        ast::expr operator()(const ast::binop&lt;Tag&gt;&amp; op) const\n        {\n            return op.oper2;\n        }\n\n        template&lt;typename Expr&gt;\n        ast::expr operator()(const Expr&amp;) const\n        {\n            return{};//throw something?\n        }\n    };\n\n    ast::expr right(const ast::expr&amp; expression) const\n    {\n        return boost::apply_visitor(right_getter{}, expression);\n    }\n\n};\n\nstruct eliminate_imp : ast_helper&lt;eliminate_imp&gt;\n{\n    template &lt;typename Op&gt;\n    ast::expr operator()(const Op&amp; op) const\n    {\n        return pass_through(op);\n    }\n\n    ast::expr operator()(const ast::binop&lt;op_imp&gt;&amp; imp) const\n    {\n        return !recurse(imp.oper1) || recurse(imp.oper2);\n    }\n\n    ast::expr operator()(const ast::expr&amp; expression) const\n    {\n        return recurse(expression);\n    }\n};\n\nstruct eliminate_iff : ast_helper&lt;eliminate_iff&gt;\n{\n    template &lt;typename Op&gt;\n    ast::expr operator()(const Op&amp; op) const\n    {\n        return pass_through(op);\n    }\n\n    ast::expr operator()(const ast::binop&lt;op_iff&gt;&amp; imp) const\n    {\n        return (recurse(imp.oper1) || !recurse(imp.oper2)) &amp;&amp; (!recurse(imp.oper1) || recurse(imp.oper2));\n    }\n\n    ast::expr operator()(const ast::expr&amp; expression) const\n    {\n        return recurse(expression);\n    }\n};\n\nstruct distribute_nots : ast_helper&lt;distribute_nots&gt;\n{\n    template &lt;typename Op&gt;\n    ast::expr operator()(const Op&amp; op) const\n    {\n        return pass_through(op);\n    }\n\n    ast::expr operator()(const ast::unop&lt;op_not&gt;&amp; not_) const\n    {\n        switch (ast::get_expr_type(not_.oper1)) //There is probably a better solution\n        {\n        case ast::expr_type::and_:\n            return recurse(!recurse(left(not_.oper1))) || recurse(!recurse(right(not_.oper1)));\n\n        case ast::expr_type::or_:\n            return recurse(!recurse(left(not_.oper1))) &amp;&amp; recurse(!recurse(right(not_.oper1)));\n\n        case ast::expr_type::not_:\n            return recurse(child0(not_.oper1));\n        default:\n            return pass_through(not_);\n        }\n    }\n\n    ast::expr operator()(const ast::expr&amp; expression) const\n    {\n        return recurse(expression);\n    }\n};\n\nstruct any_and_inside : boost::static_visitor&lt;bool&gt;\n{\n    any_and_inside(const ast::expr&amp; expression) :expression(expression) {}\n    const ast::expr&amp; expression;\n\n    bool operator()(const ast::var&amp;) const\n    {\n        return false;\n    }\n\n    template &lt;typename Tag&gt;\n    bool operator()(const ast::binop&lt;Tag&gt;&amp; op) const\n    {\n        return boost::apply_visitor(*this, op.oper1) || boost::apply_visitor(*this, op.oper2);\n    }\n\n    bool operator()(const ast::binop&lt;op_and&gt;&amp;) const\n    {\n        return true;\n    }\n\n    template&lt;typename Tag&gt;\n    bool operator()(const ast::unop&lt;Tag&gt;&amp; op) const\n    {\n        return boost::apply_visitor(*this, op.oper1);\n    }\n\n\n    explicit operator bool() const\n    {\n        return boost::apply_visitor(*this, expression);\n    }\n\n};\n\nstruct distribute_ors : ast_helper&lt;distribute_ors&gt;\n{\n    template &lt;typename Op&gt;\n    ast::expr operator()(const Op&amp; op) const\n    {\n        return pass_through(op);\n    }\n\n    ast::expr operator()(const ast::binop&lt;op_or&gt;&amp; or_) const\n    {\n        if (ast::get_expr_type(or_.oper1) == ast::expr_type::and_)\n        {\n            return recurse(recurse(left(or_.oper1)) || recurse(or_.oper2)) \n                &amp;&amp; recurse(recurse(right(or_.oper1)) || recurse(or_.oper2));\n        }\n        else if (ast::get_expr_type(or_.oper2) == ast::expr_type::and_)\n        {\n            return recurse(recurse(or_.oper1) || recurse(left(or_.oper2)))\n                &amp;&amp; recurse(recurse(or_.oper1) || recurse(right(or_.oper2)));\n        }\n        else if (any_and_inside( or_ ))\n        {\n            return recurse(recurse(or_.oper1) || recurse(or_.oper2));\n        }\n        else\n        {\n            return pass_through(or_);\n        }\n    }\n\n    ast::expr operator()(const ast::expr&amp; expression) const\n    {\n        return recurse(expression);\n    }\n\n};\n\nast::expr to_CNF(const ast::expr&amp; expression)\n{\n    return distribute_ors()(distribute_nots()(eliminate_iff()(eliminate_imp()(expression))));\n}\n\n\n\n\n// Test some examples in main and check the order of precedence\n\nint main()\n{\n    for (auto&amp; input : std::list&lt;std::string&gt;{\n\n        // Test the order of precedence\n        \"(a and b) imp ((c and d) or (a and b));\",\n        \"a and b iff (c and d or a and b);\",\n        \"a and b imp (c and d or a and b);\",\n        \"not a or not b;\",\n        \"a or b;\",\n        \"not a and b;\",\n        \"not (a and b);\",\n        \"a or b or c;\",\n        \"aaa imp bbb iff ccc;\",\n        \"aaa iff bbb imp ccc;\",\n\n\n        // Test elimination of equivalences\n        \"a iff b;\",\n        \"a iff b or c;\",\n        \"a or b iff b;\",\n        \"a iff b iff c;\",\n\n        // Test elimination of implications\n        \"p imp q;\",\n        \"p imp not q;\",\n        \"not p imp not q;\",\n        \"p imp q and r;\",\n        \"p imp q imp r;\"\n    })\n    {\n        auto f(std::begin(input)), l(std::end(input));\n        parser&lt;decltype(f)&gt; p;\n\n        try\n        {\n            ast::expr result;\n            bool ok = qi::phrase_parse(f, l, p &gt; ';', qi::space, result);\n\n            if (!ok)\n                std::cerr &lt;&lt; \"invalid input\\n\";\n            else\n            {\n                std::cout &lt;&lt; \"original: \" &lt;&lt; result &lt;&lt; \"\\n\";\n                std::cout &lt;&lt; \"CNF: \" &lt;&lt; to_CNF(result) &lt;&lt; \"\\n\";\n            }\n\n        }\n        catch (const qi::expectation_failure&lt;decltype(f)&gt;&amp; e)\n        {\n            std::cerr &lt;&lt; \"expectation_failure at '\" &lt;&lt; std::string(e.first, e.last) &lt;&lt; \"'\\n\";\n        }\n\n        if (f != l) std::cerr &lt;&lt; \"unparsed: '\" &lt;&lt; std::string(f, l) &lt;&lt; \"'\\n\";\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 66, "user_id": 5222345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b87446f2250a2eeae203be9c5c1ba3?s=128&d=identicon&r=PG", "display_name": "Eric Tsai", "link": "https://stackoverflow.com/users/5222345/eric-tsai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2948, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1451029737, "creation_date": 1450880617, "last_edit_date": 1450885197, "question_id": 34437723, "link": "https://stackoverflow.com/questions/34437723/convert-logic-formula-to-conjunctive-normal-form-in-c", "title": "Convert logic formula to conjunctive normal form in C++", "body": "<p>I'm going to implement a CNF generator in C++, using Boots/Spirit. but after finish \"the order of precedence\" and \"eliminating equivalences &amp; implications\" these two parts, I can't figure out how to implement \"move NOTs inwards\" and \"distribute ORs inwards over ANDs\". </p>\n\n<p>Desired output is documented here:\n<a href=\"https://en.wikipedia.org/wiki/Conjunctive_normal_form\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Conjunctive_normal_form</a></p>\n\n<p>Here are more detail description below:</p>\n\n<p>The order of precedence:</p>\n\n<pre><code>NOT &gt; AND &gt; OR &gt; IMP &gt; IFF\n</code></pre>\n\n<p>Input example:</p>\n\n<pre><code>A iff B imp C\n</code></pre>\n\n<p>Now the output is:</p>\n\n<pre><code>(A or not ( not B or C)) and ( not A or ( not B or C))\n</code></pre>\n\n<p>And the code( I implement output at printer part ):</p>\n\n<pre><code>#include &lt;boost/spirit/include/qi.hpp&gt;\n#include &lt;boost/spirit/include/phoenix.hpp&gt;\n#include &lt;boost/spirit/include/phoenix_operator.hpp&gt;\n#include &lt;boost/variant/recursive_wrapper.hpp&gt;\n\nnamespace qi    = boost::spirit::qi;\nnamespace phx   = boost::phoenix;\n\n\n\n// Abstract data type\n\nstruct op_or  {};\nstruct op_and {};\nstruct op_imp {};\nstruct op_iff {};\nstruct op_not {};\n\ntypedef std::string var;\ntemplate &lt;typename tag&gt; struct binop;\ntemplate &lt;typename tag&gt; struct unop;\n\ntypedef boost::variant&lt;var,\n        boost::recursive_wrapper&lt;unop &lt;op_not&gt; &gt;,\n        boost::recursive_wrapper&lt;binop&lt;op_and&gt; &gt;,\n        boost::recursive_wrapper&lt;binop&lt;op_or&gt; &gt;,\n        boost::recursive_wrapper&lt;binop&lt;op_imp&gt; &gt;,\n        boost::recursive_wrapper&lt;binop&lt;op_iff&gt; &gt;\n        &gt; expr;\n\ntemplate &lt;typename tag&gt; struct binop\n{\n  explicit binop(const expr&amp; l, const expr&amp; r) : oper1(l), oper2(r) { }\n  expr oper1, oper2;\n};\n\ntemplate &lt;typename tag&gt; struct unop\n{\n  explicit unop(const expr&amp; o) : oper1(o) { }\n  expr oper1;\n};\n\n\n\n// Operating on the syntax tree\n\nstruct printer : boost::static_visitor&lt;void&gt;\n{\n  printer(std::ostream&amp; os) : _os(os) {}\n  std::ostream&amp; _os;\n\n  //\n  void operator()(const var&amp; v) const { _os &lt;&lt; v; }\n\n  void operator()(const binop&lt;op_and&gt;&amp; b) const { print(\" and \", b.oper1, b.oper2); }\n  void operator()(const binop&lt;op_or &gt;&amp; b) const { print(\" or \", b.oper1, b.oper2); }\n  void operator()(const binop&lt;op_iff&gt;&amp; b) const { eliminate_iff(b.oper1, b.oper2); }\n  void operator()(const binop&lt;op_imp&gt;&amp; b) const { eliminate_imp(b.oper1, b.oper2); }\n\n  void print(const std::string&amp; op, const expr&amp; l, const expr&amp; r) const\n  {\n    _os &lt;&lt; \"(\";\n    boost::apply_visitor(*this, l);\n    _os &lt;&lt; op;\n    boost::apply_visitor(*this, r);\n    _os &lt;&lt; \")\";\n  }\n\n  void operator()(const unop&lt;op_not&gt;&amp; u) const\n  {\n    _os &lt;&lt; \"( not \";\n    boost::apply_visitor(*this, u.oper1);\n    _os &lt;&lt; \")\";\n  }\n\n  void eliminate_iff(const expr&amp; l, const expr&amp; r) const\n  {\n    _os &lt;&lt; \"(\";\n    boost::apply_visitor(*this, l);\n    _os &lt;&lt; \" or not \";\n    boost::apply_visitor(*this, r);\n    _os &lt;&lt; \") and ( not \";\n    boost::apply_visitor(*this, l);\n    _os &lt;&lt; \" or \";\n    boost::apply_visitor(*this, r);\n    _os &lt;&lt; \")\";\n  }\n\n  void eliminate_imp(const expr&amp; l, const expr&amp; r) const\n  {\n    _os &lt;&lt; \"( not \";\n    boost::apply_visitor(*this, l);\n    _os &lt;&lt; \" or \";\n    boost::apply_visitor(*this, r);\n    _os &lt;&lt; \")\";\n  }\n};\n\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, const expr&amp; e)\n{ boost::apply_visitor(printer(os), e); return os; }\n\n\n\n// Grammar rules\n\ntemplate &lt;typename It, typename Skipper = qi::space_type&gt;\nstruct parser : qi::grammar&lt;It, expr(), Skipper&gt;\n{\n  parser() : parser::base_type(expr_)\n  {\n    using namespace qi;\n\n    expr_  = iff_.alias();\n\n    iff_ = (imp_ &gt;&gt; \"iff\" &gt;&gt; iff_) [ _val = phx::construct&lt;binop&lt;op_iff&gt;&gt;(_1, _2) ] | imp_   [ _val = _1 ];\n    imp_ = (or_  &gt;&gt; \"imp\" &gt;&gt; imp_) [ _val = phx::construct&lt;binop&lt;op_imp&gt;&gt;(_1, _2) ] | or_    [ _val = _1 ];\n    or_  = (and_ &gt;&gt; \"or\"  &gt;&gt; or_ ) [ _val = phx::construct&lt;binop&lt;op_or &gt;&gt;(_1, _2) ] | and_   [ _val = _1 ];\n    and_ = (not_ &gt;&gt; \"and\" &gt;&gt; and_) [ _val = phx::construct&lt;binop&lt;op_and&gt;&gt;(_1, _2) ] | not_   [ _val = _1 ];\n    not_ = (\"not\" &gt; simple       ) [ _val = phx::construct&lt;unop &lt;op_not&gt;&gt;(_1)     ] | simple [ _val = _1 ];\n\n    simple = (('(' &gt; expr_ &gt; ')') | var_);\n    var_ = qi::lexeme[ +alpha ];\n\n    BOOST_SPIRIT_DEBUG_NODE(expr_);\n    BOOST_SPIRIT_DEBUG_NODE(iff_);\n    BOOST_SPIRIT_DEBUG_NODE(imp_);\n    BOOST_SPIRIT_DEBUG_NODE(or_);\n    BOOST_SPIRIT_DEBUG_NODE(and_);\n    BOOST_SPIRIT_DEBUG_NODE(not_);\n    BOOST_SPIRIT_DEBUG_NODE(simple);\n    BOOST_SPIRIT_DEBUG_NODE(var_);\n  }\n\n  private:\n  qi::rule&lt;It, var() , Skipper&gt; var_;\n  qi::rule&lt;It, expr(), Skipper&gt; not_, and_, or_, imp_, iff_, simple, expr_;\n};\n\n\n\n\n// Test some examples in main and check the order of precedence\n\nint main()\n{\n  for (auto&amp; input : std::list&lt;std::string&gt; {\n\n      // Test the order of precedence\n      \"(a and b) imp ((c and d) or (a and b));\",\n      \"a and b iff (c and d or a and b);\",\n      \"a and b imp (c and d or a and b);\",\n      \"not a or not b;\",\n      \"a or b;\",\n      \"not a and b;\",\n      \"not (a and b);\",\n      \"a or b or c;\",\n      \"aaa imp bbb iff ccc;\",\n      \"aaa iff bbb imp ccc;\",\n\n\n      // Test elimination of equivalences\n      \"a iff b;\",\n      \"a iff b or c;\",\n      \"a or b iff b;\",\n      \"a iff b iff c;\",\n\n      // Test elimination of implications\n      \"p imp q;\",\n      \"p imp not q;\",\n      \"not p imp not q;\",\n      \"p imp q and r;\",\n      \"p imp q imp r;\",\n      })\n  {\n    auto f(std::begin(input)), l(std::end(input));\n    parser&lt;decltype(f)&gt; p;\n\n    try\n    {\n      expr result;\n      bool ok = qi::phrase_parse(f,l,p &gt; ';',qi::space,result);\n\n      if (!ok)\n        std::cerr &lt;&lt; \"invalid input\\n\";\n      else\n        std::cout &lt;&lt; \"result: \" &lt;&lt; result &lt;&lt; \"\\n\";\n\n    } catch (const qi::expectation_failure&lt;decltype(f)&gt;&amp; e)\n    {\n      std::cerr &lt;&lt; \"expectation_failure at '\" &lt;&lt; std::string(e.first, e.last) &lt;&lt; \"'\\n\";\n    }\n\n    if (f!=l) std::cerr &lt;&lt; \"unparsed: '\" &lt;&lt; std::string(f,l) &lt;&lt; \"'\\n\";\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>Compiling command:</p>\n\n<pre><code>clang++ -std=c++11 -stdlib=libc++ -Weverything CNF_generator.cpp\n</code></pre>\n"}, {"tags": ["c#", "c++", "c"], "comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1450880563, "post_id": 34437686, "comment_id": 56616193, "body": "It&#39;s not C#, but Clang will probably help with this."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 4361260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaa8dadbfb7418733a5d5e1f942042f1?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Nouman", "link": "https://stackoverflow.com/users/4361260/muhammad-nouman"}, "edited": false, "score": 0, "creation_date": 1450883536, "post_id": 34437735, "comment_id": 56617909, "body": "That looks like perfect solution. But i am a beginner in C#. Can you please guide me how to use code over here ! <a href=\"https://github.com/SimonRichards/clang-sharp\" rel=\"nofollow noreferrer\">github.com/SimonRichards/clang-sharp</a>"}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 85, "user_id": 4361260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaa8dadbfb7418733a5d5e1f942042f1?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Nouman", "link": "https://stackoverflow.com/users/4361260/muhammad-nouman"}, "edited": false, "score": 0, "creation_date": 1450883773, "post_id": 34437735, "comment_id": 56618045, "body": "No, you need to learn the language before using it for your projects. I suggest reading <a href=\"https://rads.stackoverflow.com/amzn/click/com/073568183X\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">C# Step By Step</a> and then getting up-to-date with the latest C# standards."}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 85, "user_id": 4361260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaa8dadbfb7418733a5d5e1f942042f1?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Nouman", "link": "https://stackoverflow.com/users/4361260/muhammad-nouman"}, "edited": false, "score": 0, "creation_date": 1452187295, "post_id": 34437735, "comment_id": 57068074, "body": "@MuhammadNouman: if you are satisfied, do you mind accepting this answer so that the question can be marked as &quot;solved&quot;? Thanks."}], "tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": true, "score": 9, "last_activity_date": 1450880654, "creation_date": 1450880654, "answer_id": 34437735, "question_id": 34437686, "link": "https://stackoverflow.com/questions/34437686/parsing-a-c-c-c-file-in-c/34437735#34437735", "title": "Parsing a c/c++/c# file in c#", "body": "<p><code>libclang</code> is probably the easiest-to-use and most mature option to parse C++.</p>\n\n<p>There are several C# wrappers available - here are some results of a quick Google search:</p>\n\n<ul>\n<li><p><a href=\"http://www.clangsharp.org/\" rel=\"noreferrer\">http://www.clangsharp.org/</a></p></li>\n<li><p><a href=\"https://github.com/SimonRichards/clang-sharp\" rel=\"noreferrer\">https://github.com/SimonRichards/clang-sharp</a></p></li>\n</ul>\n"}], "owner": {"reputation": 85, "user_id": 4361260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaa8dadbfb7418733a5d5e1f942042f1?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Nouman", "link": "https://stackoverflow.com/users/4361260/muhammad-nouman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 0, "accepted_answer_id": 34437735, "answer_count": 1, "score": 1, "last_activity_date": 1450880654, "creation_date": 1450880451, "question_id": 34437686, "link": "https://stackoverflow.com/questions/34437686/parsing-a-c-c-c-file-in-c", "title": "Parsing a c/c++/c# file in c#", "body": "<p>I have a c file, which has many functions in it.</p>\n\n<p>I want to separate out each function and get all of them in a List(lets say, list_code), and also get name of each function in a different List(lets say, fun_code). E.g</p>\n\n<p>Lets say, a c file has following code:</p>\n\n<pre><code>void main()\n{\n//some code here\n}\n\nint count (int abc)\n{\n///some code here\n}\n\nint adder(int def)\n{\n///some code here\n}\n</code></pre>\n\n<p>I want the following two lists <strong>list_code</strong> and <strong>fun_code</strong> !!\nThe elements of <strong>list_code</strong> would be a list with three element, containing,</p>\n\n<ol>\n<li>void main()\n{\n//some code here\n}</li>\n<li>int count (int abc)\n{\n///some code here\n}</li>\n<li>int adder(int def)\n{\n///some code here\n}</li>\n</ol>\n\n<p>The elements of <strong>fun_code</strong> would be a list with three element, containing,</p>\n\n<ol>\n<li>void main() </li>\n<li>int count (int abc)</li>\n<li>int adder(int def)</li>\n</ol>\n\n<p>I have already written a code, which keep tracks of braces(\"{\" and \"}\") and separate out full functions. But it would fail, if comments contain braces. \nMoreover i wasn't able to get the function names this way.</p>\n\n<p>Kindly, let me know how can i achieve this. Any library or builtin functions would be of great help, as it would have taken care of all minor details like comments, new line and similar scenarios.</p>\n"}, {"tags": ["c++", "multithreading", "c++11"], "comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1450880968, "post_id": 34437566, "comment_id": 56616425, "body": "You really don&#39;t want to forward rvalue arguments <i>multiple times</i>. They&#39;ll get moved from the first time."}, {"owner": {"reputation": 205, "user_id": 4866991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b330586c0a34188163e3c16236f3c836?s=128&d=identicon&r=PG&f=1", "display_name": "ruser45381", "link": "https://stackoverflow.com/users/4866991/ruser45381"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1450881722, "post_id": 34437566, "comment_id": 56616856, "body": "What would suggest doing?"}], "answers": [{"comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1450880814, "post_id": 34437643, "comment_id": 56616339, "body": "Wait, what&#39;s wrong with <code>threads.push_back(std::make_shared &lt;std::thread&gt;(std::forward&lt;Fn&gt;(fn), thread_id, std::forward&lt;Args&gt;(args)...));</code>?"}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1450881044, "post_id": 34437643, "comment_id": 56616477, "body": "@T.C. I think he wants to call <code>fn</code> with <code>args...</code> <b>and</b> <code>thread_id</code> - at least, that&#39;s how I interpreted the question. Like <code>fn(thread_id, args...)</code> or <code>fn(args..., thread_id)</code>."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1450881086, "post_id": 34437643, "comment_id": 56616492, "body": "...and just sticking <code>thread_id</code> in the argument list of <code>std::thread</code>&#39;s constructor won&#39;t do that because...?"}, {"owner": {"reputation": 205, "user_id": 4866991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b330586c0a34188163e3c16236f3c836?s=128&d=identicon&r=PG&f=1", "display_name": "ruser45381", "link": "https://stackoverflow.com/users/4866991/ruser45381"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1450881141, "post_id": 34437643, "comment_id": 56616526, "body": "@T.C. Since the std::thread constructor expects two arguments the constructor you suggested doesn&#39;t work. I originally had the same thought!"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 205, "user_id": 4866991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b330586c0a34188163e3c16236f3c836?s=128&d=identicon&r=PG&f=1", "display_name": "ruser45381", "link": "https://stackoverflow.com/users/4866991/ruser45381"}, "edited": false, "score": 1, "creation_date": 1450881186, "post_id": 34437643, "comment_id": 56616557, "body": "@ruser45381 What crazy <code>std::thread</code> implementation are you using?"}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1450881200, "post_id": 34437643, "comment_id": 56616568, "body": "Whoops, @T.C. is correct - the <a href=\"http://en.cppreference.com/w/cpp/thread/thread/thread\" rel=\"nofollow noreferrer\"><code>std::thread</code> (3) constructor</a> does call the function with the passed variadic arguments. His solution should work properly."}, {"owner": {"reputation": 205, "user_id": 4866991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b330586c0a34188163e3c16236f3c836?s=128&d=identicon&r=PG&f=1", "display_name": "ruser45381", "link": "https://stackoverflow.com/users/4866991/ruser45381"}, "edited": false, "score": 0, "creation_date": 1450881312, "post_id": 34437643, "comment_id": 56616630, "body": "I&#39;m using mingw-64 on Windows 7 64-bit. If I try to add the thread_id directly to the argument list I get the error: &quot;Wrong number of arguments for function&quot; (in a huge heaping mess of template errors)"}, {"owner": {"reputation": 205, "user_id": 4866991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b330586c0a34188163e3c16236f3c836?s=128&d=identicon&r=PG&f=1", "display_name": "ruser45381", "link": "https://stackoverflow.com/users/4866991/ruser45381"}, "edited": false, "score": 0, "creation_date": 1450882634, "post_id": 34437643, "comment_id": 56617423, "body": "I just tried to compile this in g++ 5.2.1 and clang++ 3.6 (using libc++) in Ubuntu 15.10 and I get the same error as above. Note that when I mentioned thread_id previously I actually meant the loop counter. I&#39;m just being consistent with the other comments."}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 205, "user_id": 4866991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b330586c0a34188163e3c16236f3c836?s=128&d=identicon&r=PG&f=1", "display_name": "ruser45381", "link": "https://stackoverflow.com/users/4866991/ruser45381"}, "edited": false, "score": 0, "creation_date": 1450882955, "post_id": 34437643, "comment_id": 56617603, "body": "@ruser45381: could you please paste your compile log and your test code somewhere <i>(like pastie or pastebin)</i> and share it with us? A minimal example on an online compiler <i>(like godbolt, ideone or coliru)</i> would be even better."}, {"owner": {"reputation": 205, "user_id": 4866991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b330586c0a34188163e3c16236f3c836?s=128&d=identicon&r=PG&f=1", "display_name": "ruser45381", "link": "https://stackoverflow.com/users/4866991/ruser45381"}, "edited": false, "score": 0, "creation_date": 1450883286, "post_id": 34437643, "comment_id": 56617791, "body": "<a href=\"https://ideone.com/hZ405g\" rel=\"nofollow noreferrer\">ideone.com/hZ405g</a> here&#39;s a minimal example with an online compiler (note that I&#39;m using ideone c++14 compiler but it&#39;s the same error). Same error on godbolt using c++11 as well: <a href=\"https://goo.gl/LCyh03\" rel=\"nofollow noreferrer\">goo.gl/LCyh03</a>"}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 205, "user_id": 4866991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b330586c0a34188163e3c16236f3c836?s=128&d=identicon&r=PG&f=1", "display_name": "ruser45381", "link": "https://stackoverflow.com/users/4866991/ruser45381"}, "edited": false, "score": 0, "creation_date": 1450883656, "post_id": 34437643, "comment_id": 56617974, "body": "@ruser45381: well - it obviously doesn&#39;t compile because <code>test</code> requires two parameters: <code>void test(const size_t thread_id, int x)</code>. Calling <code>qthread(test, 5)</code> doesn&#39;t pass any argument to <code>test</code>&#39;s <code>x</code> parameter. Calling <code>qthread(test, 5, 1)</code> sets <code>thread_id = 5</code> and <code>x = 1</code> in the <code>test</code> function call, so it compiles properly. The number of passed arguments <b>needs</b> to match <code>test</code>&#39;s arity. Also, the reported <code>error: static_assert failed &quot;Wrong number of arguments for function&quot;</code> is pretty self-explanatory and not a <i>&quot;huge heaping mess of template errors&quot;</i> in my opinion."}, {"owner": {"reputation": 205, "user_id": 4866991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b330586c0a34188163e3c16236f3c836?s=128&d=identicon&r=PG&f=1", "display_name": "ruser45381", "link": "https://stackoverflow.com/users/4866991/ruser45381"}, "edited": false, "score": 0, "creation_date": 1450883853, "post_id": 34437643, "comment_id": 56618088, "body": "I&#39;m not sure I understand. Calling <code>qthread(test, 5)</code> <i>should</i> pass the correct arguments to <code>test</code>: <code>i</code>, the loop counter (for <code>thread_id</code>, the first argument) and <code>5</code>, the <code>x</code> value (the second argument), no?"}, {"owner": {"reputation": 205, "user_id": 4866991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b330586c0a34188163e3c16236f3c836?s=128&d=identicon&r=PG&f=1", "display_name": "ruser45381", "link": "https://stackoverflow.com/users/4866991/ruser45381"}, "reply_to_user": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1450884189, "post_id": 34437643, "comment_id": 56618274, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/98828/discussion-between-ruser45381-and-vittorio-romeo\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": true, "score": 4, "last_activity_date": 1450881858, "last_edit_date": 1495539892, "creation_date": 1450880307, "answer_id": 34437643, "question_id": 34437566, "link": "https://stackoverflow.com/questions/34437566/wrapping-additional-parameters-to-variadic-parameter-pack-in-c11/34437643#34437643", "title": "Wrapping additional parameters to variadic parameter pack in c++11", "body": "<p>As mentioned by <a href=\"https://stackoverflow.com/users/2756719/t-c\">T.C.</a> in the comments, there is <a href=\"http://en.cppreference.com/w/cpp/thread/thread/thread\" rel=\"nofollow noreferrer\">a <code>std::thread</code> constructor</a> with the following signature:</p>\n\n<pre><code>template&lt; class Function, class... Args &gt; \nexplicit thread( Function&amp;&amp; f, Args&amp;&amp;... args );\n</code></pre>\n\n<p>This constructor will call copy/move the function <code>f</code> and the arguments <code>args...</code> to its thread-accessible storage, then call <code>f(args...)</code> in the new thread.</p>\n\n<p>It is sufficient to use...</p>\n\n<pre><code>threads.push_back(\n    std::make_shared &lt;std::thread&gt;(\n        std::forward&lt;Fn&gt;(fn), thread_id, std::forward&lt;Args&gt;(args)...\n    )\n) \n</code></pre>\n\n<p>...to bind <code>thread_id</code> as an argument of <code>fn</code>.</p>\n\n<p>This will result in a function call similar to:</p>\n\n<pre><code>fn(thread_id, args...);\n</code></pre>\n\n<hr>\n\n<p><strong>In general</strong>, if you want to bind some arguments to a function and obtain a new callable object that will wrap the previous one, you want to use a lambda or a <code>struct</code>.</p>\n\n<p>C++14 example <em>(assuming the thread id is the first argument)</em>:</p>\n\n<pre><code>threads.push_back(\n    std::make_shared &lt;std::thread&gt;(\n        [thread_id, &amp;fn](auto&amp;&amp;... args) -&gt; decltype(auto)\n        { \n            // \"Bind\" `_thread_id` as first argument of `fn`.\n            return std::forward&lt;Fn&gt;(fn)(thread_id, \n                std::forward&lt;decltype(args)&gt;(args)...); \n        }, \n        std::forward&lt;Args&gt;(args)...\n    )\n);\n</code></pre>\n\n<hr>\n\n<p>C++11 example <em>(assuming the thread id is the first argument)</em>:</p>\n\n<pre><code>template&lt;typename TF&gt;\nstruct bind_thread_id\n{\n    TF _fn;\n    int _thread_id;\n\n    bind_thread_id(TF fn, int thread_id) \n        : _fn(fn), _thread_id(thread_id) \n    { \n    }\n\n    template&lt;typename... Ts&gt;\n    auto operator()(Ts&amp;&amp;... xs) \n    {\n        // \"Bind\" `_thread_id` as first argument of `fn`.\n        fn(_thread_id, std::forward&lt;Ts&gt;(xs)...);   \n    }\n};\n\n// ...\n\nthreads.push_back(\n    std::make_shared &lt;std::thread&gt;(\n        bind_thread_id&lt;Fn&gt;{fn, thread_id}, \n        std::forward&lt;Args&gt;(args)...\n    )\n);\n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 4866991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b330586c0a34188163e3c16236f3c836?s=128&d=identicon&r=PG&f=1", "display_name": "ruser45381", "link": "https://stackoverflow.com/users/4866991/ruser45381"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "accepted_answer_id": 34437643, "answer_count": 1, "score": 3, "last_activity_date": 1450881858, "creation_date": 1450880054, "last_edit_date": 1450880199, "question_id": 34437566, "link": "https://stackoverflow.com/questions/34437566/wrapping-additional-parameters-to-variadic-parameter-pack-in-c11", "title": "Wrapping additional parameters to variadic parameter pack in c++11", "body": "<p>Based on my previous question <a href=\"https://stackoverflow.com/questions/34422625/c11-thread-wrapper-with-parameter-forwarding\">here</a>, I am writing a small class to help me distribute work to a bunch of threads. While constructing the thread I would like to pass a loop counter as an additional parameter to the parameter pack to be used as a thread_id. Is this possible?</p>\n\n<p><code>qthread.h</code>:</p>\n\n<pre><code>#ifndef QTHREAD_H\n#define QTHREAD_H\n\n#include &lt;vector&gt;\n#include &lt;thread&gt;\n#include &lt;memory&gt;\n\nclass qthread\n{\n    std::vector &lt;std::shared_ptr &lt;std::thread&gt;&gt; threads;\npublic:\n    // Constructor\n    template &lt;class Fn, class... Args&gt;\n    qthread(Fn&amp;&amp; fn, Args&amp;&amp;... args)\n    {\n        size_t maxNumThreads = std::thread::hardware_concurrency() - 1;\n        for(size_t i = 0; i &lt; maxNumThreads; i++)\n        {\n            // While constructing the thread I would like to also pass i as a thread_id to the function in the parameter packing\n            threads.push_back(std::make_shared &lt;std::thread&gt;(std::forward&lt;Fn&gt;(fn), std::forward&lt;Args&gt;(args)...));\n        }\n    }\n    // Destructor\n    ~qthread()\n    {\n        for(auto thr_p:threads)\n        {\n            thr_p-&gt;join();\n        }\n    }\n};\n\n#endif /* QTHREAD_H */\n</code></pre>\n\n<p><code>main.cpp</code>:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n#include \"qthread.h\"\n\nvoid test(const size_t thread_id, int x)\n{\n    for(size_t i=0; i &lt; 1000; i++)\n    {\n        x += i;\n    }\n    std::cout &lt;&lt; \"thread: \" &lt;&lt; thread_id &lt;&lt; \", total: \" &lt;&lt; x &lt;&lt; \"\\n\";\n}\n\nint main()\n{\n    qthread(test, 5); // Distribute the 'test' task to n threads -- note that this doesn't work in this case since the function requires two parameters\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 3, "creation_date": 1450880355, "post_id": 34437557, "comment_id": 56616082, "body": "<a href=\"http://stackoverflow.com/q/25953542/995714\">callback function: difference between <code>void(*func)(int)</code> and <code>void(func)(int)</code></a>"}, {"owner": {"reputation": 2089, "user_id": 3629438, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/2pkry.png?s=128&g=1", "display_name": "acupofjose", "link": "https://stackoverflow.com/users/3629438/acupofjose"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1450880430, "post_id": 34437557, "comment_id": 56616121, "body": "@L\u01b0uV\u0129nhPh&#250;c if you believe this is a duplicate, you should flag it as such"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1450880603, "post_id": 34437557, "comment_id": 56616217, "body": "It isn&#39;t a duplicate. That question is about a function parameter that is declared with a function type."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1450880817, "post_id": 34437557, "comment_id": 56616341, "body": "Related (not duplicate, though the answer mentions function types in passing): <a href=\"http://stackoverflow.com/q/19200513/364696\">Function pointer vs Function reference</a>"}], "answers": [{"comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1450881041, "post_id": 34437680, "comment_id": 56616474, "body": "Note: In (just about?) every scenario but C++ template substitution and the trivial case of &quot;calling a function directly&quot;, <a href=\"http://stackoverflow.com/a/19200555/364696\">a function type degrades to a function pointer when used</a>, so there is no difference. And I&#39;d suspect in the template case, where the function is part of the template definition, the compiler would inline and undo the function pointeriness if it can (if it&#39;s not actually using a variable storing a non-constexpr function pointer)."}, {"owner": {"reputation": 547, "user_id": 1322848, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f9787a9df41c4727933f734ef9b4a64b?s=128&d=identicon&r=PG", "display_name": "Derek", "link": "https://stackoverflow.com/users/1322848/derek"}, "edited": false, "score": 0, "creation_date": 1450881393, "post_id": 34437680, "comment_id": 56616669, "body": "can I have a var of type void(int), and how to assign a value to it?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 547, "user_id": 1322848, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f9787a9df41c4727933f734ef9b4a64b?s=128&d=identicon&r=PG", "display_name": "Derek", "link": "https://stackoverflow.com/users/1322848/derek"}, "edited": false, "score": 0, "creation_date": 1450881599, "post_id": 34437680, "comment_id": 56616788, "body": "@Derek: No, you cannot have variables of function type, you cannot have prvalues of function type, and the return value of a function must not be a function type."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 547, "user_id": 1322848, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f9787a9df41c4727933f734ef9b4a64b?s=128&d=identicon&r=PG", "display_name": "Derek", "link": "https://stackoverflow.com/users/1322848/derek"}, "edited": false, "score": 0, "creation_date": 1450881935, "post_id": 34437680, "comment_id": 56616985, "body": "@Derek: You can&#39;t have a variable of type <code>void(int)</code>, but you can have a <i>function</i> of that type."}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": true, "score": 16, "last_activity_date": 1450884247, "last_edit_date": 1450884247, "creation_date": 1450880438, "answer_id": 34437680, "question_id": 34437557, "link": "https://stackoverflow.com/questions/34437557/difference-between-voidint-void-int/34437680#34437680", "title": "difference between void(int) &amp; void (*)(int)", "body": "<p>If <code>T</code> is a type, then <code>T*</code> denotes the type \"pointer-to-<code>T</code>\".</p>\n\n<p>The type <code>void(int)</code> is a <em>function type</em>, it's the type of a function taking one <code>int</code> and returning <code>void</code>. For example, it is the type of <code>f</code> if <code>f</code> is declared as <code>void f(int);</code></p>\n\n<p>If <code>T = void(int)</code>, then <code>T*</code> is spelled <code>void(*)(int)</code>, so the latter is the type of a <em>function pointer</em>. You can also form a reference to a function, which is <code>T&amp; = void(&amp;)(int)</code>; this is occasionally more useful (e.g. you can take the address of a function lvalue).</p>\n\n<hr>\n\n<p>Aside note: Function lvalues <em>decay</em> to their function pointer very easily. You can call a function either via a function lvalue or via a function pointer. When used as an operand for the indirection operator (<code>*</code>), the function value decays, so you can dereference the pointer again and again:</p>\n\n<pre><code>printf(\"Hello world\\n\");        // OK\n(*printf)(\"Hello world\\n\");     // also OK\n(****printf)(\"Hello world\\n\");  // four-star programmer\n</code></pre>\n\n<p>Some of the only times that a function does not decay is when used as the operand of the address-of operator, or when bound to a reference:</p>\n\n<pre><code>void f(int);          // our example function\n\nvoid(*p1)(int) = &amp;f;  // no decay of \"f\" here\nvoid(*p2)(int) = f;   // \"f\" decays\nvoid(&amp;r1)(int) = f;   // no decay of \"f\" here\n\nvoid g(void(&amp;callback)(int), int n) {\n  callback(n);\n}\ng(f, 10);             // no decay of \"f\" here\n\ntemplate &lt;typename F, typename ...Args&gt;\ndecltype(auto) h(F&amp;&amp; callback, Args&amp;&amp;... args) {\n    return std::forward&lt;F&gt;(callback)(std::forward&lt;Args&gt;(args)...);\n}\nh(f, 10);             // no decay of \"f\" here\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1457, "user_id": 2326817, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/x4kjE.jpg?s=128&g=1", "display_name": "Karel Kubat", "link": "https://stackoverflow.com/users/2326817/karel-kubat"}, "is_accepted": false, "score": 8, "last_activity_date": 1450880696, "creation_date": 1450880696, "answer_id": 34437747, "question_id": 34437557, "link": "https://stackoverflow.com/questions/34437557/difference-between-voidint-void-int/34437747#34437747", "title": "difference between void(int) &amp; void (*)(int)", "body": "<pre><code>void (*whatever)(int) \n</code></pre>\n\n<p>should be read as: whatever is a pointer, pointing to a function, that accepts one int as argument, and returns nothing (ie., void).</p>\n\n<pre><code>void whatever(int)\n</code></pre>\n\n<p>should be read as: whatever is a function (NOT a pointer), that accepts one int as argument, and returns nothing (ie., void)</p>\n\n<p>Once the pointer to a function is initialized to point to a valid function (one that satisfies the prototype), then you can invoke the function either through its \"real\" name, or through the pointer.</p>\n\n<p>Pointers to functions are very useful - they're variables, just like anything else, so you can pass them around to other functions (see e.g. qsort()), you can put them in structs, etc..</p>\n\n<p>Given this, the following code is valid:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid myfun(int x) {\n  printf(\"The value of X is %d\\n\", x);\n}\n\nint main() {\n    void (*myfunp)(int);\n\n    myfunp = &amp;myfun;\n\n    myfun(13);\n    myfunp(12);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29080, "user_id": 1084174, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BsASP.png?s=128&g=1", "display_name": "Sazzad Hissain Khan", "link": "https://stackoverflow.com/users/1084174/sazzad-hissain-khan"}, "is_accepted": false, "score": 3, "last_activity_date": 1450881611, "creation_date": 1450881611, "answer_id": 34438032, "question_id": 34437557, "link": "https://stackoverflow.com/questions/34437557/difference-between-voidint-void-int/34438032#34438032", "title": "difference between void(int) &amp; void (*)(int)", "body": "<p><code>void(*)(int)</code> should be read as type of a pointer which is pointing to a <code>function</code>, that accepts one <code>int</code> as argument, and returns nothing.</p>\n\n<p>For understanding more on function to pointer and its usage please check here: <a href=\"http://www.cprogramming.com/tutorial/function-pointers.html\" rel=\"nofollow\">http://www.cprogramming.com/tutorial/function-pointers.html</a></p>\n"}], "owner": {"reputation": 547, "user_id": 1322848, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f9787a9df41c4727933f734ef9b4a64b?s=128&d=identicon&r=PG", "display_name": "Derek", "link": "https://stackoverflow.com/users/1322848/derek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8574, "favorite_count": 4, "accepted_answer_id": 34437680, "answer_count": 3, "score": 14, "last_activity_date": 1450889052, "creation_date": 1450880034, "last_edit_date": 1450889052, "question_id": 34437557, "link": "https://stackoverflow.com/questions/34437557/difference-between-voidint-void-int", "title": "difference between void(int) &amp; void (*)(int)", "body": "<p>I know <code>void (*)(int)</code> is to function pointer but what is <code>void(int)</code>? </p>\n\n<p>It's used for <code>std::function</code> template. </p>\n\n<p>Say I have a function <code>void fun(int){}</code> : <code>decltype(&amp;fun)</code> gives <code>void(*)(int)</code> but <code>decltype(fun)</code> gives <code>void(int)</code></p>\n"}, {"tags": ["c++", "c", "windows", "winapi"], "comments": [{"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "edited": false, "score": 1, "creation_date": 1450880446, "post_id": 34437470, "comment_id": 56616129, "body": "I think that when you use this function you should already know that the section exist, because it is intended to retrive the value associated with the key. Maybe there is another function that check for the section?"}, {"owner": {"reputation": 159, "user_id": 1013092, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4944696ddf439c1e5265a3e210c01898?s=128&d=identicon&r=PG", "display_name": "ChrisJ", "link": "https://stackoverflow.com/users/1013092/chrisj"}, "reply_to_user": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "edited": false, "score": 0, "creation_date": 1450882022, "post_id": 34437470, "comment_id": 56617031, "body": "As Martin Bonner reminded me below, there is a function that can be used to read in the full section. I&#39;ll try us this and see if it helps."}, {"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "edited": false, "score": 1, "creation_date": 1450882249, "post_id": 34437470, "comment_id": 56617186, "body": "Yes, I think is the correct way to do this, see also GetPrivateProfileSectionNames that returns all the section names."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1450886037, "post_id": 34437470, "comment_id": 56619516, "body": "The <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms724345.aspx\" rel=\"nofollow noreferrer\">documentation</a> doesn&#39;t say, that the last error code is set to any specific value in case a key cannot be retrieved. Don&#39;t rely on it, as the behavior can change without prior notice."}, {"owner": {"reputation": 159, "user_id": 1013092, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4944696ddf439c1e5265a3e210c01898?s=128&d=identicon&r=PG", "display_name": "ChrisJ", "link": "https://stackoverflow.com/users/1013092/chrisj"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1450886978, "post_id": 34437470, "comment_id": 56620073, "body": "@IInspectable, it mentions it in the documentation for <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms724353(v=vs.85).aspx\" rel=\"nofollow noreferrer\">GetPrivateProfileString()</a> which I am also using. Anyway, neither work and I&#39;m going with the solution suggested by others."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1450887386, "post_id": 34437470, "comment_id": 56620328, "body": "Do what msdn says and stop using these functions. It&#39;s nearly 2016. You were meant to stop 20 years ago."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1450889504, "post_id": 34437470, "comment_id": 56621651, "body": "@DavidHeffernan: Good advice, in general. Not so good, when the question is about maintaining a legacy application. This is true in particular, since there is no recommended replacement for the functionality in question: Storing information in configuration files alongside the application."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1450892854, "post_id": 34437470, "comment_id": 56623551, "body": "@IInspectable there are many good libraries for working with ini files"}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 1013092, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4944696ddf439c1e5265a3e210c01898?s=128&d=identicon&r=PG", "display_name": "ChrisJ", "link": "https://stackoverflow.com/users/1013092/chrisj"}, "edited": false, "score": 0, "creation_date": 1450880730, "post_id": 34437644, "comment_id": 56616283, "body": "The values of this INI file are not mapped to the registry. It is located in application directory, and contains information relating to the application but it is not initialisation information. These keys or sections will only be there if the user enables a specific function of the app (I know, bad design, but it&#39;s what I have to work with). So I would like to find out programmatically what is causing the default value to be returned so I can handle it."}, {"owner": {"reputation": 159, "user_id": 1013092, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4944696ddf439c1e5265a3e210c01898?s=128&d=identicon&r=PG", "display_name": "ChrisJ", "link": "https://stackoverflow.com/users/1013092/chrisj"}, "edited": false, "score": 0, "creation_date": 1450881249, "post_id": 34437644, "comment_id": 56616597, "body": "The tip to use GetPrivateProfileSection to check if the section exists first is a good one. I know the file should exist, otherwise there would be a much, much bigger issue. I&#39;ll try this. Thanks."}], "tags": [], "owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1450880308, "creation_date": 1450880308, "answer_id": 34437644, "question_id": 34437470, "link": "https://stackoverflow.com/questions/34437470/how-to-know-why-getprivateprofileint-string-fail/34437644#34437644", "title": "How to know why GetPrivateProfileInt/String fail", "body": "<p>If GetLastError() won't help, then you need to do some detective work.  You should check yourself if the registry key or file exists (you know that most ini files are mapped to the registry, right?), or if the section doesn't exist (GetPrivateProfileSection), and if neither of those apply, then the key doesn't exist.</p>\n"}], "owner": {"reputation": 159, "user_id": 1013092, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4944696ddf439c1e5265a3e210c01898?s=128&d=identicon&r=PG", "display_name": "ChrisJ", "link": "https://stackoverflow.com/users/1013092/chrisj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1762, "favorite_count": 0, "accepted_answer_id": 34437644, "answer_count": 1, "score": 1, "last_activity_date": 1450886243, "creation_date": 1450879755, "last_edit_date": 1450886243, "question_id": 34437470, "link": "https://stackoverflow.com/questions/34437470/how-to-know-why-getprivateprofileint-string-fail", "title": "How to know why GetPrivateProfileInt/String fail", "body": "<p>I am working on a piece of code in the old application, using C++ in Visual Studio 2008. It attempts to read some values from an INI file, and I'm trying to do some error handling in the case of the section or key I am trying to read does not exist in the file. </p>\n\n<p>Here is the code snippet:</p>\n\n<pre><code>int nValue = GetPrivateProfileInt (SECTION, KEY, -1, sINIFile);\nif(nValue == -1)  // default value\n{\n    int nLastError = GetLastError();\n    if(nLastError != 0)\n    {\n        // do something\n    }\n}\n</code></pre>\n\n<p>sINIFile contains the full path to my required INI file.</p>\n\n<p>After some testing, I've found that GetLastError() returns 2 (ERROR_FILE_NOT_FOUND) if:</p>\n\n<ol>\n<li><p>the file doesn't exist OR,</p></li>\n<li><p>the section doesn't exist OR,</p></li>\n<li><p>the key doesn't exist. </p></li>\n</ol>\n\n<p>I would like to know the specific reason the GetPrivateProfileInt returned the default value - is this possible?</p>\n\n<p>Note: I've looked into checking the value of 'errno' (or errorno, as it says on the MSDN page) but this is always 0 for any of the above cases. </p>\n"}, {"tags": ["c++", "ios", "qt", "qml", "qquickview"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5711323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8090d793966d82a7785a57aec8a26560?s=128&d=identicon&r=PG&f=1", "display_name": "Jian", "link": "https://stackoverflow.com/users/5711323/jian"}, "edited": false, "score": 0, "creation_date": 1451566700, "post_id": 34442397, "comment_id": 56835217, "body": "Sorry for the late feedback because it&#39;s Christmas and New year time :). The <code>layout</code> in my code was <code>QVBoxLayout</code>, but i have tested with both <code>QHBoxLayout</code> and <code>QVBoxLayout</code> and <code>Qt::AlignRight</code>, but it has not changed at all. It&#39;s odd because the &quot;html window&quot; is actually there on the right where it should be, but its content not. It seems like the container doesn&#39;t have the right parent, but when I output <code>container-&gt;parent()</code>, it it correct. Do you know where can I be doing wrong?"}], "tags": [], "owner": {"reputation": 7482, "user_id": 313175, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/17983e85ea926e9e985c00d1a771f24a?s=128&d=identicon&r=PG", "display_name": "Alexander V", "link": "https://stackoverflow.com/users/313175/alexander-v"}, "is_accepted": false, "score": 0, "last_activity_date": 1450899343, "last_edit_date": 1450899343, "creation_date": 1450898643, "answer_id": 34442397, "question_id": 34437190, "link": "https://stackoverflow.com/questions/34437190/qml-qt-c-qquickview-in-a-widget-cant-get-the-position-right/34442397#34442397", "title": "Qml/Qt/C++: QQuickView in a Widget, can&#39;t get the position right", "body": "<p>The visibility of the author's code is maybe not enough but overall it is easier to set the widget in layout with certain alignment. This way you command the widget to be on certain side and make the placement not to depend on coordinates / host widget size etc. The <code>layout</code> variable is assumed to be horizontal box layout or QHBoxLayout.</p>\n\n<pre><code>// make sure that QHBoxLayout* layout = new QHBoxLayout(this);\n// or set the horizontal layout somehow else\nQQuickView *view = new QQuickView();\nQWidget *container = QWidget::createWindowContainer(view, this);\n\ncontainer-&gt;serFixedWidth(200); // the layout is horizontal\n                               // and we *may* want to fix the width\n\ncontainer-&gt;setFocusPolicy(Qt::TabFocus);\nview-&gt;setSource(QUrl(\"qrc:///webview.qml\"));\nlayout-&gt;addWidget(container, Qt::AlignRight); // align to the right\n</code></pre>\n\n<p>Mind that the rest of <em>horizontal</em> layout should be filled like that with respecting relative positions in it.</p>\n"}], "owner": {"reputation": 63, "user_id": 5711323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8090d793966d82a7785a57aec8a26560?s=128&d=identicon&r=PG&f=1", "display_name": "Jian", "link": "https://stackoverflow.com/users/5711323/jian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1098, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450899343, "creation_date": 1450878797, "last_edit_date": 1450898672, "question_id": 34437190, "link": "https://stackoverflow.com/questions/34437190/qml-qt-c-qquickview-in-a-widget-cant-get-the-position-right", "title": "Qml/Qt/C++: QQuickView in a Widget, can&#39;t get the position right", "body": "<p>I'am implementing a simple program with QT5.5 which contains a HTML window (QWebview) like the following screenshot:</p>\n\n<p><a href=\"http://i.stack.imgur.com/7iPGH.png\" rel=\"nofollow\">HTML window on the right side</a></p>\n\n<p>Now I want the program also installed for iOS e.g. for iPad. I found that the QWebview class isn't available for mobile system, so I had to change my HTML window to QQuickView with QML files (or is there a better way?). I found the following code online:</p>\n\n<pre><code>QQuickView *view = new QQuickView();\nQWidget *container = QWidget::createWindowContainer(view, this);\ncontainer-&gt;setMinimumSize(200,400);\ncontainer-&gt;setMaximumSize(200,400);\ncontainer-&gt;setFocusPolicy(Qt::TabFocus);\nview-&gt;setSource(QUrl(\"qrc:///webview.qml\"));\nlayout-&gt;addWidget(container);\n</code></pre>\n\n<p>Then i added the container to the mainWindow.\nThe webview.qml:</p>\n\n<pre><code>import QtQuick 2.5\nimport QtWebView 1.0\nRectangle {\nid: rectangle\nwidth: 200\nheight: 400\nWebView {\n    id: webview\n    url: \"file:///test.html\"\n    anchors.fill: parent\n    width: 200\n    height: 400\n}\n}\n</code></pre>\n\n<p>But somehow I can't get the layout right. \n<a href=\"http://i.stack.imgur.com/FeT9L.png\" rel=\"nofollow\">HTML window on iOS</a>\nThere is a blank/white rectangle behind the container, and the container is also not in the HTML window on the right side where it should be. When I change the width and the height of the rectangle in the qml file, it only changes the size of the webview, not the white background.</p>\n\n<p>Can anyone tell me, how can I get this right? I have also used <code>container-&gt;setParent()</code> but the view is always on the left.</p>\n"}, {"tags": ["c++", "directx"], "comments": [{"owner": {"reputation": 916, "user_id": 2242745, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0474fd0e62b23df1b5b339fa622895b?s=128&d=identicon&r=PG", "display_name": "kbz", "link": "https://stackoverflow.com/users/2242745/kbz"}, "reply_to_user": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1450879259, "post_id": 34437153, "comment_id": 56615464, "body": "How do I construct the grid correctly. If you look on the right side of the grid, there is a bug and it&#39;s not drawn correctly. The left of the grid is fine."}, {"owner": {"reputation": 916, "user_id": 2242745, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0474fd0e62b23df1b5b339fa622895b?s=128&d=identicon&r=PG", "display_name": "kbz", "link": "https://stackoverflow.com/users/2242745/kbz"}, "reply_to_user": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1450879739, "post_id": 34437153, "comment_id": 56615739, "body": "The code provided generates the vertex and index buffers for this grid, then I use them buffers to draw it but there is an error somewhere in the generation which causes the problem in the image."}, {"owner": {"reputation": 916, "user_id": 2242745, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0474fd0e62b23df1b5b339fa622895b?s=128&d=identicon&r=PG", "display_name": "kbz", "link": "https://stackoverflow.com/users/2242745/kbz"}, "reply_to_user": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1450879835, "post_id": 34437153, "comment_id": 56615801, "body": "I thought so too, but clearly something is going wrong."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1450882192, "post_id": 34437153, "comment_id": 56617151, "body": "What is the problem in the image?"}, {"owner": {"reputation": 916, "user_id": 2242745, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0474fd0e62b23df1b5b339fa622895b?s=128&d=identicon&r=PG", "display_name": "kbz", "link": "https://stackoverflow.com/users/2242745/kbz"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1450882677, "post_id": 34437153, "comment_id": 56617443, "body": "@MartinBonner I have updated my original post with what the final product should look like."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1450882802, "post_id": 34437153, "comment_id": 56617513, "body": "@user: I am clearly being dumb.  How does that differ from your result?  Another graphic with just 18 incorrect triangles might help."}, {"owner": {"reputation": 916, "user_id": 2242745, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0474fd0e62b23df1b5b339fa622895b?s=128&d=identicon&r=PG", "display_name": "kbz", "link": "https://stackoverflow.com/users/2242745/kbz"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1450884759, "post_id": 34437153, "comment_id": 56618635, "body": "@MartinBonner That&#39;s the issue. I cannot draw a small grid with any problems just to demonstrate what&#39;s going on. I am able to draw a 200x200 grid perfectly, no issues. Then I tried with a 300x300 and it messes up. I think I&#39;ve found the issue. Anything over 256x256 causes the issue"}], "answers": [{"comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1450885238, "post_id": 34439039, "comment_id": 56618991, "body": "The clue was that it went wrong as you got larger.  Looking at your values, you were going over 8 bits for the number of a vertices on a side, and over 16 bits for the total count. ... Then I saw WORD."}], "tags": [], "owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1450885092, "creation_date": 1450885092, "answer_id": 34439039, "question_id": 34437153, "link": "https://stackoverflow.com/questions/34437153/how-to-correctly-draw-a-flat-grid-of-triangles-for-terrain-direct-x-11-c/34439039#34439039", "title": "How to correctly draw a flat grid of triangles for terrain direct x 11 C++", "body": "<p><code>WORD</code> is a 16-bit unsigned integer with a maximum value of 65535.  With a 300x300 grid you have 90,000 vertices, so you can't index them all with a <code>WORD</code>.</p>\n"}], "owner": {"reputation": 916, "user_id": 2242745, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0474fd0e62b23df1b5b339fa622895b?s=128&d=identicon&r=PG", "display_name": "kbz", "link": "https://stackoverflow.com/users/2242745/kbz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1181, "favorite_count": 0, "accepted_answer_id": 34439039, "answer_count": 1, "score": 1, "last_activity_date": 1450885136, "creation_date": 1450878681, "last_edit_date": 1450885136, "question_id": 34437153, "link": "https://stackoverflow.com/questions/34437153/how-to-correctly-draw-a-flat-grid-of-triangles-for-terrain-direct-x-11-c", "title": "How to correctly draw a flat grid of triangles for terrain direct x 11 C++", "body": "<p>I'm trying to draw a grid of triangles for the first part of my terrain mapping but there is a slight error and I'm not sure where I'm going wrong. Could someone please point out my error or explain how to correctly construct this grid.</p>\n\n<p>To clarify, look at the right side of the grid, that shouldn't happen.</p>\n\n<p>Vertices:</p>\n\n<pre><code>vector&lt;Vertex&gt; Terrain::generateVertices(int width, int height) {\n    vector&lt;Vertex&gt; vertices;\n    Vertex v;\n    float du = 1.0f / (width - 1);\n    float dv = 1.0f / (height - 1);\n    for (int r = 0; r &lt; width; ++r) {\n        for (int c = 0; c &lt; height; ++c) {\n            v.Pos = XMFLOAT3((float)c, (float)r, 0.0f);\n            v.Normal = XMFLOAT3(0.0f, 0.0f, 0.0f);\n            v.TextureCoordinate = XMFLOAT2(c * du, r * dv);\n            vertices.push_back(v);\n        }\n    }\n    return vertices;\n}\n</code></pre>\n\n<p>Indices:</p>\n\n<pre><code>vector&lt;WORD&gt; Terrain::generateIndices(int width, int height) {\n    vector&lt;WORD&gt; indices;\n    for (int r = 0; r &lt; width; ++r) {\n        for (int c = 0; c &lt; height; ++c) {\n            indices.push_back(r * height + c);\n            indices.push_back(r * height + (c + 1));\n            indices.push_back((r + 1)*height + c);\n\n            indices.push_back((r + 1) * height + c);\n            indices.push_back((r * height + (c + 1)));\n            indices.push_back((r + 1) * height + (c + 1));\n        }\n    }\n    return indices;\n}\n</code></pre>\n\n<p>Outcome: <a href=\"https://i.gyazo.com/9d73a2cbf3091a649f2a533c9a9710d2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.gyazo.com/9d73a2cbf3091a649f2a533c9a9710d2.png\" alt=\"enter image description here\"></a></p>\n\n<p>When I draw a small grid, for example, 10x10, it comes out exactly how it should</p>\n\n<p><a href=\"https://i.stack.imgur.com/fyKZR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fyKZR.png\" alt=\"enter image description here\"></a></p>\n\n<p>When I draw a larger grid, 512x512 to cover my terrain, that's when the issues occur with the indices/vertices</p>\n\n<p>Edit: I believe I have found the problem, but I'm not sure how to solve it. I can draw a grid up to 256x256, but anything over that will give me these graphical issues.</p>\n"}, {"tags": ["c++", "pointers", "reference", "constants"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1450878720, "post_id": 34437126, "comment_id": 56615117, "body": "Make the signature <code>setDataRef(const T* p)</code>, then it&#39;s the user&#39;s problem how they come by a pointer."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1450878748, "post_id": 34437126, "comment_id": 56615138, "body": "And why have a <code>nullobj</code> when you could just leave <code>r_obj</code> null?"}, {"owner": {"reputation": 5309, "user_id": 877329, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0b5c9fa7b8fa8139c1330b5fbbd5f934?s=128&d=identicon&r=PG", "display_name": "user877329", "link": "https://stackoverflow.com/users/877329/user877329"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1450878860, "post_id": 34437126, "comment_id": 56615199, "body": "@KerrekSB but then I may get nullptr. For the other question: Null Object Pattern [ useful to avoid <code>if(r_obj!=nullptr)</code> ... ]"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1450878899, "post_id": 34437126, "comment_id": 56615226, "body": "You can make a copy of the <code>obj</code> parameter."}, {"owner": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 3, "creation_date": 1450878916, "post_id": 34437126, "comment_id": 56615234, "body": "@user877329 A user passing null would be a violation of the contract of the function, that is their problem. To be helpful, you could assert on it."}, {"owner": {"reputation": 5309, "user_id": 877329, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0b5c9fa7b8fa8139c1330b5fbbd5f934?s=128&d=identicon&r=PG", "display_name": "user877329", "link": "https://stackoverflow.com/users/877329/user877329"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1450879017, "post_id": 34437126, "comment_id": 56615298, "body": "@YSC, which implies a copy of the object, which may be not good."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 0, "creation_date": 1450879035, "post_id": 34437126, "comment_id": 56615306, "body": "@BoBTFish: Agreed. Asserting on a a pointer value is at least <i>possible</i>, wheras asserting on the continued lifetime of a temporary is not."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1450879108, "post_id": 34437126, "comment_id": 56615355, "body": "Yes, a copy generally implies a copy xD. I&#39;m not saying it&#39;s a good solution, just that it should be considerd. After all, <code>std::vector::push_back()</code> does a copy."}, {"owner": {"reputation": 7737, "user_id": 3410396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc26b280cedaa721d90828a80e39706?s=128&d=identicon&r=PG&f=1", "display_name": "Revolver_Ocelot", "link": "https://stackoverflow.com/users/3410396/revolver-ocelot"}, "edited": false, "score": 0, "creation_date": 1450879126, "post_id": 34437126, "comment_id": 56615364, "body": "BTW, passing a reference does not guarantee that it points to valid object (dangling references) or to object with <a href=\"http://coliru.stacked-crooked.com/a/eeea0b3fc6602f8e\" rel=\"nofollow noreferrer\">address different from 0</a> (second one invokes UB)."}, {"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 0, "creation_date": 1450880499, "post_id": 34437126, "comment_id": 56616162, "body": "Whatever you do, you should make it clear the caller has responsibility to ensure the lifetime of the referenced object. Clearly, passing a temporary is a complete failure in ensuring the lifetime."}], "answers": [{"comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1450879269, "post_id": 34437261, "comment_id": 56615472, "body": "I learnt something. I always assumed in this case <code>setDataRef(const T&amp; obj)</code>would be called. <a href=\"http://coliru.stacked-crooked.com/a/f99aef5c60bc0234\" rel=\"nofollow noreferrer\">It does not even compile :) (Demo)</a>"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 3, "creation_date": 1450879657, "post_id": 34437261, "comment_id": 56615700, "body": "But beware; errors are still possible.  If you pass a reference to a Foo object into a function, and set the data reference to a local variable inside the function, and then return from the function - the reference will no longer be valid."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 1, "creation_date": 1450879778, "post_id": 34437261, "comment_id": 56615763, "body": "That goes without saying. C++ does not forbid the developer to purposely crash the application."}, {"owner": {"reputation": 5309, "user_id": 877329, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0b5c9fa7b8fa8139c1330b5fbbd5f934?s=128&d=identicon&r=PG", "display_name": "user877329", "link": "https://stackoverflow.com/users/877329/user877329"}, "edited": false, "score": 0, "creation_date": 1450945009, "post_id": 34437261, "comment_id": 56640632, "body": "@MarinBonner The idea is that removing the possibility of passing a temporary gives a good documentation that the object must survive the function call, and the next larger scope is then the lifetime of the class."}], "tags": [], "owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "is_accepted": true, "score": 6, "last_activity_date": 1450879008, "creation_date": 1450879008, "answer_id": 34437261, "question_id": 34437126, "link": "https://stackoverflow.com/questions/34437126/force-non-null-while-preserving-constness/34437261#34437261", "title": "Force non-null while preserving constness", "body": "<p>In old C++ I think this was impossible, but with C++11 we can do:</p>\n\n<pre><code>class Foo\n{\npublic:\n    Foo()\n       : r_obj(&amp;nullobj)\n    {}\n\n    void setDataRef(const T&amp; obj)\n    {\n        r_obj = &amp;obj;\n    }\n    void setDataRef(T&amp;&amp; obj) = delete;   // Crucial extra line\n\nprivate:\n    static T nullobj;\n    const T* r_obj;\n};\n</code></pre>\n\n<p>If somebody tries to pass a temporary to <code>setDataRef</code>, overload resolution will prefer the <code>T&amp;&amp;</code> version but because it is deleted, the call is ill-formed.  If somebody passes an lvalue, that will bind to the const reference.</p>\n"}, {"comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1450882489, "post_id": 34437821, "comment_id": 56617337, "body": "<code>weak_ptr</code> is very interesting, because it <i>does</i> allow handling the lifetime issue.  (By always referring to nullobj if the lock fails)."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 4, "last_activity_date": 1450880910, "creation_date": 1450880910, "answer_id": 34437821, "question_id": 34437126, "link": "https://stackoverflow.com/questions/34437126/force-non-null-while-preserving-constness/34437821#34437821", "title": "Force non-null while preserving constness", "body": "<p>Martin's suggestion is very nice and does prevent the caller from passing an rvalue to the function. But that still won't guarantee that the lifetime of the passed object extends beyond the lifetime of the <code>Foo</code> instance.</p>\n\n<p>If the object stores a pointer to the passed object, it would be most intuitive, if a pointer were passed to the setter. Passing a pointer also prevents using an rvalue (because taking an address of an rvalue is not allowed).</p>\n\n<p>Just like you have to document the interface that the passed object must exist as long as <code>Foo</code> instance exists, you can also document that the passed pointer must not be null. Additionally, you can assert it. You could similarly delete the overload for <code>nullptr_t</code> to prevent passing the literal to the setter but that won't prevent passing null pointers of <code>T*</code> type. In my opinion, the advantage of the reference setter is not great.</p>\n\n<p>Of course, neither raw pointer, nor a reference tell the caller anything about ownership, so that must in either case be documented. Instead, I would recommend storing and passing a smart pointer. <code>unique_ptr</code> if <code>Foo</code> should have the ownership (apparently not), <code>shared_ptr</code> if <code>Foo</code> should keep the object alive if it goes out of scope elsewhere, or possibly <code>weak_ptr</code> if <code>Foo</code> should have a failure mode when referred object no longer exists. A smart pointer would be self documenting and intuitive for the user.</p>\n"}], "owner": {"reputation": 5309, "user_id": 877329, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0b5c9fa7b8fa8139c1330b5fbbd5f934?s=128&d=identicon&r=PG", "display_name": "user877329", "link": "https://stackoverflow.com/users/877329/user877329"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 611, "favorite_count": 1, "accepted_answer_id": 34437261, "answer_count": 2, "score": 3, "last_activity_date": 1450880910, "creation_date": 1450878600, "last_edit_date": 1450878761, "question_id": 34437126, "link": "https://stackoverflow.com/questions/34437126/force-non-null-while-preserving-constness", "title": "Force non-null while preserving constness", "body": "<p>Consider this class</p>\n\n<pre><code>class Foo\n{\npublic:\n    Foo()\n       : r_obj(&amp;nullobj)\n    {}\n\n    void setDataRef(const T&amp; obj)\n    {\n        r_obj = &amp;obj;\n    }\n\nprivate:\n    static T nullobj;\n    const T* r_obj;\n};\n</code></pre>\n\n<p>This forces <code>r_obj</code> to point to something, and I know that the class cannot modify the logical state of whatever it points to. However, now it is perfectly legal to pass a temporary object to <code>setDataRef</code> which is really bad.</p>\n\n<p>If instead using <code>setDataRef(T&amp;)</code>, the constness is lost.</p>\n\n<p>Passing a pointer does not force the object to really point to something.</p>\n\n<p>Is it possible to get all three:</p>\n\n<ul>\n<li>Constness</li>\n<li>Non-null</li>\n<li>Forbid temporary</li>\n</ul>\n"}, {"tags": ["c++", "object", "abstract-class", "evaluation", "class-template"], "answers": [{"comments": [{"owner": {"reputation": 13195, "user_id": 3777958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Cjiij.jpg?s=128&g=1", "display_name": "Destructor", "link": "https://stackoverflow.com/users/3777958/destructor"}, "edited": false, "score": 0, "creation_date": 1450879408, "post_id": 34437143, "comment_id": 56615554, "body": "@101010: Then why following std::cout&lt;&lt;std::is_array&lt;T&gt;::value&lt;&lt;&#39;\\n&#39;; doesn&#39;t give any compiler error?"}, {"owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "reply_to_user": {"reputation": 13195, "user_id": 3777958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Cjiij.jpg?s=128&g=1", "display_name": "Destructor", "link": "https://stackoverflow.com/users/3777958/destructor"}, "edited": false, "score": 1, "creation_date": 1450879552, "post_id": 34437143, "comment_id": 56615631, "body": "@PravasiMeet <code>std::is_array&lt;T&gt;::value</code> here <code>T</code> is not an array. As cpplearner mentioned the standard forbids arrays of abstract class types."}, {"owner": {"reputation": 2721, "user_id": 880984, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/65f4fa9056d1884b419463410e92c5be?s=128&d=identicon&r=PG", "display_name": "Tim Seguine", "link": "https://stackoverflow.com/users/880984/tim-seguine"}, "reply_to_user": {"reputation": 13195, "user_id": 3777958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Cjiij.jpg?s=128&g=1", "display_name": "Destructor", "link": "https://stackoverflow.com/users/3777958/destructor"}, "edited": false, "score": 0, "creation_date": 1450879608, "post_id": 34437143, "comment_id": 56615672, "body": "@PravasiMeet because <code>T</code> is a valid type although you can&#39;t create one whereas <code>T[3]</code> is not a valid type."}], "tags": [], "owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "is_accepted": true, "score": 2, "last_activity_date": 1450879709, "last_edit_date": 1450879709, "creation_date": 1450878666, "answer_id": 34437143, "question_id": 34437082, "link": "https://stackoverflow.com/questions/34437082/confusion-about-evaluation-of-is-array-template-class/34437143#34437143", "title": "confusion about evaluation of is_array template class", "body": "<p>You can't have an array of abstract class type. Thus, you get a compiler error.</p>\n\n<blockquote>\n  <p>But, why array is required to be created here? what is the need to\n  create an array If I am not able to use that array? Isn't this just\n  wastage of memory?</p>\n</blockquote>\n\n<p>The array is not created, you pass its type as a template argument. The compiler sees that this is an array of abstract class objects and it complains.</p>\n"}, {"tags": [], "owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "is_accepted": false, "score": 5, "last_activity_date": 1450879201, "creation_date": 1450879201, "answer_id": 34437307, "question_id": 34437082, "link": "https://stackoverflow.com/questions/34437082/confusion-about-evaluation-of-is-array-template-class/34437307#34437307", "title": "confusion about evaluation of is_array template class", "body": "<p>N4567 \u00a7 8.3.4 Arrays [dcl.array]p1 (emphasis mine)</p>\n\n<blockquote>\n  <p>In a declaration <code>T D</code> where <code>D</code> has the form</p>\n  \n  <p><code>D1 [ constant-expression</code><sub><code>opt</code></sub><code>] attribute-speci\ufb01er-seq</code><sub><code>opt</code></sub></p>\n  \n  <p>and the type of the identi\ufb01er in the declaration <code>T D1</code> is \u201c<em>derived-declarator-type-list</em> <code>T</code>\u201d, then the type of the <em>identi\ufb01er</em> of D is an array type; [...] <strong>T is called the <em>array element type</em>; this type shall not be a reference type, the (possibly cv-quali\ufb01ed) type void, a function type or an abstract class type</strong>. </p>\n</blockquote>\n\n<p>So, the language rule just forbids you from creating the type \"array of abstrct class type\".  </p>\n"}], "owner": {"reputation": 13195, "user_id": 3777958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Cjiij.jpg?s=128&g=1", "display_name": "Destructor", "link": "https://stackoverflow.com/users/3777958/destructor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 34437143, "answer_count": 2, "score": 1, "last_activity_date": 1450879709, "creation_date": 1450878383, "question_id": 34437082, "link": "https://stackoverflow.com/questions/34437082/confusion-about-evaluation-of-is-array-template-class", "title": "confusion about evaluation of is_array template class", "body": "<p>Consider following program (See live demo <a href=\"http://melpon.org/wandbox/permlink/M0yyRCUZLg0Atb9T\" rel=\"nofollow\">here.</a>)</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\nint main()\n{\n    struct T{ virtual void foo()=0;};\n    std::cout&lt;&lt;std::boolalpha;\n    std::cout&lt;&lt;std::is_array&lt;int[3]&gt;::value&lt;&lt;'\\n';\n    std::cout&lt;&lt;std::is_array&lt;T&gt;::value&lt;&lt;'\\n';\n    std::cout&lt;&lt;std::is_array&lt;T1[2]&gt;::value&lt;&lt;'\\n';\n    std::cout&lt;&lt;std::is_array&lt;T[3]&gt;::value&lt;&lt;'\\n'; // why uncommenting this line causes compile time error?\n}\n</code></pre>\n\n<p>I know that it isn't possible to create the object of abstract class. Here T is abstract, so it isn't possible to create the object of struct T.\nBut consider the following statement</p>\n\n<pre><code>std::cout&lt;&lt;std::is_array&lt;T[3]&gt;::value&lt;&lt;'\\n';\n</code></pre>\n\n<p>Why it gives me an error? The statement only checks whether a given type is array or not. Does that mean that If T is array \n&amp; value of the static member <code>value</code> evaluates to <code>true</code> then array of objects will be created? <strong>But, why array is required to be created here? \nwhat is the need to create an array If I am not able to use that array? Isn't this just wastage of memory?</strong></p>\n\n<p>Then why following statement doesn't give any compiler error?</p>\n\n<pre><code>std::cout&lt;&lt;std::is_array&lt;T&gt;::value&lt;&lt;'\\n';\n</code></pre>\n\n<p>What I am understanding wrong here? Please help me.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1450878251, "post_id": 34437010, "comment_id": 56614828, "body": "You really should consult the documentation first: <a href=\"http://en.cppreference.com/w/cpp/language/switch\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/switch</a>"}, {"owner": {"reputation": 24928, "user_id": 997112, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/7c52a3944cdd2eac9725e54fc548f368?s=128&d=identicon&r=PG", "display_name": "user997112", "link": "https://stackoverflow.com/users/997112/user997112"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1450878371, "post_id": 34437010, "comment_id": 56614900, "body": "@NathanOliver this bit: &quot;a single non-array variable&quot;?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1450878522, "post_id": 34437010, "comment_id": 56615001, "body": "Yes that and the whole <i>condition</i> and <i>constant_expression</i> parts"}], "answers": [{"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1450878660, "post_id": 34437045, "comment_id": 56615079, "body": "You cannot use the converted <code>int</code> from <code>atoi</code> or friends in a switch case either, because it won&#39;t be a constant expression."}], "tags": [], "owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "is_accepted": true, "score": 2, "last_activity_date": 1450878272, "creation_date": 1450878272, "answer_id": 34437045, "question_id": 34437010, "link": "https://stackoverflow.com/questions/34437010/switch-statement-on-char-variable/34437045#34437045", "title": "Switch statement on char variable", "body": "<p><code>field</code> is an array. It is not a single value you can <code>switch</code> on.</p>\n\n<p>You're trying to <code>switch</code> on the contents of a character array, when it is interpreted as an integer value.</p>\n\n<p>Use <code>atoi()</code>, or a helper <code>std::istringstream</code>'s <code>operator &gt;&gt;</code>, to convert the array into an <code>int</code> variable, then <code>switch</code> on it.</p>\n"}, {"comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1450878355, "post_id": 34437058, "comment_id": 56614888, "body": "You cannot &quot;cast&quot; a char array, like this, to an integer. This statement makes no sense. The term &quot;casting&quot; has a specific meaning in C++, and this ain&#39;t it."}, {"owner": {"reputation": 1774, "user_id": 426065, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cDexq.jpg?s=128&g=1", "display_name": "Elixir Techne", "link": "https://stackoverflow.com/users/426065/elixir-techne"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1450878466, "post_id": 34437058, "comment_id": 56614962, "body": "@Sam, I meant it to convert and not cast. Thanks for catching it and I have updated my comment."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1450878897, "post_id": 34437058, "comment_id": 56615225, "body": "How do you propose to convert the string to an integer at compile time? The case must be a constant expression."}, {"owner": {"reputation": 1774, "user_id": 426065, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cDexq.jpg?s=128&g=1", "display_name": "Elixir Techne", "link": "https://stackoverflow.com/users/426065/elixir-techne"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1450878966, "post_id": 34437058, "comment_id": 56615270, "body": "it can be atoi() as suggested by @Sam"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1450879110, "post_id": 34437058, "comment_id": 56615357, "body": "As I commented on Sams answer, <code>atoi</code> cannot be used. Function calls are not constant expressions (unless the function is declared <code>constexpr</code>, which <code>atoi</code> is not)."}], "tags": [], "owner": {"reputation": 1774, "user_id": 426065, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cDexq.jpg?s=128&g=1", "display_name": "Elixir Techne", "link": "https://stackoverflow.com/users/426065/elixir-techne"}, "is_accepted": false, "score": 1, "last_activity_date": 1450878412, "last_edit_date": 1450878412, "creation_date": 1450878316, "answer_id": 34437058, "question_id": 34437010, "link": "https://stackoverflow.com/questions/34437010/switch-statement-on-char-variable/34437058#34437058", "title": "Switch statement on char variable", "body": "<p>No, It is not possible to have switch statement on char array/string. In case you are sure that the field will contain numeric value then convert char array to integer.</p>\n"}], "owner": {"reputation": 24928, "user_id": 997112, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/7c52a3944cdd2eac9725e54fc548f368?s=128&d=identicon&r=PG", "display_name": "user997112", "link": "https://stackoverflow.com/users/997112/user997112"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 731, "favorite_count": 0, "accepted_answer_id": 34437045, "answer_count": 2, "score": -1, "last_activity_date": 1450879616, "creation_date": 1450878171, "question_id": 34437010, "link": "https://stackoverflow.com/questions/34437010/switch-statement-on-char-variable", "title": "Switch statement on char variable", "body": "<p>A library we are using defines constants and we have:</p>\n\n<pre><code>const char field[] = \"666\"\n</code></pre>\n\n<p>and I would like to:</p>\n\n<pre><code>switch(an_int){\n    case field:\n</code></pre>\n\n<p>Is there a way to achieve this? I get a compiler error saying field is not usable in a constant expression (GCC 5.2).</p>\n\n<p>I would really wish to avoid modifying the declaration of field if possible.</p>\n"}, {"tags": ["c++", "macos", "makefile", "clang++", "systemc"], "answers": [{"comments": [{"owner": {"reputation": 4801, "user_id": 1021819, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pGNtf.png?s=128&g=1", "display_name": "jtlz2", "link": "https://stackoverflow.com/users/1021819/jtlz2"}, "edited": false, "score": 0, "creation_date": 1596438916, "post_id": 34438508, "comment_id": 111800975, "body": "Finally a fix that actually works - thank you so so much!!"}], "tags": [], "owner": {"reputation": 827, "user_id": 3507543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I6dwv.jpg?s=128&g=1", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/3507543/guillaume"}, "is_accepted": true, "score": 1, "last_activity_date": 1450883277, "creation_date": 1450883277, "answer_id": 34438508, "question_id": 34436941, "link": "https://stackoverflow.com/questions/34436941/systemc-on-mac-error-with-makefile/34438508#34438508", "title": "SystemC on Mac error with Makefile", "body": "<p><code>=</code> is a GNU linker feature, not Clang.</p>\n\n<p>Edit <code>examples/sysc/Makefile.rules</code> and replace:</p>\n\n<p><code>LDFLAG_RPATH     ?= -Wl,-rpath=</code></p>\n\n<p>with</p>\n\n<p><code>LDFLAG_RPATH     ?= -Wl,-rpath,</code></p>\n"}], "owner": {"reputation": 35, "user_id": 2038153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5533e81ca72e85e4c9b4886b64b0834?s=128&d=identicon&r=PG", "display_name": "Ammar114", "link": "https://stackoverflow.com/users/2038153/ammar114"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4979, "favorite_count": 2, "accepted_answer_id": 34438508, "answer_count": 1, "score": 1, "last_activity_date": 1523808986, "creation_date": 1450877888, "last_edit_date": 1523808986, "question_id": 34436941, "link": "https://stackoverflow.com/questions/34436941/systemc-on-mac-error-with-makefile", "title": "SystemC on Mac error with Makefile", "body": "<p>I need to start working on a project with SystemC. I managed to compile SystemC according to this instructions: <a href=\"https://stackoverflow.com/questions/25961573/how-to-use-and-install-systemc-in-terminal-mac-os-x\">how to use and install SystemC in terminal mac OS X?</a></p>\n\n<p>Afterwards I adjusted the <code>SYSTEMC_HOME</code> variable in Makefile.config to <code>\"SYSTEMC_HOME?=~/Work/Other/systemc-2.3.1\"</code>\nThe problem occurs when i try to compile and run any of the provided examples.\nThe error I get is:</p>\n\n<pre><code>ld: unknown option: -rpath=/Users/admin/Work/Other/systemc-2.3.1/lib\nclang: error: linker command failed with exit code 1 \n(use -void to see invocation)\n</code></pre>\n\n<p>The command I run is: </p>\n\n<pre><code>make -f Makefile run\n</code></pre>\n\n<p>And the whole output from the console:</p>\n\n<pre><code>simple_fifo admin$ make -f Makefile run\nclang++ -fcolor-diagnostics  -g -Wall -pedantic -Wno-long-long -Werror -L. -L.. -L /Users/admin/Work/Other/systemc-2.3.1/lib -Wl,-rpath=/Users/admin/Work/Other/systemc-2.3.1/lib -o simple_fifo.x simple_fifo.o -lsystemc -lm  2&gt;&amp;1 | c++filt\nld: unknown option: -rpath=/Users/admin/Work/Other/systemc-2.3.1/lib\nclang: error: linker command failed with exit code 1 (use -void to see invocation)\nmake: *** [simple_fifo.x] Error 1\n</code></pre>\n\n<p>Any hints on what to look for would be highly appreciated. </p>\n"}, {"tags": ["c++", "floating-point"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1450877977, "post_id": 34436880, "comment_id": 56614658, "body": "In C++, how you use a result does not affect how it is computed. That your function returns a <code>float</code> does not change how <code>difRama &#47; total</code> is computed."}], "answers": [{"comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1450878307, "post_id": 34436912, "comment_id": 56614858, "body": "To clarify: that cast applies to <code>difRama</code>. Once <code>difRama</code> has become a <code>float</code>, the compiler will convert <code>total</code> to <code>float</code> so that the argument types for the division match. The cast does not apply to the expression itself; <code>(float)(difRama&#47;total)</code> would still do integer division, then convert the result to <code>float</code>."}, {"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1450878451, "post_id": 34436912, "comment_id": 56614949, "body": "@PeteBecker I was reviewing my own post deciding whether that clarification was needed when your comment appeared.  So I guess that clarification was needed."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1450878470, "post_id": 34436912, "comment_id": 56614966, "body": "Also, there&#39;s no such thing as an &quot;implicit cast&quot;. A cast is something you write in your source code to tell the compiler to convert something. The compiler can also convert things without a cast; that&#39;s an implicit <b>conversion</b>."}, {"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1450878656, "post_id": 34436912, "comment_id": 56615077, "body": "@PeteBecker I&#39;ve seen and used &quot;implicit cast&quot; quite often and I thought the meaning was clear.  But I&#39;ll trust your claim that &quot;conversion&quot; is a better word.  So I edited the answer."}], "tags": [], "owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "is_accepted": true, "score": 6, "last_activity_date": 1450878506, "last_edit_date": 1450878506, "creation_date": 1450877777, "answer_id": 34436912, "question_id": 34436880, "link": "https://stackoverflow.com/questions/34436880/function-returns-0-when-float-number-is-under-1/34436912#34436912", "title": "Function returns 0 when float number is under 1", "body": "<p>The division occurs <strong>before</strong> the implicit conversion from <code>int</code> to <code>float</code>.  </p>\n\n<p>You need an explicit cast from <code>int</code> to <code>float</code> before the division.  </p>\n\n<pre><code>return (float)  difRama / total;\n</code></pre>\n\n<p>You should know by operator precedence rules that the above cast applies to <code>difRama</code> before the divide (rather than to the result of the divide).</p>\n"}, {"comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1450878549, "post_id": 34436920, "comment_id": 56615015, "body": "Well, I just uprooted. I guess folks prefer casts to additional numbers. But there&#39;s nothing wrong with this approach."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1450878640, "post_id": 34436920, "comment_id": 56615066, "body": "Agreed.  I&#39;d use the cast myself, but I don&#39;t see why people think this is unhelpful."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1450878793, "last_edit_date": 1450878793, "creation_date": 1450877824, "answer_id": 34436920, "question_id": 34436880, "link": "https://stackoverflow.com/questions/34436880/function-returns-0-when-float-number-is-under-1/34436920#34436920", "title": "Function returns 0 when float number is under 1", "body": "<p>You're computing the division in integer arithmetic. This happens if both arguments in the division are integral types, irrespective of the type of variable to which the result is assigned.</p>\n\n<p>A simple fix is to pre-multiply the quotient by <code>1.0f</code>:</p>\n\n<p>return <code>1.0f * difRama / total;</code></p>\n\n<p>which will force the arguments to be promoted to <code>float</code>s.</p>\n\n<p>Altenatively (which I prefer), multiply by <code>1.0</code>, which will force the arguments to be promoted to <code>double</code>, and the entire expression will undergo an implicit narrowing conversion to <code>float</code> when returned.</p>\n"}, {"comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1450878408, "post_id": 34437067, "comment_id": 56614925, "body": "While it&#39;s true that casting both to <code>float</code> will produce the desired result, it&#39;s only necessary to cast one of them. The compiler will convert the other to match."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5494228"}, "is_accepted": false, "score": 1, "last_activity_date": 1450879158, "last_edit_date": 1450879158, "creation_date": 1450878348, "answer_id": 34437067, "question_id": 34436880, "link": "https://stackoverflow.com/questions/34436880/function-returns-0-when-float-number-is-under-1/34437067#34437067", "title": "Function returns 0 when float number is under 1", "body": "<p>That's because the variables difRama and total are both of type int. If the result has a fractional part (0.33 in your first situation and 0.4 in the second one), it will be truncated. But if you explicitly convert one of them to float, then truncation will not happen. Like this:</p>\n\n<pre><code>return static_cast&lt;float&gt;(difRama) / total;\n</code></pre>\n"}], "owner": {"reputation": 616, "user_id": 605737, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1801983091/picture?type=large", "display_name": "jsertx", "link": "https://stackoverflow.com/users/605737/jsertx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1141, "favorite_count": 0, "closed_date": 1450878476, "accepted_answer_id": 34436912, "answer_count": 3, "score": -1, "last_activity_date": 1450879158, "creation_date": 1450877646, "question_id": 34436880, "link": "https://stackoverflow.com/questions/34436880/function-returns-0-when-float-number-is-under-1", "closed_reason": "Duplicate", "title": "Function returns 0 when float number is under 1", "body": "<p>I have this code to calc the diference between the main branches of a binary tree, the important thing is the final. Debugging I get to the last expression:</p>\n\n<pre><code>return difRama/total;\n</code></pre>\n\n<p>this will always return a decimal between 0 and 1 as percentage it is.\nI get situations like:</p>\n\n<ul>\n<li>return 5 / 15</li>\n<li><p>return 4 / 10</p>\n\n<pre><code>float Arbol::diferenciaRamas(pnodo rama1, pnodo rama2){\n    int total, difRama, pesoIzq, pesoDer;\n\n    /* Calculamos pesos rama izq yder*/\n    pesoIzq = pesoRamificaciones(rama1);\n    pesoDer = pesoRamificaciones(rama2);\n\n    /* Diferencia de peso entre ramas */\n    difRama = abs(pesoIzq - pesoDer);\n\n    /* Total de peso del arbol */\n    total = (pesoIzq+pesoDer);\n\n    /* Si el total es 0 o la diferencia es 0 */\n    if(total == 0 || difRama == 0)\n        return 0;\n\n    /* Porcentaje de diferencia */\n    return difRama / total;\n\n}\n</code></pre></li>\n</ul>\n\n<p>The problem is that the function always returns 0, any idea?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "edited": false, "score": 5, "creation_date": 1450877402, "post_id": 34436721, "comment_id": 56614341, "body": "<code>+&quot;&quot;+</code> - why is this everywhere? I don&#39;t get how <code>&quot;~\\Documents\\trialrun\\&quot;; file_name=&quot;abc.dat&quot;</code> compiles. Learn how to <a href=\"http://en.cppreference.com/w/cpp/language/escape\" rel=\"nofollow noreferrer\">escape characters</a>."}, {"owner": {"reputation": 3356, "user_id": 4451432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97b46aba1c1ec6b780b9735f0ec7f885?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Popov", "link": "https://stackoverflow.com/users/4451432/ilya-popov"}, "edited": false, "score": 1, "creation_date": 1450877787, "post_id": 34436721, "comment_id": 56614552, "body": "Please, make your code example syntactically correct. As it is now it contains multiple problems and won&#39;t compile."}, {"owner": {"reputation": 6085, "user_id": 425871, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/58MZp.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/425871/steve"}, "edited": false, "score": 0, "creation_date": 1450884763, "post_id": 34436721, "comment_id": 56618636, "body": "Double up those backslashes: <code>path=&quot;~\\\\Documents\\\\trialrun\\\\&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 5705849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a3a561e8e43162a45d212ebf2e53fa?s=128&d=identicon&r=PG&f=1", "display_name": "vidhya", "link": "https://stackoverflow.com/users/5705849/vidhya"}, "edited": false, "score": 0, "creation_date": 1450877256, "post_id": 34436755, "comment_id": 56614247, "body": "I too had the same thought but while reading the infile, the path specified (~\\Documents\\trialrun\\infile.dat) is correctly taken by the script. Any inputs on this?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 7, "user_id": 5705849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a3a561e8e43162a45d212ebf2e53fa?s=128&d=identicon&r=PG&f=1", "display_name": "vidhya", "link": "https://stackoverflow.com/users/5705849/vidhya"}, "edited": false, "score": 2, "creation_date": 1450877297, "post_id": 34436755, "comment_id": 56614272, "body": "@vidhya: What infile? What path? What script? And so what?"}, {"owner": {"reputation": 7, "user_id": 5705849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a3a561e8e43162a45d212ebf2e53fa?s=128&d=identicon&r=PG&f=1", "display_name": "vidhya", "link": "https://stackoverflow.com/users/5705849/vidhya"}, "edited": false, "score": 0, "creation_date": 1450877375, "post_id": 34436755, "comment_id": 56614323, "body": "I read a file using the script ifstream infile; infile.open(&quot;&quot;+path+&quot;&quot;+file_name1+&quot;&quot;);"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 7, "user_id": 5705849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a3a561e8e43162a45d212ebf2e53fa?s=128&d=identicon&r=PG&f=1", "display_name": "vidhya", "link": "https://stackoverflow.com/users/5705849/vidhya"}, "edited": false, "score": 4, "creation_date": 1450877456, "post_id": 34436755, "comment_id": 56614367, "body": "@vidhya: I think it&#39;s time you showed us an actual MCVE (without buggy backslashes, for example). And name your platform. And versions for everything. Give us <i>specifics</i>. Actually, you should have done that from the start."}, {"owner": {"reputation": 7, "user_id": 5705849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a3a561e8e43162a45d212ebf2e53fa?s=128&d=identicon&r=PG&f=1", "display_name": "vidhya", "link": "https://stackoverflow.com/users/5705849/vidhya"}, "edited": false, "score": 0, "creation_date": 1450877590, "post_id": 34436755, "comment_id": 56614444, "body": "Yeah ok, I will implement that from now. Thanks for the input. :)"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 3, "last_activity_date": 1450877143, "creation_date": 1450877143, "answer_id": 34436755, "question_id": 34436721, "link": "https://stackoverflow.com/questions/34436721/output-file-not-written-in-specific-path-using/34436755#34436755", "title": "Output file not written in specific path using &quot;~&quot;", "body": "<p><em>For the purposes of this answer, I will assume that the broken backslash in your code's first line is not in your real code.</em></p>\n\n<p><code>~\\Documents\\trialrun</code> is not a valid path. That tilde is a shorthand that will be expanded by a shell environment like Bash, but you're not using Bash! You're declaring an actual path.</p>\n\n<p>You will have to use platform-specific APIs to expand the path into its \"real\" equivalent as Bash would do, or write out the path in full to begin with.</p>\n"}], "owner": {"reputation": 7, "user_id": 5705849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a3a561e8e43162a45d212ebf2e53fa?s=128&d=identicon&r=PG&f=1", "display_name": "vidhya", "link": "https://stackoverflow.com/users/5705849/vidhya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "closed_date": 1450886194, "answer_count": 1, "score": -2, "last_activity_date": 1450877152, "creation_date": 1450877043, "last_edit_date": 1450877152, "question_id": 34436721, "link": "https://stackoverflow.com/questions/34436721/output-file-not-written-in-specific-path-using", "closed_reason": "Not suitable for this site", "title": "Output file not written in specific path using &quot;~&quot;", "body": "<p>I have already searched threads for storing file in specific location but my problem persists.</p>\n\n<p>I am trying to write file to a specific path and I could not find the file. However, if I ask the program to write the file to the current directory, it works.\nIn both ways, I do not get any error. My sample code is below.</p>\n\n<pre><code>string path=\"~\\Documents\\trialrun\\\"; file_name=\"abc.dat\";\nofstream outfile;\noutfile.open(\"\"+path+\"\"+file_name+\"\",fstream::append);\n</code></pre>\n\n<p>This does not write the file at all, whereas</p>\n\n<pre><code> outfile.open(\"\"+file_name+\"\",fstream::append);\n</code></pre>\n"}, {"tags": ["c++", "opencv", "c++11"], "comments": [{"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1450877698, "post_id": 34436719, "comment_id": 56614506, "body": "Can you provide a specific example? The short answer will be: either use <code>Mat</code> or <code>std::vector</code>. For any other container you need to convert."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1450878061, "post_id": 34436719, "comment_id": 56614821, "body": "In your previous question the problem was nothing to do with std::array (not lowercase), it was that some functions want cv::Point&lt;float&gt;* and some want cv::Point&lt;double&gt;* - and the obvious question is why?"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1450878189, "post_id": 34436719, "comment_id": 56614781, "body": "In your previous question the problem was nothing to do with std::array (note lowercase), it was that some functions wanted <code>point&lt;float&gt;*</code> and some want <code>point&lt;double&gt;*</code> - and the obvious question is why?"}, {"owner": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "edited": false, "score": 0, "creation_date": 1450878611, "post_id": 34436719, "comment_id": 56615045, "body": "if it was accept begin and end, the two problems will be solved in the same time,.. because cv::point and cv::point2f have built-in conversion functions"}], "answers": [{"comments": [{"owner": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "edited": false, "score": 0, "creation_date": 1450878656, "post_id": 34437099, "comment_id": 56615076, "body": "if OpenCV accept iterators instead of direct vector container, both problem should be solved. shouldn&#39;t it?"}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "reply_to_user": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "edited": false, "score": 0, "creation_date": 1450879259, "post_id": 34437099, "comment_id": 56615465, "body": "In general, you can&#39;t expect that a library fulfills any your requirements, but it&#39;s the other way around. You should commit to the library style. OpenCV is highly optimized and usually expects all it&#39;s data to be in a given format exactly for this. If any OpenCV function would iterate over the container and convert/copy the data to another format, it will be far too slow. Bottom line, give OpenCV data as it expects, you can always wrap OpenCV functions to accept iterators"}, {"owner": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "edited": false, "score": 0, "creation_date": 1450879379, "post_id": 34437099, "comment_id": 56615534, "body": "I see, However, I still think that any C++ library should accept iterator by default. At least, to provide a wrapper that accept it."}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "reply_to_user": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "edited": false, "score": 2, "creation_date": 1450879756, "post_id": 34437099, "comment_id": 56615747, "body": "No, it doesn&#39;t make sense in this case. You want iterators to perform implicit data conversion, and that&#39;s not what iterators should be used for. If a function accepts <code>foo</code>, you should give it <code>foo</code>, not <code>bar</code>. It&#39;s up to you to convert <code>bar</code> to <code>foo</code>. And your last comment is true the other way around: <i>any C++ library should provide iterator-like access to its data structures</i>. OpenCV has support for iterators in order to use Mat with standard algorithms using MatIterator."}, {"owner": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "edited": false, "score": 1, "creation_date": 1450879959, "post_id": 34437099, "comment_id": 56615878, "body": "What about the part related to its functions? should not it accept iterators too? it provides iterator for its container(Mat) but does not accept iterators of std containers?"}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "reply_to_user": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "edited": false, "score": 0, "creation_date": 1450880390, "post_id": 34437099, "comment_id": 56616099, "body": "I&#39;m speculating, since I&#39;m not an OpenCV developer and don&#39;t know their reasons, but... the primary data structure in OpenCV is <code>Mat</code>. They are even so kind that allows you to use <code>std::vector</code> seamlessly via <code>Input&#47;OutputArray</code>. Why do you want OpenCV to accept <code>std::list</code> with not contiguous data, or fixed size <code>std::array</code>?"}, {"owner": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "edited": false, "score": 0, "creation_date": 1450880546, "post_id": 34437099, "comment_id": 56616186, "body": "You mean the right way of using OpenCV is to store any data you want to do any operation on is to use cv::Mat?"}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "reply_to_user": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "edited": false, "score": 0, "creation_date": 1450880839, "post_id": 34437099, "comment_id": 56616353, "body": "For the <b>right</b> way you should probably ask on answers.opencv, where developers will answer you. But I&#39;m inclined to tell basically <b>yes</b>. Keep your data in <code>cv::Mat</code> (or <code>cv::Mat_&lt;Tp&gt;</code>) or <code>std::vector</code> and you&#39;ll save a lot of headaches :D"}, {"owner": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "edited": false, "score": 0, "creation_date": 1450880991, "post_id": 34437099, "comment_id": 56616436, "body": "mmmm I should ask really, if the answer was &quot;yes use Mat&quot;, I will figure out that I need to punished by rewriting my all codes or to pray that my boss does not use SO :D  @Miki thanks for your time."}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "reply_to_user": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "edited": false, "score": 0, "creation_date": 1450881216, "post_id": 34437099, "comment_id": 56616576, "body": "Please link here the discussion on answers.opencv... Good luck :D"}], "tags": [], "owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "is_accepted": true, "score": 2, "last_activity_date": 1450878487, "creation_date": 1450878487, "answer_id": 34437099, "question_id": 34436719, "link": "https://stackoverflow.com/questions/34436719/using-opencv-with-stdarray/34437099#34437099", "title": "using OpenCV with std::Array", "body": "<p>There's nothing wrong with OpenCV functions. Simply <code>fillConvexPoly</code> is expecting <code>Point</code>, while <code>getPerspectiveTransform</code> is expecting <code>Point2f</code>. So you should pass the correct data type to those functions.</p>\n\n<p>It has also nothing to do with <code>array</code> instead of <code>vector</code>. A <code>vector&lt;Point&gt;</code> would not be good either, but you need a <code>vector&lt;Point2f&gt;</code>.</p>\n\n<p>You can convert your <code>std::array&lt;cv::Point, 4&gt;</code> to a <code>vector&lt;Point2f&gt;</code> and then pass it to <code>getPerspectiveTransform</code>:</p>\n\n<pre><code>vector&lt;Point2f&gt; pts(my_points.begin(), my_points.end());\nauto homography_matrix = cv::getPerspectiveTransform(pts.data(), pts.data()); \n</code></pre>\n"}], "owner": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 851, "favorite_count": 0, "accepted_answer_id": 34437099, "answer_count": 1, "score": 2, "last_activity_date": 1450878487, "creation_date": 1450877029, "last_edit_date": 1495542199, "question_id": 34436719, "link": "https://stackoverflow.com/questions/34436719/using-opencv-with-stdarray", "title": "using OpenCV with std::Array", "body": "<p>This question is related to this one  <a href=\"https://stackoverflow.com/questions/34435578/stdarrayt-n-need-to-be-fetched-in-another-types\">std::array&lt;T,N&gt; need to be fetched in another types</a></p>\n\n<p>I have noticed that OpenCV methods that deal with sequence of points accept either <code>cv::InputArray</code> or <code>const*</code> of the point type. e.g. (<code>cv::Point* const</code>)\nWhen you have your points in <code>std::array</code>, you may depend on the <code>const*</code> input of the OpenCV method and call <code>my_array.data()</code> in order to get a pointer of the type. However, you will have to deal with the <code>cv::Point</code> to <code>cv::Point2f</code> and vice-versa problem. Furthermore, it is not really the right way.</p>\n\n<p>I thought that the solution could be found in <code>cv::InputArray</code> where I will find iterator-based solution or at least overloads for C++ standard containers. I read its documentation and I shocked that it takes either <code>std::vector</code> or <code>cv::Mat</code> and some other Gpu data types. </p>\n\n<p>The question is : How to overcome this problem? Did I miss something? in other word: How to use OpenCV with the standard container in the best way?</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>std::array&lt;cv::Point,4&gt; my_points,my_points2;\n//fill my_points,my_points2\ncv::fillConvexPoly(img, my_points.data(), 4, cv::Scalar::all(255));//this works\nauto homography_matrix = cv::getPerspectiveTransform(my_points.data(), my_points2.data()); //This will not work\n</code></pre>\n"}, {"tags": ["c++", "arrays", "cuda", "gpu"], "comments": [{"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 2, "creation_date": 1450882752, "post_id": 34436716, "comment_id": 56617482, "body": "You could just leave the memory as is and use the alternative indexing scheme. That is what every sane linear algebra library does."}, {"owner": {"reputation": 92303, "user_id": 1714410, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a254f486ab076ab1af26162a975e90f9?s=128&d=identicon&r=PG", "display_name": "Shai", "link": "https://stackoverflow.com/users/1714410/shai"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1450885003, "post_id": 34436716, "comment_id": 56618807, "body": "@talonmies I wish I could... but its part of a bigger library and the fansy indexing is not supported"}], "answers": [{"comments": [{"owner": {"reputation": 92303, "user_id": 1714410, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a254f486ab076ab1af26162a975e90f9?s=128&d=identicon&r=PG", "display_name": "Shai", "link": "https://stackoverflow.com/users/1714410/shai"}, "edited": false, "score": 0, "creation_date": 1450893696, "post_id": 34437054, "comment_id": 56623989, "body": "Thank you for your answer. I&#39;m a GPU newbie so it might take me a while to parse. But in the attached diagram, shouldn&#39;t the green column be vertical in <code>odata</code>?"}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 7, "creation_date": 1450896307, "post_id": 34437054, "comment_id": 56625235, "body": "The objective pictured in the diagram is to have coalesced access for both the <i>reads</i> from <code>idata</code> and the <i>writes</i> to <code>odata</code>.  In a nutshell, coalescing in this context will be achieved by &quot;horizontal&quot; access.  Therefore the orientation of the yellow operation (read from <code>idata</code>) and the green operation (write to <code>odata</code>) are intended to both have &quot;horizontal&quot; access as they touch the global data arrays.  The actual in-tile transposing is occurring in shared memory, which is depicted by the tile block in the center of the diagram.  This is where the reads and writes are horizontal/vertical."}], "tags": [], "owner": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "is_accepted": true, "score": 3, "last_activity_date": 1450878303, "creation_date": 1450878303, "answer_id": 34437054, "question_id": 34436716, "link": "https://stackoverflow.com/questions/34436716/gpu-cuda-re-ordering-device-memory/34437054#34437054", "title": "GPU/CUDA: Re-ordering device memory", "body": "<p>You could check this <a href=\"http://devblogs.nvidia.com/parallelforall/efficient-matrix-transpose-cuda-cc/\" rel=\"nofollow noreferrer\">http://devblogs.nvidia.com/parallelforall/efficient-matrix-transpose-cuda-cc/</a></p>\n\n<p><strong>Naive Matrix Transpose:</strong></p>\n\n<pre><code>__global__ void transposeNaive(float *odata, const float *idata)\n{\n  int x = blockIdx.x * TILE_DIM + threadIdx.x;\n  int y = blockIdx.y * TILE_DIM + threadIdx.y;\n  int width = gridDim.x * TILE_DIM;\n\n  for (int j = 0; j &lt; TILE_DIM; j+= BLOCK_ROWS)\n    odata[x*width + (y+j)] = idata[(y+j)*width + x];\n}\n</code></pre>\n\n<p><strong>Coalesced Transpose Via Shared Memory:</strong>\n<a href=\"https://i.stack.imgur.com/rr2qh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rr2qh.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>__global__ void transposeCoalesced(float *odata, const float *idata)\n{\n  __shared__ float tile[TILE_DIM][TILE_DIM];\n\n  int x = blockIdx.x * TILE_DIM + threadIdx.x;\n  int y = blockIdx.y * TILE_DIM + threadIdx.y;\n  int width = gridDim.x * TILE_DIM;\n\n  for (int j = 0; j &lt; TILE_DIM; j += BLOCK_ROWS)\n     tile[threadIdx.y+j][threadIdx.x] = idata[(y+j)*width + x];\n\n  __syncthreads();\n\n  x = blockIdx.y * TILE_DIM + threadIdx.x;  // transpose block offset\n  y = blockIdx.x * TILE_DIM + threadIdx.y;\n\n  for (int j = 0; j &lt; TILE_DIM; j += BLOCK_ROWS)\n     odata[(y+j)*width + x] = tile[threadIdx.x][threadIdx.y + j];\n}\n</code></pre>\n"}], "owner": {"reputation": 92303, "user_id": 1714410, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a254f486ab076ab1af26162a975e90f9?s=128&d=identicon&r=PG", "display_name": "Shai", "link": "https://stackoverflow.com/users/1714410/shai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "closed_date": 1450944670, "accepted_answer_id": 34437054, "answer_count": 1, "score": 1, "last_activity_date": 1450878303, "creation_date": 1450877022, "question_id": 34436716, "link": "https://stackoverflow.com/questions/34436716/gpu-cuda-re-ordering-device-memory", "closed_reason": "Duplicate", "title": "GPU/CUDA: Re-ordering device memory", "body": "<p>I have a multi dimension array stored in device memory. I want to <a href=\"http://www.mathworks.com/help/matlab/ref/permute.html\" rel=\"nofollow\">\"permute\"</a>/<a href=\"http://docs.scipy.org/doc/numpy-1.10.1/reference/generated/numpy.transpose.html\" rel=\"nofollow\">\"transpose\"</a>, that is, re-arrange its elements according to new order of dimensions.</p>\n\n<p>For example, if I have a 2D array </p>\n\n<pre><code>A = [0, 1, 2\n     3, 4, 5]\n</code></pre>\n\n<p>I want to change the order of dimension so I get</p>\n\n<pre><code>B = [0, 3\n     1, 4\n     2, 5]\n</code></pre>\n\n<p>This re-ordering practically copies the elements that are stored in memory in the order <code>[0,1,2,3,4,5]</code> and return a new ordering <code>[0,3,1,4,2,5]</code>.</p>\n\n<p>I know how to map the indices from <code>A</code> to <code>B</code>, my question is how I can execute this mapping efficiently on device using cuda?</p>\n"}, {"tags": ["c++", "csv", "binary"], "comments": [{"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 3, "creation_date": 1450877095, "post_id": 34436614, "comment_id": 56614154, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1120140/how-can-i-read-and-parse-csv-files-in-c\">How can I read and parse CSV files in C++?</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1450877117, "post_id": 34436614, "comment_id": 56614171, "body": "Of course it doesn&#39;t work, your file is in text format and you read it as raw binary."}, {"owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 2, "creation_date": 1450879792, "post_id": 34436614, "comment_id": 56615770, "body": "CSV is not a binary format."}], "answers": [{"comments": [{"owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "reply_to_user": {"reputation": 25, "user_id": 5644687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65d7a1dbca300a539393317f9730c3c8?s=128&d=identicon&r=PG&f=1", "display_name": "Artur", "link": "https://stackoverflow.com/users/5644687/artur"}, "edited": false, "score": 0, "creation_date": 1451179095, "post_id": 34436663, "comment_id": 56695243, "body": "@Artur - You might as well accept this as the answer then. Now it stays on the list as &#39;unanswered&#39;."}, {"owner": {"reputation": 25, "user_id": 5644687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65d7a1dbca300a539393317f9730c3c8?s=128&d=identicon&r=PG&f=1", "display_name": "Artur", "link": "https://stackoverflow.com/users/5644687/artur"}, "edited": false, "score": 0, "creation_date": 1451306995, "post_id": 34436663, "comment_id": 56729277, "body": "Oh, true. Thanks :) . I&#39;m new here and I didn&#39;t realize that."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4180612"}, "is_accepted": true, "score": 0, "last_activity_date": 1450876853, "creation_date": 1450876853, "answer_id": 34436663, "question_id": 34436614, "link": "https://stackoverflow.com/questions/34436614/binary-read-data-to-float-c/34436663#34436663", "title": "Binary read data to float C++", "body": "<p>Use <a href=\"http://www.cplusplus.com/reference/istream/istream/operator%3E%3E/\" rel=\"nofollow\"><code>&gt;&gt;</code></a> operator:\n<code>obraz &gt;&gt; lateral_range;</code>.</p>\n"}], "owner": {"reputation": 25, "user_id": 5644687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65d7a1dbca300a539393317f9730c3c8?s=128&d=identicon&r=PG&f=1", "display_name": "Artur", "link": "https://stackoverflow.com/users/5644687/artur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 438, "favorite_count": 0, "accepted_answer_id": 34436663, "answer_count": 1, "score": -1, "last_activity_date": 1450878302, "creation_date": 1450876706, "last_edit_date": 1450878302, "question_id": 34436614, "link": "https://stackoverflow.com/questions/34436614/binary-read-data-to-float-c", "title": "Binary read data to float C++", "body": "<p>I need to read into my program some data from <code>.CSV</code> file and I have no idea how to change this number into float.\nI can use only standard libraries and this file needs to be binary (<code>ios::binary</code>).</p>\n\n<p>This is how it looks like in .csv file:</p>\n\n<pre><code>Lateral.Range(mm),5.000000\n</code></pre>\n\n<p>How to make this \"5.000000\" a float?</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;fstream&gt;\n#include&lt;cstring&gt;\n\nusing namespace std;\n\nint main()\n{\n    ifstream obraz;\n    obraz.open(\"File_name.csv\", ios::binary);\n\n    if(!obraz)\n        cerr&lt;&lt;\"nie udalo sie otworzyc pliku \"&lt;&lt;endl;\n\n    char lat_ran[18]; // text before the number\n    float lateral_range;\n\n    obraz.read(lat_ran, sizeof(lat_ran));\n    obraz.read(reinterpret_cast&lt;float*&gt;(&amp;lateral_range), sizeof(float)); // I know this part is wrong.\n\n    obraz.close();\n}\n</code></pre>\n"}, {"tags": ["c++", "data-structures", "cout"], "comments": [{"owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 0, "creation_date": 1450880008, "post_id": 34436497, "comment_id": 56615902, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/14644716/how-to-output-a-character-as-an-integer-through-cout\">How to output a character as an integer through cout?</a>"}, {"owner": {"reputation": 1751, "user_id": 2959769, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/9WfJf.jpg?s=128&g=1", "display_name": "Vinay Shukla", "link": "https://stackoverflow.com/users/2959769/vinay-shukla"}, "reply_to_user": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 0, "creation_date": 1450880144, "post_id": 34436497, "comment_id": 56615964, "body": "@AlanStokes does it also apply to structure ? My concern was why the value in the structure is not printing whereas normal variable value is getting printed properly."}, {"owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 0, "creation_date": 1450880156, "post_id": 34436497, "comment_id": 56615979, "body": "Unless you&#39;re storing millions of these it would be easier to use plain <code>unsigned int</code> for your values."}, {"owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 0, "creation_date": 1450880231, "post_id": 34436497, "comment_id": 56616018, "body": "It applies to any value of a <code>char</code> type regardless of where you get it from. I bet your variable is not of type <code>uint8_t</code>."}, {"owner": {"reputation": 1751, "user_id": 2959769, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/9WfJf.jpg?s=128&g=1", "display_name": "Vinay Shukla", "link": "https://stackoverflow.com/users/2959769/vinay-shukla"}, "reply_to_user": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 0, "creation_date": 1450881027, "post_id": 34436497, "comment_id": 56616460, "body": "@AlanStokes yeah adding <code>+</code> displayed the value in proper format can you help as to how can i populate the structure<code>diskDataT-&gt;currentTemp</code> with this value"}], "answers": [{"comments": [{"owner": {"reputation": 1751, "user_id": 2959769, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/9WfJf.jpg?s=128&g=1", "display_name": "Vinay Shukla", "link": "https://stackoverflow.com/users/2959769/vinay-shukla"}, "edited": false, "score": 0, "creation_date": 1450881464, "post_id": 34437935, "comment_id": 56616707, "body": "Alan, I agree with you and your solution worked for printing but I wish to know how can i populate the structure with this value I tried this.  ` diskDataT-&gt;currentTemp = +currentTemp;    diskDataT-&gt;maxTemp = +maxTemp;` but this did not work. I cannot use unsigned int because it is a header file change"}, {"owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "reply_to_user": {"reputation": 1751, "user_id": 2959769, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/9WfJf.jpg?s=128&g=1", "display_name": "Vinay Shukla", "link": "https://stackoverflow.com/users/2959769/vinay-shukla"}, "edited": false, "score": 0, "creation_date": 1450881716, "post_id": 34437935, "comment_id": 56616855, "body": "You only need the <code>+</code> for output. <code>diskDataT-&gt;currentTemp = currentTemp</code> is just fine. The problem is not the value or the variable; it is only how you print it. You have to apply the <code>+</code> at the time of printing and not before. If you don&#39;t want to do that, stop using <code>uint8_t</code>."}], "tags": [], "owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "is_accepted": false, "score": 0, "last_activity_date": 1450881760, "last_edit_date": 1450881760, "creation_date": 1450881295, "answer_id": 34437935, "question_id": 34436497, "link": "https://stackoverflow.com/questions/34436497/normal-variable-getting-printed-but-its-instance-in-structure-is-printing/34437935#34437935", "title": "Normal variable getting printed but its instance in structure is printing &quot;$&quot;", "body": "<p>You already have the right value, but because it is of type <code>unsigned char</code> (which is  what <code>uint8_t</code> is on your system) the default behaviour is to print it as a character not a number. </p>\n\n<p>As I said above replacing <code>uint8_t</code> with <code>unsigned int</code> would make things slightly easier. Otherwise you just need to remember to convert the value to a wider type before you print it - that's what the <code>+</code> does.</p>\n"}], "owner": {"reputation": 1751, "user_id": 2959769, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/9WfJf.jpg?s=128&g=1", "display_name": "Vinay Shukla", "link": "https://stackoverflow.com/users/2959769/vinay-shukla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1450881760, "creation_date": 1450876327, "last_edit_date": 1450879910, "question_id": 34436497, "link": "https://stackoverflow.com/questions/34436497/normal-variable-getting-printed-but-its-instance-in-structure-is-printing", "title": "Normal variable getting printed but its instance in structure is printing &quot;$&quot;", "body": "<p>// function which populates the value of currentTemp and maxTemp </p>\n\n<pre><code>  result = smartHlpTemperatureGet( &amp;sh, &amp;currentTemp, &amp;maxTemp );\n</code></pre>\n\n<p>// Adding maxTemp and currentTemp to the structure after gettin</p>\n\n<pre><code>diskDataT-&gt;currentTemp = currentTemp;\ndiskDataT-&gt;maxTemp = maxTemp;\n</code></pre>\n\n<p>// Following cout is printing the value properly</p>\n\n<pre><code>cout&lt;&lt;\"Temperatures - Current\"&lt;&lt;currentTemp&lt;&lt;\"Max Temperature =\"&lt;&lt;maxTemp&lt;&lt;endl;\n</code></pre>\n\n<p>//structure in which the above variables are declared</p>\n\n<pre><code>  struct diskDataDetailed\n{\n\n   uint8_t currentTemp;\n   uint8_t maxTemp;\n\n}\n</code></pre>\n\n<p>//Does not print the value of currentTemp</p>\n\n<pre><code>cout&lt;&lt;diskDataT-&gt;currentTemp&lt;&lt;endl;\n</code></pre>\n\n<p>//Output for above cout</p>\n\n<pre><code>$\n</code></pre>\n\n<p>I don't understand where I am going wrong.</p>\n"}, {"tags": ["c++", "operator-overloading", "operator-keyword"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1450875673, "post_id": 34436274, "comment_id": 56613416, "body": "Are you expecting <code>arr[curSize]</code> to call <code>T operator[](int i)</code>?"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 3, "creation_date": 1450875775, "post_id": 34436274, "comment_id": 56613487, "body": "The <code>add</code> function uses the <code>[]</code> operator on <code>arr</code>, which isn&#39;t an instance of your class, so the overloaded operator isn&#39;t called."}], "answers": [{"tags": [], "owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "is_accepted": true, "score": 2, "last_activity_date": 1450879279, "last_edit_date": 1450879279, "creation_date": 1450876299, "answer_id": 34436488, "question_id": 34436274, "link": "https://stackoverflow.com/questions/34436274/using-subscript-operator-within-a-class-on-a-template-array/34436488#34436488", "title": "Using subscript operator within a class on a template array", "body": "<p>The solution you found using <code>(*this)</code> was correct but your <code>operator[]</code> returns the wrong type so there would be no correct way to use it.  Change the return from <code>T</code> to <code>T&amp;</code>:</p>\n\n<pre><code>T&amp; operator[](int i){\n        if( i &gt; sizes || i&lt;0 ){\n            cout &lt;&lt; \"Index out of bounds\" &lt;&lt; endl;\n            return arr[0];\n        }\n        return arr[i];\n}\n</code></pre>\n\n<p>Then you can use it inside your class with:</p>\n\n<pre><code>(*this)[curSize] = element;\n</code></pre>\n\n<p>You should also have a const version:</p>\n\n<pre><code>T const&amp; operator[](int i) const {\n        if( i &gt; sizes || i&lt;0 ){\n            cout &lt;&lt; \"Index out of bounds\" &lt;&lt; endl;\n            return arr[0];\n        }\n        return arr[i];\n}\n</code></pre>\n\n<p>An alternate way to code the const and non const versions (to avoid the duplicated code) would be for one to delegate to the other using <code>const_cast</code>.  </p>\n\n<p>Also notice the need for checking <code>i&lt;0</code>.  That is a reason it would have been better for both <code>i</code> and <code>sizes</code> to be <code>unsigned</code> to avoid the extra check.  The optimizer should fix the apparent inefficiency of the extra check, even if you leave the type signed.  But the extra check still clutters the source code and forgetting it (as you did) is still an easy mistake.  So using <code>int</code> for values which are never correctly negative is bad practice.</p>\n"}], "owner": {"reputation": 511, "user_id": 4461576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bnRSu.png?s=128&g=1", "display_name": "izik", "link": "https://stackoverflow.com/users/4461576/izik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 0, "accepted_answer_id": 34436488, "answer_count": 1, "score": -2, "last_activity_date": 1450879279, "creation_date": 1450875565, "question_id": 34436274, "link": "https://stackoverflow.com/questions/34436274/using-subscript-operator-within-a-class-on-a-template-array", "title": "Using subscript operator within a class on a template array", "body": "<pre><code>..\n..\n..\n\nconst int sizes = 50;\n\ntemplate&lt;class T&gt;\nclass List {\nprivate:\n    int curSize;\n    T arr[sizes];\n\npublic:\n    List&lt;T&gt;(){\n        cout &lt;&lt; \"constructor called\\n\";\n        this-&gt;curSize = 0;\n    }\n\n    void add(T element) {\n        arr[curSize] = element;\n        this-&gt;curSize++;\n    }\n\n..\n..\n..\n\nT operator[](int i){\n        if( i &gt; sizes ){\n            cout &lt;&lt; \"Index out of bounds\" &lt;&lt; endl;\n            return arr[0];\n        }\n        return arr[i];\n}\n</code></pre>\n\n<p>when i call the add function the operator overloading isnt working for me, only when i try to acces it from the main.cpp it works.\nhow can i acces the operator inside the class?\ni searched here and i found a soulotion that didnt worked for me (*this).</p>\n"}, {"tags": ["c++", "pointers", "function-pointers"], "comments": [{"owner": {"reputation": 545, "user_id": 760365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a609e2719e17ddaf2ae99133b1447b7?s=128&d=identicon&r=PG&f=1", "display_name": "Pravar Jawalekar", "link": "https://stackoverflow.com/users/760365/pravar-jawalekar"}, "edited": false, "score": 1, "creation_date": 1450876022, "post_id": 34436197, "comment_id": 56613620, "body": "You can take a look at <code>std::function</code>. It is basically a class template which can store function objects or function pointers. In your can, WindowManager class can simply contain function definitions and Button class can have member variable of type <code>std::function</code> and then WindowManager class can pass <code>std::function</code> object in constructor of Button class."}], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 4755792, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ffbb0e215361f6ff94b879a55d00265c?s=128&d=identicon&r=PG&f=1", "display_name": "Hexodus", "link": "https://stackoverflow.com/users/4755792/hexodus"}, "edited": false, "score": 0, "creation_date": 1450880262, "post_id": 34436556, "comment_id": 56616034, "body": "Curious, the <code>typedef</code> has to occur in public for it to be accessible outside of the button class (in the case I&#39;m using separate class and header files) right? In your example, <code>onClick</code> is defined  below the <code>onClick(nullptr)</code> line meaning it&#39;s not defined. Moving private above public only solves this if the <code>typedef</code> occurs above both public and private, or <code>onClick</code> is moved into public."}, {"owner": {"reputation": 329, "user_id": 4755792, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ffbb0e215361f6ff94b879a55d00265c?s=128&d=identicon&r=PG&f=1", "display_name": "Hexodus", "link": "https://stackoverflow.com/users/4755792/hexodus"}, "edited": false, "score": 0, "creation_date": 1450880637, "post_id": 34436556, "comment_id": 56616237, "body": "And what exactly is <code>Button() : onClick(nullptr) {}</code> doing in this case?"}, {"owner": {"reputation": 984, "user_id": 3586583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ff364c78d225c26158cda484102447?s=128&d=identicon&r=PG", "display_name": "Rochet2", "link": "https://stackoverflow.com/users/3586583/rochet2"}, "reply_to_user": {"reputation": 329, "user_id": 4755792, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ffbb0e215361f6ff94b879a55d00265c?s=128&d=identicon&r=PG&f=1", "display_name": "Hexodus", "link": "https://stackoverflow.com/users/4755792/hexodus"}, "edited": false, "score": 0, "creation_date": 1450881062, "post_id": 34436556, "comment_id": 56616482, "body": "@Jamie4840 Yes, the typedef would need to be public if you use it elsewhere outside of the class. But it is just an alias for the type so you can use the typedef inside the class and the type itself elsewhere without the typedef.  The <code>Button()</code> is a default constructor that ensures that <code>onClick</code> is initialized to a null pointer. See <a href=\"http://stackoverflow.com/questions/8406931/pointer-member-variable-initialization-in-c-classes\" title=\"pointer member variable initialization in c classes\">stackoverflow.com/questions/8406931/&hellip;</a>"}, {"owner": {"reputation": 984, "user_id": 3586583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ff364c78d225c26158cda484102447?s=128&d=identicon&r=PG", "display_name": "Rochet2", "link": "https://stackoverflow.com/users/3586583/rochet2"}, "reply_to_user": {"reputation": 329, "user_id": 4755792, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ffbb0e215361f6ff94b879a55d00265c?s=128&d=identicon&r=PG&f=1", "display_name": "Hexodus", "link": "https://stackoverflow.com/users/4755792/hexodus"}, "edited": false, "score": 0, "creation_date": 1450881988, "post_id": 34436556, "comment_id": 56617017, "body": "@Jamie4840 note that onClick is a member variable (the function pointer to store) and OnClick is a member function. Careful with that case sensitivity. You can move the class member functions and variables around as you please, but the typedef needs to be above it&#39;s use cases. So in other words because onClick is defined in the class it is defined everywhere in the class - even above the actual definition."}, {"owner": {"reputation": 329, "user_id": 4755792, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ffbb0e215361f6ff94b879a55d00265c?s=128&d=identicon&r=PG&f=1", "display_name": "Hexodus", "link": "https://stackoverflow.com/users/4755792/hexodus"}, "edited": false, "score": 0, "creation_date": 1450884019, "post_id": 34436556, "comment_id": 56618164, "body": "I&#39;m struggling to get this working myself. Everything that is occurring in <code>main()</code> in your example is occurring in a function within <code>WindowManager</code> for me, lets say <code>InitGUI</code>. Therefore, my <code>MyEventFunc</code> also has to be a function within <code>WindowManager</code>. In this case, trying to make a pointer <code>&amp;MyEventFunc</code> from <code>InitGUI</code> gives me <code>&#39;&amp;&#39;: illegal operation on bound member function expression</code>. Is it possible for it to work this way?"}, {"owner": {"reputation": 984, "user_id": 3586583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ff364c78d225c26158cda484102447?s=128&d=identicon&r=PG", "display_name": "Rochet2", "link": "https://stackoverflow.com/users/3586583/rochet2"}, "reply_to_user": {"reputation": 329, "user_id": 4755792, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ffbb0e215361f6ff94b879a55d00265c?s=128&d=identicon&r=PG&f=1", "display_name": "Hexodus", "link": "https://stackoverflow.com/users/4755792/hexodus"}, "edited": false, "score": 0, "creation_date": 1450892947, "post_id": 34436556, "comment_id": 56623605, "body": "@Jamie4840 I believe this was already answered by Gernot, but here is a small example for a static function that you seemed to be using: <a href=\"http://ideone.com/xzbR8d\" rel=\"nofollow noreferrer\">ideone.com/xzbR8d</a> There are comments on what needs to be included for what part of code if the code is split into different files."}], "tags": [], "owner": {"reputation": 984, "user_id": 3586583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ff364c78d225c26158cda484102447?s=128&d=identicon&r=PG", "display_name": "Rochet2", "link": "https://stackoverflow.com/users/3586583/rochet2"}, "is_accepted": false, "score": 3, "last_activity_date": 1450876887, "last_edit_date": 1450876887, "creation_date": 1450876503, "answer_id": 34436556, "question_id": 34436197, "link": "https://stackoverflow.com/questions/34436197/pass-in-and-store-function-pointer-to-object/34436556#34436556", "title": "Pass in and store function pointer to object", "body": "<p>Here is one approach by using function pointers. However using <code>std::function</code> makes the code more flexible. For example you can use lambda expressions.\nTo use <code>std::function</code> you can simply change the typedef to <code>typedef std::function&lt;void(Button*)&gt; EventCallback;</code> and add  the include <code>#include &lt;functional&gt;</code></p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass Button\n{\npublic:\n    // Typedef of the event function signature\n    typedef void(*EventCallback)(Button* button);\n\n    Button() : onClick(nullptr) {}\n\n    // Set the function to call\n    void SetOnClick(EventCallback func) { onClick = func; }\n    // Call the function if exists\n    void OnClick() {\n        if (onClick)\n            onClick(this);\n    }\n\nprivate:\n    // This stores the function pointer for the button\n    EventCallback onClick;\n};\n\n// just some example function that has the same signature as Button::EventCallback\nvoid MyEventFunc(Button* button)\n{\n    std::cout &lt;&lt; \"Triggered\" &lt;&lt; std::endl;\n}\n\nint main() {\n    Button button;\n    button.SetOnClick(&amp;MyEventFunc);\n    button.OnClick();\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"http://ideone.com/x5O49B\" rel=\"nofollow\">http://ideone.com/x5O49B</a></p>\n"}, {"comments": [{"owner": {"reputation": 329, "user_id": 4755792, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ffbb0e215361f6ff94b879a55d00265c?s=128&d=identicon&r=PG&f=1", "display_name": "Hexodus", "link": "https://stackoverflow.com/users/4755792/hexodus"}, "edited": false, "score": 0, "creation_date": 1450885941, "post_id": 34436598, "comment_id": 56619458, "body": "On `\tWindowManager::TypeOnClickFunc _onclickfptr;` I&#39;m getting the error <code>use of undefined type &#39;WindowManager&#39;</code> despite having included windowmanager.h. Will this method work if I have the two classes in separate files as wel ass having <code>btn1-&gt;SetOnClick()</code> being called from a setup function within <code>WindowManager</code>?"}, {"owner": {"reputation": 329, "user_id": 4755792, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ffbb0e215361f6ff94b879a55d00265c?s=128&d=identicon&r=PG&f=1", "display_name": "Hexodus", "link": "https://stackoverflow.com/users/4755792/hexodus"}, "edited": false, "score": 0, "creation_date": 1450886669, "post_id": 34436598, "comment_id": 56619902, "body": "Both are already included. VisualStudio seems to recognise everything as intellisense doesn&#39;t throw any issues but upon building the compiler complains about the undefined type."}, {"owner": {"reputation": 329, "user_id": 4755792, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ffbb0e215361f6ff94b879a55d00265c?s=128&d=identicon&r=PG&f=1", "display_name": "Hexodus", "link": "https://stackoverflow.com/users/4755792/hexodus"}, "edited": false, "score": 0, "creation_date": 1450913264, "post_id": 34436598, "comment_id": 56632452, "body": "I&#39;ve absolutely no idea what happened the first time I tried it but I&#39;d obviously broken something somewhere and I had a page of errors. Started over and it&#39;s working perfectly. Thanks for your help!"}], "tags": [], "owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": true, "score": 2, "last_activity_date": 1450888967, "last_edit_date": 1450888967, "creation_date": 1450876663, "answer_id": 34436598, "question_id": 34436197, "link": "https://stackoverflow.com/questions/34436197/pass-in-and-store-function-pointer-to-object/34436598#34436598", "title": "Pass in and store function pointer to object", "body": "<p>You can do it with pointer to member function like this (in this case Button has to know WindowManager);</p>\n\n<pre><code>class WindowManager\n{\npublic:\n    typedef void (WindowManager::* TypeOnClickFunc)( void );\n\n    void anyfunction( void ) {}\n};\n\nclass Button\n{\npublic:\n\n    Button( WindowManager * wm ) :_windowmanager( wm ) {}\n\n    void SetOnClick( WindowManager::TypeOnClickFunc fptr )\n    {\n        _onclickfptr = fptr;\n    }\n\n    void OnClick( void )\n    {\n        (_windowmanager-&gt;*_onclickfptr )( ); // indirect call WindowManager::anyfunction\n    }\n\nprivate:\n\n    WindowManager *_windowmanager;\n    WindowManager::TypeOnClickFunc _onclickfptr;\n};\n\nWindowManager wm;\n\nButton *btn1 = new Button( &amp;wm );\nbtn1-&gt;SetOnClick( &amp;WindowManager::anyfunction );\n</code></pre>\n\n<p>... or with pointer to static function like this ...</p>\n\n<pre><code>class WindowManager\n{\npublic:\n    typedef void (*TypeOnClickFunc)( void );\n\n    static void anyfunction( void ) {}\n};\n\nclass Button\n{\npublic:\n\n    Button() {}\n\n    void SetOnClick( WindowManager::TypeOnClickFunc fptr )\n    {\n        _onclickfptr = fptr;\n    }\n\n    void OnClick( void )\n    {\n        (*_onclickfptr )( ); // indirect call static WindowManager::anyfunction\n    }\n\nprivate:\n\n    WindowManager::TypeOnClickFunc _onclickfptr;\n};\n\nButton *btn1 = new Button();\nbtn1-&gt;SetOnClick( &amp;WindowManager::anyfunction );\n</code></pre>\n\n<p>... with typdef in Button instead of WindowManager ...</p>\n\n<pre><code>class WindowManager\n{\npublic:\n    static void anyfunction( void ) {}\n};\n\nclass Button\n{\npublic:\n    typedef void (*TypeOnClickFunc)( void );\n\n    Button() {}\n\n    void SetOnClick( TypeOnClickFunc fptr )\n    {\n        _onclickfptr = fptr;\n    }\n\n    void OnClick( void )\n    {\n        (*_onclickfptr )( ); // indirect call \n    }\n\nprivate:\n    TypeOnClickFunc _onclickfptr;\n};\n\nButton *btn1 = new Button();\nbtn1-&gt;SetOnClick( &amp;WindowManager::anyfunction ); \n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 4755792, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ffbb0e215361f6ff94b879a55d00265c?s=128&d=identicon&r=PG&f=1", "display_name": "Hexodus", "link": "https://stackoverflow.com/users/4755792/hexodus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1333, "favorite_count": 1, "accepted_answer_id": 34436598, "answer_count": 2, "score": 1, "last_activity_date": 1450888967, "creation_date": 1450875357, "last_edit_date": 1450886436, "question_id": 34436197, "link": "https://stackoverflow.com/questions/34436197/pass-in-and-store-function-pointer-to-object", "title": "Pass in and store function pointer to object", "body": "<p>I'm writing a basic GUI framework as a school project and I'm trying to create an object (think a button) that, when interacted with, will call a particular function.</p>\n\n<p>To explain my setup simply, I have a button class and a window manager class. The window manager is instantiated once from main and many buttons are instantiated from the window manager, with all 3 being in separate files. Nothing should go in main.</p>\n\n<p>I'm a bit of a C++ noob, but as far as I can see, it would be best to use function pointers for this. My idea is to instantiate my button object then to pass it a function pointer to a function that when called would edit another object.</p>\n\n<p>Firstly, I presume that the best way to do this would be to have the functions be defined locally to the window manager otherwise I'd have trouble with access? I had wanted to initially not have them listed in the header to make things easier (with a view to creating a kind of drag and drop editor in the future).</p>\n\n<p>Second, how would I pass (from the window manager) a pointer to a function (which would exist within the window manager) to an instance of a button object? I thought I'd be able to treat it similarly to any other variable and do something as:</p>\n\n<pre><code>Button btn1 = new Button();\nbtn1-&gt;SetText(\"Button 1\");\nbtn1-&gt;SetOnClick(functionpointer);\n</code></pre>\n\n<p>But, after looking through various tutorials I don't quite understand how I'd implement this. For example, how do I even define somewhere to store the function pointer in my button class?</p>\n\n<p>Would appreciate any insight, I think I've confused myself enough for one day.</p>\n\n<p><strong>EDIT: Seems I should add that my <code>Button</code> and <code>WindowManager</code> classes are in separate files and my entry point so to speak is an instance of <code>WindowManager</code>. All the setup of my GUI including assigning a function to a button would be done in the constructor of <code>WindowManager</code>.</strong></p>\n"}, {"tags": ["c++", "priority-queue", "multimap", "minmax"], "comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1450875521, "post_id": 34436183, "comment_id": 56613329, "body": "C has no <code>std::multimap</code> or <code>std::set</code>. The tag seems irrelevant to your question. Why did you add it?"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1450875932, "post_id": 34436183, "comment_id": 56613573, "body": "So, the <code>minValue</code> function should return the smallest value in the map, rather than the value in the smallest key?"}, {"owner": {"reputation": 3478, "user_id": 5138665, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh5.googleusercontent.com/-Xzku5FavZUc/AAAAAAAAAAI/AAAAAAAAAAs/hj_zbKCGfM8/photo.jpg?sz=128", "display_name": "Amit Tiwari", "link": "https://stackoverflow.com/users/5138665/amit-tiwari"}, "edited": false, "score": 0, "creation_date": 1450876065, "post_id": 34436183, "comment_id": 56613641, "body": "C++ already has <code>priority_queue</code> in STL. What extra functionality do you want apart from that?"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 3478, "user_id": 5138665, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh5.googleusercontent.com/-Xzku5FavZUc/AAAAAAAAAAI/AAAAAAAAAAs/hj_zbKCGfM8/photo.jpg?sz=128", "display_name": "Amit Tiwari", "link": "https://stackoverflow.com/users/5138665/amit-tiwari"}, "edited": false, "score": 0, "creation_date": 1450876159, "post_id": 34436183, "comment_id": 56613682, "body": "@AmitTiwari <code>std::priority_queue</code> is single ended. astose appears to be implementing a double ended priority queue."}, {"owner": {"reputation": 125, "user_id": 3870339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w5QiK.png?s=128&g=1", "display_name": "Maciej Pk", "link": "https://stackoverflow.com/users/3870339/maciej-pk"}, "edited": false, "score": 0, "creation_date": 1450876236, "post_id": 34436183, "comment_id": 56613723, "body": "Correct. minValue has to return the smallest value in the map. I think that the only solution would be to duplicate memory size, but is there any other option?"}, {"owner": {"reputation": 3478, "user_id": 5138665, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh5.googleusercontent.com/-Xzku5FavZUc/AAAAAAAAAAI/AAAAAAAAAAs/hj_zbKCGfM8/photo.jpg?sz=128", "display_name": "Amit Tiwari", "link": "https://stackoverflow.com/users/5138665/amit-tiwari"}, "edited": false, "score": 0, "creation_date": 1450876352, "post_id": 34436183, "comment_id": 56613776, "body": "If it is possible, you could maintain 2 priority queues. One a min-heap and other a max-heap."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 3870339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w5QiK.png?s=128&g=1", "display_name": "Maciej Pk", "link": "https://stackoverflow.com/users/3870339/maciej-pk"}, "edited": false, "score": 0, "creation_date": 1450881549, "post_id": 34436868, "comment_id": 56616762, "body": "Hm, I think that using std::multimap + std::set would be the best option. in multimap I would just store &lt;K, *V&gt; and in std::set I would store just V. This way, none of the data is duplicated and I have constant access to minValue and maxValue."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 125, "user_id": 3870339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w5QiK.png?s=128&g=1", "display_name": "Maciej Pk", "link": "https://stackoverflow.com/users/3870339/maciej-pk"}, "edited": false, "score": 0, "creation_date": 1450881793, "post_id": 34436868, "comment_id": 56616900, "body": "That wouldn&#39;t allow you to find what is the key of the min value. If you don&#39;t need that, then suit yourself."}, {"owner": {"reputation": 125, "user_id": 3870339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w5QiK.png?s=128&g=1", "display_name": "Maciej Pk", "link": "https://stackoverflow.com/users/3870339/maciej-pk"}, "edited": false, "score": 0, "creation_date": 1450883240, "post_id": 34436868, "comment_id": 56617768, "body": "I don&#39;t need that. Now I have a problem with copy constructor, because it has to be in [O(queue.size())] time complexity, therefore I cannot use neither insert nor find. Using = operator on multimap would give me pointers to original values (not copied ones). Do you maybe have an idea on how to accomplish it?"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 125, "user_id": 3870339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w5QiK.png?s=128&g=1", "display_name": "Maciej Pk", "link": "https://stackoverflow.com/users/3870339/maciej-pk"}, "edited": false, "score": 0, "creation_date": 1450884161, "post_id": 34436868, "comment_id": 56618251, "body": "Simply use the copy constructor of the <code>mutltimap</code>. No, <code>operator=</code> does not give you pointers to original values. It does a deep copy."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1450877595, "creation_date": 1450877595, "answer_id": 34436868, "question_id": 34436183, "link": "https://stackoverflow.com/questions/34436183/implementing-minmax-priorityqueue-with-minvalue-and-maxvalue-in-o1/34436868#34436868", "title": "Implementing MinMax PriorityQueue with minValue and maxValue in O(1)", "body": "<p>Let's recap what you want. You want to implement a double ended priority queue for key-value-pairs that must be sorted according to two different comparison functions. One that compares the key-part of the pair, and one that compares the value-part.</p>\n\n<p>In my opinion, that's too many responsibilities for a single container. I would recommend that you implement a priority queue that uses only a single comparison, and use two separate priority queues with duplicated content but different comparison function. Sure, that duplicates the datastructure just like your parallel <code>std::set</code> idea, but the simpler one-comparison priority queue that you will have implemented will be more (re-)useful in general. It could be used even when the user only needs to store simple, non-pair types and has no need for multiple sortings. If the size of the individual objects is large, then you can store pointers in one to save space that would be taken by duplication.</p>\n\n<p>Ignoring a very different solution such as an interval heap, I would recommend using a <code>std::mutiset</code> of key-value-pairs instead of <code>std::multimap</code> because the map wouldn't ever be used to find arbitrary elements by key. You only need to find the first and the last elements after all.</p>\n\n<p>If you're hell-bent on your multi-comparison-rule design, then what you could use to implement the queue is a multi-index container. <a href=\"http://www.boost.org/doc/libs/1_60_0/libs/multi_index/doc/index.html\" rel=\"nofollow\">Boost</a> has a library of such containers.</p>\n"}], "owner": {"reputation": 125, "user_id": 3870339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w5QiK.png?s=128&g=1", "display_name": "Maciej Pk", "link": "https://stackoverflow.com/users/3870339/maciej-pk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 253, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450877595, "creation_date": 1450875284, "last_edit_date": 1450875734, "question_id": 34436183, "link": "https://stackoverflow.com/questions/34436183/implementing-minmax-priorityqueue-with-minvalue-and-maxvalue-in-o1", "title": "Implementing MinMax PriorityQueue with minValue and maxValue in O(1)", "body": "<p>I'm implementing a MinMax Priority Queue on a std::multimap with a possibility of having multiple values on a key and I already have functions minKey and maxKey written in O(1) time complexity (using begin() and end()).</p>\n\n<p>Now, I have a problem with implementing minValue and maxValue. One of the obvious solutions would be to make a data structure (for example with std::set) with just values of that pqueue and having an access to min and max in O(1).</p>\n\n<p>Obviously, the cons of this solution would be duplicated memory size, which I certainly do not want.</p>\n\n<p>I'm thinking about a solution with pointers to minValue and maxValue respectively. Insertion to PQ would be easy, just compare with these pointers... now what about removal?</p>\n\n<p>Insertion: I can have multiple values on a certain key</p>\n\n<p>Removal: Erases any value from a certain key (if key does not exist, an exception is thrown).</p>\n\n<p>Do you have any suggestion on how to implement minValue and maxValue in O(1) time complexity? </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c++", "opencv"], "comments": [{"owner": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "edited": false, "score": 1, "creation_date": 1450875147, "post_id": 34436110, "comment_id": 56613088, "body": "Side comment: you declare twice the variables &#236;, j and k. Once is enough (inside the &#39;for&#39;)"}, {"owner": {"reputation": 159, "user_id": 4177774, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/90fdd647c2d3a2a7d67dc67f3719af39?s=128&d=identicon&r=PG&f=1", "display_name": "purudpd", "link": "https://stackoverflow.com/users/4177774/purudpd"}, "reply_to_user": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "edited": false, "score": 0, "creation_date": 1450875666, "post_id": 34436110, "comment_id": 56613409, "body": "Someone just posted the correct answer here and then removed the comment."}, {"owner": {"reputation": 159, "user_id": 4177774, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/90fdd647c2d3a2a7d67dc67f3719af39?s=128&d=identicon&r=PG&f=1", "display_name": "purudpd", "link": "https://stackoverflow.com/users/4177774/purudpd"}, "reply_to_user": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "edited": false, "score": 0, "creation_date": 1450875772, "post_id": 34436110, "comment_id": 56613485, "body": "The issue was due to difference in the color space. Reading the files with grayscale( imread(&quot;tomato.jpg&quot;,0) ) fixed it."}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 4177774, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/90fdd647c2d3a2a7d67dc67f3719af39?s=128&d=identicon&r=PG&f=1", "display_name": "purudpd", "link": "https://stackoverflow.com/users/4177774/purudpd"}, "edited": false, "score": 0, "creation_date": 1452668007, "post_id": 34758686, "comment_id": 57265456, "body": "I was able to fix the issue. The issue was because the training images and testing image were not in the space color space. I made all of them grayscale thereby fixing the code."}, {"owner": {"reputation": 108, "user_id": 4300003, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JPA5S-8vQWM/AAAAAAAAAAI/AAAAAAAAAHg/EWR-IpLNDVM/photo.jpg?sz=128", "display_name": "Liberus", "link": "https://stackoverflow.com/users/4300003/liberus"}, "reply_to_user": {"reputation": 159, "user_id": 4177774, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/90fdd647c2d3a2a7d67dc67f3719af39?s=128&d=identicon&r=PG&f=1", "display_name": "purudpd", "link": "https://stackoverflow.com/users/4177774/purudpd"}, "edited": false, "score": 0, "creation_date": 1487882907, "post_id": 34758686, "comment_id": 71997137, "body": "@PurusharthDwivedi please close your question then, or if the answer above helped - mark it"}], "tags": [], "owner": {"reputation": 11, "user_id": 5782208, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kgf4hfspx74/AAAAAAAAAAI/AAAAAAAAAYo/EJiHfmJ9N_Q/photo.jpg?sz=128", "display_name": "JeongHwan", "link": "https://stackoverflow.com/users/5782208/jeonghwan"}, "is_accepted": false, "score": 1, "last_activity_date": 1452661124, "creation_date": 1452661124, "answer_id": 34758686, "question_id": 34436110, "link": "https://stackoverflow.com/questions/34436110/training-svm-for-images-in-opencv/34758686#34758686", "title": "Training svm for images in opencv", "body": "<p>check <p>1) Tomato.jpg and Melon.jpg size is 128*128 ? <br>\n      2) both images are grayscale? </P>\nif not. try this code: <br>I just add resize(), cvtColor() and print result</p>\n\n<pre><code>#include &lt;opencv2/core/core.hpp&gt;\n#include &lt;opencv2/highgui/highgui.hpp&gt;\n#include &lt;opencv2/ml/ml.hpp&gt;\n#include &lt;opencv2\\imgproc\\imgproc.hpp&gt;\n\nusing namespace cv;\nusing namespace std;\n\nint main(){\n    int num_files = 2;\n    int width = 128, height = 128;\n\n    Mat image[2];\n    image[0] = imread(\"Tomato.jpg\", 0);\n    image[1] = imread(\"Melon.jpg\", 0);\n\n    resize(image[0], image[0], Size(width, height));\n    resize(image[1], image[1], Size(width, height));\n\n    Mat new_image(2, height*width, CV_32FC1); //Training sample from input images\n\n    int ii = 0;\n    for (int i = 0; i &lt; num_files; i++){\n        Mat temp = image[i];\n        ii = 0;\n        for (int j = 0; j &lt; temp.rows; j++){\n            for (int k = 0; k &lt; temp.cols; k++){\n                new_image.at&lt;float&gt;(i, ii++) = temp.at&lt;uchar&gt;(j, k);\n            }\n        }\n    }\n    //new_image.push_back(image[0].reshape(0, 1));\n    //new_image.push_back(image[1].reshape(0, 1));\n    Mat labels(num_files, 1, CV_32FC1);\n    labels.at&lt;float&gt;(0, 0) = 1.0;//tomato\n    labels.at&lt;float&gt;(1, 0) = -1.0;//melon\n\n    imshow(\"New image\", new_image);\n    printf(\"%f %f\", labels.at&lt;float&gt;(0, 0), labels.at&lt;float&gt;(1, 0));\n\n    CvSVMParams params;\n    params.svm_type = CvSVM::C_SVC;\n    params.kernel_type = CvSVM::LINEAR;\n    params.gamma = 3;\n    params.degree = 3;\n    params.term_crit = cvTermCriteria(CV_TERMCRIT_ITER, 100, 1e-6);\n    CvSVM svm;\n    svm.train(new_image, labels, Mat(), Mat(), params);\n\n    svm.save(\"svm.xml\"); // saving\n    svm.load(\"svm.xml\"); // loading\n\n    Mat test_img = imread(\"Tomato.jpg\", 0);\n    resize(test_img, test_img, Size(width, height));\n    test_img = test_img.reshape(0, 1);\n    imshow(\"shit_image\", test_img);\n    test_img.convertTo(test_img, CV_32FC1);\n    float res = svm.predict(test_img);\n    if (res &gt; 0)\n        cout &lt;&lt; endl &lt;&lt; \"Tomato\";\n    else\n        cout &lt;&lt; endl &lt;&lt; \"Melon\";\n    waitKey(0);\n}\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 4177774, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/90fdd647c2d3a2a7d67dc67f3719af39?s=128&d=identicon&r=PG&f=1", "display_name": "purudpd", "link": "https://stackoverflow.com/users/4177774/purudpd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3331, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452661124, "creation_date": 1450874988, "last_edit_date": 1495541803, "question_id": 34436110, "link": "https://stackoverflow.com/questions/34436110/training-svm-for-images-in-opencv", "title": "Training svm for images in opencv", "body": "<p>I have already reffered to the following links:\n<a href=\"https://stackoverflow.com/questions/29348239/training-images-using-svm-on-opencv\">Link 1</a> and <a href=\"https://stackoverflow.com/questions/14694810/using-opencv-and-svm-with-images\">Link 2</a></p>\n\n<p>From the above i have to managed to write the following :</p>\n\n<pre><code>#include &lt;opencv2/core/core.hpp&gt;\n#include &lt;opencv2/highgui/highgui.hpp&gt;\n#include &lt;opencv2/ml/ml.hpp&gt;\n\nusing namespace cv;\nusing namespace std;\n\nint main(){\n    int num_files = 2;\n    int width = 128, height = 128;\n\n    Mat image[2];\n    image[0] = imread(\"Tomato.jpg\");\n    image[1] = imread(\"Melon.jpg\");\n\n    Mat new_image(2,height*width,CV_32FC1); //Training sample from input images\n\n    int ii = 0;\n    for (int i = 0; i &lt; num_files; i++){\n        Mat temp = image[i];\n        ii = 0;\n        for (int j = 0; j &lt; temp.rows; j++){\n            for (int k = 0; k &lt; temp.cols; k++){\n                new_image.at&lt;float&gt;(i, ii++) = temp.at&lt;uchar&gt;(j, k);\n            }\n        }\n    }\n    //new_image.push_back(image[0].reshape(0, 1));\n    //new_image.push_back(image[1].reshape(0, 1));\n    Mat labels(num_files, 1, CV_32FC1);\n    labels.at&lt;float&gt;(0, 0) = 1.0;//tomato\n    labels.at&lt;float&gt;(1, 0) = -1.0;//melon\n\n    imshow(\"New image\", new_image);\n    printf(\"%f %f\", labels.at&lt;float&gt;(0, 0), labels.at&lt;float&gt;(1, 0));\n\n    CvSVMParams params;\n    params.svm_type = CvSVM::C_SVC;\n    params.kernel_type = CvSVM::LINEAR;\n    params.gamma = 3;\n    params.degree = 3;\n    params.term_crit = cvTermCriteria(CV_TERMCRIT_ITER, 100, 1e-6);\n    CvSVM svm;\n    svm.train(new_image, labels, Mat(), Mat(), params);\n\n    svm.save(\"svm.xml\"); // saving\n    svm.load(\"svm.xml\"); // loading\n\n    Mat test_img = imread(\"Tomato.jpg\");\n    test_img=test_img.reshape(0, 1);\n    imshow(\"shit_image\", test_img);\n    test_img.convertTo(test_img, CV_32FC1);\n    svm.predict(test_img);\n\n    waitKey(0);\n}\n</code></pre>\n\n<p>I get the following error:</p>\n\n<blockquote>\n  <p>unsupported format or combination of formats, input sample must have 32FC1 type in cvPreparePredictData ...</p>\n</blockquote>\n\n<p>I followed all steps in the second link. All matrices are 32FC1 type. \nWhat am I missing?\nIs there something wrong with the svm parameters ?\nThe error is caused when i try to predict a result.</p>\n"}, {"tags": ["c++", "directx"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1450875317, "post_id": 34436021, "comment_id": 56613189, "body": "This is usually done as part of object design taking into account how the object should behave in the scene.  For very simple objects it can be done mathematically but for anything even slightly complex the object designer usually needs to include it in the model."}], "answers": [{"tags": [], "owner": {"reputation": 916, "user_id": 2242745, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0474fd0e62b23df1b5b339fa622895b?s=128&d=identicon&r=PG", "display_name": "kbz", "link": "https://stackoverflow.com/users/2242745/kbz"}, "is_accepted": true, "score": 1, "last_activity_date": 1504904712, "creation_date": 1504904712, "answer_id": 46124532, "question_id": 34436021, "link": "https://stackoverflow.com/questions/34436021/how-to-get-the-centre-of-an-object-in-direct-x-11-c/46124532#46124532", "title": "How to get the centre of an object in direct x 11 C++", "body": "<p>Rotation/scale should be done before translation</p>\n"}], "owner": {"reputation": 916, "user_id": 2242745, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0474fd0e62b23df1b5b339fa622895b?s=128&d=identicon&r=PG", "display_name": "kbz", "link": "https://stackoverflow.com/users/2242745/kbz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 46124532, "answer_count": 1, "score": 2, "last_activity_date": 1504904712, "creation_date": 1450874710, "last_edit_date": 1450875262, "question_id": 34436021, "link": "https://stackoverflow.com/questions/34436021/how-to-get-the-centre-of-an-object-in-direct-x-11-c", "title": "How to get the centre of an object in direct x 11 C++", "body": "<p>How to I obtain the centre of the objects I'm drawing in direct x 11? I'm having a problem when rotating the objects that they're rotating about their position, but their position is from one of the corners, resulting in a circular motion when rotating. I'm trying to rotate about the cente (origin)</p>\n\n<p>I'm translating before rotating using the following:</p>\n\n<pre><code>setObjectWorld(XMMatrixIdentity());\n\nsetTranslation(XMMatrixTranslation(getPositionX(), getPositionY(), getPositionZ()));\n\nsetRotationAxis(XMVectorSet(0.0f, 1.0f, 0.0f, 0.0f));\nsetRotation(XMMatrixRotationAxis(getRotationAxisVector(), delta));\n\nsetObjectWorld(getTranslationMatrix() * getRotationMatrix());\n</code></pre>\n\n<p>The outcome is this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mE8FL.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mE8FL.gif\" alt=\"enter image description here\"></a></p>\n"}]