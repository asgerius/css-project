[{"tags": ["c++", "c", "memory-barriers", "stdatomic", "itanium"], "comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559171245, "post_id": 56369559, "comment_id": 99341764, "body": "If you use acq/rel for everything (like x86) then barriers become no-ops except for seq_cst.  (Although I&#39;m not 100% sure about barriers being supposed to affect non-atomic operations as well, or if that&#39;s just an implementation detail in current compilers).  Seems like a weird choice, but maybe a good idea on that microarchitecture family for some reason."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559171349, "post_id": 56369559, "comment_id": 99341784, "body": "So what about the <code>mf</code> in <code>cmpxchg.rel; mf</code>? It is redundant? What does it provide if <code>cmpxchg</code> has ack?"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559171650, "post_id": 56369559, "comment_id": 99341838, "body": "IDK, I haven&#39;t thought about that part yet."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1574122519, "post_id": 56369559, "comment_id": 104111065, "body": "@PeterCordes &quot;<i>barriers being supposed to affect non-atomic operations as well</i>&quot; What in the (C or C++) std supports the idea that thread fences can order two non atomic ops?"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1574130302, "post_id": 56369559, "comment_id": 104112613, "body": "Back in May that was something I wondered about.  But now I think atomic_thread_fence doesn&#39;t help for non-atomic ops wrt. each other, but yes wrt. the fence in case there&#39;s an acq or rel operation on the other side of the fence somewhere in another function (e.g. the caller, or a library function).  In general compilers don&#39;t usually have a <i>complete</i> picture of the source they&#39;re compiling, and have to emit function definitions that work for an arbitrary caller.  Even with LTO there are some non-inline library functions.  So non-atomic ops do sometimes need to be ordered wrt. a fence."}], "owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1559170705, "creation_date": 1559170705, "question_id": 56369559, "link": "https://stackoverflow.com/questions/56369559/issue-with-c-c11-mappings-to-processors-in-proposed-nop-memory-barriers-for", "title": "Issue with &quot;C/C++11 mappings to processors&quot; in proposed NOP memory barriers for Itanium?", "body": "<p>Although I don't read Itanium assembly, and I don't claim to understand its memory model, I have noticed something very strange and apparently contradictory in one proposed mapping of C/C++ atomics to Itanium.</p>\n\n<p>In <a href=\"https://www.cl.cam.ac.uk/~pes20/cpp/cpp0xmappings.html\" rel=\"nofollow noreferrer\">C/C++11 mappings to processors</a> the proposed implementation of atomics on Itanium suggests no acquire or release fences:</p>\n\n<pre><code>Consume Fence:  &lt;ignore&gt;\nAcquire Fence:  &lt;ignore&gt;\nRelease Fence:  &lt;ignore&gt;\nAcq_Rel Fence:  &lt;ignore&gt;\n</code></pre>\n\n<p>(What is a consume fence anyway?)</p>\n\n<p>And indeed in that proposal the relaxed atomic loads and stores are never relaxed:</p>\n\n<pre><code>Load Relaxed:   ld.acq\nLoad Consume:   ld.acq\nLoad Acquire:   ld.acq\n...\n</code></pre>\n\n<p>We see that all relaxed simple (not RMW) operations are already Acq_Rel in these mappings. But looking at RMW operations with see that the relaxed and non-relaxed operations are different:</p>\n\n<pre><code>Cmpxchg Release:    cmpxchg.rel\nCmpxchg AcqRel:     cmpxchg.rel; mf\n</code></pre>\n\n<p>Unless the Cmpxchg AcqRel implementation has gratuitous <code>mf</code> (unlikely), it means the acquire behavior is not automatic in <code>cmpxchg.rel</code>.</p>\n\n<p>Shouldn't a relaxed, release-only RMW operation followed by an acquire fence provide at least the guarantees of acq_rel RMW? If so, doesn't that show the proposal is defective?</p>\n"}, {"tags": ["c++", "pointers", "c++17", "volatile", "dereference"], "comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1559170878, "post_id": 56369506, "comment_id": 99341699, "body": "You&#39;&#39;ll get hints from your friendly compiler. Edit: g++ 9 gives hints. Please make it a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1559171558, "post_id": 56369506, "comment_id": 99341825, "body": "It sounds like it might be worth making your own pointer type where dereferencing is actually a &quot;seize&quot; operation. Or it&#39;s possible I&#39;m misunderstanding your needs."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1559171559, "post_id": 56369506, "comment_id": 99341826, "body": "&quot;<i>If I add volatile to foo() I can&#39;t pass the dereferenced</i>&quot; You will not get away from synching."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1559171919, "post_id": 56369506, "comment_id": 99341898, "body": "Sounds like an XY problem.  What are you trying to solve with this?"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1559174930, "post_id": 56369506, "comment_id": 99342540, "body": "Is that a thread question? Can you use <code>std::atomic</code>?"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1559181108, "post_id": 56369506, "comment_id": 99343716, "body": "@NathanOliver I added an example of what I have in mind in the question. Thanks!"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1559181140, "post_id": 56369506, "comment_id": 99343725, "body": "@curiousguy I cannot because this spans more than a single std::atomic&lt;&gt; unfortunately."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1559181336, "post_id": 56369506, "comment_id": 99343756, "body": "The whole Q is meaningless w/o a discussion of the expected memory visibility requirements. What kind of memory is it? Cached, uncached?"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1559181557, "post_id": 56369506, "comment_id": 99343793, "body": "@curiousguy I&#39;m not too familiar with uncached memory, so let&#39;s say it&#39;s cacheable. And is loaded from an external device or something. Also tried to clarify memory visibility in the question."}, {"owner": {"reputation": 4535, "user_id": 59081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c17b54bbea172f608e552f9bf67d4f9?s=128&d=identicon&r=PG", "display_name": "Tanveer Badar", "link": "https://stackoverflow.com/users/59081/tanveer-badar"}, "edited": false, "score": 0, "creation_date": 1559196198, "post_id": 56369506, "comment_id": 99346794, "body": "You should use a special compiler intrinsic or write a driver with a dumb compiler, probably in C. Sounds like C++ is the wrong tool to use here."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 4535, "user_id": 59081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c17b54bbea172f608e552f9bf67d4f9?s=128&d=identicon&r=PG", "display_name": "Tanveer Badar", "link": "https://stackoverflow.com/users/59081/tanveer-badar"}, "edited": false, "score": 0, "creation_date": 1559223496, "post_id": 56369506, "comment_id": 99359070, "body": "@TanveerBadar I don\u2019t know if that makes sense. C++ code uses compiler instrinsics all the time..."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 4535, "user_id": 59081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c17b54bbea172f608e552f9bf67d4f9?s=128&d=identicon&r=PG", "display_name": "Tanveer Badar", "link": "https://stackoverflow.com/users/59081/tanveer-badar"}, "edited": false, "score": 1, "creation_date": 1559236680, "post_id": 56369506, "comment_id": 99365856, "body": "@TanveerBadar C++ is intended to go as low level as C"}], "owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1559182144, "creation_date": 1559170310, "last_edit_date": 1559181520, "question_id": 56369506, "link": "https://stackoverflow.com/questions/56369506/how-to-ensure-a-dereference-happens-only-once", "title": "How to ensure a dereference happens only once", "body": "<p>Is there a way to ensure that a dereference happens only once and the value from the dereference is loaded-from/stored-to only once? For example</p>\n\n<pre><code>class X {\npublic:\n  std::pair&lt;int, int&gt; p;\n};\n\nvoid bar(std::pair&lt;int, int&gt;);\n\nvoid foo(X* pointer) {\n  auto pr = pointer-&gt;p;\n  bar(pr);\n}\n\nint main() {\n  auto&amp;&amp; go = std::atomic&lt;bool&gt;{false};\n  auto&amp;&amp; x = X{};\n  auto&amp;&amp; thread = std::thread{[&amp;]() {\n    while (!go.load(std::memory_order_acquire)) {}\n    foo(&amp;x);\n  }};\n\n  x = create();\n  go.store(true, std::memory_order_release);\n  thread.join();\n}\n</code></pre>\n\n<p>It's valid for the compiler to load from the pointer more than once, is there a way to ensure that the load(s) happens only once? If I add volatile to <code>foo()</code> I can't pass the dereferenced pair to <code>bar()</code> because I would be casting away <code>volatile</code>-ness from <code>p</code>.  </p>\n\n<hr>\n\n<p>An example of where this could be useful is if you have a device that is connected to receive IO from one of the device's ports. Then it's important that you only read from the pointer once. As each read means something to the device. Further if you have other code that does not deal with volatile types, then it would be important to dereference the pointer, and pass a non-volatile object to the external code. </p>\n"}, {"tags": ["c++", "http", "http-headers", "boost-asio"], "comments": [{"owner": {"reputation": 21, "user_id": 4084721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BzLs4_55MZU/AAAAAAAAAAI/AAAAAAAAAYE/2Y82UfDNHmY/photo.jpg?sz=128", "display_name": "Fahim Durrani", "link": "https://stackoverflow.com/users/4084721/fahim-durrani"}, "edited": false, "score": 0, "creation_date": 1559170651, "post_id": 56369505, "comment_id": 99341644, "body": "This isn&#39;t the problem but missed the semi-colon on the line request_stream &lt;&lt; &quot;Content-Length: &quot; &lt;&lt; postfields.length() &lt;&lt; &quot;\\r\\n&quot;; // ."}, {"owner": {"reputation": 3808, "user_id": 2922611, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f26420ac1fcb58b3d0c0f63273eaf3f5?s=128&d=identicon&r=PG&f=1", "display_name": "kenba", "link": "https://stackoverflow.com/users/2922611/kenba"}, "edited": false, "score": 0, "creation_date": 1559199511, "post_id": 56369505, "comment_id": 99348165, "body": "I&#39;ve tagged your question with <code>http</code> and <code>http-headers</code> since it&#39;s really about the content of a <code>http post</code> request."}], "owner": {"reputation": 21, "user_id": 4084721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BzLs4_55MZU/AAAAAAAAAAI/AAAAAAAAAYE/2Y82UfDNHmY/photo.jpg?sz=128", "display_name": "Fahim Durrani", "link": "https://stackoverflow.com/users/4084721/fahim-durrani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586962316, "creation_date": 1559170301, "last_edit_date": 1586962316, "question_id": 56369505, "link": "https://stackoverflow.com/questions/56369505/boost-asio-https-post-request-with-empty-body", "title": "boost asio https post request with empty body", "body": "<p>I'm sending a post request over a tcp socket using the boost asio library. On the server side the request is received but there's no params, what's going on?</p>\n\n<pre><code>boost::asio::streambuf request_;\nstd::string postfields (\"username=user1&amp;password=any\");\nstd::ostream request_stream(&amp;request_);\nrequest_stream &lt;&lt; \"POST \" &lt;&lt; /somepath &lt;&lt; \" HTTP/1.1\\r\\n\";\nrequest_stream &lt;&lt; \"Host: \" &lt;&lt; somehost.com &lt;&lt; \"\\r\\n\";\nrequest_stream &lt;&lt; \"User-Agent: C/1.0\" &lt;&lt; \"\\r\\n\";\nrequest_stream &lt;&lt; \"Content-Type: application/x-www-form-urlencoded \\r\\n\";\nrequest_stream &lt;&lt; \"Accept: application/json\\r\\n\";\nrequest_stream &lt;&lt; \"Content-Length: \" &lt;&lt; postfields.length() &lt;&lt; \"\\r\\n\"\nrequest_stream &lt;&lt; \"Connection: close\\r\\n\\r\\n\";\nrequest_stream &lt;&lt; postfields;\nrequest_stream &lt;&lt; \"\\n\\n\"; // tried with and without this line\n\nboost::asio::async_write(socket_, request_,\n                      boost::bind(&amp;client::handle_write_request, shared_from_this(),\n                              boost::asio::placeholders::error));\n\n</code></pre>\n\n<p>When I print the request it looks like this</p>\n\n<pre><code>POST /somepath HTTP/1.1\nHost: somehost.com\nUser-Agent: C/1.0\nContent-Type: application/x-www-form-urlencoded\nAccept: application/json\nConnection: close\n\nusername=user1&amp;password=any\n</code></pre>\n\n<p>On the serverside the body is empty, there's no params. What could be wrong here?</p>\n\n<p>Please don't mark this as duplicate as I've exhausted all the stackoverflow questions similar to this. Thanks</p>\n"}, {"tags": ["c++", "linux", "multithreading", "boost"], "comments": [{"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1559169830, "post_id": 56369397, "comment_id": 99341429, "body": "First thing to do is figure out where your threads are stuck at.  Are they blocked on some particular line, or are they moving forward but stuck in some sort of endless loop?  You can figure that out using a debugger, or by adding some temporary <code>printf()</code>&#39;s and seeing what does (and does not) get printed.  Once you know <i>where</i> the threads are stuck at, you can start thinking about <i>why</i> they might be stuck there."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1559169896, "post_id": 56369397, "comment_id": 99341454, "body": "It&#39;&#39;lll be easy when you give us a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. This is close but, make it complete please."}, {"owner": {"reputation": 351, "user_id": 2601107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769202f441824a755e63ce2ad8406ac1?s=128&d=identicon&r=PG", "display_name": "michip96", "link": "https://stackoverflow.com/users/2601107/michip96"}, "edited": false, "score": 0, "creation_date": 1559172001, "post_id": 56369397, "comment_id": 99341918, "body": "I updated my question with some additional outputs. Thank you all for the comments!"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559173295, "post_id": 56369397, "comment_id": 99342185, "body": "Still not an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. It&#39;s not a program. Please click on the link provided and read the instructions."}, {"owner": {"reputation": 4394, "user_id": 11218687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q9OQOfewRmE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf6UauF-z1wrWfcYS38osHELYqJMA/mo/photo.jpg?sz=128", "display_name": "Dmitry Kuzminov", "link": "https://stackoverflow.com/users/11218687/dmitry-kuzminov"}, "edited": false, "score": 0, "creation_date": 1559173632, "post_id": 56369397, "comment_id": 99342256, "body": "In the example there is not code that outputs &quot;3 entered while&quot;, etc."}], "answers": [{"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1559172652, "post_id": 56369570, "comment_id": 99342062, "body": "<i>&quot;For example you do not need to lock before retrieving the size of the container if the only thing you need is it&#39;s size&quot;</i> [citation needed] No standard containers are thread-safe. Doesn&#39;t matter what you&#39;re doing with them."}, {"owner": {"reputation": 4394, "user_id": 11218687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q9OQOfewRmE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf6UauF-z1wrWfcYS38osHELYqJMA/mo/photo.jpg?sz=128", "display_name": "Dmitry Kuzminov", "link": "https://stackoverflow.com/users/11218687/dmitry-kuzminov"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559173117, "post_id": 56369570, "comment_id": 99342149, "body": "Ok, I agree that the containers are not thread-safe, but my point was: you get a value that is not true when you start using it. This is a little better than just selecting a random value."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559173232, "post_id": 56369570, "comment_id": 99342173, "body": "I don&#39;t remark on the rest of your answer, but the suggestion that you &quot;don&#39;t need locks&quot; to read the size of a container is completely wrong and quite dangerous. Not only are <code>int</code>s (or <code>std::size_t</code>s, or whatever) not atomic, but you assume implementation details. <i>Code to spec</i>, not to assumptions about implementation."}, {"owner": {"reputation": 351, "user_id": 2601107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769202f441824a755e63ce2ad8406ac1?s=128&d=identicon&r=PG", "display_name": "michip96", "link": "https://stackoverflow.com/users/2601107/michip96"}, "edited": false, "score": 0, "creation_date": 1559173689, "post_id": 56369570, "comment_id": 99342269, "body": "I found the problem. Your answer helped a lot. I was not getting an exception inside a function but I accessed some I/O from two threads simultaneously. This caused some strange behavior."}], "tags": [], "owner": {"reputation": 4394, "user_id": 11218687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q9OQOfewRmE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf6UauF-z1wrWfcYS38osHELYqJMA/mo/photo.jpg?sz=128", "display_name": "Dmitry Kuzminov", "link": "https://stackoverflow.com/users/11218687/dmitry-kuzminov"}, "is_accepted": false, "score": 1, "last_activity_date": 1559174160, "last_edit_date": 1559174160, "creation_date": 1559170803, "answer_id": 56369570, "question_id": 56369397, "link": "https://stackoverflow.com/questions/56369397/threads-not-terminating-on-linux-but-on-mac/56369570#56369570", "title": "Threads not terminating on Linux but on Mac", "body": "<p>One thing that I don't like in your code is that you misuse locks. For example when you retrieve the size of the container you cannot be sure that the size you've just retrieved is correct right after you unlock the mutex. So the correct pattern could be to lock the block of code where you retrieve the size and work with the container in the assumption that this size is correct -- and unlock it when you don't need this container anymore.</p>\n\n<p>So you should rework the code because there could be race conditions in many places. One possible answer to your question, look at the code below:</p>\n\n<pre><code>    mutex.lock();\n    individual male = *utilities::container::select_randomly(parents.begin(), selectable_parents_end);\n    bool generate_child = utilities::container::bool_with_prob(0.3);\n    mutex.unlock();\n</code></pre>\n\n<p>What is an exception is thrown in the <code>select_randomly</code>? You would never unlock the mutex and this is a deadlock condition. Why could it throw an exception? For example because the value <code>selectable_parents_end</code> have become obsolete due to the race condition.</p>\n"}], "owner": {"reputation": 351, "user_id": 2601107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769202f441824a755e63ce2ad8406ac1?s=128&d=identicon&r=PG", "display_name": "michip96", "link": "https://stackoverflow.com/users/2601107/michip96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559174160, "creation_date": 1559169370, "last_edit_date": 1559171973, "question_id": 56369397, "link": "https://stackoverflow.com/questions/56369397/threads-not-terminating-on-linux-but-on-mac", "title": "Threads not terminating on Linux but on Mac", "body": "<p>I'm currently working on a genetic algorithm where a new population is computed with different independent threads. My program works fine on OSX but some threads do not terminate on a Linux machine. </p>\n\n<p>I have the following method which each thread performs until I have enough individuals generated. I'm using a single mutex which is part of the population class (as this method is). Therefore the mutex object is not static. The method gets passed a set of <code>parents</code> of which it may select one on the first <code>parents_max</code>'s parents to generate a new child. A child is generated by mutation or recombination which another parent object. Inside <code>select_randomly</code> and <code>bool_with_prob</code> I use several distributions from <code>&lt;random&gt;</code> (all local variables) to pick a random parent or provide me with a random bool.</p>\n\n<p>I searched the internet for reasons why the threads won't terminate and added serveral (possibly unecessary) locks around method which use <code>std::random_device</code> or <code>std::mt19937</code> objects.</p>\n\n<pre><code>void generate_childs(std::set&lt;individual&gt; &amp;parents, double mutation_rate, size_t parents_max)\n{\n\nsize_t individuals_size;\n\n{\n    boost::lock_guard&lt;boost::mutex&gt; lock(mutex);\n    individuals_size = individuals.size();\n}\n\nauto selectable_parents_end = parents.begin();\nstd::advance(selectable_parents_end, parents_max);\n\nwhile(individuals_size &lt; size)\n{\n    mutex.lock();\n    individual male = *utilities::container::select_randomly(parents.begin(), selectable_parents_end);\n    bool generate_child = utilities::container::bool_with_prob(0.3);\n    mutex.unlock();\n\n    boost::optional&lt;individual&gt; ind;\n\n    if(generate_child)\n    {\n        mutex.lock();\n        individual female = *utilities::container::select_randomly(parents.begin(), parents.end());\n        mutex.unlock();\n\n        ind = mutation::combined_mutated_child(male, female, mutation_rate);\n    } else\n    {\n        ind = mutation::mutated_child(male, 0.9);\n    }\n\n    if(ind &amp;&amp; ind-&gt;is_valid())\n    {\n        boost::lock_guard&lt;boost::mutex&gt; lock(mutex);\n\n        if (individuals.size() &lt; size) {\n            individuals.insert(*ind);\n        }\n\n    }\n\n    {\n        boost::lock_guard&lt;boost::mutex&gt; lock(mutex);\n        individuals_size = individuals.size();\n    }\n}\n}\n</code></pre>\n\n<p>I'm starting the threads like this:</p>\n\n<pre><code>unsigned int number_of_threads = std::thread::hardware_concurrency();\n\nauto parents = individuals;\n\nstd::vector&lt;boost::thread&gt; threads;\n\nfor(size_t i = 0; i&lt;number_of_threads; i++)\n{\n    threads.emplace_back(&amp;population::generate_childs,\n                         this,\n                         std::ref(parents),\n                         mutation_rate,\n                         parents_max);\n}\n\nfor(auto &amp;t: threads)\n{\n    t.join();\n    std::cout &lt;&lt; \"Thread finished\" &lt;&lt; individuals.size()  &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>When executing my program on the local (OSX) machine compiled with Clang it performs as expected. On my Linux machine, it does not finish. I even tried to set <code>number_of_threads=1</code>, which did not help. When the program is not terminating on my Linux machine I can not quit it with <code>Ctrl+C</code>. Any ideas where I might have a race condition or a deadlock?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>As suggested I printed out an comment with the thread id for each thread. Apparently, my usage of the lock when updating the size was inappropriate. Therefore I modified the last lock as follows:</p>\n\n<pre><code>std::cout &lt;&lt; i &lt;&lt; \" updating size\" &lt;&lt; std::endl;\n\n{\n    std::cout &lt;&lt; i &lt;&lt; \" updating size about to lock\" &lt;&lt; std::endl;\n    boost::lock_guard&lt;boost::mutex&gt; lock(configuration::mutex);\n\n    std::cout &lt;&lt; i &lt;&lt; \" updating size about to locked\" &lt;&lt; std::endl;\n\n    individuals_size = individuals.size();\n\n    if(individuals_size &gt;= size)\n    {\n        std::cout &lt;&lt; i &lt;&lt; \" returning\" &lt;&lt; std::endl;\n        return;\n    }\n}\n</code></pre>\n\n<p>The output of my program is this (skipped the part where threads worked fine):</p>\n\n<pre><code>0 started\n2 started\n3 started\n3 entered while\n0 entered while\n1 started\n2 entered while\n1 entered while\n3 got male 1\n0 got male 0\n3 got female\n2 got male 1\n1 got male 1\n2 got female\n1 got female\n0 got mutated\n0 before is valid\n0 inserting\n0 inserted\n0 updating size\n0 updating size about to lock\n0 updating size about to locked\n0 returning\nThread finished10\n2 got combined\n2 before is valid\n2 inserting\n2 inserted\n2 updating size\n2 updating size about to lock\n2 updating size about to locked\n2 returning\n</code></pre>\n\n<p>After this, I don't get any additional outputs. For me, it seems like the lock guard does not free the mutex. Is it the order in which I join the threads? Because I try to join thread 1 before 2 even though it is not finished yet?</p>\n"}, {"tags": ["c++", "amazon-web-services", "amazon-s3"], "comments": [{"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1559170173, "post_id": 56369268, "comment_id": 99341524, "body": "Try and determine if it&#39;s a problem with your C++ code by running the equivalent ranged get using the awscli (aws s3api get-object --range=&quot;bytes=1-20&quot; ...). I would run both this and your code against the first 20 bytes of a known text file for testing."}, {"owner": {"reputation": 21, "user_id": 11575269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df938f5cb23509056e98f995003f483?s=128&d=identicon&r=PG&f=1", "display_name": "TerryW", "link": "https://stackoverflow.com/users/11575269/terryw"}, "reply_to_user": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1559234581, "post_id": 56369268, "comment_id": 99364978, "body": "Thanks, I really should have done that before I posted.  I used the aws cli and it did indeed download the requested range."}, {"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1559238858, "post_id": 56369268, "comment_id": 99366792, "body": "I think you need to stream from the read buffer into a string or byte array. For example (if it&#39;s a text file): Aws::StringStream ss; ss &lt;&lt; xyz.rdbuf(), then look at ss.str().c_str()."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11575269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df938f5cb23509056e98f995003f483?s=128&d=identicon&r=PG&f=1", "display_name": "TerryW", "link": "https://stackoverflow.com/users/11575269/terryw"}, "edited": false, "score": 0, "creation_date": 1559252231, "post_id": 56369523, "comment_id": 99371909, "body": "You are correct, thanks.  Your response sent me on a different search and to a working result.  Much appreciated.  I needed the output in a buffer I controlled so I did the following:  streambuf* body = results.GetResult().GetBody().rdbuf();  body-&gt;sgetn(buffer,rbytes);"}], "tags": [], "owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "is_accepted": false, "score": 1, "last_activity_date": 1559170419, "creation_date": 1559170419, "answer_id": 56369523, "question_id": 56369268, "link": "https://stackoverflow.com/questions/56369268/s3clientgetobject-with-setrange-returns-wrong-data/56369523#56369523", "title": "S3Client::GetObject with SetRange returns wrong data?", "body": "<p><code>rdbuf()</code> is a stream and you are treating it as a memory pointer.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 11575269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df938f5cb23509056e98f995003f483?s=128&d=identicon&r=PG&f=1", "display_name": "TerryW", "link": "https://stackoverflow.com/users/11575269/terryw"}, "is_accepted": false, "score": 1, "last_activity_date": 1559252756, "creation_date": 1559252756, "answer_id": 56386027, "question_id": 56369268, "link": "https://stackoverflow.com/questions/56369268/s3clientgetobject-with-setrange-returns-wrong-data/56386027#56386027", "title": "S3Client::GetObject with SetRange returns wrong data?", "body": "<p>Here's my final code for anyone who's interested.  I would also appreciate any comments you see fit to make.</p>\n\n<pre><code>#include &lt;streambuf&gt;\n#include &lt;aws/core/Aws.h&gt;\n#include &lt;aws/s3/S3Client.h&gt;\n#include &lt;aws/s3/model/GetObjectRequest.h&gt;\n#include &lt;aws/s3/model/HeadObjectRequest.h&gt;\n#include &lt;aws/s3/model/HeadObjectResult.h&gt;\n#include &lt;aws/s3/model/Object.h&gt;\n\nlong scanObject(Aws::String region,\n                Aws::String bucket_name,\n                Aws::String object_name);\n\n\nint main(int argc, char** argv)\n{\n   long scanned=0;\n\n   if (argc &lt; 4){ return(1); }\n   Aws::String region = argv[1];\n   Aws::String bucket_name = argv[2];\n   Aws::String object_name = argv[3];\n\n   Aws::SDKOptions options;\n   Aws::InitAPI(options);\n\n   scanned = scanObject(region,bucket_name,object_name);\n   printf(\"Scanned %d bytes of object\\n\",scanned);\n\n   Aws::ShutdownAPI(options);\n\n   return(0);\n}\n\nlong scanObject(Aws::String region,\n                Aws::String bucket_name,\n                Aws::String object_name)\n{\n   int   rbytes, nbytes;\n   char range[48], *buffer;\n   long filesize, bytesleft, start;\n\n   Aws::Client::ClientConfiguration cconfig;\n   cconfig.region = region;\n   Aws::S3::S3Client s3_client(cconfig);\n\n   Aws::S3::Model::HeadObjectRequest head_object_request;\n   head_object_request.WithBucket(bucket_name).WithKey(object_name);\n   Aws::S3::Model::HeadObjectOutcome head_object;\n   head_object = s3_client.HeadObject(head_object_request);\n   if (!head_object.IsSuccess())\n   {\n      printf(\"AWS Object, /%s/%s, failed to locate\\n\",\n             region.c_str(),object_name.c_str());\n      return(-1);\n   }\n\n   filesize = head_object.GetResult().GetContentLength();\n   bytesleft = filesize;\n\n   start = 0;\n   nbytes = 1048576;\n   buffer = (char*)malloc(nbytes*2);\n\n   Aws::S3::Model::GetObjectRequest read_request;\n   while(bytesleft &gt; 0)\n   {\n      if (bytesleft &gt; 1048576){ nbytes = 1048576; }else{ nbytes = bytesleft; }\n\n      sprintf(range,\"bytes=%d-%d\",start,start+nbytes-1);\n\n      read_request.SetBucket(bucket_name);\n      read_request.SetKey(object_name);\n      read_request.SetRange(range);\n\n      auto results = s3_client.GetObject(read_request);\n\n      if (!results.IsSuccess())\n      {\n         printf(\"\\nUnable to fetch object range %s from s3 bucket.\\n\",range);\n         return(-1);\n      }\n      rbytes = results.GetResult().GetContentLength();\n\n      std::streambuf* body = results.GetResult().GetBody().rdbuf();\n      body-&gt;sgetn(buffer,rbytes);\n\n      start += rbytes;\n      bytesleft -= rbytes;\n   }\n\n   return(filesize);\n}\n</code></pre>\n\n<p>I'm sure this could be done in a more efficient manner and hopefully I will learn that as I go along.</p>\n"}], "owner": {"reputation": 21, "user_id": 11575269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df938f5cb23509056e98f995003f483?s=128&d=identicon&r=PG&f=1", "display_name": "TerryW", "link": "https://stackoverflow.com/users/11575269/terryw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1559252756, "creation_date": 1559168334, "question_id": 56369268, "link": "https://stackoverflow.com/questions/56369268/s3clientgetobject-with-setrange-returns-wrong-data", "title": "S3Client::GetObject with SetRange returns wrong data?", "body": "<p>I am attempting to read a segment of a large AWS S3 Object starting with the first 1048576 bytes.  I specify the range of bytes that I want to read but I do not receive those bytes.  The length returned is correct.</p>\n\n<p>I am fairly new at this so I'm probably doing something wrong and being a C programmer instead of C++ has not helped a lot.</p>\n\n<p>Here's a sample of my code:</p>\n\n<pre><code>int   start=0, rbytes=0;\n\nAws::S3::S3Client  s3_client;\nAws::S3::Model::GetObjectRequest read_object_request;\nsprintf(range,\"bytes=%lld-%lld\",start,start+1048575);\n\nread_object_request.SetBucket(container_name);\nread_object_request.SetKey(object_name);\nread_object_request.SetRange(range);\nauto results = s3_client.GetObject(read_object_request);\nif (results.IsSuccess())\n{\n   rbytes = results.GetResult().GetContentLength();\n   std::cout &lt;&lt; rbytes &lt;&lt; \" bytes read\" &lt;&lt; std::endl;\n}\nmemcpy(bdata,results.GetResult().GetBody().rdbuf(),rbytes);\n</code></pre>\n\n<p>I then dump the bdata buffer and it is not what I expected.  When I repeat the execution of the code, a new instance, it returns different data.</p>\n\n<p>Though I don't show it the   bdata  buffer is pre-allocated 2 megabytes.</p>\n\n<p>Any ideas that would point me in the right direction would be appreciated.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c++", "c++17", "move", "move-semantics", "stdany"], "comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1559180196, "post_id": 56369214, "comment_id": 99343555, "body": "Note that you don&#39;t need to do <code>move(vptr{})</code>, <code>vptr{}</code> is already an rvalue."}], "answers": [{"tags": [], "owner": {"reputation": 542, "user_id": 10865566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b1030e5af9ef662afc6d7a806d0182?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/10865566/david"}, "is_accepted": true, "score": 5, "last_activity_date": 1559180173, "last_edit_date": 1559180173, "creation_date": 1559173851, "answer_id": 56369931, "question_id": 56369214, "link": "https://stackoverflow.com/questions/56369214/cannot-move-stdany/56369931#56369931", "title": "Cannot move std::any", "body": "<p>The problem is not moving std::any, it's that std::any itself does not support move-only types (std::unique_ptr for example)</p>\n\n<p>as per <a href=\"https://en.cppreference.com/w/cpp/utility/any/any\" rel=\"nofollow noreferrer\">cppreference</a> </p>\n\n<pre><code>template&lt; class ValueType &gt;\nany( ValueType&amp;&amp; value );\n</code></pre>\n\n<blockquote>\n  <p>Constructs an object with initial content an object of type <code>std::decay_t&lt; ValueType&gt;</code>, direct-initialized from <code>std::forward&lt; ValueType&gt;(value)</code>. <strong>If <code>std::is_copy_constructible&lt; std::decay_t&lt; ValueType&gt;&gt;::value</code> is <code>false</code>, the program is ill-formed</strong></p>\n</blockquote>\n\n<p>You can check that is_copy_constructible ... is false with a static_assert, see on <a href=\"http://coliru.stacked-crooked.com/a/7e25e04b47ea1d15\" rel=\"nofollow noreferrer\">coliru</a></p>\n\n<p>Easiest workaround I can think of is to use shared_ptr instead and still call the std::move.</p>\n"}], "owner": {"reputation": 509, "user_id": 3134946, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/198952b24b7de8ec7329d3a3f46d7bc0?s=128&d=identicon&r=PG&f=1", "display_name": "Ryba", "link": "https://stackoverflow.com/users/3134946/ryba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 56369931, "answer_count": 1, "score": 0, "last_activity_date": 1559186246, "creation_date": 1559167975, "last_edit_date": 1559186246, "question_id": 56369214, "link": "https://stackoverflow.com/questions/56369214/cannot-move-stdany", "title": "Cannot move std::any", "body": "<p>The following code</p>\n\n<pre><code>using vptr = std::vector&lt;std::unique_ptr&lt;int&gt;&gt;;\nauto m = std::unordered_map&lt;int, std::any&gt;{};\nm.try_emplace(0, move(vptr{}));\n</code></pre>\n\n<p>Fails to compile, complaining about using of deleted copy constructor of <code>unique_ptr</code>. After replacing <code>std::any</code> with <code>vptr</code> in template argument this code compiles, so the issue is clearly with <code>any</code></p>\n\n<p>How can I force <code>std::any</code> to be moved instead of copied? </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1559168007, "post_id": 56369138, "comment_id": 99340973, "body": "The right way is to move it. The right way to move it is to set <code>fd</code> in the moved-from object to an &quot;dummy/empty/invalid&quot; value, so that the destructor doesn&#39;t do anything, um, destructive."}, {"owner": {"reputation": 1172, "user_id": 2494177, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4a3a27398754da4ed4dbd070bafc223b?s=128&d=identicon&r=PG", "display_name": "gpanders", "link": "https://stackoverflow.com/users/2494177/gpanders"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1559168054, "post_id": 56369138, "comment_id": 99340980, "body": "@n.m. How do I move it into the vector? As far as I can tell using <code>push_back(std::move(foo))</code> doesn&#39;t call either the move constructor or the move assignment operator (I&#39;ve tried both)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1559168367, "post_id": 56369138, "comment_id": 99341069, "body": "<code>ide(std::move(foo))</code> should call the move constructor. Your class should have a non-default one for this to work. <a href=\"https://ideone.com/Du6vV3\" rel=\"nofollow noreferrer\">And it works</a>. Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": false, "score": 1, "last_activity_date": 1559168158, "creation_date": 1559168158, "answer_id": 56369241, "question_id": 56369138, "link": "https://stackoverflow.com/questions/56369138/moving-an-object-with-a-file-descriptor/56369241#56369241", "title": "Moving an object with a file descriptor", "body": "<p>n.m beat me to the punch, but you need to define a move constructor that 'forgets' about your file descriptor in the moved-from object.  Something like:</p>\n\n<pre><code>Foo (Foo &amp;&amp;move_from)\n{\n    valid = move_from.valid;\n    fd = move_from.fd;\n    move_from.valid = false;\n}\n</code></pre>\n\n<p>Also, delete your copy constructor and copy assignment operator and implement a move-assignment operator.  You then have an object that can be moved but not copied, rather like <code>std::unique_ptr</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559169050, "post_id": 56369245, "comment_id": 99341245, "body": "In <code>Foo(const Foo&amp;&amp; other)</code> and <code>Foo&amp; operator=(const Foo&amp;&amp; other)</code>, you need to drop the <code>const</code>. Move semantics require non-const objects so members can be updated after being moved."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559169098, "post_id": 56369245, "comment_id": 99341254, "body": "@RemyLebeau True"}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559169358, "post_id": 56369245, "comment_id": 99341313, "body": "@RemyLebeau I assumed that <code>valid</code> field is used for this purpose, but your answer covers it better ;)"}], "tags": [], "owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "is_accepted": false, "score": 1, "last_activity_date": 1559169109, "last_edit_date": 1559169109, "creation_date": 1559168173, "answer_id": 56369245, "question_id": 56369138, "link": "https://stackoverflow.com/questions/56369138/moving-an-object-with-a-file-descriptor/56369245#56369245", "title": "Moving an object with a file descriptor", "body": "<p>You probably want to delete copy constructors altogether (or provide some logic to have two valid instances with different descriptors). If you delete them, compiler will make sure you use move semantics always. </p>\n\n<p>Then, you can declare move constructors, that will perform valid moving:</p>\n\n<pre><code>class Foo {\npublic:\n  Foo(int i) {\n    valid = false;\n    char devname[] = \"/dev/device0\";\n    sprintf(devname, \"/dev/device%d\", i);\n    fd = open(devname, O_RDWR);\n    if (fd &gt; 0) {\n      valid = true;\n    }\n\n  ~Foo() {\n    if (valid) {\n      close(fd);\n    }\n  }\n\n  Foo(const Foo&amp;) = delete;\n  Foo&amp; operator=(const Foo&amp;) = delete;\n  Foo(Foo&amp;&amp; other) {\n    valid = other.valid;\n    fd = other.fd;\n    other.valid = false;\n  };\n  Foo&amp; operator=(Foo&amp;&amp; other) {\n    valid = other.valid;\n    fd = other.fd;\n    other.valid = false;\n  };\n\n  bool valid;\nprivate:\n  int fd;\n};\n</code></pre>\n\n<p>A bit of explanation:</p>\n\n<p>You violated the <a href=\"https://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">Rule of Three/Five/Zero</a>. In short, it says \"whenever your class needs a user defined destructor/copy constructor/move constructor, it will most likely the rest of them\". Your class does require a destructor, which you provided, but you didn't provide neither copy or move operators, which is a mistake. You have to provide both copy constructor/copy assignment operator (here deleted) and move constructor/move assignment operator.</p>\n\n<p>As to why: compiler is not smart enough to guess what do you need. Ignoring the fact that your class doesn't support move semantics (user-defined destructor prevents implicit creation of move constructors), implicit move constructor is very, very simple. It just calls <code>std::move</code> on every class member. And <code>std::move</code> for primitive types is also very simple - it just copies that variable, as it's the fastest operation.<br>\nIt <em>could</em> possibly zero the other variable, but that's not necessary. As per definition, the variable must be left in \"<em>unknown, but valid state</em>\". No change to that variable fits this definition.</p>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 3, "last_activity_date": 1559169291, "last_edit_date": 1559169291, "creation_date": 1559168557, "answer_id": 56369298, "question_id": 56369138, "link": "https://stackoverflow.com/questions/56369138/moving-an-object-with-a-file-descriptor/56369298#56369298", "title": "Moving an object with a file descriptor", "body": "<p><code>Foo</code> needs a copy constructor and copy assignment operator so it can <code>dup()</code> the <code>fd</code> of the copied-from object (or, you need to <code>delete</code> them so <code>Foo</code> objects can't be copied at all, only moved).</p>\n\n<p>When implementing move semantics, after moving the <code>fd</code> value from the moved-from object to the moved-to object, you need to update the moved-from object so its <code>fd</code> no longer refers to a valid file descriptor.  Simply set it to -1, which is what <code>open()</code> and <code>dup()</code> return on error.</p>\n\n<p>You don't need your <code>valid</code> member at all.  That is a source of error waiting to happen if it ever gets out of sync with your <code>fd</code>.</p>\n\n<p>Try something more like this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class Foo {\npublic:\n  Foo(int i) {\n    std::string devname = \"/dev/device\" + std::to_string(i);\n    fd = open(devname.c_str(), O_RDWR);\n  }\n\n  Foo(const Foo &amp;src) {\n    fd = dup(src.fd);\n  }\n  // or: Foo(const Foo &amp;) = delete;\n\n  Foo(Foo &amp;&amp;src) : fd(-1) {\n    src.swap(*this);\n  }\n\n  ~Foo() {\n    if (fd != -1) {\n      close(fd);\n    }\n  }\n\n  bool valid() const {\n    return (fd != -1); \n  }\n\n  Foo&amp; operator=(Foo rhs) {\n    rhs.swap(*this);\n    return *this;\n  }\n  // optional: Foo&amp; operator=(const Foo &amp;) = delete;\n\n  void swap(Foo &amp;other) {\n    std::swap(fd, other.fd);\n  }\n\nprivate:\n  int fd;\n};\n</code></pre>\n"}], "owner": {"reputation": 1172, "user_id": 2494177, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4a3a27398754da4ed4dbd070bafc223b?s=128&d=identicon&r=PG", "display_name": "gpanders", "link": "https://stackoverflow.com/users/2494177/gpanders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 56369298, "answer_count": 3, "score": 5, "last_activity_date": 1559169291, "creation_date": 1559167490, "question_id": 56369138, "link": "https://stackoverflow.com/questions/56369138/moving-an-object-with-a-file-descriptor", "title": "Moving an object with a file descriptor", "body": "<p>I have a class, say <code>Foo</code>, defined like this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class Foo {\npublic:\n  Foo(int i) {\n    valid = false;\n    char devname[] = \"/dev/device0\";\n    sprintf(devname, \"/dev/device%d\", i);\n    fd = open(devname, O_RDWR);\n    if (fd &gt; 0) {\n      valid = true;\n    }\n\n  ~Foo() {\n    if (valid) {\n      close(fd);\n    }\n  }\n\n  bool valid;\nprivate:\n  int fd;\n};\n</code></pre>\n\n<p>I have another class, say <code>Bar</code>, defined like this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class Bar {\npublic:\n  Bar() {\n    for (int i = 0; i &lt; 4; i++) {\n      Foo foo(i);\n      if (foo.valid) {\n        vector_of_foos.push_back(foo);\n      }\n    }\n  }\n\n  std::vector&lt;Foo&gt; vector_of_foos;\n};\n</code></pre>\n\n<p>The problem with this is that <code>push_back</code> makes a copy of the Foo object, which copies the <code>fd</code> property. Then the destructor for the original <code>Foo</code> object is called, which closes the file that <code>fd</code> points to, rendering <code>fd</code> invalid.</p>\n\n<p>Unfortunately I cannot use <code>emplace_back</code> since I need to instantiate my <code>Foo</code> object <em>before</em> adding it to the <code>vector_of_foos</code> vector so that I can check the <code>valid</code> property.</p>\n\n<p>I have also tried using <code>std::move</code> but this still calls the destructor for the original <code>Foo</code> object once it goes out of scope which closes the file.</p>\n\n<p>What is the recommended way of managing a resource like this? Should I use an array of smart pointers? Should my <code>vector_of_foos</code> be instead a <code>std::vector&lt;Foo *&gt;</code> where I maintain a vector of pointers to <code>Foo</code> which I allocate dynamically?</p>\n"}, {"tags": ["c++", "boolean", "undefined-behavior", "evaluation", "abi"], "comments": [{"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 66, "creation_date": 1559167572, "post_id": 56369080, "comment_id": 99340858, "body": "With undefined behavior, anything is possible :)"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 7, "creation_date": 1559214166, "post_id": 56369080, "comment_id": 99354609, "body": "not quite a duplicate of <a href=\"//stackoverflow.com/q/54120862\">Does the C++ standard allow for an uninitialized bool to crash a program?</a> where my answer explains that the x86-64 System V ABI specifies that <code>bool</code> is a 0 or 1, and thus the compiler is allowed to assume this when emitting code."}, {"owner": {"reputation": 30517, "user_id": 774499, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sju2a.jpg?s=128&g=1", "display_name": "David Hammen", "link": "https://stackoverflow.com/users/774499/david-hammen"}, "edited": false, "score": 10, "creation_date": 1559217948, "post_id": 56369080, "comment_id": 99356304, "body": "There&#39;s a tension between the mathematics of booleans and their computer science representations. Mathematically, booleans have two values, so a single bit. The problem is that in c++, bools have to be addressable, but individual bits are not addressable. The standard requires implementations to make all boolean operations result in a zero or a one. Anything else is a noncompliant implementation. The standard also requires programmers to follow this rule. In particular, intentionally setting bits so that a bool has a value this is neither zero nor one is undefined behavior."}, {"owner": {"reputation": 2865, "user_id": 264047, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/579c47066a9e277550d87cd4a53ca8e8?s=128&d=identicon&r=PG", "display_name": "Alexander Malakhov", "link": "https://stackoverflow.com/users/264047/alexander-malakhov"}, "edited": false, "score": 4, "creation_date": 1559233843, "post_id": 56369080, "comment_id": 99364641, "body": "Here is <a href=\"https://godbolt.org/z/ghzs8X\" rel=\"nofollow noreferrer\">minimal example</a>. GCC up to 8.3 behaves the same as in the post. With 9.1 it&#39;s different, but still is surprising. (C++ is fun!)"}, {"owner": {"reputation": 413, "user_id": 11575253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84223c303d332e0eb70545a76ed126?s=128&d=identicon&r=PG&f=1", "display_name": "BY408", "link": "https://stackoverflow.com/users/11575253/by408"}, "edited": false, "score": 1, "creation_date": 1559243008, "post_id": 56369080, "comment_id": 99368504, "body": "TAKE AWAY: Don&#39;t use bool/logical types if using multiple languages in a program. Each language has their own standard about bits of bool. Use int or other types that have same definition in all languages (if that is even possible)"}, {"owner": {"reputation": 301322, "user_id": 26428, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S1BbQ.png?s=128&g=1", "display_name": "Dennis Williamson", "link": "https://stackoverflow.com/users/26428/dennis-williamson"}, "edited": false, "score": 3, "creation_date": 1559254830, "post_id": 56369080, "comment_id": 99372709, "body": "&quot;Doctor, it hurts when I do this.&quot;"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 301322, "user_id": 26428, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S1BbQ.png?s=128&g=1", "display_name": "Dennis Williamson", "link": "https://stackoverflow.com/users/26428/dennis-williamson"}, "edited": false, "score": 1, "creation_date": 1559576400, "post_id": 56369080, "comment_id": 99455552, "body": "@DennisWilliamson If &quot;this&quot; is &quot;walking&quot;, it&#39;s reasonable to want an explanation rather than a &quot;don&#39;t walk then&quot; response from your doctor."}], "answers": [{"comments": [{"owner": {"reputation": 413, "user_id": 11575253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84223c303d332e0eb70545a76ed126?s=128&d=identicon&r=PG&f=1", "display_name": "BY408", "link": "https://stackoverflow.com/users/11575253/by408"}, "edited": false, "score": 0, "creation_date": 1559238621, "post_id": 56369368, "comment_id": 99366674, "body": "Thanks for detailed explanation. I think C++ standard definition is very dangerous and leaves a lot of room for error when used with other languages. Fortran defines bool to be true if any bit is 1 and false if all are zero. If bool has 8 bits standard needs to clearly define what happens when other bits are set. You cannot assume that people will never touch other bits. People develop software with many languages combined and you need to safely cover these cases. Undefined behavior because some bits are set to one is simply not an acceptable standard in my view. I call this stupid standard."}, {"owner": {"reputation": 413, "user_id": 11575253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84223c303d332e0eb70545a76ed126?s=128&d=identicon&r=PG&f=1", "display_name": "BY408", "link": "https://stackoverflow.com/users/11575253/by408"}, "edited": false, "score": 0, "creation_date": 1559238685, "post_id": 56369368, "comment_id": 99366705, "body": "If you will use this standard then require bool to be 1 bit not 8 bits"}, {"owner": {"reputation": 413, "user_id": 11575253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84223c303d332e0eb70545a76ed126?s=128&d=identicon&r=PG&f=1", "display_name": "BY408", "link": "https://stackoverflow.com/users/11575253/by408"}, "edited": false, "score": 1, "creation_date": 1559238802, "post_id": 56369368, "comment_id": 99366768, "body": "This is like having an 8 lanes highway, all lanes are open, but if you use any lane other than the first you will have a guaranteed accident."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "reply_to_user": {"reputation": 413, "user_id": 11575253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84223c303d332e0eb70545a76ed126?s=128&d=identicon&r=PG&f=1", "display_name": "BY408", "link": "https://stackoverflow.com/users/11575253/by408"}, "edited": false, "score": 9, "creation_date": 1559238833, "post_id": 56369368, "comment_id": 99366780, "body": "<code>bool</code> effectively <i>is</i> one bit, it&#39;s just not implemented that way under the hood. How many bits are used to represent is an implementation detail (part of the ABI), not one that is defined by the language. I do not understand why this is a problem in the real world, although it does make for a great Stack Overflow Q&amp;A. I do lots of interop between C++ and code in other languages, and I&#39;ve never had a problem. @BY408"}, {"owner": {"reputation": 413, "user_id": 11575253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84223c303d332e0eb70545a76ed126?s=128&d=identicon&r=PG&f=1", "display_name": "BY408", "link": "https://stackoverflow.com/users/11575253/by408"}, "edited": false, "score": 1, "creation_date": 1559238994, "post_id": 56369368, "comment_id": 99366854, "body": "Try using gcc with intel fortran compiler. Have a fortran function that returns a logical*1 type variable that is a 8 bit bool and assign it to a C++ bool and see what happens :)"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "reply_to_user": {"reputation": 413, "user_id": 11575253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84223c303d332e0eb70545a76ed126?s=128&d=identicon&r=PG&f=1", "display_name": "BY408", "link": "https://stackoverflow.com/users/11575253/by408"}, "edited": false, "score": 0, "creation_date": 1559259418, "post_id": 56369368, "comment_id": 99373718, "body": "I&#39;m not a Fortran expert by any stretch of the imagination, but I don&#39;t see why that would be a problem. As far as I can tell, a <code>LOGICAL*1</code> type variable has compatible semantics with a C++ bool: non-zero values are &quot;true&quot;, while zero values are &quot;false&quot;. I <i>believe</i> that Fortran actually represents &quot;true&quot; by setting all bits, whereas a C++ implementation will typically only bother to set the lowest-order bit, but that doesn&#39;t matter, as long as &quot;false&quot; is defined as &quot;all bits zero&quot;. Alternatively, there are ways to make Intel Fortran fully compliant with C; see <code>logical(c_bool)</code>. @BY408"}, {"owner": {"reputation": 413, "user_id": 11575253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84223c303d332e0eb70545a76ed126?s=128&d=identicon&r=PG&f=1", "display_name": "BY408", "link": "https://stackoverflow.com/users/11575253/by408"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 1, "creation_date": 1559262449, "post_id": 56369368, "comment_id": 99374281, "body": "@Cody Gray , A fortran logical*1 has same representation as bool, but in fortran if bits are 00000011 it is true, in C++ it is undefined. That is the problem. You cannot have fortran return a logical*1, and assign that to a C++ bool. C++ bool becomes undefined, see my code above. (I am manipulating bits to mimic what fortran does and how C++ treats it)"}, {"owner": {"reputation": 2105, "user_id": 8718773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34213fbac0a5b09b9ff8abe458e6b87a?s=128&d=identicon&r=PG&f=1", "display_name": "Giacomo Alzetta", "link": "https://stackoverflow.com/users/8718773/giacomo-alzetta"}, "reply_to_user": {"reputation": 413, "user_id": 11575253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84223c303d332e0eb70545a76ed126?s=128&d=identicon&r=PG&f=1", "display_name": "BY408", "link": "https://stackoverflow.com/users/11575253/by408"}, "edited": false, "score": 7, "creation_date": 1559285812, "post_id": 56369368, "comment_id": 99379258, "body": "@BY408 IT looks like you don&#39;t know how to properly interop between fortran and C++. Don&#39;t blame your ignorance on the C++ standard. Standards exists <i>precisely</i> because without them any implementation could do anything they wont and interoperability would be impossible."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1559287556, "post_id": 56369368, "comment_id": 99380047, "body": "BTW this kind of interoperability isn&#39;t any of the C++ or Fortran standard business, but of the platform ABI. In case of x86-64 Linux, it&#39;s <a href=\"https://www.uclibc.org/docs/psABI-x86_64.pdf\" rel=\"nofollow noreferrer\">uclibc.org/docs/psABI-x86_64.pdf</a>; it specifies that plain <code>LOGICAL</code> is mapped to <code>signed int</code> (so, it&#39;s 4 byte, like Win32 <code>BOOL</code>), while there&#39;s no explicit mapping for <code>LOGICAL*1</code>. From the fact that &quot;The &quot;<code>TYPE*N</code>&quot; notation specifies that variables or aggregate members of type <code>TYPE</code> shall occupy <code>N</code> bytes of storage&quot;, it should follow that the type to be mapped should probably be <code>signed char</code>."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1559287621, "post_id": 56369368, "comment_id": 99380093, "body": "Besides, it also says that <code>LOGICAL</code> should have only 1 and 0 as possible values, which makes me wonder how you obtained the broken data even on the Fortran side: from what I gather, <code>LOGICAL</code> should work similarly to C++ <code>bool</code>: the actual content is always 0 or 1, it&#39;s <i>on assignment</i> that nonzero integer values are forced to become 1. But again, this is just what I seem to gather from a quick read of the spec, so I may be wrong."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1559287978, "post_id": 56369368, "comment_id": 99380252, "body": "This seems hinted by <a href=\"https://groups.google.com/forum/#!topic/gg95/yQqAlfzIBDU\" rel=\"nofollow noreferrer\">the last message of this post</a>: even in Fortran you are not expected to mess with <code>LOGICAL</code> bits setting them to any value you like."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 413, "user_id": 11575253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84223c303d332e0eb70545a76ed126?s=128&d=identicon&r=PG&f=1", "display_name": "BY408", "link": "https://stackoverflow.com/users/11575253/by408"}, "edited": false, "score": 1, "creation_date": 1559308042, "post_id": 56369368, "comment_id": 99389867, "body": "@BY408: starting from this, I expanded a bit my answer, you may find it useful to be aware of some extra culprits about <code>LOGICAL</code>, interoperatbility and even portability inside Fortran itself."}, {"owner": {"reputation": 413, "user_id": 11575253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84223c303d332e0eb70545a76ed126?s=128&d=identicon&r=PG&f=1", "display_name": "BY408", "link": "https://stackoverflow.com/users/11575253/by408"}, "edited": false, "score": 0, "creation_date": 1559329715, "post_id": 56369368, "comment_id": 99399516, "body": "Fortran function added above."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1560177689, "post_id": 56369368, "comment_id": 99640439, "body": "re the quote about <code>bool</code> fiddling (unfortunately a moderator nuked our prior comments on the subject for no reason): <a href=\"https://github.com/cplusplus/draft/commit/a5603f0cf1b35097a9892d9627eb03dc5cc3e154#diff-a7cb4634eeb2e4ce984d41aaa9a70ef4\" rel=\"nofollow noreferrer\">github.com/cplusplus/draft/commit/&hellip;</a> #sadface"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1560179871, "post_id": 56369368, "comment_id": 99641556, "body": "@LightnessRacesinOrbit: once that we had a note that didn&#39;t add confusion, they decide to remove it! :-("}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1560180513, "post_id": 56369368, "comment_id": 99641897, "body": "@MatteoItalia IKR!"}], "tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": true, "score": 66, "last_activity_date": 1559307965, "last_edit_date": 1592644375, "creation_date": 1559169166, "answer_id": 56369368, "question_id": 56369080, "link": "https://stackoverflow.com/questions/56369080/setting-extra-bits-in-a-bool-makes-it-true-and-false-at-the-same-time/56369368#56369368", "title": "Setting extra bits in a bool makes it true and false at the same time", "body": "<p>In C++ the bit representation (and even the size) of a <code>bool</code> is implementation defined; generally it's implemented as a <code>char</code>-sized type taking 1 or 0 as possible values.</p>\n<p>If you set its value to anything different from the allowed ones (in this specific case by aliasing a <code>bool</code> through a <code>char</code> and modifying its bit representation), you are breaking the rules of the language, so anything can happen. In particular, it's explicitly specified in the standard that a &quot;broken&quot; <code>bool</code> may behave as both <code>true</code> and <code>false</code> (or neither <code>true</code> nor <code>false</code>) at the same time:</p>\n<blockquote>\n<p>Using a <code>bool</code> value in ways described by this International Standard as \u201cundefined,\u201d such as by examining the value of an uninitialized automatic object, might cause it to behave as if it is neither <code>true</code> nor <code>false</code></p>\n</blockquote>\n<p>(C++11, [basic.fundamental], note 47)</p>\n<hr />\n<p>In this particular case, <a href=\"https://gcc.godbolt.org/z/3P5DYR\" rel=\"noreferrer\">you can see how it ended up in this bizarre situation</a>: the first <code>if</code> gets compiled to</p>\n<pre><code>    movzx   eax, BYTE PTR [rbp-33]\n    test    al, al\n    je      .L22\n</code></pre>\n<p>which loads <code>T</code> in <code>eax</code> (with zero extension), and skips the print if it's all zero; the next if instead is</p>\n<pre><code>    movzx   eax, BYTE PTR [rbp-33]\n    xor     eax, 1\n    test    al, al\n    je      .L23\n</code></pre>\n<p>The test <code>if(T == false)</code> is transformed to <code>if(T^1)</code>, which flips just the low bit. This would be ok for a valid <code>bool</code>, but for your &quot;broken&quot; one it doesn't cut it.</p>\n<p>Notice that this bizarre sequence is only generated at low optimization levels; at higher levels this is generally going to boil down to a zero/nonzero check, and a sequence like yours is likely to become <a href=\"https://gcc.godbolt.org/z/9I0OR-\" rel=\"noreferrer\">a single test/conditional branch</a>. You will get bizarre behavior anyway in other contexts, e.g. when summing <code>bool</code> values to other integers:</p>\n<pre><code>int foo(bool b, int i) {\n    return i + b;\n}\n</code></pre>\n<p><a href=\"https://gcc.godbolt.org/z/07suQv\" rel=\"noreferrer\">becomes</a></p>\n<pre><code>foo(bool, int):\n        movzx   edi, dil\n        lea     eax, [rdi+rsi]\n        ret\n</code></pre>\n<p>where <code>dil</code> is &quot;trusted&quot; to be 0/1.</p>\n<hr />\n<p>If your program is all C++, then the solution is simple: don't break <code>bool</code> values this way, avoid messing with their bit representation and everything will go well; in particular, even if you assign from an integer to a <code>bool</code> the compiler will emit the necessary code to make sure that the resulting value is a valid <code>bool</code>, so your <code>bool T = 3</code> is indeed safe, and <code>T</code> will end up with a <code>true</code> in its guts.</p>\n<p>If instead you need to interoperate with code written in other languages that may not share the same idea of what a <code>bool</code> is, just avoid <code>bool</code> for &quot;boundary&quot; code, and marshal it as an appropriately-sized integer. It will work in conditionals &amp; co. just as fine.</p>\n<hr />\n<h3>Update about the Fortran/interoperability side of the issue</h3>\n<blockquote>\n<p><em>Disclaimer</em> all I know of Fortran is what I read this morning on standard documents, and that I have some punched cards with Fortran listings that I use as bookmarks, so go easy on me.</p>\n</blockquote>\n<p>First of all, this kind of language interoperability stuff isn't part of the language standards, but of the platform ABI. As we are talking about Linux x86-64, the relevant document is <a href=\"https://www.uclibc.org/docs/psABI-x86_64.pdf\" rel=\"noreferrer\">the System V x86-64 ABI</a>.</p>\n<p>First of all, nowhere is specified that the C <code>_Bool</code> type (which is defined to be the same as C++ <code>bool</code> at 3.1.2 note \u2020) has any kind of compatibility with Fortran <code>LOGICAL</code>; in particular, at 9.2.2 table 9.2 specifies that &quot;plain&quot; <code>LOGICAL</code> is mapped to <code>signed int</code>. About <code>TYPE*N</code> types it says that</p>\n<blockquote>\n<p>The \u201c<code>TYPE*N</code>\u201d notation specifies that variables or aggregate members of type <code>TYPE</code> shall occupy <code>N</code> bytes of storage.</p>\n</blockquote>\n<p>(ibid.)</p>\n<p>There's no equivalent type explicitly specified for <code>LOGICAL*1</code>, and it's understandable: it's not even standard; indeed if you try to compile a Fortran program containing a <code>LOGICAL*1</code> in Fortran 95 compliant mode you get warnings about it, both by ifort</p>\n<pre><code>./example.f90(2): warning #6916: Fortran 95 does not allow this length specification.   [1]\n\n    logical*1, intent(in) :: x\n\n------------^\n</code></pre>\n<p>and by gfort</p>\n<pre><code>./example.f90:2:13:\n     logical*1, intent(in) :: x\n             1\nError: GNU Extension: Nonstandard type declaration LOGICAL*1 at (1)\n</code></pre>\n<p>so the waters are already muddled; so, combining the two rules above, I'd go for <code>signed char</code> to be safe.</p>\n<p><em>However</em>: the ABI also specifies:</p>\n<blockquote>\n<p>The values for type <code>LOGICAL</code> are <code>.TRUE.</code> implemented as 1 and <code>.FALSE.</code>\nimplemented as 0.</p>\n</blockquote>\n<p>So, if you have a program that stores anything besides 1 and 0 in a <code>LOGICAL</code> value, <em>you are already out of spec on the Fortran side</em>! You say:</p>\n<blockquote>\n<p>A fortran <code>logical*1</code> has same representation as <code>bool</code>, but in fortran if bits are 00000011 it is <code>true</code>, in C++ it is undefined.</p>\n</blockquote>\n<p>This last statement is not true, the Fortran standard is representation-agnostic, and the ABI explicitly says the contrary. Indeed you can see this in action easily by <a href=\"https://gcc.godbolt.org/z/dh-a-c\" rel=\"noreferrer\">checking the output of gfort for <code>LOGICAL</code> comparison</a>:</p>\n<pre><code>integer function logical_compare(x, y)\n    logical, intent(in) :: x\n    logical, intent(in) :: y\n    if (x .eqv. y) then\n        logical_compare = 12\n    else\n        logical_compare = 24\n    end if\nend function logical_compare\n</code></pre>\n<p>becomes</p>\n<pre><code>logical_compare_:\n        mov     eax, DWORD PTR [rsi]\n        mov     edx, 24\n        cmp     DWORD PTR [rdi], eax\n        mov     eax, 12\n        cmovne  eax, edx\n        ret\n</code></pre>\n<p>You'll notice that there's a straight <code>cmp</code> between the two values, without normalizing them first (unlike <code>ifort</code>, that is more conservative in this regard).</p>\n<p>Even more interesting: regardless of what the ABI says, ifort by default uses a nonstandard representation for <code>LOGICAL</code>; this is explained in the <a href=\"https://software.intel.com/en-us/fortran-compiler-developer-guide-and-reference-fpscomp\" rel=\"noreferrer\"><code>-fpscomp logicals</code></a> switch documentation, which also specifies some interesting details about <code>LOGICAL</code> and cross-language compatibility:</p>\n<blockquote>\n<p>Specifies that integers with a non-zero value are treated as true, integers with a zero value are treated as false. The literal constant .TRUE. has an integer value of 1, and the literal constant .FALSE. has an integer value of 0. This representation is used by Intel Fortran releases before Version 8.0 and by Fortran PowerStation.</p>\n<p>The default is <code>fpscomp nologicals</code>, which specifies that odd integer values (low bit one) are treated as true and even integer values (low bit zero) are treated as false.</p>\n<p>The literal constant .TRUE. has an integer value of -1, and the literal constant .FALSE. has an integer value of 0. This representation is used by Compaq Visual Fortran. The internal representation of LOGICAL values is not specified by the Fortran standard. <em><strong>Programs which use integer values in LOGICAL contexts, or which pass LOGICAL values to procedures written in other languages, are non-portable and may not execute correctly. Intel recommends that you avoid coding practices that depend on the internal representation of LOGICAL values.</strong></em></p>\n</blockquote>\n<p>(emphasis added)</p>\n<p>Now, the internal representation of a <code>LOGICAL</code> normally shouldn't a problem, as, from what I gather, if you play &quot;by the rules&quot; and don't cross language boundaries you aren't going to notice. For a standard compliant program there's no &quot;straight conversion&quot; between <code>INTEGER</code> and <code>LOGICAL</code>; the only way I see you can shove an <code>INTEGER</code> into a <code>LOGICAL</code> seem to be <code>TRANSFER</code>, which is intrinsically non-portable and give no real guarantees, or the non-standard <code>INTEGER</code> &lt;-&gt; <code>LOGICAL</code> conversion on assignment.</p>\n<p>The latter one <a href=\"https://gcc.gnu.org/onlinedocs/gfortran/Implicitly-convert-LOGICAL-and-INTEGER-values.html\" rel=\"noreferrer\">is documented</a> by gfort to always result in nonzero -&gt; <code>.TRUE.</code>, zero -&gt; <code>.FALSE.</code>, and <a href=\"https://gcc.godbolt.org/z/y5taV2\" rel=\"noreferrer\">you can see</a> that in all cases code is generated to make this happen (even though it's convoluted code in case of ifort with the legacy representation), so you cannot seem to shove an arbitrary integer into a <code>LOGICAL</code> in this way.</p>\n<pre><code>logical*1 function integer_to_logical(x)\n    integer, intent(in) :: x\n    integer_to_logical = x\n    return\nend function integer_to_logical\n</code></pre>\n<pre><code>integer_to_logical_:\n        mov     eax, DWORD PTR [rdi]\n        test    eax, eax\n        setne   al\n        ret\n</code></pre>\n<p>The reverse conversion for a <code>LOGICAL*1</code> is a straight integer zero-extension (gfort), so, to be honoring the contract in the documentation linked above, it's clearly expecting the <code>LOGICAL</code> value to be 0 or 1.</p>\n<p>But in general, the situation for these conversions is <a href=\"https://www.reddit.com/r/fortran/comments/a8dzvs/ifort_implicit_logicaltointeger_conversion_of/\" rel=\"noreferrer\">a bit</a> of <a href=\"https://groups.google.com/forum/#!topic/gg95/yQqAlfzIBDU\" rel=\"noreferrer\">a mess</a>, so I'd just stay away from them.</p>\n<hr />\n<p>So, long story short: avoid putting <code>INTEGER</code> data into <code>LOGICAL</code> values, as it is bad even in Fortran, and make sure to use the correct compiler flag to get the ABI-compliant representation for booleans, and interoperability with C/C++ should be fine. But to be extra safe, I'd just use plain <code>char</code> on the C++ side.</p>\n<p>Finally, from what I gather <a href=\"https://software.intel.com/en-us/fortran-compiler-developer-guide-and-reference-scalar-types\" rel=\"noreferrer\">from the documentation</a>, in ifort there is some builtin support for interoperability with C, including booleans; you may try to leverage it.</p>\n"}, {"comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 5, "creation_date": 1559214840, "post_id": 56369692, "comment_id": 99354931, "body": "<i>It&#39;s up to the compiler.</i>  It&#39;s up to &quot;the implementation&quot; in C++ terms.  On most platforms (including x86-64 GNU/Linux), compilers all follow an ABI (x86-64 System V) which is a separate document from the compiler.  It&#39;s <i>not</i> up to the compiler how a <code>bool</code> is stored in memory, that&#39;s specified by the ABI (other than private <code>bool</code> objects that nothing outside the function can ever see; then the as-if rule is in full force).  &quot;Up to the compiler&quot; is a useful simplification, but it&#39;s not really true, especially for compilers other than GCC (because GCC devs designed the x86-64 System V ABI.)"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1559214961, "post_id": 56369692, "comment_id": 99354984, "body": "@PeterCordes That&#39;s correct. As you say, it&#39;s a useful simplification, and completely warranted in this context IMO."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1559214976, "post_id": 56369692, "comment_id": 99354995, "body": "My answer on the uninitialized-bool UB question you linked covers all that, though :)  +1 don&#39;t mess with the object-representation of <code>bool</code>."}, {"owner": {"reputation": 413, "user_id": 11575253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84223c303d332e0eb70545a76ed126?s=128&d=identicon&r=PG&f=1", "display_name": "BY408", "link": "https://stackoverflow.com/users/11575253/by408"}, "edited": false, "score": 0, "creation_date": 1559264148, "post_id": 56369692, "comment_id": 99374563, "body": "I won&#39;t mess up with bits in my code, but this problem happens because I had a fortran function that returns a logical type (which is the same size as bool) and assigned that return value to a C++ bool. Then C++ started to act as it does above. I added that bit manipulation to mimic what fortran returned as true to save you the hassle of needing two compilers to reproduce the problem. What fortran assign to a variable as true is not true when you return that and assign it to a C++ bool. And it is not intuitive why standard will not accept non-zero bits as true."}, {"owner": {"reputation": 733, "user_id": 101039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/88oCA.png?s=128&g=1", "display_name": "JPhi1618", "link": "https://stackoverflow.com/users/101039/jphi1618"}, "reply_to_user": {"reputation": 413, "user_id": 11575253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84223c303d332e0eb70545a76ed126?s=128&d=identicon&r=PG&f=1", "display_name": "BY408", "link": "https://stackoverflow.com/users/11575253/by408"}, "edited": false, "score": 4, "creation_date": 1559277049, "post_id": 56369692, "comment_id": 99376838, "body": "@BY408, if you need a type to handle values other than 1 and 0, then you shouldn&#39;t use a bool.  Use an unsigned char or int or other number variable.  A unsigned char used in an if() statement behaves the way you want (zero is false, nonzero is true)."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 413, "user_id": 11575253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84223c303d332e0eb70545a76ed126?s=128&d=identicon&r=PG&f=1", "display_name": "BY408", "link": "https://stackoverflow.com/users/11575253/by408"}, "edited": false, "score": 0, "creation_date": 1559297949, "post_id": 56369692, "comment_id": 99384984, "body": "@BY408 Such a rule would make code necessarily slower, for no real gain. Matteo shows how the implementations that the standard permits can be super fast! Thanks, standard!"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 413, "user_id": 11575253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84223c303d332e0eb70545a76ed126?s=128&d=identicon&r=PG&f=1", "display_name": "BY408", "link": "https://stackoverflow.com/users/11575253/by408"}, "edited": false, "score": 0, "creation_date": 1559310902, "post_id": 56369692, "comment_id": 99391333, "body": "@BY408 can you show the code of this Fortran function?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1559315687, "post_id": 56369692, "comment_id": 99393847, "body": "@LightnessRacesinOrbit: If the Standard had specified that each read of a <code>bool</code> that has had a non-zero even number into a <code>bool</code> may independently treat it as yielding any integer value and specified that implementations need not allow code to take the address of <code>__bool</code> objects,  that would have made the type compatible with many implementations&#39; pre-existing <code>bit</code> types, and would have allowed compilers to generate optimal code in many circumstances where they presently cannot."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1559315741, "post_id": 56369692, "comment_id": 99393876, "body": "@supercat: I don&#39;t follow. Can you rephrase?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1559317201, "post_id": 56369692, "comment_id": 99394605, "body": "@LightnessRacesinOrbit: Suppose <code>unsigned f(unsigned)</code> is external function of whose return value is known by the programmer to always be 0 or 1 when passed an argument of 2. Given <code>bool b = f(2);</code> a C99 compiler would be required to generate machine code to check whether the value is zero and force it to 1 if not. If the Standard had been written with optimization in mind, it could simply store the return value of <code>f</code> directly. Further, a fair number of compilers prior to C99 had a <code>bit</code> type which behaved like a single-bit bitfield with the same truncation behavior as other unsigned types."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1559317333, "post_id": 56369692, "comment_id": 99394673, "body": "@supercat That seems like an edge case when compared to <i>every single int-to-bool conversion ever</i>."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1559317691, "post_id": 56369692, "comment_id": 99394843, "body": "@LightnessRacesinOrbit: The same issue would apply in any situation where the programmer knows that an integer-type value will be 0 or 1 in all cases where the value in the <code>bool</code> would matter, but a compiler would have no way of knowing that."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1559318214, "post_id": 56369692, "comment_id": 99395082, "body": "@supercat There are intrinsics you can use for edge cases like that to signal that you know something the compiler doesn&#39;t"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 23, "last_activity_date": 1560177809, "last_edit_date": 1560177809, "creation_date": 1559171829, "answer_id": 56369692, "question_id": 56369080, "link": "https://stackoverflow.com/questions/56369080/setting-extra-bits-in-a-bool-makes-it-true-and-false-at-the-same-time/56369692#56369692", "title": "Setting extra bits in a bool makes it true and false at the same time", "body": "<p>This is what happens when you violate your contract with both the language and the compiler.</p>\n\n<p>You probably heard somewhere that \"zero is false\", and \"non-zero is true\". That holds when you stick to the language's parameters, statically converting an <code>int</code> to <code>bool</code> or vice versa.</p>\n\n<p>It does not hold when you start messing with bit representations. In that case, you break your contract, and enter the realm of (at the very least) implementation-defined behaviour.</p>\n\n<p>Simply don't do that.</p>\n\n<p>It's not up to you how a <code>bool</code> is stored in memory. It's up to the compiler. If you want to change a <code>bool</code>'s value, either assign <code>true</code>/<code>false</code>, or assign an integer and use the proper conversion mechanisms provided by C++.</p>\n\n<hr>\n\n<p>The C++ standard used to actually give a specific call-out to how using <code>bool</code> in this manner is naughty and bad and evil (<em>\"Using a <code>bool</code> value in ways described by this document as 'undefined',such as by examining the value of an uninitialized automatic object, might cause it to behave as if it is neither <code>true</code> nor <code>false</code>.\"</em>), though it was <a href=\"https://github.com/cplusplus/draft/commit/a5603f0cf1b35097a9892d9627eb03dc5cc3e154#diff-a7cb4634eeb2e4ce984d41aaa9a70ef4\" rel=\"nofollow noreferrer\">removed in C++20 for editorial reasons</a>.</p>\n"}], "owner": {"reputation": 413, "user_id": 11575253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84223c303d332e0eb70545a76ed126?s=128&d=identicon&r=PG&f=1", "display_name": "BY408", "link": "https://stackoverflow.com/users/11575253/by408"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6313, "favorite_count": 5, "accepted_answer_id": 56369368, "answer_count": 2, "score": 42, "last_activity_date": 1560177809, "creation_date": 1559167094, "last_edit_date": 1559554806, "question_id": 56369080, "link": "https://stackoverflow.com/questions/56369080/setting-extra-bits-in-a-bool-makes-it-true-and-false-at-the-same-time", "title": "Setting extra bits in a bool makes it true and false at the same time", "body": "<p>If I get a <code>bool</code> variable and set its second bit to 1, then variable evaluates to true and false at the same time. Compile the following code with gcc6.3 with <code>-g</code> option, (<code>gcc-v6.3.0/Linux/RHEL6.0-2016-x86_64/bin/g++ -g main.cpp -o mytest_d</code>)  and run the executable. You get the following.</p>\n\n<p>How can T be equal to true and false at the same time?</p>\n\n<pre><code>       value   bits \n       -----   ---- \n    T:   1     0001\nafter bit change\n    T:   3     0011\nT is true\nT is false\n</code></pre>\n\n<p>This can happen when you call a function in a different language (say fortran) where true and false definition is different than C++. For fortran if any bits are not 0 then the value is true, if all bits are zero then the value is false.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;bitset&gt;\n\nusing namespace std;\n\nvoid set_bits_to_1(void* val){\n  char *x = static_cast&lt;char *&gt;(val);\n\n  for (int i = 0; i&lt;2; i++ ){\n    *x |= (1UL &lt;&lt; i);\n  }\n}\n\nint main(int argc,char *argv[])\n{\n\n  bool T = 3;\n\n  cout &lt;&lt;\"       value   bits \" &lt;&lt;endl;\n  cout &lt;&lt;\"       -----   ---- \" &lt;&lt;endl;\n  cout &lt;&lt;\"    T:   \"&lt;&lt; T &lt;&lt;\"     \"&lt;&lt; bitset&lt;4&gt;(T)&lt;&lt;endl;\n\n  set_bits_to_1(&amp;T);\n\n\n  bitset&lt;4&gt; bit_T = bitset&lt;4&gt;(T);\n  cout &lt;&lt;\"after bit change\"&lt;&lt;endl;\n  cout &lt;&lt;\"    T:   \"&lt;&lt; T &lt;&lt;\"     \"&lt;&lt; bit_T&lt;&lt;endl;\n\n  if (T ){\n    cout &lt;&lt;\"T is true\" &lt;&lt;endl;\n  }\n\n  if ( T == false){\n    cout &lt;&lt;\"T is false\" &lt;&lt;endl;\n  }\n\n\n}\n</code></pre>\n\n<p>///////////////////////////////////\n// Fortran function that is not compatible with C++ when compiled with ifort.</p>\n\n<pre><code>       logical*1 function return_true()\n         implicit none\n\n         return_true = 1;\n\n       end function return_true\n</code></pre>\n"}, {"tags": ["c++", "compiler-optimization", "bit", "bit-shift", "intrinsics"], "comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1559259051, "post_id": 56369022, "comment_id": 99373635, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/194199/discussion-on-question-by-bryce-kille-creating-a-mask-using-c-bit-shift-intrin\">moved to chat</a>."}], "owner": {"reputation": 494, "user_id": 7092484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l9xmX.png?s=128&g=1", "display_name": "Throckmorton", "link": "https://stackoverflow.com/users/7092484/throckmorton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1559258906, "creation_date": 1559166777, "last_edit_date": 1559258906, "question_id": 56369022, "link": "https://stackoverflow.com/questions/56369022/creating-a-mask-using-c-bit-shift-intrinsics", "title": "Creating a mask using C++ bit shift intrinsics", "body": "<p>Let's say we want to create a mask of type <code>unsigned short</code> with contiguous set of <code>len</code> 1s starting from position <code>a</code> with as little instructions as possible. The most popular way to do this is</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>T mask = ((1 &lt;&lt; len)-1) &lt;&lt; a;\n</code></pre>\n\n<p>Where <code>T</code> is any built-in unsigned integral type.</p>\n\n<p>My question is the following: If <code>a != 0 &amp;&amp; a + len &lt; DIGITS</code>, where <code>DIGITS</code> is a compile time constant equal to the number of bits in a word of type<code>T</code>, is there anything we can do (compiler builtins or intrinsics) to save even a single instruction? I am looking for answers as generic as possible (architecture and compiler neutral), however answers that only work on specific systems or in specific contexts are also of use, primarily when they are compile-time deducible contexts.</p>\n\n<p><strong>Edit/Leaderboard:</strong></p>\n\n<p>-<strong>4 instructions</strong>: <a href=\"https://godbolt.org/z/ppuHVP\" rel=\"nofollow noreferrer\"><code>_bzhi_u32(-1,len) &lt;&lt; first_pos</code></a><br>\n(however as people discussed in the comments, I don't know much about the latency of the _bhzi instruction)</p>\n\n<p>-<strong>6 instructions</strong> (by just adding the <code>-O1</code> flag)</p>\n"}, {"tags": ["c++", "operator-overloading", "c++14", "language-lawyer", "delete-operator"], "answers": [{"comments": [{"owner": {"reputation": 469, "user_id": 4824854, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SPhK8fI7Ih8/AAAAAAAAAAI/AAAAAAAACnc/0BBhoF9bSXg/photo.jpg?sz=128", "display_name": "Sandburg", "link": "https://stackoverflow.com/users/4824854/sandburg"}, "edited": false, "score": 0, "creation_date": 1559190857, "post_id": 56368878, "comment_id": 99345479, "body": "It is not related to <code>operator delete[]</code>?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 469, "user_id": 4824854, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SPhK8fI7Ih8/AAAAAAAAAAI/AAAAAAAACnc/0BBhoF9bSXg/photo.jpg?sz=128", "display_name": "Sandburg", "link": "https://stackoverflow.com/users/4824854/sandburg"}, "edited": false, "score": 1, "creation_date": 1559191035, "post_id": 56368878, "comment_id": 99345511, "body": "@Sandburg - No. <code>operator delete</code> has a legal overload that accepts the object size of the most derived object as an additional argument."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 469, "user_id": 4824854, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SPhK8fI7Ih8/AAAAAAAAAAI/AAAAAAAACnc/0BBhoF9bSXg/photo.jpg?sz=128", "display_name": "Sandburg", "link": "https://stackoverflow.com/users/4824854/sandburg"}, "edited": false, "score": 0, "creation_date": 1559236699, "post_id": 56368878, "comment_id": 99365864, "body": "@Sandburg: It is related to both versions of the operator."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 8, "last_activity_date": 1559165894, "creation_date": 1559165894, "answer_id": 56368878, "question_id": 56368799, "link": "https://stackoverflow.com/questions/56368799/operator-delete-with-size-parameter-and-without-size-parameter-which-one-is-c/56368878#56368878", "title": "`operator delete` with size parameter and without size parameter: which one is chosen when both are available?", "body": "<p>This is <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#255\" rel=\"noreferrer\">CWG issue 255</a>, dating back to the year 2000. To quote its premise:</p>\n\n<blockquote>\n  <p>Paragraph 4 of 15.5 [class.free] speaks of looking up a deallocation\n  function. While it is an error if a placement deallocation function\n  alone is found by this lookup, there seems to be an assumption that a\n  placement deallocation function and a usual deallocation function can\n  both be declared in a given class scope without creating an ambiguity.\n  The normal mechanism by which ambiguity is avoided when functions of\n  the same name are declared in the same scope is overload resolution;\n  however, there is no mention of overload resolution in the description\n  of the lookup. In fact, there appears to be nothing in the current\n  wording that handles this case. That is, the following example appears\n  to be ill-formed, according to the current wording:</p>\n\n<pre><code>struct S {\n    void operator delete(void*);\n    void operator delete(void*, int);\n};\nvoid f(S* p) {\n    delete p;    // ill-formed: ambiguous operator delete\n}\n</code></pre>\n</blockquote>\n\n<p>The status of the issue is currently \"drafting\", and as of writing this answer it appears still unresolved. There is no wording about overload resolution with regard to the deallocation functions.</p>\n\n<p>Clang and GCC seem to be choosing arbitrarily. I'd argue it would have been better to emit some sort of diagnostic about the operator being ambiguous.</p>\n"}], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 1, "accepted_answer_id": 56368878, "answer_count": 1, "score": 6, "last_activity_date": 1559342041, "creation_date": 1559165451, "last_edit_date": 1559342041, "question_id": 56368799, "link": "https://stackoverflow.com/questions/56368799/operator-delete-with-size-parameter-and-without-size-parameter-which-one-is-c", "title": "`operator delete` with size parameter and without size parameter: which one is chosen when both are available?", "body": "<p>When I run this code sample in GCC and Clang</p>\n\n<pre><code>struct S\n{\n  int a;        \n\n  void *operator new(size_t s) \n  { \n    std::cout &lt;&lt; \"new \" &lt;&lt; s &lt;&lt; std::endl;\n    return ::operator new(s); \n  }\n\n  void operator delete(void *p, size_t s) noexcept \n  { \n    std::cout &lt;&lt; \"delete \" &lt;&lt; s &lt;&lt; std::endl;\n    ::operator delete(p);\n  }\n\n  void operator delete(void *p) noexcept\n  { \n    std::cout &lt;&lt; \"delete \" &lt;&lt; \"none\" &lt;&lt; std::endl;\n    ::operator delete(p);\n  }\n};\n\nint main()\n{\n  S *p = new S;\n  delete p;\n}\n</code></pre>\n\n<p>I get the following output from both GCC and Clang</p>\n\n<pre><code>new 4\ndelete none\n</code></pre>\n\n<p>which means that the compilers selected the \"sizeless\" version of <code>operator delete</code>.</p>\n\n<p>However, if I try something similar with globally replaced <code>operator new</code> and <code>operator delete</code> functions</p>\n\n<pre><code>struct S\n{\n  int a;        \n};\n\nvoid *operator new(size_t s)\n{\n  std::cout &lt;&lt; \"new \" &lt;&lt; s &lt;&lt; std::endl;\n  return std::malloc(s);\n}\n\nvoid operator delete(void *p, size_t s) noexcept\n{\n  std::cout &lt;&lt; \"delete \" &lt;&lt; s &lt;&lt; std::endl;\n  std::free(p);\n}\n\nvoid operator delete(void *p) noexcept\n{\n  std::cout &lt;&lt; \"delete \" &lt;&lt; \"none\" &lt;&lt; std::endl;\n  std::free(p);\n}\n\nint main()\n{\n  S *p = new S;\n  delete p;\n}\n</code></pre>\n\n<p>From GCC I get </p>\n\n<pre><code>new 4\ndelete 4\n</code></pre>\n\n<p>and from Clang I get</p>\n\n<pre><code>new 4\ndelete none\n</code></pre>\n\n<p>I know that \"sized\" version of in-class <code>operator delete</code> has been present in C++ since C++98, but looking through C++98 I don't seem to be able to find a definitive answer to the question of what version of <code>operator delete</code> should be selected in the first example. Is it even specified?</p>\n\n<p>And what about C++14 and its \"sized\" version of global <code>operator delete</code> in the second example? Does the language say which version should be selected?</p>\n"}, {"tags": ["c++", "linker", "g++", "ld", "link-time-optimization"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1559185942, "post_id": 56368771, "comment_id": 99344554, "body": "Seems like a linker bug to me, maybe file a bug report"}, {"owner": {"reputation": 201, "user_id": 2796814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RlzsP.png?s=128&g=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/2796814/steven"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1559572146, "post_id": 56368771, "comment_id": 99453204, "body": "Linking with -pthread does not make any difference. Also compiling with -pthread does not make any difference, regardless on whether -pthread is used for linking or not."}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 2, "creation_date": 1559572527, "post_id": 56368771, "comment_id": 99453434, "body": "If the gold linker is installed, try linking with <code>-fuse-ld=gold</code>. But as M.M said, this looks like a linker bug. It&#39;s probably worth reporting. I use the latest version of binutils (2.32) and I can reproduce the issue."}, {"owner": {"reputation": 201, "user_id": 2796814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RlzsP.png?s=128&g=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/2796814/steven"}, "reply_to_user": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 0, "creation_date": 1559575815, "post_id": 56368771, "comment_id": 99455271, "body": "@NikosC. Everything works with gold. Thank you for confirming the issue. I&#39;ll look into filing a bug report."}, {"owner": {"reputation": 201, "user_id": 2796814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RlzsP.png?s=128&g=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/2796814/steven"}, "edited": false, "score": 1, "creation_date": 1564700358, "post_id": 56368771, "comment_id": 101127237, "body": "The issue seems to be fixed in binutils 2.32.51.20190707-1 in Debian testing."}, {"owner": {"reputation": 109, "user_id": 8700131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18e6ca50099cc0c6fd1a1f0e0c06f08a?s=128&d=identicon&r=PG&f=1", "display_name": "Coronon", "link": "https://stackoverflow.com/users/8700131/coronon"}, "edited": false, "score": 0, "creation_date": 1603554877, "post_id": 56368771, "comment_id": 114077094, "body": "@Steven, thank you for this question, all my questions were marked as a duplicate (which they werent) and now after another 3h I finally found this, you are my hero ^^"}], "owner": {"reputation": 201, "user_id": 2796814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RlzsP.png?s=128&g=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/2796814/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 457, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1559571535, "creation_date": 1559165255, "last_edit_date": 1559571535, "question_id": 56368771, "link": "https://stackoverflow.com/questions/56368771/undefined-reference-with-link-time-optimization-and-as-needed-ld-flag", "title": "Undefined reference with link time optimization and --as-needed ld flag", "body": "<p>I'm having some troubles compiling a large C++ project that uses link time optimization. After some digging I managed to produce an (almost) minimal working example that exhibits the same issue.</p>\n\n<p>Say that I have the following <strong>foo.cpp</strong> file:</p>\n\n<pre><code>//foo.cpp\n#include &lt;iostream&gt;\n#include \"bar.h\"\n\nint main()\n{\n    std::cout &lt;&lt; \"Hello world\" &lt;&lt; std::endl;\n    //bar(); //Everything works if this is uncommented\n\n    return 0;\n}\n</code></pre>\n\n<p>Where <strong>bar.h</strong> and <strong>bar.cpp</strong> look like this:</p>\n\n<pre><code>//bar.h\n#ifndef __BAR_H__\n#define __BAR_H__\n\nvoid bar();\n\n#endif\n</code></pre>\n\n<p>and</p>\n\n<pre><code>//bar.cpp\n#include \"bar.h\"\n#include &lt;thread&gt;\n\nvoid bar()\n{\n    std::thread t([] {});\n    t.join();\n}\n</code></pre>\n\n<p>The code is compiled like this:</p>\n\n<pre><code>$ g++ -std=c++11 -O3 -flto -c foo.cpp\n$ g++ -std=c++11 -O3 -flto -c bar.cpp\n</code></pre>\n\n<p>But trying to link the object files results in a undefined reference error:</p>\n\n<pre><code>$ g++ -flto -Wl,-as-needed foo.o bar.o -lpthread\n/usr/bin/ld: /usr/lib/gcc/x86_64-linux-gnu/8/libstdc++.so: undefined reference to `pthread_create'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Can somebody please explain what is going on here?</p>\n\n<p>Some notes:</p>\n\n<ul>\n<li>Adding the -pthread flag makes no difference.  </li>\n<li>I'm explicitly passing the option -Wl,-as-needed as, on my system, this is not the default. However, this is the default behavior in some other GNU/Linux distributions.</li>\n<li>Linking succeeds if I uncomment the call to bar() in foo.cpp.</li>\n<li>Linking succeeds if the option -Wl,--as-needed is removed (or -Wl,--no-as-needed is added).</li>\n<li>I'm using g++ 8.3.0 (Debian 8.3.0-6) but the same problem appears in g++ 7.4.0 (Ubuntu 7.4.0-1ubuntu1~18.04).</li>\n</ul>\n\n<p>Edit: clang with lld works fine.</p>\n\n<pre><code>$ clang++ -fuse-ld=lld -flto -Wl,-as-needed foo.o bar.o -lpthread\n$ ./a.out \nHello world\n</code></pre>\n"}, {"tags": ["c++", "variadic-templates", "template-argument-deduction"], "comments": [{"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1559165212, "post_id": 56368693, "comment_id": 99340203, "body": "It&#39;s a g++ bug. &quot;mismatched types <code>Vs</code> and <code>char</code>&quot; makes no sense. A workaround is to do <code>foo&lt;int&gt;  f0(std::pair&lt;int, char&gt;())</code>."}, {"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1559165704, "post_id": 56368693, "comment_id": 99340330, "body": "Strangely the workaround only works if there are 0 arguments to the pair constructor."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1559241378, "post_id": 56368693, "comment_id": 99367822, "body": "A bug without doubt. There are no initializer-list constructor and it is not a copy-intialization so overload resolution for list-initialization should be equivalent to direct initialization with parenthesis as shown by 0x4499... <a href=\"http://eel.is/c++draft/over.match.funcs#over.match.list-1.2\" rel=\"nofollow noreferrer\">eel.is/c++draft/over.match.funcs#over.match.list-1.2</a> and  <a href=\"http://eel.is/c++draft/over.match.funcs#over.match.ctor-1\" rel=\"nofollow noreferrer\">eel.is/c++draft/over.match.funcs#over.match.ctor-1</a>"}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 1, "creation_date": 1559326575, "post_id": 56368693, "comment_id": 99398403, "body": "@0x499602D2: That\u2019s a function declaration."}, {"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "reply_to_user": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "edited": false, "score": 1, "creation_date": 1559326715, "post_id": 56368693, "comment_id": 99398440, "body": "@DavisHerring Oops. Most vexing parse got me."}], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1586917276, "creation_date": 1559164853, "last_edit_date": 1586917276, "question_id": 56368693, "link": "https://stackoverflow.com/questions/56368693/g-and-clang-different-behaviour-for-class-method-variadic-template-types", "title": "g++ and clang++ different behaviour for class/method variadic template types", "body": "<p>Another case where g++ and clang++ behaves differently with variadic templates.</p>\n\n<p>Given the following program</p>\n\n<pre><code>#include &lt;utility&gt;\n\ntemplate &lt;typename ... Ks&gt;\nstruct foo\n {\n   template &lt;typename ... Vs&gt;\n   foo (std::pair&lt;Ks, Vs&gt; ...)\n    { }\n };\n\nint main ()\n {\n   foo&lt;int&gt;  f0{std::pair&lt;int, char&gt;{}};\n }\n</code></pre>\n\n<p>clang++ compile without problems where g++ gives the following error</p>\n\n<pre><code>tmp_004-17,gcc,clang.cpp: In function \u2018int main()\u2019:\ntmp_004-17,gcc,clang.cpp:28:39: error: no matching function for call to \u2018foo&lt;int&gt;::foo(&lt;brace-enclosed initializer list&gt;)\u2019\n    foo&lt;int&gt;  f0{std::pair&lt;int, char&gt;{}};\n                                       ^\ntmp_004-17,gcc,clang.cpp:22:4: note: candidate: \u2018template&lt;class ... Vs&gt; foo&lt;Ks&gt;::foo(std::pair&lt;Ks, Vs&gt;...)\u2019\n    foo (std::pair&lt;Ks, Vs&gt; ...)\n    ^~~\ntmp_004-17,gcc,clang.cpp:22:4: note:   template argument deduction/substitution failed:\ntmp_004-17,gcc,clang.cpp:28:39: note:   mismatched types \u2018Vs\u2019 and \u2018char\u2019\n    foo&lt;int&gt;  f0{std::pair&lt;int, char&gt;{}};\n                                       ^\ntmp_004-17,gcc,clang.cpp:19:8: note: candidate: \u2018constexpr foo&lt;int&gt;::foo(const foo&lt;int&gt;&amp;)\u2019\n struct foo\n        ^~~\ntmp_004-17,gcc,clang.cpp:19:8: note:   no known conversion for argument 1 from \u2018std::pair&lt;int, char&gt;\u2019 to \u2018const foo&lt;int&gt;&amp;\u2019\ntmp_004-17,gcc,clang.cpp:19:8: note: candidate: \u2018constexpr foo&lt;int&gt;::foo(foo&lt;int&gt;&amp;&amp;)\u2019\ntmp_004-17,gcc,clang.cpp:19:8: note:   no known conversion for argument 1 from \u2018std::pair&lt;int, char&gt;\u2019 to \u2018foo&lt;int&gt;&amp;&amp;\u2019\n</code></pre>\n\n<p>Isn't completely clear but seems to me that g++ has problem mixing variadic template expansion/deduction for class/struct (<code>Ks...</code>) and methods template arguments (<code>Vs...</code>).</p>\n\n<p>As usual, the question is: who's right? g++ or clang++?</p>\n"}, {"tags": ["c++", "std", "perfect-forwarding"], "answers": [{"comments": [{"owner": {"reputation": 629, "user_id": 7432062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c9af59e5dabc944ba727e6e83b7e7be?s=128&d=identicon&r=PG&f=1", "display_name": "MrBrN197", "link": "https://stackoverflow.com/users/7432062/mrbrn197"}, "edited": false, "score": 0, "creation_date": 1559239111, "post_id": 56368696, "comment_id": 99366905, "body": "I completely did not look at this from a practical use case point of view I simply saw the function and tried to guess at how it worked. So your example with <code>foo</code> when <code>foo</code> gets an rvalue the type of <code>T</code> is <code>&amp;&amp;</code> and specifying that explicitly as <code>std::forward&lt;T&gt;(t)</code> invokes the partial specialization of <code>std::remove_reference</code> that takes template parameter <code>T</code> as <code>T&amp;&amp;</code>. Also due to the reference collapsing that you mentioned <code>t</code> would be an rvalue and thus invoke the <code>std::forward</code> implementation that takes and rvalue. Is this all correct? Why do both <code>std::forward</code> implementations return &amp;&amp;"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 629, "user_id": 7432062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c9af59e5dabc944ba727e6e83b7e7be?s=128&d=identicon&r=PG&f=1", "display_name": "MrBrN197", "link": "https://stackoverflow.com/users/7432062/mrbrn197"}, "edited": false, "score": 1, "creation_date": 1559239803, "post_id": 56368696, "comment_id": 99367214, "body": "@MrBrN197 - Both return <code>&amp;&amp;</code> because  applying it to an lvalue reference will leave it an lvalue reference (due to reference collapsing)."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 4, "last_activity_date": 1559165242, "last_edit_date": 1559165242, "creation_date": 1559164857, "answer_id": 56368696, "question_id": 56368603, "link": "https://stackoverflow.com/questions/56368603/how-does-stdforward-deduce-the-type-of-ty/56368696#56368696", "title": "How does std::forward deduce the type of `_Ty`?", "body": "<blockquote>\n  <p>how does the compiler figure out the type of _Ty?</p>\n</blockquote>\n\n<p>It doesn't. <code>std::forward</code> is meant to be used with the type provided explicitly. And it's enforced by accepting the function argument to <code>std::forward</code> with the type <code>typename remove_reference&lt;_Ty&gt;::type</code>, where <code>_Ty</code> is in a <a href=\"https://stackoverflow.com/questions/25245453/what-is-a-nondeduced-context\">non-deduced context</a>. The compiler <em>can't</em> deduce it.</p>\n\n<p>A typical use with a forwarding reference is as follows:</p>\n\n<pre><code>template&lt;typename T&gt;\nvoid foo(T&amp;&amp; t) {\n    std::forward&lt;T&gt;(t);\n}\n</code></pre>\n\n<p>Strictly speaking, <code>std::forward</code> is just syntactic sugar for a cast to <code>T&amp;&amp;</code> above. It's <a href=\"https://stackoverflow.com/questions/13725747/concise-explanation-of-reference-collapsing-rules-requested-1-a-a-2\">reference collapsing</a> the does all the magic, but a bare cast to <code>T&amp;&amp;</code> does not convey the intent to forward quite as clearly as a named operator. That is why <code>std::forward</code> exists.</p>\n"}, {"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 3, "last_activity_date": 1559164874, "creation_date": 1559164874, "answer_id": 56368701, "question_id": 56368603, "link": "https://stackoverflow.com/questions/56368603/how-does-stdforward-deduce-the-type-of-ty/56368701#56368701", "title": "How does std::forward deduce the type of `_Ty`?", "body": "<p>It does not deduce it. This is why when you use <code>std::forward</code> you have to give it template argument:</p>\n\n<pre><code>std::forward&lt;T&gt;(t);\n</code></pre>\n\n<p>This is contrary to <code>std::move</code>, which does deduce, and typically used like this:</p>\n\n<pre><code>std::move(t);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 2, "last_activity_date": 1559165302, "last_edit_date": 1559165302, "creation_date": 1559164875, "answer_id": 56368702, "question_id": 56368603, "link": "https://stackoverflow.com/questions/56368603/how-does-stdforward-deduce-the-type-of-ty/56368702#56368702", "title": "How does std::forward deduce the type of `_Ty`?", "body": "<blockquote>\n  <p>How does <code>std::forward</code> deduce the type of <code>_Ty</code>?</p>\n</blockquote>\n\n<p><code>Ty</code> doesn't <em>have</em> a type. <code>Ty</code> <em>is</em> a type (template parameter). The compiler <em>doesn't</em> deduce the type.</p>\n\n<blockquote>\n  <p>how does the compiler figure out the type of <code>_Ty</code>?</p>\n</blockquote>\n\n<p>The template argument has to be passed explicitly.</p>\n\n<p>If the type were deduced, then:</p>\n\n<pre><code>template&lt;class T&gt;\nvoid foo(T&amp;&amp; t) {\n    bar(std::forward(t));\n}\n</code></pre>\n\n<p>would pass an lvalue, since <code>t</code> is an lvalue. But we want to pass an rvalue, because <code>t</code> is an rvalue reference. Because the deduction is counter-productive, it is disabled using the <code>remove_reference&lt;_Ty&gt;::type&amp;</code> trick, and we must write correctly:</p>\n\n<pre><code>template&lt;class T&gt;\nvoid foo(T&amp;&amp; t) {\n    bar(std::forward&lt;T&gt;(t));\n                 // ^^^ this is how the compiler knows\n}\n</code></pre>\n"}], "owner": {"reputation": 629, "user_id": 7432062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c9af59e5dabc944ba727e6e83b7e7be?s=128&d=identicon&r=PG&f=1", "display_name": "MrBrN197", "link": "https://stackoverflow.com/users/7432062/mrbrn197"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1559192770, "creation_date": 1559164395, "last_edit_date": 1559192770, "question_id": 56368603, "link": "https://stackoverflow.com/questions/56368603/how-does-stdforward-deduce-the-type-of-ty", "title": "How does std::forward deduce the type of `_Ty`?", "body": "<p>I'm learning about templates and particularly <code>std::forward</code>; when I check its implementation it uses another class template <code>std::remove_reference</code> in its arguments list:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;class _Ty&gt;\n_Ty&amp;&amp; forward(typename remove_reference&lt;_Ty&gt;::type&amp; _Arg)\n{// forward an lvalue as either an lvalue or an rvalue\n   // ...\n}\n</code></pre>\n\n<p>btw: I've removed a few things like inline, constexpr, NO_EXCEPT and the body of the function for clarity</p>\n\n<p>I read about how types are deduced when the template parameter is a pointer(<code>_Ty*</code>), reference(<code>_Ty</code>&amp;), universal reference(<code>_Ty</code>) and where its just the type itself (<code>_Ty</code>). In this case it is a reference but it has that added <code>removed_reference&lt;_Ty&gt;::type</code> preceding it; the <code>_Ty</code> and the reference are split by the call to <code>remove_reference</code>. How does the compiler figure out the type of <code>_Ty</code>?</p>\n\n<p>The function template has to figure out the template parameters using the arguments passed in to the function(when not explicitly defining them in the function call) but in this case remove_reference is also a class template that needs to figure out the type of <code>_Ty</code> as well. It seems almost like a catch 22 for me because <code>std::forward</code> needs to figure out <code>_Ty</code> using its function argument but its function argument which is <code>std::remove_reference&lt;_Ty&gt;</code> needs to already know what <code>_Ty</code> is. All This tells me is that I have a flawed understanding of how templates work but I don't know where.</p>\n"}, {"tags": ["c++", "image", "qt", "opencv", "image-processing"], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 11575127, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zs8bolHfPLk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reQzEaYkzJj-zS5jWs54klico2okg/mo/photo.jpg?sz=128", "display_name": "Alessandro Cerro", "link": "https://stackoverflow.com/users/11575127/alessandro-cerro"}, "edited": false, "score": 0, "creation_date": 1559589430, "post_id": 56369176, "comment_id": 99460947, "body": "the thing is that this software should be kind of a GIMP, Lightroom... So I got a MainWindow, with lots of slider, each one referring to a kind of transformation (like exposure contrast, white balance, saturation etc...). So is ok to modify directly my loaded image, but I don&#39;t have a &#39;rule&#39; to follow for all the filters."}], "tags": [], "owner": {"reputation": 8084, "user_id": 2896626, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd83959d7fe39c658d2e49cfecfe4b6?s=128&d=identicon&r=PG&f=1", "display_name": "Paul92", "link": "https://stackoverflow.com/users/2896626/paul92"}, "is_accepted": false, "score": 2, "last_activity_date": 1559167731, "creation_date": 1559167731, "answer_id": 56369176, "question_id": 56368586, "link": "https://stackoverflow.com/questions/56368586/handle-multiple-transformation-on-an-image/56369176#56369176", "title": "Handle multiple transformation on an Image", "body": "<p>What about applying all the transformations on the original image all the time?</p>\n\n<p>You know the positions of your sliders, and you know when something changes. Then, you simply start from scratch. Take the new image and apply the transformations one by one.</p>\n\n<p>In order to do this, you make the functions return a copy of the original image with the transformations applied. So, the algorithm would be something like:</p>\n\n<pre><code>originalImage = getImage();\nbrightnessImage = applyBrightness(originalImage);\ncontrastedImage = applyContrast(brightnessImage);\n</code></pre>\n\n<p>and so on. Everytime something changes.</p>\n\n<p>I think this is reasonable, since you don't seem to deal with very expensive operations. </p>\n"}, {"tags": [], "owner": {"reputation": 590, "user_id": 2026195, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yoGcO.gif?s=128&g=1", "display_name": "Micka&#235;l C. Guimar&#227;es", "link": "https://stackoverflow.com/users/2026195/micka%c3%abl-c-guimar%c3%a3es"}, "is_accepted": true, "score": 0, "last_activity_date": 1559174141, "creation_date": 1559174141, "answer_id": 56369974, "question_id": 56368586, "link": "https://stackoverflow.com/questions/56368586/handle-multiple-transformation-on-an-image/56369974#56369974", "title": "Handle multiple transformation on an Image", "body": "<p>Paul92's answers already answers your question and is probably the easiest and cleanest solution to your problem.</p>\n\n<p>If you really wish/need to keep the latest transformed image instead of the original one, you can store the value of the sliders position at the latest transformation and use a delta to do the actual transformation :</p>\n\n<pre><code>brightnessDelta = brightnessSlider-&gt;value() - latestBrightnessSlider;\nconstrastDelta = contrastSlider-&gt;value() - latestContrastSlider;\n\nlatestTransformedImage = getImage();\napplyBrightness(latestTransformedImage, brightnessDelta);\napplyContrast(latestTransformedImage, contrastDelta);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 139, "user_id": 11575127, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zs8bolHfPLk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reQzEaYkzJj-zS5jWs54klico2okg/mo/photo.jpg?sz=128", "display_name": "Alessandro Cerro", "link": "https://stackoverflow.com/users/11575127/alessandro-cerro"}, "is_accepted": false, "score": 0, "last_activity_date": 1560528388, "creation_date": 1560528388, "answer_id": 56601799, "question_id": 56368586, "link": "https://stackoverflow.com/questions/56368586/handle-multiple-transformation-on-an-image/56601799#56601799", "title": "Handle multiple transformation on an Image", "body": "<p>Hi solved this by creating a single function that process all the linear transformation together!</p>\n"}], "owner": {"reputation": 139, "user_id": 11575127, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zs8bolHfPLk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reQzEaYkzJj-zS5jWs54klico2okg/mo/photo.jpg?sz=128", "display_name": "Alessandro Cerro", "link": "https://stackoverflow.com/users/11575127/alessandro-cerro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 56369974, "answer_count": 3, "score": 1, "last_activity_date": 1560528388, "creation_date": 1559164349, "last_edit_date": 1559164552, "question_id": 56368586, "link": "https://stackoverflow.com/questions/56368586/handle-multiple-transformation-on-an-image", "title": "Handle multiple transformation on an Image", "body": "<p>I'm running a project that will do more or less the same as CameraRaw/Photoshop does. The thing is, how do I handle multiple mods on the image matrix?</p>\n\n<p>let me explain, I read the image Using OpenCV function, and I built a simple Ui in QtCreator, with a few sliders for contrast, exposure etc..\nso I got my sliders that, on triggered action, call the function contrast(); on where I pass my Image, and the sliders value (sliders can go from -100 to 100).</p>\n\n<p>Here's the problem: if I set the exposure to +50, then my Image will increase it to +50. From that, if I try to decrease it, to +30, then the exposure will be +50 +30, as I wrote on my pixels image.</p>\n\n<p>So, in order to decrease from +50 to +30, I made a copy of my image, that will be modified , and when I recall the exposure(), then the filter will be applied on the original Image.</p>\n\n<p>So far so good, but, what if I'll apply contrast() and exposure() at the same time? As I done for now, calling one of the twos will exclude the firstly called.</p>\n\n<p>Is there anybody that can help with figure out a way for handling that?</p>\n"}, {"tags": ["c++", "vector", "unique-ptr", "coredump", "cyclic-reference"], "comments": [{"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "edited": false, "score": 0, "creation_date": 1559346100, "post_id": 56368506, "comment_id": 99403845, "body": "your destructor is not <code>virtual</code>, this is UB"}, {"owner": {"reputation": 25, "user_id": 9273114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce80feeedadc39575b2ab6447c1f3595?s=128&d=identicon&r=PG&f=1", "display_name": "JIN TLG", "link": "https://stackoverflow.com/users/9273114/jin-tlg"}, "reply_to_user": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "edited": false, "score": 0, "creation_date": 1559485971, "post_id": 56368506, "comment_id": 99427836, "body": "@Jack, but the problem happens before the destructor starts to work."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9273114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce80feeedadc39575b2ab6447c1f3595?s=128&d=identicon&r=PG&f=1", "display_name": "JIN TLG", "link": "https://stackoverflow.com/users/9273114/jin-tlg"}, "edited": false, "score": 0, "creation_date": 1559167155, "post_id": 56369068, "comment_id": 99340739, "body": "Thank you. I will try shared_ptr later on. But why the vector can also have porblem?"}, {"owner": {"reputation": 25, "user_id": 9273114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce80feeedadc39575b2ab6447c1f3595?s=128&d=identicon&r=PG&f=1", "display_name": "JIN TLG", "link": "https://stackoverflow.com/users/9273114/jin-tlg"}, "edited": false, "score": 0, "creation_date": 1559496087, "post_id": 56369068, "comment_id": 99430346, "body": "Hello, I have tried to use the weak pointer. At the beginning it worked, but after I added a new vector in the Derived class member, the similar problem comes again."}], "tags": [], "owner": {"reputation": 51, "user_id": 9802514, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-a8g73zAixu8/AAAAAAAAAAI/AAAAAAAAAFk/NF6U2cSF1LI/photo.jpg?sz=128", "display_name": "Geo", "link": "https://stackoverflow.com/users/9802514/geo"}, "is_accepted": false, "score": 0, "last_activity_date": 1559167028, "creation_date": 1559167028, "answer_id": 56369068, "question_id": 56368506, "link": "https://stackoverflow.com/questions/56368506/core-dumped-due-to-unique-ptr-or-vector-in-classes-with-cyclic-references/56369068#56369068", "title": "Core-dumped due to unique_ptr or vector in classes with cyclic references", "body": "<p>You're creating a circular reference by having two objects refer to each other, so you shouldn't be using a unique pointer. Try using a weak pointer.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/27085782/how-to-break-shared-ptr-cyclic-reference-using-weak-ptr\">How to break shared_ptr cyclic reference using weak_ptr</a></p>\n"}], "owner": {"reputation": 25, "user_id": 9273114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce80feeedadc39575b2ab6447c1f3595?s=128&d=identicon&r=PG&f=1", "display_name": "JIN TLG", "link": "https://stackoverflow.com/users/9273114/jin-tlg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559845365, "creation_date": 1559163954, "last_edit_date": 1559845365, "question_id": 56368506, "link": "https://stackoverflow.com/questions/56368506/core-dumped-due-to-unique-ptr-or-vector-in-classes-with-cyclic-references", "title": "Core-dumped due to unique_ptr or vector in classes with cyclic references", "body": "<p>I am trying to handle with a code with cyclic references classes. And I found I got some problem with unique_ptr or vector, when I tried to define them as class members. </p>\n\n<p>This code contains 3 classes. I will show all of them in order to avoid any ambiguity. </p>\n\n<p>First, I start my code by a class called as startup in main.cpp:</p>\n\n<pre><code>#include &lt;memory&gt;\n#include &lt;vector&gt;\n#include \"startup.h\"\n#include \"Derived_B.h\"\nint main() {\n    std::unique_ptr&lt;startup&gt; go(new startup);\n    return 0;\n}\n</code></pre>\n\n<p>In startup class, the derived class is declared (note the base class in not this one):</p>\n\n<pre><code>//Header file\n#include &lt;memory&gt;\nclass startup {\npublic:\n    startup();\n    ~startup();\n    class Derived_B *dcb;\n};\n//.cpp\n#include \"startup.h\"\n#include \"Derived_B.h\"\nstartup::startup() {\n    dcb = new Derived_B(this);\n}\nstartup::~startup() {\ndelete dcb;\n}\n</code></pre>\n\n<p>Before I show the derived classes, I will show the base class:</p>\n\n<pre><code>//Header file    \n#include \"startup.h\"\nclass Base {\npublic:\n    class startup *go;\n    class Derived_B *&amp;dcb;\n    Base(startup *up):go(up),\n                      dcb(up-&gt;dcb){}\n    ~Base(){}\n};\n</code></pre>\n\n<p>Now, the derived class is:</p>\n\n<pre><code>//Header file    \n#include &lt;memory&gt;\n#include &lt;vector&gt;\n#include \"Base.h\"\nclass Derived_B:public Base {\npublic:\n    Derived_B(startup *up);\n    ~Derived_B(){}\n    std::unique_ptr&lt;double[]&gt; apple; //Unique pointer here may give problem\n    std::unique_ptr&lt;double[]&gt; apple2; //Unique pointer here may give problem\n    std::vector&lt;double&gt; orange; //Vector here may give problem too\n};\n//.cpp\n#include \"Derived_B.h\"\nDerived_B::Derived_B(startup *up):Base(up) {\n\n}\n</code></pre>\n\n<p>I constructed these class in this way in order to let the startup class and Derived_B class know each orther's public member directly. However after I added unique_ptr or vector in the Derived_B class, time to time I will get problem of core dumped. </p>\n\n<p>I have checked it with valgrind, and the result is here:</p>\n\n<pre><code>==7999== 1 errors in context 1 of 2:\n==7999== Invalid write of size 8\n==7999==    at 0x400967: _Vector_impl (stl_vector.h:87)\n==7999==    by 0x400967: _Vector_base (stl_vector.h:125)\n==7999==    by 0x400967: vector (stl_vector.h:257)\n==7999==    by 0x400967: Derived_B::Derived_B(startup*) (Derived_B.cpp:7)\n==7999==    by 0x4008F0: startup::startup() (startup.cpp:11)\n==7999==    by 0x40076A: main (main.cpp:9)\n==7999==  Address 0x5ab6d00 is 8 bytes after a block of size 40 alloc'd\n==7999==    at 0x4C2E0EF: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==7999==    by 0x4008E2: startup::startup() (startup.cpp:11)\n==7999==    by 0x40076A: main (main.cpp:9)\n==7999== \n==7999== \n==7999== 1 errors in context 2 of 2:\n==7999== Invalid write of size 8\n==7999==    at 0x40095F: _Vector_impl (stl_vector.h:87)\n==7999==    by 0x40095F: _Vector_base (stl_vector.h:125)\n==7999==    by 0x40095F: vector (stl_vector.h:257)\n==7999==    by 0x40095F: Derived_B::Derived_B(startup*) (Derived_B.cpp:7)\n==7999==    by 0x4008F0: startup::startup() (startup.cpp:11)\n==7999==    by 0x40076A: main (main.cpp:9)\n==7999==  Address 0x5ab6cf8 is 0 bytes after a block of size 40 alloc'd\n==7999==    at 0x4C2E0EF: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==7999==    by 0x4008E2: startup::startup() (startup.cpp:11)\n==7999==    by 0x40076A: main (main.cpp:9)\n==7999== \n==7999== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Please note that the problem happens quite randomly, sometimes valgrind will report unique_ptr having problem.\nCould someone tell me how to solve this problem please?</p>\n\n<p><strong>Edit 2:</strong>\nIn order to deal with the problem of cyclic reference, I used the combination of shared_ptr and unique_ptr. I will show what I have changed in the startup class and Base class:</p>\n\n<pre><code>//In startup.h\nstd::shared_ptr&lt;class Derived_B&gt; dcb;//original code: class Derived_B *dcb;\n//In startup.cpp\ndcb.reset(new Derived_B(this));//original code: dcb = new Derived_B(this);\n\n//In Base.h\nclass startup *&amp;go;\nstd::weak_ptr&lt;class Derived_B&gt; dcb; //original code: class Derived_B *&amp;dcb;\n</code></pre>\n\n<p>At the beginning, this change seems work.But after I add new vector member in the Derived_B class, the similar problem comes again. In addition, this problem happens before the destructor. I can show part of the valgrind test:</p>\n\n<pre><code>Constructor of startup.\n--12397-- REDIR: 0x54613b0 (libc.so.6:__GI_mempcpy) redirected to 0x4c34fa0 (__GI_mempcpy)\nConstructor of Base.\n==12397== Invalid write of size 8\n==12397==    at 0x400F54: _Head_base (tuple:105)\n==12397==    by 0x400F54: _Tuple_impl (tuple:202)\n==12397==    by 0x400F54: tuple (tuple:602)\n==12397==    by 0x400F54: unique_ptr (unique_ptr.h:415)\n==12397==    by 0x400F54: Derived_B::Derived_B(startup*) (Derived_B.cpp:7)\n==12397==    by 0x400C9E: startup::startup() (startup.cpp:13)\n==12397==    by 0x400A6A: main (main.cpp:10)\n==12397==  Address 0x5ab7168 is 0 bytes after a block of size 88 alloc'd\n==12397==    at 0x4C2E0EF: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==12397==    by 0x400C90: startup::startup() (startup.cpp:13)\n==12397==    by 0x400A6A: main (main.cpp:10)\n==12397== \n==12397== Invalid write of size 8\n==12397==    at 0x400F5C: _Head_base (tuple:105)\n==12397==    by 0x400F5C: _Tuple_impl (tuple:202)\n==12397==    by 0x400F5C: tuple (tuple:602)\n==12397==    by 0x400F5C: unique_ptr (unique_ptr.h:415)\n==12397==    by 0x400F5C: Derived_B::Derived_B(startup*) (Derived_B.cpp:7)\n==12397==    by 0x400C9E: startup::startup() (startup.cpp:13)\n==12397==    by 0x400A6A: main (main.cpp:10)\n==12397==  Address 0x5ab7170 is 8 bytes after a block of size 88 alloc'd\n==12397==    at 0x4C2E0EF: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==12397==    by 0x400C90: startup::startup() (startup.cpp:13)\n==12397==    by 0x400A6A: main (main.cpp:10)\n==12397== \nConstructor of Derived_B.\n</code></pre>\n\n<p><strong>Edit 3 (Problem may be solved):</strong>\nI think the problem may be related with how I made the executable code. After I deleted all the .o files, and re-make the code, there is no more problem.\nHere is my Makefile:</p>\n\n<pre><code># makefile \nFLAG = -O2 -g\nCOMPLIER = g++ -std=c++14\n#OBJ = \nOBJ = startup.o Derived_B.o #Derived_A.o \nspTest: ${OBJ} main.cpp\n    ${COMPLIER} ${FLAG} -o spTest ${OBJ} main.cpp\nDerived_B.o: Derived_B.h Derived_B.cpp Base.h\n    ${COMPLIER} ${FLAG} -c Derived_B.cpp \nstartup.o: startup.h startup.cpp \n    ${COMPLIER} ${FLAG} -c startup.cpp\n.PHONY: clean\nclean:\n    -rm *.o spTest\n</code></pre>\n"}, {"tags": ["c++", "tensorflow"], "comments": [{"owner": {"reputation": 2179, "user_id": 2630666, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/VIN5F.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2630666/matt"}, "edited": false, "score": 0, "creation_date": 1559164660, "post_id": 56368470, "comment_id": 99340042, "body": "Is this one of the features that is still being ported from python to c++?"}, {"owner": {"reputation": 190, "user_id": 3870885, "user_type": "registered", "profile_image": "https://graph.facebook.com/667895180/picture?type=large", "display_name": "Francois Zard", "link": "https://stackoverflow.com/users/3870885/francois-zard"}, "reply_to_user": {"reputation": 2179, "user_id": 2630666, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/VIN5F.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2630666/matt"}, "edited": false, "score": 0, "creation_date": 1559165601, "post_id": 56368470, "comment_id": 99340305, "body": "Unlikely as this has been around since at least 1.12 and i&#39;m on 2.0"}], "owner": {"reputation": 190, "user_id": 3870885, "user_type": "registered", "profile_image": "https://graph.facebook.com/667895180/picture?type=large", "display_name": "Francois Zard", "link": "https://stackoverflow.com/users/3870885/francois-zard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1559163784, "creation_date": 1559163784, "question_id": 56368470, "link": "https://stackoverflow.com/questions/56368470/feeding-a-variable-alpha-learning-rate-to-applygradientdescent", "title": "Feeding a Variable alpha (learning rate) to ApplyGradientDescent", "body": "<p>This is a minimal example to create a variable, create a gradient for it and create the gradient update operations with ApplyGradientDescent</p>\n\n<pre><code>auto w = Variable(scope, { 3 }, DT_FLOAT);\n\nstd::vector&lt;Output&gt; grad_outputs;\nTF_CHECK_OK(AddSymbolicGradients(scope, { loss }, { w }, &amp;grad_outputs));\n\nauto apply_w1 = ApplyGradientDescent(scope, w, Cast(scope, 0.01, DT_FLOAT), { grad_outputs[0] });\n</code></pre>\n\n<p>However, what I really want is to have a variable learning rate, which I could update from outside the graph, while avoiding having to create new gradient operations on the graph each time... As such:</p>\n\n<pre><code>auto ph = Placeholder(scope, DT_FLOAT));\nauto var = Variable(scope, {1}, DT_FLOAT));\nauto assignVar = Assign(scope, var, ph));\n\nTensor newLr(DT_FLOAT, TensorShape({1}));\nnewLr.flat&lt;float&gt;().data()[0] = 0.001;\n\nTF_CHECK_OK(session-&gt;Run({{ph, newLr}}, {assignVar}, nullptr));\n\nauto apply = ApplyGradientDescent(scope, w, var, { grad_outputs[0] });\n</code></pre>\n\n<p>The problem is the above fails because ApplyGradientDescent expects a Scalar as alpha, which I don't understand. Is there any way around this?</p>\n"}, {"tags": ["c++", "inheritance", "constructor"], "comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 1, "creation_date": 1559163978, "post_id": 56368357, "comment_id": 99339832, "body": "This should be of use: <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\" title=\"the definitive c book guide and list\">stackoverflow.com/questions/388242/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 2, "last_activity_date": 1559163869, "creation_date": 1559163869, "answer_id": 56368489, "question_id": 56368357, "link": "https://stackoverflow.com/questions/56368357/what-does-it-mean-that-a-sub-classs-constructor-followed-by-a-base-class-constr/56368489#56368489", "title": "What does it mean that a sub-class&#39;s constructor followed by a base class constructor after a colon?", "body": "<p><code>Student() : Person::Person() {}</code> is calling the constructor of the base class <code>Person</code> in the <a href=\"https://en.cppreference.com/w/cpp/language/initializer_list\" rel=\"nofollow noreferrer\">member initialization list</a> of the derived <code>Student</code> constructor.</p>\n\n<p>Note that <code>Person::Person()</code> can be simplified to just <code>Person()</code> in that context, as there is no need to fully qualify it using its class type.</p>\n\n<p><code>Student() : Person() {}</code> </p>\n\n<p>You don't <em>need</em> to specify a base class constructor in the member initialization list of a derived constructor unless the derived constructor passes input values to the base class constructor.  Which your code does not, so you can optionally omit the base class constructor call entirely.  <code>Person()</code> is a <a href=\"https://en.cppreference.com/w/cpp/language/default_constructor\" rel=\"nofollow noreferrer\">default constructor</a>, which the compiler will call automatically for you.</p>\n\n<p><code>Student() {}</code> </p>\n\n<p>In which case, you can optionally also omit the <code>Student</code> constructor entirely, since it doesn't initialize anything else explicitly.</p>\n"}], "owner": {"reputation": 131, "user_id": 6811674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b1bbd38e08f28c51ae3873c9b886e2?s=128&d=identicon&r=PG&f=1", "display_name": "Wubin", "link": "https://stackoverflow.com/users/6811674/wubin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "closed_date": 1559194549, "accepted_answer_id": 56368489, "answer_count": 1, "score": 1, "last_activity_date": 1559163869, "creation_date": 1559163215, "question_id": 56368357, "link": "https://stackoverflow.com/questions/56368357/what-does-it-mean-that-a-sub-classs-constructor-followed-by-a-base-class-constr", "closed_reason": "Duplicate", "title": "What does it mean that a sub-class&#39;s constructor followed by a base class constructor after a colon?", "body": "<p>I would like to know what the code which is followed by a base class constructor does. Here is the code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;cmath&gt;\n#include &lt;cstdio&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\nusing namespace std;\n\nclass Person\n{\npublic:\n    Person() : name(\"\"), age(0) {}\n\nprotected:\n    string name;\n    int age;\n};\n\nclass Student : public Person\n{\npublic:\n    Student() : Person::Person() {}\n\nprivate:\n    int student_id;\n};\n</code></pre>\n\n<p>I know what the code does in class <code>Person</code>:</p>\n\n<p><code>Person() : name(\"\"), age(0) {}</code></p>\n\n<p>But I do not understand what this line does in class <code>Student</code>:</p>\n\n<p><code>Student() : Person::Person() {}</code></p>\n\n<p>So what it the meaning of <code>Person::Person()</code> after the colon?</p>\n"}, {"tags": ["c++", "linked-list"], "comments": [{"owner": {"reputation": 350, "user_id": 9723461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8fd01cd442e062d643682e3ac4d3b10?s=128&d=identicon&r=PG&f=1", "display_name": "MPops", "link": "https://stackoverflow.com/users/9723461/mpops"}, "edited": false, "score": 3, "creation_date": 1559163180, "post_id": 56368269, "comment_id": 99339557, "body": "well, if you want to place the nodes that meet the <code>cost</code> requirement, make a new linked list and add these nodes to them, and then return the <code>new_list_head</code> of this new linked list."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 2, "creation_date": 1559163251, "post_id": 56368269, "comment_id": 99339586, "body": "Unless this is a homework assignment (or something similar) where you&#39;re required to write all the code yourself, you might want to use <code>std::list</code> or <code>std::forward_list</code> instead of writing your own."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8124738, "user_type": "registered", "profile_image": "https://graph.facebook.com/1392259394172421/picture?type=large", "display_name": "Mickael Gon&#231;alves", "link": "https://stackoverflow.com/users/8124738/mickael-gon%c3%a7alves"}, "edited": false, "score": 0, "creation_date": 1559167319, "post_id": 56368612, "comment_id": 99340800, "body": "Hey thanks, Both cases are fine, I chose to return the head on the function argument, can you explain what you did in the If section?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 33, "user_id": 8124738, "user_type": "registered", "profile_image": "https://graph.facebook.com/1392259394172421/picture?type=large", "display_name": "Mickael Gon&#231;alves", "link": "https://stackoverflow.com/users/8124738/mickael-gon%c3%a7alves"}, "edited": false, "score": 0, "creation_date": 1559167488, "post_id": 56368612, "comment_id": 99340837, "body": "@MickaelGon&#231;alves a good way to learn how linked lists work is to sketch it out on paper, then step through the code instructions one at a time updating the drawing accordingly."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 3, "last_activity_date": 1559164817, "last_edit_date": 1559164817, "creation_date": 1559164458, "answer_id": 56368612, "question_id": 56368269, "link": "https://stackoverflow.com/questions/56368269/looping-through-linked-lists/56368612#56368612", "title": "Looping through linked lists", "body": "<p>What you are asking for really depends on your requirements, which you did not make clear enough.</p>\n\n<p>If you are expected to modify the input list that is being verified, you can do something like this:</p>\n\n<pre><code>node * verify_money(node * head, int cost)\n{\n    node * iterator = head;\n    node * previous = NULL;\n\n    while (iterator) {\n        node *next = iterator-&gt;next;\n\n        if (iterator-&gt;value &lt;= cost) {\n            if (previous) previous-&gt;next = next;\n            if (head == iterator) head = next;\n            delete iterator;\n        }\n        else\n            previous = iterator;\n\n        iterator = next;\n    }\n\n    return head;\n}\n</code></pre>\n\n<p>If you are expected to return a new list without modifying the original list, you can do something like this instead:</p>\n\n<pre><code>node * verify_money(node * head, int cost)\n{\n    node * new_head = NULL;\n    node ** new_node = &amp;new_head;\n\n    node * iterator = head;\n    while (iterator) {\n        if (iterator-&gt;value &gt; cost) {  \n            *new_node = new node;\n            (*new_node)-&gt;cost = value;\n            (*new_node)-&gt;next = NULL;\n            new_node = &amp;((*new_node)-&gt;next);\n        }\n        iterator = iterator-&gt;next;\n    }\n\n    return new_head;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8124738, "user_type": "registered", "profile_image": "https://graph.facebook.com/1392259394172421/picture?type=large", "display_name": "Mickael Gon&#231;alves", "link": "https://stackoverflow.com/users/8124738/mickael-gon%c3%a7alves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 56368612, "answer_count": 1, "score": 2, "last_activity_date": 1559164817, "creation_date": 1559162780, "last_edit_date": 1559163012, "question_id": 56368269, "link": "https://stackoverflow.com/questions/56368269/looping-through-linked-lists", "title": "Looping through linked lists", "body": "<p>So basically, what I'm trying to do is going through all the nodes and verify if <code>node.value is &lt;= cost</code>. If it is I need to remove that node and in the end I want to store the nodes that weren't remove in a new struct. I'm not sure how exactly am I suppose to do this.</p>\n\n<p>This struct can be an example:</p>\n\n<pre><code>struct node {\n    int value;\n    node * next;\n}\n</code></pre>\n\n<p>I'm going through all the nodes and remove only the ones that doen't have the required.</p>\n\n<pre><code>node * verify_money(node * head, int cost)\n{\n\n    node * iterator = head;\n\n    while(iterator != NULL){\n       if(iterator.value &lt;= cost) {  \n           /*remove this node*/\n       }\n       iterator = iterator.next;\n    }\n\nreturn /*struct without nodes removed/*\n\n}\n</code></pre>\n\n<p>I want to get the remaining nodes.</p>\n"}, {"tags": ["c++", "templates", "constants", "template-argument-deduction"], "comments": [{"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1559162850, "post_id": 56368233, "comment_id": 99339427, "body": "If the accessors are <code>const</code>, shouldn&#39;t they return a const reference? Then you wouldn&#39;t need the <code>const T</code> template parameter."}, {"owner": {"reputation": 1433, "user_id": 1093346, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a3a565cb678e2197a9a2320621524fbe?s=128&d=identicon&r=PG", "display_name": "bartgol", "link": "https://stackoverflow.com/users/1093346/bartgol"}, "reply_to_user": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1559162986, "post_id": 56368233, "comment_id": 99339477, "body": "Good question. See my edit."}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 3, "creation_date": 1559163258, "post_id": 56368233, "comment_id": 99339591, "body": "Why can&#39;t you simply use <code>template&lt;class T&gt; void foo(const MyArray&lt;T&gt;&amp; x);</code>?"}, {"owner": {"reputation": 1433, "user_id": 1093346, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a3a565cb678e2197a9a2320621524fbe?s=128&d=identicon&r=PG", "display_name": "bartgol", "link": "https://stackoverflow.com/users/1093346/bartgol"}, "reply_to_user": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 0, "creation_date": 1559163389, "post_id": 56368233, "comment_id": 99339630, "body": "@Evg, if I do that, then I have no help from the compiler in detecting accidental changes to the array (like e.g. because of a typo). When doing <code>MyArray&lt;int&gt; a; foo(a);</code>, the compiler will allow changes to <code>a</code> inside <code>foo</code>. I&#39;d like to prevent that, by having const enforced on the input."}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 0, "creation_date": 1559163517, "post_id": 56368233, "comment_id": 99339671, "body": "You should ensure this by properly using <code>const</code> overloads, not by inventing a different type. <code>const</code> member functions should not return non-const references."}, {"owner": {"reputation": 1433, "user_id": 1093346, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a3a565cb678e2197a9a2320621524fbe?s=128&d=identicon&r=PG", "display_name": "bartgol", "link": "https://stackoverflow.com/users/1093346/bartgol"}, "reply_to_user": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 0, "creation_date": 1559163614, "post_id": 56368233, "comment_id": 99339711, "body": "@Evg, as I said, I am not the one implementing <code>MyArray</code>. It&#39;s implementation is beyond my control. Notice, however, that <i>there is</i> a logic in their implementation: calling <code>operator[]</code> does not modify the underlying pointer, only the pointee. Depending on what you mean with &quot;being const&quot;, their implementation does or does not make sense."}, {"owner": {"reputation": 1433, "user_id": 1093346, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a3a565cb678e2197a9a2320621524fbe?s=128&d=identicon&r=PG", "display_name": "bartgol", "link": "https://stackoverflow.com/users/1093346/bartgol"}, "edited": false, "score": 0, "creation_date": 1559163958, "post_id": 56368233, "comment_id": 99339828, "body": "Re: &quot;const member function should not return non-const references&quot;. I absolutely agree if the object the reference is bound to is <i>a member</i> of the class. This case is <i>slightly</i> different, since the pointee is technically not a member of the class. I know the developers of <code>MyArray</code> are <i>very smart</i> c++ developers, and I know they had reasons for this choice. It&#39;s just too long to go over it here, and, as I said, changing <code>MyArray</code> is not  even under my control anyways."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1559166137, "post_id": 56368233, "comment_id": 99340445, "body": "For the edit2, you should ask another question normally, but for template function, parameters should &quot;match&quot;, whereas for non template function, one user conversion is allowed (by parameter)."}, {"owner": {"reputation": 1433, "user_id": 1093346, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a3a565cb678e2197a9a2320621524fbe?s=128&d=identicon&r=PG", "display_name": "bartgol", "link": "https://stackoverflow.com/users/1093346/bartgol"}, "edited": false, "score": 0, "creation_date": 1559174809, "post_id": 56368233, "comment_id": 99342517, "body": "Ah, that&#39;s the catch. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 7182, "user_id": 1756405, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ba33dcfe557ac8225234e185a43d8844?s=128&d=identicon&r=PG", "display_name": "IdeaHat", "link": "https://stackoverflow.com/users/1756405/ideahat"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1559164797, "post_id": 56368560, "comment_id": 99340084, "body": "Nope. const MyArray&lt;const T&gt;&amp; will make a ConstMyArrayView&lt;const T&gt; without any intervention."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1559165191, "post_id": 56368560, "comment_id": 99340195, "body": "@IdeaHat: As <code>foo</code> is template, indeed, no need to extra constructor, but <code>MyArray&lt;T&gt; x; foo(x);</code> won&#39;t compile as it is not matching. <code>foo&lt;T&gt;(x);</code> or <code>foo(ConstMyArrayView {x})</code> would be required."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1559166385, "post_id": 56368560, "comment_id": 99340523, "body": "but if <code>foo</code> is not template, overload might be called ;) but <code>void foo(const ConstMyArrayView&lt;int&gt;&amp; x);</code> won&#39;t accept <code>MyArray&lt;const int&gt;</code>."}], "tags": [], "owner": {"reputation": 7182, "user_id": 1756405, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ba33dcfe557ac8225234e185a43d8844?s=128&d=identicon&r=PG", "display_name": "IdeaHat", "link": "https://stackoverflow.com/users/1756405/ideahat"}, "is_accepted": false, "score": 2, "last_activity_date": 1559164227, "creation_date": 1559164227, "answer_id": 56368560, "question_id": 56368233, "link": "https://stackoverflow.com/questions/56368233/deducing-the-template-parameter-of-a-templated-class-argument-const-issue/56368560#56368560", "title": "Deducing the template parameter of a templated class argument: const issue", "body": "<p>Since you are not allowed to change MyArray, one option is to use an adapter class.</p>\n\n<pre><code>template &lt;typename T&gt;\nclass ConstMyArrayView {\n   public:\n    // Not an explicit constructor!\n    ConstMyArrayView(const MyArray&lt;T&gt;&amp; a) : a_(a) {}\n    const T&amp; operator[](size_t i) const { return a_[i]; }\n   private:\n     const MyArray&lt;T&gt;&amp; a_;\n};\n\ntemplate&lt;typename T&gt;\nvoid foo(const ConstMyArrayView&lt;T&gt;&amp; x);\n\nMyArray&lt;T&gt; x;\nfoo(x);\n</code></pre>\n\n<p>But in the end, if you can change <code>MyArray</code> to match the const-correctness you want, or switch to a class that does, that'll be the better option. </p>\n"}, {"comments": [{"owner": {"reputation": 1433, "user_id": 1093346, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a3a565cb678e2197a9a2320621524fbe?s=128&d=identicon&r=PG", "display_name": "bartgol", "link": "https://stackoverflow.com/users/1093346/bartgol"}, "edited": false, "score": 0, "creation_date": 1559165052, "post_id": 56368651, "comment_id": 99340152, "body": "<code>MyArray</code> is <i>veery</i> close to <code>std::span</code> (which I&#39;m not allowed to use due to portability and compiler limitations)."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 3, "last_activity_date": 1559165535, "last_edit_date": 1559165535, "creation_date": 1559164673, "answer_id": 56368651, "question_id": 56368233, "link": "https://stackoverflow.com/questions/56368233/deducing-the-template-parameter-of-a-templated-class-argument-const-issue/56368651#56368651", "title": "Deducing the template parameter of a templated class argument: const issue", "body": "<p>I would stay with</p>\n\n<pre><code>template&lt;typename T&gt;\nvoid foo(const MyArray&lt;T&gt;&amp;);\n</code></pre>\n\n<p>and make sure to instantiate it with <code>const T</code> (in unitTest for example).</p>\n\n<p>Else you can create a view as <a href=\"https://en.cppreference.com/w/cpp/container/span\" rel=\"nofollow noreferrer\"><code>std::span</code></a>.</p>\n\n<p>Something like (Depending of other methods provided by <code>MyArray</code>, you probably can do a better const view. I currently only used <code>operator[]</code>):</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct MyArrayConstView\n{\n    MyArrayConstView(MyArray&lt;T&gt;&amp; array) : mArray(std::ref(array)) {}\n    MyArrayConstView(MyArray&lt;const T&gt;&amp; array) : mArray(std::ref(array)) {}\n\n    const T&amp; operator[](std::size_t i) {\n        return std::visit([i](const auto&amp; a) -&gt; const T&amp; { return a[i]; }), mArray);\n    }\n\nprivate:\n    std::variant&lt;std::reference_wrapper&lt;MyArray&lt;T&gt;&gt;,\n                 std::reference_wrapper&lt;MyArray&lt;const T&gt;&gt;&gt; mArray;\n};\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>template &lt;typename T&gt;\nvoid foo(const MyArrayConstView&lt;T&gt;&amp;);\n</code></pre>\n\n<p>but you need to call it explicitly, (as deduction won't happen as <code>MyArray&lt;T&gt;</code> is not a <code>MyArrayConstView</code>)</p>\n\n<pre><code>MyArray&lt;double&gt; ar(/*blah*/);\nfoo(MyArrayConstView{ar});\nfoo&lt;double&gt;(ar);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "is_accepted": false, "score": 2, "last_activity_date": 1559166056, "creation_date": 1559166056, "answer_id": 56368900, "question_id": 56368233, "link": "https://stackoverflow.com/questions/56368233/deducing-the-template-parameter-of-a-templated-class-argument-const-issue/56368900#56368900", "title": "Deducing the template parameter of a templated class argument: const issue", "body": "<p>Here's an ugly but effective way to have a function use one type, but also get the compiler to check that the same code would compile if it used a different type instead:</p>\n\n<pre><code>template &lt;typename From, typename To&gt;\nstruct xfer_refs_cv\n{\n    using type = To;\n};\ntemplate &lt;typename From, typename To&gt;\nstruct xfer_refs_cv&lt;const From, To&gt;\n{\n    using type = const typename xfer_refs_cv&lt;From, To&gt;::type;\n};\ntemplate &lt;typename From, typename To&gt;\nstruct xfer_refs_cv&lt;volatile From, To&gt;\n{\n    using type = volatile typename xfer_refs_cv&lt;From, To&gt;::type;\n};\ntemplate &lt;typename From, typename To&gt;\nstruct xfer_refs_cv&lt;From&amp;, To&gt;\n{\n    using type = typename xfer_refs_cv&lt;From, To&gt;::type&amp;;\n};\ntemplate &lt;typename From, typename To&gt;\nstruct xfer_refs_cv&lt;From&amp;&amp;, To&gt;\n{\n    using type = typename xfer_refs_cv&lt;From, To&gt;::type&amp;&amp;;\n};\n\ntemplate &lt;typename CheckType, typename Func, typename CallType&gt;\nconstexpr decltype(auto) check_and_call(Func&amp;&amp; f, CallType&amp;&amp; call_arg)\n    noexcept(noexcept(std::forward&lt;Func&gt;(f)(std::forward&lt;CallType&gt;(call_arg))))\n{\n    (void) decltype(std::declval&lt;Func&amp;&amp;&gt;()\n      (std::declval&lt;typename xfer_refs_cv&lt;CallType&amp;&amp;, CheckType&gt;::type&gt;()), 0){};\n    return std::forward&lt;Func&gt;(f)(std::forward&lt;CallType&gt;(call_arg));\n}\n\ntemplate&lt;typename T&gt;\nvoid foo(const MyArray&lt;T&gt;&amp; x)\n{\n    check_and_call&lt;MyArray&lt;const T&gt;&gt;(\n        [](auto&amp;&amp; x) {\n        // Function implementation here.\n    }, x);\n}\n</code></pre>\n"}], "owner": {"reputation": 1433, "user_id": 1093346, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a3a565cb678e2197a9a2320621524fbe?s=128&d=identicon&r=PG", "display_name": "bartgol", "link": "https://stackoverflow.com/users/1093346/bartgol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 4, "accepted_answer_id": 56368651, "answer_count": 3, "score": 3, "last_activity_date": 1559166056, "creation_date": 1559162603, "last_edit_date": 1559165482, "question_id": 56368233, "link": "https://stackoverflow.com/questions/56368233/deducing-the-template-parameter-of-a-templated-class-argument-const-issue", "title": "Deducing the template parameter of a templated class argument: const issue", "body": "<p>I think the problem is fairly common, so there should be a known solution. I came up with one, but I'm not really satisfied, so I'm asking here, hoping someone can help.</p>\n\n<p>Say I have a function, whose signature is</p>\n\n<pre><code>template&lt;typename T&gt;\nvoid foo(const MyArray&lt;const T&gt;&amp; x);\n</code></pre>\n\n<p>The const in the template parameter is to prevent me from changin the array content, since (for reasons beyond this question), the accessors (<code>[]</code> and <code>()</code>) of <code>MyArray&lt;T&gt;</code> are always marked const, and return references to <code>T</code> (hence, the const ensure safety, since <code>MyArray&lt;T&gt;::operator[]</code> returns <code>T&amp;</code>, while <code>MyArray&lt;const T&gt;::operator[]</code> returns <code>const T&amp;</code>).</p>\n\n<p>Great. However, templates with different template arguments are non related, so I can't bind a reference to <code>MyClass&lt;T&gt;</code> to a reference of <code>MyClass&lt;const T&gt;</code>, meaning I can't do this</p>\n\n<pre><code>MyArray&lt;double&gt; ar(/*blah*/);\nfoo(ar);\n</code></pre>\n\n<p>Notice that, without a reference, the code above would work <em>provided</em> that there is a copy constructor that lets me create <code>MyArray&lt;const T&gt;</code> from <code>MyArray&lt;T&gt;</code>. However, I don't want to remove the reference, since the array construction would happen <em>a lot of times</em>, and, despite relatively cheap, its cost would add up.</p>\n\n<p>So the question: how can I call <code>foo</code> with an <code>MyArray&lt;T&gt;</code>?</p>\n\n<p>My only solution so far is the following:</p>\n\n<pre><code>MyArray&lt;T&gt; ar(/*blah*/);\nfoo(reinterpret_cast&lt;MyArray&lt;const T&gt;&gt;(ar));\n</code></pre>\n\n<p>(actually in my code I hid the reinterpret cast in an inlined function with more verbose name, but the end game is the same). The class <code>MyArray</code> does not have a specialization for <code>const T</code> that makes it not reinterpretable, so the cast should be 'safe'. But this is not really a nice solution to read. An alternative, would be to duplicate <code>foo</code>'s signature, to have a version taking <code>MyArray&lt;T&gt;</code>, which implementation does the cast and calls the const version. The problem with this is code duplication (and I have quite a few functions <code>foo</code> that need to be duplicated).</p>\n\n<p>Perhaps some extra template magic on the signature of <code>foo</code>? The goal is to pass both <code>MyArray&lt;T&gt;</code> and <code>MyArray&lt;const T&gt;</code>, while still retaining const-correctness (i.e., make the compiler bark if I accidentally change the input in the function body).</p>\n\n<p><strong>Edit 1</strong>: The class <code>MyArray</code> (whose implementation is not under my control), has const accessors, since it stores pointers. So calling <code>v[3]</code> will modify the values in the array, but not the <em>members stored in the class</em> (namely a pointer and some smart-pointer-like metadata). In other words, the object is de facto not modified by accessors, though the array is. It's a semantic distinction. Not sure why they went this direction (I have an idea, but too long to explain).</p>\n\n<p><strong>Edit 2</strong>: I accepted one of the two answers (though they were somewhat similar). I am not sure (for reasons long to explain) that the wrapper class is doable in my case (maybe, I have to think about it). I am also puzzled by the fact that, while</p>\n\n<pre><code>template&lt;typename T&gt;\nvoid foo(const MyArray&lt;const T&gt;&amp; x);\nMyArray&lt;int&gt; a;\nfoo(a);\n</code></pre>\n\n<p>does not compile, the following does</p>\n\n<pre><code>void foo(const MyArray&lt;const int&gt;&amp; x);\nMyArray&lt;int&gt; a;\nfoo(a);\n</code></pre>\n\n<p>Note: <code>MyArray</code> does offer a templated \"copy constructor\" with signature</p>\n\n<pre><code>template&lt;typename S&gt;\nMyArray(const MyArray&lt;S&gt;&amp;);\n</code></pre>\n\n<p>so it can create <code>MyArray&lt;const T&gt;</code> from <code>MyArray&lt;T&gt;</code>. I am puzzled why it works when <code>T</code> is explicit, while it doesn't if <code>T</code> is a template parameter.</p>\n"}, {"tags": ["c++", "templates", "inheritance", "specialization"], "answers": [{"tags": [], "owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "is_accepted": false, "score": 2, "last_activity_date": 1559165820, "last_edit_date": 1559165820, "creation_date": 1559165315, "answer_id": 56368777, "question_id": 56368183, "link": "https://stackoverflow.com/questions/56368183/template-specialization-and-inheritance-template-class-from-other-template-class/56368777#56368777", "title": "Template specialization and inheritance template class from other template class", "body": "<ol>\n<li><p>A class instantiated from the template <code>Derived&lt;T(P)&gt;</code> inherits from the class instantiated from <code>Base&lt;T(P)&gt;</code>.  Since the type <code>T(P)</code> matches your <code>Base</code> partial specialization, that template will be used to instantiate the class to inherit from.</p></li>\n<li><p>It's just called inheritance.  There's nothing special going on there.  You're just instantiating the template <code>Base</code> with the type <code>T(P)</code> and inheriting from the resulting class.</p></li>\n</ol>\n\n<hr>\n\n<p><code>Base&lt;T(P)&gt;</code> will get instantiated when <code>Derived&lt;T(P)&gt;</code> gets instantiated, so <code>Derived&lt;void(int)&gt;</code> inherits from <code>Base&lt;void(int)&gt;</code>.  Both of those instantiations will go through the same set of rules to figure out which template to use to instantiate that class.</p>\n\n<p>You may be getting confused thinking that <code>T(P)</code> is some special template thing.  It is not.  It's just the type \"function that returns <code>T</code> and takes a single argument of type <code>P</code>\".  Granted, types like that don't come up much outside of templates, but they're perfectly legal other places.  i.e.</p>\n\n<pre><code>using FuncType = void(int);\n\n// These two declarations are exactly the same\nvoid doAThing(FuncType* callback);\nvoid doAThing(void(*callback)(int));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 171, "user_id": 6707172, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_-oJ4-GxV-Q/AAAAAAAAAAI/AAAAAAAAIeI/nKtIUIyXOs0/photo.jpg?sz=128", "display_name": "Dark Hell", "link": "https://stackoverflow.com/users/6707172/dark-hell"}, "edited": false, "score": 0, "creation_date": 1559168817, "post_id": 56369251, "comment_id": 99341180, "body": "Why is it so difficult? I&#39;m writing thesis and i can&#39;t find a precise definition and explanation for such a construction."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "reply_to_user": {"reputation": 171, "user_id": 6707172, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_-oJ4-GxV-Q/AAAAAAAAAAI/AAAAAAAAIeI/nKtIUIyXOs0/photo.jpg?sz=128", "display_name": "Dark Hell", "link": "https://stackoverflow.com/users/6707172/dark-hell"}, "edited": false, "score": 0, "creation_date": 1559169590, "post_id": 56369251, "comment_id": 99341368, "body": "@DarkHell I&#39;m still not sure exactly what it is you want a term for."}, {"owner": {"reputation": 171, "user_id": 6707172, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_-oJ4-GxV-Q/AAAAAAAAAAI/AAAAAAAAIeI/nKtIUIyXOs0/photo.jpg?sz=128", "display_name": "Dark Hell", "link": "https://stackoverflow.com/users/6707172/dark-hell"}, "edited": false, "score": 0, "creation_date": 1559169853, "post_id": 56369251, "comment_id": 99341439, "body": "I thought that such a phenomenon has a term."}, {"owner": {"reputation": 359, "user_id": 6138593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efc52d146880aff19896fecdb156f1ea?s=128&d=identicon&r=PG&f=1", "display_name": "bluk", "link": "https://stackoverflow.com/users/6138593/bluk"}, "edited": false, "score": 0, "creation_date": 1604301825, "post_id": 56369251, "comment_id": 114295386, "body": "First time for me to encounter the syntax like Base&lt;T(P)&gt; (with that &quot;(P)&quot;). May I ask what is a keyword to google for?"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "reply_to_user": {"reputation": 359, "user_id": 6138593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efc52d146880aff19896fecdb156f1ea?s=128&d=identicon&r=PG&f=1", "display_name": "bluk", "link": "https://stackoverflow.com/users/6138593/bluk"}, "edited": false, "score": 1, "creation_date": 1604329610, "post_id": 56369251, "comment_id": 114307319, "body": "@bluk <code>T(P)</code> here is a function type. If we have the function <code>int f(double);</code>, then <code>Base&lt;decltype(f)&gt;</code> is the same as <code>Base&lt;int(double)&gt;</code>, and that type will use the partial specialization by deducing <code>T=int</code> and <code>P=double</code>."}], "tags": [], "owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "is_accepted": true, "score": 2, "last_activity_date": 1559168220, "creation_date": 1559168220, "answer_id": 56369251, "question_id": 56368183, "link": "https://stackoverflow.com/questions/56368183/template-specialization-and-inheritance-template-class-from-other-template-class/56369251#56369251", "title": "Template specialization and inheritance template class from other template class", "body": "<blockquote>\n  <ol>\n  <li>Class specialization <code>Derived&lt;T(P)&gt;</code> inherits from class <code>template&lt;typename T&gt; class Base</code> or from class <code>template&lt;typename T, typename P&gt; class Base&lt;T(P)&gt;</code>?</li>\n  </ol>\n</blockquote>\n\n<p>Technically, neither. A class or class template never inherits from a template, only from one specific base class type. That is, <code>Derived&lt;int(float&amp;)&gt;</code> inherits <code>Base&lt;int(float&amp;)&gt;</code>, and so on. That base class gets instantiated from whatever is the most specialized declaration associated with <code>Base</code> for those specific types. The importance of this distinction comes up if there are additional partial specializations or explicit specializations.</p>\n\n<p>If I change your example a bit,</p>\n\n<pre><code>template&lt;typename T&gt; // #1\nclass Base;\n\ntemplate&lt;typename T, typename P&gt; // #2\nclass Base&lt;T(P)&gt; {\npublic:\n    static const int mem1 = 1;\n};\n\ntemplate&lt;typename T&gt;\nclass Derived;\n\ntemplate&lt;typename T, typename P&gt;\nclass Derived&lt;T(P)&gt; : public Base&lt;T(P)&gt; {\n};\n\nclass SomethingElse {};\n\ntemplate&lt;typename P&gt; // #3\nclass Base&lt;SomethingElse(const P&amp;)&gt; {\npublic:\n    static const long long mem2 = 2;\n};\n\nusing ThingType = Derived&lt;SomethingElse(const std::string&amp;)&gt;;\nconst auto A = ThingType::mem1; // Error!\nconst auto B = ThingType::mem2; // OK\n</code></pre>\n\n<p>It's not correct to say that partial specialization <code>Derived&lt;T(P)&gt;</code> inherits partial specialization <code>Base&lt;T(P)&gt;</code>, since the example type <code>Derived&lt;SomethingElse(const std::string&amp;)&gt;</code> uses that <code>Derived</code> partial specialization, but doesn't use that <code>Base</code> partial specialization at all.  <code>Base&lt;T(P)&gt;</code> just means the template called <code>Base</code>, with whatever specialization definition for <code>Base</code> best matches the template argument <code>T(P)</code>.  The decision about what the base class <code>Base&lt;T(P)&gt;</code> means is made independently for each specific set of template arguments when each specialization of <code>Derived</code> is instantiated.</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>What the name of when I'm binding template parameters <code>T</code> and <code>P</code> of class specialization <code>Derived&lt;T(P)&gt;</code> with template parameter <code>T</code> of class Base.</li>\n  </ol>\n</blockquote>\n\n<p>I don't know of any term for this, other than that you are using a dependent compound type.  (Dependent = depends on one or more template parameters; Compound = the type <code>T(P)</code> involves the other types <code>T</code> and <code>P</code>.)  This also makes <code>Base&lt;T(P)&gt;</code> a dependent base class in the definition of <code>Derived&lt;T(P)&gt;</code>, meaning the compiler will not look there for plain identifiers, and you need to use <code>this-&gt;name</code> or <code>Base::name</code> to make such names valid.  It's also important that the template parameters are in \"deducible contexts\" within the specialization's template arguments.</p>\n"}], "owner": {"reputation": 171, "user_id": 6707172, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_-oJ4-GxV-Q/AAAAAAAAAAI/AAAAAAAAIeI/nKtIUIyXOs0/photo.jpg?sz=128", "display_name": "Dark Hell", "link": "https://stackoverflow.com/users/6707172/dark-hell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 534, "favorite_count": 0, "accepted_answer_id": 56369251, "answer_count": 2, "score": 2, "last_activity_date": 1559168220, "creation_date": 1559162357, "question_id": 56368183, "link": "https://stackoverflow.com/questions/56368183/template-specialization-and-inheritance-template-class-from-other-template-class", "title": "Template specialization and inheritance template class from other template class", "body": "<p>I have some questions about next code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename T&gt;\nclass Base;\n\ntemplate&lt;typename T, typename P&gt;\nclass Base&lt;T(P)&gt; {\n\n};\n\ntemplate&lt;typename T&gt;\nclass Derived;\n\ntemplate&lt;typename T, typename P&gt;\nclass Derived&lt;T(P)&gt; : public Base&lt;T(P)&gt; {\n\n};\n</code></pre>\n\n<ol>\n<li><p>Class specialization <code>Derived&lt;T(P)&gt;</code> inherits from class <code>template&lt;typename T&gt; class Base</code> or  from class <code>template&lt;typename T, typename P&gt; class Base&lt;T(P)&gt;</code>?</p></li>\n<li><p>What the name of when I'm binding template parameters <code>T</code> and <code>P</code> of class specialization <code>Derived&lt;T(P)&gt;</code> with template parameter <code>T</code> of <code>class Base</code>.</p></li>\n</ol>\n"}, {"tags": ["c++", "sorting", "vector", "operator-overloading"], "comments": [{"owner": {"reputation": 350, "user_id": 9723461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8fd01cd442e062d643682e3ac4d3b10?s=128&d=identicon&r=PG&f=1", "display_name": "MPops", "link": "https://stackoverflow.com/users/9723461/mpops"}, "edited": false, "score": 2, "creation_date": 1559162953, "post_id": 56368169, "comment_id": 99339464, "body": "using <code>&lt;</code> with vectors will do a lexicographic comparison. Not a numeric comparison. <a href=\"https://en.cppreference.com/w/cpp/container/vector/operator_cmp\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/vector/operator_cmp</a>   And because &quot;-19&quot; is lexicographically less than &quot;-199&quot;, well... you&#39;ll see the results you are getting."}, {"owner": {"reputation": 43, "user_id": 11574964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14db828964a65f0b3edf0b94a3fd116f?s=128&d=identicon&r=PG&f=1", "display_name": "Tamfub", "link": "https://stackoverflow.com/users/11574964/tamfub"}, "reply_to_user": {"reputation": 350, "user_id": 9723461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8fd01cd442e062d643682e3ac4d3b10?s=128&d=identicon&r=PG&f=1", "display_name": "MPops", "link": "https://stackoverflow.com/users/9723461/mpops"}, "edited": false, "score": 0, "creation_date": 1559163353, "post_id": 56368169, "comment_id": 99339615, "body": "Ok, the lexicographic comparison is not the desired action then. Is there another way to do what I want?"}, {"owner": {"reputation": 350, "user_id": 9723461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8fd01cd442e062d643682e3ac4d3b10?s=128&d=identicon&r=PG&f=1", "display_name": "MPops", "link": "https://stackoverflow.com/users/9723461/mpops"}, "edited": false, "score": 0, "creation_date": 1559163430, "post_id": 56368169, "comment_id": 99339638, "body": "Yes. Do the comparison manually (transform vector into integer, then compare?)"}], "answers": [{"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 43, "user_id": 11574964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14db828964a65f0b3edf0b94a3fd116f?s=128&d=identicon&r=PG&f=1", "display_name": "Tamfub", "link": "https://stackoverflow.com/users/11574964/tamfub"}, "edited": false, "score": 0, "creation_date": 1559165206, "post_id": 56368353, "comment_id": 99340201, "body": "You are welcome @Tambuf, and also welcome to Stack Overflow! I included a full working example, have fun!"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 2, "last_activity_date": 1559165812, "last_edit_date": 1559165812, "creation_date": 1559163203, "answer_id": 56368353, "question_id": 56368169, "link": "https://stackoverflow.com/questions/56368169/how-can-i-properly-use-and-operators-for-2-vectors-of-integers-when-the-firs/56368353#56368353", "title": "How can I properly use &lt; and &gt; operators for 2 vectors of integers when the first element of both are negative?", "body": "<p>As @MPops commented, using the overloaded operator <code>&lt;</code> with <code>std::vector</code> will do a <strong>lexicographical</strong> comparison, which is not what you want (a numerical comparison).</p>\n\n<p>Read more in the <a href=\"https://en.cppreference.com/w/cpp/container/vector/operator_cmp\" rel=\"nofollow noreferrer\">reference</a>.</p>\n\n<p>You need to do the numerical comparison of two vectors manually, by converting the <code>vector&lt;int&gt;</code> to an <code>int</code>, like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\ntemplate &lt;typename T&gt; int sgn(T val) {\n    return (T(0) &lt; val) - (val &lt; T(0));\n}\n\nint vectorToInt(std::vector&lt;int&gt; v) {\n  int result = 0;\n  if(!v.size()) return result;\n  result = result * 10 + v[0];\n  for (size_t i = 1; i &lt; v.size(); ++i) {\n    result = result * 10 + (v[i] * sgn(v[0]));\n  }\n  return result;\n}\n\nint main(void) {\n  std::vector&lt;int&gt; a_vec = {-1, 9};\n  int a = vectorToInt(a_vec);\n  std::vector&lt;int&gt; b_vec = {-1, 9, 9};\n  int b = vectorToInt(b_vec);\n  std::cout &lt;&lt; \"Comparing \" &lt;&lt; a &lt;&lt; \" with \" &lt;&lt; b &lt;&lt; std::endl;\n\n  if(a &lt; b)       std::cout &lt;&lt; \"a &lt; b\" &lt;&lt; std::endl;\n  else if(a &gt; b)  std::cout &lt;&lt; \"a &gt; b\" &lt;&lt; std::endl;\n  else            std::cout &lt;&lt; \"a = b\" &lt;&lt; std::endl;\n  return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Comparing -19 with -199\na &gt; b\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11574964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14db828964a65f0b3edf0b94a3fd116f?s=128&d=identicon&r=PG&f=1", "display_name": "Tamfub", "link": "https://stackoverflow.com/users/11574964/tamfub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 56368353, "answer_count": 1, "score": 4, "last_activity_date": 1559165812, "creation_date": 1559162280, "question_id": 56368169, "link": "https://stackoverflow.com/questions/56368169/how-can-i-properly-use-and-operators-for-2-vectors-of-integers-when-the-firs", "title": "How can I properly use &lt; and &gt; operators for 2 vectors of integers when the first element of both are negative?", "body": "<p>I'm writing a simple C++17 program that compares two vectors of integers. </p>\n\n<p>e.g., I have two vectors: <code>a</code> represents the number -1, <code>b</code> 25</p>\n\n<pre><code>std::vector&lt;int&gt; a = {-1};\nstd::vector&lt;int&gt; b = {2, 5};\nif(a &lt; b)       std::cout &lt;&lt; \"a &lt; b\" &lt;&lt; std::endl;\nelse if(a &gt; b)  std::cout &lt;&lt; \"a &gt; b\" &lt;&lt; std::endl;\nelse            std::cout &lt;&lt; \"a = b\" &lt;&lt; std::endl;\n</code></pre>\n\n<p>The output produced by the previous piece of code is <code>a &lt; b</code>, and it is correct.\nLet us consider now the following example:</p>\n\n<pre><code>std::vector&lt;int&gt; a = {-1, 9};\nstd::vector&lt;int&gt; b = {-1, 9, 9};\nif(a &lt; b)       std::cout &lt;&lt; \"a &lt; b\" &lt;&lt; std::endl;\nelse if(a &gt; b)  std::cout &lt;&lt; \"a &gt; b\" &lt;&lt; std::endl;\nelse            std::cout &lt;&lt; \"a = b\" &lt;&lt; std::endl;\n</code></pre>\n\n<p>Here the output is <code>a &lt; b</code> as well, but since -19 > -199 I would like it to be <code>a &gt; b</code>.</p>\n\n<p>There is a way to solve this? For example, I thought of converting the two vectors into integers and comparing them, but I can't figure out how to do that.</p>\n"}, {"tags": ["c++", "ffmpeg"], "comments": [{"owner": {"reputation": 27067, "user_id": 210785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a561cd4d29738e18d9e565a6265d86ac?s=128&d=identicon&r=PG", "display_name": "szatmary", "link": "https://stackoverflow.com/users/210785/szatmary"}, "edited": false, "score": 0, "creation_date": 1559168944, "post_id": 56368106, "comment_id": 99341217, "body": "It would be way easier to just use libflac directly."}, {"owner": {"reputation": 4902, "user_id": 491527, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/iru1n.jpg?s=128&g=1", "display_name": "Matin Kh", "link": "https://stackoverflow.com/users/491527/matin-kh"}, "reply_to_user": {"reputation": 27067, "user_id": 210785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a561cd4d29738e18d9e565a6265d86ac?s=128&d=identicon&r=PG", "display_name": "szatmary", "link": "https://stackoverflow.com/users/210785/szatmary"}, "edited": false, "score": 0, "creation_date": 1559169053, "post_id": 56368106, "comment_id": 99341246, "body": "It&#39;s not a part of ffmpeg, is it? I&#39;m afraid I do not have anything other than ffmpeg to use."}, {"owner": {"reputation": 27067, "user_id": 210785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a561cd4d29738e18d9e565a6265d86ac?s=128&d=identicon&r=PG", "display_name": "szatmary", "link": "https://stackoverflow.com/users/210785/szatmary"}, "edited": false, "score": 0, "creation_date": 1559169245, "post_id": 56368106, "comment_id": 99341288, "body": "<code>I&#39;m afraid I do not have anything other than ffmpeg to use</code> You can download it."}, {"owner": {"reputation": 4902, "user_id": 491527, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/iru1n.jpg?s=128&g=1", "display_name": "Matin Kh", "link": "https://stackoverflow.com/users/491527/matin-kh"}, "reply_to_user": {"reputation": 27067, "user_id": 210785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a561cd4d29738e18d9e565a6265d86ac?s=128&d=identicon&r=PG", "display_name": "szatmary", "link": "https://stackoverflow.com/users/210785/szatmary"}, "edited": false, "score": 0, "creation_date": 1559169297, "post_id": 56368106, "comment_id": 99341299, "body": "Yes, but not for this project, I cannot."}], "answers": [{"tags": [], "owner": {"reputation": 1374, "user_id": 6385870, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WcPaBJ4dA7E/AAAAAAAAAAI/AAAAAAAAACU/GqGqqqVbT9E/photo.jpg?sz=128", "display_name": "the kamilz", "link": "https://stackoverflow.com/users/6385870/the-kamilz"}, "is_accepted": false, "score": 1, "last_activity_date": 1559200103, "creation_date": 1559200103, "answer_id": 56373388, "question_id": 56368106, "link": "https://stackoverflow.com/questions/56368106/encoding-audio-data-using-ffmpeg/56373388#56373388", "title": "Encoding audio data using ffmpeg", "body": "<p>You are nearly there, follow this example: <a href=\"https://github.com/FFmpeg/FFmpeg/blob/master/doc/examples/encode_audio.c\" rel=\"nofollow noreferrer\">https://github.com/FFmpeg/FFmpeg/blob/master/doc/examples/encode_audio.c</a></p>\n\n<p>Answer to 1st question:\nThere you'll see <code>codec = avcodec_find_encoder(AV_CODEC_ID_MP2)</code>.<br>\nIn your case, you guessed it, it probably will be <code>codec = avcodec_find_encoder(AV_CODEC_ID_FLAC)</code> and check/fix other values accordingly.</p>\n\n<p>As for 2nd one... I'm sure you'll find out yourself, especially you must set this correctly (line 158) <code>c-&gt;sample_fmt = AV_SAMPLE_FMT_S16</code> according to what your <code>int8_t</code> array formatted.</p>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 4902, "user_id": 491527, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/iru1n.jpg?s=128&g=1", "display_name": "Matin Kh", "link": "https://stackoverflow.com/users/491527/matin-kh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1559200103, "creation_date": 1559161976, "question_id": 56368106, "link": "https://stackoverflow.com/questions/56368106/encoding-audio-data-using-ffmpeg", "title": "Encoding audio data using ffmpeg", "body": "<p>I am receiving a byte array (<code>int8_t*</code>) and I would like to use <a href=\"https://ffmpeg.org/\" rel=\"nofollow noreferrer\">FFMPEG</a> to encode it into FLAC. All the examples I found are reading data from files, which is not the case for me. Following the original documents (see <a href=\"http://ffmpeg.org/doxygen/trunk/encoding-example_8c-source.html\" rel=\"nofollow noreferrer\">here</a>), I came up with the following solution:</p>\n\n<pre><code>#include \"libavcodec/avcodec.h\"\n\n// ...\n\n// params:\n//  audioData: original audio data\n//  len: length of the byte array (audio data)\n//  sampleRate: sample rate of the original audio data\n//  frameSize: frame size of the original data\nuint8_t* encodeToFlac(uint8_t* audioData, int len, int sampleRate, int frameSize) {\n  uint8_t* convertedAudioData;\n\n  // Context information\n  AVCodecContext* context = avcodec_alloc_context();\n  context-&gt;bit_rate = 64000;\n  context-&gt;sample_rate = sampleRate;\n  context-&gt;channels = 2;\n  context-&gt;frame_size = frameSize;\n\n  short* samples = malloc(frameSize * 2 * context-&gt;channels);\n  int outAudioDataSize = len * 2;\n  convertedAudioData = malloc(outAudioDataSize);\n  int outSize = avcodec_encode_audio(c, convertedAudioData, outAudioDataSize, samples);\n\n  return convertedAudioData;\n}\n</code></pre>\n\n<p>I have two main issues with the above solution:</p>\n\n<ol>\n<li><p>I did not specify what the final encoding should be (for example, MP3, FLAC, etc), which makes me wonder if I'm using FFMPEG library correctly?</p></li>\n<li><p>Do I have all the necessary information about the source - original audio data? I am not certain if I have all the necessary information to perform the encoding.</p></li>\n</ol>\n"}, {"tags": ["c++", "assembly", "memory", "arm", "cortex-m"], "comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1559162407, "post_id": 56368081, "comment_id": 99339277, "body": "Does your chip support speculative prefetch?  I don&#39;t think so, but if it did it might be <a href=\"//stackoverflow.com/q/46118893\">ARM prefetch workaround</a> there they neglected to make I/O or other regions of physical address space not prefetchable.  (And so speculative loads or code-fetches from them were resulting in hard lockups.)"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1559178447, "post_id": 56368081, "comment_id": 99343213, "body": "It&#39;s possible that the debugger runs a startup script that loads various registers in the MCU, to prepare the MCU to run the code. When free running, you need to make sure that the boot code loads all of those registers, in the same order, with the same values."}, {"owner": {"reputation": 177, "user_id": 1180367, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8meDX.jpg?s=128&g=1", "display_name": "Kyle Oliveira", "link": "https://stackoverflow.com/users/1180367/kyle-oliveira"}, "edited": false, "score": 0, "creation_date": 1559191805, "post_id": 56368081, "comment_id": 99345665, "body": "I&#39;ve checked the datasheet and manual and I could not find any reference to speculative pre-fetch, despite being a good starting point... I&#39;ve noticed that when in free run, the last address held by PC before the HardFault is exactly the first address <b>in RAM</b> that the MCU tried to execute."}, {"owner": {"reputation": 177, "user_id": 1180367, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8meDX.jpg?s=128&g=1", "display_name": "Kyle Oliveira", "link": "https://stackoverflow.com/users/1180367/kyle-oliveira"}, "edited": false, "score": 1, "creation_date": 1559192083, "post_id": 56368081, "comment_id": 99345741, "body": "I highly doubt this <i>debug side-loaded boot code</i> mentioned by user3386109 is the reason for the faults. I say so because <b>I see the crash even when I bootup with the debugger</b>. <b>It only works if I set a breakpoint <i>right before the branch-and-link instruction</i> that brings the MCU to run in RAM space</b>, which I think is quite suspicious..."}, {"owner": {"reputation": 7207, "user_id": 410847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a354e99dd64adf823aa72c4ee22a1fc?s=128&d=identicon&r=PG", "display_name": "Turbo J", "link": "https://stackoverflow.com/users/410847/turbo-j"}, "edited": false, "score": 1, "creation_date": 1559209323, "post_id": 56368081, "comment_id": 99352440, "body": "Note that I would help if you specified the actual MCU rather than just saying &quot;ARM Cortex-M0+&quot;. Many vendors have known quirks which could explain your behaviour."}, {"owner": {"reputation": 177, "user_id": 1180367, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8meDX.jpg?s=128&g=1", "display_name": "Kyle Oliveira", "link": "https://stackoverflow.com/users/1180367/kyle-oliveira"}, "edited": false, "score": 0, "creation_date": 1559211552, "post_id": 56368081, "comment_id": 99353419, "body": "Good point Turbo J, I&#39;m currently working with a <b>Cypress S6E1C3 Series Arm Cortex M0+ FM0+ Microcontroller</b>."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1559212758, "post_id": 56368081, "comment_id": 99353964, "body": "Is there any mechanism that would let you find out <i>where</i> the HardFault happened?  Is it on the branch instruction itself (or code-fetch for the instruction after)?  Or does it run for a while before crashing?"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1559212838, "post_id": 56368081, "comment_id": 99353997, "body": "Is hardware failure a possibility?  Have you stress-tested the RAM with code running from flash?  Back-to-back instruction fetch might be stressing memory timings in a way that single-stepping isn&#39;t?"}, {"owner": {"reputation": 177, "user_id": 1180367, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8meDX.jpg?s=128&g=1", "display_name": "Kyle Oliveira", "link": "https://stackoverflow.com/users/1180367/kyle-oliveira"}, "edited": false, "score": 0, "creation_date": 1559213476, "post_id": 56368081, "comment_id": 99354308, "body": "Hey Peter Cordes, I&#39;m not sure where the crash happens but if I would have to guess, I would say it happens <b>after the branch is executed</b>. I say so because PC (R15) will always point to the address of the first instruction in RAM. and I also see that the link register (LR) has always the correct return address (in Flash). The crash happens always immediately and it is not like it ran for a while and then randomly crashed. I&#39;m not sure whether a hardware failure could be the reason, because I see the same problem when running this code in a second unit."}, {"owner": {"reputation": 177, "user_id": 1180367, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8meDX.jpg?s=128&g=1", "display_name": "Kyle Oliveira", "link": "https://stackoverflow.com/users/1180367/kyle-oliveira"}, "edited": false, "score": 0, "creation_date": 1559213514, "post_id": 56368081, "comment_id": 99354326, "body": "Peter Cordes, do you have any reference of pipeline and instruction timing in Arm?"}, {"owner": {"reputation": 177, "user_id": 1180367, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8meDX.jpg?s=128&g=1", "display_name": "Kyle Oliveira", "link": "https://stackoverflow.com/users/1180367/kyle-oliveira"}, "edited": false, "score": 0, "creation_date": 1559233709, "post_id": 56368081, "comment_id": 99364573, "body": "I have an update...!"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559247057, "post_id": 56368081, "comment_id": 99370114, "body": "To notify people when you reply, use <code>@username</code>."}], "answers": [{"tags": [], "owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 1, "last_activity_date": 1559250340, "last_edit_date": 1592644375, "creation_date": 1559247317, "answer_id": 56385043, "question_id": 56368081, "link": "https://stackoverflow.com/questions/56368081/hardfault-when-running-code-from-ram-in-cortexm0/56385043#56385043", "title": "HardFault when running code from RAM in CortexM0", "body": "<p><strong>Cortex-M <em>only</em> supports Thumb mode, not ARM mode</strong>, so telling your compiler to compiler for Cortex-M0+ guarantees that it will create Thumb2 code.</p>\n<p>That's why you need to set the low bit of your target address.</p>\n<blockquote>\n<p><a href=\"https://en.wikipedia.org/wiki/ARM_Cortex-M#Instruction_sets\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/ARM_Cortex-M#Instruction_sets</a></p>\n<p>Only Thumb-1 and Thumb-2 instruction sets are supported in Cortex-M architectures; the legacy 32-bit ARM instruction set isn't supported.</p>\n</blockquote>\n<p>If you actually look at the code bytes in memory, you'll see they're Thumb2 instructions.</p>\n<p><strong>The only question is how your debugger managed to make it <em>not</em> fault.</strong>  Perhaps it has to handle BLX specially anyway, and doesn't emulate the fault-if-switching-to-ARM-mode on Thumb-only microarchitectures behaviour.  Or maybe just handling the single-step interrupt ends up returning properly in Thumb mode.</p>\n<hr />\n<p>&quot;legacy&quot; is a bit of an overstatement for ARM mode in general, I think; I thought high-performance ARM chips (with large instruction caches) could still benefit from ARM mode getting more done with fewer instructions and easier access to more registers.  Anyway, that's just Wikipedia's phrasing.</p>\n"}, {"tags": [], "owner": {"reputation": 177, "user_id": 1180367, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8meDX.jpg?s=128&g=1", "display_name": "Kyle Oliveira", "link": "https://stackoverflow.com/users/1180367/kyle-oliveira"}, "is_accepted": true, "score": 1, "last_activity_date": 1559293951, "creation_date": 1559293951, "answer_id": 56392065, "question_id": 56368081, "link": "https://stackoverflow.com/questions/56368081/hardfault-when-running-code-from-ram-in-cortexm0/56392065#56392065", "title": "HardFault when running code from RAM in CortexM0", "body": "<p>The issue was in the branch address (as correctly pointed out by @PeterCordes). The branch to RAM was performed by the following code (slightly adjusted for this audience):</p>\n\n<pre><code>// Prepare address and Function Pointer\nuint32_t codeBufferAddress = reinterpret_cast&lt;uint32_t&gt;(&amp;buffer) + offset;\nvoid(*methodFromRAM)(void*) = reinterpret_cast&lt;void(*)(void*)&gt;(codeBufferAddress | 0x01);\n\n// Branch to RAM\n// thisPointer holds an object byte-stream...\n(*methodFromRAM)(reinterpret_cast&lt;void*&gt;(thisPointer));\n</code></pre>\n\n<p>Note that in line 3 <code>codeBufferAddress</code> is or'ed with <code>0x01</code> (<code>codeBufferAddress | 0x01</code>), which ensures that the branch will be taken in <em>Thumb Mode</em>. By the moment I posted this question, the value held by <code>codeBufferAddress</code> was <code>0x20003E40</code>, which clearly does not set the LSBit and thus would force the MCU to run in <em>ARM Mode</em>.</p>\n\n<p>I think the compiler would not be able to infer and adjust the branch mode, because the address is <em>dynamically generated</em>  (even though I think it could be a bit smarter and force all branches to run in <em>Thumb Mode</em>, since my MCU can only decode Thumb).</p>\n\n<p>Anyways, when running in step-by-step mode, I could not observe any changes in the target address, and for now I can only guess it forces the MCU to run in <em>Thumb Mode</em>... but this is only a guess. Any ideas?</p>\n\n<p>K.</p>\n"}], "owner": {"reputation": 177, "user_id": 1180367, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8meDX.jpg?s=128&g=1", "display_name": "Kyle Oliveira", "link": "https://stackoverflow.com/users/1180367/kyle-oliveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1172, "favorite_count": 1, "accepted_answer_id": 56392065, "answer_count": 2, "score": 5, "last_activity_date": 1559293951, "creation_date": 1559161830, "last_edit_date": 1559233692, "question_id": 56368081, "link": "https://stackoverflow.com/questions/56368081/hardfault-when-running-code-from-ram-in-cortexm0", "title": "HardFault when running code from RAM in CortexM0", "body": "<p>I'm currently developing firmware for an Arm Cortex-M0+ microcontroller and I'm facing a rather interesting issue. I'm not looking for any answers but rather would like to share the problem with other developers so I can (hopefully) shed some light on the issue I'm facing. I will describe it below:</p>\n\n<p>I have a program that dynamically loads (properly compiled and linked) code from an external Flash Chip, to be executed straight out of the MCU RAM. The interesting is that I can perfectly execute the RAM-loaded code when running in step-by-step (via debugger), but it will always crash [formally HardFault] when freely running. I've tried to disable all interrupts, I've double checked the instructions, memory addresses, byte alignments, everything, but I still cannot pinpoint a reason for the exception.</p>\n\n<p>Have some of you any hint of what could be happening? I'm very interested to know more about your experiences! Thanks,</p>\n\n<p><strong>Update 1 (30/05)</strong></p>\n\n<p><em>Free run</em> in this case, means not setting a breakpoint right before the branch to RAM. Whenever I step into the branch and execute the instructions in RAM it will run correctly and return. Wherever the breakpoint is not there (and thus the MCU goes zooming thought the branch) the HardFault is observed. Notice that it will crash even when booting up with the debugger engaged but not having the breakpoint set.</p>\n\n<p><strong>Update 2 (30/05)</strong></p>\n\n<p>I'm using a <strong>Cypress S6E1C3 Series Arm Cortex M0+ FM0+ Microcontroller</strong>.</p>\n\n<p><strong>Update 3 (30/05)</strong></p>\n\n<p>After digging around and playing with the code, I could get it to work properly! It however brought up more questions than answers for me. Reading the official ARM documentation about the BLX instruction (<a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0068b/CIHFJFDG.html\" rel=\"nofollow noreferrer\">BLX</a>) I found out that the LSBit of the branch address <em>determines the CPU instruction mode</em> (1 causes it to run in Thumb mode). By explicitly setting this bit, <strong>I get the code to always work, even in <em>free-run mode</em></strong>. The thing is, the code in RAM has not been compiled in Thumb mode, and there is not <em>apparent</em> reason why running the code step-by-step with the debugger would cause the instruction mode to change... Any ideas?</p>\n\n<p>K.</p>\n"}, {"tags": ["c++", "linux", "opencv", "qr-code"], "comments": [{"owner": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 0, "creation_date": 1559163302, "post_id": 56368035, "comment_id": 99339603, "body": "Looks like you just need to include a header file for <code>QRCodeDetector</code>. Are you using OpenCV 4.0?"}, {"owner": {"reputation": 415, "user_id": 10669327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6051fc808e6d6c453bf165e339d09a6a?s=128&d=identicon&r=PG&f=1", "display_name": "raj123", "link": "https://stackoverflow.com/users/10669327/raj123"}, "reply_to_user": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 0, "creation_date": 1559166666, "post_id": 56368035, "comment_id": 99340607, "body": "As this website shows QRCoderDetector is part of &lt;opencv2/objdetect.hpp&gt; header file which I included. <a href=\"https://docs.opencv.org/3.4/de/dc3/classcv_1_1QRCodeDetector.html\" rel=\"nofollow noreferrer\">docs.opencv.org/3.4/de/dc3/classcv_1_1QRCodeDetector.html</a>"}, {"owner": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 0, "creation_date": 1559167013, "post_id": 56368035, "comment_id": 99340697, "body": "Well yes but in <i>your</i> installation if you look at that header file does it in fact define <code>QRCodeDetector</code>? Have you checked?"}, {"owner": {"reputation": 415, "user_id": 10669327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6051fc808e6d6c453bf165e339d09a6a?s=128&d=identicon&r=PG&f=1", "display_name": "raj123", "link": "https://stackoverflow.com/users/10669327/raj123"}, "reply_to_user": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 0, "creation_date": 1559167789, "post_id": 56368035, "comment_id": 99340918, "body": "I am using OPENCV-2 .So what I have to include I cant getting it?Have you tried to compile this code?@barny"}, {"owner": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 1, "creation_date": 1559168062, "post_id": 56368035, "comment_id": 99340983, "body": "No I haven\u2019t. The example you link to refers to OpenCV version 4.0. The error is saying <code>QRCodeDetector</code> isn\u2019t defined. All I\u2019m asking you to do is to check that the header files which presumably should be defining it (if they are the same version as the example you link to) actually <i>do</i> define it. Is that so difficult? If they don\u2019t define <code>QRCodeDetector</code> then you <i>will</i> get a compilation error. Do the header files define <code>QRCodeDetector</code>?"}, {"owner": {"reputation": 415, "user_id": 10669327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6051fc808e6d6c453bf165e339d09a6a?s=128&d=identicon&r=PG&f=1", "display_name": "raj123", "link": "https://stackoverflow.com/users/10669327/raj123"}, "reply_to_user": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 0, "creation_date": 1559168315, "post_id": 56368035, "comment_id": 99341060, "body": "the header file(opencv2/objdetect.hpp) which I included is not having that class defined @barny"}, {"owner": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 1, "creation_date": 1559168861, "post_id": 56368035, "comment_id": 99341192, "body": "OK so you are not using the same version of opencv as the example: that\u2019s why it won\u2019t compile. Resolving that is up to you."}, {"owner": {"reputation": 415, "user_id": 10669327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6051fc808e6d6c453bf165e339d09a6a?s=128&d=identicon&r=PG&f=1", "display_name": "raj123", "link": "https://stackoverflow.com/users/10669327/raj123"}, "reply_to_user": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 0, "creation_date": 1559170089, "post_id": 56368035, "comment_id": 99341500, "body": "ok thanks I will look out it @barny"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 10699623, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LAeaUuudAHQ/AAAAAAAAAAI/AAAAAAAADjE/EhUK9D7e5sk/photo.jpg?sz=128", "display_name": "Muhammed Emin BA\u011eD\u0130GEN", "link": "https://stackoverflow.com/users/10699623/muhammed-emin-ba%c4%9ed%c4%b0gen"}, "is_accepted": false, "score": 0, "last_activity_date": 1586006689, "creation_date": 1586006689, "answer_id": 61028767, "question_id": 56368035, "link": "https://stackoverflow.com/questions/56368035/how-to-decode-qrcode-using-c-opencv-library-on-linux/61028767#61028767", "title": "How to decode QRCODE using C++ opencv library on Linux?", "body": "<p>First of all, code is compatible with OpenCV 4.0, so be sure that you are using OpenCV 4.0. If you are using OpenCV 4.0, you may have refered different version of OpenCV path in eclipse.</p>\n\n<p>For solution, there is two steps.</p>\n\n<p><strong>Step1</strong></p>\n\n<p>From Terminal, type <em>pkg-config --cflags opencv4</em>. Output will be like <em>I/usr/local/include/opencv4/opencv</em>. Copy output and paste it place which is shown in first link.</p>\n\n<p><a href=\"https://drive.google.com/open?id=1WSBEOaSF6JJvOiUSI_kop8wnRaK8TOIt\" rel=\"nofollow noreferrer\">https://drive.google.com/open?id=1WSBEOaSF6JJvOiUSI_kop8wnRaK8TOIt</a></p>\n\n<p><strong>Steps2</strong></p>\n\n<p>Again from terminal, type <em>pkg-config --libs opencv4</em>. Output will be like <em>L/usr/local/lib</em>. Copy output and paste it place which is shown in second link. Than add headers referances to Libraries(-l) section like shown in link.</p>\n\n<p><a href=\"https://drive.google.com/open?id=1VYJHNV10P8oj_pwaUh3GZJwWu8vDmUxA\" rel=\"nofollow noreferrer\">https://drive.google.com/open?id=1VYJHNV10P8oj_pwaUh3GZJwWu8vDmUxA</a></p>\n\n<p>This steps will be solution your problem.</p>\n"}], "owner": {"reputation": 415, "user_id": 10669327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6051fc808e6d6c453bf165e339d09a6a?s=128&d=identicon&r=PG&f=1", "display_name": "raj123", "link": "https://stackoverflow.com/users/10669327/raj123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1155, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1586006689, "creation_date": 1559161619, "last_edit_date": 1559168049, "question_id": 56368035, "link": "https://stackoverflow.com/questions/56368035/how-to-decode-qrcode-using-c-opencv-library-on-linux", "title": "How to decode QRCODE using C++ opencv library on Linux?", "body": "<p>I am working with opencv c++ library to decode Qrcode.Here I given sample test code which is from this website: <a href=\"https://www.learnopencv.com/opencv-qr-code-scanner-c-and-python/\" rel=\"nofollow noreferrer\">https://www.learnopencv.com/opencv-qr-code-scanner-c-and-python/</a></p>\n\n<p>When I am compiling this test program I am getting following error:</p>\n\n<pre><code>test.cc: In function \u2018int main(int, char**)\u2019:\ntest.cc:29:3: error: \u2018QRCodeDetector\u2019 was not declared in this scope\n   QRCodeDetector qrDecoder = QRCodeDetector::QRCodeDetector();\n   ^~~~~~~~~~~~~~\ntest.cc:33:22: error: \u2018qrDecoder\u2019 was not declared in this scope\n   std::string data = qrDecoder.detectAndDecode(inputImage, bbox, rectifiedImage)\n</code></pre>\n\n<p>How to resolve this error?</p>\n\n<pre><code>test.cc:\n//https://www.learnopencv.com/opencv-qr-code-scanner-c-and-python/\n#include &lt;opencv2/objdetect.hpp&gt;\n#include &lt;opencv2/imgcodecs.hpp&gt;\n#include &lt;opencv2/highgui/highgui.hpp&gt;\n#include &lt;opencv2/imgproc/imgproc.hpp&gt;\n#include &lt;iostream&gt;\n\nusing namespace cv;\nusing namespace std;\n\nvoid display(Mat &amp;im, Mat &amp;bbox)\n{\n  int n = bbox.rows;\n  for(int i = 0 ; i &lt; n ; i++)\n  {\n    line(im, Point2i(bbox.at&lt;float&gt;(i,0),bbox.at&lt;float&gt;(i,1)), Point2i(bbox.at&lt;float&gt;((i+1) % n,0), bbox.at&lt;float&gt;((i+1) % n,1)), Scalar(255,0,0), 3);\n  }\n  imshow(\"Result\", im);\n}\n\nint main(int argc, char* argv[])\n{\n  // Read image\n  Mat inputImage;\n\n  inputImage = imread(argv[1]);\n\n  QRCodeDetector qrDecoder = QRCodeDetector::QRCodeDetector();\n\n  Mat bbox, rectifiedImage;\n\n  std::string data = qrDecoder.detectAndDecode(inputImage, bbox, rectifiedImage);\n  if(data.length()&gt;0)\n  {\n    cout &lt;&lt; \"Decoded Data : \" &lt;&lt; data &lt;&lt; endl;\n\n    display(inputImage, bbox);\n    rectifiedImage.convertTo(rectifiedImage, CV_8UC3);\n    imshow(\"Rectified QRCode\", rectifiedImage);\n\n    waitKey(0);\n  }\n  else\n    cout &lt;&lt; \"QR Code not detected\" &lt;&lt; endl;\n}\n\n//compile\ng++ test.cc -o test `pkg-config opencv --cflags --libs`\n</code></pre>\n"}, {"tags": ["c++", "arrays", "initialization"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1559160911, "post_id": 56367858, "comment_id": 99338738, "body": "You may prefer to use <code>std::array&lt;std::array&lt;int, 10&gt;, 10&gt;</code> instead. It&#39;s self documenting like you want, and behaves as you expect, like other value types."}, {"owner": {"reputation": 1972, "user_id": 3738356, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e17701b63957cb2224001256ad355f6b?s=128&d=identicon&r=PG&f=1", "display_name": "interestedparty333", "link": "https://stackoverflow.com/users/3738356/interestedparty333"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1559160953, "post_id": 56367858, "comment_id": 99338748, "body": "Ah this is a good point.  Unfortunately, this is on a GPU, so none of the STL is available to me."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1559160955, "post_id": 56367858, "comment_id": 99338750, "body": "Note that Line 3 provides a pointer to <code>foo[0]</code> which is not what you seem to want from Line 1. It looks like you intend to make a copy of that array. If that&#39;s the case, Line 3 would behave very differently."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1559161029, "post_id": 56367858, "comment_id": 99338786, "body": "You should tag the question with whatever shader language you are using. It&#39;s not a C++ question, even if many shader languages look a lot like C++."}, {"owner": {"reputation": 3761, "user_id": 3982001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Fabio says Reinstate Monica", "link": "https://stackoverflow.com/users/3982001/fabio-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1559161323, "post_id": 56367858, "comment_id": 99338883, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/23850656/assigning-one-array-to-another-array-c\">Assigning one array to another array c++</a>"}, {"owner": {"reputation": 1972, "user_id": 3738356, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e17701b63957cb2224001256ad355f6b?s=128&d=identicon&r=PG&f=1", "display_name": "interestedparty333", "link": "https://stackoverflow.com/users/3738356/interestedparty333"}, "reply_to_user": {"reputation": 3761, "user_id": 3982001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Fabio says Reinstate Monica", "link": "https://stackoverflow.com/users/3982001/fabio-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1559161406, "post_id": 56367858, "comment_id": 99338914, "body": "thx @fabioturati Here&#39;s the longer version of that one <a href=\"https://stackoverflow.com/questions/4810664/how-do-i-use-arrays-in-c?rq=1\" title=\"how do i use arrays in c\">stackoverflow.com/questions/4810664/&hellip;</a>"}, {"owner": {"reputation": 1972, "user_id": 3738356, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e17701b63957cb2224001256ad355f6b?s=128&d=identicon&r=PG&f=1", "display_name": "interestedparty333", "link": "https://stackoverflow.com/users/3738356/interestedparty333"}, "edited": false, "score": 0, "creation_date": 1559161536, "post_id": 56367858, "comment_id": 99338962, "body": "@ Fran&#231;ois Andrieux I think your point is that I&#39;m accidentally invoking a copy operator for the array, which wasn&#39;t my intention.  I see how the semantics of &quot;copy the object/array&quot; could make sense.  Will have to read more."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1559161654, "post_id": 56367858, "comment_id": 99339009, "body": "Simplified example: <code>int arr[5]; int arr2[5] = arr;</code> &lt;- error. You can&#39;t copy arrays in C or C++."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1559161721, "post_id": 56367858, "comment_id": 99339036, "body": "@Fran&#231;oisAndrieux looks like valid C++ code (compilation error notwithstanding) to me?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1559161727, "post_id": 56367858, "comment_id": 99339038, "body": "@ragerdl If you just want a reference to an array, you want <code>int (&amp;bar)[10] = foo[0];</code>. Here <code>bar</code> is a reference to a <code>int[10]</code>, initialized to the array <code>foo[0]</code>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559161749, "post_id": 56367858, "comment_id": 99339043, "body": "@formerlyknownas_463035818 no, your example is different."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1559161770, "post_id": 56367858, "comment_id": 99339054, "body": "@SergeyA Yeah but OP is saying they can&#39;t use all the language features because they will run the code on a GPU. That usually means it&#39;s a shader, whose code looks a lot like C and C++. If that&#39;s the case, the C++ tag is misleading and it would be important to tag the actual language used."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1559161818, "post_id": 56367858, "comment_id": 99339078, "body": "@SergeyA I got confused which error the question actually is about. my example was for line 2"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1559161862, "post_id": 56367858, "comment_id": 99339094, "body": "@Fran&#231;oisAndrieux oh, it is in the comments, I missed it."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559161955, "post_id": 56367858, "comment_id": 99339121, "body": "@formerlyknownas_463035818 still no, because <code>foo[0]</code> is an array, while <code>0</code> in your case is not."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1559161956, "post_id": 56367858, "comment_id": 99339122, "body": "@SergeyA meh my confusion was worse, sorry, I&#39;ll have a beer, cheers :P"}, {"owner": {"reputation": 1972, "user_id": 3738356, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e17701b63957cb2224001256ad355f6b?s=128&d=identicon&r=PG&f=1", "display_name": "interestedparty333", "link": "https://stackoverflow.com/users/3738356/interestedparty333"}, "edited": false, "score": 0, "creation_date": 1559163239, "post_id": 56367858, "comment_id": 99339579, "body": "Thanks all!  I incorporated the feedback into an answer.  I also included an explanation about the source of my confusion in that answer.  Thanks again!"}], "answers": [{"tags": [], "owner": {"reputation": 1480, "user_id": 9248466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PruMp.jpg?s=128&g=1", "display_name": "Ghasem Ramezani", "link": "https://stackoverflow.com/users/9248466/ghasem-ramezani"}, "is_accepted": false, "score": -1, "last_activity_date": 1559161641, "creation_date": 1559161641, "answer_id": 56368039, "question_id": 56367858, "link": "https://stackoverflow.com/questions/56367858/subarray-assignment-initialization-with-expected-for-aggregate-object-e/56368039#56368039", "title": "Subarray assignment: initialization with &quot;{...}&quot; expected for aggregate object error", "body": "<p>when you don't specify the array size (in line 1). the compiler specifies it for you. and for this you have to do this:</p>\n\n<pre><code>/* Line 0 */    int foo[10][10];\n/* Line 1 */    int foo_alias_compile_error[] = {foo[0]};\n</code></pre>\n\n<p>but it still has a problem. when compile that code:</p>\n\n<pre><code> $ g++ error.cpp\n $ error.cpp:4:28: error: invalid conversion from \u2018int*\u2019 to \u2018int\u2019 [-fpermissive]\n $    4 |     int fooError[] = {foo[0]};\n $      |                       ~~~~~^\n $      |                            |\n $      |                            int*\n</code></pre>\n\n<p>because of <code>foo[0]</code> is a pointer, and point to first row of your matrix (in line 1). you can do this:</p>\n\n<pre><code>/* Line 0 */    int foo[10][10];\n/* Line 1 */    int foo_alias_compile_error[] = {foo[0][0]};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1559161953, "post_id": 56368090, "comment_id": 99339119, "body": "This explains the problem but doesn&#39;t really propose a solution. So I guess I&#39;ll repeat my comment here : If you just want a reference to an array, you want <code>int (&amp;bar)[10] = foo[0];</code>. Here <code>bar</code> is a reference to a <code>int[10]</code>, initialized to the array <code>foo[0]</code>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1559162076, "post_id": 56368090, "comment_id": 99339166, "body": "I think, you need to read a good C++ book instead of learning the language by try and error. A curated list can be found here: <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\" title=\"the definitive c book guide and list\">stackoverflow.com/questions/388242/&hellip;</a>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1559162171, "post_id": 56368090, "comment_id": 99339194, "body": "@Fran&#231;oisAndrieux or even <code>auto&amp; ref = foo[0];</code>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559162193, "post_id": 56368090, "comment_id": 99339201, "body": "an <code>int</code> is never appropriately named &quot;alias&quot;, maybe you should take a look at references"}, {"owner": {"reputation": 3761, "user_id": 3982001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Fabio says Reinstate Monica", "link": "https://stackoverflow.com/users/3982001/fabio-says-reinstate-monica"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1559162248, "post_id": 56368090, "comment_id": 99339224, "body": "Ahhhh, so you wanted an alias! Yes, it&#39;s even part of the variables&#39; names, but I hadn&#39;t really understood it until I read this. Then I second @Fran&#231;oisAndrieux: what you want is called a reference, which uses the <code>&amp;</code>, and you have to use his syntax. I&#39;m afraid the duplicate I&#39;ve proposed indicates why you get an error, but it doesn&#39;t explain how to do what you want. Well, you could update your question making it clear that you are trying to get an alias!"}], "tags": [], "owner": {"reputation": 1972, "user_id": 3738356, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e17701b63957cb2224001256ad355f6b?s=128&d=identicon&r=PG&f=1", "display_name": "interestedparty333", "link": "https://stackoverflow.com/users/3738356/interestedparty333"}, "is_accepted": true, "score": 0, "last_activity_date": 1559189786, "last_edit_date": 1559189786, "creation_date": 1559161899, "answer_id": 56368090, "question_id": 56367858, "link": "https://stackoverflow.com/questions/56367858/subarray-assignment-initialization-with-expected-for-aggregate-object-e/56368090#56368090", "title": "Subarray assignment: initialization with &quot;{...}&quot; expected for aggregate object error", "body": "<p>One might hope to think of Line 1 as creating a reference for the 0th entry of <code>foo</code>.  However, that's not how C++ works.  Rather, the assignment operator (<code>=</code>) is invoking a copy operation.  So, C++ is interpreting Line 1 as a directive to copy the elements of <code>foo[0]</code> into a new array inappropriately named <code>foo_alias_compile_error</code>.</p>\n\n<p>This isn't what was meant -- one wanted a reference, not a copy.  So, it's good that C++ happens to have caused an error for an unrelated reason and saved one from oneself.</p>\n\n<p>A viable solution is suggested by @Fran\u00e7oisAndrieux.  Here's a fuller example showing that a reference (not a copy) can be made with <code>int (&amp;foo_reference)[10] = foo[0];</code>.</p>\n\n<pre><code>int foo[10][10];\nfor (int i = 0; i &lt; 10; ++i) {\n    for (int j = 0; j &lt; 10; ++j) {\n        foo[i][j] = i + j * 10;\n    }\n}\nint (&amp;foo_reference)[10] = foo[0];\n\nfor (int j = 0; j &lt; 10; ++j) {\n    foo_reference[j] = 100 + j;\n}\n\nfor (int i = 0; i &lt; 10; ++i) {\n    printf(\"foo   [0][%i] is %i\\n\", i, foo[0][i]);\n    printf(\"foo_refer[%i] is %i\\n\", i, foo_reference[i]);\n}\n</code></pre>\n\n<p><strong>Output Snippet</strong></p>\n\n<pre><code>foo   [0][0] is 100\nfoo_alias[0] is 100\nfoo   [0][1] is 101\nfoo_alias[1] is 101\nfoo   [0][2] is 102\nfoo_alias[2] is 102\nfoo   [0][3] is 103\nfoo_alias[3] is 103\n</code></pre>\n\n<p><strong>Side-note</strong></p>\n\n<p>It's worth mentioning that functions that take arrays as arguments implicitly convert their array arguments into pointers (as is shown in Line 3).  So, that's one reason why one might incorrectly think something like Line 1 should work.</p>\n\n<p>In other words, the following code</p>\n\n<pre><code>void barz(int arg[]) {\n    arg[2] = 99999;\n}\n\nint another_array[] = {0, 1, 2, 3, 4};\nbarz(another_array);\nprintf(\"another_array[2] is %i\\n\", another_array[2]);\n</code></pre>\n\n<p>\"Correctly\" prints <code>99999</code>, not <code>2</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1559190283, "creation_date": 1559190283, "answer_id": 56371598, "question_id": 56367858, "link": "https://stackoverflow.com/questions/56367858/subarray-assignment-initialization-with-expected-for-aggregate-object-e/56371598#56371598", "title": "Subarray assignment: initialization with &quot;{...}&quot; expected for aggregate object error", "body": "<p>The initializer in an array definition (C-style array, that is) <strong>must</strong> be a braced list.</p>\n\n<p>This rule covers both of your Line 1 and Line 2, where you provide something that isn't a braced list and therefore the code is incorrect.</p>\n\n<p>Further information: when you do provide a braced list, then each element of the list is taken as the initializer for <strong>an</strong> element of the array.  As a corollary, it's not possible to supply a single initializer which causes multiple array elements to be set by it.</p>\n\n<p>This rule nearly applies recursively; if you have an array of arrays, then the initializer should be a braced list of braced lists. However there is a rule that nested braces can be omitted in some cases (and the code will behave as if full bracing had been provided). For example <code>int x[2][2] = { 1, 2, 3, 4 };</code> is allowed and behaves like <code>int x[2][2] = { {1, 2}, {3, 4} };</code>. </p>\n"}], "owner": {"reputation": 1972, "user_id": 3738356, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e17701b63957cb2224001256ad355f6b?s=128&d=identicon&r=PG&f=1", "display_name": "interestedparty333", "link": "https://stackoverflow.com/users/3738356/interestedparty333"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 56368090, "answer_count": 3, "score": 1, "last_activity_date": 1559190283, "creation_date": 1559160826, "last_edit_date": 1559162372, "question_id": 56367858, "link": "https://stackoverflow.com/questions/56367858/subarray-assignment-initialization-with-expected-for-aggregate-object-e", "title": "Subarray assignment: initialization with &quot;{...}&quot; expected for aggregate object error", "body": "<p>What's a good explanation for the error on Line 1?</p>\n\n<pre><code>/* Line 0 */    int foo[10][10];\n/* Line 1 */    int foo_alias_compile_error[] = foo[0];\n/* Line 2 */    int foo_alias_also_errors[10] = foo[0];\n/* Line 3 */    int * foo_alias_works = foo[0];\n</code></pre>\n\n<p>The error on Line 2 doesn't really bother me, because I don't need to be able to repeat myself and re-declare the size of the array.  However, the error on Line 1 (<em>initialization with \"{...}\" expected for aggregate object</em>) kind of confuses me.  I get that the <code>int foo_alias_compile_error[]</code> is probably the \"aggregate object\".  I just don't get why the language is setup for that not to work.  I understand why Line 3 works, but it kind of feels unrepresentative -- it's an array, so I'd rather self-document it as an array.</p>\n"}, {"tags": ["python", "c++", "pybind11"], "answers": [{"tags": [], "owner": {"reputation": 3137, "user_id": 170413, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c2574774985d332827840f73fbd3622e?s=128&d=identicon&r=PG", "display_name": "eacousineau", "link": "https://stackoverflow.com/users/170413/eacousineau"}, "is_accepted": false, "score": 0, "last_activity_date": 1560859299, "creation_date": 1560859299, "answer_id": 56648670, "question_id": 56367837, "link": "https://stackoverflow.com/questions/56367837/downcast-to-pybind11-derived-class/56648670#56648670", "title": "Downcast to pybind11 derived class", "body": "<p>I think that you're probably suffering from this suite of problems:</p>\n\n<p><a href=\"https://github.com/pybind/pybind11/issues/1774\" rel=\"nofollow noreferrer\">https://github.com/pybind/pybind11/issues/1774</a></p>\n\n<p>Ultimately, because you're just returning <code>MyState</code> straight out the gate, which then goes straight to C++, the Python interpreter loses track of your instance, and goes ahead and garbage collects the Python-portion of the object, which is why your object ends up getting kinda <a href=\"https://en.wikipedia.org/wiki/Object_slicing\" rel=\"nofollow noreferrer\">sliced</a>.</p>\n\n<p>Potential solutions:</p>\n\n<ul>\n<li>Stash a reference to your return <code>MyState</code>,at least long enough for the Python interpreter to get a reference again.\n\n<ul>\n<li>e.g. change <code>return MyState(...)</code> to <code>self._stashed_state = MyState(...); return self._stashed_state</code></li>\n</ul></li>\n<li>See if you can somehow <code>incref</code> on the Python version of your class in C++ (yuck, but it'll work)</li>\n<li>Review the workarounds listed in the aforementioned issues (can't remember all of 'em)</li>\n<li>Use our fork of <code>pybind11</code>, which handles this, but also drags in other stuff: <a href=\"https://github.com/YannickJadoul/pybind11-cleanup/blob/be4c7a38801d351bdb1b9b47e973a10a5197fc3a/FORKS.md\" rel=\"nofollow noreferrer\">overview for RobotLocomotion/pybind11</a></li>\n</ul>\n\n<p>You may also want to post on one of the existing issues mentioning that you encountered this problem as well (just so that it can be tracked).</p>\n"}], "owner": {"reputation": 3118, "user_id": 1253415, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/87096d37b6aed093f1b142c6a9bfae91?s=128&d=identicon&r=PG", "display_name": "jcai", "link": "https://stackoverflow.com/users/1253415/jcai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 487, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560859299, "creation_date": 1559160758, "question_id": 56367837, "link": "https://stackoverflow.com/questions/56367837/downcast-to-pybind11-derived-class", "title": "Downcast to pybind11 derived class", "body": "<p>I'm using the \"<a href=\"https://pybind11.readthedocs.io/en/stable/advanced/classes.html\" rel=\"nofollow noreferrer\">Overriding virtual functions in Python</a>\" feature of pybind11 to create Python classes that inherit from C++ abstract classes. I have a C++ class <code>State</code> which is subclassed in Python as <code>MyState</code>. In this situation I have some <code>MyState</code> object that lost its type information and Python thinks it's a <code>State</code>. I need to downcast it back to <code>MyState</code> in Python code and I don't know a good way to do this.</p>\n\n<p>Here's the C++ example code:</p>\n\n<pre><code>#include &lt;memory&gt;\n\n#include &lt;pybind11/pybind11.h&gt;\n\nnamespace py = pybind11;\n\n// ========== State ==========\n\nclass State {\n public:\n  virtual ~State() = default;\n\n  virtual void dump() = 0;\n};\n\nusing StatePtr = std::shared_ptr&lt;State&gt;;\n\nclass PyState : public State {\n public:\n  using State::State;\n\n  void dump() override {\n    PYBIND11_OVERLOAD_PURE(void, State, dump);\n  }\n};\n\n// ========== Machine ==========\n\nclass Machine {\n public:\n  virtual ~Machine() = default;\n\n  virtual StatePtr begin() = 0;\n\n  virtual StatePtr step(const StatePtr&amp;) = 0;\n};\n\nusing MachinePtr = std::shared_ptr&lt;Machine&gt;;\n\nclass PyMachine : public Machine {\n public:\n  using Machine::Machine;\n\n  StatePtr begin() override {\n    PYBIND11_OVERLOAD_PURE(StatePtr, Machine, begin);\n  }\n\n  StatePtr step(const StatePtr&amp; state) override {\n    PYBIND11_OVERLOAD_PURE(StatePtr, Machine, step, state);\n  }\n};\n\n// ========== run ==========\n\nvoid run(const MachinePtr&amp; machine) {\n  StatePtr state = machine-&gt;begin();\n  for (int i = 0; i &lt; 5; ++i) {\n    state = machine-&gt;step(state);\n    state-&gt;dump();\n  }\n}\n\n// ========== pybind11 ==========\n\nPYBIND11_MODULE(example, m) {\n  py::class_&lt;State, StatePtr, PyState&gt;(m, \"State\").def(py::init&lt;&gt;());\n  py::class_&lt;Machine, MachinePtr, PyMachine&gt;(m, \"Machine\")\n      .def(py::init&lt;&gt;())\n      .def(\"begin\", &amp;Machine::begin)\n      .def(\"step\", &amp;Machine::step);\n  m.def(\"run\", &amp;run, \"Run the machine\");\n}\n</code></pre>\n\n<p>And the Python code:</p>\n\n<pre><code>#!/usr/bin/env python3\n\nfrom example import Machine, State, run\n\n\nclass MyState(State):\n    def __init__(self, x):\n        State.__init__(self)\n        self.x = x\n\n    def dump(self):\n        print(self.x)\n\n\nclass MyMachine(Machine):\n    def __init__(self):\n        Machine.__init__(self)\n\n    def begin(self):\n        return MyState(0)\n\n    def step(self, state):\n        # problem: when called from C++, `state` is an `example.State`\n        # instead of `MyState`. In order to access `state.x` we need\n        # some way to downcast it...\n        return MyState(state.x + 1)\n\n\nmachine = MyMachine()\n\nprint(\"running machine with python\")\nstate = machine.begin()\nfor _ in range(5):\n    state = machine.step(state)\n    state.dump()\n\nprint(\"running machine with C++\")\nrun(machine)  # error\n</code></pre>\n\n<p>Error message:</p>\n\n<pre><code>running machine with python\n1\n2\n3\n4\n5\nrunning machine with C++\nTraceback (most recent call last):\n  File \"&lt;string&gt;\", line 38, in &lt;module&gt;\n  File \"&lt;string&gt;\", line 36, in __run\n  File \"/usr/local/fbcode/platform007/lib/python3.6/runpy.py\", line 193, in _run_module_as_main\n    \"__main__\", mod_spec)\n  File \"/usr/local/fbcode/platform007/lib/python3.6/runpy.py\", line 85, in _run_code\n    exec(code, run_globals)\n  File \"/data/users/jcai/fbsource/fbcode/buck-out/dev/gen/experimental/jcai/pybind/run_example#link-tree/run_example.py\", line 38, in &lt;module&gt;\n    run(machine)  # error\n  File \"/data/users/jcai/fbsource/fbcode/buck-out/dev/gen/experimental/jcai/pybind/run_example#link-tree/run_example.py\", line 26, in step\n    return MyState(state.x + 1)\nAttributeError: 'example.State' object has no attribute 'x'\n</code></pre>\n\n<p>I do have a hacky workaround where I basically keep a \"downcast map\" <code>std::unordered_map&lt;State*, py::object&gt;</code> and register every created <code>MyState</code> with it. But I prefer not to resort to such things.</p>\n"}, {"tags": ["c++", "mysql", "linux", "cmake"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559160658, "post_id": 56367629, "comment_id": 99338641, "body": "The error you got is because the absence of the linking to the needed library. Do you mean that the error is caused by <code>find_library</code> approach? Otherwise, what do you mean by &quot;but dont work&quot; when describe that approach?"}, {"owner": {"reputation": 235, "user_id": 3019720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a97455500463581ba6727bb698b6d2dd?s=128&d=identicon&r=PG", "display_name": "Samuaz", "link": "https://stackoverflow.com/users/3019720/samuaz"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559161003, "post_id": 56367629, "comment_id": 99338772, "body": "the error is the same with or without find_library"}], "answers": [{"tags": [], "owner": {"reputation": 235, "user_id": 3019720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a97455500463581ba6727bb698b6d2dd?s=128&d=identicon&r=PG", "display_name": "Samuaz", "link": "https://stackoverflow.com/users/3019720/samuaz"}, "is_accepted": true, "score": 0, "last_activity_date": 1559571674, "creation_date": 1559571674, "answer_id": 56429270, "question_id": 56367629, "link": "https://stackoverflow.com/questions/56367629/mysqlcppconn8-and-cmake-error-at-build-in-linux/56429270#56429270", "title": "Mysqlcppconn8 and cmake error at build in linux", "body": "<p>Fixed by adding the library with extension</p>\n\n<pre><code>if (BUILD_MODE STREQUAL \"Docker\")\n    message(\"***************************** USING STATIC LIBS **************************************\")\n    add_compile_definitions(STATIC_CONCPP)\n    set(BUILD_SHARED_LIBS OFF)\n    set(CMAKE_EXE_LINKER_FLAGS ${CMAKE_EXE_LINKER_FLAGS} \"-static\")\n    set(DCMAKE_FIND_LIBRARY_SUFFIXES .a)\n    find_library(PISTACHE_LIB libpistache.a)\n    find_library(MYSQL_LIB libmysqlcppconn8-static.a)\n    set(MY_LIBS ${PISTACHE_LIB} ${MYSQL_LIB})\nelse()\n    message(\"***************************** USING SHARED LIBS **************************************\")\n    find_library(PISTACHE_LIB libpistache.so)\n    find_library(MYSQL_LIB libmysqlcppconn8.so)\n    set(MY_LIBS ${PISTACHE_LIB} ${MYSQL_LIB})\nendif (BUILD_MODE STREQUAL \"Docker\")\nunset(BUILD_MODE CACHE)\n</code></pre>\n"}], "owner": {"reputation": 235, "user_id": 3019720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a97455500463581ba6727bb698b6d2dd?s=128&d=identicon&r=PG", "display_name": "Samuaz", "link": "https://stackoverflow.com/users/3019720/samuaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 56429270, "answer_count": 1, "score": 0, "last_activity_date": 1559571674, "creation_date": 1559159658, "last_edit_date": 1559278014, "question_id": 56367629, "link": "https://stackoverflow.com/questions/56367629/mysqlcppconn8-and-cmake-error-at-build-in-linux", "title": "Mysqlcppconn8 and cmake error at build in linux", "body": "<p>I'm trying to build simple example with new <code>libmysqlcppconn</code> version 8 using <code>cmake</code>, I download the connector and build and install from source. But I get error when I try to build my helloworld using <code>cmake</code> or <code>Clion</code> run</p>\n\n<pre><code>/usr/bin/ld: CMakeFiles/hellogcp.dir/src/main.cpp.o: en la funci\u00f3n `mysqlx::abi2::r0::internal::Result_common&lt;mysqlx::abi2::r0::internal::Result_detail&gt;::~Result_common()':\n/usr/include/mysqlx/devapi/result.h:71: referencia a `mysqlx::abi2::r0::internal::Result_detail::~Result_detail()' sin definir\n/usr/bin/ld: CMakeFiles/hellogcp.dir/src/main.cpp.o: en la funci\u00f3n `mysqlx::abi2::r0::internal::Result_common&lt;mysqlx::abi2::r0::internal::Result_detail&gt;::~Result_common()':\n/usr/include/mysqlx/devapi/result.h:71: referencia a `mysqlx::abi2::r0::internal::Result_detail::~Result_detail()' sin definir\n/usr/bin/ld: CMakeFiles/hellogcp.dir/src/main.cpp.o: en la funci\u00f3n `mysqlx::abi2::r0::Result::~Result()':\n/usr/include/mysqlx/devapi/result.h:71: referencia a `mysqlx::abi2::r0::internal::Result_detail::~Result_detail()' sin definir\n/usr/bin/ld: CMakeFiles/hellogcp.dir/src/main.cpp.o: en la funci\u00f3n `mysqlx::abi2::r0::Result::~Result()':\n/usr/include/mysqlx/devapi/result.h:71: referencia a `mysqlx::abi2::r0::internal::Result_detail::~Result_detail()' sin definir\n</code></pre>\n\n<p>I test with </p>\n\n<pre><code>find_library(MYSQL_LIB mysqlcppconn8)\ntarget_link_libraries(${PROJECT_NAME} ${MYSQL_LIB})\n</code></pre>\n\n<p>But the error is the same with or without <code>find_library</code>.</p>\n\n<p>If I use:</p>\n\n<pre><code>set(EXTRA_LIBRARY \"mysqlcppconn8\")\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>/usr/bin/ld: can not be found -lmysqlcppconn8\n/usr/bin/ld: can not be found -lmysqlcppconn8\n</code></pre>\n\n<p>with:</p>\n\n<blockquote>\n  <p>g++ -std=c++11 -I .../include -L .../lib64 src/main.cpp -lmysqlcppconn8 -o app</p>\n</blockquote>\n\n<p>Builds perfectly. But if I remove <code>-lmysqlcppconn8</code>, I get the same error than <code>cmake</code>.</p>\n\n<p>How can I add the <code>-lmysqlcppconn8</code> to <code>cmake</code>? </p>\n"}, {"tags": ["c++", "clang", "c++17", "boost-variant"], "comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 7, "creation_date": 1559159662, "post_id": 56367480, "comment_id": 99338256, "body": "Boost <a href=\"https://github.com/boostorg/variant/commit/dd728220b00772cee5d3aea5850a2bb09eecc66b#diff-e8948f8833a40a3c873b7f8d4ff5f9d7\" rel=\"nofollow noreferrer\">fixed</a> this in 1.70. It&#39;s also discussed <a href=\"https://reviews.llvm.org/D53860\" rel=\"nofollow noreferrer\">here</a>."}], "answers": [{"comments": [{"owner": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "edited": false, "score": 6, "creation_date": 1559159766, "post_id": 56367566, "comment_id": 99338297, "body": "Perfect, that&#39;s what I was looking for: the widened definition of aggregate is the culprit."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1559196188, "post_id": 56367566, "comment_id": 99346791, "body": "Is clang right to be right? What is the accessibility context of the subobject initializer? There is a core language issue about that: <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#2244\" rel=\"nofollow noreferrer\">issue #2244</a>. As a coder, I would prefer that name accessibility checks for <a href=\"http://eel.is/c++draft/dcl.init.aggr#5.1\" rel=\"nofollow noreferrer\">dcl.init.aggr/5.1</a> and <a href=\"http://eel.is/c++draft/dcl.init.aggr#5.2\" rel=\"nofollow noreferrer\">dcl.init.aggr/5.2</a> are done, in both cases, in the context of the aggregate."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 2, "creation_date": 1559200606, "post_id": 56367566, "comment_id": 99348693, "body": "I heard that parentheses and braces are unified in C++20. Does that affect the validity of the fix?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1559223247, "post_id": 56367566, "comment_id": 99358923, "body": "@L.F. No, it does not. <code>D()</code> being <a href=\"http://eel.is/c++draft/dcl.init#17.4\" rel=\"nofollow noreferrer\">value initialization</a> precedes the <a href=\"http://eel.is/c++draft/dcl.init#17.6.2.2\" rel=\"nofollow noreferrer\">new bullet</a>."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1559223375, "post_id": 56367566, "comment_id": 99358996, "body": "@Oliv I think clang is right to be right. I don&#39;t know what the accessibility direction is."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1559230559, "post_id": 56367566, "comment_id": 99362952, "body": "Slightly wrong reduction. The issue in C++17 is the dtor (<code>static_visitor</code> is a C++17 aggregate itself, so the protectedness of the ctor doesn&#39;t matter). In C++20, both are problems and the boost fix (which fixed the dtor only) will break again, which makes this a nice example of the C++20 OMG-these-contrived-examples-are-so-surprising-we-must-fix-i&zwnj;&#8203;t change breaking things."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1559232570, "post_id": 56367566, "comment_id": 99364049, "body": "@T.C. gcc and clang both complain about <a href=\"https://godbolt.org/z/G7sq0C\" rel=\"nofollow noreferrer\">the ctor</a>?"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1559232772, "post_id": 56367566, "comment_id": 99364165, "body": "They both complain about the ctor on your (slightly wrong) reduced example."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1559233584, "post_id": 56367566, "comment_id": 99364510, "body": "@T.C. Oh I see what you mean now. I guess it&#39;s a slightly different problem, with the same underlying reason."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 61, "last_activity_date": 1559159396, "creation_date": 1559159396, "answer_id": 56367566, "question_id": 56367480, "link": "https://stackoverflow.com/questions/56367480/should-this-code-fail-to-compile-in-c17/56367566#56367566", "title": "Should this code fail to compile in C++17?", "body": "<p>clang is correct here. Here's a reduced example:</p>\n\n<pre><code>struct B {\nprotected:\n    B() { }\n};\n\nstruct D : B { };\n\nauto d = D{};\n</code></pre>\n\n<p>In C++14, <code>D</code> is <em>not</em> an aggregate because it has a base class, so <code>D{}</code> is \"normal\" (non-aggregate) initialization which invokes <code>D</code>'s default constructor, which in turn invokes <code>B</code>'s default constructor. This is fine, because <code>D</code> has access to <code>B</code>'s default constructor.</p>\n\n<p>In C++17, the definition of aggregate was widened - base classes are now allowed (as long as they're non-<code>virtual</code>). <code>D</code> is now an aggregate, which means that <code>D{}</code> is aggregate initialization. And in aggregate-initialization, this means that we (the caller) are initializing all the subobjects - including the base class subobject. But we do <em>not</em> have access to <code>B</code>'s constructor (it is <code>protected</code>), so we cannot invoke it, so it is ill-formed.</p>\n\n<hr />\n\n<p>Fear not, the fix is easy. Use parentheses:</p>\n\n<pre><code>auto d = D();\n</code></pre>\n\n<p>This goes back to invoking <code>D</code>'s default constructor as before. </p>\n"}], "owner": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3441, "favorite_count": 3, "accepted_answer_id": 56367566, "answer_count": 1, "score": 47, "last_activity_date": 1559159446, "creation_date": 1559159001, "last_edit_date": 1559159446, "question_id": 56367480, "link": "https://stackoverflow.com/questions/56367480/should-this-code-fail-to-compile-in-c17", "title": "Should this code fail to compile in C++17?", "body": "<p>I was updating a project to use C++17 and found a few instances where code that followed this pattern was causing a compile error on recent versions of clang:</p>\n\n<pre><code>#include &lt;boost/variant.hpp&gt;\n\nstruct vis : public boost::static_visitor&lt;void&gt;\n{\n    void operator()(int) const { }\n};\n\nint main()\n{\n    boost::variant&lt;int&gt; v = 0;\n    boost::apply_visitor(vis{}, v);\n}\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/jlStVD\" rel=\"noreferrer\">Using clang v8.0 in C++17 mode, this fails with the following error</a>:</p>\n\n<pre><code>&lt;source&gt;:11:30: error: temporary of type 'boost::static_visitor&lt;void&gt;' has protected destructor\n    boost::apply_visitor(vis{}, v);\n                             ^\n/opt/compiler-explorer/libs/boost_1_64_0/boost/variant/static_visitor.hpp:53:5: note: declared protected here\n    ~static_visitor() = default;\n</code></pre>\n\n<p>However, <a href=\"https://godbolt.org/z/TVPqNJ\" rel=\"noreferrer\">it compiles cleanly in C++14 mode</a>. I found that if I change the brace initialization <code>vis{}</code> to parentheses <code>vis()</code>, then it compiles correctly in both modes. Every version of gcc that I've tried allows both variants in C++17 mode.</p>\n\n<p>Is this a correct change in behavior from C++14 to C++17, or is this a clang bug? If it is correct, why is it now invalid in C++17 (or maybe it always was, but clang just allows it in earlier standard revisions)?</p>\n"}, {"tags": ["c++", "simulation", "game-engine", "game-physics", "physics-engine"], "comments": [{"owner": {"reputation": 624, "user_id": 6815225, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q6XG0.png?s=128&g=1", "display_name": "Florian p.i.", "link": "https://stackoverflow.com/users/6815225/florian-p-i"}, "edited": false, "score": 0, "creation_date": 1559167002, "post_id": 56367379, "comment_id": 99340691, "body": "Are you sure that the collision body is set correctly?"}, {"owner": {"reputation": 391, "user_id": 4017747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12c45956c691c9e1baa0fa690a3e840?s=128&d=identicon&r=PG&f=1", "display_name": "tesio", "link": "https://stackoverflow.com/users/4017747/tesio"}, "reply_to_user": {"reputation": 624, "user_id": 6815225, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q6XG0.png?s=128&g=1", "display_name": "Florian p.i.", "link": "https://stackoverflow.com/users/6815225/florian-p-i"}, "edited": false, "score": 0, "creation_date": 1559169444, "post_id": 56367379, "comment_id": 99341330, "body": "I&#39;ve reviewed several times but I couldn&#39;t figure out. Am I missing something?"}, {"owner": {"reputation": 391, "user_id": 4017747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12c45956c691c9e1baa0fa690a3e840?s=128&d=identicon&r=PG&f=1", "display_name": "tesio", "link": "https://stackoverflow.com/users/4017747/tesio"}, "reply_to_user": {"reputation": 624, "user_id": 6815225, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q6XG0.png?s=128&g=1", "display_name": "Florian p.i.", "link": "https://stackoverflow.com/users/6815225/florian-p-i"}, "edited": false, "score": 0, "creation_date": 1559338003, "post_id": 56367379, "comment_id": 99402194, "body": "I thought they will collide at positions 0: (-1.5, 0.0, 0.0) and 1: (-0.5, 0.0, 0.0) but they pass through it and collide at 0: (-0.5, 0.0, 0.0) and 1: (-1.5, 0.0, 0.0). I still don&#39;t understand..."}], "answers": [{"comments": [{"owner": {"reputation": 391, "user_id": 4017747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12c45956c691c9e1baa0fa690a3e840?s=128&d=identicon&r=PG&f=1", "display_name": "tesio", "link": "https://stackoverflow.com/users/4017747/tesio"}, "edited": false, "score": 0, "creation_date": 1560036143, "post_id": 56418925, "comment_id": 99608552, "body": "Yes, that transform had to be identity transform because it is local space! Thank you so much"}, {"owner": {"reputation": 624, "user_id": 6815225, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q6XG0.png?s=128&g=1", "display_name": "Florian p.i.", "link": "https://stackoverflow.com/users/6815225/florian-p-i"}, "reply_to_user": {"reputation": 391, "user_id": 4017747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12c45956c691c9e1baa0fa690a3e840?s=128&d=identicon&r=PG&f=1", "display_name": "tesio", "link": "https://stackoverflow.com/users/4017747/tesio"}, "edited": false, "score": 0, "creation_date": 1560195369, "post_id": 56418925, "comment_id": 99648358, "body": "I am glad to have been able to help you."}], "tags": [], "owner": {"reputation": 624, "user_id": 6815225, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q6XG0.png?s=128&g=1", "display_name": "Florian p.i.", "link": "https://stackoverflow.com/users/6815225/florian-p-i"}, "is_accepted": true, "score": 3, "last_activity_date": 1559509221, "creation_date": 1559509221, "answer_id": 56418925, "question_id": 56367379, "link": "https://stackoverflow.com/questions/56367379/no-collision-is-detected-in-n-body-simulation-using-reactphysics3d/56418925#56418925", "title": "No collision is detected in n-body simulation using ReactPhysics3D", "body": "<p>Note: This is just a good guess because the numbers add up.</p>\n\n<p><strong>I think that the additional transform of -2 to its collision shape causes this unwanted effect.</strong></p>\n\n<p>This is your initialization logic for sphere1. I</p>\n\n<pre><code>Vector3 initPosition1(-2.0, 0.0, 0.0);\nTransform transform1(initPosition1, quaternion1);\nRigidBody * body1 = dynamicsWorld.createRigidBody(transform1);\n\n// set the initial velocity, material, and the shape\nSphereShape sphere1(decimal(0.5));\nbody1-&gt;addCollisionShape(&amp;sphere1, **transform1**, decimal(10.0));\n</code></pre>\n\n<hr>\n\n<p>Sphere 1:    direction: +1.0  expected Pos(-1.5) Actual (-0.5) => diff |1|</p>\n\n<p>Sphere 2:    direction: -1.0  expected Pos(-0.5) Actual (-1.5) => diff |1|</p>\n\n<p>Your expected positions are failed by exactly the amount of 1 in each moving direction. Two spheres both moving 1 unit towards each other too far create a total distance of 2, which is exactly your amount of translation to the collision shape of sphere1.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0GCyD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0GCyD.png\" alt=\"enter image description here\"></a></p>\n\n<p>Please test this, it might just be a coincidence...</p>\n"}], "owner": {"reputation": 391, "user_id": 4017747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12c45956c691c9e1baa0fa690a3e840?s=128&d=identicon&r=PG&f=1", "display_name": "tesio", "link": "https://stackoverflow.com/users/4017747/tesio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 56418925, "answer_count": 1, "score": 5, "last_activity_date": 1560036290, "creation_date": 1559158541, "last_edit_date": 1559339485, "question_id": 56367379, "link": "https://stackoverflow.com/questions/56367379/no-collision-is-detected-in-n-body-simulation-using-reactphysics3d", "title": "No collision is detected in n-body simulation using ReactPhysics3D", "body": "<p>I am currently working on n-body simulation using ReactPhysics3D(<a href=\"https://www.reactphysics3d.com/\" rel=\"noreferrer\">https://www.reactphysics3d.com/</a>).</p>\n\n<p>I made simple simulation of collision of two spheres. Then, I print the coordinates of the two spheres as the simulation runs. The problem is that they don't collide but pass through each other. Then, they collide in weird position.</p>\n\n<p>Here is the setup\nTwo spheres are created\nFirst sphere has position (-2, 0, 0) with initial velocity (1, 0, 0), radius = 0.5, and mass = 10\nSecond sphere has position (0, 0, 0) with initial velocity (-1, 0, 0), radius = 0.5, and mass = 10</p>\n\n<p>I thought they will collide at positions <code>0: (-1.5, 0.0, 0.0)</code> and\n<code>1: (-0.5, 0.0, 0.0)</code> but they pass through it and collide at <code>0: (-0.5, 0.0, 0.0)</code> and <code>1: (-1.5, 0.0, 0.0)</code></p>\n\n<p>Here is my code</p>\n\n<pre><code>int main (int argc, char **argv) {\n    Vector3 gravity = Vector3(0.0, 0.0, 0.0);\n\n    double mSimulationTime = 2.0;\n    DynamicsWorld dynamicsWorld(gravity);\n\n    // create a rigid body with the position\n    Vector3 initPosition1(-2.0, 0.0, 0.0);\n    Quaternion quaternion1 = Quaternion::identity();\n    Transform transform1(initPosition1, quaternion1);\n    RigidBody * body1 = dynamicsWorld.createRigidBody(transform1);\n\n    // set the initial velocity, material, and the shape\n    SphereShape sphere1(decimal(0.5));\n    body1-&gt;addCollisionShape(&amp;sphere1, transform1, decimal(10.0));\n    Vector3 init_velocity1 = Vector3(1.0, 0.0, 0.0); \n    body1-&gt;setLinearVelocity(init_velocity1);\n    body1-&gt;getMaterial().setBounciness(decimal(1.0));\n    body1-&gt;getMaterial().setFrictionCoefficient(decimal(0.0));\n    body1-&gt;setType(BodyType::DYNAMIC);\n\n    // create a rigid body with the position\n    Vector3 initPosition2(0.0, 0.0, 0.0);\n    Quaternion quaternion2 = Quaternion::identity();\n    Transform transform2(initPosition2, quaternion2);\n    RigidBody * body2 = dynamicsWorld.createRigidBody(transform2);\n\n    // set the initial velocity, material, and the shape\n    SphereShape sphere2(decimal(0.5));\n    body2-&gt;addCollisionShape(&amp;sphere2, transform2, decimal(10.0));\n    Vector3 init_velocity2 = Vector3(-1.0, 0.0, 0.0);\n    body2-&gt;setLinearVelocity(init_velocity2);\n    body2-&gt;getMaterial().setBounciness(decimal(1.0));\n    body2-&gt;getMaterial().setFrictionCoefficient(decimal(0.0));\n    body2-&gt;setType(BodyType::DYNAMIC);\n\n    const float timeStep = 1.0 / 60.0;\n\n    while (mSimulationTime &gt;= timeStep) {\n        mSimulationTime -= timeStep;\n        dynamicsWorld.update(timeStep);\n        double x, y, z;\n\n        x = body1-&gt;getTransform().getPosition().x;\n        y = body1-&gt;getTransform().getPosition().y;\n        z = body1-&gt;getTransform().getPosition().z;\n        printf(\"0: (%f, %f, %f)\\n\", x, y, z);\n\n        x = body2-&gt;getTransform().getPosition().x;\n        y = body2-&gt;getTransform().getPosition().y;\n        z = body2-&gt;getTransform().getPosition().z;\n        printf(\"1: (%f, %f, %f)\\n\", x, y, z);\n\n        printf(\"collision = %s\\n\", dynamicsWorld.testOverlap(body1, body2) ? \"=============================================================\" : \"false\");\n        printf(\"num = %d\\n\", dynamicsWorld.getNbRigidBodies());\n        printf(\"----------------\\n\\n\");\n    }\n}\n</code></pre>\n\n<p>Here is the output</p>\n\n<pre><code>0: (-1.983333, 0.000000, 0.000000)\n1: (-0.016667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.966667, 0.000000, 0.000000)\n1: (-0.033333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.950000, 0.000000, 0.000000)\n1: (-0.050000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.933333, 0.000000, 0.000000)\n1: (-0.066667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.916667, 0.000000, 0.000000)\n1: (-0.083333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.900000, 0.000000, 0.000000)\n1: (-0.100000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.883333, 0.000000, 0.000000)\n1: (-0.116667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.866667, 0.000000, 0.000000)\n1: (-0.133333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.850000, 0.000000, 0.000000)\n1: (-0.150000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.833333, 0.000000, 0.000000)\n1: (-0.166667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.816667, 0.000000, 0.000000)\n1: (-0.183333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.800000, 0.000000, 0.000000)\n1: (-0.200000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.783334, 0.000000, 0.000000)\n1: (-0.216667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.766667, 0.000000, 0.000000)\n1: (-0.233333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.750000, 0.000000, 0.000000)\n1: (-0.250000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.733334, 0.000000, 0.000000)\n1: (-0.266667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.716667, 0.000000, 0.000000)\n1: (-0.283333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.700000, 0.000000, 0.000000)\n1: (-0.300000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.683334, 0.000000, 0.000000)\n1: (-0.316667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.666667, 0.000000, 0.000000)\n1: (-0.333333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.650000, 0.000000, 0.000000)\n1: (-0.350000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.633334, 0.000000, 0.000000)\n1: (-0.366667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.616667, 0.000000, 0.000000)\n1: (-0.383333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.600000, 0.000000, 0.000000)\n1: (-0.400000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.583334, 0.000000, 0.000000)\n1: (-0.416667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.566667, 0.000000, 0.000000)\n1: (-0.433333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.550000, 0.000000, 0.000000)\n1: (-0.450000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.533334, 0.000000, 0.000000)\n1: (-0.466667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.516667, 0.000000, 0.000000)\n1: (-0.483334, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.500000, 0.000000, 0.000000)\n1: (-0.500000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.483334, 0.000000, 0.000000)\n1: (-0.516667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.466667, 0.000000, 0.000000)\n1: (-0.533333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.450001, 0.000000, 0.000000)\n1: (-0.550000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.433334, 0.000000, 0.000000)\n1: (-0.566667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.416667, 0.000000, 0.000000)\n1: (-0.583333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.400001, 0.000000, 0.000000)\n1: (-0.600000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.383334, 0.000000, 0.000000)\n1: (-0.616667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.366667, 0.000000, 0.000000)\n1: (-0.633333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.350001, 0.000000, 0.000000)\n1: (-0.650000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.333334, 0.000000, 0.000000)\n1: (-0.666667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.316667, 0.000000, 0.000000)\n1: (-0.683333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.300001, 0.000000, 0.000000)\n1: (-0.700000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.283334, 0.000000, 0.000000)\n1: (-0.716667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.266667, 0.000000, 0.000000)\n1: (-0.733333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.250001, 0.000000, 0.000000)\n1: (-0.750000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.233334, 0.000000, 0.000000)\n1: (-0.766667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.216667, 0.000000, 0.000000)\n1: (-0.783333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.200001, 0.000000, 0.000000)\n1: (-0.800000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.183334, 0.000000, 0.000000)\n1: (-0.816667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.166667, 0.000000, 0.000000)\n1: (-0.833333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.150001, 0.000000, 0.000000)\n1: (-0.850000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.133334, 0.000000, 0.000000)\n1: (-0.866666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.116668, 0.000000, 0.000000)\n1: (-0.883333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.100001, 0.000000, 0.000000)\n1: (-0.900000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.083334, 0.000000, 0.000000)\n1: (-0.916666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.066668, 0.000000, 0.000000)\n1: (-0.933333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.050001, 0.000000, 0.000000)\n1: (-0.950000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.033334, 0.000000, 0.000000)\n1: (-0.966666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.016668, 0.000000, 0.000000)\n1: (-0.983333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-1.000001, 0.000000, 0.000000)\n1: (-1.000000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.983334, 0.000000, 0.000000)\n1: (-1.016666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.966668, 0.000000, 0.000000)\n1: (-1.033333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.950001, 0.000000, 0.000000)\n1: (-1.050000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.933334, 0.000000, 0.000000)\n1: (-1.066666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.916668, 0.000000, 0.000000)\n1: (-1.083333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.900001, 0.000000, 0.000000)\n1: (-1.100000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.883334, 0.000000, 0.000000)\n1: (-1.116666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.866668, 0.000000, 0.000000)\n1: (-1.133333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.850001, 0.000000, 0.000000)\n1: (-1.150000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.833334, 0.000000, 0.000000)\n1: (-1.166666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.816668, 0.000000, 0.000000)\n1: (-1.183333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.800001, 0.000000, 0.000000)\n1: (-1.200000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.783334, 0.000000, 0.000000)\n1: (-1.216666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.766668, 0.000000, 0.000000)\n1: (-1.233333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.750001, 0.000000, 0.000000)\n1: (-1.250000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.733335, 0.000000, 0.000000)\n1: (-1.266666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.716668, 0.000000, 0.000000)\n1: (-1.283333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.700001, 0.000000, 0.000000)\n1: (-1.299999, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.683335, 0.000000, 0.000000)\n1: (-1.316666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.666668, 0.000000, 0.000000)\n1: (-1.333333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.650001, 0.000000, 0.000000)\n1: (-1.349999, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.633335, 0.000000, 0.000000)\n1: (-1.366666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.616668, 0.000000, 0.000000)\n1: (-1.383333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.600001, 0.000000, 0.000000)\n1: (-1.399999, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.583335, 0.000000, 0.000000)\n1: (-1.416666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.566668, 0.000000, 0.000000)\n1: (-1.433333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.550001, 0.000000, 0.000000)\n1: (-1.449999, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.533335, 0.000000, 0.000000)\n1: (-1.466666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.516668, 0.000000, 0.000000)\n1: (-1.483333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.500001, 0.000000, 0.000000)\n1: (-1.499999, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.483335, 0.000000, 0.000000)\n1: (-1.516666, 0.000000, 0.000000)\ncollision = =============================================================\nnum = 2\n----------------\n\n0: (-0.502335, 0.000000, 0.000000)\n1: (-1.497666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.519001, 0.000000, 0.000000)\n1: (-1.480999, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.535668, 0.000000, 0.000000)\n1: (-1.464333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.552335, 0.000000, 0.000000)\n1: (-1.447666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.569001, 0.000000, 0.000000)\n1: (-1.431000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.585668, 0.000000, 0.000000)\n1: (-1.414333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.602334, 0.000000, 0.000000)\n1: (-1.397666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.619001, 0.000000, 0.000000)\n1: (-1.381000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.635668, 0.000000, 0.000000)\n1: (-1.364333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.652334, 0.000000, 0.000000)\n1: (-1.347666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.669001, 0.000000, 0.000000)\n1: (-1.331000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.685668, 0.000000, 0.000000)\n1: (-1.314333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.702334, 0.000000, 0.000000)\n1: (-1.297666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.719001, 0.000000, 0.000000)\n1: (-1.281000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.735668, 0.000000, 0.000000)\n1: (-1.264333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.752334, 0.000000, 0.000000)\n1: (-1.247666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.769001, 0.000000, 0.000000)\n1: (-1.231000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.785668, 0.000000, 0.000000)\n1: (-1.214333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.802334, 0.000000, 0.000000)\n1: (-1.197666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.819001, 0.000000, 0.000000)\n1: (-1.181000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.835668, 0.000000, 0.000000)\n1: (-1.164333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.852334, 0.000000, 0.000000)\n1: (-1.147666, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.869001, 0.000000, 0.000000)\n1: (-1.131000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.885668, 0.000000, 0.000000)\n1: (-1.114333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.902334, 0.000000, 0.000000)\n1: (-1.097667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.919001, 0.000000, 0.000000)\n1: (-1.081000, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.935668, 0.000000, 0.000000)\n1: (-1.064333, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n\n0: (-0.952334, 0.000000, 0.000000)\n1: (-1.047667, 0.000000, 0.000000)\ncollision = false\nnum = 2\n----------------\n</code></pre>\n\n<p>Could you give me some advice why I am getting this result?\nI guessing wrong initialization or wrong way to print coordinates but I couldn't figure it out.\nThank you</p>\n"}, {"tags": ["c++", "c", "windows", "sockets", "tcp"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559160128, "post_id": 56367207, "comment_id": 99338434, "body": "<code>WSASend()</code> generally does not complete until the entire buffer has been sent, but it doesn&#39;t hurt to account for the <i>possibility</i> of a partial send by simply calling <code>WSASend()</code> again if there is remaining unsent data. A read operation completes as soon as any data is available to return, unless you specify a flag to make it wait until the entire buffer is filled."}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1559160511, "post_id": 56367207, "comment_id": 99338581, "body": "With <a href=\"http://www.serverframework.com/asynchronousevents/2011/10/windows-8-registered-io-networking-extensions.html\" rel=\"nofollow noreferrer\">RIO</a> you can specify the max number of outstanding requests."}, {"owner": {"reputation": 43, "user_id": 10648225, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jeremy Hansen", "link": "https://stackoverflow.com/users/10648225/jeremy-hansen"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559169366, "post_id": 56367207, "comment_id": 99341315, "body": "@RemyLebeau &quot;simply calling WSASend() again if there is remaining unsent data.&quot; Did you mean it literally? Doesn&#39;t the program have to check how much data was sent from a previous call and if the buffer was sent partially, it would have to rearrange the arguments of next WSASend() as pointer to the start of its remaining buffer index and its remaining length?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559169427, "post_id": 56367207, "comment_id": 99341329, "body": "@JeremyHansen obviously, you have to pass only the unsent bytes, if any, to the next call to <code>WSASend()</code>. However you want to do that is up to you, there are several ways to accomplish that."}], "owner": {"reputation": 43, "user_id": 10648225, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jeremy Hansen", "link": "https://stackoverflow.com/users/10648225/jeremy-hansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559158561, "creation_date": 1559157617, "last_edit_date": 1559158561, "question_id": 56367207, "link": "https://stackoverflow.com/questions/56367207/tcp-iocp-could-wsasend-post-notification-to-waiting-thread-after-partially-sen", "title": "TCP IOCP : Could WSASend post notification to waiting thread after partially sending it&#39;s buffer like WSARecv function?", "body": "<p>Instead of sending whole requested buffer, could WSASend/send type of operation return or post notification to waiting thread after partially sending requested buffer when there's too many IO Request to handle? (Similar to how WSARecv/recv function returning/posting notification to the thread after receiving buffer partially if that's what's available in the buffer.)</p>\n"}, {"tags": ["c++", "c++17", "variadic-templates", "sfinae", "template-argument-deduction"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 2, "creation_date": 1559157499, "post_id": 56367136, "comment_id": 99337400, "body": "It would be great to show your attempt at writing a contructor with variadic template. We may be able to not only help, but also analyze your thought process and point where exactly the logic you came up with was flawed."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1559157942, "post_id": 56367136, "comment_id": 99337552, "body": "Can you use C++17?"}], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 1, "last_activity_date": 1559159054, "last_edit_date": 1559159054, "creation_date": 1559158039, "answer_id": 56367292, "question_id": 56367136, "link": "https://stackoverflow.com/questions/56367136/expand-variadic-template-pack-by-pairs/56367292#56367292", "title": "Expand Variadic Template Pack by Pairs", "body": "<p>With some indirection, you might do:</p>\n\n<pre><code>template &lt;typename Start, typename End&gt;\nclass Node {\n    // ...\n};\n\n// Implementation using the Nodes\n// You might add typedef in Node to retrieve Start/End if needed (or create traits)\ntemplate &lt;typename ... Nodes&gt;\nstruct CollectionImpl\n{\n    CollectionImpl(Nodes ... ns) : nodes(ns...){}\n\n    std::tuple&lt;Nodes...&gt; nodes; // You probably want something like that\n};\n\n// Helper class to build the type\ntemplate &lt;typename Seq, typename Tup&gt; struct CollectionMaker;\n\ntemplate &lt;std::size_t ... Is, typename Tuple&gt;\nstruct CollectionMaker&lt;std::index_sequence&lt;Is...&gt;, Tuple&gt;\n{\n    using type = CollectionImpl&lt;Node&lt;std::tuple_element_t&lt;Is, Tuple&gt;,\n                                     std::tuple_element_t&lt;Is + 1, Tuple&gt;&gt;...&gt;;\n};\n\n// Wanted interface.\ntemplate &lt;typename ... Ts&gt;\nusing Collection = typename CollectionMaker&lt;std::make_index_sequence&lt;sizeof...(Ts) - 1&gt;,\n                                            std::tuple&lt;Ts...&gt;&gt;::type;\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/kLIwBk\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}, {"comments": [{"owner": {"reputation": 744, "user_id": 7869060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e484886875f712fd3fa42b678d1b55d?s=128&d=identicon&r=PG&f=1", "display_name": "Rhaokiel", "link": "https://stackoverflow.com/users/7869060/rhaokiel"}, "edited": false, "score": 0, "creation_date": 1559221485, "post_id": 56367799, "comment_id": 99357938, "body": "Thanks, I like how your answer leaves the constructor looking most like the intended data that fills it. I don&#39;t think templates should ever obfuscate the intent of the function."}, {"owner": {"reputation": 744, "user_id": 7869060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e484886875f712fd3fa42b678d1b55d?s=128&d=identicon&r=PG&f=1", "display_name": "Rhaokiel", "link": "https://stackoverflow.com/users/7869060/rhaokiel"}, "edited": false, "score": 0, "creation_date": 1559221527, "post_id": 56367799, "comment_id": 99357966, "body": "The part that I was missing in my code was how to infer the types FTs and STs. I didn&#39;t realize you could use enable_if to do that."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 2, "last_activity_date": 1559161047, "last_edit_date": 1559161047, "creation_date": 1559160577, "answer_id": 56367799, "question_id": 56367136, "link": "https://stackoverflow.com/questions/56367136/expand-variadic-template-pack-by-pairs/56367799#56367799", "title": "Expand Variadic Template Pack by Pairs", "body": "<p>I propose a little different solution.</p>\n\n<p>Given a trivial <code>tag</code> struct to wrap a generic type (to avoid problems with types not default constructible in <code>std::tuples</code>s) </p>\n\n<pre><code>template &lt;typename&gt;\nstruct tag\n { };\n</code></pre>\n\n<p>and an helper struct that define 2 types based on <code>std::tuple</code></p>\n\n<pre><code>template &lt;typename...&gt;\nstruct getTpls;\n\ntemplate &lt;std::size_t ... Is, typename ... Ts&gt;\nstruct getTpls&lt;std::index_sequence&lt;Is...&gt;, Ts...&gt;\n {\n   using tpl0 = std::tuple&lt;tag&lt;Ts&gt;...&gt;;\n   using ftpl = std::tuple&lt;std::tuple_element_t&lt;Is,    tpl0&gt;...&gt;;\n   using stpl = std::tuple&lt;std::tuple_element_t&lt;1u+Is, tpl0&gt;...&gt;;\n };\n</code></pre>\n\n<p>you can write <code>Collection</code> as follows</p>\n\n<pre><code>template &lt;typename ... Ts&gt;\nstruct Collection\n {\n   static_assert( sizeof...(Ts) &gt; 1u, \"more types, please\");\n\n   using getT = getTpls&lt;std::make_index_sequence&lt;sizeof...(Ts)-1u&gt;, Ts...&gt;;\n\n   using ftpl = typename getT::ftpl;\n   using stpl = typename getT::stpl;\n\n   template &lt;typename ... FTs, typename ... STs,\n             std::enable_if_t&lt;\n                 std::is_same_v&lt;ftpl, std::tuple&lt;tag&lt;FTs&gt;...&gt;&gt;\n              &amp;&amp; std::is_same_v&lt;stpl, std::tuple&lt;tag&lt;STs&gt;...&gt;&gt;, int&gt; = 0&gt;\n   Collection (Node&lt;FTs, STs&gt; ...)\n    { }\n };\n</code></pre>\n\n<p>The following is a full compiling example</p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;type_traits&gt;\n\ntemplate &lt;typename Start, typename End&gt;\nclass Node\n { };\n\nstruct A {};\nstruct B {};\nstruct C {};\n\ntemplate &lt;typename&gt;\nstruct tag\n { };\n\ntemplate &lt;typename...&gt;\nstruct getTpls;\n\ntemplate &lt;std::size_t ... Is, typename ... Ts&gt;\nstruct getTpls&lt;std::index_sequence&lt;Is...&gt;, Ts...&gt;\n {\n   using tpl0 = std::tuple&lt;tag&lt;Ts&gt;...&gt;;\n   using ftpl = std::tuple&lt;std::tuple_element_t&lt;Is,    tpl0&gt;...&gt;;\n   using stpl = std::tuple&lt;std::tuple_element_t&lt;1u+Is, tpl0&gt;...&gt;;\n };\n\ntemplate &lt;typename ... Ts&gt;\nstruct Collection\n {\n   static_assert( sizeof...(Ts) &gt; 1u, \"more types, please\");\n\n   using getT = getTpls&lt;std::make_index_sequence&lt;sizeof...(Ts)-1u&gt;, Ts...&gt;;\n\n   using ftpl = typename getT::ftpl;\n   using stpl = typename getT::stpl;\n\n   template &lt;typename ... FTs, typename ... STs,\n             std::enable_if_t&lt;\n                 std::is_same_v&lt;ftpl, std::tuple&lt;tag&lt;FTs&gt;...&gt;&gt;\n              &amp;&amp; std::is_same_v&lt;stpl, std::tuple&lt;tag&lt;STs&gt;...&gt;&gt;, int&gt; = 0&gt;\n   Collection (Node&lt;FTs, STs&gt; ...)\n    { }\n };\n\nint main ()\n {\n   Collection&lt;A, B, C&gt;  c0{Node&lt;A, B&gt;{}, Node&lt;B, C&gt;{}};    // compile\n   // Collection&lt;A, B, B&gt;  c1{Node&lt;A, B&gt;{}, Node&lt;B, C&gt;{}}; // error!\n }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 744, "user_id": 7869060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e484886875f712fd3fa42b678d1b55d?s=128&d=identicon&r=PG&f=1", "display_name": "Rhaokiel", "link": "https://stackoverflow.com/users/7869060/rhaokiel"}, "is_accepted": false, "score": 0, "last_activity_date": 1559226424, "creation_date": 1559226424, "answer_id": 56380216, "question_id": 56367136, "link": "https://stackoverflow.com/questions/56367136/expand-variadic-template-pack-by-pairs/56380216#56380216", "title": "Expand Variadic Template Pack by Pairs", "body": "<p>Based on max66's answer:</p>\n\n<p>This cleans up the unnecessary <code>tag</code> structure and simplifies the <code>index_sequence</code> to direct recursion (similar to the definition of tuple).</p>\n\n<pre><code>template &lt;typename Owner, typename Value&gt;\nclass Node {\n};\n\n\nstruct A {};\nstruct B {};\nstruct C {};\nstruct D {};\n\n\ntemplate &lt;typename First, typename...Rest&gt;\nstd::tuple&lt;First, Rest...&gt; tuple_push_front(std::tuple&lt;Rest...&gt;);\n\ntemplate &lt;typename T1, typename T2, typename...T&gt;\nstruct NodeCollector {\nprivate:\n    using nodeRest = NodeCollector&lt;T2, T...&gt;;\npublic:\n    using tplOwners = decltype(tuple_push_front&lt;T1&gt;(std::declval&lt;typename nodeRest::tplOwners&gt;()));\n    using tplValues = decltype(tuple_push_front&lt;T2&gt;(std::declval&lt;typename nodeRest::tplValues&gt;()));\n};\ntemplate &lt;typename T1, typename T2&gt;\nstruct NodeCollector&lt;T1, T2&gt; {\npublic:\n    using tplOwners = std::tuple&lt;T1&gt;;\n    using tplValues = std::tuple&lt;T2&gt;;\n};\n\n\ntemplate &lt;typename...Ts&gt;\nclass Collection\n{\n    static_assert( sizeof...(Ts) &gt; 1u, \"Collection requires at least two types.\");\nprivate:\n    using nodeCollector = NodeCollector&lt;Ts...&gt;;\npublic:\n    template &lt;typename...OTs, typename...VTs, typename=std::enable_if_t&lt;\n        (std::is_same_v&lt;typename nodeCollector::tplOwners, std::tuple&lt;OTs...&gt;&gt; &amp;&amp;\n         std::is_same_v&lt;typename nodeCollector::tplValues, std::tuple&lt;VTs...&gt;&gt;)&gt; &gt;\n    Collection(Node&lt;OTs, VTs&gt;...) { }\n};\n\n\nint main()\n{\n    Collection&lt;A, B, C, D&gt; c{Node&lt;A, B&gt;{}, Node&lt;B, C&gt;{}, Node&lt;C, D&gt;{}};\n    std::cout &lt;&lt; demangle(typeid(c).name()) &lt;&lt; std::endl;\n}\n</code></pre>\n"}], "owner": {"reputation": 744, "user_id": 7869060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e484886875f712fd3fa42b678d1b55d?s=128&d=identicon&r=PG&f=1", "display_name": "Rhaokiel", "link": "https://stackoverflow.com/users/7869060/rhaokiel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 1, "accepted_answer_id": 56367799, "answer_count": 3, "score": 2, "last_activity_date": 1559226424, "creation_date": 1559157309, "last_edit_date": 1559220688, "question_id": 56367136, "link": "https://stackoverflow.com/questions/56367136/expand-variadic-template-pack-by-pairs", "title": "Expand Variadic Template Pack by Pairs", "body": "<p>I'm creating a generic collection of <code>Node</code>s. Each <code>Node</code> has a <code>Start</code> and <code>End</code> type. And the <code>End</code> type of one must match the <code>Start</code> type of the next.</p>\n\n<p>If I were to list each of the types in the collection the constructor would look like this (for four types):</p>\n\n<pre><code>template &lt;typename Start, typename End&gt;\nclass Node {\n};\n\ntemplate &lt;typename A, typename B, typename C, typename D&gt;\nclass Collection\n{\npublic:\n    Collection(Node&lt;A, B&gt; n1, Node&lt;B, C&gt; n2, Node&lt;C, D&gt; n3) { }\n};\n</code></pre>\n\n<p>But when I try to write constuctor as a variadic template to support any number of types, I am stumped.</p>\n"}, {"tags": ["c++", "boost"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559158661, "post_id": 56367088, "comment_id": 99337832, "body": "Note that you get the expected output for <code>boost::logic::tribool test = boost::logic::tribool{true} &amp;&amp; boost::logic::indeterminate;</code>"}, {"owner": {"reputation": 390, "user_id": 6778220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2017416e6f7cacc38c8564e371514e?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/6778220/newbie"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559158739, "post_id": 56367088, "comment_id": 99337865, "body": "But why is it true after all?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559158859, "post_id": 56367088, "comment_id": 99337929, "body": "I have no clue... out of curiosity: what do you use it for? Even without this quirk I find this <code>tribool</code> highly confusing and wouldnt want to have it in my code. I mean what could be more strange than a bool conversion such that after a <code>if (b) {} else if (!b) {}</code> you still have a <code>else {}</code> case...imho thats implicit conversion gone too far"}, {"owner": {"reputation": 390, "user_id": 6778220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2017416e6f7cacc38c8564e371514e?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/6778220/newbie"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559159088, "post_id": 56367088, "comment_id": 99338035, "body": "You do not need to convince me, large codebase, you know, a lot of weird people and ideas could emerge throughout life of large project"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559159228, "post_id": 56367088, "comment_id": 99338090, "body": "ok, no prob, The documentation is a bit sloppy: <a href=\"https://www.boost.org/doc/libs/1_59_0/doc/html/boost/logic/operator___idp51294368.html\" rel=\"nofollow noreferrer\">boost.org/doc/libs/1_59_0/doc/html/boost/logic/&hellip;</a> Note that it says &quot;the result of logically ANDing the <b>two tribool values</b>, according to the following table: &quot;  which strictly speaking excludes the <code>(bool,tribool)</code> overload"}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1559159427, "post_id": 56367088, "comment_id": 99338173, "body": "C++ doesn&#39;t know 3-valued logic, and the <code>if()</code> statement is a C++ language construct, not part of <code>boost::logic::tribool</code>. Any value that converts to something different from an integer zero, a <code>nullptr</code>, or <code>false</code> will be treated as true by the <code>if()</code> statement. And that obviously includes <code>boost::logic::indeterminate</code>."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1559159605, "post_id": 56367088, "comment_id": 99338238, "body": "@cmaster if I understand their <a href=\"https://www.boost.org/doc/libs/1_59_0/doc/html/tribool/tutorial.html#idp473654464\" rel=\"nofollow noreferrer\">basic example</a> correctly, what you are saying is not correct. <code>tribool</code> has a super fancy bool conversion that can make both <code>b</code> and <code>!b</code>  <code>false</code> at the same time, exactly when the value is <code>indeterminate</code>"}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559160760, "post_id": 56367088, "comment_id": 99338680, "body": "@formerlyknownas_463035818 And you are sure that the value is actually converted to <code>bool</code>? I don&#39;t know <code>boost::logic</code>, but if the statement <code>if(boost::logic::indeterminate) foo();</code> executes <code>foo()</code>, then the value cannot have been converted to <code>false</code>. Maybe it&#39;s a bug, maybe it&#39;s a pitfall, I don&#39;t know which."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1559161019, "post_id": 56367088, "comment_id": 99338780, "body": "@cmaster hum? <code>if(boost::logic::indeterminate) foo();</code> does not execute <code>foo();</code>. I didnt look into all details, but basically all you need is a <code>operator bool</code> and a <code>operator!</code> then you can make <code>if (indeterminate) {</code>bar();<code>} else if (! indeterminate) {</code>bar();<code>} else { foo();}</code> execute only <code>foo();</code> but not <code>bar();</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1562, "user_id": 1417615, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w57C6.jpg?s=128&g=1", "display_name": "Brandon Kohn", "link": "https://stackoverflow.com/users/1417615/brandon-kohn"}, "is_accepted": true, "score": 1, "last_activity_date": 1559220504, "last_edit_date": 1559220504, "creation_date": 1559220065, "answer_id": 56378536, "question_id": 56367088, "link": "https://stackoverflow.com/questions/56367088/boost-tribool-question-about-logical-operations/56378536#56378536", "title": "Boost tribool question about logical operations", "body": "<pre><code>TEST(junk, tribool)\n{\n    auto v = boost::logic::indeterminate;\n    GTEST_MESSAGE() &lt;&lt; typeid(v).name();\n}\n\n</code></pre>\n\n<p>Results in:</p>\n\n<pre><code>[----------] 1 test from junk\n[ RUN      ] junk.tribool\n[   NOTE   ] bool (__cdecl*)(class boost::logic::tribool,struct boost::logic::detail::indeterminate_t)\n</code></pre>\n\n<p><strong><em><code>boost::logic::indeterminate</code> is a function</em></strong>. So it evaluates to true. </p>\n\n<pre><code>TEST(junk, tribool)\n{\n    boost::logic::tribool test = true &amp;&amp; boost::logic::tribool{ boost::logic::indeterminate_keyword_t() };\n\n    if (test)\n    {\n        GTEST_MESSAGE() &lt;&lt; \"Executes?\" &lt;&lt; std::endl;\n    }\n\n    if (true &amp;&amp; boost::logic::tribool{ boost::logic::indeterminate_keyword_t() })\n    {\n        GTEST_MESSAGE() &lt;&lt; \"Executes 2\" &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n\n<p>Results in:</p>\n\n<pre><code>[----------] 1 test from junk\n[ RUN      ] junk.tribool\n[       OK ] junk.tribool (64970 ms)\n[----------] 1 test from junk (68580 ms total)\n</code></pre>\n"}], "owner": {"reputation": 390, "user_id": 6778220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2017416e6f7cacc38c8564e371514e?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/6778220/newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 1, "accepted_answer_id": 56378536, "answer_count": 1, "score": 2, "last_activity_date": 1559220504, "creation_date": 1559157136, "last_edit_date": 1559165781, "question_id": 56367088, "link": "https://stackoverflow.com/questions/56367088/boost-tribool-question-about-logical-operations", "title": "Boost tribool question about logical operations", "body": "<p>Recently, I used <code>boost::logic::tribool</code> and something was strange for me.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"boost/logic/tribool.hpp\"\n\n\nint main()\n{\n    boost::logic::tribool test = true &amp;&amp; boost::logic::indeterminate;\n\n    if(test)\n    {\n     std::cout &lt;&lt; \"Executes?\" &lt;&lt; std::endl;\n    }\n\n    if (true &amp;&amp; boost::logic::indeterminate)\n    {\n      std::cout &lt;&lt; \"Executes 2\" &lt;&lt; std::endl;\n    }\n\n}\n</code></pre>\n\n<p>Prints <code>Executes</code> and <code>Executes 2</code>.\nWhy are these conditions true?\nI was totally sure that AND operation with (indeterminate state, true) returns indeterminate state?</p>\n\n<p>Quote from boost.org about boolean context in <code>if</code></p>\n\n<p>\"returns true if the 3-state boolean is true, false otherwise\"</p>\n\n<p>EDIT: after comments I am adding this.\nThis is the most non-intuitive code I have ever read.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"boost/logic/tribool.hpp\"\n\n\nint main()\n{\n    boost::logic::tribool test = boost::logic::tribool(true) &amp;&amp; boost::logic::indeterminate;\n\n    if(test)\n    {\n     std::cout &lt;&lt; \"This will NOT execute\" &lt;&lt; std::endl;\n    }\n\n    boost::logic::tribool second = true &amp;&amp; boost::logic::indeterminate;\n\n    if (second)\n    {\n      std::cout &lt;&lt; \"This will execute\" &lt;&lt; std::endl;\n    }\n\n}\n</code></pre>\n\n<p>EDIT2: I need to correct myself...\nAnyone could explain?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"boost/logic/tribool.hpp\"\n\nboost::logic::tribool LOL( )\n{\n   return    boost::logic::indeterminate;\n}\n\nint main()\n{\n\n boost::logic::tribool LOL_RESULT = LOL();\n\n    if (boost::logic::indeterminate)\n    {\n        std::cout &lt;&lt; \"IT WILL BE EXECUTED\" &lt;&lt; std::endl;\n    }\n\n    if (LOL_RESULT)\n    {\n      std::cout &lt;&lt; \"IT WILL NOT BE EXECUTED\"   &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "image", "opencv", "memory-management"], "comments": [{"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1559155719, "post_id": 56366682, "comment_id": 99336660, "body": "For <code>cv::imencode</code>? You don&#39;t need to prepend anything anywhere, just <a href=\"https://docs.opencv.org/3.4.3/d3/d63/classcv_1_1Mat.html#a51615ebf17a64c968df0bf49b4de6a3a\" rel=\"nofollow noreferrer\">construct a <code>cv::Mat</code></a> wrapping the pixel buffer, and pass it to the function."}], "answers": [{"tags": [], "owner": {"reputation": 2212, "user_id": 1595504, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/45ce3e54b7c852a2cf8fd568b1a573a1?s=128&d=identicon&r=PG", "display_name": "nayab", "link": "https://stackoverflow.com/users/1595504/nayab"}, "is_accepted": true, "score": 1, "last_activity_date": 1559290750, "creation_date": 1559290750, "answer_id": 56391288, "question_id": 56366682, "link": "https://stackoverflow.com/questions/56366682/opencv-how-to-encode-raw-image-information-for-imencode/56391288#56391288", "title": "OpenCV how to encode raw image information for imencode?", "body": "<p>You can use Mat constructor to create an image from data and meta data </p>\n\n<blockquote>\n  <p>Mat::Mat(int rows, int cols, int type, void* data, size_t\n  step=AUTO_STEP); // <a href=\"https://docs.opencv.org/2.4/modules/core/doc/basic_structures.html#Mat::Mat(int%20rows,%20int%20cols,%20int%20type,%20void*%20data,%20size_t%20step)\" rel=\"nofollow noreferrer\">documentation here </a></p>\n</blockquote>\n\n<pre><code>cv::Mat image = cv::Mat(height, width, CV_8UC3, raw_data);\n</code></pre>\n\n<p><code>type</code> argument specifies the number of channels and data format. For example, typical RGB image data is <code>unsigned char</code> and the number of channels is <code>3</code> so its type = <code>CV_8UC3</code></p>\n\n<p>Available OpenCV Mat types are defined <a href=\"https://docs.opencv.org/3.1.0/dc/dcc/cvdef_8h.html\" rel=\"nofollow noreferrer\">cvdef.h</a></p>\n"}], "owner": {"reputation": 5185, "user_id": 6202327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AFtrB.png?s=128&g=1", "display_name": "Makogan", "link": "https://stackoverflow.com/users/6202327/makogan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 56391288, "answer_count": 1, "score": 0, "last_activity_date": 1559290750, "creation_date": 1559155120, "question_id": 56366682, "link": "https://stackoverflow.com/questions/56366682/opencv-how-to-encode-raw-image-information-for-imencode", "title": "OpenCV how to encode raw image information for imencode?", "body": "<p>I am in C++.</p>\n\n<p>Assume some mysterious function <code>getData()</code> returns all but only the pixel information of an image.</p>\n\n<p>i.e a <code>char*</code> that points to only the pixel information with no metadata (no width, length, height, nor channels of any form)</p>\n\n<p>Thus we have:</p>\n\n<p><code>unsigned char *raw_data = getData();</code></p>\n\n<p>Then we have another function that returns a structure containing the metadata.</p>\n\n<p>eg: </p>\n\n<pre><code>struct Metadata {\n    int width;\n    int height;\n    int channels;\n    //other useful fields\n}\n</code></pre>\n\n<p>I now need to prepend the object metadata in the correct way to create a valid image buffer.</p>\n\n<p>So instead of <code>[pixel1, pixel2, pixel3 ...]</code></p>\n\n<p>I would have, for example <code>[width, height, channels, pixel1, pixel2, pixel3...]</code></p>\n\n<p>What is the correct order to prepend the metadata and are width, height and channels enough? </p>\n"}, {"tags": ["c++", "unique-ptr", "factory-pattern"], "comments": [{"owner": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "edited": false, "score": 0, "creation_date": 1559155249, "post_id": 56366556, "comment_id": 99336457, "body": "Where is your move ctor/assignment for Agent?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "edited": false, "score": 1, "creation_date": 1559155349, "post_id": 56366556, "comment_id": 99336492, "body": "@user10933809 what does that have to do with anything? That is irrelevant to this question"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1559155367, "post_id": 56366556, "comment_id": 99336498, "body": "@MichaelS you say the code does not compile, what are the actual errors? When using <code>using creatorFunctionType = std::unique_ptr&lt;Agent&gt;(*)();</code>, try giving the lambdas an explicit return type: <code>[]() -&gt; std::unique_ptr&lt;Agent&gt; { return std::make_unique&lt;Predator&gt;(); }</code> A <code>unique_ptr&lt;Predator&gt;</code> is implicitly convertible to <code>unique_ptr&lt;Agent&gt;</code> as long as <code>Predator</code> derives from <code>Agent</code>"}, {"owner": {"reputation": 135, "user_id": 7313100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ef43515f350e0fa0d926eb360e91eb?s=128&d=identicon&r=PG&f=1", "display_name": "Michael S.", "link": "https://stackoverflow.com/users/7313100/michael-s"}, "edited": false, "score": 0, "creation_date": 1559155406, "post_id": 56366556, "comment_id": 99336520, "body": "Agent has only constructor Agent(int ID_). There is no move nor assignment. Are they necessary?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559155570, "post_id": 56366556, "comment_id": 99336587, "body": "@MichaelS. for purposes of this question, no they are not. How you construct your objects is irrelevent, what you are asking for is how to assign the function pointers correctly, and that has nothing to do with object construction."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1559155702, "post_id": 56366556, "comment_id": 99336650, "body": "please try to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and include the full error message in the question. One would have to add some missing pieces to the code you posted to get anywhere near to the error you get"}, {"owner": {"reputation": 135, "user_id": 7313100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ef43515f350e0fa0d926eb360e91eb?s=128&d=identicon&r=PG&f=1", "display_name": "Michael S.", "link": "https://stackoverflow.com/users/7313100/michael-s"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559155762, "post_id": 56366556, "comment_id": 99336684, "body": "@RemyLebeau, added compilation errors in question"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1559155827, "post_id": 56366556, "comment_id": 99336710, "body": "@MichaelS. OK, but those errors apply to <code>template &lt;class T&gt; using creatorFunctionType = std::unique_ptr&lt;T&gt;(*)();</code> What happens when you go back to <code>using creatorFunctionType = std::unique_ptr&lt;Agent&gt;(*)();</code> instead? Did you try the suggestion I offered?"}, {"owner": {"reputation": 135, "user_id": 7313100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ef43515f350e0fa0d926eb360e91eb?s=128&d=identicon&r=PG&f=1", "display_name": "Michael S.", "link": "https://stackoverflow.com/users/7313100/michael-s"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559156074, "post_id": 56366556, "comment_id": 99336799, "body": "@RemyLebeau, when added []() -&gt; std::unique_ptr&lt;Agent&gt; to lambda and do not use template, everything seems to work ok"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559158486, "post_id": 56366556, "comment_id": 99337769, "body": "@MichaelS. OK, I added an answer about that now."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1559160368, "post_id": 56366556, "comment_id": 99338528, "body": "The original problem is that <code>template&lt;T&gt; using creatorFunctionType = std::unique_ptr&lt;T&gt;(*)();</code> declares <code>creatorFunctionType</code> as a template type. It is not yet a type. To make it a type, you need to instantiate the template by saying <code>creatorFunctionType&lt;Agent&gt;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 3, "last_activity_date": 1559158978, "last_edit_date": 1559158978, "creation_date": 1559158335, "answer_id": 56367350, "question_id": 56366556, "link": "https://stackoverflow.com/questions/56366556/factory-pattern-with-unique-ptr/56367350#56367350", "title": "Factory pattern with unique_ptr", "body": "<p>When <code>creatorFunctionType</code> is defined as</p>\n\n<pre><code>using creatorFunctionType = std::unique_ptr&lt;Agent&gt;(*)();\n</code></pre>\n\n<p><code>creatorFunctionType</code> is a pointer-to-function that expects functions which return a <code>std::unique_ptr&lt;Agent&gt;</code>.</p>\n\n<p>However, your lambdas do not have explicit return types, so the compiler deduces their return types as <code>std::unique_ptr&lt;Predator&gt;</code> and <code>std::unique_ptr&lt;Prey&gt;</code>, respectively, based on their <code>return</code> statements.</p>\n\n<p>A non-capturing lambda is implicitly convertible to a pointer-to-function, which is what you want in this case, however your lambdas do not return <code>std::unique_ptr&lt;Agent&gt;</code>, so they cannot be assigned to <code>creatorFunctionType</code>.  The types simply do not match.</p>\n\n<p>You need to be explicit about the return type of your lambdas so they match the correct signature that <code>creatorFunctionType</code> is expecting, eg:</p>\n\n<pre><code>AgentFactory::AgentFactory()\n{\n    registerAgentType(Enums::AgentType::Predator,\n        []() -&gt; std::unique_ptr&lt;Agent&gt; { return std::make_unique&lt;Predator&gt;(); }\n    );\n    registerAgentType(Enums::AgentType::Prey,\n        []() -&gt; std::unique_ptr&lt;Agent&gt; { return std::make_unique&lt;Prey&gt;(); }\n    );\n}\n</code></pre>\n\n<p>With the above code, the lambdas will now return <code>std::unique_ptr&lt;Agent&gt;</code>, satisfying what <code>creatorFunctionType</code> expects.  And the <code>return</code> statements still work as-is because <code>std::unique_ptr&lt;T&gt;</code> can be initialized with a <code>std::unique_ptr&lt;U&gt;</code> as long as <code>U</code> derives from <code>T</code>, which is true in your case since <code>Predator</code> and <code>Prey</code> derive from <code>Agent</code>.</p>\n"}], "owner": {"reputation": 135, "user_id": 7313100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ef43515f350e0fa0d926eb360e91eb?s=128&d=identicon&r=PG&f=1", "display_name": "Michael S.", "link": "https://stackoverflow.com/users/7313100/michael-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 56367350, "answer_count": 1, "score": 0, "last_activity_date": 1559158978, "creation_date": 1559154465, "last_edit_date": 1559155707, "question_id": 56366556, "link": "https://stackoverflow.com/questions/56366556/factory-pattern-with-unique-ptr", "title": "Factory pattern with unique_ptr", "body": "<p>I have abstract class Agent, and few derived: Predator, Prey etc. I would like to make a factory, that gives me unique_ptr which I can store in vector of base class.</p>\n\n<p>Problem is, when I have:</p>\n\n<pre><code>using creatorFunctionType = std::unique_ptr&lt;Agent&gt;(*)();\n</code></pre>\n\n<p>this part is ok, but in map I cannot use lambda with:</p>\n\n<pre><code>return std::make_unique&lt;Predator&gt;();\n</code></pre>\n\n<p>But when I am trying to use template:</p>\n\n<pre><code>template &lt;class T&gt;\nusing creatorFunctionType = std::unique_ptr&lt;T&gt;(*)();\n</code></pre>\n\n<p>The rest of functions doesn't compile. I am nearby sure, I missed something important about templates, but no idea what. Can you give me some hints?</p>\n\n<p>Posting full code, may be helpful</p>\n\n<p>AgentFactory.h\n</p>\n\n<pre><code>#include \"Interfaces/Agent.h\"\n#include \"Enums.h\"\n#include &lt;map&gt;\n#include &lt;memory&gt;\n\nclass AgentFactory\n{\npublic:\n    template &lt;class T&gt;\n    using creatorFunctionType = std::unique_ptr&lt;T&gt;(*)();\n\n    AgentFactory();\n    std::unique_ptr&lt;Agent&gt; createAgent(Enums::AgentType agentType);\nprivate:\n    void registerAgentType(Enums::AgentType agentType, creatorFunctionType \n    creatorFunction);\n\n    std::map&lt;Enums::AgentType, creatorFunctionType&gt; factoryRegister;\n};\n</code></pre>\n\n<p>AgentFactory.cpp</p>\n\n<pre><code>#include \"AgentFactory.h\"\n#include \"Predator.h\"\n#include \"Prey.h\"\n\nAgentFactory::AgentFactory()\n{\n    registerAgentType(Enums::AgentType::Predator, []() { return         \n    std::make_unique&lt;Predator&gt;(); });\n    registerAgentType(Enums::AgentType::Prey, []() { return     \n    std::make_unique&lt;Prey&gt;(); });\n}\n\nstd::unique_ptr&lt;Agent&gt; AgentFactory::createAgent(Enums::AgentType \nagentType)\n{\n    if (auto it = factoryRegister.find(agentType); it != \n    factoryRegister.end()) {\n        return it-&gt;second();\n    }\n\n    return nullptr;\n}\n\nvoid AgentFactory::registerAgentType(Enums::AgentType agentType, \ncreatorFunctionType creatorFunction)\n{\n    factoryRegister.insert(std::pair&lt;Enums::AgentType, \n    creatorFunctionType&gt;(agentType, creatorFunction));\n}\n</code></pre>\n\n<p>Compilation errors:</p>\n\n<pre><code>1&gt;d:\\predator-prey\\predator-prey\\agentfactory.h(15): error C2955: 'AgentFactory::creatorFunctionType': use of alias template requires template argument list\n1&gt;d:\\predator-prey\\predator-prey\\agentfactory.h(10): note: see declaration of 'AgentFactory::creatorFunctionType'\n1&gt;d:\\predator-prey\\predator-prey\\agentfactory.h(17): error C3203: 'creatorFunctionType': unspecialized alias template can't be used as a template argument for template parameter '_Ty', expected a real type\n1&gt;d:\\predator-prey\\predator-prey\\agentfactory.cpp(14): error C2064: term does not evaluate to a function taking 0 arguments\n1&gt;d:\\predator-prey\\predator-prey\\agentfactory.cpp(22): error C3203: 'creatorFunctionType': unspecialized alias template can't be used as a template argument for template parameter '_Ty2', expected a real type\n1&gt;d:\\predator-prey\\predator-prey\\agentfactory.cpp(22): fatal error C1903: unable to recover from previous error(s); stopping compilation\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 3092, "user_id": 701263, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f145997aeec8662800ea27abbe7e796a?s=128&d=identicon&r=PG", "display_name": "Kyle", "link": "https://stackoverflow.com/users/701263/kyle"}, "edited": false, "score": 0, "creation_date": 1559154371, "post_id": 56366488, "comment_id": 99336135, "body": "Check out this question that seems relevant: <a href=\"https://stackoverflow.com/questions/236129/how-do-i-iterate-over-the-words-of-a-string\" title=\"how do i iterate over the words of a string\">stackoverflow.com/questions/236129/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11494833"}, "edited": false, "score": 0, "creation_date": 1559154563, "post_id": 56366524, "comment_id": 99336196, "body": "Sorry, I don&#39;t understand. My thoughts were that separate.at(index1) = &#39; &#39;"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1559154700, "post_id": 56366524, "comment_id": 99336253, "body": "@nrhale Your code uses a variable, but that variable has no value. You never assigned anything to <code>index1</code>."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 2, "last_activity_date": 1559154341, "creation_date": 1559154341, "answer_id": 56366524, "question_id": 56366488, "link": "https://stackoverflow.com/questions/56366488/how-can-i-remove-all-white-space-in-a-string-and-store-the-data-in-between/56366524#56366524", "title": "How can I remove all white space in a string and store the data in between?", "body": "<p>The first instance of undefined behavior is here:</p>\n\n<pre><code>    unsigned short index1, ...\n\n    while (separate.at(index1) ...\n//                     ^^^^^^\n</code></pre>\n\n<p><code>index1</code> is not initialized.</p>\n"}, {"tags": [], "owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "is_accepted": true, "score": 1, "last_activity_date": 1559155599, "creation_date": 1559155599, "answer_id": 56366784, "question_id": 56366488, "link": "https://stackoverflow.com/questions/56366488/how-can-i-remove-all-white-space-in-a-string-and-store-the-data-in-between/56366784#56366784", "title": "How can I remove all white space in a string and store the data in between?", "body": "<p>This is easily done by using <code>std::istringstream</code>:</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;sstream&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nint main()\n{\n  std::string test = \"  u       65.45\\t\\t   36.12\\t     78.25  0.00\";\n  std::istringstream strm(test);\n  std::string word;\n  std::vector&lt;std::string&gt; words;\n  while (strm &gt;&gt; word)\n      words.push_back(word);\n  for (auto&amp; v : words)\n    std::cout &lt;&lt; v &lt;&lt; \"|\\n\";\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>u|\n65.45|\n36.12|\n78.25|\n0.00|\n</code></pre>\n\n<p><a href=\"https://www.ideone.com/ZlJha8\" rel=\"nofollow noreferrer\">Live Example</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11494833"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 56366784, "answer_count": 2, "score": -1, "last_activity_date": 1559155599, "creation_date": 1559154154, "last_edit_date": 1559155379, "question_id": 56366488, "link": "https://stackoverflow.com/questions/56366488/how-can-i-remove-all-white-space-in-a-string-and-store-the-data-in-between", "title": "How can I remove all white space in a string and store the data in between?", "body": "<p>I am a new programmer (&lt; 1 year) so please forgive if I am making a simple thing complicated.</p>\n\n<p>I'm trying to remove all the white space (the tab and space characters) in a given string and store the data as individual elements in a vector as I go. I also want to account for leading and trailing white space.</p>\n\n<p>I've tried using string methods to move two indexes forward in the string while checking along the way for these characters. I've rewritten the code at least five times so far and I always end up with:</p>\n\n<pre><code>terminate called after throwing an instance of 'std::out_of_range'\n  what():  basic_string::at: __n (which is 7754) &gt;= this-&gt;size() (which is 42)\nAborted (core dumped)\n</code></pre>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\nvoid  makeTokens(string&amp; separate);\n\nint main()\n{\n    string test = \"  u       65.45\\t\\t   36.12\\t     78.25  0.00\";\n\n    makeTokens(test);\n\n    return 0;\n}\n\nvoid  makeTokens(string&amp; separate)\n{\n    vector&lt;string&gt; tokens;\n    unsigned short index1, index2 = 0;\n\n    while (separate.at(index1) == ' ' || separate.at(index1) == '\\t')\n    {\n        index1++;\n        index2 = index1 + 1;\n    }\n\n    while (index2 &lt; separate.length())\n    {\n        if (separate.at(index2) == ' ' || separate.at(index2) == '\\t')\n        {\n            tokens.push_back(separate.substr(index1, index2 - index1));\n\n            index1 = index2;\n\n            while (separate.at(index1) == ' ' || separate.at(index1) == '\\t')\n            {\n                index1++;\n            }\n\n            index2 = index1 + 1;\n        }\n        else\n        {\n            index2++;\n        }\n\n        if (index2 == separate.length() - 1)\n        {\n            if (separate.at(index2) == ' ' || separate.at(index2) == '\\t')\n            {\n                tokens.push_back(separate.substr(index1));\n            }\n        }\n    }\n\n    for (unsigned short i = 0; i &lt; tokens.size(); i++)\n    {\n        cout &lt;&lt; tokens[i] &lt;&lt; \"|\" &lt;&lt; endl;\n    }\n}\n</code></pre>\n\n<p>I want the console to output:</p>\n\n<pre><code>u|\n65.45|\n36.12|\n78.25|\n0.00|\n</code></pre>\n\n<p>If a similar test string were passed, except with white space on the end, I still want the same output.</p>\n\n<p>EDIT:\nI have changed my index declarations to:</p>\n\n<pre><code>unsigned short index1 = 0;\nunsigned short index2 = 0;\n</code></pre>\n\n<p>Now the console outputs:</p>\n\n<pre><code>u|\n65.45|\n36.12|\n78.25|\n</code></pre>\n\n<p>The final 0.00 is still missing.</p>\n"}, {"tags": ["c++", "exec", "c++17", "executable"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1559154234, "post_id": 56366487, "comment_id": 99336080, "body": "see: <a href=\"https://stackoverflow.com/questions/29001583/simple-c-cross-platform-way-to-execute-an-external-program\" title=\"simple c cross platform way to execute an external program\">stackoverflow.com/questions/29001583/&hellip;</a>"}, {"owner": {"reputation": 191, "user_id": 10251509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74014bfe136c3d0e9e8eda36316922e6?s=128&d=identicon&r=PG&f=1", "display_name": "Darth Moon", "link": "https://stackoverflow.com/users/10251509/darth-moon"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1559154420, "post_id": 56366487, "comment_id": 99336151, "body": "@Rakete1111 Pretty nice, I like the idea to go with a thread. But antivirus software will not like it to actually see a <code>system</code> call in my program, will it?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1559154818, "post_id": 56366487, "comment_id": 99336297, "body": "@DarthMoon You gotta face it. There&#39;s no portable c++ way to start a subprocess, and keep control of all its standard IO or exit status. There are a number of 3rd party libraries though, which will abstract out the OS dependent stuff for you."}, {"owner": {"reputation": 191, "user_id": 10251509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74014bfe136c3d0e9e8eda36316922e6?s=128&d=identicon&r=PG&f=1", "display_name": "Darth Moon", "link": "https://stackoverflow.com/users/10251509/darth-moon"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1559155129, "post_id": 56366487, "comment_id": 99336404, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6 Well, actually I mentioned that OS abstraction via preprocessor directives could do what I want. I must only know something like &quot;on windows, it&#39;s function X, on Linux Y and on BSD Z&quot;"}, {"owner": {"reputation": 191, "user_id": 10251509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74014bfe136c3d0e9e8eda36316922e6?s=128&d=identicon&r=PG&f=1", "display_name": "Darth Moon", "link": "https://stackoverflow.com/users/10251509/darth-moon"}, "edited": false, "score": 0, "creation_date": 1559155225, "post_id": 56366487, "comment_id": 99336448, "body": "But yeah, a simple and tiny library would really help me a lot! Any suggestions?"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 1, "creation_date": 1559155404, "post_id": 56366487, "comment_id": 99336518, "body": "Start with a thread and <code>system()</code> as in the suggestion @Rakete1111 linked to. It&#39;s ugly but should get you going. If that doesn&#39;t cut it, you can easily replace it with a lib or something selfmade later (although Windows <code>CreateProcess</code> takes a while to master). <code>system()</code> is definitely the most portable way though."}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1559155456, "post_id": 56366487, "comment_id": 99336536, "body": "It&#39;s useless to spend so much time and energy in something that can never be as portable as you &#39;d wish. It&#39;s easier to create 30 lines of code that would work than trying to create 5 lines of code that won&#39;t. It&#39;s also no worth using a 3rd party library just for that."}, {"owner": {"reputation": 191, "user_id": 10251509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74014bfe136c3d0e9e8eda36316922e6?s=128&d=identicon&r=PG&f=1", "display_name": "Darth Moon", "link": "https://stackoverflow.com/users/10251509/darth-moon"}, "edited": false, "score": 0, "creation_date": 1559155773, "post_id": 56366487, "comment_id": 99336692, "body": "Please tell me more about these libraries"}, {"owner": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "edited": false, "score": 0, "creation_date": 1559156132, "post_id": 56366487, "comment_id": 99336821, "body": "I&#39;d go for <code>libuv</code>, although it may be overkill for just starting processes."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1559156178, "post_id": 56366487, "comment_id": 99336837, "body": "concerning your worries about <code>system()</code> this might be of interest: <a href=\"https://stackoverflow.com/questions/8086071/are-system-calls-evil\" title=\"are system calls evil\">stackoverflow.com/questions/8086071/are-system-calls-evil</a> . <code>system()</code> is certainly not evil, but it comes with a potential serurity risk. Imho it is just fine as long as you are aware what you are dealing with"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559156763, "post_id": 56366487, "comment_id": 99337097, "body": "@formerlyknownas_463035818 I agree. I dislike <code>system</code> very much for many reasons. Security is one (where everything in the environment, <code>PATH</code>, <code>LD_LIBRARY_PATH</code> etc which are platform dependent)  needs to be either set or whilelisted to obtain some sort of security -  and that it&#39;s not possible to bypass the shell and its argument splitting support and supply the command and its arguments as separate arguments to system (or an array of arguments)."}, {"owner": {"reputation": 10444, "user_id": 235472, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/2RJ8I.png?s=128&g=1", "display_name": "Pietro", "link": "https://stackoverflow.com/users/235472/pietro"}, "edited": false, "score": 0, "creation_date": 1582209916, "post_id": 56366487, "comment_id": 106705447, "body": "Try not to reinvent the wheel. Even if processes are not part of Standard C++, they are available in <a href=\"https://www.boost.org/doc/libs/1_72_0/doc/html/process.html\" rel=\"nofollow noreferrer\">Boost</a> and <a href=\"https://pocoproject.org/slides/150-Processes.pdf\" rel=\"nofollow noreferrer\">POCO</a>, without the issues of <code>system()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": false, "score": 3, "last_activity_date": 1559156868, "last_edit_date": 1559156868, "creation_date": 1559156139, "answer_id": 56366888, "question_id": 56366487, "link": "https://stackoverflow.com/questions/56366487/most-portable-way-to-start-other-executable/56366888#56366888", "title": "Most portable way to start other executable", "body": "<p>Make your own portable way to do it:</p>\n\n<pre><code>#include &lt;cstdlib&gt;\n#include &lt;iostream&gt;\n#include &lt;string_view&gt;\n#include &lt;thread&gt;\n\nauto mysystem(const std::string_view cmdline, bool detach = false) {\n    std::thread retval = std::thread([cmdline] { std::system(cmdline.data()); });\n    if(detach) retval.detach();\n    return retval;\n}\n\nint main() {\n    auto t = mysystem(\"find /\");\n    t.join();\n    // or\n    mysystem(\"find /\", true); // to detach the thread and therefore process\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 191, "user_id": 10251509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74014bfe136c3d0e9e8eda36316922e6?s=128&d=identicon&r=PG&f=1", "display_name": "Darth Moon", "link": "https://stackoverflow.com/users/10251509/darth-moon"}, "edited": false, "score": 0, "creation_date": 1559157634, "post_id": 56367129, "comment_id": 99337444, "body": "Nice and clean answer. Will an antivirus program declare my C++ program infected because of the <code>system</code> call?"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 191, "user_id": 10251509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74014bfe136c3d0e9e8eda36316922e6?s=128&d=identicon&r=PG&f=1", "display_name": "Darth Moon", "link": "https://stackoverflow.com/users/10251509/darth-moon"}, "edited": false, "score": 0, "creation_date": 1559157672, "post_id": 56367129, "comment_id": 99337470, "body": "@DarthMoon I don&#39;t know. If you have an antivirus program, you could try it out."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 3, "last_activity_date": 1559157292, "creation_date": 1559157292, "answer_id": 56367129, "question_id": 56366487, "link": "https://stackoverflow.com/questions/56366487/most-portable-way-to-start-other-executable/56367129#56367129", "title": "Most portable way to start other executable", "body": "<blockquote>\n  <p>Most portable way to start other executable</p>\n</blockquote>\n\n<p>The C++ standard library has only <code>std::system</code>, <a href=\"https://en.cppreference.com/w/cpp/utility/program/system\" rel=\"nofollow noreferrer\">which</a>:</p>\n\n<blockquote>\n  <p>Calls the host environment's command processor (e.g. /bin/sh, cmd.exe, command.com) with the parameter command. Returns an implementation-defined value (usually the value that the invoked program returns).</p>\n</blockquote>\n\n<p>It is available on all conforming systems, but the shell syntax will be implementation defined. Using simply a path to an executable should be fairly portable.</p>\n\n<p>It has potential shortcomings however:</p>\n\n<ul>\n<li>You cannot avoid spawning a subprocess in case you don't want it.</li>\n<li>You cannot avoid executing the shell, which has potential for command injection if user defined input is involved.</li>\n</ul>\n\n<hr>\n\n<p>The POSIX standard specifies <code>exec</code> <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/exec.html\" rel=\"nofollow noreferrer\">which is</a>:</p>\n\n<blockquote>\n  <p>The exec family of functions shall replace the current process image with a new process image.</p>\n</blockquote>\n\n<p>This is a lower level function, which can be used like <code>system</code>, but you need to take care of creating a subprocess yourself if you need one.</p>\n\n<p>But POSIX standard is not supported by all operating systems, most notably not by Windows. Windows apparently does have <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/execv-wexecv?view=vs-2019\" rel=\"nofollow noreferrer\"><code>_execv</code></a> in its POSIX compatibility layer (note that POSIX functions are prefixed with an underscore), however it has a limitation:</p>\n\n<blockquote>\n  <p>This API cannot be used in applications that execute in the Windows Runtime.</p>\n</blockquote>\n\n<p>Furthermore, in case you do wish to spawn a subprocess, and keep the original running, there is no standard way of creating a subprocess in standard C++.</p>\n\n<p>POSIX specifies <code>fork</code> (and <code>spawn</code> which combines <code>fork</code> and <code>exec</code>). Windows has its own API.</p>\n\n<hr>\n\n<p>So, given the lack of a common standard, the way to portably start another executable (possibly in a subprocess) is to use pre-defined macros to detect the target system, and implement the functionality separatenly against each API's that you wish to support.</p>\n\n<p>Or use <code>std::system</code>, if its shortcomings are not a problem.</p>\n"}], "owner": {"reputation": 191, "user_id": 10251509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74014bfe136c3d0e9e8eda36316922e6?s=128&d=identicon&r=PG&f=1", "display_name": "Darth Moon", "link": "https://stackoverflow.com/users/10251509/darth-moon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 1, "closed_date": 1559173791, "accepted_answer_id": 56367129, "answer_count": 2, "score": -1, "last_activity_date": 1559230302, "creation_date": 1559154145, "last_edit_date": 1559230302, "question_id": 56366487, "link": "https://stackoverflow.com/questions/56366487/most-portable-way-to-start-other-executable", "closed_reason": "Needs more focus", "title": "Most portable way to start other executable", "body": "<p>Edit: I will just use <code>system</code> with a <code>std::filesystem::path</code> as it is portable and quite simple. Since my program will probably not need any administrator privileges, I am sure this is not going to end with trouble.</p>\n\n<hr>\n\n<p>After a lot of research and a lot of tries I found out how to start an other program directly from C++. Unfortunately, there are so many different ways to do so, good ugly <code>system</code>, old posix <code>spawn</code> and platform-specific WinAPI.</p>\n\n<p>I really would like to make my executable as portable as possible. I cannot use <code>system</code> due to it's security lacks, can I? WinAPI only works on Windows, but my favourite, the bunch of <code>spawn</code> functions, do also not work, do just not response, at least under Windows 10.</p>\n\n<p>So what would be the best and most portable approach to run a program from C++? Is there an all-in-one function for this? Or should I run the preprocessor and check for Win- or Non-Win-OS?</p>\n\n<p>Any code snippet is welcome!</p>\n"}, {"tags": ["c++", "boost-asio", "future", "boost-thread"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11574330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea01647229cc4bd55d3e07aee33436ff?s=128&d=identicon&r=PG&f=1", "display_name": "MSDNE", "link": "https://stackoverflow.com/users/11574330/msdne"}, "edited": false, "score": 0, "creation_date": 1559229631, "post_id": 56367807, "comment_id": 99362393, "body": "Thank you for the answer. Now I feel kind of stupid, since I should know this. I guess didn&#39;t see the forest for all the trees, because I tried to avoid multiple threads (complicated reasons, short explanation: existing codebase, refactoring at the moment, not threadsafe, goal is to get there) I have now put all scheduling/timers in a second thread and results of operations are sent via callback-functions to the callers."}, {"owner": {"reputation": 647, "user_id": 9773285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e95570197a5ef8f4a067a3669c09143?s=128&d=identicon&r=PG&f=1", "display_name": "Mark A", "link": "https://stackoverflow.com/users/9773285/mark-a"}, "reply_to_user": {"reputation": 13, "user_id": 11574330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea01647229cc4bd55d3e07aee33436ff?s=128&d=identicon&r=PG&f=1", "display_name": "MSDNE", "link": "https://stackoverflow.com/users/11574330/msdne"}, "edited": false, "score": 0, "creation_date": 1559229964, "post_id": 56367807, "comment_id": 99362614, "body": "Heh, no problem.  I&#39;ve found that using callbacks is a good least-common-denominator approach for handling async results.  It gives you the option of chaining on another async request or to just stuff the result in a promise that some other thread is waiting for."}], "tags": [], "owner": {"reputation": 647, "user_id": 9773285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e95570197a5ef8f4a067a3669c09143?s=128&d=identicon&r=PG&f=1", "display_name": "Mark A", "link": "https://stackoverflow.com/users/9773285/mark-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1559160612, "creation_date": 1559160612, "answer_id": 56367807, "question_id": 56366458, "link": "https://stackoverflow.com/questions/56366458/boostasio-no-handler-called-when-using-post-works-when-function-called-dire/56367807#56367807", "title": "boost::asio no handler called when using post(), works when function called directly (io_context has work)", "body": "<p>You've only got one thread that's calling <code>io_service::run</code>.</p>\n\n<p><code>post()</code> executes the function you give it from within the io_service on one of the io_service's threads. The function that you're trying to run within the io_service's main loop (<code>RequestHandler::RequestService</code>) is a blocking function that is waiting for promise to be fulfilled by the work that's supposed to execute on the io_service's thread. This will never complete because you've blocked the io_service's thread.</p>\n\n<p>This is one of the primary mistakes to you need to avoid when using ASIO or any async framework. Never block in the thread that is processing your events because you can introduce subtle (or not-so-subtle) deadlocks like this.</p>\n"}], "owner": {"reputation": 13, "user_id": 11574330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea01647229cc4bd55d3e07aee33436ff?s=128&d=identicon&r=PG&f=1", "display_name": "MSDNE", "link": "https://stackoverflow.com/users/11574330/msdne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 1, "accepted_answer_id": 56367807, "answer_count": 1, "score": 1, "last_activity_date": 1559160612, "creation_date": 1559154010, "last_edit_date": 1559156038, "question_id": 56366458, "link": "https://stackoverflow.com/questions/56366458/boostasio-no-handler-called-when-using-post-works-when-function-called-dire", "title": "boost::asio no handler called when using post(), works when function called directly (io_context has work)", "body": "<p>I am trying to periodically trigger a request from an application to a server by using a timer. The called function waits for completion by utilizing boost::promise (In case it is called manually and a success state is required to be displayed). When starting up I call the function directly and it completes without problem. Then a timer calls it again periodically but when initiated via deadline_timer the promise never gets fulfilled. </p>\n\n<p>When calling via .post() the connection to the server is opened but on the client side the handle_connect handler is never triggered. The io_context has work assigned.</p>\n\n<p>I have already tried moving the promise to the ServiceRequest-class instead of passing a refernce and also implementing it as a class member to rule out lifetime problems.</p>\n\n<p>I have reduced the whole problem to a minimum example of the failing code:</p>\n\n<p>(Demos on Coliru: <a href=\"http://coliru.stacked-crooked.com/a/b2f55ff5316af21e\" rel=\"nofollow noreferrer\">Working (via direct call)</a>, <a href=\"http://coliru.stacked-crooked.com/a/5dfa6a9e73ebe679\" rel=\"nofollow noreferrer\">Failing (via post)</a>)</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class ServiceRequest : public boost::enable_shared_from_this&lt;ServiceRequest&gt;\n{\n    public:\n\n        ServiceRequest(boost::asio::io_service&amp; io_service, Client&amp; client, boost::promise&lt;bool&gt;&amp; promise)\n          : io_service_(io_service),\n            socket_(io_service_),\n            client_(client),\n            promise_(promise)\n        {}\n\n        ~ServiceRequest()\n        {}\n\n        void Start()\n        {\n            socket_.async_connect(\n                boost::asio::ip::tcp::endpoint(boost::asio::ip::address::from_string(\"127.0.0.1\"), 3005),\n                boost::bind(&amp;ServiceRequest::handle_connect,\n                            shared_from_this(),\n                            boost::asio::placeholders::error\n                )\n            );\n        }\n\n    private: \n\n        void handle_connect(const boost::system::error_code&amp; ec)\n        {\n            if(!ec)\n            {\n                promise_.set_value(true);\n\n                boost::asio::async_write(socket_,\n                                         boost::asio::buffer(\"Test\"),                                                \n                                         boost::bind(&amp;ServiceRequest::close_socket, \n                                                     shared_from_this())\n                                        );              \n\n            }\n            else\n            {           \n                promise_.set_value(false);\n            }           \n        }\n\n        void close_socket()\n        {\n            socket_.shutdown(boost::asio::ip::tcp::socket::shutdown_both);              \n            socket_.close();                                                        \n        }\n\n        boost::asio::io_service&amp;        io_service_;\n        boost::asio::ip::tcp::socket    socket_;\n        Client&amp;                         client_;\n        boost::promise&lt;bool&gt;&amp;           promise_;       \n\n};\n\nclass RequestHandler\n{\n\n    public:\n\n        RequestHandler(boost::asio::io_service&amp; io_service, Client&amp; client)\n          : io_service_(io_service),\n            client_(client)\n        {}\n\n        ~RequestHandler()\n        {}\n\n        bool RequestService()\n        {\n\n            boost::promise&lt;bool&gt; promise;\n            boost::shared_ptr&lt;ServiceRequest&gt; service_request = boost::make_shared&lt;ServiceRequest&gt;(io_service_, client_, promise);\n            service_request-&gt;Start();\n\n            bool result = promise.get_future().get();\n\n            return result;          \n        }\n\n    private:\n\n        boost::asio::io_service&amp;    io_service_;\n        Client&amp;                     client_;\n\n};\n\nclass Client {\n\n    public:\n\n        Client()\n          : io_service_(),\n            work_(io_service_),\n            thread_group_(),\n            timer_(io_service_),\n            request_handler_(io_service_, *this)\n        {\n            thread_group_.create_thread(boost::bind(&amp;boost::asio::io_service::run, &amp;io_service_));\n        }\n\n        ~Client()\n        {\n            io_service_.stop();\n            thread_group_.join_all();\n        }\n\n        void RequestService()\n        {\n            io_service_.post(boost::bind(&amp;RequestHandler::RequestService, &amp;request_handler_));  // &lt;&lt;--- deadlocks at promise.get_future().get()\n            request_handler_.RequestService(); // &lt;&lt;--- works\n            timer_.expires_from_now(boost::posix_time::seconds(10));\n            timer_.async_wait(boost::bind(&amp;Client::RequestService, this)); // &lt;&lt;--- deadlocks at promise.get_future().get()\n        }\n\n    private:\n\n        boost::asio::io_service         io_service_;\n        boost::asio::io_service::work   work_;\n        boost::thread_group             thread_group_;\n        boost::asio::deadline_timer     timer_;\n        RequestHandler                  request_handler_;\n\n};\n\nint main()\n{\n    Client client;\n    client.RequestService();    \n    return 0;\n}\n</code></pre>\n\n<p>When calling request_handler_.RequestService() directly everything works as expected. The handler tracking of boost::asio shows as expected:</p>\n\n<pre><code>@asio|1559149650.446538|0*1|socket@00000000007b9d40.async_connect\n@asio|1559149650.456538|&gt;1|ec=system:0\n@asio|1559149650.456538|1*2|socket@00000000007b9d40.async_send\n@asio|1559149650.456538|&lt;1|\n@asio|1559149650.456538|&gt;2|ec=system:0,bytes_transferred=5\n@asio|1559149650.456538|2|socket@00000000007b9d40.close\n@asio|1559149650.456538|&lt;2|\n</code></pre>\n\n<p>When using .post() or a deadline timer to call RequestService() the handler tracker shows:</p>\n\n<pre><code>@asio|1559149477.071693|0*1|io_context@000000000022fd90.post\n@asio|1559149477.071693|&gt;1|\n@asio|1559149477.071693|1*2|socket@00000000007b9e10.async_connect\n</code></pre>\n\n<p>So the connection is established but the handler is not triggered and therefore no promise.set_value(bool) is called and the whole thing locks up.</p>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["c++", "glsl", "shader", "sfml", "fragment-shader"], "comments": [{"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1559153882, "post_id": 56366341, "comment_id": 99335938, "body": "The shader compiler errors seem self-explanatory enough. Are you sure that <code>iChannel0..3</code> is legal? What happens when you change that and add a <code>#version XXX</code> directive?"}, {"owner": {"reputation": 63, "user_id": 11310945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fe5995d91ec48234c4f078a8204b7ed?s=128&d=identicon&r=PG&f=1", "display_name": "SeanAbner", "link": "https://stackoverflow.com/users/11310945/seanabner"}, "reply_to_user": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1559155610, "post_id": 56366341, "comment_id": 99336604, "body": "It&#39;s not compiling due to those errors yes, I&#39;m trying to find out what converts to what for SFML. The iChannel sampler is what OpenGL uses to bind texture bits to shaders but I&#39;m not sure what to the equivalent for sfml is. Messing with the #version directive hasn&#39;t gotten anything, trying different ways to define it."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1559156943, "post_id": 56366341, "comment_id": 99337176, "body": "As far as I know, SFML doesn&#39;t do anything special with shaders; it just wraps a set of pure OpenGL calls. <a href=\"https://www.sfml-dev.org/tutorials/2.5/graphics-shader.php#minimal-shaders\" rel=\"nofollow noreferrer\">The documentation</a> describes the most basic ins and outs of vertex and fragment shaders for SFML, but I can&#39;t spot anything specific to SFML."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1559158024, "post_id": 56366341, "comment_id": 99337580, "body": "After doing some searching, it appears <code>SamplerXX</code> is unique to ShaderToy. You&#39;re not the first one to have this problem. My guess is that ShaderToy does some kind of non-standard, non-portable text substitution and replaces <code>iChannel0..3</code> with something like <code>iChannel0, iChannel1, iChannel2, iChannel3</code>, but that&#39;s a shot in the dark. <code>SamplerXX</code> probably gets replaced with <code>Sampler2D</code> or <code>SamplerCube</code> but I couldn&#39;t tell you how."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1559158123, "post_id": 56366341, "comment_id": 99337622, "body": "It wouldn&#39;t be the first coding website to do something weird and hackish like this either. <a href=\"https://stackoverflow.com/questions/55269252/what-is-going-on-with-getsstdin-on-the-site-coderbyte\" title=\"what is going on with getsstdin on the site coderbyte\">stackoverflow.com/questions/55269252/&hellip;</a>"}, {"owner": {"reputation": 63, "user_id": 11310945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fe5995d91ec48234c4f078a8204b7ed?s=128&d=identicon&r=PG&f=1", "display_name": "SeanAbner", "link": "https://stackoverflow.com/users/11310945/seanabner"}, "reply_to_user": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1559159468, "post_id": 56366341, "comment_id": 99338190, "body": "Alright I edited the sampler from &quot;samplerXX&quot; to &quot;sampler2D&quot; and it did fix that issue. The problem from there came that it was failing to link the shader. There was no definition to the void main().  When I add the empty main method the shader loads without errors."}, {"owner": {"reputation": 63, "user_id": 11310945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fe5995d91ec48234c4f078a8204b7ed?s=128&d=identicon&r=PG&f=1", "display_name": "SeanAbner", "link": "https://stackoverflow.com/users/11310945/seanabner"}, "reply_to_user": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1559159796, "post_id": 56366341, "comment_id": 99338310, "body": "Edited to show new issues."}], "owner": {"reputation": 63, "user_id": 11310945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fe5995d91ec48234c4f078a8204b7ed?s=128&d=identicon&r=PG&f=1", "display_name": "SeanAbner", "link": "https://stackoverflow.com/users/11310945/seanabner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 491, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559161201, "creation_date": 1559153455, "last_edit_date": 1559161201, "question_id": 56366341, "link": "https://stackoverflow.com/questions/56366341/porting-a-shader-to-sfml", "title": "Porting a Shader to SFML", "body": "<p>I don't have much experience with Shader or GLSL. I am trying to practice with them. To this end I'm trying to port this shader.\n<a href=\"https://www.shadertoy.com/view/XsXGR7\" rel=\"nofollow noreferrer\">https://www.shadertoy.com/view/XsXGR7</a>\nInto a project to use with SFML. I am having issue doing this and I'm not sure what to do to start fixing the issues.</p>\n\n<p>I messed around with the uniforms and a few varaiable but the shader itself keeps giving the same error message. That it won't compile. Not sure why, I assume it's because without converting it to work with SFML it's asking for input from OpenGL.</p>\n\n<p>Shader file</p>\n\n<pre><code>   uniform vec3      iResolution;           // viewport resolution (in pixels)\n   uniform float     iTime;                 // shader playback time (in seconds)\n   uniform float     iTimeDelta;            // render time (in seconds)\n   uniform int       iFrame;                // shader playback frame\n   uniform float     iChannelTime[4];       // channel playback time (in seconds)\n    uniform vec3      iChannelResolution[4]; // channel resolution (in pixels)\n    uniform vec4      iMouse;                // mouse pixel coords. xy: current (if MLB down), zw: click\n    uniform samplerXX iChannel0..3;          // input channel. XX = 2D/Cube\n    uniform vec4      iDate;                 // (year, month, day, time in seconds)\n    uniform float     iSampleRate;           // sound sample rate (i.e., 44100)\n\n    void mainImage( out vec4 fragColor, in vec2 fragCoord )\n    {\n     vec3 waveParams = vec3( 10.0, 0.8, 0.1 );\n     vec2 tmp = vec2( iMouse.xy / iResolution.xy );\n     vec2 uv = fragCoord.xy / iResolution.xy;\n     vec2 texCoord = uv;\n     float distance = distance(uv, tmp);\n\n     if ( (distance &lt;= ((iTime ) + waveParams.z )) &amp;&amp; ( distance &gt;= ((iTime ) - waveParams.z)) ) \n     {\n            float diff = (distance - (iTime)); \n            float powDiff = 1.0 - pow(abs(diff*waveParams.x), waveParams.y); \n\n            float diffTime = diff  * powDiff; \n            vec2 diffUV = normalize(uv - tmp); \n            texCoord = uv + (diffUV * diffTime);\n\n     } \n     vec4 original = texture( iChannel0, texCoord);\n     fragColor = original; \n   }\n</code></pre>\n\n<p>Currently all the shader does is get loaded in.</p>\n\n<pre><code>shader.loadFromFile(\"ASSETS/SHADERS/Shockwave1.txt\",sf::Shader::Fragment);    \n //load the shader\n\nif (!shader.isAvailable()) {\n std::cout &lt;&lt; \"The shader is not available\\n\";\n}\n\n</code></pre>\n\n<p>Error message trying to load the above shader. No uniforms set, nothing is done with the shader aside from loading it.</p>\n\n<pre><code>   Failed to compile fragment shader:\n   WARNING: 0:1 '' : #version directive missing\n   ERROR: 0:8 'iChannel0 : syntax error syntax error\n</code></pre>\n\n<p>Edit:</p>\n\n<p>Having replaced \"samplerXX\" with \"sampler2D\" and inserted a void main() function the shader loads properly. Getting the code to work is now the issue.</p>\n\n<p>The Main()</p>\n\n<pre><code>void main(out vec4 fragColor, in vec2 fragCoord )\n{\n     vec3 waveParams = vec3( 10.0, 0.8, 0.1 );\n     vec2 tmp = vec2( iMouse.xy / iResolution.xy );\n     vec2 uv = fragCoord.xy / iResolution.xy;\n     vec2 texCoord = uv;\n     float distance = distance(uv, tmp);\n\n     if ( (distance &lt;= ((iTime ) + waveParams.z )) &amp;&amp; ( distance &gt;= ((iTime ) - waveParams.z)) ) \n     {\n            float diff = (distance - (iTime)); \n            float powDiff = 1.0 - pow(abs(diff*waveParams.x), waveParams.y); \n\n            float diffTime = diff  * powDiff; \n            vec2 diffUV = normalize(uv - tmp); \n            texCoord = uv + (diffUV * diffTime);\n\n     } \n     vec4 original = texture( iChannel0, texCoord);\n     fragColor = original; \n\n}\n</code></pre>\n\n<p>This produces these errors</p>\n\n<pre><code>Failed to compile fragment shader:\nWARNING: 0:1: '' :  #version directive missing\nWARNING: 0:32: 'function' : is not available in current GLSL version texture\nERROR: 0:34: 'main' : function cannot take any parameter(s)\nWARNING: 0:53: 'function' : is not available in current GLSL version texture\n</code></pre>\n\n<p>While the main not taking parameters is straightforward I would like to know would values be passed in strictly using uniforms?  I am not sure what the 'function' errors relate to.</p>\n\n<p>Edit:</p>\n\n<p>Main()</p>\n\n<pre><code>void main( )\n{\n     vec2 fragCoord = vec2(20,20);\n     vec3 waveParams = vec3( 10.0, 0.8, 0.1 );\n     vec2 tmp = vec2( iMouse.xy / iResolution.xy );\n     vec2 uv = fragCoord.xy / iResolution.xy;\n     vec2 texCoord = uv;\n     float distance = distance(uv, tmp);\n\n     if ( (distance &lt;= ((iTime ) + waveParams.z )) &amp;&amp; ( distance &gt;= ((iTime ) - waveParams.z)) ) \n     {\n            float diff = (distance - (iTime)); \n            float powDiff = 1.0 - pow(abs(diff*waveParams.x), waveParams.y); \n\n            float diffTime = diff  * powDiff; \n            vec2 diffUV = normalize(uv - tmp); \n            texCoord = uv + (diffUV * diffTime);\n\n     } \n     vec4 original = texture( iChannel0, texCoord);\n     gl_FragColor = original; \n\n}\n</code></pre>\n\n<p>Removing the main parameters, hardcode defining vec2 fragCoord as vec2(20,20) made the shader run without issue. My question now is this enough to output the shader effect? (Little experience with glsl, sorry if this is a dumb question)</p>\n\n<pre><code> gl_FragColor = original; \n</code></pre>\n\n<p>And if it is this seems to be the position of the pixel to be shaded. Is there a way to pass this in automatically?</p>\n\n<pre><code> vec2 fragCoord\n</code></pre>\n"}, {"tags": ["c++", "regex", "string", "clr"], "comments": [{"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1559153731, "post_id": 56366339, "comment_id": 99335866, "body": "do you just want to know if string matches the regex or do you want to search items using a regex?"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1559153959, "post_id": 56366339, "comment_id": 99335965, "body": "Use <code>sregex_token_iterator</code> or <code>sregex_iterator</code>. Fix your regex, too, but that is not the current issue."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9658871"}, "edited": false, "score": 0, "creation_date": 1559291965, "post_id": 56366339, "comment_id": 99382038, "body": "My pattern captures exactly what I need, thank you very much. What I don&#39;t get is how I can &#39;read&#39; my captures in the <code>std::smatch m;</code> var."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9658871"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559316241, "post_id": 56366339, "comment_id": 99394147, "body": "@LightnessRacesinOrbit Seems likely. Can you write it in an answer so I&#39;ll accept it? Also would it work by placing a <code>GetBuffer()</code> instead of the <code>GetString()</code> ? While I can see the necessity I don&#39;t like using an entire variable for a single line."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559317500, "post_id": 56366339, "comment_id": 99394753, "body": "Yeah I&#39;ve decided that wasn&#39;t a useful dupe. Re-opened and answered."}], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 0, "last_activity_date": 1559317464, "creation_date": 1559317464, "answer_id": 56398121, "question_id": 56366339, "link": "https://stackoverflow.com/questions/56366339/how-to-use-the-result-of-stdregex-search/56398121#56398121", "title": "How to use the result of std::regex_search?", "body": "<p>You are correct that you can just assign the match to a <code>std::string</code>; you don't <em>have</em> to use the stream insertion feature.</p>\n\n<p>However, your third example crashes because <code>std::smatch</code> holds references/handles to positions in the original source data &hellip; which in your crashy case is the temporary <code>strT.GetString()</code> that went out of scope as soon as the regex was done (read <a href=\"https://en.cppreference.com/w/cpp/regex/match_results\" rel=\"nofollow noreferrer\">here</a>).</p>\n\n<p>Your second example is correct.</p>\n\n<p>I concede that the C++ regex implementation is not entirely intuitive at first glance.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9658871"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 56398121, "answer_count": 1, "score": 1, "last_activity_date": 1559317464, "creation_date": 1559153447, "last_edit_date": 1559313810, "question_id": 56366339, "link": "https://stackoverflow.com/questions/56366339/how-to-use-the-result-of-stdregex-search", "title": "How to use the result of std::regex_search?", "body": "<p>I'm simply calling</p>\n\n<pre><code>std::smatch m;\nif (std::regex_search \n  (std::string (strT.GetString ()), \n  m,\n  std::regex (\"((\\\\d[\\\\s_\\\\-.]*){10,13})\")))\n{\n  ...\n}\n</code></pre>\n\n<p>I can't for the life of me figure out how to extract the matched values from m.</p>\n\n<p>EVERY SINGLE page on the subject writes it to cout which is worthless to me. I just want to get what's been captured in a string, but no matter what I try it crashes with a \"string iterators incompatible\" error message.</p>\n\n<p>OK so I tried a few more things and got annoyed at a lot more, most notably about how the same code worked in online testers but not on my computer. I've come down to this</p>\n\n<pre><code>std::string s (strT.GetString ()) ;\nstd::smatch m;\nif (std::regex_search (\n    s, \n    m,\n    std::regex (\"((\\\\d[\\\\s_\\\\-.]*){10,13})\")))\n{\n    std::string v = m[ 0 ] ;\n}\n</code></pre>\n\n<p>working, but this</p>\n\n<pre><code>std::smatch m;\nif (std::regex_search (\n    std::string (strT.GetString ()), \n    m,\n    std::regex (\"((\\\\d[\\\\s_\\\\-.]*){10,13})\")))\n{\n    std::string v = m[ 0 ] ;\n}\n</code></pre>\n\n<p>Not Working For Some Reason (with the incompatible string iterator error thingy).\nThere's surely some trick to it. I'll let someone who knows explain it.</p>\n"}, {"tags": ["c++", "matrix", "cuda", "global-variables", "nvidia"], "comments": [{"owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1559153647, "post_id": 56366268, "comment_id": 99335833, "body": "And what is wrong with <code>cudaMalloc</code> and <code>cudaMemcpy</code>?"}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 2, "creation_date": 1559156365, "post_id": 56366268, "comment_id": 99336912, "body": "If you have multiple <code>malloc</code> statements in your host code as you have shown here, a separate one for each row, there is <b>no safe way</b> to copy that data to the device using only a single <code>cudaMemcpy</code> or <code>cudaMemcpyToSymbol</code> operation.  It cannot be done.  If you want to use a single copy operation, you will need to make some changes.  A large variety of techniques are covered <a href=\"https://stackoverflow.com/questions/45643682/cuda-using-2d-and-3d-arrays/45644824#45644824\">here</a>."}, {"owner": {"reputation": 11, "user_id": 11368476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d89abaf6953040551c6d26ed97b2113?s=128&d=identicon&r=PG&f=1", "display_name": "Armeno", "link": "https://stackoverflow.com/users/11368476/armeno"}, "reply_to_user": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1559156929, "post_id": 56366268, "comment_id": 99337164, "body": "@Ptaq666 it gives &quot;CUDA error: invalid device symbol&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "reply_to_user": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "edited": false, "score": 0, "creation_date": 1559154342, "post_id": 56366465, "comment_id": 99336122, "body": "@user10933809 Such a solution is almost never advisable. Most Heterogenous Computing environments have not-especially-high limits on the number of buffers that can be individually addressed for a single kernel. Unless the OP&#39;s dataset is expressly limited to a very small number (i.e. <code>TRANSACTIONS</code> is less than 100) that kind of solution simply is not viable. What I&#39;ve done is provide a helpful framework to quickly convert their host-side &quot;array of pointers&quot; into a flat array that will fit the data layout that device data buffers expect."}, {"owner": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "edited": false, "score": 0, "creation_date": 1559154589, "post_id": 56366465, "comment_id": 99336207, "body": "no doubt the array must be flattened here. I was just wondering if you could provide a solution with array of pointers as well."}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "reply_to_user": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "edited": false, "score": 0, "creation_date": 1559154980, "post_id": 56366465, "comment_id": 99336360, "body": "@user10933809 As I said: that kind of solution is not viable."}, {"owner": {"reputation": 11, "user_id": 11368476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d89abaf6953040551c6d26ed97b2113?s=128&d=identicon&r=PG&f=1", "display_name": "Armeno", "link": "https://stackoverflow.com/users/11368476/armeno"}, "edited": false, "score": 0, "creation_date": 1559155270, "post_id": 56366465, "comment_id": 99336463, "body": "No it is not rectangular matrix @Xirema."}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "reply_to_user": {"reputation": 11, "user_id": 11368476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d89abaf6953040551c6d26ed97b2113?s=128&d=identicon&r=PG&f=1", "display_name": "Armeno", "link": "https://stackoverflow.com/users/11368476/armeno"}, "edited": false, "score": 0, "creation_date": 1559155806, "post_id": 56366465, "comment_id": 99336706, "body": "@Armeno That&#39;s fine; the solution works as-is provided that the number you pass as the number of columns is equal to the largest row in your input data."}, {"owner": {"reputation": 11, "user_id": 11368476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d89abaf6953040551c6d26ed97b2113?s=128&d=identicon&r=PG&f=1", "display_name": "Armeno", "link": "https://stackoverflow.com/users/11368476/armeno"}, "edited": false, "score": 0, "creation_date": 1559155898, "post_id": 56366465, "comment_id": 99336745, "body": "Thanks @Xirema but I am looking for another method."}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "reply_to_user": {"reputation": 11, "user_id": 11368476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d89abaf6953040551c6d26ed97b2113?s=128&d=identicon&r=PG&f=1", "display_name": "Armeno", "link": "https://stackoverflow.com/users/11368476/armeno"}, "edited": false, "score": 1, "creation_date": 1559156008, "post_id": 56366465, "comment_id": 99336782, "body": "@Armeno Well, if your constraint is &quot;I want to only copy it to device memory once&quot;, I don&#39;t know what other solution exists..."}, {"owner": {"reputation": 11, "user_id": 11368476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d89abaf6953040551c6d26ed97b2113?s=128&d=identicon&r=PG&f=1", "display_name": "Armeno", "link": "https://stackoverflow.com/users/11368476/armeno"}, "reply_to_user": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "edited": false, "score": 0, "creation_date": 1559503344, "post_id": 56366465, "comment_id": 99432144, "body": "@oblivion no.there is no any"}], "tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": true, "score": 2, "last_activity_date": 1559154030, "last_edit_date": 1592644375, "creation_date": 1559154030, "answer_id": 56366465, "question_id": 56366268, "link": "https://stackoverflow.com/questions/56366268/how-to-copy-dynamic-matrix-to-device-memory-in-cuda/56366465#56366465", "title": "How to copy dynamic matrix to device memory in CUDA?", "body": "<h1>You need to Flatten the data</h1>\n<p>If you're only working with rectangular matrices in the first place, I'd recommend always storing your Matrixes like this anyways, but either way, you'll need to get it into this form before trying to push this data to your device memory.</p>\n<pre><code>template&lt;typename T&gt;\nclass Matrix {\n    std::vector&lt;T&gt; _data;\n    size_t rows, columns;\npublic:\n    Matrix(size_t rows, size_t columns) :rows(rows), columns(columns) {\n        _data.resize(rows * columns);\n    }\n\n    T &amp; operator()(size_t row, size_t column) &amp; {\n        return _data.at(row * columns + column); //Row-Major Ordering\n    }\n    \n    T const&amp; operator()(size_t row, size_t column) const&amp; {\n        return _data.at(row * columns + column);\n    }\n\n    T operator() size_t row, size_t column) const {\n        return _data.at(row * columns + column);\n    }\n\n    T * data() &amp; {\n        return _data.data();\n    }\n    \n    T const* data() const&amp; {\n        return _data.data();\n    }\n\n    std::pair&lt;size_t, size_t&gt; size() const {\n        return {rows, columns};\n    }\n\n    size_t flat_size() const {\n        return rows * columns;\n    }\n\n    size_t byte_size() const {\n        return flat_size() * sizeof(T);\n    }\n};\n</code></pre>\n<br/>\n<pre><code>int ** file_data = (int **)malloc(TRANSACTIONS * sizeof(int *));\nfile_data[0] = (int *)malloc((a_size+1) * sizeof(int));\nfile_data[1] = (int *)malloc((a_size+1) * sizeof(int));\nfile_data[2] = (int *)malloc((a_size+1) * sizeof(int));\n//................................................................\n\nMatrix&lt;int&gt; flat_data(TRANSACTIONS, a_size + 1);\nfor(size_t row = 0; row &lt; TRANSACTIONS; row++) {\n    for(size_t column = 0; column &lt; a_size + 1; column++) {\n        flat_data(row, column) = file_data[row][column];\n    }\n}\n//ALTERNATIVE: use this instead of your manual mallocs in the first place!\n\ncudaMemcpyToSymbol(flat_data.data(), /*buffer name*/, flat_data.byte_size());\n</code></pre>\n<p>This has the major advantage that you're not having to copy each row individually into their own buffers, you can put all of them together in memory, saving memory and reducing the number of API calls you need to make. And a class designed specifically to handle your functionality won't break when you inevitably make a mistake trying to manually handle all the pointer management in your original code.</p>\n"}], "owner": {"reputation": 11, "user_id": 11368476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d89abaf6953040551c6d26ed97b2113?s=128&d=identicon&r=PG&f=1", "display_name": "Armeno", "link": "https://stackoverflow.com/users/11368476/armeno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 56366465, "answer_count": 1, "score": 0, "last_activity_date": 1559154030, "creation_date": 1559153118, "question_id": 56366268, "link": "https://stackoverflow.com/questions/56366268/how-to-copy-dynamic-matrix-to-device-memory-in-cuda", "title": "How to copy dynamic matrix to device memory in CUDA?", "body": "<p>In my code I have dynamic matrix.</p>\n\n<pre><code>int ** file_data = (int **)malloc(TRANSACTIONS * sizeof(int *));\nfile_data[0] = (int *)malloc((a_size+1) * sizeof(int));\nfile_data[1] = (int *)malloc((a_size+1) * sizeof(int));\nfile_data[2] = (int *)malloc((a_size+1) * sizeof(int));\n................................................................\n</code></pre>\n\n<p>I want to copy it to device global memory only once.</p>\n\n<p>I have used:</p>\n\n<pre><code>__device__ int raw_data[][];\n...................................\n...................................\n...................................\ncudaMemcpyToSymbol(raw_data[i], file_data[i], (a_size+1)*sizeof(int));\n</code></pre>\n\n<p>But this do not works.</p>\n\n<p>How can I do it?</p>\n"}, {"tags": ["c++", "linux", "qt", "qt5"], "answers": [{"comments": [{"owner": {"reputation": 604, "user_id": 1205340, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e7273304eb7892b2ee4edaf4bb094f72?s=128&d=identicon&r=PG", "display_name": "Darin Beaudreau", "link": "https://stackoverflow.com/users/1205340/darin-beaudreau"}, "edited": false, "score": 0, "creation_date": 1559564080, "post_id": 56385855, "comment_id": 99448824, "body": "That&#39;s exactly what I was looking for! Thank you!"}, {"owner": {"reputation": 604, "user_id": 1205340, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e7273304eb7892b2ee4edaf4bb094f72?s=128&d=identicon&r=PG", "display_name": "Darin Beaudreau", "link": "https://stackoverflow.com/users/1205340/darin-beaudreau"}, "edited": false, "score": 0, "creation_date": 1559564211, "post_id": 56385855, "comment_id": 99448895, "body": "However, I do get a segmentation fault when tapping outside the application from the mapFromGlobal() method."}, {"owner": {"reputation": 4406, "user_id": 4911665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4f3ec7f68e33af504b9055abed79b7?s=128&d=identicon&r=PG&f=1", "display_name": "talamaki", "link": "https://stackoverflow.com/users/4911665/talamaki"}, "reply_to_user": {"reputation": 604, "user_id": 1205340, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e7273304eb7892b2ee4edaf4bb094f72?s=128&d=identicon&r=PG", "display_name": "Darin Beaudreau", "link": "https://stackoverflow.com/users/1205340/darin-beaudreau"}, "edited": false, "score": 0, "creation_date": 1559564759, "post_id": 56385855, "comment_id": 99449162, "body": "1) do you check targetWidget is not null, 2) you wrote something about screen resolution being smaller that &quot;digitizer&quot; resolution whatever that means... The code snippet is not supposed to be a complete robust solution but to describe how you can solve your problem."}, {"owner": {"reputation": 604, "user_id": 1205340, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e7273304eb7892b2ee4edaf4bb094f72?s=128&d=identicon&r=PG", "display_name": "Darin Beaudreau", "link": "https://stackoverflow.com/users/1205340/darin-beaudreau"}, "edited": false, "score": 0, "creation_date": 1559568406, "post_id": 56385855, "comment_id": 99451170, "body": "No, it was #1. It&#39;s early and I was half-asleep."}], "tags": [], "owner": {"reputation": 4406, "user_id": 4911665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4f3ec7f68e33af504b9055abed79b7?s=128&d=identicon&r=PG&f=1", "display_name": "talamaki", "link": "https://stackoverflow.com/users/4911665/talamaki"}, "is_accepted": true, "score": 2, "last_activity_date": 1559279591, "last_edit_date": 1559279591, "creation_date": 1559251680, "answer_id": 56385855, "question_id": 56366180, "link": "https://stackoverflow.com/questions/56366180/how-to-simulate-a-mouse-click-with-touch-data/56385855#56385855", "title": "How to simulate a mouse click with touch data?", "body": "<p>You wrote that you sometimes get your message box \"clicked\" when your fingers are in a \"wrong position\" so it sounds like you a mixing global screen coordinates and widget local coordinates. It seems, in your <code>MainWindow::touch</code> you try to check if a point in global screen coordinates, e.g. (530, 815) is inside a widget's geometry (in its local coordinates). <a href=\"https://doc.qt.io/qt-5/qwidget.html#rect-prop\" rel=\"nofollow noreferrer\">QWidget::rect()</a> returns internal geometry of the button (widget), i.e. a rectangle of widget's width and height, e.g. (0, 0, 60, 100).</p>\n\n<p>You have to move the rect to a right position in global screen coordinates. <a href=\"https://doc.qt.io/qt-5/qwidget.html#pos-prop\" rel=\"nofollow noreferrer\">QWidget::pos()</a> returns widget local position to its parent. You can use <a href=\"https://doc.qt.io/qt-5/qwidget.html#mapToGlobal\" rel=\"nofollow noreferrer\">QWidget::mapToGlobal</a> to translate widget coordinate position to global screen coordinates. Then your rect is something like (500, 850, 60, 100) and you should get a hit and get your slot called.</p>\n\n<p>However, better approach is to use <a href=\"https://doc.qt.io/qt-5/qapplication.html#widgetAt\" rel=\"nofollow noreferrer\">QApplication::widgetAt</a> to get the widget in a specific screen position and generate a mouse click for it.</p>\n\n<p>You can generate a mouse click for a widget by posting a mouse press and release to it, something like below:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>QPoint screenPos = QPoint(tp.getX(), tp.getY());\nQWidget *targetWidget = QApplication::widgetAt(screenPos);\n\nQPoint localPos = targetWidget-&gt;mapFromGlobal(screenPos); \nQMouseEvent *eventPress = new QMouseEvent(QEvent::MouseButtonPress, localPos, screenPos, Qt::LeftButton, Qt::LeftButton,  Qt::NoModifier);\nQApplication::postEvent(targetWidget, eventPress);\nQMouseEvent *eventRelease = new QMouseEvent(QEvent::MouseButtonRelease, localPos, screenPos, Qt::LeftButton, Qt::LeftButton,  Qt::NoModifier);\nQApplication::postEvent(targetWidget, eventRelease);\n</code></pre>\n"}], "owner": {"reputation": 604, "user_id": 1205340, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e7273304eb7892b2ee4edaf4bb094f72?s=128&d=identicon&r=PG", "display_name": "Darin Beaudreau", "link": "https://stackoverflow.com/users/1205340/darin-beaudreau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 978, "favorite_count": 0, "accepted_answer_id": 56385855, "answer_count": 1, "score": 2, "last_activity_date": 1559279591, "creation_date": 1559152705, "last_edit_date": 1559247413, "question_id": 56366180, "link": "https://stackoverflow.com/questions/56366180/how-to-simulate-a-mouse-click-with-touch-data", "title": "How to simulate a mouse click with touch data?", "body": "<p>I'm working on a Qt5 application to attempt to make use of raw input data from a touchscreen because touch is not fully supported by my Linux kernel (2.6.32). I wrote a parser for the raw data coming from <strong>/dev/input/eventX</strong> because even though X doesn't support touch, the events are still there.</p>\n\n<p>I'm able to read the events just fine, and wrote a wrapper called \"TouchPoint\" which contains the ID and (x,y) coordinates of each touch point, as well as a boolean indicating whether or not the touch point is currently \"active\" (ie: the user currently has that finger on the screen). <strong>It's worth noting that I also output the number of points of touch currently on the screen, and the value is accurate.</strong></p>\n\n<p>My issue is that I can't seem to figure out how to accurately simulate a mouse click with it. With multi-touch events in Linux, each touch point is assigned a \"tracking ID\" when the user presses a finger to the screen, and when that point is lifted, an event setting that slot's tracking ID to -1 is generated. I use this change of ID from some value to -1 to indicate that a touch point is \"down\" or not:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void TouchPoint::setID(int nid) {\n    if((id == -1) &amp;&amp; (nid &gt;= 0)) down = true;\n    else if(nid == -1) down = false;\n    id = nid;\n}\n</code></pre>\n\n<p>So to try and simulate a mouse click, I do this when a tracking ID event is read:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>else if(event.code == ABS_MT_TRACKING_ID) {\n    bool before = touchPoints[cSlot].isDown(); // where cSlot is the current slot the events are referring to\n    touchPoints[cSlot].setID(event.value);\n    bool after = touchPoints[cSlot].isDown();\n\n    if(!before &amp;&amp; after) touch(touchPoints[cSlot]);\n}\n</code></pre>\n\n<p>And then the touch method does this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void MainWindow::touch(TouchPoint tp) {\n    if(ui-&gt;touchMe-&gt;rect().contains(QPoint(tp.getX(), tp.getY()))) {\n        on_touchMe_clicked();\n    }\n}\n</code></pre>\n\n<p>The button does not respond to me directly touching it, but sometimes if I wildly flail my fingers around the screen, the message box that should show when it's pressed will show, but when it does, my fingers are always somewhere on another area of the screen.</p>\n\n<p>Can anyone think of something I might be doing wrong here? Is my method of checking to see if the touch point is within the button's bounds wrong? Or is my logic for keeping track of the \"down\" status of the touch points wrong? Or something else entirely?</p>\n\n<p><strong>UPDATE:</strong> I just noticed two things by outputting the screen coordinates of both the touch location and the button location.</p>\n\n<ol>\n<li>The digitizer resolution is larger than the screen resolution, so I needed to scale the X and Y coordinates coming from the raw events.</li>\n<li>My coordinates are offset because they are screen coordinates.</li>\n</ol>\n\n<p><strong>UPDATE 2:</strong> I've now dealt with the two issues mentioned in my last update, but I'm still not able to figure out how to accurately simulate a touch/mouse event to be able to interact with the interface. I also modified my TouchPoint class to have a boolean flag indicating whether or not the touch point was just updated, which is set to true when the tracking ID is updated and reset when an EV_SYN event is raised. This is so I can get the X and Y position events before creating the event for the application. I tried the following:</p>\n\n<ol>\n<li>Using the QApplication class to post a mouse event to the QApplication::desktop()->screen() widget that has the position of the touch point.</li>\n<li>Using the QTest class to raise a touchEvent to the QApplication::desktop()->screen() widget using the press and release methods for the given slot and position of the touch point and then using the bool event(QEvent*) method to try to catch the event. I also enabled the WA_AcceptTouchEvents attribute on the main window.</li>\n</ol>\n\n<p>Neither of these works, as for some reason, when I have the <strong>\"bool event(QEvent*)\"</strong> method in place, the signal emitted from the thread reading <strong>/dev/input/eventX</strong> doesn't trigger the slot in the main window class. and I can't seem to find any other method to accomplish simulating the events. Anyone have any ideas?</p>\n"}, {"tags": ["c++", "ros"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1559152777, "post_id": 56366054, "comment_id": 99335452, "body": "Welcome to Stack Overflow. Unfortunately your question doesn&#39;t fit well for the FAQ like intended format here, it&#39;s way to broad. 1.Only one question per question please. 2. Do some research before asking, it&#39;s well documented already whet e.g. the <i>scope resolution operator does</i>, or what <code>boost::bind()</code> is for."}], "answers": [{"tags": [], "owner": {"reputation": 2041, "user_id": 7316365, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/84de9f27708456d85bf1078aa51155b2?s=128&d=identicon&r=PG&f=1", "display_name": "Vivick", "link": "https://stackoverflow.com/users/7316365/vivick"}, "is_accepted": false, "score": 1, "last_activity_date": 1559152806, "creation_date": 1559152806, "answer_id": 56366204, "question_id": 56366054, "link": "https://stackoverflow.com/questions/56366054/dynamic-reconfigure-in-ros/56366204#56366204", "title": "Dynamic Reconfigure in ROS", "body": "<p>The namespace resolution operator allows you to specify a \"path\" to the function/class/variable (by default it uses the global namespace or <a href=\"https://en.cppreference.com/w/cpp/language/adl\" rel=\"nofollow noreferrer\">ADL</a> ; here it denotes the fact that we use the <code>bind</code> from the <code>boost</code> namespace.</p>\n\n<p><code>boost::bind</code> allows you to bind (as a form of <a href=\"https://en.wikipedia.org/wiki/Partial_application\" rel=\"nofollow noreferrer\">Partial Application</a>) parameters of a function.</p>\n\n<p><code>_1</code> and <code>_2</code> are placeholders for <code>boost::bind</code> that tells how to \"route\" the unbound parameters (those not provided as arguments of <code>bind</code>) :</p>\n\n<pre><code>void f(int a, int b);\n\nauto x = boost::bind(f, _1, _2);\nx(1, 2); //a=1 b=2\n\nauto y = boost::bind(f, _2, _1);\ny(1,2); //a=2 b=1\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5744053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9874cbe79e777a488cdeb30b41622ae?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/5744053/nitin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "closed_date": 1559211924, "answer_count": 1, "score": -2, "last_activity_date": 1559152806, "creation_date": 1559152153, "last_edit_date": 1559152455, "question_id": 56366054, "link": "https://stackoverflow.com/questions/56366054/dynamic-reconfigure-in-ros", "closed_reason": "Needs more focus", "title": "Dynamic Reconfigure in ROS", "body": "<p>I am going through the ROS tutorials for Dynamic Reconfigure. I have very little background in C++. I am having trouble understanding some lines in particular.</p>\n\n<p>I have tried to go through some tutorials for C++ and boost but the jargon used is beyond by technical level. \nThe exact lines are as follows:</p>\n\n<pre><code>dynamic_reconfigure::Server&lt;parameter_test::parametersConfig&gt;::CallbackType f;\nf = boost::bind(&amp;callback, _1, _2);\n</code></pre>\n\n<p>My questions are:</p>\n\n<p>1) Could someone explain in simple terms what :: or the namespace resolution operator does?</p>\n\n<p>2) What exactly is boost::bind() and what does it do?</p>\n\n<p>3) What are the arguments _1 and _2 supposed to do?</p>\n\n<p>The link for the complete file is on: </p>\n\n<p><a href=\"http://wiki.ros.org/dynamic_reconfigure/Tutorials/SettingUpDynamicReconfigureForANode%28cpp%29\" rel=\"nofollow noreferrer\">http://wiki.ros.org/dynamic_reconfigure/Tutorials/SettingUpDynamicReconfigureForANode%28cpp%29</a></p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c++", "libusb-1.0"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11574189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/553c63cd29749279daae1636855b17b0?s=128&d=identicon&r=PG&f=1", "display_name": "EYoung", "link": "https://stackoverflow.com/users/11574189/eyoung"}, "is_accepted": false, "score": 0, "last_activity_date": 1559162684, "creation_date": 1559162684, "answer_id": 56368250, "question_id": 56365907, "link": "https://stackoverflow.com/questions/56365907/sending-a-interrupt-transfer-using-libusb-1-0-returns-an-libusb-error-io-but-not/56368250#56368250", "title": "Sending a interrupt transfer using Libusb 1.0 returns an LIBUSB_ERROR_IO but not when receiving", "body": "<p>Had a co-worker help me figure this one out.\nSo apparently in the libusb source code the hid_open() function parses the USB Descriptor and uses the capabilities.NumberOutputValueCaps to determine whether the report ID is needed for writing the output report. The USB Descriptor in my custom firmware gets parsed by this such that the capabilities.NumberOutputValueCaps = 0. This means the api call does not expect a report ID to be used. </p>\n\n<p>To solve this, we just hard coded a particular value for NumberOutputValueCaps and recompiled the libusb library. This let us have a working test framework for the production version of the firmware. </p>\n"}], "owner": {"reputation": 1, "user_id": 11574189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/553c63cd29749279daae1636855b17b0?s=128&d=identicon&r=PG&f=1", "display_name": "EYoung", "link": "https://stackoverflow.com/users/11574189/eyoung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559162684, "creation_date": 1559151555, "question_id": 56365907, "link": "https://stackoverflow.com/questions/56365907/sending-a-interrupt-transfer-using-libusb-1-0-returns-an-libusb-error-io-but-not", "title": "Sending a interrupt transfer using Libusb 1.0 returns an LIBUSB_ERROR_IO but not when receiving", "body": "<p>I am setting up a testing framework (Google Test Framework) for some custom firmware. I am using USB with the Libusb 1.0 library to receive outputs from the firmware, but I also need to simulate an input to the firmware. I am able to receive the outputs to the host ok, but am not able to send the transfer from the host.  </p>\n\n<p>The USB descriptor indicates that interrupt transfers to the host contain 3/4 pieces of data which I capture using this data structure:</p>\n\n<pre><code>typedef struct\n{\n    uint8_t reportId;\n    uint8_t axis[NUM_AXIS];\n    uint8_t button;\n}usb_report_t;\n</code></pre>\n\n<p>This works fine using this call from libusb</p>\n\n<pre><code>transfer_error = libusb_interrupt_transfer(dev_handle, 0x81, (unsigned char*)&amp;report, sizeof(report), &amp;transfer_length, 200);\n</code></pre>\n\n<p>My second task namely sending an interrupt transfer I set up using this structure</p>\n\n<pre><code>typedef struct\n{\n    uint8_t reportId;\n    uint8_t thumper;\n}usb_out_report_t;\n</code></pre>\n\n<p>And I send the interrupt transfer using this call</p>\n\n<pre><code>transfer_error = libusb_interrupt_transfer(dev_handle, 0x01, (unsigned char*)&amp;out_report, sizeof(out_report), &amp;length, 200);\n</code></pre>\n\n<p>This call returns a -1 which is a LIBUSB_ERROR_IO. </p>\n\n<p>While I was attempting to solve this issue I discovered a work around.\nIf I remove the report ID from the USB descriptor which consequently turns the two structs to</p>\n\n<pre><code>typedef struct\n{\n    //uint8_t reportId;\n    uint8_t axis[NUM_AXIS];\n    uint8_t button;\n}usb_report_t;\ntypedef struct\n{\n    //uint8_t reportId;\n    uint8_t thumper;\n}usb_out_report_t;\n</code></pre>\n\n<p>Then the interrupt transfers both in and out work fine. This is ok as a temporary work around but is not an ideal long term solution. </p>\n\n<p>Is there a way to keep the report ID field but have the transfer work both for IN and OUT endpoints?</p>\n"}, {"tags": ["java", "c++", "ssl", "grpc"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1559151617, "post_id": 56365638, "comment_id": 99335004, "body": "I&#39;m curious; <i>why</i> would you <i>want</i> to just blindly accept any certificate? Ok, in test code, <i>maybe</i>. But in production, certainly not. Or?"}, {"owner": {"reputation": 11, "user_id": 11528565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e50e24a44643d2cd772b40546bc4743?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/11528565/anton"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1559152109, "post_id": 56365638, "comment_id": 99335180, "body": "Because that&#39;s what my boss wants. He is the one who signs my paychecks. Anyway, if it&#39;s doable in Java gRPC, how would you do it in C++?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1559153384, "post_id": 56365638, "comment_id": 99335734, "body": "A <i>responsible</i> engineer <i>questions</i> his boss&#39;s decisions when he makes an obvious mistake, rather than just roll over and do as he&#39;s told."}, {"owner": {"reputation": 11, "user_id": 11528565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e50e24a44643d2cd772b40546bc4743?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/11528565/anton"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1559154132, "post_id": 56365638, "comment_id": 99336041, "body": "But there are provisions added to Java to accomplish it. Do you know how to do the same in C++?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1559154287, "post_id": 56365638, "comment_id": 99336103, "body": "No. I don&#39;t know a direct C++ equivalent. I would <i>probably</i> start by looking into OpenSSL."}, {"owner": {"reputation": 11, "user_id": 11528565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e50e24a44643d2cd772b40546bc4743?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/11528565/anton"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1559154739, "post_id": 56365638, "comment_id": 99336267, "body": "Python version of gRPC has similar provisions in &quot;ssl_channel_credentials()&quot; function. Fourth parameter of which is &quot;verify_callback&quot; and can be None to turn off the verification."}, {"owner": {"reputation": 16391, "user_id": 4690866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854931adcbf75ac84630116123920854?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Anderson", "link": "https://stackoverflow.com/users/4690866/eric-anderson"}, "edited": false, "score": 0, "creation_date": 1559168918, "post_id": 56365638, "comment_id": 99341208, "body": "To be clear, gRPC Java does not consider that a &quot;supported&quot; configuration. It happens to work, but isn&#39;t a &quot;feature.&quot; It&#39;s easier to just use plaintext."}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 9211571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3861d9346629af36058865d8ff2cbeda?s=128&d=identicon&r=PG", "display_name": "Jiangtao Li", "link": "https://stackoverflow.com/users/9211571/jiangtao-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1559191943, "creation_date": 1559191943, "answer_id": 56371822, "question_id": 56365638, "link": "https://stackoverflow.com/questions/56365638/how-to-make-c-client-trust-all-x-509-certificates-without-any-verification-li/56371822#56371822", "title": "How to make C++ client trust all X.509 certificates without any verification (like in Java)", "body": "<p>Unfortunately, gRPC C++ does not support this feature. gRPC C++ only has options to not verify client's certificate but not server's certificate.</p>\n\n<p>Your use case does not seem strong enough for us to support this feature.</p>\n"}], "owner": {"reputation": 11, "user_id": 11528565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e50e24a44643d2cd772b40546bc4743?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/11528565/anton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 376, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559191943, "creation_date": 1559150309, "question_id": 56365638, "link": "https://stackoverflow.com/questions/56365638/how-to-make-c-client-trust-all-x-509-certificates-without-any-verification-li", "title": "How to make C++ client trust all X.509 certificates without any verification (like in Java)", "body": "<p>What is the grpc C++ equivalent of Java's InsecureTrustManagerFactory ? </p>\n\n<p>GrpcSslContexts.forClient().trustManager(InsecureTrustManagerFactory.INSTANCE).build()</p>\n\n<p>an insecure TrustManagerFactory that trusts all X.509 certificates without any verification.</p>\n\n<p>In other words - in Java I create a server (private.key + certificate.pem signed by rootCA) and a client that creates SSL-encrypted channel with the server accepting server's certificate without verification (rootCA.pem is not available for the client). Technically it's not recommended but I use it for testing purposes only. I need to do the same for my C++ version of server-client pair. So far my C++ client needs rootCA.pem either through SslCredentialsOptions:</p>\n\n<pre><code>    grpc::SslCredentialsOptions sslChannelOptions;\n    sslChannelOptions.pem_root_certs  = \"rootCA.pem\";\n    sslChannelOptions.pem_cert_chain  = \"\";\n    sslChannelOptions.pem_private_key = \"\";\n    return grpc::SslCredentials( sslChannelOptions );\n</code></pre>\n\n<p>or through </p>\n\n<p>gpr_setenv(\"GRPC_DEFAULT_SSL_ROOTS_FILE_PATH\", \"roots.pem\")</p>\n\n<p>Otherwise I get:</p>\n\n<p>ssl_transport_security.c:921] Handshake failed with fatal error SSL_ERROR_SSL: error:0400006b:RSA routines:OPENSSL_internal:BLOCK_TYPE_IS_NOT_01.</p>\n"}, {"tags": ["c++", ".net", "reinterpret-cast", "pin-ptr"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1559149621, "post_id": 56365362, "comment_id": 99334099, "body": "&quot;As far as I understood, the issue may be caused by&quot; I&#39;m confused. What is your issue? The rest of your post seems to ask about best practices with reinterpret cast, and then you say you have an issue. Can you maybe give more detail of the issue, or maybe create separate questions, one for the issue and one for safe practices?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559150796, "post_id": 56365362, "comment_id": 99334662, "body": "reinterpret cast is never safe, in the sense that you have to make sure it is the right thing to do. Did you read about what is allowed and what not, eg here <a href=\"https://en.cppreference.com/w/cpp/language/reinterpret_cast\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/reinterpret_cast</a> ?"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1559150829, "post_id": 56365362, "comment_id": 99334678, "body": "It is never safe, the C++/CLI compiler is forbidden from doing this by itself.  Memory layout of managed types is fundamentally undiscoverable.  Using memcpy() is something you&#39;ll get away with here, the CLR has no great reasons to alter the layout.  But it is actually inefficient, it can&#39;t beat assigning those three fields explicitly.  Marshal::PtrToStructure() is safe."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1559151171, "post_id": 56365362, "comment_id": 99334830, "body": "Scary example <a href=\"https://stackoverflow.com/questions/24742325/why-does-struct-alignment-depend-on-whether-a-field-type-is-primitive-or-user-de\">is here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5403966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/17VYs.jpg?s=128&g=1", "display_name": "whats_wrong_here", "link": "https://stackoverflow.com/users/5403966/whats-wrong-here"}, "is_accepted": true, "score": 0, "last_activity_date": 1559549828, "creation_date": 1559549828, "answer_id": 56423489, "question_id": 56365362, "link": "https://stackoverflow.com/questions/56365362/managed-to-native-value-class-conversion-is-it-safe-to-cast-pointer/56423489#56423489", "title": "Managed to native value class conversion: is it safe to cast pointer?", "body": "<p>Well, I have ended up using usual constructors of native classes. It looks for me absolutely safe, and fastest from remaining variants. The idea from comments with Marshal::PtrToStructure() was good, but for my test example gave slower execution, than the same with using constructors. Pointer casts are the fastest solution, but after very scary example from comments, I will not risk to use it anymore (except if we really need to optimize it, then LayoutKind::Explicit should do the thing).</p>\n\n<p>Here is code i used for testing:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// this is C++ native class\nclass NativePoint\n{\npublic:\n  double x;\n  double y;\n  double z;\n  NativePoint()\n  {\n\n  }\n  NativePoint(double x, double y, double z)\n  {\n    this-&gt;x = x;\n    this-&gt;y = y;\n    this-&gt;z = z;\n  }\n  NativePoint operator * (int value)\n  {\n    return NativePoint(x * value, y * value, z * value);\n  }\n};\n\n// this class managed C++ class\n[StructLayout(LayoutKind::Sequential)]\npublic value class ManagedPoint\n{\ninternal:\n  double x;\n  double y;\n  double z;\n  ManagedPoint(const NativePoint&amp; p)\n  {\n    x = p.x;\n    y = p.y;\n    z = p.z;\n  }\n  ManagedPoint(double x, double y, double z)\n  {\n    this-&gt;x = x;\n    this-&gt;y = y;\n    this-&gt;z = z;\n  }\npublic:\n  static ManagedPoint operator * (ManagedPoint a, double value)\n  {\n    return ManagedPoint((*reinterpret_cast&lt;NativePoint*&gt;(&amp;(a))) * value);\n  }\n  ManagedPoint MultiplyBy(double value)\n  {\n    pin_ptr&lt;ManagedPoint&gt; pThisTmp = &amp;*this;\n    NativePoint* pThis = reinterpret_cast&lt;NativePoint*&gt;(&amp;*pThisTmp);\n    return ManagedPoint(*pThis * value);\n  }\n};\n\n// this class managed C++ class\n[StructLayout(LayoutKind::Sequential)]\npublic value class ManagedPoint2\n{\ninternal:\n  double x;\n  double y;\n  double z;\n  ManagedPoint2(const NativePoint&amp; p)\n  {\n    x = p.x;\n    y = p.y;\n    z = p.z;\n  }\n  ManagedPoint2(double x, double y, double z)\n  {\n    this-&gt;x = x;\n    this-&gt;y = y;\n    this-&gt;z = z;\n  }\npublic:\n  static ManagedPoint2 operator * (ManagedPoint2 a, double value)\n  {\n    return ManagedPoint2((NativePoint(a.x, a.y, a.z)) * value);\n  }\n  ManagedPoint2 MultiplyBy(double value)\n  {\n    return ManagedPoint2((NativePoint(this-&gt;x, this-&gt;y, this-&gt;z)) * value);\n  }\n};\n\n// this class managed C++ class\n[StructLayout(LayoutKind::Sequential)]\npublic value class ManagedPoint3\n{\ninternal:\n  double x;\n  double y;\n  double z;\n  ManagedPoint3(const NativePoint&amp; p)\n  {\n    x = p.x;\n    y = p.y;\n    z = p.z;\n  }\n  ManagedPoint3(double x, double y, double z)\n  {\n    this-&gt;x = x;\n    this-&gt;y = y;\n    this-&gt;z = z;\n  }\npublic:\n  static ManagedPoint3 operator * (ManagedPoint3 a, double value)\n  {\n    NativePoint p;\n    Marshal::StructureToPtr(a, IntPtr(&amp;p), false);\n    return ManagedPoint3(p * value);\n  }\n  ManagedPoint3 MultiplyBy(double value)\n  {\n    NativePoint p;\n    Marshal::StructureToPtr(*this, IntPtr(&amp;p), false);\n    return ManagedPoint3(p * value);\n  }\n};\n\n// this class managed C++ class\n[StructLayout(LayoutKind::Sequential)]\npublic value class ManagedPoint4\n{\ninternal:\n  double x;\n  double y;\n  double z;\n  ManagedPoint4(const NativePoint&amp; p)\n  {\n    x = p.x;\n    y = p.y;\n    z = p.z;\n  }\n  ManagedPoint4(double x, double y, double z)\n  {\n    this-&gt;x = x;\n    this-&gt;y = y;\n    this-&gt;z = z;\n  }\npublic:\n  static ManagedPoint4 operator * (ManagedPoint4 a, double value)\n  {\n    return ManagedPoint4(ManagedPoint4::ToNative(a) * value);\n  }\n  ManagedPoint4 MultiplyBy(double value)\n  {\n    return ManagedPoint4(ManagedPoint4::ToNative(*this) * value);\n  }\n  static NativePoint ToNative(const ManagedPoint4&amp; pp)\n  {\n    NativePoint p;\n    Marshal::StructureToPtr(pp, IntPtr(&amp;p), false);\n    return p;\n  }\n};\n\n// this should be called from C# code, or another .NET app\nint main(array&lt;System::String ^&gt; ^args)\n{\n  Stopwatch time;\n  time.Start();\n  for (int i = 0; i &lt; 10000000; i++)\n  {\n    ManagedPoint a = ManagedPoint(1, 2, 3) * 4;\n  }\n  time.Stop();\n  Console::WriteLine(\"time: \" + time.ElapsedMilliseconds);\n\n  Stopwatch time2;\n  time2.Start();\n  for (int i = 0; i &lt; 10000000; i++)\n  {\n    ManagedPoint2 a2 = ManagedPoint2(1, 2, 3) * 4;\n  }\n  time2.Stop();\n  Console::WriteLine(\"time2: \" + time2.ElapsedMilliseconds);\n\n  Stopwatch time3;\n  time3.Start();\n  for (int i = 0; i &lt; 10000000; i++)\n  {\n    ManagedPoint3 a3 = ManagedPoint3(1, 2, 3) * 4;\n  }\n  time3.Stop();\n  Console::WriteLine(\"time3: \" + time3.ElapsedMilliseconds);\n\n  Stopwatch time4;\n  time4.Start();\n  for (int i = 0; i &lt; 10000000; i++)\n  {\n    ManagedPoint4 a3 = ManagedPoint4(1, 2, 3) * 4;\n  }\n  time4.Stop();\n  Console::WriteLine(\"time4: \" + time4.ElapsedMilliseconds);\n\n  Console::ReadLine();\n  Console::WriteLine(\"======================================================\");\n  Console::WriteLine();\n\n  return 0;\n}\n</code></pre>\n\n<p>And this is output:</p>\n\n<pre><code>time: 374\ntime2: 382\ntime3: 857\ntime4: 961\n\ntime: 395\ntime2: 413\ntime3: 900\ntime4: 968\n\ntime: 376\ntime2: 378\ntime3: 840\ntime4: 909\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5403966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/17VYs.jpg?s=128&g=1", "display_name": "whats_wrong_here", "link": "https://stackoverflow.com/users/5403966/whats-wrong-here"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 56423489, "answer_count": 1, "score": 0, "last_activity_date": 1559556326, "creation_date": 1559149063, "last_edit_date": 1559556326, "question_id": 56365362, "link": "https://stackoverflow.com/questions/56365362/managed-to-native-value-class-conversion-is-it-safe-to-cast-pointer", "title": "Managed to native value class conversion: is it safe to cast pointer?", "body": "<p>I have a C# project which uses C++ classes from a library. C# classes are actually wrappers for C++ classes, they expose C++ functionality to C# client code.\nIn many places C++ value classes are converted to C# wrappers and backwards. \nDuring code review I've found two ways how the classes are converted: via reinterpret_cast ( see operator * ) and via pin_ptr ( see MultiplyBy );\nAs you can see, both native and managed class has three 'double' fields, this is why someone was using reinterpret_cast;</p>\n\n<p>In many places classes are copied from C# to C++ using memcpy: \n memcpy(&amp;NativePointInstance, &amp;ManagedPointIntance, sizeof(double)*3);</p>\n\n<p>I've heard from one developer that reinterpret_cast can be safe in some cases, when we work with C# value classes.</p>\n\n<p>The question is: \nWhen it is safe to use reinterpret_cast on C# value classes and when it is not?\nWhat is the most correct way of converting the pointers in this case - like in operator * or like in MultiplyBy, or another alternative?</p>\n\n<p>Can someone explain in details what is happening in MultiplyBy(), how these trick work?</p>\n\n<p>As far as I understood, the issue may be caused by that optimizer may change fields order, GC may reorganize heap, and alignment of fields may be different between managed and native code.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// this is C++ native class\nclass NativePoint\n{\npublic:\n  double x;\n  double y;\n  double z;\n  NativePoint(double x, double y, double z)\n  {\n    this-&gt;x = x;\n    this-&gt;y = y;\n    this-&gt;z = z;\n  }\n  NativePoint operator * (int value)\n  {\n    return NativePoint(x * value, y * value, z * value);\n  }\n};\n\n// this class managed C++ class\n[StructLayout(LayoutKind::Sequential)]\npublic value class ManagedPoint\n{\ninternal:\n  double x;\n  double y;\n  double z;\n  ManagedPoint(const NativePoint&amp; p)\n  {\n    x = p.x;\n    y = p.y;\n    z = p.z;\n  }\npublic:\n  static ManagedPoint operator * (ManagedPoint a, double value)\n  {\n    return ManagedPoint((*reinterpret_cast&lt;NativePoint*&gt;(&amp;(a))) * value);\n  }\n  ManagedPoint MultiplyBy(double value)\n  {\n    pin_ptr&lt;ManagedPoint&gt; pThisTmp = &amp;*this;\n    NativePoint* pThis = reinterpret_cast&lt;NativePoint*&gt;(&amp;*pThisTmp);\n    return ManagedPoint(*pThis * value);\n  }\n};\n\n// this should be called from C# code, or another .NET app\nint main(array&lt;System::String ^&gt; ^args)\n{\n  NativePoint p_native = NativePoint(1, 1, 1);\n  ManagedPoint p = ManagedPoint(p_native);\n  Console::WriteLine(\"p is {\" + p.x + \", \" + p.y + \", \" + p.z + \"}\");\n  ManagedPoint p1 = p * 5;\n  Console::WriteLine(\"p1 is {\" + p1.x + \", \" + p1.y + \", \" + p1.z + \"}\");\n  ManagedPoint p2 = p.MultiplyBy(5);\n  Console::WriteLine(\"p2 is {\" + p2.x + \", \" + p2.y + \", \" + p2.z + \"}\");\n  Console::ReadLine();\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "sockets", "udp", "boost-asio"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1559149278, "post_id": 56365336, "comment_id": 99333959, "body": "Some redirections, routing active in your network infrastructure? Also the <code>0</code> in the last part of the IP address is usuallly dedicated to a network entry point, the actual server which serves the request, doesn&#39;t necessarily have the same IP address."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1559322532, "post_id": 56365336, "comment_id": 99396812, "body": "You didn&#39;t capture the endpoint!"}, {"owner": {"reputation": 11, "user_id": 11574135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rmljO.jpg?s=128&g=1", "display_name": "ewachter", "link": "https://stackoverflow.com/users/11574135/ewachter"}, "edited": false, "score": 0, "creation_date": 1559552116, "post_id": 56365336, "comment_id": 99442735, "body": "I was capturing the endpoint. I don&#39;t know why they were using io_service.post(), but when I removed it worked!"}], "answers": [{"comments": [{"owner": {"reputation": 915, "user_id": 407578, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/caddf51bf8183d376c12a2fd4161eb80?s=128&d=identicon&r=PG", "display_name": "psy", "link": "https://stackoverflow.com/users/407578/psy"}, "edited": false, "score": 0, "creation_date": 1583281904, "post_id": 56397730, "comment_id": 107061258, "body": "There are multiple issues with this code. 1. Need to make sure underlying memory for the buffer (in this case, <code>packet</code>) is still valid. <a href=\"https://www.boost.org/doc/libs/1_72_0/doc/html/boost_asio/reference/basic_datagram_socket/async_send_to/overload1.html\" rel=\"nofollow noreferrer\">boost.org/doc/libs/1_72_0/doc/html/boost_asio/reference/&hellip;</a> 2. Can&#39;t use a single send buffer. If multiple clients connect at the same time,  async_send_to will be called for each client. All the calls will use a single send buffer which is problematic."}], "tags": [], "owner": {"reputation": 11, "user_id": 11574135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rmljO.jpg?s=128&g=1", "display_name": "ewachter", "link": "https://stackoverflow.com/users/11574135/ewachter"}, "is_accepted": false, "score": 0, "last_activity_date": 1559315874, "creation_date": 1559315874, "answer_id": 56397730, "question_id": 56365336, "link": "https://stackoverflow.com/questions/56365336/boost-asio-udp-socket-sending-to-different-ip-address/56397730#56397730", "title": "Boost asio udp socket sending to different ip address", "body": "<p>Solved!</p>\n\n<p>I removed the <code>io_service.post</code> and it worked!</p>\n\n<pre><code>`std::cout &lt;&lt; udp_remote_endpoint.address().to_string();\nstd::string str(packet.begin(), packet.end());\nstd::cout &lt;&lt; str &lt;&lt; std::endl;\n//io_service.post(\n//    [this, packet]()\n//    {\n        udp_socket.async_send_to(\n            boost::asio::buffer(packet),\n            udp_remote_endpoint,\n            boost::bind(\n                &amp;uds::handle_write,\n                this,\n                boost::asio::placeholders::error,\n                boost::asio::placeholders::bytes_transferred\n            )\n        );\n//    }\n//);`\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11574135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rmljO.jpg?s=128&g=1", "display_name": "ewachter", "link": "https://stackoverflow.com/users/11574135/ewachter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 592, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559315874, "creation_date": 1559148949, "question_id": 56365336, "link": "https://stackoverflow.com/questions/56365336/boost-asio-udp-socket-sending-to-different-ip-address", "title": "Boost asio udp socket sending to different ip address", "body": "<p>I have one udp server receiving messages from multiple remote clients. When it receives one message, I copy the endpoint and reply to the client at the same IP address on port 5000 where each client is listening. </p>\n\n<p>I have tried multiple debbuging strategies, and printing the endpoint right before I send the reply message gives me the correct IP address and port.</p>\n\n<p>The sender:</p>\n\n<pre><code>    std::cout &lt;&lt; udp_remote_endpoint.address().to_string();\n    std::string str(packet.begin(), packet.end());\n    std::cout &lt;&lt; str &lt;&lt; std::endl;\n    io_service.post(\n        [this, packet]()\n        {\n            udp_socket.async_send_to(\n                boost::asio::buffer(packet),\n                udp_remote_endpoint,\n                boost::bind(\n                    &amp;uds::handle_write,\n                    this,\n                    boost::asio::placeholders::error,\n                    boost::asio::placeholders::bytes_transferred\n                )\n            );\n        }\n            );\n</code></pre>\n\n<p>On the receiver, I get the udp_remote_endpoint and before sending, I set the socket endpoint:</p>\n\n<pre><code>    new_addr.endpoint = socket.get_udp_remote_endpoint();\n    new_addr.endpoint.port(5000);\n    socket.set_udp_remote_endpoint(new_addr.endpoint);\n</code></pre>\n\n<p>For example, this output:</p>\n\n<pre><code>192.168.1.131K-131-1559147491761155\n</code></pre>\n\n<p>Is actually sending to the IP 192.168.1.130. The message contents are correct \"K-131-1559147491761155\"</p>\n"}, {"tags": ["c++", "bit-shift", "hardware-programming"], "comments": [{"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 1, "creation_date": 1559149118, "post_id": 56365318, "comment_id": 99333881, "body": "I use enums for things like this, and then have a switch to convert from the enum to the specific bit pattern.  (I try NOT to have the enum reflect the bit pattern, so that the specific enum values do not have semantic meaning.)  <code>enum class RefreshRate { kDefault &#47;* same as k2Hz *&#47;, kHalfHz, k1Hz, k2Hz, k4Hz, k8Hz, k16Hz, k32Hz, k64Hz };</code>"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 8729023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b78144babed12f0b8508b71128d84278?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Dirven", "link": "https://stackoverflow.com/users/8729023/marc-dirven"}, "edited": false, "score": 0, "creation_date": 1559151154, "post_id": 56365381, "comment_id": 99334822, "body": "I tested it and it works, however, with a <code>register_value</code> of <code>0b1110000000</code> this gives me an output of 128Hz, so I think you might have dropped a <code>-1</code> somewhere or my registers weren&#39;t correctly transferred. I&#39;m also having a hard time understanding the opposite (reverse) steps you mentioned."}], "tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": false, "score": 2, "last_activity_date": 1559154762, "last_edit_date": 1559154762, "creation_date": 1559149132, "answer_id": 56365381, "question_id": 56365318, "link": "https://stackoverflow.com/questions/56365318/how-to-convert-amount-of-hz-to-appropriate-byte-bit-format/56365381#56365381", "title": "How to &#39;convert&#39; amount of Hz to appropriate byte/bit format?", "body": "<p>First convert the Hz value in the register to a number:  </p>\n\n<pre><code>register_value &gt;&gt;= 7;  // Shift right 7 bits.\nregister_value &amp;= 7;  // Keep remaining 3 bits. \n</code></pre>\n\n<p>Next, calculate the Hz by left shifting. </p>\n\n<pre><code>herz = (1 &lt;&lt; register_value) / 2.;\n</code></pre>\n\n<p>To set the Herz value, perform the <em>opposite</em> (reverse) steps.</p>\n"}, {"tags": [], "owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "is_accepted": false, "score": 0, "last_activity_date": 1559150310, "creation_date": 1559150310, "answer_id": 56365639, "question_id": 56365318, "link": "https://stackoverflow.com/questions/56365318/how-to-convert-amount-of-hz-to-appropriate-byte-bit-format/56365639#56365639", "title": "How to &#39;convert&#39; amount of Hz to appropriate byte/bit format?", "body": "<p>However you map actual Hz to bit patterns, you set them like this:</p>\n\n<pre><code>void set_hz(uint16_t&amp; control_reg, uint8_t hz)  // here hz is 0 for .5 Hz, 1 for 1Hz,.. 7 for 64Hz\n{\n     constexpr int hz_shift = 7;\n     constexpr uint16_t hz_mask = static_cast&lt;uint16_t&gt;(0x07) &lt;&lt; hz_shift;\n     control_reg &amp;= ~hz_mask;\n     control_reg |= static_cast&lt;uint16_t&gt;(hz) &lt;&lt; hz_shift;\n} \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "is_accepted": true, "score": 1, "last_activity_date": 1559153813, "last_edit_date": 1559153813, "creation_date": 1559152990, "answer_id": 56366241, "question_id": 56365318, "link": "https://stackoverflow.com/questions/56365318/how-to-convert-amount-of-hz-to-appropriate-byte-bit-format/56366241#56366241", "title": "How to &#39;convert&#39; amount of Hz to appropriate byte/bit format?", "body": "<blockquote>\n  <p>How can I best convert a given integer (refresh_rate) value between 0.5Hz and 64Hz to 0b000 - 0b111</p>\n</blockquote>\n\n<p>One approach is to see that the target value increases by one every time the input doubles, meaning it is <em>log<sub>2</sub>(Hz) + 1</em>.</p>\n\n<p>So, you can write</p>\n\n<pre><code>uint16_t hz_bits(float hz) {\n    return static_cast&lt;uint16_t&gt;(round(1.0f + log2(hz)));\n}\n</code></pre>\n\n<p>which admittedly requires floating-point and isn't highly-optimized. Conversely,</p>\n\n<pre><code>float hz_from_bits(uint16_t hzB) {\n    return 0.5f * (1 &lt;&lt; hzB);\n}\n</code></pre>\n\n<p>Both of those have the three bits you care about as the least significant bits of the <code>uint16_t</code>.</p>\n\n<p>If you want to use an integral Hz number, and ignore the <code>0.5</code> case, then <em>log<sub>2</sub></em> is just the number of the highest set bit: eg, 64 = 0b1000000, with highest set bit 6 (you still need to add 1 to get 7 = 0b111).</p>\n\n<p>Then you can combine them with something like</p>\n\n<pre><code>static const uint16_t HZ_START = 7;\nstatic const uint16_t HZ_LEN = 3;\nstatic const uint16_t HZ_MASK = ((1 &lt;&lt; HZ_LEN)-1) &lt;&lt; HZ_START;\n\nuint16_t set_hz_bits(uint16_t control, uint16_t hzB) {\n    return (control &amp; ~HZ_MASK) | (hzB &lt;&lt; HZ_START);\n}\nuint16_t get_hz_bits(uint16_t control) {\n    return (control &amp; HZ_MASK) &gt;&gt; HZ_START;\n}\n</code></pre>\n\n<p>into</p>\n\n<pre><code>uint16_t set_hz(uint16_t control, float hz) {\n    return set_hz_bits(control, hz_bits(hz));\n}\nfloat get_hz(uint16_t control) {\n    return hz_from_bits(get_hz_bits(control));\n}\n</code></pre>\n\n<p>Note that the actual bit masking and shifting is pretty mechanical - you can automate this stuff for your various fields quite easily, using something like the below, and pass around <code>HzField</code> objects instead of having to remember which <code>uint16_t</code> contain zero-based encoded Hz values, and which contain correctly layed-out control registers.</p>\n\n<pre><code>template &lt;size_t Bstart, size_t Blen, typename T = uint16_t&gt;\nstruct BitField\n{\n    T value; // zero-based, not shifted\n\n    static constexpr T mask() { return ((1 &lt;&lt; Blen)-1) &lt;&lt; Bstart; }\n\n    static T clear(T r) { return r &amp; ~mask(); }\n\n    void decode(T r) { value = (r &amp; mask()) &gt;&gt; Bstart; }\n    T encode(T r) { return clear(r) | ((value &lt;&lt; Bstart) &amp; mask()); }\n    // etc.\n};\nusing HzField = BitField&lt;7, 3&gt;;\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 8729023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b78144babed12f0b8508b71128d84278?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Dirven", "link": "https://stackoverflow.com/users/8729023/marc-dirven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 56366241, "answer_count": 3, "score": 1, "last_activity_date": 1559158336, "creation_date": 1559148857, "question_id": 56365318, "link": "https://stackoverflow.com/questions/56365318/how-to-convert-amount-of-hz-to-appropriate-byte-bit-format", "title": "How to &#39;convert&#39; amount of Hz to appropriate byte/bit format?", "body": "<p>I am programming an IR camera. But the internal register for storing the refreshrate (bits 9, 8 and 7 of 16 in total) only accepts 1's and 0's of course. For example, a value of 0b110 means 32Hz and 0b111, 64Hz. How can I best convert a given integer (<code>refresh_rate</code>) value between 0.5Hz and 64Hz to 0b000 - 0b111 when looking at the Refresh rate control picture?</p>\n\n<p><img src=\"https://i.imgur.com/mu7ieVv.png\" alt=\"\"></p>\n\n<p>To be honest, I haven't tried anything yet because I think it requires a weird hack. However I have been thinking of a lookuptable, I think that is possible but requires more memory and it has to be memory efficient since it is programmed on an Arduino Due. </p>\n\n<p>Note: You can see that the refresh_rate is an <code>uint16_t</code> which does not accept floating point values such as 0.5Hz, however, I am probably not going to use the 0.5Hz setting.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// the end-user currently has to pass a value between 7 and 0\nvoid mlx90650::set_refresh_rate(uint16_t refresh_rate) {\n    // So the refresh rate may not be higher than 7 (0b111) since this register only \naccepts 3 bits. The memory map is:\n/*\n    | decimal | bits  |  \n    (decimal 0) 0 0 0 IR refresh rate = 0.5Hz \n    (decimal 1) 0 0 1 IR refresh rate = 1Hz \n    (decimal 2) 0 1 0 IR refresh rate = 2Hz (default) \n    (decimal 3) 0 1 1 IR refresh rate = 4Hz \n    (decimal 4) 1 0 0 IR refresh rate = 8Hz \n    (decimal 5) 1 0 1 IR refresh rate = 16Hz \n    (decimal 6) 1 1 0 IR refresh rate = 32Hz \n    (decimal 7) 1 1 1 IR refresh rate = 64H\n*/\n}\n</code></pre>\n\n<p>I want that this function converts for example 64Hz to 0b111.</p>\n"}, {"tags": ["c++", "qt", "qt5", "qlabel"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1559151771, "post_id": 56365244, "comment_id": 99335064, "body": "It&#39;d help to create a MCVE (add main function creating labels, or better yet self-contained main.cpp with everything), and adding screenshots of the wrong behavior wouldn&#39;t hurt either."}, {"owner": {"reputation": 5378, "user_id": 2110683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33179a1918a5d90f47cde062fab10ff4?s=128&d=identicon&r=PG", "display_name": "Dimitry Ernot", "link": "https://stackoverflow.com/users/2110683/dimitry-ernot"}, "edited": false, "score": 0, "creation_date": 1559161011, "post_id": 56365244, "comment_id": 99338778, "body": "A <code>QLabel</code> with the property <code>WordWrap</code> to true isn&#39;t enough?"}, {"owner": {"reputation": 500, "user_id": 187359, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/bc319c4b6ab42da4cce05ac52cc6f6c3?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/187359/jay"}, "reply_to_user": {"reputation": 5378, "user_id": 2110683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33179a1918a5d90f47cde062fab10ff4?s=128&d=identicon&r=PG", "display_name": "Dimitry Ernot", "link": "https://stackoverflow.com/users/2110683/dimitry-ernot"}, "edited": false, "score": 0, "creation_date": 1559161195, "post_id": 56365244, "comment_id": 99338839, "body": "@RomhaKorev <code>QLabel</code> with <code>WordWrap</code> doesn&#39;t elide."}, {"owner": {"reputation": 5378, "user_id": 2110683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33179a1918a5d90f47cde062fab10ff4?s=128&d=identicon&r=PG", "display_name": "Dimitry Ernot", "link": "https://stackoverflow.com/users/2110683/dimitry-ernot"}, "edited": false, "score": 0, "creation_date": 1559170901, "post_id": 56365244, "comment_id": 99341706, "body": "Right. My bad... The text in your label will change at runtime or not? Because it will be more tricky to adjust the layout (the label will be resized but not the <i>layout item</i>)"}], "answers": [{"comments": [{"owner": {"reputation": 500, "user_id": 187359, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/bc319c4b6ab42da4cce05ac52cc6f6c3?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/187359/jay"}, "edited": false, "score": 0, "creation_date": 1559230587, "post_id": 56369750, "comment_id": 99362966, "body": "I created a new gist that incorporates these changes. Thanks! <a href=\"https://gist.github.com/jahabrewer/79110fa93eb193c234fb2efcfeadeda0\" rel=\"nofollow noreferrer\">gist.github.com/jahabrewer/79110fa93eb193c234fb2efcfeadeda0</a>"}], "tags": [], "owner": {"reputation": 5378, "user_id": 2110683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33179a1918a5d90f47cde062fab10ff4?s=128&d=identicon&r=PG", "display_name": "Dimitry Ernot", "link": "https://stackoverflow.com/users/2110683/dimitry-ernot"}, "is_accepted": true, "score": 1, "last_activity_date": 1559172354, "creation_date": 1559172354, "answer_id": 56369750, "question_id": 56365244, "link": "https://stackoverflow.com/questions/56365244/how-to-make-a-multiline-qlabel-elide-the-last-line-be-constrained-by-a-max-heig/56369750#56369750", "title": "How to make a multiline QLabel elide the last line, be constrained by a max height, but also shrink if text doesn&#39;t fill to max height?", "body": "<p>You have to constraint the height of your label to the minimum needed to draw the text. You can get this height by using the <code>QFontMetrics</code> class and the method <code>QFontMetrics::boundingRect</code>:</p>\n\n<pre><code>QFontMetrics const fontMetrics(font());\nQRect const r = fontMetrics.boundingRect(\n            QRect(QPoint(0, 0), size()),\n            Qt::TextWordWrap | Qt::ElideRight,\n            content\n            );\nqDebug() &lt;&lt; \"Needed Height:\" &lt;&lt; r.height();\n</code></pre>\n\n<p>First, define the method <code>QWidget::sizeHint</code> to force your label to have a size:</p>\n\n<pre><code>virtual QSize sizeHint() const override\n{\n    QFontMetrics const fontMetrics(font());\n    QRect const r = fontMetrics.boundingRect(\n            QRect(QPoint(0, 0), size()),\n            Qt::TextWordWrap | Qt::ElideRight,\n            content\n            );\n    return QSize(width(), r.height());\n}\n</code></pre>\n\n<p>We want to shrink the height, only. That's why we will not use the width returned by the <em>font metrics</em></p>\n\n<p>Now, we will use the resize events to check if we can shrink the height:</p>\n\n<p>So, we can override the <code>QWidget::resizeEvent</code> method:</p>\n\n<pre><code>virtual void resizeEvent(QResizeEvent* event) override\n{\n    QFrame::resizeEvent(event); // Process the event. The label is now resized\n    QSize const size = sizeHint();\n    if (size.height() &lt; height()) // Shrink the height if needed\n        resize(QSize(width(), size.height()));\n}\n</code></pre>\n\n<p>If the text has to change during the runtime, we have to readjust the size:</p>\n\n<pre><code>void setText(const QString &amp;newText)\n{\n   content = newText;\n   update();\n   adjustSize(); // Will resize the label\n}\n</code></pre>\n\n<p>The code I used for the tests:</p>\n\n<pre><code>QWidget* w = new QWidget();\nQVBoxLayout* l = new QVBoxLayout(w);\n\nQString const lorem(\"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\");\nElidedLabel* label = new ElidedLabel(lorem);\nlabel-&gt;setFrameShape(QFrame::Box); // To see its bounds\n\nl-&gt;addWidget(label);\nl-&gt;addWidget(new QLabel(\"Text Label\"));\n\nQTimer::singleShot(3000, [=]() { label-&gt;setText(lorem.left(100)); });\n\nw-&gt;show();\n\n</code></pre>\n"}], "owner": {"reputation": 500, "user_id": 187359, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/bc319c4b6ab42da4cce05ac52cc6f6c3?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/187359/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 524, "favorite_count": 1, "accepted_answer_id": 56369750, "answer_count": 1, "score": 2, "last_activity_date": 1559172354, "creation_date": 1559148561, "last_edit_date": 1559168935, "question_id": 56365244, "link": "https://stackoverflow.com/questions/56365244/how-to-make-a-multiline-qlabel-elide-the-last-line-be-constrained-by-a-max-heig", "title": "How to make a multiline QLabel elide the last line, be constrained by a max height, but also shrink if text doesn&#39;t fill to max height?", "body": "<p>EDIT: Updated with working example and example screenshots of current and desired behavior.</p>\n\n<h1>Description</h1>\n\n<p>I'm trying to get a multiline QLabel to have these behaviors:</p>\n\n<ol>\n<li>It should expand to fill available width.</li>\n<li>If its text is longer than it can show, it should show all it can (expanding to its max height) and elide the last line.</li>\n<li>If its text is not the longest it can show, it should show all text, but shrink its height to fit the text.</li>\n</ol>\n\n<p>The label is in a layout. Maybe I'm thinking about this wrong, like maybe instead of a label it should be a text area wrapped in something else?</p>\n\n<p>Anyway, I've found solutions that cover one or two of these behaviors, but not all three. I've tried tweaking Qt's <a href=\"https://doc.qt.io/qt-5/qtwidgets-widgets-elidedlabel-example.html\" rel=\"nofollow noreferrer\">ElidedLabel</a>, but I can't quite figure out how to tweak it to achieve all three.</p>\n\n<p>I've considered overriding <code>sizeHint()</code>, but I'm not Qt-savvy enough to know if that's the right way to do this. I feel like maybe the right combination of <code>layoutSizeConstraint</code> on the layout and size policies on the ElidedLabel might make this possible, but I'm not sure.</p>\n\n<p>I've slightly modified Qt's ElidedLabel example code so that it doesn't take its content in its constructor.</p>\n\n<h1>Example code</h1>\n\n<p><a href=\"https://gist.github.com/jahabrewer/bd0c79ac2255953eeadf87c9767ce693\" rel=\"nofollow noreferrer\">https://gist.github.com/jahabrewer/bd0c79ac2255953eeadf87c9767ce693</a></p>\n\n<h1>Screenshots</h1>\n\n<h2>Current behavior</h2>\n\n<p>Left column has text short enough that the ElidedLabel should reduce its height and cede that vertical space to the QLabel underneath it. Right column has text long enough that it's elided, which is correct/desired.</p>\n\n<p><a href=\"https://i.stack.imgur.com/cTt1H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cTt1H.png\" alt=\"current behavior\"></a></p>\n\n<h2>Desired behavior</h2>\n\n<p>(to be clear, I want a single configuration that will produce behavior like the left column when text is short and like the right column when text is long)</p>\n\n<p><a href=\"https://i.stack.imgur.com/yCrDv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yCrDv.png\" alt=\"desired behavior\"></a></p>\n"}, {"tags": ["c++", "unix", "networking", "tcp", "socat"], "comments": [{"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1559149292, "post_id": 56365010, "comment_id": 99333965, "body": "What comes out of your Unix socket <code>recvmsg()</code> calls?  Because TCP is just a stream and all the information from <code>sendmsg()</code> is gathered into a single packet and sent over the connection.  See <a href=\"https://stackoverflow.com/questions/4258834/how-sendmsg-works\">this question</a> and in particular <a href=\"https://stackoverflow.com/a/4259888/4756299\">this answer</a>: &quot;For a stream socket, it wouldn&#39;t matter either way. Any data you send will just end up as one long stream of data on the other side.&quot;"}, {"owner": {"reputation": 241, "user_id": 1286486, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5dcd0da3d2d8be87a8afd4b1036ca3cd?s=128&d=identicon&r=PG", "display_name": "e wagness", "link": "https://stackoverflow.com/users/1286486/e-wagness"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1559153230, "post_id": 56365010, "comment_id": 99335667, "body": "@AndrewHenle I&#39;m not sure what you mean, my problem is that recvmsg is NOT being called on the unix socket.  The example I have above of the recvmsg on the unix socket is from a separate program I wrote which reads the unix socket directly. What comes out is the [5], its an int / file descriptor.   read is being called on the unix socket instead though (when using socat), which as I understand ignores ancillary data"}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1559154828, "post_id": 56365010, "comment_id": 99336300, "body": "Are you trying to pass an integer value file descriptor over a TCP socket, through <code>socat</code>, and the out the Unix socket?  Or the opposite way - through a Unix socket, then through <code>socat</code> and then over a TCP connection to a remote machine?"}, {"owner": {"reputation": 241, "user_id": 1286486, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5dcd0da3d2d8be87a8afd4b1036ca3cd?s=128&d=identicon&r=PG", "display_name": "e wagness", "link": "https://stackoverflow.com/users/1286486/e-wagness"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1559155259, "post_id": 56365010, "comment_id": 99336460, "body": "@AndrewHenle I think my problem may be with python, and I&#39;ve opened a separate question.   I am trying to read from a unix socket, which replies to the read with an integer FD. My client is remote (its a functional test) so it cant run locally on the target machine w/ the Unix socket. So instead, I am trying to use socat to forward a TCP socket to a Unix socket, so my client can &#39;use&#39; a TCP socket to read / recv on the unix socket with socat as a proxy of sorts."}], "answers": [{"tags": [], "owner": {"reputation": 241, "user_id": 1286486, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5dcd0da3d2d8be87a8afd4b1036ca3cd?s=128&d=identicon&r=PG", "display_name": "e wagness", "link": "https://stackoverflow.com/users/1286486/e-wagness"}, "is_accepted": true, "score": 0, "last_activity_date": 1559235622, "creation_date": 1559235622, "answer_id": 56382553, "question_id": 56365010, "link": "https://stackoverflow.com/questions/56365010/socat-forwarding-tcp-socket-to-a-unix-socket-changes-recvmsg-to-read-drop/56382553#56382553", "title": "SOCAT, forwarding TCP socket to a Unix Socket, changes recvmsg() to read(), drops ancillary data", "body": "<p>Ancillary data is not sent over the wire / via TCP. Thats the answer I believe, frustratingly this information is seldom provided.</p>\n"}], "owner": {"reputation": 241, "user_id": 1286486, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5dcd0da3d2d8be87a8afd4b1036ca3cd?s=128&d=identicon&r=PG", "display_name": "e wagness", "link": "https://stackoverflow.com/users/1286486/e-wagness"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 56382553, "answer_count": 1, "score": 0, "last_activity_date": 1559235622, "creation_date": 1559147587, "last_edit_date": 1559153817, "question_id": 56365010, "link": "https://stackoverflow.com/questions/56365010/socat-forwarding-tcp-socket-to-a-unix-socket-changes-recvmsg-to-read-drop", "title": "SOCAT, forwarding TCP socket to a Unix Socket, changes recvmsg() to read(), drops ancillary data", "body": "<p>I am using socat to forward a TCP socket to a unix domain socket</p>\n\n<p>Here is an example command:</p>\n\n<pre><code>socat TCP-LISTEN:&lt;PORT&gt; UNIX-CONNECT:&lt;UNIX DOMAIN SOCKET&gt;\n</code></pre>\n\n<p>I need to read ancillary data out of the socket, and my problem is that socat is 'changing' the recvmsg() calls (from my TCP socket), and normal read() calls on the unix socket. As I understand, there is no way a read() call can get the ancillary data.</p>\n\n<p>My (python) client is remote, and calls recvmsg on the tcp socket.</p>\n\n<p>From a strace of my client:</p>\n\n<pre><code>recvmsg(3, {msg_name(0)=0x7ffc14322490, msg_iov(1)=[{\"\\360\", 1}], msg_controllen=0, msg_flags=0}, 0) = 1\nrecvmsg(3, {msg_name(0)=0x7ffc14322490, msg_iov(1)=[{\"\\252\", 1}], msg_controllen=0, msg_flags=0}, 0) = 1\n</code></pre>\n\n<p>Here is a strace of a program that reads directly from the unix socket, The data I need is the [5], in the ancillary data. This is what I want the strace on my remote machine to look like:</p>\n\n<pre><code>recvmmsg(3, {{\n{msg_name(0)=NULL, msg_iov(1)=[{\"\\360\", 1}], msg_controllen=20, [{cmsg_len=20, cmsg_level=SOL_SOCKET, cmsg_type=SCM_RIGHTS, [5]}], msg_flags=0}, 1}, {\n{msg_name(0)=NULL, msg_iov(1)=[{\"\\252\", 1}], msg_controllen=20, [{cmsg_len=20, cmsg_level=SOL_SOCKET, cmsg_type=SCM_RIGHTS, [6]}], msg_flags=0}, 1}, {\n</code></pre>\n\n<p>Here is a strace on the remote maching where socat is running / the read syscalls are being made. Notice that its reading the msg_iov data (the non ancillary data). The very top recvmsg's from my client are being translated into read() calls by socat on my remote machine</p>\n\n<pre><code>read(5, \"\\360\", 8192)                   = 1\nread(5, \"\\252\", 8192)                   = 1\n</code></pre>\n\n<p>Is there a way I can make socat not change these recvmsg calls into read() calls?</p>\n"}, {"tags": ["c++", "sockets", "udp"], "comments": [{"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1559147406, "post_id": 56364893, "comment_id": 99333111, "body": "winsock or winsock2?"}, {"owner": {"reputation": 11, "user_id": 9595162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Aubrey Russell", "link": "https://stackoverflow.com/users/9595162/aubrey-russell"}, "reply_to_user": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1559147545, "post_id": 56364893, "comment_id": 99333178, "body": "Why the downvote? I think its winsock. Should I be using winsock2?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1559148178, "post_id": 56364893, "comment_id": 99333470, "body": "My downvote (I can&#39;t speak for any other): Consider how difficult it is to debug software when you cannot see said software. It&#39;s like going to the mechanic with a car problem and leaving the car at home. There are countless reasons you could be running into this, such as using <code>strlen</code> on binary data, and there is no way for us to narrow in on the correct problem or family of problems other than dumb luck. Your question cannot be answered, and this  makes it &quot;Not useful&quot;."}, {"owner": {"reputation": 11, "user_id": 9595162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Aubrey Russell", "link": "https://stackoverflow.com/users/9595162/aubrey-russell"}, "edited": false, "score": 0, "creation_date": 1559148303, "post_id": 56364893, "comment_id": 99333519, "body": "tried both winsock2 and winsock and both have the same problem"}, {"owner": {"reputation": 11, "user_id": 9595162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Aubrey Russell", "link": "https://stackoverflow.com/users/9595162/aubrey-russell"}, "edited": false, "score": 0, "creation_date": 1559148745, "post_id": 56364893, "comment_id": 99333712, "body": "um, how could there be countless reasons? There is no strlen. The recv call is quite simple and mine is just recv(socket, buffer, default_buffer_length, 0). Default buffer length is 1500 and buffer has been initialized to be size of 1500. I&#39;m not sending data, i&#39;m receiving data so what does strlen have to do with it? As I mentioned the recv call is returning only 8 bytes even though wireshark sees 300."}, {"owner": {"reputation": 11, "user_id": 9595162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Aubrey Russell", "link": "https://stackoverflow.com/users/9595162/aubrey-russell"}, "edited": false, "score": 0, "creation_date": 1559149196, "post_id": 56364893, "comment_id": 99333919, "body": "I also explained the exact situation here. recv seems to only be reading up to the first 00 byte whereas wireshark is reading past it. Basically I need an explanation as to why recv cannot read past a 00 byte."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1559154794, "post_id": 56364893, "comment_id": 99336286, "body": "At the time the comment was made there was no code to back the claim of no <code>strlen</code>, leaving that possibility on the table. You have provided more information, but still not enough. <code>recv</code> can read past a zero byte. Since it isn&#39;t in your case, and all we&#39;ve been given is a single line that by itself should work, the bug must be elsewhere.  Consider playing a few rounds of divide and conquer to narrow the scope of the problem by eliminating all code that can be removed from the program while still reproducing the problem. Read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for suggestions and inspiration."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559157259, "post_id": 56364893, "comment_id": 99337304, "body": "@AubreyRussell &quot;<i>recv seems to only be reading up to the first 00 byte whereas wireshark is reading past it</i>&quot; - That is not how <code>recv</code> works. It doesn&#39;t look at, or care about, the actual bytes inside the datagram at all. If the sender sends X bytes, <code>recv()</code> will read and return <code>min(X, buffer_length)</code> bytes. The actual values of the bytes are irrelevant."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1559157581, "last_edit_date": 1559157581, "creation_date": 1559157198, "answer_id": 56367107, "question_id": 56364893, "link": "https://stackoverflow.com/questions/56364893/winsock-udp-recv-not-receiving-all-data-even-within-a-loop/56367107#56367107", "title": "Winsock udp recv not receiving all data even within a loop", "body": "<p>UDP is message-oriented, not stream-oriented like TCP is.</p>\n\n<p>In UDP, the <em>only</em> way that <code>recv()</code> would return 8 bytes is if either:</p>\n\n<ul>\n<li><p>you set the <code>len</code> parameter to <code>&gt; 8</code>, and a datagram containing exactly 8 bytes is received.</p></li>\n<li><p>you set the <code>len</code> parameter to <code>== 8</code>, and a datagram containing more than 8 bytes is received.</p></li>\n</ul>\n\n<p>Given your claim that that you are setting the <code>len</code> to 1500, then the only possibility is that the datagram received only has 8 bytes in it, not 299 bytes like you claim.</p>\n\n<p>Unlike in TCP, in UDP you cannot read a datagram in pieces, a read is an all-or-nothing operation (unless you peek the data, which you are not doing).  In UDP, <code>recv()</code>/<code>recvfrom()</code> reads whole datagrams at a time, and if the provided buffer is too small to receive the data (which it is not in this case) then an <code>WSAEMSGSIZE</code> error is reported and the data is truncated, discarding the rest of the data that does not fit in the buffer.</p>\n\n<p>The <code>00</code> null bytes you describe have NO EFFECT WHATEVER on <code>recv()</code>/<code>recvfrom()</code>'s ability to read a whole datagram.  A datagram carries a payload length, and <code>recv()</code>/<code>recvfrom()</code> will read up to that payload length or the specified buffer size, whichever is smaller, regardless of the actual payload content.</p>\n\n<p>So, chances are, in your code, <code>recv()</code> is simply not receiving the datagram you are expecting.</p>\n\n<p>For instance, in order to use <code>recv()</code> in UDP at all, you must <code>connect()</code> the UDP socket first to associate it with a specific peer IP/port, thus allowing <code>recv()</code> to ignore inbound datagrams from other peers (and for <code>send()</code> to send datagrams to a specific peer).  Maybe you are <code>connect</code>'ing your UDP socket to the wrong peer, and thus reading datagrams that are meant for something else.  Or, maybe you are <code>connect</code>'ing to the correct peer and it really is sending an 8-byte datagram that you are not expecting.</p>\n\n<p>Since you did not provide <em>any</em> context info about your setup, the peer involved, the protocol involved, the Wireshark capture, nothing, there is really no way for anyone here to diagnose your situation with any certainty.  But, what I described above would account for the symptom you have described.  If you feel that is not the case, then you need to edit your question to provide more details.</p>\n"}], "owner": {"reputation": 11, "user_id": 9595162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Aubrey Russell", "link": "https://stackoverflow.com/users/9595162/aubrey-russell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 293, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1559170456, "creation_date": 1559147112, "last_edit_date": 1559170456, "question_id": 56364893, "link": "https://stackoverflow.com/questions/56364893/winsock-udp-recv-not-receiving-all-data-even-within-a-loop", "title": "Winsock udp recv not receiving all data even within a loop", "body": "<p>I have some UDP recv code utilizing winsock, specifically AF_INET, SOCK_DGRAM, and IPPROTO_UDP. The recv call exists in a loop that reads until all data is received. The problem is that I only get partial data every time. Furthermore I shouldn't even need the loop since I can see that all the data exists in a single packet. In wireshark I see that the real data length is 299 bytes. Wireshark successfully sees the entire packet so I know the packet sender is working correctly. </p>\n\n<p>With my windows UDP code I only get 8 bytes until my receive method returns. I can see that the UDP code is stopping when it sees a 00 byte. Wireshark is able to read past those 00 bytes but windows udp recv is not able to read past it. It seems like windows sees the 00 as the end and therefore concludes that the packet is only 8 bytes. </p>\n\n<p>I have looked at the header in wireshark and I see that the length specified is correct so i'm very confused as to why its only reading 8 bytes. Thank you for your help in advance.</p>\n\n<p>This is what my receive call looks like for reference:</p>\n\n<pre><code>int ret = recv(socket, buffer, 1500, 0);\n</code></pre>\n\n<p>ret becomes 8 and buffer, which has been allocated to be 1500 bytes, is only filled with 8 bytes</p>\n"}, {"tags": ["c++", "qt", "vtk", "dicom"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1559147571, "post_id": 56364729, "comment_id": 99333186, "body": "Have you tried a different writer for the same data? That way you can rule out a problem with <code>testDat</code>."}, {"owner": {"reputation": 179, "user_id": 10448383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/au24R.png?s=128&g=1", "display_name": "Lambda1010", "link": "https://stackoverflow.com/users/10448383/lambda1010"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1559148553, "post_id": 56364729, "comment_id": 99333628, "body": "I tried vtk&#39;s TIFF reader and hard coding the file path using &quot; &quot;. Everything worked as expected. However hard coding the path using &quot; &quot; with the DICOM writer did not work. Yes it is Qt (QString), I was trying to convert it to const char*."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1559148834, "post_id": 56364729, "comment_id": 99333754, "body": "<a href=\"https://stackoverflow.com/questions/2523765/qstring-to-char-conversion\" title=\"qstring to char conversion\">stackoverflow.com/questions/2523765/qstring-to-char-conversi&zwnj;&#8203;on</a>"}, {"owner": {"reputation": 3245, "user_id": 5575382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/057515498825ff836584c58442d8d99c?s=128&d=identicon&r=PG&f=1", "display_name": "kritzel_sw", "link": "https://stackoverflow.com/users/5575382/kritzel-sw"}, "edited": false, "score": 1, "creation_date": 1559284687, "post_id": 56364729, "comment_id": 99378812, "body": "where does &quot;testDat&quot; come from?"}, {"owner": {"reputation": 179, "user_id": 10448383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/au24R.png?s=128&g=1", "display_name": "Lambda1010", "link": "https://stackoverflow.com/users/10448383/lambda1010"}, "edited": false, "score": 0, "creation_date": 1559323747, "post_id": 56364729, "comment_id": 99397299, "body": "testDat is vtkImageData"}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 10448383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/au24R.png?s=128&g=1", "display_name": "Lambda1010", "link": "https://stackoverflow.com/users/10448383/lambda1010"}, "edited": false, "score": 0, "creation_date": 1559148708, "post_id": 56365161, "comment_id": 99333695, "body": "Unfortunately, this did not work. I even tried hard coding the path using &quot; &quot; and I still get the access violation reading location. Its crashing on the <code>dcmWriter-&gt;Update()</code>, and if I comment out the <code>Update()</code> line, it will crash on the <code>dcmWriter-&gt;Write()</code> line."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1559148960, "post_id": 56365161, "comment_id": 99333808, "body": "Are you using the correct <code>vtk-dicom</code> binaries for your compiler?"}], "tags": [], "owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "is_accepted": false, "score": 0, "last_activity_date": 1559148826, "last_edit_date": 1559148826, "creation_date": 1559148165, "answer_id": 56365161, "question_id": 56364729, "link": "https://stackoverflow.com/questions/56364729/access-reading-violation-when-writing-a-dicom-with-vtkdicomwriter/56365161#56365161", "title": "Access Reading Violation when writing a DICOM with vtkDICOMWriter", "body": "<p>I need to make some guesses here because you didn't post all of your code, but I suspect that the problem happens in the following line:</p>\n\n<pre><code>dcmWriter-&gt;SetFileName(fullPath.toStdString().c_str());\n</code></pre>\n\n<p><code>toStdString()</code> is most probably returning a temporary <code>std::string</code> (<code>fullPath</code> looks like a Qt <a href=\"https://doc.qt.io/qt-5/qstring.html#toStdString\" rel=\"nofollow noreferrer\"><code>QString</code></a>), on which you call <code>c_str()</code>. After the statement, your temporary is destroyed and whatever you have passed to <code>SetFileName</code> is now a dangling pointer. Hence the segfault.</p>\n\n<p>Try the following instead::</p>\n\n<pre><code>const auto pathString = fullPath.toStdString();\ndcmWriter-&gt;SetFileName(pathString.c_str());\n</code></pre>\n\n<p>This should hopefully work fine. Even if not, it definitely is an issue with your code.</p>\n"}, {"tags": [], "owner": {"reputation": 976, "user_id": 3565017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ca9b87bfc80f0428240ea6b8c0b5be?s=128&d=identicon&r=PG&f=1", "display_name": "L.C.", "link": "https://stackoverflow.com/users/3565017/l-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1559319825, "creation_date": 1559319825, "answer_id": 56398666, "question_id": 56364729, "link": "https://stackoverflow.com/questions/56364729/access-reading-violation-when-writing-a-dicom-with-vtkdicomwriter/56398666#56398666", "title": "Access Reading Violation when writing a DICOM with vtkDICOMWriter", "body": "<p>These lines are from the example you posted:</p>\n\n<pre><code>writer-&gt;SetFilePrefix(\"/tmp\");\nwriter-&gt;SetFilePattern(\"%s/IM-0001-%04.4d.dcm\");\n</code></pre>\n\n<p>and you use </p>\n\n<pre><code>dcmWriter-&gt;SetFileName(fullPath.toStdString().c_str());\n</code></pre>\n\n<p>It seems that vtkDICOMWriter writes several files so you probably need to provide a file pattern. Anyway, it's hard to guess why it gives a reading error and it's hard to help if you don't post a full working example. </p>\n\n<p>Last, vtkDICOMWriter is not a class from vtk, it was released separetely (it seems) in 2017. This means it's not tested against the rest of VTK at every new release.</p>\n"}], "owner": {"reputation": 179, "user_id": 10448383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/au24R.png?s=128&g=1", "display_name": "Lambda1010", "link": "https://stackoverflow.com/users/10448383/lambda1010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1559319825, "creation_date": 1559146453, "last_edit_date": 1559148596, "question_id": 56364729, "link": "https://stackoverflow.com/questions/56364729/access-reading-violation-when-writing-a-dicom-with-vtkdicomwriter", "title": "Access Reading Violation when writing a DICOM with vtkDICOMWriter", "body": "<p>I'm trying to write vtkImageData as a DICOM. I keep getting an \"Access Reading Violation\" when I try to write the image. </p>\n\n<blockquote>\n  <p>Unhandled exception at 0x00007FFDA30ECA50 : 0xC0000005: Access violation reading location 0x000001BD38D5C000</p>\n</blockquote>\n\n<p>Here is my code: </p>\n\n<pre><code>vtkSmartPointer&lt;vtkDICOMWriter&gt; dcmWriter = vtkSmartPointer&lt;vtkDICOMWriter&gt;::New();\ndcmWriter-&gt;SetInputData(testDat);\ndcmWriter-&gt;SetFileName(fullPath.toStdString().c_str());\ndcmWriter-&gt;Update(); // this line breaks\ndcmWriter-&gt;Write(); \n</code></pre>\n\n<p><code>testDat</code> is a <code>vtkSmartPointer&lt;vtkImageData&gt;</code> type and has data in it. Any thoughts on whats causing the error? I can't find anything similar online.</p>\n\n<p>I followed this example: <a href=\"https://github.com/dgobbi/vtk-dicom/blob/master/Examples/TestDICOMWriter.cxx\" rel=\"nofollow noreferrer\">https://github.com/dgobbi/vtk-dicom/blob/master/Examples/TestDICOMWriter.cxx</a></p>\n\n<p>I don't have metadata, but that shouldn't be a problem.</p>\n"}, {"tags": ["java", "c++", "android-ndk", "java-native-interface"], "comments": [{"owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "edited": false, "score": 0, "creation_date": 1559147396, "post_id": 56364635, "comment_id": 99333107, "body": "Take a look here: <a href=\"https://github.com/mkowsiak/jnicookbook/tree/master/recipeNo013\" rel=\"nofollow noreferrer\">github.com/mkowsiak/jnicookbook/tree/master/recipeNo013</a> for a sample with committing changes. If you want to alter List, you will have to go via methods of object. Take a look here for a sample: <a href=\"https://github.com/mkowsiak/jnicookbook/tree/master/recipeNo037\" rel=\"nofollow noreferrer\">github.com/mkowsiak/jnicookbook/tree/master/recipeNo037</a>. You will have to convert your data to C++ structures."}, {"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1559148828, "post_id": 56364635, "comment_id": 99333749, "body": "You <i>are</i> already passing the list by reference. But it&#39;s a different kind of reference to a different type of data. Interfacing with Java code and objects using JNI is a lot like using reflection within Java. If you had write Java code that turned that <code>List&lt;Integer&gt;</code> into an <code>int[]</code> and back again using reflection, how would you do that? It should be fairly easy to translate such a solution into a sequence of JNI calls. Then you just need the final step of turning a <code>jintArray</code> into a <code>vector&lt;int&gt;</code>, but that&#39;s trivial (e.g. using <code>GetIntArrayElements</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "is_accepted": true, "score": 1, "last_activity_date": 1582233852, "last_edit_date": 1582233852, "creation_date": 1559321547, "answer_id": 56399010, "question_id": 56364635, "link": "https://stackoverflow.com/questions/56364635/how-to-pass-list-from-java-to-jni-c-as-vector-by-ref/56399010#56399010", "title": "How to pass List from Java to JNI C++ as vector by ref?", "body": "<p>In this case, it's quite simple. All you have to do is to pass <code>List</code> to your native code and fill it inside <code>JNI</code> part using <code>JNI</code> based access methods</p>\n\n<pre><code>#include &lt;vector&gt;\n#include \"jni.h\"\n#include \"recipeNo046_FillTheList.h\"\nusing namespace std;\n\nJNIEXPORT void JNICALL Java_recipeNo046_FillTheList_fillTheList\n  (JNIEnv *env, jclass cls, jobject obj) {\n\n  vector&lt;int&gt; vect { 1, 2, 3 };\n\n  jclass listClass = env-&gt;FindClass(\"java/util/List\");\n  if(listClass == NULL) {\n    return;                  // alternatively, throw exception (recipeNo019)\n  }\n\n  jclass integerClass = env-&gt;FindClass(\"java/lang/Integer\");\n  if(integerClass == NULL) {\n    return;                  // alternatively, throw exception (recipeNo019)\n  }\n\n  jmethodID addMethodID = env-&gt;GetMethodID(listClass, \"add\", \"(Ljava/lang/Object;)Z\");\n  if(addMethodID == NULL) {\n    return;                  //                 - || -\n  }\n\n  jmethodID integerConstructorID = env-&gt;GetMethodID(integerClass, \"&lt;init&gt;\", \"(I)V\");\n  if(integerConstructorID == NULL) {\n    return;                  //                 - || -\n  }\n\n  for(int i : vect) {\n    // Now, we have object created by Integer(i)\n    jobject integerValue = env-&gt;NewObject(integerClass, integerConstructorID, i);\n    if(integerValue == NULL) {\n      return;\n    }\n    env-&gt;CallBooleanMethod(obj, addMethodID, integerValue);\n  }\n\n  env-&gt;DeleteLocalRef(listClass);\n  env-&gt;DeleteLocalRef(integerClass);\n\n}\n</code></pre>\n\n<p>Note that you don't have to create <code>List</code> object inside <code>JNI</code> as you already have it there - inside <code>C++</code> code. It is passed as argument of <code>native</code> method.</p>\n\n<p>You can find full sample code here:</p>\n\n<p><a href=\"https://github.com/mkowsiak/jnicookbook/tree/master/recipes/recipeNo046\" rel=\"nofollow noreferrer\">https://github.com/mkowsiak/jnicookbook/tree/master/recipes/recipeNo046</a></p>\n\n<p>Once you run the code, you can see data from <code>C++</code> being passed through the <code>List</code> object.</p>\n\n<pre><code>&gt; make test\n/Library/Java/JavaVirtualMachines/jdk-12.0.1.jdk/Contents/Home/bin/java -Djava.library.path=:./lib -cp target recipeNo046.FillTheList\nlibrary: :./lib\n1\n2\n3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 115, "user_id": 11640307, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cIqVAlBuJuo/AAAAAAAAAAI/AAAAAAAABEA/ndcavxgK_q0/photo.jpg?sz=128", "display_name": "Siva Rahul", "link": "https://stackoverflow.com/users/11640307/siva-rahul"}, "is_accepted": false, "score": 0, "last_activity_date": 1561358942, "last_edit_date": 1561358942, "creation_date": 1561358540, "answer_id": 56731066, "question_id": 56364635, "link": "https://stackoverflow.com/questions/56364635/how-to-pass-list-from-java-to-jni-c-as-vector-by-ref/56731066#56731066", "title": "How to pass List from Java to JNI C++ as vector by ref?", "body": "<p>The answer mentioned by @Oo.oO may seem to work in Windows 10, But is not in the case with Windows 8.<br>\nWindows 8 does'nt support any containers from Cpp Libraries to work with.<br>\nThe Reported Error would be - \" %1 is not a valid Win32 Application \"<br>\nThis occurs while running the Java Program.<br>\nThe dll file generated here seem to be the issue.  </p>\n"}], "owner": {"reputation": 3379, "user_id": 5709159, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/DL3rX.jpg?s=128&g=1", "display_name": "Aleksey Timoshchenko", "link": "https://stackoverflow.com/users/5709159/aleksey-timoshchenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 837, "favorite_count": 0, "accepted_answer_id": 56399010, "answer_count": 2, "score": 1, "last_activity_date": 1582233852, "creation_date": 1559146047, "question_id": 56364635, "link": "https://stackoverflow.com/questions/56364635/how-to-pass-list-from-java-to-jni-c-as-vector-by-ref", "title": "How to pass List from Java to JNI C++ as vector by ref?", "body": "<p>I am fresh in C++ and JNI</p>\n\n<p>Flow should be like this</p>\n\n<p>From Java I pass a empty <code>List</code> to JNI, JNI invoke method <code>loadData(std::vector&lt;int&gt;)</code> from <code>MyClass</code> and this method fill my list with a data.</p>\n\n<p>So, question is</p>\n\n<p>I have </p>\n\n<pre><code>class MyClass {\npublic:\nMyClass();\n~MyClass();\n\nvoid loadData(std::vector&lt;int&gt; &amp; vector);\n};\n\n\nvoid MyClass::loadData(std::vector&lt;int&gt; &amp; vector)\n{\nconst int size = 10;\n\nvector.resize(size);\n\nfor (int i = 0; i &lt; size; ++i) {\n    vector.push_back(4);\n}\n}\n</code></pre>\n\n<p>This is my method that I wrote in pure C++ and now I need to use it from Java like this</p>\n\n<pre><code>public native void fillListWithData(List&lt;Integer&gt; list);\n</code></pre>\n\n<p>So, I wrote such method in JNI to associate them </p>\n\n<pre><code>extern \"C\" JNIEXPORT void JNICALL\nJava_com_google_ar_core_examples_java\n_helloar_HelloArActivity_fillListWithData(\n    JNIEnv *env,\n    jobject /* this */,\n    jobject input\n) {\nmyClass-&gt;loadData(\"HERE I NEED TO PASS MY \" input);\n}\n</code></pre>\n\n<p>And here how I should to invoke this method</p>\n\n<pre><code>public void TEST(){\n    List&lt;Integer&gt; list = new ArrayList&lt;&gt;();\n    fillListWithData(list);\n    Log.e(\"TAG\", \"HERE I NEED TO HAVE A LIST WITH FILLED DATA\");\n}\n</code></pre>\n\n<p>I can't understand how to pass this list by reference by JNI to C++...</p>\n\n<p>Any ideas appreciate </p>\n"}, {"tags": ["c++", "include", "forward-declaration"], "comments": [{"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 4, "creation_date": 1559145718, "post_id": 56364484, "comment_id": 99332246, "body": "Most of the time the order should not matter. I&#39;m voting to close this as opinion based."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1559146680, "post_id": 56364484, "comment_id": 99332729, "body": "you should write your headers such that the order of includes does not matter. If code breaks because you swap two includes then you did something wrong"}, {"owner": {"reputation": 1481, "user_id": 4438463, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1a0f16ea396090bd329422805329b1ba?s=128&d=identicon&r=PG&f=1", "display_name": "Touloudou", "link": "https://stackoverflow.com/users/4438463/touloudou"}, "edited": false, "score": 0, "creation_date": 1559147935, "post_id": 56364484, "comment_id": 99333347, "body": "I am asking this question precisely because I want to know if this is purely opinion-based, or if there is something more than I need to be aware of."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1559150709, "post_id": 56364484, "comment_id": 99334630, "body": "if you&#39;ve a spinning disk, you could work out which sectors they&#39;re all on - and then include them in order to minimise seeking times....   The time saved compared to that of buying a solid state disk or just not doing it and suffering the build time increase makes it well worth it.  I do it for all my projects."}], "answers": [{"tags": [], "owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "is_accepted": false, "score": 1, "last_activity_date": 1559145921, "creation_date": 1559145921, "answer_id": 56364607, "question_id": 56364484, "link": "https://stackoverflow.com/questions/56364484/c-include-header-forward-declaration-order/56364607#56364607", "title": "C++ include header / forward declaration order", "body": "<p>I think this is one of those questions that has no one right answer.</p>\n\n<p>The way I think of it (and its by no means the absolute answer) is from an encapsulation point of view and I tend to do the opposite of the google guidelines for this reason:</p>\n\n<ul>\n<li><p>If you include your project headers first you are less likley to hit issues where your header relies on some system include that went before it because you will just get a compile error... so therefore I find you see issues faster by putting the system includes last.</p></li>\n<li><p>Same thing for the forward declarations - if you need them and they are not provided by a header - then add them after the includes because the headers should not need them (otherwise it would be in the header) and so you only declare it as/when you need it...</p></li>\n</ul>\n\n<p>That is more-or-less my reasoning - but as I say, if your headers are designed correctly then you could do it either way...</p>\n"}], "owner": {"reputation": 1481, "user_id": 4438463, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1a0f16ea396090bd329422805329b1ba?s=128&d=identicon&r=PG&f=1", "display_name": "Touloudou", "link": "https://stackoverflow.com/users/4438463/touloudou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "closed_date": 1559146692, "answer_count": 1, "score": 0, "last_activity_date": 1559145921, "creation_date": 1559145490, "question_id": 56364484, "link": "https://stackoverflow.com/questions/56364484/c-include-header-forward-declaration-order", "closed_reason": "Opinion-based", "title": "C++ include header / forward declaration order", "body": "<p>A similar issue has already been discussed (<a href=\"https://stackoverflow.com/questions/2762568/c-c-include-header-file-order\">C/C++ include header file order</a>), but this thread makes no mention of forward declarations. If I summarize what I've read online so far:</p>\n\n<ol>\n<li><p>Everyone agrees that the corresponding header for the .cpp file should go first. This ensures that the header files has everything it needs.</p></li>\n<li><p>Beyond that, there seems to be no consensus. The Google guidelines (<a href=\"https://google.github.io/styleguide/cppguide.html\" rel=\"nofollow noreferrer\">https://google.github.io/styleguide/cppguide.html</a>) suggest including headers from system -> other libs -> project. Many people on SO suggest the exact opposite. It seems to be a matter of personal preferences.</p></li>\n</ol>\n\n<p>Regarding forward declarations, is there any reason to add them before/after the include headers? I don't see why it would matter (<a href=\"https://stackoverflow.com/questions/32715610/is-a-class-declaration-allowed-after-a-class-definition\">Is a class declaration allowed after a class definition?</a>), but maybe I am missing something.</p>\n"}, {"tags": ["c++", "class", "vector", "memory-reallocation"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559145197, "post_id": 56364340, "comment_id": 99331958, "body": "Entirely, is not a good idea to code like this? No it is not, forget about using <code>new</code> outside of constructing smartpointers until you really need it (probably never)"}, {"owner": {"reputation": 611, "user_id": 8572540, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-_EnHwIQ4h04/AAAAAAAAAAI/AAAAAAAAHMk/lHYNxYR8YcA/photo.jpg?sz=128", "display_name": "sungjun cho", "link": "https://stackoverflow.com/users/8572540/sungjun-cho"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559145276, "post_id": 56364340, "comment_id": 99331998, "body": "@formerlyknownas What i questioned was that is it good idea to manage vector(memory) like this"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 4, "creation_date": 1559145299, "post_id": 56364340, "comment_id": 99332022, "body": "Your question is quite unclear, why do you think that anything might &quot;collide&quot; here?"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 2, "creation_date": 1559145303, "post_id": 56364340, "comment_id": 99332024, "body": "You could write a much less contrived version with two <code>std::vector&lt;int&gt;</code> objects in local scope."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559145342, "post_id": 56364340, "comment_id": 99332041, "body": "i dont really understand. You are not managing the vectors memory, the vector does that for you"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 7, "creation_date": 1559145372, "post_id": 56364340, "comment_id": 99332061, "body": "Anyway, the answer is that the vector object doesn&#39;t grow when you add elements to it - the top-level object manages some dynamically-allocated storage <i>elsewhere</i>. Your false premise is that increasing <code>vector.size()</code> affects <code>sizeof(vector)</code>, and it doesn&#39;t."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559145385, "post_id": 56364340, "comment_id": 99332068, "body": "vectors do not store their elements on the stack if thats your source of confusion"}, {"owner": {"reputation": 16695, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 0, "creation_date": 1559145404, "post_id": 56364340, "comment_id": 99332078, "body": "&quot;there might exist chances to collide memory address range of each vector inside each class while resizing their memory size.&quot; This part is not at all clear"}, {"owner": {"reputation": 16695, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 0, "creation_date": 1559145489, "post_id": 56364340, "comment_id": 99332125, "body": "Classes have a fixed compile-time size in C++. Nothing grows or shrinks on the stack. How do you think <code>sizeof</code> works without evaluating its parameters?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1559145511, "post_id": 56364340, "comment_id": 99332135, "body": "This sounds like an <a href=\"http://Xyproblem.info\" rel=\"nofollow noreferrer\">XY Problem</a>, what are you <i>actually</i> trying to achieve?"}, {"owner": {"reputation": 611, "user_id": 8572540, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-_EnHwIQ4h04/AAAAAAAAAAI/AAAAAAAAHMk/lHYNxYR8YcA/photo.jpg?sz=128", "display_name": "sungjun cho", "link": "https://stackoverflow.com/users/8572540/sungjun-cho"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1559145520, "post_id": 56364340, "comment_id": 99332143, "body": "@Jabberwocky since vector will be resized while pushing back, vectors inside each class can&#39;t resize its area consecutively, which means they have to be copied into other memory area and has to be resized in that area."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1559145575, "post_id": 56364340, "comment_id": 99332170, "body": "Yes the vectors will be resized, so where is the problem?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1559145581, "post_id": 56364340, "comment_id": 99332175, "body": "<i>vectors inside each class can&#39;t resize its area consecutively,</i> -- What does one vector have to do with the other?  They are separate objects -- one knows nothing or cares about what the other is doing."}, {"owner": {"reputation": 16695, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 1, "creation_date": 1559145595, "post_id": 56364340, "comment_id": 99332181, "body": "Vector does not <i>&quot;grow inside each class&quot;</i> That is not a thing. Vector does not store its data on the stack"}, {"owner": {"reputation": 611, "user_id": 8572540, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-_EnHwIQ4h04/AAAAAAAAAAI/AAAAAAAAHMk/lHYNxYR8YcA/photo.jpg?sz=128", "display_name": "sungjun cho", "link": "https://stackoverflow.com/users/8572540/sungjun-cho"}, "edited": false, "score": 0, "creation_date": 1559145658, "post_id": 56364340, "comment_id": 99332220, "body": "sry I think I have to edit my question."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1559145683, "post_id": 56364340, "comment_id": 99332233, "body": "related/maybe dupe: <a href=\"https://stackoverflow.com/questions/55478523/how-does-stdvector-support-contiguous-memory-for-custom-objects-of-unknown-siz\" title=\"how does stdvector support contiguous memory for custom objects of unknown siz\">stackoverflow.com/questions/55478523/&hellip;</a>"}, {"owner": {"reputation": 611, "user_id": 8572540, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-_EnHwIQ4h04/AAAAAAAAAAI/AAAAAAAAHMk/lHYNxYR8YcA/photo.jpg?sz=128", "display_name": "sungjun cho", "link": "https://stackoverflow.com/users/8572540/sungjun-cho"}, "edited": false, "score": 0, "creation_date": 1559145731, "post_id": 56364340, "comment_id": 99332258, "body": "anyway now i understand something that i have missed"}], "answers": [{"comments": [{"owner": {"reputation": 611, "user_id": 8572540, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-_EnHwIQ4h04/AAAAAAAAAAI/AAAAAAAAHMk/lHYNxYR8YcA/photo.jpg?sz=128", "display_name": "sungjun cho", "link": "https://stackoverflow.com/users/8572540/sungjun-cho"}, "edited": false, "score": 0, "creation_date": 1559145876, "post_id": 56364561, "comment_id": 99332316, "body": "This is what I want to know. Thank you. So does the vector act as dynamic array initialized with small size(by programmer)?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 611, "user_id": 8572540, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-_EnHwIQ4h04/AAAAAAAAAAI/AAAAAAAAHMk/lHYNxYR8YcA/photo.jpg?sz=128", "display_name": "sungjun cho", "link": "https://stackoverflow.com/users/8572540/sungjun-cho"}, "edited": false, "score": 0, "creation_date": 1559146210, "post_id": 56364561, "comment_id": 99332502, "body": "@sungjuncho Yes, <code>std::vector</code> is a dynamic array that keeps its elements on the heap. <code>std::array</code> is a static array allocated at compile time, that cannot change its size. And don&#39;t bother with C-style arrays in new code."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 611, "user_id": 8572540, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-_EnHwIQ4h04/AAAAAAAAAAI/AAAAAAAAHMk/lHYNxYR8YcA/photo.jpg?sz=128", "display_name": "sungjun cho", "link": "https://stackoverflow.com/users/8572540/sungjun-cho"}, "edited": false, "score": 0, "creation_date": 1559146389, "post_id": 56364561, "comment_id": 99332582, "body": "@sungjuncho hm yes, kind of. <code>std::vector</code> is much more than that. Just to name one example, it has an <code>operator==</code> that does what you want, something that is unnecessarily complicated with c-arrays"}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": true, "score": 8, "last_activity_date": 1559145901, "last_edit_date": 1559145901, "creation_date": 1559145756, "answer_id": 56364561, "question_id": 56364340, "link": "https://stackoverflow.com/questions/56364340/how-memory-works-if-vectors-inside-class-array-are-dynamically-push-backed/56364561#56364561", "title": "How memory works if vectors inside class array are dynamically push_backed?", "body": "<p>Consider this example:</p>\n\n<pre><code>struct foo {\n    std::vector&lt;int&gt; x;\n    std::vector&lt;int&gt; y;\n};\n</code></pre>\n\n<p>Now <code>sizeof(foo)</code> is a compile time constant. It does not change when you add elements to the vectors. Also <code>sizeof(std::vector&lt;int&gt;)</code> is constant. </p>\n\n<p>The size of a <code>foo</code> instance is not increasing when the <code>size()</code> of the vector grows. It is similar to having a dynamic array (only for the sake of the example):</p>\n\n<pre><code>struct bar {\n   int* c_array;\n};\n</code></pre>\n\n<p>Here, <code>sizeof(bar)</code> is likely to be just <code>sizeof(int*)</code>, because it is just a pointer, even though it could point to the first element of a c-style array, or to a single <code>int</code>. </p>\n"}], "owner": {"reputation": 611, "user_id": 8572540, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-_EnHwIQ4h04/AAAAAAAAAAI/AAAAAAAAHMk/lHYNxYR8YcA/photo.jpg?sz=128", "display_name": "sungjun cho", "link": "https://stackoverflow.com/users/8572540/sungjun-cho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 56364561, "answer_count": 1, "score": 1, "last_activity_date": 1559146200, "creation_date": 1559144922, "last_edit_date": 1559145204, "question_id": 56364340, "link": "https://stackoverflow.com/questions/56364340/how-memory-works-if-vectors-inside-class-array-are-dynamically-push-backed", "title": "How memory works if vectors inside class array are dynamically push_backed?", "body": "<p>Assume that we have following class:</p>\n\n<pre><code>class Test {\npublic:\n   Test() {}\n   std::vector&lt;int&gt;&amp; getIntList() {\n      return intList;\n   }\nprivate:\n   std::vector&lt;int&gt; intList;\n};\n</code></pre>\n\n<p>Also, we have following codes inside main function to declare class array:</p>\n\n<pre><code>int main(void) {\n   Test* test[20];\n\n   for (int i = 0; i &lt; 20; ++i) {\n      test[i] = new Test();\n   }\n}\n</code></pre>\n\n<p>In these cases, test objects are instantiated. </p>\n\n<p>Now if I append multiple items in the vector inside each class randomly,</p>\n\n<p>there might exist chances to collide memory address range of each vector inside each class while resizing their memory size.</p>\n\n<p>In this case, is the entire 'test' object copied into other memory area and vector is resized?\nOr, is vector STL only copied into other memory area and resized while the class references the vector?</p>\n\n<p>Entirely, is not a good idea to code like this?</p>\n"}, {"tags": ["c++", "gdb", "eigen"], "comments": [{"owner": {"reputation": 191, "user_id": 4400686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812a51d21bfa004b03873b844f146ba5?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Taw", "link": "https://stackoverflow.com/users/4400686/eric-taw"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1559152385, "post_id": 56364205, "comment_id": 99335278, "body": "Thanks. I&#39;m compiling with the Eigen source, not with the library."}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1559160782, "post_id": 56364205, "comment_id": 99338688, "body": "@JesperJuhl Just for clarification: Eigen is header-only, i.e., not compiled separately. Eric: Can you provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}], "answers": [{"tags": [], "owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "is_accepted": false, "score": 0, "last_activity_date": 1559302638, "creation_date": 1559302638, "answer_id": 56394389, "question_id": 56364205, "link": "https://stackoverflow.com/questions/56364205/gdb-eigen-debugging-with-conditional-breakpoints-failing/56394389#56394389", "title": "GDB Eigen Debugging with Conditional Breakpoints Failing", "body": "<p>According to <a href=\"https://stackoverflow.com/questions/10801112/\">this question</a>, (sometimes) GDB seems to have problems with overloaded operators. You could try one of these alternatives:</p>\n\n<pre><code>if (! v.isZero())\n\nif (! v.cwiseEqual(0).all()) \n</code></pre>\n\n<p>And instead of <code>if v[0] != 0</code> you could try one of these:</p>\n\n<pre><code> if (v.data()[0] != 0)\n\n if (v.coeff(0) != 0)\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 4400686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812a51d21bfa004b03873b844f146ba5?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Taw", "link": "https://stackoverflow.com/users/4400686/eric-taw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1559302638, "creation_date": 1559144442, "last_edit_date": 1559148081, "question_id": 56364205, "link": "https://stackoverflow.com/questions/56364205/gdb-eigen-debugging-with-conditional-breakpoints-failing", "title": "GDB Eigen Debugging with Conditional Breakpoints Failing", "body": "<p>I'm trying to debug with GDB using conditional breakpoints on an Eigen object. For instance, I'd like to break when any values in my vector are nonzero. I would do this in GDB:</p>\n\n<pre><code>break cpp/File.cpp:143 if (v != 0).any()\n</code></pre>\n\n<p>However, this doesn't work. GDB gives this:</p>\n\n<pre><code>Could not find operator!=\n</code></pre>\n\n<p>even though this is perfectly valid syntax. Moreover, a conditional breakpoint like </p>\n\n<pre><code>break cpp/File.cpp:143 if v[0] != 0\n</code></pre>\n\n<p>gives this error in GDB:</p>\n\n<pre><code>Error in testing breakpoint condition:\nCouldn't get registers: No such process.\nAn error occurred while in a function called from GDB.\nEvaluation of the expression containing the function\n(Eigen::DenseCoeffsBase&lt;Eigen::Array&lt;int, 3, 1, 0, 3, 1&gt;, 1&gt;::operator[](long)) will be abandoned.\nWhen the function is done executing, GDB will silently stop.\n</code></pre>\n\n<p>The code was compiled with <code>-O0 -g -fno-inline</code>. How do I debug the contents of an Eigen object?</p>\n"}, {"tags": ["c++", "linux", "path", "c++17", "known-folders"], "comments": [{"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 1, "creation_date": 1559144733, "post_id": 56364165, "comment_id": 99331718, "body": "Not that I know of. The linux file system usually follows a <a href=\"https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard\" rel=\"nofollow noreferrer\">standard</a> though, but variations may occur in some distros."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1559145184, "post_id": 56364165, "comment_id": 99331945, "body": "and there are standard environment variables which are usually set, like <code>USER</code>, <code>HOME</code>, etc. RoamingAppData probably equates to <code>&quot;${HOME}&#47;.config&quot;</code> or something similar"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1559145883, "post_id": 56364165, "comment_id": 99332324, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/37178010/608639\">SHGetKnownFolderPath equivalent API in Linux</a>, <a href=\"https://stackoverflow.com/q/37558406/608639\">FOLDERID_RoamingAppData equivalent in linux</a>, etc."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 4, "last_activity_date": 1559148305, "last_edit_date": 1592644375, "creation_date": 1559146053, "answer_id": 56364638, "question_id": 56364165, "link": "https://stackoverflow.com/questions/56364165/how-to-get-known-paths-for-linux/56364638#56364638", "title": "How to get known paths for linux", "body": "<p>Linux is an operating system kernel. It does not have a concept of user directories.</p>\n<p>There are several Linux distributions. The filesystem structure is determined by the distro. Most distros conform to <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799.2018edition/\" rel=\"nofollow noreferrer\">POSIX standard</a>, and follow (to varying degree) the <a href=\"https://refspecs.linuxfoundation.org/FHS_3.0/fhs-3.0.pdf\" rel=\"nofollow noreferrer\">Filesystem Hierarchy Standard</a> by Linux Foundation, which is similar to the directory structures of other UNIX like systems. That said, distributions generally allow the user to use the file system in unconventional configurations. For example, they don't typically force users home directory to be under <code>/home</code>.</p>\n<p>POSIX specifies a few environment variables that are relevant to this context:</p>\n<blockquote>\n<pre><code>HOME\n</code></pre>\n<p>The system shall initialize this variable at the time of login to be a pathname of the user's home directory.</p>\n<pre><code>TMPDIR\n</code></pre>\n<p>This variable shall represent a pathname of a directory made available for programs that need a place to create temporary files.</p>\n</blockquote>\n<p>Environment variables can be accessed using <code>std::getenv</code> in C++.</p>\n<hr />\n<p>On desktop systems, the directory structure is also determined to some degree by the desktop environment, of which there are several available. freedesktop.org produces unofficial specifications for interoperability of different desktop environments. On DE's conforming to <a href=\"https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html\" rel=\"nofollow noreferrer\">XDG Base Directory Specification</a> should following environment variables be available:</p>\n<blockquote>\n<p>$XDG_DATA_HOME defines the base directory relative to which user specific data files should be stored. If $XDG_DATA_HOME is either not set or empty, a default equal to $HOME/.local/share should be used.</p>\n<p>$XDG_CONFIG_HOME defines the base directory relative to which user specific configuration files should be stored. If $XDG_CONFIG_HOME is either not set or empty, a default equal to $HOME/.config should be used.</p>\n<p>$XDG_DATA_DIRS defines the preference-ordered set of base directories to search for data files in addition to the $XDG_DATA_HOME base directory. The directories in $XDG_DATA_DIRS should be seperated with a colon ':'.</p>\n<p>If $XDG_DATA_DIRS is either not set or empty, a value equal to /usr/local/share/:/usr/share/ should be used.</p>\n</blockquote>\n<p>freedesktop.org also provides a utility <a href=\"https://www.freedesktop.org/wiki/Software/xdg-user-dirs/\" rel=\"nofollow noreferrer\">xdg-user-dirs</a>:</p>\n<blockquote>\n<p>xdg-user-dirs is a tool to help manage &quot;well known&quot; user directories like the desktop folder and the music folder. It also handles localization (i.e. translation) of the filenames.</p>\n<p>$(XDG_CONFIG_HOME)/user-dirs.dirs specifies the current set of directories for the user. This file is in a shell format, so its easy to access from a shell script. This file can also be modified by users (manually or via applications) to change the directories used.</p>\n</blockquote>\n<hr />\n<p>So, in case of <code>FOLDERID_RoamingAppData</code>, you should probably use one of <code>$XDG_x</code> depending on the use case, falling back to the appropriate default relative to <code>$HOME</code> as specified.</p>\n"}], "owner": {"reputation": 8345, "user_id": 421178, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9fa51d322613d477fd82330340c46ff3?s=128&d=identicon&r=PG", "display_name": "Casey", "link": "https://stackoverflow.com/users/421178/casey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 56364638, "answer_count": 1, "score": 3, "last_activity_date": 1559148305, "creation_date": 1559144288, "question_id": 56364165, "link": "https://stackoverflow.com/questions/56364165/how-to-get-known-paths-for-linux", "title": "How to get known paths for linux", "body": "<p>Windows has a concept of a Known Path with functions to retrieve them without hard-coding a path:</p>\n\n<pre><code>#include &lt;filesystem&gt;\n#include &lt;windows.h&gt;\n#include &lt;ShlObj.h&gt;\n//...\nstd::filesystem::path GetAppDataPath() {\n    namespace FS = std::filesystem;\n    PWSTR ppszPath = nullptr;\n    auto hr_path = ::SHGetKnownFolderPath(FOLDERID_RoamingAppData, KF_FLAG_DEFAULT, nullptr, &amp;ppszPath);\n    bool success = SUCCEEDED(hr_path);\n    if (success) {\n        auto p = FS::path(ppszPath);\n        ::CoTaskMemFree(ppszPath);\n        p = FS::canonical(p);\n        return p;\n    }\n    return {};\n}\n</code></pre>\n\n<p>Is there an equivalent for linux?</p>\n"}, {"tags": ["c++", "multithreading", "boost", "locking"], "comments": [{"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559145196, "post_id": 56363792, "comment_id": 99331956, "body": "Mh im not familiar with the syntax of <code>_(mutex_);</code> when i try to compile i get an error that _mutex is not defined. As i would analyse it this line tries to create a variable <code>_</code> with construction argument <code>_mutex</code>?"}, {"owner": {"reputation": 11, "user_id": 8062971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70fb85fd7fcd1514eb516fcfedbaa2d4?s=128&d=identicon&r=PG&f=1", "display_name": "alpc40", "link": "https://stackoverflow.com/users/8062971/alpc40"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559226813, "post_id": 56363792, "comment_id": 99360900, "body": "oh,I&#39;m sorry,you must add the definition: <b>boost::shared_mutex mutex_;</b>"}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559300054, "post_id": 56363792, "comment_id": 99386017, "body": "Okay might be too late but i now compiled and run your example on linux and i can not reproduce your problem so it does not seem to be your implementation."}, {"owner": {"reputation": 11, "user_id": 8062971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70fb85fd7fcd1514eb516fcfedbaa2d4?s=128&d=identicon&r=PG&f=1", "display_name": "alpc40", "link": "https://stackoverflow.com/users/8062971/alpc40"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559726948, "post_id": 56363792, "comment_id": 99507382, "body": "yeah, I get the problem in windows 2010. Thank you all the same."}], "owner": {"reputation": 11, "user_id": 8062971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70fb85fd7fcd1514eb516fcfedbaa2d4?s=128&d=identicon&r=PG&f=1", "display_name": "alpc40", "link": "https://stackoverflow.com/users/8062971/alpc40"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559143011, "creation_date": 1559143011, "question_id": 56363792, "link": "https://stackoverflow.com/questions/56363792/why-i-get-no-error-exception-by-boostuniqueboostshared-mutex", "title": "Why I get No error exception by boost::unique&lt;boost::shared_mutex&gt;", "body": "<p>I'm using boost to solve a multi-threads problem. It gets some problems when I use boost::unique_lock as <strong>WriteLock</strong>. </p>\n\n<p>I simplify the code as following:</p>\n\n<pre><code>void test() {\n    try {\n        boost::unique_lock&lt;boost::shared_mutex&gt; _(mutex_);\n        Sleep(20);\n        printf(\"asdfasdf\\n\");\n    } catch (boost::system::system_error &amp;ex) {\n        printf(\"boost::exception:%s\\n\", ex.what());\n        printf(\"boost::exception:%d\\n\", ex.code().value());\n    }catch (std::exception &amp;ex) {\n        printf(\"exception:%s\\n\", ex.what());\n    }\n}\n\n\nint main() {\n    std::vector&lt;std::thread *&gt; thread_pool;\n        int max_thread=1000;\n    for (int i = 0; i &lt; max_thread; i++) {\n        std::thread *t = new std::thread(test);\n        thread_pool.push_back(t);\n    }\n    for (int i = 0; i &lt; thread_pool.size(); i++) {\n        thread_pool[i]-&gt;join();\n    }\n    getchar();\n}\n</code></pre>\n\n<p>when the <strong>max_thread</strong> smaller than 200 (nearly), the program runs smoothly.</p>\n\n<p>However, it get many exceptions when <strong>max_thread</strong> bigger than 200 (such as 1000),The result is like this:</p>\n\n<pre><code>.....\nboost::exception:boost::lock_error: No error\nboost::exception:0\nboost::exception:boost::lock_error: No error\nboost::exception:0\nboost::exception:0\nboost::exception:0\nboost::exception:boost::lock_error: No error\nboost::exception:0\nboost::exception:boost::lock_error: No error\nboost::exception:0\nasdfasdf\nasdfasdf\nasdfasdf\nasdfasdf\nasdfasdf\nasdfasdf\nasdfasdf\nasdfasdf\nasdfasdf\nasdfasdf\n......\n</code></pre>\n\n<p>My system is win10 with c++11 and boost_1.67</p>\n\n<p>does anyone know why and how to solve it?</p>\n"}, {"tags": ["c++", "performance", "binary-search", "unordered-set"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 8, "creation_date": 1559143071, "post_id": 56363791, "comment_id": 99330757, "body": "Keep in mind that Big O notation represents the behavior of an algorithm <i>as the input set&#39;s size tends to infinity</i>. If you don&#39;t have infinite input data, constant and lower order overhead can still be significant."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 4, "creation_date": 1559143151, "post_id": 56363791, "comment_id": 99330802, "body": "Locality and branch prediction is <i>huge</i> for performance. Sorted data can be very fast to work with. Even with higher order time complexity, if those operations are much faster than your alternative algorithm it may still be faster. This ties in with my previous comment."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 1, "creation_date": 1559143336, "post_id": 56363791, "comment_id": 99330910, "body": "&quot;Any thought on this?&quot; is kinda vague question. Can you be more specific?"}, {"owner": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 0, "creation_date": 1559143364, "post_id": 56363791, "comment_id": 99330928, "body": "It would be interesting to know the <code>size</code> of your use case"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 1, "creation_date": 1559143395, "post_id": 56363791, "comment_id": 99330947, "body": "@Damien <code>int size = 5000000; int* in = TwoSum::Testcase(size);</code>."}, {"owner": {"reputation": 585, "user_id": 7345753, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Uc9D2H4PVFw/AAAAAAAAAAI/AAAAAAAAAGk/H6klX_lKjq8/photo.jpg?sz=128", "display_name": "santosh kumar", "link": "https://stackoverflow.com/users/7345753/santosh-kumar"}, "edited": false, "score": 0, "creation_date": 1559143406, "post_id": 56363791, "comment_id": 99330954, "body": "int size = 5000000;"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559143410, "post_id": 56363791, "comment_id": 99330959, "body": "you measure absolute time while complexity tells you close to zero about that. You can have a O(N) algorithm that performs worse than a O(N^500) one in absolute terms for some N"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1559143767, "post_id": 56363791, "comment_id": 99331172, "body": "This is why arrays (and vectors) rock.  The data they store is all in one location making their cache locality great.  Using an <code>unordered_set</code> you&#39;re going have at least one cache miss for every element you access.  Using an array, unless you are jumping around randomly on a array to big to fit in the cache, you don&#39;t get the cache misses.  There is a really good talk about this here: <a href=\"https://www.youtube.com/watch?v=fHNmRkzxHWs\" rel=\"nofollow noreferrer\">youtube.com/watch?v=fHNmRkzxHWs</a>"}, {"owner": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1559143803, "post_id": 56363791, "comment_id": 99331190, "body": "@Fran&#231;oisAndrieux Sorry, I read too fast. This is a rather large value. I am surprised that the <i>crossing point</i> has not been met"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 1, "creation_date": 1559143850, "post_id": 56363791, "comment_id": 99331225, "body": "@Damien As I and others have mentioned, the difference is probably due to locality. Operating on cache is significantly faster than having to read from RAM. I&#39;ve seen numbers like 40 and 100 CPU cycles are needed to load a chunk from RAM, but I&#39;ll admit I don&#39;t know exactly. And log2(5000000) is only about 22."}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 1, "creation_date": 1559144983, "post_id": 56363791, "comment_id": 99331832, "body": "Yo do unnecessary work for <code>hash</code> sets. You first do a lookup, then you ignore the result and do the insertion. Just check the second element of the pair returned by <code>insert</code> and see how it&#39;ll work. Also, specify the compiler you&#39;ve used."}, {"owner": {"reputation": 585, "user_id": 7345753, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Uc9D2H4PVFw/AAAAAAAAAAI/AAAAAAAAAGk/H6klX_lKjq8/photo.jpg?sz=128", "display_name": "santosh kumar", "link": "https://stackoverflow.com/users/7345753/santosh-kumar"}, "reply_to_user": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 0, "creation_date": 1559145492, "post_id": 56363791, "comment_id": 99332127, "body": "@DanM. I am using MS Visual studio 2019"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1559157965, "post_id": 56363791, "comment_id": 99337557, "body": "Keep in mind that every <code>unordered_set</code> insert is doing a memory allocation.  This adds a considerable amount of time to every loop iteration."}], "answers": [{"tags": [], "owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1559144954, "creation_date": 1559144954, "answer_id": 56364353, "question_id": 56363791, "link": "https://stackoverflow.com/questions/56363791/onlogn-shows-better-performance-than-on-if-unordered-set-is-used/56364353#56364353", "title": "O(NLogN) shows better performance than O(N) if unordered_set is used", "body": "<p>This is because computational complexity doesn\u2019t take into account the behavior of multi-level memory system present in every modern computer. And it is precisely because you measure that behavior via proxy using time (!!), that your measurement is not \u201clike\u201d theoretical computational complexity. <strong>Computational complexity predicts execution times only in very well controlled situations, when the code is optimal for the platform</strong>. If you want to measure complexity, you can\u2019t measure time. Measure operation counts. It will agree with theory then.</p>\n\n<p>In my limited experience, it is rather rare that computational complexity theory would predict runtimes on reasonably sized data sets, when the behavior is neither exponential nor cubic (or higher terms). Cache access patterns and utilization of architectural parallelism are major predictors of performance, before computational complexity comes into play. </p>\n"}], "owner": {"reputation": 585, "user_id": 7345753, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Uc9D2H4PVFw/AAAAAAAAAAI/AAAAAAAAAGk/H6klX_lKjq8/photo.jpg?sz=128", "display_name": "santosh kumar", "link": "https://stackoverflow.com/users/7345753/santosh-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559144954, "creation_date": 1559142992, "last_edit_date": 1592644375, "question_id": 56363791, "link": "https://stackoverflow.com/questions/56363791/onlogn-shows-better-performance-than-on-if-unordered-set-is-used", "title": "O(NLogN) shows better performance than O(N) if unordered_set is used", "body": "<pre><code>//Time sorting O(nlogn) + binary search for N items logN = 2NLogN = \n//Time: O(NLogN). \n//space - O(1).\nbool TwoSum::TwoSumSortAndBinarySearch(int* arr, int size, int sum)\n{\n    sort(arr, arr + size);\n    \n    for (int i = 0; i &lt; size; i++)\n    {\n        if (binary_search(arr + i + 1, arr + size, sum - arr[i]))\n            return true;\n    }\n    return false;\n}\n\n\n//Time: O(N) as time complexity of Add and Search in hashset/unordered_set is O(1).\n//Space: O(N)\nbool TwoSum::TwoSumHashSet(int* arr, int size, int sum)\n{\n    unordered_set&lt;int&gt; hash;\n    for (int i = 0; i &lt; size; i++)\n    {\n        if (hash.find(sum - arr[i]) != hash.end())\n            return true;\n        hash.insert(arr[i]);\n    }\n    return false;\n}\n\nint* TwoSum::Testcase(int size)\n{\n    int* in = new int[size];\n    for (int i = 0; i &lt; size; i++)\n    {       \n        in[i] = rand() % (size + 1);//random number b/w 0 to N.\n    }\n    return in;\n}\n\nint main()\n{\n    int size = 5000000;\n    int* in = TwoSum::Testcase(size);\n    \n    auto start = std::chrono::system_clock::now();//clock start \n    bool output = TwoSum::TwoSumHashSet(in, size, INT_MAX);\n    auto end = std::chrono::system_clock::now();//clock end\n\n    std::chrono::duration&lt;double&gt; elapsed_seconds = end - start;\n    cout &lt;&lt; &quot;elapsed time: &quot; &lt;&lt; elapsed_seconds.count() &lt;&lt; &quot;s\\n&quot;;   \n}\n</code></pre>\n<p>I measured the performance of the above two methods, where I would like to find the TwoSum problem.\nIn the First approach, I am sorting the array then using binary search.\nTime: O(NLogN).\nspace - O(1).</p>\n<p>In the second approach, <a href=\"https://en.cppreference.com/w/cpp/container/unordered_set/find\" rel=\"nofollow noreferrer\">unordered_set</a> is used whose complexity is constant on average, worst case linear in the size of the container.</p>\n<p>//Time: O(N) as time complexity of Add and Search in hashset/unordered_set is O(1).\n//Space: O(N)</p>\n<p>Here are the three runs time taken by these two methods</p>\n<h2>TwoSumSortAndBinarySearch---------------TwoSumHashSet</h2>\n<hr />\n<ol>\n<li>8.05---------------------------------------15.15</li>\n</ol>\n<hr />\n<ol start=\"2\">\n<li>7.76---------------------------------------14.47</li>\n</ol>\n<hr />\n<ol start=\"3\">\n<li>7.74---------------------------------------14.28</li>\n</ol>\n<p>So, it is clear that TwoSumSortAndBinarySearch performs definitely better than unordered_Set.</p>\n<p>Which approach is more preferable and suggested in real scenario and why?</p>\n"}, {"tags": ["c++"], "owner": {"reputation": 382, "user_id": 11571396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5def31ad84a650795c0aed92cb953224?s=128&d=identicon&r=PG&f=1", "display_name": "milck", "link": "https://stackoverflow.com/users/11571396/milck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "closed_date": 1559141493, "answer_count": 0, "score": 2, "last_activity_date": 1559141414, "creation_date": 1559141414, "question_id": 56363347, "link": "https://stackoverflow.com/questions/56363347/question-about-inheritence-of-a-template-class-and-the-usage-of-this", "closed_reason": "Duplicate", "title": "Question about inheritence of a template class and the usage of this", "body": "<p>I have this little sample class here:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n\nclass A {\nprotected:\n    void method_a() {\n        std::cout &lt;&lt; \"Hello World\" &lt;&lt; std::endl;\n    }\n};\n\ntemplate &lt;class T&gt;\nclass B : public A {\npublic:\n    void method_b() {\n        method_a();\n    }\n};\n\ntemplate &lt;class T&gt;\nclass C : public B&lt;T&gt; {\npublic:\n    void method_c() {\n        method_a(); // the line the question is about\n    }\n};\n\nint main() {\n\n    C&lt;int&gt; c;\n    c.method_c();\n}\n</code></pre>\n\n<p>If I compile this using g++ I get this error:</p>\n\n<pre><code>$ tmp g++ -std=c++17 test.cpp\ntest.cpp: In member function \u2018void C&lt;T&gt;::method_c()\u2019:\ntest.cpp:22:9: error: there are no arguments to \u2018method_a\u2019 that depend on a template parameter, so a declaration of \u2018method_a\u2019 must be available [-fpermissive]\n         method_a();\n         ^~~~~~~~\ntest.cpp:22:9: note: (if you use \u2018-fpermissive\u2019, G++ will accept your code, but allowing the use of an undeclared name is deprecated)\n</code></pre>\n\n<p>However if I change the <code>method_c</code> to the following it works:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void method_c() {\n    this-&gt;method_a();\n}\n</code></pre>\n\n<p>I am having trouble understanding the compiler behaviour here. Why do I need to add a <code>this</code> here? Is this a general case for c++ and inheriting multiple times? I do not recall having encountered this problem before.</p>\n\n<p>Side note:\nI actually encountered this in a more complex example but for simplicity I tried to find a minimum working example</p>\n"}, {"tags": ["c++", "asynchronous", "recursion", "lambda"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1559141656, "post_id": 56363323, "comment_id": 99329987, "body": "You could probably do <a href=\"https://stackoverflow.com/questions/37924996/lambda-with-dynamic-storage-duration\">this</a> and have it delete itself at the end."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1559142309, "post_id": 56363323, "comment_id": 99330348, "body": "Beware that this design has flaws. There is no way to know that all the async tasks have finished by the time you <code>return 0;</code> from <code>main</code>. It&#39;s possible to implement this, but you might as well just use <code>std::async</code> and rely on the <code>std::future</code> it provides."}, {"owner": {"reputation": 89, "user_id": 11328160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74063f71644f4af0ea50ca9b83d99ac?s=128&d=identicon&r=PG&f=1", "display_name": "Parmi93", "link": "https://stackoverflow.com/users/11328160/parmi93"}, "edited": false, "score": 0, "creation_date": 1559206300, "post_id": 56363323, "comment_id": 99351014, "body": "I know, this is a simple example, in the real application (based on FreeRTOS) this does not occur."}], "answers": [{"comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1559144672, "post_id": 56363587, "comment_id": 99331676, "body": "<code>y_combinate</code> -&gt; <code>y_combine</code>?"}, {"owner": {"reputation": 89, "user_id": 11328160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74063f71644f4af0ea50ca9b83d99ac?s=128&d=identicon&r=PG&f=1", "display_name": "Parmi93", "link": "https://stackoverflow.com/users/11328160/parmi93"}, "edited": false, "score": 0, "creation_date": 1559564019, "post_id": 56363587, "comment_id": 99448794, "body": "What does it mean &quot;F&amp;&quot;?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 89, "user_id": 11328160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74063f71644f4af0ea50ca9b83d99ac?s=128&d=identicon&r=PG&f=1", "display_name": "Parmi93", "link": "https://stackoverflow.com/users/11328160/parmi93"}, "edited": false, "score": 0, "creation_date": 1559567188, "post_id": 56363587, "comment_id": 99450450, "body": "@parmi F is a type -- F&amp; is a reference to that type.  <code>F&amp;( y_combinator_t&lt;F&gt;&amp;, Args&amp;&amp;... )</code> is a signature of a function returning <code>F&amp;</code> and taking <code>y_combinator_t&lt;F&gt;&amp;, Args&amp;&amp;...</code>.  It is passed to <code>result_of_t</code>, which pretends the return type is the type of object you are passing the arguments to, and returns the type actually returned.  So we get &quot;if you call an <code>F&amp;</code> with <code>y_combinator_t&lt;F&gt;&amp;, Args&amp;&amp;...</code>, whatever type that returns&quot; is the return type of <code>y_combinator_t&lt;F&gt;::operator()(Args&amp;&amp;...)</code>."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 89, "user_id": 11328160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74063f71644f4af0ea50ca9b83d99ac?s=128&d=identicon&r=PG&f=1", "display_name": "Parmi93", "link": "https://stackoverflow.com/users/11328160/parmi93"}, "edited": false, "score": 0, "creation_date": 1559569960, "post_id": 56363587, "comment_id": 99452014, "body": "@parmi all of which are technical details; the point is you write your lambda with <code>auto&amp;self</code> as the first argument, and then pass it to <code>y_combinate</code>, and now you have access to a reference to yourself."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 4, "last_activity_date": 1559142297, "creation_date": 1559142297, "answer_id": 56363587, "question_id": 56363323, "link": "https://stackoverflow.com/questions/56363323/how-can-a-lambda-capture-itself-for-an-asynchronous-call/56363587#56363587", "title": "How can a lambda capture itself for an asynchronous call?", "body": "<p>The basic problem is that C++ doesn't expose the <code>this</code> pointer of a lambda to itself.</p>\n\n<p>As it happens, there are many languages where during something's definition, you cannot refer to itself.  This is fixed in functional languages using a technique called the \"Y Combinator\".</p>\n\n<p>A simple y combinator in C++ looks like:</p>\n\n<pre><code>template&lt;class F&gt;\nstruct y_combinator_t {\n  F f;\n  template&lt;class...Args&gt;\n  auto operator()(Args&amp;&amp;...args)\n  -&gt; std::result_of_t&lt; F&amp;( y_combinator_t&lt;F&gt;&amp;, Args&amp;&amp;... ) &gt;\n  {\n    return f( *this, std::forward&lt;Args&gt;(args)... );\n  }\n};\ntemplate&lt;class F&gt;\ny_combinator_t&lt;std::decay_t&lt;F&gt;&gt; y_combinate( F&amp;&amp; f ) {\n  return {std::forward&lt;F&gt;(f)};\n}\n</code></pre>\n\n<p>I'm of two minds if we should <code>f( *this</code> or <code>f( f</code>, I sometimes do either.</p>\n\n<p>Use:</p>\n\n<pre><code>void AsyncWorks(Callback final_callback, int id)\n{\n  Callback lambda = y_combinate(\n    [final_callback, id]\n    (auto&amp; self, int next_work)\n    -&gt; void\n    {\n      if(next_work == 1) {\n        //...\n        AsyncWork1(self, 2, \"bla bla\");\n      } else if(next_work == 2) {\n        //...\n        //the lambda variable no longer exists\n        AsyncWork2(self, 3, 0.0, \"bla bla\");\n      } else if(next_work == 3) {\n        //...\n        final_callback(id);\n      }\n    }\n  );\n  lambda(1);\n}\n</code></pre>\n\n<p>basically, I added an implicit <code>self</code> parameter to the lambda function body.  Caller of the <code>operator()</code> don't see this parameter.</p>\n\n<p>Y combinator based off <a href=\"https://stackoverflow.com/a/50571486/1774667\">this post by myself</a> with modifications.</p>\n"}, {"comments": [{"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 0, "creation_date": 1559146593, "post_id": 56364671, "comment_id": 99332678, "body": "So in conclusion, this works only if the lambda does not capture anything."}, {"owner": {"reputation": 235, "user_id": 4262263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d72aea65f8ef4c3793765e3601271353?s=128&d=identicon&r=PG&f=1", "display_name": "Vikas Awadhiya", "link": "https://stackoverflow.com/users/4262263/vikas-awadhiya"}, "reply_to_user": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 1, "creation_date": 1559154828, "post_id": 56364671, "comment_id": 99336301, "body": "If lambda capture anything then it is not convertible to function pointer, because it becomes a class of unique name know only to compiler and then <code>auto</code> have to use and then what will happen is explained above. But it is not the purpose of lambda, like purpose of <code>std::map</code> is to provide key/value pair not random access, similarly purpose of lambda is to make quick anonymous callback functions with capture capability."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1559160059, "post_id": 56364671, "comment_id": 99338403, "body": "Your <code>factorial</code> is global too :-/"}], "tags": [], "owner": {"reputation": 235, "user_id": 4262263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d72aea65f8ef4c3793765e3601271353?s=128&d=identicon&r=PG&f=1", "display_name": "Vikas Awadhiya", "link": "https://stackoverflow.com/users/4262263/vikas-awadhiya"}, "is_accepted": false, "score": 0, "last_activity_date": 1559146173, "creation_date": 1559146173, "answer_id": 56364671, "question_id": 56363323, "link": "https://stackoverflow.com/questions/56363323/how-can-a-lambda-capture-itself-for-an-asynchronous-call/56364671#56364671", "title": "How can a lambda capture itself for an asynchronous call?", "body": "<p>Lambda can capture itself implicitly. To demo how? see below code it calculate factorial value.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint (* factorial)( const int) = []( const int number)\n{\n    if( number &gt; 1)\n    {\n        return number* factorial( number - 1);\n    }\n    else\n    {\n        return 1;\n    }\n};\n\nint main(int , char *[])\n{\n    int fact = factorial( 7);\n    std::cout&lt;&lt; \"7! = \"&lt;&lt; fact&lt;&lt; std::endl;\n}\n</code></pre>\n\n<pre><code>Output 7! = 5040\n</code></pre>\n\n<p>If any variable is used inside lambda then lambda captures it implicitly, if it is not captured explicitly. Due to this inside lambda, name <code>factorial</code> referring itself, is available.<br/>\nBut if in place of<br/><code>int (* factorial)( const int) = []( const int number){//implementation };</code><br/><br/> if <code>auto</code> is used like as follows,<br/><br/><code>auto factorial = []( const int number){ //implementation };</code><br/><br/>then g++ compiler gives following error,<br/><code>error: use of \u2018factorial\u2019 before deduction of \u2018auto\u2019\n         return number* factorial( number - 1);</code><br/><br/>It is because type of <code>factorial</code> is not deduced, auto does not deduce for same control block. Name <code>factorial</code> will be available only below the declaration in case of <code>auto</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 89, "user_id": 11328160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74063f71644f4af0ea50ca9b83d99ac?s=128&d=identicon&r=PG&f=1", "display_name": "Parmi93", "link": "https://stackoverflow.com/users/11328160/parmi93"}, "is_accepted": false, "score": 0, "last_activity_date": 1566288916, "last_edit_date": 1566288916, "creation_date": 1566288243, "answer_id": 57569178, "question_id": 56363323, "link": "https://stackoverflow.com/questions/56363323/how-can-a-lambda-capture-itself-for-an-asynchronous-call/57569178#57569178", "title": "How can a lambda capture itself for an asynchronous call?", "body": "<p>@Yakk\nTo understand your answer I had to spend some time studying many c++ features, value category, rvalue, lvalue, move constructor, move assignment operator, variadic templates, variadic templates with implicit conversions, result_of_t&lt;>, decay_t&lt;>, forward&lt;>.</p>\n\n<p>But I don't have a thing yet, why did you put the '&amp;' symbol here? </p>\n\n<pre><code>... std::result_of_t &lt;F&amp;(y_combinator_t&lt;...\n</code></pre>\n\n<p>I also rewrote your solution to make it more specific for my case and easier to read and understand for me too (and for all those who are beginners with C++),</p>\n\n<pre><code>class y_combinator_t\n{\npublic:\n    function&lt;void(y_combinator_t*, int, double, string)&gt; callback;\n\n    void operator()(int a, double b, string s)\n    {\n        this-&gt;callback(this, a, b, s);\n    }\n};\n\ny_combinator_t combinator = {\n    [id_work = 1]\n    (y_combinator_t* _this, int a, double b, string s) mutable -&gt; void\n    {\n        if(id_work == 1)\n        {\n            //...\n            AsyncWork1(*_this, 2, 3.0, \"bla bla\");\n            id_work = 2;\n        }\n        else if(id_work == 2)\n        {\n            //...\n            AsyncWork2(*_this, 3, 0.0, \"bla bla\");\n            id_work = 3;\n        }\n        else if(id_work == 3)\n        {\n            //...\n        }\n    }\n};\n\n//Start works\ncombinator(0, 0, \"\");\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 11328160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74063f71644f4af0ea50ca9b83d99ac?s=128&d=identicon&r=PG&f=1", "display_name": "Parmi93", "link": "https://stackoverflow.com/users/11328160/parmi93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 3, "accepted_answer_id": 56363587, "answer_count": 3, "score": 3, "last_activity_date": 1566288916, "creation_date": 1559141328, "last_edit_date": 1559206753, "question_id": 56363323, "link": "https://stackoverflow.com/questions/56363323/how-can-a-lambda-capture-itself-for-an-asynchronous-call", "title": "How can a lambda capture itself for an asynchronous call?", "body": "<p>I have to make an asynchronous call inside a lambda, and once the asynchronous call is terminated I have to call the lambda itself.</p>\n\n<p>I try to explain my problem with code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>typedef function&lt;void(int id)&gt; Callback;\n</code></pre>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>AsyncWork1(Callback call, int id, string)\n{\n    //...\n    call(id);\n}\n\nAsyncWork2(Callback call, int id, double, string)\n{\n    //...\n    call(id);\n}\n</code></pre>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void AsyncWorks(Callback final_callback, int id)\n{\n    Callback lambda = [&amp;lambda, final_callback, id](int next_work) -&gt; void\n        {\n            if(next_work == 1)\n            {\n                //...\n                AsyncWork1(lambda, 2, \"bla bla\");\n            }\n            else if(next_work == 2)\n            {\n                //...\n                //the lambda variable no longer exists\n                AsyncWork2(lambda, 3, 0.0, \"bla bla\");\n            }\n            else if(next_work == 3)\n            {\n                //...\n                final_callback(id);\n            }\n        };\n\n    lambda(1);\n}\n</code></pre>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>int main()\n{\n    AsyncWorks(...);\n\n    AsyncWorks(...);\n\n    AsyncWorks(...);\n\n    AsyncWorks(...);\n\n    return 0;\n}\n</code></pre>\n\n<p>The problem is that when the code exits from \"AsyncWorks(...)\" function, the local variable \"lambda\" no longer exists.</p>\n\n<p>I've read several threads that talk about lambda recursive, but I haven't found any solution.</p>\n\n<p>How can I solve this problem?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 2, "creation_date": 1559141337, "post_id": 56363277, "comment_id": 99329828, "body": "Depends on how you define a &#39;paragraph&#39;."}, {"owner": {"reputation": 71, "user_id": 7286467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37a54d96183b49995c13cb850de2a485?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/7286467/jordan"}, "reply_to_user": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1559141396, "post_id": 56363277, "comment_id": 99329861, "body": "@vahancho: There&#39;s a line space between paragraphs"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1559141425, "post_id": 56363277, "comment_id": 99329875, "body": "@PemiNg a space ? but there is also a space between words no ? Do you mean newline after each paragraph ? Or may be a dot ?"}, {"owner": {"reputation": 71, "user_id": 7286467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37a54d96183b49995c13cb850de2a485?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/7286467/jordan"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1559141562, "post_id": 56363277, "comment_id": 99329941, "body": "@bruno: I mean two newline space"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 7286467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37a54d96183b49995c13cb850de2a485?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/7286467/jordan"}, "edited": false, "score": 0, "creation_date": 1559141644, "post_id": 56363367, "comment_id": 99329984, "body": "Yes my .txt is pretty standard, so two newline is good. Would you mind telling me the code for this? I&#39;ll really appreciate it"}, {"owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "reply_to_user": {"reputation": 71, "user_id": 7286467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37a54d96183b49995c13cb850de2a485?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/7286467/jordan"}, "edited": false, "score": 1, "creation_date": 1559141717, "post_id": 56363367, "comment_id": 99330019, "body": "That I&#39;m going to leave up to you. However, do know that a newline can be recognized just like any other ASCII character."}], "tags": [], "owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "is_accepted": false, "score": 4, "last_activity_date": 1559141472, "creation_date": 1559141472, "answer_id": 56363367, "question_id": 56363277, "link": "https://stackoverflow.com/questions/56363277/read-words-from-paragraph-to-paragraph-from-line-to-line-c/56363367#56363367", "title": "Read words from paragraph to paragraph, from line to line (C++)", "body": "<p>Line number is fairly simple, as you can just use <code>getline</code> or something similar to read one line at a time. Just keep track of the number of times you read a line from the file. Or, you could count the number of newline (<code>\\n</code>) you run across. </p>\n\n<p>Paragraph is a bit trickier, there's no standardized way to look at paragraph in a file. You would probably need some sort of character delimiter for the end of a paragraph. You could interpret two newlines as a new paragraph, but that part is up to you. </p>\n"}, {"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 1, "last_activity_date": 1559144966, "last_edit_date": 1559144966, "creation_date": 1559144509, "answer_id": 56364221, "question_id": 56363277, "link": "https://stackoverflow.com/questions/56363277/read-words-from-paragraph-to-paragraph-from-line-to-line-c/56364221#56364221", "title": "Read words from paragraph to paragraph, from line to line (C++)", "body": "<p>Supposing</p>\n\n<ul>\n<li><p>paragraphs are separated by at least one empty line, so a line just containing a newline</p></li>\n<li><p>a line even with only spaces is not an empty line, but that has no real sense and I let you changing that ;-)</p></li>\n<li><p>the program memorizes the number of paragraph line and column where the word appears, all these numbers start by 1, and the line number is global rather than the line rank into the paragraph</p></li>\n<li><p>a word only contains alphanumeric character, so all other characters are considered to be a separator. That allows to find the word \"isn\" or \"t\" in \"this isn't possible\" even they are not separated by a space with the other words, or to find \"jean\" in \"jean-luc\" etc</p></li>\n<li><p>the program does not check if the input word is a valid word</p></li>\n</ul>\n\n<p>A proposal  :</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n\nint main(int argc, char ** argv)\n{\n  if (argc != 3)\n      std::cerr &lt;&lt; \"Usage: \" &lt;&lt; *argv &lt;&lt; \" &lt;file path&gt; &lt;word&gt;\" &lt;&lt; std::endl;\n  else {\n    std::ifstream f(argv[1]);\n\n    if (! f.is_open())\n      std::cerr &lt;&lt; \"Cannot open '\" &lt;&lt; argv[1] &lt;&lt; '\\'' &lt;&lt; std::endl;\n    else {\n      std::string word = argv[2];\n      std::string line;\n      size_t line_num = 0;\n      size_t paragraph_num = 0;\n      std::vector&lt;size_t&gt; paragraph_number; \n      std::vector&lt;size_t&gt; line_number;\n      std::vector&lt;size_t&gt; column_number;\n      bool afterEmptyLine = true;\n\n      while (std::getline(f, line)) {\n        line_num += 1;\n        if (!line.empty()) {\n          if (afterEmptyLine) {\n            afterEmptyLine = false;\n            paragraph_num += 1;\n          }\n\n          std::size_t p = 0;\n\n          while ((p = line.find(word, p)) != std::string::npos) {\n            // check it is not a subword, suppose a word is only alphanum\n            if (((p == 0) || !isalnum(line[p - 1])) &amp;&amp;\n                ((line.length() == (p + word.length())) || !isalnum(line[p + word.length()]))) {\n              paragraph_number.push_back(paragraph_num);\n              line_number.push_back(line_num);\n              column_number.push_back(p + 1);\n            }\n\n            p += word.length();\n          }\n        }\n        else\n          afterEmptyLine = true;\n      }\n\n      /* debug */\n      std::cout &lt;&lt; '\\'' &lt;&lt; word &lt;&lt; \"' found \" &lt;&lt; paragraph_number.size() &lt;&lt; \" times :\" &lt;&lt; std::endl;\n\n      for (size_t i = 0; i != paragraph_number.size(); ++i)\n        std::cout &lt;&lt; \"\\t paragraph \" &lt;&lt; paragraph_number[i] \n          &lt;&lt; \" line \" &lt;&lt; line_number[i]\n            &lt;&lt; \" column \" &lt;&lt; column_number[i] &lt;&lt; std::endl;\n    }\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>Compilation and execution :</p>\n\n<pre><code>bruno@bruno-XPS-8300:/tmp$ g++ -pedantic -Wextra -Wall c.cc\nbruno@bruno-XPS-8300:/tmp$ cat fw\nis it you or not you?\nthis is your decision and you are right\n\nyou and me\n\n\n\nyou\nbruno@bruno-XPS-8300:/tmp$ ./a.out\nUsage: ./a.out &lt;file path&gt; &lt;word&gt;\nbruno@bruno-XPS-8300:/tmp$ ./a.out fw you\n'you' found 5 times :\n     paragraph 1 line 1 column 7\n     paragraph 1 line 1 column 18\n     paragraph 1 line 2 column 27\n     paragraph 2 line 4 column 1\n     paragraph 3 line 8 column 1\nbruno@bruno-XPS-8300:/tmp$ \n</code></pre>\n\n<p>(in the file the empty lines are really empty)</p>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1559144534, "creation_date": 1559144534, "answer_id": 56364228, "question_id": 56363277, "link": "https://stackoverflow.com/questions/56363277/read-words-from-paragraph-to-paragraph-from-line-to-line-c/56364228#56364228", "title": "Read words from paragraph to paragraph, from line to line (C++)", "body": "<p>Try something like this :</p>\n\n<pre><code>ifstream file(\"input.txt\");\n\nvector&lt;int&gt; paragraph_number;\nvector&lt;int&gt; line_number;\nstring line, word;\nint curr_paragraph_num = 0;\nint curr_line_num = 0;\nbool in_paragraph = false;\n\nwhile (getline(file, line))\n{\n    ++curr_line_num;\n    if (line.empty())\n    {\n        in_paragraph = false;\n    }\n    else\n    {\n        if (!in_paragraph)\n        {\n            in_paragraph = true;\n            ++curr_paragraph_num;\n        }\n\n        istringstream iss(line);\n        while (iss &gt;&gt; word)\n        {\n            if (word == \"you\")\n            {\n                paragraph_number.push_back(curr_paragraph_num);\n                line_number.push_back(curr_line_num);\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 7286467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37a54d96183b49995c13cb850de2a485?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/7286467/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "closed_date": 1559179033, "answer_count": 3, "score": 0, "last_activity_date": 1559144966, "creation_date": 1559141208, "question_id": 56363277, "link": "https://stackoverflow.com/questions/56363277/read-words-from-paragraph-to-paragraph-from-line-to-line-c", "closed_reason": "Needs more focus", "title": "Read words from paragraph to paragraph, from line to line (C++)", "body": "<p>I'm looking for a way to read and locate words (line number, paragraph number) from a file. </p>\n\n<p>For example, I want to track the number of the word \"you\" in a file. Each time I find this word on a line, I will push the line number and the paragraph number to the two vectors</p>\n\n<pre><code>ifstream file;\nfile.open(input.txt)\nvector&lt;int&gt; paragraph_number;\nvector&lt;int&gt; line_number; \n</code></pre>\n\n<p>What's the best way to read paragraph by paragraph and line by line? Thank you!</p>\n"}, {"tags": ["c++", "alphabetical", "read-write"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1559140893, "post_id": 56363102, "comment_id": 99329571, "body": "1) &quot;<i>I have tried ise isalpha but can not get it to work</i>&quot; What&#39;s the problem with <code>std::isalpha</code>? 2) Relevant read: <a href=\"https://stackoverflow.com/questions/5605125/why-is-iostreameof-inside-a-loop-condition-i-e-while-stream-eof-cons\">Why is iostream::eof inside a loop condition (i.e. <code>while (!stream.eof())</code>) considered wrong?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1559141810, "post_id": 56363342, "comment_id": 99330070, "body": "Note: As per the documentation of <a href=\"https://en.cppreference.com/w/cpp/string/byte/isalpha\" rel=\"nofollow noreferrer\"><code>std::isalpha</code></a>, the argument passed to <code>std::isalpha</code>, should first be converted to <code>unsigned char</code>, to avoid the possibility of UB."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1559142071, "post_id": 56363342, "comment_id": 99330214, "body": "That is one way of doing it, but the documentation, itself, provides a cleaner looking example: <code>return std::count_if(s.begin(), s.end(), [](unsigned char c){ return std::isalpha(c); });</code>"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1559143750, "post_id": 56363342, "comment_id": 99331159, "body": "@AlgirdasPreid\u017eius I don&#39;t think that&#39;s what the OP wants.  He wants to delete non-alphas, not count alphas."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1559143888, "post_id": 56363342, "comment_id": 99331247, "body": "I just copy-pasted the relevant part of the example, in  the documentation, that I linked to. I thought that my comment was clear about that."}], "tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": false, "score": 0, "last_activity_date": 1559141941, "last_edit_date": 1559141941, "creation_date": 1559141402, "answer_id": 56363342, "question_id": 56363102, "link": "https://stackoverflow.com/questions/56363102/reading-file-with-alphabetic-letters-only/56363342#56363342", "title": "Reading file with alphabetic letters only", "body": "<p>The algorithm library makes this easy:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;algorithm&gt;\n\nint main ()\n{\n    std::string s = \"A1B2C3\";\n    s.erase (std::remove_if (s.begin (), s.end (), [] (auto c) { return !std::isalpha ((unsigned char) c); }), s.end ());\n    std::cout &lt;&lt; s;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>ABC\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/dkFhfy723enA0nNx\" rel=\"nofollow noreferrer\">Live demo</a></p>\n\n<p>See also <a href=\"https://en.wikipedia.org/wiki/Erase%E2%80%93remove_idiom\" rel=\"nofollow noreferrer\">erase remove idiom</a></p>\n"}], "owner": {"reputation": 13, "user_id": 11571479, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-b0GVvkT997k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbG8MX93cbfdcqGfIKTZuCK-_vFA/mo/photo.jpg?sz=128", "display_name": "Tom Tommy", "link": "https://stackoverflow.com/users/11571479/tom-tommy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559141941, "creation_date": 1559140613, "question_id": 56363102, "link": "https://stackoverflow.com/questions/56363102/reading-file-with-alphabetic-letters-only", "title": "Reading file with alphabetic letters only", "body": "<p>I am stuck on a small part of a task I am trying to complete and each word must be trimmed so that a word contains only alphabetic letters when I read from a .txt file. This is apart of an AVL tree yes but the problem I believe lies within the reading of the text document.</p>\n\n<p>I have tried ise isalpha but can not get it to work and have run out of ideas and am stuck in a situation here. I will appreciate any help given to me!</p>\n\n<pre><code>           cout &lt;&lt; \"Input a file name (dictionary.txt):\" &lt;&lt; endl;\n            cin &gt;&gt; file;\n            myfile.open(file);\n            if (!myfile) {\n                cout &lt;&lt; \"\\nFile does not exist.\" &lt;&lt; endl;\n                return 0;\n            }\n            else cout &lt;&lt; \"\\nDictionary has been loaded.\" &lt;&lt; endl;\n            while(!myfile.eof()) {\n                myfile &gt;&gt; insert;\n                DATA newItem;\n                newItem.key = insert;\n                tree.AVL_Insert(newItem);\n                count++;\n            }\n</code></pre>\n"}, {"tags": ["c++", "casting"], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 1, "last_activity_date": 1559140058, "creation_date": 1559140058, "answer_id": 56362915, "question_id": 56362839, "link": "https://stackoverflow.com/questions/56362839/avoid-int-to-double-typecast-rounding/56362915#56362915", "title": "Avoid Int to double typecast rounding?", "body": "<p>There isn't any; you're just not observing the values correctly.</p>\n\n<p>Quick fix:</p>\n\n<pre><code>std::cout &lt;&lt; \"d= \" &lt;&lt; std::fixed &lt;&lt; d &lt;&lt; endl;\n</code></pre>\n\n<p>You'll need <code>#include &lt;iomanip&gt;</code> to use <a href=\"https://en.cppreference.com/w/cpp/io/manip/fixed\" rel=\"nofollow noreferrer\"><code>std::fixed</code></a>.</p>\n"}], "owner": {"reputation": 597, "user_id": 2387204, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f12464e95bb1a29586ec10fc7c49b018?s=128&d=identicon&r=PG&f=1", "display_name": "zzz2991", "link": "https://stackoverflow.com/users/2387204/zzz2991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "closed_date": 1559140071, "accepted_answer_id": 56362915, "answer_count": 1, "score": 1, "last_activity_date": 1559140078, "creation_date": 1559139812, "last_edit_date": 1559140078, "question_id": 56362839, "link": "https://stackoverflow.com/questions/56362839/avoid-int-to-double-typecast-rounding", "closed_reason": "Duplicate", "title": "Avoid Int to double typecast rounding?", "body": "<p>I am converting an <code>int</code> to a <code>double</code> by dividing the integers by powers of 10. For integers with 7 or greater digits, it appears that rounding is performed when I cast an <code>int</code> into a <code>double</code>. Why is this happening and how can I avoid this rounding?</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\ndouble add_decimals(int x, int decimal_places)\n{\n    double ret = 1.0 * x;\n    cout &lt;&lt; \"x= \" &lt;&lt; x &lt;&lt; endl;\n    cout &lt;&lt; \"ret before changes= \" &lt;&lt; ret &lt;&lt; endl;\n    for (int i = 0; i &lt; decimal_places; ++i)\n    {\n        ret /= 10;\n    }\n    return ret;\n}\n\nint main() \n{\n    double d = add_decimals(1234566, 2);\n    cout &lt;&lt; \"d= \" &lt;&lt; d &lt;&lt; endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "tensorflow", "header"], "comments": [{"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 1, "creation_date": 1559140784, "post_id": 56362540, "comment_id": 99329502, "body": "The C API is completely different from the C++ one. There is currently no official binary distribution of the C++ library and API headers. See the <a href=\"https://doc.cgal.org/latest/Manual/installation.html#title37\" rel=\"nofollow noreferrer\">Installation notes of CGAL</a> for instructions about how you can build it yourself."}, {"owner": {"reputation": 1, "user_id": 11544735, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0m1XQr099DM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reSMbhFY6SiMUl0DZMzmlxkoWFJ3Q/mo/photo.jpg?sz=128", "display_name": "rswsl drone_mavic2pro", "link": "https://stackoverflow.com/users/11544735/rswsl-drone-mavic2pro"}, "reply_to_user": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 0, "creation_date": 1559552541, "post_id": 56362540, "comment_id": 99442918, "body": "Thanks for the hint, but CGAL itself is not the issue, I have a complete cmake-compilation of CGAL with demos,examples without compilation or linking problems. The only problem is the integration of the C++-based tensorflow for the mentioned classification example. I am still wondering how INRA could succeed..."}], "owner": {"reputation": 1, "user_id": 11544735, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0m1XQr099DM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reSMbhFY6SiMUl0DZMzmlxkoWFJ3Q/mo/photo.jpg?sz=128", "display_name": "rswsl drone_mavic2pro", "link": "https://stackoverflow.com/users/11544735/rswsl-drone-mavic2pro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559138927, "creation_date": 1559138927, "question_id": 56362540, "link": "https://stackoverflow.com/questions/56362540/cgal-with-tensorflow-example", "title": "CGAL with tensorflow example", "body": "<p>I tried to compile tensorflow 1.13.1 into a C++-useable form for CGAL, but I always fail during linkage, because some core-classes are missing in the built tensorflow shared library, e.g. \"tensorflow::Tensor::Tensor()\" is missing.\nSomebody has a recipe for this issues ? The tensorflow C-API headers is not complete at all for usage within CGAL.</p>\n"}, {"tags": ["c++", "getline", "non-ascii-characters"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1559138882, "post_id": 56362464, "comment_id": 99328387, "body": "<code>getline</code> doesn&#39;t print any characters.  Please edit the title."}, {"owner": {"reputation": 231, "user_id": 6695965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1157898f9ebdb62e6baa5c0becf3ecd7?s=128&d=identicon&r=PG&f=1", "display_name": "Levy", "link": "https://stackoverflow.com/users/6695965/levy"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1559139013, "post_id": 56362464, "comment_id": 99328473, "body": "Ok, I changed it."}, {"owner": {"reputation": 144, "user_id": 10349374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d109de7a5adcb83b8c06c1d67f567e4?s=128&d=identicon&r=PG&f=1", "display_name": "gabbo1092", "link": "https://stackoverflow.com/users/10349374/gabbo1092"}, "edited": false, "score": 0, "creation_date": 1559139333, "post_id": 56362464, "comment_id": 99328647, "body": "Possibly related to : <a href=\"https://stackoverflow.com/questions/19069881/write-a-string-with-non-ascii-characters-in-it-error-only-if-string-is-a-varia\" title=\"write a string with non ascii characters in it error only if string is a varia\">stackoverflow.com/questions/19069881/&hellip;</a>"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1559140756, "post_id": 56362464, "comment_id": 99329490, "body": "Possibly relevant: <a href=\"https://stackoverflow.com/questions/7454111/change-default-code-page-for-debug-console-in-vs10\" title=\"change default code page for debug console in vs10\">stackoverflow.com/questions/7454111/&hellip;</a>.  I find it sad that there seems to be no way to output Unicode characters to this window,  Changing the locale in the app is a poor second-best."}], "answers": [{"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 2, "last_activity_date": 1559141001, "creation_date": 1559141001, "answer_id": 56363214, "question_id": 56362464, "link": "https://stackoverflow.com/questions/56362464/getline-doesnt-read-accented-characters-correctly/56363214#56363214", "title": "getline() doesn&#39;t read accented characters correctly", "body": "<p>There are 2 levels in a same problem. The problem is that you are using characters outside the ASCII charset. The 2 levels are:</p>\n\n<ul>\n<li>how they are converted to narrow characters on input</li>\n<li>how they will be displayed on output</li>\n</ul>\n\n<p>Windows console is a rather disturbing application in that respect: it is able to internaly process UCS2 characters that is any unicode character in the Basic Multilingual Plane, said differently any character with a code point of at most 0xFFFF. On input into narrow characters, it tries to map any character not represented in the current charset to what it thinks is closer, on output, it just outputs the value of each byte in its current charset. So the most reliable way is to ensure that the current locale has a correct collating sequence and that the console has a correct code page (charset in Windows language). After seeing the displayed output, I assume that you are using the code page 437 which contains semi-graphics character but few non ascii ones.</p>\n\n<p>As you only need Western European characters, I would advise you to use the code page 1252. It is a Windows variant of the standard Latin1 or ISO-8859-1 charset (characters with codepoint of at most 0xFF).</p>\n\n<p>So if possible you should try to configure the system in a non english  west eurapean language (Portugues would be fine, but French seems to be enough, so I would assume that Spanish would go too).</p>\n\n<p>And you <strong>must</strong> configure the console in an correct code page: <code>chcp 1252</code>.</p>\n\n<p>If it is not enough (I cannot currently test anything), you could try to use wide character (<code>wstring</code>, <code>wcin</code>, <code>wcout</code>). But without changing code page from 437, the console would not display accented character.</p>\n"}, {"comments": [{"owner": {"reputation": 231, "user_id": 6695965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1157898f9ebdb62e6baa5c0becf3ecd7?s=128&d=identicon&r=PG&f=1", "display_name": "Levy", "link": "https://stackoverflow.com/users/6695965/levy"}, "edited": false, "score": 0, "creation_date": 1559143604, "post_id": 56363218, "comment_id": 99331062, "body": "It works almost right. The character &#227; is displayed as a, without the tilde above it."}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "reply_to_user": {"reputation": 231, "user_id": 6695965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1157898f9ebdb62e6baa5c0becf3ecd7?s=128&d=identicon&r=PG&f=1", "display_name": "Levy", "link": "https://stackoverflow.com/users/6695965/levy"}, "edited": false, "score": 0, "creation_date": 1559210701, "post_id": 56363218, "comment_id": 99353056, "body": "For me it works great, I think your console has not the same settings than mine."}], "tags": [], "owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "is_accepted": false, "score": 4, "last_activity_date": 1559141722, "last_edit_date": 1559141722, "creation_date": 1559141021, "answer_id": 56363218, "question_id": 56362464, "link": "https://stackoverflow.com/questions/56362464/getline-doesnt-read-accented-characters-correctly/56363218#56363218", "title": "getline() doesn&#39;t read accented characters correctly", "body": "<p>Actually, the problem does not come from <code>getline()</code>.</p>\n\n<p><code>std::cout</code> (respectively <code>std::cin</code>) does not support special characters. For this, you have to use <code>std::wcout</code> (respectively <code>std::wcin</code>) which uses wide characters (the size of standard characters limits you to what you can find in the ascii table).<br/>You need to use bigger characters to store the special characters too, that is the case of wide characters.<br/><code>std::string</code> handles standard characters, <code>std::wstring</code> handles wide characters.</p>\n\n<p>A way to do this could be:</p>\n\n<pre><code>std::wstring a(L\"Cora\u00e7\u00e3o\");\nstd::wcout &lt;&lt; a &lt;&lt; std::endl;\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n  <p>Cora\u00e7\u00e3o</p>\n</blockquote>\n\n<hr>\n\n<p>To make it work with <code>getline()</code>:</p>\n\n<pre><code>std::wstring a;\ngetline(std::wcin, a)\nstd::wcout &lt;&lt; a &lt;&lt; std::endl;\n</code></pre>\n\n<p>I hope it can help.</p>\n"}], "owner": {"reputation": 231, "user_id": 6695965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1157898f9ebdb62e6baa5c0becf3ecd7?s=128&d=identicon&r=PG&f=1", "display_name": "Levy", "link": "https://stackoverflow.com/users/6695965/levy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1559141722, "creation_date": 1559138685, "last_edit_date": 1559138991, "question_id": 56362464, "link": "https://stackoverflow.com/questions/56362464/getline-doesnt-read-accented-characters-correctly", "title": "getline() doesn&#39;t read accented characters correctly", "body": "<p>I'm trying to get accented characters from user using <code>getline()</code> command, but it does not print them correctly.</p>\n\n<p>I tried to include some libraries as <code>locale</code>, but it was in vain.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\n#include &lt;string&gt;\n#include &lt;locale&gt;\n\nusing namespace std;\n\nclass Pers {\npublic:\n    string name;\n    int age;\n    string weapon;\n};\n\nint main()\n{\n    setlocale(LC_ALL, \"\");\n    Pers pers;\n\n    cout &lt;&lt; \"Say the name of your character: \";\n    getline(cin, pers.name);\n    cout &lt;&lt; pers.name;\n}\n</code></pre>\n\n<p>When I type: Mark Cora\u00e7\u00e3o, this is what I get:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Vnz6S.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vnz6S.jpg\" alt=\"Accented characters aren&#39;t displaying correctly\"></a></p>\n\n<p>How do I fix it?</p>\n"}, {"tags": ["c++", "cuda", "unified-memory"], "comments": [{"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 2, "creation_date": 1559143490, "post_id": 56362269, "comment_id": 99331004, "body": "You may be confused about managed memory.  Since your unified memory is by definition unpitched, there is no point attempting to do any sort of pitched copy, if the source is a unified memory allocation (which it <b>always</b> is when using <code>cudaMemPrefetchAsync</code>).  If you want to copy from a <b>separate</b> pitched allocation on the host to a unified memory allocation, just use <code>cudaMemcpy2DAsync</code>.  However that doesn&#39;t appear to apply to your case, because you&#39;ve said the data resides in Unified Memory.  You should clarify the exact way you allocated the source and destinations here."}, {"owner": {"reputation": 3, "user_id": 10950433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f85fdaae900ab397d260ef8db2378cc?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/10950433/fabian"}, "reply_to_user": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1559547887, "post_id": 56362269, "comment_id": 99440908, "body": "Thanks for the info and my apologies for the late answer, I am only seeing your response today.   I&#39;m not sure I understand why a pitched copy into unpitched memory is impossible; it&#39;s just adding some padding while doing the copy, there&#39;s no actual difference in the memory itself?  Either way though, if a pitched copy is impossible then that&#39;s the answer to my question. If you would like to post this as the answer then I can accept it and close this question. (Though it has already been downvoted for some reason so it might not matter anyway.)"}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1559567325, "post_id": 56362269, "comment_id": 99450532, "body": "Unless you state precisely how the source and destination are allocated in your example, I wouldn&#39;t be able to provide any sort of answer."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10950433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f85fdaae900ab397d260ef8db2378cc?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/10950433/fabian"}, "edited": false, "score": 0, "creation_date": 1560250053, "post_id": 56436533, "comment_id": 99665511, "body": "&quot;Asynchronous copies with unified memory do not support pitches, because unified memory does not support pitches.&quot; -- Thank you, this was the information I was missing. Sorry if the original question seems to have been a bit murky!"}], "tags": [], "owner": {"reputation": 2086, "user_id": 10543528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a3a9d1ea239d645f62babcbb003c5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/10543528/michael"}, "is_accepted": true, "score": 0, "last_activity_date": 1559614420, "creation_date": 1559614420, "answer_id": 56436533, "question_id": 56362269, "link": "https://stackoverflow.com/questions/56362269/replacing-cudamemcpy2d-with-cudamemprefetchasync/56436533#56436533", "title": "Replacing cudaMemcpy2D with cudaMemPrefetchAsync", "body": "<p>The answer is that you'll need to make a copy. Asynchronous copies with unified memory do not support pitches, because unified memory does not support pitches. You can either copy the prefetched unified buffer on the device into a pitched memory region, or you can copy the unified buffer n the host into a pitched memory region and then asynchronously copy it. You cannot satisfy all three conditions (a, b, and c) simultaneously</p>\n"}], "owner": {"reputation": 3, "user_id": 10950433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f85fdaae900ab397d260ef8db2378cc?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/10950433/fabian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 56436533, "answer_count": 1, "score": -2, "last_activity_date": 1559614420, "creation_date": 1559138065, "question_id": 56362269, "link": "https://stackoverflow.com/questions/56362269/replacing-cudamemcpy2d-with-cudamemprefetchasync", "title": "Replacing cudaMemcpy2D with cudaMemPrefetchAsync", "body": "<p>I'm trying to do an <strong>asynchronous</strong> memory transfer (Host to Device) of data residing in <strong>Unified Memory</strong> in the same way that <code>cudaMemcpy2DAsync()</code> offers, i.e., using a <strong>pitch value</strong> for the destination (Device) memory.</p>\n\n<p>However, to my understanding:</p>\n\n<ul>\n<li><p>I cannot use <code>cudaMemcpy2DAsync()</code> since it requires pinned memory and a Unified Memory block allocated using <code>cudaMallocManaged()</code> is not pinned by default and cannot be pinned manually.</p></li>\n<li><p>I cannot use <code>cudaMemPrefetchAsync()</code> because it only copies a continuous chunk of memory, whereas <code>cudaMemcpy2DAsync()</code> includes additional options to buffer the rows of my data according to a given pitch value.</p></li>\n</ul>\n\n<p><strong>My question:</strong></p>\n\n<p>How can I transfer my data, which <strong>(a)</strong> <em>resides in Unified Memory</em>, in <strong>(b)</strong> <em>an asynchronous manner</em> from the Host to the Device while, at the same time, making sure that the data is copied <strong>(c)</strong> <em>with the right pitch value</em>?</p>\n\n<p>My current transfer using <code>cudaMemcpy2D()</code> looks something like this:</p>\n\n<pre><code>cudaMemcpy2D( \n    dest_ptr, dest_pitch,         // dst address &amp; pitch\n    src_ptr, dim_x*sizeof(float)  // src address &amp; pitch\n    dim_x*sizeof(float), dim_y,   // transfer width &amp; height\n    cudaMemcpyHostToDevice ) );\n</code></pre>\n\n<p>(As you can see, the pitch at the source is effectively zero, while the pitch at the destination is <code>dest_pitch</code> -- maybe that helps?)</p>\n\n<p><strong>An additional hassle</strong> is that I do not allocate the data that needs to be transferred myself and so I cannot apply the pitch manually without creating an additional copy of the data (which would be problematic).</p>\n\n<p><strong>One idea I had</strong> was to simply copy the data row-wise. However, this would mean a very large number of very small data transfers which sounds a bit horrible. In my example it would be 3,040,000 transfers of 304 bytes each.. but maybe that's fine on Pascal if the transfers are spread asynchronously across multiple streams..?</p>\n\n<p>Any pointers/ideas would be appreciated!</p>\n"}, {"tags": ["c++", "qt", "qmake"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559138286, "post_id": 56362087, "comment_id": 99327992, "body": "this might help: <a href=\"https://stackoverflow.com/questions/5801754/gcc-directory-option-isystem\" title=\"gcc directory option isystem\">stackoverflow.com/questions/5801754/&hellip;</a> . the <code>-isystem</code> basically allows you to select include folders where warnings are ignored"}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 0, "creation_date": 1559246673, "post_id": 56362087, "comment_id": 99369969, "body": "This is normally done on per-project level. You should consider using a global <code>SUBDIRS</code> type of project, along with distinct subprojects for your application and libraries used."}], "owner": {"reputation": 7405, "user_id": 5735010, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/znAEN.jpg?s=128&g=1", "display_name": "abhiarora", "link": "https://stackoverflow.com/users/5735010/abhiarora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559137499, "creation_date": 1559137499, "question_id": 56362087, "link": "https://stackoverflow.com/questions/56362087/different-warning-flags-for-different-files-in-qt", "title": "Different Warning flags for different files in Qt", "body": "<p>I have one large <code>codebase</code> project in <code>Qt</code>. I have been using two third party libraries: <a href=\"https://github.com/open-source-parsers/jsoncpp\" rel=\"nofollow noreferrer\">json</a> and <a href=\"https://github.com/alex-spataru/QSimpleUpdater\" rel=\"nofollow noreferrer\">QSimpleUpdater</a>. Since, these libraries are external, their source files generates alot of warnings. I can't and don't want to change those external libraries. I want to add different compiler flags for different folders. </p>\n\n<p>For example, source code except external libraries should be compiled with following warnings:</p>\n\n<pre><code>QMAKE_CXXFLAGS += -Wall -Wextra -Wshadow -Wno-unused-parameter\n</code></pre>\n\n<p>And external libraries should be compiled with:</p>\n\n<pre><code>QMAKE_CXXFLAGS += -Wall\n</code></pre>\n\n<p>I tried to find answers over stackoverflow and came across <a href=\"https://stackoverflow.com/questions/27683777/how-to-specify-compiler-flag-to-a-single-source-file-with-qmake\">this</a> question but that question specify how to add another compiler for the project but i need just to have different warning flags for different files.</p>\n"}, {"tags": ["c++", "templates", "metaprogramming"], "comments": [{"owner": {"reputation": 1549, "user_id": 3600304, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/582e17ff0889a21f8b0f39315e064e76?s=128&d=identicon&r=PG&f=1", "display_name": "PapaDiHatti", "link": "https://stackoverflow.com/users/3600304/papadihatti"}, "edited": false, "score": 0, "creation_date": 1559137790, "post_id": 56362085, "comment_id": 99327667, "body": "You have only declared debug_t not defined it anywhere."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 1549, "user_id": 3600304, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/582e17ff0889a21f8b0f39315e064e76?s=128&d=identicon&r=PG&f=1", "display_name": "PapaDiHatti", "link": "https://stackoverflow.com/users/3600304/papadihatti"}, "edited": false, "score": 2, "creation_date": 1559137902, "post_id": 56362085, "comment_id": 99327754, "body": "@Kapil That&#39;s on purpose.  It is a trick to get the compiler to give you an error that gives you the exact type given to the template."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1559137953, "post_id": 56362085, "comment_id": 99327780, "body": "clang also gives the results I would expect.  Not sure what is going on with GCC but changing <code>template &lt;typename TPort, uint32_t N&gt;</code> to <code>template &lt;typename TPort, auto N&gt;</code> gets it to work.  No idea why it is needed though."}, {"owner": {"reputation": 4531, "user_id": 4756309, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/XMiQX.png?s=128&g=1", "display_name": "Weak to Enuma Elish", "link": "https://stackoverflow.com/users/4756309/weak-to-enuma-elish"}, "edited": false, "score": 0, "creation_date": 1559138385, "post_id": 56362085, "comment_id": 99328062, "body": "It&#39;s crazy that Visual Studio gets the template right and GCC has a weird result. I originally thought that VS must be the wrong one, but if clang also works than maybe this is actually a bug with GCC."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1559140430, "post_id": 56362085, "comment_id": 99329298, "body": "@NathanOliver: there is probablyy a dupe with <code>std::array</code> when trying to specialise for <code>std::array&lt;T, N&gt;</code> with <code>N</code> of type <code>int</code> instead of <code>std::size_t</code>."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1559138601, "post_id": 56362412, "comment_id": 99328199, "body": "Can you say why it should be so?  MSVS and clang both work for <code>uint32_t</code>."}, {"owner": {"reputation": 1778, "user_id": 9063139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bze7O.png?s=128&g=1", "display_name": "Martin Morterol", "link": "https://stackoverflow.com/users/9063139/martin-morterol"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1559138774, "post_id": 56362412, "comment_id": 99328313, "body": "I have add some explanation but i am not a language lawyer, it&#39;s more how I feel it more than C++ norm or what ever"}, {"owner": {"reputation": 574, "user_id": 10270827, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Zg20K6ddUR8/AAAAAAAAAAI/AAAAAAAAACM/5CYLYoCCjlI/photo.jpg?sz=128", "display_name": "Sean Brookins", "link": "https://stackoverflow.com/users/10270827/sean-brookins"}, "edited": false, "score": 0, "creation_date": 1559140704, "post_id": 56362412, "comment_id": 99329457, "body": "Because unsigned int is implementation dependent and not established as a standard. GCC, if I recall correctly, chooses the smallest (storage-wise) type that it can when initializing if you don&#39;t specify fixed width at time of creation."}], "tags": [], "owner": {"reputation": 1778, "user_id": 9063139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bze7O.png?s=128&g=1", "display_name": "Martin Morterol", "link": "https://stackoverflow.com/users/9063139/martin-morterol"}, "is_accepted": false, "score": 2, "last_activity_date": 1559139311, "last_edit_date": 1559139311, "creation_date": 1559138516, "answer_id": 56362412, "question_id": 56362085, "link": "https://stackoverflow.com/questions/56362085/why-template-specialization-doesnt-work-in-gcc/56362412#56362412", "title": "Why template specialization doesn&#39;t work in gcc", "body": "<p>It should be</p>\n\n<pre><code>template &lt;typename TPort, uint8_t N&gt;  // or auto\nstruct GetPinWithPort&lt;TPort, TPin&lt;TPort, N&gt;&gt;\n</code></pre>\n\n<p>not </p>\n\n<pre><code>template &lt;typename TPort, uint32_t N&gt;\nstruct GetPinWithPort&lt;TPort, TPin&lt;TPort, N&gt;&gt;\n</code></pre>\n\n<p>because (I am <strong>not</strong> a language lawer, it's just how I understand i): </p>\n\n<pre><code>template &lt;class PORT, uint8_t PIN&gt;\nclass TPin {}\n// and \nusing pina = GetPinWithPort&lt;Porta, TPin&lt;Porta, 1&gt; &gt;::type;\n</code></pre>\n\n<p>In the specialisation gcc have to choose between: </p>\n\n<pre><code>class T\n</code></pre>\n\n<p>and </p>\n\n<pre><code>TPin&lt;TPort, uint32_t&gt;\n</code></pre>\n\n<p>and the type it have is:</p>\n\n<pre><code>TPin&lt;Porta, 1&gt;\n</code></pre>\n\n<p>So may be gcc resolve the <code>TPin&lt;Porta, 1&gt;</code> to <code>TPin&lt;Porta, uint8_t&gt;</code> then fail the specialisation.</p>\n"}, {"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1559140496, "post_id": 56362954, "comment_id": 99329338, "body": "If you change the specialization to use an <code>int</code> it still does not work: <a href=\"http://coliru.stacked-crooked.com/a/1d795435e7a29d75\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/1d795435e7a29d75</a>"}, {"owner": {"reputation": 1956, "user_id": 878915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed0870e5d6b30b12a448c8b0a2fe1f20?s=128&d=identicon&r=PG", "display_name": "shargors", "link": "https://stackoverflow.com/users/878915/shargors"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1559141065, "post_id": 56362954, "comment_id": 99329679, "body": "@NathanOliver You are right.  I should have tried it myself first.  This works: <a href=\"http://coliru.stacked-crooked.com/a/a5e94bc8cc1657ae\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/a5e94bc8cc1657ae</a>"}], "tags": [], "owner": {"reputation": 1956, "user_id": 878915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed0870e5d6b30b12a448c8b0a2fe1f20?s=128&d=identicon&r=PG", "display_name": "shargors", "link": "https://stackoverflow.com/users/878915/shargors"}, "is_accepted": false, "score": 1, "last_activity_date": 1559141215, "last_edit_date": 1559141215, "creation_date": 1559140166, "answer_id": 56362954, "question_id": 56362085, "link": "https://stackoverflow.com/questions/56362085/why-template-specialization-doesnt-work-in-gcc/56362954#56362954", "title": "Why template specialization doesn&#39;t work in gcc", "body": "<p>In this line <code>using pina = GetPinWithPort&lt;Porta, TPin&lt;Porta, 1&gt; &gt;::type;</code>\n1 has the type of int not uint32_t.  So you instantiate <code>GetPinWithPort&lt;Porta, int&gt;</code> (the non-specialized definition), not <code>GetPinWithPort&lt;Porta, uint32_t&gt;</code>.</p>\n\n<p>Here is what the specialization should look like to pass the right template parameter to TPin:</p>\n\n<pre><code>template &lt;typename TPort, uint8_t N&gt;\nstruct GetPinWithPort&lt;TPort, TPin&lt;TPort, N&gt;&gt;\n{\n    using type = TPin&lt;TPort, N&gt;;\n};\n</code></pre>\n\n<p>Here is how it should be used:</p>\n\n<pre><code>using pina = GetPinWithPort&lt;Porta, TPin&lt;Porta, static_cast&lt;uint8_t&gt;(1)&gt; &gt;::type;\n</code></pre>\n\n<p>The reason for this is that C++ is very strict about using types instide of templates: very limited conversion of types is allowed.</p>\n"}], "owner": {"reputation": 31, "user_id": 10300031, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Dj43vNYuBQs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOWbFBMaKetaU8u0aK4N6_Gllbq-Q/mo/photo.jpg?sz=128", "display_name": "Dmitrey", "link": "https://stackoverflow.com/users/10300031/dmitrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1559141215, "creation_date": 1559137496, "last_edit_date": 1559139024, "question_id": 56362085, "link": "https://stackoverflow.com/questions/56362085/why-template-specialization-doesnt-work-in-gcc", "title": "Why template specialization doesn&#39;t work in gcc", "body": "<p>I'd like to write typelist methods to operate with microcontrollers GPIO's.</p>\n\n<p>I'd like to create list of GPIO's and select only pins of specific port.\nSo, <code>GetPinWithPort</code> template has specialisation which checks provided type. </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename... Ts&gt;\nstruct tlist\n{\n    using type = tlist;\n};\n\ntemplate &lt;typename T&gt; class debug_t;\n\n#define MAKE_PORT(NAME, ID)\\\n    class NAME\\\n    {\\\n        public:\\\n        static void Set(uint32_t v) { };\\\n        static void Reset(uint32_t v) { };\\\n        enum { id = ID };\\\n    };\n\nMAKE_PORT(Porta, 'A');\nMAKE_PORT(Portb, 'B');\n\ntemplate &lt;class PORT, uint8_t PIN&gt;\nclass TPin\n{\npublic:\n    static void Set() { PORT::Set(1 &lt;&lt; PIN); }\n    static void Reset() { PORT::Reset(1 &lt;&lt; PIN); }\n\n    typedef PORT port;\n    enum { pin = PIN };\n};\n\ntemplate &lt;class TPort, class T&gt;\nstruct GetPinWithPort {\n    using type = tlist&lt;&gt;;\n};\n\ntemplate &lt;typename TPort, uint32_t N&gt;\nstruct GetPinWithPort&lt;TPort, TPin&lt;TPort, N&gt;&gt;\n{\n    using type = TPin&lt;TPort, N&gt;;\n};\n\nint main()\n{\n\n    using pina = GetPinWithPort&lt;Porta, TPin&lt;Porta, 1&gt; &gt;::type;\n\n    // std::cout &lt;&lt; typeid(pina).name() &lt;&lt; std::endl;  //Visual Studio gives: class TPin&lt;class Porta,1&gt;\n    debug_t&lt;pina&gt; d; //gcc output: tlist&lt;&gt;\n\n}\n</code></pre>\n\n<p>Visual Studio gives expected result. But gcc - empty list. \nWhat is wrong here?</p>\n"}, {"tags": ["c++", "templates", "overloading", "language-lawyer", "ambiguous"], "owner": {"reputation": 2289, "user_id": 839932, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a487a879a978ecef2a3991c266e3b648?s=128&d=identicon&r=PG", "display_name": "0x5f3759df", "link": "https://stackoverflow.com/users/839932/0x5f3759df"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 2, "answer_count": 0, "score": 4, "last_activity_date": 1559137446, "creation_date": 1559137446, "question_id": 56362063, "link": "https://stackoverflow.com/questions/56362063/out-of-class-definition-of-member-function-template-in-the-presence-of-a-member", "title": "Out of class definition of member function template in the presence of a member function of the same name - compiler divergence", "body": "<p>Consider this example of a class template containing a member function and a member function template both of which are named <code>f</code> followed by an attempt to define and specialize the member function template:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename T&gt;\nstruct A {\n    void f();\n    template&lt;typename U&gt;\n    void f();\n};\n\ntemplate&lt;&gt;\ntemplate&lt;typename U&gt;\nvoid A&lt;double&gt;::f() { }\n\ntemplate&lt;&gt;\ntemplate&lt;&gt;\nvoid A&lt;double&gt;::f&lt;int&gt;() { }\n</code></pre>\n\n<p>Is this legal? How should the member function template definition be written?</p>\n\n<p>In the first definition of <code>f</code>, does the template declaration ensure that the member function template <code>f</code> should be selected rather than the member function <code>f</code> even though the template parameter does not appear in the type? I don't see any way to further disambiguate this as writing <code>::template f()</code>, <code>::f&lt;U&gt;()</code>, <code>::f&lt;&gt;()</code>, or a combination thereof does not seem to help.</p>\n\n<p>Compiler results:</p>\n\n<ul>\n<li>clang: crashes with a stack trace at the specialization of <code>f&lt;int&gt;</code></li>\n<li>Visual Studio: compiles successfully</li>\n<li>gcc: compile error (ambiguity regarding which <code>f</code> is being defined) at the first definition of <code>f</code></li>\n<li>EDG: compiles successfully</li>\n</ul>\n\n<p>By contrast, every compiler accepts the equivalent at namespace scope:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>namespace X {\n    void f();\n    template&lt;typename T&gt;\n    void f();\n}\ntemplate&lt;typename T&gt;\nvoid X::f() { }\ntemplate&lt;&gt;\nvoid X::f&lt;int&gt;() { }\n</code></pre>\n"}, {"tags": ["c++", "qt"], "answers": [{"tags": [], "owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "is_accepted": true, "score": 0, "last_activity_date": 1559143879, "creation_date": 1559143879, "answer_id": 56364053, "question_id": 56362006, "link": "https://stackoverflow.com/questions/56362006/creating-a-scrollable-window-without-layouts/56364053#56364053", "title": "Creating a scrollable window without Layouts", "body": "<p>Try this to fix it:</p>\n\n<p>In Qt Designer:</p>\n\n<ul>\n<li>Select <code>QScrollArea</code> object.</li>\n<li>Uncheck the <code>QScrollArea</code> properties <code>widgetResizable</code>.</li>\n</ul>\n\n<p>In C++:</p>\n\n<pre><code>// If you want to set `widgetResizable` programmaticly\nui-&gt;scrollArea-&gt;setWidgetResizable(false); // Optional if you did it in Qt Designer\nui-&gt;scrollArea-&gt;widget()-&gt;adjustSize();\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 11208712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cec889d7a7fd2aca23f762b78041483?s=128&d=identicon&r=PG&f=1", "display_name": "Jens", "link": "https://stackoverflow.com/users/11208712/jens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 56364053, "answer_count": 1, "score": 0, "last_activity_date": 1559144545, "creation_date": 1559137244, "last_edit_date": 1559144545, "question_id": 56362006, "link": "https://stackoverflow.com/questions/56362006/creating-a-scrollable-window-without-layouts", "title": "Creating a scrollable window without Layouts", "body": "<p>I am trying to achieve something what, I thought, would be a super easy thing to do. But for some reason QtDesigner is driving me crazy, it simply won't work...</p>\n\n<p>I created a GUI and freely arranged different elements in the window, without layout or anything like that. At some point there were to many elements, so all I wanted to to, was to make it scrollable up and down, to see all elements.</p>\n\n<p>So I added a ScrollArea in QtDesigner and added all elements as children of this ScrollArea (which btw also was a pain in the ass, because apparently drag and drop in the Object viewer is not a thing, and editing the .ui file by hand, is also not allowed... great).</p>\n\n<p>So the result I have now is the following:</p>\n\n<ul>\n<li>before resize - no scrollbar, elements at bottom inaccessible </li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/dQj3x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dQj3x.png\" alt=\"enter image description here\"></a></p>\n\n<ul>\n<li>resized vertically - some stuff still snapped off at the bottom</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/F4SIo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F4SIo.png\" alt=\"enter image description here\"></a></p>\n\n<p>So as you see, although I created a ScrollArea... There is no scroll area. So I googled a little bit and found out that you can add layouts to your scrollarea, and yey, finally, a scroll bar! But how in this world am I supposed to arrange the elements in the way you see in the screenshots, with layouts. They are so super restrictive.</p>\n\n<p>How am I supposed to simply get a vertical scrollbar, without this restrictive layout stuff?!</p>\n\n<p>Here is how my object viewer looks</p>\n\n<p><img src=\"https://i.stack.imgur.com/QkQRI.png\" alt=\"\"></p>\n\n<p>And here is what is called upon GUI creation:</p>\n\n<pre><code>ui-&gt;setupUi(this);\n//setCentralWidget(ui-&gt;scrollArea);\n//ui-&gt;scrollArea-&gt;setWidgetResizable(true);\n</code></pre>\n\n<p>I tried it with, and without the commented lines. No scrollbar, no matter what I do.</p>\n"}, {"tags": ["c++", "libunwind"], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 12196596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc3a7a03b4037af4551feed94527cde1?s=128&d=identicon&r=PG", "display_name": "nnnsoft", "link": "https://stackoverflow.com/users/12196596/nnnsoft"}, "is_accepted": false, "score": 0, "last_activity_date": 1580047535, "last_edit_date": 1580047535, "creation_date": 1580041111, "answer_id": 59918243, "question_id": 56361894, "link": "https://stackoverflow.com/questions/56361894/getting-module-addresses-with-libunwind/59918243#59918243", "title": "Getting module addresses with libunwind", "body": "<p>Assuming that by <em>static address</em> you mean offset from the start of the module where the function resides, you may use <code>dladdr(ip, info)</code> where <code>info.dli_fbase</code> gives you the base address of the loaded module. Then <code>(pc -  info.dli_fbase)</code> gives you the offset of this function from the start of the module.</p>\n"}], "owner": {"reputation": 601, "user_id": 9069780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bf2ad1391fadfaac120f3bb4e625ef?s=128&d=identicon&r=PG&f=1", "display_name": "Desperado17", "link": "https://stackoverflow.com/users/9069780/desperado17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1580047535, "creation_date": 1559136892, "question_id": 56361894, "link": "https://stackoverflow.com/questions/56361894/getting-module-addresses-with-libunwind", "title": "Getting module addresses with libunwind", "body": "<p>I extract the instruction pointer from a stackframe using libunwind like this:</p>\n\n<pre><code>unw_get_reg ( &amp;cursor, UNW_REG_IP, &amp;ip );\n</code></pre>\n\n<p>However, this only gives me the dynamic addresses of the function pointers. I would like to receive the static addresses in the modules so I can query them via addr2line.</p>\n\n<p>A different thread didn't receive an answer back then. Do you know how to achieve this info?</p>\n\n<p>Regards</p>\n"}, {"tags": ["python", "c++", "python-3.x", "omnet++", "python-c-api"], "comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 2, "creation_date": 1559137019, "post_id": 56361853, "comment_id": 99327176, "body": "<code>PyObject_GetAttrString(pModule (char*)&quot;calculateExecutionTime&quot;);</code> shouldn&#39;t be legal. Does your real code have a comma in there, or is the compiler accepting something truly strange? Also, you&#39;re not checking your return values for <code>NULL</code> (especially important on the <code>PyObject_CallObject</code> call, where you&#39;re ignoring any exception raised and trying to interpret a possibly <code>NULL</code> return as a legal pointer to <code>PyFloat</code>) or other error returns (e.g. <code>PyFloat_AsDouble</code> returns <code>-1.0</code> and sets an exception on failure)."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1559137285, "post_id": 56361853, "comment_id": 99327336, "body": "Additional problem: You&#39;re <code>Py_DECREF</code>ing after releasing the GIL. The primary purpose of the GIL is to protect reference count manipulation; if you don&#39;t hold the GIL, you aren&#39;t allowed to modify reference counts in any way. Admittedly unlikely to be a problem if no threads are involved, but it&#39;s just one more possible source of problems."}, {"owner": {"reputation": 11, "user_id": 11573074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ccebfc6620e8ad959810b884f918f05?s=128&d=identicon&r=PG&f=1", "display_name": "Mouna", "link": "https://stackoverflow.com/users/11573074/mouna"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1559138086, "post_id": 56361853, "comment_id": 99327873, "body": "My real code contains a comma in PyObject_GetAttrString(pModule,(char*)&quot;calculateExecutionTim&zwnj;&#8203;e&quot;);. I will check my return value. Thanks for your comments."}], "answers": [{"comments": [{"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1559282855, "post_id": 56375466, "comment_id": 99378200, "body": "Ok. But there&#39;s no clue in your question that your might be initializing and finalizing Python multiple times (and the github issue you linked to and which you said &quot;didn&#39;t help&quot; actually said that this wasn&#39;t supported). Please read the help on asking <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and follow it next time"}, {"owner": {"reputation": 11, "user_id": 11573074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ccebfc6620e8ad959810b884f918f05?s=128&d=identicon&r=PG&f=1", "display_name": "Mouna", "link": "https://stackoverflow.com/users/11573074/mouna"}, "reply_to_user": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1559311346, "post_id": 56375466, "comment_id": 99391572, "body": "That&#39;s right, because i am using python embedded code in particular case of OmneT++ simulation. It is not classical C++ program. It is controlled by simulation events, and after that I understood the problem and then the github link was helpful. At the beginning, I wasn&#39;t aware about the python interpreter mechanism. Thank you for the link, I will follow it next time."}], "tags": [], "owner": {"reputation": 11, "user_id": 11573074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ccebfc6620e8ad959810b884f918f05?s=128&d=identicon&r=PG&f=1", "display_name": "Mouna", "link": "https://stackoverflow.com/users/11573074/mouna"}, "is_accepted": false, "score": 0, "last_activity_date": 1559208718, "creation_date": 1559208718, "answer_id": 56375466, "question_id": 56361853, "link": "https://stackoverflow.com/questions/56361853/segmentation-fault-error-in-python-embedded-code-in-c-code-of-omnet-simple-m/56375466#56375466", "title": "Segmentation fault error in python embedded code in C++ code of Omnet++ simple module", "body": "<p>The problem occurs after the first initialization/uninitialization of python interpreter.  What happens during the OmneT++ simulation is initializing/uninitializing/re-initializing/... the Python interpreter. However, Numpy doesn't support this;</p>\n\n<p>So, I resolved this problem by initializing python interpreter just one time in the beginning of the simulation in initialize() method. Then, I called Py_Finalize(); in the destructor.</p>\n"}], "owner": {"reputation": 11, "user_id": 11573074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ccebfc6620e8ad959810b884f918f05?s=128&d=identicon&r=PG&f=1", "display_name": "Mouna", "link": "https://stackoverflow.com/users/11573074/mouna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559208718, "creation_date": 1559136815, "last_edit_date": 1559138330, "question_id": 56361853, "link": "https://stackoverflow.com/questions/56361853/segmentation-fault-error-in-python-embedded-code-in-c-code-of-omnet-simple-m", "title": "Segmentation fault error in python embedded code in C++ code of Omnet++ simple module", "body": "<p>I want to call a Python function from C++ code in OMNeT++ simple module. </p>\n\n<p>I debugged the code using gdb. It passes all lines fine, but at the end the\nsegmentation fault occurs after <code>Py_Finalize();</code>. </p>\n\n<p><a href=\"https://i.stack.imgur.com/tFq18.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tFq18.png\" alt=\"Segmentation fault error\"></a></p>\n\n<p>I found the following <a href=\"https://github.com/numpy/numpy/issues/7595\" rel=\"nofollow noreferrer\">issue on GitHub</a> that describes the same problem.\nBut it did not help me to resolve the problem.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>double result=0;\n// 1) Initialise python interpretator\nif (!Py_IsInitialized()) {\n    Py_Initialize();\n        //Py_AtExit(Py_Finalize);\n}\n// 2) Initialise python thread mechanism\nif (!PyEval_ThreadsInitialized()) {\n        PyEval_InitThreads();\n        assert(PyEval_ThreadsInitialized());\n}\n\nPyGILState_STATE s = PyGILState_Ensure();\nPyRun_SimpleString(\"import sys; sys.path.append('/home/mypath/')\");\nPyObject *pName = PyUnicode_DecodeFSDefault((char*)\"integrationTest\");\nPyObject* pModule = PyImport_Import(pName);\n\nif (pModule != NULL)\n{\n    PyObject* pFunction = PyObject_GetAttrString(pModule, (char*)\"calculateExecutionTime\");\n    /// changement will be held in this level Args and function result.\n    PyObject* pArgs = PyTuple_Pack(2,PyFloat_FromDouble(2.0),PyFloat_FromDouble(8.0));\n    PyObject* pResult = PyObject_CallObject(pFunction, pArgs);\n    result = (double)PyFloat_AsDouble(pResult);\n    ///////\n}\n// Clean up\nPyGILState_Release(s);\nPy_DECREF(pName);\nPy_DECREF(pModule);\nPy_Finalize();\n</code></pre>\n"}, {"tags": ["c++", "c++11", "c++14", "c++17", "perfect-forwarding"], "comments": [{"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 4, "creation_date": 1559138430, "post_id": 56361755, "comment_id": 99328097, "body": "This language is going mad."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1559138453, "post_id": 56361755, "comment_id": 99328107, "body": "In the case where the argument is not an lvalue. Say, <code>std::forward&lt;int&gt;(2)</code>."}, {"owner": {"reputation": 307, "user_id": 10664135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ab1f785cbf3a01f84bf25ad48677a86?s=128&d=identicon&r=PG&f=1", "display_name": "openyourmind", "link": "https://stackoverflow.com/users/10664135/openyourmind"}, "reply_to_user": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1559139512, "post_id": 56361755, "comment_id": 99328742, "body": "@Raymond Chen: sure, but I can&#39;t immagine when a such use is needed"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1559140239, "post_id": 56361755, "comment_id": 99329161, "body": "Define &quot;valid scenario.&quot; It seems to me that the <code>static_assert</code> is there to prevent malformed usage of the API, not to cover a &quot;valid scenario&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 5, "creation_date": 1559140724, "post_id": 56363121, "comment_id": 99329470, "body": "lol was halfway through typing out an answer linking to this paper -- glad you&#39;re here :-)"}], "tags": [], "owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "is_accepted": true, "score": 14, "last_activity_date": 1559142433, "last_edit_date": 1559142433, "creation_date": 1559140675, "answer_id": 56363121, "question_id": 56361755, "link": "https://stackoverflow.com/questions/56361755/what-is-the-purpose-of-stdforwards-rvalue-reference-overload/56363121#56363121", "title": "What is the purpose of std::forward()&#39;s rvalue reference overload?", "body": "<p>The design rationale for <code>forward</code> is discussed in great detail in <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2951.html\" rel=\"noreferrer\">N2951</a>.</p>\n\n<p>This document lays out 6 use cases:</p>\n\n<blockquote>\n  <p>A. <strong>Should forward an lvalue as an lvalue.</strong> All implementations pass\n  this test. But this is not the classic perfect forwarding pattern. The\n  purpose of this test is to show that implementation 2 fails in its\n  stated goal of preventing all use cases except perfect forwarding.</p>\n  \n  <p>B. <strong>Should forward an rvalue as an rvalue.</strong> Like use case A, this is\n  an identity transformation and this presents a motivating example\n  where the identity transformation is needed.</p>\n  \n  <p>C. <strong>Should <em>not</em> forward an rvalue as an lvalue.</strong> This use case\n  demonstrates a dangerous situation of accidentally creating a dangling\n  reference.</p>\n  \n  <p>D.  <strong>Should forward less cv-qualified expressions to more\n  cv-qualified expressions.</strong> A motivating use case involving the\n  addition of const during the forward.</p>\n  \n  <p>E. <strong>Should forward expressions of derived type to an accessible,\n  unambiguous base type.</strong> A motivating use case involving forwarding a\n  derived type to a base type.</p>\n  \n  <p>F.  <strong>Should <em>not</em> forward arbitrary type conversions.</strong> This use case\n  demonstrates how arbitrary conversions within a forward lead to\n  dangling reference run time errors.</p>\n</blockquote>\n\n<p>The second overload enables cases B and C.</p>\n\n<p>The paper goes on to provide examples of each use case, which are too lengthy to be repeated here.</p>\n\n<p><strong>Update</strong></p>\n\n<p>I've just run the \"solution\" of just the first overload through these 6 use cases, and this exercise shows that the second overload also enables use case F:  Should not forward arbitrary type conversions.</p>\n"}], "owner": {"reputation": 307, "user_id": 10664135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ab1f785cbf3a01f84bf25ad48677a86?s=128&d=identicon&r=PG&f=1", "display_name": "openyourmind", "link": "https://stackoverflow.com/users/10664135/openyourmind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 56363121, "answer_count": 1, "score": 16, "last_activity_date": 1569841799, "creation_date": 1559136408, "last_edit_date": 1559140644, "question_id": 56361755, "link": "https://stackoverflow.com/questions/56361755/what-is-the-purpose-of-stdforwards-rvalue-reference-overload", "title": "What is the purpose of std::forward()&#39;s rvalue reference overload?", "body": "<p>I'm experimenting with Perfect Forwarding and I found that \n<a href=\"https://en.cppreference.com/w/cpp/utility/forward\" rel=\"noreferrer\"><code>std::forward()</code></a> needs two overloads:</p>\n\n<p>Overload nr. 1:</p>\n\n<pre><code>template &lt;typename T&gt;\ninline T&amp;&amp; forward(typename \nstd::remove_reference&lt;T&gt;::type&amp; t) noexcept\n{\n    return static_cast&lt;T&amp;&amp;&gt;(t);\n}\n</code></pre>\n\n<p>Overload nr.2:</p>\n\n<pre><code>template &lt;typename T&gt;\ninline T&amp;&amp; forward(typename \nstd::remove_reference&lt;T&gt;::type&amp;&amp; t) noexcept\n{\n    static_assert(!std::is_lvalue_reference&lt;T&gt;::value,\n              \"Can not forward an rvalue as an lvalue.\");\n    return static_cast&lt;T&amp;&amp;&gt;(t);\n}\n</code></pre>\n\n<p>Now a typical scenario for Perfect Forwarding is something like</p>\n\n<pre><code>template &lt;typename T&gt;\nvoid wrapper(T&amp;&amp; e)\n{\n    wrapped(forward&lt;T&gt;(e));\n}\n</code></pre>\n\n<p>Of course you know that when <code>wrapper()</code> is instantiated, <code>T</code> depends on whether the argument passed to it is an lvalue or an rvalue. If it's an lvalue of type <code>U</code>, <code>T</code> is deduced to <code>U&amp;</code>. If it's an rvalue, <code>T</code> is deduced to <code>U</code>.</p>\n\n<p>In any case - in the scope of <code>wrapper()</code> - <code>e</code> is an lvalue, therefore it always uses the first overload of <code>std::forward()</code>.</p>\n\n<p>Now my question:</p>\n\n<p><strong>What is a valid scenario in which the 2nd overload is used (and is needed)?</strong></p>\n"}, {"tags": ["c++", "c", "arm", "interrupt-handling", "cortex-m"], "answers": [{"comments": [{"owner": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "edited": false, "score": 1, "creation_date": 1559137917, "post_id": 56362016, "comment_id": 99327763, "body": "May I summarize your answer to: no it is not possible due to the requirement to use the C calling convention?  If so that raises another question, why are we bound to this convention?"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "edited": false, "score": 1, "creation_date": 1559138048, "post_id": 56362016, "comment_id": 99327852, "body": "@Bart: Hard to summarize because you had multiple questions.  Your first one &quot;Is it possible to write an interrupt handler in C++ for ARM Cortex chips?&quot; the answer is Yes.  For &quot;Is there a way to not having to forward through the C function?&quot; also Yes.  For &quot;Is there a way to directly call a C++ object function when a interrupt occurs?&quot; No.  There are multiple things that &quot;C++ object function&quot; could mean and none of them are usable as interrupt handlers."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "edited": false, "score": 0, "creation_date": 1559138226, "post_id": 56362016, "comment_id": 99327964, "body": "@Bart: And as for why you are bound to this convention, it&#39;s because it is baked into the hardware.  The processor doesn&#39;t know about <code>this</code> pointers or anything like that.  In fact, interrupt handlers might not even use the C calling convention used for other functions, you might get a special calling convention by using a keyword (for example <code>__interrupt</code>, so in C++ you end up with <code>extern &quot;C&quot; __interrupt void whatever(void)</code>).  (The spelling of the keyword depends on your compiler)  The compiler will take care of this detail.  What it can&#39;t do is create a <code>this</code> pointer out of thin air."}, {"owner": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "edited": false, "score": 0, "creation_date": 1559138379, "post_id": 56362016, "comment_id": 99328057, "body": "Thank you for your clarification. I understand what you mean. By using a singleton or global object I implicitly stopped using this, hence working around that problem."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1559140688, "post_id": 56362016, "comment_id": 99329447, "body": "@old_timer: Can you check if my edit is precise enough to avoid confusion?"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1559141236, "post_id": 56362016, "comment_id": 99329781, "body": "C compilers can chose their own convention there are no rules to stop them.  they can choose to use a common or recommended one or go their own way.  For the cortex-m to be able to have a c function label address in the vector table and have it work that compiler needs to conform to the convention &quot;baked&quot; into the logic.  otherwise C wont work either.   You can then use the traditional approach of wrapping your C function either with compiler specific features or on your own in assembly."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1559146914, "post_id": 56362016, "comment_id": 99332850, "body": "@old_timer: Yes absolutely you can write the interrupt handler (or a forwarder) in assembly if you choose, giving it the expected name.  You can choose your own symbol names for handler functions if you write your own (or modify) the platform support code.  But most people will use the compiler-provided startup function so they get globals correctly initialized, etc before <code>main()</code> is called.  And in that common case the interrupt handlers need to use the names designated by the platform support library, which have C linkage."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1559152459, "post_id": 56362016, "comment_id": 99335311, "body": "and most people are using gnu or kiel or some other that uses a compatible calling convention."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1559152496, "post_id": 56362016, "comment_id": 99335329, "body": "the reset vector is a special case even for C but definitely for C++ the other vectors are the one you want to use this cortex-m feature for."}, {"owner": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "edited": false, "score": 0, "creation_date": 1559199373, "post_id": 56362016, "comment_id": 99348094, "body": "I think something important is mentioned here: it is compiler dependent. In the mean time I found this link to the <a href=\"https://www.iar.com/support/tech-notes/compiler/cortex-m-interrupt-vector-in-c-ewarm-6.21/\" rel=\"nofollow noreferrer\">IAR</a> website. It is an example for an interrupt vertor table in C++. I did look at it but have to undertand it yet."}], "tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": true, "score": 3, "last_activity_date": 1559141082, "last_edit_date": 1559141082, "creation_date": 1559137278, "answer_id": 56362016, "question_id": 56361596, "link": "https://stackoverflow.com/questions/56361596/arm-cortex-m-interrupt-handler-in-c/56362016#56362016", "title": "ARM Cortex-M interrupt handler in C++", "body": "<p>It is possible to write the interrupt handler in any language that compiles to native code.</p>\n\n<p>It still has to use C language linkage with the interrupt handler calling convention.  That means no member functions.  (Formally, static member functions are illegal as well, although they usually work in practice.  Non-static member functions cannot be used.)</p>\n\n<p>In C++, first enable the C language linkage with <code>extern \"C\"</code>.  Also use any compiler-specific keyword for interrupt handlers that you would have used in C, such as <code>__interrupt</code>.</p>\n\n<p>Inside the function you can use the full power of C++ -- objects, for-in loops, smart pointers, template instances, etc.  Although you still want to be careful about how much work you do in interrupt context, and C++ tends to hide the complexity so you no longer have a feel for how many machine instructions are being generated.</p>\n\n<hr>\n\n<p>On ARM Cortex M chips, there's a table of function pointers at a preset memory address.  The table may be constructed in C or assembly, and if your interrupt handlers aren't exported with the correct name, the linker won't be able to find the addresses that belong in the table.  C language linkage ensures that any name mangling is performed in a way compatible with the symbol references in the startup code.</p>\n\n<p>Other processor families use a fixed address only for the reset vector, and install other interrupt handlers by writing each handler address into a special-function register corresponding to its interrupt.  For these, only calling convention matters and not the function name/linkage.  ARM Cortex-M lets you write a special function register to find the whole vector table at an alternate address, but not to relocate individual handlers.</p>\n"}, {"comments": [{"owner": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "edited": false, "score": 0, "creation_date": 1559139165, "post_id": 56362415, "comment_id": 99328564, "body": "Thank you for your answer, I understand what you mean. Only a static function of that class would be a valid candidate."}], "tags": [], "owner": {"reputation": 5417, "user_id": 1823524, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/uScxd.jpg?s=128&g=1", "display_name": "Amomum", "link": "https://stackoverflow.com/users/1823524/amomum"}, "is_accepted": false, "score": 2, "last_activity_date": 1559138529, "creation_date": 1559138529, "answer_id": 56362415, "question_id": 56361596, "link": "https://stackoverflow.com/questions/56361596/arm-cortex-m-interrupt-handler-in-c/56362415#56362415", "title": "ARM Cortex-M interrupt handler in C++", "body": "<blockquote>\n  <p>Is away to directly call a C++ object function when a interrupt occurs?</p>\n</blockquote>\n\n<p>In a short, no. Even if you declare your non-static method as <code>void (void)</code>, it still has an implicit argument - <code>this</code>. Interrupt handler on the other hand, has no arguments at all.</p>\n"}], "owner": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 852, "favorite_count": 0, "accepted_answer_id": 56362016, "answer_count": 2, "score": 2, "last_activity_date": 1559898945, "creation_date": 1559135919, "last_edit_date": 1559898945, "question_id": 56361596, "link": "https://stackoverflow.com/questions/56361596/arm-cortex-m-interrupt-handler-in-c", "title": "ARM Cortex-M interrupt handler in C++", "body": "<p>Is it possible to write an interrupt handler in C++ for ARM Cortex chips like those of ST and NXP.</p>\n\n<p>Currently I develop a lot of code in C++ for ARM cortex chips. I am a bit fed up with having to call a static/global/singleton C++ object from a C callback function. Is there a way to not having to through the C function. </p>\n\n<p>Is there a way to directly call a C++ object functions when a interrupt occurs?</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1559145175, "post_id": 56361491, "comment_id": 99331939, "body": "Do not ask the same question in different publications, on one occasion you indicate that this is considered noise here"}], "answers": [{"tags": [], "owner": {"reputation": 510, "user_id": 6223604, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/fgRcJ.jpg?s=128&g=1", "display_name": "TheRight", "link": "https://stackoverflow.com/users/6223604/theright"}, "is_accepted": false, "score": 0, "last_activity_date": 1559136341, "creation_date": 1559136341, "answer_id": 56361735, "question_id": 56361491, "link": "https://stackoverflow.com/questions/56361491/how-to-hide-a-scoll-area-in-qt/56361735#56361735", "title": "how to hide a scoll area in qt?", "body": "<p>QScrollArea is a QFrame descendant. If you set the frame shape to QFrame::NoFrame\nTry :</p>\n\n<pre><code>setFrameShape(QFrame::NoFrame);\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 11232960, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Hkx8IPcP7C4/AAAAAAAAAAI/AAAAAAAAAHk/v-aae30T0PY/photo.jpg?sz=128", "display_name": "Brian Kreidberg", "link": "https://stackoverflow.com/users/11232960/brian-kreidberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "closed_date": 1559145098, "answer_count": 1, "score": 0, "last_activity_date": 1559136341, "creation_date": 1559135563, "question_id": 56361491, "link": "https://stackoverflow.com/questions/56361491/how-to-hide-a-scoll-area-in-qt", "closed_reason": "Duplicate", "title": "how to hide a scoll area in qt?", "body": "<p>I am trying to hide a scroll area but running these commands just make it smaller and more towards the bottom. I am trying to close a scroll area which has a live webcam feed in it. I have tried the hide and the close command and neither of those are working.</p>\n\n<pre><code>    connect(mCameraAction, &amp;QAction::triggered, [&amp;](){\n        ui-&gt;xAxis-&gt;hide();\n        ui-&gt;yAxis-&gt;hide();\n        ui-&gt;zAxis-&gt;hide();\n        ui-&gt;xRotate-&gt;hide();\n        ui-&gt;yRotate-&gt;hide();\n        ui-&gt;zRotate-&gt;hide();\n        ui-&gt;x1Label-&gt;hide();\n        ui-&gt;y1Label-&gt;hide();\n        ui-&gt;z1Label-&gt;hide();\n        ui-&gt;x2Label-&gt;hide();\n        ui-&gt;y2Label-&gt;hide();\n        ui-&gt;z2Label-&gt;hide();\n\n\n        ui-&gt;ScrollArea-&gt;show();\n        mCamera-&gt;setViewfinder(mCameraViewfinder);\n        mLayout-&gt;addWidget(mCameraViewfinder);\n        mLayout-&gt;setMargin(0);\n        ui-&gt;ScrollArea-&gt;setLayout(mLayout);\n        mCamera-&gt;start();\n\n    });\n\n    connect(mGantryAction,&amp;QAction::triggered, [&amp;](){\n        mCamera-&gt;stop();\n        ui-&gt;ScrollArea-&gt;hide();\n        ui-&gt;scrollAreaWidgetContents-&gt;hide();\n\n\n        ui-&gt;xAxis-&gt;setLayout(mLayout);\n        ui-&gt;yAxis-&gt;setLayout(mLayout);\n        ui-&gt;zAxis-&gt;setLayout(mLayout);\n        ui-&gt;xRotate-&gt;setLayout(mLayout);\n        ui-&gt;yRotate-&gt;setLayout(mLayout);\n        ui-&gt;zRotate-&gt;setLayout(mLayout);\n        ui-&gt;x1Label-&gt;setLayout(mLayout);\n        ui-&gt;y1Label-&gt;setLayout(mLayout);\n        ui-&gt;z1Label-&gt;setLayout(mLayout);\n        ui-&gt;x2Label-&gt;setLayout(mLayout);\n        ui-&gt;y2Label-&gt;setLayout(mLayout);\n        ui-&gt;z2Label-&gt;setLayout(mLayout);\n        ui-&gt;x1Label-&gt;show();\n        ui-&gt;y1Label-&gt;show();\n        ui-&gt;z1Label-&gt;show();\n        ui-&gt;x2Label-&gt;show();\n        ui-&gt;y2Label-&gt;show();\n        ui-&gt;z2Label-&gt;show();\n        ui-&gt;xAxis-&gt;show();\n        ui-&gt;yAxis-&gt;show();\n        ui-&gt;zAxis-&gt;show();\n        ui-&gt;xRotate-&gt;show();\n        ui-&gt;yRotate-&gt;show();\n        ui-&gt;zRotate-&gt;show();\n\n\n    });\n</code></pre>\n"}, {"tags": ["c++", "data-structures"], "comments": [{"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1559135690, "post_id": 56361474, "comment_id": 99326316, "body": "Does <code>Player</code> class have a default constructor you are trying to call?"}, {"owner": {"reputation": 1, "user_id": 11572890, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tmgPJrnzaOw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmcqGr-ylbiwi0OTRf9R1IR1fIiQ/mo/photo.jpg?sz=128", "display_name": "Soul DEV", "link": "https://stackoverflow.com/users/11572890/soul-dev"}, "reply_to_user": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1559135857, "post_id": 56361474, "comment_id": 99326430, "body": "No, i forgot to, your comment solved my problem!.. thanks!."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11572890, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tmgPJrnzaOw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmcqGr-ylbiwi0OTRf9R1IR1fIiQ/mo/photo.jpg?sz=128", "display_name": "Soul DEV", "link": "https://stackoverflow.com/users/11572890/soul-dev"}, "edited": false, "score": 0, "creation_date": 1559135929, "post_id": 56361523, "comment_id": 99326474, "body": "oh :(, it took me long time trying to find where the problem is, now it&#39;s solved!, thanks!."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 2, "last_activity_date": 1559135691, "creation_date": 1559135691, "answer_id": 56361523, "question_id": 56361474, "link": "https://stackoverflow.com/questions/56361474/class-templates-no-matching-function-for-call-to-playerplayer/56361523#56361523", "title": "class templates &#39;no matching function for call to Player::Player()&#39;", "body": "<p>It's what it says (and has little to do with templates).</p>\n\n<p><code>Queue&lt;Player&gt;</code> has a member <code>Player entry[maxsize]</code>, which requires the default-construction of <code>maxsize</code> <code>Player</code> objects.</p>\n\n<p>But since <code>Player</code> has no default constructor, this is impossible.</p>\n\n<p><a href=\"https://stackoverflow.com/q/4754763/560648\">How about a nice vector instead?</a> You don't really need/want to allocate the maximum number of <code>Player</code>s up-front anyway, surely.</p>\n"}], "owner": {"reputation": 1, "user_id": 11572890, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tmgPJrnzaOw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmcqGr-ylbiwi0OTRf9R1IR1fIiQ/mo/photo.jpg?sz=128", "display_name": "Soul DEV", "link": "https://stackoverflow.com/users/11572890/soul-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559135691, "creation_date": 1559135515, "question_id": 56361474, "link": "https://stackoverflow.com/questions/56361474/class-templates-no-matching-function-for-call-to-playerplayer", "title": "class templates &#39;no matching function for call to Player::Player()&#39;", "body": "<p>I'm learning about data structures by making a simple card game.\nIn this code, i have a class <strong>Player</strong>, and a <strong>Queue</strong> containing all the players in the game.</p>\n\n<p>the implementation of the Queue:</p>\n\n<pre><code>template &lt; typename T &gt;\n    class Queue{\n    int count;\n    int front, rear;\n    T entry[maxsize];\n    public:\n    Queue();\n    bool empty();\n    errorcode Append(T item);\n    errorcode serve();\n    errorcode retreive(T &amp;item);\n    };\n</code></pre>\n\n<p>The Queue constructor:</p>\n\n<pre><code>template &lt;typename T&gt;\n    Queue&lt;T&gt;::Queue(){\n        count = 0;\n        rear = maxsize-1;\n        front=0;\n    }\n</code></pre>\n\n<p>And here is the Player class:</p>\n\n<pre><code>       class Player {\n            int number;\n            List&lt;string&gt; set;\n        public:\n            Player(int number, List&lt;string&gt; set) {\n                this-&gt;number = number;\n                this-&gt;set = set;\n            }\n            void draw();\n            string play();\n            .\n            .\n            .\n        };\n</code></pre>\n\n<p>in the main function, i declare the Queue using this code:</p>\n\n<pre><code>Queue&lt;Player&gt; pl;\n</code></pre>\n\n<p>But i get the error 'no matching function for call to Player::Player()', this error is in the line where the queue constructor is implemented.</p>\n"}, {"tags": ["c++", "multithreading", "openmp"], "answers": [{"tags": [], "owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "is_accepted": false, "score": 0, "last_activity_date": 1559138253, "creation_date": 1559138253, "answer_id": 56362328, "question_id": 56361293, "link": "https://stackoverflow.com/questions/56361293/overriding-omp-num-threads-from-code-for-real/56362328#56362328", "title": "Overriding OMP_NUM_THREADS from code - for real", "body": "<blockquote>\n  <p>Overriding OMP_NUM_THREADS from code...</p>\n</blockquote>\n\n<p>Change this:</p>\n\n<pre><code>int main () {\n  omp_set_num_threads(2);\n  #pragma omp parallel\n  {\n    if (omp_get_thread_num() == 0) {\n      std::cout &lt;&lt; \"Num threads:\" &lt;&lt; omp_get_num_threads() &lt;&lt; std::endl;\n    }\n  };\n  std::thread t(job);\n  t.join();\n}\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>int main () {\n  #pragma omp parallel num_threads(2)\n  {\n    if (omp_get_thread_num() == 0) {\n      std::cout &lt;&lt; \"Num threads:\" &lt;&lt; omp_get_num_threads() &lt;&lt; std::endl;\n    }\n  };\n  std::thread t(job);\n  t.join();\n}\n</code></pre>\n\n<p>I believe that works with Microsoft compilers, which are stuck somewhere around 2003 for OpenMP. The 2003 release of OpenMP is roughly version 2.0 or 2.1, if I recall correctly.</p>\n\n<p>Also see <a href=\"https://stackoverflow.com/q/22813923/608639\">Difference between num_threads vs. omp_set_num_threads vs OMP_NUM_THREADS</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1650, "user_id": 2785280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mokc5.jpg?s=128&g=1", "display_name": "Michael Klemm", "link": "https://stackoverflow.com/users/2785280/michael-klemm"}, "is_accepted": false, "score": 2, "last_activity_date": 1559138773, "creation_date": 1559138773, "answer_id": 56362483, "question_id": 56361293, "link": "https://stackoverflow.com/questions/56361293/overriding-omp-num-threads-from-code-for-real/56362483#56362483", "title": "Overriding OMP_NUM_THREADS from code - for real", "body": "<p>The problem with what you're trying to achieve is outside of OpenMP's specification.  OpenMP assumes that it's the only programming model in the application process and thus it does know anything about what happens when you create a new thread that also executes OpenMP code.</p>\n\n<p>Specifically, for your problem: the ICV <code>num-threads</code> is a thread-private ICV, that means, that a call to <code>omp_set_num_threads()</code> only affects the ICV stored in the thread that calls <code>omp_set_num_threads()</code>.</p>\n\n<p>So, the new <code>std::thread</code> will receive a new copy that initialized from the envionment variable.  You won't be able to change it from the master thread that spawned the new thread.</p>\n"}], "owner": {"reputation": 332, "user_id": 6083484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f1aa2eed4e448de97d3bd320cd610b?s=128&d=identicon&r=PG&f=1", "display_name": "S. Kaczor", "link": "https://stackoverflow.com/users/6083484/s-kaczor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1559138773, "creation_date": 1559134813, "question_id": 56361293, "link": "https://stackoverflow.com/questions/56361293/overriding-omp-num-threads-from-code-for-real", "title": "Overriding OMP_NUM_THREADS from code - for real", "body": "<p>All the answers I was able to find so far suggest calling <code>omp_set_num_threads</code>. While it's a proper answer for most cases, it doesn't work for me. Internally, calling <code>omp_set_num_threads</code> causes a creation of per-thread ICV  (or modification, if current thread already has one), and the number of threads is stored there. This means that if there is a different thread, that starts a parallel region, it won't see our new value. So calling omp_set_num_threads != setting OMP_NUM_THREADS env variable.</p>\n\n<p>Is there a way to change global ICV?</p>\n\n<p>Side note - why would I want to to this: I'm working with a library spawns a worker thread for me, so I don't really control it's life-cycle.</p>\n\n<p>Simplest example to reproduce:</p>\n\n<p><code>export OMP_NUM_THREADS=3</code></p>\n\n<pre><code>#include &lt;omp.h&gt;\n#include &lt;iostream&gt;\n#include &lt;thread&gt;\n\nvoid job() {\n  #pragma omp parallel\n  {\n    if (omp_get_thread_num() == 0) {\n      std::cout &lt;&lt; \"Num threads:\" &lt;&lt; omp_get_num_threads() &lt;&lt; std::endl;\n    }\n  };\n}\n\n\nint main () {\n  omp_set_num_threads(2);\n  #pragma omp parallel\n  {\n    if (omp_get_thread_num() == 0) {\n      std::cout &lt;&lt; \"Num threads:\" &lt;&lt; omp_get_num_threads() &lt;&lt; std::endl;\n    }\n  };\n  std::thread t(job);\n  t.join();\n}\n</code></pre>\n\n<p>This produces</p>\n\n<pre><code>Num threads:2\nNum threads:3\n</code></pre>\n"}, {"tags": ["c++", "glm-math", "return-value-optimization"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559134904, "post_id": 56361206, "comment_id": 99325803, "body": "&quot;Weirdly, I cannot reproduce if I just copy these two code blocks into an empty project&quot; this sounds like undefined behaviour or other problems in other parts of your code. It is likely that the problem is not caused by the code you posted here"}], "owner": {"reputation": 4630, "user_id": 160386, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b6044f355342bb055fbb03804d9673e3?s=128&d=identicon&r=PG", "display_name": "Jan Tojnar", "link": "https://stackoverflow.com/users/160386/jan-tojnar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 347, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559134533, "creation_date": 1559134533, "question_id": 56361206, "link": "https://stackoverflow.com/questions/56361206/how-to-return-glmvec3-as-a-value", "title": "How to return glm::vec3 as a value?", "body": "<p>I am trying to convert an array of floats to glm vector in a helper function. Unfortunately, the returned value is mangled:</p>\n\n<pre><code>arr: 1, 1, 0\nfn.arr: 1, 1, 0\nfn.vec: 1, 1, 0\nvec: 4.7468e-11, 4.55856e-41, 1\n</code></pre>\n\n<p>I would expect the following code to allocate <code>vec</code> on stack in the function and then return it as a value.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// main.cpp\n\nfloat colour[3] = {1.0f, 1.0f, 0.0f};\nstd::cout &lt;&lt; \"arr: \" &lt;&lt; colour[0] &lt;&lt; \", \" &lt;&lt; colour[1] &lt;&lt; \", \" &lt;&lt; colour[2] &lt;&lt; std::endl;\nglm::vec3 c = arr_to_vec3(colour);\nstd::cout &lt;&lt; \"vec: \" &lt;&lt; c.x &lt;&lt; \", \" &lt;&lt; c.y &lt;&lt; \", \" &lt;&lt; c.z &lt;&lt; std::endl;\n\n// util.cpp\n\nglm::vec3 arr_to_vec3(float arr[3]) {\n  std::cout &lt;&lt; \"fn.arr: \" &lt;&lt; arr[0] &lt;&lt; \", \" &lt;&lt; arr[1] &lt;&lt; \", \" &lt;&lt; arr[2] &lt;&lt; std::endl;\n  glm::vec3 vec = glm::vec3(arr[0], arr[1], arr[2]);\n  std::cout &lt;&lt; \"fn.vec: \" &lt;&lt; vec.x &lt;&lt; \", \" &lt;&lt; vec.y &lt;&lt; \", \" &lt;&lt; vec.z &lt;&lt; std::endl;\n\n  return vec;\n}\n</code></pre>\n\n<p>From the output above, it does not seem to be the case. Something must be deallocating the value as the last output shows random junk. Maybe the <code>float</code>s are not copied for some reason and the returned vector points to the <code>arr_to_vec3</code>\u2019s stack frame? It is not really clear to me how the <a href=\"https://github.com/g-truc/glm/blob/0.9.8.5/glm/detail/type_vec3.hpp#L27-L76\" rel=\"nofollow noreferrer\">data</a> is stored in the vector and what semantics applies.</p>\n\n<p>Weirdly, I cannot reproduce if I just copy these two code blocks into an empty project (perhaps the memory is not cleared there by chance).</p>\n"}, {"tags": ["c++", "multithreading", "qt", "qt5", "mutex"], "comments": [{"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1559134620, "post_id": 56360804, "comment_id": 99325619, "body": "Please edit your question to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  As it stands there&#39;s not nearly enough information to be able to reproduce/diagnose the problem."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1559135497, "post_id": 56360804, "comment_id": 99326188, "body": "<a href=\"https://blog.qt.io/blog/2010/06/17/youre-doing-it-wrong/\" rel=\"nofollow noreferrer\">blog.qt.io/blog/2010/06/17/youre-doing-it-wrong</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11049660, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4vxFgastHLg/AAAAAAAAAAI/AAAAAAAAAKY/l5QTXW0WgxA/photo.jpg?sz=128", "display_name": "Gagandeep", "link": "https://stackoverflow.com/users/11049660/gagandeep"}, "edited": false, "score": 0, "creation_date": 1559142005, "post_id": 56362480, "comment_id": 99330177, "body": "can this will work ? emit pass_to_main(test_mem)      Inside main-&gt;           connect(thread_variable,signal(pass_to_main(*p),SLOT(display&zwnj;&#8203;(*p),this,Qt::Queued&zwnj;&#8203;Connection) ??"}, {"owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "reply_to_user": {"reputation": 11, "user_id": 11049660, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4vxFgastHLg/AAAAAAAAAAI/AAAAAAAAAKY/l5QTXW0WgxA/photo.jpg?sz=128", "display_name": "Gagandeep", "link": "https://stackoverflow.com/users/11049660/gagandeep"}, "edited": false, "score": 0, "creation_date": 1559144110, "post_id": 56362480, "comment_id": 99331370, "body": "Yes, it will work fine. Cause the threads share the same address space. <code>*p</code> (address of <code>p</code>) will be accessible by all threads in the same process (app)."}, {"owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "reply_to_user": {"reputation": 11, "user_id": 11049660, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4vxFgastHLg/AAAAAAAAAAI/AAAAAAAAAKY/l5QTXW0WgxA/photo.jpg?sz=128", "display_name": "Gagandeep", "link": "https://stackoverflow.com/users/11049660/gagandeep"}, "edited": false, "score": 0, "creation_date": 1559232200, "post_id": 56362480, "comment_id": 99363843, "body": "With <code>QThread</code> you can use void <code>QThread::exit(int returnCode)</code>."}, {"owner": {"reputation": 11, "user_id": 11049660, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4vxFgastHLg/AAAAAAAAAAI/AAAAAAAAAKY/l5QTXW0WgxA/photo.jpg?sz=128", "display_name": "Gagandeep", "link": "https://stackoverflow.com/users/11049660/gagandeep"}, "edited": false, "score": 0, "creation_date": 1559621836, "post_id": 56362480, "comment_id": 99468322, "body": "Can any-body tell be which is the safe way to terminate the pthread if user want to abort the execution of the pthread, pthread_cancel or pthread_kill ??"}, {"owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "reply_to_user": {"reputation": 11, "user_id": 11049660, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4vxFgastHLg/AAAAAAAAAAI/AAAAAAAAAKY/l5QTXW0WgxA/photo.jpg?sz=128", "display_name": "Gagandeep", "link": "https://stackoverflow.com/users/11049660/gagandeep"}, "edited": false, "score": 0, "creation_date": 1559672478, "post_id": 56362480, "comment_id": 99492029, "body": "<code>pthread_cancel</code> is the safest for terminating a thread since the thread is only supposed to be affected when it has set its cancelability state to true using <code>pthread_setcancelstate()</code>."}, {"owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "reply_to_user": {"reputation": 11, "user_id": 11049660, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4vxFgastHLg/AAAAAAAAAAI/AAAAAAAAAKY/l5QTXW0WgxA/photo.jpg?sz=128", "display_name": "Gagandeep", "link": "https://stackoverflow.com/users/11049660/gagandeep"}, "edited": false, "score": 0, "creation_date": 1559672708, "post_id": 56362480, "comment_id": 99492102, "body": "<code>pthread_cancel()</code> : used to terminate a thread, based on cancel ability state the cleanup handlers are called if any handlers are registered before invoking the thread destructor. <a href=\"http://man7.org/linux/man-pages/man3/pthread_cancel.3.html\" rel=\"nofollow noreferrer\">for more details</a>"}, {"owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "reply_to_user": {"reputation": 11, "user_id": 11049660, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4vxFgastHLg/AAAAAAAAAAI/AAAAAAAAAKY/l5QTXW0WgxA/photo.jpg?sz=128", "display_name": "Gagandeep", "link": "https://stackoverflow.com/users/11049660/gagandeep"}, "edited": false, "score": 0, "creation_date": 1559672749, "post_id": 56362480, "comment_id": 99492111, "body": "<code>pthread_kill()</code> : used just like <code>kill()</code>, it raises a signal to thread. It is possible that some times it affects the entire process like when passed <code>SIGKILL</code> to <code>pthread_kill</code> will terminate the entire process. <a href=\"http://man7.org/linux/man-pages/man3/pthread_kill.3.html\" rel=\"nofollow noreferrer\">for more details</a>"}], "tags": [], "owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "is_accepted": false, "score": 0, "last_activity_date": 1559149523, "last_edit_date": 1559149523, "creation_date": 1559138757, "answer_id": 56362480, "question_id": 56360804, "link": "https://stackoverflow.com/questions/56360804/does-the-qt-thread-share-the-static-global-variable-or-not/56362480#56362480", "title": "Does the qt-thread share the static global variable or not?", "body": "<p>Qt and C++ in general share the <code>static</code> variables.</p>\n\n<p>example of use:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>\n//Class where data is stored:\n\nclass SharedData {\n    static QMutex sMutex;\n    static unsigned char* spDataPointer;\n    signals: void pass_test(unsigned char** address);\n}\n\n//Access from from thread:\n\nSharedData::spDataPointer = (unsignedchar*) mmap(NULL, lenth, PROT_WRITE|PROT_READ, MAP_SHARED, trigger_fd, offset);\nemit SharedData::pass_test(&amp;SharedData::spDataPointer); \n</code></pre>\n\n<p>But there is another approach for your implementation.</p>\n\n<p>You don't need to use a shared variable, just use Qt Signals and Slots:</p>\n\n<p>Connect a <code>slot</code> to your <code>pass_test</code> <code>signal</code> by <code>Qt::QueuedConnection</code>.\nLike this, when you initialize your pointer, just emit the signal to send it to main-thread. The main-thread will receive your pointer handle it safely.</p>\n\n<p>For more information about QThread show <a href=\"https://doc.qt.io/qt-5/thread-basics.html\" rel=\"nofollow noreferrer\">this article</a>.\nFor more information about Qt Signals and Slots show <a href=\"https://doc.qt.io/qt-5/signalsandslots.html\" rel=\"nofollow noreferrer\">this article</a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 11049660, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4vxFgastHLg/AAAAAAAAAAI/AAAAAAAAAKY/l5QTXW0WgxA/photo.jpg?sz=128", "display_name": "Gagandeep", "link": "https://stackoverflow.com/users/11049660/gagandeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 285, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559149581, "creation_date": 1559133336, "last_edit_date": 1559149581, "question_id": 56360804, "link": "https://stackoverflow.com/questions/56360804/does-the-qt-thread-share-the-static-global-variable-or-not", "title": "Does the qt-thread share the static global variable or not?", "body": "<p>I want to know about how to share the static global variable with qt-thread.</p>\n\n<p>I have a one static global pointer <strong>test_mem</strong> which is shared between qt-thread &amp; main thread.qt-thread with initialize this pointer variable to the starting address of the data memory location which i has to read.then main thread will use the same global variable to read the data from the memory location where this pointer is pointing. But it seems like qt-thread is not sharing the global pointer with main thread.  </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void run() {\n    test_mem = (unsignedchar*)mmap(NULL,lenth,PROT_WRITE|PROT_READ,MAP_SHARED,trigger_fd,offset);\n    emit pass_test(&amp;test_mem);       \n}\n</code></pre>\n\n<p>I want to know about can we share the static global variable between qt-thread &amp; main thread?</p>\n"}, {"tags": ["c++", "guideline-support-library"], "comments": [{"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 3, "creation_date": 1559134011, "post_id": 56360796, "comment_id": 99325268, "body": "Check <a href=\"https://stackoverflow.com/questions/36349523/ensures-guideline-support-library\">this</a> question."}, {"owner": {"reputation": 545, "user_id": 8654234, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ffdff2f2d5422e6f5b150fa7ff73308?s=128&d=identicon&r=PG&f=1", "display_name": "suresh m", "link": "https://stackoverflow.com/users/8654234/suresh-m"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1559135302, "post_id": 56360796, "comment_id": 99326078, "body": "I got it, thanks for sharing:)"}, {"owner": {"reputation": 545, "user_id": 8654234, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ffdff2f2d5422e6f5b150fa7ff73308?s=128&d=identicon&r=PG&f=1", "display_name": "suresh m", "link": "https://stackoverflow.com/users/8654234/suresh-m"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1559136163, "post_id": 56360796, "comment_id": 99326630, "body": "but I wanted to know about the performance comparison of both, since assert is generally not used in the production build as mentioned in the above link(learncpp)."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 3, "creation_date": 1559136307, "post_id": 56360796, "comment_id": 99326726, "body": "Off-topic, but <a href=\"https://stackoverflow.com/q/1452721\"><code>using namespace std;</code> is considered bad practice.</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 0, "creation_date": 1582909382, "post_id": 56361827, "comment_id": 106951301, "body": "As decided by the Core Guideline authors the MS GSL lately removed <code>GSL_THROW_ON_CONTRACT_VIOLATION</code> and now always <code>std::terminate</code>s. But... there is still a discussion ongoing because the Core Guidelines seem to be inconsistent about the behaviour of <code>Expects</code>."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 3, "last_activity_date": 1559136672, "creation_date": 1559136672, "answer_id": 56361827, "question_id": 56360796, "link": "https://stackoverflow.com/questions/56360796/advantage-of-gsl-assert-vs-assert-in-c/56361827#56361827", "title": "Advantage of gsl assert vs assert in c++?", "body": "<p>It's not a question of performance; it's a question of flexibility.</p>\n\n<h3>C assert</h3>\n\n<p>This just terminates (in debug builds) if the condition is true, and usually does nothing in release builds.</p>\n\n<h3>GSL contract check</h3>\n\n<p><a href=\"https://github.com/Microsoft/GSL/blob/master/include/gsl/gsl_assert\" rel=\"nofollow noreferrer\">Depending on configuration</a>, this can:</p>\n\n<ol>\n<li>Throw an exception</li>\n<li>Terminate</li>\n<li>Do nothing\n\n<ul>\n<li>&hellip;except signal to the optimiser that we expect the condition to hold (if supported)</li>\n</ul></li>\n</ol>\n\n<hr>\n\n<p>In some configuration modes, I suppose GSL's <code>Expects</code> and <code>Ensures</code> macros end up doing pretty much the same thing as <code>assert</code>. But not in all.</p>\n\n<p>It's worth noting, though, that the GSL behaviour appears not to be dependent on build configuration (debug vs release). I guess (and I am only guessing) that, for performance-critical code, a sensible project maintainer would choose mode #1 or #2 in debug builds, and #3 (or possibly #2) in release builds.</p>\n"}], "owner": {"reputation": 545, "user_id": 8654234, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ffdff2f2d5422e6f5b150fa7ff73308?s=128&d=identicon&r=PG&f=1", "display_name": "suresh m", "link": "https://stackoverflow.com/users/8654234/suresh-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 873, "favorite_count": 2, "accepted_answer_id": 56361827, "answer_count": 1, "score": 9, "last_activity_date": 1559136672, "creation_date": 1559133317, "last_edit_date": 1559136026, "question_id": 56360796, "link": "https://stackoverflow.com/questions/56360796/advantage-of-gsl-assert-vs-assert-in-c", "title": "Advantage of gsl assert vs assert in c++?", "body": "<p>I know the use of <code>assert</code> in C++. Wanted to know is there any difference between and any benefit(I think <code>assert</code> is costlier according as mentioned in <a href=\"https://www.learncpp.com/cpp-tutorial/7-12a-assert-and-static_assert/\" rel=\"nofollow noreferrer\">https://www.learncpp.com/cpp-tutorial/7-12a-assert-and-static_assert/</a> so performance wise, are both same?) in using <code>gsl_assert</code> over <code>assert</code>? Why <code>gsl_assert</code> was added in gsl library since there is already <code>assert</code> support in c++(even though <code>assert</code> came from 'C', since we add <code>#include&lt;cassert&gt;</code> for using <code>assert</code> in C++)?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;gsl/gsl_assert&gt;\nusing namespace std;\n\nint main()\n{\n    int val;\n    cin &gt;&gt; val;\n    Ensures( val &gt; 5 );\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "winapi", "hwnd"], "comments": [{"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 1, "creation_date": 1559133125, "post_id": 56360679, "comment_id": 99324724, "body": "Congratulations, you have a stack overflow. Just use a simple <code>while</code> loop rather than making your function recursive."}, {"owner": {"reputation": 3, "user_id": 11572822, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d4RaMJaNn5A/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reqyJ2vlvgoaZRPg1vYw6FIO_JtLQ/mo/photo.jpg?sz=128", "display_name": "z32byTe", "link": "https://stackoverflow.com/users/11572822/z32byte"}, "reply_to_user": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1559133315, "post_id": 56360679, "comment_id": 99324844, "body": "Thanks, that is actually more efficient."}, {"owner": {"reputation": 3035, "user_id": 1413244, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/BaB5H.png?s=128&g=1", "display_name": "jwezorek", "link": "https://stackoverflow.com/users/1413244/jwezorek"}, "edited": false, "score": 0, "creation_date": 1559141714, "post_id": 56360679, "comment_id": 99330015, "body": "You&#39;re clicking on a window created by some other application and have your own process that is waiting for the foreground window to change?"}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 2, "last_activity_date": 1559154922, "creation_date": 1559154922, "answer_id": 56366645, "question_id": 56360679, "link": "https://stackoverflow.com/questions/56360679/get-hwnd-of-a-window-i-clicked-on/56366645#56366645", "title": "Get HWND of a window i clicked on", "body": "<p>Don't poll for the active window, especially not with a recursive function.  Just let the OS notify you when a window is clicked.</p>\n\n<p>When the user clicks on your button, you can use <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-setcapture\" rel=\"nofollow noreferrer\"><code>SetCapture()</code></a>, or a mouse hook via <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-setwindowshookexa\" rel=\"nofollow noreferrer\"><code>SetWindowsHookEx()</code></a>, to direct subsequent mouse clicks to your app even if they are clicking on someone else's window.  When you detect a click, release the capture/hook, and then use <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-windowfrompoint\" rel=\"nofollow noreferrer\"><code>WindowFromPoint()</code></a> to get the <code>HWND</code> at the location of the click.</p>\n"}], "owner": {"reputation": 3, "user_id": 11572822, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d4RaMJaNn5A/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reqyJ2vlvgoaZRPg1vYw6FIO_JtLQ/mo/photo.jpg?sz=128", "display_name": "z32byTe", "link": "https://stackoverflow.com/users/11572822/z32byte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1559154922, "creation_date": 1559132997, "question_id": 56360679, "link": "https://stackoverflow.com/questions/56360679/get-hwnd-of-a-window-i-clicked-on", "title": "Get HWND of a window i clicked on", "body": "<p>I'm making a program, with c++ and winapi, where you can click a button, then select a window and it changes the transparency of that window.</p>\n\n<p>I have no problems of making the window transparent, but i can't get the hwnd of a window.</p>\n\n<p>When I use this function the program just crashes (No errors are being printed to the console).</p>\n\n<pre><code>HWND getHWND(HWND self)\n{\n  HWND found = GetForegroundWindow();\n  if(found == self || found == NULL)\n    return getHWND(self);\n  return found;\n}\n</code></pre>\n\n<p>I tried using this, but I don't like it, because the user has only 2 seconds to click on another window. (I'know I could use a bigger delay, but then it might be to much.. so this isn't optimal)</p>\n\n<pre><code>HWND getHWND()\n{\n  Sleep(2000);\n  return GetForegroundWindow();\n}\n</code></pre>\n"}, {"tags": ["c++", "sfinae", "generic-programming", "expression-templates"], "comments": [{"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 0, "creation_date": 1559133491, "post_id": 56360583, "comment_id": 99324952, "body": "Maybe my understanding of what ADL is is incorrect, but what this has to do with ADL?"}, {"owner": {"reputation": 1122, "user_id": 3218438, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XE9Rb.png?s=128&g=1", "display_name": "Nibor", "link": "https://stackoverflow.com/users/3218438/nibor"}, "reply_to_user": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 0, "creation_date": 1559135451, "post_id": 56360583, "comment_id": 99326156, "body": "I thought &#39;Overload Resolution&#39; and ADL are the same. Apparently, they&#39;re not."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1559800172, "post_id": 56360583, "comment_id": 99533860, "body": "Overloading resolution is choosing between names found incl. those found by ADL."}], "answers": [{"comments": [{"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1559133306, "post_id": 56360722, "comment_id": 99324837, "body": "In fact removing the sfinae, the superfluous template argument then uncommenting the uncontrainted one yield me the correct result."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 1, "creation_date": 1559133443, "post_id": 56360722, "comment_id": 99324925, "body": "@GuillaumeRacicot Yes, that works in the reduced example posted. But note that the OP says that the constrained version should only be used when <code>V</code> is derived from <code>A&lt;T&gt;</code> for some <code>A</code>. Removing the sfinae would make it apply to all transpose-nontranspose pairs."}, {"owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "edited": false, "score": 0, "creation_date": 1559138428, "post_id": 56360722, "comment_id": 99328094, "body": "Reading this SFINAE it should only allow <code>typename V</code> to be <code>B&lt;T&gt;</code> but given that <code>std::is_base_of&lt;Base, Derived&gt;::value</code> yields <code>true</code> if <code>std::is_same&lt;Base, Derived&gt;::value</code> it also allows <code>A&lt;T&gt;</code>. Shouldn&#39;t there be a check to disallow that, too? If I am understand OP&#39;s Intention correctly, that is."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "edited": false, "score": 0, "creation_date": 1559138563, "post_id": 56360722, "comment_id": 99328171, "body": "@StackDanny I understood the OP&#39;s question as &quot;how do I word SFINAE for a special case that involves <code>A&lt;T&gt;</code> or a type derived from <code>A&lt;T&gt;</code>?&quot; That&#39;s how I read &quot;Suppose now that I want a specialized treatment for &#39;transpose of a variable of type <code>A&lt;T&gt;</code> times a variable of type <code>A&lt;T&gt;</code> for some type <code>T</code>&#39;, as I had in my <code>main</code>.&quot; Note that it was a <code>B&lt;double&gt;</code> in the <code>main</code>, actually."}, {"owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "edited": false, "score": 0, "creation_date": 1559139220, "post_id": 56360722, "comment_id": 99328599, "body": "@Angew I just find it weird because if you were to remove <code>struct B</code> from the code the SFINAE (which strictly asks for a <code>std::is_base_of</code> case) will still be called even though there is no inheritance whatsover going on. I just thoughts that&#39;s unintentional. I suppose this is to be blamed on the implementation of <code>std::is_base_of</code>."}, {"owner": {"reputation": 1122, "user_id": 3218438, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XE9Rb.png?s=128&g=1", "display_name": "Nibor", "link": "https://stackoverflow.com/users/3218438/nibor"}, "edited": false, "score": 0, "creation_date": 1559140322, "post_id": 56360722, "comment_id": 99329224, "body": "@Angew You interpreted my intent correctly, although more generally, <code>A&lt;T&gt;</code> would be an abstract class."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "edited": false, "score": 0, "creation_date": 1559141278, "post_id": 56360722, "comment_id": 99329802, "body": "@StackDanny <code>std::is_base_of</code> effectively models IS-A. To be fair, it&#39;s much more common in practice to need to know &quot;are you X or one of its descendants&quot; than &quot;are you derived from X, but not X itself.&quot;"}], "tags": [], "owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": true, "score": 12, "last_activity_date": 1559140711, "last_edit_date": 1559140711, "creation_date": 1559133108, "answer_id": 56360722, "question_id": 56360583, "link": "https://stackoverflow.com/questions/56360583/why-is-overload-resolution-favoring-unconstrained-template-function-over-a-more/56360722#56360722", "title": "Why is Overload Resolution favoring unconstrained template function over a more specific one?", "body": "<p>The problem is that in the SFINAE overload, <code>T</code> is used in a non-deduced context. You're effectively asking the compiler: \"Enable this if there exists a <code>T</code> such that <code>A&lt;T&gt;</code> is a base class of <code>V</code>.\" Existential quantification is a good indicator that what you're asking for cannot be SFINAEd.</p>\n\n<p>You can see this yourself if you disable the unconstrained template, as I did <a href=\"http://coliru.stacked-crooked.com/a/04a4c907690b9d91\" rel=\"nofollow noreferrer\">here</a>. This forces the compiler to spell out why the other function is not admissible.</p>\n\n<p>You can solve this by making <code>T</code> available through your <code>A</code> (and thus <code>B</code>) classes, like this:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct A {\n    using Type = T;\n    T elem;\n};\n\n\ntemplate &lt;typename V&gt;\nstd::enable_if_t&lt;std::is_base_of&lt;A&lt;typename V::Type&gt;, V&gt;::value, typename V::Type&gt; operator*(const transpose&lt;V&gt; &amp;one,\n                                                               const V &amp;two) {\n    std::cout &lt;&lt; \" called: std::enable_if_t&lt;std::is_base_of&lt;A&lt;T&gt;, V&gt;::value, T&gt; operator*(const \"\n                 \"transpose&lt;V&gt; &amp;one, const V &amp;two)\\n\";\n    return one.t.elem * two.elem;\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/72735cfc0759777e\" rel=\"nofollow noreferrer\">[Live example]</a></p>\n"}], "owner": {"reputation": 1122, "user_id": 3218438, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XE9Rb.png?s=128&g=1", "display_name": "Nibor", "link": "https://stackoverflow.com/users/3218438/nibor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 56360722, "answer_count": 1, "score": 14, "last_activity_date": 1559792999, "creation_date": 1559132643, "last_edit_date": 1559792999, "question_id": 56360583, "link": "https://stackoverflow.com/questions/56360583/why-is-overload-resolution-favoring-unconstrained-template-function-over-a-more", "title": "Why is Overload Resolution favoring unconstrained template function over a more specific one?", "body": "<p>I have this minimal expression template library with a multiplication, i.e.</p>\n\n<pre><code>template &lt;typename T, typename U&gt;\nstruct mul {\n    const T &amp;v1;\n    const U &amp;v2;\n};\n\ntemplate &lt;typename T, typename U&gt;\nmul&lt;T, U&gt; operator*(const T &amp;one, const U &amp;two) {\n    std::cout &lt;&lt; \" called: mul&lt;T, U&gt; operator*(const T &amp;one, const T &amp;two)\\n\";\n    return mul&lt;T, U&gt;{one, two};\n}\n</code></pre>\n\n<p>and transpose, i.e.</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct transpose {\n    const T &amp;t;\n};\n\ntemplate &lt;typename T&gt;\ntranspose&lt;T&gt; tran(const T &amp;one) {\n    return transpose&lt;T&gt;{one};\n}\n</code></pre>\n\n<p>I will introduce some types <code>A</code> and <code>B</code>, where the latter is a subclass of the former:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct A {\n    T elem;\n};\n\ntemplate &lt;typename T&gt;\nstruct B : A&lt;T&gt; {\n    B(T val) : A&lt;T&gt;{val} {}\n};\n</code></pre>\n\n<p>Then, I can call my expression template library as follows (with an overload for printing to <code>std::cout</code>):</p>\n\n<pre><code>template &lt;typename T, typename U&gt;\nstd::ostream &amp;operator&lt;&lt;(std::ostream &amp;os, const mul&lt;T, U&gt; &amp;m) {\n    os &lt;&lt; \" unconstrained template \\n\";\n}\n\nint main(int argc, char const *argv[]) {\n    B&lt;double&gt; a{2};\n    B&lt;double&gt; b{3};\n    std::cout &lt;&lt; tran(a) * b &lt;&lt; \"\\n\";\n    return 0;\n}\n</code></pre>\n\n<p>This gives me the output : </p>\n\n<pre><code>called: mul&lt;T, U&gt; operator*(const T &amp;one, const T &amp;two)\nunconstrained template \n</code></pre>\n\n<p>So far so good. Suppose now that I want a specialized treatment for 'transpose of a variable of type <code>A&lt;T&gt;</code> times a variable of type <code>A&lt;T&gt;</code> for some type <code>T</code>', as I had in my <code>main</code>. To this end, I will introduce </p>\n\n<pre><code>template &lt;typename T&gt;\nT operator*(const transpose&lt;A&lt;T&gt;&gt; &amp;one, const A&lt;T&gt; &amp;two) {\n    std::cout &lt;&lt; \" called: T operator*(const A&lt;T&gt; &amp;one, const A&lt;T&gt; &amp;two)\\n\";\n    return one.t.elem * two.elem;\n}\n</code></pre>\n\n<p>I run the same <code>main</code> function as above, and I still get the same output as above (<code>unconstrained template</code>). This is to be expected, since <code>transpose&lt;B&lt;double&gt;&gt;</code> is a completely different type compared to <code>transpose&lt;A&lt;double&gt;&gt;</code>, so overload resolution picks the unconstrained template version of <code>operator*</code>. </p>\n\n<p>(Of course, if I change my variable definitions in <code>main</code> to <code>A</code> instead of <code>B</code>, ADL calls the specialized function and output is <code>called: T operator*(const A&lt;T&gt; &amp;one, const A&lt;T&gt; &amp;two)</code> and <code>6</code>).</p>\n\n<p>I recently learned about SFINAE, so I expected the following change to the more specific multiplication operator would cause overload resulution to select the specialized function:</p>\n\n<pre><code>template &lt;typename T, typename V&gt;\nstd::enable_if_t&lt;std::is_base_of&lt;A&lt;T&gt;, V&gt;::value, T&gt; operator*(const transpose&lt;V&gt; &amp;one,\n                                                               const V &amp;two) {\n    std::cout &lt;&lt; \" called: std::enable_if_t&lt;std::is_base_of&lt;A&lt;T&gt;, V&gt;::value, T&gt; operator*(const \"\n                 \"transpose&lt;V&gt; &amp;one, const V &amp;two)\\n\";\n    return one.t.elem * two.elem;\n}\n</code></pre>\n\n<p><strong>Even using the SFINAE'd <code>operator*</code> I still get the <code>unconstrained template</code> version. How come? What changes should I make to call the more specialized template function?</strong></p>\n"}, {"tags": ["c++", "visual-c++"], "comments": [{"owner": {"reputation": 63, "user_id": 8413068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3990a7bb367a46ef51ed0205ddc74c2e?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad Ross", "link": "https://stackoverflow.com/users/8413068/vlad-ross"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1559132958, "post_id": 56360564, "comment_id": 99324608, "body": "I am sure, because at program start I see newly generated file with 4 records &quot;I was called \\n&quot;"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1559133883, "post_id": 56360564, "comment_id": 99325196, "body": "Try closing <code>myfile</code> after logging WM_QUERYENDSESSION CALLED.  As things stand, it&#39;s probably not being flushed to disk."}, {"owner": {"reputation": 63, "user_id": 8413068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3990a7bb367a46ef51ed0205ddc74c2e?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad Ross", "link": "https://stackoverflow.com/users/8413068/vlad-ross"}, "edited": false, "score": 0, "creation_date": 1559134313, "post_id": 56360564, "comment_id": 99325424, "body": "I did as you said, also tried to show messageBox, but it didn&#39;t help"}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 2, "creation_date": 1559134530, "post_id": 56360564, "comment_id": 99325568, "body": "What is <code>&#47;&#47;some code</code> maybe it is your message dispatch loop which does not handle messages properly could you at least provide that?"}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1559134676, "post_id": 56360564, "comment_id": 99325652, "body": "@PaulSanders according to <a href=\"https://stackoverflow.com/questions/4802494/do-i-need-to-close-a-stdfstream\">this question&#39;s answers</a> <code>std::fstream</code> objects are RAII objects which means they should close and flush semselfs on destruction."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559134775, "post_id": 56360564, "comment_id": 99325713, "body": "@Yastanub Good point, I stand corrected."}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 1, "creation_date": 1559135278, "post_id": 56360564, "comment_id": 99326062, "body": "@VladRoss have you tried outputing to your file when receiving the <code>WM_ENDSESSION</code> message? As stated in the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/shutdown/shutting-down\" rel=\"nofollow noreferrer\">WM_QUERYENDSESSION&#39;s Documentation</a> &quot;Each application should return TRUE or FALSE immediately upon receiving this message, and defer any cleanup operations until it receives the WM_ENDSESSION message.&quot; Maybe it is some Windows shutdown magic that some system calls like writing or opening a file wont work while <code>WM_QUERYENDSESSION</code> Message is received."}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 1, "creation_date": 1559139028, "post_id": 56360564, "comment_id": 99328484, "body": "Okay so i compiled your example myself all i added was a simply message processing loop to the main function and i can not reproduce your error. I get a <code>log.txt</code> fiel with the expected content. So either it is because of the not shown code or how you shut down your system or application repectively."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 2, "creation_date": 1559139554, "post_id": 56360564, "comment_id": 99328756, "body": "My educated guess would be, &quot;some code&quot; doesn&#39;t involve calling <code>GetMessage</code> and <code>DispatchMessage</code> (also known as a message loop or message pump). That&#39;s how window messages get routed to the window procedure. No message pump == no messages."}, {"owner": {"reputation": 63, "user_id": 8413068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3990a7bb367a46ef51ed0205ddc74c2e?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad Ross", "link": "https://stackoverflow.com/users/8413068/vlad-ross"}, "edited": false, "score": 0, "creation_date": 1559142793, "post_id": 56360564, "comment_id": 99330590, "body": "Yeah, <a href=\"https://docs.microsoft.com/en-us/windows/desktop/winmsg/using-messages-and-message-queues\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/desktop/winmsg/&hellip;</a> that&#39;s it. Thanks for help! But what if I already have my main loop where I do my stuff with some delay, should I run Message Loop in separated thread?"}, {"owner": {"reputation": 63, "user_id": 8413068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3990a7bb367a46ef51ed0205ddc74c2e?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad Ross", "link": "https://stackoverflow.com/users/8413068/vlad-ross"}, "edited": false, "score": 0, "creation_date": 1559143938, "post_id": 56360564, "comment_id": 99331279, "body": "As I see, if I run it in separate loop it doesn&#39;t get messages, so I should run my main loop in separated thread?"}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559147533, "post_id": 56360564, "comment_id": 99333173, "body": "@VladRoss im not sure if i get you here but cant you just transform your main loop to your message loop? You also have a <code>PeekMessage</code> function which does not block which you might prefer. If ou struggle with the loop open a new question."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1559228054, "post_id": 56360564, "comment_id": 99361595, "body": "Message queues are per-thread. You must run the pump on the same thread that called <code>CreateWindow</code>, in order to deliver messages to that window."}, {"owner": {"reputation": 63, "user_id": 8413068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3990a7bb367a46ef51ed0205ddc74c2e?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad Ross", "link": "https://stackoverflow.com/users/8413068/vlad-ross"}, "edited": false, "score": 0, "creation_date": 1559322060, "post_id": 56360564, "comment_id": 99396627, "body": "Thx, I already understood this, so I call <code>CreateWindow</code> and Message loop in separated thread, it works fine"}], "owner": {"reputation": 63, "user_id": 8413068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3990a7bb367a46ef51ed0205ddc74c2e?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad Ross", "link": "https://stackoverflow.com/users/8413068/vlad-ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559132584, "creation_date": 1559132584, "question_id": 56360564, "link": "https://stackoverflow.com/questions/56360564/c-wndproc-event-wm-queryendsession-is-not-called-in-windows", "title": "C++ WndProc event WM_QUERYENDSESSION is not called in Windows", "body": "<p>Here is my code example:</p>\n\n<pre><code>LRESULT CALLBACK WindowProc(HWND, UINT, WPARAM, LPARAM);\n\nint WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, PSTR szCmdParam, int iCmdShow)\n{\n    static char szAppName[] = \"hidden window\";\n\n    HWND        hWnd = GetActiveWindow();\n\n    WNDCLASSEX  wndclass;\n    wndclass.cbSize = sizeof(wndclass);\n    wndclass.style = CS_OWNDC;\n    wndclass.lpfnWndProc = WindowProc;\n    wndclass.cbClsExtra = 0;\n    wndclass.cbWndExtra = 0;\n    wndclass.hInstance = hInstance;\n    wndclass.hIcon = LoadIcon(NULL, IDI_APPLICATION);\n    wndclass.hCursor = LoadCursor(NULL, IDC_ARROW);\n    wndclass.hbrBackground = NULL;\n    wndclass.lpszMenuName = NULL;\n    wndclass.lpszClassName = szAppName;\n    wndclass.hIconSm = LoadIcon(NULL, IDI_APPLICATION);\n\n    RegisterClassEx(&amp;wndclass);\n\n    hWnd = CreateWindow(\n        szAppName,\n        \"hidden window\", // window caption\n        WS_OVERLAPPEDWINDOW,\n        CW_USEDEFAULT,\n        CW_USEDEFAULT,\n        CW_USEDEFAULT,\n        CW_USEDEFAULT,\n        NULL,\n        NULL,\n        hInstance,\n        NULL);\n\n    ShowWindow(hWnd, SW_HIDE);\n    UpdateWindow(hWnd);\n\n    // Some code\n}\n\nLRESULT CALLBACK WindowProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)\n{\n    ofstream myfile;\n    myfile.open(\"log.txt\", ios::app);\n    myfile &lt;&lt; \"I was called \\n\";\n    switch (uMsg)\n    {\n    case  WM_QUERYENDSESSION:\n    {\n        myfile &lt;&lt; \"WM_QUERYENDSESSION CALLED\\n\";\n        return TRUE;\n\n        break;\n    }\n    }\n    myfile.close();\n\n    return DefWindowProc(hwnd, uMsg, wParam, lParam);\n}\n</code></pre>\n\n<p>I register handler by <code>wndclass.lpfnWndProc = WindowProc;</code> and WindowProc is triggered few times and writes \"I was called \\n\" only when I start app, but when I shutdown system absolutely nothing writes to log.txt, therefore handler is not triggered. I tried different examples, but nothing works to me. Any ideas what's wrong here?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1717, "user_id": 8690361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a10e6bc70a207a4a458c76b04c08?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8690361/steve"}, "edited": false, "score": 2, "creation_date": 1559132911, "post_id": 56360552, "comment_id": 99324571, "body": "Append the id to a string of 6 underscores. Then take the last 6 characters, using e.g. <code>substr()</code>"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559140485, "post_id": 56360552, "comment_id": 99329334, "body": "What is a &quot;PLC&quot;? What is <code>glog</code>?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 1717, "user_id": 8690361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a10e6bc70a207a4a458c76b04c08?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8690361/steve"}, "edited": false, "score": 2, "creation_date": 1559140517, "post_id": 56360552, "comment_id": 99329351, "body": "@Steve: That&#39;s very inefficient. Also let&#39;s avoid giving answers in the comments section"}], "answers": [{"tags": [], "owner": {"reputation": 633, "user_id": 11493447, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wIRkU.jpg?s=128&g=1", "display_name": "Cristi&#225;n Ormaz&#225;bal", "link": "https://stackoverflow.com/users/11493447/cristi%c3%a1n-ormaz%c3%a1bal"}, "is_accepted": false, "score": 0, "last_activity_date": 1559135293, "last_edit_date": 1559135293, "creation_date": 1559134958, "answer_id": 56361328, "question_id": 56360552, "link": "https://stackoverflow.com/questions/56360552/fill-out-empty-spaces-with-underscore/56361328#56361328", "title": "Fill out empty spaces with underscore", "body": "<p>If you are able to use the standard library, you can use the formatting capabilities it provides. Here a mini demo of that:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n#include &lt;sstream&gt;\n\n#define BUFFER_SIZE (10)\nint main() {\n  std::stringstream buffer;\n  buffer &lt;&lt; std::right &lt;&lt; std::setw(BUFFER_SIZE) &lt;&lt; std::setfill('_') &lt;&lt; 1;\n  std::cout &lt;&lt; buffer.str() &lt;&lt; std::endl;\n  buffer.str(std::string());\n  buffer &lt;&lt; std::right &lt;&lt; std::setw(BUFFER_SIZE) &lt;&lt; std::setfill('_') &lt;&lt; 1234;\n  std::cout &lt;&lt; buffer.str() &lt;&lt; std::endl;\n  buffer.str(std::string());\n  buffer &lt;&lt; std::right &lt;&lt; std::setw(BUFFER_SIZE) &lt;&lt; std::setfill('_') &lt;&lt; 1234567;\n  std::cout &lt;&lt; buffer.str() &lt;&lt; std::endl;\n  buffer.str(std::string());\n  return 0;\n}\n</code></pre>\n\n<p>std::right makes the formatting to align to right, std::setfill sets '_' as padding character and std::setw sets the width required.\nBest regards.</p>\n"}, {"tags": [], "owner": {"reputation": 149, "user_id": 7220147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EgTrK.png?s=128&g=1", "display_name": "Gilgames", "link": "https://stackoverflow.com/users/7220147/gilgames"}, "is_accepted": true, "score": 1, "last_activity_date": 1559140388, "creation_date": 1559140388, "answer_id": 56363019, "question_id": 56360552, "link": "https://stackoverflow.com/questions/56360552/fill-out-empty-spaces-with-underscore/56363019#56363019", "title": "Fill out empty spaces with underscore", "body": "<p>If you have to go the C way, you can do it <a href=\"http://cpp.sh/2r6mo\" rel=\"nofollow noreferrer\">like this</a>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n\nint main()\n{\n  const char *padding = \"______\";\n  int n = 123;\n  char buf[7];\n  int len;\n  len = snprintf(buf, 7, \"%d\", n);\n  printf(\"%.*s%s\", 6 - std::min(6, len), padding, buf);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>___123\n</code></pre>\n\n<p>If the number has more than 6 digits, it will be truncated by taking only the 6 leftmost digits. For example, if <code>n</code> is <code>1234567890</code>, the output will be <code>123456</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 11370366, "user_type": "registered", "profile_image": "https://graph.facebook.com/2209572019118469/picture?type=large", "display_name": "Pex van Nieuwburg", "link": "https://stackoverflow.com/users/11370366/pex-van-nieuwburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 56363019, "answer_count": 2, "score": 1, "last_activity_date": 1559140388, "creation_date": 1559132551, "question_id": 56360552, "link": "https://stackoverflow.com/questions/56360552/fill-out-empty-spaces-with-underscore", "title": "Fill out empty spaces with underscore", "body": "<p>I have a telegram that i have to send to the PLC, 1 substring of that telegram provides the barcodeID. It has 6 spaces and it starts with 1 and it is counting up.</p>\n\n<p>For the PLC to work i have to fill up to empty spots wit an underscore. F.E.</p>\n\n<p>_____1<br>\n____22<br>\n___333   </p>\n\n<p>Is there a way i can fix this?</p>\n\n<p>I know that i can fill up the empty spaces with zero's like this: %06d</p>\n\n<p>000001<br>\n000022<br>\n000333   </p>\n\n<pre><code>gLog.LogPrintf(Info, \"customerlog\", \"Storage Out Ready: %02d%02d%02d%s%04d%010d%02d%010d%010d%06d%06d%06d%06d%06d%06d%010d\",\n        (*inMessage)[\"sender\"].asInt(), (*inMessage)[\"reciever\"].asInt(), (*inMessage)[\"series\"].asInt(), (*inMessage)[\"type\"].asString().c_str(),\n        (*inMessage)[\"command\"].asInt(), (*inMessage)[\"id\"].asInt(), (*inMessage)[\"priority\"].asInt(), (*inMessage)[\"source\"].asInt(),\n        (*inMessage)[\"target\"].asInt(), (*inMessage)[\"height\"].asInt(), (*inMessage)[\"width\"].asInt(), (*inMessage)[\"length\"].asInt(),\n        (*inMessage)[\"weight\"].asInt(), (*inMessage)[\"status\"].asInt(), (*inMessage)[\"error\"].asInt(), (*inMessage)[\"data\"].asInt());\n        gLog.LogPrintf(Info, \"Barcode ID: \", (*inMessage)[\"id\"].asCString());\n        gLog.LogPrintf(Info, \"error: \", (*inMessage)[\"error\"].asInt());\n</code></pre>\n"}, {"tags": ["c++", "arrays", "for-loop"], "comments": [{"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1559132972, "post_id": 56360537, "comment_id": 99324626, "body": "I afraid you cannot do that in that way. Your <code>int odd[]</code> array is not dynamic one. You should use rather STL containers, or know the size of <code>odd</code> and <code>even</code> arrays at compile time."}, {"owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1559133607, "post_id": 56360537, "comment_id": 99325025, "body": "The size of an array on the stack needs to be known at compile time, otherwise, the compiler doesn&#39;t know how much space it needs to allocate."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559137454, "post_id": 56360537, "comment_id": 99327433, "body": "Please expand on &quot;I get stuck&quot;. What specific problem do you encounter?"}], "answers": [{"tags": [], "owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "is_accepted": false, "score": 0, "last_activity_date": 1559134543, "creation_date": 1559134543, "answer_id": 56361211, "question_id": 56360537, "link": "https://stackoverflow.com/questions/56360537/how-to-input-values-into-already-defined-arrays/56361211#56361211", "title": "How to input values into already defined arrays?", "body": "<p>You need to have a dynamic array for <code>odd</code> and <code>even</code>.<br/>Moreover you made a mistake, if the modulo equals zero, the number is even and not odd. And you want to add <code>input[n]</code> and not <code>n</code>.</p>\n\n<p>I think you should use STL containers instead of raw arrays, it will make it easier.</p>\n\n<p>You can do as follows:</p>\n\n<pre><code>std::array&lt;int, 10&gt; input {0, 1, 2, 3, 4, 5, 6, 7, 8, 9}; // fill the array with anything you want\n\nstd::vector&lt;int&gt; odd, even;\n\nfor(unsigned int n = 0; n &lt; input.size(); ++n)\n{\n    (input[n]%2) ? (odd.push_back(input[n])) : (even.push_back(input[n]));\n}\n</code></pre>\n\n<p>You can replace the ternary conditional operator <code>condition ? action_if_true : action_if_false</code> by:</p>\n\n<pre><code>if(input[n]%2)\n    odd.push_back(input[n]);\nelse\n    even.push_back(input[n]);\n</code></pre>\n\n<p>I hope it can help.</p>\n"}, {"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559137672, "post_id": 56361918, "comment_id": 99327582, "body": "&quot;neither initialize them with a variable like beginners could naively think (with a syntax like int odd[n])&quot; this is either wrong or misleading, at least unclear. Nothing wrong with <code>int odd[n];</code> as long as <code>n</code> is a compile time constant"}, {"owner": {"reputation": 473, "user_id": 11502610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf986a3bd7cf5ca22ae39a8fbabfe0b?s=128&d=identicon&r=PG&f=1", "display_name": "DrosvarG", "link": "https://stackoverflow.com/users/11502610/drosvarg"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559138458, "post_id": 56361918, "comment_id": 99328112, "body": "@formerlyknownas_463035818 As far as i know, and as specified in <a href=\"https://stackoverflow.com/a/15013295/11502610\">this topic</a>, <code>int odd[n];</code> is not valid in proper C++ if <code>n</code> is a variable. Though, this same link explain different methods to initialize an array with a variable. But I don&#39;t think that one of them is consistant in our case"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1559138572, "post_id": 56361918, "comment_id": 99328178, "body": "&quot;variables&quot; are commonly also called &quot;variables&quot; when they are actually constants. <code>const size_t n = 10; int odd[n];</code> is perfertcly fine, what you refer to i guess is <code>int n = 10; int odd[n];</code> which is not standard c++"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559138691, "post_id": 56361918, "comment_id": 99328255, "body": "dont get me wrong, I am just nitpicking, specifically about the &quot;with a syntax like int odd[n]&quot; because with the syntax there is definitely nothing wrong"}, {"owner": {"reputation": 473, "user_id": 11502610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf986a3bd7cf5ca22ae39a8fbabfe0b?s=128&d=identicon&r=PG&f=1", "display_name": "DrosvarG", "link": "https://stackoverflow.com/users/11502610/drosvarg"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559139365, "post_id": 56361918, "comment_id": 99328660, "body": "@formerlyknownas_463035818 This is exactly what I refer to, but I don&#39;t know how to explain it better. Feel free to edit if you think this make my answer too unclear"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1559140983, "post_id": 56361918, "comment_id": 99329637, "body": "edited, I dont think it made the whole question &quot;too unclear&quot;, though it was adding a bit of confusion already at the beginning of the answer, so I thought it is worth a fix"}], "tags": [], "owner": {"reputation": 473, "user_id": 11502610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf986a3bd7cf5ca22ae39a8fbabfe0b?s=128&d=identicon&r=PG&f=1", "display_name": "DrosvarG", "link": "https://stackoverflow.com/users/11502610/drosvarg"}, "is_accepted": false, "score": 1, "last_activity_date": 1559140864, "last_edit_date": 1559140864, "creation_date": 1559136971, "answer_id": 56361918, "question_id": 56360537, "link": "https://stackoverflow.com/questions/56360537/how-to-input-values-into-already-defined-arrays/56361918#56361918", "title": "How to input values into already defined arrays?", "body": "<p>As vahancho said in a comment, both <code>odd[]</code> and <code>even[]</code> are static arrays. That means once created you can't change the size of any of them. Moreover, when declaring the array, the size cannot be \"dynamic\", ie <code>int odd[n];</code> is only valid when <code>n</code> is a compile time constant (note that some compiler offer it as extension but it is not standard c++).</p>\n\n<p>So here we get a bit stuck, and most would consider using the usual <code>std::vector</code> which have a variable size. \nUnfortunately, you specified \"Use arrays\" in your question. Erf, back to square one.</p>\n\n<p>Let's think a little bit and remember that arrays can be seen as pointers. In the following image, we define an array <code>arr[5]</code>. Then <code>arr</code> is a pointer to the adress 1000, the first value of your array : <a href=\"https://i.stack.imgur.com/BeqB3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BeqB3.jpg\" alt=\"\"></a></p>\n\n<p>Spoiler alert : You can create a dynamic array with this property.\nOk, so let's define a pointer for our two arrays of odd and even numbers and let's declare their associated size: </p>\n\n<pre><code>int * odd_array = NULL;\nint * even_array = NULL;\n\nint odd_array_size = 0, even_array_size = 0;\n</code></pre>\n\n<p>Now, the idea is to increase the size of the good array when we find an odd or even number and use the C function <code>void* realloc(void* ptr, size_t size)</code> offered by <code>&lt;cstdlib&gt;</code>to increase the size allocated for your array. In your case you probably want to do that as you are looping over your <code>input</code> array. Here is an exemple of what you can have in your case : </p>\n\n<pre><code>for (int n = 0; n &lt; 10; n++)\n{\n    if ((input_array[n]) % 2 != 0) // We find an odd number\n    {\n        odd_array_size++; // Increase the size of the array\n        odd_array = (int*)realloc(odd_array, odd_array_size * sizeof(int)); // Reallocate more memory\n        odd_array[odd_array_size-1] = input_array[n]; // Add the value in your new allocated memory\n    }\n    else\n    {\n        // Same here, but in the case of an even number\n        even_array_size++;\n        even_array = (int*)realloc(even_array, even_array_size * sizeof(int));\n        even_array[even_array_size-1] = input_array[n];\n    }\n}\n</code></pre>\n\n<p>With this, you get your two arrays <code>odd_array</code> and <code>even_array</code>, filled respectively with the odd and even numbers of your <code>input_array</code>, which both have their associated size <code>odd_array_size</code> and <code>even_array_size</code></p>\n\n<p>This is basically a C way to do this. You may probably consider smart pointers (in order to be safe with freeing the memory) and, if you were allowed, <code>std::vectors</code> which are the best way to deal with this problem. So don't forget to free your two arrays at the end of your program if you use this.</p>\n\n<p>I hope this will be helpful and clear, don't hesitate to ask me clarifications in comment if needed.</p>\n"}, {"comments": [{"owner": {"reputation": 473, "user_id": 11502610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf986a3bd7cf5ca22ae39a8fbabfe0b?s=128&d=identicon&r=PG&f=1", "display_name": "DrosvarG", "link": "https://stackoverflow.com/users/11502610/drosvarg"}, "edited": false, "score": 0, "creation_date": 1559139246, "post_id": 56362023, "comment_id": 99328612, "body": "What if the user need to give an input of thousands of values ? What I mean is, this works well in our scenario, with a known input of fixed size, but can your solution be adapted to a more generic scenario (like unknown input size for example). And can&#39;t the &quot;wasted&quot; memory be a problem if we need a larger array ?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 473, "user_id": 11502610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf986a3bd7cf5ca22ae39a8fbabfe0b?s=128&d=identicon&r=PG&f=1", "display_name": "DrosvarG", "link": "https://stackoverflow.com/users/11502610/drosvarg"}, "edited": false, "score": 1, "creation_date": 1559139926, "post_id": 56362023, "comment_id": 99328979, "body": "@DrosvarG Yes, it can, but the OP said 10."}, {"owner": {"reputation": 101, "user_id": 11449597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCBus.jpg?s=128&g=1", "display_name": "nocomment", "link": "https://stackoverflow.com/users/11449597/nocomment"}, "edited": false, "score": 0, "creation_date": 1559477592, "post_id": 56362023, "comment_id": 99425954, "body": "@LightnessRacesinOrbit Thank you for the solution, it helped me solve the problem. However, I&#39;d like to know whether the problem could be solved using similar noncomplex methods for values that are larger and by which we don&#39;t waste the memory of the array, as DrosvarG pointed out. Thanks in advance."}, {"owner": {"reputation": 101, "user_id": 11449597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCBus.jpg?s=128&g=1", "display_name": "nocomment", "link": "https://stackoverflow.com/users/11449597/nocomment"}, "edited": false, "score": 0, "creation_date": 1559477775, "post_id": 56362023, "comment_id": 99425983, "body": "@LightnessRacesinOrbit Also, in the very problem example, do the new arrays, odd and even, allocate values straight to index of 1, instead of 0, given that value of countOdd and countEven is set to 0 and has an increment of 1 in the if loop?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 101, "user_id": 11449597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCBus.jpg?s=128&g=1", "display_name": "nocomment", "link": "https://stackoverflow.com/users/11449597/nocomment"}, "edited": false, "score": 0, "creation_date": 1559521212, "post_id": 56362023, "comment_id": 99435258, "body": "@nocomment No, it&#39;s a post-increment, so <code>0</code> comes first"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 3, "last_activity_date": 1559137641, "last_edit_date": 1559137641, "creation_date": 1559137309, "answer_id": 56362023, "question_id": 56360537, "link": "https://stackoverflow.com/questions/56360537/how-to-input-values-into-already-defined-arrays/56362023#56362023", "title": "How to input values into already defined arrays?", "body": "<p>You don't need dynamic allocation for this. We can just make two arrays and fill them as needed.</p>\n\n<pre><code>static constexpr std::size_t N = 10;\nconst int input[N] = { /* user input here */ };\n\nint odd[N] = {};\nint even[N] = {};\n\nstd::size_t countOdd = 0;\nstd::size_t countEven = 0;\n\nfor (std::size_t i = 0; i &lt; N; i++)\n{\n    if (input[i] % 2 == 0)\n       even[countEven++] = input[i];\n    else\n       odd[countOdd++] = input[i];\n}\n</code></pre>\n\n<p>There will be exactly <code>N</code> (10) elements \"wasted\" at the end of <code>odd</code> and <code>even</code> in total (with some unknown distribution), but who cares? Ten automatic-storage <code>int</code>s! That's nothing. \ud83d\ude0a As long as we keep track of how many odds and how many evens we \"care about\", everything's fine.</p>\n\n<p>Now for the two-row output:</p>\n\n<pre><code>for (std::size_t i = 0; i &lt; countOdd; i++)\n    std::cout &lt;&lt; odd[i] &lt;&lt; ' ';\nstd::cout &lt;&lt; '\\n';\n\nfor (std::size_t i = 0; i &lt; countEven; i++)\n    std::cout &lt;&lt; even[i] &lt;&lt; ' ';\nstd::cout &lt;&lt; '\\n';\n</code></pre>\n\n<p>Easy!</p>\n\n<p>I used <code>std::size_t</code> where appropriate for array indices, rather than <code>int</code>, but you could ignore that for now if you like. I also fixed your modulo operation, and you were storing the indices of the even/odd values, not the values themselves.</p>\n\n<hr>\n\n<p>Full program example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstddef&gt;  // for std::size_t\n\nint main()\n{\n    static constexpr std::size_t N = 10;\n    const int input[N] = { 1,5,9,14,3,99,82,42,43,70};\n\n    int odd[N] = {};\n    int even[N] = {};\n\n    std::size_t countOdd = 0;\n    std::size_t countEven = 0;\n\n    for (std::size_t i = 0; i &lt; N; i++)\n    {\n        if (input[i] % 2 == 0)\n           even[countEven++] = input[i];\n        else\n           odd[countOdd++] = input[i];\n    }\n\n    for (std::size_t i = 0; i &lt; countOdd; i++)\n        std::cout &lt;&lt; odd[i] &lt;&lt; ' ';\n    std::cout &lt;&lt; '\\n';\n\n    for (std::size_t i = 0; i &lt; countEven; i++)\n        std::cout &lt;&lt; even[i] &lt;&lt; ' ';\n    std::cout &lt;&lt; '\\n';\n}\n\n// g++ -std=c++17 -O2 -Wall -pedantic -pthread main.cpp &amp;&amp; ./a.out\n// 1 5 9 3 99 43 \n// 14 82 42 70 \n</code></pre>\n\n<h3>(<a href=\"https://coliru.stacked-crooked.com/a/c8778909f6c0ff86\" rel=\"nofollow noreferrer\">live demo</a>)</h3>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 11449597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCBus.jpg?s=128&g=1", "display_name": "nocomment", "link": "https://stackoverflow.com/users/11449597/nocomment"}, "edited": false, "score": 0, "creation_date": 1559477068, "post_id": 56362155, "comment_id": 99425857, "body": "Thank you for your reply. Would you be able to go into more detail or exemplify the mentioned above, as I am a beginner and do not quite understand it?"}], "tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": false, "score": 2, "last_activity_date": 1559137733, "creation_date": 1559137733, "answer_id": 56362155, "question_id": 56360537, "link": "https://stackoverflow.com/questions/56360537/how-to-input-values-into-already-defined-arrays/56362155#56362155", "title": "How to input values into already defined arrays?", "body": "<p>A nice trick to avoid dynamic allocation or any additional storage is to partition the set.  This appears in algorithms such as quicksort, so every computer scientist should learn it.</p>\n\n<p>All you have to do is start with two indexes or pointers, one moving forward and one backward.  As long as an item is in the correct partition, move the pointer past it.  Once both pointers have found elements in the wrong partition, swap them and continue.  Once the pointers converge, the partition is complete.</p>\n\n<p>Or, if you want to leave the input unchanged, this allows you to do a single allocation equal to the size of the entire input, without reallocation or moving already-processed items to a new buffer.</p>\n"}], "owner": {"reputation": 101, "user_id": 11449597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCBus.jpg?s=128&g=1", "display_name": "nocomment", "link": "https://stackoverflow.com/users/11449597/nocomment"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 56362023, "answer_count": 4, "score": 0, "last_activity_date": 1559140864, "creation_date": 1559132507, "question_id": 56360537, "link": "https://stackoverflow.com/questions/56360537/how-to-input-values-into-already-defined-arrays", "title": "How to input values into already defined arrays?", "body": "<p><strong>Write a program which outputs 10 given numbers into two rows, one for odd and one for even numbers. Use arrays.</strong></p>\n\n<p>After declaring an input array for 10 numbers which the user enters, I tried declaring separate arrays for odd and even values which would later be sorted by a for-loop.</p>\n\n<p>I get stuck when I need to assign these values <em>n</em> to odd or even arrays.</p>\n\n<pre><code>int input[10];\nint odd[]{};\nint even[]{};\nint n;\n\nfor(n=0;n&lt;10;n++)\n{\n    if ((input[n])%2==0)\n    {\n      odd[n] = n; \n    }\n    else\n    {\n      even[n] = n;\n    }\n</code></pre>\n"}, {"tags": ["c++", "c", "clang-format"], "comments": [{"owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "edited": false, "score": 11, "creation_date": 1559132569, "post_id": 56360525, "comment_id": 99324345, "body": "But it looks so much better with the space!"}, {"owner": {"reputation": 66, "user_id": 6281987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e3a28b271973f2de77788b43b3d11e7?s=128&d=identicon&r=PG&f=1", "display_name": "peterzuger", "link": "https://stackoverflow.com/users/6281987/peterzuger"}, "reply_to_user": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "edited": false, "score": 2, "creation_date": 1559132665, "post_id": 56360525, "comment_id": 99324426, "body": "I guess that&#39;s personal preference"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 2, "creation_date": 1559132909, "post_id": 56360525, "comment_id": 99324567, "body": "It might just not be in there if it&#39;s not a recognized code style. I tend to see styles adding more types of white space in that gap, not removing it."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559134133, "post_id": 56360525, "comment_id": 99325332, "body": "It might be that no one came up with this awful style before, hence the lack of support."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559144268, "post_id": 56360525, "comment_id": 99331462, "body": "To get that format, you&#39;ll probably need to find an alternative code formatter.  There are many to choose from.  If the one you like doesn&#39;t do what you want, you either suck it up and accept the wisdom of those who wrote it, or you switch to one that does what you want, or you modify the source for the Clang formatter so that it can be configured to do what you want, and then you try to persuade the powers that be that this is a legitimate requirement and that your code is a legitimate solution and that they should accept the change into the code base.  I suspect it may not be accepted."}, {"owner": {"reputation": 121, "user_id": 10977033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b481acf5d5db6290dcf3fa07724541d?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny", "link": "https://stackoverflow.com/users/10977033/jenny"}, "edited": false, "score": 0, "creation_date": 1571865274, "post_id": 56360525, "comment_id": 103385952, "body": "@peterzuger: Have you got this one working?"}, {"owner": {"reputation": 66, "user_id": 6281987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e3a28b271973f2de77788b43b3d11e7?s=128&d=identicon&r=PG&f=1", "display_name": "peterzuger", "link": "https://stackoverflow.com/users/6281987/peterzuger"}, "reply_to_user": {"reputation": 121, "user_id": 10977033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b481acf5d5db6290dcf3fa07724541d?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny", "link": "https://stackoverflow.com/users/10977033/jenny"}, "edited": false, "score": 2, "creation_date": 1571946051, "post_id": 56360525, "comment_id": 103417215, "body": "@Jenny: No so far I have not found anything, I just have a regexp ready to replace all &quot;) {&quot; with &quot;){&quot; and a few others. All code formater&#39;s that I have found do not support this"}], "owner": {"reputation": 66, "user_id": 6281987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e3a28b271973f2de77788b43b3d11e7?s=128&d=identicon&r=PG&f=1", "display_name": "peterzuger", "link": "https://stackoverflow.com/users/6281987/peterzuger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 475, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1586915930, "creation_date": 1559132462, "last_edit_date": 1586915930, "question_id": 56360525, "link": "https://stackoverflow.com/questions/56360525/how-to-create-format-rule-to-get-no-space-before-opening-brace", "title": "How to create format rule to get no space before opening brace?", "body": "<p>I am trying to use clang format to automatically format my code.\nBut there seems to be no option to configure the positon of the opening Brace.</p>\n\n<p>The option <em>BreakBeforeBraces</em> can be used to put the Brace on the next line,\nbut no option to disable the leading space.</p>\n\n<p>I am using clang-format 8.0.0.\nThe <a href=\"http://releases.llvm.org/8.0.0/tools/clang/docs/ClangFormatStyleOptions.html\" rel=\"nofollow noreferrer\">documentation</a> does not seem to contain any info on this.</p>\n\n<p>This is how clang formats code:</p>\n\n<pre><code>class test {\n\n};\n\nint main() {\n    if() {\n        // Here the Space before the if can be configured with:\n        // SpaceBeforeParens: SBPO_Never\n    }\n}\n</code></pre>\n\n<p>This is how I would like it to look:</p>\n\n<pre><code>class test{\n\n};\n\nint main(){\n    if(){\n        // stuff\n    }\n}\n</code></pre>\n\n<p>Is this possible with clang-format ?</p>\n"}, {"tags": ["c++", "pointers"], "comments": [{"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 1, "creation_date": 1559132140, "post_id": 56360367, "comment_id": 99324087, "body": "This <code>g = new Grid();</code> changes the temporary pointer <code>g</code>, and not the original object. That&#39;s why the value of <code>Grid::a</code> remains unchanged. What if you remove this statement: <code>g = new Grid();</code>?"}, {"owner": {"reputation": 177, "user_id": 9558747, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZpvIV218I3s/AAAAAAAAAAI/AAAAAAAADME/VDo12MNNpXM/photo.jpg?sz=128", "display_name": "Sergei Shumilin", "link": "https://stackoverflow.com/users/9558747/sergei-shumilin"}, "reply_to_user": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1559132261, "post_id": 56360367, "comment_id": 99324160, "body": "Thanks! Why is this pointer temporary? and how to deal with it?"}, {"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1559132325, "post_id": 56360367, "comment_id": 99324194, "body": "It&#39;s temporary, as any other function parameter, no matter whether it&#39;s a pointer of a value."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 1, "creation_date": 1559132341, "post_id": 56360367, "comment_id": 99324203, "body": "@vahancho: The word &quot;temporary&quot; isn&#39;t really accurate here. It&#39;s &quot;local&quot;. Also a pointer <i>is</i> a value!"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1559132621, "post_id": 56360367, "comment_id": 99324392, "body": "@vahancho Also please don&#39;t answer in the comments section"}], "answers": [{"comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 1, "creation_date": 1559132492, "post_id": 56360470, "comment_id": 99324293, "body": "You don&#39;t compile"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 1, "creation_date": 1559132507, "post_id": 56360470, "comment_id": 99324304, "body": "@SombreroChicken Neither does your mum"}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1559132738, "post_id": 56360470, "comment_id": 99324467, "body": "But her homemade cookies are quite delicious."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1559132767, "post_id": 56360470, "comment_id": 99324486, "body": "@SombreroChicken Biscuits!"}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1559132943, "post_id": 56360470, "comment_id": 99324596, "body": "SaMe Difference. Colour <i>color</i> <b>flavour</b> flavor swim swam swum mum mom HELPME"}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1559133536, "post_id": 56360470, "comment_id": 99324981, "body": "Ok so I want to apologise, it wasn&#39;t crashing due to your code but I think my desktops microchip is faulty."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1559133636, "post_id": 56360470, "comment_id": 99325043, "body": "@SombreroChicken Classic \ud83e\udd23"}, {"owner": {"reputation": 177, "user_id": 9558747, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZpvIV218I3s/AAAAAAAAAAI/AAAAAAAADME/VDo12MNNpXM/photo.jpg?sz=128", "display_name": "Sergei Shumilin", "link": "https://stackoverflow.com/users/9558747/sergei-shumilin"}, "edited": false, "score": 0, "creation_date": 1559133863, "post_id": 56360470, "comment_id": 99325186, "body": "But what if I obtain the results for constructor only inside func1? That is I can avoid creating an object inside func1?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 177, "user_id": 9558747, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZpvIV218I3s/AAAAAAAAAAI/AAAAAAAADME/VDo12MNNpXM/photo.jpg?sz=128", "display_name": "Sergei Shumilin", "link": "https://stackoverflow.com/users/9558747/sergei-shumilin"}, "edited": false, "score": 0, "creation_date": 1559134592, "post_id": 56360470, "comment_id": 99325603, "body": "@SergeiShumilin You could give your class a <code>reset()</code> member function."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 3, "last_activity_date": 1559135061, "last_edit_date": 1559135061, "creation_date": 1559132322, "answer_id": 56360470, "question_id": 56360367, "link": "https://stackoverflow.com/questions/56360367/change-an-object-passed-by-pointer-to-a-function/56360470#56360470", "title": "Change an object passed by pointer to a function", "body": "<p>If you want to use pointers to \"pass by reference\", then just do that:</p>\n\n<pre><code>void\nfunc1 (Grid * g)\n{\n    g-&gt;a = 5;\n}\n\nvoid\nfunc2 (const Grid * g)\n{\n    std::cout &lt;&lt; g-&gt;a &lt;&lt; std::endl;\n}\n\nint\nmain ()\n{\n    Grid g;\n    func1(&amp;g);\n    func2(&amp;g);\n}\n</code></pre>\n\n<p>Currently you're taking a pointer (and remember that the pointer itself is passed by value), then <em>overwriting</em> the locally-scoped copy of that pointer with a pointer to a new, dynamically-allocated <code>Grid</code> object. You set a property on that object then leak it.</p>\n\n<p>In C++ we often use actual references instead, which can be clearer (though perhaps not as clear at the callsite!):</p>\n\n<pre><code>void\nfunc1 (Grid&amp; g)\n{\n    g.a = 5;\n}\n\nvoid\nfunc2 (const Grid&amp; g)\n{\n    std::cout &lt;&lt; g.a &lt;&lt; std::endl;\n}\n\nint\nmain ()\n{\n    Grid g;\n    func1(g);\n    func2(g);\n}\n</code></pre>\n\n<p>As for this bit:</p>\n\n<blockquote>\n  <p>Pass it to a function that calls the constructor of the object's class </p>\n</blockquote>\n\n<p>The object is already constructed. You can copy-assign from a fresh, temporary object if you really want to \"reset\" it in that way:</p>\n\n<pre><code>void\nfunc1 (Grid&amp; g)\n{\n    g = Grid();\n    g.a = 5;\n}\n</code></pre>\n\n<p>But I'd advise reconsidering whether you really want/need to reset the object like this. And, if you do, perhaps a nice <code>reset()</code> member function?</p>\n"}, {"comments": [{"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1559132520, "post_id": 56360483, "comment_id": 99324316, "body": "did you mean to initialize an object here? Like <code>Grid{}</code>?"}, {"owner": {"reputation": 177, "user_id": 9558747, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZpvIV218I3s/AAAAAAAAAAI/AAAAAAAADME/VDo12MNNpXM/photo.jpg?sz=128", "display_name": "Sergei Shumilin", "link": "https://stackoverflow.com/users/9558747/sergei-shumilin"}, "edited": false, "score": 0, "creation_date": 1559133893, "post_id": 56360483, "comment_id": 99325203, "body": "But what if I obtain the results for constructor only inside func1? That is I can avoid creating an object inside func1?"}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "reply_to_user": {"reputation": 177, "user_id": 9558747, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZpvIV218I3s/AAAAAAAAAAI/AAAAAAAADME/VDo12MNNpXM/photo.jpg?sz=128", "display_name": "Sergei Shumilin", "link": "https://stackoverflow.com/users/9558747/sergei-shumilin"}, "edited": false, "score": 1, "creation_date": 1559134858, "post_id": 56360483, "comment_id": 99325771, "body": "@SergeiShumilin When you declare <code>Grid g;</code>, you call the default constructor. So you don&#39;t need to call the constructor inside <code>func1()</code>. But if you want to reset it, you can either call <code>g = Grid();</code> inside <code>func1()</code> or create a <code>reset()</code> member function as @LightnessRacesInOrbit advised to you."}], "tags": [], "owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "is_accepted": false, "score": 1, "last_activity_date": 1559132587, "last_edit_date": 1559132587, "creation_date": 1559132359, "answer_id": 56360483, "question_id": 56360367, "link": "https://stackoverflow.com/questions/56360367/change-an-object-passed-by-pointer-to-a-function/56360483#56360483", "title": "Change an object passed by pointer to a function", "body": "<p>In fact, when you use <code>new</code>, you change the value of the pointer.</p>\n\n<p>But anyway, I think you can do it much more easier. For example:</p>\n\n<pre><code>void func(Grid &amp; g)\n{\n    g.a = 5;\n}\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT:</strong>\nOf course, you have to call <code>func()</code> like this:</p>\n\n<pre><code>Grid gr;\nfunc(gr);\n</code></pre>\n\n<p>I hope it can help;</p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559132392, "post_id": 56360487, "comment_id": 99324234, "body": "I don&#39;t think that hack-casting everything to <code>uint64_t</code> is a good way to understand pointers."}, {"owner": {"reputation": 1300, "user_id": 5696269, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fM9nY4BDuE8/AAAAAAAAAAI/AAAAAAAAAAA/ykOQFUkc6Zg/photo.jpg?sz=128", "display_name": "KaiJ", "link": "https://stackoverflow.com/users/5696269/kaij"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559132441, "post_id": 56360487, "comment_id": 99324263, "body": "I don&#39;t know, it demonstrates that pointers are just numbers like every other variable."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1559132515, "post_id": 56360487, "comment_id": 99324313, "body": "But they&#39;re not."}, {"owner": {"reputation": 1300, "user_id": 5696269, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fM9nY4BDuE8/AAAAAAAAAAI/AAAAAAAAAAA/ykOQFUkc6Zg/photo.jpg?sz=128", "display_name": "KaiJ", "link": "https://stackoverflow.com/users/5696269/kaij"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559132610, "post_id": 56360487, "comment_id": 99324384, "body": "Yes they are, a pointer is a number. That number just so happens to be the memory address of another variable, but it is still fundamentally a number."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1559132660, "post_id": 56360487, "comment_id": 99324420, "body": "No, it is fundamentally a pointer. That they can be represented as numbers is either an implementation detail or an abstraction leak, depending on how you look at it. But pointers are much more restricted than numbers. (Admittedly this is not well-known for some reason.) <i>Pointers are not numbers; they are pointers.</i>"}], "tags": [], "owner": {"reputation": 1300, "user_id": 5696269, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fM9nY4BDuE8/AAAAAAAAAAI/AAAAAAAAAAA/ykOQFUkc6Zg/photo.jpg?sz=128", "display_name": "KaiJ", "link": "https://stackoverflow.com/users/5696269/kaij"}, "is_accepted": false, "score": 1, "last_activity_date": 1559132369, "creation_date": 1559132369, "answer_id": 56360487, "question_id": 56360367, "link": "https://stackoverflow.com/questions/56360367/change-an-object-passed-by-pointer-to-a-function/56360487#56360487", "title": "Change an object passed by pointer to a function", "body": "<p>To help you imagine this, I'm going to write it like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass Grid\n{\n    public:\n        int a;\n\n        Grid()\n        {\n            a = 2;\n        }\n};\n\nvoid func1(uint64_t g);\nvoid func2(uint64_t g);\n\nint\nmain ()\n{\n    Grid g;\n    func1((uint64_t)&amp;g);\n    func2((uint64_t)&amp;g);\n}\n\nvoid\nfunc1 (uint64_t g)\n{\n    g = (uint64_t)new Grid();\n    ((Grid*)g)-&gt;a = 5;\n}\n\nvoid\nfunc2 (uint64_t g)\n{\n    std::cout &lt;&lt; ((Grid*)g)-&gt;a &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>The code above will work exactly the same as the other code (on a 64-bit system). Obviously it is horrific and the code above should never be used, but writing it out like this might help you understand pointers.</p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559134069, "post_id": 56361038, "comment_id": 99325293, "body": "Explain your solution. Also you have a memory leak."}, {"owner": {"reputation": 354, "user_id": 8467526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8314397bd54de94709d208447f42ed?s=128&d=identicon&r=PG&f=1", "display_name": "Saif Faidi", "link": "https://stackoverflow.com/users/8467526/saif-faidi"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559134421, "post_id": 56361038, "comment_id": 99325497, "body": "need just to delete the pointer at the end of the program of course, and adding some protection for memory allocation. but the version using reference still the best solution i think."}], "tags": [], "owner": {"reputation": 354, "user_id": 8467526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8314397bd54de94709d208447f42ed?s=128&d=identicon&r=PG&f=1", "display_name": "Saif Faidi", "link": "https://stackoverflow.com/users/8467526/saif-faidi"}, "is_accepted": false, "score": 3, "last_activity_date": 1559134095, "last_edit_date": 1559134095, "creation_date": 1559134047, "answer_id": 56361038, "question_id": 56360367, "link": "https://stackoverflow.com/questions/56360367/change-an-object-passed-by-pointer-to-a-function/56361038#56361038", "title": "Change an object passed by pointer to a function", "body": "<p>here is another possibility using pointers </p>\n\n<pre><code>Grid *  func1();\nvoid func2(Grid * g);\n\n\nint main ()\n{\n\n    Grid * g = func1();\n    func2(g);\n}\n\n\nGrid * func1 ()\n{\n    Grid * g = new Grid();\n    g-&gt;a = 5;\n    return g;\n}\n\n\nvoid func2 (Grid * g)\n{\n    std::cout &lt;&lt; g-&gt;a &lt;&lt; std::endl;\n}\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 9558747, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZpvIV218I3s/AAAAAAAAAAI/AAAAAAAADME/VDo12MNNpXM/photo.jpg?sz=128", "display_name": "Sergei Shumilin", "link": "https://stackoverflow.com/users/9558747/sergei-shumilin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 56360470, "answer_count": 4, "score": 2, "last_activity_date": 1559135061, "creation_date": 1559131992, "question_id": 56360367, "link": "https://stackoverflow.com/questions/56360367/change-an-object-passed-by-pointer-to-a-function", "title": "Change an object passed by pointer to a function", "body": "<p>I need:</p>\n\n<ol>\n<li><p>Create reference to object.</p></li>\n<li><p>Pass it to a function that calls the constructor of the object's class and make some calculation over the object.</p></li>\n<li><p>Pass the object to another function that also make some stuff with it.</p></li>\n</ol>\n\n<p>My object that goes to the second function is always empty. </p>\n\n<p>I slightly know the difference between stack and heap memory and the use of new operator but can't handle with it. I don't understand why <code>g</code> doesn't change after the func1 is over.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass Grid\n{\n    public:\n        int a;\n\n        Grid()\n        {\n            a = 2;\n        }\n};\n\nvoid func1(Grid * g);\nvoid func2(Grid * g);\n\nint\nmain ()\n{\n    Grid g;\n    func1(&amp;g);\n    func2(&amp;g);\n}\n\nvoid\nfunc1 (Grid * g)\n{\n    g = new Grid();\n    g-&gt;a = 5;\n}\n\nvoid\nfunc2 (Grid * g)\n{\n    std::cout &lt;&lt; g-&gt;a &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>How make the output in the func2 5, cause now it's 2?</p>\n"}, {"tags": ["c++", "variables"], "comments": [{"owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "edited": false, "score": 7, "creation_date": 1559131564, "post_id": 56360181, "comment_id": 99323755, "body": "you want arrays, e.g. <a href=\"https://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\"><code>std::vector</code></a>"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1559132078, "post_id": 56360181, "comment_id": 99324053, "body": "Once you get vectors working put the sort in a function you can call with any vector."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1559137230, "post_id": 56360181, "comment_id": 99327302, "body": "It is not portable to use <code>$</code> in an identifier."}], "owner": {"reputation": 1, "user_id": 11569850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce8932bcb4f1b1adea08779100d85b48?s=128&d=identicon&r=PG&f=1", "display_name": "Oli", "link": "https://stackoverflow.com/users/11569850/oli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586916357, "creation_date": 1559131332, "last_edit_date": 1586916357, "question_id": 56360181, "link": "https://stackoverflow.com/questions/56360181/is-there-a-way-to-create-a-variable-which-includes-a-value-from-a-different-vari", "title": "Is there a way to create a variable which includes a value from a different variable in its name?", "body": "<p>I'm trying to do a basic bubble sort algorithm, which orders numbers from lowest to highest. I have already made one that works, however it requires a new set of variables for every pass, and in order to be able to add an extra input number (there are only 6 at the moment) would take a lot of effort. I want a way for a new variable to be created every time the user enters a number, and that variable to be able to be generated on its own.</p>\n\n<pre><code>using namespace std;\nint Acount = 0;\nint SV = 0;\nint x = 1;\nint main()\n{   \n    cout &lt;&lt; \"Enter first number\\n1: \";\n    int I$Acount;\n    cin &gt;&gt; I$Acount; \n    while (SV == 0)\n    {\n        Acount = Acount + 1;\n        x = x + 1;\n        cout &lt;&lt; \"Enter the next number or Press S to begin sort\\n\"&lt;&lt; x &lt;&lt; \": \";\n        if (_kbhit())\n        {\n            switch (_getch())\n            { \n            case 's':\n                SV = 1;\n            }   \n        }\n        else\n        {\n            SV = 0;\n            cin &gt;&gt; I$Acount;\n        }\n    }\n    cout &lt;&lt; \"DONE\";\n    system(\"pause\");\n}\n</code></pre>\n\n<p>Issues with the code:</p>\n\n<ol>\n<li>The increasing variable function <code>I$Acount</code> does not work (it is supposed to assign values to I0, I1, I2, ext...)</li>\n<li>When the letter S is typed, the while statement loops with increasing value of x, until s is pressed again.</li>\n</ol>\n"}, {"tags": ["c++", "design-patterns", "random", "c++17"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1559130969, "post_id": 56359951, "comment_id": 99323400, "body": "Seems to me that you&#39;re pretty clear on the diraction you should be taking. As food for thought, an interface with a single virtual function can be seen as a functor, so <code>std::function</code>&#39;s type-erasure functionality migh come in handy here."}, {"owner": {"reputation": 812, "user_id": 1141307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a69398c4489fcf24e75479ba8fd6f5f?s=128&d=identicon&r=PG", "display_name": "Amir", "link": "https://stackoverflow.com/users/1141307/amir"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1559131255, "post_id": 56359951, "comment_id": 99323565, "body": "@Quentin I think what I don&#39;t like much about my approach is the amount of adaptors that I need to write for all algorithm. I somehow hope there is a nicer way to achieve this."}], "answers": [{"tags": [], "owner": {"reputation": 1143, "user_id": 2466572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3de0d3fe056a4e5b6285244fd531e4a?s=128&d=identicon&r=PG", "display_name": "k.v.", "link": "https://stackoverflow.com/users/2466572/k-v"}, "is_accepted": false, "score": 5, "last_activity_date": 1559131739, "creation_date": 1559131739, "answer_id": 56360296, "question_id": 56359951, "link": "https://stackoverflow.com/questions/56359951/writing-a-factory-method-for-stl-random-number-generators/56360296#56360296", "title": "Writing a Factory method for STL random number generators", "body": "<p>You described a pretty standard way to deal with this situation - to have abstract <code>RandomGenerator</code> class with just one virtual method <code>gen()</code>.</p>\n\n<p>Then, it will have implementations like <code>NormalDistributionGenerator</code>, <code>UniformDistributionGenerator</code> etc. with constructors accepting appropriate distribution parameter set and initializing STL stuff as members.\nThese concrete classes will be used directly only in generator creation routine, and used in other places as abstract <code>RandomGenerator</code>.</p>\n\n<p>So creation routine will look something like this</p>\n\n<pre><code>std::unique_ptr&lt;RandomGenerator&gt; CreateRandomGenerator(const Info&amp; info) {\n    switch (info.type) {\n    case Type::Normal:\n        return std::make_unique&lt;NormalDistributionGenerator&gt;(info.mean(), info.stddev());\n    case Type::Uniform:\n        return std::make_unique&lt;UniformDistributionGenerator&gt;(info.a(), info.b());\n    // ...\n    }\n}\n</code></pre>\n\n<p><code>Info</code> - is a class which holds distribution info (some JSON wrapper, of map/hash_table - whatever works best in your case).</p>\n\n<p>So you will definitely need to write <em>some</em> boilerplate code to make it work, but it will make a usage of your <code>RandomGenerator</code> simple and clear, and adding new types of distributions will be easy enough and require code modification in single place only - factory method.</p>\n"}, {"comments": [{"owner": {"reputation": 812, "user_id": 1141307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a69398c4489fcf24e75479ba8fd6f5f?s=128&d=identicon&r=PG", "display_name": "Amir", "link": "https://stackoverflow.com/users/1141307/amir"}, "edited": false, "score": 0, "creation_date": 1559134666, "post_id": 56360944, "comment_id": 99325649, "body": "This looks amazing! I think this is what I was looking for but I have to admit I have issue understanding it. I think for the most part, I get the logic behind it but I have a question. Some distributions, e.g., <code>std::piecewise_linear_distribution</code> are using container as they parameters, I wonder how you handle those in your approach. I use nlohmann-json to handle those nicely. My idea was to write a parser to each distribution&#39;s param_type, and read the parameters, then pass them around. But I don&#39;t understand how to do it here. Thanks :-)"}, {"owner": {"reputation": 812, "user_id": 1141307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a69398c4489fcf24e75479ba8fd6f5f?s=128&d=identicon&r=PG", "display_name": "Amir", "link": "https://stackoverflow.com/users/1141307/amir"}, "edited": false, "score": 0, "creation_date": 1559135053, "post_id": 56360944, "comment_id": 99325916, "body": "I think removing <code>std::stod</code> will do, since nlohmann&#39;s json library uses the same syntax, and does the conversion to stl types, ... but I&#39;m asking since I don&#39;t fully understand the code for <code>generate_dis....</code> part."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 812, "user_id": 1141307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a69398c4489fcf24e75479ba8fd6f5f?s=128&d=identicon&r=PG", "display_name": "Amir", "link": "https://stackoverflow.com/users/1141307/amir"}, "edited": false, "score": 0, "creation_date": 1559135090, "post_id": 56360944, "comment_id": 99325945, "body": "@Amir ... dammit! You using nlohmann-json is great news, since it does have the auto-converting plumbing all set up -- you can simply remove <code>std::stod()</code> from <code>make_distribution_impl</code> and the magic conversions will kick in for the simple cases. <code>std::piecewise_linear_distribution</code> is kind of a chore though, since it takes iterators... The simplest solution is just to not declare it through the macro, but add a separate branch to handle it inside <code>make_distribution</code>."}, {"owner": {"reputation": 812, "user_id": 1141307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a69398c4489fcf24e75479ba8fd6f5f?s=128&d=identicon&r=PG", "display_name": "Amir", "link": "https://stackoverflow.com/users/1141307/amir"}, "edited": false, "score": 0, "creation_date": 1559135287, "post_id": 56360944, "comment_id": 99326067, "body": "I&#39;m following but not fully honestly. I get what the macro does, and understand how to expand it but I don&#39;t know what I should to support the <code>std::piecewise_linear_distribution</code> outside to it :\\"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 812, "user_id": 1141307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a69398c4489fcf24e75479ba8fd6f5f?s=128&d=identicon&r=PG", "display_name": "Amir", "link": "https://stackoverflow.com/users/1141307/amir"}, "edited": false, "score": 0, "creation_date": 1559135366, "post_id": 56360944, "comment_id": 99326110, "body": "That should be no more than <code>if(distributionName == &quot;piecewise_linear_distribution &quot;) { &#47;* read in values, handle errors *&#47; return std::piecewise_linear_distribution&lt;double&gt;{ &#47;* what you just parsed *&#47; }; }</code>"}, {"owner": {"reputation": 812, "user_id": 1141307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a69398c4489fcf24e75479ba8fd6f5f?s=128&d=identicon&r=PG", "display_name": "Amir", "link": "https://stackoverflow.com/users/1141307/amir"}, "edited": false, "score": 0, "creation_date": 1559135509, "post_id": 56360944, "comment_id": 99326198, "body": "I&#39;ll try to see if I can make it to work :-) I think I see what I should do. Thanks a lot..."}, {"owner": {"reputation": 812, "user_id": 1141307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a69398c4489fcf24e75479ba8fd6f5f?s=128&d=identicon&r=PG", "display_name": "Amir", "link": "https://stackoverflow.com/users/1141307/amir"}, "edited": false, "score": 0, "creation_date": 1559137061, "post_id": 56360944, "comment_id": 99327200, "body": "I think I got it, but I&#39;m not gonna lie, I&#39;m having a headache after reading and understanding your code. It was another level for me :D But I now have a reason to learn these stuff more."}, {"owner": {"reputation": 812, "user_id": 1141307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a69398c4489fcf24e75479ba8fd6f5f?s=128&d=identicon&r=PG", "display_name": "Amir", "link": "https://stackoverflow.com/users/1141307/amir"}, "edited": false, "score": 0, "creation_date": 1559304774, "post_id": 56360944, "comment_id": 99388227, "body": "I managed to get all distributions except the <code>bernoulli_distribution</code> and <code>discrete_distribution</code>! I changed the macro to this, <code>#define generate_distribution_factory(name_, type_, ...)\\ if(distributionName == #name_) return make_distribution_impl&lt;std::name_&lt;type_&gt;&gt;(j, ## __VA_ARGS__);</code> so that I can specify the type, and be more flexible. However, this doesn&#39;t help with the <code>bool</code> for some reason! I wonder if you have any idea about this?"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 812, "user_id": 1141307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a69398c4489fcf24e75479ba8fd6f5f?s=128&d=identicon&r=PG", "display_name": "Amir", "link": "https://stackoverflow.com/users/1141307/amir"}, "edited": false, "score": 0, "creation_date": 1559310637, "post_id": 56360944, "comment_id": 99391188, "body": "Ah, <code>bernoulli_distribution</code> is the only distributioin that&#39;s not a template... What a tour! I&#39;ve made it work by lifting the <code>&lt;&gt;</code> pair into the macro argument as well: <code>#define generate_distribution_factory(name_, suffix_, ...) if(distributionName == #name_) return make_distribution_impl&lt;std::name_ suffix_&gt;(json, ## __VA_ARGS__)</code>, called as <code>generate_distribution_factory(bernoulli_distribution, &#47;* empty *&#47;, &quot;p&quot;);</code>; but you could also just special-case it. I&#39;m not sure how you&#39;re stuck with <code>discrete_distribution</code> nor which <code>bool</code> you&#39;re talking about, though."}], "tags": [], "owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "is_accepted": true, "score": 2, "last_activity_date": 1559133757, "creation_date": 1559133757, "answer_id": 56360944, "question_id": 56359951, "link": "https://stackoverflow.com/questions/56359951/writing-a-factory-method-for-stl-random-number-generators/56360944#56360944", "title": "Writing a Factory method for STL random number generators", "body": "<p>I've tried to keep the boilerplate to a bare minimum. Assumptions:</p>\n\n<ul>\n<li><p>You know the type of your generator in advance (that's easily switchable if you need your generators to be dynamic as well)</p></li>\n<li><p>All of the distributions generate <code>double</code>s (that's pretty much baked in since the API has to return <em>something</em> concrete to be decently usable)</p></li>\n<li><p>All of the distributions are constructible from <code>double</code> parameters (that's tweakable as well with a proxy object, but depending on your actual JSON library the work may already be done there)</p></li>\n<li><p>I've used a GCC preprocessor extension to handle the zero-parameter case, but the macro can certainly be rewritten to not need it.</p></li>\n</ul>\n\n\n\n<pre><code>using Generator = std::mt19937;\nusing Distribution = std::function&lt;double(Generator &amp;)&gt;;\nusing Json = std::map&lt;std::string, std::string&gt;;\n\ntemplate &lt;class DistributionType, class... Parameters&gt;\nDistribution make_distribution_impl(Json const &amp;json, Parameters... parameters) {\n    return DistributionType{std::stod(json.at(parameters))...};\n}\n\nDistribution make_distribution(Json const &amp;json) {\n    auto const &amp;distributionName = json.at(\"dist\");\n\n    #define generate_distribution_factory(name_, ...) \\\n        if(distributionName == #name_) \\\n            return make_distribution_impl&lt;std::name_&lt;double&gt;&gt;(json, ## __VA_ARGS__)\n\n    generate_distribution_factory(uniform_real_distribution, \"a\", \"b\");\n    generate_distribution_factory(normal_distribution, \"mean\", \"stddev\");\n    // ...\n\n    #undef generate_distribution_factory\n\n    throw std::runtime_error{\"Unknown distribution \" + distributionName};\n}\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/OQXo3qvRPvAbh4Xg\" rel=\"nofollow noreferrer\">See it live on Wandbox</a></p>\n"}], "owner": {"reputation": 812, "user_id": 1141307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a69398c4489fcf24e75479ba8fd6f5f?s=128&d=identicon&r=PG", "display_name": "Amir", "link": "https://stackoverflow.com/users/1141307/amir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 1, "accepted_answer_id": 56360944, "answer_count": 2, "score": 3, "last_activity_date": 1559133757, "creation_date": 1559130559, "question_id": 56359951, "link": "https://stackoverflow.com/questions/56359951/writing-a-factory-method-for-stl-random-number-generators", "title": "Writing a Factory method for STL random number generators", "body": "<p>I'm trying to provide an interface \u2014 through a config file \u2014\u00a0for my users to choose a distribution for some of the parameters that they are using. I would like to use STL random number generator algorithms for this purpose.</p>\n\n<p>Let's assume that my program reads a JSON from a command line. For the JSON provided below, the program needs to realize that it should generate a random number from the normal distribution with given mean and standard variation. (I'm using the same parameter names as STL library for clearance.)</p>\n\n<pre><code>{\n    \"dist\": \"normal_distribution\",\n    \"mean\": 0.1,\n    \"stddev\": 0.5\n}\n</code></pre>\n\n<p>So far, I can parse the JSON easily, and use each distribution's <code>param_type</code> to initialize the distribution. I use the name to decide which distribution to decide the <code>param_type</code> and the distribution. </p>\n\n<p>What I don't know is how to implement this nicely. I know that I should provide some sort of factory method for this, pass the JSON, and spit out a function or a class. If I want to return an instance of a class, let's say a <code>unique_ptr</code> of the generator, I need to define an abstract class, e.g., <code>RandDist</code> and write some sort of adaptor to incorporate my input, .... I generally don't need a lot from the class, just a <code>gen()</code> method should be enough.</p>\n\n<p>I'm wondering if anyone have thoughts on this. Or, if anyone knows a library that can do this.</p>\n\n<p>P.S. Input doesn't have to be a JSON object, any hash table would work per se.</p>\n"}, {"tags": ["c++", "qt", "ssl", "gsoap"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 2400944, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ox8c6.jpg?s=128&g=1", "display_name": "Amirhosein Seddighi", "link": "https://stackoverflow.com/users/2400944/amirhosein-seddighi"}, "is_accepted": false, "score": 0, "last_activity_date": 1559457745, "creation_date": 1559457745, "answer_id": 56412753, "question_id": 56359739, "link": "https://stackoverflow.com/questions/56359739/segmentation-fault-in-gsoap-when-use-inheritance-in-soap-ssl-server-context/56412753#56412753", "title": "Segmentation fault in gsoap when use inheritance in soap_ssl_server_context(...)", "body": "<p>Unfortunately, after I convert my Gsoap service to use SSL, I didn't remove libgsoap++ and append libgsoapssl++. So the application crashed :|</p>\n"}], "owner": {"reputation": 1, "user_id": 2400944, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ox8c6.jpg?s=128&g=1", "display_name": "Amirhosein Seddighi", "link": "https://stackoverflow.com/users/2400944/amirhosein-seddighi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559457745, "creation_date": 1559129913, "question_id": 56359739, "link": "https://stackoverflow.com/questions/56359739/segmentation-fault-in-gsoap-when-use-inheritance-in-soap-ssl-server-context", "title": "Segmentation fault in gsoap when use inheritance in soap_ssl_server_context(...)", "body": "<p>I have set up a gsoap web service and it works. I need to use SSL. I follow steps as mention in the following link :\n<a href=\"https://www.genivia.com/doc/guide/html/index.html#serveropenssl\" rel=\"nofollow noreferrer\">https://www.genivia.com/doc/guide/html/index.html#serveropenssl</a>\nand my program is crashed :(</p>\n\n<p>Soap files are generated with 'soapcpp2 -i' switch that inherits from soap class.</p>\n\n<p>My QT .pro file:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>...\nLIBS += -lgsoapssl++ -lssl -lcrypto\nQMAKE_CXXFLAGS += -DWITH_OPENSSL\n...\n</code></pre>\n\n<p>And finally, my program was crashed at following function \"soap_ssl_server_context\" even with NULL parameter for all arguments.</p>\n\n<pre><code>  if (soap_ssl_server_context(soap, \n    SOAP_SSL_DEFAULT, \n    \"server.pem\",      /* keyfile: required when server must authenticate to clients (see SSL docs on how to obtain this file) */ \n    \"password\",        /* password to read the key file (not used with GNUTLS) */ \n    \"cacert.pem\",      /* optional cacert file to store trusted certificates */ \n    NULL,              /* optional capath to directory with trusted certificates */ \n    \"dh512.pem\",       /* DH file name or DH key len bits (minimum is 512, e.g. \"512\") to generate DH param, if NULL use RSA */ \n    NULL,              /* if randfile!=NULL: use a file with random data to seed randomness */  \n    NULL               /* optional server identification to enable SSL session caching to speed up TLS (must be a unique name) */\n  )) \n  {\n    soap_print_fault(soap, stderr); \n    exit(EXIT_FAILURE); \n  } \n</code></pre>\n"}, {"tags": ["c++", "c++14"], "answers": [{"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559131655, "post_id": 56359899, "comment_id": 99323815, "body": "Indeed, this is the very reason <code>try_emplace</code> was added."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 2, "last_activity_date": 1559130391, "creation_date": 1559130391, "answer_id": 56359899, "question_id": 56359720, "link": "https://stackoverflow.com/questions/56359720/avoid-double-search-or-unecessary-construction-with-stdunordered-map-and-othe/56359899#56359899", "title": "Avoid double search or unecessary construction with std::unordered_map (and others)", "body": "<blockquote>\n  <p>Is my assumption correct that I have to decide on this trade-off until C++17?</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<p>Or, you can use a container outside of the standard library that supports a <code>try_emplace</code> operation or equivalent.</p>\n"}], "owner": {"reputation": 415, "user_id": 1590596, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/71e8f2ed5f3111f984a4452897d05705?s=128&d=identicon&r=PG", "display_name": "nunojpg", "link": "https://stackoverflow.com/users/1590596/nunojpg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 1, "accepted_answer_id": 56359899, "answer_count": 1, "score": 4, "last_activity_date": 1559148087, "creation_date": 1559129846, "last_edit_date": 1592644375, "question_id": 56359720, "link": "https://stackoverflow.com/questions/56359720/avoid-double-search-or-unecessary-construction-with-stdunordered-map-and-othe", "title": "Avoid double search or unecessary construction with std::unordered_map (and others)", "body": "<p>I would like to find a element with a key on a <code>std::unordered_map</code>, or insert it if it does not yet exist.</p>\n<p>From <a href=\"https://en.cppreference.com/w/cpp/container/unordered_map/emplace\" rel=\"nofollow noreferrer\">cppreference.com</a>:</p>\n<blockquote>\n<p>std::unordered_map::emplace</p>\n<p>Inserts a new element into the container constructed in-place with the given args if there is no element with the key in the container.</p>\n<p>...</p>\n<p>The element may be constructed even if there already is an element with the key in the container, in which case the newly constructed element will be destroyed immediately.</p>\n<p>...</p>\n<p>Returns a pair consisting of an iterator to the inserted element, or the already-existing element if no insertion happened, and a bool denoting whether the insertion took place. True for Insertion, False for No Insertion.</p>\n</blockquote>\n<p>I've tested it, for my environments, and it actually constructs the element even if the same key already exists.</p>\n<p>This can be a major performance issue.</p>\n<p>From c++17 there is <code>try_emplace</code> that avoids this construction if insertion does not take place.</p>\n<p>I'm limited to c++14 and after looking around I find two alternatives for the same behavior:</p>\n<ul>\n<li><p>use <code>std::unordered_map::find</code> first, and if the element does not exist then use <code>std::unordered_map::emplace</code>. If <strong>key does not exist</strong> I pay for a <strong>redundant container search</strong>.</p>\n</li>\n<li><p>use <code>std::unordered_map::emplace</code>. If <strong>key exist</strong> I pay for a <strong>unnecessary object construction and destruction</strong>.</p>\n</li>\n</ul>\n<p>Is my assumption correct that I have to decide on this trade-off until C++17?</p>\n"}, {"tags": ["c++", "winsock", "winsock2"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11572473, "user_type": "registered", "profile_image": "https://graph.facebook.com/2324880024241469/picture?type=large", "display_name": "Jaden DeFields", "link": "https://stackoverflow.com/users/11572473/jaden-defields"}, "edited": false, "score": 0, "creation_date": 1559132769, "post_id": 56359990, "comment_id": 99324489, "body": "That fixed it. I moved the FD_SET function to inside the loop and it does work. Thank you!"}], "tags": [], "owner": {"reputation": 4462, "user_id": 147763, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5523105def6892e8d9427fb5c13af04e?s=128&d=identicon&r=PG", "display_name": "Paolo Brandoli", "link": "https://stackoverflow.com/users/147763/paolo-brandoli"}, "is_accepted": true, "score": 1, "last_activity_date": 1559130768, "creation_date": 1559130768, "answer_id": 56359990, "question_id": 56359563, "link": "https://stackoverflow.com/questions/56359563/winsock2-select-function-giving-invalid-arguement-error-error-10022/56359990#56359990", "title": "Winsock2: select() function giving &quot;invalid arguement error&quot; (Error 10022)?", "body": "<p>When select returns 0 then the content of the structure readfds is also set to zero (select modifies it to indicate which socket is ready).</p>\n\n<p>When the outer loop executes again then the readfds structure does not contain any socket to check, which causes the error. You should set again the socket in readfds.</p>\n"}], "owner": {"reputation": 13, "user_id": 11572473, "user_type": "registered", "profile_image": "https://graph.facebook.com/2324880024241469/picture?type=large", "display_name": "Jaden DeFields", "link": "https://stackoverflow.com/users/11572473/jaden-defields"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 56359990, "answer_count": 1, "score": 1, "last_activity_date": 1559130768, "creation_date": 1559129312, "question_id": 56359563, "link": "https://stackoverflow.com/questions/56359563/winsock2-select-function-giving-invalid-arguement-error-error-10022", "title": "Winsock2: select() function giving &quot;invalid arguement error&quot; (Error 10022)?", "body": "<p>Running the select() function (Line 13 of provided code) returns error 10022 (WSAEINVAL) meaning either my timeout variable in negative or all 3 other variables are NULL. But I only get this error after the first iteration through the outside loop.</p>\n\n<p>Basically my set up is send a window of packets of size N at base, then check to see if any confirmations have been sent back to me by checking if my socket is ready to be read from. For the first window of packets, the select() call works just fine, returning 1. But all calls to select() after the first iteration of the full loop result in the error code. I'm completely out of ideas.</p>\n\n<p>I saw a thread saying to just wrap the function with another function call and it didn't seem to change the problem. I have no idea why it would work the first loop but not at all after that.</p>\n\n<pre><code>int Exit = 0;\nint endRecv = 0;\nint ready = 0;\n//Sending Algorithm\nint base = 0;\nuint32_t confirmedPosition;\n\n\n\nwhile (Exit == 0) {\n    //Send data in an N sized Window.\n    for (int i = 0; i &lt; N; i++) {\n        if (successfulPackets[i + base] != 1) {\n            memcpy(&amp;buffer_tx, &amp;packets[i + base], BUFFERS_LEN);\n            sendto(socketS, buffer_tx, BUFFERS_LEN, 0, (sockaddr*)&amp; addrDest, sizeof(addrDest));\n        }\n    }\n    endRecv = 0;\n    //Receive Confirmations\n    while (endRecv == 0) {\n        //Poll to see if something is waiting\n        ready = select(NULL, &amp;readfds, NULL, NULL, &amp;pollTime);\n        if (ready == -1) {\n            printf(\"Error with Code: %d\", WSAGetLastError());\n        } else if (ready == 1) {//If yes, log confirmation\n            recvfrom(socketS, buffer_rx, BUFFERS_LEN, 0, (sockaddr *)&amp;from, &amp;fromlen);\n            memcpy(&amp;confirmedPosition, &amp;buffer_rx, 4);\n            successfulPackets[confirmedPosition] = 1;\n            fileSize -= BUFFERS_LEN - 8;\n        } else {//If no, end receiving and send\n            endRecv = 1;\n        }\n    }\n    //Apply Changes to Base\n    for (int i = 0; i &lt; N; i++) {\n        if (successfulPackets[base] == 1) {\n            base++;\n        }\n    }\n    if (fileSize &lt;= 0) {\n        Exit = 1;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "armadillo"], "comments": [{"owner": {"reputation": 619, "user_id": 3728261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f9216f3adbf85c8b4730bc5929806d0?s=128&d=identicon&r=PG", "display_name": "Mathieu Bour", "link": "https://stackoverflow.com/users/3728261/mathieu-bour"}, "edited": false, "score": 0, "creation_date": 1559131323, "post_id": 56359517, "comment_id": 99323598, "body": "Can you provide a mathematical example of what you want to do?"}, {"owner": {"reputation": 3, "user_id": 11571825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fc7ddb1fde3655e9dc380293d9b170d?s=128&d=identicon&r=PG&f=1", "display_name": "oussama", "link": "https://stackoverflow.com/users/11571825/oussama"}, "reply_to_user": {"reputation": 619, "user_id": 3728261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f9216f3adbf85c8b4730bc5929806d0?s=128&d=identicon&r=PG", "display_name": "Mathieu Bour", "link": "https://stackoverflow.com/users/3728261/mathieu-bour"}, "edited": false, "score": 0, "creation_date": 1559134801, "post_id": 56359517, "comment_id": 99325727, "body": "h = [[ 0.65670886,  0.43024765],        [ 0.6688264 ,  0.46121732],        [ 0.96284109,  0.73983768],        [ 0.94589245,  0.41653401],        [ 0.90351229,  0.65803306]]"}, {"owner": {"reputation": 3, "user_id": 11571825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fc7ddb1fde3655e9dc380293d9b170d?s=128&d=identicon&r=PG&f=1", "display_name": "oussama", "link": "https://stackoverflow.com/users/11571825/oussama"}, "reply_to_user": {"reputation": 619, "user_id": 3728261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f9216f3adbf85c8b4730bc5929806d0?s=128&d=identicon&r=PG", "display_name": "Mathieu Bour", "link": "https://stackoverflow.com/users/3728261/mathieu-bour"}, "edited": false, "score": 0, "creation_date": 1559134965, "post_id": 56359517, "comment_id": 99325849, "body": "for example  I want to extract the first column using a Armadillo&#39;s functions so:"}, {"owner": {"reputation": 3, "user_id": 11571825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fc7ddb1fde3655e9dc380293d9b170d?s=128&d=identicon&r=PG&f=1", "display_name": "oussama", "link": "https://stackoverflow.com/users/11571825/oussama"}, "reply_to_user": {"reputation": 619, "user_id": 3728261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f9216f3adbf85c8b4730bc5929806d0?s=128&d=identicon&r=PG", "display_name": "Mathieu Bour", "link": "https://stackoverflow.com/users/3728261/mathieu-bour"}, "edited": false, "score": 0, "creation_date": 1559135126, "post_id": 56359517, "comment_id": 99325961, "body": "So Vec_H = [0.65670886, 0.6688264,0.962841090.0.94589245, 0.90351229] T"}], "answers": [{"tags": [], "owner": {"reputation": 3990, "user_id": 6095394, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7e512acda63343ac20eedd20c3964911?s=128&d=identicon&r=PG&f=1", "display_name": "pschill", "link": "https://stackoverflow.com/users/6095394/pschill"}, "is_accepted": false, "score": 1, "last_activity_date": 1559129940, "creation_date": 1559129940, "answer_id": 56359745, "question_id": 56359517, "link": "https://stackoverflow.com/questions/56359517/is-there-an-c-function-from-armadillo-for-selecting-a-column-from-a-matrix/56359745#56359745", "title": "Is there an c++ function from Armadillo for selecting a column from a matrix?\u201d", "body": "<p>According to <a href=\"http://arma.sourceforge.net/docs.html#submat\" rel=\"nofollow noreferrer\">http://arma.sourceforge.net/docs.html#submat</a> you can use <code>X.col(col_number)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1300, "user_id": 5696269, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fM9nY4BDuE8/AAAAAAAAAAI/AAAAAAAAAAA/ykOQFUkc6Zg/photo.jpg?sz=128", "display_name": "KaiJ", "link": "https://stackoverflow.com/users/5696269/kaij"}, "is_accepted": false, "score": 0, "last_activity_date": 1559130088, "creation_date": 1559130088, "answer_id": 56359807, "question_id": 56359517, "link": "https://stackoverflow.com/questions/56359517/is-there-an-c-function-from-armadillo-for-selecting-a-column-from-a-matrix/56359807#56359807", "title": "Is there an c++ function from Armadillo for selecting a column from a matrix?\u201d", "body": "<p>Try the .col(col_number) function, or the .cols(first_col, last_col) function.</p>\n\n<p>See <a href=\"http://arma.sourceforge.net/docs.html#submat\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 3, "user_id": 11571825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fc7ddb1fde3655e9dc380293d9b170d?s=128&d=identicon&r=PG&f=1", "display_name": "oussama", "link": "https://stackoverflow.com/users/11571825/oussama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559130088, "creation_date": 1559129187, "last_edit_date": 1559129245, "question_id": 56359517, "link": "https://stackoverflow.com/questions/56359517/is-there-an-c-function-from-armadillo-for-selecting-a-column-from-a-matrix", "title": "Is there an c++ function from Armadillo for selecting a column from a matrix?\u201d", "body": "<p>I'm looking for selecting a column from a matrix H for example, knowingly that a have the index off this column </p>\n\n<p>I searched in Armadillio</p>\n"}, {"tags": ["c++", "opencv", "emscripten", "webassembly"], "answers": [{"tags": [], "owner": {"reputation": 321, "user_id": 861124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9e0823063c91434cf084da10a485ebd4?s=128&d=identicon&r=PG", "display_name": "Jeremie", "link": "https://stackoverflow.com/users/861124/jeremie"}, "is_accepted": false, "score": 0, "last_activity_date": 1559477991, "creation_date": 1559477991, "answer_id": 56414950, "question_id": 56359496, "link": "https://stackoverflow.com/questions/56359496/building-webassembly-with-opencv/56414950#56414950", "title": "Building webassembly with opencv", "body": "<p>Ok, looks like I found a way to build it (still here <a href=\"https://github.com/jdrouet/opencv-wasm\" rel=\"nofollow noreferrer\">https://github.com/jdrouet/opencv-wasm</a>) but now, when I try to use the resize function, I end up with the following error :</p>\n\n<pre><code>Error: the string \"174007712 - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch.\" was thrown, throw an Error :)\n</code></pre>\n\n<p>So now, I don't know if I'm not using the function well... Here is the function : <a href=\"https://github.com/jdrouet/opencv-wasm/blob/master/source/resizer.cpp#L23\" rel=\"nofollow noreferrer\">https://github.com/jdrouet/opencv-wasm/blob/master/source/resizer.cpp#L23</a></p>\n\n<p>Do you have any idea of why it's not working?</p>\n"}], "owner": {"reputation": 321, "user_id": 861124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9e0823063c91434cf084da10a485ebd4?s=128&d=identicon&r=PG", "display_name": "Jeremie", "link": "https://stackoverflow.com/users/861124/jeremie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 583, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559477991, "creation_date": 1559129120, "question_id": 56359496, "link": "https://stackoverflow.com/questions/56359496/building-webassembly-with-opencv", "title": "Building webassembly with opencv", "body": "<p>I've been trying to build a piece of code in webassembly that would use OpenCV.</p>\n\n<p>I took <a href=\"https://github.com/mpizenberg/emscripten-opencv\" rel=\"nofollow noreferrer\">https://github.com/mpizenberg/emscripten-opencv</a> to start building, this worked well, but when I try adding cv::resize to be able to resize an image, that's when I have some issues:</p>\n\n<pre><code>make[1]: Entering directory '/code/build'\nmake[2]: Entering directory '/code/build'\nmake[3]: Entering directory '/code/build'\nScanning dependencies of target hello\nmake[3]: Leaving directory '/code/build'\nmake[3]: Entering directory '/code/build'\n[ 50%] Building CXX object CMakeFiles/hello.dir/source/main.cpp.o\n[100%] Linking CXX executable hello.js\nerror: undefined symbol: _Z7cvFloorRKN2cv10softdoubleE\nwarning: To disable errors for undefined symbols use `-s ERROR_ON_UNDEFINED_SYMBOLS=0`\nerror: undefined symbol: _Z7cvRoundRKN2cv10softdoubleE\nerror: undefined symbol: _Z9cvRound64RKN2cv10softdoubleE\nerror: undefined symbol: _ZN2cv10softdoubleC1Ei\nerror: undefined symbol: _ZN2cv10softdoubleC1Ex\nerror: undefined symbol: _ZNK2cv10softdoubledvERKS0_\nerror: undefined symbol: _ZNK2cv10softdoublemiERKS0_\nerror: undefined symbol: _ZNK2cv10softdoublemlERKS0_\nerror: undefined symbol: _ZNK2cv10softdoubleplERKS0_\nError: Aborting compilation due to previous errors\nshared:ERROR: '/emsdk_portable/node/bin/node /emsdk_portable/sdk/src/compiler.js /tmp/tmpS6bxjF.txt /emsdk_portable/sdk/src/embind/emval.js /emsdk_portable/sdk/src/embind/embind.js /emsdk_portable/sdk/src/library_pthread_stub.js' failed (1)\nCMakeFiles/hello.dir/build.make:95: recipe for target 'hello.js' failed\nmake[3]: *** [hello.js] Error 1\nmake[3]: Leaving directory '/code/build'\nCMakeFiles/Makefile2:72: recipe for target 'CMakeFiles/hello.dir/all' failed\nmake[2]: *** [CMakeFiles/hello.dir/all] Error 2\nmake[2]: Leaving directory '/code/build'\nMakefile:83: recipe for target 'all' failed\nmake[1]: *** [all] Error 2\nmake[1]: Leaving directory '/code/build'\nMakefile:5: recipe for target 'build' failed\nmake: *** [build] Error 2\nThe command '/bin/sh -c make build' returned a non-zero code: 2\nmake: *** [all] Error 2\n</code></pre>\n\n<p>I tried wrapping up my problem here <a href=\"https://github.com/jdrouet/opencv-wasm\" rel=\"nofollow noreferrer\">https://github.com/jdrouet/opencv-wasm</a>, you can pull it and run make, it'll build with docker.</p>\n\n<p>Do you have any idea of how I could fix my issue?</p>\n"}, {"tags": ["c++", "qt", "qmap"], "comments": [{"owner": {"reputation": 1380, "user_id": 1809260, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/5T88E.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/1809260/simon"}, "edited": false, "score": 1, "creation_date": 1559129106, "post_id": 56359469, "comment_id": 99322373, "body": "you can serialize it to <code>QByteArray</code>"}, {"owner": {"reputation": 5378, "user_id": 2110683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33179a1918a5d90f47cde062fab10ff4?s=128&d=identicon&r=PG", "display_name": "Dimitry Ernot", "link": "https://stackoverflow.com/users/2110683/dimitry-ernot"}, "edited": false, "score": 0, "creation_date": 1559131867, "post_id": 56359469, "comment_id": 99323946, "body": "Do you have to send it over a TCP socket or just send your map on the network? (TCP sockets are a bit too low level to send data)."}, {"owner": {"reputation": 19, "user_id": 11526418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7108163c724d71ebda6597009e2258c?s=128&d=identicon&r=PG&f=1", "display_name": "Someone", "link": "https://stackoverflow.com/users/11526418/someone"}, "edited": false, "score": 0, "creation_date": 1559132204, "post_id": 56359469, "comment_id": 99324122, "body": "I need to make something on the server side using QMap (like a command) so when a client makes some change, in QMap that change is made and sent back to client so there a client can see it."}, {"owner": {"reputation": 19, "user_id": 11526418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7108163c724d71ebda6597009e2258c?s=128&d=identicon&r=PG&f=1", "display_name": "Someone", "link": "https://stackoverflow.com/users/11526418/someone"}, "reply_to_user": {"reputation": 1380, "user_id": 1809260, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/5T88E.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/1809260/simon"}, "edited": false, "score": 0, "creation_date": 1559139055, "post_id": 56359469, "comment_id": 99328499, "body": "@Simon how to do that?"}], "answers": [{"tags": [], "owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "is_accepted": false, "score": 0, "last_activity_date": 1559147925, "last_edit_date": 1559147925, "creation_date": 1559140467, "answer_id": 56363049, "question_id": 56359469, "link": "https://stackoverflow.com/questions/56359469/how-to-send-qmap-over-socket/56363049#56363049", "title": "How to send QMap over socket?", "body": "<p>Try to use this approach:</p>\n\n<p>On Server side use this to send a map:</p>\n\n<pre><code>// to send Map\nqint64 SendMap(QMap&lt;String, int&gt; map){\n    QByteArray block;\n    QDataStream sendStream(&amp;block, QIODevice::ReadWrite);\n\n    sendStream &lt;&lt; quint64(0) // for size of data\n               &lt;&lt; map;       // your map\n\n    sendStream.device()-&gt;seek(0); // return back to set data size\n\n    sendStream &lt;&lt; (quint64)(block.size() - sizeof(quint64)); // set data size\n\n    return socket-&gt;write(block);    // send data\n}\n</code></pre>\n\n<p>On Client side, when you expect a map, use this to read a map:</p>\n\n<pre><code>// to receive Map\nQMap&lt;QString, int&gt; ReceiveMap(QTcpSocket *socket){\n    QDataStream readStream(socket);\n    quint64 dataBlockSize = 0;\n\n    while(true) {\n        if (!dataBlockSize) {\n            if (socket-&gt;bytesAvailable() &lt; sizeof(quint64)) { // waiting data size \n                break;                                        // to be available\n            }\n            readStream &gt;&gt; dataBlockSize;\n        }\n\n        if (socket-&gt;bytesAvailable() &lt; dataBlockSize) { // waiting full data\n            break;\n        }\n\n        QMap&lt;QString, int&gt; map;\n        readStream &gt;&gt; map;\n\n        return map;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11526418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7108163c724d71ebda6597009e2258c?s=128&d=identicon&r=PG&f=1", "display_name": "Someone", "link": "https://stackoverflow.com/users/11526418/someone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559147925, "creation_date": 1559129052, "question_id": 56359469, "link": "https://stackoverflow.com/questions/56359469/how-to-send-qmap-over-socket", "title": "How to send QMap over socket?", "body": "<p>I have a QMap object: </p>\n\n<pre><code>QMap&lt;QString, int&gt; map; \n</code></pre>\n\n<p>and I would like to send it over TCP socket. Do I have to convert it to JSON and then send it or?</p>\n"}, {"tags": ["c++", "macos", "pid"], "comments": [{"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1559133521, "post_id": 56359462, "comment_id": 99324971, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12431643/how-do-i-capture-a-list-of-all-running-processes-for-osx-and-save-them-as-a-file\" title=\"how do i capture a list of all running processes for osx and save them as a file\">stackoverflow.com/questions/12431643/&hellip;</a>"}, {"owner": {"reputation": 2915, "user_id": 5136580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42efea573d72921a6de90bef052c4879?s=128&d=identicon&r=PG&f=1", "display_name": "Mikel Rychliski", "link": "https://stackoverflow.com/users/5136580/mikel-rychliski"}, "edited": false, "score": 0, "creation_date": 1586916648, "post_id": 56359462, "comment_id": 108302792, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/12431643/how-do-i-capture-a-list-of-all-running-processes-for-osx-and-save-them-as-a-file\">How do I capture a list of all running processes for OSX and save them as a file in Xcode / Cocoa?</a>"}], "owner": {"reputation": 1, "user_id": 11572497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6af4592c6daa7b58e20e486092801f17?s=128&d=identicon&r=PG", "display_name": "user333585", "link": "https://stackoverflow.com/users/11572497/user333585"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586937903, "creation_date": 1559129027, "last_edit_date": 1586937903, "question_id": 56359462, "link": "https://stackoverflow.com/questions/56359462/how-to-show-all-running-process-on-macos-programmatically-in-c", "title": "How to show all running process on macOS programmatically in C++?", "body": "<p>macOS doesn\u2019t have procfs.</p>\n\n<p>Does anybody know some analogs or anything else that can help me? </p>\n"}, {"tags": ["python", "c++", "swig"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11571869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc98da34c74bda5077bb39c5ca6d0b77?s=128&d=identicon&r=PG&f=1", "display_name": "john zhao", "link": "https://stackoverflow.com/users/11571869/john-zhao"}, "is_accepted": false, "score": 0, "last_activity_date": 1559207262, "last_edit_date": 1559207262, "creation_date": 1559206487, "answer_id": 56374854, "question_id": 56359450, "link": "https://stackoverflow.com/questions/56359450/how-to-convert-python-ndarray-to-c-char/56374854#56374854", "title": "how to convert python ndarray to c++ char*?", "body": "<p>haha, I figured it out myself.<br/>\nIn <a href=\"http://swig.org/Doc4.0/SWIG.html#SWIG_nn33\" rel=\"nofollow noreferrer\">SWIG Documentation 5.5.2</a>, </p>\n\n<blockquote>\n  <p>SWIG assumes that all members of type char * have been dynamically allocated using malloc() and that they are NULL-terminated ASCII strings.<br/><br/>\n  If this behavior differs from what you need in your applications, the SWIG \"memberin\" typemap can be used to change it.</p>\n</blockquote>\n\n<p>So, what I need is \"typemap(memberin)\":</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>%typemap(in) Image_Data_Type{\n  $1 = reinterpret_cast&lt;Image_Data_Type&gt;(PyLong_AsLongLong($input));\n}\n\n%typemap(memberin) Image_Data_Type{\n  $1 = $input;\n}\n\n%typemap(out) Image_Data_Type{\n  $result = PyLong_FromLongLong(reinterpret_cast&lt;__int64&gt;($1));\n}\n</code></pre>\n\n<p>It's a bit ugly using integer to transfer pointer. Is there a better way? </p>\n"}], "owner": {"reputation": 11, "user_id": 11571869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc98da34c74bda5077bb39c5ca6d0b77?s=128&d=identicon&r=PG&f=1", "display_name": "john zhao", "link": "https://stackoverflow.com/users/11571869/john-zhao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1559287329, "creation_date": 1559128989, "last_edit_date": 1559287329, "question_id": 56359450, "link": "https://stackoverflow.com/questions/56359450/how-to-convert-python-ndarray-to-c-char", "title": "how to convert python ndarray to c++ char*?", "body": "<p>I'm using swig to wrap a c++ library, it needs to get image data as char*. I can read the image in python. But how can i trans it to c++?</p>\n\n<p>I konw I might need to use typemap. I tried several ways, but I always get a picture with only stripes.</p>\n\n<p>This is my interface file:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>/* np2char */\n%module np2char\n\n%{\n    #define SWIG_FILE_WITH_INIT\n    #include &lt;opencv2/opencv.hpp&gt;\n    using namespace cv;\n%}\n\n%inline %{\n  typedef char* Image_Data_Type;\n  typedef int Image_Width_Type;\n  typedef int Image_Height_Type;\n\n  struct Image_Info {\n      Image_Data_Type imageData;\n      Image_Width_Type imageWidth;\n      Image_Height_Type imageHeight;\n  };\n\n  int Imageshow(Image_Info ImageInfo) {\n      Mat img(ImageInfo.imageHeight, ImageInfo.imageWidth, CV_8UC3, ImageInfo.imageData);\n      imshow(\"img_in_cpp\", img);\n      waitKey(0);\n      destroyAllWindows();\n      return 0;\n  }\n\n%}\n</code></pre>\n\n<p>This is my setup.py:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>\"\"\"\nsetup.py\n\"\"\"\nfrom distutils.core import setup,Extension\n\nmodule1 = Extension('_np2char',\n            sources=['np2char_wrap.cxx'],\n            include_dirs=['include'],\n            libraries = [\"opencv_world342\"],\n            library_dirs=[\"lib\"],\n            )\n\nsetup(name = \"np2char\",\n      version = \"1.0\",\n      description = 'This package is used to trans ndarray to char*',\n      ext_modules = [module1],\n      py_modules=['np2char'])\n</code></pre>\n\n<p>and this is my python file:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import np2char\nimport cv2\n\nimg1 = cv2.imread(\"1.jpg\")\n\nimg_info = np2char.Image_Info()\nimg_info.imageData = img1.data\nimg_info.imageWidth = img1.shape[1]\nimg_info.imageHeight = img1.shape[0]\n\nnp2char.Imageshow(img_info)\n</code></pre>\n\n<p>I have tried </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>%typemap(in) Image_Data_Type{\n  $1 = reinterpret_cast&lt;char*&gt;(PyLong_AsLongLong($input));\n}\n</code></pre>\n\n<p>, and in python side \n<code>img_info.imageData=img1.ctypes.data</code>\nBut still I got only stripes. It seems that imagedata is copied to other places in memory. In the process, it was truncated by '\\0'.</p>\n"}, {"tags": ["c#", "c++", "winapi", "clr", "appdomain"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 3, "creation_date": 1559130700, "post_id": 56359368, "comment_id": 99323242, "body": "That&#39;s the AppDomain.Load(byte[]) overload.  It is not happy about you trying to pass double[]."}], "answers": [{"tags": [], "owner": {"reputation": 869, "user_id": 887420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/WHuOw.jpg?s=128&g=1", "display_name": "Ilian Zapryanov", "link": "https://stackoverflow.com/users/887420/ilian-zapryanov"}, "is_accepted": true, "score": 0, "last_activity_date": 1559130212, "creation_date": 1559130212, "answer_id": 56359835, "question_id": 56359368, "link": "https://stackoverflow.com/questions/56359368/appdomainptr-load-3-method-example/56359835#56359835", "title": "_AppDomainPtr Load_3 method example?", "body": "<p>Apparently I've found the problem. I was creating a SafeArray of Real numbers. The correct fix for anyone who needs that is:</p>\n\n<pre><code>static void binarray(SAFEARRAY** output, const unsigned  char* data, size_t size)\n{\n    SAFEARRAYBOUND  Bound;\n    Bound.lLbound = 0;\n    Bound.cElements = size;\n//  VT_I1\n    *output = SafeArrayCreate(VT_UI1, 1, &amp;Bound);\n    //VT_R8\n    unsigned char *pdFreq;\n    HRESULT hr = SafeArrayAccessData(*output, (void* FAR*)&amp;pdFreq);\n    if (SUCCEEDED(hr))\n    {\n        // copy sample values from data[] to this safearray\n        for (DWORD i = 0; i &lt; size; i++)\n        {\n            *pdFreq++ = data[i];\n        }\n        SafeArrayUnaccessData(*output);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 869, "user_id": 887420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/WHuOw.jpg?s=128&g=1", "display_name": "Ilian Zapryanov", "link": "https://stackoverflow.com/users/887420/ilian-zapryanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 56359835, "answer_count": 1, "score": 0, "last_activity_date": 1559130212, "creation_date": 1559128701, "question_id": 56359368, "link": "https://stackoverflow.com/questions/56359368/appdomainptr-load-3-method-example", "title": "_AppDomainPtr Load_3 method example?", "body": "<p>I am trying to load a C# assembly with <code>_AppDomainPtr</code> <code>Load_3</code> method. Do you have some example since I get error:\n<code>hr = 0x80131533 : A mismatch has occurred between the runtime type of the array and the sub type recorded in the metadata.</code>\nHere is a snippet how do I load the assembly:</p>\n\n<pre><code>static void binarray(SAFEARRAY** output, const char* data, size_t size)\n{\n    SAFEARRAYBOUND  Bound;\n    Bound.lLbound = 0;\n    Bound.cElements = size;\n\n    *output = SafeArrayCreate(VT_R8, 1, &amp;Bound);\n\n    double HUGEP *pdFreq;\n    HRESULT hr = SafeArrayAccessData(*output, (void HUGEP* FAR*)&amp;pdFreq);\n    if (SUCCEEDED(hr))\n    {\n        // copy sample values from data[] to this safearray\n        for (DWORD i = 0; i &lt; size; i++)\n        {\n            *pdFreq++ = data[i];\n        }\n        SafeArrayUnaccessData(*output);\n    }\n}\n</code></pre>\n\n<p>And the call:</p>\n\n<pre><code>hr = spDefaultAppDomain-&gt;Load_3(output, &amp;spAssembly);\n</code></pre>\n\n<p>Anyone used that?</p>\n"}, {"tags": ["c++", "visual-studio", "dll"], "comments": [{"owner": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 0, "creation_date": 1559128083, "post_id": 56359082, "comment_id": 99321804, "body": "Because the build tools differ from VS to VS version. In between build tools the implementation of, say, the STD classes may have breaking changes in between. Same applies to when one compiles under different GCC versions for example"}, {"owner": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 0, "creation_date": 1559128147, "post_id": 56359082, "comment_id": 99321854, "body": "You could use a newer visual studio version and build with older visual studio build tools though."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "reply_to_user": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 0, "creation_date": 1559128276, "post_id": 56359082, "comment_id": 99321916, "body": "@Neijwiert Doesn&#39;t GCC have a higher commitment to keeping <i>binary</i> compatibility for their standard library?"}, {"owner": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1559128342, "post_id": 56359082, "comment_id": 99321964, "body": "@Deduplicator Could be, but I&#39;m pretty sure there isn&#39;t a guarantee that it will be."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "reply_to_user": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 2, "creation_date": 1559128637, "post_id": 56359082, "comment_id": 99322131, "body": "@Neijwiert <a href=\"https://gcc.gnu.org/onlinedocs/libstdc++/manual/abi.html#abi.versioning.goals\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/libstdc++/manual/&hellip;</a>"}, {"owner": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1559128962, "post_id": 56359082, "comment_id": 99322306, "body": "@Deduplicator I stand corrected, you&#39;re right. It is still mentioned under goals, so I&#39;m not sure that it is a 100% guarantee for all edge-cases. IMHO it wouldn&#39;t be a bad idea to compile with the earliest GCC version of all the libs you&#39;re using."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1559129084, "post_id": 56359082, "comment_id": 99322362, "body": "An IDE doesn&#39;t have an impact on DLLs.   The compiler and library, which that IDE uses, does -  for example, updates of the standard library, change of calling conventions or ABIs, that change between versions of the compiler and library.    Practically, it is reasonable to expect Microsoft will ship each update of their IDE with the latest/contemporary version of their compiler and library."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1559129773, "post_id": 56359082, "comment_id": 99322728, "body": "These downloads are enormous, at half a gig I&#39;d imagine they included a whole bunch of sample projects.  Too large to wait for.  Do check the manual, a DLL can be reasonably isolated from the compiler version but a static library can not."}], "owner": {"reputation": 509, "user_id": 859385, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e3613ab2650aacf6d02b6d2500910389?s=128&d=identicon&r=PG", "display_name": "user859385", "link": "https://stackoverflow.com/users/859385/user859385"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559127840, "creation_date": 1559127840, "question_id": 56359082, "link": "https://stackoverflow.com/questions/56359082/why-are-there-visual-studio-version-specific-lib-dll-files-provided-by-some-vend", "title": "Why are there visual studio version specific lib/dll files provided by some vendors?", "body": "<p>Check, <a href=\"https://www.rti.com/free-trial/dds-files\" rel=\"nofollow noreferrer\">https://www.rti.com/free-trial/dds-files</a>. If you take a look at the download section under Windows, you would see different installers for different versions of visual studio. After inspection, I can say one of the major differences between this installers is that the DLLs resided in the installers are different. These DLLs are used to import some shared functions for my c++ development. After some research I found that not only RTI does this, but there are some libraries by other vendors which are visual studio specific as well. Theoretically, what could be the reason for the vendor deciding to seperate the DLLs according to visual studio versions? What happens if I don't use visual studio to compile the c++ files? Would the DLL still work (assuming the DLL is built with the correct arch type and is built using c++)? I just don't see why an IDE (visual studio) has impact on DLLs. </p>\n"}, {"tags": ["c++", "bit"], "comments": [{"owner": {"reputation": 167922, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1559127717, "post_id": 56358931, "comment_id": 99321604, "body": "1) You didn&#39;t tag with a language; there are many languages with non-semantic line breaks, so <i>any</i> program can be trivially a one-liner. 2) Why do you need this? is it a golf (a puzzle challenge to write code as short as possible), or would it be some other requirement? Does it need to be fast, or just not have line breaks? 3) Did you try anything yet? Have you researched it?"}, {"owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "edited": false, "score": 0, "creation_date": 1559127741, "post_id": 56358931, "comment_id": 99321615, "body": "What do you mean by <i>find</i> the left/right most bit? Return a value with only this bit set? Or return the index of this bit?"}, {"owner": {"reputation": 167922, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1559128102, "post_id": 56358931, "comment_id": 99321824, "body": "4) Some programming languages have built-ins or library functions to do what you are looking for. For example, in Ruby, <code>x.bit_length - 1</code> will give you the index of the highest set bit. 5) It is also fairly trivial to do this by converting a number to the binary representation (which many languages support natively), then use string functions like <code>index</code>, <code>rindex</code> and <code>len</code> to find the ones (though it is not the most performant way)."}], "answers": [{"comments": [{"owner": {"reputation": 14371, "user_id": 321866, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/25e93a50d485eca289f887868e1bcea5?s=128&d=identicon&r=PG", "display_name": "C Johnson", "link": "https://stackoverflow.com/users/321866/c-johnson"}, "reply_to_user": {"reputation": 167922, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1559229762, "post_id": 56359862, "comment_id": 99362477, "body": "@Amadan he didn&#39;t say &quot;only way&quot;. What are you talking about? Alain didn&#39;t use built-in functions for his response. So why are you raising that concern?"}], "tags": [], "owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "is_accepted": false, "score": 4, "last_activity_date": 1559130273, "creation_date": 1559130273, "answer_id": 56359862, "question_id": 56358931, "link": "https://stackoverflow.com/questions/56358931/how-to-find-the-leftmost-bit-of-an-number-in-one-line/56359862#56359862", "title": "How to find the leftmost bit of an number in one line", "body": "<p>For the rightmost bit, there is a well-known trick.</p>\n\n<pre><code>x=x &amp; -x\n</code></pre>\n\n<p>will clear all set bits in x, except the leftmost one. You will find many explanations why this works in SO (see for instance <a href=\"https://stackoverflow.com/questions/56320733/understanding-how-to-count-trailing-zeros-for-a-number-using-bitwise-operators-i/56322499#56322499\">this answer</a>)</p>\n\n<p>To find its index, except by using builtins of programming languages, there is no way but doing a loop AFAIK. Note that this loop can be unrolled to have a one liner.</p>\n\n<pre><code>pos = (16*(x&amp;0xffff0000)!=0) + (8*(x&amp;0xff00ff00)!=0) + (4&amp;(x&amp;0xf0f0f0f0)!=0) + (2*(x&amp;0x66666666)!=0)+(x&amp;0xaaaaaaaa)!=0)\n</code></pre>\n\n<p>x is the result of the previous operation (ie only the rightmost bit is set) and it works by testing is this bit is in the upper half word in which case the position will be > 16, then an even byte, even nibble, and so on.</p>\n\n<p>Another solution, is to use the mathematic operator <code>log2</code></p>\n\n<pre><code>pos=(int)log2((double)x)\n</code></pre>\n\n<p>For the left most bit, AFAIK, there are no way to do that at the bit level, except through loops. But it is possible to use log2() to find the position of the leftmost bit.</p>\n\n<p>Then, to return an int with only this bit set, one can use right shifts.</p>\n\n<pre><code>x = 1 &lt;&lt; ((int) log2((double)x))\n</code></pre>\n\n<p>This will keep only the left most bit in x.</p>\n\n<p>Beware to previously check if x in non null.</p>\n"}], "owner": {"reputation": 97, "user_id": 9114063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wrW7Y.jpg?s=128&g=1", "display_name": "sagar saini", "link": "https://stackoverflow.com/users/9114063/sagar-saini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1559228916, "creation_date": 1559127360, "last_edit_date": 1559228916, "question_id": 56358931, "link": "https://stackoverflow.com/questions/56358931/how-to-find-the-leftmost-bit-of-an-number-in-one-line", "title": "How to find the leftmost bit of an number in one line", "body": "<p>How to find out the leftmost bit and rightmost bit of an number in one line of code ?</p>\n\n<p>Well we can traverse an loop to find out the leftmost set bit by leftshift but how to do it in one line to make an another no. whose leftmost bit / rightmost bit is set ?\nLike y = x &amp; ~(x-1) will find leftmost bit but I didn't get this how ? </p>\n\n<p>Can someone give the code for that in C++ and explain ?</p>\n"}]