[{"tags": ["c++"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1531957831, "post_id": 51412434, "comment_id": 89796533, "body": "maybe you want <code>std::cout &lt;&lt; std::hex &lt;&lt; std::setw(2) &lt;&lt; std::setfill(&#39;0&#39;) &lt;&lt; integers[i] &lt;&lt; &quot; &quot;;</code> ?"}, {"owner": {"reputation": 433, "user_id": 5405358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98b7f3bba06b1943a65885501eab7a10?s=128&d=identicon&r=PG&f=1", "display_name": "Gravity Mass", "link": "https://stackoverflow.com/users/5405358/gravity-mass"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1531957973, "post_id": 51412434, "comment_id": 89796560, "body": "Worked perfectly. thanks"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1531958020, "post_id": 51412434, "comment_id": 89796569, "body": "@M.M that should be an answer, not a comment"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1531958060, "post_id": 51412434, "comment_id": 89796578, "body": "integers[i] = (int)&#39;f&#39;   won&#39;t work."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1531958156, "post_id": 51412434, "comment_id": 89796600, "body": "If you are going to test the values manually (which is not needed), you would need something more like this instead <code>if ((integers[i] &gt;= 0) &amp;&amp; (integers[i] &lt; 16)) { std::cout &lt;&lt; &quot;0&quot;; } cout &lt;&lt; std::hex &lt;&lt; integers[i] &lt;&lt; &quot; &quot;;</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1531958262, "post_id": 51412434, "comment_id": 89796613, "body": "@RemyLebeau I wasn&#39;t sure if that was what&#39;s being asked"}], "owner": {"reputation": 433, "user_id": 5405358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98b7f3bba06b1943a65885501eab7a10?s=128&d=identicon&r=PG&f=1", "display_name": "Gravity Mass", "link": "https://stackoverflow.com/users/5405358/gravity-mass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "closed_date": 1531958066, "answer_count": 0, "score": 0, "last_activity_date": 1531958298, "creation_date": 1531957747, "last_edit_date": 1531958298, "question_id": 51412434, "link": "https://stackoverflow.com/questions/51412434/how-to-do-zero-padding-to-a-hexadecimal-number-converted-from-int", "closed_reason": "Duplicate", "title": "How to do zero padding to a hexadecimal number converted from int?", "body": "<p>I am printing converted hexadecimal values like the following:</p>\n\n<pre><code>std::cout &lt;&lt; std::hex &lt;&lt; integers[i] &lt;&lt; \" \"; //i is a loop counter\n</code></pre>\n\n<p>But it prints out single digits for few values, like <code>FF D2 78 9 A9 87 f ff</code>. I want those single values to have a 0: <code>FF D2 78 09 A9 87 0f ff</code>.</p>\n\n<p>I tried </p>\n\n<pre><code>if(integers[i] == 1 || ... || integers[i] = (int)'f')\n{\nstd::cout &lt;&lt; \"0\" &lt;&lt; std::hex &lt;&lt; integers[i] &lt;&lt; \" \";\n}\n</code></pre>\n\n<p>But when 1 ... f is an hexadecimal value it, it does not print properly. How can I convert the value to hex first and check if its one digit or two digits and add 0 padding if it is a single digit? </p>\n"}, {"tags": ["c++", "int"], "comments": [{"owner": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "edited": false, "score": 0, "creation_date": 1531957190, "post_id": 51412353, "comment_id": 89796390, "body": "Seems like the simplest would be to loop over the array and convert each number to a string, then simply concatenate each to a master string and at the end convert that back to an int. What if the values are larger than 9, how would you handle that?"}, {"owner": {"reputation": 37, "user_id": 9075030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80410d64eb277bf7a028b2684919844a?s=128&d=identicon&r=PG&f=1", "display_name": "NULLPTR", "link": "https://stackoverflow.com/users/9075030/nullptr"}, "reply_to_user": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "edited": false, "score": 0, "creation_date": 1531957253, "post_id": 51412353, "comment_id": 89796398, "body": "For the purposes of this project, they arent, they&#39;re only digits from 0-9"}, {"owner": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "edited": false, "score": 0, "creation_date": 1531958419, "post_id": 51412353, "comment_id": 89796646, "body": "Your case is slightly simpler than the attached dupe, in that you dont need to consider multi digit numbers. It should be simple to convert without involving strings.  See <a href=\"https://wandbox.org/permlink/ZniBYkmGshWZOE6h\" rel=\"nofollow noreferrer\">here</a>. It comes with certain caveats though, for instance it could easily overflow and it might not play nice if any of the numbers are negative (outside your stated range but still worth being aware of). To resolve the overflow issue, you can just use a larger type for the <code>accum</code> variable."}], "owner": {"reputation": 37, "user_id": 9075030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80410d64eb277bf7a028b2684919844a?s=128&d=identicon&r=PG&f=1", "display_name": "NULLPTR", "link": "https://stackoverflow.com/users/9075030/nullptr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "closed_date": 1531957189, "answer_count": 0, "score": 0, "last_activity_date": 1531957005, "creation_date": 1531957005, "question_id": 51412353, "link": "https://stackoverflow.com/questions/51412353/c-convert-array-of-int-into-one-int", "closed_reason": "Duplicate", "title": "C++ Convert Array of Int into one Int", "body": "<p>suppose I have this:</p>\n\n<pre><code>int ziparr[5];\n</code></pre>\n\n<p>and i've got some elements in it...</p>\n\n<pre><code>int ziparr[0] = 2;\nint ziparr[1] = 4;\nint ziparr[2] = 3;\n.....\n</code></pre>\n\n<p>I want to combine them into one int value, for instance</p>\n\n<pre><code>int zip = 243\n</code></pre>\n\n<p>What is the best way to concatenate this array into one int value?</p>\n"}, {"tags": ["c++", "windows", "visual-studio", "irc"], "answers": [{"tags": [], "owner": {"reputation": 12010, "user_id": 23235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6281820b28d03f98e85bb3d901ae3f39?s=128&d=identicon&r=PG", "display_name": "Shane Powell", "link": "https://stackoverflow.com/users/23235/shane-powell"}, "is_accepted": true, "score": 2, "last_activity_date": 1531956703, "last_edit_date": 1531956703, "creation_date": 1531955241, "answer_id": 51412160, "question_id": 51412107, "link": "https://stackoverflow.com/questions/51412107/connecting-to-irc-server-c-windows-10-visual-studio/51412160#51412160", "title": "Connecting to IRC Server C++ Windows 10 Visual Studio", "body": "<p>Your problem is:</p>\n\n<pre><code>sizeof(s.c_str())\n</code></pre>\n\n<p>in</p>\n\n<pre><code>if (send(ConnectSocket, s.c_str(), sizeof(s.c_str()), 0) == SOCKET_ERROR) {\n</code></pre>\n\n<p>The <code>sizeof</code> operator is returning the size of the <code>char*</code> (which may be 4 bytes or 8 bytes depending if it's a 32-bit or 64-bit application).</p>\n\n<p>You want to change it to:</p>\n\n<pre><code>if (send(ConnectSocket, s.c_str(), s.size(), 0) == SOCKET_ERROR) {\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 8209613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd1a9dbf7c805a4396cb849f07139a6f?s=128&d=identicon&r=PG&f=1", "display_name": "Harsh Baid", "link": "https://stackoverflow.com/users/8209613/harsh-baid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 51412160, "answer_count": 1, "score": -1, "last_activity_date": 1531956703, "creation_date": 1531954814, "last_edit_date": 1531955459, "question_id": 51412107, "link": "https://stackoverflow.com/questions/51412107/connecting-to-irc-server-c-windows-10-visual-studio", "title": "Connecting to IRC Server C++ Windows 10 Visual Studio", "body": "<p>So I am fairly new to C++/C and only learned the language about a week ago so I'm a bit lost. I am trying to build an IRC Client to connect to a server and I can't seem to get it to work. I am using Visual Studio as my IDE and have followed the instructions listed on here for Socket connections: <a href=\"https://docs.microsoft.com/en-us/windows/desktop/winsock/complete-client-code\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/desktop/winsock/complete-client-code</a></p>\n\n<pre><code>// Testing.cpp : Defines the entry point for the console application.\n//\n\n#include \"stdafx.h\"\n#include &lt;winsock2.h&gt;\n#include &lt;ws2tcpip.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\n#pragma comment(lib, \"Ws2_32.lib\")\n\nusing namespace std;\n\nSOCKET ConnectSocket = INVALID_SOCKET;\n\nvoid SendData(string s) {\n    if (send(ConnectSocket, s.c_str(), sizeof(s.c_str()), 0) == SOCKET_ERROR) {\n        cout &lt;&lt; \"send failed: \" &lt;&lt; WSAGetLastError() &lt;&lt; endl;\n        closesocket(ConnectSocket);\n        WSACleanup();\n    }\n    else { cout &lt;&lt; s &lt;&lt; endl; }\n}\n\nint main()\n{\n    WSADATA wsaData;\n\n    // Initialize Winsock\n    if (WSAStartup(MAKEWORD(2, 2), &amp;wsaData)) {\n        printf(\"WSAStartup failed\");\n        system(\"pause\");\n    }\n    else { cout &lt;&lt; \"WinSock Started\" &lt;&lt; endl; }\n\n    struct addrinfo *result = NULL,\n        *ptr = NULL,\n        hints;\n\n    ZeroMemory(&amp;hints, sizeof(hints));\n    hints.ai_family = AF_INET;\n    hints.ai_socktype = SOCK_STREAM;\n    hints.ai_protocol = IPPROTO_TCP;\n\n    // Resolve the server address and port\n\n    if (getaddrinfo(\"38.229.70.22\", \"6665\", &amp;hints, &amp;result)) {\n        cout &lt;&lt; \"GetAddrInfo FAILED\" &lt;&lt; endl;\n        WSACleanup();\n        system(\"pause\");\n    }\n\n    // Attempt to connect to the first address returned by\n    // the call to getaddrinfo\n    ptr = result;\n\n    // Create a SOCKET for connecting to server\n    ConnectSocket = socket(ptr-&gt;ai_family, ptr-&gt;ai_socktype,\n        ptr-&gt;ai_protocol);\n\n    if (ConnectSocket == INVALID_SOCKET) {\n        cout &lt;&lt; \"Error at socket(): \" &lt;&lt; WSAGetLastError() &lt;&lt; endl;\n        freeaddrinfo(result);\n        WSACleanup();\n        system(\"pause\");\n    }\n\n    // Connect to server.\n    if (connect(ConnectSocket, ptr-&gt;ai_addr, (int)ptr-&gt;ai_addrlen) == SOCKET_ERROR) {\n        closesocket(ConnectSocket);\n        ConnectSocket = INVALID_SOCKET;\n    }\n\n    // Should really try the next address returned by getaddrinfo\n    // if the connect call failed\n    // But for this simple example we just free the resources\n    // returned by getaddrinfo and print an error message\n\n    freeaddrinfo(result);\n\n    if (ConnectSocket == INVALID_SOCKET) {\n        cout &lt;&lt; \"Unable to connect to server!\\n\" &lt;&lt; endl;\n        WSACleanup();\n        system(\"pause\");\n    }\n    else { cout &lt;&lt; \"CONNECTED!!!\" &lt;&lt; endl; }\n\n    string pass = \"PASS none\\r\\n\", nick = \"NICK TestUserFoo\\r\\n\", user = \"USER guest 0 * :TestUserFoo\\r\\n\", join = \"JOIN #etc\";\n    SendData(pass);\n    SendData(nick);\n    SendData(user);\n    SendData(join);\n\n    char recvbuf[512];\n\n    int iResult;\n\n    cout &lt;&lt; \"Data Sent\" &lt;&lt; endl;\n\n    // shutdown the connection for sending since no more data will be sent\n    // the client can still use the ConnectSocket for receiving data\n    /*iResult = shutdown(ConnectSocket, SD_SEND);\n    if (iResult == SOCKET_ERROR) {\n        printf(\"shutdown failed: %d\\n\", WSAGetLastError());\n        closesocket(ConnectSocket);\n        WSACleanup();\n        return 1;\n    }*/\n\n    // Receive data until the server closes the connection\n    do {\n        iResult = recv(ConnectSocket, recvbuf, sizeof(recvbuf), 0);\n        if (iResult &gt; 0)\n            cout &lt;&lt; \"Bytes received: \" &lt;&lt; iResult &lt;&lt; endl &lt;&lt; recvbuf &lt;&lt; endl;\n        else if (iResult == 0)\n            cout &lt;&lt; \"Connection closed\\n\";\n        else\n            cout &lt;&lt; \"recv failed: \" &lt;&lt; WSAGetLastError() &lt;&lt;endl;\n    } while (iResult &gt; 0);\n\n    system(\"pause\");\n}\n</code></pre>\n\n<p>I decided to connect to an empty channel on freenode and got the ip of chat.freenode.net by doing a ping-ing it. When I connect, here is my output:</p>\n\n<pre><code>WinSock Started\nCONNECTED!!!\nPASS none\n\nNICK TestUserFoo\n\nUSER guest 0 * :TestUserFoo\n\nJOIN #etc\nData Sent\nBytes received: 62\n:card.freenode.net NOTICE * :*** Looking up your hostname...\n\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u255a\u03a3v\nBytes received: 103\n:card.freenode.net NOTICE * :*** Checking Ident\n:card.freenode.net NOTICE * :*** Found your hostname\n\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u255a\u03a3v\n</code></pre>\n\n<p>It seems my commands sent for PASS NICK and USER aren't being interpreted or properly sent to the IRC server since I'm not getting a response back. What is going on?</p>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 954, "user_id": 8726235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fuUBe.jpg?s=128&g=1", "display_name": "Eduardo Soares", "link": "https://stackoverflow.com/users/8726235/eduardo-soares"}, "edited": false, "score": 0, "creation_date": 1531954204, "post_id": 51412007, "comment_id": 89795624, "body": "I don&#39;t understand your question. Do you wanna to add 1 more dimension to vector?"}, {"owner": {"reputation": 954, "user_id": 8726235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fuUBe.jpg?s=128&g=1", "display_name": "Eduardo Soares", "link": "https://stackoverflow.com/users/8726235/eduardo-soares"}, "edited": false, "score": 0, "creation_date": 1531954311, "post_id": 51412007, "comment_id": 89795644, "body": "The column number is gonna be the size of the vector rows"}, {"owner": {"reputation": 1165, "user_id": 9281750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8498cc436eda8c1bd8920dee3fd1b117?s=128&d=identicon&r=PG&f=1", "display_name": "gchen", "link": "https://stackoverflow.com/users/9281750/gchen"}, "edited": false, "score": 1, "creation_date": 1531954556, "post_id": 51412007, "comment_id": 89795709, "body": "You can iterate through each row and push_back a new element at the end of each row"}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1531955592, "post_id": 51412129, "comment_id": 89796005, "body": "I&#39;ll emphasize &quot;throw this code into separate functions&quot; and suggest one further improvement: create a wrapper class to help encapsulate and abstract away the inner workings. That way if you have to make changes in the future, you can do it without ripping up much, if any, any client code."}, {"owner": {"reputation": 11, "user_id": 10091055, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8E4ziV_aGQo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r0DD5hKsR31f3c6dQWAKN-5IAbCg/mo/photo.jpg?sz=128", "display_name": "justTom", "link": "https://stackoverflow.com/users/10091055/justtom"}, "edited": false, "score": 0, "creation_date": 1531955627, "post_id": 51412129, "comment_id": 89796011, "body": "Thank you this is what I wanted to do but can u explain what exactly the for (auto &amp;row : matrix) thing does :)"}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1531956042, "post_id": 51412129, "comment_id": 89796106, "body": "<a href=\"https://en.cppreference.com/w/cpp/language/range-for\" rel=\"nofollow noreferrer\">That&#39;s a range-based for loop</a>. It&#39;s a little cleaner than the traditional for loop, but feel free to stick to traditional counter loops if you&#39;re accustomed to them; the logic is the same."}], "tags": [], "owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "is_accepted": true, "score": 2, "last_activity_date": 1531955465, "last_edit_date": 1531955465, "creation_date": 1531954972, "answer_id": 51412129, "question_id": 51412007, "link": "https://stackoverflow.com/questions/51412007/how-to-add-a-column-to-a-multi-dimesional-vector-c/51412129#51412129", "title": "How to add a column to a multi-dimesional vector (C++)?", "body": "<p>Adding to your code, the idea is to loop over each row in the matrix and push a new element onto each vector. Together, all of these elements are a new column.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\nint main() {\n\n    // Initialize a 3x3 matrix\n    vector&lt;vector&lt;int&gt;&gt; matrix;\n    vector&lt;int&gt; row;\n    int x = 3;\n\n    for (int i = 0; i &lt; x; i++) {\n        row.push_back(i);\n    }\n\n    for (int i = 0; i &lt; x; i++) {\n        matrix.push_back(row);\n    }\n\n    // Add a column; the matrix is now 3x4\n    int newElement = 3;\n\n    for (auto &amp;row : matrix) {\n        row.push_back(newElement);\n    }\n\n    // Print the matrix\n    for (auto &amp;row : matrix) {\n        for (auto &amp;cell : row) {\n            cout &lt;&lt; cell &lt;&lt; ' ';\n        }\n\n        cout &lt;&lt; endl;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>You'll likely want to separate this code into functions.</p>\n"}, {"comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "reply_to_user": {"reputation": 11, "user_id": 10091055, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8E4ziV_aGQo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r0DD5hKsR31f3c6dQWAKN-5IAbCg/mo/photo.jpg?sz=128", "display_name": "justTom", "link": "https://stackoverflow.com/users/10091055/justtom"}, "edited": false, "score": 0, "creation_date": 1531956876, "post_id": 51412228, "comment_id": 89796311, "body": "@justTom And that&#39;s exactly what this code does. Additionally, it permits to specift the exact column number where you want to insert a new one. I, however, don&#39;t quite understand your &quot;<i>and more dynamic</i>&quot; comment. Care to elaborate? Also - his method allows you to add a column of identical numbers. My solution offers adding a column made of any <code>int</code>s"}], "tags": [], "owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "is_accepted": false, "score": 0, "last_activity_date": 1531956144, "last_edit_date": 1531956144, "creation_date": 1531955836, "answer_id": 51412228, "question_id": 51412007, "link": "https://stackoverflow.com/questions/51412007/how-to-add-a-column-to-a-multi-dimesional-vector-c/51412228#51412228", "title": "How to add a column to a multi-dimesional vector (C++)?", "body": "<p>Here is a simple function that will add a column to your matrix at a specified position:</p>\n\n<pre><code>void add_column(std::vector&lt;std::vector&lt;int&gt;&gt;&amp; matrix,\n                const std::vector&lt;int&gt;&amp; column, std::size_t position)\n{\n    if(matrix.size() &lt; position || position &lt; 0) return; // check for position correctness\n\n    std::size_t index = 0;\n    for(auto&amp; row : matrix){\n        row.insert(row.begin() + position, column[index++]);\n    }\n}\n</code></pre>\n\n<p>For example, given a matrix:</p>\n\n<pre><code>std::vector&lt;std::vector&lt;int&gt;&gt; matrix;\n</code></pre>\n\n<p>and initializing it like so:</p>\n\n<pre><code>std::vector&lt;int&gt; column;\nfor (int i = 0; i &lt; 3; i++) {\n    column.push_back(3);\n}\nfor (int i = 0; i &lt; 3; i++) {\n    matrix.push_back(column);\n}\n</code></pre>\n\n<p>you end with with 3x3 matrix of <code>3</code>s. Now, adding a column in between the first and the second one:</p>\n\n<pre><code>add_column(matrix, std::vector&lt;int&gt;({9, 9, 9}), 1);\n</code></pre>\n\n<p>and printing it:</p>\n\n<pre><code>for (auto&amp; row : matrix) {\n    for (const auto x : row) {\n        std::cout &lt;&lt; x &lt;&lt; ' ';\n    }\n    std::cout &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>You end up with:</p>\n\n<pre><code>3 9 3 3\n3 9 3 3\n3 9 3 3\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 634, "user_id": 4450986, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/NFN4Q.png?s=128&g=1", "display_name": "Pierre-Antoine Guillaume", "link": "https://stackoverflow.com/users/4450986/pierre-antoine-guillaume"}, "edited": false, "score": 0, "creation_date": 1534754080, "post_id": 51413121, "comment_id": 90803293, "body": "I upvoted because abstracting <i>is</i> the correct way to learn programmation, but what the user gave was maybe a minimal working version of his problem !"}], "tags": [], "owner": {"reputation": 249, "user_id": 6814658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9415554eef74e2169ce3e459c177ff75?s=128&d=identicon&r=PG", "display_name": "lewis", "link": "https://stackoverflow.com/users/6814658/lewis"}, "is_accepted": false, "score": 1, "last_activity_date": 1531964016, "creation_date": 1531964016, "answer_id": 51413121, "question_id": 51412007, "link": "https://stackoverflow.com/questions/51412007/how-to-add-a-column-to-a-multi-dimesional-vector-c/51413121#51413121", "title": "How to add a column to a multi-dimesional vector (C++)?", "body": "<p>vector&lt;vector&lt;T&gt;&gt; is a BAD way to implement a matrix. Well - it may not be a bad backend implementation, but its a bad public API.</p>\n\n<p>I'd suggest using some library designed to support a Matrix. A few come to mind:</p>\n\n<pre><code>https://github.com/SophistSolutions/Stroika/blob/V2.1-Release/Library/Sources/Stroika/Foundation/Math/LinearAlgebra/Matrix.h\nhttps://docs.opencv.org/3.4/d3/d63/classcv_1_1Mat.html\nhttp://arma.sourceforge.net/docs.html#part_classes\n</code></pre>\n\n<p>or write your own and implement the basic functions directly.</p>\n"}], "owner": {"reputation": 11, "user_id": 10091055, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8E4ziV_aGQo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r0DD5hKsR31f3c6dQWAKN-5IAbCg/mo/photo.jpg?sz=128", "display_name": "justTom", "link": "https://stackoverflow.com/users/10091055/justtom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "accepted_answer_id": 51412129, "answer_count": 3, "score": 0, "last_activity_date": 1559680074, "creation_date": 1531954073, "last_edit_date": 1559680074, "question_id": 51412007, "link": "https://stackoverflow.com/questions/51412007/how-to-add-a-column-to-a-multi-dimesional-vector-c", "title": "How to add a column to a multi-dimesional vector (C++)?", "body": "<p>This might be easy but I just cant find a solution. I created a 2D vector like this:</p>\n\n<pre><code>vector&lt;vector&lt;int&gt; &gt; matrix;\nvector&lt;int&gt; row;\n\nfor (int i = 0; i &lt; x;i++) {\n    row.push_back(i);\n}\nfor (int i = 0; i &lt; x; i++) {\n    matrix.push_back(row);\n}\n</code></pre>\n\n<p>The problem I have is that I now wanna add rows and columns as I need them because I might run out of matrix space over time but I don't know how to do it. The rows are easy I can just .push_back another row to the bottom end of the matrix...but I have no Idea how to add another column.</p>\n\n<p>I'm sorry if this question is super stupid but I'm not that experienced in programming yet and I couldn't find anything on the particular problem of adding columns to a 2D vector.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1531954557, "post_id": 51412002, "comment_id": 89795711, "body": "This, as most questions which give the strong impression of being a blind homework dump, is too braod to be answered. At least please define a coding frame by providing a program which has some sample data in  suitable datastructures and produces an (possibly incorrect) output of the desired shape. Consider stating that you would appreciate help according to the compromise described here: <a href=\"https://meta.stackoverflow.com/questions/334822/how-do-i-ask-and-answer-homework-questions\" title=\"how do i ask and answer homework questions\">meta.stackoverflow.com/questions/334822/&hellip;</a>"}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1531954664, "post_id": 51412002, "comment_id": 89795748, "body": "Are you supposed to do this in C AND in C++? Or with code which can be compiled by both compilers? Are you supposed to stay within integers? Or can you interpret the input as different datatypes, especially strings?"}, {"owner": {"reputation": 3, "user_id": 10102056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/437bf5e2212086cb115fa75754c8188f?s=128&d=identicon&r=PG&f=1", "display_name": "Pawe\u0142", "link": "https://stackoverflow.com/users/10102056/pawe%c5%82"}, "reply_to_user": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1531984955, "post_id": 51412002, "comment_id": 89804371, "body": "Sorry, that was my 1st question on Stack, I wasn&#39;t expecting a ready complete code, any good tips about methodology would be just fine. It&#39;s not said that I can&#39;t interpret the input as another datatype, so I think it&#39;s possible."}], "answers": [{"comments": [{"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 1, "creation_date": 1531957092, "post_id": 51412027, "comment_id": 89796363, "body": "<code>find_first_of()</code> will search for <b>any one of the characters</b> in the given string. I think the OP wants to search for the whole substring and should use <code>find()</code> instead."}, {"owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "reply_to_user": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 0, "creation_date": 1531958616, "post_id": 51412027, "comment_id": 89796683, "body": "Hey wow thanks for the feedback, I don&#39;t think I ever knew that! I&#39;ve updated the answer to be more accurate"}], "tags": [], "owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "is_accepted": true, "score": 0, "last_activity_date": 1531958588, "last_edit_date": 1531958588, "creation_date": 1531954243, "answer_id": 51412027, "question_id": 51412002, "link": "https://stackoverflow.com/questions/51412002/returning-position-of-int/51412027#51412027", "title": "Returning position of int", "body": "<p>The easiest way to do this would be to convert them both to <code>std::string</code>, and then you can use functions of <code>std::string</code> to find the index, similar to how you'd have <code>indexOf</code> for Java.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nint main()\n{\n    int a = 53;\n    int b = 513953786;\n    std::string number = std::to_string(b);\n    std::string numberToFind = std::to_string(a);\n    auto index = number.find(numberToFind);\n    std::cout &lt;&lt; index;\n}\n</code></pre>\n\n<p>This will return <code>4</code>, since I moved the <code>53</code> to be at the 4th index to show it won't find the earlier <code>5</code> or <code>3</code> I added, per the advice of @Blastfurnace in the comments</p>\n"}, {"comments": [{"owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "edited": false, "score": 0, "creation_date": 1531958757, "post_id": 51412229, "comment_id": 89796708, "body": "<code>find</code> returns a <code>size_t</code> and will return <code>std::string::npos</code> if the string is not found, so your function would ideally also return <code>size_t</code>"}], "tags": [], "owner": {"reputation": 1, "user_id": 7366938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3d3042eca5fc207f53f4123c5c71278?s=128&d=identicon&r=PG&f=1", "display_name": "L. Holme", "link": "https://stackoverflow.com/users/7366938/l-holme"}, "is_accepted": false, "score": 0, "last_activity_date": 1531955837, "creation_date": 1531955837, "answer_id": 51412229, "question_id": 51412002, "link": "https://stackoverflow.com/questions/51412002/returning-position-of-int/51412229#51412229", "title": "Returning position of int", "body": "<p>What about using the c++ function: <a href=\"http://www.cplusplus.com/reference/string/string/find/\" rel=\"nofollow noreferrer\">std::find()</a>? You could then do something like this:</p>\n\n<pre><code>int getIndex(int a, int b){\n      std::string a_str = std::to_string(a);\n      std::string b_str = std::to_string(b);\n      return a_str.find(b_str);\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10102056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/437bf5e2212086cb115fa75754c8188f?s=128&d=identicon&r=PG&f=1", "display_name": "Pawe\u0142", "link": "https://stackoverflow.com/users/10102056/pawe%c5%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "closed_date": 1531955391, "accepted_answer_id": 51412027, "answer_count": 2, "score": -2, "last_activity_date": 1531984829, "creation_date": 1531954053, "last_edit_date": 1531984829, "question_id": 51412002, "link": "https://stackoverflow.com/questions/51412002/returning-position-of-int", "closed_reason": "Needs more focus", "title": "Returning position of int", "body": "<p>The task is to return the leftmost position of given int A in larger int B (counting from 0)</p>\n\n<p>A = 53, B = 1953786, \nreturn: 2 </p>\n\n<p>I've found similar problem, but in that solution java function \"indexOf\" was used, is there a possibility to do it in other way? </p>\n"}, {"tags": ["c++", "templates", "c++17", "overloading"], "answers": [{"comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1531954496, "post_id": 51412050, "comment_id": 89795690, "body": "Indeed, if you place <code>Value</code> in a namespace, you get the exact same compilation error: <a href=\"https://godbolt.org/g/BeShHV\" rel=\"nofollow noreferrer\">godbolt.org/g/BeShHV</a>"}, {"owner": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "edited": false, "score": 0, "creation_date": 1531955073, "post_id": 51412050, "comment_id": 89795859, "body": "Intersting! Thanks for explaining this. The page I linked to was way to convoluted for me to ever derive such a clear and concise explanation as yours! Just to be clear, the point of instantiation here is the invocation of the function, correct? (which is why you can&#39;t put all the declarations below their usage?) Is there any reason why it works this way? Does this enable some behavior that would otherwise be impossible? This seems very counterintuitive."}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "edited": false, "score": 0, "creation_date": 1531976929, "post_id": 51412050, "comment_id": 89800626, "body": "@BaileyParker With function templates, it was clear that something allowing later declarations to be seen was needed, but allowing that in the general case is problematic. I think it&#39;s sort of a balancing act, it needs to be useful enough for the programmers to use, but not so complex that compiler vendors couldn&#39;t reasonably implement it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "is_accepted": true, "score": 5, "last_activity_date": 1531954439, "creation_date": 1531954439, "answer_id": 51412050, "question_id": 51411953, "link": "https://stackoverflow.com/questions/51411953/why-does-overloaded-function-template-order-matter-for-fundamental-types/51412050#51412050", "title": "Why does overloaded function template order matter for fundamental types?", "body": "<blockquote>\n  <p>In my research, I had a suspicion that this had to deal with ADL (which I admit I do not fully understand).</p>\n</blockquote>\n\n<p>You're right that this is the problem.</p>\n\n<blockquote>\n  <p>But my best interpretation of this is, at the end of searching in the case of <code>Container&lt;int&gt;</code>, the set should have found <code>int</code> due to ordinary unqualified lookup.</p>\n</blockquote>\n\n<p>Ordinary unqualified lookup cannot see the <code>template &lt;typename T&gt; void visit(const T &amp;v)</code> overload because it hasn't been declared yet. Argument-dependent lookup is an exception to that; it can see all declarations at the point of instantiation.</p>\n\n<p>The type <code>int</code> is a built-in type not related to any particular namespace. Because <code>int</code> does not have any associated namespaces, there are no namespaces in which ADL searches for declarations, so there is no way for the second declaration to be found.</p>\n\n<p>The type <code>Value</code> is a user-defined type in the global namespace. Because of that, ADL searches in the global namespace for declarations, and in that case, it does find the second declaration.</p>\n"}], "owner": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 51412050, "answer_count": 1, "score": 1, "last_activity_date": 1531954439, "creation_date": 1531953671, "question_id": 51411953, "link": "https://stackoverflow.com/questions/51411953/why-does-overloaded-function-template-order-matter-for-fundamental-types", "title": "Why does overloaded function template order matter for fundamental types?", "body": "<p>For illustration purposes, say I have this contrived container:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct Container {\n    T v;\n};\n</code></pre>\n\n<p>And this contrived \"value:\"</p>\n\n<pre><code>struct Value {};\n</code></pre>\n\n<p>I have a recursive templated function declared exactly like so:</p>\n\n<pre><code>template &lt;typename T&gt;\nvoid visit(const Container&lt;T&gt; &amp;c) {\n    visit(c.v);\n}\n\ntemplate &lt;typename T&gt;\nvoid visit(const T &amp;v) {}\n</code></pre>\n\n<p>With the above, it is perfectly valid to invoke <code>visit(Value{})</code>. I can also invoke:</p>\n\n<pre><code>void this_works_too(Container&lt;Value&gt; c) {\n    visit(c);\n}\n</code></pre>\n\n<p>This is a little puzzling, because the recursive call <code>visit(c.v)</code> occurs before its definition.</p>\n\n<p>But, when we try the following, we get an error (both from clang 6 and gcc 8):</p>\n\n<pre><code>void this_blows_up(Container&lt;int&gt; c) {\n    visit(c);\n}\n</code></pre>\n\n<p>It complains about the recursive call <code>visit(c.v)</code> now:</p>\n\n<pre><code>error: call to function 'visit' that is neither visible in the\n       template definition nor found by argument dependent lookup\n</code></pre>\n\n<p>However, if we reorder the declarations of <code>visit</code>:</p>\n\n<pre><code>template &lt;typename T&gt;\nvoid visit(const T &amp;c) {}\n\ntemplate &lt;typename T&gt;\nvoid visit(const Container&lt;T&gt; &amp;c) {\n    visit(c.v);\n}\n</code></pre>\n\n<p>Both, <code>this_works_too</code> and <code>this_blows_up</code> compile, successfully.</p>\n\n<p>(This behavior also happens for STL containers and is irrespective of the <code>const</code> and reference qualifiers)</p>\n\n<p>Why does the order become important for specializing <code>visit(Container&lt;int&gt;)</code> when it wasn't for <code>visit(Container&lt;Value&gt;)</code>?</p>\n\n<p>In my research, I had a suspicion that this had to deal with <a href=\"https://en.cppreference.com/w/cpp/language/adl\" rel=\"nofollow noreferrer\">ADL</a> (which I admit I do not fully understand). But my best interpretation of this is, at the end of searching in the case of <code>Container&lt;int&gt;</code>, the set should have found <code>int</code> due to ordinary <a href=\"https://en.cppreference.com/w/cpp/language/lookup\" rel=\"nofollow noreferrer\">unqualified lookup</a>. So, both <code>Container&lt;int&gt;</code> and <code>Container&lt;Value&gt;</code> should work.</p>\n\n<p><a href=\"https://godbolt.org/g/QFnRKN\" rel=\"nofollow noreferrer\">Godbolt demonstrating this</a></p>\n\n<p>I have confirmed that despite the reordering, the correct overload is called (ie. when <code>visit(T)</code> is first, <code>visit(Container&lt;T&gt;)</code> is actually invoked for <code>visit(Container&lt;int&gt;)</code> instead of just choosing the more generic <code>visit(T)</code>). I believe this is because the most specific specialization is chosen.</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1531953360, "post_id": 51411879, "comment_id": 89795387, "body": "Looks like you have to iterate over one and do lookup on another"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1531953631, "post_id": 51411879, "comment_id": 89795461, "body": "And you would want to read <a href=\"https://en.cppreference.com/w/cpp/container/unordered_map/operator_cmp\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/unordered_map/operator_c&zwnj;&#8203;mp</a> before implementing it. It&#39;s not quite as easy as it looks."}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 0, "creation_date": 1531956657, "post_id": 51411879, "comment_id": 89796257, "body": "@NeilButterworth That&#39;s a very interesting read.  Let&#39;s assume for a moment that the &quot;naive&quot; approach returns true iff each member of <code>lhs</code> is in <code>rhs</code> and vice versa, noting that member in this context means <code>pair&lt;key, value&gt;</code>.  Does this definition have the same semantic meaning as the combination of the two bullet items on your linked page, and if not, what might be an example of two maps that disagree on their equality when compared with criteria I&#39;ve stated and <code>unordered_map::operator==</code>."}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1531956931, "post_id": 51411879, "comment_id": 89796331, "body": "It&#39;s really a nuisance that your compiler does not support the standard. Is there no way to use a more recent version?"}, {"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "reply_to_user": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1531959347, "post_id": 51411879, "comment_id": 89796844, "body": "@Walter pretty sure gcc 4.4 <a href=\"https://gcc.gnu.org/gcc-4.4/cxx0x_status.html\" rel=\"nofollow noreferrer\">doesn&#39;t fully support C++11</a> so its not surprising it&#39;d have an incomplete <code>std::unordered_map</code> implementation"}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "reply_to_user": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1531960198, "post_id": 51411879, "comment_id": 89797041, "body": "@Walter sadly no, I&#39;ve tried my best.  I&#39;ve gotten to where I don&#39;t have to support gcc 4.4 itself, but Intel uses the gcc STL, so I can&#39;t avoid it."}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1531960278, "post_id": 51411879, "comment_id": 89797052, "body": "@NeilButterworth I&#39;m not entirely sure what that&#39;s saying, how can you have multiple values that have an equal key?"}, {"owner": {"reputation": 583, "user_id": 1948525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5bccd182ec2401b4f8e031067b45d1?s=128&d=identicon&r=PG", "display_name": "SJHowe", "link": "https://stackoverflow.com/users/1948525/sjhowe"}, "edited": false, "score": 1, "creation_date": 1531970074, "post_id": 51411879, "comment_id": 89798962, "body": "Sean McAllister: I have seen the page Neil quotes and  agree with you and disagree with the page. With unordered_map, it is enough to iterate through the keys, see if the other key exists in the other containerr and I ssume the values are the same. If it was  unordered_multimap, for each key is the number of each had to be the same and the values are a permutation of each other"}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "reply_to_user": {"reputation": 583, "user_id": 1948525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5bccd182ec2401b4f8e031067b45d1?s=128&d=identicon&r=PG", "display_name": "SJHowe", "link": "https://stackoverflow.com/users/1948525/sjhowe"}, "edited": false, "score": 0, "creation_date": 1531978685, "post_id": 51411879, "comment_id": 89801227, "body": "@SJHowe There is indeed something wrong in that cppreference page (a rarity): since <code>unordered_map</code> stores unique keys, there is no range of equivalent keys. The page looks like it should be for <code>unordered_multimap</code>."}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "reply_to_user": {"reputation": 583, "user_id": 1948525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5bccd182ec2401b4f8e031067b45d1?s=128&d=identicon&r=PG", "display_name": "SJHowe", "link": "https://stackoverflow.com/users/1948525/sjhowe"}, "edited": false, "score": 0, "creation_date": 1532060281, "post_id": 51411879, "comment_id": 89840124, "body": "@SJHowe and Walter, unordered_map does indeed have an equal_range function though.  I think perhaps you can have keys that compare equal and hash differently?"}, {"owner": {"reputation": 583, "user_id": 1948525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5bccd182ec2401b4f8e031067b45d1?s=128&d=identicon&r=PG", "display_name": "SJHowe", "link": "https://stackoverflow.com/users/1948525/sjhowe"}, "edited": false, "score": 0, "creation_date": 1532108731, "post_id": 51411879, "comment_id": 89866165, "body": "Sean McAllister: Yes I think that is possible. Your 2 containers could be different sizes before elements being erased and bring them down to the same size before a compare. Therefore hash buckets could be different. But they should be comparable for equality of keys."}], "owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531955980, "creation_date": 1531953136, "question_id": 51411879, "link": "https://stackoverflow.com/questions/51411879/how-to-check-two-unordered-map-instances-for-equality-in-gcc-4-4", "title": "How to check two unordered_map instances for equality in gcc 4.4?", "body": "<p>It looks like the STL in gcc 4.4 doesn't include operator== for unordered_map.  (I'm forced to support RHEL6, and I'm using the intel compiler to do it, but it uses GCC's STL).  Absent that definition, how can I reliably (and quickly) compare two unordered_map instances for equality?</p>\n"}, {"tags": ["c++", "function-pointers"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1531952478, "post_id": 51411756, "comment_id": 89795189, "body": "Whenever you see <code>void *</code>, consider you probably have something wrong."}, {"owner": {"reputation": 280, "user_id": 798064, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/43adc507a7618475e3176e93df2ce909?s=128&d=identicon&r=PG", "display_name": "GeneralZero", "link": "https://stackoverflow.com/users/798064/generalzero"}, "edited": false, "score": 0, "creation_date": 1531953326, "post_id": 51411756, "comment_id": 89795381, "body": "@NeilButterworth How else would you pass function pointers that can have zero or one varables."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1531953774, "post_id": 51411756, "comment_id": 89795509, "body": "Function pointers are not guaranteed to be convertible to <code>void *</code>, or vice versa, so this is moot.  As your question is about C++, you should probably  be using function objects."}, {"owner": {"reputation": 280, "user_id": 798064, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/43adc507a7618475e3176e93df2ce909?s=128&d=identicon&r=PG", "display_name": "GeneralZero", "link": "https://stackoverflow.com/users/798064/generalzero"}, "edited": false, "score": 0, "creation_date": 1531954231, "post_id": 51411756, "comment_id": 89795628, "body": "@NeilButterworth How do you do function objects that have different function signatures?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1531954456, "post_id": 51411756, "comment_id": 89795683, "body": "If you are writing a simple CPU simulator, then don&#39;t use function pointers. Speaking as someone that wrote a fairly complete 8080 simulator and development environment in FORTRAN77 way back when."}], "answers": [{"comments": [{"owner": {"reputation": 280, "user_id": 798064, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/43adc507a7618475e3176e93df2ce909?s=128&d=identicon&r=PG", "display_name": "GeneralZero", "link": "https://stackoverflow.com/users/798064/generalzero"}, "edited": false, "score": 0, "creation_date": 1531954167, "post_id": 51411775, "comment_id": 89795611, "body": "I cant cast to it  src/cpu/cpu.cpp:19:64: error: invalid conversion from \u2018void (<i>)(unsigned char)\u2019 to \u2018void (</i>)(void*)\u2019 [-fpermissive]   opcodes[0x06] = (instruction){ &quot;LD B, 0x%02X&quot;, 1, load_n_to_b };"}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "reply_to_user": {"reputation": 280, "user_id": 798064, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/43adc507a7618475e3176e93df2ce909?s=128&d=identicon&r=PG", "display_name": "GeneralZero", "link": "https://stackoverflow.com/users/798064/generalzero"}, "edited": false, "score": 0, "creation_date": 1531957527, "post_id": 51411775, "comment_id": 89796461, "body": "@GeneralZero hmm apparently you should study C/C++, it is a kinda common subject for both."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 280, "user_id": 798064, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/43adc507a7618475e3176e93df2ce909?s=128&d=identicon&r=PG", "display_name": "GeneralZero", "link": "https://stackoverflow.com/users/798064/generalzero"}, "edited": false, "score": 0, "creation_date": 1531958835, "post_id": 51411775, "comment_id": 89796727, "body": "@GeneralZero you would have to change <code>void load_n_to_b(unsigned char arg1);</code> to <code>void load_n_to_b(void *arg1);</code>, and change <code>void load_c_to_b();</code> to <code>void load_c_to_b(void*);</code> In cases where there is no argument to pass, pass null: <code>inst.execute(nullptr);</code>. In cases where there is an argument to pass, pass it in by its address and type-cast the pointer in the function, eg: <code>unsigned char value = ...; inst.execute(&amp;value); ... void load_n_to_b(void *arg1) { unsigned char arg = *static_cast&lt;unsigned char*&gt;(arg1); ... }</code> If you have more than 1 argument to pass, pass in a <code>struct</code> by pointer."}], "tags": [], "owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "is_accepted": false, "score": 1, "last_activity_date": 1531952430, "creation_date": 1531952430, "answer_id": 51411775, "question_id": 51411756, "link": "https://stackoverflow.com/questions/51411756/c-function-pointers-in-struct-with-0-or-1-argument/51411775#51411775", "title": "C++ Function Pointers in struct with 0 or 1 argument", "body": "<p>You hold pointer to <code>void</code> in <code>instruction</code> struct. Instead, you require function pointer.</p>\n\n<pre><code>void (*execute)() ;\n</code></pre>\n\n<p>It applies to <code>load_c_to_b</code> because its parameter is <code>void</code> as well. However, I would prefer <code>void (*execute)(void*)</code> because if I need a parameter I can use it by casting, otherwise, ignore it.</p>\n"}], "owner": {"reputation": 280, "user_id": 798064, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/43adc507a7618475e3176e93df2ce909?s=128&d=identicon&r=PG", "display_name": "GeneralZero", "link": "https://stackoverflow.com/users/798064/generalzero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531952430, "creation_date": 1531952245, "question_id": 51411756, "link": "https://stackoverflow.com/questions/51411756/c-function-pointers-in-struct-with-0-or-1-argument", "title": "C++ Function Pointers in struct with 0 or 1 argument", "body": "<p>Here I declare a structure and I have an array of them in my class.</p>\n\n<pre><code>struct instruction {\n    std::string disassembly;\n    unsigned char operandLength;\n    void* execute;\n};\n\n...\n\nclass CPU {\nprivate:\n    struct instruction opcodes[256];\n\n    void load_n_to_b(unsigned char arg1); //0x06\n    void load_c_to_b(); //0x41 \n\n...\n\n}\n</code></pre>\n\n<p>I have tried to initialize the opcode array but keep getting errors about \"too many initializers for 'instruction'\" or invalid cast from type \u2018void (*)(unsigned char)\u2019 to type \u2018void*\u2019. Because the functions can have either 0 arguments or 1 argument I do not know how to make it work in C++.</p>\n\n<p>I am initializing them like so below</p>\n\n<pre><code>opcodes[0x06] = instruction{ \"LD B, 0x%02X\", 1, load_n_to_b };\nopcodes[0x41] = instruction{ \"LD B, C\", 0, load_c_to_b };\n</code></pre>\n"}, {"tags": ["java", "c++", "jvm", "java-native-interface", "jnienv"], "comments": [{"owner": {"reputation": 12819, "user_id": 845414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fbe63f77ce3f9656c62b27db4d8583b?s=128&d=identicon&r=PG", "display_name": "Johannes Kuhn", "link": "https://stackoverflow.com/users/845414/johannes-kuhn"}, "edited": false, "score": 0, "creation_date": 1531951653, "post_id": 51411581, "comment_id": 89794906, "body": "What is running? A loop?"}, {"owner": {"reputation": 15, "user_id": 10072244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b18a97f29b654510cef0f4b4c46bf4?s=128&d=identicon&r=PG&f=1", "display_name": "JamesTrix", "link": "https://stackoverflow.com/users/10072244/jamestrix"}, "reply_to_user": {"reputation": 12819, "user_id": 845414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fbe63f77ce3f9656c62b27db4d8583b?s=128&d=identicon&r=PG", "display_name": "Johannes Kuhn", "link": "https://stackoverflow.com/users/845414/johannes-kuhn"}, "edited": false, "score": 0, "creation_date": 1531951944, "post_id": 51411581, "comment_id": 89795027, "body": "Yes there is a loop in the JNI function which returns the data"}, {"owner": {"reputation": 496326, "user_id": 57695, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=128&d=identicon&r=PG", "display_name": "Peter Lawrey", "link": "https://stackoverflow.com/users/57695/peter-lawrey"}, "edited": false, "score": 0, "creation_date": 1531992769, "post_id": 51411581, "comment_id": 89809056, "body": "So what have you tried and what are you having trouble with?  You appear to have a loop to call this method and it returns new data each time."}], "answers": [{"tags": [], "owner": {"reputation": 1908, "user_id": 2543253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a87e0065d4c5036eb7adabe2edfd187?s=128&d=identicon&r=PG", "display_name": "user2543253", "link": "https://stackoverflow.com/users/2543253/user2543253"}, "is_accepted": false, "score": 0, "last_activity_date": 1531995681, "creation_date": 1531995681, "answer_id": 51420158, "question_id": 51411581, "link": "https://stackoverflow.com/questions/51411581/return-constant-dynamic-jni-data-to-java-object-while-application-is-running/51420158#51420158", "title": "Return Constant dynamic JNI data to Java object while application is running", "body": "<p>So you have a Java application that calls a function in a JNI library and the function in turn starts a second thread that needs to send data back to Java regularly? </p>\n\n<p>Assuming this is the case:</p>\n\n<p>Option 1 is the <a href=\"https://docs.oracle.com/javase/8/docs/technotes/guides/jni/spec/invocation.html\" rel=\"nofollow noreferrer\">invocation API</a>: <code>JNI_GetCreatedJavaVMs</code> will give you a handle to the existing VM and you can go on from there. You attach your new thread, then you can either call static methods (<code>FindClass</code>/<code>GetStaticMethodID</code>/<code>Call&lt;type&gt;Method</code>) or you can call methods in an object (<code>GetObjectClass</code>/<code>GetMethodID</code>/<code>Call&lt;type&gt;Method</code>). You would have to pass the object from Java in a previous call and keep it in a global reference. </p>\n\n<p>Option 2 is <a href=\"https://github.com/java-native-access/jna\" rel=\"nofollow noreferrer\">JNA</a>: if your library doesn't have to be a JNI library for some other reason, you can make it a \"regular\" library and call it via JNA. JNA supports passing function pointers to native functions via the <code>Callback</code> class. You can then call this callback from your new thread.</p>\n"}], "owner": {"reputation": 15, "user_id": 10072244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b18a97f29b654510cef0f4b4c46bf4?s=128&d=identicon&r=PG&f=1", "display_name": "JamesTrix", "link": "https://stackoverflow.com/users/10072244/jamestrix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531995681, "creation_date": 1531951195, "question_id": 51411581, "link": "https://stackoverflow.com/questions/51411581/return-constant-dynamic-jni-data-to-java-object-while-application-is-running", "title": "Return Constant dynamic JNI data to Java object while application is running", "body": "<p>So I have this program where i constantly retrieves data from my JNI function (in C++) when the application is running I retrieve these data in the JNI function\nbut I want to pass the data to my Java class which handles these inputs values (for instance x and y values).</p>\n\n<p>How am I supposed to pass the data to the Java class constantly while the application is running?</p>\n\n<p>Any help would be appreciated</p>\n"}, {"tags": ["c++", "eigen", "covariance-matrix"], "answers": [{"comments": [{"owner": {"reputation": 5097, "user_id": 3175480, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/agIDd.jpg?s=128&g=1", "display_name": "Gluttton", "link": "https://stackoverflow.com/users/3175480/gluttton"}, "edited": false, "score": 0, "creation_date": 1531995876, "post_id": 51416783, "comment_id": 89811285, "body": "Thanks, for the suggestion! I really appropriate it!"}], "tags": [], "owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "is_accepted": true, "score": 1, "last_activity_date": 1531985362, "creation_date": 1531985362, "answer_id": 51416783, "question_id": 51411433, "link": "https://stackoverflow.com/questions/51411433/does-eigen-have-solution-for-repair-non-positive-defined-covariance-matrix/51416783#51416783", "title": "Does Eigen have solution for repair non-positive defined covariance matrix", "body": "<p>You can use the <a href=\"https://eigen.tuxfamily.org/dox/classEigen_1_1SelfAdjointEigenSolver.html\" rel=\"nofollow noreferrer\"><code>SelfAdjointEigenSolver</code></a> to decompose your non-positive definite matrix, edit the negative eigenvalues to something slightly positive and (manually) re-compose the matrix.</p>\n"}], "owner": {"reputation": 5097, "user_id": 3175480, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/agIDd.jpg?s=128&g=1", "display_name": "Gluttton", "link": "https://stackoverflow.com/users/3175480/gluttton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "closed_date": 1531994243, "accepted_answer_id": 51416783, "answer_count": 1, "score": -2, "last_activity_date": 1531985362, "creation_date": 1531950387, "question_id": 51411433, "link": "https://stackoverflow.com/questions/51411433/does-eigen-have-solution-for-repair-non-positive-defined-covariance-matrix", "closed_reason": "Needs details or clarity", "title": "Does Eigen have solution for repair non-positive defined covariance matrix", "body": "<p>Does Eigen contains an algorithm for solving nearest correlation matrix problems?</p>\n"}, {"tags": ["c++", "dictionary", "object", "insert", "stdmap"], "comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 1, "creation_date": 1531949535, "post_id": 51411248, "comment_id": 89794076, "body": "Both are correct. Depends whether you want to you <code>foo</code> later on. As a side note, you might as well use <code>.emplace</code>."}, {"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "edited": false, "score": 0, "creation_date": 1531949644, "post_id": 51411248, "comment_id": 89794128, "body": "or also sample[0] = new Foo(), which is semantically different but in this case equivalent."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1531949786, "post_id": 51411248, "comment_id": 89794178, "body": "Case 2 allows move construction, but you are using pointers and pointers don&#39;t move more efficiently than they copy on any realistic architecture."}, {"owner": {"reputation": 1611, "user_id": 3810466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JUvyo.png?s=128&g=1", "display_name": "ricky3350", "link": "https://stackoverflow.com/users/3810466/ricky3350"}, "edited": false, "score": 0, "creation_date": 1531949894, "post_id": 51411248, "comment_id": 89794227, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/27026019/should-single-use-values-be-inline-function-level-const-variables-or-class-lev\">Should single-use values be inline, function-level const variables, or class-level static const variables?</a>"}, {"owner": {"reputation": 189, "user_id": 8266573, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207836662714292/picture?type=large", "display_name": "Josnei Luis Olszewski Junior", "link": "https://stackoverflow.com/users/8266573/josnei-luis-olszewski-junior"}, "edited": false, "score": 0, "creation_date": 1531950442, "post_id": 51411248, "comment_id": 89794446, "body": "Thanks, guys. It clarified that they are both accepted, though applied on different cases."}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 8266573, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207836662714292/picture?type=large", "display_name": "Josnei Luis Olszewski Junior", "link": "https://stackoverflow.com/users/8266573/josnei-luis-olszewski-junior"}, "edited": false, "score": 0, "creation_date": 1531950542, "post_id": 51411294, "comment_id": 89794484, "body": "One of my doubts with this question was exactly this &quot;who has the control over the object&quot;, which can be dangerous if we lose control of things. Thanks for the answer! It clarified a lot."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 189, "user_id": 8266573, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207836662714292/picture?type=large", "display_name": "Josnei Luis Olszewski Junior", "link": "https://stackoverflow.com/users/8266573/josnei-luis-olszewski-junior"}, "edited": false, "score": 0, "creation_date": 1531950597, "post_id": 51411294, "comment_id": 89794513, "body": "@JosneiLuisOlszewskiJunior, you&#39;re welcome. Glad I was able to help."}, {"owner": {"reputation": 413, "user_id": 640259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ae61300b46b5377d5f08acf60927785?s=128&d=identicon&r=PG", "display_name": "sam msft", "link": "https://stackoverflow.com/users/640259/sam-msft"}, "edited": false, "score": 1, "creation_date": 1531950865, "post_id": 51411294, "comment_id": 89794623, "body": "I would suggest using std::unique_ptr instead of the raw pointer.  It will a better job maintaining the lifetime of the object.  In you sample, you may be leaking the new&#39;ed pointers. Instead of new, use make_unique&lt;Foo&gt;."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 1, "last_activity_date": 1531951210, "last_edit_date": 1531951210, "creation_date": 1531949684, "answer_id": 51411294, "question_id": 51411248, "link": "https://stackoverflow.com/questions/51411248/proper-way-to-initiate-object-on-map/51411294#51411294", "title": "Proper way to initiate object on map", "body": "<p>The answer depends on the object ownership policy used in your program.</p>\n\n<p>If you expect the ownership of the dynamically allocated object to lie with <code>sample</code>, then either of the methods is ok. You'll have to make sure that before <code>sample</code> goes out of scope, all the dynamically allocated objects contained in it are deleted.</p>\n\n<p>If you expect the ownership of the dynamically allocated object to not lie with <code>sample</code>, then the second method will cause a memory leak while the first method allows you to delete the object after you are done using it.</p>\n\n<p>You can use smart pointers to manage life time of dynamically allocated objects. Then your code will become simpler no matter which method you use to add objects to the map. E.g.</p>\n\n<pre><code>std::map&lt;int, std::unique_ptr&lt;Foo&gt;&gt; sample;\nsample.insert(std::make_pair(0, std::make_unique&lt;Foo&gt;()));\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 8266573, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207836662714292/picture?type=large", "display_name": "Josnei Luis Olszewski Junior", "link": "https://stackoverflow.com/users/8266573/josnei-luis-olszewski-junior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 51411294, "answer_count": 1, "score": -1, "last_activity_date": 1531951210, "creation_date": 1531949403, "last_edit_date": 1531949522, "question_id": 51411248, "link": "https://stackoverflow.com/questions/51411248/proper-way-to-initiate-object-on-map", "title": "Proper way to initiate object on map", "body": "<p>I have a std::map that has a int as key and an object pointer as value. On creation, should I first instantiate objects separately and then insert them at the container, or can I simply call the \"new\" tag right at the insert method? Is there any advantage of using one of those other than simplifying code?</p>\n\n<pre><code>map&lt;int, Foo*&gt; sample;\n\nFoo* foo = new Foo();\n\nsample.insert(pair&lt;int, Foo*&gt;(0, foo));       //case 1\nsample.insert(pair&lt;int, Foo*&gt;(0, new Foo())); //case 2\n</code></pre>\n"}, {"tags": ["c++", "move"], "comments": [{"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 1, "creation_date": 1531948543, "post_id": 51411014, "comment_id": 89793672, "body": "Yes to 1. and 2. Can you try to explain what exactly &quot;move as a whole&quot; means in your mind? ;)"}, {"owner": {"reputation": 1604, "user_id": 6085595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fa066abb138dd22f51932878d3364cb0?s=128&d=identicon&r=PG&f=1", "display_name": "DiveIntoML", "link": "https://stackoverflow.com/users/6085595/diveintoml"}, "reply_to_user": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 0, "creation_date": 1531948678, "post_id": 51411014, "comment_id": 89793722, "body": "@MichaelKenzel I mean for example your class has 1000 instance variables, instead of changing the 1000 instance variables one by one, simply change the pointer of the class, like python and java do."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1531948903, "post_id": 51411014, "comment_id": 89793819, "body": "@DiveIntoML, are you suggesting that compile should do that for 1 member variable also? If not, what&#39;s the threshold for switching behaviors? Who decides what that threshold is?"}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 0, "creation_date": 1531949211, "post_id": 51411014, "comment_id": 89793942, "body": "@DiveIntoML How exactly do you imagine that &quot;simply change the pointer of the class&quot; would work? An object lives at a certain place in memory. That place has an address. You cannot simply change that address. The address identifies the object, not the other way around."}], "owner": {"reputation": 1604, "user_id": 6085595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fa066abb138dd22f51932878d3364cb0?s=128&d=identicon&r=PG&f=1", "display_name": "DiveIntoML", "link": "https://stackoverflow.com/users/6085595/diveintoml"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "closed_date": 1531948570, "answer_count": 0, "score": 0, "last_activity_date": 1531948152, "creation_date": 1531948152, "question_id": 51411014, "link": "https://stackoverflow.com/questions/51411014/defining-c-move-constructor-and-move-assignment-operator", "closed_reason": "Duplicate", "title": "Defining C++ move constructor and move assignment operator", "body": "<p>I am a rookie of C++ and I am looking at how to improve the efficiency of my code using move constructor and move assignment. But I have a few questions not clear about the move semantics:</p>\n\n<p>1.Do I have to declare move constructor and assignment myself? I see a lot of conditions on when a move constructor will be implicitly declared, but assume I declare the following</p>\n\n<pre><code>SomeClass(SomeClass &amp;&amp; other) = default\n</code></pre>\n\n<p>Should I get a usable move constructor implicitly?</p>\n\n<p>2.What does the implicitly declared move constructor do? Does it simply call the move constructor of its member classes one by one? And I assume the copy action is always performed for primitive types such as int.</p>\n\n<p>3.Instead of moving instance variables one by one, why does not C++ simply move the class as a whole? For example, if I have a class</p>\n\n<pre><code>SomeClass {\nprivate:\n    Class1 member1;\n    Class2 member2;\n    Class2 member3;\n}\n</code></pre>\n\n<p>then does C++ move Class1, Class2, Class3 one by one? It sounds a lot simpler if C++ move SomeClass pointer as a whole.</p>\n"}, {"tags": ["c++", "qt", "signals-slots", "qlistwidget", "qlistwidgetitem"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9150170"}, "edited": false, "score": 0, "creation_date": 1532009759, "post_id": 51414016, "comment_id": 89820921, "body": "connect(step_Widget, &amp;stepWidget::widgetClicked, [=]() {         ui-&gt;listWidget-&gt;setCurrentItem(item);     }); How did you connect it like this? Is this defining the slot right in the connection itself? It did not compile for me. Says widgetClicked is protected. I made it a signal in stepWidget."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7336312"}, "edited": false, "score": 0, "creation_date": 1532045172, "post_id": 51414016, "comment_id": 89837320, "body": "It compiles fine for me. It&#39;s the Qt5 connection style. Which version of Qt are you using? You may want to upgrade to a latest version. Connect using the Qt4 macros <code>SIGNAL</code> and <code>SLOT</code> is deprecated but still supported in Qt5, however, it&#39;s likely to be removed in Qt6. If you press ALT+RETURN inside a Qt4-style <code>connect</code>, it will show you an option to morph it into a Qt5-style <code>connect</code> statement. Also, Qt5-style connect has several advantages: <b>1.</b> It&#39;s faster. <b>2.</b> Can be checked at compile-time, not at runtime as old styles. <b>3.</b> It allows using C++11 Lambda functions."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7336312"}, "edited": false, "score": 0, "creation_date": 1532046513, "post_id": 51414016, "comment_id": 89837579, "body": "I realize that it works for me even when I put the <code>signals:</code> declarations in the same block as the <code>protected</code> declarations. You problem may reside on the version of Qt you are using or in the data you want to access from the lambda. Inside the square parenthesis you place the data that you want to access from the Lambda function. Try changing the <code>=</code> for a <code>&amp;</code> (ampersand). Of course you can also create a separate slot to manipulate the signal. You not have to stick with the Lambda if you don&#39;t know how to use it or simply you don&#39;t want to use it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7336312"}, "edited": false, "score": 0, "creation_date": 1532046883, "post_id": 51414016, "comment_id": 89837652, "body": "See this: <a href=\"http://doc.qt.io/qt-5/signalsandslots.html\" rel=\"nofollow noreferrer\">Qt Signals &amp; Slots</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7336312"}, "is_accepted": true, "score": 1, "last_activity_date": 1531972707, "last_edit_date": 1531972707, "creation_date": 1531971911, "answer_id": 51414016, "question_id": 51410977, "link": "https://stackoverflow.com/questions/51410977/qlistwidget-with-custom-widgets-not-triggering-itemclicked-signal/51414016#51414016", "title": "QListWidget with custom widgets - not triggering itemClicked signal", "body": "<p>The <code>itemClicked()</code> signal is not emmited because the <code>QPushButton</code> consumes the click event.<br>\nThere is the simplest solution I've found.<br>\nFirst, in your class <code>stepWidget</code> add a signal that will be emitted when any <code>QPushButton</code> is clicked, for example:  </p>\n\n<pre><code>signals:\n    void widgetClicked();\n</code></pre>\n\n<p>Then connect the <code>clicked()</code> signal of every <code>QPushButton</code> with that signal. This code is in the constructor of the widget <code>stepWidget</code>:  </p>\n\n<pre><code>connect(ui-&gt;pushButton1, &amp;QPushButton::clicked, this, &amp;stepWidget::widgetClicked);\nconnect(ui-&gt;pushButton2, &amp;QPushButton::clicked, this, &amp;stepWidget::widgetClicked);\nconnect(ui-&gt;pushButton3, &amp;QPushButton::clicked, this, &amp;stepWidget::widgetClicked);\n</code></pre>\n\n<p>To test it I added 10 widgets to a <code>QListWidget</code> that reside in the <code>MainWindow</code> class. You must connect that signal to a slot (in this case I use a C++11 Lambda Function, but you can create a slot instead, it's fine) where you establish the current item as the item under the widget. This code is located in the constructor of <code>MainWindow</code>:  </p>\n\n<pre><code>for (int i = 0; i &lt; 10; ++i) {\n    QListWidgetItem *item = new QListWidgetItem;\n    stepWidget *step_Widget = new stepWidget;\n    ui-&gt;listWidget-&gt;addItem(item);\n    ui-&gt;listWidget-&gt;setItemWidget(item, step_Widget);\n    connect(step_Widget, &amp;stepWidget::widgetClicked, [=]() {\n        ui-&gt;listWidget-&gt;setCurrentItem(item);\n    });\n}\n</code></pre>\n\n<p>Now, this will <strong>not</strong> make the <code>itemClicked()</code> signal to be emitted because the user not clicked the item. But I advice you to connect instead the signal <code>currentRowChanged()</code> as it will be emitted with this code and also it has the advantage that it allows you to directly obtain the row. Once you have the row you can obtain the item and the widget, evidently.<br>\nHowever, this procedure has the inconvenient that the <code>currentRowChanged()</code> signal will be emitted even when the user selects a row with the keyboard or when the user press and slide the mouse over the <code>QListWidget</code> without releasing it.<br>\nOn workaround could be, for example, using a flag as an attribute for your <code>MainWindow</code> class that is always <code>false</code> except during this connection:  </p>\n\n<pre><code>connect(ste_pWidget, &amp;stepWidget ::widgetClicked, [=]() {\n    buttonPressed = true;\n    ui-&gt;listWidget-&gt;setCurrentItem(item);\n    buttonPressed = false;\n});\n</code></pre>\n\n<p>Then you must manipulate two signals from the <code>QListWidget</code>: <code>clicked()</code> and <code>currentRowChanged()</code>. I choose <code>clicked()</code> instead of <code>itemClicked()</code> because it gives almost directly access to the row:  </p>\n\n<pre><code>void MainWindow::on_listWidget_clicked(const QModelIndex &amp;index)\n{\n    ui-&gt;statusBar-&gt;showMessage(tr(\"Row clicked: %1\").arg(index.row()), 1000);\n}\n\nvoid MainWindow::on_listWidget_currentRowChanged(int currentRow)\n{\n    if (buttonPressed) {\n        ui-&gt;statusBar-&gt;showMessage(tr(\"Row clicked: %1\").arg(currentRow), 1000);\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 14209059, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IF5OC6bfTa0/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmcqrjrbXN2YlHRYQaHi-k50WMDtQ/photo.jpg?sz=128", "display_name": "Madhuri Rawat", "link": "https://stackoverflow.com/users/14209059/madhuri-rawat"}, "is_accepted": false, "score": 0, "last_activity_date": 1599053938, "creation_date": 1599053938, "answer_id": 63706801, "question_id": 51410977, "link": "https://stackoverflow.com/questions/51410977/qlistwidget-with-custom-widgets-not-triggering-itemclicked-signal/63706801#63706801", "title": "QListWidget with custom widgets - not triggering itemClicked signal", "body": "<p>what you can simply do is, make your qpushbutton to qlabel and then qpushbutton will become clickable.\nYou can then override this method :- on_listWidget_itemClicked(QListWidgetItem *item) for double click on qpushbutton.\nI tried it &amp; it worked perfectly, its quite simple workaround.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9150170"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "accepted_answer_id": 51414016, "answer_count": 2, "score": 0, "last_activity_date": 1599053938, "creation_date": 1531947938, "question_id": 51410977, "link": "https://stackoverflow.com/questions/51410977/qlistwidget-with-custom-widgets-not-triggering-itemclicked-signal", "title": "QListWidget with custom widgets - not triggering itemClicked signal", "body": "<p>I have listwidgetitem's that have a custom widget (step_widget) which contains 3 QPushButtons and a QLabel.\nWhen I press one of the buttons in the widget, it is not triggering itemClicked which i need to see the index of the listwidget that was clicked. If i click the QLabel, the signal is triggered and i am able to obtain the index. How can trigger the signal when one of the buttons is pressed? Why does it not trigger?</p>\n\n<pre><code>QListWidgetItem *item = new QListWidgetItem();\nstepWidget *step_widget = new stepWidget();\nui-&gt;listWidget-&gt;addItem(item);\nui-&gt;listWidget-&gt;setItemWidget(item,step_widget);\n</code></pre>\n"}, {"tags": ["c++", "macos", "shutdown", "reboot", "shutdown-hook"], "comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1531947569, "post_id": 51410828, "comment_id": 89793265, "body": "Not quite a duplicate - asked with [c] tag, answered with Objective-C.  <a href=\"https://stackoverflow.com/questions/1321219\">stackoverflow.com/questions/1321219</a>"}, {"owner": {"reputation": 1729, "user_id": 1618465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7e9867486a678f1a5ddc2929c25c2a53?s=128&d=identicon&r=PG", "display_name": "user1618465", "link": "https://stackoverflow.com/users/1618465/user1618465"}, "reply_to_user": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1531947984, "post_id": 51410828, "comment_id": 89793447, "body": "Yes, I saw that one but I need to use C or C++ :)"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1531948639, "post_id": 51410828, "comment_id": 89793708, "body": "This question has nothing to with C++, it&#39;s a question about APIs and calls provided by OS."}, {"owner": {"reputation": 1729, "user_id": 1618465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7e9867486a678f1a5ddc2929c25c2a53?s=128&d=identicon&r=PG", "display_name": "user1618465", "link": "https://stackoverflow.com/users/1618465/user1618465"}, "edited": false, "score": 0, "creation_date": 1531952871, "post_id": 51410828, "comment_id": 89795271, "body": "I want to do it with C++ and not with cocoa (that&#39;s already answered) so yes, it has something to do with it"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1531954400, "post_id": 51410828, "comment_id": 89795666, "body": "@user1618465: I think you are missing Sergey&#39;s point. This question has nothing to do with C++ the language (as C++ absolutely nowhere in the standard talks about hardware or OS requirements; this is unlike coco that does build in some OS/Hardware into the language). The problem is an OS one. What API does the OS provided you that notifies you of a shutdown. You have to know this API so that you can call it from C++."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1531954571, "post_id": 51410828, "comment_id": 89795716, "body": "I would bet this is a signal sent to each running ap by the OS just prior to shutdown. You may want to search SO for shutdown signal from the OS."}, {"owner": {"reputation": 21298, "user_id": 309425, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75a67cd9a3d7367a6e594fcbe5e41400?s=128&d=identicon&r=PG", "display_name": "JWWalker", "link": "https://stackoverflow.com/users/309425/jwwalker"}, "edited": false, "score": 1, "creation_date": 1531962372, "post_id": 51410828, "comment_id": 89797456, "body": "That other question&#39;s answer uses <code>NSNotificationCenter</code>, but I bet you could use <code>CFNotificationCenterGetLocalCenter</code> and <code>CFNotificationCenterAddObserver</code> using toll-free bridging."}], "owner": {"reputation": 1729, "user_id": 1618465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7e9867486a678f1a5ddc2929c25c2a53?s=128&d=identicon&r=PG", "display_name": "user1618465", "link": "https://stackoverflow.com/users/1618465/user1618465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 329, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1531947276, "creation_date": 1531947276, "question_id": 51410828, "link": "https://stackoverflow.com/questions/51410828/detect-shutdown-reboot-in-osx-from-c-app", "title": "Detect shutdown/reboot in OSX from C++ app", "body": "<p>How can I detect a shutdown/reboot on OSX from a C++ application? </p>\n\n<p>I need to report that the system is gonna shutdown/reboot to a central server sending a packet so it should be fast enough so network interfaces don't go down before the packet is sent. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "windows", "winapi", "access-token", "elevation"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1531946818, "post_id": 51410577, "comment_id": 89792907, "body": "No idea, but it&#39;s possible that the error refers to one of the previous Win32 API calls. Try checking the error code after each call."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1531951102, "post_id": 51410577, "comment_id": 89794707, "body": "You don&#39;t do any error checking so any of these calls, or none of them, could be failing"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9782286"}, "edited": false, "score": 0, "creation_date": 1531949226, "post_id": 51411206, "comment_id": 89793950, "body": "Alright, but then just wondering how does the system create elevated tokens when you run an app as an admin?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1531949608, "post_id": 51411206, "comment_id": 89794107, "body": "@ArushAgarampur - we can ask how system create token at all. <code>NtCreateToken</code>. with interactive admin login - system usually filter admin token (remove some privileges, disable admin group) from initially created token. so not elevate but downgrade existing. and create 2 linked logon sessions. you can get elevated linked token by query <code>TokenLinkedToken</code>. but unless you have TCB privilege - system return to you impersonation token with <code>SecurityIdentification</code> only. if any program can so easy elevate yourself - uac lost sense"}], "tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": true, "score": 3, "last_activity_date": 1531949100, "creation_date": 1531949100, "answer_id": 51411206, "question_id": 51410577, "link": "https://stackoverflow.com/questions/51410577/create-elevated-token-with-settokeninformation-returns-error-87/51411206#51411206", "title": "Create elevated token with SetTokenInformation returns error 87", "body": "<p><code>TokenElevation</code> is valid information class only for <code>GetTokenInformation</code> function. you can query are <code>TokenIsElevated</code> but you can not set it. <code>NtSetInformationToken</code> return <code>STATUS_INVALID_INFO_CLASS</code> in this case. the <code>SetTokenInformation</code> convert this error to <code>ERROR_INVALID_PARAMETER</code>. original <code>NTSTATUS</code> error code you can got by calling <code>RtlGetLastNtStatus()</code>. and anyway you can not \"elevate\" already existing token. this is by design</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9782286"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 767, "favorite_count": 0, "accepted_answer_id": 51411206, "answer_count": 1, "score": -2, "last_activity_date": 1531949100, "creation_date": 1531946126, "question_id": 51410577, "link": "https://stackoverflow.com/questions/51410577/create-elevated-token-with-settokeninformation-returns-error-87", "title": "Create elevated token with SetTokenInformation returns error 87", "body": "<p>I am trying to create an elevated token with <code>SetTokenInformation</code>, but it fails and keeps returning error code 87.</p>\n\n<p>This is my code:</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n\nint main()\n{\n    HANDLE currentProcessToken, newTok;\n    OpenProcessToken(GetCurrentProcess(), TOKEN_DUPLICATE, &amp;currentProcessToken);\n    DuplicateTokenEx(currentProcessToken, TOKEN_ALL_ACCESS, nullptr, SecurityImpersonation, TokenPrimary, &amp;newTok);\n    CloseHandle(currentProcessToken);\n    TOKEN_ELEVATION elev = { 1 };\n    BOOL setTokenInfo = SetTokenInformation(newTok, TokenElevation, &amp;elev, sizeof(TOKEN_ELEVATION));\n    DWORD error = GetLastError(); // is 87 which is \"the parameter is incorrect\"\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 2, "creation_date": 1531945222, "post_id": 51410353, "comment_id": 89792202, "body": "<i>&quot;make this more pythonic&quot;</i>, no. But you can perhaps not use very long identifiers."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 3, "creation_date": 1531945278, "post_id": 51410353, "comment_id": 89792224, "body": "Well, definitely don&#39;t try to use <code>short</code> as an identifier in C++. Or <code>long</code>, or <code>and</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 5, "creation_date": 1531945376, "post_id": 51410353, "comment_id": 89792260, "body": "related? <a href=\"https://stackoverflow.com/questions/3053561/how-do-i-assign-an-alias-to-a-function-name-in-c\" title=\"how do i assign an alias to a function name in c\">stackoverflow.com/questions/3053561/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 1, "creation_date": 1531961486, "post_id": 51412081, "comment_id": 89797281, "body": "And for the sake of completeness <code>using x = long::and::painful::stillWayToLong;</code> if <code>stillWayTooLong</code> is a namespace."}], "tags": [], "owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "is_accepted": true, "score": 1, "last_activity_date": 1531954683, "creation_date": 1531954683, "answer_id": 51412081, "question_id": 51410353, "link": "https://stackoverflow.com/questions/51410353/emulate-import-as-functionality-from-python-in-c/51412081#51412081", "title": "Emulate Import as functionality from python in C++", "body": "<p>How about</p>\n\n<pre><code>auto x = long::and::painful::stillWayToLong;  // If this is an object/function\nx(\"Why must I type this so often?\");\n\n\nusing X = typename long::and::painful::stillWayToLong; // If this is a type.\nX bob;\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10101844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/167ce2c79da1425230b6bd1008b483b2?s=128&d=identicon&r=PG", "display_name": "user124950", "link": "https://stackoverflow.com/users/10101844/user124950"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 51412081, "answer_count": 1, "score": 0, "last_activity_date": 1531954683, "creation_date": 1531945099, "question_id": 51410353, "link": "https://stackoverflow.com/questions/51410353/emulate-import-as-functionality-from-python-in-c", "title": "Emulate Import as functionality from python in C++", "body": "<p>In python I can do:<br>\n<code>from long_and_painful import still_way_to_long as short</code></p>\n\n<p>In C++ I am stuck with:  </p>\n\n<pre><code>using long::and::painful::stillWayToLong;\n... //Code and Stuff\nstillWayToLong(\"Why must I type this so often?\");\n</code></pre>\n\n<p>Am I missing something that would make this more pythonic?</p>\n"}, {"tags": ["c++", "segmentation-fault", "rapidxml"], "answers": [{"comments": [{"owner": {"reputation": 38, "user_id": 3999327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc2db83c072252c9b6d6f8e52ec55785?s=128&d=identicon&r=PG&f=1", "display_name": "Artur", "link": "https://stackoverflow.com/users/3999327/artur"}, "edited": false, "score": 0, "creation_date": 1531947379, "post_id": 51410561, "comment_id": 89793182, "body": "Thats it! Setting the char* cstr as a class variable fixed the problem!"}], "tags": [], "owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "is_accepted": true, "score": 0, "last_activity_date": 1531946051, "creation_date": 1531946051, "answer_id": 51410561, "question_id": 51410259, "link": "https://stackoverflow.com/questions/51410259/c-rapidxml-cant-use-saved-xml-document-properly/51410561#51410561", "title": "c++ rapidxml cant use saved xml_document properly", "body": "<p>The problem is that you are violating  contract of <code>xml_document::parse</code> method by disposing of the xml string before disposing of the document, as <a href=\"http://rapidxml.sourceforge.net/manual.html#classrapidxml_1_1xml__document\" rel=\"nofollow noreferrer\">stated in the documentation</a></p>\n\n<blockquote>\n  <p>The string must persist for the lifetime of the document.</p>\n</blockquote>\n\n<p><code>xml_document</code> does not copy string content to avoid extra memory allocations and therefore string must be kept alive. You can probably make string a class field. Also note that with C++17 there is a non-const-qualified <code>data</code> method in string class so there is no need to allocate another temporary buffer.</p>\n"}], "owner": {"reputation": 38, "user_id": 3999327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc2db83c072252c9b6d6f8e52ec55785?s=128&d=identicon&r=PG&f=1", "display_name": "Artur", "link": "https://stackoverflow.com/users/3999327/artur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "accepted_answer_id": 51410561, "answer_count": 1, "score": 1, "last_activity_date": 1531946051, "creation_date": 1531944660, "question_id": 51410259, "link": "https://stackoverflow.com/questions/51410259/c-rapidxml-cant-use-saved-xml-document-properly", "title": "c++ rapidxml cant use saved xml_document properly", "body": "<p>i'm trying to parse some xml string to an xml_document, and save the xml_document to a variable for further usage.\nDirectly after the parsing the xml_document is useable, but i cant access it from another method.</p>\n\n<p>Heres the example code:\nXML.h</p>\n\n<pre><code>//\n// Created by artur on 18.07.18.\n//\n\n#ifndef PLSMONITOR_XML_H\n#define PLSMONITOR_XML_H\n#include &lt;rapidxml/rapidxml.hpp&gt;\n\nclass XML {\n\npublic:\n    XML();\n    void print();\n\nprivate:\n    rapidxml::xml_document&lt;&gt; _store_xml;\n\n};\n\n#endif //PLSMONITOR_XML_H\n</code></pre>\n\n<p>XML.cpp</p>\n\n<pre><code>//\n// Created by artur on 18.07.18.\n//\n\n#include \"XML.h\"\n#include &lt;string&gt;\n#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\nXML::XML() {\n    std::string str{\"&lt;Store&gt;\"\n                           \" &lt;Field1&gt;1&lt;/Field1&gt;\"\n                           \"&lt;/Store&gt;\"\n                           \"\"};\n    char* cstr = new char[str.size() + 1];\n    strcpy (cstr, str.c_str());\n    _store_xml.parse&lt;0&gt;(cstr);\n    // this prints the 1\n    cout &lt;&lt;_store_xml.first_node(\"Store\")-&gt;first_node(\"Field1\")-&gt;value() &lt;&lt; endl;\n    delete [] cstr;\n\n}\n\nvoid XML::print() {\n    // this exits with Process finished with exit code 139 (interrupted by signal 11: SIGSEGV)\n    cout &lt;&lt;_store_xml.first_node(\"Store\")-&gt;first_node(\"Field1\")-&gt;value() &lt;&lt; endl;\n\n}\n\nint main(int argc, char *argv[]) {\n    cout &lt;&lt; \"Test of XML\" &lt;&lt; endl;\n    XML xml{};\n    xml.print();\n}\n</code></pre>\n\n<p>Using the xml_document in the constructor is fine, but using it in the print method will crash. This is the console output:</p>\n\n<blockquote>\n  <p>Test of XML \n  1</p>\n  \n  <p>Process finished with exit code 139 (interrupted by signal 11:\n  SIGSEGV)</p>\n</blockquote>\n\n<p>Anybody got an idea how to properly use the rapidxml document and save the xml struct for further use?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "multithreading", "header", "c-preprocessor"], "comments": [{"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 4, "creation_date": 1531948328, "post_id": 51410193, "comment_id": 89793585, "body": "Are you asking the right question?  Sounds like an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>.  Solving the error would be better than trying to detect when you need to avoid it."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1531959228, "post_id": 51410193, "comment_id": 89796816, "body": "&quot;<i>error: &#39;thread&#39; has not been declared</i>&quot; - did you remember to use <code>#include &lt;thread&gt;</code>? And probably also <code>using namespace std;</code> or better <code>using std::thread;</code> since you are not fully qualifying <code>hardware_concurrency()</code> as <code>std::thread::hardware_concurrency()</code>, only as <code>thread::hardware_concurrency()</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "is_accepted": false, "score": 4, "last_activity_date": 1531947599, "creation_date": 1531947599, "answer_id": 51410900, "question_id": 51410193, "link": "https://stackoverflow.com/questions/51410193/remove-threadhardware-concurrency-by-preprocessor-if-not-declared/51410900#51410900", "title": "remove thread::hardware_concurrency by preprocessor if not declared", "body": "<p><code>std::thread::hardware_concurrency</code> is provided by C++11. If compilers on those \"some computers\" support it you may have to toggle C++11 support (e.g. with mingw/gcc <code>-std=c++11</code>).</p>\n\n<p>To disable <code>hardware_concurrency</code> usage when unavailable, the best solution might be to detect C++11 support.</p>\n\n<p><a href=\"https://stackoverflow.com/a/40512515/6261331\">This answer</a> may work out for you, even if you use Visual Studio:</p>\n\n<pre><code>#if __cplusplus &gt;= 201103L || (defined(_MSC_VER) &amp;&amp; _MSC_VER &gt;= 1900)\n    int nthreads = std::thread::hardware_concurrency();\n#else\n    int nthreads = 4; // whatever fallback value\n#endif\n</code></pre>\n\n<p>Do note that it detects the VS 2015 compiler version as it was the first one to advertize full C++11 support. You can tweak the <code>_MSC_VER</code> check to an older version if <code>hardware_concurrency</code> happens to be available on older VS compilers.</p>\n"}], "owner": {"reputation": 2401, "user_id": 7431005, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/faf76298f3d4f60915eee51da1ee7c3f?s=128&d=identicon&r=PG&f=1", "display_name": "user7431005", "link": "https://stackoverflow.com/users/7431005/user7431005"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1531947945, "creation_date": 1531944375, "last_edit_date": 1531947945, "question_id": 51410193, "link": "https://stackoverflow.com/questions/51410193/remove-threadhardware-concurrency-by-preprocessor-if-not-declared", "title": "remove thread::hardware_concurrency by preprocessor if not declared", "body": "<p>I have C++ code that uses</p>\n\n<pre><code>int nthreads = thread::hardware_concurrency();\n</code></pre>\n\n<p>When I try to build my application on some computers, I get the error message</p>\n\n<pre><code>error: 'thread' has not been declared\n</code></pre>\n\n<p>I do not ask how to solve the error. I'm more interested in if there is a special \"guard\" that I can use to simply remove the lines of code by the preprocessor like for example in OpenMP I can use:</p>\n\n<pre><code>#ifdef _OPENMP\n...\n#endif\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1531950452, "post_id": 51410181, "comment_id": 89794451, "body": "If you are performing no operations on the data before writing to the dat file you may be able to take advantage of  <code>std::filesystem::copy</code> to copy the file."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1531995681, "post_id": 51410181, "comment_id": 89811145, "body": "Does the loop need to be within your program?  You might find it easier to use a shell script for the glue: <code>for f in *.txt; do your_program &lt;&quot;$f&quot; &gt;&quot;${f%.txt}.dat&quot;; done</code>, for example."}, {"owner": {"reputation": 11, "user_id": 10101633, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yf-Y3jkBjDI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oe0LQ-h1A0vmSA5dq_rVpQEZ4Ctw/mo/photo.jpg?sz=128", "display_name": "Farnaz76", "link": "https://stackoverflow.com/users/10101633/farnaz76"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1532016910, "post_id": 51410181, "comment_id": 89826100, "body": "@Toby Speight, No, it does not have to. I got it worked from below answer but writing a shell will also be a convenient way. I am just curious how will it work. Should I do: for f in *.txt; mycode.c &lt;&quot;$f&quot; &gt;&quot;${f%.txt}.dat&quot;; done in a shell script?"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1532017066, "post_id": 51410181, "comment_id": 89826211, "body": "For the loop to work like that, your program will need to cooperate a bit - make it a pipeline, so that it reads from standard input and writes to standard output, instead of opening files itself; then something like that shell loop will meet your needs.  (And you should invoke your <i>compiled program</i> within the loop, not the C++ source!)"}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 10089312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c99ca69d7e1d61160453c67a384f42?s=128&d=identicon&r=PG&f=1", "display_name": "renspaceyi", "link": "https://stackoverflow.com/users/10089312/renspaceyi"}, "is_accepted": false, "score": 2, "last_activity_date": 1531946578, "last_edit_date": 1531946578, "creation_date": 1531944845, "answer_id": 51410294, "question_id": 51410181, "link": "https://stackoverflow.com/questions/51410181/read-multiple-files-in-directory-for-editing-and-writing-into-another-set-of-fil/51410294#51410294", "title": "Read multiple files in directory for editing and writing into another set of files", "body": "<p>It's simple, really. First thing we will do is make that stuff you've already written into a function. But not before making some edits. It should do exactly the same thing your code does, but with better practices!</p>\n\n<pre><code>void readAndWrite(std::string in_name, std::string out_name)\n{\n    std::ifstream in{in_name};\n    std::ofstream out{out_name};\n    std::string line;\n\n    if (!in.is_open() || !out.is_open())\n        return;\n\n    while (std::getline(in, line)) {\n        if (line.find(\" No.\") == line.npos) {\n            out &lt;&lt; line &lt;&lt; \"\\n\";\n            std::cout &lt;&lt; \"line is:\\t\" &lt;&lt; line&lt;&lt;\"\\n\";\n        }\n    }\n}\n</code></pre>\n\n<p>Then we just need to call it 100 times with our file names. I'll assume that your files are named like \"0.txt\", \"1.txt\", ... and so on. We can do this using <code>std::to_string()</code>, a function which, as the name implies, changes things to <code>std::string</code>s. In our case, we'll be changing <code>int</code>s to <code>std::string</code>s. This is one way to do it. (this will be in <code>main</code>):</p>\n\n<pre><code>#include &lt;string&gt;\n...\nfor (int i = 0; i &lt; 100; ++i) {\n    std::string fname = std::to_string(i);\n    readAndWrite(fname + \".txt\", fname + \".dat\");\n}\n</code></pre>\n\n<p>And that should do it!</p>\n"}], "owner": {"reputation": 11, "user_id": 10101633, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yf-Y3jkBjDI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oe0LQ-h1A0vmSA5dq_rVpQEZ4Ctw/mo/photo.jpg?sz=128", "display_name": "Farnaz76", "link": "https://stackoverflow.com/users/10101633/farnaz76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531946578, "creation_date": 1531944301, "question_id": 51410181, "link": "https://stackoverflow.com/questions/51410181/read-multiple-files-in-directory-for-editing-and-writing-into-another-set-of-fil", "title": "Read multiple files in directory for editing and writing into another set of files", "body": "<p>I am newbie in C++ and appreciate if someone could help me figure this out. I wrote the following code and it works fine but I need to repeat it for many files in the same directory. It reads 0.txt line by line, removes lines of strings of characters if found and writes the rest of the lines which are only numbers into another file named 0.dat. I need to repeat this for multiple files (0.txt,1.txt....100.txt) in the same directory. </p>\n\n<pre><code>    #include &lt;iostream&gt;\n    #include &lt;fstream&gt;\n    #include &lt;string&gt;\n    int main()\n    {\n    std::ifstream in;\n    std::ofstream out;\n    in.open(\"0.txt\");\n    out.open(\"0.dat\");\n    if(in.is_open() &amp;&amp; out.is_open()){\n         while(std::getline(in, line)){\n                if(line.find(\" No.\")==line.npos){\n                         out &lt;&lt; line &lt;&lt; \"\\n\";\n                         std::cout &lt;&lt; \"line is:\\t\" &lt;&lt; line&lt;&lt;\"\\n\";\n                }\n          }\n    }\n\n    in.close();\n    out.close();\n    return 0;\n    }\n</code></pre>\n\n<p>How can I create a loop to read 100 \"<em>.txt\" files and write them into 100 \"</em>.dat\" files with correct name reference?</p>\n"}, {"tags": ["c++", "inheritance", "multiple-inheritance"], "comments": [{"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 1, "creation_date": 1531943896, "post_id": 51410068, "comment_id": 89791562, "body": "Where&#39;s your definition for <code>Adult</code>?"}, {"owner": {"reputation": 43, "user_id": 9426418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24e97284871f227ff0adc9a7617efdf1?s=128&d=identicon&r=PG&f=1", "display_name": "lunchbox", "link": "https://stackoverflow.com/users/9426418/lunchbox"}, "edited": false, "score": 0, "creation_date": 1531944094, "post_id": 51410068, "comment_id": 89791651, "body": "I added the definition for Adult.  I did not have a GetFirstName in it&#39;s definition."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 3, "creation_date": 1531944158, "post_id": 51410068, "comment_id": 89791693, "body": "Why inherit <code>Teacher</code> from <code>Person</code> and <code>Adult</code> when <code>Adult</code> is already a <code>Person</code>?"}, {"owner": {"reputation": 43, "user_id": 9426418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24e97284871f227ff0adc9a7617efdf1?s=128&d=identicon&r=PG&f=1", "display_name": "lunchbox", "link": "https://stackoverflow.com/users/9426418/lunchbox"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1531944379, "post_id": 51410068, "comment_id": 89791794, "body": "@FredLarson - Good question.  I did that because my constructor for a Teacher is &quot;Teacher::Teacher(variables)  : Person(firstName, lastName), Adult(other variables)&quot;.  I guess based off your comment that I can omit that second inheritance and just pass everything to Adult"}, {"owner": {"reputation": 341, "user_id": 10061112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/892e89fec3f5a5073a4e61b1a7325e93?s=128&d=identicon&r=PG&f=1", "display_name": "hiimdaosui", "link": "https://stackoverflow.com/users/10061112/hiimdaosui"}, "edited": false, "score": 0, "creation_date": 1531944607, "post_id": 51410068, "comment_id": 89791899, "body": "Do you want your <code>Adult</code> and <code>Teacher</code> have <code>Firstname</code> and <code>Lastname</code> and <code>Id</code>? If so, you should initialize the base class objects in your derived classes."}, {"owner": {"reputation": 43, "user_id": 9426418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24e97284871f227ff0adc9a7617efdf1?s=128&d=identicon&r=PG&f=1", "display_name": "lunchbox", "link": "https://stackoverflow.com/users/9426418/lunchbox"}, "reply_to_user": {"reputation": 341, "user_id": 10061112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/892e89fec3f5a5073a4e61b1a7325e93?s=128&d=identicon&r=PG&f=1", "display_name": "hiimdaosui", "link": "https://stackoverflow.com/users/10061112/hiimdaosui"}, "edited": false, "score": 0, "creation_date": 1531945440, "post_id": 51410068, "comment_id": 89792293, "body": "@hiimdaosui - Yes.  And thanks for mentioning that, I did it with Teacher but not Adult"}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1531945803, "post_id": 51410068, "comment_id": 89792468, "body": "Are you really sure inheritance is the right way to model your requirements? How about allowing every <code>Person</code> to have any number of roles, like teacher, with any necessary ancillary data?"}, {"owner": {"reputation": 43, "user_id": 9426418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24e97284871f227ff0adc9a7617efdf1?s=128&d=identicon&r=PG&f=1", "display_name": "lunchbox", "link": "https://stackoverflow.com/users/9426418/lunchbox"}, "edited": false, "score": 0, "creation_date": 1531947194, "post_id": 51410068, "comment_id": 89793086, "body": "@Deduplicator- I could go that route, sure.  Really this is just a pet project of mine that was originally started in C# and now I have to learn C++ so I&#39;m re-writing it to learn the basics of C++."}], "answers": [{"comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1531945862, "post_id": 51410442, "comment_id": 89792494, "body": "A <code>std::string_view</code> by value generally trumps a <code>std::string</code> by constant reference."}, {"owner": {"reputation": 245, "user_id": 10025445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c215777ec0036f32d949a80dbf259345?s=128&d=identicon&r=PG&f=1", "display_name": "acade", "link": "https://stackoverflow.com/users/10025445/acade"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1531945999, "post_id": 51410442, "comment_id": 89792554, "body": "@Deduplicator, I agree with you."}], "tags": [], "owner": {"reputation": 245, "user_id": 10025445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c215777ec0036f32d949a80dbf259345?s=128&d=identicon&r=PG&f=1", "display_name": "acade", "link": "https://stackoverflow.com/users/10025445/acade"}, "is_accepted": true, "score": 1, "last_activity_date": 1531945523, "creation_date": 1531945523, "answer_id": 51410442, "question_id": 51410068, "link": "https://stackoverflow.com/questions/51410068/c-inheritance-multi-inheritance-ambiguous-call/51410442#51410442", "title": "c++ inheritance/multi-inheritance ambiguous call", "body": "<p>You have incorrect hierarchy. Teacher inherit from Person and Adult at the same time and Adult inherit Person too. What do you want compiler call when you write Teacher::GetFirstName? Maybe Person::GetFirstName or Adult::Person::GetFirstName. Moreover you will have two exemplars of Person's variables.</p>\n\n<p><strong>Decisions:</strong></p>\n\n<ol>\n<li><p>virtual inheritance:</p>\n\n<p><code>class Adult : virtual public Person {...};\n class Teacher : virtual public Person, public Adult {...};</code></p></li>\n</ol>\n\n<p>more <a href=\"https://en.wikipedia.org/wiki/Virtual_inheritance\" rel=\"nofollow noreferrer\">here</a></p>\n\n<ol start=\"2\">\n<li><p>teacher's basic class must be Adult only:</p>\n\n<p><code>class Teacher : public Adult {...};</code></p></li>\n</ol>\n\n<p>As <strong>bad</strong> option: you can to indicate explicit which certainly method you want to call:</p>\n\n<pre><code>`Teacher t = ...;\nt.Adult::GetFirstName();`\n</code></pre>\n\n<p>Bonus: Don't pass arguments by value, in your case will be better pass arguments as constant reference.</p>\n\n<pre><code>`Person(const std::string&amp; firstName, const std::string&amp; lastName);`\n</code></pre>\n\n<p>Instead</p>\n\n<pre><code> `Person(std::string firstName, std::string lastName);`\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 341, "user_id": 10061112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/892e89fec3f5a5073a4e61b1a7325e93?s=128&d=identicon&r=PG&f=1", "display_name": "hiimdaosui", "link": "https://stackoverflow.com/users/10061112/hiimdaosui"}, "is_accepted": false, "score": 0, "last_activity_date": 1531945848, "creation_date": 1531945848, "answer_id": 51410518, "question_id": 51410068, "link": "https://stackoverflow.com/questions/51410068/c-inheritance-multi-inheritance-ambiguous-call/51410518#51410518", "title": "c++ inheritance/multi-inheritance ambiguous call", "body": "<p>There are multiple issues in your previous design. The direct issue that causes the compilation error is that your <code>Teacher</code> is inherited from both <code>Adult</code> and <code>Person</code> class. Since <code>Adult</code> is also a subclass of <code>Person</code>, both of those classes have <code>GetLastName()</code> method, so the compiler cannot tell which one to call. </p>\n\n<p>More importantly, you should manage your hierarchy in a more correct and clear way. Semantically, an adult should also be a person and a teacher is supposed to be an adult. So why not just inherit <code>Teacher</code> from <code>Adult</code> only and make your hierarchy a linear list in your design?</p>\n\n<p>Moreover, if you want complete information for your base classes, you should initialize your base class objects first in your derived class object. Use <a href=\"https://stackoverflow.com/questions/926752/why-should-i-prefer-to-use-member-initialization-list\">C++ initialization list</a> to complete this.</p>\n\n<pre><code>class Person\n{\nprotected:\n    int Id;\n    std::string FirstName;\n    std::string LastName;\n\npublic:\n    Person() = default;\n    Person(std::string firstName, std::string lastName) : FirstName(firstName), LastName(lastName) {}\n    ~Person() = default;\n    std::string GetPersonInfo() const;\n    std::string GetFirstName() const;\n    std::string GetLastName() const;\n};\n\ninline std::string Person::GetPersonInfo() const {\n    return FirstName + \" \" + LastName;\n}\n\ninline std::string Person::GetFirstName() const {\n    return FirstName;\n}\n\ninline std::string Person::GetLastName() const {\n    return LastName;\n}\n\nclass Adult : public Person\n{\nprotected:\n    std::string Email;\n    std::string PhoneNumber;\n    std::vector&lt;std::string&gt; Address;\npublic:\n    Adult() = default;\n    ~Adult() = default;\n    Adult(std::string firstName, std::string lastName, std::string emailAddress, std::string phoneNumber, std::vector&lt;std::string&gt; address) \n        : Person(firstName, lastName), Email(emailAddress), PhoneNumber(phoneNumber), Address(address) {};\n    Adult(std::string firstName, std::string lastName, std::string emailAddress, std::string phoneNumber) \n        : Person(firstName, lastName), Email(emailAddress), PhoneNumber(phoneNumber) {};\n\n};\n\n\nclass Teacher : public Adult\n{\nprivate:\n    int ClassroomID;\npublic:\n    Teacher() = default;\n    ~Teacher() = default;\n    Teacher(std::string firstName, std::string lastName, std::string emailAddress, std::string phoneNumber,\n        std::vector&lt;std::string&gt; teacherAddress, int classroomID) \n        : Adult(firstName, lastName, emailAddress, phoneNumber, teacherAddress), ClassroomID(classroomID) {}\n\n};\n\n\n\nint main(void) {\n\n    Teacher teacher(\"ExampleFirstName\", \"ExampleLastName\", \"example@email.com\", \"100-1001000\", {\"example address\"}, 1);\n\n    cout &lt;&lt; teacher.GetLastName() &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 9426418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24e97284871f227ff0adc9a7617efdf1?s=128&d=identicon&r=PG&f=1", "display_name": "lunchbox", "link": "https://stackoverflow.com/users/9426418/lunchbox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 51410442, "answer_count": 2, "score": -1, "last_activity_date": 1531945848, "creation_date": 1531943746, "last_edit_date": 1531944029, "question_id": 51410068, "link": "https://stackoverflow.com/questions/51410068/c-inheritance-multi-inheritance-ambiguous-call", "title": "c++ inheritance/multi-inheritance ambiguous call", "body": "<p>Beginner C++ question:</p>\n\n<p>I have a class Person that has protected variables FirstName and LastName:</p>\n\n<pre><code>class Person\n{\nprotected:\n    int Id;\n    std::string FirstName;\n    std::string LastName;\n\npublic:\n    Person();\n    Person(std::string firstName, std::string lastName);\n    ~Person();\n    std::string GetPersonInfo() const;\n    std::string GetFirstName() const;\n    std::string GetLastName() const;\n};\n\ninline std::string Person::GetPersonInfo() const {\n    return FirstName + \" \" + LastName;\n}\n\ninline std::string Person::GetFirstName() const {\n    return FirstName;\n}\n\ninline std::string Person::GetLastName() const {\n    return LastName;\n}\n</code></pre>\n\n<p>I have a Teacher class that inherits from Person (and an Adult Class)</p>\n\n<pre><code>class Teacher :\n    public Person, public Adult\n{\nprivate:\n    int ClassroomID;\npublic:\n    Teacher() = default;\n    ~Teacher() = default;\n    Teacher(std::string firstName, std::string lastName, std::string emailAddress, std::string phoneNumber,\n        std::vector&lt;Address&gt; teacherAddress, int classroomID);\n\n};\n</code></pre>\n\n<p>In my main() I have the following: </p>\n\n<pre><code>vector&lt;Teacher&gt; teachers = TeacherRepository.RetrieveTeachers();\n            for (Teacher teacher : teachers) {\n                cout &lt;&lt; teacher.GetFirstName(); }\n</code></pre>\n\n<p>When I start to type \"teacher.\" I see \"GetFirstName\" appear as an option, however; it is throws a compiler error that \"Teacher::GetFirstName is ambiguous\"</p>\n\n<p>What have I done wrong?</p>\n\n<p>EDIT: Definition for Adult</p>\n\n<pre><code>class Adult :\n    public Person\n{\nprotected:\n    std::string Email;\n    std::string PhoneNumber;\n    std::vector&lt;Address&gt; address;\npublic:\n    Adult() = default;\n    ~Adult() = default;\n    Adult(std::string emailAddress, std::string phoneNumber, std::vector&lt;Address&gt; address);\n    Adult(std::string emailAddress, std::string phoneNumber);\n\n};\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "edited": false, "score": 3, "creation_date": 1531943786, "post_id": 51410048, "comment_id": 89791509, "body": "Well, I don&#39;t think you can with <code>cin</code> or anything standard for the matter. This &quot;fancy UI&quot; seems to be ncurses; you could use it for your program."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1531944801, "post_id": 51410048, "comment_id": 89791992, "body": "Yep, from the image it is <a href=\"https://www.gnu.org/software/ncurses/\" rel=\"nofollow noreferrer\">ncurses</a>. you don&#39;t want to implement such stuff portably based on <code>iostream</code> facilities on your own."}], "answers": [{"tags": [], "owner": {"reputation": 371, "user_id": 10100947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64b07db91c2fa1bb6d46d9dbb3f4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Zackary Jones", "link": "https://stackoverflow.com/users/10100947/zackary-jones"}, "is_accepted": true, "score": 3, "last_activity_date": 1531946148, "creation_date": 1531946148, "answer_id": 51410584, "question_id": 51410048, "link": "https://stackoverflow.com/questions/51410048/c-multiple-choice-with-arrow-keys/51410584#51410584", "title": "C++ Multiple Choice with Arrow Keys", "body": "<p>This is by no means an all encompassing answer, but i'm hoping it will help with the basic idea.</p>\n\n<p>I wrote up a quick C++ program which preforms the logical part of a multiple choice picker using only the up arrow, down arrow, and enter key.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;conio.h&gt;//For _getch().\n\n//https://stackoverflow.com/questions/24708700/c-detect-when-user-presses-arrow-key\n#define KEY_UP 72       //Up arrow character\n#define KEY_DOWN 80    //Down arrow character\n#define KEY_ENTER '\\r'//Enter key charatcer\n\nint main(){\n    int selected = 0;    //Keeps track of which option is selected.\n    int numChoices = 2; //The number of choices we have.\n    bool selecting = true;//True if we are still waiting for the user to press enter.\n    bool updated = false;//True if the selected value has just been updated.\n\n    //Output options\n    std::cout &lt;&lt; \"A. Option 1\\n\"; \n    std::cout &lt;&lt; \"B. Option 2\\n\";\n\n    char c; //Store c outside of loop for efficiency.\n    while (selecting) { //As long as we are selecting...\n        switch ((c = _getch())) { //Check value of the last inputed character.\n            case KEY_UP:\n                if (selected &gt; 0) { //Dont decrement if we are at the first option.\n                    --selected;\n                    updated = true;\n                }\n                break;\n            case KEY_DOWN:\n                if (selected &lt; numChoices - 1) { //Dont increment if we are at the last option.\n                    ++selected;\n                    updated = true;\n                }\n                break;\n            case KEY_ENTER:\n                //We are done selecting the option.\n                selecting = false;\n                break;\n            default: break;\n        }\n        if (updated) { //Lets us know what the currently selected value is.\n            std::cout &lt;&lt; \"Option \" &lt;&lt; (selected + 1) &lt;&lt; \" is selected.\\n\";\n            updated = false;\n        }\n    }\n    //Lets us know what we ended up selecting.\n    std::cout &lt;&lt; \"Selected \" &lt;&lt; (selected + 1) &lt;&lt; '\\n';\n    return 0;\n}\n</code></pre>\n\n<p>I used <a href=\"https://stackoverflow.com/questions/24708700/c-detect-when-user-presses-arrow-key\">this</a> stack overflow answer to determine how to track key presses in the console.\n<a href=\"http://stackoverflow.com/questions/10058050/how-to-go-up-a-line-in-console-programs-c\">This</a> answer may also prove useful for moving the console cursor around when changing the background color of text.</p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 39, "user_id": 4735873, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YKlZXCzpqSY/AAAAAAAAAAI/AAAAAAAAAFo/WD0RLe3Q-9A/photo.jpg?sz=128", "display_name": "yzzyx", "link": "https://stackoverflow.com/users/4735873/yzzyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 964, "favorite_count": 1, "closed_date": 1532648061, "accepted_answer_id": 51410584, "answer_count": 1, "score": 0, "last_activity_date": 1531954747, "creation_date": 1531943649, "last_edit_date": 1531954747, "question_id": 51410048, "link": "https://stackoverflow.com/questions/51410048/c-multiple-choice-with-arrow-keys", "closed_reason": "Needs more focus", "title": "C++ Multiple Choice with Arrow Keys", "body": "<p>I am wondering how to make a multiple choice prompt in the console where you can select the options with the arrow keys. So instead of something like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nint main()\n{\n    std::string selection;\n    std::cout &lt;&lt; \"A. option 1\";\n    std::cout &lt;&lt; \"B. option 2\";\n    std::cin &gt;&gt; selection;\n\n    if(selection == \"A\") {\n        //do whatever;\n    } else if(selection == \"B\") {\n        //do something else;\n    } else {\n        //repeat the prompt\n    }\nreturn 0;\n}\n</code></pre>\n\n<p>I could have something that looks like this, but without the fancy UI:\n<a href=\"https://i.stack.imgur.com/wtyhk.jpg\" rel=\"nofollow noreferrer\">image</a></p>\n"}, {"tags": ["c++", "linux", "cmake", "cross-compiling"], "comments": [{"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 1, "creation_date": 1531943848, "post_id": 51409985, "comment_id": 89791531, "body": "Dear downvoters. Maybe you&#39;d like to specify your reasoning for downvoting a perfectly legitimate question where efforts were described and obviosuly made, such that the poster can form a better question? Otherwise, we&#39;ll end up with the exact same thing posted yet again."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1531943961, "post_id": 51409985, "comment_id": 89791594, "body": "The question appears to be a run-on. It is not readily apparent what the problem or question is."}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1531944165, "post_id": 51409985, "comment_id": 89791697, "body": "Ok, edited to be one single black and white question."}, {"owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "edited": false, "score": 3, "creation_date": 1531945190, "post_id": 51409985, "comment_id": 89792191, "body": "The flags are not recognized because you&#39;re invoking the wrong compiler. Have you tried <code>make package VERBOSE=1</code>? That should show you the command line calls. You may have to do something like <code>CXX=&lt;path-to-gcc-arm-cross-compiler&gt; cmake &lt;remaining-args&gt;</code>"}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1531945965, "post_id": 51409985, "comment_id": 89792536, "body": "VERBOSE=1 is the bees knees!"}], "answers": [{"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1531998130, "post_id": 51410251, "comment_id": 89812803, "body": "Standard makefiles assume that the compiler is specified by the <code>CXX</code> variable - that&#39;s the normal way to specify a cross-compiler."}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": true, "score": 5, "last_activity_date": 1531944624, "creation_date": 1531944624, "answer_id": 51410251, "question_id": 51409985, "link": "https://stackoverflow.com/questions/51409985/whats-cmake-cxx-flags-and-which-are-available/51410251#51410251", "title": "What&#39;s CMAKE_CXX_FLAGS and which are available", "body": "<p>In the Linux world, it's often assumed that you don't need to specify the compiler by name; instead you arrange for <code>c++</code> to refer to the compiler. That may involve setting <code>PATH</code>, creating a shell alias or a symbolic link.</p>\n\n<p>Apparently you already did so, as your compiler is being called and is complaining about standard GCC flags - clearly your compiler isn't GCC.</p>\n\n<p>The CMakeLists.txt file however is very much assuming it's intended for GCC. Don't blame CMake for that. CMake is the tool, CMakeLists.txt are project-specific instructions. This is a problem of whoever created the particular CMakeLists.txt file.</p>\n\n<p>There's no easy fix. There is a real possibility that the <code>-mfpu=neon</code> option to <code>gcc</code> was necessary for the program, and it's anyone's guess what you'll need on the other compiler.</p>\n"}], "owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1422, "favorite_count": 1, "accepted_answer_id": 51410251, "answer_count": 1, "score": 2, "last_activity_date": 1531997960, "creation_date": 1531943391, "last_edit_date": 1531997960, "question_id": 51409985, "link": "https://stackoverflow.com/questions/51409985/whats-cmake-cxx-flags-and-which-are-available", "title": "What&#39;s CMAKE_CXX_FLAGS and which are available", "body": "<p>I've been doing C++ for a long long time, but I come from the land of Windows.</p>\n\n<p>I've been handed a project that uses CMake. I've googled around trying to learn it.</p>\n\n<p>I run <code>cmake .</code>\nI assume it always looks for <code>CMakeLists.txt</code> and generates makefiles.</p>\n\n<p>This creates a bunch more cmake files and make files.\nI was then instructed to run <code>make package</code>.\nI assume <code>package</code> is just a target name that could be anything.</p>\n\n<p>I then get errors:</p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>c++: error: unrecognized command line option \u2018-mthumb-interwork\u2019\nc++: error: unrecognized command line option \u2018-mfloat-abi=hard\u2019\nc++: error: unrecognized command line option \u2018-mfpu=neon\u2019\n</code></pre>\n\n<p>I think those are due to the fact that I am trying to compile for a different architecture then the one I am on. I assume all the cmake files would set that up correctly for me. I also assume that nothing there is proprietary.</p>\n\n<p>I see the line in the CMakeLists.txt</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>SET(CMAKE_CXX_FLAGS \"-march=armv7-a -mthumb-interwork -mfloat-abi=hard -mfpu=neon -mtune=cortex-a9 -std=c++11 -O3\")\n</code></pre>\n\n<p>If I look at the official cmake documentation, it says, and I quote\n<strong>\"Flags for all build types.\"</strong> ....Not very helpful</p>\n\n<p>I am thinking it isn't using the correct compiler, but I also don't see where in the CMakeLists.txt the compiler is specified at all.</p>\n\n<p>The question is:\nWhy would these flags be unrecognized?</p>\n"}, {"tags": ["c++", "multithreading", "thread-safety", "global-variables"], "comments": [{"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1531945570, "post_id": 51409967, "comment_id": 89792356, "body": "You&#39;re sure that there are no data members inside <code>ObjectClass</code>? So in fact <code>funA</code> could be static, and you wouldn&#39;t even need <code>obj</code>? Because if <code>funA</code> is static, you&#39;d just call it as <code>ObjectClass::funA</code>."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 359691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ba0f3dc59de4185518e5a4bf386ba5?s=128&d=identicon&r=PG", "display_name": "Jaideep Karande", "link": "https://stackoverflow.com/users/359691/jaideep-karande"}, "edited": false, "score": 0, "creation_date": 1531978591, "post_id": 51410013, "comment_id": 89801188, "body": "Actually, it&#39;s not pure stateless, there is a init thread which initializes the variable(const) when the object is created. The later worker thread comes and starts working. So the data is not changed. Besides its inherited with overloaded functions to be used, so funA funB etc are inherited virtually."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 47, "user_id": 359691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ba0f3dc59de4185518e5a4bf386ba5?s=128&d=identicon&r=PG", "display_name": "Jaideep Karande", "link": "https://stackoverflow.com/users/359691/jaideep-karande"}, "edited": false, "score": 0, "creation_date": 1532003908, "post_id": 51410013, "comment_id": 89816644, "body": "@JaideepKarande As long as you aren&#39;t changing state you are okay.  It is valid to have multiple threads read from that same state without any synchronization."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 3, "last_activity_date": 1531943511, "creation_date": 1531943511, "answer_id": 51410013, "question_id": 51409967, "link": "https://stackoverflow.com/questions/51409967/threads-and-function-call-safety-for-global-variable/51410013#51410013", "title": "Threads and function call safety for global variable", "body": "<p>Yes, this is safe.  Since there is no shared state there is no possible way to get a data race.  The only caveat is if one of your threads deletes the object while the others are still trying to call functions on it then you will have undefined behavior.</p>\n\n<p>If your class is truly stateless then you should consider making all these functions <code>static</code> so they don't even share a global object or just put the functions in a namespace if you want them to be scoped to a name.</p>\n"}], "owner": {"reputation": 47, "user_id": 359691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ba0f3dc59de4185518e5a4bf386ba5?s=128&d=identicon&r=PG", "display_name": "Jaideep Karande", "link": "https://stackoverflow.com/users/359691/jaideep-karande"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531943511, "creation_date": 1531943320, "question_id": 51409967, "link": "https://stackoverflow.com/questions/51409967/threads-and-function-call-safety-for-global-variable", "title": "Threads and function call safety for global variable", "body": "<p>I have many threads and a global object variable. Threads use this global variable to call many functions inside of that object. I have no shared data. Are function calls thread safe?\ne.g.</p>\n\n<pre><code>ObjectClass\n{\n    public:\n    funA() {}\n    funB() {}\n    funC() {}\n};\n\nObjectClass *obj=new ObjectClass;\n</code></pre>\n\n<p>Threads randomly call:</p>\n\n<pre><code>obj-&gt;funA();\nobj-&gt;funB();\nobj-&gt;funC();\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 2599, "user_id": 1534898, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/e96aa9237f776b2fdf6ca1b805ba48f8?s=128&d=identicon&r=PG", "display_name": "infoclogged", "link": "https://stackoverflow.com/users/1534898/infoclogged"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1531944165, "post_id": 51409965, "comment_id": 89791699, "body": "@dbush - i am trying to extract 4 bytes each from the character stream and assign it to an array of floats."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1531944229, "post_id": 51409965, "comment_id": 89791728, "body": "<b><i>i am trying to extract 4 bytes each from the character stream and assign it to an array of floats.</i></b> Then your <b><i>I was expecting</i></b> part of your question is completely wrong. You should be expecting some floating point numbers."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1531944239, "post_id": 51409965, "comment_id": 89791736, "body": "A <code>float</code> expects data ordered in IEEE-754 single precision floating point format. I&#39;ve never seen a Latin alphabet that comes in IEEE-754 format."}, {"owner": {"reputation": 9142, "user_id": 1442918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7490251da02084a2e2720e20029d2bff?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/1442918/max"}, "edited": false, "score": 0, "creation_date": 1531944339, "post_id": 51409965, "comment_id": 89791782, "body": "memcpy takes a byte count not an element count."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1531944341, "post_id": 51409965, "comment_id": 89791783, "body": "&quot; i am trying to extract 4 bytes each from the character stream....&quot; this is simply not doable. What float do u expect to get from &quot;hijk&quot;"}, {"owner": {"reputation": 9142, "user_id": 1442918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7490251da02084a2e2720e20029d2bff?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/1442918/max"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1531944384, "post_id": 51409965, "comment_id": 89791798, "body": "@pm100 At least in IEEE-754 each bit pattern means something.  A lot of them are NAN though."}, {"owner": {"reputation": 2599, "user_id": 1534898, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/e96aa9237f776b2fdf6ca1b805ba48f8?s=128&d=identicon&r=PG", "display_name": "infoclogged", "link": "https://stackoverflow.com/users/1534898/infoclogged"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1531944503, "post_id": 51409965, "comment_id": 89791836, "body": "@pm100 - if i change float to int, is it doable then?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1531944561, "post_id": 51409965, "comment_id": 89791865, "body": "If the bytes in question are in fact a list of IEEE-754 floating point numbers with the bytes in the same order the host expects, it could be as simple as <code>float *float_data = reinterpret_cast&lt;float *&gt;(char_data);</code>"}, {"owner": {"reputation": 2599, "user_id": 1534898, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/e96aa9237f776b2fdf6ca1b805ba48f8?s=128&d=identicon&r=PG", "display_name": "infoclogged", "link": "https://stackoverflow.com/users/1534898/infoclogged"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1531944936, "post_id": 51409965, "comment_id": 89792053, "body": "@dbush - why is the first result  a valid floating point and the rest are 0s?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1531945029, "post_id": 51409965, "comment_id": 89792097, "body": "@infoclogged Because you aren&#39;t copying enough bytes.  You need <code>strlen(char_data_)</code>, not <code>strlen(char_data_)&#47;sizeof(float)</code>.  Also, a real stream of floating point numbers may contain bytes with the value 0, in which case using string functions is useless."}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1531945237, "post_id": 51409965, "comment_id": 89792210, "body": "See <a href=\"https://en.cppreference.com/w/cpp/string/byte/memcpy\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/string/byte/memcpy</a> the cast in the call is also useless."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531947611, "post_id": 51409965, "comment_id": 89793292, "body": "Tip: 1) Using <code>unsigned char</code> rather than <code>char</code> reduces a number of minor annoyances and technical UB.  2) Use <code>&quot;%e&quot;</code> or <code>&quot;%a&quot;</code>.  They are more informative than <code>printf(&quot;%f\\n&quot;, ...</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531947793, "post_id": 51409965, "comment_id": 89793374, "body": "&quot;but its clear its incorrect.&quot; --&gt; It is not clear that output is incorrect.  Post the expected output."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1531948529, "post_id": 51409965, "comment_id": 89793665, "body": "<b><i>Post the expected output</i></b> That was posted but retracted because the expected output was also wrong."}, {"owner": {"reputation": 2599, "user_id": 1534898, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/e96aa9237f776b2fdf6ca1b805ba48f8?s=128&d=identicon&r=PG", "display_name": "infoclogged", "link": "https://stackoverflow.com/users/1534898/infoclogged"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1531949743, "post_id": 51409965, "comment_id": 89794161, "body": "@drescherjm   The expected output is chunk of 4 bytes each from the character stream. The problem is solved now because, I was allocating wrong number of bytes in malloc and the second problem was my misunderstanding of floats coz  float has a special representation and hence cannot be meaninguflly directly converted one to one from character stream. Both of them are addressed in the solution below."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1531956516, "post_id": 51409965, "comment_id": 89796229, "body": "@DavidC.Rankin <code>float</code> is not necessarily IEEE754. It could be any floating point representation."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1532109155, "post_id": 51409965, "comment_id": 89866385, "body": "@infoclogged yes every bit combination in a char string is a valid int. For example &quot;aa&quot; cast as a 16 bit int is 24929 (see if you can work out why). BTW there are all sorts of portability, laguagecompliance, endianness issues associated with this"}], "answers": [{"comments": [{"owner": {"reputation": 2599, "user_id": 1534898, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/e96aa9237f776b2fdf6ca1b805ba48f8?s=128&d=identicon&r=PG", "display_name": "infoclogged", "link": "https://stackoverflow.com/users/1534898/infoclogged"}, "edited": false, "score": 0, "creation_date": 1531947689, "post_id": 51410643, "comment_id": 89793323, "body": "thank you very much ! malloc was the problem that you correctly identified. Let me have a look at the union and will get back."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1531948678, "post_id": 51410643, "comment_id": 89793721, "body": "Aren&#39;t both methods Undefined Behavior? I known the union is definitely UB in <code>c++</code>. <a href=\"https://stackoverflow.com/questions/11373203/accessing-inactive-union-member-and-undefined-behavior\" title=\"accessing inactive union member and undefined behavior\">stackoverflow.com/questions/11373203/&hellip;</a>"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1531955132, "post_id": 51410643, "comment_id": 89795876, "body": "I see. Using union is undefined behavior. Why should be memcpy UB? I am sure  that under my machine (!) the bytes stored in string represent floats, so i can convert the representation, as i know that the underlying bytes represent the float object."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1531956448, "post_id": 51410643, "comment_id": 89796208, "body": "&quot;using pointer&quot; version causes undefined behaviour (strict aliasing violation)"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1531957644, "post_id": 51410643, "comment_id": 89796490, "body": "But the underlying memory contains an object that is of compatible type with float, so it&#39;s not strict aliasing violation. I know that this memory contains float object on my machine, so it&#39;s not strict alias violation. Is it?"}, {"owner": {"reputation": 2599, "user_id": 1534898, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/e96aa9237f776b2fdf6ca1b805ba48f8?s=128&d=identicon&r=PG", "display_name": "infoclogged", "link": "https://stackoverflow.com/users/1534898/infoclogged"}, "edited": false, "score": 0, "creation_date": 1532008075, "post_id": 51410643, "comment_id": 89819652, "body": "<code>unsigned int val = 0x0000803f;    float float_val = *(reinterpret_cast&lt;float *&gt;( &amp;val ));    printf(&quot;answer - %f\\n&quot;, float_val);</code> - I was expecting 1.0f as the result. But its not.. Any reason why?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1532016933, "post_id": 51410643, "comment_id": 89826108, "body": "This code (yours and mine) is so wrong on so many levels. The representation of unsigned int is not equal to bytes. I mean <code>!memcmp(&amp;val, (uint8_t[4]){0x00,0x00,0x80,0x3f}, 4)</code> may return false. sizeof(unsigned int) may be not equal to sizeof(float). Read about strict alias violation and endianess and float representation. Btw. Why do you want to convert char array into float? Isn&#39;t this XY problem? The only valid reason would be to explore float representation on a particular machine, such code has no production value."}, {"owner": {"reputation": 2599, "user_id": 1534898, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/e96aa9237f776b2fdf6ca1b805ba48f8?s=128&d=identicon&r=PG", "display_name": "infoclogged", "link": "https://stackoverflow.com/users/1534898/infoclogged"}, "edited": false, "score": 0, "creation_date": 1532455937, "post_id": 51410643, "comment_id": 89979148, "body": "@KamilCuk i want to convert char to float because this is a byte stream on the socket. The byte stream represents a depth image that is encoded in float and I want to extract these floats."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1532016987, "last_edit_date": 1532016987, "creation_date": 1531946368, "answer_id": 51410643, "question_id": 51409965, "link": "https://stackoverflow.com/questions/51409965/convert-char-to-float-using-union-or-memcpy/51410643#51410643", "title": "convert char* to float* using union or memcpy", "body": "<p>How to convert char* to float* using union or memcpy?</p>\n\n<p>Using memcpy and reinterpretcast:</p>\n\n<pre><code>#include &lt;cstdio&gt;\n#include &lt;string&gt;\n#include &lt;cstring&gt;\n#include &lt;cassert&gt;\n#include &lt;cstddef&gt;\n\nvoid using_pointer(const char *s, size_t slen) {\n    const float *f = reinterpret_cast&lt;const float*&gt;(s);\n    for (size_t i = 0; i &lt; slen/sizeof(float); ++i) {\n        printf(\"%zu = %f\\n\", i, f[i]);\n    }\n}\n\nvoid using_memcpy(const char* s, size_t slen) {\n    float* f = new float[slen/sizeof(float)];\n    memcpy(f, s, slen/sizeof(float)*sizeof(float));\n    for (size_t i = 0; i &lt; slen/sizeof(float); ++i) {\n        printf(\"%zu = %f\\n\", i, f[i]);\n    }\n    delete f;\n}\n\nint main() {\n    static_assert(sizeof(float) == 4, \"\");\n    std::string stdstr(\n        \"\\x00\\x00\\x80\\x3f\" // float 1.0\n        \"\\x00\\x00\\x81\\x3f\" // just randomly changed 0x80 to 0x81 \n        \"\\x00\\x00\\x82\\x3f\"\n    , 4 * 3);\n\n    printf(\"using_pointer:\\n\");\n    using_pointer(stdstr.c_str(), stdstr.size());\n    printf(\"using_memcpy:\\n\");\n    using_memcpy(stdstr.c_str(), stdstr.size());\n\n    std::string s2(\"abcdefghijklmnopqrstuvwx\");\n    printf(\"Last:\\n\");\n    using_memcpy(s2.c_str(), s2.size());\n\n    return 0;\n}\n</code></pre>\n\n<p>will output on machine that is used by <a href=\"http://www.onlinegdb.com\" rel=\"nofollow noreferrer\">http://www.onlinegdb.com</a> :</p>\n\n<pre><code>using_pointer:                                                                                                         \n0 = 1.000000                                                                                                           \n1 = 1.007812                                                                                                           \n2 = 1.015625                                                                                                           \nusing_memcpy:                                                                                                          \n0 = 1.000000                                                                                                           \n1 = 1.007812                                                                                                           \n2 = 1.015625                                                                                                           \nLast:                                                                                                                  \n0 = 16777999408082104352768.000000                                                                                     \n1 = 4371022013021616997400576.000000                                                                                   \n2 = 1138400301458999111806091264.000000                                                                                \n3 = 296401655701622853703074578432.000000                                                                              \n4 = 77151445562813935304650187079680.000000                                                                            \n5 = 20076561220099179535696200212676608.000000      \n</code></pre>\n\n<p>@edit: As @drescherjm pointed out in comments, using union to convert between char and float representation is impossible in C++ unless based on undefined behavior. In C++ unions are not used to change representation of bytes. Unions are used to store at most one of multiple objects. You can store char array or float array in an union, not both at a time and you can't (at least shouldn't) convert between float and char representation using an union in C++.  </p>\n\n<p>What is happening in your code?</p>\n\n<pre><code>// static_cast&lt;char*&gt; from string is forbidden in iso C++. It's better to use  should use at least std::string.c_str()\n// or use char char_data_[sizeof(\"abcdefghijklmnopqrstuvwx\"]; memcpy(char_data_, \"abcdefghijklmnopqrstuvwx\", sizeof(char_data_));\nchar  *char_data_  = static_cast&lt;char *&gt;(\"abcdefghijklmnopqrstuvwx\");\n// you are allocating strlen(\"abcdefghijklmnopqrstuvwx\")/4 = 24/4 = 6 bytes of memory. That's memory for 1 and a half float numbers.\nfloat *float_data_ = reinterpret_cast&lt;float *&gt;(malloc(strlen(char_data_)/sizeof(float)));\n\n// this will print '24\\n'\nprintf(\"%ld\\n\", strlen(char_data_));\n\n// you are copying 6 bytes of data from char_data_ to float_data_\n// now float_data_ contains \"abcdef\" without '\\0'\nmemcpy(float_data_, reinterpret_cast&lt;float *&gt;(char_data_), strlen(char_data_)/sizeof(float));\n\n// this will print  16777999408082104352768.000000 on the first loop, which is \"abcd\" in hex in ascii\n// then this invokes undefined behaviour cause of out of bound access\n// you are trying to access elements number 2, 3, 4, 5 while float_data_ points to only 6 bytes, which is 1,5 float numbers, so even float_data_[1] is out of bound and undefined behaviour\nfor ( auto n = 0 ; n &lt; strlen(char_data_)/sizeof(float); n++) {\n    printf(\"%f\\n\", *(float_data_ + n));\n}              \n</code></pre>\n"}], "owner": {"reputation": 2599, "user_id": 1534898, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/e96aa9237f776b2fdf6ca1b805ba48f8?s=128&d=identicon&r=PG", "display_name": "infoclogged", "link": "https://stackoverflow.com/users/1534898/infoclogged"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 569, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532016987, "creation_date": 1531943314, "last_edit_date": 1531944303, "question_id": 51409965, "link": "https://stackoverflow.com/questions/51409965/convert-char-to-float-using-union-or-memcpy", "title": "convert char* to float* using union or memcpy", "body": "<p>I am trying to convert a stream of characters into float *, but somehow unable to get the right result.</p>\n\n<pre><code>char  *char_data_  = static_cast&lt;char *&gt;(\"abcdefghijklmnopqrstuvwx\");\nfloat *float_data_ = reinterpret_cast&lt;float *&gt;(malloc(strlen(char_data_)/sizeof(float)));\n\nprintf(\"%ld\\n\", strlen(char_data_));\n\nmemcpy(float_data_, reinterpret_cast&lt;float *&gt;(char_data_), strlen(char_data_)/sizeof(float));\n\nfor ( auto n = 0 ; n &lt; strlen(char_data_)/sizeof(float); n++) {\n    printf(\"%f\\n\", *(float_data_ + n));\n}\n</code></pre>\n\n<p>Following is my result, but its clear its incorrect. Can anyone have a look please?</p>\n\n<pre><code>16777999408082104352768.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n</code></pre>\n\n<p>Is it possible to solve this problem using union?</p>\n\n<p>I am expecting to have chunks of 4 bytes each of the character stream and save it into an array of floats.</p>\n"}, {"tags": ["c++", "oop", "inheritance", "polymorphism"], "comments": [{"owner": {"reputation": 908, "user_id": 3292279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VX393.jpg?s=128&g=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/3292279/alex-johnson"}, "edited": false, "score": 3, "creation_date": 1531943295, "post_id": 51409892, "comment_id": 89791283, "body": "Is a cylinder really a type of circle?"}, {"owner": {"reputation": 3, "user_id": 10061436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98ae10b2aeca8694fbac06c2f404e64b?s=128&d=identicon&r=PG&f=1", "display_name": "Cory S.", "link": "https://stackoverflow.com/users/10061436/cory-s"}, "reply_to_user": {"reputation": 908, "user_id": 3292279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VX393.jpg?s=128&g=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/3292279/alex-johnson"}, "edited": false, "score": 0, "creation_date": 1531943402, "post_id": 51409892, "comment_id": 89791322, "body": "the base of a cylinder is a circle."}, {"owner": {"reputation": 908, "user_id": 3292279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VX393.jpg?s=128&g=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/3292279/alex-johnson"}, "edited": false, "score": 0, "creation_date": 1531943567, "post_id": 51409892, "comment_id": 89791398, "body": "Exactly. That tells me that the second option above is the best reflection of the relationship between a circle and a cylinder."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 908, "user_id": 3292279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VX393.jpg?s=128&g=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/3292279/alex-johnson"}, "edited": false, "score": 4, "creation_date": 1531943583, "post_id": 51409892, "comment_id": 89791408, "body": "The point I believe @AlexJohnson is trying to make is the first example violates the <a href=\"https://stackoverflow.com/questions/56860/what-is-an-example-of-the-liskov-substitution-principle\">Liskov Substitution Principle</a>. If you cannot use a cylinder as a circle, it should not be a circle."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 1, "creation_date": 1531943598, "post_id": 51409892, "comment_id": 89791420, "body": "In general, the notable difference is that &quot;is-a&quot; will inherit interface.  &quot;has-a&quot; will not.  In your specific example, cylinder has-a circle, but cylinder is-NOT-a circle."}], "answers": [{"tags": [], "owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "is_accepted": true, "score": 6, "last_activity_date": 1531943863, "creation_date": 1531943863, "answer_id": 51410088, "question_id": 51409892, "link": "https://stackoverflow.com/questions/51409892/object-member-variable-or-inheritence/51410088#51410088", "title": "Object member variable or inheritence?", "body": "<p>Prefer composition to inheritance when the is-a relationship doesn't hold.  In this case, a cylinder isn't a type of circle, so (public) inheritance isn't appropriate.</p>\n\n<p>Remember, a class that inherits publicly from another class can be used anywhere the parent can be used.  For example, given the definitions in the OP, the following is totally valid, even though it doesn't really make much sense to calculate the area of a cylinder:</p>\n\n<pre><code>double area(const circleType&amp; circle)\n{\n    return PI * circle.radius() * circle.radius();\n}\n\nint main()\n{\n    cylinderType cylinder;\n    std::cout &lt;&lt; area(cylinder);\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10061436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98ae10b2aeca8694fbac06c2f404e64b?s=128&d=identicon&r=PG&f=1", "display_name": "Cory S.", "link": "https://stackoverflow.com/users/10061436/cory-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 51410088, "answer_count": 1, "score": 0, "last_activity_date": 1531943863, "creation_date": 1531943060, "question_id": 51409892, "link": "https://stackoverflow.com/questions/51409892/object-member-variable-or-inheritence", "title": "Object member variable or inheritence?", "body": "<p>I've been practicing inheritance and I found myself asking what a \"has-a\" relationship is really about.</p>\n\n<p>If I have a class <code>circleType</code> and I want to create a class <code>cylinderType</code>, whats the difference between deriving <code>cylinderType</code> from <code>circleType</code> and just including a <code>circleType</code> object member in the definition of <code>cylinderType</code></p>\n\n<pre><code>class cylinderType :\npublic circleType\n{\npublic:\n    cylinderType();\n    ~cylinderType();\n\nprivate:\n    double * height;\n};\n</code></pre>\n\n<p>OR:</p>\n\n<pre><code>class cylinderType\n{\npublic:\n    cylinderType();\n    ~cylinderType();\n\nprivate:\n    circleType baseOfCylinder;\n};\n</code></pre>\n"}, {"tags": ["c++", "linux", "visual-c++", "vector", "stl"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1531942406, "post_id": 51409680, "comment_id": 89790818, "body": "Linux is not like Windows. On the MS platform you have <code>-DDEBUG</code> and checked iterators under &quot;Debug&quot; builds. Linux does not really have a concept of a &quot;Debug&quot; build. On Linux with GCC you need <code>-D_GLIBCXX_DEBUG</code>. I don&#39;t recall if <code>-D_GLIBCXX_DEBUG</code> checks ranges. And I don&#39;t know if ICC honors it, either."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 4, "creation_date": 1531942407, "post_id": 51409680, "comment_id": 89790819, "body": "I am not sure why your program crashes on Windows. Your program looks perfectly fine to me."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1531942425, "post_id": 51409680, "comment_id": 89790829, "body": "Cannot reproduce, works as expected <a href=\"https://ideone.com/NVnX4B\" rel=\"nofollow noreferrer\">ideone.com/NVnX4B</a>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1531942553, "post_id": 51409680, "comment_id": 89790884, "body": "@jww but it is still a perfectly conforming program."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1531942555, "post_id": 51409680, "comment_id": 89790885, "body": "I see nothing in the posted code that would make it crash.  FWIW <code>#include &quot;iostream&quot; #include &quot;vector&quot;</code> should be <code>#include &lt;iostream&gt; #include &lt;vector&gt;</code>"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1531942568, "post_id": 51409680, "comment_id": 89790892, "body": "@jww I am not sure what OP wants to achieve, but behavior is exactly as expected"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1531942613, "post_id": 51409680, "comment_id": 89790923, "body": "@Someprogrammerdude only that nowhere OP goes out of bounds."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1531942683, "post_id": 51409680, "comment_id": 89790962, "body": "Asker means <code>v.resize(5);</code> to be <code>v.reserve(5);</code>, perhaps?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1531942714, "post_id": 51409680, "comment_id": 89790983, "body": "Either your crashing program is missing that <code>resize</code> call or does something else you don&#39;t show with your code here. Did you copy-paste the actual code that causes the crash? You did not rewrite it into the question? If you did rewrote the code for the question, it&#39;s easy to add something by mistake, and even to <i>fix</i> the problem (still by mistake). Unfortunately that can make the question quite worthless, so please copy (as text) the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> that causes the crash, and paste it here without any modifications."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1531942752, "post_id": 51409680, "comment_id": 89791007, "body": "And if you catch the crash in your debugger, where does it happen? At what index (if any)?"}, {"owner": {"reputation": 3, "user_id": 10101550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebaee46e62a95c0be88063be35478bf9?s=128&d=identicon&r=PG&f=1", "display_name": "Hashmenow", "link": "https://stackoverflow.com/users/10101550/hashmenow"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1531942937, "post_id": 51409680, "comment_id": 89791111, "body": "@RSahu I&#39;m trying to access v[5] or the 6th element and windows crashes as it is out of bounds."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1531943002, "post_id": 51409680, "comment_id": 89791132, "body": "Actually, in the code you show the vector have <i>ten</i> elements. That&#39;s why nobody understands what the problem is."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1531943014, "post_id": 51409680, "comment_id": 89791140, "body": "@Hashmenow, that does not make sense. At the time you are accessing <code>v[5]</code>, <code>V</code> has 10 elements in it."}, {"owner": {"reputation": 3, "user_id": 10101550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebaee46e62a95c0be88063be35478bf9?s=128&d=identicon&r=PG&f=1", "display_name": "Hashmenow", "link": "https://stackoverflow.com/users/10101550/hashmenow"}, "edited": false, "score": 0, "creation_date": 1531943070, "post_id": 51409680, "comment_id": 89791163, "body": "My bad all, please remove the resize. I was testing and posted the wrong version."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1531943262, "post_id": 51409680, "comment_id": 89791262, "body": "@Hashmenow You can <b><a href=\"https://stackoverflow.com/posts/51409680/edit\">edit</a></b> ( &lt;- click this link) your post to put the code that actually crashes"}, {"owner": {"reputation": 3, "user_id": 10101550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebaee46e62a95c0be88063be35478bf9?s=128&d=identicon&r=PG&f=1", "display_name": "Hashmenow", "link": "https://stackoverflow.com/users/10101550/hashmenow"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1531943637, "post_id": 51409680, "comment_id": 89791439, "body": "@NathanOliver : thank you, commented the line, crashes now on Windows and linux printing garbage."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1531944373, "post_id": 51409680, "comment_id": 89791792, "body": "Now that the question is fixed, Here is a close match: <a href=\"https://stackoverflow.com/questions/1239938/accessing-an-array-out-of-bounds-gives-no-error-why\">Accessing an array out of bounds gives no error, why?</a> Odds are good that a release build from MSVC will have similar behaviour to the Linux and ICC builds. This cannot be guaranteed, though."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1531944627, "post_id": 51409680, "comment_id": 89791904, "body": "@user4581301 this case is little different AFAIK, <code>std::vector</code> most probably reserves more memory that for 5 elements (I would say at least 6 :) to make it even) so even writing there may not crash the program. With array situation is different, as writing out of bounds will modify stack."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1531947591, "post_id": 51409680, "comment_id": 89793277, "body": "Not going to argue that, but what&#39;s probably the most important part, &quot;The language simply says what should happen if you access the elements <i>within</i> the bounds&quot;, still applies. What happens in UB at the implementation level, is the point of the question, but it probably shouldn&#39;t be. Just for fun, I built a 2015 release build. No crash. Without the extra-friendly checks in the debug build, the out of bounds access prints garbage."}, {"owner": {"reputation": 3, "user_id": 10101550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebaee46e62a95c0be88063be35478bf9?s=128&d=identicon&r=PG&f=1", "display_name": "Hashmenow", "link": "https://stackoverflow.com/users/10101550/hashmenow"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1531951079, "post_id": 51409680, "comment_id": 89794697, "body": "@user4581301 Precisely."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1531943583, "post_id": 51409930, "comment_id": 89791407, "body": "The OP has edited their Q to remove the <code>resize</code>."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1531943741, "post_id": 51409930, "comment_id": 89791486, "body": "@NathanOliver I answered assuming <code>resize()</code> is not there anyway"}, {"owner": {"reputation": 3, "user_id": 10101550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebaee46e62a95c0be88063be35478bf9?s=128&d=identicon&r=PG&f=1", "display_name": "Hashmenow", "link": "https://stackoverflow.com/users/10101550/hashmenow"}, "edited": false, "score": 0, "creation_date": 1531943867, "post_id": 51409930, "comment_id": 89791544, "body": "@Slava - Great suggestion: To use &#39;at&#39; which includes bounds checking.!"}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": true, "score": 2, "last_activity_date": 1531944200, "last_edit_date": 1531944200, "creation_date": 1531943188, "answer_id": 51409930, "question_id": 51409680, "link": "https://stackoverflow.com/questions/51409680/std-vector-memory-allocation-linux-vs-windows-compilers/51409930#51409930", "title": "std vector memory allocation linux vs windows compilers", "body": "<p>Assuming you put <code>v.resize(5)</code> by mistake, here are some answers:</p>\n\n<blockquote>\n  <p>how to make linux fatal out/ crash the same way as windows (since i have a huge codebase).</p>\n</blockquote>\n\n<p>Use <code>std::vector::at()</code> that validates index and throws exception by design. <code>std::vector::operator[]</code> not suppose to validate index and even if some platform does it for some configuration (looks like Windows compiler in debug has such validation), you cannot demand it everywhere. </p>\n\n<blockquote>\n  <p>Technically i was expecting a signal 11 from linux, not to throw a garbage value everytime for whatever the size of vector i tested.</p>\n</blockquote>\n\n<p>It is a problem of your expectation. Giving invalid index to <code>std::vector::operator[]</code> leads to Undefined Behaviour, and you cannot expect that to give signal 11 or something else in particular.</p>\n\n<p>FYR: </p>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/container/vector/operator_at\" rel=\"nofollow noreferrer\">std::vector::operator[]</a></p>\n\n<blockquote>\n  <p>Returns a reference to the element at specified location pos. <strong>No bounds checking is performed</strong>.</p>\n</blockquote>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/container/vector/at\" rel=\"nofollow noreferrer\">std::vector::at()</a></p>\n\n<blockquote>\n  <p>If pos is not within the range of the container, an exception of type std::out_of_range is thrown.</p>\n</blockquote>\n\n<p>emphasis is mine.</p>\n\n<p>As for memory allocation, it is implementation specific, most of them would not allocate memory exactly for 5 elements but more in advance, to make it efficient, so that's why your code on Linux did not crush, but produced garbage, as you read value from uninitialized memory. But that can change any moment and you should not rely on this behavior in any way.</p>\n"}], "owner": {"reputation": 3, "user_id": 10101550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebaee46e62a95c0be88063be35478bf9?s=128&d=identicon&r=PG&f=1", "display_name": "Hashmenow", "link": "https://stackoverflow.com/users/10101550/hashmenow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "closed_date": 1531943504, "accepted_answer_id": 51409930, "answer_count": 1, "score": -2, "last_activity_date": 1531944200, "creation_date": 1531942126, "last_edit_date": 1531943237, "question_id": 51409680, "link": "https://stackoverflow.com/questions/51409680/std-vector-memory-allocation-linux-vs-windows-compilers", "closed_reason": "Not suitable for this site", "title": "std vector memory allocation linux vs windows compilers", "body": "<p>A very simple program testing the STL implementations between Intel compiler on linux (Intel 18.0) and visual c++ on windows (MSVC 2015). </p>\n\n<ol>\n<li><p>Primarily, how to make linux fatal out/ crash the same way as windows (since i have a huge codebase). Technically i was expecting a signal 11 from linux, not to throw a garbage value everytime for whatever the size of vector i tested.  </p></li>\n<li><p>Can someone explain what is happening under the hood (memory allocation wise and their rules and if it is implementation/platform/compiler dependent).? Just for my understanding.</p></li>\n</ol>\n\n<p>'</p>\n\n<pre><code>#include \"iostream\"\n#include \"vector\"\nusing namespace std;\nint main(int argc,char* argv[])\n{   \n   vector&lt;int&gt; v;\n   //v.resize(5);  (my bad, please ignore this, i was testing and posted incorrect version)\n   cout&lt;&lt;\"Initial vector size: \"&lt;&lt;v.size()&lt;&lt;endl;\n   for(int i=1;i&lt;=5;++i)\n   {\n       v.push_back(i);\n   }\n   cout&lt;&lt;\"size of vector after: \"&lt;&lt;v.size()&lt;&lt;endl;\n\n   for(int j=5;j&gt;=0;--j) // Notice my upper bound.\n   {\n      cout&lt;&lt; \"printing \" &lt;&lt;v[j]&lt;&lt;std::endl;\n   }\n   return 0;\n}\n</code></pre>\n\n<p>Both had no problems compiling as one can expect. Subsequently, Windows crashed with a nice message \"vector subscript out of range\" while linux threw some garbage value everytime and continued. </p>\n"}, {"tags": ["c++", "opencv", "dll"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1531941377, "post_id": 51409346, "comment_id": 89790351, "body": "I would avoid this situation if possible. I mean recompile the 3rd party library if you can. Otherwise  you may want to restrict yourself to the same version of opencv that they are using."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1531941556, "post_id": 51409346, "comment_id": 89790439, "body": "Also you likely have to use the same compiler version that they are using for the 3rd party library. Remember that Visual Studio 2015 and 2017 are binary compatible but no other versions of Visual Studio are compatible with each other. And its not safe to mix debug and release. Meaning all dlls must be the same configuration of your application."}, {"owner": {"reputation": 1369, "user_id": 10100264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y0gPu.jpg?s=128&g=1", "display_name": "avermaet", "link": "https://stackoverflow.com/users/10100264/avermaet"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1531941890, "post_id": 51409346, "comment_id": 89790585, "body": "You mean recompiling the 3rd party with opencv3.4 and also using opencv3.4 myself?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1531942003, "post_id": 51409346, "comment_id": 89790645, "body": "<b><i>You mean recompiling the 3rd party with opencv3.4 and also using opencv3.4 myself?</i></b> That would be preferred. Make sure you do that with the same compiler that you use for your application."}], "owner": {"reputation": 1369, "user_id": 10100264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y0gPu.jpg?s=128&g=1", "display_name": "avermaet", "link": "https://stackoverflow.com/users/10100264/avermaet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531941081, "creation_date": 1531940773, "last_edit_date": 1531941081, "question_id": 51409346, "link": "https://stackoverflow.com/questions/51409346/c-and-opencv3-4-and-lib-that-uses-also-opencv-but-other-version-as-a-dependenc", "title": "C++ and opencv3.4 and lib that uses also opencv but other version as a dependency", "body": "<p>I am confused about how to use libraries. how do I link the folowing properly?\nWhat do I have to do in Visual Studio?</p>\n\n<pre><code>myprogram ---&gt; opencv 3.4\n          |\n          ---&gt; 3rd party lib  ---&gt; opencv 2.x\n                              |\n                              ---&gt; many other libs(tbb, boost, ...)\n</code></pre>\n\n<p>I am just confused about what todo with the 2 opencv's.\n<p>Thanks!</p>\n"}, {"tags": ["c++", "opencv"], "answers": [{"comments": [{"owner": {"reputation": 549, "user_id": 4647888, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/77bab1fa60b42c06325910435337a594?s=128&d=identicon&r=PG", "display_name": "Kroll", "link": "https://stackoverflow.com/users/4647888/kroll"}, "edited": false, "score": 0, "creation_date": 1532152595, "post_id": 51409645, "comment_id": 89876132, "body": "int result = sum(A).val[0]/(mat.cols*mat.rows);"}], "tags": [], "owner": {"reputation": 1350, "user_id": 1698678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c3dcda949d1adcc6db14345586b2b9?s=128&d=identicon&r=PG", "display_name": "PlinyTheElder", "link": "https://stackoverflow.com/users/1698678/plinytheelder"}, "is_accepted": true, "score": 1, "last_activity_date": 1531941992, "creation_date": 1531941992, "answer_id": 51409645, "question_id": 51409320, "link": "https://stackoverflow.com/questions/51409320/how-to-summ-all-cvmat-elements/51409645#51409645", "title": "How to summ all cv::Mat elements?", "body": "<p>An OpenCV function sum() adds the elements for all dimensions of a matrix:</p>\n\n<p><a href=\"http://docs.opencv.org/modules/core/doc/operations_on_arrays.html#sum\" rel=\"nofollow noreferrer\">http://docs.opencv.org/modules/core/doc/operations_on_arrays.html#sum</a></p>\n\n<pre><code>Scalar result = sum(A);\n</code></pre>\n"}], "owner": {"reputation": 549, "user_id": 4647888, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/77bab1fa60b42c06325910435337a594?s=128&d=identicon&r=PG", "display_name": "Kroll", "link": "https://stackoverflow.com/users/4647888/kroll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 51409645, "answer_count": 1, "score": 0, "last_activity_date": 1531941992, "creation_date": 1531940685, "question_id": 51409320, "link": "https://stackoverflow.com/questions/51409320/how-to-summ-all-cvmat-elements", "title": "How to summ all cv::Mat elements?", "body": "<p>I trying to make the fast character recognition algorithm.</p>\n\n<p>I have the result of absdiff() and now I want to summ all of this cv::Mat to find out small or big difference it is.</p>\n\n<p>How can I do this?</p>\n"}, {"tags": ["c++", "string"], "comments": [{"owner": {"reputation": 23, "user_id": 9909047, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209336722855589/picture?type=large", "display_name": "Lim Waikhang", "link": "https://stackoverflow.com/users/9909047/lim-waikhang"}, "edited": false, "score": 0, "creation_date": 1531939763, "post_id": 51409054, "comment_id": 89789481, "body": "[1]: <a href=\"https://i.stack.imgur.com/4PVaR.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/4PVaR.png</a>   -picture of my output"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 2, "creation_date": 1531939867, "post_id": 51409054, "comment_id": 89789549, "body": "You need to calculate <code>ranksindex </code>, <code>suitsindex </code> etc inside loop"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1531939960, "post_id": 51409054, "comment_id": 89789610, "body": "and you better use <code>std::uniform_int_distribution</code> rather than <code>rand</code>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1531940320, "post_id": 51409054, "comment_id": 89789817, "body": "Instead of working with string, use index between 0-51. only for display convert it to string."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1531940792, "post_id": 51409054, "comment_id": 89790059, "body": "<code>int ranksindex = rand() % 13;</code> calculates a value <i>once</i> and assigns it to <code>ranksindex</code>. Assigning to an <code>int</code> in c++ copies the immediate value, not the expression. Subsequent uses of <code>ranksindex</code> will always have the same value unless you assign a new one to it."}, {"owner": {"reputation": 23, "user_id": 9909047, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209336722855589/picture?type=large", "display_name": "Lim Waikhang", "link": "https://stackoverflow.com/users/9909047/lim-waikhang"}, "edited": false, "score": 0, "creation_date": 1531990665, "post_id": 51409054, "comment_id": 89807671, "body": "*update  [1]: <a href=\"https://i.stack.imgur.com/jbArS.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/jbArS.png</a>  it will run but it will not finish the whole program and display the counter."}], "answers": [{"tags": [], "owner": {"reputation": 2619, "user_id": 4183255, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/100002672903408/picture?type=large", "display_name": "Priyansh Goel", "link": "https://stackoverflow.com/users/4183255/priyansh-goel"}, "is_accepted": true, "score": 3, "last_activity_date": 1531939844, "creation_date": 1531939844, "answer_id": 51409089, "question_id": 51409054, "link": "https://stackoverflow.com/questions/51409054/loop-one-pair-of-cards-for-100-times-deck-of-cards/51409089#51409089", "title": "Loop one pair of cards for 100 times (deck of cards)", "body": "<pre><code>int ranksindex = rand() % 13; //random index for drawing card 1\nint suitsindex = rand() % 4; \n\nint ranksindex2 = rand() % 13; // random index for drawing card 2\nint suitsindex2 = rand() % 4;\n</code></pre>\n\n<p>The above code should be inside for loop.</p>\n\n<p>For every turn you want to find out the random ranksIndex and suitsIndex. Right now, you were just finding it once and using it multiple times in for loop.</p>\n"}, {"tags": [], "owner": {"reputation": 4533, "user_id": 2504757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef5b308d33027fab8440d223828fe4c?s=128&d=identicon&r=PG", "display_name": "Robert Andrzejuk", "link": "https://stackoverflow.com/users/2504757/robert-andrzejuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1531942840, "creation_date": 1531942840, "answer_id": 51409849, "question_id": 51409054, "link": "https://stackoverflow.com/questions/51409054/loop-one-pair-of-cards-for-100-times-deck-of-cards/51409849#51409849", "title": "Loop one pair of cards for 100 times (deck of cards)", "body": "<p>As can be seen after reformatting the code that the random values are been read outside the loop, therefore this code has to be moved inside the loop.</p>\n\n<hr>\n\n<p>I believe that by getting 2 random numbers, the distribution of the outcome of selected cards will not be quite uniform.</p>\n\n<p>Since You are looking for 1 card out of 52, then only 1 random value should be generated and then that value should be mapped to a card.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>constexpr auto card_ranks_count = 13;\nconstexpr auto card_suits_count = 4;\n\nconst int random_card = rand() % (card_ranks_count * card_suits_count);\n\nconst auto indexes = std::div(random_card, card_ranks_count);\n\nconst int ranksindex = indexes.rem;\nconst int suitsindex = indexes.quot;\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9909047, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209336722855589/picture?type=large", "display_name": "Lim Waikhang", "link": "https://stackoverflow.com/users/9909047/lim-waikhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 51409089, "answer_count": 2, "score": -2, "last_activity_date": 1531990638, "creation_date": 1531939725, "last_edit_date": 1531990638, "question_id": 51409054, "link": "https://stackoverflow.com/questions/51409054/loop-one-pair-of-cards-for-100-times-deck-of-cards", "title": "Loop one pair of cards for 100 times (deck of cards)", "body": "<pre><code>int main()\n{\n    srand(time(NULL)); //seeding rand with a starting value\n\n\n    const string ranks[] = { \"Ace\",   \"Two\",  \"Three\", \"Four\", \"Five\",  \"Six\", \"Seven\",\n                             \"Eight\", \"Nine\", \"Ten\",   \"Jack\", \"Queen\", \"King\" };\n\n    const string suits[] = {\n        \"Diamonds\", \"Hearts\", \"Spades\", \"Clubs\"\n    }; //array with 52 cards,4 suits each with 13 ranks(1 to King)\n\n    int ranksindex = rand() % 13; //random index for drawing card 1\n    int suitsindex = rand() % 4;\n\n    int ranksindex2 = rand() % 13; // random index for drawing card 2\n    int suitsindex2 = rand() % 4;\n\n    string card1, card2;\n    int    counter = 0;\n    int    times   = 1000;\n    int    i;\n\n    for (i = 0; i &lt; times; i++)\n    {\n        card1 = ranks[ranksindex] + \" of \"\n                + suits[suitsindex]; // two random cards with the ranks and suits\n        card2 = ranks[ranksindex2] + \" of \" + suits[suitsindex2];\n\n        if (card1 == card2)\n        {\n            card2 = ranks[ranksindex] + \" of \"\n                    + suits[suitsindex]; // to make the cards always different\n        }\n\n        cout &lt;&lt; \"The two cards drawn are : \" &lt;&lt; card1 &lt;&lt; \" and \" &lt;&lt; card2 &lt;&lt; endl\n             &lt;&lt; endl; //display card the two cards drawn\n    }\n}\n</code></pre>\n\n<p>When i try to run the program , it doesnt finish the program ,its stuck there, what can i do to fix this?</p>\n\n<p>Below is a picture of my output,it will run but it will not finish the whole program and display the counter</p>\n"}, {"tags": ["c++", "variadic-templates", "c++17", "typetraits", "function-signature"], "comments": [{"owner": {"reputation": 908, "user_id": 3292279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VX393.jpg?s=128&g=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/3292279/alex-johnson"}, "edited": false, "score": 1, "creation_date": 1531939593, "post_id": 51408881, "comment_id": 89789370, "body": "Try Code Review: <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1531940494, "post_id": 51408881, "comment_id": 89789907, "body": "<code>R(U::*)(Args...) const volatile</code>, <code>R(U::*)(Args...) &amp;</code>, <code>R(*)(Args... ...)</code> are missing (with the combinations)."}], "answers": [{"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1531941768, "post_id": 51409404, "comment_id": 89790531, "body": "If it is just to compare signature, we can even have <code>R(*)(Args...)</code> -&gt; <code>R(Args...)</code> and <code>R(C::*)(Args...)</code> -&gt; <code>R(Args...)</code>. (allows to handle C-ellipsis too Btw contrary to <code>std::tuple</code>). (to result to something like <code>std::is_same&lt;remove_class_compound_t&lt;F1&gt;, remove_class_compound_t&lt;F2&gt;&gt;</code>)."}, {"owner": {"reputation": 103, "user_id": 51599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c525e1c15819eaf8212c4cf537ff1de5?s=128&d=identicon&r=PG", "display_name": "Reuven Abliyev", "link": "https://stackoverflow.com/users/51599/reuven-abliyev"}, "edited": false, "score": 0, "creation_date": 1564559030, "post_id": 51409404, "comment_id": 101066293, "body": "unfortunately decltype doesn&#39;t work for the class private members"}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 3, "last_activity_date": 1531941651, "last_edit_date": 1531941651, "creation_date": 1531940995, "answer_id": 51409404, "question_id": 51408881, "link": "https://stackoverflow.com/questions/51408881/check-that-signature-of-two-functions-or-member-function-pointer-equal/51409404#51409404", "title": "Check that signature of two functions or member function pointer equal", "body": "<p>To simplifty: there is no reason to separate <code>return_type</code> and <code>arg_types</code>: you can join they in a single <code>std::tuple</code> with <code>return_type</code> in first position.</p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;type_traits&gt;\n\ntemplate&lt;class Signature&gt;\nstruct signature_trait;\n\ntemplate&lt;class R, class... Args&gt;\nstruct signature_trait&lt;R(Args...)&gt;\n { using type = std::tuple&lt;R, Args...&gt;; };\n\ntemplate&lt;class R, class... Args&gt;\nstruct signature_trait&lt;R(*)(Args...)&gt;\n { using type = std::tuple&lt;R, Args...&gt;; };\n\ntemplate&lt;class R, class U, class... Args&gt;\nstruct signature_trait&lt;R(U::*)(Args...)&gt;\n { using type = std::tuple&lt;R, Args...&gt;; };\n\ntemplate&lt;class Signature&gt;\nusing signature_trait_t = typename signature_trait&lt;Signature&gt;::type;\n\ntemplate&lt;class Signature1, class Signature2&gt;\nusing is_same_signature = std::is_same&lt;signature_trait_t&lt;Signature1&gt;,\n                                       signature_trait_t&lt;Signature2&gt;&gt;;\n\ntemplate&lt;class Signature1, class Signature2&gt;\ninline constexpr bool is_same_signature_v = \n    is_same_signature&lt;Signature1, Signature2&gt;::value;\n\nstruct Foo\n { void bar (int, int) {} };\n\nvoid bar (int, int) {}\n\nint main ()\n {\n    static_assert(is_same_signature_v&lt;decltype(&amp;bar), decltype(&amp;Foo::bar)&gt;, \"\");\n    static_assert(is_same_signature_v&lt;decltype(&amp;bar), void(int, int)&gt;, \"\");\n    static_assert(is_same_signature_v&lt;decltype(&amp;Foo::bar), void(int, int)&gt;, \"\");\n    static_assert(is_same_signature_v&lt;decltype(&amp;Foo::bar), void(Foo::*)(int, int)&gt;, \"\");\n }\n</code></pre>\n"}], "owner": {"reputation": 270, "user_id": 1226448, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3cef5f5cf69404f97f48e7842cc5eee3?s=128&d=identicon&r=PG", "display_name": "Anton Lashkov", "link": "https://stackoverflow.com/users/1226448/anton-lashkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 51409404, "answer_count": 1, "score": 2, "last_activity_date": 1531941651, "creation_date": 1531939036, "last_edit_date": 1531941111, "question_id": 51408881, "link": "https://stackoverflow.com/questions/51408881/check-that-signature-of-two-functions-or-member-function-pointer-equal", "title": "Check that signature of two functions or member function pointer equal", "body": "<p>I write some code for check that signature of free function is equal to signature of member function, etc. It compare extracted return type and function arguments:</p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;type_traits&gt;\n\ntemplate&lt;class Signature&gt;\nstruct signature_trait;\n\ntemplate&lt;class R, class... Args&gt;\nstruct signature_trait&lt;R(Args...)&gt;\n{\n    using return_type = R;\n    using arg_types = std::tuple&lt;Args...&gt;;\n};\n\ntemplate&lt;class R, class... Args&gt;\nstruct signature_trait&lt;R(*)(Args...)&gt;\n{\n    using return_type = R;\n    using arg_types = std::tuple&lt;Args...&gt;;\n};\n\ntemplate&lt;class R, class U, class... Args&gt;\nstruct signature_trait&lt;R(U::*)(Args...)&gt;\n{\n    using return_type = R;\n    using arg_types = std::tuple&lt;Args...&gt;;\n};\n\ntemplate&lt;class Signature&gt;\nusing signature_trait_r = typename signature_trait&lt;Signature&gt;::return_type;\n\ntemplate&lt;class Signature&gt;\nusing signature_trait_a = typename signature_trait&lt;Signature&gt;::arg_types;\n\ntemplate&lt;class Signature1, class Signature2&gt;\nusing is_same_signature = \n    std::conjunction&lt;\n        std::is_same&lt;signature_trait_r&lt;Signature1&gt;, signature_trait_r&lt;Signature2&gt;&gt;, \n        std::is_same&lt;signature_trait_a&lt;Signature1&gt;, signature_trait_a&lt;Signature2&gt;&gt;\n    &gt;;\n\ntemplate&lt;class Signature1, class Signature2&gt;\ninline constexpr bool is_same_signature_v = \n    is_same_signature&lt;Signature1, Signature2&gt;::value;\n\nstruct Foo\n{\n    void bar(int, int){}\n};\n\nvoid bar(int, int){}\n\nint main()\n{\n    static_assert(is_same_signature_v&lt;decltype(&amp;bar), decltype(&amp;Foo::bar)&gt;, \"\");\n    static_assert(is_same_signature_v&lt;decltype(&amp;bar), void(int, int)&gt;, \"\");\n    static_assert(is_same_signature_v&lt;decltype(&amp;Foo::bar), void(int, int)&gt;, \"\");\n    static_assert(is_same_signature_v&lt;decltype(&amp;Foo::bar), void(Foo::*)(int, int)&gt;, \"\");\n}\n</code></pre>\n\n<p>It works fine, but is it possible to simplify? And maybe there some cases where this solution won't work?</p>\n"}, {"tags": ["c++", "c++17", "clion", "c++-standard-library"], "comments": [{"owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "edited": false, "score": 2, "creation_date": 1531941795, "post_id": 51408824, "comment_id": 89790548, "body": "Does code which is using <code>optional</code> and <code>variant</code> compile? If yes, the problem is with the IDE. You may want to look in its settings for an option to enable a particular C++ standard version."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 1, "creation_date": 1531950204, "post_id": 51408824, "comment_id": 89794357, "body": "Find out the version of your compiler. Try adding <code>-v</code> option to the compiler command line. May be there is an option to choose a compiler in the IDE, look for that."}], "owner": {"reputation": 45, "user_id": 7059221, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9bv2NQDLQz8/AAAAAAAAAAI/AAAAAAAABGY/ASfsjUP5gWc/photo.jpg?sz=128", "display_name": "Alexander Swanson", "link": "https://stackoverflow.com/users/7059221/alexander-swanson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531941721, "creation_date": 1531938782, "last_edit_date": 1531941721, "question_id": 51408824, "link": "https://stackoverflow.com/questions/51408824/missing-standard-library-components", "title": "Missing Standard Library Components", "body": "<p>I'm currently working on a project with C++17 and I have trying to make use of certain libraries (such as <code>variant</code> and <code>optional</code>). However, my IDE cannot find these (I'm using CLion). What would be the best way to debug this issue? I want to know if I truly do not have these installed (although they are part of the STD Library so I would think this unlikely) or if there is an issue with my editor...</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1531938902, "post_id": 51408819, "comment_id": 89789003, "body": "Do you, by chance, ever use <code>json_value</code> inside a standard container?"}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1531938974, "post_id": 51408819, "comment_id": 89789047, "body": "@Justin indeed, see the first three <code>using</code>s at the top of <code>json_value</code>"}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1531938978, "post_id": 51408819, "comment_id": 89789052, "body": "I use std::pair, std::vector and std::unordered_map as a keypair, json_array and json_object respectively.  They&#39;re part of json_value, and recursively hold json_values."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1531939033, "post_id": 51408819, "comment_id": 89789073, "body": "Unrelated: A move assignment operator might be a good addition."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1531939046, "post_id": 51408819, "comment_id": 89789078, "body": "You likely just need to make your move constructor and move assignment operator <code>noexcept</code>. For exception safety, if you don&#39;t, containers will prefer the copy constructor."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1531939076, "post_id": 51408819, "comment_id": 89789092, "body": "@SeanMcAllister <a href=\"https://stackoverflow.com/questions/8001823/how-to-enforce-move-semantics-when-a-vector-grows\">This</a> might be your issue"}], "answers": [{"comments": [{"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1531939257, "post_id": 51408896, "comment_id": 89789174, "body": "And indeed it does!"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1531939774, "post_id": 51408896, "comment_id": 89789489, "body": "Nitpick : If you don&#39;t have a copy constructor, the throwing move constructor will be used. So it&#39;s not impossible to use the move constructor. <code>std::vector</code> can use a throwing move constructor but will only do so if there&#39;s no choice."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1531939825, "post_id": 51408896, "comment_id": 89789523, "body": "@Fran&#231;oisAndrieux Indeed, in that case, you lose the <i>strong exception guarantee</i>."}], "tags": [], "owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "is_accepted": true, "score": 2, "last_activity_date": 1537217596, "last_edit_date": 1537217596, "creation_date": 1531939097, "answer_id": 51408896, "question_id": 51408819, "link": "https://stackoverflow.com/questions/51408819/copy-constructor-being-preferred-over-move-constructor/51408896#51408896", "title": "Copy constructor being preferred over move constructor?", "body": "<p>Standard containers all try to have the <a href=\"https://en.cppreference.com/w/cpp/language/exceptions#Exception_safety\" rel=\"nofollow noreferrer\"><em>strong exception guarantee</em></a>, meaning that if an exception is thrown, it's as if nothing happened.</p>\n\n<p>Take the case of <code>std::vector</code>. In order to keep this guarantee, it can only use the move constructor if it's guaranteed that moving won't throw. Consider the case when the vector needs to resize its buffer:</p>\n\n<pre><code>d // new element to push_back\n[a][b][c] // old, filled buffer\n[ ][ ][ ][ ][ ][ ] // new, empty buffer\n</code></pre>\n\n<p>Moving the new element in place isn't a problem, even if it throws, since we'll still have the old buffer that we can use:</p>\n\n<pre><code>[a][b][c]\n[ ][ ][ ][d][ ][ ]\n</code></pre>\n\n<p>But when we move the old buffer's elements into the new buffer, what happens if we throw in the middle?</p>\n\n<pre><code>[ ][#][c]\n[a][#][ ][d][ ][ ]\n</code></pre>\n\n<p>We don't know the state that <code>b</code> is in when it throws, so how do we recreate the old state? Even if we were able to resurrect <code>b</code>, we can't just go and move the prior elements back, because moving those could throw too.</p>\n\n<p>If we fall back on a copy, we could back out at any time by just discarding the new buffer.</p>\n\n<p>Thus, in order to keep the <em>strong exception guarantee</em>, <code>std::vector</code> can't move unless the move constructor is <code>noexcept</code>.</p>\n\n<hr>\n\n<p>Declaring the move operations as <code>noexcept</code> is necessary for the standard containers to use them. Most of the time, move constructors and move assignments can be <code>noexcept</code>, so declare them as such when they are:</p>\n\n<pre><code>json_value(json_value&amp;&amp; other) noexcept {\n    // ...\n}\n\njson_value&amp; operator=(json_value&amp;&amp; other) noexcept {\n    // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "closed_date": 1531939449, "accepted_answer_id": 51408896, "answer_count": 1, "score": 1, "last_activity_date": 1537217596, "creation_date": 1531938754, "question_id": 51408819, "link": "https://stackoverflow.com/questions/51408819/copy-constructor-being-preferred-over-move-constructor", "closed_reason": "Duplicate", "title": "Copy constructor being preferred over move constructor?", "body": "<p>I'm working on a simple JSON parser for fun, and I've got my value type:</p>\n\n<pre><code>typedef enum {\n    JSON_NULL,\n    JSON_NUMBER,\n    JSON_STRING,\n    JSON_ARRAY,\n    JSON_OBJECT,\n    JSON_BOOLEAN\n} json_type_t;\n\n// datatype for json value\nstruct json_value {\n    using arr_type = vector&lt;json_value&gt;;\n    using obj_pair = pair&lt;string, json_value&gt;;\n    using obj_type = unordered_map&lt;string, json_value&gt;;\n\n    // constructors \n    json_value()\n        : type(JSON_NULL) {}\n\n    json_value(json_type_t type)\n        : type(type) {\n        switch(type) {\n            case JSON_STRING:  str = new string;   break;\n            case JSON_ARRAY:   arr = new arr_type; break;\n            case JSON_OBJECT:  obj = new obj_type; break;\n            default:\n                break;\n        }\n    }\n\n    // copy construct\n    json_value(const json_value&amp; other) {\n        printf(\"copying json value\\n\");\n        if (other.type != JSON_NULL) {\n            type = other.type;\n            switch(type) {\n                case JSON_NULL:                                    return;\n                case JSON_NUMBER:  num = other.num;                return;\n                case JSON_BOOLEAN: val = other.val;                return;         \n                case JSON_STRING:  str = new string  (*other.str); return;\n                case JSON_ARRAY:   arr = new arr_type(*other.arr); return;\n                case JSON_OBJECT:  obj = new obj_type(*other.obj); return;\n            }\n        }\n    }\n\n    // move construct\n    json_value(json_value&amp;&amp; other) {\n        type = other.type;\n        switch(type) {\n            case JSON_NULL:                     break;\n            case JSON_NUMBER:  num = other.num; break;\n            case JSON_BOOLEAN: val = other.val; break; \n            case JSON_STRING:  str = other.str; other.str = nullptr; break;\n            case JSON_ARRAY:   arr = other.arr; other.arr = nullptr; break;\n            case JSON_OBJECT:  obj = other.obj; other.obj = nullptr; break;\n        }\n    }\n\n    // assignment operator copy/swap idiom\n    json_value&amp; operator =(json_value other) {\n        destroy();\n        type = other.type;\n        switch(type) {\n            case JSON_NULL:                     break;\n            case JSON_NUMBER:  num = other.num; break;\n            case JSON_BOOLEAN: val = other.val; break; \n            case JSON_STRING:  str = other.str; other.str = nullptr; break;\n            case JSON_ARRAY:   arr = other.arr; other.arr = nullptr; break;\n            case JSON_OBJECT:  obj = other.obj; other.obj = nullptr; break;\n        }\n        return *this;\n    }\n\n    // destructor\n    ~json_value() {\n        destroy();\n    }\n\n    // type of value and union to hold data\n    json_type_t type = JSON_NULL;\n    union { \n        bool      val;\n        double    num;\n        string   *str;\n        arr_type *arr;\n        obj_type *obj;\n    };\n\nprivate:\n    // cleanup our memory\n    void destroy() { \n        switch(type) {\n            case JSON_NULL:    break;\n            case JSON_NUMBER:  break;\n            case JSON_BOOLEAN: break; \n            case JSON_STRING:  delete str; break;\n            case JSON_ARRAY:   delete arr; break;\n            case JSON_OBJECT:  delete obj; break;\n        }\n        type = JSON_NULL;\n    }\n};\n</code></pre>\n\n<p>I've written proper copy/move constructors and an assignment operator.  My issue is that, when running a particular benchmark, the parser takes about 40ms.  Trying to optimize a bit, I commented out the copy constructor to make sure I'm not making any unecessary copies.  Sure enough, my code still compiles, indicating the move constructor is sufficient,  <em>and</em> it's ~25% faster!   </p>\n\n<p>Instrumenting the copy constructor, I can see it is indeed being called, but as I've shown, the move constructor is sufficient. </p>\n\n<p>So, my question is, in what contexts would a copy constructor be preferred over the move constructor, and how can I find where that's happening?</p>\n"}, {"tags": ["c++", "dirent.h"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1531939435, "post_id": 51408778, "comment_id": 89789273, "body": "I recommend adding a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Not only is making one likely to answer your question, they also make questions and answers more applicable to a wider pool of future askers."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1531939619, "post_id": 51408778, "comment_id": 89789390, "body": "I suggest you use string variables such as <code>std::string</code>, not <code>char *</code> to store names.  In addition, it would cut out the <code>strcat</code> / <code>strcpy</code> that&#39;s going on.  You&#39;re using C++ -- any reason why you&#39;re resorting to <code>C</code>-like programming?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1531939622, "post_id": 51408778, "comment_id": 89789393, "body": "When you are producing the MCVE, keep an eye on the scope of your variables and resist the urge to store pointers to tightly scoped Automatics."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1531939809, "post_id": 51408778, "comment_id": 89789515, "body": "Also <code>char fullDirName[100];</code> -- directory names can be greater than 100 characters on most operating systems."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1531945007, "post_id": 51408778, "comment_id": 89792088, "body": "<code>dirent.h</code> ? Ew. You&#39;re on Windows, filenames are not ASCII."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9161272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JSWVnuTt-Qc/AAAAAAAAAAI/AAAAAAAAAOY/X1T1ozN4Us8/photo.jpg?sz=128", "display_name": "Ziphold", "link": "https://stackoverflow.com/users/9161272/ziphold"}, "edited": false, "score": 0, "creation_date": 1531942558, "post_id": 51409290, "comment_id": 89790887, "body": "After modifying all char arrays to std::strings, everything worked amazingly! Thank you for bothering!"}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": true, "score": 1, "last_activity_date": 1531940560, "creation_date": 1531940560, "answer_id": 51409290, "question_id": 51408778, "link": "https://stackoverflow.com/questions/51408778/stuck-using-dirent-h-to-find-all-files-in-subfolders-c/51409290#51409290", "title": "Stuck using dirent.h to find all files in subfolders C++", "body": "<p>You are ignoring the scope of your char arrays. Effectively you are doing this</p>\n\n<pre><code>const char *dirlist[20];\n\nwhile (...)\n{\n    char fullDirNameIn[100];\n    ....\n    dirlist[dirAm] = fullDirNameIn;\n}\n</code></pre>\n\n<p>The problem is that your array is scoped to the body of while loop but you are storing a pointer to that array outside the while loop. After you exit the body of the loop (i.e. when you iterate) then contents of your array become undefined, but you still have a pointer to it.</p>\n\n<p>The solution is easy and this should be a lesson well learned. <strong>Don't use pointers</strong>, do what experienced programmers do and use <code>std::string</code> instead.</p>\n\n<pre><code>std::string dirlist[20];\n\nwhile (...)\n{\n    std::string fullDirNameIn;\n    ....\n    dirlist[dirAm] = fullDirNameIn;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9161272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JSWVnuTt-Qc/AAAAAAAAAAI/AAAAAAAAAOY/X1T1ozN4Us8/photo.jpg?sz=128", "display_name": "Ziphold", "link": "https://stackoverflow.com/users/9161272/ziphold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 626, "favorite_count": 0, "accepted_answer_id": 51409290, "answer_count": 1, "score": -2, "last_activity_date": 1531940560, "creation_date": 1531938638, "last_edit_date": 1531939301, "question_id": 51408778, "link": "https://stackoverflow.com/questions/51408778/stuck-using-dirent-h-to-find-all-files-in-subfolders-c", "title": "Stuck using dirent.h to find all files in subfolders C++", "body": "<p>I'm currently stuck using dirent.h extension. The goal is to give the function a path directory to start from. That function would then look through all the subfolders from that directory and find files in it. It all works until there are two folders in the same directory. Then the program stubbornly chooses one folder and ignores the other.\nHere goes my mess of a code.\n(The issue is commented at the bottom of the code)</p>\n\n<pre><code>    #include &lt;iostream&gt;\n    #include \"dirent.h\"\n    #include &lt;windows.h&gt;\n\n    DWORD getPathType(const char *path); //checks if path leads to folder or file\n    const char *dirlist[20];  //contains all directories (not files, only dir's)\n    int dirAm = 0;            //specifies amount of directories\n\n    void loadTextures(const char *loaddir) {\n\n        dirlist[dirAm] = loaddir;  //specifies starting directory\n        dirAm++;\n\n        for(int i = 0; i&lt;20; i++) {\n            DIR *dir;\n            struct dirent *ent;\n            const char *currentdir = dirlist[i];  //stores current directory\n            dir = opendir(currentdir);            //opens current directory\n\n            if (dir != NULL) {\n                std::cout &lt;&lt; \"[OPENING dir]\\t\" &lt;&lt; currentdir &lt;&lt; std::endl;\n\n                while ((ent = readdir(dir)) != NULL) {\n                    const char *filename;  //stores current file/folder name\n                    char fullDirName[100]; //stores full path name (current dir+file name, for example /images/+image1.png)\n                    DWORD filetype;        //checking path type (file/folder)\n                    filename = ent-&gt;d_name; //gets current file name\n\n                    strcpy(fullDirName, currentdir); //concats current directory and file name to get full path, for example /images/image1.png\n                    strcat(fullDirName, filename);\n\n                    filetype = getPathType(fullDirName); //gets path type\n                    if (filetype == FILE_ATTRIBUTE_DIRECTORY) {\n                        //if its a directory add it to the list of directories, dirlist, the naming process is the same as above\n                        const char *filenameIn;\n                        char fullDirNameIn[100];\n\n                        filenameIn = ent-&gt;d_name;\n\n                        strcpy(fullDirNameIn, currentdir);\n                        strcat(fullDirNameIn, filenameIn);\n                        strcat(fullDirNameIn, \"/\");\n                        std::cout &lt;&lt; \"[FOUND dir]\\t\" &lt;&lt; fullDirNameIn&lt;&lt;std::endl;\n\n                        dirlist[dirAm] = fullDirNameIn;\n                        dirAm++;\n\n                        /* Here is the problem! The cout line above finds all\n folders in a directory and saves them in the array, but as soon as the new for\n loop iteration starts, the values in the dirlist array... change? And I have no\n idea what is going on */\n\n                    } else {\n                        std::cout &lt;&lt; \"[FOUND file]\\t\" &lt;&lt; fullDirName &lt;&lt; std::endl;\n                    }\n                }\n            }\n        }\n</code></pre>\n\n<p>And here is the getPathType() function. Pretty straight forward, I guess.</p>\n\n<pre><code>DWORD getPathType(const char *path) {\n    DWORD fileat;\n    fileat = GetFileAttributesA(path);\n    return fileat;\n}\n</code></pre>\n\n<p>Finally, here is the console output:</p>\n\n<pre><code>[OPENING dir]   img/                 &lt;- opens starting dir\n[FOUND dir]     img/lvl0/            &lt;- finds lvl0, should store it in dirlist\n[FOUND dir]     img/lvl1/            &lt;- finds lvl1\n[OPENING dir]   img/lvl1/\n[FOUND file]    img/lvl1/player2.png\n[OPENING dir]   img/lvl1/            &lt;- only opens lvl1\n[FOUND file]    img/lvl1/player2.png\n</code></pre>\n\n<p>I know this is a very big question, but I would be quite thankful if someone could share ideas on this.</p>\n"}, {"tags": ["c++", "templates", "c++14", "c++17", "template-meta-programming"], "comments": [{"owner": {"reputation": 701, "user_id": 8189786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a05f8cdcac615b9ddff502e7cd8b0724?s=128&d=identicon&r=PG&f=1", "display_name": "R Balasubramanian", "link": "https://stackoverflow.com/users/8189786/r-balasubramanian"}, "edited": false, "score": 0, "creation_date": 1531940562, "post_id": 51408771, "comment_id": 89789938, "body": "Welcome to SO! Please take a look at <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask</a> questions .- can you post any attempts you&#39;ve made?"}], "answers": [{"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 9, "last_activity_date": 1531940202, "last_edit_date": 1531940202, "creation_date": 1531939705, "answer_id": 51409050, "question_id": 51408771, "link": "https://stackoverflow.com/questions/51408771/c-reversed-integer-sequence-implementation/51409050#51409050", "title": "c++ reversed integer sequence implementation", "body": "<p>IMHO, there is no reason for a <code>index_sequence_reverse</code>: <code>std::index_sequence</code> support sequences of indexes and are order neutral (or even without order).</p>\n\n<p>If you can use <code>std::make_index_sequence</code>, for a <code>makeIndexSequenceReverse</code> you can make something as follows</p>\n\n<pre><code>#include &lt;utility&gt;\n#include &lt;type_traits&gt;\n\ntemplate &lt;std::size_t ... Is&gt;\nconstexpr auto indexSequenceReverse (std::index_sequence&lt;Is...&gt; const &amp;)\n   -&gt; decltype( std::index_sequence&lt;sizeof...(Is)-1U-Is...&gt;{} );\n\ntemplate &lt;std::size_t N&gt;\nusing makeIndexSequenceReverse\n   = decltype(indexSequenceReverse(std::make_index_sequence&lt;N&gt;{}));\n\nint main ()\n {\n   static_assert( std::is_same&lt;std::index_sequence&lt;4U, 3U, 2U, 1U, 0U&gt;,\n      makeIndexSequenceReverse&lt;5U&gt;&gt;::value, \"!\" );\n }\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10101349, "user_type": "registered", "profile_image": "https://graph.facebook.com/1915543301836023/picture?type=large", "display_name": "Andrey Avraliov", "link": "https://stackoverflow.com/users/10101349/andrey-avraliov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1531940202, "creation_date": 1531938613, "last_edit_date": 1531939808, "question_id": 51408771, "link": "https://stackoverflow.com/questions/51408771/c-reversed-integer-sequence-implementation", "title": "c++ reversed integer sequence implementation", "body": "<p>Who knows how to implement C++ <code>std::make_index_sequence</code> reverse version. To get - <code>make_index_sequence_reverse&lt;int, 5&gt; = &lt;4,3,2,1,0&gt;</code>. Thank you!</p>\n"}, {"tags": ["c++", "omnet++", "mac-address", "inet", "data-link-layer"], "answers": [{"comments": [{"owner": {"reputation": 176, "user_id": 5058728, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-crPH-7OvDbQ/AAAAAAAAAAI/AAAAAAAAAf4/Sb8-M3L4mLU/photo.jpg?sz=128", "display_name": "Farzan Badakhshan", "link": "https://stackoverflow.com/users/5058728/farzan-badakhshan"}, "edited": false, "score": 0, "creation_date": 1531945473, "post_id": 51409729, "comment_id": 89792304, "body": "Thanks, the error has gone now, however, this doesn&#39;t work either. The <code>if</code> condition is false. That is, the <code>MacAddressInd</code> tag cannot be found."}, {"owner": {"reputation": 5342, "user_id": 4653172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c894c1021e3092a98cdd62d88e69819?s=128&d=identicon&r=PG&f=1", "display_name": "Jerzy D.", "link": "https://stackoverflow.com/users/4653172/jerzy-d"}, "reply_to_user": {"reputation": 176, "user_id": 5058728, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-crPH-7OvDbQ/AAAAAAAAAAI/AAAAAAAAAf4/Sb8-M3L4mLU/photo.jpg?sz=128", "display_name": "Farzan Badakhshan", "link": "https://stackoverflow.com/users/5058728/farzan-badakhshan"}, "edited": false, "score": 1, "creation_date": 1531948012, "post_id": 51409729, "comment_id": 89793464, "body": "It is because the radio layer does not look for a MAC address in received frame. The <b>MAC layer</b> recognizes the addresses. Try to run any <code>IEEE 802.11</code> example form <code>INET</code> and look at packets that are interchanged between these layers using object inspector."}], "tags": [], "owner": {"reputation": 5342, "user_id": 4653172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c894c1021e3092a98cdd62d88e69819?s=128&d=identicon&r=PG&f=1", "display_name": "Jerzy D.", "link": "https://stackoverflow.com/users/4653172/jerzy-d"}, "is_accepted": true, "score": 1, "last_activity_date": 1532066077, "last_edit_date": 1532066077, "creation_date": 1531942303, "answer_id": 51409729, "question_id": 51408759, "link": "https://stackoverflow.com/questions/51408759/omnet-how-to-obtain-frames-source-mac-address-in-inet-4-0/51409729#51409729", "title": "OMNET++: How to obtain frame&#39;s source MAC Address in INET 4.0?", "body": "<p>The proper name of tag which contains MAC address is <code>MacAddressInd</code>, not <code>MacAddress</code>. It is declared in <code>MacAddressTag_m.h</code> which you have included.  </p>\n\n<p><strong>EDIT</strong><br>\nAdditional remark: the <code>MacAddressInd</code> contains two addresses: source and destination. So you should precise which one you want to obtain, for example:</p>\n\n<pre><code>auto macAddress = macFrame-&gt;getTag&lt;MacAddressInd&gt;()-&gt;getSrcAddress();\n</code></pre>\n"}], "owner": {"reputation": 176, "user_id": 5058728, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-crPH-7OvDbQ/AAAAAAAAAAI/AAAAAAAAAf4/Sb8-M3L4mLU/photo.jpg?sz=128", "display_name": "Farzan Badakhshan", "link": "https://stackoverflow.com/users/5058728/farzan-badakhshan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 51409729, "answer_count": 1, "score": 0, "last_activity_date": 1532066077, "creation_date": 1531938585, "last_edit_date": 1531946044, "question_id": 51408759, "link": "https://stackoverflow.com/questions/51408759/omnet-how-to-obtain-frames-source-mac-address-in-inet-4-0", "title": "OMNET++: How to obtain frame&#39;s source MAC Address in INET 4.0?", "body": "<p>I am using <code>INET</code> Framework 4.0 with <code>OMNET++</code>. I have customised my <code>Ieee80211ScalarRadio</code> module to read signal power and source MAC Address of the beacons received from various APs in my <code>AdhocHost</code>.<br>\nHere is my custom <code>CIeee80211ScalarRadio.ned</code> file:</p>\n\n<pre><code>import inet.physicallayer.ieee80211.packetlevel.Ieee80211ScalarRadio;\n\nmodule CIeee80211ScalarRadio extends Ieee80211ScalarRadio\n{\n    @class(inet::physicallayer::CIeee80211ScalarRadio);\n}\n</code></pre>\n\n<p>And here is the corresponding <code>CIeee80211ScalarRadio.cc</code> file:</p>\n\n<pre><code>#include \"inet/physicallayer/ieee80211/packetlevel/Ieee80211Radio.h\"\n#include \"inet/physicallayer/common/packetlevel/SignalTag_m.h\"\n#include \"inet/linklayer/common/MacAddressTag_m.h\"\n\n\n#include &lt;omnetpp.h&gt;\n#include &lt;string&gt;\n\n#include &lt;cmath&gt;\n#include &lt;iostream&gt;\n\nnamespace inet{\nnamespace physicallayer{\nclass CIeee80211ScalarRadio : public Ieee80211Radio{\nprotected:\n   virtual void sendUp(Packet *macFrame) override;\n};\n\nDefine_Module(CIeee80211ScalarRadio);\n\nvoid CIeee80211ScalarRadio::sendUp(Packet *macFrame)\n{\n    if (macFrame-&gt;findTag&lt;SignalPowerInd&gt;() != nullptr) {\n           auto signalPowerInd = macFrame-&gt;getTag&lt;SignalPowerInd&gt;();\n           auto rxPower = signalPowerInd-&gt;getPower().get();\n           double pdBm = 10*log10(rxPower)+30;\n           EV_INFO &lt;&lt; \"RX power = \" &lt;&lt; pdBm &lt;&lt; \" dBm\" &lt;&lt; endl;\n    }\n    if(macFrame-&gt;findTag&lt;MacAddress&gt;() != nullptr){\n        auto macAddress = macFrame-&gt;getTag&lt;MacAddress&gt;();\n        EV_INFO &lt;&lt; \"Mac Address = \" &lt;&lt; macAddress &lt;&lt; endl;\n    }\n\n    Radio::sendUp(macFrame);\n}\n}//namespace physicallayer\n}//namespace inet\n</code></pre>\n\n<p>As you can see, I am overriding <code>Ieee80211ScalarRadio</code>'s <code>sendUp()</code> method to obtain the values I want from the <code>macFrame</code>.<br>\nI can extract the <code>RxPower</code> successfully, however, when I do the same thing for <code>MacAddress</code>, I get the following compiler error in <code>INET</code>'s own source code:</p>\n\n<pre><code>../inet4/src/inet/common/packet/tag/TagSet.h:123:36: error: static_cast from 'std::__1::__vector_base&lt;omnetpp::cObject *, std::__1::allocator&lt;omnetpp::cObject *&gt; &gt;::value_type' (aka 'omnetpp::cObject *') to 'inet::MacAddress *', which are not related by inheritance, is not allowed\n</code></pre>\n\n<p>How can I get the <code>MacAddress</code> value without any error?</p>\n"}, {"tags": ["c++", "node.js", "error-handling", "crash", "node-ffi"], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 5587251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db08e52f36b4931f05d14f75b64bd109?s=128&d=identicon&r=PG&f=1", "display_name": "Callum Thomas", "link": "https://stackoverflow.com/users/5587251/callum-thomas"}, "is_accepted": true, "score": 1, "last_activity_date": 1534530723, "creation_date": 1534530723, "answer_id": 51901095, "question_id": 51408715, "link": "https://stackoverflow.com/questions/51408715/how-to-prevent-node-from-crashing-when-using-node-ffi/51901095#51901095", "title": "How to prevent Node from crashing when using node-ffi", "body": "<p>The answer is to do input validation on the C++ side, and for debugging to write text files as the crash output.</p>\n"}], "owner": {"reputation": 63, "user_id": 5587251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db08e52f36b4931f05d14f75b64bd109?s=128&d=identicon&r=PG&f=1", "display_name": "Callum Thomas", "link": "https://stackoverflow.com/users/5587251/callum-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "accepted_answer_id": 51901095, "answer_count": 1, "score": 0, "last_activity_date": 1534530723, "creation_date": 1531938374, "question_id": 51408715, "link": "https://stackoverflow.com/questions/51408715/how-to-prevent-node-from-crashing-when-using-node-ffi", "title": "How to prevent Node from crashing when using node-ffi", "body": "<p>I have a node.js server that uses Node-ffi to call C++ code and send it to the client. The problem I'm facing is that the client can send user input that crashes the C++ program, how do I prevent this?</p>\n\n<p>When the C++ program crashes, the following output appears in the terminal of the server:</p>\n\n<pre><code>npm ERR! code ELIFECYCLE\nnpm ERR! errno 3221225477\nnpm ERR! ws_send_json_server@1.0.0 start: `node app.js`\nnpm ERR! Exit status 3221225477\nnpm ERR!\nnpm ERR! Failed at the ws_send_json_server@1.0.0 start script.\nnpm ERR! This is probably not a problem with npm. There is likely additional logging output above.\n\nnpm ERR! A complete log of this run can be found in:\n</code></pre>\n\n<p>I'm wondering if it's possible to write a try-catch block or something else around the node-ffi function calls, for example:</p>\n\n<pre><code>try {\n    greenbuild.GB_SetArchOffset(messageJSON.Item.arch_offset);\n    greenbuild.GB_SetArchRadius(messageJSON.Item.arch_radius);\n    greenbuild.GB_SetBayLength(messageJSON.Item.bay_length);\n    greenbuild.GB_SetBayWidth(messageJSON.Item.bay_width);\n    greenbuild.GB_SetPeakHeight(messageJSON.Item.peak_height);\n    greenbuild.GB_SetWallHeight(messageJSON.Item.wall_height);\n    greenbuild.GB_SetColumnSpacing(messageJSON.Item.column_spacing);\n    greenbuild.GB_SetNumBayLength(messageJSON.Item.number_bays_length);\n    greenbuild.GB_SetNumBayWidth(messageJSON.Item.number_bays_width);\n    greenbuild.GB_SetNumPanelHorzLength(messageJSON.Item.horizontal_panels_length);\n    greenbuild.GB_SetNumPanelHorzWidth(messageJSON.Item.horizontal_panels_width)\n    greenbuild.GB_SetNumPanelVert(messageJSON.Item.vertical_panels);\n\n} catch (ERROR) {\n    console.error(\"error occurred, but the whole server is still running.\")\n}\n</code></pre>\n\n<p>where \"greenbuild\" is a ffi.Library of C++ code.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "fstream"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1531938372, "post_id": 51408658, "comment_id": 89788691, "body": "<code>find</code> will fail every time except the one line that matches. You need to check <code>found</code> before trying to use it."}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 2, "creation_date": 1531938373, "post_id": 51408658, "comment_id": 89788693, "body": "<code>content[0] &amp;&amp; content[1] == &#39;&#47;&#39;</code> this does not check if the line starts with <code>&#47;&#47;</code>. It checks <code>(content[0]) &amp;&amp; (content[1] == &#39;&#47;&#39;)</code>."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1531938463, "post_id": 51408658, "comment_id": 89788750, "body": "<code>content[0]</code> doesn&#39;t check if the line is empty, either. Undefined behavior, with a chance of a crash."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1531938583, "post_id": 51408658, "comment_id": 89788809, "body": "Furthermore, I&#39;m quite confident that even if the line has at least two characters, <code>content[0] &amp;&amp; content[1] == &#39;&#47;&#39;</code> doesn&#39;t do what you think it does. It does not, I repeat, <b><i>does not</i></b> check if the first two characters in the line are slashes, as your likely intent is. C++ does not work this way."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1531942283, "post_id": 51408658, "comment_id": 89790760, "body": "Gosh, three comments saying that <code>content[0] &amp;&amp; content[1] == &#39;&#47;&#39;</code> doesn&#39;t do what you want, but none of the three says how to write that test. Welcome to StackExchange! If you know that there are at least two characters in <code>content</code>, then you should check <code>content[0] == &#39;&#47;&#39; &amp;&amp; content[1] == &#39;&#47;&#39;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "is_accepted": true, "score": 1, "last_activity_date": 1531938492, "creation_date": 1531938492, "answer_id": 51408739, "question_id": 51408658, "link": "https://stackoverflow.com/questions/51408658/microsoft-c-exception-stdout-of-range-at-memory-location/51408739#51408739", "title": "Microsoft C++ exception: std::out_of_range at memory location", "body": "<p>A couple notes on the following excerpt:</p>\n\n<pre><code>content[0] &amp;&amp; content[1] == '/'\n</code></pre>\n\n<p>When you write <code>content[0]</code> and <code>content[1]</code>, you're <em>assuming</em> that the characters at positions 0 and 1 exist, which is not necessarily the case. You should wrap this code in a condition like <code>if (content.size() &gt;= 2){ ... }</code> To protect yourself from accessing string contents that don't exist. </p>\n\n<p>Secondly, as currently written, this code will convert <code>content[0]</code> to <code>bool</code>, because of how the logical AND operator <code>&amp;&amp;</code> works. You should write <code>content[0] == '/' &amp;&amp; content[1] == '/'</code> if you want to check that the first and second characters are both <code>'/'</code></p>\n\n<p>Furthermore, in the following snippet:</p>\n\n<pre><code>size_t found = content.find(\"citylocation.txt\");\nstring city = content.substr(found);\n</code></pre>\n\n<p>What should happen if <code>\"citylocation.txt\"</code> can't be found in the string? <code>std::string::find</code> handles this by returning the special value <code>std::string::npos</code>. You should test against this to check if the substring could be found, again to prevent yourself from reading an invalid memory location:</p>\n\n<pre><code>size_t found = content.find(\"citylocation.txt\");\nif (found != std::string::npos){\n    std::string city = content.substr(found);\n    // do work with 'city' ...\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10101333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14931322394e419fffc0764f486d1ab6?s=128&d=identicon&r=PG&f=1", "display_name": "Ravichandran Muthia", "link": "https://stackoverflow.com/users/10101333/ravichandran-muthia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1542, "favorite_count": 0, "accepted_answer_id": 51408739, "answer_count": 1, "score": 0, "last_activity_date": 1532295948, "creation_date": 1531938186, "last_edit_date": 1532295948, "question_id": 51408658, "link": "https://stackoverflow.com/questions/51408658/microsoft-c-exception-stdout-of-range-at-memory-location", "title": "Microsoft C++ exception: std::out_of_range at memory location", "body": "<p>I was trying to output a specific line in the file using the find() and substr(), just to see if it works. As you can see i'm quite a beginner so i would appreciate any comments or tips on my code. </p>\n\n<pre><code>inFile.open(\"config.txt\");\nstring content;\nwhile (getline(inFile, content)){\n\n    if (content[0] &amp;&amp; content[1] == '/') continue;\n\n    size_t found = content.find(\"citylocation.txt\");\n    string city = content.substr(found);\n\n    cout &lt;&lt; city &lt;&lt; '\\n';\n\n}\n</code></pre>\n"}, {"tags": ["c++", "parallel-processing", "stl", "mpi"], "comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1531943468, "post_id": 51408632, "comment_id": 89791355, "body": "This question is frequently asked in numerous variations, but I haven&#39;t found a suitable duplicate. So I tried to add a canonical answer."}], "answers": [{"comments": [{"owner": {"reputation": 801, "user_id": 9147662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37fb4a650eeaeb33df9d57f04b0185c9?s=128&d=identicon&r=PG&f=1", "display_name": "user27490", "link": "https://stackoverflow.com/users/9147662/user27490"}, "edited": false, "score": 0, "creation_date": 1531939719, "post_id": 51408980, "comment_id": 89789463, "body": "Yes that would work. But I want to write a general function to Bcast any object. <code>MPI_Bcast(&amp;foo, sizeof(foo), MPI_BYTE, 0, MPI_COMM_WORLD)</code> works for most classes I know, but not for std::vector."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 1, "creation_date": 1531943112, "post_id": 51408980, "comment_id": 89791180, "body": "This condition is a bad trap inviting errors where <code>v</code> is empty on some ranks."}, {"owner": {"reputation": 583, "user_id": 1948525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5bccd182ec2401b4f8e031067b45d1?s=128&d=identicon&r=PG", "display_name": "SJHowe", "link": "https://stackoverflow.com/users/1948525/sjhowe"}, "edited": false, "score": 0, "creation_date": 1531947060, "post_id": 51408980, "comment_id": 89793021, "body": "Zulan: That is why the first line of code is checking to see if v is not empty and does not make the API call to MPI_Bcast if it is."}, {"owner": {"reputation": 583, "user_id": 1948525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5bccd182ec2401b4f8e031067b45d1?s=128&d=identicon&r=PG", "display_name": "SJHowe", "link": "https://stackoverflow.com/users/1948525/sjhowe"}, "edited": false, "score": 0, "creation_date": 1531947502, "post_id": 51408980, "comment_id": 89793237, "body": "user27490: sizeof(foo) wont work. A vector typically is 3 pointers.  So for 32-bits you will get 12 and for 64-bits 24, regardless of how many items the vector is managing. The true size of the vector  is always v.size() * sizeof(underlying type)"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1531968109, "post_id": 51408980, "comment_id": 89798566, "body": "@SJHowe <code>MPI_Bcast()</code> is a collective operation and hence must be invoked by all the ranks of the communicator. A direct consequence is that <code>v.size()</code> (and hence <code>v.empty()</code>) must be identical on all the ranks, and it is up to the programmer to ensure that. if <code>v</code> is empty on some but not all ranks, your app will likely end up hanging, possibly in an other location, making troubleshooting very hard.. On the other hand, if <code>v.size()</code> is not identical, your app will likely crash in <code>MPI_Bcast()</code> and that is way easier to debug."}], "tags": [], "owner": {"reputation": 583, "user_id": 1948525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5bccd182ec2401b4f8e031067b45d1?s=128&d=identicon&r=PG", "display_name": "SJHowe", "link": "https://stackoverflow.com/users/1948525/sjhowe"}, "is_accepted": false, "score": 1, "last_activity_date": 1531948139, "last_edit_date": 1531948139, "creation_date": 1531939454, "answer_id": 51408980, "question_id": 51408632, "link": "https://stackoverflow.com/questions/51408632/mpi-bcast-c-stl-vector/51408980#51408980", "title": "MPI_Bcast c++ STL vector", "body": "<p>Most likely you want</p>\n\n<pre><code>if (!v.empty())\n    MPI_Bcast(&amp;v[0], v.size() * sizeof(decltype(v)::value_type)), MPI_BYTE, 0, MPI_COMM_WORLD);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": true, "score": 3, "last_activity_date": 1531943409, "creation_date": 1531943409, "answer_id": 51409988, "question_id": 51408632, "link": "https://stackoverflow.com/questions/51408632/mpi-bcast-c-stl-vector/51409988#51409988", "title": "MPI_Bcast c++ STL vector", "body": "<p>The address of a <code>vector</code> itself is not the same as of it's <code>data</code>. Sending objects like you propose only works for <em>trivially copyable</em> types - you can imagine MPI communication works similarly to <code>memcpy</code>. You can check with <code>std::is_trivially_copyable</code> - <code>std::vector</code> itself is never <em>trivially copyable</em>.</p>\n\n<p>However, <code>vector</code> stores it's <code>data</code> in contiguous memory - on which you may use <code>memcpy</code>.</p>\n\n<p>You must ensure that <strong>all MPI processes have a vector with the same <code>size</code> before the operation</strong>. <code>capacity</code> is not sufficient. If you only know the <code>size</code> on one process, you must broadcast the size before and <code>resize</code> the target vectors on the other process accordingly.</p>\n\n<p>Also, the elements in your vector must be <em>trivially copyable</em> themselves.</p>\n\n<pre><code>MPI_Bcast(v.data(), v.size(), MPI_INT, 0, MPI_COMM_WORLD);\n</code></pre>\n\n<p>If for some reason you have trouble figuring out the MPI type (e.g. <code>MPI_INT</code>), you can do it as follows (avoiding redundancy that breaks when you change the type).</p>\n\n<pre><code>MPI_Bcast(v.data(), v.size() * sizeof(decltype(v)::value_type)), MPI_BYTE, 0, MPI_COMM_WORLD);\n</code></pre>\n"}], "owner": {"reputation": 801, "user_id": 9147662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37fb4a650eeaeb33df9d57f04b0185c9?s=128&d=identicon&r=PG&f=1", "display_name": "user27490", "link": "https://stackoverflow.com/users/9147662/user27490"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 989, "favorite_count": 1, "accepted_answer_id": 51409988, "answer_count": 2, "score": 0, "last_activity_date": 1531948139, "creation_date": 1531938065, "last_edit_date": 1531941480, "question_id": 51408632, "link": "https://stackoverflow.com/questions/51408632/mpi-bcast-c-stl-vector", "title": "MPI_Bcast c++ STL vector", "body": "<p>Why does the following code not work? It works for my user-defined class but not for STL vector.</p>\n\n<pre><code>std::vector&lt;int&gt; v(4);\nMPI_Bcast(&amp;v, sizeof(v), MPI_BYTE, 0, MPI_COMM_WORLD);\n</code></pre>\n\n<p>I got segmentation error:</p>\n\n<pre><code>[sdg:13611] Signal: Segmentation fault (11)\n[sdg:13611] Signal code: Address not mapped (1)\n</code></pre>\n\n<p>Since the elements in vector are stored contiguously, why can't I send std::vector as a whole using MPI_BYTE?</p>\n"}, {"tags": ["java", "android", "c++", "android-studio", "android-studio-3.1.3"], "answers": [{"tags": [], "owner": {"reputation": 5131, "user_id": 5135551, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ILHpb.jpg?s=128&g=1", "display_name": "Jim Leask", "link": "https://stackoverflow.com/users/5135551/jim-leask"}, "is_accepted": false, "score": 0, "last_activity_date": 1533241612, "creation_date": 1533241612, "answer_id": 51661664, "question_id": 51408563, "link": "https://stackoverflow.com/questions/51408563/exteranl-native-build-issues-build-command-failed-android-studio/51661664#51661664", "title": "exteranl native build issues,build command failed, android studio", "body": "<p>I just had this problem too. I think my C compiler / NDK environment was corrupted for some reason. However reinstalling these tools fixed the problem.</p>\n\n<p>Steps to reinstall C / NDK environment:</p>\n\n<ul>\n<li>Android menu: Tools > SDK Manager</li>\n<li>Appearance &amp; Behaviour > System Settings > Android SDK</li>\n<li>SDK Tools tab</li>\n<li>Uncheck CMake, LLDB, NDK and click OK (to uninstall them)</li>\n<li>Check CMake, LLDB, NDK and click OK (to install them again - takes some time)</li>\n</ul>\n\n<p>After forcing a refresh of the tools, everything compiled correctly again.</p>\n"}], "owner": {"reputation": 442, "user_id": 9666795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf51883733cb3335d251059e5956a3d5?s=128&d=identicon&r=PG&f=1", "display_name": "mrpepo877", "link": "https://stackoverflow.com/users/9666795/mrpepo877"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 657, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533241612, "creation_date": 1531937833, "question_id": 51408563, "link": "https://stackoverflow.com/questions/51408563/exteranl-native-build-issues-build-command-failed-android-studio", "title": "exteranl native build issues,build command failed, android studio", "body": "<p>i posted one question about a problem that i was having,and it was answer but appear another problems less than before, but it follow being a problems that i really don t understand, because i am new in doing app android with android studio. those were the consoles errors that give me android studios:</p>\n\n<p>first:</p>\n\n<pre><code>null \nBuild command failed. \nError while executing process C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\cmake\\3.6.4111459\\bin\\cmake.exe with arguments {-HC:\\Users\\Raul del Rio\\AndroidStudioProjects\\MyApplication2\\app -BC:\\Users\\Raul del Rio\\AndroidStudioProjects\\MyApplication2\\app\\.externalNativeBuild\\cmake\\debug\\armeabi-v7a -DANDROID_ABI=armeabi-v7a -DANDROID_PLATFORM=android-15 -DCMAKE_LIBRARY_OUTPUT_DIRECTORY=C:\\Users\\Raul del Rio\\AndroidStudioProjects\\MyApplication2\\app\\build\\intermediates\\cmake\\debug\\obj\\armeabi-v7a -DCMAKE_BUILD_TYPE=Debug -DANDROID_NDK=C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\ndk-bundle -DCMAKE_CXX_FLAGS=-std=c++14 -fexceptions -frtti -DCMAKE_TOOLCHAIN_FILE=C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\ndk-bundle\\build\\cmake\\android.toolchain.cmake -DCMAKE_MAKE_PROGRAM=C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\cmake\\3.6.4111459\\bin\\ninja.exe -GAndroid Gradle - Ninja -DBUILD_TESTING=OFF -DANDROID_TOOLCHAIN=gcc-4.9} \nC:/Users/Raul del Rio/AndroidStudioProjects/MyApplication2 \n../../AppData/Local/Android/Sdk/ndk-bundle/build/cmake/android.toolchain.cmake \n (include)   CMakeLists.txt \n&lt;a href=\"openFile:C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\ndk-bundle\\build\\cmake\\android.toolchain.cmake\"&gt;Open File&lt;/a&gt; \n (include)   CMakeLists.txt \n&lt;a href=\"openFile:C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\ndk-bundle\\build\\cmake\\android.toolchain.cmake\"&gt;Open File&lt;/a&gt; \nCMake Error: CMAKE_C_COMPILER not set, after EnableLanguage \nCMake Error: CMAKE_CXX_COMPILER not set, after EnableLanguage \n-- Configuring incomplete, errors occurred! \nBuild command failed. \nError while executing process C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\cmake\\3.6.4111459\\bin\\cmake.exe with arguments {-HC:\\Users\\Raul del Rio\\AndroidStudioProjects\\MyApplication2\\app -BC:\\Users\\Raul del Rio\\AndroidStudioProjects\\MyApplication2\\app\\.externalNativeBuild\\cmake\\release\\armeabi-v7a -DANDROID_ABI=armeabi-v7a -DANDROID_PLATFORM=android-15 -DCMAKE_LIBRARY_OUTPUT_DIRECTORY=C:\\Users\\Raul del Rio\\AndroidStudioProjects\\MyApplication2\\app\\build\\intermediates\\cmake\\release\\obj\\armeabi-v7a -DCMAKE_BUILD_TYPE=Release -DANDROID_NDK=C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\ndk-bundle -DCMAKE_CXX_FLAGS=-std=c++14 -fexceptions -frtti -DCMAKE_TOOLCHAIN_FILE=C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\ndk-bundle\\build\\cmake\\android.toolchain.cmake -DCMAKE_MAKE_PROGRAM=C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\cmake\\3.6.4111459\\bin\\ninja.exe -GAndroid Gradle - Ninja -DBUILD_TESTING=OFF -DANDROID_TOOLCHAIN=gcc-4.9} \nCMake Error: CMAKE_C_COMPILER not set, after EnableLanguage\nCMake Error: CMAKE_CXX_COMPILER not set, after EnableLanguage   \n-- Configuring incomplete, errors occurred! \n</code></pre>\n\n<p>here is the other console:</p>\n\n<pre><code>Build command failed.\n\n\nError while executing process C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\cmake\\3.6.4111459\\bin\\cmake.exe with arguments {-HC:\\Users\\Raul del Rio\\AndroidStudioProjects\\MyApplication2\\app -BC:\\Users\\Raul del Rio\\AndroidStudioProjects\\MyApplication2\\app\\.externalNativeBuild\\cmake\\debug\\armeabi-v7a -DANDROID_ABI=armeabi-v7a -DANDROID_PLATFORM=android-15 -DCMAKE_LIBRARY_OUTPUT_DIRECTORY=C:\\Users\\Raul del Rio\\AndroidStudioProjects\\MyApplication2\\app\\build\\intermediates\\cmake\\debug\\obj\\armeabi-v7a -DCMAKE_BUILD_TYPE=Debug -DANDROID_NDK=C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\ndk-bundle -DCMAKE_CXX_FLAGS=-std=c++14 -fexceptions -frtti -DCMAKE_TOOLCHAIN_FILE=C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\ndk-bundle\\build\\cmake\\android.toolchain.cmake -DCMAKE_MAKE_PROGRAM=C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\cmake\\3.6.4111459\\bin\\ninja.exe -GAndroid Gradle - Ninja -DBUILD_TESTING=OFF -DANDROID_TOOLCHAIN=gcc-4.9}\n\n\n (include)   CMakeLists.txt \nOpen File\n\n\nCMake Error: CMAKE_C_COMPILER not set, after EnableLanguage\n\n\nCMake Error: CMAKE_CXX_COMPILER not set, after EnableLanguage\n\n\n-- Configuring incomplete, errors occurred!\n\n\nBuild command failed.\n\n\nError while executing process C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\cmake\\3.6.4111459\\bin\\cmake.exe with arguments {-HC:\\Users\\Raul del Rio\\AndroidStudioProjects\\MyApplication2\\app -BC:\\Users\\Raul del Rio\\AndroidStudioProjects\\MyApplication2\\app\\.externalNativeBuild\\cmake\\release\\armeabi-v7a -DANDROID_ABI=armeabi-v7a -DANDROID_PLATFORM=android-15 -DCMAKE_LIBRARY_OUTPUT_DIRECTORY=C:\\Users\\Raul del Rio\\AndroidStudioProjects\\MyApplication2\\app\\build\\intermediates\\cmake\\release\\obj\\armeabi-v7a -DCMAKE_BUILD_TYPE=Release -DANDROID_NDK=C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\ndk-bundle -DCMAKE_CXX_FLAGS=-std=c++14 -fexceptions -frtti -DCMAKE_TOOLCHAIN_FILE=C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\ndk-bundle\\build\\cmake\\android.toolchain.cmake -DCMAKE_MAKE_PROGRAM=C:\\Users\\Raul del Rio\\AppData\\Local\\Android\\Sdk\\cmake\\3.6.4111459\\bin\\ninja.exe -GAndroid Gradle - Ninja -DBUILD_TESTING=OFF -DANDROID_TOOLCHAIN=gcc-4.9}\n\n\n (include)   CMakeLists.txt \nOpen File\n\n\nCMake Error: CMAKE_C_COMPILER not set, after EnableLanguage\n\n\nCMake Error: CMAKE_CXX_COMPILER not set, after EnableLanguage\n\n\n-- Configuring incomplete, errors occurred!\n</code></pre>\n\n<p>this was the change that i did to solve the past problem:</p>\n\n<pre><code>android {\n    compileSdkVersion 28\n    defaultConfig {\n    applicationId \"com.example.rauldelrio.myapplication\"\n    minSdkVersion 15\n    targetSdkVersion 28\n    versionCode 1\n    versionName \"1.0\"\n    testInstrumentationRunner \"android.support.test.runner.AndroidJUnitRunner\"\n\n    externalNativeBuild {\n        cmake {\n            arguments '-DBUILD_TESTING=OFF', '-DANDROID_TOOLCHAIN=gcc-4.9'\n            cppFlags \"-std=c++14 -fexceptions -frtti\"\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "arguments"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1531937786, "post_id": 51408509, "comment_id": 89788338, "body": "<code>s += (result of ternary)</code>"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1531937857, "post_id": 51408509, "comment_id": 89788378, "body": "It\u2019s being &quot;added&quot; to <code>s</code>, I\u2019m not sure what the confusion is. It\u2019s an expression."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1531937859, "post_id": 51408509, "comment_id": 89788380, "body": "<code>&#39;0&#39; + digit</code> value would be one of <code>&#39;0&#39;</code>, <code>&#39;1&#39;</code>, <code>&#39;2&#39;</code>, <code>&#39;3&#39;</code>, <code>&#39;4&#39;</code>, <code>&#39;5&#39;</code>, <code>&#39;6&#39;</code>, <code>&#39;7&#39;</code>, <code>&#39;8&#39;</code>, <code>&#39;9&#39;</code>."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1531938009, "post_id": 51408509, "comment_id": 89788465, "body": "Ternary returns value: <code>condition ? true_value : false_value</code>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1531939425, "post_id": 51408509, "comment_id": 89789270, "body": "I prefer more portable <code>s += &quot;0123456789abcdefghijklmnopkrstuvwxyz&quot;[digit];</code> (assuming <code>digit &lt; 36</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1531939301, "post_id": 51408555, "comment_id": 89789199, "body": "<code>&#39;a&#39;</code>-<code>&#39;z&#39;</code> is not guarantied to be contiguous BTW."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1531939645, "post_id": 51408555, "comment_id": 89789405, "body": "@Jarod42, Thanks for pointing that out. It&#39;s an easy one to miss when ASCII encoding is so dominant."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 3, "last_activity_date": 1531938134, "last_edit_date": 1531938134, "creation_date": 1531937805, "answer_id": 51408555, "question_id": 51408509, "link": "https://stackoverflow.com/questions/51408509/confusion-surrounding-the-use-of-as-no-value-is-assumed/51408555#51408555", "title": "Confusion surrounding the use of &quot;?&quot;, as no value is assumed", "body": "<blockquote>\n  <p>What variable are we exactly setting to '0' + digit or 'a' + digit -10 pending the validity of the condition?</p>\n</blockquote>\n\n<p>Simplify the line</p>\n\n<pre><code>s += digit &lt; 10 ? '0' + digit :'a' + digit - 10;\n</code></pre>\n\n<p>to </p>\n\n<pre><code>char temp = (digit &lt; 10) ? ('0' + digit) : ('a' + digit - 10);\ns += temp;\n</code></pre>\n\n<p>That line adds a character corresponding to the digit to <code>s</code>. If the numerical value of the digit is less than 10, the corresponding character will be <code>0</code>-<code>9</code>. If the numerical value of the digit is greater than or equal to 10 (presumably it is less then 16), the corresponding character will be <code>a</code>-<code>f</code>. However, the code will gladly work with the values of digit greater than or equal to 16. In that case, characters <code>g</code> and up will be added to <code>s</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1531939256, "post_id": 51408642, "comment_id": 89789173, "body": "Whereas <code>&#39;0&#39;</code>-<code>&#39;9&#39;</code> is guarantied to be contiguous, it is not the case of <code>&#39;a&#39;</code>-<code>&#39;z&#39;</code>."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1531939573, "post_id": 51408642, "comment_id": 89789359, "body": "@Jarod42 would it then be more correct to write <code>s += &quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;[i]</code> ?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1531939655, "post_id": 51408642, "comment_id": 89789415, "body": "Yes (with same restriction digit)."}], "tags": [], "owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "is_accepted": false, "score": 0, "last_activity_date": 1531939719, "last_edit_date": 1531939719, "creation_date": 1531938117, "answer_id": 51408642, "question_id": 51408509, "link": "https://stackoverflow.com/questions/51408509/confusion-surrounding-the-use-of-as-no-value-is-assumed/51408642#51408642", "title": "Confusion surrounding the use of &quot;?&quot;, as no value is assumed", "body": "<p>It might help to replace the conditional operator with simple <code>if</code> statements:</p>\n\n<pre><code>digit = n%b;\nif (digit &lt; 10){\n    s += '0' + digit;\n} else {\n    s += 'a' + digit - 10;\n}\n</code></pre>\n\n<p>In the first case, if <code>digit</code> is between 0 and 9 inclusive, the string <code>s</code> has the corresponding character from<code>'0'</code> through <code>'9'</code> appending. In the second case, if the <code>digit</code> is greater than or equal to 10, the corresponding alphabetic character is used. Overall, this performs the following mapping, assuming base is less than or equal to 36:</p>\n\n<ul>\n<li>0 : <code>'0'</code></li>\n<li>1 : <code>'1'</code></li>\n<li>...</li>\n<li>9 : <code>'9'</code></li>\n<li>10 : <code>'a'</code></li>\n<li>11 : <code>'b'</code></li>\n<li>...</li>\n<li>35 : <code>'z'</code></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 102, "user_id": 9643935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b6f138af2cb0b43798f9527d5eccfe9?s=128&d=identicon&r=PG&f=1", "display_name": "Jon E", "link": "https://stackoverflow.com/users/9643935/jon-e"}, "is_accepted": false, "score": 1, "last_activity_date": 1531938171, "creation_date": 1531938171, "answer_id": 51408653, "question_id": 51408509, "link": "https://stackoverflow.com/questions/51408509/confusion-surrounding-the-use-of-as-no-value-is-assumed/51408653#51408653", "title": "Confusion surrounding the use of &quot;?&quot;, as no value is assumed", "body": "<p>The ternary operator tests an expression (in your case digit &lt; 10), and returns if_true if it's true, if_false if it's false.</p>\n\n<p>From your example, this: </p>\n\n<pre><code> s += digit &lt; 10 ? '0' + digit :'a' + digit - 10\n</code></pre>\n\n<p>could also be written as:</p>\n\n<pre><code>if (digit &lt; 10) {\n    s += '0' + digit;\n} else {\n    s += 'a' + digit - 10;\n}\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 9078057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba2501f267e5133e981e8860e485f9bc?s=128&d=identicon&r=PG", "display_name": "user9078057", "link": "https://stackoverflow.com/users/9078057/user9078057"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 51408555, "answer_count": 3, "score": 0, "last_activity_date": 1531939719, "creation_date": 1531937591, "last_edit_date": 1531939565, "question_id": 51408509, "link": "https://stackoverflow.com/questions/51408509/confusion-surrounding-the-use-of-as-no-value-is-assumed", "title": "Confusion surrounding the use of &quot;?&quot;, as no value is assumed", "body": "<pre><code> std::string qfunc(unsigned int n, unsigned int base) \n {\n     std::string s; \n     do\n     {\n         unsigned int digit = n % base;\n         s += digit &lt; 10 ? '0' + digit :'a' + digit - 10;\n         n /= base;\n     } while (n != 0);\n     ...\n</code></pre>\n\n<p>I have recently become acquainted with the \n\"<code>condition ? if_true : if_false</code>\" argument, however, I am confused by the <code>if_true</code> and <code>if_false</code> statements. What variable are we exactly setting to <code>'0' + digit</code> or <code>'a' + digit - 10</code> pending the validity of the condition? </p>\n\n<p>at the moment wouldn't <code>'0' + digit</code> or <code>'a' + digit - 10</code> simply be statements that have no bearing on any variable in the code?</p>\n\n<p>If someone could give me clarity on this topic, I would be very grateful.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1531938648, "post_id": 51408503, "comment_id": 89788852, "body": "&quot;in order&quot; In what order? All the <code>Foo</code>s and then all the <code>Bars</code>, <code>Bar</code>s then <code>Foos</code>, ascending, descending, or some other ordering that I kind-of need to know more to be able to grasp?"}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1531938854, "post_id": 51408672, "comment_id": 89788975, "body": "May need a call to <code>std::sort</code> in there depending on how the combiniation is to be ordered"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1531939955, "post_id": 51408672, "comment_id": 89789607, "body": "You may <code>reserve</code> to appropriate size."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1531940008, "post_id": 51408672, "comment_id": 89789637, "body": "You may also store the lambda in a variable to reuse it (as you create generic lambda)."}], "tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": false, "score": 4, "last_activity_date": 1531940313, "last_edit_date": 1531940313, "creation_date": 1531938228, "answer_id": 51408672, "question_id": 51408503, "link": "https://stackoverflow.com/questions/51408503/c-concatenate-attributes-of-two-vectors-of-different-type-into-new-vector/51408672#51408672", "title": "C++ Concatenate attributes of two vectors of different type into new vector", "body": "<p>I don't know that you need something more succinct than simply:</p>\n\n<pre><code>int main() {\n    std::vector&lt;Foo&gt; foos = get_foos();\n    std::vector&lt;Bar&gt; bars = get_bars();\n\n    std::vector&lt;int&gt; vec;\n    auto merge = [](auto const&amp; arg) {return arg.baz;};\n    std::transform(foos.begin(), foos.end(), std::back_inserter(vec), merge);\n    std::transform(bars.begin(), bars.end(), std::back_inserter(vec), merge);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 56338, "user_id": 4573247, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/JHd9a.png?s=128&g=1", "display_name": "dfrib", "link": "https://stackoverflow.com/users/4573247/dfrib"}, "edited": false, "score": 0, "creation_date": 1531942947, "post_id": 51409482, "comment_id": 89791116, "body": "Nice. In case the OP actually wants to interleave the <code>baz</code> values from the two vectors, could range-v3&#39;s <code>interleave_view</code> be used for this, similarly straight-forward as <code>concat</code> above?"}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1531941327, "creation_date": 1531941327, "answer_id": 51409482, "question_id": 51408503, "link": "https://stackoverflow.com/questions/51408503/c-concatenate-attributes-of-two-vectors-of-different-type-into-new-vector/51409482#51409482", "title": "C++ Concatenate attributes of two vectors of different type into new vector", "body": "<p>With <a href=\"https://github.com/ericniebler/range-v3\" rel=\"nofollow noreferrer\">range-v3</a>, it might be:</p>\n\n<pre><code>std::vector&lt;int&gt; v3 = ranges::view::concat(ranges::view::transform(v1, &amp;Foo::baz),\n                                           ranges::view::transform(v2, &amp;Bar::baz));\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/fcae686d24edf992\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}], "owner": {"reputation": 17, "user_id": 10101308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8efa528d12f1b4b2c4849926fc89e48b?s=128&d=identicon&r=PG&f=1", "display_name": "bonnoz05", "link": "https://stackoverflow.com/users/10101308/bonnoz05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1531941327, "creation_date": 1531937569, "last_edit_date": 1531939879, "question_id": 51408503, "link": "https://stackoverflow.com/questions/51408503/c-concatenate-attributes-of-two-vectors-of-different-type-into-new-vector", "title": "C++ Concatenate attributes of two vectors of different type into new vector", "body": "<p>I have two vectors as follows:</p>\n\n<pre><code>std::vector&lt;Foo&gt; v1;\nstd::vector&lt;Bar&gt; v2;\n</code></pre>\n\n<p>both <code>Foo</code> and <code>Bar</code> possess the <code>.baz</code> attribute, for example of type <code>int</code>.</p>\n\n<p>What I would like is to end up with a new vector, combining all <code>.baz</code> attributes, in order:</p>\n\n<pre><code>std::vector&lt;int&gt; v3;\n</code></pre>\n\n<p>where <code>v3.size() == v1.size() + v2.size()</code></p>\n\n<p>Is there a succinct way of achieving this?</p>\n"}, {"tags": ["c++", "label", "qwt"], "answers": [{"tags": [], "owner": {"reputation": 118, "user_id": 9426480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M5xOC.jpg?s=128&g=1", "display_name": "vcloarec", "link": "https://stackoverflow.com/users/9426480/vcloarec"}, "is_accepted": true, "score": 0, "last_activity_date": 1532025152, "last_edit_date": 1532025152, "creation_date": 1532024231, "answer_id": 51429412, "question_id": 51408429, "link": "https://stackoverflow.com/questions/51408429/qwt-align-center-the-date-time-label-text-on-an-bottom-axis/51429412#51429412", "title": "Qwt : align center the date/time label text on an bottom axis", "body": "<p>Found !!!</p>\n\n<p>Instead of override the method\nQt Code:\nSwitch view</p>\n\n<pre><code>label(double value)\n</code></pre>\n\n<p>To copy to clipboard, switch view to plain text mode \n.</p>\n\n<p>I have to override the drawLabel method of QwtDateScaleDraw :</p>\n\n<pre><code>void drawLabel( QPainter *painter, double value ) const override\n        {\n                QwtText lbl = tickLabel( painter-&gt;font(), value );\n                if ( lbl.isEmpty() )\n                    return;\n\n                lbl.setRenderFlags(Qt::AlignCenter); //&lt;---- add this line \n\n                QPointF pos = labelPosition( value );\n\n                QSizeF labelSize = lbl.textSize( painter-&gt;font() );\n\n                const QTransform transform = labelTransformation( pos, labelSize );\n\n                painter-&gt;save();\n                painter-&gt;setWorldTransform( transform, true );\n\n                lbl.draw ( painter, QRect( QPoint( 0, 0 ), labelSize.toSize() ) );\n\n                painter-&gt;restore();\n\n        }\n</code></pre>\n\n<p>To copy to clipboard, switch view to plain text mode </p>\n\n<p>And after the label is really center ! </p>\n\n<p><strong>The setRenderFlags method can not do the job !!!</strong></p>\n"}], "owner": {"reputation": 118, "user_id": 9426480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M5xOC.jpg?s=128&g=1", "display_name": "vcloarec", "link": "https://stackoverflow.com/users/9426480/vcloarec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 51429412, "answer_count": 1, "score": 0, "last_activity_date": 1532025152, "creation_date": 1531937245, "last_edit_date": 1532023532, "question_id": 51408429, "link": "https://stackoverflow.com/questions/51408429/qwt-align-center-the-date-time-label-text-on-an-bottom-axis", "title": "Qwt : align center the date/time label text on an bottom axis", "body": "<p>With Qwt, I want that the time and the date are both center under the tick under a bottom axis, but the time is still on the left side like in this picture : </p>\n\n<p><a href=\"https://i.stack.imgur.com/CVczl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CVczl.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have tried to use </p>\n\n<pre><code>QwtDateScaleDraw::setLabelAlignment(Qt::AlignHCenter|Qt::AlignBottom);\n</code></pre>\n\n<p>But the time is still on the left.</p>\n\n<p>I have tried to subclass the QwtScaleDraw like this:</p>\n\n<pre><code>class MyDateScaleDraw:public QwtDateScaleDraw\n{\npublic:\n    QwtText label(double value) const override\n    {\n        QwtText txt=QwtDateScaleDraw::label(value);\n        txt.setRenderFlags(Qt::AlignHCenter);\n        return txt;\n    }\n};\n</code></pre>\n\n<p>But the time is still on the left side.</p>\n\n<p>Somebody know how to center the time ?</p>\n\n<p><strong><em>UPDATE :</em></strong></p>\n\n<p>I have found in the source code of Qwt this:</p>\n\n<pre><code>const QwtText &amp;QwtAbstractScaleDraw::tickLabel(const QFont &amp;font, double value ) const\n{\n    QMap&lt;double, QwtText&gt;::const_iterator it = d_data-&gt;labelCache.find( value );\n    if ( it == d_data-&gt;labelCache.end() )\n    {\n        QwtText lbl = label( value );\n        lbl.setRenderFlags( 0 );\n        lbl.setLayoutAttribute( QwtText::MinimumLayout );\n\n        ( void )lbl.textSize( font ); // initialize the internal cache\n\n        it = d_data-&gt;labelCache.insert( value, lbl );\n    }\n\n    return ( *it );\n}\n</code></pre>\n\n<p>It is the method who, I guess, generate the QwtText Label.</p>\n\n<p>It seems that the line 8 set the render flags to '0'. May be it why changing the renderFlags of the label don't change the alignement of the label under the tick.</p>\n\n<p>What do you think ? </p>\n"}, {"tags": ["c++", "multithreading", "qt", "qimage", "opencv-mat"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1531937379, "post_id": 51408416, "comment_id": 89788154, "body": "Don&#39;t use <code>void setImage(QImage *img);</code>, instead use <code>void setImage(const QImage &amp; img);</code>"}, {"owner": {"reputation": 1756, "user_id": 5233188, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OS2a7.png?s=128&g=1", "display_name": "goulashsoup", "link": "https://stackoverflow.com/users/5233188/goulashsoup"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1531937466, "post_id": 51408416, "comment_id": 89788185, "body": "I will change it, problem stays... <i>I have also tried normal parameter &#39;setImage(QImage img)&#39; and reference &#39;setImage(QImage &amp;img)&#39;</i>"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1531937517, "post_id": 51408416, "comment_id": 89788203, "body": "<code>QImage &amp;img</code> is different to <code>const QImage &amp;img</code>"}, {"owner": {"reputation": 1756, "user_id": 5233188, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OS2a7.png?s=128&g=1", "display_name": "goulashsoup", "link": "https://stackoverflow.com/users/5233188/goulashsoup"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1531937619, "post_id": 51408416, "comment_id": 89788252, "body": "@eyllanesc That&#39;s right... I&#39;ll try"}, {"owner": {"reputation": 1756, "user_id": 5233188, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OS2a7.png?s=128&g=1", "display_name": "goulashsoup", "link": "https://stackoverflow.com/users/5233188/goulashsoup"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1531937825, "post_id": 51408416, "comment_id": 89788358, "body": "@eyllanesc It still crashes, so that is not the problem in this case, i&#39;ll update the question."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1531937927, "post_id": 51408416, "comment_id": 89788418, "body": "It may not be the solution, but you must correct it."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1531938048, "post_id": 51408416, "comment_id": 89788493, "body": "do the following in a thread: ui-&gt;logOutput-&gt;appendPlainText(...) is not correct, you should not update the GUI from another thread, you must use the signals to send the log."}, {"owner": {"reputation": 1756, "user_id": 5233188, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OS2a7.png?s=128&g=1", "display_name": "goulashsoup", "link": "https://stackoverflow.com/users/5233188/goulashsoup"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1531938221, "post_id": 51408416, "comment_id": 89788602, "body": "@eyllanesc Was a copy error, in the implementation it&#39;s just a return, thanks, sry"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1531938300, "post_id": 51408416, "comment_id": 89788648, "body": "Take your time and delete all the <i>copy error</i>, nobody rushes you to post a question. On the other hand, have you used a debugger to see where the problem is? :)"}, {"owner": {"reputation": 1756, "user_id": 5233188, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OS2a7.png?s=128&g=1", "display_name": "goulashsoup", "link": "https://stackoverflow.com/users/5233188/goulashsoup"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1531938692, "post_id": 51408416, "comment_id": 89788885, "body": "@eyllanesc Yes i did, The function <code>DoCameraStuff::readBinaryAndShowBinPic</code> does run till the end <code>emit showQImage(qImage);</code>, then i enter some Qt code and finally end in the Dissambler. The label opens and shows cryptic a pattern, so the image is not shown properly. Please be aware that this behavior is owed by debugging the code slowly..."}], "answers": [{"tags": [], "owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1532123750, "last_edit_date": 1532123750, "creation_date": 1531942180, "answer_id": 51409693, "question_id": 51408416, "link": "https://stackoverflow.com/questions/51408416/qt-transform-cvmat-to-qimage-in-worker-thread-crashes/51409693#51409693", "title": "Qt - Transform cv::Mat to QImage in worker thread crashes", "body": "<p>It doesn't have a chance of working, since the <code>QImage</code> wraps transient data that then is deallocated by <code>cvMat</code>. At the minimum you should emit the copy of the image (literally <code>qImage.copy()</code>. Ideally, you'd wrap the <code>cvMat</code> lifetime management in <code>QImage</code>'s deleter, so that the copy is not necessary, and the matrix gets destroyed along with the image that wraps it. Since format conversions are usually needed between <code>cv::Mat</code> and <code>QImage</code>, it's probably best to perform the conversion between the source <code>cv::Mat</code> and another <code>cv::Mat</code> that wraps the <code>QImage</code>-owned memory. That solution avoids memory reallocations, since the <code>QImage</code> can be retained in the class performing the conversion. It is then also comaptible with Qt 4, where <code>QImage</code> doesn't support deleters.</p>\n\n<p>See <a href=\"https://stackoverflow.com/a/21253353/1329652\">this answer for a complete example of an OpenCV video capture Qt-based widget viewer</a>, and <a href=\"https://stackoverflow.com/a/22872664/1329652\">this answer for a complete example of multi-format conversion from <code>cv::Mat</code> to <code>QImage</code></a>.</p>\n"}], "owner": {"reputation": 1756, "user_id": 5233188, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OS2a7.png?s=128&g=1", "display_name": "goulashsoup", "link": "https://stackoverflow.com/users/5233188/goulashsoup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 51409693, "answer_count": 1, "score": 0, "last_activity_date": 1532123750, "creation_date": 1531937181, "last_edit_date": 1592644375, "question_id": 51408416, "link": "https://stackoverflow.com/questions/51408416/qt-transform-cvmat-to-qimage-in-worker-thread-crashes", "title": "Qt - Transform cv::Mat to QImage in worker thread crashes", "body": "<h1>Introduction</h1>\n<p>What i want is really simple: I want to start the process of reading a binary file via a button in a main ui thread, let a seperate thread handle the processing including transformation into <code>QImage</code> and return this image back to the main ui thread where it should shown in a label.</p>\n<p>Therefore i use Qt's signal/slot mechanism and its thread functionality.</p>\n<p>I allready have a single thread working solution, but when using the threading attempt it crashes on totally arbitrary steps which i don't understand because the whole process is totally encapsulated and not time critical...</p>\n<hr />\n<h1>Working single-threading solution:</h1>\n<p><code>TragVisMain</code> is a <code>QMainWindow</code>:</p>\n<pre><code>class TragVisMain : public QMainWindow \n</code></pre>\n<p>Pushing the button <code>readBinSingle</code> starts the process:</p>\n<pre><code>void TragVisMain::on_readBinSingle_clicked()\n{\n    // Open binary file\n        FILE *imageBinFile = nullptr;\n        imageBinFile = fopen(&quot;imageFile.bin&quot;, &quot;rb&quot;);\n        if(imageBinFile == NULL) {\n            return;\n        }\n    \n    // Get binary file size\n        fseek(imageBinFile, 0, SEEK_END); // seek to end of file\n        size_t size = static_cast&lt;size_t&gt;(ftell(imageBinFile)); // get current file pointer\n        fseek(imageBinFile, 0, SEEK_SET);\n\n    // Read binary file\n        void *imageData = malloc(size);\n        fread(imageData, 1, size, imageBinFile);\n    \n    // Create cv::Mat\n        cv::Mat openCvImage(1024, 1280, CV_16UC1, imageData);\n        openCvImage.convertTo(openCvImage, CV_8UC1, 0.04); // Convert to 8 Bit greyscale\n\n    // Transform to QImage\n        QImage qImage(\n            openCvImage.data,\n            1280,\n            1024,\n            QImage::Format_Grayscale8\n        );\n\n    // Show image in label, 'imageLabel' is class member\n        imageLabel.setPixmap(QPixmap::fromImage(qImage));\n        imageLabel.show();\n}\n</code></pre>\n<p>This works like a charm, but of course the ui is blocked.</p>\n<hr />\n<h1>Not working multi-threading solution</h1>\n<p>As you will see the code is basically the same as above just moving to another class <code>DoCameraStuff</code>. So here is are the main components for this purpose in the <code>TragVisMain</code> header file:</p>\n<pre><code>namespace Ui {\n    class TragVisMain;\n}\n\nclass TragVisMain : public QMainWindow\n{\n        Q_OBJECT\n    public:\n        explicit TragVisMain(QWidget *parent = nullptr);\n        ~TragVisMain();\n\n    private:\n        Ui::TragVisMain *ui;\n        DoCameraStuff dcs;\n        QLabel imageLabel;\n        QThread workerThread;\n\n    public slots:\n        void setImage(const QImage &amp;img); // Called after image processing\n        // I have also tried normal parameter 'setImage(QImage img)', non-const referenc 'setImage(const QImage &amp;img)' and pointer 'setImage(QImage *img)'\n\n    private slots:\n        void on_readBin_clicked(); // Emits 'loadBinaryImage'\n        // void on_readBinSingle_clicked();\n\n    signals:\n        void loadBinaryImage(); // Starts image processing\n};\n</code></pre>\n<p><code>DoCameraStuff</code> is just a <code>QObject</code>:</p>\n<pre><code>class DoCameraStuff : public QObject\n{\n        Q_OBJECT\n    public:\n        explicit DoCameraStuff(QObject *parent = nullptr);\n\n    public slots:\n        void readBinaryAndShowBinPic();\n\n    signals:\n        void showQImage(const QImage &amp;image);\n\n};\n</code></pre>\n<p>Moving <code>dcs</code> to the <code>workerThread</code> and <code>connect</code>ing signals and slots happens in the constructor of <code>TragVisMain</code>:</p>\n<pre><code>TragVisMain::TragVisMain(QWidget *parent) :\n    QMainWindow(parent),\n    ui(new Ui::TragVisMain),\n    dcs()\n{\n    ui-&gt;setupUi(this);\n    dcs.moveToThread(&amp;workerThread);\n\n    // Object should be deletable after the thread finished!\n    connect(&amp;workerThread, &amp;QThread::finished, &amp;dcs, &amp;QObject::deleteLater);\n\n    // For starting the image processing\n    connect(this, &amp;TragVisMain::loadBinaryImage, &amp;dcs, &amp;DoCameraStuff::readBinaryAndShowBinPic);\n\n    // Showing QImage after image processing is done\n    connect(&amp;dcs, &amp;DoCameraStuff::showQImage, this, &amp;TragVisMain::setImage);\n\n    // Start workerThread\n    workerThread.start();\n}\n</code></pre>\n<p>Starting the image processing happens through pressing the <code>readBinSingle</code> button:</p>\n<pre><code>void TragVisMain::on_readBin_clicked()\n{\n    emit loadBinaryImage(); // slot: readBinaryAndShowBinPic\n}\n</code></pre>\n<p>The process happens in <code>DoCameraStuff::readBinaryAndShowBinPic</code>:</p>\n<pre><code>void DoCameraStuff::readBinaryAndShowBinPic() {\n    // Exact same code from single thread solution:\n        // Open binary file\n            FILE *imageBinFile = nullptr;\n            imageBinFile = fopen(&quot;imageFile.bin&quot;, &quot;rb&quot;);\n            if(imageBinFile == NULL) {\n                return;\n            }\n\n        // Get binary file size\n            fseek(imageBinFile, 0, SEEK_END); // seek to end of file\n            size_t size = static_cast&lt;size_t&gt;(ftell(imageBinFile)); // get current file pointer\n            fseek(imageBinFile, 0, SEEK_SET);\n\n        // Read binary file\n            void *imageData = malloc(size);\n            fread(imageData, 1, size, imageBinFile);\n\n        // Create cv::Mat\n            cv::Mat openCvImage(1024, 1280, CV_16UC1, imageData);\n            openCvImage.convertTo(openCvImage, CV_8UC1, 0.04); // Convert to 8 Bit greyscale\n\n        // Transform to QImage\n            QImage qImage(\n                openCvImage.data,\n                1280,\n                1024,\n                QImage::Format_Grayscale8\n            );\n\n    // Send qImage to 'TragVisMain'\n    emit showQImage(qImage);\n}\n</code></pre>\n<p>Showing the image in <code>TragVisMain::setImage</code>:</p>\n<pre><code>void TragVisMain::setImage(const QImage &amp;img)\n{\n    imageLabel.setPixmap(QPixmap::fromImage(img));\n    imageLabel.show();\n}\n</code></pre>\n<hr />\n<h1>Problem</h1>\n<p>Well the multi-threading attempt just crashed the whole Application without any message during different steps. But honestly i don't have any idea. For me the <code>DoCameraStuff</code> class is a <a href=\"http://doc.qt.io/qt-5/qthread.html#details\" rel=\"nofollow noreferrer\">standard worker class</a> doing time-independent stuff in a member function without any critical relations.</p>\n<p>I also checked if some of the used function inside <code>DoCameraStuff::readBinaryAndShowBinPic</code> are not thread-safe but I couldn't find any problems regarding <code>&lt;cstdio&gt;</code>, <code>cv::Mat</code> and <code>QImage</code> in equivalent conditions.</p>\n<p>So:</p>\n<ol>\n<li>Why does the multi-threading attempt crash?</li>\n<li>What changes need to be applied, so that the process in the thread does not crash?</li>\n</ol>\n<p>I allways appreciate your help.</p>\n"}, {"tags": ["c++", "templates", "static-members", "linker-warning"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1531937012, "post_id": 51408276, "comment_id": 89787958, "body": "Just put everything in the header and use a <code>inline</code> for the definiiiton: <code>inline template&lt;class T&gt; int MyTemp&lt;T&gt;::smDummyVar = 0;</code>"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1531937096, "post_id": 51408276, "comment_id": 89788013, "body": "Sorry, @\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6, that duplicate you marked just isn&#39;t, because it effectively is everything in a header file. Since the .cpp is included in the .h, that split is irrelevant."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1531937197, "post_id": 51408276, "comment_id": 89788065, "body": "@Ulrich Sorry to disagree. The case that <code>#include &quot;xxx.cpp&quot;</code> shouldn&#39;t be included at the header and why is explained there IIRC."}, {"owner": {"reputation": 61, "user_id": 8766730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbdfcffa435e515a324aa0a4dcc28c51?s=128&d=identicon&r=PG&f=1", "display_name": "astro_son", "link": "https://stackoverflow.com/users/8766730/astro-son"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1531937376, "post_id": 51408276, "comment_id": 89788150, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6  : nope, that doesn&#39;t work."}], "owner": {"reputation": 61, "user_id": 8766730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbdfcffa435e515a324aa0a4dcc28c51?s=128&d=identicon&r=PG&f=1", "display_name": "astro_son", "link": "https://stackoverflow.com/users/8766730/astro-son"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 334, "favorite_count": 1, "closed_date": 1531936926, "answer_count": 0, "score": 2, "last_activity_date": 1532363542, "creation_date": 1531936554, "last_edit_date": 1532363542, "question_id": 51408276, "link": "https://stackoverflow.com/questions/51408276/c-static-member-of-class-template-linker-warning-multiple-definition", "closed_reason": "Duplicate", "title": "C++ static member of class template -- linker warning &quot;multiple definition&quot;", "body": "<p>Let's say for some reason, I want to have a class template MyTemp with some static data member smDummyVar :</p>\n\n<p>Mytemp.h</p>\n\n<pre><code>#ifndef MY_TEMP_H\n#define MY_TEMP_H\n\ntemplate&lt;class T&gt;\nclass MyTemp{\n...\nprivate:\n   static int smDummyVar;\n   ...\n};\n\n#include \"MyTemp.cpp\"\n\n#endif //MY_TEMP_H\n</code></pre>\n\n<p>Mytemp.cpp</p>\n\n<pre><code>...\ntemplate&lt;class T&gt; int MyTemp&lt;T&gt;::smDummyVar = 0;\n...\n</code></pre>\n\n<p>Since the compiler requires that the definition and declaration of a template be at the same place, so I include MyTemp.cpp in MyTemp.h .</p>\n\n<p>Now: I want to use MyTemp at many places and create objects using the template:</p>\n\n<p>case1.cpp</p>\n\n<pre><code>#include \"MyTemp.h\"\n\nvoid dummyfunc1(){\n    MyTemp&lt;int&gt; myTemp1;\n}\n</code></pre>\n\n<p>case2.cpp</p>\n\n<pre><code>#include \"MyTemp.h\"\n\nvoid dummyfunc2(){\n    MyTemp&lt;int&gt; myTemp2;\n}\n</code></pre>\n\n<p>I won't get any error from the compiler, but I'd get warning from the linker:</p>\n\n<pre><code>\"multiple definition for MyTemp&lt;int&gt;::smDummyVar\" ... defined in invalid_group(case1.o) ... rejected in favour of symbol defined in ...(case2.o)\n</code></pre>\n\n<p>Question: how can I get rid of this warning ?</p>\n\n<p>Thanks a lot in advance for your help !</p>\n\n<p>====================================</p>\n\n<p>inspired by one of the answers in this thread <a href=\"https://stackoverflow.com/questions/495021/why-can-templates-only-be-implemented-in-the-header-file\">Why can templates only be implemented in the header file?</a>\nI found the following solution:</p>\n\n<p>i. remove <code>#include \"MyTemp.cpp\"</code> in MyTemp.h</p>\n\n<p>ii. specialized.h</p>\n\n<pre><code>#include \"MyTemp.h\"\ntypedef MyTemp&lt;int&gt; MySpecialized;\n</code></pre>\n\n<p>iii. specialized.cpp</p>\n\n<pre><code>#include \"MyTemp.cpp\"\ntemplate class MyTemp&lt;int&gt;;\n</code></pre>\n\n<p>iv. give specialized.cpp to cmake file</p>\n\n<p>v. include specilized.h in case1.cpp and case2.cpp</p>\n\n<p>the \"multiple definition\" warning issued by the linker will go away.</p>\n\n<p>Thank you guys for helping !</p>\n"}, {"tags": ["c++", "cuda"], "comments": [{"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 1, "creation_date": 1531938216, "post_id": 51408172, "comment_id": 89788598, "body": "That copy loop at the end of your setup routine is totally broken. Why are you executing hostToDevice copies between device pointers? (and magically taking the host address of those pointers to fix the runtime errors only means you are copying random garbage from the host stack). If you can&#39;t keep track of what is a host pointer and what is a device pointer, you would be better off using managed memory as you originally asked about."}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1531939077, "post_id": 51408172, "comment_id": 89789094, "body": "In fact, the whole cudaGraphMalloc is full of that same mistake"}, {"owner": {"reputation": 32458, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1531940029, "post_id": 51408172, "comment_id": 89789650, "body": "@talonmies ah, I was so focused in the pointers that my mind slipped. Simple mistake, no need to be rude.  If I understand correctly, you are suggesting to change the  flag to <code>cudaMemcpyDeviceToDevice</code> when I am copying from device pointers to device pointers, which of course, makes sense. However I get &quot;invalid input&quot; error when I do that (on line <code>gpuErrchk(cudaMemcpy(&amp;outGraph-&gt;boundary, &amp;d_auxboundary, sizeof(unsigned int *), cudaMemcpyDeviceToDevice));</code>) thus it does not fix whatever is wrong with the code"}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1531940468, "post_id": 51408172, "comment_id": 89789895, "body": "There is no rudeness in that comment -- it is a constructive suggestion if you are focussed on writing code which actually works in the simplest possible way. But in what you quote <code>&amp;d_auxboundary</code> is wrong. It should just be <code>d_auxboundary</code>. Like I said, if you are finding this hard, use managed memory, that is what it was created for."}, {"owner": {"reputation": 32458, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1531940758, "post_id": 51408172, "comment_id": 89790041, "body": "@talonmies thanks, sorry for misunderstanding. I need to do this for structures that are generated on CPU, so managed memory seems not to be the thing for me. Regardless, I am trying to learn better CUDA, so this is a good way, I rather make it work in here. I&#39;ll check your suggestions to see if I can fix it"}, {"owner": {"reputation": 32458, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1531941484, "post_id": 51408172, "comment_id": 89790401, "body": "@talonmies sorry to bother, but I still get the same behavior, with your spotted mistakes."}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1531943236, "post_id": 51408172, "comment_id": 89791252, "body": "The last copy is hosing everything because it is copying the wrong size.  It should only copy <code>sizeof(Node *)</code>."}, {"owner": {"reputation": 32458, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1531945280, "post_id": 51408172, "comment_id": 89792228, "body": "@talonmies ah, true, thanks for spotting that too. That indeed solves the problem I described in the post. However I dont seem to be able to access any of the node variables in the kernel such as <code>graph-&gt;node[0].position[0]</code> without &quot;illegal memory access&quot;,"}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1531952072, "post_id": 51408172, "comment_id": 89795063, "body": "Well, you didn&#39;t copy it, so surely that isn&#39;t a surpise?"}, {"owner": {"reputation": 32458, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1531956386, "post_id": 51408172, "comment_id": 89796198, "body": "@talonmies that said, why does <code>gpuErrchk(cudaMemcpy(d_position[i], h_position[i], 3 * sizeof(float), cudaMemcpyHostToDevice));</code> not copy them?"}], "answers": [{"comments": [{"owner": {"reputation": 32458, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1531993668, "post_id": 51412103, "comment_id": 89809717, "body": "If I dont understand wrongly, <code>auxNodeHost.position</code> and <code>outGraph-&gt;node[0].position</code> (lets assume <code>nNode==1</code>) is the same memory address. Why do I need to store <code>temp</code> or <code>auxNodeHost</code> to <code>cudaFree</code>? Can I not <code>cudaFree</code> the members of <code>outGraph</code>?"}, {"owner": {"reputation": 15243, "user_id": 1231073, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/lSwuI.jpg?s=128&g=1", "display_name": "sgarizvi", "link": "https://stackoverflow.com/users/1231073/sgarizvi"}, "reply_to_user": {"reputation": 32458, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1531994475, "post_id": 51412103, "comment_id": 89810323, "body": "@AnderBiguri... Yes, that is correct if <code>nNode==1</code>. Both point to the same memory address on the device. You need <code>temp</code> and <code>auxNodeHost</code> for <code>cudaFree</code> because you cannot dereference a device variable from the host. It means that doing <code>cudaFree(outGraph-&gt;boundary);</code> is illegal. The proper way will be <code>cudaFree(temp.boundary);</code>."}, {"owner": {"reputation": 32458, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1531995245, "post_id": 51412103, "comment_id": 89810849, "body": "Ahh I see. Its the <code>outGraph-&gt;boundary</code> that is illegal, not the freeing. Thanks! This mistake was the biggest cause of my misconception."}], "tags": [], "owner": {"reputation": 15243, "user_id": 1231073, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/lSwuI.jpg?s=128&g=1", "display_name": "sgarizvi", "link": "https://stackoverflow.com/users/1231073/sgarizvi"}, "is_accepted": true, "score": 2, "last_activity_date": 1532003495, "last_edit_date": 1532003495, "creation_date": 1531954804, "answer_id": 51412103, "question_id": 51408172, "link": "https://stackoverflow.com/questions/51408172/variable-gets-lost-after-allocating-array-of-structs-in-cuda/51412103#51412103", "title": "Variable gets lost after allocating array of structs in cuda", "body": "<p>The problem is in the function <code>cudaGraphMalloc</code> where you are trying to allocate device memory to the members of <code>outGraph</code> which has already been allocated on the device. In process of doing so, you are de-referencing a device pointer on host which is illegal.</p>\n\n<p>To allocate device memory to members of <code>struct</code> type variable which exists on the device, we first have to create a temporary host variable of that <code>struct</code> type, then allocate device memory to its members, and then copy it to the struct which exists on the device.</p>\n\n<p>I have answered a similar question <a href=\"https://stackoverflow.com/a/31135377/1231073\">here</a>. Please take a look at it.</p>\n\n<p>The fixed code may look like this:</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;cuda_runtime.h&gt;\n#include &lt;cuda.h&gt;\n\n// A point, part of some elements\nstruct Node {\n\n    float* position;\n\n};\n\nstruct Graph {\n    unsigned int nNode;\n    Node* node;\n    unsigned int nBoundary;\n    unsigned int* boundary;\n};\nGraph* cudaGraphMalloc(const Graph* inGraph);\n#define gpuErrchk(ans) { gpuAssert((ans), __FILE__, __LINE__); }\ninline void gpuAssert(cudaError_t code, const char *file, int line, bool abort = true)\n{\n    if (code != cudaSuccess)\n    {\n        fprintf(stderr, \"GPUassert: %s %s %d\\n\", cudaGetErrorString(code), file, line);\n        if (abort) exit(code);\n    }\n}\n\n__global__ void testKernel(Graph* graph, unsigned int * d_res) {\n    d_res[0] = graph-&gt;nBoundary;\n\n};\nint main()\n{\n\n    // Generate some fake data on the CPU\n    Graph graph;\n    graph.node = (Node*)malloc(2 * sizeof(Node));\n    graph.boundary = (unsigned int*)malloc(3 * sizeof(unsigned int));\n    for (int i = 0; i &lt; 3; i++) {\n        graph.boundary[i] = i + 10;\n    }\n    graph.nBoundary = 3;\n    graph.nNode = 2;\n    for (int i = 0; i &lt; 2; i++) {\n        // They can have different sizes in the original code\n        graph.node[i].position = (float*)malloc(3 * sizeof(float));\n        graph.node[i].position[0] = 45;\n        graph.node[i].position[1] = 1;\n        graph.node[i].position[2] = 2;\n    }\n\n    // allocate GPU memory\n    Graph * d_graph = cudaGraphMalloc(&amp;graph);\n    // some dummy variables to test on GPU.\n    unsigned int * d_res, *h_res;\n    cudaMalloc((void **)&amp;d_res, sizeof(unsigned int));\n    h_res = (unsigned int*)malloc(sizeof(unsigned int));\n\n    //Run kernel\n    testKernel &lt;&lt; &lt;1, 1 &gt;&gt; &gt;(d_graph, d_res);\n    gpuErrchk(cudaPeekAtLastError());\n    gpuErrchk(cudaMemcpy(h_res, d_res, sizeof(unsigned int), cudaMemcpyDeviceToHost));\n\n    printf(\"%u\\n\", graph.nBoundary);\n    printf(\"%u\\n\", h_res[0]);\n\n    return 0;\n}\n\nGraph* cudaGraphMalloc(const Graph* inGraph) \n{\n    //Create auxiliary Graph variable on host\n    Graph temp;\n\n    //copy constants\n    temp.nNode = inGraph-&gt;nNode;\n    temp.nBoundary = inGraph-&gt;nBoundary;\n\n    // copy boundary\n    gpuErrchk(cudaMalloc((void**)&amp;(temp.boundary), inGraph-&gt;nBoundary * sizeof(unsigned int)));\n    gpuErrchk(cudaMemcpy(temp.boundary, inGraph-&gt;boundary, inGraph-&gt;nBoundary * sizeof(unsigned int), cudaMemcpyHostToDevice));\n\n\n    //Create nodes \n    size_t nodeBytesTotal = temp.nNode * sizeof(Node);\n    gpuErrchk(cudaMalloc((void**)&amp;(temp.node), nodeBytesTotal));\n\n    for (int i = 0; i &lt; temp.nNode; i++)\n    {\n        //Create auxiliary node on host\n        Node auxNodeHost;\n\n        //Allocate device memory to position member of auxillary node\n        size_t nodeBytes = 3 * sizeof(float);\n        gpuErrchk(cudaMalloc((void**)&amp;(auxNodeHost.position), nodeBytes));\n        gpuErrchk(cudaMemcpy(auxNodeHost.position, inGraph-&gt;node[i].position, nodeBytes, cudaMemcpyHostToDevice));\n\n        //Copy auxillary host node to device\n        Node* dPtr = temp.node + i;\n        gpuErrchk(cudaMemcpy(dPtr, &amp;auxNodeHost, sizeof(Node), cudaMemcpyHostToDevice));\n    }\n\n\n    Graph* outGraph;\n    gpuErrchk(cudaMalloc((void**)&amp;outGraph, sizeof(Graph)));\n    gpuErrchk(cudaMemcpy(outGraph, &amp;temp, sizeof(Graph), cudaMemcpyHostToDevice));\n\n    return outGraph;\n}\n</code></pre>\n\n<p><strong>Be advised</strong> that you will have to keep the host copies of internal device pointers (i.e. the auxiliary host variables). This is because you will have to free the device memory later and since you will only have a device copy of <code>Graph</code> in the main code, you won't be able to access its members from the host to call <code>cudaFree</code> on them. In this case the variable <code>Node auxNodeHost</code> (created in each iteration) and <code>Graph temp</code> are those variables.</p>\n\n<p>The above code does not do that and is just for demonstration purpose.</p>\n\n<p>Tested on Windows 10, Visual Studio 2015, CUDA 9.2, NVIDIA Driver 397.44.</p>\n"}], "owner": {"reputation": 32458, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 1, "accepted_answer_id": 51412103, "answer_count": 1, "score": 1, "last_activity_date": 1532003495, "creation_date": 1531936143, "last_edit_date": 1531984820, "question_id": 51408172, "link": "https://stackoverflow.com/questions/51408172/variable-gets-lost-after-allocating-array-of-structs-in-cuda", "title": "Variable gets lost after allocating array of structs in cuda", "body": "<p>I have a structure with arrays of structures inside in C, and I need a copy of that in the GPU. For that I am writing a function that makes some <code>cudaMalloc</code> and <code>cudaMemcpy</code>s of the variables in the struct from host to device. </p>\n\n<p>A simple version (the real one has various structs and variables/arrays inside) of the struct is:</p>\n\n<pre><code>struct Node {\n\n    float* position;\n\n};\n\nstruct Graph{\n    unsigned int nNode;\n    Node* node;\n    unsigned int nBoundary;\n    unsigned int* boundary;\n};\n</code></pre>\n\n<p>My problem is that I must be doing something wrong in the memory allocation and copy of the struct. When I copy the variables withing <code>Graph</code>, I can see that they are properly copied (by accessing it in a kernel as in the example below). For example, I can check that <code>graph.nBoundary=3</code>. </p>\n\n<p>However, I can only see this if I do not allocate and copy the memory of <code>Node *</code>. If I do, I get <code>-858993460</code> instead of <code>3</code>. Interestingly, <code>Node *</code> is not wrongly allocated, as I can inspect the value of say <code>graph.node[0].pos[0]</code> and it has the correct value. </p>\n\n<p>This only happens with the <code>graph.nBoundary</code>. All the other variables remain with the correct numerical values, but this one gets \"wronged\" when running the <code>cudaMemcpy</code> of the <code>Node*</code>.</p>\n\n<p><strong>What am I doing wrong and why does this happen? How do I fix it?</strong> </p>\n\n<p>Let me know if you need more information.</p>\n\n<hr>\n\n<p>MCVE:</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;cuda_runtime_api.h&gt;\n#include &lt;cuda.h&gt;\n\n// A point, part of some elements\nstruct Node {\n\n    float* position;\n\n};\n\nstruct Graph{\n    unsigned int nNode;\n    Node* node;\n    unsigned int nBoundary;\n    unsigned int* boundary;\n};\nGraph* cudaGraphMalloc(const Graph* inGraph);\n#define gpuErrchk(ans) { gpuAssert((ans), __FILE__, __LINE__); }\ninline void gpuAssert(cudaError_t code, const char *file, int line, bool abort = true)\n{\n    if (code != cudaSuccess)\n    {\n        fprintf(stderr, \"GPUassert: %s %s %d\\n\", cudaGetErrorString(code), file, line);\n        if (abort) exit(code);\n    }\n}\n\n__global__ void testKernel(Graph* graph,unsigned int * d_res){\n    d_res[0] = graph-&gt;nBoundary;\n\n};\nint main()\n{\n\n    // Generate some fake data on the CPU\n    Graph graph;\n    graph.node = (Node*)malloc(2 * sizeof(Node));\n    graph.boundary = (unsigned int*)malloc(3 * sizeof(unsigned int));\n    for (int i = 0; i &lt; 3; i++){\n        graph.boundary[i] = i + 10;\n    }\n    graph.nBoundary = 3;\n    graph.nNode = 2;\n    for (int i = 0; i &lt; 2; i++){\n        // They can have different sizes in the original code\n        graph.node[i].position = (float*)malloc(3 * sizeof(float));\n        graph.node[i].position[0] = 45;\n        graph.node[i].position[1] = 1;\n        graph.node[i].position[2] = 2;\n    }\n\n    // allocate GPU memory\n    Graph * d_graph = cudaGraphMalloc(&amp;graph);\n    // some dummy variables to test on GPU.\n    unsigned int * d_res, *h_res;\n    cudaMalloc((void **)&amp;d_res, sizeof(unsigned int));\n    h_res = (unsigned int*)malloc(sizeof(unsigned int));\n\n    //Run kernel\n    testKernel &lt;&lt; &lt;1, 1 &gt;&gt; &gt;(d_graph, d_res);\n    gpuErrchk(cudaPeekAtLastError());\n    gpuErrchk(cudaMemcpy(h_res, d_res, sizeof(unsigned int), cudaMemcpyDeviceToHost));\n\n    printf(\"%u\\n\", graph.nBoundary);\n    printf(\"%d\", h_res[0]);\n\n    return 0;\n}\n\nGraph* cudaGraphMalloc(const Graph* inGraph){\n    Graph* outGraph;\n    gpuErrchk(cudaMalloc((void**)&amp;outGraph, sizeof(Graph)));\n\n    //copy constants\n    gpuErrchk(cudaMemcpy(&amp;outGraph-&gt;nNode, &amp;inGraph-&gt;nNode, sizeof(unsigned int), cudaMemcpyHostToDevice));\n    gpuErrchk(cudaMemcpy(&amp;outGraph-&gt;nBoundary, &amp;inGraph-&gt;nBoundary, sizeof(unsigned int), cudaMemcpyHostToDevice));\n\n\n    // copy boundary\n    unsigned int * d_auxboundary, *h_auxboundary;\n    h_auxboundary = inGraph-&gt;boundary;\n    gpuErrchk(cudaMalloc((void**)&amp;d_auxboundary, inGraph-&gt;nBoundary*sizeof(unsigned int)));\n    gpuErrchk(cudaMemcpy(d_auxboundary, h_auxboundary, inGraph-&gt;nBoundary*sizeof(unsigned int), cudaMemcpyHostToDevice));\n    gpuErrchk(cudaMemcpy(&amp;outGraph-&gt;boundary, d_auxboundary, sizeof(unsigned int *), cudaMemcpyDeviceToDevice));\n\n\n    //Create nodes \n    Node * auxnode;\n    gpuErrchk(cudaMalloc((void**)&amp;auxnode, inGraph-&gt;nNode*sizeof(Node)));\n\n    // Crate auxiliary pointers to grab them from host and pass them to device\n    float ** d_position, ** h_position;\n    d_position = static_cast&lt;float **&gt;(malloc(inGraph-&gt;nNode*sizeof(float*)));\n    h_position = static_cast&lt;float **&gt;(malloc(inGraph-&gt;nNode*sizeof(float*)));\n\n    for (int i = 0; i &lt; inGraph-&gt;nNode; i++){\n\n        // Positions\n        h_position[i] = inGraph-&gt;node[i].position;\n        gpuErrchk(cudaMalloc((void**)&amp;d_position[i], 3 * sizeof(float)));\n        gpuErrchk(cudaMemcpy(d_position[i], h_position[i], 3 * sizeof(float), cudaMemcpyHostToDevice));\n        gpuErrchk(cudaMemcpy(&amp;auxnode[i].position, d_position[i], sizeof(float *), cudaMemcpyDeviceToDevice));\n\n    }\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////// If I comment the following section, nBoundary can be read by the kernel\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n    gpuErrchk(cudaMemcpy(&amp;outGraph-&gt;node, auxnode, inGraph-&gt;nNode*sizeof(Node *), cudaMemcpyDeviceToDevice));\n\n\n\n    return outGraph;\n}\n</code></pre>\n"}, {"tags": ["c++", "unit-testing", "c++11", "googlemock"], "comments": [{"owner": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "edited": false, "score": 0, "creation_date": 1531937069, "post_id": 51408164, "comment_id": 89787994, "body": "Could you show us how you&#39;ve set it up so far? To me, <code>template &lt;class boost::asio::ip::udp::socket&gt;</code> seems like you&#39;re defining a template parameter as part of a function definition (in which case you&#39;d define a generic class name instead of <code>boost::asio::ip::udp::socket</code>). If you&#39;re trying to pass in a template parameter according to the Google Mock documentation, I&#39;d expect to see something like <code>TestFunction&lt;boost::asio::ip::udp::socket&gt;()</code> instead."}, {"owner": {"reputation": 1556, "user_id": 611716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/f4i2e.jpg?s=128&g=1", "display_name": "Frecklefoot", "link": "https://stackoverflow.com/users/611716/frecklefoot"}, "reply_to_user": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "edited": false, "score": 0, "creation_date": 1531941793, "post_id": 51408164, "comment_id": 89790546, "body": "Okay, added. If I understand correctly, I only need to templatize it if I need a way to use the concrete class in production code and my mock class in tests? I don&#39;t think this will be a problem, since I only instantiate the concrete class in the constructor when a socket isn&#39;t passed in, which the production code already does. I&#39;ll always pass in a mock in tests."}], "answers": [{"comments": [{"owner": {"reputation": 1556, "user_id": 611716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/f4i2e.jpg?s=128&g=1", "display_name": "Frecklefoot", "link": "https://stackoverflow.com/users/611716/frecklefoot"}, "edited": false, "score": 0, "creation_date": 1531951215, "post_id": 51410969, "comment_id": 89794750, "body": "These are great suggestions, thanks! I&#39;ll give them a shot."}, {"owner": {"reputation": 1556, "user_id": 611716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/f4i2e.jpg?s=128&g=1", "display_name": "Frecklefoot", "link": "https://stackoverflow.com/users/611716/frecklefoot"}, "edited": false, "score": 1, "creation_date": 1532013726, "post_id": 51410969, "comment_id": 89823837, "body": "I tried this, but like a hydra, I cut off one head, and two more appear. Now gcc says that I can&#39;t have a template type as member data. It&#39;s okay; I&#39;m going to write a Boost Socket wrapper that has virtual functions that are direct pass-thrus to an actual Boost Socket. My mock object will inherit from the wrapper, and mock its virtual functions."}, {"owner": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "reply_to_user": {"reputation": 1556, "user_id": 611716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/f4i2e.jpg?s=128&g=1", "display_name": "Frecklefoot", "link": "https://stackoverflow.com/users/611716/frecklefoot"}, "edited": false, "score": 1, "creation_date": 1532014309, "post_id": 51410969, "comment_id": 89824302, "body": "Not a bad idea; that&#39;s a good approach to handle 3rd party classes."}], "tags": [], "owner": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "is_accepted": false, "score": 2, "last_activity_date": 1531947902, "creation_date": 1531947902, "answer_id": 51410969, "question_id": 51408164, "link": "https://stackoverflow.com/questions/51408164/googlemock-mocking-non-virtual-functions/51410969#51410969", "title": "GoogleMock mocking non-virtual functions", "body": "<p>The issue, as you've noticed, is that the compiler cannot deduce whatever type <code>Socket</code> is meant to represent here:</p>\n\n<pre><code>class PIngester : public IPIngester{\npublic:\n    template &lt;class Socket&gt;\n    PIngester(boost::asio::io_service&amp; ioService, Band band,\n              std::unique_ptr&lt;Socket&gt; socket = std::unique_ptr&lt;Socket&gt;(nullptr));\n    ...\n</code></pre>\n\n<p>If you try to construct an object of this class without specifying the third argument (as in <code>new PIngester(ioService, band)</code>), what would <code>Socket</code> be exactly?</p>\n\n<p>Now, there's no way to explicitly specify any template parameter when calling the constructor, so you can't do something like <code>new PIngester&lt;boost::asio::ip::udp::socket&gt;(ioService, band)</code> if the constructor is templatized.</p>\n\n<hr>\n\n<p>Here are a couple ways (out of potentially many) to work around this:</p>\n\n<ol>\n<li><p>You could templatize the <code>PIngester</code> class itself:</p>\n\n<pre><code>template &lt;class Socket&gt;\nclass PIngester : public IPIngester{\npublic:\n    PIngester(boost::asio::io_service&amp; ioService, Band band,\n              std::unique_ptr&lt;Socket&gt; socket = std::unique_ptr&lt;Socket&gt;(nullptr));\n    ...\n</code></pre>\n\n<p>Then calling <code>new PIngester&lt;boost::asio::ip::udp::socket&gt;(ioService, band)</code> (or your mock class in place of <code>boost::asio::ip::udp::socket</code>) would work.</p></li>\n<li><p>You could define a default template parameter:</p>\n\n<pre><code>class PIngester : public IPIngester{\npublic:\n    template &lt;class Socket = boost::asio::ip::udp::socket&gt;\n    PIngester(boost::asio::io_service&amp; ioService, Band band,\n              std::unique_ptr&lt;Socket&gt; socket = std::unique_ptr&lt;Socket&gt;(nullptr));\n    ...\n</code></pre>\n\n<p>Then <code>PIngester(ioService, band)</code> would always use this default Boost class, and you'd need to explicitly pass in some <code>socket</code> that represents a unique pointer to your mock class if you want to use this in tests.</p></li>\n</ol>\n"}], "owner": {"reputation": 1556, "user_id": 611716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/f4i2e.jpg?s=128&g=1", "display_name": "Frecklefoot", "link": "https://stackoverflow.com/users/611716/frecklefoot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 577, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1612197239, "creation_date": 1531936115, "last_edit_date": 1612197239, "question_id": 51408164, "link": "https://stackoverflow.com/questions/51408164/googlemock-mocking-non-virtual-functions", "title": "GoogleMock mocking non-virtual functions", "body": "<p>We're writing unit tests for an existing code base. We're using Google Test/Google Mock for the tests, C++11 and Eclipse CDT with the gcc compiler.</p>\n<p>One of our classes aggregates a Boost Socket. It used it as an instance, but luckily we can modify the existing code base, and I changed it to a pointer and injected the socket as a dependency. So I went about mocking the calls to the socket, but there's a problem: the Boost functions are non-virtual.</p>\n<p>I found documentation showing how to mock non-virtual functions using <em><a href=\"https://github.com/google/googletest/blob/master/docs/gmock_cook_book.md#mocking-non-virtual-methods-mockingnonvirtualmethods\" rel=\"nofollow noreferrer\">hi-perf dependency injection</a></em>. Trying to implement it as shown, though, has been unsuccessful. For example, the doc says to &quot;templatize your code&quot;. So for our class that uses the boost socket, I followed their example. I inserted:</p>\n<pre><code>template &lt;class boost::asio::ip::udp::socket&gt;\n</code></pre>\n<p>That is supposed to let us insert our mock class instead of the concrete Boost class. I tried it before the class and separately just before the constructor that accepts the socket, in the header and the implementation file. In each place, I just get tons of errors, most of which are along the lines of &quot;no matching function call for &quot; the constructor call.</p>\n<p>Clearly, I'm doing something wrong. Does anyone know of a complete example somewhere?</p>\n<p><strong>Update:</strong>\nPer request, here is what we currently have:</p>\n<p>GoogleMock mocking non-virtual functions</p>\n<pre><code>class PIngester : public IPIngester{\npublic:\n    // this is the method that takes the socket. It is the constructor, and the socket\n    // is a default parameter so the existing code will still work. We added the socket \n    // as a parameter specifically for unit testing. If no socket is provided, the \n    // constructor creates one. It only will ever create a concrete Boost\n    // Socket, not a mock one.\n    PIngester(boost::asio::io_service&amp; ioService, Band band,\n              std::unique_ptr&lt;boost::asio::ip::udp::socket&gt; socket = std::unique_ptr&lt;boost::asio::ip::udp::socket&gt;(nullptr));\n    ...\n</code></pre>\n<p><strong>Update 2</strong></p>\n<p>I defined a generic class type for the template, but that breaks the existing code. Here is my current version:</p>\n<pre><code>class PIngester : public IPIngester{\npublic:\n    template &lt;class Socket&gt;\n    PIngester(boost::asio::io_service&amp; ioService, Band band,\n              std::unique_ptr&lt;Socket&gt; socket = std::unique_ptr&lt;Socket&gt;(nullptr));\n    ...\n</code></pre>\n<p>I think it might be barfing on the default parameter, but I can't be sure. The error messages aren't very helpful:</p>\n<pre><code> error: no matching function for call to \u2018foonamespace::PIngester::PIngester(boost::asio::io_service&amp;, foonamespace::Band&amp;)\u2019                                     \n          new PIngester(ioService, band));\n</code></pre>\n<p>This error message is from existing code; it doesn't seem to recognize the default parameter.</p>\n<p><strong>Update 3</strong></p>\n<p>I've abandoned this approach and decided to write a Boost Socket Wrapper instead. The wrapper will hold the actual Socket instance, and its methods will be direct pass-throughs to the actual Socket. The wrapper's functions will be virtual, and my mock object will inherit from the wrapper. Then my mock object will mock the wrapper's virtual functions.</p>\n"}, {"tags": ["java", "c++", "java-native-interface", "g++", "mingw"], "comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1531943295, "post_id": 51408117, "comment_id": 89791282, "body": "The symbols in your DLL appear to have STDCALL name decorations (the <code>@N</code> part). Have you tried adding <code>-Wl,--kill-at</code> when compiling?"}], "answers": [{"tags": [], "owner": {"reputation": 324, "user_id": 5085934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe63e6fa414645d698a8a8916d48ab83?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Schroijen", "link": "https://stackoverflow.com/users/5085934/joshua-schroijen"}, "is_accepted": false, "score": 3, "last_activity_date": 1531946018, "creation_date": 1531946018, "answer_id": 51410556, "question_id": 51408117, "link": "https://stackoverflow.com/questions/51408117/cant-get-simplest-jni-eample-to-run-on-windows-10/51410556#51410556", "title": "Can&#39;t get simplest JNI eample to run on Windows 10", "body": "<p>OK, I solved my issue. The issue was the way I built my DLL.</p>\n\n<p>First, you should pass the option <strong>kill-at</strong> to the MinGW linker (ld). When you don't pass this option, your symbols will still get mangled in a subtle way despite the <em>extern \"C\"</em> declaration: at the end of the function name the compiler will append <strong>@&lt;number of bytes the function's parameters take up&gt;</strong>. This looks like a minor detail, but you <strong>DON'T</strong> want this. Java ( or at least the standard Oracle JVM ) <strong>DOES NOT</strong> expect this suffix!</p>\n\n<p>Secondly, g++ actually allows you to define <strong>_JNI_IMPLEMENTATION</strong>. This built-in identifier will signal to the compiler that the shared library it's going to build is meant to be used for the JNI and to configure itself accordingly.</p>\n\n<p>So, finally, to compile the DLL property you <strong>DON'T</strong> have to change anything to the original javah-generated header file. Just execute this command:</p>\n\n<blockquote>\n  <p>g++ -I\"C:\\Program Files (x86)\\Java\\jdk1.8.0_172\\include\" -I\"C:\\Program Files (x86)\\Java\\jdk1.8.0_172\\include\\win32\" -D_JNI_IMPLEMENTATION -Wl,--kill-at --shared -o Sample132.dll Sample1.cpp</p>\n</blockquote>\n\n<p>( Of course, change the include paths to the include paths of your Java SDK installation )</p>\n\n<p><a href=\"http://www.mingw.org/wiki/JNI_MinGW_DLL\" rel=\"nofollow noreferrer\">This page</a> contains lots of interesting information about building JNI compatible DLL's with MinGW</p>\n\n<p>I hope this will also help someone in the future. Thanks a lot for your help, Alerra! :)</p>\n"}], "owner": {"reputation": 324, "user_id": 5085934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe63e6fa414645d698a8a8916d48ab83?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Schroijen", "link": "https://stackoverflow.com/users/5085934/joshua-schroijen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 517, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1531946018, "creation_date": 1531935940, "last_edit_date": 1531939692, "question_id": 51408117, "link": "https://stackoverflow.com/questions/51408117/cant-get-simplest-jni-eample-to-run-on-windows-10", "title": "Can&#39;t get simplest JNI eample to run on Windows 10", "body": "<p>For a project I'm doing I will soon have to use the Java Native interface. I tried to get started with it by reading <a href=\"https://www.ibm.com/developerworks/java/tutorials/j-jni/j-jni.html\" rel=\"nofollow noreferrer\">this tutorial</a> on it over on the IBM DeveloperWorks site.</p>\n\n<p>Basically, it told me to write this class:</p>\n\n<pre><code>public class Sample1 {\n  public native int intMethod( int n );\n  public native boolean booleanMethod( boolean bool );\n  public native String stringMethod( String text );\n  public native int intArrayMethod( int[] intArray );\n\n  public static void main( String[] args ){\n    try{\n      System.loadLibrary( \"Sample132\" );\n    } catch( UnsatisfiedLinkError e ){\n        System.out.println( \"Linking failed with message\\n\" + e.getMessage() );\n    }\n\n    Sample1 sample = new Sample1();\n    int square = 0, sum = 0;\n    boolean bool = false;\n    String text = \"\";\n\n    try{\n      square = sample.intMethod( 5 );\n      bool   = sample.booleanMethod( true );\n      text   = sample.stringMethod( \"JAVA\" );\n      sum    = \n        sample.intArrayMethod(\n          new int[]{ 1, 1, 2, 3, 5, 8, 13 } );\n    } catch( UnsatisfiedLinkError e ){\n      System.out.println( \"Calling native method failed with\\n\" + e.getMessage() );\n      System.exit( 1 );\n    }\n\n    System.out.println( \"intMethod: \" + square );\n    System.out.println( \"booleanMethod: \" + bool );\n    System.out.println( \"stringMethod: \" + text );\n    System.out.println( \"intArrayMethod: \" + sum );\n  }\n}\n</code></pre>\n\n<p>This class just contains some simple native methods. In its main method, it tries to load the DLL containing the implementations of these. I generated the appropriate header file (Sample1.h) for the class with javah. My C++ file containing the implementation looks as follows:</p>\n\n<pre><code>#include \"Sample1.h\"\n\n#include &lt;string.h&gt;\n\nextern \"C\" {\nJNIEXPORT jint JNICALL Java_Sample1_intMethod\n  ( JNIEnv * env, \n    jobject obj, \n    jint num ){\n      return( num * num );\n    }\n\nJNIEXPORT jboolean JNICALL Java_Sample1_booleanMethod\n  ( JNIEnv * env, \n    jobject obj, \n    jboolean boolean ){\n    return( ! boolean );\n  }\n\nJNIEXPORT jstring JNICALL Java_Sample1_stringMethod\n  ( JNIEnv * env, \n    jobject obj,\n    jstring string ){\n    const char * str = env-&gt;GetStringUTFChars( string, 0 );\n    char cap[ 128 ];\n    strcpy( cap, str );\n    env-&gt;ReleaseStringUTFChars( string, 0 );\n    return( env-&gt;NewStringUTF( strupr( cap ) ) );\n  }\n\nJNIEXPORT jint JNICALL Java_Sample1_intArrayMethod\n  ( JNIEnv * env,\n    jobject obj,\n    jintArray array ){\n    int i, sum = 0;\n    jsize len = env-&gt;GetArrayLength( array );\n    jint * body = env-&gt;GetIntArrayElements( array, 0 );\n    for( i=0; i &lt; len; i++ ){\n      sum += body[ i ];\n    }\n    env-&gt;ReleaseIntArrayElements(array, body, 0);\n    return( sum );\n  }\n}\n</code></pre>\n\n<p>The problem I have now is that as soon as the Sample1 class' main method hits the call to the native intMethod on its instance, it crashes with a UnsatisfiedLinkError runtime exception. Now, the DLL is just residing in the same directory as the class and I have verified that the main function actually loads the library successfully: it doesn't throw an UnsatisfiedLinkError exception in the System.loadLibrary() call. But for completeness sake, I was wondering whether the way I compile the DLL with MinGW's G++ has anything to do with the call failing:</p>\n\n<p>g++ -I\"C:\\Program Files (x86)\\Java\\jdk1.8.0_172\\include\" -I\"C:\\Program Files (x86)\\Java\\jdk1.8.0_172\\include\\win32\" -fPIC --shared -m32 -o Sample132.dll Sample1.cpp</p>\n\n<p>I should also note that I'm running the class in the 32-bit JVM and it's a 32 bit DLL!</p>\n\n<p>Finally, with MS VS's dumpbin tool, I got this output:</p>\n\n<pre><code>Dump of file Sample132.dll\n\nFile Type: DLL\n\n  Section contains the following exports for Sample132.dll\n\n    00000000 characteristics\n    5B4F79B4 time date stamp Wed Jul 18 19:32:36 2018\n        0.00 version\n           1 ordinal base\n           4 number of functions\n           4 number of names\n\n    ordinal hint RVA      name\n\n          1    0 000012DE Java_Sample1_booleanMethod@12\n          2    1 00001368 Java_Sample1_intArrayMethod@12\n          3    2 000012D0 Java_Sample1_intMethod@12\n          4    3 000012F5 Java_Sample1_stringMethod@12\n\n  Summary\n\n        1000 .CRT\n        1000 .bss\n        1000 .data\n        1000 .debug_abbrev\n        1000 .debug_aranges\n        2000 .debug_info\n        1000 .debug_line\n        1000 .edata\n        1000 .eh_frame\n        1000 .idata\n        1000 .rdata\n        1000 .reloc\n        1000 .text\n        1000 .tls\n</code></pre>\n\n<p>So it doesn't seem like the symbols were mangled and thus the JVM wouldn't be able to find the correct symbols inside the loaded DLL.</p>\n\n<p>Is there anyone who knows why my program fails with a UnsatisfieLinkError when it calls the native methods? Some help would be greatly appreciated!</p>\n\n<p>Thanks in advance,\nJoshua</p>\n\n<p><strong>EDIT:</strong> this is the C++ file that still won't compile</p>\n\n<pre><code>#include \"Sample1.h\"\n\n#include &lt;string.h&gt;\n\nJNIEXPORT jint JNICALL Java_Sample1_intMethod\n  ( JNIEnv * env, \n    jobject obj, \n    jint num ){\n      return( num * num );\n    }\n\nJNIEXPORT jboolean JNICALL Java_Sample1_booleanMethod\n  ( JNIEnv * env, \n    jobject obj, \n    jboolean boolean ){\n    return( ! boolean );\n  }\n\nJNIEXPORT jstring JNICALL Java_Sample1_stringMethod\n  ( JNIEnv * env, \n    jobject obj,\n    jstring string ){\n    const char * str = env-&gt;GetStringUTFChars( string, 0 );\n    char cap[ 128 ];\n    strcpy( cap, str );\n    env-&gt;ReleaseStringUTFChars( string, 0 );\n    return( env-&gt;NewStringUTF( strupr( cap ) ) );\n  }\n\nJNIEXPORT jint JNICALL Java_Sample1_intArrayMethod\n  ( JNIEnv * env,\n    jobject obj,\n    jintArray array ){\n    int i, sum = 0;\n    jsize len = env-&gt;GetArrayLength( array );\n    jint * body = env-&gt;GetIntArrayElements( array, 0 );\n    for( i=0; i &lt; len; i++ ){\n      sum += body[ i ];\n    }\n    env-&gt;ReleaseIntArrayElements(array, body, 0);\n    return( sum );\n  }\n\nvoid main(){}\n</code></pre>\n"}, {"tags": ["c++", "sdl", "bazel", "imgui"], "comments": [{"owner": {"reputation": 3270, "user_id": 7778502, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/LjybV.png?s=128&g=1", "display_name": "L&#225;szl&#243;", "link": "https://stackoverflow.com/users/7778502/l%c3%a1szl%c3%b3"}, "edited": false, "score": 0, "creation_date": 1532086828, "post_id": 51408079, "comment_id": 89853200, "body": "Using the external repo is the right direction. What exactly have you tried with <code>-isystem</code>? I thought adding it to the <code>cc_library</code> in the <code>build_file_contents</code> should suffice, is that not the case? Have you tried <code>cc_library.includes</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 31438, "user_id": 908939, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/etRsI.jpg?s=128&g=1", "display_name": "Trevor Hickey", "link": "https://stackoverflow.com/users/908939/trevor-hickey"}, "is_accepted": false, "score": 0, "last_activity_date": 1591023784, "creation_date": 1591023784, "answer_id": 62135106, "question_id": 51408079, "link": "https://stackoverflow.com/questions/51408079/how-do-i-reference-a-system-library-used-by-an-external-dependency-if-copts-does/62135106#62135106", "title": "How do I reference a system library used by an external dependency if copts doesn&#39;t allow system paths?", "body": "<p>As L\u00e1szl\u00f3 stated, you can set the <code>includes</code> to the current directory which will allow it to be detected as a system header when used as a dependency in other code: </p>\n\n<pre><code>cc_library(\n    ... \n    includes = [\n        \".\",\n    ],\n)\n</code></pre>\n"}], "owner": {"reputation": 31438, "user_id": 908939, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/etRsI.jpg?s=128&g=1", "display_name": "Trevor Hickey", "link": "https://stackoverflow.com/users/908939/trevor-hickey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1081, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1591023784, "creation_date": 1531935815, "question_id": 51408079, "link": "https://stackoverflow.com/questions/51408079/how-do-i-reference-a-system-library-used-by-an-external-dependency-if-copts-does", "title": "How do I reference a system library used by an external dependency if copts doesn&#39;t allow system paths?", "body": "<p>For Bazel, I'm pulling in an external library from within my <code>WORKSPACE</code>:  </p>\n\n<pre><code>new_http_archive(\n      name = \"imgui\",\n      build_file = \"deps/BUILD.imgui\",\n      sha256 = \"c457fdc19b4e3aa74deccf6a2d9bc51f0d470b3acd9cc095bf04df16459d6474\",\n      strip_prefix = 'imgui-1.62',\n      url = \"https://github.com/ocornut/imgui/archive/v1.62.tar.gz\",\n)\n</code></pre>\n\n<p>Inside <code>BUILD.imgui</code>, I'm attempting to build it:  </p>\n\n<pre><code>cc_library(\n name = \"imgui_sdl_opengl3\",\n linkopts = [\"-ldl\", \"-lGL\", \"-L/usr/lib/x86_64-linux-gnu\", \"-lSDL2\", \"-lSDL\"],\n copts = [\"-Iexamples/\", \"-D_REENTRANT\",],\n includes = [\".\",\"examples/libs/gl3w\"],\n hdrs = [\n     \"examples/imgui_impl_opengl3.h\",\n     \"examples/libs/gl3w/GL/gl3w.h\",\n     \"examples/imgui_impl_sdl.h\",\n     \"examples/libs/gl3w/GL/glcorearb.h\",\n ],\n srcs = [\n     \"examples/imgui_impl_opengl3.cpp\",\n     \"examples/imgui_impl_sdl.cpp\",\n     \"examples/libs/gl3w/GL/gl3w.c\",\n ],\n)\n</code></pre>\n\n<p>The problem is that it can't find <code>#include &lt;SDL.h&gt;</code>.<br>\nI tried adding it to copts:  </p>\n\n<pre><code> copts = [\"-Iexamples/\", \"-D_REENTRANT\", \"-I/usr/include/SDL\"],\n</code></pre>\n\n<p>But the error is:  </p>\n\n<pre><code>The include path '/usr/include/SDL' references a path outside of the execution root.\n</code></pre>\n\n<p>Ok. Same if I try to add it to the <code>includes</code> argument of <code>cc_library</code>.</p>\n\n<p>I tried this other trick I saw where you make the headers visible through another repo within Bazel editing the <code>WORKSPACE</code> as followed:  </p>\n\n<pre><code>new_local_repository(\n    name = \"SDL\",\n    path = \"/usr/include/SDL\",\n    build_file_content = \"\"\"\npackage(\n    default_visibility = [\n        \"//visibility:public\",\n    ],\n)\n\ncc_library(\n    name = \"headers\",\n    srcs = glob([\"**/*.h\"]),\n)\n\"\"\",\n</code></pre>\n\n<p>The problem is, if I reference that repo as a deps to the external library I'm trying to build, I get the following error:  </p>\n\n<pre><code>external/imgui/examples/imgui_impl_sdl.cpp:38:10: error: 'SDL.h' file not found with &lt;angled&gt; include; use \"quotes\" instead\n#include &lt;SDL.h&gt;\n         ^~~~~~~\n         \"SDL.h\"\n</code></pre>\n\n<p>Of course I can't change the header to that, because its not my header.  It comes from the external library I pulled down.  </p>\n\n<p>What do I do?<br>\nI don't understand why I can't add system paths to copts (probably hermetic reasons).  I don't know how to include paths and have them  accessible as system headers.  I tried different things with <code>-isystem</code> as as well, but saw the same errors.</p>\n"}, {"tags": ["c++", "qt", "events"], "comments": [{"owner": {"reputation": 88, "user_id": 4577193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96b6c3d3d45b37747eb6c32da18d1632?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/4577193/zac"}, "edited": false, "score": 0, "creation_date": 1531938656, "post_id": 51407921, "comment_id": 89788862, "body": "this post: <a href=\"https://stackoverflow.com/questions/36016069/how-to-prevent-member-qwidgets-or-qdialog-objects-taking-over-key-events-from-qm\" title=\"how to prevent member qwidgets or qdialog objects taking over key events from qm\">stackoverflow.com/questions/36016069/&hellip;</a> presents a similar problem where the solution involves redirecting events but it doesn&#39;t actually describe how to do that."}, {"owner": {"reputation": 88, "user_id": 4577193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96b6c3d3d45b37747eb6c32da18d1632?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/4577193/zac"}, "edited": false, "score": 0, "creation_date": 1531938738, "post_id": 51407921, "comment_id": 89788910, "body": "this post: <a href=\"https://stackoverflow.com/questions/5563862/how-to-pass-click-event-to-sibling-underneath-in-qt\" title=\"how to pass click event to sibling underneath in qt\">stackoverflow.com/questions/5563862/&hellip;</a> also presents a similar problem but the solution is to build custom methods or recreate a new system event while making yourself transparent and I have to believe there is a better way"}], "answers": [{"comments": [{"owner": {"reputation": 88, "user_id": 4577193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96b6c3d3d45b37747eb6c32da18d1632?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/4577193/zac"}, "edited": false, "score": 0, "creation_date": 1531939987, "post_id": 51408746, "comment_id": 89789623, "body": "Thank you for your answer.  It wasn&#39;t quite <code>setAcceptDrops(true)</code> but there was a reason the child wasn&#39;t seeing the event first.  I&#39;ve answered below."}], "tags": [], "owner": {"reputation": 1350, "user_id": 1698678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c3dcda949d1adcc6db14345586b2b9?s=128&d=identicon&r=PG", "display_name": "PlinyTheElder", "link": "https://stackoverflow.com/users/1698678/plinytheelder"}, "is_accepted": false, "score": 1, "last_activity_date": 1531938508, "creation_date": 1531938508, "answer_id": 51408746, "question_id": 51407921, "link": "https://stackoverflow.com/questions/51407921/how-do-i-pass-qevents-to-child-widgets/51408746#51408746", "title": "How do I pass QEvents to child widgets?", "body": "<p>Intersting! I think that accepting the event in the parent widget, and then trying to forward it to the child widget, is not the right approach architecturally. It would basically violate encapsulation (objects handling their own events).</p>\n\n<p>If I were you, I would investigate why the child widget isn't seeing the event first. Children widgets are on top of their parents, so your child widget should have a first go at the event. Did you call <code>setAcceptDrops(true)</code>?</p>\n\n<p>When you fix that, in the child widget event handler you can analyze the event and call <code>event-&gt;ignore()</code> if the event should be forwarded to the parent QTabWidget. If you don't call <code>ignore()</code>, the child will \"consume\" the event and it will not be propagated to the parent!</p>\n\n<p>Here's an old blog post on event propagation that could help:</p>\n\n<p><a href=\"http://blog.qt.io/blog/2006/05/27/mouse-event-propagation/\" rel=\"nofollow noreferrer\">http://blog.qt.io/blog/2006/05/27/mouse-event-propagation/</a></p>\n"}, {"tags": [], "owner": {"reputation": 88, "user_id": 4577193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96b6c3d3d45b37747eb6c32da18d1632?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/4577193/zac"}, "is_accepted": true, "score": 1, "last_activity_date": 1531940175, "creation_date": 1531940175, "answer_id": 51409194, "question_id": 51407921, "link": "https://stackoverflow.com/questions/51407921/how-do-i-pass-qevents-to-child-widgets/51409194#51409194", "title": "How do I pass QEvents to child widgets?", "body": "<p>Solving my own problem:\nAs Pliny stated the child should see the event first.  My problem appears to have been that in <code>EditorWidget</code> I had not implemented <code>dragEnterEvent</code> and <code>dragMoveEvent</code> so even though I had implemented <code>dropEvent</code> in <code>EditorWidget</code> the <code>TabWidget</code> took control of the drag and therefore stole the drop.  </p>\n"}], "owner": {"reputation": 88, "user_id": 4577193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96b6c3d3d45b37747eb6c32da18d1632?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/4577193/zac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 51409194, "answer_count": 2, "score": 3, "last_activity_date": 1531940175, "creation_date": 1531935121, "last_edit_date": 1592644375, "question_id": 51407921, "link": "https://stackoverflow.com/questions/51407921/how-do-i-pass-qevents-to-child-widgets", "title": "How do I pass QEvents to child widgets?", "body": "<h3>Here's the situation:</h3>\n<p>I have a custom widget subclassed from <code>QTabWidget</code> that I've implemented to accept <code>QDropEvents</code> for files.  When files are dropped on the <code>TabWidget</code> they are opened for editing.  This part works fine.  However, I want to implement drag and drop functionality as part of the editor (think like a LabView-esque GUI).  I have properly implemented the event handlers and <code>acceptsDrops</code> on the <code>EditorWidget</code> but the <code>TabWidget</code> receives all the events and attempts to process them as files.  I can differentiate file-related events from the editor's events by mimedata but I can't figure out how to pass the event from the <code>TabWidget</code>on to the appropriate <code>EditorWidget</code>.</p>\n<h3>So the question:</h3>\n<p>How can I pass a QDropEvent from the widget which received it from the system to another widget which it owns?  Alternatively, how do I tell the system which widget should receive the event, based on the contents of said event?</p>\n<h3>What I've tried:</h3>\n<p>I can't call the <code>dropEvent</code> method of the child as it's protected.  I could create a series of my own methods that pass the events around but that seems redundant and fragile.  I've looked into installing an EventFilter, but from what I can tell that only discards events, it doesn't say &quot;not me try someone else.&quot;</p>\n<p>Thanks in advance for your assistance!</p>\n"}, {"tags": ["c++", "templates", "c++14", "sfinae", "enable-if"], "answers": [{"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 2, "last_activity_date": 1531934961, "creation_date": 1531934961, "answer_id": 51407874, "question_id": 51407809, "link": "https://stackoverflow.com/questions/51407809/sfinae-based-overloads-conflict/51407874#51407874", "title": "SFINAE-based overloads conflict", "body": "<blockquote>\n  <p>But I am wondering is there more idiomatic way to handle such conflicting overloads? </p>\n</blockquote>\n\n<p>By example</p>\n\n<pre><code>template &lt;class T, std::enable_if_t&lt;std::is_same&lt;T, A&gt;{}&gt; * = nullptr&gt;\nvoid foo(T t) {}\n\ntemplate &lt;class T, std::enable_if_t&lt;!std::is_same&lt;T, A&gt;{}&gt; * = nullptr&gt;\nvoid foo(T t) {}\n</code></pre>\n\n<p>But I find more clearer in this way</p>\n\n<pre><code>template &lt;class T&gt;\nstd::enable_if_t&lt;std::is_same&lt;T, A&gt;{}&gt; foo(T t) {}\n\ntemplate &lt;class T&gt;\nstd::enable_if_t&lt;!std::is_same&lt;T, A&gt;{}&gt; foo(T t) {}\n</code></pre>\n\n<p>You can also add a second, defaulted, parameter.</p>\n\n<pre><code>template &lt;class T&gt;\nvoid foo(T t, std::enable_if_t&lt;std::is_same&lt;T, A&gt;{}&gt; * = nullptr) {}\n\ntemplate &lt;class T&gt;\nvoid foo(T t, std::enable_if_t&lt;!std::is_same&lt;T, A&gt;{}&gt; * = nullptr) {}\n</code></pre>\n"}], "owner": {"reputation": 1470, "user_id": 1072878, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/15e4a648de45b3005f2f5b891f4e6242?s=128&d=identicon&r=PG", "display_name": "eXXXXXXXXXXX2", "link": "https://stackoverflow.com/users/1072878/exxxxxxxxxxx2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "closed_date": 1531935758, "accepted_answer_id": 51407874, "answer_count": 1, "score": 1, "last_activity_date": 1531938494, "creation_date": 1531934751, "last_edit_date": 1531938494, "question_id": 51407809, "link": "https://stackoverflow.com/questions/51407809/sfinae-based-overloads-conflict", "closed_reason": "Duplicate", "title": "SFINAE-based overloads conflict", "body": "<pre><code>#include &lt;type_traits&gt;\n\nstruct A {};\n\ntemplate &lt;class T, class = std::enable_if_t&lt;std::is_same_v&lt;T, A&gt;&gt;&gt;\nvoid foo(T t) {}\n\ntemplate &lt;class T, class = std::enable_if_t&lt;!std::is_same_v&lt;T, A&gt;&gt;&gt;\nvoid foo(T t) {}\n\nint main()\n{\n    foo(A{});\n    foo(0);\n    return 0;\n}\n</code></pre>\n\n<p>I see a compilation error for the second definition of <code>foo()</code>:</p>\n\n<p><code>test.cpp:9:6: error: redefinition of \u2018template&lt;class T, class&gt; void foo(T)\u2019</code></p>\n\n<p>Looks like this is because SFINAE resolution happens on the later stages.</p>\n\n<p>As a workaround I can add one more template parameter to the second <code>foo()</code> by changing it to:</p>\n\n<p><code>template &lt;class T, class = std::enable_if_t&lt;!std::is_same_v&lt;T, A&gt;&gt;, class = void&gt;\nvoid foo(T t) {}\n</code></p>\n\n<p>Then the error gone. But I am wondering is there more idiomatic way to handle such conflicting overloads? For two overloads it is enough to add one extra dummy template parameter but if we have many such overloads then the code would become more cluttered and the purpose of those extra parameters is unclear from the first glance to a reader.</p>\n"}, {"tags": ["c++", "c", "cmake", "grpc", "c-ares"], "comments": [{"owner": {"reputation": 31, "user_id": 1499058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1bfbd18c317be0d087fe2c6b4dbef0?s=128&d=identicon&r=PG", "display_name": "CyA", "link": "https://stackoverflow.com/users/1499058/cya"}, "edited": false, "score": 0, "creation_date": 1539348191, "post_id": 51407735, "comment_id": 92481104, "body": "This has been making me miserable for a while now. :-( Anyone able to help me on this?"}, {"owner": {"reputation": 123, "user_id": 5323364, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cf9c3f7f70bd3463e9c836eb38186dac?s=128&d=identicon&r=PG&f=1", "display_name": "Happy", "link": "https://stackoverflow.com/users/5323364/happy"}, "edited": false, "score": 0, "creation_date": 1545300488, "post_id": 51407735, "comment_id": 94580237, "body": "Have you been able to resolve this issue? I probably met the same issue, but I can&#39;t resolve it either."}, {"owner": {"reputation": 31, "user_id": 1499058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1bfbd18c317be0d087fe2c6b4dbef0?s=128&d=identicon&r=PG", "display_name": "CyA", "link": "https://stackoverflow.com/users/1499058/cya"}, "reply_to_user": {"reputation": 123, "user_id": 5323364, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cf9c3f7f70bd3463e9c836eb38186dac?s=128&d=identicon&r=PG&f=1", "display_name": "Happy", "link": "https://stackoverflow.com/users/5323364/happy"}, "edited": false, "score": 0, "creation_date": 1550347474, "post_id": 51407735, "comment_id": 96238129, "body": "Hi, not yet. I wasn&#39;t able resolve that yet.. :-("}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 1499058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1bfbd18c317be0d087fe2c6b4dbef0?s=128&d=identicon&r=PG", "display_name": "CyA", "link": "https://stackoverflow.com/users/1499058/cya"}, "edited": false, "score": 0, "creation_date": 1559426899, "post_id": 56386791, "comment_id": 99418634, "body": "Thanks so much for sharing this. seem like my problem is gone now. I took the same approach as you to limit the impact"}], "tags": [], "owner": {"reputation": 3035, "user_id": 131129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d8f2b3e2651182fea52c8bfd4d06cd?s=128&d=identicon&r=PG", "display_name": "opello", "link": "https://stackoverflow.com/users/131129/opello"}, "is_accepted": false, "score": 1, "last_activity_date": 1559258080, "creation_date": 1559258080, "answer_id": 56386791, "question_id": 51407735, "link": "https://stackoverflow.com/questions/51407735/bitbake-grpc-cross-compile-configure-failing-with-error-c-arescares-references/56386791#56386791", "title": "bitbake grpc cross compile/configure failing with error c-ares::cares references the file /usr/lib/libcares.so.2.2.0", "body": "<p>I came across this issue today when building a newer gRPC in an older (daisy) BitBake environment.  The solutions I came to were either backporting <a href=\"https://git.openembedded.org/openembedded-core/commit/meta/classes/cmake.bbclass?id=c03b32bd71dbe04f2f239556fea0b53215e403d7\" rel=\"nofollow noreferrer\">this upstream change to the cmake.bbclass</a> or hacking in the updated variable definitions in a .bbappend to the cmake invocation by way of the <code>EXTRA_OECMAKE</code> variable.</p>\n\n<p>I chose the latter, as I only seemed to need this for c-ares, and wanted to limit my impact.  I did not end up digging into the difference between how c-ares and other gRPC dependencies (e.g. gflags) generate CMake export targets files.  I assume there's some way the ultimate target paths are generated within the respective projects' CMakeLists.txt files.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>diff --git a/meta/classes/cmake.bbclass b/meta/classes/cmake.bbclass\nindex b18152a8ed..5203d8aca1 100644\n--- a/meta/classes/cmake.bbclass\n+++ b/meta/classes/cmake.bbclass\n@@ -108,15 +108,15 @@ cmake_do_configure() {\n      ${OECMAKE_SITEFILE} \\\n      ${OECMAKE_SOURCEPATH} \\\n      -DCMAKE_INSTALL_PREFIX:PATH=${prefix} \\\n-     -DCMAKE_INSTALL_BINDIR:PATH=${bindir} \\\n-     -DCMAKE_INSTALL_SBINDIR:PATH=${sbindir} \\\n-     -DCMAKE_INSTALL_LIBEXECDIR:PATH=${libexecdir} \\\n+     -DCMAKE_INSTALL_BINDIR:PATH=${@os.path.relpath(d.getVar('bindir', True), d.getVar('prefix', True))} \\\n+     -DCMAKE_INSTALL_SBINDIR:PATH=${@os.path.relpath(d.getVar('sbindir', True), d.getVar('prefix', True))} \\\n+     -DCMAKE_INSTALL_LIBEXECDIR:PATH=${@os.path.relpath(d.getVar('libexecdir', True), d.getVar('prefix', True))} \\\n      -DCMAKE_INSTALL_SYSCONFDIR:PATH=${sysconfdir} \\\n-     -DCMAKE_INSTALL_SHAREDSTATEDIR:PATH=${sharedstatedir} \\\n+     -DCMAKE_INSTALL_SHAREDSTATEDIR:PATH=${@os.path.relpath(d.getVar('sharedstatedir', True), d.  getVar('prefix', True))} \\\n      -DCMAKE_INSTALL_LOCALSTATEDIR:PATH=${localstatedir} \\\n-     -DCMAKE_INSTALL_LIBDIR:PATH=${libdir} \\\n-     -DCMAKE_INSTALL_INCLUDEDIR:PATH=${includedir} \\\n-     -DCMAKE_INSTALL_DATAROOTDIR:PATH=${datadir} \\\n+     -DCMAKE_INSTALL_LIBDIR:PATH=${@os.path.relpath(d.getVar('libdir', True), d.getVar('prefix', True))} \\\n+     -DCMAKE_INSTALL_INCLUDEDIR:PATH=${@os.path.relpath(d.getVar('includedir', True), d.getVar('prefix', True))} \\\n+     -DCMAKE_INSTALL_DATAROOTDIR:PATH=${@os.path.relpath(d.getVar('datadir', True), d.getVar('prefix', True))} \\\n      -DCMAKE_INSTALL_SO_NO_EXE=0 \\\n      -DCMAKE_TOOLCHAIN_FILE=${WORKDIR}/toolchain.cmake \\\n      -DCMAKE_VERBOSE_MAKEFILE=1 \\\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 1499058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1bfbd18c317be0d087fe2c6b4dbef0?s=128&d=identicon&r=PG", "display_name": "CyA", "link": "https://stackoverflow.com/users/1499058/cya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1559258080, "creation_date": 1531934482, "last_edit_date": 1538664567, "question_id": 51407735, "link": "https://stackoverflow.com/questions/51407735/bitbake-grpc-cross-compile-configure-failing-with-error-c-arescares-references", "title": "bitbake grpc cross compile/configure failing with error c-ares::cares references the file /usr/lib/libcares.so.2.2.0", "body": "<p>I am having issues with finding c-ares dependencies when building grpc in open-embedded.Error in the log when looking for the dependency c-ares during configure is shown in the log as -</p>\n\n<p>--</p>\n\n<pre><code>Found ZLIB: ....../poky/build/tmp-glibc/sysroots/arm7/usr/lib/libz.so (found version \"1.2.8\")\nCMake Error at ....../poky/build/tmp-glibc/sysroots/arm7/usr/lib/cmake/c-ares/c-ares-targets.cmake:70 (message):\n   The imported target \"c-ares::cares\" references the file\n      \"/usr/lib/libcares.so.2.2.0\"\n\nbut this file does not exist.  Possible reasons include:\n\n   * The file was deleted, renamed, or moved to another location.\n\n   * An install or uninstall procedure did not complete successfully.\n\n   * The installation package was faulty and contained\n\n    \"/home/...../poky/build/tmp-glibc/sysroots/arm7/usr/lib/cmake/c-ares/c-ares-targets.cmake\"\n   but not all the files it references.\n</code></pre>\n\n<p>--</p>\n\n<p>Issue seem to be how cmake has configured the import prefix for c-ares,which is configured as below in  file - poky/build/tmp-glibc/sysroots/arm7/usr/lib/cmake/c-ares/c-ares-targets.cmake. I believe it should be the path into the target staging directory</p>\n\n<p>set(_IMPORT_PREFIX \"/usr\")</p>\n\n<p>Can someone please help me identify the issue here? what needs to be configured in the c-ares recipe in order to get the  _IMPORT_PREFIX right??\nAny help is much appreciated.\nThanks</p>\n"}, {"tags": ["c++", "arrays", "for-loop", "if-statement"], "comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 6, "creation_date": 1531933312, "post_id": 51407392, "comment_id": 89786053, "body": "Write a function to encapsulate that comparison."}, {"owner": {"reputation": 89, "user_id": 4363773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6128b9c4cb655ececaa96afed72e6091?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Lindstr&#246;m", "link": "https://stackoverflow.com/users/4363773/jens-lindstr%c3%b6m"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1531933752, "post_id": 51407392, "comment_id": 89786306, "body": "I&#39;m sorry if I&#39;m annoying to you but I am quite new to c++ and programming in general but could you give an example cause I don&#39;t understand what you mean"}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 2, "creation_date": 1531934026, "post_id": 51407392, "comment_id": 89786457, "body": "@JensLindstr&#246;m you don&#39;t understand what a function is?"}, {"owner": {"reputation": 89, "user_id": 4363773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6128b9c4cb655ececaa96afed72e6091?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Lindstr&#246;m", "link": "https://stackoverflow.com/users/4363773/jens-lindstr%c3%b6m"}, "reply_to_user": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1531934862, "post_id": 51407392, "comment_id": 89786843, "body": "@bolov no I just did not understand what meant by encapsulation the comparison"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1531935164, "post_id": 51407392, "comment_id": 89786998, "body": "Looks like you are writing a parser, probably better use a special tool or lib for that. Like <code>std::regex</code> or <code>bison</code> or <code>boost::spirit</code> etc"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1531940923, "post_id": 51407392, "comment_id": 89790141, "body": "<code>bool is_valid_char(char ch) { return isdigit(ch) || ch == &#39;+&#39; || ch == &#39;-&#39; || ch == &#39;*&#39; || ch == &#39;&#47;&#39; || ch == &#39; &#39;; }</code> And with that, the <code>if</code> statement becomes much simpler: <code>if (!is_valid_char(input[x]) return false;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 60, "user_id": 10049760, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GgZk_oOWXfY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p2qcbfGdcIiM7hn6WH9PKWFzwU9w/mo/photo.jpg?sz=128", "display_name": "lordseanington", "link": "https://stackoverflow.com/users/10049760/lordseanington"}, "is_accepted": false, "score": 0, "last_activity_date": 1531935342, "last_edit_date": 1531935342, "creation_date": 1531934258, "answer_id": 51407672, "question_id": 51407392, "link": "https://stackoverflow.com/questions/51407392/what-is-a-more-elegant-way-of-dealing-with-multiple-ors-in-an-if-statment/51407672#51407672", "title": "What is a more elegant way of dealing with multiple or&#39;s in an if statment", "body": "<p>Id suggest creating a function that checks if it is one of the values you want and have it return a boolean value \nSomething like</p>\n\n<pre><code>bool Contains(char in)\n{\n     return in=='+' || in =='-' || in == '*' || in == '/' || in== ' ';\n}\n</code></pre>\n\n<p>Although there are better ways to do this such as passing an array of charecters to check against instead of doing it hard coded.</p>\n"}, {"comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1531944017, "post_id": 51407710, "comment_id": 89791624, "body": "Emphasis at <b><i>oldschool</i></b> &#39;ole chum ;-)"}], "tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": true, "score": 1, "last_activity_date": 1531934406, "creation_date": 1531934406, "answer_id": 51407710, "question_id": 51407392, "link": "https://stackoverflow.com/questions/51407392/what-is-a-more-elegant-way-of-dealing-with-multiple-ors-in-an-if-statment/51407710#51407710", "title": "What is a more elegant way of dealing with multiple or&#39;s in an if statment", "body": "<p>The oldschool solution is to use <a href=\"https://en.cppreference.com/w/cpp/string/byte/strchr\" rel=\"nofollow noreferrer\"><code>std::strchr</code></a>:</p>\n\n<pre><code>if (isdigit(input[x]) || std::strchr(\"+-*/ \", input[x]))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": false, "score": 2, "last_activity_date": 1531936595, "creation_date": 1531936595, "answer_id": 51408285, "question_id": 51407392, "link": "https://stackoverflow.com/questions/51407392/what-is-a-more-elegant-way-of-dealing-with-multiple-ors-in-an-if-statment/51408285#51408285", "title": "What is a more elegant way of dealing with multiple or&#39;s in an if statment", "body": "<p>Since c++14 the most idiomatic way to do that is probably to use a <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/operator%22%22s\" rel=\"nofollow noreferrer\"><code>std::string</code> literal</a> and the <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/find\" rel=\"nofollow noreferrer\"><code>std::string::find()</code></a> function:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n#include &lt;string&gt;\n#include &lt;cctype&gt;\n\nusing namespace std::literals::string_literals;\n\nint main()\n{\n    std::string input = \"Hello world5!\"s;\n\n    for(auto c : input) {\n        std::cout &lt;&lt; std::boolalpha \n                  &lt;&lt; (std::isdigit(c) || \"+-*/ \"s.find(c) != std::string::npos) \n                  &lt;&lt; '\\n';\n    }      \n}\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n<pre><code>false\nfalse\nfalse\nfalse\nfalse\ntrue\nfalse\nfalse\nfalse\nfalse\nfalse\ntrue\nfalse\n</code></pre>\n</blockquote>\n\n<p>See a working <a href=\"http://coliru.stacked-crooked.com/a/b68742dbe02b10e2\" rel=\"nofollow noreferrer\">example</a>.</p>\n"}], "owner": {"reputation": 89, "user_id": 4363773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6128b9c4cb655ececaa96afed72e6091?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Lindstr&#246;m", "link": "https://stackoverflow.com/users/4363773/jens-lindstr%c3%b6m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 1, "accepted_answer_id": 51407710, "answer_count": 3, "score": 1, "last_activity_date": 1531985115, "creation_date": 1531933219, "last_edit_date": 1531934622, "question_id": 51407392, "link": "https://stackoverflow.com/questions/51407392/what-is-a-more-elegant-way-of-dealing-with-multiple-ors-in-an-if-statment", "title": "What is a more elegant way of dealing with multiple or&#39;s in an if statment", "body": "<p>I have this code to check every char in a char array if it satisfies a set number of properties:\n * Is a number\n * or is a (+, -, *, /) </p>\n\n<pre><code>bool chkArray(char input[]) {\n    for (auto x = 0; x &lt; strlen(input); x++) {\n        if (isdigit(input[x]) || input[x] == '+' || input[x] == '-' || input[x] == '*' || input[x] == '/' || input[x] == ' ') {\n            continue;\n        }\n        else {\n            return false;\n        }\n    }\n    return true;\n}\n</code></pre>\n\n<p>I feel like there is a more elegant way of dealing with the multiple or's that check for the (+, -, *, /). Something like this:</p>\n\n<pre><code>bool chkArray(char input[]) {\n    for (auto x = 0; x &lt; strlen(input); x++) {\n        if (isdigit(input[x]) || input[x] == '+', '-', '*', '/', ' ') {\n            continue;\n        }\n        else {\n            return false;\n        }\n    }\n    return true;\n}\n</code></pre>\n\n<p>So I am now wondering if anybody has an alternative to the original code to make it more elegant ?</p>\n"}, {"tags": ["python", "c++", "gtk", "wxpython", "wxwidgets"], "comments": [{"owner": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1531937493, "post_id": 51407295, "comment_id": 89788196, "body": "you can recompile with GTK+3. Or you can install wxPython for GTK+2 (either manually or from the repo). Or you can select GTK+2 as a main library using pkg-config. Up to you...."}, {"owner": {"reputation": 2463, "user_id": 596273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecfd95ed7c25b54d6ca64d500cfb73e6?s=128&d=identicon&r=PG", "display_name": "Seth", "link": "https://stackoverflow.com/users/596273/seth"}, "reply_to_user": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1531938178, "post_id": 51407295, "comment_id": 89788568, "body": "Thanks for the suggestions!  Unfortunately, wxPython for GTK+2 is not available under Ubuntu 18.04. I can compile my own but makes it hard to distribute.  Porting to GTK3 is in the works but is a long-term project."}], "owner": {"reputation": 2463, "user_id": 596273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecfd95ed7c25b54d6ca64d500cfb73e6?s=128&d=identicon&r=PG", "display_name": "Seth", "link": "https://stackoverflow.com/users/596273/seth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531936008, "creation_date": 1531932867, "last_edit_date": 1531936008, "question_id": 51407295, "link": "https://stackoverflow.com/questions/51407295/how-can-i-prevent-a-specific-shared-library-from-loading", "title": "How can I prevent a specific shared library from loading?", "body": "<p>I'm writing a (C++) program that utilizes wxWidgets and GTK2 under Linux.  I also have some basic Python scripting using the Python C-API (<a href=\"https://docs.python.org/2/c-api/veryhigh.html\" rel=\"nofollow noreferrer\">https://docs.python.org/2/c-api/veryhigh.html</a>).</p>\n\n<p>I'm running into a problem where <code>PyRun_SimpleString(\"import wx\\n\");</code> segfaults when running under Ubuntu 18.04 but runs fine under Ubuntu 16.04.  The issue appears to be that Ubuntu 18.04 does not package <code>wxpython-gtk2</code>.  It only provides <code>wxpython-gtk3</code>.  </p>\n\n<p>Using strace, I find that the python api imports wx, which in turn loads <code>wxpython</code>, pulling in GTK3 and shadowing all of the GTK2 function calls.</p>\n\n<p><strong>Question:</strong> Any ideas for how I can prevent GTK3 from being loaded as a dependency for my program?</p>\n\n<p>Long-term, I'm moving to GTK3 and phoenix but that's a ways off...</p>\n"}, {"tags": ["c++", "templates", "initialization"], "comments": [{"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1531932594, "post_id": 51407118, "comment_id": 89785648, "body": "<a href=\"http://coliru.stacked-crooked.com/a/169879aab97b4357\" rel=\"nofollow noreferrer\">clang gives 42</a> (and VS2015 gives 0)"}, {"owner": {"reputation": 38390, "user_id": 923854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OecRr.png?s=128&g=1", "display_name": "Casey", "link": "https://stackoverflow.com/users/923854/casey"}, "edited": false, "score": 4, "creation_date": 1531932729, "post_id": 51407118, "comment_id": 89785720, "body": "<a href=\"http://eel.is/c++draft/basic.start.dynamic#1\" rel=\"nofollow noreferrer\">eel.is/c++draft/basic.start.dynamic#1</a>"}, {"owner": {"reputation": 36538, "user_id": 471164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/45d4a7ba0fb8e789356f5da87536444d?s=128&d=identicon&r=PG", "display_name": "vitaut", "link": "https://stackoverflow.com/users/471164/vitaut"}, "edited": false, "score": 0, "creation_date": 1531933844, "post_id": 51407118, "comment_id": 89786353, "body": "I wonder if there is any trick to force the desired initialization here."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1531935811, "post_id": 51407118, "comment_id": 89787334, "body": "&quot;Why is dynamic initialization for global run before the one for S&lt;T&gt;::I&gt; and not in the order of their definitions&quot; because <code>template &lt;typename T&gt;int S&lt;T&gt;::I = f();</code> is not a definition, it is defined when you instantiate it, when you call <code>g&lt;int&gt;()</code> and that&#39;s after <code>global</code> defined"}], "answers": [{"tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": false, "score": 1, "last_activity_date": 1531935866, "creation_date": 1531935866, "answer_id": 51408095, "question_id": 51407118, "link": "https://stackoverflow.com/questions/51407118/why-is-static-member-of-a-template-initialized-after-an-object-defined-later-in/51408095#51408095", "title": "Why is static member of a template initialized after an object defined later in the same translation unit?", "body": "<p>Since the <a href=\"http://eel.is/c++draft/basic.start.dynamic#1\" rel=\"nofollow noreferrer\">initialization of <code>S&lt;T&gt;::I</code> is unordered</a>, the value for <code>S&lt;int&gt;::I</code> can be either 0 (if it is initialized after <code>global</code>) or 42 (if initialized before <code>global</code>).</p>\n\n<p>While you can't force the compiler to initialize <code>I</code> before <code>global</code>, with a slight change in your code you can employ the same method used to order static variables defined in different translation units.  By changing <code>I</code> to a function that stores its value in an internal static variable, you can ensure that it is initialized before <code>global</code>.</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct S {\n  static int I() {\n    static int i = f();\n    return i;\n  }\n};\n\ntemplate &lt;typename T&gt;\nint g() {\n  return S&lt;T&gt;::I();\n}\n</code></pre>\n"}], "owner": {"reputation": 36538, "user_id": 471164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/45d4a7ba0fb8e789356f5da87536444d?s=128&d=identicon&r=PG", "display_name": "vitaut", "link": "https://stackoverflow.com/users/471164/vitaut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1531935866, "creation_date": 1531932158, "question_id": 51407118, "link": "https://stackoverflow.com/questions/51407118/why-is-static-member-of-a-template-initialized-after-an-object-defined-later-in", "title": "Why is static member of a template initialized after an object defined later in the same translation unit?", "body": "<p>Consider the following (artificial) example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint f() {\n  return 42;\n}\n\ntemplate &lt;typename T&gt;\nstruct S {\n  static int I;\n};\n\ntemplate &lt;typename T&gt;\nint S&lt;T&gt;::I = f();\n\ntemplate &lt;typename T&gt;\nint g() {\n  return S&lt;T&gt;::I;\n}\n\nint global = g&lt;int&gt;();\n\nint main() {\n  std::cout &lt;&lt; global &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>It prints 0 when compiled with gcc 4.8.4 and run:</p>\n\n<pre><code>$ g++ test.cc\n$ ./a.out\n0\n</code></pre>\n\n<p>This suggests that dynamic initialization for <code>global</code> is run before the initialization for <code>S&lt;T&gt;::I&gt;</code>. However, according to <a href=\"https://stackoverflow.com/a/1421780/471164\">this SO answer</a>,</p>\n\n<blockquote>\n  <p>objects defined in the same translation unit (usually it means .cpp file) are initialized in order of their definitions</p>\n</blockquote>\n\n<p>Why is dynamic initialization for <code>global</code> run before the one for <code>S&lt;T&gt;::I&gt;</code> and not in the order of their definitions and is it possible to force <code>global</code> be initialized after?</p>\n"}, {"tags": ["c++", "performance", "qt", "serial-port", "qstring"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 3, "creation_date": 1531931315, "post_id": 51406812, "comment_id": 89784907, "body": "Avoid using the waitXXX methods, they are blockers, instead use signals."}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1531932541, "post_id": 51406812, "comment_id": 89785618, "body": "Is <code>serialPort</code> an instance of <code>QSerialPort</code>?  If so then your calls to <code>serialPort.readLine()</code> assume the data returned (if any) is a complete line.  I don&#39;t think there are any such guarantees."}, {"owner": {"reputation": 41, "user_id": 8509168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82f556769231ae708dbe557386fb3f8?s=128&d=identicon&r=PG&f=1", "display_name": "englemon", "link": "https://stackoverflow.com/users/8509168/englemon"}, "edited": false, "score": 0, "creation_date": 1531940570, "post_id": 51406812, "comment_id": 89789942, "body": "The way I understood it is that readLine reads until a \\r character. There is a \\r at the end of each packet that is sent. so it shouldn&#39;t keep reading past a packet."}, {"owner": {"reputation": 41, "user_id": 8509168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82f556769231ae708dbe557386fb3f8?s=128&d=identicon&r=PG&f=1", "display_name": "englemon", "link": "https://stackoverflow.com/users/8509168/englemon"}, "edited": false, "score": 0, "creation_date": 1531941127, "post_id": 51406812, "comment_id": 89790235, "body": "I obviously didn&#39;t understand how readLine() worked. I now at least know where to look to fix it. Thanks"}, {"owner": {"reputation": 23728, "user_id": 299399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1907f4968c4c5b5fedb8f7cba422a032?s=128&d=identicon&r=PG", "display_name": "Frank Osterfeld", "link": "https://stackoverflow.com/users/299399/frank-osterfeld"}, "edited": false, "score": 0, "creation_date": 1531986827, "post_id": 51406812, "comment_id": 89805469, "body": "Don\u2019t use QString (unicode strings) but QByteArray (plain data) when implementing a protocol like this."}], "owner": {"reputation": 41, "user_id": 8509168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82f556769231ae708dbe557386fb3f8?s=128&d=identicon&r=PG&f=1", "display_name": "englemon", "link": "https://stackoverflow.com/users/8509168/englemon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531930936, "creation_date": 1531930936, "question_id": 51406812, "link": "https://stackoverflow.com/questions/51406812/qt-qstring-quick-processing-problems", "title": "Qt QString quick processing problems", "body": "<p>I am trying to use QString functions to process frames received via serial in quite fast succession. I am running into problems where the functions such as mid() seem to stop working when called too quickly in rapid succession. I wrote a small test program to test it and am still having the problem. Is there a way I can make this work for calls in rapid succession or are there alternative functions I can try using? The code looks like this:</p>\n\n<pre><code>for(i = 0; i &lt; 200; i++){\n  status = interfaceObject.recieveBlocking(&amp;frame);\n  if(status == 0){\n    ui-&gt;statusWindow-&gt;append(frame.data + \"\\r\");\n  }\n  qApp-&gt;processEvents();\n}\n</code></pre>\n\n<p>and the receiving function like this:</p>\n\n<pre><code>int interface::recieveBlocking(struct frameStructure *frame){\n\n  if(serialPort.waitForReadyRead(100)){\n    QString read = serialPort.readLine().trimmed().simplified();\n    int length;\n    QString data;\n    QString id;\n    bool extended;\n    if(read.left(1) == \"t\"){\n      extended = false;\n      id = read.mid(1,3);\n      length = read.mid(4,1).toInt();\n      data = read.mid(5).trimmed();\n      if(read.length() &lt; 5 || ((data.length()/2) &lt; length))return 3;\n    }else if(read.left(1) == \"T\"){\n      extended = true;\n      id = read.mid(1,8);\n      length = read.mid(9,1).toInt();\n      data = read.mid(10).trimmed();\n      if(read.length() &lt; 10 || ((data.length()/2) &lt; length))return 3;\n    }else{\n      return 3;\n    }\n    frame-&gt;id = id;\n    frame-&gt;length = length;\n    frame-&gt;data = data;\n    frame-&gt;extended = extended;\n    return 0;\n  }else{\n    return 1;\n  }\n}\n</code></pre>\n\n<p>The serial getting set looks like this (sent at about 80 frames per second):</p>\n\n<pre><code>T18340418800009A1940000000\nT1834041B83CD011CF00000000\nT1834041F8596A090000CCF4FF\nT1834042184C4300007A110600\nT1834042280000000000000000\nT18340423899115C00FFA75B00\nT18340424833F304002C2C0100\nT18340425800000006000000FB\nT18340418800009A193F000000\nT180C041880000000000002500\nT18340418800009A193F000000\nT18340418800009A193F000000\nT180C041880000000000002500\nT18340418800009A193F000000\nT1834041B83CD011CF00000000\nT1834041F85C870900003FF7FF\nT1834042181D1900007A110600\nT1834042280000000000000000\nT18340423866465C00FFA75B00\nT183404248CC4C030063C80000\nT18340425800000006000000FB\nT18340418800009A193F000000\nT180C041880000000000002500\nT18340418800009A193F000000\nT18340418800009A193F000000\nT1834041B83CD011CF00000000\nT1834041F816020700004FF9FF\nT1834042181185FFFF7A110600\nT1834042280000000000000000\nT18340423899115C00FFA75B00\nT183404248FF1F040050FA0000\nT18340425800000006000000FB\nT180C041880000000000002500\nT18340418800009A193F000000\nT18340418800009A193F000000\nT180C041880000000000002500\nT181404188C300000000000000\nT182C041881E00000000000000\nT18340418800009A193F000000\nT183C04188002C000000000000\nT1824041880036000000000000\nT18340418800009A193F000000\nT1834041B83CD011CF00000000\nT1834041F8CA82060000F5F5FF\nT183404218B8E0FFFF6B100600\nT1834042280000000000000000\nT18340423899115C0099115C00\n</code></pre>\n\n<p>The output in the textBrowser looks like this:</p>\n\n<pre><code>0000000000002600 T18340418800009A193E000000\n\n0000000000002500\n\n00009A193E000000\n\n00009A193E000000\n\n3ED013CF00000000\n\n6F4082FA0064E7FF T1834042181F2200001C0B0600 T1834042280000000000000000 T18340423832BB640032BB6400 T18340424899790200FB950000\n\n00000006000000FB T180C041880000000000002500\n\n00009A193E000000 T18340418800009A193E000000\n\n0000000000002500\n\n00009A193E000000\n\n00009A193E000000\n\n3ED013CF00000000\n\nCC4A83FA0020EFFF T183404218DE6D00009A130600\n\n0000000000000000 T18340423832BB640032BB6400 T183404248FF1F0400F9F90000 T18340425800000006000000FB\n\n0000000000002500\n\n0036000000000000 T18340418800009A193E000000\n\n00009A193E000000\n\n0000000000002500\n\n00009A193E000000\n\n3ED013CF00000000\n\n083683FA00E7EBFF T1834042187FF8FFFFA9140600\n\n0000000000000000 T1834042386686640066866400 T183404248CC4C030086C80000 T18340425800000006000000FB\n\n00009A193E000000\n\n0000000000002500\n\n00009A193E000000\n\n00009A193E000000\n\n3ED013CF00000000\n\n211384FA0074E9FF\n\nC20E00004B0E0600 T1834042280000000000000000 T18340423832BB640032BB6400 T183404248CC4C0300A9C80000\n\n00000006000000FB T180C041880000000000002500\n\n00009A193E000000 T18340418800009A193E000000\n\n0000000000002500\n\n00009A193E000000\n\n00009A193E000000\n\n3ED013CF00000000\n\nAECA82FA00D7E9FF T183404218911C00002C0C0600 T1834042280000000000000000 T1834042386686640032BB6400 T183404248CC4C0300FAC70000 T18340425800000006000000FB\n\n0000000000002500\n\nC300000000000000 T182C041881E00000000000000\n\n00009A193E000000 T183C04188002F000000000000 T1824041880036000000000000 T18340418800009A193E000000\n</code></pre>\n"}, {"tags": ["c++", "cmake"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1531934777, "post_id": 51406768, "comment_id": 89786799, "body": "<code>These are not directly defined in the toy code above, but they should be defined in the library, correct?</code> - No, your <code>POP</code> library doesn&#39;t define symbols from <code>ParaView</code> one. So, when link with your library, you still need to link with <code>ParaView</code>."}, {"owner": {"reputation": 1, "user_id": 5352222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a9a42cd46bc36d596594c74a89a2c9d?s=128&d=identicon&r=PG&f=1", "display_name": "lemmox", "link": "https://stackoverflow.com/users/5352222/lemmox"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1531935349, "post_id": 51406768, "comment_id": 89787104, "body": "@Tsyvarev, is there anyway to make the library fully self-contained?  For a number of reasons directly linking Paraview and my final code is extremely messy."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1531951589, "post_id": 51406768, "comment_id": 89794879, "body": "If by &quot;self-contained&quot; you mean that your library will define symbols from ParaView, then you need to compile code of those libraries together. Or build static variant of libraries, and combine them into single static library (google for that). If by &quot;self-contained&quot; you mean that linking with &quot;Paraview&quot; will be performed automatically when one links your library, you need to create shared library instead of static."}, {"owner": {"reputation": 1, "user_id": 5352222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a9a42cd46bc36d596594c74a89a2c9d?s=128&d=identicon&r=PG&f=1", "display_name": "lemmox", "link": "https://stackoverflow.com/users/5352222/lemmox"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1532004455, "post_id": 51406768, "comment_id": 89817003, "body": "Okay great, that&#39;s actually very helpful!"}], "owner": {"reputation": 1, "user_id": 5352222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a9a42cd46bc36d596594c74a89a2c9d?s=128&d=identicon&r=PG&f=1", "display_name": "lemmox", "link": "https://stackoverflow.com/users/5352222/lemmox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531930802, "creation_date": 1531930802, "question_id": 51406768, "link": "https://stackoverflow.com/questions/51406768/cmake-static-libraries-not-linking-correctly-with-second-project", "title": "CMake: Static libraries not linking correctly with second project", "body": "<p>Let me preface this by saying I'm quite new to CMake, so please let me know if I'm just misunderstanding something here.</p>\n\n<p>First I'm compiling a static library that acts as a wrapper to an external program (Paraview).  The CMakeLists file I use to create this library is like so:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.3)\nproject(POP)\nset(CMAKE_ARCHIVE_OUTPUT_DIRECTORY [LIBRARY HOME]/lib/)\n\n\n set(ParaView_DIR [PARAVIEW HOME]/ParaView-v5.4.1/)\n\n  find_package(ParaView REQUIRED COMPONENTS vtkPVPythonCatalyst)\n  include(\"${PARAVIEW_USE_FILE}\")\n\n\n if(NOT PARAVIEW_USE_MPI)\n    message(SEND_ERROR \"ParaView must be built with MPI enabled\")\n    endif()\n\n  set(HEADER_FILES ${CMAKE_CURRENT_SOURCE_DIR}/include/pop_API.h ${CMAKE_CURRENT_SOURCE_DIR}/include/pop_API_vars.h ${CMAKE_CURRENT_SOURCE_DIR}/include/pop_Structures.h ${CMAKE_CURRENT_SOURCE_DIR}/include/wrapper_pop_API.h)\n\n  add_library(POP STATIC src/pop_API.cpp src/wrapper_pop_API.cpp src/pop_Adaptor.cpp ${HEADER_FILES})\n  target_include_directories(POP PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/include)          \n  target_link_libraries(POP LINK_PUBLIC vtkPVPythonCatalyst)\n  include(vtkModuleMacros)\n  include(vtkMPI)\n  vtk_mpi_link(POP)\n</code></pre>\n\n<p>This links in a specific Paraview module I need, and some VTK datastructures that are required for that as well.</p>\n\n<p>This CMake file runs just fine, and I can compile the libraries no problem.  If I add a Main function to my C++ code and compile it as an executable, that runs no problem as well.  So everything <em>seems</em> fine here.</p>\n\n<p>Now, I ultimately want this static library to be called by a second piece of code.  To test this I've written a toy C++ project that just calls the main functions of this library</p>\n\n<pre><code>#include \"pop_Structures.h\"\n#include \"pop_API.h\" \n\nint main()\n    {\n      PopGrid* grid;\n      PopSolution* solution;\n      a = 1;\n      b = 2;\n      int x = POP_INITIALIZE(a, b);\n      int y = COPROCESS(PopGrid, PopSolution, a, b, a, b);\n      int z = POP_FINALIZE();\n}\n</code></pre>\n\n<p>The included header files just define the PopSolution and PopGrid structures, as well as the prototypes for the three functions being called.  I create the executable for this program using a CMakeLists file that looks like</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.3)\nproject(CPP_Test)\n\nfind_package(MPI REQUIRED)\n  include_directories(${MPI_CXX_INCLUDE_PATH})  \n\n  set(HEADER_FILES [LIBRARY HOME]/include/pop_API.h [LIBRARY HOME]/include/pop_Structures.h)\n\n  ADD_EXECUTABLE(CPP_TEST CPP_Test.cpp ${HEADER_FILES})\n  target_include_directories(CPP_TEST PUBLIC [LIBRARY HOME]/include)\n  target_link_libraries(CPP_TEST[LIBRARY HOME]/lib/libPOP.a)\n</code></pre>\n\n<p>This CMake also runs just fine, but when I compile it I get a number of undefined reference errors pointing to functions in libPOP.a where I refer to VTK/Paraview data structures and functions.  These are not directly defined in the toy code above, but they <em>should</em> be defined in the library, correct?  If these structures are all defined when I compile the initial library, why are they not defined when I call that library externally?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "sorting"], "comments": [{"owner": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "edited": false, "score": 3, "creation_date": 1531930727, "post_id": 51406678, "comment_id": 89784572, "body": "You shouldn&#39;t avoid arrays simply because you don&#39;t want to learn how to work with them..."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1531930766, "post_id": 51406678, "comment_id": 89784593, "body": "You should learn about loops and arrays and consider this the opportunity to do so."}, {"owner": {"reputation": 399, "user_id": 7460500, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/058e5b7edb0f5289e44762b5ac176143?s=128&d=identicon&r=PG&f=1", "display_name": "person", "link": "https://stackoverflow.com/users/7460500/person"}, "edited": false, "score": 1, "creation_date": 1531930824, "post_id": 51406678, "comment_id": 89784630, "body": "You&#39;re going to have to use some sort of loop if you ever want to scale this up to sort more numbers. Try learning C++ basics more before trying to tackle this"}, {"owner": {"reputation": 39539, "user_id": 153430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a446e1fd338fb334fa68b3f7470cd65b?s=128&d=identicon&r=PG", "display_name": "Jim Lewis", "link": "https://stackoverflow.com/users/153430/jim-lewis"}, "edited": false, "score": 5, "creation_date": 1531930952, "post_id": 51406678, "comment_id": 89784702, "body": "With only four values, it should be easy to simulate your algorithm using pencil and paper.  Try &quot;4 3 2 1&quot; as your input and see what happens."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1531930998, "post_id": 51406678, "comment_id": 89784735, "body": "There are minimum <b>five</b> conditions,  not three, to be checked for sorting four arbitrary items. And this gets unmanageable past a dozen or so. Learn loops and arrays."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1531931504, "post_id": 51406678, "comment_id": 89785034, "body": "<i>and so I hope that In the end there is a way to do sorting without them.</i> -- Try to sort a hundred or a thousand numbers without using arrays (or some container) and loops."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 2, "creation_date": 1531931651, "post_id": 51406678, "comment_id": 89785123, "body": "Sorting is more difficult than loops and arrays. I suggest you learn loops and arrays first."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1531932271, "post_id": 51406678, "comment_id": 89785478, "body": "If you don&#39;t want to use loops and arrays you have to continue the processes manually. You have the smallest value in <code>d</code> now. Now you have to get the second smallest value in <code>c</code>. You simply have to repeat what you did again."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1531932228, "creation_date": 1531932228, "answer_id": 51407137, "question_id": 51406678, "link": "https://stackoverflow.com/questions/51406678/sorting-in-c-without-arrays/51407137#51407137", "title": "Sorting in c++, without arrays", "body": "<blockquote>\n  <p>But no matter what I try it doesn't seem to work.</p>\n</blockquote>\n\n<p>It doesn't work because you don't sort the array enough. Those three swaps aren't sufficient for all inputs.</p>\n\n<p>Now that you've attempted to invent a way to sort numbers, I would suggest researching existing algorithms. I recommend starting with teaching yourself bubble sort. Not because it's good - it's not - but because it is very intuitive, and in fact what you have written so far is the first \"pass\" of the bubble sort algorithm.</p>\n\n<p>You can certainly implement bubble sort without loops or arrays, but it will be more tedious and error prone than using them.</p>\n"}, {"tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": true, "score": 4, "last_activity_date": 1531932326, "creation_date": 1531932326, "answer_id": 51407165, "question_id": 51406678, "link": "https://stackoverflow.com/questions/51406678/sorting-in-c-without-arrays/51407165#51407165", "title": "Sorting in c++, without arrays", "body": "<p>Now that everyone has pounded the point of learning array management and loop control, I'l tell you what is actually wrong with your sorting operation. It's only partially sorting because your chosen comparisons and swaps are incomplete, and frankly based on educated naive guessing.</p>\n\n<p>Sorting four arbitrary values descending without arrays can be done with a <a href=\"https://en.wikipedia.org/wiki/Sorting_network\" rel=\"nofollow noreferrer\"><strong>static sorting network</strong></a>. I'll not go into how they work, and the far, far more complex task of how to generate them (generators do exist, btw). Suffice it to say that John's comment about sorting being much, much more complicated than loops and arrays is spot-on, and infinite wisdom, and you should learn the latter first.</p>\n\n<p>Regardless, see below</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\n\nint main() \n{\n    int a, b, c, d;\n    if (!(std::cin &gt;&gt; a &gt;&gt; b &gt;&gt; c &gt;&gt; d))\n        return EXIT_FAILURE;\n\n    if (a &lt; b)\n        std::swap(a, b);\n\n    if (c &lt; d)\n        std::swap(c, d);\n\n    if (a &lt; c)\n        std::swap(a, c);\n\n    if (b &lt; d)\n        std::swap(b, d);\n\n    if (b &lt; c)\n        std::swap(b, c);\n\n    std::cout &lt;&lt; a &lt;&lt; ' ' &lt;&lt; b &lt;&lt; ' ' &lt;&lt; c &lt;&lt; ' ' &lt;&lt; d &lt;&lt; '\\n';\n\n    return 0;\n}\n</code></pre>\n\n<p>Those comparisons and swaps are <em>not</em> arbitrary. They were chosen <em>specifically</em> because at each point along the algorithm, what you have in place in each variable is a direct reflection of the code before it. For only a few numbers, this is visually graspable. Once you cross about eight or so, things get very complicated, <em>very</em> quickly.</p>\n\n<p>Your code is broken because you didn't actually consider what each step in your swap comparisons was doing, and what was left in the wake of prior steps. Though you <em>can</em> do this for smaller sets of items (optimized multi-phase sorting algorithms frequently employ static sorting networks for the smaller partitions), it is no excuse for avoiding learning sequence management with things like arrays and loop control. You'll use that knowledge the rest of your life, and in many more things than just sorting.</p>\n"}, {"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1531933610, "post_id": 51407221, "comment_id": 89786215, "body": "If you have <code>d</code>, <code>c</code>, and <code>b</code> correct, then by definition, the only remaining <code>a</code> must also be correct ;)"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1531954028, "post_id": 51407221, "comment_id": 89795581, "body": "@user2079303: I know. But that&#39;s an optimization. Just like not needing to re-test the ones that are already sorted."}], "tags": [], "owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "is_accepted": false, "score": 0, "last_activity_date": 1531932569, "creation_date": 1531932569, "answer_id": 51407221, "question_id": 51406678, "link": "https://stackoverflow.com/questions/51406678/sorting-in-c-without-arrays/51407221#51407221", "title": "Sorting in c++, without arrays", "body": "<blockquote>\n  <p>But no matter what I try it doesn't seem to work.</p>\n</blockquote>\n\n<p>That's because you have simply sorted the smallest number into <code>d</code>.</p>\n\n<p>The next step is to repeat what you have done for each of the next three numbers.</p>\n\n<pre><code>//What You did:\nif (a &lt; b){\n    swap (b,a);\n}\n\nif (b &lt; c){\n    swap (c,b);\n}\n\nif (c &lt; d){\n    swap (d,c);\n}\n\n// You now have `d`.\n// To sort this you need to do this 3 more\n// times to get the other three values\nif (a &lt; b){\n    swap (b,a);\n}\n\nif (b &lt; c){\n    swap (c,b);\n}\n\nif (c &lt; d){\n    swap (d,c);\n}\n\n// You now have d and c correct.\nif (a &lt; b){\n    swap (b,a);\n}\n\nif (b &lt; c){\n    swap (c,b);\n}\n\nif (c &lt; d){\n    swap (d,c);\n}\n\n// You now have d c b correct.\nif (a &lt; b){\n    swap (b,a);\n}\n\nif (b &lt; c){\n    swap (c,b);\n}\n\nif (c &lt; d){\n    swap (d,c);\n}\n\n// You now have d c b a correct. Sorted complete.\n</code></pre>\n\n<p>I would note that this is way easier if you simply use a loop. There is a lot less code to type. But what you have implemented here is a bubble sort for 4 values (with absolutely no optimizations) that you have unrolled. Now you can optimize this not all those swaps are required. But I think it best you learn about loops next.</p>\n"}], "owner": {"reputation": 13, "user_id": 10029163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4b61ca68a0c33644263d384d17b3b55?s=128&d=identicon&r=PG&f=1", "display_name": "Ingham", "link": "https://stackoverflow.com/users/10029163/ingham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2047, "favorite_count": 0, "accepted_answer_id": 51407165, "answer_count": 3, "score": -4, "last_activity_date": 1531932569, "creation_date": 1531930496, "last_edit_date": 1531930664, "question_id": 51406678, "link": "https://stackoverflow.com/questions/51406678/sorting-in-c-without-arrays", "title": "Sorting in c++, without arrays", "body": "<p>I am new to c++, and I'm currently trying to do sorting. But no matter what I try it doesn't seem to work. I don't really have any experience with while, for loops, and arrays, and so I hope that In the end there is a way to do sorting without them.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint a;\nint b;\nint c;\nint d;\n\nvoid Sort(){\n    cout &lt;&lt; \"Enter 4 numbers.\";\n\n    cin &gt;&gt; a;\n    cin &gt;&gt; b;\n    cin &gt;&gt; c;\n    cin &gt;&gt; d;\n\n    if (a &lt; b){\n        swap (b,a);\n    }\n\n    if (b &lt; c){\n        swap (c,b);\n    }\n\n    if (c &lt; d){\n        swap (d,c);\n    }\n}\n\nint main () {\n    Sort();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "qt", "opengl", "geometry-shader"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9653621, "user_type": "registered", "profile_image": "https://graph.facebook.com/1671258452960568/picture?type=large", "display_name": "Anton Ponikarovskii", "link": "https://stackoverflow.com/users/9653621/anton-ponikarovskii"}, "edited": false, "score": 0, "creation_date": 1532348494, "post_id": 51407420, "comment_id": 89925675, "body": "thank you for your advices. I understood that need to solve more complex task: save somewhere points, which are result from crossing my 3d object and plane. Started to google, found this <a href=\"https://stackoverflow.com/questions/13662005/run-on-buffer-object-and-change-its-data-by-shader\">article</a>. But all of them need at least GL 3.X. After that i tried to swith to a modern core profile GL context: run standart Qt example &quot;computegles31&quot; and through function OGLSupports it returns me that there is no GL &gt;=2.0 and compute shaders support, supporting just GLES 2.0, 3.0. How can i fix it?"}, {"owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "reply_to_user": {"reputation": 13, "user_id": 9653621, "user_type": "registered", "profile_image": "https://graph.facebook.com/1671258452960568/picture?type=large", "display_name": "Anton Ponikarovskii", "link": "https://stackoverflow.com/users/9653621/anton-ponikarovskii"}, "edited": false, "score": 0, "creation_date": 1532372566, "post_id": 51407420, "comment_id": 89940255, "body": "@AntonPonikarovskii: &quot;I understood that need to solve more complex task: save somewhere points, which are result from crossing my 3d object and plane.&quot; uhm, no. What would you need to save that for? You calculate that value on the fly in the vertex shader, and just assign it to the appropriate <code>gl_ClipDistance</code> output. All you need are the coffecients for your plane(s) (e.g as uniform), and a simple <code>dot</code> product."}, {"owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "reply_to_user": {"reputation": 13, "user_id": 9653621, "user_type": "registered", "profile_image": "https://graph.facebook.com/1671258452960568/picture?type=large", "display_name": "Anton Ponikarovskii", "link": "https://stackoverflow.com/users/9653621/anton-ponikarovskii"}, "edited": false, "score": 0, "creation_date": 1532372739, "post_id": 51407420, "comment_id": 89940332, "body": "@AntonPonikarovskii: as far as the GL context creation goes: what&#39;s possible will depend on the device you&#39;re running this, the drivers in use, the Qt version and some with which options it was compiled, and maybe even some of the GL libraries which are deployed along your Qt application. I&#39;ve seen some Qt projects coming with own versions of the mesa software renderer and/or ANGLE. I&#39;ve no idea why they do that, but I really don&#39;t know about qt."}, {"owner": {"reputation": 13, "user_id": 9653621, "user_type": "registered", "profile_image": "https://graph.facebook.com/1671258452960568/picture?type=large", "display_name": "Anton Ponikarovskii", "link": "https://stackoverflow.com/users/9653621/anton-ponikarovskii"}, "edited": false, "score": 0, "creation_date": 1532429258, "post_id": 51407420, "comment_id": 89961128, "body": "yes, I&#39;ve understood gl_ClipDistance method and implemented it. But while I was implementing this method I decided to add some addition featch. I clip 3D model of room with complicated geometry, and by clipping I get walls border in this plane. I want to compute some trajectories in this 2D plane inside borders. So, I need this points which I get from crossing the model and plane. Thanks about Qt and GL. Continue googling and reading."}, {"owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "reply_to_user": {"reputation": 13, "user_id": 9653621, "user_type": "registered", "profile_image": "https://graph.facebook.com/1671258452960568/picture?type=large", "display_name": "Anton Ponikarovskii", "link": "https://stackoverflow.com/users/9653621/anton-ponikarovskii"}, "edited": false, "score": 0, "creation_date": 1532459635, "post_id": 51407420, "comment_id": 89980992, "body": "&quot;So, I need this points which I get from crossing the model and plane.&quot; Well, you should proably just calculate the intersections manually. The GL isn&#39;t going to help you with that."}, {"owner": {"reputation": 13, "user_id": 9653621, "user_type": "registered", "profile_image": "https://graph.facebook.com/1671258452960568/picture?type=large", "display_name": "Anton Ponikarovskii", "link": "https://stackoverflow.com/users/9653621/anton-ponikarovskii"}, "edited": false, "score": 0, "creation_date": 1532498940, "post_id": 51407420, "comment_id": 89992170, "body": "maybe you know some other methods which could help? I download my object from .obj file, so i know all vertices and how they connet between each other."}], "tags": [], "owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "is_accepted": true, "score": 3, "last_activity_date": 1531933324, "creation_date": 1531933324, "answer_id": 51407420, "question_id": 51406431, "link": "https://stackoverflow.com/questions/51406431/implementing-clip-planes-with-geometry-shaders/51407420#51407420", "title": "Implementing clip planes with geometry shaders?", "body": "<p>Let's sort out a few misconceptions first:</p>\n\n<blockquote>\n  <p>have found ancient openGL function <code>glClipPlane</code>, but its not compability with VAOs and VBOs.</p>\n</blockquote>\n\n<p>That is not correct. The user defined clip planes via <code>glClipPlane</code> are indeed deprecated in modern GL, and removed from core profiles. But if you use a context where they still exist, you can combine them with VAOs and VBOs without any issue.</p>\n\n<blockquote>\n  <p>Also Ive found out that its possible to rewrite <code>glClipPlane</code> via geometry shader.</p>\n</blockquote>\n\n<p>You don't need a geometry shader for custom clip planes.</p>\n\n<p>The modern way of user-defined clip planes is calculating <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/gl_ClipDistance.xhtml\" rel=\"nofollow noreferrer\"><code>gl_ClipDistance</code></a> for each vertex. While you can modify this value in a geometry shader, you can also directly generate it in the vertex shader. If you don't otherwise need a geometry shader, there is absolutely no reason to add it just for the clip planes.</p>\n\n<blockquote>\n  <p>I really dont understand, how to add geometry shader in QtCreator, there is no \"icon\" of geometry shader, I tried to add vertex shader and rename it to .gsh or just .glsl, tried to use <code>OpenGLShaderProgram::addShaderFromSourceCode(QOpenGLShader::Geometry, QString &amp;source)</code> and write shader code in program, but every time I get \"QOpenGLShader: could not create shader\" on string with adding geometry shader.</p>\n</blockquote>\n\n<p>You first need to find out which OpenGL version you're actually using. With Qt, you can easily end up with an OpenGL<strong>ES</strong> 2.0 context (depending on how you create the context, and also how your Qt was compiled). Your shader code is either desktop GL 2.x (GLSL 1.10/1.20) or GLES 2.0 (GLSL 1.00ES), but not valid in modern core profiles of OpenGL.</p>\n\n<p>GLES2 does not support geometry shaders at all. It also does not support <code>gl_ClipDistance</code>, so if you _really) have to use GLES2, you can try to <a href=\"https://stackoverflow.com/a/49094187/2327517\">emulate the clipping in the fragment shader</a>. But the better option would be switching to a modern core profile GL context.</p>\n"}, {"tags": [], "owner": {"reputation": 1230, "user_id": 3958860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iLugv.jpg?s=128&g=1", "display_name": "Fibbles", "link": "https://stackoverflow.com/users/3958860/fibbles"}, "is_accepted": false, "score": 1, "last_activity_date": 1531935847, "last_edit_date": 1531935847, "creation_date": 1531933689, "answer_id": 51407519, "question_id": 51406431, "link": "https://stackoverflow.com/questions/51406431/implementing-clip-planes-with-geometry-shaders/51407519#51407519", "title": "Implementing clip planes with geometry shaders?", "body": "<p>While <code>glClipPlane</code> is deprecated in modern OpenGL, the concept of clipping planes is not.</p>\n\n<p>In your CPU code before you start drawing the geometry to be clipped you must enable one of the clipping planes.</p>\n\n<p><code>glEnable(GL_CLIP_DISTANCE0);</code></p>\n\n<p>Once you have finished drawing you would disable this in a similar way.</p>\n\n<p><code>glDisable(GL_CLIP_DISTANCE0);</code></p>\n\n<p>You are guaranteed to be able to enable minimum of 8 clipping planes.</p>\n\n<p>In your vertex or geometry shader you must then tell OpenGL the signed distance of your vertex from the plane so that it knows what to clip. To be clear you don't <em>need</em> a geometry shader for clipping but it can be done there if you wish. The shader code would look something like the following:</p>\n\n<pre><code>// vertex in world space\nvec4 vert_pos_world = world_matrix * vec4(vert_pos_model, 1.0);\n\n// a horizontal plane at a specified height with normal pointing up\n// could be a uniform or hardcoded\nvec4 plane = vec4(0, 1, 0, clip_height_world);\n\n// 0 index since that's the clipping plane we enabled\ngl_ClipDistance[0] = dot(vert_pos_world, plane);\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9653621, "user_type": "registered", "profile_image": "https://graph.facebook.com/1671258452960568/picture?type=large", "display_name": "Anton Ponikarovskii", "link": "https://stackoverflow.com/users/9653621/anton-ponikarovskii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1292, "favorite_count": 1, "accepted_answer_id": 51407420, "answer_count": 2, "score": 1, "last_activity_date": 1532348785, "creation_date": 1531929584, "last_edit_date": 1532348785, "question_id": 51406431, "link": "https://stackoverflow.com/questions/51406431/implementing-clip-planes-with-geometry-shaders", "title": "Implementing clip planes with geometry shaders?", "body": "<p><strong>What am I using:</strong> Qt 5.11.1, MinGW 5.3, Windows 10, C++11, GPU: NVidia 820M (supports OpenGL 4.5)</p>\n\n<p><strong>My task:</strong> I have non-solid (just surface) object, rendering by glDrawArrays, and i need to get cross-section of this object by plane. I have found ancient openGL function glClipPlane, but its not compability with VAOs and VBOs. Also Ive found out that its possible to rewrite glClipPlane via geometry shader.</p>\n\n<p><strong>My questions/problems:</strong></p>\n\n<ol>\n<li><p>Do you know other ways to realize this task?</p></li>\n<li><p>I really dont understand, how to add geometry shader in QtCreator, there is no \"icon\" of geometry shader, I tried to add vertex shader and rename it to .gsh or just .glsl, tried to use <code>QOpenGLShaderProgram::addShaderFromSourceCode(QOpenGLShader::Geometry, QString &amp;source)</code> and write shader code in program, but every time I get \"QOpenGLShader: could not create shader\" on string with adding geometry shader.</p></li>\n</ol>\n\n<p>look of adding shader into program</p>\n\n<p><a href=\"https://i.stack.imgur.com/MXjYC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MXjYCm.png\" alt=\"screenshot\"></a>\n<br></p>\n\n<p>Vertex shader:</p>\n\n<pre><code>layout (triangles) in;\nlayout (triangles) out;\nlayout (max_vertices = 3) out;\n\nvoid main()\n{\n    int i;\n\n    for (i = 0; i &lt; gl_in.length(); i++)\n    {\n        gl_Position = gl_in[i].gl_Position;\n        EmitVertex();\n    }\n    EndPrimitive();\n}\n</code></pre>\n\n<p>Geometry shader:</p>\n\n<pre><code>layout (triangles) in;\nlayout (triangles) out;\nlayout (max_vertices = 3) out;\n\nvoid main()\n{\n    int i;\n\n    for (i = 0; i &lt; gl_in.length(); i++)\n    {\n        gl_Position = gl_in[i].gl_Position;\n        EmitVertex();\n    }\n    EndPrimitive();\n}\n</code></pre>\n\n<p>Fragment shader:</p>\n\n<pre><code>precision mediump float;\n\nuniform highp float u_lightPower;\nuniform sampler2D u_texture;\nuniform highp mat4 u_viewMatrix;\nvarying highp vec4 v_position;\nvarying highp vec2 v_texCoord;\nvarying highp vec3 v_normal;\n\nvoid main(void)\n{\n    vec4 resultColor = vec4(0.25, 0.25, 0.25, 0.0);\n    vec4 diffMatColor = texture2D(u_texture, v_texCoord);\n    vec3 eyePosition = vec3(u_viewMatrix);\n    vec3 eyeVect = normalize(v_position.xyz - eyePosition);\n    float dist = length(v_position.xyz - eyePosition);\n    vec3 reflectLight = normalize(reflect(eyeVect, v_normal));\n    float specularFactor = 1.0;\n    float ambientFactor = 0.05;\n\n    vec4 diffColor = diffMatColor * u_lightPower * dot(v_normal, -eyeVect);//     * (1.0 + 0.25 * dist * dist);\n\n    resultColor += diffColor;\n\n    gl_FragColor = resultColor;\n\n}    \n</code></pre>\n"}, {"tags": ["c++", "integer", "division", "multiplication", "elliptic-curve"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4471396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53d035b6d934256579e4b6b40c909c70?s=128&d=identicon&r=PG&f=1", "display_name": "letsgetsomecodedone", "link": "https://stackoverflow.com/users/4471396/letsgetsomecodedone"}, "is_accepted": false, "score": 0, "last_activity_date": 1532096656, "creation_date": 1532096656, "answer_id": 51444702, "question_id": 51406274, "link": "https://stackoverflow.com/questions/51406274/elliptic-curve-how-to-handle-division-at-point-multiplication/51444702#51444702", "title": "Elliptic Curve - How to handle division at point multiplication", "body": "<p>The answer seems to be modular division or better multiplication of the inverse element.</p>\n"}], "owner": {"reputation": 1, "user_id": 4471396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53d035b6d934256579e4b6b40c909c70?s=128&d=identicon&r=PG&f=1", "display_name": "letsgetsomecodedone", "link": "https://stackoverflow.com/users/4471396/letsgetsomecodedone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532096656, "creation_date": 1531929154, "last_edit_date": 1531932839, "question_id": 51406274, "link": "https://stackoverflow.com/questions/51406274/elliptic-curve-how-to-handle-division-at-point-multiplication", "title": "Elliptic Curve - How to handle division at point multiplication", "body": "<p>I am working on implementing EC-calculations (first) in C++. Everything makes sense to me, but the division used in point multiplication. As I understand using integers is common but the division of lambda (<a href=\"https://en.wikipedia.org/wiki/Elliptic_curve_point_multiplication\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Elliptic_curve_point_multiplication</a>) for addition or doubling a point gives some uncertainty because of the approximation of the result. How is this normally handled, so everyone gets the same results despite using different amount of numbers after dot? </p>\n\n<p>(Unfortunately I could not find the implementation of the return of the EC_POINT_add function by openssl to compare their solution)  </p>\n"}, {"tags": ["c++", "boost", "split"], "comments": [{"owner": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "edited": false, "score": 0, "creation_date": 1531929131, "post_id": 51406255, "comment_id": 89783513, "body": "What&#39;s the problem?"}, {"owner": {"reputation": 13, "user_id": 10096542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/155fadd64a27b10ff9cccafe1da5eeb2?s=128&d=identicon&r=PG&f=1", "display_name": "newquest", "link": "https://stackoverflow.com/users/10096542/newquest"}, "reply_to_user": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "edited": false, "score": 0, "creation_date": 1531929187, "post_id": 51406255, "comment_id": 89783557, "body": "I know how split but I dont know how get the nth part  in this case get &quot;two&quot;"}, {"owner": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "edited": false, "score": 0, "creation_date": 1531929249, "post_id": 51406255, "comment_id": 89783594, "body": "doesn&#39;t the <code>cout</code> line work? what does it print? by the way, prefer <code>std::vector</code> over <code>std::list</code>. <code>std::list</code> is a linked-list which is typically slower than <code>std::vector</code> and doesn&#39;t have a benefit here."}, {"owner": {"reputation": 13, "user_id": 10096542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/155fadd64a27b10ff9cccafe1da5eeb2?s=128&d=identicon&r=PG&f=1", "display_name": "newquest", "link": "https://stackoverflow.com/users/10096542/newquest"}, "reply_to_user": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "edited": false, "score": 0, "creation_date": 1531929300, "post_id": 51406255, "comment_id": 89783629, "body": "this part not work cout &lt;&lt; results[1] &lt;&lt; &quot;&quot;;"}, {"owner": {"reputation": 13, "user_id": 10096542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/155fadd64a27b10ff9cccafe1da5eeb2?s=128&d=identicon&r=PG&f=1", "display_name": "newquest", "link": "https://stackoverflow.com/users/10096542/newquest"}, "reply_to_user": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "edited": false, "score": 0, "creation_date": 1531929326, "post_id": 51406255, "comment_id": 89783654, "body": "IM confused , IM looking some examples but I dont found"}, {"owner": {"reputation": 13, "user_id": 10096542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/155fadd64a27b10ff9cccafe1da5eeb2?s=128&d=identicon&r=PG&f=1", "display_name": "newquest", "link": "https://stackoverflow.com/users/10096542/newquest"}, "reply_to_user": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "edited": false, "score": 0, "creation_date": 1531929409, "post_id": 51406255, "comment_id": 89783720, "body": "please help me IM new in c++"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10096542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/155fadd64a27b10ff9cccafe1da5eeb2?s=128&d=identicon&r=PG&f=1", "display_name": "newquest", "link": "https://stackoverflow.com/users/10096542/newquest"}, "edited": false, "score": 0, "creation_date": 1531929459, "post_id": 51406361, "comment_id": 89783764, "body": "but how I could do this with list and boost exist any way?"}, {"owner": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "reply_to_user": {"reputation": 13, "user_id": 10096542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/155fadd64a27b10ff9cccafe1da5eeb2?s=128&d=identicon&r=PG&f=1", "display_name": "newquest", "link": "https://stackoverflow.com/users/10096542/newquest"}, "edited": false, "score": 0, "creation_date": 1531929487, "post_id": 51406361, "comment_id": 89783786, "body": "why would you use <code>std::list</code> rather than <code>std::vector</code>?"}, {"owner": {"reputation": 13, "user_id": 10096542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/155fadd64a27b10ff9cccafe1da5eeb2?s=128&d=identicon&r=PG&f=1", "display_name": "newquest", "link": "https://stackoverflow.com/users/10096542/newquest"}, "edited": false, "score": 0, "creation_date": 1531929551, "post_id": 51406361, "comment_id": 89783841, "body": "Im new in c++ I know boost because use this ,  i dont know vector"}, {"owner": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "reply_to_user": {"reputation": 13, "user_id": 10096542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/155fadd64a27b10ff9cccafe1da5eeb2?s=128&d=identicon&r=PG&f=1", "display_name": "newquest", "link": "https://stackoverflow.com/users/10096542/newquest"}, "edited": false, "score": 0, "creation_date": 1531929595, "post_id": 51406361, "comment_id": 89783873, "body": "It will work with <code>std::vector</code> too... you do not need <code>std::list</code> here."}], "tags": [], "owner": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "is_accepted": false, "score": 0, "last_activity_date": 1531929460, "last_edit_date": 1531929460, "creation_date": 1531929406, "answer_id": 51406361, "question_id": 51406255, "link": "https://stackoverflow.com/questions/51406255/how-print-nth-split-of-string-with-boost-c/51406361#51406361", "title": "how print nth split of string with boost c++?", "body": "<p><code>cout &lt;&lt; results[1] &lt;&lt; \"\";</code></p>\n\n<p>This doesn't work because <code>results</code> is a <code>std::list</code>. <a href=\"https://stackoverflow.com/questions/1112724/why-isnt-there-an-operator-for-a-stdlist\"><code>std::list</code> does not provide the <code>[]</code> operator.</a> In your usecase, you should use a <code>std::vector</code> instead.</p>\n"}, {"tags": [], "owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "is_accepted": true, "score": 0, "last_activity_date": 1531934839, "last_edit_date": 1531934839, "creation_date": 1531932039, "answer_id": 51407086, "question_id": 51406255, "link": "https://stackoverflow.com/questions/51406255/how-print-nth-split-of-string-with-boost-c/51407086#51407086", "title": "how print nth split of string with boost c++?", "body": "<p>The other answers given shows the reason for the error in that you are using a <code>std::list</code>, which in turn does not provide an <code>operator []</code>.  The easiest thing is to just use <code>std::vector</code>.</p>\n\n<p>However, if you really wanted to use a <code>std::list</code>, the way you get to a certain position in the list is to advance to that position.  Thus there is a <a href=\"https://en.cppreference.com/w/cpp/iterator/advance\" rel=\"nofollow noreferrer\">std::advance</a> function that does this, in addition to <a href=\"https://en.cppreference.com/w/cpp/iterator/next\" rel=\"nofollow noreferrer\">std::next</a>, which is merely a wrapper for <code>std::advance</code>.</p>\n\n<p>So here is a solution using <code>std::list</code> and <code>std::advance</code>.</p>\n\n<pre><code>#include &lt;boost/algorithm/string.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;list&gt;\n#include &lt;string&gt;\n#include &lt;iterator&gt;\n\nint main()\n{\n    std::string s = \"one,two,three,four\";\n    std::list&lt;std::string&gt; results;\n\n    boost::split(results, s, boost::is_any_of(\",\"));\n    auto iter = results.begin();\n    std::advance(iter, 1);\n    std::cout &lt;&lt; *iter &lt;&lt; \"\";\n}\n</code></pre>\n\n<p><a href=\"https://www.ideone.com/nzG4lJ\" rel=\"nofollow noreferrer\">Live Example</a></p>\n\n<hr>\n\n<p>Now using <code>std::next</code>:</p>\n\n<pre><code>#include &lt;boost/algorithm/string.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;list&gt;\n#include &lt;string&gt;\n#include &lt;iterator&gt;\n\nint main()\n{\n    std::string s = \"one,two,three,four\";\n    std::list&lt;std::string&gt; results;\n\n    boost::split(results, s, boost::is_any_of(\",\"));\n    auto iter = std::next(results.begin(), 1);\n    std::cout &lt;&lt; *iter &lt;&lt; \"\";\n}\n</code></pre>\n\n<p><a href=\"https://www.ideone.com/SuWyMS\" rel=\"nofollow noreferrer\">Live Example</a></p>\n"}], "owner": {"reputation": 13, "user_id": 10096542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/155fadd64a27b10ff9cccafe1da5eeb2?s=128&d=identicon&r=PG&f=1", "display_name": "newquest", "link": "https://stackoverflow.com/users/10096542/newquest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 51407086, "answer_count": 2, "score": -1, "last_activity_date": 1531934839, "creation_date": 1531929105, "last_edit_date": 1531930568, "question_id": 51406255, "link": "https://stackoverflow.com/questions/51406255/how-print-nth-split-of-string-with-boost-c", "title": "how print nth split of string with boost c++?", "body": "<p>I need to get the 2nd split of a string, in the case below \"two\".</p>\n\n<p>I tried running this code:</p>\n\n<pre><code>#include &lt;boost/algorithm/string.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;list&gt;\n#include &lt;string&gt;\n\nint main()\n{\n    std::string s = \"one,two,three,four\";\n    std::list&lt;std::string&gt; results;\n\n    boost::split(results, s, boost::is_any_of(\",\"));\n\n    std::cout &lt;&lt; results[1] &lt;&lt; \"\";\n}\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>error: no match for 'operator[]'\n</code></pre>\n\n<p>How can I solve it?</p>\n"}, {"tags": ["c++", "c++14", "constexpr"], "answers": [{"comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1531929716, "post_id": 51406413, "comment_id": 89783957, "body": "Hm. Not quite, but you are nearly there."}, {"owner": {"reputation": 588, "user_id": 2133098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCzMG.jpg?s=128&g=1", "display_name": "Taylor Nichols", "link": "https://stackoverflow.com/users/2133098/taylor-nichols"}, "edited": false, "score": 0, "creation_date": 1531929883, "post_id": 51406413, "comment_id": 89784070, "body": "If var is known to be 3 in all cases, why can&#39;t the compiler check this at compile time?"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 588, "user_id": 2133098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCzMG.jpg?s=128&g=1", "display_name": "Taylor Nichols", "link": "https://stackoverflow.com/users/2133098/taylor-nichols"}, "edited": false, "score": 0, "creation_date": 1531930320, "post_id": 51406413, "comment_id": 89784352, "body": "@TaylorNichols - this is the suggestion from <code>Ron</code>: make <code>var</code> <code>static constexpr</code> so the value is compile-time known also for not <code>consexpr</code> objects. But if <code>var</code> is a variable; not a constant; you can&#39;t <code>static_assert()</code> a variable."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1531930510, "post_id": 51406413, "comment_id": 89784452, "body": "Perhaps worth noting that already <code>this</code> itself is not constexpr in constructor?"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1531930775, "post_id": 51406413, "comment_id": 89784600, "body": "@Aconcagua - not sure to understand your question but... I suppose that is another aspect of the same problem: <code>this</code> can&#39;t be <code>constexpr</code>, in a <code>constexpr</code> method (also a constructor) because the method can be executed also by not-contexpr objects."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 4, "last_activity_date": 1531930115, "last_edit_date": 1531930115, "creation_date": 1531929525, "answer_id": 51406413, "question_id": 51406232, "link": "https://stackoverflow.com/questions/51406232/using-constexpr-member-in-constructor/51406413#51406413", "title": "Using constexpr member in constructor", "body": "<blockquote>\n  <p>In constexpr constructor every variable should be known at compile time, right?</p>\n</blockquote>\n\n<p>Wrong.</p>\n\n<p>A <code>constexpr</code> constructor is a function (method) that can be executed compile time (in your case, declaring <code>c</code> <code>constexpr</code>) but also run-time (by example, declaring <code>C c2;</code> not <code>constexpr</code>).</p>\n\n<p>So the <code>static_assert()</code> inside the constructor is an error because the compiler can't check it when the constructor is executed run-time.</p>\n\n<p>In other words...\nWhen you use it as follows</p>\n\n<pre><code>constexpr C c;\nstatic_assert(c.var == 3, \"\");\n</code></pre>\n\n<p>can be compiled because <code>c</code> is declared <code>constexpr</code> so the value of <code>c.var</code> is known compile-time.</p>\n\n<p>But </p>\n\n<pre><code>C c2;\nstatic_assert(c2.var == 3, \"\");\n</code></pre>\n\n<p>gives an error because the value of <code>c2.var</code> isn't know compile time.</p>\n\n<p>Writing</p>\n\n<pre><code>constexpr C() { static_assert(var == 3, \"\"); }\n</code></pre>\n\n<p>is asking that the <code>static_assert()</code> is executed in both cases.</p>\n"}, {"tags": [], "owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "is_accepted": false, "score": 1, "last_activity_date": 1531930173, "last_edit_date": 1531930173, "creation_date": 1531930013, "answer_id": 51406546, "question_id": 51406232, "link": "https://stackoverflow.com/questions/51406232/using-constexpr-member-in-constructor/51406546#51406546", "title": "Using constexpr member in constructor", "body": "<p>A <code>constexpr</code>-function, be it ctor, (static) member-function, or free function, is a function which can, assuming appropriate arguments, be evaluated at compile-time.</p>\n\n<p>There is no guarantee any specific call will be evaluated at compile-time, unless it is done in a context needing a compile-time-constant.<br>\nThus, you cannot use any non-<code>static constexpr</code>-members where a compile-time-constant-expression is needed.</p>\n\n<p>Even GCC's <code>__builtin_constant_p()</code>, which allows you more leeway, does not help there for some reason:</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/2aab3b90335b9d04\" rel=\"nofollow noreferrer\">http://coliru.stacked-crooked.com/a/2aab3b90335b9d04</a></p>\n"}], "owner": {"reputation": 1193, "user_id": 5935594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/22667135bcdc2057427f772000a1fc73?s=128&d=identicon&r=PG&f=1", "display_name": "Igor", "link": "https://stackoverflow.com/users/5935594/igor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 51406413, "answer_count": 2, "score": 3, "last_activity_date": 1531930251, "creation_date": 1531929051, "last_edit_date": 1531929718, "question_id": 51406232, "link": "https://stackoverflow.com/questions/51406232/using-constexpr-member-in-constructor", "title": "Using constexpr member in constructor", "body": "<p>I have following code:</p>\n\n<pre><code>struct C {\n    int var = 3;\n};\n</code></pre>\n\n<p>when I use it like this:</p>\n\n<pre><code>constexpr C c;\nstatic_assert(c.var == 3, \"\");\n</code></pre>\n\n<p>everything works fine, however if I would like to do this assert in a <code>constexpr</code> consturctor it fails:</p>\n\n<pre><code>struct C {\n    constexpr C() { static_assert(var == 3, \"\"); }\n    int var = 3;\n};\n</code></pre>\n\n<p>Why this is the case?\nIn <code>constexpr</code> constructor every variable should be known at compile time,  right?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 2, "creation_date": 1531929834, "post_id": 51406186, "comment_id": 89784042, "body": "Please clarify definition of <i>Dalton Board</i>.  My internet search is not showing any physical boards. :-("}, {"owner": {"reputation": 1127, "user_id": 1796858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1b4f442048641cf0656ab4cdc4b6ec?s=128&d=identicon&r=PG", "display_name": "Owl", "link": "https://stackoverflow.com/users/1796858/owl"}, "edited": false, "score": 0, "creation_date": 1531930518, "post_id": 51406186, "comment_id": 89784456, "body": "It&#39;s also known as a Bean Machine. This seems to be its more commonly known name."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1531931362, "post_id": 51406186, "comment_id": 89784935, "body": "Unrelated (and won&#39;t affect the operation of this program, but you might be in for a surprise next time): <code>&#47;&#47;If 2 then R</code> is incorrect. The output of  <code>rand() % 2</code> will be [0,1].. <code>rand() % N</code> will result in [0, N), assuming <code>N &lt;=  RANDMAX +1</code>"}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 0, "creation_date": 1531959603, "post_id": 51406186, "comment_id": 89796905, "body": "<code>columns</code> and <code>j</code> are used to refer to stuff in the <code>dropMarble</code> and <code>printColumns</code> function. Those variables are limited to the function they are declared in, so you can&#39;t use them in <code>main()</code>. Use <code>slot</code> instead."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8235810"}, "is_accepted": false, "score": 0, "last_activity_date": 1531930614, "creation_date": 1531930614, "answer_id": 51406714, "question_id": 51406186, "link": "https://stackoverflow.com/questions/51406186/c-virtual-galton-board/51406714#51406714", "title": "C++ Virtual Galton Board", "body": "<p>Not very sure what you want to achieve but you can try rewriting 2nd for loop like this - </p>\n\n<pre><code> for(int j = 0; j &lt;= numberOfColumns; ++j) {\n        cout &lt;&lt; \"The number of marbles in slot \" &lt;&lt; j &lt;&lt; \" is \" &lt;&lt; slots[j] \n         &lt;&lt; endl;\n\n       dropMarble(slots, numberOfColumns);\n\n        printColumns(slots, numberOfColumns);\n  }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8748990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef718840f138f5633e16f35e85257c7e?s=128&d=identicon&r=PG&f=1", "display_name": "1st timer", "link": "https://stackoverflow.com/users/8748990/1st-timer"}, "edited": false, "score": 0, "creation_date": 1531961598, "post_id": 51406993, "comment_id": 89797302, "body": "So when I run your code it outputs the data multiple times.  How do I stop this and just have it output it once?"}, {"owner": {"reputation": 1127, "user_id": 1796858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1b4f442048641cf0656ab4cdc4b6ec?s=128&d=identicon&r=PG", "display_name": "Owl", "link": "https://stackoverflow.com/users/1796858/owl"}, "reply_to_user": {"reputation": 11, "user_id": 8748990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef718840f138f5633e16f35e85257c7e?s=128&d=identicon&r=PG&f=1", "display_name": "1st timer", "link": "https://stackoverflow.com/users/8748990/1st-timer"}, "edited": false, "score": 0, "creation_date": 1531995742, "post_id": 51406993, "comment_id": 89811185, "body": "I&#39;ve modified the code, all you need to do is move the inner for loop after the outer for loop, and also move printColumns function out also!"}], "tags": [], "owner": {"reputation": 1127, "user_id": 1796858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1b4f442048641cf0656ab4cdc4b6ec?s=128&d=identicon&r=PG", "display_name": "Owl", "link": "https://stackoverflow.com/users/1796858/owl"}, "is_accepted": false, "score": 0, "last_activity_date": 1531996308, "last_edit_date": 1531996308, "creation_date": 1531931633, "answer_id": 51406993, "question_id": 51406186, "link": "https://stackoverflow.com/questions/51406186/c-virtual-galton-board/51406993#51406993", "title": "C++ Virtual Galton Board", "body": "<p>Is this what you're trying to do?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;ctime&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\n//Decide a L or R direction at random\nbool dropMarble()\n{\n  if(rand() % 2)\n    {\n      return false;\n    }\n  else\n    {\n      return true;\n    }\n}\n\nvoid dropMarble(vector&lt;int&gt; &amp;columns, int cols)\n{\n  int i = 0, j = 0;\n  bool GoneRight=true;\n\n  while((i + j) != cols)\n    {\n      GoneRight = dropMarble();\n\n      if(GoneRight)\n        {\n      //Marble goes right\n      ++j;\n        }\n\n      else\n        {\n      //Marble goes left\n      // i is height small i is high, large i is low\n      ++i;\n        }\n    }\n\n  //Increment the count of marbles in the columns\n  ++columns[j];\n}\n\nvoid printColumns(vector&lt;int&gt; &amp;columns, int cols)\n{\n  for(int i = 0; i&lt; cols; ++i)\n    {\n      cout &lt;&lt; columns[i] &lt;&lt; \"\";\n    }\n  cout &lt;&lt; endl;\n}\n\nint main()\n{\n  srand(time(NULL));\n  int numberOfMarbles;\n  int numberOfColumns = 8;\n  vector&lt;int&gt; slots;\n  slots.resize(8);\n\n  //    int columns[numberOfColumns];\n\n  //Initialize the count of marbles in the columns to zero\n  for(int i = 1; i &lt;= numberOfColumns; ++i)\n    {\n      slots[i] = 0;\n    }\n  cout &lt;&lt; \"Enter the number of marbles to drop: \" &lt;&lt; endl;\n  cin &gt;&gt; numberOfMarbles;\n\n  for(int i = 1; i &lt;= numberOfMarbles; ++i)\n  {    \n      dropMarble(slots, numberOfColumns);\n  }\n\n  for(int j = 0; j&lt;numberOfColumns;++j){\n    cout &lt;&lt; \"The number of marbles in slot \" &lt;&lt; j &lt;&lt; \" is \" &lt;&lt; slots[j] \n     &lt;&lt; endl;\n  }\n\n  printColumns(slots, numberOfColumns);\n  return 0;\n}\n</code></pre>\n\n<p>With a 1000 marbles:</p>\n\n<pre><code>The number of marbles in slot 0 is 7\nThe number of marbles in slot 1 is 30\nThe number of marbles in slot 2 is 100\nThe number of marbles in slot 3 is 213\nThe number of marbles in slot 4 is 262\nThe number of marbles in slot 5 is 225\nThe number of marbles in slot 6 is 122\nThe number of marbles in slot 7 is 34\n\n73010021326322512234\n</code></pre>\n\n<p>Interesting idea. The key change really is to pass by reference a vector. You don't have to use a vector, you could parse an array via a pointer that would work also. </p>\n\n<p>The other thing was to change the marble printing logic so it's in its own loop, and also to parse the number of columns rather than the number of marbles to your other functions. </p>\n"}], "owner": {"reputation": 11, "user_id": 8748990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef718840f138f5633e16f35e85257c7e?s=128&d=identicon&r=PG&f=1", "display_name": "1st timer", "link": "https://stackoverflow.com/users/8748990/1st-timer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 675, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1532005242, "creation_date": 1531928907, "last_edit_date": 1532005242, "question_id": 51406186, "link": "https://stackoverflow.com/questions/51406186/c-virtual-galton-board", "title": "C++ Virtual Galton Board", "body": "<p>I have gotten this far in creating my Galton Board but fail to understand how to fix my code in regards to j and columns[j] not being in the main scope.  I understand I have not declared them in the main function but not sure how to properly do so to obtain my results.  </p>\n\n<p>How do I get this fixed so that it outputs what my intentions are?  </p>\n\n<p>My intentions are simply when the code runs to output my data like so:</p>\n\n<p>The number of marbles in slot 0 is 2.\nThe number of marbles in slot 1 is 4.\nand so forth up to 7.</p>\n\n<p>Here is the code I have:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;ctime&gt;\nusing namespace std;\n\n//Decide a L or R direction at random\nchar dropMarble()\n{\n    //If 1 then L\n    if(rand() % 2)\n    {\n        return 'L';\n    }\n\n    //If 2 then R\n    else\n    {\n        return 'R';\n    }\n}\n\nvoid dropMarble(int columns[], int cols)\n{\n    int i = 0, j = 0;\n    char LorR;\n\n    while((i + j) != cols)\n    {\n        LorR = dropMarble();\n\n        if(LorR == 'R')\n        {\n        //Marble goes right\n             ++j;\n        }\n\n        else\n        {\n        //Marble goes left\n            ++i;\n        }\n    }\n\ncout &lt;&lt; endl;\n\n//Increment the count of marbles in the columns\n\n++columns[j];\n}\n\nvoid printColumns(int columns[], int cols)\n{\n    for(int i = 0; i&lt; cols; ++i)\n    {\n         cout &lt;&lt; columns[i] &lt;&lt; \"\";\n    }\n    cout &lt;&lt; endl;\n}\n\nint main()\n{\n    srand(time(NULL));\n    int numberOfMarbles;\n    int numberOfColumns = 8;\n    int slots[numberOfColumns];\n\n    //Initialize the count of marbles in the columns to zero\n    for(int i = 1; i &lt;= numberOfColumns; ++i)\n    {\n        slots[i] = 0;\n    }\n    cout &lt;&lt; \"Enter the number of marbles to drop: \" &lt;&lt; endl;\n    cin &gt;&gt; numberOfMarbles;\n\n    for(int i = 1; i &lt;= numberOfMarbles; ++i)\n    {\n        cout &lt;&lt; \"The number of marbles in slot \" &lt;&lt; j &lt;&lt; \" is \" &lt;&lt; columns[j] \n         &lt;&lt; endl;\n\n        dropMarble(slots, numberOfMarbles);\n\n        printColumns(slots, numberOfMarbles);\n     }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "sqlite", "type-conversion"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1531930465, "post_id": 51406142, "comment_id": 89784435, "body": "Use a <a href=\"https://www.sqlite.org/c3ref/stmt.html\" rel=\"nofollow noreferrer\">prepared statement</a> and bind your dynamic arguments depending on their type, then execute the statement. The binder sorts out what do to with the data, and more importantly, safely forms the statement and avoid sql injection risks. This is the universal preference for sql back-ends that support it (most do, including sqlite)."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1531942659, "post_id": 51406142, "comment_id": 89790947, "body": "You cannot create a <code>char*</code> in a particular format; it&#39;s up to the compiler to determine how a <code>char*</code> is represented. Your question is about an <b>array of <code>char</code></b>, which is not the same as a pointer to <code>char</code>."}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 8997005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96419829db8a57b0989928489a07b229?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Peedah", "link": "https://stackoverflow.com/users/8997005/daniel-peedah"}, "is_accepted": false, "score": 0, "last_activity_date": 1531944068, "creation_date": 1531944068, "answer_id": 51410133, "question_id": 51406142, "link": "https://stackoverflow.com/questions/51406142/creating-a-char-of-specific-format-with-specific-values/51410133#51410133", "title": "Creating a char* of specific format with specific values", "body": "<p>The comment left by whozcraig solved my question, I must use a prepared statement to feed my values to the statement</p>\n"}], "owner": {"reputation": 151, "user_id": 8997005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96419829db8a57b0989928489a07b229?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Peedah", "link": "https://stackoverflow.com/users/8997005/daniel-peedah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531944068, "creation_date": 1531928775, "question_id": 51406142, "link": "https://stackoverflow.com/questions/51406142/creating-a-char-of-specific-format-with-specific-values", "title": "Creating a char* of specific format with specific values", "body": "<p>I am attempting to create a char* type in a specific format, using values given by the other areas of the program, the values within the VALUES() brackets are the values that are given by the program.\nThe format should look like so:</p>\n\n<pre><code>  char* sql = \"INSERT INTO RecurringEvents (title,description,duration,recurtype,startfrom,endingtype,dateend,occurences,venueid) \"  \\\n         \"VALUES ('title','description','duration','recurtype','startfrom','endingtype','dateend',occurences,venueid); \"\n</code></pre>\n\n<p>As you can see, text values must be within '  ' punctuation, while int values are left alone, so a usual command may be like so:</p>\n\n<pre><code>\"INSERT INTO RecurringEvents (title,description,duration,recurtype,startfrom,endingtype,dateend,occurences,venueid) \"  \\\n     \"VALUES ('thetitle','thedesc','theduration','recurtype','startfrom','enddddtype','dateend',2,4); \";\n</code></pre>\n\n<p>The function in which this is required is below,not that it all matters, but to explain, it converts the event's(class) data all into string/int values, so they can be used to form an INSERT command(this is the proble), and then executed on a database, once this is done (and the record is verified for plausability) its added to the vector and the database is closed.</p>\n\n<pre><code>void addRecEvent(newRecurringEvent event, vector &lt;newRecurringEvent&gt; &amp;events){\n    sqlite3 *db;\n    int rc;\n    char *sql;\n    int tableCheck;\n    char *zErrMsg = 0;\n    rc = sqlite3_open(\"data.sqlite\", &amp;db);\n    string title = event.getTitle();\n    string description = event.getDescription();\n    string duration = to_string(event.getDuration());\n    string recurType = recToString(event.getRecurType());\n    string startfrom = to_string( event.getStartFrom());\n    string endingtype = etypeToStr(event.getEndingType());\n    string dateend = to_string(event.getDateEnd());\n    int occurences = event.getOccurences();\n    int venueid = event.getVenuid();\n    /*CREATE INSERT COMMAND USING char*sql  IN FORMAT REQUIRED*/\n    rc = sqlite3_exec(db, sql, callback, 0, &amp;zErrMsg); //execute the command\n    if (rc != SQLITE_OK){\n        cout &lt;&lt; stderr &lt;&lt; \"SQL error: %s \\n\", zErrMsg;\n\n    }\n    else{\n        cout &lt;&lt; stdout &lt;&lt; \"Records created succesfully\";\n        events.push_back(event);\n    }\n    sqlite3_close(db);\n\n\n}\n</code></pre>\n\n<p>I once attempted to create the format all in string within another function (by passing the values to it), and then returning it as a char*, but came accross the problem of the single quotation marks used on the text fields (like title,description etc).</p>\n\n<p>Sorry if any of this is confusing, but to make it short, I just want to form a character sequence in the format in the first snippet of code, that uses given values to form its sequence.Any help is appreciated, as I am new to c++.</p>\n"}, {"tags": ["c++", "deep-copy", "shallow-copy"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1531928552, "post_id": 51406033, "comment_id": 89783130, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, we have no idea how your class looks like"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 3, "creation_date": 1531928592, "post_id": 51406033, "comment_id": 89783154, "body": "C++ really doesn&#39;t have the concept of deep or shallow copies, just the concept of semantically correct copies for a particular class."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 1, "creation_date": 1531928829, "post_id": 51406033, "comment_id": 89783308, "body": "@NeilButterworth Unless academia steps in. Then all bets are off."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1531929521, "post_id": 51406033, "comment_id": 89783810, "body": "The default copy constructor copies the contents of variables, nothing more, nothing less.  If you have a copy constructor, then the code in the copy constructor is executed."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1531930190, "post_id": 51406033, "comment_id": 89784256, "body": "Tightly related: <a href=\"https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three\">What is the Rule of Three?</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1531930480, "post_id": 51406033, "comment_id": 89784440, "body": "More details on how <code>{1,2,3}</code> is being stored in <code>v1</code> is required to provide a complete answer."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1531930295, "post_id": 51406148, "comment_id": 89784332, "body": "Note that this means if your class contains a pointer, the pointer and only the pointer is copied. You now have two objects pointing to the same thing. Depending on the ownership of this pointed-at thing, this may be bad."}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": false, "score": 9, "last_activity_date": 1531928782, "creation_date": 1531928782, "answer_id": 51406148, "question_id": 51406033, "link": "https://stackoverflow.com/questions/51406033/default-constructor-in-cpp-shallow-or-deep-copy/51406148#51406148", "title": "Default constructor in cpp shallow or deep copy?", "body": "<p>It doesn't do either. It does a <em>memberwise</em> copy. I.e. it copies all the members of the class using their copy constructors. If those members have copy constructors that do a deep copy then you'll get a deep copy, if they do a shallow copy then you'll get a shallow copy, or they could do something else entirely.</p>\n\n<p>Deep copy and shallow copy are not C++ concepts, instead C++ lets you do a deep or shallow copy as you prefer.</p>\n"}, {"comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1531931136, "post_id": 51406203, "comment_id": 89784800, "body": "This was probably downvoted because it is unclear to someone unused to C++&#39;s ability to have complex objects with value semantics.  To improve I&#39;d advise elaborating about value/reference (and pointer) semantics, how member semantics impacts default semantics of a type, and how that flows back into deep/shallow conxept.  Because everything you said is true, but I suspect not useful to the OP as written.  Meh, maybe I&#39;ll just answer."}, {"owner": {"reputation": 49, "user_id": 10100602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EC21_pKnJV8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rQEMV6fmkwOxYysLntWXcib1Urtw/mo/photo.jpg?sz=128", "display_name": "Robin Khurana ", "link": "https://stackoverflow.com/users/10100602/robin-khurana"}, "edited": false, "score": 0, "creation_date": 1531935514, "post_id": 51406203, "comment_id": 89787177, "body": "You said &quot;There is no difference between a shallow copy, and deep copy of a value type&quot;, what does it mean? as they share the same memory (shallow copy) as this is the assignment operator."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 49, "user_id": 10100602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EC21_pKnJV8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rQEMV6fmkwOxYysLntWXcib1Urtw/mo/photo.jpg?sz=128", "display_name": "Robin Khurana ", "link": "https://stackoverflow.com/users/10100602/robin-khurana"}, "edited": false, "score": 0, "creation_date": 1531935720, "post_id": 51406203, "comment_id": 89787288, "body": "@RobinKhurana It means that there is only one kind of copying of value types - there is no distinction between shallow and deep copy for them. <code>as they share the same memory</code> What share the same memory?"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": -1, "last_activity_date": 1531928977, "creation_date": 1531928977, "answer_id": 51406203, "question_id": 51406033, "link": "https://stackoverflow.com/questions/51406033/default-constructor-in-cpp-shallow-or-deep-copy/51406203#51406203", "title": "Default constructor in cpp shallow or deep copy?", "body": "<p>The implicitly generated copy constructor (and assignment operator) performs a shallow copy.</p>\n\n<p>There is no difference between a shallow copy, and deep copy of a value type.</p>\n\n<blockquote>\n  <p>now if I have done v2[0]=1; It does not get reflected</p>\n</blockquote>\n\n<p>There is no reason to expect such operation to <em>get reflected</em> unless the type of <code>v2</code> is a referential type.</p>\n"}, {"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 2, "last_activity_date": 1531941917, "last_edit_date": 1531941917, "creation_date": 1531932087, "answer_id": 51407097, "question_id": 51406033, "link": "https://stackoverflow.com/questions/51406033/default-constructor-in-cpp-shallow-or-deep-copy/51407097#51407097", "title": "Default constructor in cpp shallow or deep copy?", "body": "<p>Your question is the wrong question.</p>\n\n<p>First, C++ default copy/assign is memberwise; it recursively copies/assigns based on what the members do.</p>\n\n<p>Well designed C++ types follow a few patterns in what they do when copied/assigned that lines up with 3 different kinds of primitive types; value, reference amd pointer semantics.</p>\n\n<p>A value semantics type behaves like a value.  This corresponds to your \"deep copy\" roughly.  Modifying one variable that follows value semantics never changes another.  <code>std::vector</code> is a value semantics type, as is <code>int</code>, <code>double</code>, <code>std::string</code> and other <code>std</code> container types.  Value semantics are a strong pattern, and make reasoning about program behaviour easy.  Note that value semantics need not be implemented as values; vector is typically implemented as a triple of pointers, with construction/copying/etc overloaded.</p>\n\n<p>A reference semantics type behaves like a C++ reference type -- <code>int&amp;</code>.  This is not the same as a Java/C# reference.  C++ references are aliases;  <code>int&amp; a=b;</code> means <code>a</code> is another name for <code>b</code>.  Then <code>a=7</code> makes both <code>a</code> and <code>b</code> equal <code>7</code>.  If you had another reference <code>c</code>, <code>a=c</code> would <em>not</em> rebind <code>a</code> to refer to <code>c</code>; it would change what <code>a</code> referred to to have the same value as what <code>c</code> referred to.</p>\n\n<p>Complex objects with reference semantics are rare.</p>\n\n<p>A pointer semantics is like reference semantics, but assignment rebinds who it points to.  Sometimes an additional operation, like <code>&amp;</code>, is needed to create a new pointer.  A type with pointer semantics includes <code>std::reference_wrapper</code>, <code>std::string_view</code>, <code>std::shared_ptr&lt;double&gt;</code>, <code>gsl::span&lt;char&gt;</code> and <code>int*</code>.</p>\n\n<p>Typically it is a bad idea to mix members with different semantics in the same type; the rule of 0/3/5 states that the best move/copy/assogn/ctor/dtor is the empty one.  Your resource management types use RAII and write those special members, the other types aggregate them.  Value semantics types are not used mixed with reference/pointer in order for the composite class to get coherant semantics.</p>\n\n<p>TL;DR: it depends.  Read the documentation on your members.  Document what semantics your types have so users know what to expect.</p>\n\n<p>Note, however, that reference semantics is incompatible with being stored in a std container.</p>\n"}], "owner": {"reputation": 49, "user_id": 10100602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EC21_pKnJV8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rQEMV6fmkwOxYysLntWXcib1Urtw/mo/photo.jpg?sz=128", "display_name": "Robin Khurana ", "link": "https://stackoverflow.com/users/10100602/robin-khurana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1308, "favorite_count": 1, "answer_count": 3, "score": 3, "last_activity_date": 1531941917, "creation_date": 1531928444, "last_edit_date": 1531929073, "question_id": 51406033, "link": "https://stackoverflow.com/questions/51406033/default-constructor-in-cpp-shallow-or-deep-copy", "title": "Default constructor in cpp shallow or deep copy?", "body": "<p>Does the default copy-constructor do a shallow or a deep copy in C++?</p>\n\n<p>I am really confused with default copy constructor in cpp, as it does shallow copy or deep copy,  as when I did <code>v2=v1;</code> suppose <code>v1={1,2,3}</code>, now if I have done <code>v2[0]=1;</code> It does not get reflected but I heard it does shallow copy, can anybody please explain?</p>\n"}, {"tags": ["c++", "parameters", "arguments", "function-pointers", "typedef"], "comments": [{"owner": {"reputation": 659, "user_id": 5229875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWrD6.png?s=128&g=1", "display_name": "MivVG", "link": "https://stackoverflow.com/users/5229875/mivvg"}, "edited": false, "score": 0, "creation_date": 1531928221, "post_id": 51405920, "comment_id": 89782919, "body": "You can&#39;t declare a function like that. Typedefs with functions are for function pointers/references."}, {"owner": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "edited": false, "score": 0, "creation_date": 1531928251, "post_id": 51405920, "comment_id": 89782937, "body": "what would you expect <code>cout &lt;&lt; arg &lt;&lt; endl;</code> to print ?"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 1, "creation_date": 1531928252, "post_id": 51405920, "comment_id": 89782938, "body": "<code>FOO</code> is a function pointer. What is <code>FOO foo { &#47;* statements *&#47; }</code> supposed to mean?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1531928359, "post_id": 51405920, "comment_id": 89782996, "body": "This question doesn&#39;t make any sense.  <code>FOO</code> is a typedef to a function pointer.  It is not a short way to write <code>void FOO(const int arg)</code>"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "edited": false, "score": 0, "creation_date": 1531928378, "post_id": 51405920, "comment_id": 89783015, "body": "@Tyker I was trying to use it to define a function. So I would expect it to print whatever was passed into the defined function. For example: I&#39;d hope this could be called like <code>foo(13)</code>"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1531928518, "post_id": 51405920, "comment_id": 89783103, "body": "@NathanOliver Obviously this doesn&#39;t work, I give the error in the question. I&#39;m going to have a ton of functions who&#39;s definitions must match this <code>typedef</code> I was wondering if there was a way that I could enforce that."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1531928675, "post_id": 51405920, "comment_id": 89783208, "body": "Depends on how you use them.  You might be able to use some sort of interface that uses a compile time check to make sure the function has the right signature.  As an aside, how would you have named the different functions if this actually worked?"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 659, "user_id": 5229875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWrD6.png?s=128&g=1", "display_name": "MivVG", "link": "https://stackoverflow.com/users/5229875/mivvg"}, "edited": false, "score": 0, "creation_date": 1531928714, "post_id": 51405920, "comment_id": 89783223, "body": "@MivVG I understand that... Obviously with the error. I&#39;m just trying to keep the <code>typedef</code> and the function signature in sync. Is there a way to do that?"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1531928842, "post_id": 51405920, "comment_id": 89783313, "body": "@NathanOliver I mean, I was hoping for some syntax where I could just do <code>FOO foo{}</code>, <code>FOO bar{}</code>, and so on. Again I get that this doesn&#39;t work. I was just hoping someone could suggest an alternative."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1531928928, "post_id": 51405920, "comment_id": 89783379, "body": "@Ron perhaps I misunderstand? How would that assist with specifying function signatures?"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1531929062, "post_id": 51405920, "comment_id": 89783466, "body": "@PasserBy I mean that&#39;s obviously bad syntax, I&#39;m just trying to give an example of what I want to do. I&#39;d like to be able to use the signature specified in the <code>typedef</code> to specify a function signature as I define it."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1531928372, "post_id": 51405993, "comment_id": 89783009, "body": "Well, it may have <i>something</i> to do with it - for example, this <code>FOO f();</code> is perfectly valid function declaration."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 3, "creation_date": 1531928521, "post_id": 51405993, "comment_id": 89783104, "body": "@NeilButterworth How vexing :)"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1531929285, "post_id": 51405993, "comment_id": 89783614, "body": "On the contrary, obviously a function pointer can only address a function with a matching signature, so there is a direct correlation. I&#39;m trying to find a way to define a function according to the corresponding function signature."}], "tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": false, "score": 1, "last_activity_date": 1531928288, "creation_date": 1531928288, "answer_id": 51405993, "question_id": 51405920, "link": "https://stackoverflow.com/questions/51405920/is-there-a-way-to-use-the-parameter-names-from-a-typedef/51405993#51405993", "title": "Is There a way to use the Parameter Names from a typedef", "body": "<p>The definition of a function pointer has nothing to do with the declaration nor the definition of a function so the answer is no. </p>\n"}, {"comments": [{"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1531929345, "post_id": 51406273, "comment_id": 89783665, "body": "Well... Not what I was hoping for but at least it tries to answer the question +1."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 1, "creation_date": 1531929414, "post_id": 51406273, "comment_id": 89783728, "body": "@JonathanMee Thanks.  This is the best I can think of right now for what you are actually trying to accomplish.  If I think of something else I&#39;ll add it to the answer and ping you."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1531929645, "post_id": 51406273, "comment_id": 89783908, "body": "I&#39;ve tried to clean up the question to make more clear that this is the best answer... But who knows? I seem to have really failed on this question."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 2, "last_activity_date": 1531930012, "last_edit_date": 1531930012, "creation_date": 1531929154, "answer_id": 51406273, "question_id": 51405920, "link": "https://stackoverflow.com/questions/51405920/is-there-a-way-to-use-the-parameter-names-from-a-typedef/51406273#51406273", "title": "Is There a way to use the Parameter Names from a typedef", "body": "<p>What you are trying to do will not work.  <code>FOO</code> is an alias for <code>void(*)(const int)</code>. so</p>\n\n<pre><code>FOO foo {\n    cout &lt;&lt; arg &lt;&lt; endl;\n}\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>void(*)(const int) foo {\n    cout &lt;&lt; arg &lt;&lt; endl;\n}   \n</code></pre>\n\n<p>and that just doesn't work.  What you can do though is define a macro that takes a name and use that to stamp out a function signature.  That would look like</p>\n\n<pre><code>#define MAKE_FUNCTION(NAME) void NAME(const int arg)\n\nMAKE_FUNCTION(foo){ std::cout &lt;&lt; arg * 5 &lt;&lt; \"\\n\"; }\n\nMAKE_FUNCTION(bar){ std::cout &lt;&lt; arg * 10 &lt;&lt; \"\\n\"; }\n\nint main()\n{\n    foo(1);\n    bar(2);\n}\n</code></pre>\n"}], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1531930012, "creation_date": 1531928054, "last_edit_date": 1531929565, "question_id": 51405920, "link": "https://stackoverflow.com/questions/51405920/is-there-a-way-to-use-the-parameter-names-from-a-typedef", "title": "Is There a way to use the Parameter Names from a typedef", "body": "<p>So given a <code>typedef</code> that defines a function pointer with parameter names like this:</p>\n\n<pre><code>typedef void(*FOO)(const int arg);\n</code></pre>\n\n<p>Is there a way that I can just use this function pointer to define the signature of my function? Obviously this won't work, but I'd like to somehow use the <code>typedef</code> to specify a function signature with a corresponding type:</p>\n\n<pre><code>FOO foo {\n    cout &lt;&lt; arg &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Again, I know this doesn't work, and is bad syntax. It will just give the error:</p>\n\n<blockquote>\n  <p>error: <code>arg</code> was not declared in this scope</p>\n</blockquote>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1531930267, "post_id": 51405816, "comment_id": 89784312, "body": "Start from the innermost expression and work outwards."}], "answers": [{"tags": [], "owner": {"reputation": 148466, "user_id": 2319407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/98O16.jpg?s=128&g=1", "display_name": "Dmitry Bychenko", "link": "https://stackoverflow.com/users/2319407/dmitry-bychenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1531927892, "creation_date": 1531927892, "answer_id": 51405862, "question_id": 51405816, "link": "https://stackoverflow.com/questions/51405816/equation-given-x-x8-355-solve-the-above-equation-using-assignment/51405862#51405862", "title": "Equation Given : x = (((x+8)/3)%5)*5; solve the above equation&#160;using assignment operators (eg. +=, -=, *=)", "body": "<p>Technically, you can convert a single readable formula</p>\n\n<pre><code> x = (((x + 8) / 3) % 5) * 5;\n</code></pre>\n\n<p>into <em>four</em> ones:</p>\n\n<pre><code> x += 8;\n x /= 3;\n x %= 5;\n x *= 5; \n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10100550, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YDL395G8vAo/AAAAAAAAAAI/AAAAAAAAALU/qCI-N5PGJco/photo.jpg?sz=128", "display_name": "Nagarjun rao", "link": "https://stackoverflow.com/users/10100550/nagarjun-rao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "closed_date": 1531927899, "answer_count": 1, "score": -4, "last_activity_date": 1531928011, "creation_date": 1531927749, "last_edit_date": 1531928011, "question_id": 51405816, "link": "https://stackoverflow.com/questions/51405816/equation-given-x-x8-355-solve-the-above-equation-using-assignment", "closed_reason": "Needs more focus", "title": "Equation Given : x = (((x+8)/3)%5)*5; solve the above equation&#160;using assignment operators (eg. +=, -=, *=)", "body": "<p>Equation Given :\u00a0\u00a0</p>\n\n<pre><code>x = (((x+8)/3)%5)*5;\n</code></pre>\n\n<p>solve the above equation\u00a0using <em>assignment operator</em>s (eg. <code>+=</code>, <code>-=</code>, <code>*=</code>).</p>\n\n<p>Can someone help with this c++ problem? \nsorry if this a dumb question</p>\n"}, {"tags": ["c++", "string", "string-literals"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 9, "creation_date": 1531927407, "post_id": 51405664, "comment_id": 89782375, "body": "The language would be kind of limiting if you couldn&#39;t have <code>&quot;&#47;&#47;&quot;</code> in a string literal"}, {"owner": {"reputation": 15376, "user_id": 588916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b9737fb0439f70903f8948ad3963d9cc?s=128&d=identicon&r=PG", "display_name": "collapsar", "link": "https://stackoverflow.com/users/588916/collapsar"}, "edited": false, "score": 2, "creation_date": 1531927413, "post_id": 51405664, "comment_id": 89782383, "body": "You use the comment prefix within string <i>literal</i>, which means that the compiler treats that portion of the source code as an opaque piece of text."}], "answers": [{"comments": [{"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 2, "creation_date": 1531932014, "post_id": 51405794, "comment_id": 89785347, "body": "Addendum, as of C++11 allows <code>unique_ptr&lt;vector&lt;int&gt;&gt;</code> without needing a space between the last two <code>&gt;&gt;</code>.  That&#39;s a violation of the maximal munch policy that otherwise is the norm.  I believe the allowance is generally considered a good idea, but I&#39;m sure there is a contingent that is unhappy with the change."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 8, "last_activity_date": 1531928552, "last_edit_date": 1531928552, "creation_date": 1531927672, "answer_id": 51405794, "question_id": 51405664, "link": "https://stackoverflow.com/questions/51405664/why-does-in-a-string-does-not-start-a-comment-in-c/51405794#51405794", "title": "Why does // in a string does not start a comment in C++?", "body": "<p>For an in depth analysis of this, you'd have to refer to the language grammar, and the string literal production rules in particular.</p>\n\n<p>Informally speaking, the fact that <code>//</code> appears in the quoted string literal means that it does not denote a comment block. The same applies to <code>/*</code> and <code>*/</code>.</p>\n\n<p>The converse applies to other constructs, where <em>maximal munch</em> requires parsing into the token denoting the start of a comment block; a space is needed before the pointer dereference operator in</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main() {\n    int n = 1;\n    int* p = &amp;n;\n    cout &lt;&lt; 1 / *p; // Removing the final space will fail compilation.\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 11, "last_activity_date": 1531927745, "creation_date": 1531927745, "answer_id": 51405812, "question_id": 51405664, "link": "https://stackoverflow.com/questions/51405664/why-does-in-a-string-does-not-start-a-comment-in-c/51405812#51405812", "title": "Why does // in a string does not start a comment in C++?", "body": "<p>The grammar of C++ (like most of programming languages) is context-sensitive. Simply, <code>//</code> does not start a comment if it is within a string literal.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6951576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fddd5f41e28c9e19546467e119a545a4?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/6951576/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1531946965, "creation_date": 1531946965, "answer_id": 51410778, "question_id": 51405664, "link": "https://stackoverflow.com/questions/51405664/why-does-in-a-string-does-not-start-a-comment-in-c/51410778#51410778", "title": "Why does // in a string does not start a comment in C++?", "body": "<p>In easy terms, This is because everything inside quotes is recognized as a string and so the computer does not evaluate // as the way to start a comment.</p>\n"}], "owner": {"reputation": 155, "user_id": 9057615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9c4f3ea0e76ee3059357971dbb6aa13?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Chaudhary", "link": "https://stackoverflow.com/users/9057615/nishant-chaudhary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 3, "score": 7, "last_activity_date": 1531946965, "creation_date": 1531927243, "last_edit_date": 1531927539, "question_id": 51405664, "link": "https://stackoverflow.com/questions/51405664/why-does-in-a-string-does-not-start-a-comment-in-c", "title": "Why does // in a string does not start a comment in C++?", "body": "<p>I am printing a line like this</p>\n\n<pre><code>cout&lt;&lt;\"Hello //stackoverflow\";\n</code></pre>\n\n<p>And this produces the following output</p>\n\n<pre><code>Hello //stackoverflow\n</code></pre>\n\n<p>I want to know why it does not give me an error as I commented half of the statement and there should be</p>\n\n<pre><code>missing terminating \" character\n</code></pre>\n\n<p>error.</p>\n"}, {"tags": ["c++", "visual-studio", "visual-c++", "visual-studio-2017", "atl"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1531927611, "post_id": 51405647, "comment_id": 89782509, "body": "SelectFont() is not a macro.  Unless you got the #include order wrong and got windowsx.h included first.  We can&#39;t see it."}, {"owner": {"reputation": 13842, "user_id": 2790621, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/b7bSs.jpg?s=128&g=1", "display_name": "xMRi", "link": "https://stackoverflow.com/users/2790621/xmri"}, "edited": false, "score": 0, "creation_date": 1531938887, "post_id": 51405647, "comment_id": 89788991, "body": "Show us what you included to the file... for me it looks like a simple syntax error at the top of you cpp file or any of the first headers"}], "answers": [{"comments": [{"owner": {"reputation": 1105, "user_id": 320881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb54fab6422dafe7d7eb33508b5f85a1?s=128&d=identicon&r=PG", "display_name": "netcat", "link": "https://stackoverflow.com/users/320881/netcat"}, "edited": false, "score": 1, "creation_date": 1552586615, "post_id": 51410709, "comment_id": 97077880, "body": "Thanks for posting this. I had the same problem and this fixed it in MFC."}], "tags": [], "owner": {"reputation": 535, "user_id": 876880, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/058ece570a12dec6fae64f96f39cb112?s=128&d=identicon&r=PG", "display_name": "Mr. Awesome", "link": "https://stackoverflow.com/users/876880/mr-awesome"}, "is_accepted": false, "score": 0, "last_activity_date": 1531946698, "creation_date": 1531946698, "answer_id": 51410709, "question_id": 51405647, "link": "https://stackoverflow.com/questions/51405647/adding-new-dialog-to-legacy-c-app-vs2017-results-in-many-errors-why/51410709#51410709", "title": "Adding new Dialog to legacy C++ app (VS2017) results in many errors. Why?", "body": "<p>I moved the #include \"afxcontrolbars.h\" before any other afx includes and this resolved this issue. </p>\n"}], "owner": {"reputation": 535, "user_id": 876880, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/058ece570a12dec6fae64f96f39cb112?s=128&d=identicon&r=PG", "display_name": "Mr. Awesome", "link": "https://stackoverflow.com/users/876880/mr-awesome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531946698, "creation_date": 1531927193, "question_id": 51405647, "link": "https://stackoverflow.com/questions/51405647/adding-new-dialog-to-legacy-c-app-vs2017-results-in-many-errors-why", "title": "Adding new Dialog to legacy C++ app (VS2017) results in many errors. Why?", "body": "<p>This is a legacy C++ app. It's been ported from VS 6.0, to VS2015, and now to VS2017. In 2017, I add a dialog via the menus/resource wizards. The act of this dialog causes all kinds of issues with ATL. (Error examples below...)</p>\n\n<pre><code>   c:\\program files (x86)\\microsoft visual studio\\2017\\professional\\vc\\tools\\msvc\\14.14.26428\\atlmfc\\include\\afxbutton.h(184): warning C4003: not enough actual parameters for macro 'SelectFont'\n\\afxbutton.h(184): error C2146: syntax error: missing ')' before identifier 'SelectObject'\n\\afxbutton.h(184): error C3646: 'SelectObject': unknown override specifier\n\\afxbutton.h(184): error C2146: syntax error: missing ')' before identifier 'pDC'\n\\afxbutton.h(184): error C2065: 'pDC': undeclared identifier\n\\afxbutton.h(184): error C2096: 'HFONT': A data member cannot be initialized with a parenthesized initializer\n\\afxbutton.h(184): error C2433: 'CMFCButton::HFONT': 'virtual' not permitted on data declarations\n\\afxbutton.h(184): error C2131: expression did not evaluate to a constant\n\\afxbutton.h(184): note: failure was caused by non-constant arguments or reference to a non-constant symbol\n\\afxbutton.h(184): note: see usage of 'pDC'\n\\afxbutton.h(184): error C2327: 'CMFCButton::HFONT': is not a type name, static, or enumerator\n\\afxbutton.h(184): error C2059: syntax error: ')'\n\\afxbutton.h(184): error C2091: function returns function\n\\afxbutton.h(203): error C2327: 'CMFCButton::HFONT': is not a type name, static, or enumerator\n\\afxfontcombobox.h(45): warning C4003: not enough actual parameters for macro 'SelectFont'\n\\afxfontcombobox.h(45): error C2146: syntax error: missing ')' before identifier 'SelectObject'\n\\afxfontcombobox.h(45): error C3646: 'SelectObject': unknown override specifier\n\\afxfontcombobox.h(45): error C2146: syntax error: missing ')' before identifier 'pDesc'\n\\afxfontcombobox.h(45): error C2065: 'pDesc': undeclared identifier\n\\afxfontcombobox.h(45): error C2096: 'HFONT': A data member cannot be initialized with a parenthesized initializer\n\\afxfontcombobox.h(45): error C2131: expression did not evaluate to a constant\n\\afxfontcombobox.h(45): note: failure was caused by non-constant arguments or reference to a non-constant symbol\n\\afxfontcombobox.h(45): note: see usage of 'pDesc'\n\\afxfontcombobox.h(45): error C2327: 'CMFCFontComboBox::HFONT': is not a type name, static, or enumerator\n\\afxfontcombobox.h(45): error C2059: syntax error: ')'\n\\afxfontcombobox.h(45): error C2091: function returns function\n\\afxfontcombobox.h(46): error C2146: syntax error: missing ')' before identifier 'SelectObject'\n\\afxfontcombobox.h(46): error C3646: 'SelectObject': unknown override specifier\n\\afxfontcombobox.h(46): error C2146: syntax error: missing ')' before identifier 'lpszName'\n\\afxfontcombobox.h(46): error C2065: 'lpszName': undeclared identifier\n\\afxfontcombobox.h(46): error C2096: 'HFONT': A data member cannot be initialized with a parenthesized initializer\n\\afxfontcombobox.h(46): error C2086: 'BOOL CMFCFontComboBox::HFONT': redefinition\n\\afxfontcombobox.h(45): note: see declaration of 'CMFCFontComboBox::HFONT'\n\\afxfontcombobox.h(46): error C2131: expression did not evaluate to a constant\n\\afxfontcombobox.h(46): note: failure was caused by non-constant arguments or reference to a non-constant symbol\n\\afxfontcombobox.h(46): note: see usage of 'lpszName'\n\\afxfontcombobox.h(46): error C2327: 'CMFCFontComboBox::HFONT': is not a type name, static, or enumerator\n\\afxfontcombobox.h(46): error C2059: syntax error: ')'\n</code></pre>\n\n<p>The culprit is #include \"afxcontrolbars.h\" which is auto added by the IDE. Not sure if I have to link to another version of ATL, change the include order, or what. Does anyone have an idea?</p>\n"}, {"tags": ["c++", "c", "file", "winapi"], "comments": [{"owner": {"reputation": 258, "user_id": 8083690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrIvk.png?s=128&g=1", "display_name": "Sam Pagenkopf", "link": "https://stackoverflow.com/users/8083690/sam-pagenkopf"}, "edited": false, "score": 0, "creation_date": 1531926714, "post_id": 51405370, "comment_id": 89781928, "body": "Are they using a memory-mapped file? <a href=\"https://en.wikipedia.org/wiki/Memory-mapped_file\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Memory-mapped_file</a>"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 1, "creation_date": 1531926791, "post_id": 51405370, "comment_id": 89781979, "body": "Never use both <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a> and <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> ....."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1531926795, "post_id": 51405370, "comment_id": 89781983, "body": "<code>int8_t</code> probably isn&#39;t large enough since <code>ULONG</code> is probably <code>uint32_t</code>."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 2, "creation_date": 1531926911, "post_id": 51405370, "comment_id": 89782049, "body": "You&#39;ve got a problem.  You tagged the C language, but the C language doesn&#39;t have <code>std::vector</code>.  I recommend you focus on one language before mixing or combing the two languages.  Also, update your language tags."}, {"owner": {"reputation": 2231, "user_id": 6909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ncdCb.png?s=128&g=1", "display_name": "Jo&#227;o Augusto", "link": "https://stackoverflow.com/users/6909/jo%c3%a3o-augusto"}, "edited": false, "score": 0, "creation_date": 1531927202, "post_id": 51405370, "comment_id": 89782239, "body": "what&#39;s the point of reading data to a vector of int8_t and read uint32_t blocks of data by using a pointer to the vector buffer.... Why don&#39;t you just read the data to a vector of uint32_t and access the values by index ?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9926513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/341349c4a277a57df5cb22339cda30b1?s=128&d=identicon&r=PG&f=1", "display_name": "jdoe", "link": "https://stackoverflow.com/users/9926513/jdoe"}, "edited": false, "score": 0, "creation_date": 1531927100, "post_id": 51405503, "comment_id": 89782171, "body": "this makes a lot more sense. I didn&#39;t realize you could cast a pointer like that from a  vector"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1531964931, "post_id": 51405503, "comment_id": 89797952, "body": "Beware that four <code>int8_t</code> values may not satisfy alignment requirements to be accessed as a single <code>ULONG</code>. You will need to declare the pointer as unaligned to avoid crashes on alignment-sensitive CPUs."}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": false, "score": 1, "last_activity_date": 1531926743, "creation_date": 1531926743, "answer_id": 51405503, "question_id": 51405370, "link": "https://stackoverflow.com/questions/51405370/read-file-by-ulong-at-a-time/51405503#51405503", "title": "Read File by ULONG at a time", "body": "<p>I'm assuming that your data is binary data in the correct native format (I think that's implied by your question).</p>\n\n<p>So if your data is ULONGs don't use a char pointer use a ULONG pointer, like this</p>\n\n<pre><code>vector&lt;int8_t&gt; res;\n// some code to read into res\n\n// get the underlying data\nULONG* resData = (ULONG*)res.data();\n\n// read a ULONG\nULONG someData = *resData;\n\n// advance to the next ULONG\n++resData;\n</code></pre>\n\n<p>The important part is the use of the <code>data()</code> method to access the vectors data.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9926513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/341349c4a277a57df5cb22339cda30b1?s=128&d=identicon&r=PG&f=1", "display_name": "jdoe", "link": "https://stackoverflow.com/users/9926513/jdoe"}, "edited": false, "score": 0, "creation_date": 1531928089, "post_id": 51405873, "comment_id": 89782820, "body": "well, that was the old code. All I have now is the path to my file.. so not sure if it is locked to memory now? Before they had the bin files loaded into the .exe itself"}, {"owner": {"reputation": 1, "user_id": 9926513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/341349c4a277a57df5cb22339cda30b1?s=128&d=identicon&r=PG&f=1", "display_name": "jdoe", "link": "https://stackoverflow.com/users/9926513/jdoe"}, "edited": false, "score": 0, "creation_date": 1531929572, "post_id": 51405873, "comment_id": 89783855, "body": "okay think i see what you mean. Although I don&#39;t think I&#39;d have an offest because I would be right at the top of the file. I also am trying to use a pointer to do this where in this case I would have to keep recalled the read function?"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1531941699, "post_id": 51405873, "comment_id": 89790504, "body": "You also need <code>SizeofResource(NULL, resHandle)</code> to find the data size"}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1531929361, "last_edit_date": 1531929361, "creation_date": 1531927921, "answer_id": 51405873, "question_id": 51405370, "link": "https://stackoverflow.com/questions/51405370/read-file-by-ulong-at-a-time/51405873#51405873", "title": "Read File by ULONG at a time", "body": "<p>You have no reason to read into a vector. Your resource is already loaded into memory, so the conformant way is to <code>memcpy</code> the relevant parts directly into your variables. Here it could be:</p>\n\n<pre><code>...\nchar* resData = (char*)LockResource(resHandle);\n...\nULONG myVar;\nint offset = ...;    // the offset in the resource where your long value resides\nmemcpy(&amp;myVar, resData+offset, sizeof(myVar));\n</code></pre>\n\n<p>That is all your ULONG variable can now be used...</p>\n\n<hr>\n\n<p>If you no longer have a resource but a file you can use unformatted io methods over an <code>ifstream</code>:</p>\n\n<pre><code>std::ifstream in(file_name, std::ios_base::in | std::ios_base_binary);\n...\nULONG myVar;\nint offset = ...;    // the offset in the resource where your long value resides\nin.seekg(offset, std::ios_base::seekdir::beg);        // position the stream at the offset\nin.read(static_cast&lt;char *&gt;(&amp;myVar), sizeof(myVar));  // and read the bytes\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9926513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/341349c4a277a57df5cb22339cda30b1?s=128&d=identicon&r=PG&f=1", "display_name": "jdoe", "link": "https://stackoverflow.com/users/9926513/jdoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1531929361, "creation_date": 1531926326, "last_edit_date": 1531927281, "question_id": 51405370, "link": "https://stackoverflow.com/questions/51405370/read-file-by-ulong-at-a-time", "title": "Read File by ULONG at a time", "body": "<p>I am trying to adapt to some code which creates a char * to the head of some data. And then is able to increment that pointer unsigned long at a time to read the data.</p>\n\n<p>I have been told a good way to do this is use ifstream to read the file (located somewhere on C:/) into a vector:</p>\n\n<pre><code>std::vector&lt;int8_t&gt;\n</code></pre>\n\n<p>But where my confusion is how do I then pull each piece of the file out in sizes of ULONG. I posted the logic below, this is communicating to hardware which needs data to be in that size, so they traverse the pointer at the sizeOf(ULONG) at a time until they read the end of the file(which they know by checking the file size). I know I need to somehow load this into memory.. but how do I traverse the same way</p>\n\n<p>a small snippet of their code looks like this:</p>\n\n<pre><code>char* resData;\nres = FindResource(NULL, MAKEINTRESOURCE(fpgaDevice), L\"FPGADATA\");\n  resHandle = LoadResource(NULL, res);\n  resData = (char*)LockResource(resHandle);\n</code></pre>\n\n<p>then to advance the file they advance the pointer by the size of the ULONG:</p>\n\n<pre><code>resData += sizeof(ULONG);\n</code></pre>\n\n<p>And to read the pointer simply use:</p>\n\n<pre><code>(ULONG*)resData\n</code></pre>\n"}, {"tags": ["c++", "oop"], "comments": [{"owner": {"reputation": 292, "user_id": 5416291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dne4W.png?s=128&g=1", "display_name": "AGirlHasNoName", "link": "https://stackoverflow.com/users/5416291/agirlhasnoname"}, "edited": false, "score": 0, "creation_date": 1531940181, "post_id": 51405312, "comment_id": 89789728, "body": "cross-posted to CodeReview <a href=\"https://codereview.stackexchange.com/questions/199770/a-design-for-data-flow-computation\" title=\"a design for data flow computation\">codereview.stackexchange.com/questions/199770/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1531929471, "post_id": 51405695, "comment_id": 89783776, "body": "Possibly <code>(i + c.size() - 1) % c.size()</code> instead of ternary operator"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1531929699, "post_id": 51405695, "comment_id": 89783945, "body": "I would even go for something like: <code>using DataflowClass = std::pair&lt;int, int&gt;;     DataflowClass calculate(int a, int b)     {         return { a + b, a - 2 * b} ;     }</code> :)"}, {"owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "edited": false, "score": 0, "creation_date": 1531933670, "post_id": 51405695, "comment_id": 89786257, "body": "Your solution, just solve the simple case which all blocks are serially connected and the connections are simple which can be generalized, but the real case isn&#39;t, i just wrote a simple example for that, in real case the output of blocks may not connected in uniform order which you do, also we have to specify the inputs in each calculate, see my edited question with my design i can call the calculate methods in some where different from that context even automatically, but in your design it can&#39;t"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "edited": false, "score": 0, "creation_date": 1531934723, "post_id": 51405695, "comment_id": 89786771, "body": "@e.jahandar your design is bad and your reasoning is bogus, but I do not want to argue anymore. You are free to do whatever, but this answer is not only for you."}, {"owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "edited": false, "score": 0, "creation_date": 1531935210, "post_id": 51405695, "comment_id": 89787024, "body": "@Slava you just say &quot;your design is bad&quot; without getting a good design, thanks for your attention."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "edited": false, "score": 0, "creation_date": 1531935475, "post_id": 51405695, "comment_id": 89787165, "body": "@e.jahandar I am giving you better design (at least based on information I have) or Jarod42 gives you even better one. I cannot give full proper design without knwoing requirements. But your design is definitely not good, and you are already hitting one of the problems of it - you cannot make circular calculations without ugly workarounds. Believe me more such workarounds to come if you continue to use it."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1531935887, "post_id": 51405695, "comment_id": 89787382, "body": "@Slava: you are not consistent, or we misunderstood each other. I was talking about the design of Jarod42&#39;s answer (basically it is the same as the original, just the references changed to pointers - no real design difference). You said, it is bad design, because it contains hidden parameters <code>a</code> and <code>b</code>. Now you say that it is a good design. I&#39;m confused now."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1531936029, "post_id": 51405695, "comment_id": 89787451, "body": "@geza I was saying about Jarod&#39;s second implementation using <code>std::pair</code>"}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 0, "last_activity_date": 1531927324, "creation_date": 1531927324, "answer_id": 51405695, "question_id": 51405312, "link": "https://stackoverflow.com/questions/51405312/resolving-circular-reference-variable-dependency-in-c/51405695#51405695", "title": "Resolving circular reference variable dependency in C++", "body": "<p>Your design is overcomplicated without much reason:</p>\n\n<pre><code>class DataflowClass {\n    public:\n        void calculate(const DataflowClass &amp;from ){\n            c = from.getC() + from.getD();\n            d = from.getC() - 2*from.getD();\n        }\n\n        int getC() const { return c; }\n        int getD() const { return d; }\n\n    private:\n        int c = 1;\n        int d = 2;\n};\n\nvoid TestReferenceVariableDataflow(int count){\n    std::array&lt;DataflowClass,3&gt; c;\n\n    for(int i=0;i&lt;count;i++){\n        for( size_t i = 0; i &lt; c.size(); ++i ) {\n            auto prev = ( i == 0 ? c.size() : i ) - 1;\n            c[i].calculate( c[prev] ); \n        }\n    }\n}\n</code></pre>\n\n<p>this does the same more generic and safer way.</p>\n"}, {"comments": [{"owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "edited": false, "score": 0, "creation_date": 1531933893, "post_id": 51406758, "comment_id": 89786385, "body": "The solution of using pointers are good, because allows us to connect the inputs later than construction time, but i will prefer the static assertion comes from unconnected inputs"}, {"owner": {"reputation": 222, "user_id": 6467688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bf732ef592dbe8400fed50bba557f3?s=128&d=identicon&r=PG&f=1", "display_name": "hoffmale", "link": "https://stackoverflow.com/users/6467688/hoffmale"}, "edited": false, "score": 0, "creation_date": 1532004958, "post_id": 51406758, "comment_id": 89817339, "body": "Remove the default constructor, and the pointers will never be <code>nullptr</code>: They always have to point somewhere. If that &quot;somewhere&quot; is invalid (because the object got destroyed), the original references-only implementation would dangle as well. (However, you should immediately call <code>calculate</code>: If you actually build a cycle, you&#39;d lose your input values otherwise.)"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 222, "user_id": 6467688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bf732ef592dbe8400fed50bba557f3?s=128&d=identicon&r=PG&f=1", "display_name": "hoffmale", "link": "https://stackoverflow.com/users/6467688/hoffmale"}, "edited": false, "score": 0, "creation_date": 1532007994, "post_id": 51406758, "comment_id": 89819588, "body": "@hoffmale: OP wants to avoid to use &quot;dummy&quot; variables (<code>int a; int b;</code>). So, instead of removing default constructor with <code>nullptr</code>, I might make pointers point to members <code>c</code> and <code>d</code> which are valid."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1531930753, "creation_date": 1531930753, "answer_id": 51406758, "question_id": 51405312, "link": "https://stackoverflow.com/questions/51405312/resolving-circular-reference-variable-dependency-in-c/51406758#51406758", "title": "Resolving circular reference variable dependency in C++", "body": "<p>You might use pointer instead of references:</p>\n\n<pre><code>class DataflowClass {\npublic:\n    DataflowClass() = default;\n\n    DataflowClass(int&amp; pa, int&amp; pb) : a(&amp;pa), b(&amp;pb){}\n    void linkTo(int&amp; pa, int&amp; pb) { a = &amp;pa; b = &amp;pb; }\n\n    void calculate(){\n        assert(a != nullptr &amp;&amp; b != nullptr);\n        c = *a + *b;\n        d = *a - 2 * *b;\n    }\n\n    int &amp; getC() { return c; }\n    int &amp; getD() { return d; }\n\nprivate:\n    int c = 1;\n    int d = 2;\n    const int* a = nullptr;\n    const int* b = nullptr;\n\n};\n\nvoid TestReferenceVariableDataflow(int count)\n{\n    DataflowClass c1;\n    DataflowClass c2(c1.getC(), c1.getD());\n    DataflowClass c3(c2.getC(), c2.getD());\n    c1.linkTo(c3.getC(), c3.getD());\n\n    for(int i=0;i&lt;count;i++){\n        c1.calculate();\n        c2.calculate();\n        c3.calculate();\n    }\n}\n</code></pre>\n\n<p>but then pointer might be null :-/</p>\n\n<p>Having something like the following seems simpler:</p>\n\n<pre><code>std::pair&lt;int, int&gt; calculate(int a, int b) { return { a + b, a - 2 * b} ; }\n\nvoid TestReferenceVariableDataflow(int count)\n{\n    int a = 1;\n    int b = 2;\n\n    for(int i=0;i&lt;count;i++){\n        std::tie(a, b)  = calculate(a, b);\n        std::tie(a, b)  = calculate(a, b);\n        std::tie(a, b)  = calculate(a, b);\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 222, "user_id": 6467688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bf732ef592dbe8400fed50bba557f3?s=128&d=identicon&r=PG&f=1", "display_name": "hoffmale", "link": "https://stackoverflow.com/users/6467688/hoffmale"}, "is_accepted": false, "score": 1, "last_activity_date": 1532072724, "last_edit_date": 1532072724, "creation_date": 1532008562, "answer_id": 51424525, "question_id": 51405312, "link": "https://stackoverflow.com/questions/51405312/resolving-circular-reference-variable-dependency-in-c/51424525#51424525", "title": "Resolving circular reference variable dependency in C++", "body": "<p>The only way I can sensibly see this working with only references is by decoupling the storage entirely.</p>\n\n<pre><code>class DataFlowClass {\n    const int&amp; a;\n    const int&amp; b;\n    int&amp; c;\n    int&amp; d;\n\npublic:\n    DataFlowClass(const int&amp; a, const int&amp; b, int&amp; c, int&amp; d) : a{a}, b{b}, c{c}, d{d} {\n        c = 1;\n        d = 2;\n    }\n\n    void calculate() {\n        c = a + b;\n        d = a - 2*b;\n    }\n};\n\nvoid TestReferenceVariableDataflow(int count){\n    int storage[6]; // could use 6 int variables instead\n\n    DataflowClass c1(storage[0], storage[1], storage[2], storage[3]);\n    DataflowClass c2(storage[2], storage[3], storage[4], storage[5]);\n    DataflowClass c3(storage[4], storage[5], storage[0], storage[1]);\n\n    for(int i=0;i&lt;count;i++){\n        c1.calculate();\n        c2.calculate();\n        c3.calculate();\n    }\n}\n</code></pre>\n\n<p>However, here it is the responsibility of the caller to ensure all references get setup correctly, which might get complicated.</p>\n\n<blockquote>\n  <p>Since you mentioned that this is targeting an embedded environment, note that this solution likely takes 1.5 times the amount of memory necessary for the pointer-based solution in <a href=\"https://stackoverflow.com/a/51406758/6467688\">Jarod42's answer</a>.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "is_accepted": true, "score": 0, "last_activity_date": 1541516861, "creation_date": 1541516861, "answer_id": 53174599, "question_id": 51405312, "link": "https://stackoverflow.com/questions/51405312/resolving-circular-reference-variable-dependency-in-c/53174599#53174599", "title": "Resolving circular reference variable dependency in C++", "body": "<p>Finally found an optimal solution using std::reference_wrapper</p>\n\n<pre><code>class DataflowClass {\n    public:\n        DataflowClass(){}\n\n        inline void setInputs(int &amp; _a, int &amp; _b){\n            this-&gt;a = _a ;\n            this-&gt;b = _b;\n        }\n\n        inline void calculate(){\n            c = a + b;\n            d = a - 2*b;\n        }\n\n        inline int &amp; getC() { return c; }\n        inline int &amp; getD() { return d; }\n\n    private:\n        int c = 1;\n        int d = 2;\n        int a_initial = 0;\n        int b_initial = 0;\n        std::reference_wrapper&lt;int&gt; a = a_initial;\n        std::reference_wrapper&lt;int&gt; b = b_initial;\n};\n\nvoid TestReferenceVariableDataflow(int count){\n\n    DataflowClass c1, c2, c3;\n    c2.setInputs(c1.getC(), c1.getD());\n    c3.setInputs(c2.getC(), c2.getD());\n    c1.setInputs(c3.getC(), c3.getD());\n\n    for(int i=0;i&lt;count;i++){\n        c1.calculate();\n        c2.calculate();\n        c3.calculate();\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 53174599, "answer_count": 4, "score": 0, "last_activity_date": 1541516861, "creation_date": 1531926162, "last_edit_date": 1531933663, "question_id": 51405312, "link": "https://stackoverflow.com/questions/51405312/resolving-circular-reference-variable-dependency-in-c", "title": "Resolving circular reference variable dependency in C++", "body": "<p>Suppose i have following code for making a data flow architecture with C++</p>\n\n<pre><code>class DataflowClass {\n    public:\n        DataflowClass(int &amp; _a, int &amp; b) : a(_a), b(b){}\n\n        inline void calculate(){\n            c = a + b;\n            d = a - 2*b;\n        }\n\n        inline int &amp; getC() { return c; }\n        inline int &amp; getD() { return d; }\n\n    private:\n        int c = 1;\n        int d = 2;\n        int &amp; a;\n        int &amp; b;\n};\n\nvoid TestReferenceVariableDataflow(int count){\n\n    int a;\n    int b;\n\n    DataflowClass c1(a, b);\n    DataflowClass c2(c1.getC(), c1.getD());\n    DataflowClass c3(c2.getC(), c2.getD());\n\n    for(int i=0;i&lt;count;i++){\n        a = c3.getC();\n        b = c3.getD();\n        c1.calculate();\n        c2.calculate();\n        c3.calculate();\n    }\n}\n</code></pre>\n\n<p>The DataflowClass is a main building for dataflow blocks which have two inputs and two outputs. The constructor of DataflowClass accepts two reference variables as inputs and has two getter functions which return the reference to its two output members,\nAs can be seen, in TestReferenceVariableDataflow function i constructed 3 instances of DataflowClass, the c1 instance constructed with a reference to two local variables defined in TestReferenceVariableDataflow function, the c2 has been constructed with two references comming from c1.getC() and c2.getC() and vice versa for c3.</p>\n\n<p>in each iteration, the calculate method of 3 classes will be called defined order, which result in dataflow computation within the 3 classes.</p>\n\n<p>The real problem is circular dependency, as you can see, the c1 constructed with reference of two variables defined in TestReferenceVariableDataflow function and at the end of each iteration, i have to copy the values from c3.getC() and c3.getD() into those variables.</p>\n\n<p>as the DataflowClass accepts reference variables in its constructor, i can't connect the output variables of c3 directly to c1, because the c3 instance isn't available at the construction time of c1 and so i have to define two extra variable to copy the values in each iteration from the last to the first.</p>\n\n<p>as you know, the classes with reference members should initialize the reference at the construction time and this issue makes that circular dependency problem.</p>\n\n<p>Is there any solution to this circular dependency problem? </p>\n\n<p><strong>Edit</strong>\nThere are some simple reasons behind this design,</p>\n\n<p>1- first of all, this is design only uses C++ generic syntax and not any other sort of libraries or even std::*, just because of performance, think there are tens of these blocks, and all connected to each other serially, \nanother reason to avoid using libraries, is this code is part of real time software and its behavior is much more predictable than libraries</p>\n\n<p>2- The instances of DataflowClass will never destroy and we can't have dangling pointers</p>\n\n<p>3- In time critical and realtime softwares, dynamic memory management are somehow prohibited, because of unpredictability and this design truly could be used with all static memory allocation</p>\n\n<p>4- Use of pointers are not considered as good solution, because with the pointers static compile time assertion can't be achieved, the compile time wiring prevents unconnected input nets\nAlso the pointers may get null or something like that</p>\n\n<p>5- this design doesn't need change signals for each variables, because all calculate methods will be called serially, and also maybe called automatically with a parent class</p>\n\n<p>6- The inputs of blocks may come from different blocks (than their previous blocks), the provided example is just a simple case which the blocks connected to each other uniformly</p>\n\n<p>7- Simple this design would be a C++ implementation of simulink blocks, the output of blocks are connected to the input of other blocks and they will calculate their outputs with increment of time</p>\n"}, {"tags": ["c++", "intel", "sse", "avx", "avx2"], "comments": [{"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1531926254, "post_id": 51404863, "comment_id": 89781568, "body": "memcpy, possibly with a shuffle first?"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 6, "creation_date": 1531926294, "post_id": 51404863, "comment_id": 89781602, "body": "Out of curiosity, I googled a bit and found <a href=\"https://software.intel.com/en-us/node/695239\" rel=\"nofollow noreferrer\"><b><code>_mm256_storeu_si256() </code></b></a> due to this Q/A: <a href=\"https://stackoverflow.com/a/29517684/7478597\">SO: Store __m256i to integer</a>"}, {"owner": {"reputation": 269, "user_id": 10011283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0ec1be422acb5aba3493f49ef1e378b?s=128&d=identicon&r=PG&f=1", "display_name": "yatsukino", "link": "https://stackoverflow.com/users/10011283/yatsukino"}, "edited": false, "score": 0, "creation_date": 1531928134, "post_id": 51404863, "comment_id": 89782849, "body": "oops sorry... Didn&#39;t saw that post, Thanks for the answer!"}], "owner": {"reputation": 269, "user_id": 10011283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0ec1be422acb5aba3493f49ef1e378b?s=128&d=identicon&r=PG&f=1", "display_name": "yatsukino", "link": "https://stackoverflow.com/users/10011283/yatsukino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 0, "closed_date": 1531927794, "answer_count": 0, "score": 1, "last_activity_date": 1531924787, "creation_date": 1531924787, "question_id": 51404863, "link": "https://stackoverflow.com/questions/51404863/turn-m256i-into-int-array", "closed_reason": "Duplicate", "title": "Turn _m256i into int array", "body": "<p>I'm currently using AVX2 and I have the following problem:</p>\n\n<p>After doing some AVX instructions I have to extract all values and put them into an array, the problem is that the way I found to do it isn't efficient at all...</p>\n\n<p>I did the following things:</p>\n\n<pre><code>uint32_t temp[];\n__m256i x, y;\ntemp[0] = _mm256_extract_epi32(x, 0);\ntemp[1] = _mm256_extract_epi32(x, 1);\ntemp[2] = _mm256_extract_epi32(x, 2);\ntemp[3] = _mm256_extract_epi32(x, 3);\ntemp[4] = _mm256_extract_epi32(x, 4);\ntemp[5] = _mm256_extract_epi32(x, 5);\ntemp[6] = _mm256_extract_epi32(x, 6);\ntemp[7] = _mm256_extract_epi32(x, 7);\n</code></pre>\n\n<p>Is there a way to do it better ?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1531924555, "post_id": 51404763, "comment_id": 89780375, "body": "At the very least, that <code>if</code> will need to be a <code>constexpr if</code>. If <code>f(arg);</code> is illformed, the compiler would complain of it&#39;s presence even if the branch could never be taken. Using <code>constexpr if</code> fixes that."}, {"owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "edited": false, "score": 0, "creation_date": 1531925467, "post_id": 51404763, "comment_id": 89781047, "body": "Is it possible to add a function  f() that takes any type and that calls g(). The compiler would do the work for you. I&#39;m not sure how to do this. May be void f(...){g();} ?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "edited": false, "score": 0, "creation_date": 1531925666, "post_id": 51404763, "comment_id": 89781155, "body": "@WilliamJBagshaw <code>template&lt;class T&gt; void f(T&amp;&amp;) { g(); }</code> sounds like what you are suggesting. But then it gets tricky when you call with <code>int&amp;</code> or other almost-but-not-quite-the-same arguments."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1531926588, "post_id": 51404763, "comment_id": 89781822, "body": "@Mat: <code>is_invocable</code> is a little problematic to call with overloads..."}, {"owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "edited": false, "score": 0, "creation_date": 1531930836, "post_id": 51404763, "comment_id": 89784636, "body": "If you struggle create your own test as a templated function  and populate the specialisations. Default template returns false. Available types return true. Then I think you could also add false positives if you want them to be false. You would have to keep it in sync yourself and getting all false positive may be an issues. But it looks like automatic ways are difficult too."}], "answers": [{"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1531926515, "post_id": 51405352, "comment_id": 89781778, "body": "Possibly <a href=\"https://en.cppreference.com/w/cpp/experimental/is_detected\" rel=\"nofollow noreferrer\">std::experimental::is_detected</a>."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1531926605, "post_id": 51405352, "comment_id": 89781835, "body": "@Jarod42 I was thinking about it, but am unsure how widely available/accepted it is."}], "tags": [], "owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "is_accepted": true, "score": 6, "last_activity_date": 1531926745, "last_edit_date": 1531926745, "creation_date": 1531926281, "answer_id": 51405352, "question_id": 51404763, "link": "https://stackoverflow.com/questions/51404763/c-compile-time-check-that-an-overloaded-function-can-be-called-with-a-certain/51405352#51405352", "title": "C++ Compile-time check that an overloaded function can be called with a certain type of argument", "body": "<p>You could use the <a href=\"https://en.cppreference.com/w/cpp/experimental/is_detected\" rel=\"noreferrer\">detection idiom</a> to build such a test</p>\n\n<pre><code>template&lt;typename = void, typename... Args&gt;\nstruct test : std::false_type {};\n\ntemplate&lt;typename... Args&gt;\nstruct test&lt;std::void_t&lt;decltype(f(std::declval&lt;Args&gt;()...))&gt;, Args...&gt;\n    : std::true_type {};\n\ntemplate&lt;typename... Args&gt;\ninline constexpr bool test_v = test&lt;void, Args...&gt;::value;\n</code></pre>\n\n<p>And use it as</p>\n\n<pre><code>template &lt;class T&gt;\nstruct C\n{\n    void method(T arg)\n    { \n        if constexpr (test_v&lt;T&gt;)\n            f(arg);\n        else\n            g();\n    }\n};\n</code></pre>\n\n<p><a href=\"https://godbolt.org/g/rHS2m8\" rel=\"noreferrer\">Live</a></p>\n\n<p>Or alternatively</p>\n\n<pre><code>template&lt;typename... Args&gt;\nusing test_t = decltype(f(std::declval&lt;Args&gt;()...));\n\ntemplate&lt;typename... Args&gt;\ninline constexpr auto test_v = std::experimental::is_detected_v&lt;test_t, Args...&gt;;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1531926385, "creation_date": 1531926385, "answer_id": 51405390, "question_id": 51404763, "link": "https://stackoverflow.com/questions/51404763/c-compile-time-check-that-an-overloaded-function-can-be-called-with-a-certain/51405390#51405390", "title": "C++ Compile-time check that an overloaded function can be called with a certain type of argument", "body": "<p>You might do the following with SFINAE:</p>\n\n<pre><code>template &lt;class T, typename Enabler = void&gt;\nstruct C {\n    void method(T arg) {\n        g();\n    }\n};\n\ntemplate &lt;class T&gt;\nstruct C&lt;T, std::void_t&lt;decltype(f(std::declval&lt;T&gt;()))&gt;&gt; {\n    void method(T arg) { \n        f(arg);\n    }\n};\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/9e32ddfaa3b15f96\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}], "owner": {"reputation": 98, "user_id": 9094797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29203caa938c908084e1a299f573de12?s=128&d=identicon&r=PG&f=1", "display_name": "5r1gsOi1", "link": "https://stackoverflow.com/users/9094797/5r1gsoi1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1242, "favorite_count": 0, "accepted_answer_id": 51405352, "answer_count": 2, "score": 7, "last_activity_date": 1563448051, "creation_date": 1531924478, "last_edit_date": 1563448051, "question_id": 51404763, "link": "https://stackoverflow.com/questions/51404763/c-compile-time-check-that-an-overloaded-function-can-be-called-with-a-certain", "title": "C++ Compile-time check that an overloaded function can be called with a certain type of argument", "body": "<p>Consider an overloaded function</p>\n\n<pre><code>void f(int);\nvoid f(long);\nvoid f(double);\nvoid f(MyClass);\n</code></pre>\n\n<p>And a method in a template class with unknown argument type</p>\n\n<pre><code>template &lt;class T&gt;\nstruct C {\n  void method(T arg) { ... }\n};\n</code></pre>\n\n<p>I want to check at compile time if there is a version of <code>f</code> which can take <code>arg</code> as an argument.  </p>\n\n<pre><code>template &lt;class T&gt;\nstruct C {\n  void method(T arg) { \n    if constexpr (CAN_BE_CALLED(f, arg)) {\n      f(arg);\n    } else {\n      g();\n    }\n  }\n};\n</code></pre>\n\n<p>Is it possible to do that? I tried <a href=\"https://stackoverflow.com/questions/22882170/c-compile-time-predicate-to-test-if-a-callable-object-of-type-f-can-be-called\">this</a> and <a href=\"https://stackoverflow.com/questions/27590890/how-to-check-at-compile-time-if-a-function-that-can-be-called-with-a-specific-se\">this</a> but compiler complained about <em>unresolved overloaded function type</em>.</p>\n"}, {"tags": ["c++", "linux", "qt", "camera"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1531928178, "post_id": 51404413, "comment_id": 89782880, "body": "What research have you done? This is almost certainly referred to in the many tutorials out there. Show what research you&#39;ve done, and maybe share the relevant file details so people don&#39;t have to redo your work."}, {"owner": {"reputation": 1, "user_id": 10053400, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FmA3NbjBbWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rs-LqpJOCBHJIUPw6Pb9N0HUDKDw/mo/photo.jpg?sz=128", "display_name": "Deepanshu Mourya", "link": "https://stackoverflow.com/users/10053400/deepanshu-mourya"}, "edited": false, "score": 0, "creation_date": 1531973406, "post_id": 51404413, "comment_id": 89799735, "body": "I tried to find something on how to connect pylon camera to qt on linux but I didn&#39;t find anything that&#39;s why I posted a question here. I don&#39;t even know how to proceed on this. Can you please help me on this and provide relevant links please."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1532007477, "post_id": 51404413, "comment_id": 89819203, "body": "Unfortunately, <a href=\"https://stackoverflow.com\">Stack Overflow</a> is not a great tutorial site, and this question seems to be about how to do some specific thing with a specific API under specific circumstances. At the end of the day this is just a library and API being used with C++. Some of the info out there will probably apply or at least give you a hint. You are encouraged to continue with your research until someone finds this question interesting enough to form and answer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1532007579, "post_id": 51404413, "comment_id": 89819279, "body": "Given that a Mac is pretty close to *NIX often, look here: <a href=\"https://stackoverflow.com/q/39421854/1531971\">stackoverflow.com/q/39421854/1531971</a> Also, just search &quot;pylon qt c++&quot; on the web."}], "owner": {"reputation": 1, "user_id": 10053400, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FmA3NbjBbWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rs-LqpJOCBHJIUPw6Pb9N0HUDKDw/mo/photo.jpg?sz=128", "display_name": "Deepanshu Mourya", "link": "https://stackoverflow.com/users/10053400/deepanshu-mourya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 301, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532022501, "creation_date": 1531923557, "last_edit_date": 1532022501, "question_id": 51404413, "link": "https://stackoverflow.com/questions/51404413/how-to-link-pylon-camera-to-qt-creater-on-linux", "title": "How to link pylon camera to qt creater on linux", "body": "<p>I am trying to connect a Basler camera to my qt application on linux but I am not able to include any of the pylon header files because I don't know what extra things to add my .pro file other than \"QT  += core gui multimedia multimediawidgets\". If any one of you can help me on this then I'll be grateful to you guys. </p>\n"}, {"tags": ["c++"], "answers": [{"comments": [{"owner": {"reputation": 265, "user_id": 9462746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2902d2b08a8ebd92b8654dc22f522c87?s=128&d=identicon&r=PG&f=1", "display_name": "DDaniel", "link": "https://stackoverflow.com/users/9462746/ddaniel"}, "edited": false, "score": 0, "creation_date": 1531923557, "post_id": 51404329, "comment_id": 89779617, "body": "Is there a reason why &quot;T const&quot; is not disallowed when T is of reference type?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 265, "user_id": 9462746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2902d2b08a8ebd92b8654dc22f522c87?s=128&d=identicon&r=PG&f=1", "display_name": "DDaniel", "link": "https://stackoverflow.com/users/9462746/ddaniel"}, "edited": false, "score": 0, "creation_date": 1531923590, "post_id": 51404329, "comment_id": 89779642, "body": "@DDaniel so templated code would not be affected when unessesary"}, {"owner": {"reputation": 265, "user_id": 9462746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2902d2b08a8ebd92b8654dc22f522c87?s=128&d=identicon&r=PG&f=1", "display_name": "DDaniel", "link": "https://stackoverflow.com/users/9462746/ddaniel"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1531924382, "post_id": 51404329, "comment_id": 89780256, "body": "@Slava: I&#39;m failing to comprehend why it would be considered &quot;harmful&quot; or &quot;unnecessary&quot; to disallow for that case. Would not the fact that const is &quot;ignored&quot; be considered dangerous since I can change the value of such a variable even though it should be constant? Just curious as to the reasoning behind the rule."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 5, "last_activity_date": 1531923310, "creation_date": 1531923310, "answer_id": 51404329, "question_id": 51404206, "link": "https://stackoverflow.com/questions/51404206/why-does-aliasing-int-allow-for-the-creation-of-the-non-function-type-const-in/51404329#51404329", "title": "Why does aliasing int&amp; allow for the creation of the non-function type const (int&amp;)?", "body": "<p>That's just the rule. From <a href=\"http://eel.is/c++draft/dcl.ref#1.sentence-4\" rel=\"noreferrer\">[dcl.ref]/1</a>:</p>\n\n<blockquote>\n  <p>Cv-qualified references are ill-formed except when the cv-qualifiers are introduced through the use of a <em>typedef-name</em> ([dcl.typedef], [temp.param]) or <em>decltype-specifier</em>, in which case the cv-qualifiers are ignored.</p>\n</blockquote>\n\n<p>It's there to make it easier to code. <code>int&amp; const</code> is obviously wrong, and there's no benefit to allowing it. <code>T const</code> could be valid for some <code>T</code>s, so it would be actively harmful to reject it when it's not - it's just easier to code if you allow it and ignore the invalid cv-qualifiers in those cases. </p>\n"}, {"comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 1, "creation_date": 1531924123, "post_id": 51404581, "comment_id": 89780027, "body": "It is prohibited by the standard."}], "tags": [], "owner": {"reputation": 185, "user_id": 9602261, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Eugene Mart", "link": "https://stackoverflow.com/users/9602261/eugene-mart"}, "is_accepted": false, "score": -3, "last_activity_date": 1531924134, "last_edit_date": 1531924134, "creation_date": 1531923982, "answer_id": 51404581, "question_id": 51404206, "link": "https://stackoverflow.com/questions/51404206/why-does-aliasing-int-allow-for-the-creation-of-the-non-function-type-const-in/51404581#51404581", "title": "Why does aliasing int&amp; allow for the creation of the non-function type const (int&amp;)?", "body": "<p><a href=\"https://i.stack.imgur.com/S2NR9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S2NR9.png\" alt=\"Microsoft compiler\"></a></p>\n\n<p>It works in a Microsoft compiler.\nThough it throws a warning\nWarning C4227   anachronism used: qualifiers on reference are ignored</p>\n\n<p>It is not prohibited by the standard, but it is considered ill-formated. So it is compiler defined.</p>\n"}], "owner": {"reputation": 265, "user_id": 9462746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2902d2b08a8ebd92b8654dc22f522c87?s=128&d=identicon&r=PG&f=1", "display_name": "DDaniel", "link": "https://stackoverflow.com/users/9462746/ddaniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 51404329, "answer_count": 2, "score": 4, "last_activity_date": 1531924134, "creation_date": 1531922978, "last_edit_date": 1531923874, "question_id": 51404206, "link": "https://stackoverflow.com/questions/51404206/why-does-aliasing-int-allow-for-the-creation-of-the-non-function-type-const-in", "title": "Why does aliasing int&amp; allow for the creation of the non-function type const (int&amp;)?", "body": "<p>Normally when working with constant to a reference one gets a compiler error, but not when aliasing or using templates. Why is this so?</p>\n\n<pre><code>int a = 5;\nusing my_t = int&amp;;\nmy_t const b = a; //#1 OK \nint&amp; const c = a; //#2 Compiler error\n</code></pre>\n\n<p>When running through the latest clang compiler (x86-64 clang (experimental P1144)), #1 gives me the warning:</p>\n\n<blockquote>\n  <p>[x86-64 clang (experimental P1144) #1] warning: 'const' qualifier on reference type 'my_t' (aka 'int &amp;') has no effect\n  [-Wignored-qualifiers]</p>\n</blockquote>\n\n<p>and #2 gives me the error:</p>\n\n<blockquote>\n  <p>[x86-64 clang (experimental P1144) #1] error: 'const' qualifier may not be applied to a reference.</p>\n</blockquote>\n\n<p>x86-64 gcc (trunk) gives an error for #2 but nothing for #1. </p>\n"}, {"tags": ["c++", "cassandra", "dns", "kubernetes", "datastax"], "comments": [{"owner": {"reputation": 47278, "user_id": 18627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b31b9d123bff80f00317a1df0dd00e2?s=128&d=identicon&r=PG", "display_name": "Alex Ott", "link": "https://stackoverflow.com/users/18627/alex-ott"}, "edited": false, "score": 0, "creation_date": 1531982624, "post_id": 51404148, "comment_id": 89803037, "body": "What version of C++ driver?"}, {"owner": {"reputation": 16, "user_id": 7316951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f24eb4c6521b478a1784bc02c99827?s=128&d=identicon&r=PG&f=1", "display_name": "comaes", "link": "https://stackoverflow.com/users/7316951/comaes"}, "reply_to_user": {"reputation": 47278, "user_id": 18627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b31b9d123bff80f00317a1df0dd00e2?s=128&d=identicon&r=PG", "display_name": "Alex Ott", "link": "https://stackoverflow.com/users/18627/alex-ott"}, "edited": false, "score": 0, "creation_date": 1531990724, "post_id": 51404148, "comment_id": 89807706, "body": "@AlexOtt Datastax c++ driver for Cassandra version 2.8.0"}], "owner": {"reputation": 16, "user_id": 7316951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f24eb4c6521b478a1784bc02c99827?s=128&d=identicon&r=PG&f=1", "display_name": "comaes", "link": "https://stackoverflow.com/users/7316951/comaes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532021426, "creation_date": 1531922811, "last_edit_date": 1532021426, "question_id": 51404148, "link": "https://stackoverflow.com/questions/51404148/cassandra-c-driver-keeps-attempting-reconnection-to-endpoints-that-do-not-exis", "title": "Cassandra c++ driver keeps attempting reconnection to endpoints that do not exist anymore", "body": "<p>I am using <a href=\"https://github.com/datastax/cpp-driver\" rel=\"nofollow noreferrer\">Datastax's c++ driver version 2.8.0</a> for Apache Cassandra inside a kubernetes application. Cassandra is deployed as a 3 node cluster via this <a href=\"https://github.com/kubernetes/charts/tree/master/incubator/cassandra\" rel=\"nofollow noreferrer\" title=\"following Helm chart\">Helm chart</a>.</p>\n\n<p>The chart leverages kubernetes' headless services to make the Cassandra endpoints available, so there is an entry in the kubernetes DNS for those endpoints.</p>\n\n<p>I have a c++ app running in a kubernetes pod that interacts with Cassandra, which connects using that DNS entry to resolve the endpoints. The application has a single connection to Cassandra object, following the driver usage guidelines. Connection is initialized at the beginning of the program, and failure to initialize the connection or to execute a query later on will actually fail the program.</p>\n\n<p>Everything is working fine, but cassandra nodes/pods may eventually go down for some reason. When that happens, they're respawned, but get reassigned with a different IP. It seems like the c++ driver is able to get the new endpoints from the DNS without any additional code. However in such a situation the connection is not closed on the client side, and it looks like the previous endpoints remain in the connection pool on some level. This leads to a series of log events similar to the following:</p>\n\n<pre><code>1531920921.161 [WARN] (src/pool.cpp:420:virtual void cass::Pool::on_close(cass::Connection*)): Connection pool was unable to reconnect to host XXX.XXX.XXX.XX because of the following error: Connection timeout\n</code></pre>\n\n<p>and</p>\n\n<pre><code>1531920921.894 [WARN] (src/pool.cpp:420:virtual void cass::Pool::on_close(cass::Connection*)): Connection pool was unable to reconnect to host XXX.XXX.XXX.XX because of the following error: Connect error 'host is unreachable'\n</code></pre>\n\n<p>Which pop up every [reconnect timeout]. The more IP reassignments, the more log messages, which as you can guess can get to a pretty large number for long lived applications.</p>\n\n<p>Is there some feature of the driver's API that allows dealing with that? Or a good/recommended way to handle that client side, more generally? One option, external to the driver, could be to reset the connection within the client code, but (although I may be missing out) I fail to see a way to \"catch\" such events : they only show up in the logs.</p>\n"}, {"tags": ["java", "android", "c++", "java-native-interface"], "comments": [{"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1531928592, "post_id": 51403985, "comment_id": 89783153, "body": "Where do you get things like <code>t.classID</code> and <code>t.methodID</code>?"}, {"owner": {"reputation": 6651, "user_id": 1264375, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e0b81876ca5b35253893f82ffbc7162e?s=128&d=identicon&r=PG", "display_name": "Makalele", "link": "https://stackoverflow.com/users/1264375/makalele"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1531983431, "post_id": 51403985, "comment_id": 89803509, "body": "This is a standard cocos2d-x JNI template."}], "answers": [{"comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1531931378, "post_id": 51406811, "comment_id": 89784944, "body": "Well, a <code>jclass</code> as returned by <code>FindClass</code> is a local reference. Method/field IDs arent&#39; though."}, {"owner": {"reputation": 6651, "user_id": 1264375, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e0b81876ca5b35253893f82ffbc7162e?s=128&d=identicon&r=PG", "display_name": "Makalele", "link": "https://stackoverflow.com/users/1264375/makalele"}, "edited": false, "score": 0, "creation_date": 1531984351, "post_id": 51406811, "comment_id": 89804010, "body": "Even if I don&#39;t delete stuff it still crashes."}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 0, "last_activity_date": 1531931495, "last_edit_date": 1531931495, "creation_date": 1531930932, "answer_id": 51406811, "question_id": 51403985, "link": "https://stackoverflow.com/questions/51403985/jni-detected-error-in-application-use-of-deleted-local-reference-0x1/51406811#51406811", "title": "JNI DETECTED ERROR IN APPLICATION: use of deleted local reference 0x1", "body": "<p>A <code>jmethodid</code> is not a <code>jobject</code> and does not need to (cannot) be deleted.</p>\n"}, {"tags": [], "owner": {"reputation": 6651, "user_id": 1264375, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e0b81876ca5b35253893f82ffbc7162e?s=128&d=identicon&r=PG", "display_name": "Makalele", "link": "https://stackoverflow.com/users/1264375/makalele"}, "is_accepted": false, "score": 0, "last_activity_date": 1531990232, "last_edit_date": 1531990232, "creation_date": 1531984622, "answer_id": 51416571, "question_id": 51403985, "link": "https://stackoverflow.com/questions/51403985/jni-detected-error-in-application-use-of-deleted-local-reference-0x1/51416571#51416571", "title": "JNI DETECTED ERROR IN APPLICATION: use of deleted local reference 0x1", "body": "<p>After a lot of trials&amp;errors I've finally fixed it.</p>\n\n<p>I don't know why, but when jstrings are first parameters it works. If I put something (like an int) before any string app will crash. Code below is the solution:</p>\n\n<pre><code>void NativeHelper::mathSendResults(int kidId, int points, int correct, int error, float time,\n                            std::string date, long timestamp, std::string description,\n                            std::string settings, int classNumber, int level, float percentage) {\n\n//    final String date, final String description, final String settings,\n//    final int kidId, final int points, final int correct, final int error, final int classNumber, final int level,\n//    final float percentage, final float time,\n//    final long timestamp\n\n    cocos2d::JniMethodInfo t;\n    if (cocos2d::JniHelper::getStaticMethodInfo(t, AppActivityClassName, \"mathSendResults\",\n                                                \"(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;IIIIIIFFJ)V\")){\n\n        jstring jdate = t.env-&gt;NewStringUTF(date.c_str());\n        jstring jdescription = t.env-&gt;NewStringUTF(description.c_str());\n        jstring jsettings = t.env-&gt;NewStringUTF(settings.c_str());\n\n        t.env-&gt;CallStaticVoidMethod(t.classID, t.methodID,\n                                    jdate, jdescription, jsettings,\n                                    kidId, points, correct, error, classNumber, level,\n                                    percentage, time,\n                                    timestamp);\n\n        t.env-&gt;DeleteLocalRef(t.classID);\n        t.env-&gt;DeleteLocalRef(jdate);\n        t.env-&gt;DeleteLocalRef(jdescription);\n        t.env-&gt;DeleteLocalRef(jsettings);\n    }\n}\n</code></pre>\n\n<p>Java:</p>\n\n<pre><code>public static void mathSendResults(final String date, final String description, final String settings,\n                                   final int kidId, final int points, final int correct, final int error, final int classNumber, final int level,\n                                   final float percentage, final float time,\n                                   final long timestamp)\n</code></pre>\n\n<p>It's still a mystery to me why the order matters.</p>\n\n<p>edit: Updated the code. Actually first version didn't work properly. Some int variables had incorrect (random) values in Java code. I had to sort parameters via type and then it finally worked.</p>\n"}], "owner": {"reputation": 6651, "user_id": 1264375, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e0b81876ca5b35253893f82ffbc7162e?s=128&d=identicon&r=PG", "display_name": "Makalele", "link": "https://stackoverflow.com/users/1264375/makalele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4683, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1531990232, "creation_date": 1531922334, "question_id": 51403985, "link": "https://stackoverflow.com/questions/51403985/jni-detected-error-in-application-use-of-deleted-local-reference-0x1", "title": "JNI DETECTED ERROR IN APPLICATION: use of deleted local reference 0x1", "body": "<p>I've got Java function, which declaration looks like this:</p>\n\n<pre><code>public static void mathSendResults(final int kidId, final int points, final int correct, final int error, final float time,\n                                       final String date, final long timestamp, final String description,\n                                       final String settings, final int classNumber, final int level, final float percentage)\n</code></pre>\n\n<p>Now, I want to call this function through JNI:</p>\n\n<pre><code>void NativeHelper::mathSendResults(int kidId, int points, int correct, int error, float time,\n                            std::string date, long timestamp, std::string description,\n                            std::string settings, int classNumber, int level, float percentage) {\n\n    cocos2d::JniMethodInfo t;\n    if (cocos2d::JniHelper::getStaticMethodInfo(t, AppActivityClassName, \"mathSendResults\",\n                                                \"(IIIIFLjava/lang/String;JLjava/lang/String;Ljava/lang/String;IIF)V\")){\n\n        jstring jdate = t.env-&gt;NewStringUTF(date.c_str());\n        jstring jdescription = t.env-&gt;NewStringUTF(description.c_str());\n        jstring jsettings = t.env-&gt;NewStringUTF(settings.c_str());\n\n        t.env-&gt;CallStaticVoidMethod(t.classID, t.methodID, kidId, points, correct, error, time,\n                                    jdate, timestamp, jdescription,\n                                    jsettings, classNumber, level, percentage);\n\n        t.env-&gt;DeleteLocalRef(t.classID);\n        t.env-&gt;DeleteLocalRef(jdate);\n        t.env-&gt;DeleteLocalRef(jdescription);\n        t.env-&gt;DeleteLocalRef(jsettings);\n    }\n}\n</code></pre>\n\n<p>It should work, but app crashes with the following error:</p>\n\n<pre><code>JNI DETECTED ERROR IN APPLICATION: use of deleted local reference 0x1\n</code></pre>\n\n<p>Which looks very strange to me. I've tried removing <code>DeleteLocalRef</code> calls, but it still crashes. I've already have working other method, but with less parameters. I'm not sure if that's the reason. Anyway I've tried replacing string with ints (just for testing) so the number of parameters didn't change and it worked. So it's definitely an issue with string objects. I've also tried sending empty strings, but result is the same (so it's unrelated to string contents). I've also tried to reduce number of strings to just one, but it still crashes.</p>\n"}, {"tags": ["c++", "dll", "installation"], "comments": [{"owner": {"reputation": 3837, "user_id": 1749713, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/PqPOy.png?s=128&g=1", "display_name": "Micha\u0142 Walenciak", "link": "https://stackoverflow.com/users/1749713/micha%c5%82-walenciak"}, "edited": false, "score": 1, "creation_date": 1531922261, "post_id": 51403868, "comment_id": 89778739, "body": "If you want your library to be used in as many platforms/systems/compilers as possible, make it open source and use CMake as build system."}, {"owner": {"reputation": 3140, "user_id": 1463557, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/52qXF.gif?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/1463557/madscientist"}, "edited": false, "score": 0, "creation_date": 1531922959, "post_id": 51403868, "comment_id": 89779209, "body": "Why a dll? Could you turn it into a static library instead?"}, {"owner": {"reputation": 480, "user_id": 6459731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/179e020f0454f24c41c44ee25084bdcb?s=128&d=identicon&r=PG&f=1", "display_name": "WARhead", "link": "https://stackoverflow.com/users/6459731/warhead"}, "edited": false, "score": 0, "creation_date": 1531923428, "post_id": 51403868, "comment_id": 89779522, "body": "Still even if it is a static library how would you deploy it"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1531924373, "post_id": 51403868, "comment_id": 89780248, "body": "As a <i>static</i> library, the code becomes part of the executable.  No need to deploy a static library."}, {"owner": {"reputation": 480, "user_id": 6459731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/179e020f0454f24c41c44ee25084bdcb?s=128&d=identicon&r=PG&f=1", "display_name": "WARhead", "link": "https://stackoverflow.com/users/6459731/warhead"}, "edited": false, "score": 0, "creation_date": 1531924463, "post_id": 51403868, "comment_id": 89780312, "body": "I am not deploying an executable rather a library that can be used for multiple executables"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1531925044, "post_id": 51403868, "comment_id": 89780708, "body": "<i>&quot;multiple executables&quot;</i> - well, only those compiled with same compiler and version! With different versions, you are likely doomed to run into implementation incompatibilities..."}, {"owner": {"reputation": 480, "user_id": 6459731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/179e020f0454f24c41c44ee25084bdcb?s=128&d=identicon&r=PG&f=1", "display_name": "WARhead", "link": "https://stackoverflow.com/users/6459731/warhead"}, "edited": false, "score": 0, "creation_date": 1531925114, "post_id": 51403868, "comment_id": 89780761, "body": "So I&#39;m better of not deploying an independent DLL? And only release it with an executable?"}], "answers": [{"comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1531924826, "post_id": 51404546, "comment_id": 89780563, "body": "Had to work with COM quite some while ago. Ugly API... If conversions are not too complex, I personally would prefer creating a C-compatible library interface (<code>extern &quot;C&quot;</code> for exported functions) instead. Makes porting to other systems more easy as well."}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 2, "last_activity_date": 1531923897, "creation_date": 1531923897, "answer_id": 51404546, "question_id": 51403868, "link": "https://stackoverflow.com/questions/51403868/how-to-deploy-a-c-dll/51404546#51404546", "title": "How To Deploy a C++ DLL", "body": "<p>You can't deploy a C++ DLL for all compilers. C++ doesn't have an ABI. Not even MSVC++ is compatible across versions, let alone compilers from different vendors.</p>\n\n<p>The Windows solution for binary compatibility is COM. Conveniently, MSVC++ will use the COM ABI for classes that inherit from <code>IUnknown</code>, although you'll also have to adhere to other COM rules for full compatibility. E.g. you can't rely on <code>dynamic_cast</code>, you need <code>QueryInterface</code>.</p>\n"}], "owner": {"reputation": 480, "user_id": 6459731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/179e020f0454f24c41c44ee25084bdcb?s=128&d=identicon&r=PG&f=1", "display_name": "WARhead", "link": "https://stackoverflow.com/users/6459731/warhead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531923897, "creation_date": 1531922060, "question_id": 51403868, "link": "https://stackoverflow.com/questions/51403868/how-to-deploy-a-c-dll", "title": "How To Deploy a C++ DLL", "body": "<p>I have written a dll in visual studio community 2017. To be used as a general purpose library. Which could be ideally used for any c++ program for any compiler.\nHow will I best deploy it. (An installer)</p>\n\n<p>In Visual Studio, I can simply add the project and reference it through settings in my IDE, but for it to work in any IDE, what kind of installer project should i use and what all files should be included and how.</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 2, "creation_date": 1531922195, "post_id": 51403827, "comment_id": 89778696, "body": "That\u2019s a linking error because you didn\u2019t define the method <code>coppy</code> of <code>Test</code>, you only defined a function with that name. You forgot the <code>Test::</code> it has to be <code>void Test::coppy( int zahl) {</code>"}, {"owner": {"reputation": 549, "user_id": 6911200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05be3c3f1ae8e8eaab9648064182b932?s=128&d=identicon&r=PG&f=1", "display_name": "NelDav", "link": "https://stackoverflow.com/users/6911200/neldav"}, "reply_to_user": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 0, "creation_date": 1531922632, "post_id": 51403827, "comment_id": 89778990, "body": "Oh no so easy, ofcours you are right I didn&#39;t expectet such an easy solution."}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 9602261, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Eugene Mart", "link": "https://stackoverflow.com/users/9602261/eugene-mart"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1531922560, "post_id": 51403950, "comment_id": 89778934, "body": "He wrote void coppy(int zahl), not void Test::coppy(int zahl)"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1531922778, "post_id": 51403950, "comment_id": 89779096, "body": "Ha, you&#39;ve definitely been more attendant than me... You might hint more clearly to the missing scope, though..."}, {"owner": {"reputation": 185, "user_id": 9602261, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Eugene Mart", "link": "https://stackoverflow.com/users/9602261/eugene-mart"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1531923046, "post_id": 51403950, "comment_id": 89779268, "body": "Ah, sorry. Probably I should."}], "tags": [], "owner": {"reputation": 185, "user_id": 9602261, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Eugene Mart", "link": "https://stackoverflow.com/users/9602261/eugene-mart"}, "is_accepted": true, "score": 1, "last_activity_date": 1531922237, "creation_date": 1531922237, "answer_id": 51403950, "question_id": 51403827, "link": "https://stackoverflow.com/questions/51403827/how-to-call-a-method-from-a-class-in-qt/51403950#51403950", "title": "How to call a method from a class in qt?", "body": "<pre><code>void Test::coppy(int zahl)\n{\n    tata = zahl;\n}\n</code></pre>\n\n<p>It must be in your cpp file.</p>\n\n<p>And I suggest you to make int tata a class member</p>\n"}, {"tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": false, "score": 2, "last_activity_date": 1531922624, "creation_date": 1531922624, "answer_id": 51404100, "question_id": 51403827, "link": "https://stackoverflow.com/questions/51403827/how-to-call-a-method-from-a-class-in-qt/51404100#51404100", "title": "How to call a method from a class in qt?", "body": "<p><code>void coppy(int zahl)</code> defines a new function in your .cpp file. The compiler doesn't see any relation between this function and <code>Test</code>'s <code>coppy</code> function. To define a <code>class</code> member function you need to use the full member name, including the <code>class</code> name. Try the following instead :</p>\n\n<pre><code>void Test::coppy(int zahl)\n//   ^^^^ Add the class name here\n{\n    tata = zahl;\n}\n</code></pre>\n"}], "owner": {"reputation": 549, "user_id": 6911200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05be3c3f1ae8e8eaab9648064182b932?s=128&d=identicon&r=PG&f=1", "display_name": "NelDav", "link": "https://stackoverflow.com/users/6911200/neldav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 1, "accepted_answer_id": 51403950, "answer_count": 2, "score": 0, "last_activity_date": 1531922624, "creation_date": 1531921959, "last_edit_date": 1531922496, "question_id": 51403827, "link": "https://stackoverflow.com/questions/51403827/how-to-call-a-method-from-a-class-in-qt", "title": "How to call a method from a class in qt?", "body": "<p>I made a class in qt the the following code is the header:</p>\n\n<pre><code>#ifndef TEST_H\n#define TEST_H\n\n\nclass Test {\npublic:\n    Test();\n    void coppy(int zahl);\n};\n\n#endif // TEST_H\n</code></pre>\n\n<p>The methods are initialized in the .cpp file:</p>\n\n<pre><code>#include \"test.h\"\n\nint tata;\nTest::Test()\n{\n}\n\nvoid coppy(int zahl)\n{\n    tata = zahl;\n}\n</code></pre>\n\n<p>And I want to call the coppy method in a second class when I press a button like this:</p>\n\n<pre><code>void MainWindow::on_pushButton_2_clicked()\n{\n    Test *t = new Test();\n    t-&gt;coppy(5);\n}\n</code></pre>\n\n<p>But I always get the following error: undefined reference to `Test::coppy(int)'</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c#", "c++", "uwp", "windows-iot-core-10", "app-launcher"], "comments": [{"owner": {"reputation": 2034, "user_id": 2486496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rpd3r.jpg?s=128&g=1", "display_name": "gravity", "link": "https://stackoverflow.com/users/2486496/gravity"}, "edited": false, "score": 0, "creation_date": 1531923278, "post_id": 51403787, "comment_id": 89779420, "body": "There&#39;s not a lot of detail here showing what you&#39;ve attempted (explicitly) along with what&#39;s not working.  Some screenshots, and code would be helpful to understand exactly what you&#39;re attempting to do.  Consider reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and try to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> if you can please."}], "answers": [{"tags": [], "owner": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "is_accepted": true, "score": 0, "last_activity_date": 1531989389, "last_edit_date": 1531989389, "creation_date": 1531988871, "answer_id": 51417843, "question_id": 51403787, "link": "https://stackoverflow.com/questions/51403787/windows-iot-core-launcher-with-navbar/51417843#51417843", "title": "Windows IoT Core launcher with Navbar", "body": "<p>AFAIK, this can not be done on Windows IoT Core because either launcher app or launched app is running as a foreground app itself and there is only one foreground hold the whole UI in hand. So \"leave some space for my navigation bar\" seems impossible.</p>\n\n<p>But as a workaround, you can add the launcher app's (like home app in the following sample) URI or its display name and description get from AppListEntry API to others apps you are going to launch, so the newly launched app can get chance to go back to the launcher app. Like this sample do: \"<a href=\"https://github.com/ms-iot/samples/tree/4638a5d7d2d131b8b56659de88c284d8f2d71cfa/IoTHomeAppSample#iothomeapp\" rel=\"nofollow noreferrer\">IoTHomeApp</a>\".</p>\n\n<p>ShellHomeApp:\n<a href=\"https://i.stack.imgur.com/7nNfS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7nNfS.png\" alt=\"enter image description here\"></a></p>\n\n<p>OemApp2:</p>\n\n<p><a href=\"https://i.stack.imgur.com/KFk4h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KFk4h.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 9957323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee3ea1ac50858604381e9ea2e77daf6?s=128&d=identicon&r=PG&f=1", "display_name": "Riccardo", "link": "https://stackoverflow.com/users/9957323/riccardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 51417843, "answer_count": 1, "score": -1, "last_activity_date": 1531989389, "creation_date": 1531921850, "last_edit_date": 1531926319, "question_id": 51403787, "link": "https://stackoverflow.com/questions/51403787/windows-iot-core-launcher-with-navbar", "title": "Windows IoT Core launcher with Navbar", "body": "<p>I am working on a project with Windows 10 IoT Core and I have recently managed to launch an UWP app from another one by using <code>Windows.ApplicationModel.Core.AppListEntry.LaunchAsync()</code>.<br>\nMy test launcher is the one used in Microsoft's IoT Examples, with some minor UI changes. The code I use for launching an app is:  </p>\n\n<pre><code>void MainPage::StackPanel_Tapped(Object^ sender, TappedRoutedEventArgs^ e) {\n    auto appItem = dynamic_cast&lt;AppListItem^&gt;(appList-&gt;SelectedItem);\n    if (appItem) {\n        appItem-&gt;AppEntry-&gt;LaunchAsync();\n    } \n}\n</code></pre>\n\n<p>(the same code can be found <a href=\"https://github.com/Microsoft/Windows-iotcore-samples/tree/develop/Samples/IoTStartApp\" rel=\"nofollow noreferrer\">here</a>)  </p>\n\n<p>The app list is populated using the PackageManager API, as shown in the sample project \"IoTStartApp\" linked above.\nWhen I tap an item, the correspondent application is started covering the entire screen.<br>\nSince I don't have any external device apart from a touchscreen display, I would like to integrate the navigation buttons (Home and Back) in my launcher.\nSo the actual question is, do the actual UWP APIs allow to launch another UWP app inside an area of my launcher, in order to leave some space for my navigation bar? (Like a frame, but instead of showing a page from the current app it should contain a page of another application).<br>\nMy idea is to start an app with an argument telling where to start, like <code>LaunchInContainerAsync(Frame frame)</code>, where frame is my container (imagine a page with only this container and my two navigation buttons at the bottom, in another grid). XAML would be something like this:  </p>\n\n<pre><code>&lt;Grid&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"*\"/&gt;\n        &lt;RowDefinition Height=\"30\"/&gt;\n    &lt;/Grid.RowDefinitions&gt;\n    &lt;Frame x:Name=\"ApplicationFrame\" Grid.Row=\"0\" Margin=\"0\"/&gt;\n    &lt;Grid x:Name=\"NavBar\" Grid.Row=\"1\" Margin=\"0\"&gt;\n        &lt;!-- Here are my other UI elements that should stay visible during the execution of the \"launched\" application, such as navigation buttons. --&gt;\n    &lt;/Grid&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p>I'm asking this because I remember (but I'm surely wrong) that there were some examples from Microsoft showing this kind of application launching solution, but now they migrated (and eventually removed) many examples and wiki pages from their documentation and GitHub repos.\nIf this isn't possible, what are some other navigation solutions? Has somebody successfully created a launcher for Windows 10 IoT Core that works only with a touchscreen display?</p>\n"}, {"tags": ["c++", "opencv"], "comments": [{"owner": {"reputation": 3018, "user_id": 44390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9d94e885a0f4ea815305eaf29313cf84?s=128&d=identicon&r=PG", "display_name": "mskfisher", "link": "https://stackoverflow.com/users/44390/mskfisher"}, "edited": false, "score": 0, "creation_date": 1531922153, "post_id": 51403715, "comment_id": 89778668, "body": "The screenshot links don&#39;t appear to show what you&#39;re describing - can you try to upload them to Stack Overflow using the image upload button?"}, {"owner": {"reputation": 61, "user_id": 10099955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6fd8580174fe2770887ac7fe84f3c98?s=128&d=identicon&r=PG&f=1", "display_name": "MichaelWatling", "link": "https://stackoverflow.com/users/10099955/michaelwatling"}, "reply_to_user": {"reputation": 3018, "user_id": 44390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9d94e885a0f4ea815305eaf29313cf84?s=128&d=identicon&r=PG", "display_name": "mskfisher", "link": "https://stackoverflow.com/users/44390/mskfisher"}, "edited": false, "score": 0, "creation_date": 1531922690, "post_id": 51403715, "comment_id": 89779035, "body": "I cant upload images due to not having enough rep :/ Keeps saying I need 10 rep to post the image directly. I checked the link and it shows it properly if you zoom in, maybe if I change the circle colour it will be easier to see."}, {"owner": {"reputation": 61, "user_id": 10099955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6fd8580174fe2770887ac7fe84f3c98?s=128&d=identicon&r=PG&f=1", "display_name": "MichaelWatling", "link": "https://stackoverflow.com/users/10099955/michaelwatling"}, "reply_to_user": {"reputation": 3018, "user_id": 44390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9d94e885a0f4ea815305eaf29313cf84?s=128&d=identicon&r=PG", "display_name": "mskfisher", "link": "https://stackoverflow.com/users/44390/mskfisher"}, "edited": false, "score": 0, "creation_date": 1531923083, "post_id": 51403715, "comment_id": 89779299, "body": "The circle has been changed to white and the picture should be more zoomed on the area! Any help would be appreciated."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1531923327, "post_id": 51403715, "comment_id": 89779446, "body": "This is just plain inefficient - remember HeadInten` alongside <code>Head</code>, instead of recalculating it every time."}, {"owner": {"reputation": 61, "user_id": 10099955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6fd8580174fe2770887ac7fe84f3c98?s=128&d=identicon&r=PG&f=1", "display_name": "MichaelWatling", "link": "https://stackoverflow.com/users/10099955/michaelwatling"}, "edited": false, "score": 0, "creation_date": 1531923772, "post_id": 51403715, "comment_id": 89779774, "body": "Im completely new to the library, so it was just a hash out to be fair but I can change that now."}, {"owner": {"reputation": 9770, "user_id": 888688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e1a439c266dcf5015373dbeae410ff5?s=128&d=identicon&r=PG", "display_name": "api55", "link": "https://stackoverflow.com/users/888688/api55"}, "edited": false, "score": 0, "creation_date": 1531924233, "post_id": 51403715, "comment_id": 89780122, "body": "<code>grayImg.at&lt;uchar&gt;(j, i)</code> should be <code>grayImg.at&lt;uchar&gt;(i, j)</code> OpenCV uses matrix notation for the cv::Mat functions, this means (row, col) or in cartesian coordinates language (y,x)... I suppose Head is cv::Point which actually uses cartesian coordinates so (x,y) .... I know it is confusing, but... it is like that. And <code>.at</code> already gives you an uchar... there is no need to do <code>.val[0]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 10099955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6fd8580174fe2770887ac7fe84f3c98?s=128&d=identicon&r=PG&f=1", "display_name": "MichaelWatling", "link": "https://stackoverflow.com/users/10099955/michaelwatling"}, "edited": false, "score": 0, "creation_date": 1531925697, "post_id": 51404665, "comment_id": 89781169, "body": "Just changed this as suggested, the outcome is the same, I&#39;m going to upload the whole code as well! Thank you for helping though I had no idea it was a YX system"}], "tags": [], "owner": {"reputation": 143, "user_id": 9282907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c16598a88d0cdc2507cdac9ac85d367d?s=128&d=identicon&r=PG&f=1", "display_name": "Benno Geels", "link": "https://stackoverflow.com/users/9282907/benno-geels"}, "is_accepted": false, "score": 1, "last_activity_date": 1531924230, "creation_date": 1531924230, "answer_id": 51404665, "question_id": 51403715, "link": "https://stackoverflow.com/questions/51403715/opencv-pixel-intensities/51404665#51404665", "title": "OpenCV Pixel Intensities", "body": "<p>The Mat.at function needs parameters row , column order.\nSo first Y and then X</p>\n\n<pre><code>int imgHight = grayImg.rows;\nint imgWidth = grayImg.cols;\nint maxX = 0, maxY = 0;\nuint8_t grayMax = grayImg.at&lt;uint8_t&gt;(maxY,maxX);\n\nfor (int i = 0; i &lt; imgHight; i++) //Going through the height or Y axis.\n{                                   // The height and width are equal the image is a square\n    for (int j = 0; j &lt; imgWidth; j++) //  Going through the width or X axis. \n    {\n        uint8_t newInten = grayImg.at&lt;uchar&gt;(i, j); // This uses the X and Y to find a new point\n        if (newInten &gt; grayMax)\n        {\n            grayMax = newInten;\n            maxX = j;\n            maxY = i;\n        }\n    }\n}\n</code></pre>\n\n<p>Also changed the code a bit to make it faster.\nNot the fastest possible option though.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 10099955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6fd8580174fe2770887ac7fe84f3c98?s=128&d=identicon&r=PG&f=1", "display_name": "MichaelWatling", "link": "https://stackoverflow.com/users/10099955/michaelwatling"}, "is_accepted": false, "score": 1, "last_activity_date": 1531930604, "creation_date": 1531930604, "answer_id": 51406711, "question_id": 51403715, "link": "https://stackoverflow.com/questions/51403715/opencv-pixel-intensities/51406711#51406711", "title": "OpenCV Pixel Intensities", "body": "<p>After adding the suggested fixes I swapped the X and Y round the way I would expect them normally for drawing the circle, I also needed to remember to compare maxX to Leftside.y. The outcome is now as expected. Thank you all!</p>\n"}], "owner": {"reputation": 61, "user_id": 10099955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6fd8580174fe2770887ac7fe84f3c98?s=128&d=identicon&r=PG&f=1", "display_name": "MichaelWatling", "link": "https://stackoverflow.com/users/10099955/michaelwatling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1531930604, "creation_date": 1531921682, "last_edit_date": 1531926058, "question_id": 51403715, "link": "https://stackoverflow.com/questions/51403715/opencv-pixel-intensities", "title": "OpenCV Pixel Intensities", "body": "<p>I'm just looking for an explanation behind OpenCV's coordinate system and its pixel intensity system. I am using a for loop to find the most intense pixel on the screen (I am aware that I could use minMaxLoc to find it, however, my code will be changed to find the leftmost pixel as well so this for loop is needed). </p>\n\n<pre><code>for (int i = 0; i &lt; imgHight; i++) //Going through the height or Y axis.\n{                                   // The height and width are equal the image is a square\n    for (int j = 0; j &lt; imgWidth; j++) //  Going through the width or X axis. \n    {\n        newInten = grayImg.at&lt;uchar&gt;(j, i); // This uses the X and Y to find a new point\n        HeadInten = grayImg.at&lt;uchar&gt;(Head); // This uses the stored XY as a comparassion\n        newIntenVal = newInten.val[0]; // This finds the intensity of the pixel at this point\n        if (newIntenVal &gt; LowerBounds) //Compaired to lower bounds (80% of max pixel intensity)\n        {\n\n            if (newIntenVal &gt; HeadIntenVal) // If the new intensity is higher than old then change head to new point and run again.\n            {\n                //cout &lt;&lt; newInten &lt;&lt; \" \" &lt;&lt; HeadInten &lt;&lt; \" \" &lt;&lt; i &lt;&lt; \" \" &lt;&lt; j &lt;&lt; endl;\n                Head = { j, i};\n                HeadIntenVal = HeadInten.val[0]; // Finds the intensity of pixel at stored head.\n\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>I then draw a circle around Head to show its position on the picture. The issue is, that currently, this draws in a random place, but when Head = {i, j} (X and Y are reversed) then this draws in the expected place. Is there any suggestion as to why this might happen?\nIncorrect circle : <a href=\"https://i.stack.imgur.com/zzBB2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zzBB2.png\" alt=\"https://gyazo.com/bc7808c7a9de724a33a587f1524d10f5\"></a>\nCorrect circle: <a href=\"https://i.stack.imgur.com/p7aNJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p7aNJ.png\" alt=\"https://gyazo.com/560a460822a45d24c2dcbae31cd5c8d5\"></a></p>\n\n<p>The problem feeds into trying to find the intensity of that pixel again using the point values of Head, this then gives me a different result and cannot be used for comparison later on.</p>\n\n<p>Many Thanks for any help!</p>\n\n<p>EDIT: Full code - Sorry its a bit of a mess</p>\n\n<pre><code>#include&lt;opencv2/opencv.hpp&gt;\n#include&lt;iostream&gt;\nusing namespace std;\nusing namespace cv;\n\nint main()\n{\n    double IBKG, IMAX, TC, LowerBounds; // IBKG is Image Background Level \n    Intensity, IMAX is Maximum Image Intensity, TC is comet theshold\n    Point IBKG_LOC, IMAX_LOC; // These are the respective locations on the \n    image, head is to find the head of the comet\n\n    Mat img = imread(\"Test1.png\");\n    Mat grayImg;\n    int imgHight = img.rows;\n    int imgWidth = img.cols;\n    cout &lt;&lt; imgHight &lt;&lt; \" \" &lt;&lt; imgWidth &lt;&lt; endl;\n\n    cvtColor(img, grayImg, CV_RGB2GRAY);\n    minMaxLoc(grayImg, &amp;IBKG, &amp;IMAX, &amp;IBKG_LOC, &amp;IMAX_LOC);\n    cout &lt;&lt; IMAX_LOC &lt;&lt; endl;\n    TC = (IBKG + IMAX) / 2;\n    LowerBounds = IMAX * 0.8;\n    cout &lt;&lt; LowerBounds &lt;&lt; endl;\n    uint8_t newInten;\n    int maxX = 0, maxY = 0;\n    uint8_t grayMax = grayImg.at&lt;uint8_t&gt;(maxY, maxX);\n    for (int i = 0; i &lt; imgHight; i++) //Going through the height or Y axis.\n    {                                   // The height and width are equal the image is a square\n        for (int j = 0; j &lt; imgWidth; j++) //  Going through the width or X axis. \n        {\n            uint8_t newInten = grayImg.at&lt;uchar&gt;(i,j); // This uses the X and Y to find a new point\n\n            if (newInten &gt; LowerBounds) //Compaired to lower bounds (80% of max pixel intensity)\n            {\n\n                if (newInten &gt; grayMax) // If the new intensity is higher than old then change head to new point and run again.\n                {\n                grayMax = newInten;\n                maxX = j;\n                maxY = i;\n                }\n            }\n        }\n    }\n\n    Point LeftSide;\n    bool leftSideFlag = false;\n    for (int i = maxX; i &gt; 0; i--)\n    {\n        newInten = grayImg.at&lt;uchar&gt;(maxY, i);\n\n        if (!leftSideFlag)\n        {\n            if (newInten &lt; TC)\n            {\n                LeftSide = { maxY, i};\n                leftSideFlag = true;\n                //i = 1;\n            }\n        }\n    }\n\n    int CircleRadius = maxX - LeftSide.x;\n\n    circle(img, Point(maxY, maxX), 10, Scalar(255, 255, 255));\n\n    cout &lt;&lt; IBKG &lt;&lt;\" \" &lt;&lt; IMAX &lt;&lt; \" \" &lt;&lt; IBKG_LOC &lt;&lt; \" \"  &lt;&lt; IMAX_LOC &lt;&lt; \" \" &lt;&lt; TC &lt;&lt; endl;\n    namedWindow(\"Image\", WINDOW_NORMAL);\n    namedWindow(\"Gray Image\", WINDOW_NORMAL);\n    imshow(\"Image\", img);\n    imshow(\"Gray Image\", grayImg);\n\n    waitKey(0);\n    return 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c++", "qt", "serialization", "qdatastream"], "answers": [{"comments": [{"owner": {"reputation": 571, "user_id": 6109408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/okBQo.jpg?s=128&g=1", "display_name": "twodee", "link": "https://stackoverflow.com/users/6109408/twodee"}, "edited": false, "score": 0, "creation_date": 1531923715, "post_id": 51404296, "comment_id": 89779743, "body": "Hi, thanks for your input. Could you please be a bit more elaborate? I also require a way to properly deserialize the data. Please explain a bit more so that its a little bit clearer. Also, I would like to create a new list based on the serialized data that I can read. If you could provide me an example for that, it would be great."}, {"owner": {"reputation": 706, "user_id": 4070330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5de272559ba2ec727fe9b3108afa222f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Kashpur", "link": "https://stackoverflow.com/users/4070330/andrew-kashpur"}, "reply_to_user": {"reputation": 571, "user_id": 6109408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/okBQo.jpg?s=128&g=1", "display_name": "twodee", "link": "https://stackoverflow.com/users/6109408/twodee"}, "edited": false, "score": 0, "creation_date": 1531924262, "post_id": 51404296, "comment_id": 89780142, "body": "you define &lt;&lt; and &gt;&gt; operators in base class. operators use virtual functions serialize and deserialize. Then you provide implementations to these functions ( if required ) in derived classes. And so you can use &lt;&lt; and &gt;&gt; on derived classes. (The compiler will perform cast to base class and deduce correct serialize/deserialize function by itself if I am correct)"}, {"owner": {"reputation": 571, "user_id": 6109408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/okBQo.jpg?s=128&g=1", "display_name": "twodee", "link": "https://stackoverflow.com/users/6109408/twodee"}, "edited": false, "score": 0, "creation_date": 1531924507, "post_id": 51404296, "comment_id": 89780348, "body": "That looks like a nice way to deal with it, I will try that out and get back to you. Thank you. :D"}, {"owner": {"reputation": 706, "user_id": 4070330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5de272559ba2ec727fe9b3108afa222f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Kashpur", "link": "https://stackoverflow.com/users/4070330/andrew-kashpur"}, "reply_to_user": {"reputation": 571, "user_id": 6109408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/okBQo.jpg?s=128&g=1", "display_name": "twodee", "link": "https://stackoverflow.com/users/6109408/twodee"}, "edited": false, "score": 0, "creation_date": 1531926977, "post_id": 51404296, "comment_id": 89782092, "body": "@2dsharp I modified my answer (added desirialization). at first I did not consider the fact that size of list and type of elements should be stored when serializing."}, {"owner": {"reputation": 571, "user_id": 6109408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/okBQo.jpg?s=128&g=1", "display_name": "twodee", "link": "https://stackoverflow.com/users/6109408/twodee"}, "edited": false, "score": 0, "creation_date": 1531951860, "post_id": 51404296, "comment_id": 89794994, "body": "Thank you very much, this code actually worked without me having to change a lot of things. All I had to do was overload the operators for  <code>QList&lt;Layer*&gt;</code> and put the iteration."}], "tags": [], "owner": {"reputation": 706, "user_id": 4070330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5de272559ba2ec727fe9b3108afa222f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Kashpur", "link": "https://stackoverflow.com/users/4070330/andrew-kashpur"}, "is_accepted": false, "score": 3, "last_activity_date": 1531927190, "last_edit_date": 1531927190, "creation_date": 1531923225, "answer_id": 51404296, "question_id": 51403419, "link": "https://stackoverflow.com/questions/51403419/how-do-i-properly-serialize-and-deserialize-a-qlist-class-in-qt-using-qdatastrea/51404296#51404296", "title": "How do I properly serialize and deserialize a QList class in QT using QDatastream?", "body": "<p>I hope the following example will give you general idea:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;list&gt;\n\nclass A{\n    int a=0;\npublic:\n    virtual int type(){return 0;}\n    virtual void serialize(std::ostream&amp; stream)const{\n        stream&lt;&lt;a&lt;&lt;std::endl;\n    }\n    virtual void deserialize(std::istream&amp; stream){\n        stream&gt;&gt;a;\n    }\n\n    friend std::ostream&amp; operator &lt;&lt;(std::ostream&amp; stream, const A&amp; object){\n        object.serialize(stream);\n        return stream;\n    }\n    friend std::istream&amp; operator &gt;&gt;(std::istream&amp; stream, A&amp; object){\n        object.deserialize(stream);\n        return stream;\n    }\n\n    virtual ~A(){}\n};\n\nclass B : public A{\n  int b=1;\npublic:\n  virtual int type(){return 1;}\n  virtual void serialize(std::ostream&amp; stream)const{\n      A::serialize(stream);\n      stream&lt;&lt;b&lt;&lt;std::endl;\n  }\n  virtual void deserialize(std::istream&amp; stream){\n      A::deserialize(stream);\n      stream&gt;&gt;b;\n  }\n};\n\nclass C : public A{\n  int c=2;\npublic:\n  virtual int type(){return 2;}\n  virtual void serialize(std::ostream&amp; stream)const{\n      A::serialize(stream);\n      stream&lt;&lt;c&lt;&lt;std::endl;\n  }\n  virtual void deserialize(std::istream&amp; stream){\n      A::deserialize(stream);\n      stream&gt;&gt;c;\n  }\n};\n\nstd::ostream&amp; operator &lt;&lt;(std::ostream&amp; stream, const std::list&lt;A*&gt;&amp; l){\n    stream&lt;&lt;l.size()&lt;&lt;std::endl;\n    for(auto&amp; a_ptr: l){\n        stream&lt;&lt;a_ptr-&gt;type()&lt;&lt;std::endl;\n        stream&lt;&lt;*a_ptr;\n    }\n}\nstd::istream&amp; operator &gt;&gt;(std::istream&amp; stream, std::list&lt;A*&gt;&amp; l){\n    l.clear();\n    int size, type;\n    stream&gt;&gt;size;\n    A* tmp;\n    for(int i =0; i&lt;size; ++i){\n        stream&gt;&gt;type;\n        if(type==0){\n           tmp = new A;\n        }\n        if(type==1){\n           tmp = new B;\n        }\n        if(type==2){\n           tmp = new C;\n        }\n        stream&gt;&gt;(*tmp);\n        l.push_back(tmp);\n    }\n    return stream;\n}\n\n\nint main(){\n    A* a = new A;\n    A* b = new B;\n    A* c = new C;\n    std::list&lt;A*&gt; List{ a, b, c };\n    std::list&lt;A*&gt; List2;\n    std::ofstream ofs(\"D:\\\\temp.txt\");\n    ofs&lt;&lt;List;\n    ofs.flush();\n    ofs.close();\n\n    std::ifstream ifs(\"D:\\\\temp.txt\");\n    ifs&gt;&gt;List2;\n    std::cout&lt;&lt;List2;\n    for(auto&amp; a_ptr : List2){\n        delete a_ptr;\n    }\n    delete c;\n    delete b;\n    delete a;\n    return 0;\n}\n</code></pre>\n\n<p>Edit: at I did not consider the fact that when serializing list we should write size of list and type of elements for succesfull deserialization, so I modified example.</p>\n"}, {"comments": [{"owner": {"reputation": 571, "user_id": 6109408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/okBQo.jpg?s=128&g=1", "display_name": "twodee", "link": "https://stackoverflow.com/users/6109408/twodee"}, "edited": false, "score": 0, "creation_date": 1531928722, "post_id": 51405847, "comment_id": 89783234, "body": "Hi, thanks for the detailed answer. My version seems to have a problem for <code>Layer</code> to create an instance of <code>RasterLayer</code> using <code>new</code>. Including rasterlayer.h in layer.h would create a cyclic dependency. Could you tell me how to go about this problem?"}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "reply_to_user": {"reputation": 571, "user_id": 6109408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/okBQo.jpg?s=128&g=1", "display_name": "twodee", "link": "https://stackoverflow.com/users/6109408/twodee"}, "edited": false, "score": 0, "creation_date": 1531929895, "post_id": 51405847, "comment_id": 89784076, "body": "You don&#39;t need to include rasterlayer.h in layer.h, because the implementations belong in <code>layer.cpp</code>, not <code>layer.h</code>. I&#39;ve also updated the answer to follow the conventions of <code>QListWidgetItem</code>."}, {"owner": {"reputation": 571, "user_id": 6109408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/okBQo.jpg?s=128&g=1", "display_name": "twodee", "link": "https://stackoverflow.com/users/6109408/twodee"}, "edited": false, "score": 0, "creation_date": 1531951972, "post_id": 51405847, "comment_id": 89795033, "body": "Hi, it was very helpful. Although I see a lot of extra code added here to make my version compatible with QListWidgetItem. But I am kind of having a hard time understanding the requirements and usages of the things like MetaType stream operators and stuff."}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "reply_to_user": {"reputation": 571, "user_id": 6109408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/okBQo.jpg?s=128&g=1", "display_name": "twodee", "link": "https://stackoverflow.com/users/6109408/twodee"}, "edited": false, "score": 0, "creation_date": 1531958126, "post_id": 51405847, "comment_id": 89796596, "body": "@2dsharp I&#39;ve now submitted a complete example. You can also fetch it from github. It demonstrates how the derived types are fairly simple, and also demonstrates the use of it all."}], "tags": [], "owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1533007306, "last_edit_date": 1533007306, "creation_date": 1531927829, "answer_id": 51405847, "question_id": 51403419, "link": "https://stackoverflow.com/questions/51403419/how-do-i-properly-serialize-and-deserialize-a-qlist-class-in-qt-using-qdatastrea/51405847#51405847", "title": "How do I properly serialize and deserialize a QList class in QT using QDatastream?", "body": "<p>To address your need: The typical way to do it is to exploit the polymorphism.</p>\n\n<p>The base class (<code>QListWidgetItem</code>) has an interface to perform serialization and deserialization. We can leverage it to implement (de)serialization of pointers to derived types. Serialization invokes an interface implemented in derived classes to serialize derived-specific data. Deserialization first uses a type-specific factory to create an instance of the derived type, and only then invokes the deserialization interface implemented in the derived class - using the base class's operator.</p>\n\n<p>Once the serialization and deserialization of the base type is implemented, <code>QList</code> and <code>QVariant</code> (!) should work as well.</p>\n\n<p>You should not be implementing your own type storage - <code>QListWidgetItem</code> already provides it for you!</p>\n\n<p>The <code>Layer</code> class is the abstract foundation for the classes that derive from <code>QGraphicsItem</code>. The <code>typeId()</code> and <code>typeName()</code> methods leverage the metatype type system. The derived class should pass a <code>typeId</code> (not <code>type()</code>!) to <code>Layer</code>'s constructor.</p>\n\n<pre><code>// https://github.com/KubaO/stackoverflown/tree/master/questions/stream-qwidgetlistitem-51403419\n#include &lt;QtWidgets&gt;\n\nclass Layer : public QListWidgetItem {\npublic:\n   virtual QGraphicsItem *it() = 0;\n   const QGraphicsItem *it() const { return const_cast&lt;Layer*&gt;(this)-&gt;it(); }\n   int typeId() const {\n      if (type() &lt; UserType)\n         return QMetaType::UnknownType;\n      return type() - QListWidgetItem::UserType + QMetaType::User;\n   }\n   const char *typeName() const { return QMetaType::typeName(typeId()); }\n   void write(QDataStream&amp;) const override;\n   void read(QDataStream&amp;) override;\n   QListWidgetItem *clone() const override final;\n\n   void setZValue(int z) { it()-&gt;setZValue(z); }\n   void setParentItem(Layer *parent) { it()-&gt;setParentItem(parent-&gt;it()); }\n   void setParentItem(QGraphicsItem *parent) { it()-&gt;setParentItem(parent); }\n   void setSelected(bool sel) { it()-&gt;setSelected(sel); }\n   void setPos(const QPointF &amp;pos) { it()-&gt;setPos(pos); }\n\n   Layer(const Layer &amp;);\n   QString name() const { return m_name; }\n   void setName(const QString &amp;n) { m_name = n; }\n   ~Layer() override = default;\nprotected:\n   using Format = quint8;\n   Layer(const QString &amp;name, int typeId);\n   static void invalidFormat(QDataStream &amp;);\n   template &lt;typename T&gt; T &amp;assign(const T&amp; o) { return static_cast&lt;T&amp;&gt;(assignLayer(o)); }\nprivate:\n   QString m_name;\n   Layer&amp; assignLayer(const Layer &amp;);\n};\n</code></pre>\n\n<p>The <code>it()</code> helper provides access to the derived <code>QGraphicsItem*</code> type. The basics of the implementation are relatively simple.</p>\n\n<pre><code>Layer::Layer(const Layer &amp;o) : Layer(o.name(), o.typeId()) {}\n\nLayer::Layer(const QString &amp;name, int typeId) :\n   QListWidgetItem(nullptr, typeId - QMetaType::User + QListWidgetItem::UserType),\n   m_name(name)\n{}\n\nQListWidgetItem *Layer::clone() const {\n   const QMetaType mt(typeId());\n   Q_ASSERT(mt.isValid());\n   return reinterpret_cast&lt;QListWidgetItem*&gt;(mt.create(this));\n}\n\nLayer &amp;Layer::assignLayer(const Layer &amp;o) {\n   Q_ASSERT(o.type() == type());\n   const QMetaType mt(typeId());\n   Q_ASSERT(mt.isValid());\n   this-&gt;~Layer();\n   mt.construct(this, &amp;o);\n   return *this;\n}\n</code></pre>\n\n<p>It is important to version the data to ensure backwards-compatibility: newer versions of the software should be able to read data written by older versions. Thus each class maintains its own format indicator. This decouples the format of the <code>Layer</code> class from that of the derived classes. The data types are saved as text to ensure portability in light of potentially changing type ids.</p>\n\n<pre><code>void Layer::write(QDataStream &amp;ds) const {\n   ds &lt;&lt; typeName() &lt;&lt; (Format)0 &lt;&lt; m_name &lt;&lt; it()-&gt;pos();\n   QListWidgetItem::write(ds);\n}\n\nvoid Layer::read(QDataStream &amp;ds) {\n   QByteArray typeName_;\n   Format format_;\n   QPointF pos_;\n   ds &gt;&gt; typeName_ &gt;&gt; format_;\n   if (typeName_.endsWith('\\0')) typeName_.chop(1);\n   Q_ASSERT(typeName_ == typeName());\n   if (format_ &gt;= 0) {\n      ds &gt;&gt; m_name &gt;&gt; pos_;\n      setPos(pos_);\n      QListWidgetItem::read(ds);\n   }\n   if (format_ &gt;= 1)\n      invalidFormat(ds);\n}\n\nvoid Layer::invalidFormat(QDataStream &amp;ds) {\n   ds.setStatus(QDataStream::ReadCorruptData);\n}\n</code></pre>\n\n<p>Qt already provides the stream operators for references to <code>QListWidgetItem</code>. We need to provide stream operators that handle the pointers to that type. The output operator immediately forwards to the reference-taking output operator. The input operator peeks the type of the object stored in the stream, uses the type to look up the metatype id, and instantiates it using <code>QMetaType::create()</code>. Then, it forwards to the reference-taking input operator.</p>\n\n<pre><code>QDataStream &amp;operator&lt;&lt;(QDataStream &amp;ds, const Layer *l) {\n   return ds &lt;&lt; *l;\n}\n\nQByteArray peekByteArray(QDataStream &amp;ds) {\n   qint32 size;\n   auto read = ds.device()-&gt;peek(reinterpret_cast&lt;char*&gt;(&amp;size), sizeof(size));\n   if (read != sizeof(size))\n      return ds.setStatus(QDataStream::ReadPastEnd), QByteArray();\n   if (ds.byteOrder() == QDataStream::BigEndian)\n      size = qFromBigEndian(size);\n   auto buf = ds.device()-&gt;peek(size + 4);\n   if (buf.size() != size + 4)\n      return ds.setStatus(QDataStream::ReadPastEnd), QByteArray();\n   if (buf.endsWith('\\0')) buf.chop(1);\n   return buf.mid(4);\n}\n\nQDataStream &amp;operator&gt;&gt;(QDataStream &amp;ds, Layer *&amp;l) {\n   auto typeName = peekByteArray(ds);\n   int typeId = QMetaType::type(typeName);\n   QMetaType mt(typeId);\n   l = mt.isValid() ? reinterpret_cast&lt;Layer*&gt;(mt.create()) : nullptr;\n   if (l)\n      ds &gt;&gt; *l;\n   else\n      ds.setStatus(QDataStream::ReadCorruptData);\n   return ds;\n}\n</code></pre>\n\n<p>Once the <code>Layer</code> abstract base class is set up, it is simple to implement derived classes:</p>\n\n<pre><code>class RasterLayer : public Layer, public QGraphicsPixmapItem {\npublic:\n   QGraphicsItem *it() override { return this; }\n   int type() const override { return Layer::type(); }\n   RasterLayer &amp;operator=(const RasterLayer &amp;o) { return assign(o); }\n   void write(QDataStream &amp;) const override;\n   void read(QDataStream &amp;) override;\n   RasterLayer(const RasterLayer &amp;);\n   RasterLayer(const QString &amp;name = {});\n};\nQ_DECLARE_METATYPE(RasterLayer)\n\n// implementation\n\nstatic int rasterOps = qRegisterMetaTypeStreamOperators&lt;RasterLayer&gt;();\n\nRasterLayer::RasterLayer(const RasterLayer &amp;o) :\n   Layer(o),\n   QGraphicsPixmapItem(o.pixmap())\n{}\n\nRasterLayer::RasterLayer(const QString &amp;name) : Layer(name, qMetaTypeId&lt;RasterLayer&gt;()) {}\n\nvoid RasterLayer::write(QDataStream &amp;ds) const {\n   Layer::write(ds);\n   ds &lt;&lt; Format(0) &lt;&lt; pixmap();\n}\n\nvoid RasterLayer::read(QDataStream &amp;ds) {\n   Layer::read(ds);\n   Format format_;\n   QPixmap pix_;\n   ds &gt;&gt; format_;\n   if (format_ &gt;= 0) {\n      ds &gt;&gt; pix_;\n      setPixmap(pix_);\n   }\n   if (format_ &gt;= 1)\n      invalidFormat(ds);\n}\n</code></pre>\n\n<p>And, similarly:</p>\n\n<pre><code>class VectorLayer : public Layer, public QGraphicsPathItem {\npublic:\n   QGraphicsItem *it() override { return this; }\n   int type() const override { return Layer::type(); }\n   VectorLayer &amp;operator=(const VectorLayer &amp;o) { return assign(o); }\n   void write(QDataStream &amp;) const override;\n   void read(QDataStream &amp;) override;\n   VectorLayer(const VectorLayer &amp;);\n   VectorLayer(const QString &amp;name = {});\n};\nQ_DECLARE_METATYPE(VectorLayer)\n\n// implementation\n\nstatic int vectorOps = qRegisterMetaTypeStreamOperators&lt;VectorLayer&gt;();\n\nVectorLayer::VectorLayer(const VectorLayer &amp;o) :\n   Layer(o),\n   QGraphicsPathItem(o.path())\n{}\n\nVectorLayer::VectorLayer(const QString &amp;name) : Layer(name, qMetaTypeId&lt;VectorLayer&gt;()) {}\n\nvoid VectorLayer::write(QDataStream &amp;ds) const {\n   Layer::write(ds);\n   ds &lt;&lt; Format(0) &lt;&lt; path();\n}\n\nvoid VectorLayer::read(QDataStream &amp;ds) {\n   Layer::read(ds);\n   Format format_;\n   QPainterPath path_;\n   ds &gt;&gt; format_;\n   if (format_ &gt;= 0) {\n      ds &gt;&gt; path_;\n      setPath(path_);\n   }\n   if (format_ &gt;= 1)\n      invalidFormat(ds);\n}\n</code></pre>\n\n<p>The <code>rasterOps</code> and <code>vectorOps</code> are dummy variables used to register stream operators for the types before <code>main()</code> is entered. They serve no other purpose. Those stream operator registrations are used to interface the types to <code>QVector</code>.</p>\n\n<p>Now we can write a test harness that demonstrates the streaming operations that are supported.</p>\n\n<pre><code>#include &lt;QtTest&gt;\n\nclass LayerTest : public QObject {\n   Q_OBJECT\n   QBuffer buf;\n   QDataStream ds{&amp;buf};\n\nprivate slots:\n   void initTestCase() {\n      buf.open(QIODevice::ReadWrite);\n   }\n\n   void testClone() {\n      RasterLayer raster(\"foo\");\n      QScopedPointer&lt;QListWidgetItem&gt; clone(raster.clone());\n      auto *raster2 = static_cast&lt;RasterLayer*&gt;(clone.data());\n\n      QCOMPARE(raster2-&gt;type(), raster.type());\n      QCOMPARE(raster2-&gt;name(), raster.name());\n   }\n\n   void testValueIO() {\n      ds.device()-&gt;reset();\n      RasterLayer raster(\"foo\");\n      VectorLayer vector(\"bar\");\n      ds &lt;&lt; raster &lt;&lt; vector;\n\n      ds.device()-&gt;reset();\n      RasterLayer raster2;\n      VectorLayer vector2;\n      ds &gt;&gt; raster2 &gt;&gt; vector2;\n\n      QCOMPARE(raster2.name(), raster.name());\n      QCOMPARE(vector2.name(), vector.name());\n   }\n\n   void testPointerIO() {\n      ds.device()-&gt;reset();\n      RasterLayer raster(\"foo\");\n      VectorLayer vector(\"bar\");\n      ds &lt;&lt; &amp;raster &lt;&lt; &amp;vector;\n\n      ds.device()-&gt;reset();\n      Layer *raster2 = {}, *vector2 = {};\n      ds &gt;&gt; raster2 &gt;&gt; vector2;\n\n      QVERIFY(raster2 &amp;&amp; vector2);\n      QCOMPARE(raster2-&gt;typeId(), qMetaTypeId&lt;RasterLayer&gt;());\n      QCOMPARE(vector2-&gt;typeId(), qMetaTypeId&lt;VectorLayer&gt;());\n      QCOMPARE(raster2-&gt;name(), raster.name());\n      QCOMPARE(vector2-&gt;name(), vector.name());\n      delete raster2;\n      delete vector2;\n   }\n\n   void testValueContainerIO() {\n      ds.device()-&gt;reset();\n      QVector&lt;RasterLayer&gt; rasters(2);\n      QList&lt;VectorLayer&gt; vectors;\n      vectors &lt;&lt; VectorLayer() &lt;&lt; VectorLayer();\n      ds &lt;&lt; rasters &lt;&lt; vectors;\n\n      ds.device()-&gt;reset();\n      rasters.clear();\n      vectors.clear();\n      ds &gt;&gt; rasters &gt;&gt; vectors;\n\n      QCOMPARE(rasters.size(), 2);\n      QCOMPARE(vectors.size(), 2);\n   }\n\n   void testPointerConteinerIO() {\n      ds.device()-&gt;reset();\n      RasterLayer raster;\n      VectorLayer vector;\n      QList&lt;Layer*&gt; layers;\n      layers &lt;&lt; &amp;raster &lt;&lt; &amp;vector;\n      ds &lt;&lt; layers;\n\n      ds.device()-&gt;reset();\n      layers.clear();\n      QVERIFY(layers.isEmpty());\n      ds &gt;&gt; layers;\n      QCOMPARE(layers.size(), 2);\n      QVERIFY(!layers.contains({}));\n      qDeleteAll(layers);\n   }\n\n   void testVariantIO() {\n      ds.device()-&gt;reset();\n      RasterLayer raster;\n      VectorLayer vector;\n      auto vr = QVariant::fromValue(raster);\n      auto vv = QVariant::fromValue(vector);\n      ds &lt;&lt; vr &lt;&lt; vv;\n\n      ds.device()-&gt;reset();\n      vv.clear();\n      vr.clear();\n      QVERIFY(vr.isNull() &amp;&amp; vv.isNull());\n      ds &gt;&gt; vr &gt;&gt; vv;\n      QVERIFY(!vr.isNull() &amp;&amp; !vv.isNull());\n      QCOMPARE(vr.userType(), qMetaTypeId&lt;RasterLayer&gt;());\n      QCOMPARE(vv.userType(), qMetaTypeId&lt;VectorLayer&gt;());\n   }\n\n   void testVariantContainerIO() {\n      ds.device()-&gt;reset();\n      QVariantList layers;\n      layers &lt;&lt; QVariant::fromValue(RasterLayer())\n             &lt;&lt; QVariant::fromValue(VectorLayer());\n      ds &lt;&lt; layers;\n\n      ds.device()-&gt;reset();\n      layers.clear();\n      ds &gt;&gt; layers;\n      QCOMPARE(layers.size(), 2);\n      QVERIFY(!layers.contains({}));\n      QCOMPARE(layers.at(0).userType(), qMetaTypeId&lt;RasterLayer&gt;());\n      QCOMPARE(layers.at(1).userType(), qMetaTypeId&lt;VectorLayer&gt;());\n   }\n};\n\nQTEST_MAIN(LayerTest)\n#include \"main.moc\"\n</code></pre>\n\n<p>This concludes the complete, compileable example.</p>\n"}], "owner": {"reputation": 571, "user_id": 6109408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/okBQo.jpg?s=128&g=1", "display_name": "twodee", "link": "https://stackoverflow.com/users/6109408/twodee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1002, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1533007306, "creation_date": 1531920891, "question_id": 51403419, "link": "https://stackoverflow.com/questions/51403419/how-do-i-properly-serialize-and-deserialize-a-qlist-class-in-qt-using-qdatastrea", "title": "How do I properly serialize and deserialize a QList class in QT using QDatastream?", "body": "<p>I am trying to serialize a custom class <code>Layer*</code> and read it back using QDataStream. Now, <code>Layer</code> is an abstract class with virtual method which is inherited by different kinds of layers: <code>RasterLayer</code>, <code>TextLayer</code>, <code>AdjustmentLayer</code> etc.</p>\n\n<p>I have a <code>QList&lt;Layer*&gt; layers</code> which keeps track of all the layers, and any adjustments made to a layer are updated in the list. I need to serialize and deserialize the QList to its original state and restore the properties of the individual layers (of different types).</p>\n\n<p>Here is <strong>layer.h</strong>:</p>\n\n<pre><code>#ifndef LAYER_H\n#define LAYER_H\n\n#include &lt;QString&gt;\n#include &lt;QImage&gt;\n#include &lt;QDebug&gt;\n#include &lt;QListWidgetItem&gt;\n#include &lt;QGraphicsItem&gt;\n#include &lt;QPixmap&gt;\n\nclass Layer : public QListWidgetItem\n{\n\npublic:\n\n    enum LayerType{\n        RASTER,\n        VECTOR,\n        TEXT,\n        ADJUSTMENT\n    };\n\n    Layer(QString name, LayerType type);\n\n    ~Layer();\n    inline void setName(QString &amp;name) { _name = name; }\n    inline QString getName() { return _name; }\n    inline LayerType getType() { return _type; }\n\n    virtual void setSceneSelected(bool select) = 0;\n    virtual void setLayerSelected(bool select) = 0;\n    virtual void setZvalue(int z) = 0;\n    virtual void setParent(QGraphicsItem *parent) = 0;\n\nprotected:\n    QString _name;\n    LayerType _type;\n};\n\n#endif // LAYER_H\n</code></pre>\n\n<p>This is extended by a <strong>RasterLayer</strong> class:</p>\n\n<pre><code>#ifndef RASTERLAYER_H\n#define RASTERLAYER_H\n\n#include &lt;QGraphicsPixmapItem&gt;\n#include &lt;QPainter&gt;\n#include &lt;QGraphicsScene&gt;\n\n#include \"layer.h\"\n\n    class RasterLayer : public Layer, public QGraphicsPixmapItem\n    {\n    public:\n        RasterLayer(const QString &amp;name, const QImage &amp;image);\n        RasterLayer();\n        ~RasterLayer();\n\n        void setLocked(bool lock);\n        void setSceneSelected(bool select);\n        void setLayerSelected(bool select);\n        void setZvalue(int z);\n        void setParent(QGraphicsItem *parent);\n        inline QPixmap getPixmap() const { return pixmap(); }\n        inline QPointF getPos() const { return QGraphicsPixmapItem::pos(); }\n        inline void setLayerPos(QPointF pos) { setPos(pos);}\n        inline void setLayerPixmap(QPixmap pixmap) { setPixmap(pixmap); }\n\n        friend QDataStream&amp; operator&lt;&lt;(QDataStream&amp; ds, RasterLayer *&amp;layer)\n        {\n            ds &lt;&lt; layer-&gt;getPixmap() &lt;&lt; layer-&gt;getName() &lt;&lt; layer-&gt;getPos();\n            return ds;\n        }\n\n        friend QDataStream&amp; operator&gt;&gt;(QDataStream&amp; ds, RasterLayer *layer)\n        {\n            QString name;\n            QPixmap pixmap;\n            QPointF pos;\n\n            ds &gt;&gt; pixmap &gt;&gt; name &gt;&gt; pos;\n\n            layer-&gt;setName(name);\n            layer-&gt;setPixmap(pixmap);\n            layer-&gt;setPos(pos);\n\n            return ds;\n        }\n\n    protected:\n        void paint(QPainter *painter,\n                   const QStyleOptionGraphicsItem *option,\n                   QWidget *widget);\n\n    private:\n        QImage _image;\n    };\n\n    #endif // RASTERLAYER_H\n</code></pre>\n\n<p>I am currently trying to test serialization-deserialization of a <code>RasterLayer</code> like this:</p>\n\n<pre><code>QFile file(fileName);\n\nfile.open(QIODevice::WriteOnly);\nQDataStream out(&amp;file);\n\nLayer *layer = paintWidget-&gt;getItems().at(1);\n// Gets the second element in the list\n\nRasterLayer *raster = dynamic_cast&lt;RasterLayer*&gt; (layer);\nout &lt;&lt; raster;\nfile.close();\n</code></pre>\n\n<p>Now, as you can see here, I am specifically casting <code>Layer*</code> to a <code>RasterLayer*</code>to be serialized, and this works since I have worked on only one type of layer till now. So my first question is: </p>\n\n<p><strong>How do I generalize this serialization process to all types of layers?</strong></p>\n\n<p>Every type of layer will have a different way of serialization since each hold different properties. Also, the casting here feels like a bit of code smell and a possible bad design choice. So, having something like serialize the entire list of layers calling their corresponding overloaded operators would be the expected scenario.</p>\n\n<p>My second question is:</p>\n\n<p><strong>How do I deserialize the data properly?</strong>\nHere's how I am currently serializing an individual <code>RasterLayer</code>:</p>\n\n<pre><code>QFile newFile(fileName);\nnewFile.open(QIODevice::ReadOnly);\nQDataStream in(&amp;newFile);\n\nRasterLayer *layer2 = new RasterLayer;\nin &gt;&gt; layer2;\npaintWidget-&gt;pushLayer(layer2);\nui-&gt;layerView-&gt;updateItems(paintWidget-&gt;getItems());\n</code></pre>\n\n<p>Firstly, I don't think serializing to a pointer is something I should be doing in this case, but I am not sure what else to do or how to do better yet. Secondly, the deserialization works here, but it doesn't quite do what I would be expecting it to do. Although I am using setters in the overloaded operators, it's really not updating the layer properly. I need to call the constructor to make a new layer out of it. </p>\n\n<p>I have tried this: <a href=\"https://stackoverflow.com/questions/2570679/serialization-with-qt\">Serialization with Qt</a> but I am not quite sure how to have a <code>Layer*</code> convert it to a <code>Layer</code>, serialize it, deserialize it and then convert it back to <code>Layer*</code>.\nSo I need to add a third step:</p>\n\n<pre><code>RasterLayer *layer3 = new RasterLayer(layer2-&gt;getName(), layer2-&gt;getPixmap().toImage());\nlayer3-&gt;setPos(layer2-&gt;pos());\n</code></pre>\n\n<p>and then push <code>layer3</code> to the list to actually make it work. According to this post: <a href=\"https://stackoverflow.com/a/23697747/6109408\">https://stackoverflow.com/a/23697747/6109408</a>, I really shouldn't be doing a <code>new RasterLayer...</code> inside the operator overloading function (or else I will fry in hell), and I am following the first suggestion given there, which isn't very much working in my case and I don't know the right way to do it.</p>\n\n<p>Also, how do I deserialize this for a general QList of <code>Layer*</code>s instead of having to create new specific layer instances and injecting them with deserialized data? Although this is similar: <a href=\"https://stackoverflow.com/questions/23202667/serialize-a-class-with-a-qlist-of-custom-classes-as-member-using-qdatastream#23219659\">Serialize a class with a Qlist of custom classes as member (using QDataStream)</a>, the answers weren't clear enough for me to understand.</p>\n\n<p>I have had an idea about an intermediate value holder class that I will use to serialize all sorts of Layers and let that create and inject the parameters depending upon the type of Layer it is, but I am not sure if that will work.</p>\n\n<p>Thanks for helping me out.</p>\n"}, {"tags": ["c++", "operator-overloading", "operators"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1531920319, "post_id": 51403087, "comment_id": 89777197, "body": "Just use <code>std::adressof()</code>"}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 2, "creation_date": 1531920626, "post_id": 51403087, "comment_id": 89777453, "body": "Usually with questions like this, you don&#39;t just need the &quot;I want to&quot;, you also need the &quot;<b>Why</b> I want to&quot;. Because if you are looking to play around the with the language the simple answer is &quot;No you cant do this&quot; and the reason is because it would not be useful and it would be complex to implement."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1531921483, "post_id": 51403087, "comment_id": 89778151, "body": "If you are successful, you will confuse the hell out of people that would read your code.  <i>&quot;Speaking words of wisdom, let it be.&quot;</i>"}, {"owner": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 0, "creation_date": 1531921662, "post_id": 51403087, "comment_id": 89778296, "body": "Technically that&#39;s not called the &quot;and&quot; operator. It&#39;s the <a href=\"https://en.cppreference.com/w/cpp/language/operator_member_access#Built-in_address-of_operator\" rel=\"nofollow noreferrer\">address-of</a> operator"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 0, "creation_date": 1531924410, "post_id": 51403087, "comment_id": 89780267, "body": "@BenJones: To be fair, it&#39;s alternative name is <code>bitand</code>. As in <code>int* p = bitand a;</code>"}, {"owner": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1531925042, "post_id": 51403087, "comment_id": 89780703, "body": "@MSalters the <code>bitand</code> is an entirely different operation (binary operation defined for integral types.)  Can you really use it in that way?"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 0, "creation_date": 1531925279, "post_id": 51403087, "comment_id": 89780894, "body": "@BenJones: Yes. And <code>Foo::compl Foo()</code> is a destructor. ( <code>~</code> is <code>compl</code>, also outside operator context)"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 8098191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9928d3cae5cff49b531d117413b26af?s=128&d=identicon&r=PG&f=1", "display_name": "Stel Team", "link": "https://stackoverflow.com/users/8098191/stel-team"}, "edited": false, "score": 0, "creation_date": 1531920141, "post_id": 51403128, "comment_id": 89777059, "body": "So I cant change the &amp; operator syntax to anything else?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 3, "creation_date": 1531920173, "post_id": 51403128, "comment_id": 89777076, "body": "Plus operators cannot be overloaded for embedded types"}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 2, "creation_date": 1531920207, "post_id": 51403128, "comment_id": 89777106, "body": "Basically you can&#39;t create new operators."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 77, "user_id": 8098191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9928d3cae5cff49b531d117413b26af?s=128&d=identicon&r=PG&f=1", "display_name": "Stel Team", "link": "https://stackoverflow.com/users/8098191/stel-team"}, "edited": false, "score": 0, "creation_date": 1531920264, "post_id": 51403128, "comment_id": 89777142, "body": "@StelTeam legaly no. You can write your own preprocessor, that will do that, but I doubt there is any value in it."}, {"owner": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "reply_to_user": {"reputation": 77, "user_id": 8098191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9928d3cae5cff49b531d117413b26af?s=128&d=identicon&r=PG&f=1", "display_name": "Stel Team", "link": "https://stackoverflow.com/users/8098191/stel-team"}, "edited": false, "score": 0, "creation_date": 1531921028, "post_id": 51403128, "comment_id": 89777781, "body": "@StelTeam You can for user-created types, as long as that &quot;anything else&quot; is a unary operator like <code>+</code>, <code>-</code>, or <code>*</code>, although you really shouldn&#39;t do that as it would be very confusing to anyone else reading your program."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 6, "last_activity_date": 1531922605, "last_edit_date": 1531922605, "creation_date": 1531920084, "answer_id": 51403128, "question_id": 51403087, "link": "https://stackoverflow.com/questions/51403087/how-to-change-and-operator/51403128#51403128", "title": "How to change and(&amp;) operator?", "body": "<p>You can't change to <code>_</code> since that's not an operator, so therefore cannot be overloaded.</p>\n\n<p>You can't change to <code>|</code> since the <em>airity</em> of that operator is binary, whereas pointer dereference <code>*</code> is unary.</p>\n\n<p>Even if you do pick an operator with the correct airity for overloading, note that you <em>cannot</em> overload a built-in type such as <code>int</code>.</p>\n\n<p>Finally if you want to see operator overloading at its most powerful, take a look at this project: <a href=\"http://boost-spirit.com/home/\" rel=\"nofollow noreferrer\">http://boost-spirit.com/home/</a> where expression templates, coupled with operator overloading, are used to mimic EBNF grammars.</p>\n"}, {"tags": [], "owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "is_accepted": false, "score": 1, "last_activity_date": 1531920608, "creation_date": 1531920608, "answer_id": 51403311, "question_id": 51403087, "link": "https://stackoverflow.com/questions/51403087/how-to-change-and-operator/51403311#51403311", "title": "How to change and(&amp;) operator?", "body": "<p>As <a href=\"https://stackoverflow.com/a/51403128/3233393\">Bathsheba</a> already answered, you cannot replace operators that easily.</p>\n\n<p>If, however, you really can't stand to use <code>&amp;</code> as an address-of operator, you <em>can</em> use the <a href=\"https://en.cppreference.com/w/cpp/memory/addressof\" rel=\"nofollow noreferrer\"><code>std::addressof</code></a> function. It will still be weird and unidiomatic, but at least it makes syntactic sense.</p>\n"}, {"comments": [{"owner": {"reputation": 185, "user_id": 9602261, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Eugene Mart", "link": "https://stackoverflow.com/users/9602261/eugene-mart"}, "edited": false, "score": 1, "creation_date": 1531921059, "post_id": 51403465, "comment_id": 89777815, "body": "It compiles, I checked"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1531922691, "post_id": 51403465, "comment_id": 89779036, "body": "But now, you no longer can do <code>int _ = 42;</code>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1531922724, "post_id": 51403465, "comment_id": 89779058, "body": "\u034f+\u034f1\u034f\u034f\u034f\u034f\u034f\u034f\u034f\u034f\u034f\u034f\u034f\u034f\u034f And I&#39;m pretty sure the behaviour is well-defined although this way is <i>very</i> disruptive."}, {"owner": {"reputation": 185, "user_id": 9602261, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Eugene Mart", "link": "https://stackoverflow.com/users/9602261/eugene-mart"}, "edited": false, "score": 0, "creation_date": 1531923140, "post_id": 51403465, "comment_id": 89779337, "body": "True, _ can be a name of a variable. Though you can use some other symbol. I still believe it is foolish to redefine standards. They are bad as it is, nobody needs you to make them even worse :D"}], "tags": [], "owner": {"reputation": 185, "user_id": 9602261, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Eugene Mart", "link": "https://stackoverflow.com/users/9602261/eugene-mart"}, "is_accepted": true, "score": 3, "last_activity_date": 1531921013, "creation_date": 1531921013, "answer_id": 51403465, "question_id": 51403087, "link": "https://stackoverflow.com/questions/51403087/how-to-change-and-operator/51403465#51403465", "title": "How to change and(&amp;) operator?", "body": "<p>&amp; is 'and' when applied to TWO operators, but it is 'take address' when applied unary. You can't possibly confuse them.</p>\n\n<p>If you are just curious you can do this </p>\n\n<pre><code>#include &lt;iostream&gt;\n#define _ &amp;\n\n\nint main()\n{\n   int a = 5;\n   int* p_a = _ a;\n   std::cout &lt;&lt; *p_a &lt;&lt; std::endl;\n\n   return 0;\n} \n</code></pre>\n\n<p>You have to put a space here. And believe me, nobody wants you redefining standard operators. </p>\n"}], "owner": {"reputation": 77, "user_id": 8098191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9928d3cae5cff49b531d117413b26af?s=128&d=identicon&r=PG&f=1", "display_name": "Stel Team", "link": "https://stackoverflow.com/users/8098191/stel-team"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 1, "accepted_answer_id": 51403465, "answer_count": 3, "score": 0, "last_activity_date": 1531922605, "creation_date": 1531919960, "question_id": 51403087, "link": "https://stackoverflow.com/questions/51403087/how-to-change-and-operator", "title": "How to change and(&amp;) operator?", "body": "<p>as we know &amp; operator used for reference and returning address of a variable. What I want to do is change the operator syntax to something like _ or | (You got the point). How can I do that?</p>\n\n<p>The default:</p>\n\n<pre><code>int *p;\nint a;\np = &amp;a;\n</code></pre>\n\n<p>What I want to do:</p>\n\n<pre><code>int *p;\nint a;\np = _a; // or |a\n</code></pre>\n"}, {"tags": ["c++", "file", "pointers"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1531919663, "post_id": 51402913, "comment_id": 89776663, "body": "What you seem to want to do is general file reading, which is a very basic subject in just about all languages."}, {"owner": {"reputation": 3545, "user_id": 2183547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd540edd4677da5281d4331bf835f51?s=128&d=identicon&r=PG", "display_name": "L. Scott Johnson", "link": "https://stackoverflow.com/users/2183547/l-scott-johnson"}, "edited": false, "score": 0, "creation_date": 1531920046, "post_id": 51402913, "comment_id": 89776978, "body": "Yeah, basic file I/O. ifstream to open the file, fstat for the file size. And see <a href=\"http://www.cplusplus.com/doc/tutorial/files/\" rel=\"nofollow noreferrer\">cplusplus.com/doc/tutorial/files</a>"}, {"owner": {"reputation": 1, "user_id": 9926513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/341349c4a277a57df5cb22339cda30b1?s=128&d=identicon&r=PG&f=1", "display_name": "jdoe", "link": "https://stackoverflow.com/users/9926513/jdoe"}, "edited": false, "score": 0, "creation_date": 1531920432, "post_id": 51402913, "comment_id": 89777291, "body": "yeah i got that.. I was more unsure about how I would set that to a char pointer so I could be compatible with the same code.. if that makes sense"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1531920601, "post_id": 51402913, "comment_id": 89777431, "body": "You don&#39;t need to do much really. Just allocate enough memory in a suitable container (I suggest you start to use e.g. <code>std::vector&lt;int8_t&gt;</code> instead), fill it with the contents from the file, and use it as before."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1531921068, "post_id": 51402913, "comment_id": 89777825, "body": "Background: for pointer arithmetic as intended to do, you need contiguous memory containing the data. This is why you need to read in all the file into memory before you can go on."}, {"owner": {"reputation": 1, "user_id": 9926513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/341349c4a277a57df5cb22339cda30b1?s=128&d=identicon&r=PG&f=1", "display_name": "jdoe", "link": "https://stackoverflow.com/users/9926513/jdoe"}, "edited": false, "score": 0, "creation_date": 1531921390, "post_id": 51402913, "comment_id": 89778069, "body": "does anyone have an example of this.. really lost.."}], "owner": {"reputation": 1, "user_id": 9926513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/341349c4a277a57df5cb22339cda30b1?s=128&d=identicon&r=PG&f=1", "display_name": "jdoe", "link": "https://stackoverflow.com/users/9926513/jdoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531919444, "creation_date": 1531919444, "question_id": 51402913, "link": "https://stackoverflow.com/questions/51402913/creating-a-pointer-to-the-state-of-a-file-and-reading-in", "title": "Creating a pointer to the State of a File and reading in", "body": "<p>I have some old code to adapt to which uses some sort of resource address system to load a file (fpgaDevice). It uses these FindResource and load, lock resource mehtods to get a pointer to the start of the file, as well as the size of the file. Then just reads word by word.</p>\n\n<pre><code>ULONG nAvailableWords = 0;\n  ULONG nFileLength = 0;\n  ULONG nCurrentPoint = 0;\n  HRSRC res;\n  HGLOBAL resHandle = NULL;\n  char* resData;\n     res = FindResource(NULL, MAKEINTRESOURCE(fpgaDevice), L\"FPGADATA\");\n      resHandle = LoadResource(NULL, res);\n      resData = (char*)LockResource(resHandle);\n      // Get the file length\n      nFileLength = SizeofResource(NULL, res);\n</code></pre>\n\n<p>Instead I am trying to adapt to the same sort of system, only with a string that has a corresponding address path to the file.\nie:</p>\n\n<pre><code>std::string PATH = \"C:\\\\PathToFile\\\\file.bin\";\n</code></pre>\n\n<p>Is there a way to pull off this same sort of system, get a pointer to the top of the bin file, and the size.. and be able to read word by word. There is some other code that I need to be compatible with, which is why I am kinda forced to do it this way..</p>\n\n<p>Later on I retrieve data by using:</p>\n\n<pre><code>(ULONG*)resData\n</code></pre>\n\n<p>and advance the pointer by</p>\n\n<pre><code>resData += sizeof(ULONG)\n</code></pre>\n"}, {"tags": ["c++", "c++17", "return-value-optimization"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1531919593, "post_id": 51402731, "comment_id": 89776617, "body": "You forgot to remove unrelated to question operator new and delete in the example."}, {"owner": {"reputation": 8732, "user_id": 486617, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/782b3f70d69545be0724536e9df98efb?s=128&d=identicon&r=PG", "display_name": "fen", "link": "https://stackoverflow.com/users/486617/fen"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1531919765, "post_id": 51402731, "comment_id": 89776752, "body": "@Slava deleted the delete/new overloads"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1531919953, "post_id": 51402731, "comment_id": 89776900, "body": "Simpler code to reproduce: <code>std::unique_ptr&lt;int&gt; foo() {     std::unique_ptr&lt;int&gt; p;     return {p}; }</code>"}, {"owner": {"reputation": 8732, "user_id": 486617, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/782b3f70d69545be0724536e9df98efb?s=128&d=identicon&r=PG", "display_name": "fen", "link": "https://stackoverflow.com/users/486617/fen"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1531920315, "post_id": 51402731, "comment_id": 89777193, "body": "thanks @Slava - I&#39;ve updated the question"}], "answers": [{"comments": [{"owner": {"reputation": 7136, "user_id": 1831108, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/WSdNc.png?s=128&g=1", "display_name": "watashiSHUN", "link": "https://stackoverflow.com/users/1831108/watashishun"}, "edited": false, "score": 0, "creation_date": 1607705158, "post_id": 51403039, "comment_id": 115365033, "body": "I don&#39;t understand why return{u} didn&#39;t get the same treatment as the others, I mean it&#39;s a return statement, the variable &quot;u&quot; is going out of scope, is there a case where a COPY should be used?"}, {"owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "reply_to_user": {"reputation": 7136, "user_id": 1831108, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/WSdNc.png?s=128&g=1", "display_name": "watashiSHUN", "link": "https://stackoverflow.com/users/1831108/watashishun"}, "edited": false, "score": 0, "creation_date": 1607915575, "post_id": 51403039, "comment_id": 115413698, "body": "@watashiSHUN I don&#39;t know. It&#39;s the rule. I think only the committee who made this rule knows the reason."}], "tags": [], "owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "is_accepted": true, "score": 28, "last_activity_date": 1531920707, "last_edit_date": 1531920707, "creation_date": 1531919794, "answer_id": 51403039, "question_id": 51402731, "link": "https://stackoverflow.com/questions/51402731/why-does-returning-a-stdoptional-sometimes-move-and-sometimes-copy/51403039#51403039", "title": "Why does returning a std::optional sometimes move and sometimes copy?", "body": "<p>Because returning a <strong>name</strong> of an object with automatic storage duration is treated as returning an rvalue of the object. Note this works only if the expression in the return statement is a (possibly parenthesized, not including braces) name, like <code>return u;</code> or <code>return (u);</code>, so <code>return {u};</code> works as usual, i.e. the copy constructor is invoked.</p>\n\n<p>Related part in the standard <a href=\"http://www.eel.is/c++draft/class.copy.elision#3\" rel=\"noreferrer\">[class.copy.elision]/3</a>:</p>\n\n<blockquote>\n  <p>In the following copy-initialization contexts, a move operation might be used instead of a copy operation:</p>\n  \n  <ul>\n  <li>If the expression in a return statement ([stmt.return]) is a <strong>(possibly parenthesized) id-expression</strong> that names an object with automatic storage duration declared in the body or parameter-declaration-clause of the innermost enclosing function or lambda-expression, or</li>\n  <li>...</li>\n  </ul>\n  \n  <p>overload resolution to select the constructor for the copy is first performed as if the object were designated by an rvalue.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 8732, "user_id": 486617, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/782b3f70d69545be0724536e9df98efb?s=128&d=identicon&r=PG", "display_name": "fen", "link": "https://stackoverflow.com/users/486617/fen"}, "edited": false, "score": 1, "creation_date": 1531920398, "post_id": 51403057, "comment_id": 89777264, "body": "but <code>return u;</code> is also a copy initialization, as mentioned <a href=\"https://en.cppreference.com/w/cpp/language/copy_initialization\" rel=\"nofollow noreferrer\">copy initialization - cppreference.com</a>"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 8732, "user_id": 486617, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/782b3f70d69545be0724536e9df98efb?s=128&d=identicon&r=PG", "display_name": "fen", "link": "https://stackoverflow.com/users/486617/fen"}, "edited": false, "score": 0, "creation_date": 1531924174, "post_id": 51403057, "comment_id": 89780077, "body": "@fen <i>copy</i> initialization is not the same as <i>copy list</i> initialization"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1531924339, "post_id": 51403057, "comment_id": 89780221, "body": "This doesn&#39;t actually. answer the question. Yes, <code>return {u};</code> is copy-list-initialization. True. However, why does that copy while the other one moves?"}], "tags": [], "owner": {"reputation": 4838, "user_id": 956030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1093fec993109b46d2f20963e52718bc?s=128&d=identicon&r=PG", "display_name": "Zang MingJie", "link": "https://stackoverflow.com/users/956030/zang-mingjie"}, "is_accepted": false, "score": 1, "last_activity_date": 1531919854, "creation_date": 1531919854, "answer_id": 51403057, "question_id": 51402731, "link": "https://stackoverflow.com/questions/51402731/why-does-returning-a-stdoptional-sometimes-move-and-sometimes-copy/51403057#51403057", "title": "Why does returning a std::optional sometimes move and sometimes copy?", "body": "<blockquote>\n  <p>return { <em>arg1, arg2, ...</em> } ;</p>\n</blockquote>\n\n<p>is <strong><a href=\"https://en.cppreference.com/w/cpp/language/list_initialization\" rel=\"nofollow noreferrer\">copy-list-initialization</a></strong>. the (return) object is initialized from the initializer list by copy-initialization for copy-list-initialization</p>\n"}, {"tags": [], "owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "is_accepted": false, "score": 6, "last_activity_date": 1531924687, "last_edit_date": 1592644375, "creation_date": 1531924687, "answer_id": 51404830, "question_id": 51402731, "link": "https://stackoverflow.com/questions/51402731/why-does-returning-a-stdoptional-sometimes-move-and-sometimes-copy/51404830#51404830", "title": "Why does returning a std::optional sometimes move and sometimes copy?", "body": "<p>This is a kind of <em>braced-init-list</em>. <a href=\"http://eel.is/c++draft/dcl.init.list#1.3\" rel=\"noreferrer\">[dcl.init.list]/1.3</a></p>\n<p>To be even more specific, it is an <em><strong>&quot;</strong></em> <em>expr-or-braced-init-list</em> <a href=\"http://eel.is/c++draft/dcl.init#nt:expr-or-braced-init-list\" rel=\"noreferrer\">[dcl.init]/1</a></p>\n<p>of a <em>return statement</em> <em><strong>&quot;</strong></em> <a href=\"http://eel.is/c++draft/stmt.return#2\" rel=\"noreferrer\">[stmt.return]/2</a></p>\n<blockquote>\n<p>A return statement with any other operand shall be used only in a\nfunction whose return type is not cv void; the return statement\ninitializes the glvalue result or prvalue result object of the\n(explicit or implicit) function call by <strong>copy-initialization</strong> from the\n<strong>operand</strong>.</p>\n</blockquote>\n<p>From this point, let me qoutes xskxzr's answer that mention <a href=\"http://www.eel.is/c++draft/class.copy.elision#3\" rel=\"noreferrer\">[class.copy.elision]/3</a></p>\n<blockquote>\n<p>In the following <strong>copy-initialization contexts</strong>, a <strong>move operation</strong> might be used <strong>instead</strong> of a copy operation:</p>\n<ul>\n<li>If the expression in a return statement ([stmt.return]) is a (possibly parenthesized) id-expression that names an object with automatic storage duration declared in the body or parameter-declaration-clause of the innermost enclosing function or lambda-expression, or</li>\n</ul>\n</blockquote>\n<hr />\n<p>In normal human words, the reason that copy is called instead of move because braced-init-list call <code>u</code> that happened to be lvalue.</p>\n<p>So, you may wanna know if <em>braced-init-list</em> call <code>u</code> that is <em>rvalue</em> ...</p>\n<pre><code>return {std::move(u)};\n</code></pre>\n<p>Well, <code>u</code> is moved to a new rvalue of <code>UserName</code> and copy elision works right after.</p>\n<p>So this takes one move as in</p>\n<pre><code>return u;\n</code></pre>\n<p><a href=\"https://godbolt.org/g/b6stLr\" rel=\"noreferrer\">godbolt.org/g/b6stLr</a></p>\n<p><a href=\"https://wandbox.org/permlink/7u1cPc0TG9gqToZD\" rel=\"noreferrer\">wandbox.org/permlink/7u1cPc0TG9gqToZD</a></p>\n<pre><code>#include &lt;iostream&gt;\n#include &lt;optional&gt;\n\nstruct UserName\n{\n  int x;\n  UserName() : x(0) {};\n  UserName(const UserName&amp; other) : x(other.x) { std::cout &lt;&lt; &quot;copy &quot; &lt;&lt; x &lt;&lt; &quot;\\n&quot;; };\n  UserName(UserName&amp;&amp; other)      : x(other.x) { std::cout &lt;&lt; &quot;move &quot;  &lt;&lt; x &lt;&lt; &quot;\\n&quot;; };\n};\n\nstd::optional&lt;UserName&gt; CreateUser()\n{\n  UserName u;\n  return u;   // this one moves UserName\n}\n\nstd::optional&lt;UserName&gt; CreateUser_listinit()\n{\n  UserName u;\n  auto whatever{u};\n  return whatever;\n}\n\nstd::optional&lt;UserName&gt; CreateUser_listinit_with_copy_elision()\n{\n  UserName u;\n  return {u};\n}\n\nstd::optional&lt;UserName&gt; CreateUser_move_listinit_with_copy_elision()\n{\n  UserName u;\n  return {std::move(u)};\n}\n\nint main()\n{\n  std::cout &lt;&lt; &quot;CreateUser() :\\n&quot;;\n  [[maybe_unused]] auto d = CreateUser();\n\n  std::cout &lt;&lt; &quot;\\nCreateUser_listinit() :\\n&quot;;\n  [[maybe_unused]] auto e = CreateUser_listinit();\n\n  std::cout &lt;&lt; &quot;\\nCreateUser_listinit_with_copy_elision() :\\n&quot;;\n  [[maybe_unused]] auto f = CreateUser_listinit_with_copy_elision();\n\n  std::cout &lt;&lt; &quot;\\nCreateUser_move_listinit_with_copy_elision() :\\n&quot;;\n  [[maybe_unused]] auto g = CreateUser_move_listinit_with_copy_elision();\n}\n</code></pre>\n<p>print</p>\n<pre><code>CreateUser() :\nmove 0\n\nCreateUser_listinit() :\ncopy 0\nmove 0\n\nCreateUser_listinit_with_copy_elision() :\ncopy 0\n\nCreateUser_move_listinit_with_copy_elision() :\nmove 0\n</code></pre>\n"}], "owner": {"reputation": 8732, "user_id": 486617, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/782b3f70d69545be0724536e9df98efb?s=128&d=identicon&r=PG", "display_name": "fen", "link": "https://stackoverflow.com/users/486617/fen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2853, "favorite_count": 5, "accepted_answer_id": 51403039, "answer_count": 3, "score": 31, "last_activity_date": 1531928503, "creation_date": 1531918954, "last_edit_date": 1531928503, "question_id": 51402731, "link": "https://stackoverflow.com/questions/51402731/why-does-returning-a-stdoptional-sometimes-move-and-sometimes-copy", "title": "Why does returning a std::optional sometimes move and sometimes copy?", "body": "<p>See the below example of returning an optional of <code>UserName</code> - a movable/copyable class.</p>\n\n<pre><code>std::optional&lt;UserName&gt; CreateUser()\n{\n   UserName u;\n   return {u}; // this one will cause a copy of UserName\n   return u;   // this one moves UserName\n}\n\n\nint main()\n{\n   auto d = CreateUser();\n}\n</code></pre>\n\n<p>Why does <code>return {u}</code> cause a copy and <code>return u</code> a move?</p>\n\n<p>Here's the related coliru sample: <a href=\"http://coliru.stacked-crooked.com/a/6bf853750b38d110\" rel=\"noreferrer\">http://coliru.stacked-crooked.com/a/6bf853750b38d110</a></p>\n\n<p>Another case (thanks to the comment from @Slava):</p>\n\n<pre><code>std::unique_ptr&lt;int&gt; foo() \n{ \n    std::unique_ptr&lt;int&gt; p; \n    return {p};  // uses copy of unique_ptr and so it breaks...\n}\n</code></pre>\n"}, {"tags": ["c#", "c++", "evaluation", "operator-precedence", "associativity"], "comments": [{"owner": {"reputation": 3298, "user_id": 3394884, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/LqQhR.png?s=128&g=1", "display_name": "kuskmen", "link": "https://stackoverflow.com/users/3394884/kuskmen"}, "edited": false, "score": 0, "creation_date": 1531918206, "post_id": 51402424, "comment_id": 89775639, "body": "Out of curiosity is this some kind of assignment you have or requirement, because if it is, it sounds crazy :)"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1531918216, "post_id": 51402424, "comment_id": 89775646, "body": "It&#39;s undefined behaviour. Simplest fix is to breakup into 2 lines of code.  See also <b>what not to ask</b>: <a href=\"https://stackoverflow.com/questions/24853/what-is-the-difference-between-i-and-i\" title=\"what is the difference between i and i\">stackoverflow.com/questions/24853/&hellip;</a>"}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 7, "creation_date": 1531918232, "post_id": 51402424, "comment_id": 89775658, "body": "Drawing parallels between two unrelated languages might prove counter-productive."}, {"owner": {"reputation": 289239, "user_id": 704848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9be2c2958e208c8d9b629ac43c9c42?s=128&d=identicon&r=PG", "display_name": "EdChum", "link": "https://stackoverflow.com/users/704848/edchum"}, "edited": false, "score": 1, "creation_date": 1531918275, "post_id": 51402424, "comment_id": 89775688, "body": "Why is there this restriction? Is this just out of interest and not a real-world problem?"}, {"owner": {"reputation": 3298, "user_id": 3394884, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/LqQhR.png?s=128&g=1", "display_name": "kuskmen", "link": "https://stackoverflow.com/users/3394884/kuskmen"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1531918370, "post_id": 51402424, "comment_id": 89775745, "body": "@RichardCritten why it is undefined behavior? Expression is evaluated right to left in one case and left to right in the other case, seems pretty defined to me, am I missing something?"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "reply_to_user": {"reputation": 3298, "user_id": 3394884, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/LqQhR.png?s=128&g=1", "display_name": "kuskmen", "link": "https://stackoverflow.com/users/3394884/kuskmen"}, "edited": false, "score": 0, "creation_date": 1531918456, "post_id": 51402424, "comment_id": 89775807, "body": "@kuskmen modifying and reading in the same expression.  This changes between C++11 and C++17 but left to right etc has nothing to do with expression evaluation and the freedom the compiler is allowed to optimise.  Complete answer is here: <a href=\"https://en.cppreference.com/w/cpp/language/eval_order\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/eval_order</a>"}, {"owner": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 1, "creation_date": 1531918809, "post_id": 51402424, "comment_id": 89776063, "body": "Anything can be a one-liner if you use enough semi-colons ;)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1531918877, "post_id": 51402424, "comment_id": 89776112, "body": "Sure: <code>x = y; y = x + x;</code>"}, {"owner": {"reputation": 6114, "user_id": 3070060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a936bdd7a67a345d312281305d5adde?s=128&d=identicon&r=PG&f=1", "display_name": "PaulF", "link": "https://stackoverflow.com/users/3070060/paulf"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1531919117, "post_id": 51402424, "comment_id": 89776271, "body": "@NathanOliver: doesn&#39;t that still result in x=2 &amp; y=4 - OP wanted x=2, y=3"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 6114, "user_id": 3070060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a936bdd7a67a345d312281305d5adde?s=128&d=identicon&r=PG&f=1", "display_name": "PaulF", "link": "https://stackoverflow.com/users/3070060/paulf"}, "edited": false, "score": 2, "creation_date": 1531919211, "post_id": 51402424, "comment_id": 89776347, "body": "@PaulF Oh wow, didn&#39;t notice that.  I&#39;ll have to put my thinking cap on but that doesn&#39;t look possible without an extra variable"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1531921906, "post_id": 51402424, "comment_id": 89778486, "body": "Why is the GOAL to &quot;maintain it in a single line&quot;?"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1531936737, "post_id": 51402424, "comment_id": 89787823, "body": "@Peter: Probably because it is a puzzle or challenge, not a real-world engineering problem."}, {"owner": {"reputation": 470, "user_id": 4376148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lfMuz.jpg?s=128&g=1", "display_name": "Lesair Valmont", "link": "https://stackoverflow.com/users/4376148/lesair-valmont"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1532267641, "post_id": 51402424, "comment_id": 89900099, "body": "@Peter (and all other folks that also asked this): Because I am pursuing academic purposes with this exercise. I am trying to achieve an advantageous use of C++ (as language, and resources consumption)."}], "answers": [{"tags": [], "owner": {"reputation": 1101, "user_id": 3783662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5409812f5cca63c1deb974fe00f65644?s=128&d=identicon&r=PG&f=1", "display_name": "ph&#246;n", "link": "https://stackoverflow.com/users/3783662/ph%c3%b6n"}, "is_accepted": false, "score": 1, "last_activity_date": 1531920686, "creation_date": 1531920686, "answer_id": 51403349, "question_id": 51402424, "link": "https://stackoverflow.com/questions/51402424/how-to-make-the-c-compiler-to-follow-the-same-precedence-associativity-and-or/51403349#51403349", "title": "How to make the C++ compiler to follow the same precedence, associativity and order of evaluation that C# has in the this assignment statement?", "body": "<p>You could write:</p>\n\n<pre><code>int x = 1;\nint y = 2;\ny = std::exchange(x,y) + y;\n</code></pre>\n\n<p>But highly unrecommended. You even have to stop browsing and think about this easy operation.</p>\n"}, {"comments": [{"owner": {"reputation": 470, "user_id": 4376148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lfMuz.jpg?s=128&g=1", "display_name": "Lesair Valmont", "link": "https://stackoverflow.com/users/4376148/lesair-valmont"}, "edited": false, "score": 0, "creation_date": 1532266842, "post_id": 51403390, "comment_id": 89899907, "body": "I want to clarify that I marked this as the accepted answer because it correctly addresses the question being asked and it provides the most optimal solution so far."}], "tags": [], "owner": {"reputation": 54, "user_id": 3033161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2d90009f994bb0b7a16eaed7e5d1874?s=128&d=identicon&r=PG&f=1", "display_name": "hosza", "link": "https://stackoverflow.com/users/3033161/hosza"}, "is_accepted": true, "score": 4, "last_activity_date": 1531920813, "creation_date": 1531920813, "answer_id": 51403390, "question_id": 51402424, "link": "https://stackoverflow.com/questions/51402424/how-to-make-the-c-compiler-to-follow-the-same-precedence-associativity-and-or/51403390#51403390", "title": "How to make the C++ compiler to follow the same precedence, associativity and order of evaluation that C# has in the this assignment statement?", "body": "<p>Yes, it is possible indeed.</p>\n\n<pre><code>x = (y+=x) - x;\n</code></pre>\n\n<p>So simple.</p>\n"}, {"comments": [{"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1531940399, "post_id": 51408469, "comment_id": 89789857, "body": "@NathanOliver: Whoops!  Fixed. Thanks."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1531940565, "post_id": 51408469, "comment_id": 89789939, "body": "Not bad but unfortunately you introduced an unused variable warning if you never use <code>t</code> (not really a big deal but I always use <code>-Wall -pedantic</code>)."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1531940617, "post_id": 51408469, "comment_id": 89789965, "body": "@NathanOliver: That&#39;s a strange warning since plainly the variable is both writtten to and read from!"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1531940694, "post_id": 51408469, "comment_id": 89790004, "body": "Huh, I didn&#39;t actually read the warning, turns out it was <i>warning: operation on &#39;t&#39; may be undefined [-Wsequence-point]</i>.  Looks like it might just be a false positive."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1531940764, "post_id": 51408469, "comment_id": 89790045, "body": "@NathanOliver: Well I admit I do not have the C sequence point spec memorized but I was under the impression that comma was a guaranteed sequence operation."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1531941131, "post_id": 51408469, "comment_id": 89790236, "body": "@NathanOliver: I&#39;ll try a different version that doesn&#39;t use the comma operator."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1531941183, "post_id": 51408469, "comment_id": 89790260, "body": "The comma operator does introduce a sequence point.  The issue (at least what I think gcc is complaining about) is that <code>t</code> isn&#39;t actually initialized until the end of the expression.  I would think that <code>(t = y)</code> would make it okay.  Only gcc complains so I&#39;m thinking it is just a false positive."}, {"owner": {"reputation": 24396, "user_id": 18192, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c939f58c5869fead24efafcec0056914?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/18192/brian"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1532006816, "post_id": 51408469, "comment_id": 89818744, "body": "@NathanOliver: On the one hand, this is probably a false positive for the reasons your describe.  On the other hand, I can&#39;t think of any scenario where initializing a variable inside of an assignment to that variable is actually necessary for either performance or readability."}, {"owner": {"reputation": 470, "user_id": 4376148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lfMuz.jpg?s=128&g=1", "display_name": "Lesair Valmont", "link": "https://stackoverflow.com/users/4376148/lesair-valmont"}, "edited": false, "score": 1, "creation_date": 1532266707, "post_id": 51408469, "comment_id": 89899867, "body": "@Eric Lippert: I want to clarify that I upvoted this answer because it provides the best explanation and context-wise references for further learning and exploration of these topics."}], "tags": [], "owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "is_accepted": false, "score": 3, "last_activity_date": 1531950219, "last_edit_date": 1531950219, "creation_date": 1531937445, "answer_id": 51408469, "question_id": 51402424, "link": "https://stackoverflow.com/questions/51402424/how-to-make-the-c-compiler-to-follow-the-same-precedence-associativity-and-or/51408469#51408469", "title": "How to make the C++ compiler to follow the same precedence, associativity and order of evaluation that C# has in the this assignment statement?", "body": "<blockquote>\n  <p>Is it possible to rewrite the assignment statement to force C++ to evaluate the same as C# does?</p>\n</blockquote>\n\n<p>Yes.  To clarify, the rule in C# is that most of the time, the left side of an expression is evaluated fully before the right side.  So C# guarantees that the evaluation of <code>x</code> on the left of the <code>+</code> happens before the side effect of the <code>x = y</code> on the right side.  C++ does not make this guarantee; compilers can disagree as to the meaning of this expression.</p>\n\n<p>(Challenge: I said \"most\" for a reason. Give an example of a simple expression in C# where a side effect on the left is executed after a side effect on the right.)</p>\n\n<blockquote>\n  <p>I know this can be rewritten by splitting the assignments into two separate lines</p>\n</blockquote>\n\n<p>Right. You wish to have a statement that has two side effects: increment y by the original value of x, and assign the original value of y to x.  So you could write that as</p>\n\n<pre><code>int t = y;\ny = y + x;\nx = t;\n</code></pre>\n\n<p>But:</p>\n\n<blockquote>\n  <p>the goal is to maintain it in a single line.</p>\n</blockquote>\n\n<p>I assume by \"line\" you mean \"statement\". Fine.  Just use the comma operator.</p>\n\n<pre><code>int t = ((t = y), (y = y + x), (x = t));\n</code></pre>\n\n<p>Easy peasy.  Why you would want to, I don't know. I assume this is a puzzle designed to elicit signal on whether or not you know about the comma operator.</p>\n\n<p>Extra credit: How many of the parentheses in that statement are required?</p>\n\n<hr>\n\n<p>Super bonus: what if we don't want to use the comma operator?  We can use other operators as sequencing operators.  </p>\n\n<pre><code>int t = ((t = y) &amp; 0) || ((y = y + x) &amp; 0) || (x = t);\n</code></pre>\n\n<p>We execute the left of the <code>||</code>, and it turns out to be false, so we execute the right side, and so on.  </p>\n\n<p>Similarly, <code>((expr1) &amp; 0) ? 0 : (expr2)</code> guarantees you that <code>expr1</code> runs before <code>expr2</code>.</p>\n\n<p>Basically what you need here is a guarantee that a number of subexpressions happen in a particular order. Look up \"sequence points\" to see which operators in C and C++ produce sequence points; you can use them to sequence expressions, hence the name.</p>\n"}], "owner": {"reputation": 470, "user_id": 4376148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lfMuz.jpg?s=128&g=1", "display_name": "Lesair Valmont", "link": "https://stackoverflow.com/users/4376148/lesair-valmont"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 1, "accepted_answer_id": 51403390, "answer_count": 3, "score": -3, "last_activity_date": 1531950219, "creation_date": 1531918038, "question_id": 51402424, "link": "https://stackoverflow.com/questions/51402424/how-to-make-the-c-compiler-to-follow-the-same-precedence-associativity-and-or", "title": "How to make the C++ compiler to follow the same precedence, associativity and order of evaluation that C# has in the this assignment statement?", "body": "<p>Consider the following piece of code:</p>\n\n<pre><code>int x = 1;\nint y = 2;\ny = x + (x = y);\n</code></pre>\n\n<p>When this runs in C#, the variables end up assigned with these values:</p>\n\n<p><em>x = 2</em></p>\n\n<p><em>y = 3</em></p>\n\n<p>On the other hand, when the same runs in C++, the variables end  like this:</p>\n\n<p><em>x = 2</em></p>\n\n<p><em>y = 4</em></p>\n\n<p>Clearly, the C++ compiler is using different <strong>precedence</strong>, <strong>associativity</strong> and <strong>order of evaluation</strong> rules than C# (as explained in <a href=\"https://blogs.msdn.microsoft.com/ericlippert/2008/05/23/precedence-vs-associativity-vs-order/\" rel=\"nofollow noreferrer\">this Eric Lippert's article</a>).</p>\n\n<p>So, the question is:</p>\n\n<p><strong>Is it possible to rewrite the assignment statement to force C++ to evaluate the same as C# does?</strong></p>\n\n<p>The only restriction is to keep it as a one-liner. I know this can be rewritten by splitting the assignments into two separate lines, but the goal is to maintain it in a single line.</p>\n"}, {"tags": ["c++", "arrays", "vb.net", "function", "return"], "comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1531918725, "post_id": 51402362, "comment_id": 89775999, "body": "Please provide code without additional decorations (line numbers, markers like the <code>&gt;</code> you used, ...) such that it can just be copied/pasted without changes!"}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1531925004, "post_id": 51402362, "comment_id": 89780684, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7769998/how-to-return-local-array-in-c\">How to return local array in C++?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1531923028, "post_id": 51403109, "comment_id": 89779249, "body": "Then have a look at <a href=\"https://stackoverflow.com/questions/3776485/marshal-c-int-array-to-c-sharp\">here</a> as well."}, {"owner": {"reputation": 1, "user_id": 8618379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4527c3ca3aeec906a1664d9fe72268?s=128&d=identicon&r=PG&f=1", "display_name": "tevfik oguz", "link": "https://stackoverflow.com/users/8618379/tevfik-oguz"}, "edited": false, "score": 0, "creation_date": 1531997421, "post_id": 51403109, "comment_id": 89812315, "body": "is my call from VB true ?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 1, "user_id": 8618379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4527c3ca3aeec906a1664d9fe72268?s=128&d=identicon&r=PG&f=1", "display_name": "tevfik oguz", "link": "https://stackoverflow.com/users/8618379/tevfik-oguz"}, "edited": false, "score": 0, "creation_date": 1532000480, "post_id": 51403109, "comment_id": 89814366, "body": "<i>&quot;true&quot;</i> -- if you mean &quot;correct&quot;, then <i>probably</i> not. According to the answer to referenced question, you&#39;d need to marshal as <code>IntPtr</code>, not as integer array. I&#39;ve been out of .NET for a while, though, and currently no environment available to do so myself, so need to leave verifying to you..."}, {"owner": {"reputation": 1, "user_id": 8618379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4527c3ca3aeec906a1664d9fe72268?s=128&d=identicon&r=PG&f=1", "display_name": "tevfik oguz", "link": "https://stackoverflow.com/users/8618379/tevfik-oguz"}, "edited": false, "score": 0, "creation_date": 1532002593, "post_id": 51403109, "comment_id": 89815784, "body": "hi, @Aconcagua,i wanna ask this, when we make the function as &#39; int* __stdcall test_array() &#39; , aren&#39;t we make it &#39;IntPtr&#39; ?. And also i used this dll inside a c++ project and it worked. i changed the code to make random array but i dont know how to post it here new version so  can&#39;t show you them. only i can change the first post. i tried answer my question to post it before but someone deleted it.  anyway, it works in another c++ project but not in VB with this DLL calling lines."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 1, "user_id": 8618379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4527c3ca3aeec906a1664d9fe72268?s=128&d=identicon&r=PG&f=1", "display_name": "tevfik oguz", "link": "https://stackoverflow.com/users/8618379/tevfik-oguz"}, "edited": false, "score": 0, "creation_date": 1532003228, "post_id": 51403109, "comment_id": 89816196, "body": "@tevfikoguz You need to be aware that C and C++ have a different interpretation of what a (raw) array is than .NET has. .NET arrays ressemble more to <code>std::vector</code> than C++ arrays. If you do bad marshalling, you get a result comparable to creating a raw array, <code>reinterpret_cast</code>ing it to a <code>std::vector</code> and hoping you magically get a true vector from. Of course it works if you use the dll from another C++ project: then both DLL and EXE have the same understanding of what a pointer to int (<code>int*</code>) is."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 1, "user_id": 8618379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4527c3ca3aeec906a1664d9fe72268?s=128&d=identicon&r=PG&f=1", "display_name": "tevfik oguz", "link": "https://stackoverflow.com/users/8618379/tevfik-oguz"}, "edited": false, "score": 0, "creation_date": 1532003280, "post_id": 51403109, "comment_id": 89816230, "body": "@tevfikoguz Yes, you make an <code>IntPtr</code> from your C++ code, but this is totally different from <code>Integer()</code>, which is what you tell the marshaller to expect as result..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 1, "user_id": 8618379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4527c3ca3aeec906a1664d9fe72268?s=128&d=identicon&r=PG&f=1", "display_name": "tevfik oguz", "link": "https://stackoverflow.com/users/8618379/tevfik-oguz"}, "edited": false, "score": 0, "creation_date": 1532003610, "post_id": 51403109, "comment_id": 89816446, "body": "However: Your <i>edited</i> code now yields undefined behaviour: you are returning a pointer to an array with local storage duration, which is destructed immediately before the function is exited, thus the pointer is dangling. It is just pure accident that your code <i>appears</i> to work, it might well have resulted in crash as well..."}, {"owner": {"reputation": 1, "user_id": 8618379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4527c3ca3aeec906a1664d9fe72268?s=128&d=identicon&r=PG&f=1", "display_name": "tevfik oguz", "link": "https://stackoverflow.com/users/8618379/tevfik-oguz"}, "edited": false, "score": 0, "creation_date": 1532006983, "post_id": 51403109, "comment_id": 89818870, "body": ",so you saying, even it works in c++ project the result could be eraseable if memory runs out or something even in coding another c++ project? and there is no way to make it out an array from c++ dll? with safe and sound. ?            !!! c++ so much complicated !!!"}, {"owner": {"reputation": 1, "user_id": 8618379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4527c3ca3aeec906a1664d9fe72268?s=128&d=identicon&r=PG&f=1", "display_name": "tevfik oguz", "link": "https://stackoverflow.com/users/8618379/tevfik-oguz"}, "edited": false, "score": 0, "creation_date": 1532009220, "post_id": 51403109, "comment_id": 89820508, "body": "when i call the function from VB just an integer output, it returns a negative number. it should be address of the array right?. how can i point this address with VB? and another thing, what is the way to make a result with a string?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 1, "user_id": 8618379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4527c3ca3aeec906a1664d9fe72268?s=128&d=identicon&r=PG&f=1", "display_name": "tevfik oguz", "link": "https://stackoverflow.com/users/8618379/tevfik-oguz"}, "edited": false, "score": 0, "creation_date": 1532014692, "post_id": 51403109, "comment_id": 89824598, "body": "You should have a look at <a href=\"https://msdn.microsoft.com/en-us/library/system.intptr%28v=vs.110%29.aspx\" rel=\"nofollow noreferrer\"><code>IntPtr</code> documentation</a>, especially at <code>ToPointer</code>. Pretty sure you will have to use unsafe code (C#), looks as if, though, not supported by VB. As mentioned already, being out of .NET for a while and currently no system to test (and while doing .NET, C#, not VB). Strings: You&#39;ll be doomed to fail if you try to return a <code>std::string</code> object, you need to return a const character pointer. If I recall correctly, there is a standard marshaller for to get .NET strings from."}, {"owner": {"reputation": 1, "user_id": 8618379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4527c3ca3aeec906a1664d9fe72268?s=128&d=identicon&r=PG&f=1", "display_name": "tevfik oguz", "link": "https://stackoverflow.com/users/8618379/tevfik-oguz"}, "edited": false, "score": 0, "creation_date": 1532353686, "post_id": 51403109, "comment_id": 89929320, "body": "what if i made a customise structure , how should i use this structure with a function in a DLL???      i see an example but don&#39;t fully understand it.  <a href=\"https://stackoverflow.com/questions/9632713/how-to-call-a-c-dll-file-from-visual-basic-2010\">&quot;theLink&quot;</a>  . The writings are way high from my level of c++."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 1, "user_id": 8618379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4527c3ca3aeec906a1664d9fe72268?s=128&d=identicon&r=PG&f=1", "display_name": "tevfik oguz", "link": "https://stackoverflow.com/users/8618379/tevfik-oguz"}, "edited": false, "score": 0, "creation_date": 1532358143, "post_id": 51403109, "comment_id": 89932509, "body": "According to the link provided, you should use cdecl calling convention (you use stdcall; calling conventions define how parameters are passed from caller to callee and who of both cleans them up again). Then you need a way to tell VB how that data type is to be marshaled (data converted from one realm to the other, i. e. how to map unmanaged types to managed ones and vice versa). There is a way to write custom marshalers in C#, completely unfamiliar with VB in this respect, though. In the past, I did marshaling manually in C++ CLI..."}, {"owner": {"reputation": 1, "user_id": 8618379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4527c3ca3aeec906a1664d9fe72268?s=128&d=identicon&r=PG&f=1", "display_name": "tevfik oguz", "link": "https://stackoverflow.com/users/8618379/tevfik-oguz"}, "edited": false, "score": 0, "creation_date": 1532420538, "post_id": 51403109, "comment_id": 89956071, "body": "first i defined an empty array with 10 elements in VB then call the function with the first element in the array.  &#39;Private Declare Function test_array Lib &quot;MyCudaLib.dll&quot; (ByVal aktar As Integer) As Integer&#39;     then, in c++, try to modify the array with this code.  &#39;__declspec(dllexport) int  __stdcall test_array(int * AKTAR) { \tfor (int i = 0; i &lt; 10; ++i) { \tAKTAR[i] = rand(); \t} \treturn 0; }&#39;    but i get error  in VB &#39; System.AccessViolationException: Attempted to read or write protect&#39;   when calling it like this &#39;Dim retrnn As Integer = test_array(aktar\u0131m(0))&#39; What should i do"}, {"owner": {"reputation": 1, "user_id": 8618379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4527c3ca3aeec906a1664d9fe72268?s=128&d=identicon&r=PG&f=1", "display_name": "tevfik oguz", "link": "https://stackoverflow.com/users/8618379/tevfik-oguz"}, "edited": false, "score": 0, "creation_date": 1532420697, "post_id": 51403109, "comment_id": 89956137, "body": "sorry i have to write here down all codes because someone coming and deleting my answers."}, {"owner": {"reputation": 1, "user_id": 8618379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4527c3ca3aeec906a1664d9fe72268?s=128&d=identicon&r=PG&f=1", "display_name": "tevfik oguz", "link": "https://stackoverflow.com/users/8618379/tevfik-oguz"}, "edited": false, "score": 0, "creation_date": 1532427433, "post_id": 51403109, "comment_id": 89960064, "body": "i finally found my answer with you guidance of course @ Aconcagua .  the key is using <i>GCHandle.Alloc</i> function to allocate memmory and get it&#39;s pointer address in VB. Then i send it to dll in c++ to change it. finally. !!!!   thanks my friend!"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 1, "user_id": 8618379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4527c3ca3aeec906a1664d9fe72268?s=128&d=identicon&r=PG&f=1", "display_name": "tevfik oguz", "link": "https://stackoverflow.com/users/8618379/tevfik-oguz"}, "edited": false, "score": 0, "creation_date": 1532452707, "post_id": 51403109, "comment_id": 89977323, "body": "@tevfikoguz Glad I could help you... Just a (<i>general</i>) note on answers: Only write one, if you really want to answer something. If you want to add additional code, edit your question instead. If the edit means a (minor) change of the character of the question, the edit should be clearly marked as such (answers given so far might get invalidated by your edit!), or better, ask a new question (in given case, I&#39;d say editing is OK, if clearly visible)."}], "tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 0, "last_activity_date": 1531922872, "last_edit_date": 1531922872, "creation_date": 1531920019, "answer_id": 51403109, "question_id": 51402362, "link": "https://stackoverflow.com/questions/51402362/how-to-make-a-function-return-an-array-for-making-dll-to-use-in-vb-net/51403109#51403109", "title": "how to make a function return an array? for making DLL to use in VB.NET", "body": "<p>Sure your function compiles fine - it is defined as a function returning a single int and does so as well (<code>return *arr;</code> is equivalent to <code>return arr[0];</code>).</p>\n\n<p>From <a href=\"https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshaldirectiveexception%28v=vs.110%29.aspx\" rel=\"nofollow noreferrer\">MarshalDirectiveException</a></p>\n\n<blockquote>\n  <p>The exception that is thrown by the marshaler when it encounters a MarshalAsAttribute it does not support.</p>\n</blockquote>\n\n<p>As you did not provide an English error message, I can only guess what's happening now, but there are only few options available:</p>\n\n<ol>\n<li>You have yet another error with your marshaling not visible here.</li>\n<li>The function is not recognised due to C++ name mangling (see below).</li>\n<li>Incompatibility between int returned in function and expected array is recognised.</li>\n<li>The int is interpreted as pointer &ndash; but pointer size does not match and the type cannot be marshaled at all.</li>\n</ol>\n\n<p>If you want to return an array, you need to define your function as such:</p>\n\n<pre><code>int* getArray()\n// ^\n{\n    static int a[] = {1, 2, 3};\n//  ^^^^^^ we cannot return an array with local storage duration, so make it\n//         static, global, or allocate one on heap (new int[]; but assure the\n//         array to be delete[]d appropriately again to avoid memory leak)\n\n    return a; // NOT dereferenced!\n}\n</code></pre>\n\n<p>Be aware that you have C++ name mangling applied. You might possibly prefer a C-kompatible interface:</p>\n\n<pre><code>extern \"C\" int* getArray();\n</code></pre>\n\n<p>However, you cannot return C++ data types this way like <code>std::vector</code> &ndash; which in most cases even is preferrable, though, as those types usually are incompatible across different implementations (DLL compiled with MSVS, EXE with GCC/MinGW) anyway.</p>\n\n<p>Finally be aware that via a pointer, you lose information about array size! You need to find other means to provide this information to the user of your library.</p>\n"}], "owner": {"reputation": 1, "user_id": 8618379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4527c3ca3aeec906a1664d9fe72268?s=128&d=identicon&r=PG&f=1", "display_name": "tevfik oguz", "link": "https://stackoverflow.com/users/8618379/tevfik-oguz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 342, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532002069, "creation_date": 1531917839, "last_edit_date": 1532002069, "question_id": 51402362, "link": "https://stackoverflow.com/questions/51402362/how-to-make-a-function-return-an-array-for-making-dll-to-use-in-vb-net", "title": "how to make a function return an array? for making DLL to use in VB.NET", "body": "<p>i am trying to make a c++ DLL project in VS2017 to use in a VB.NET VS2017 project.</p>\n\n<p>the c++ code;</p>\n\n<p>MyCudaLib.h</p>\n\n<pre><code>#ifndef DLL3_H\n#define DLL3_H\n\n#ifdef DLL3_EXPORTS\n#define DLL3_API __declspec(dllexport)\n#else\n#pragma message(\"automatic link to MyCudaLib.LIB\")\n//#pragma comment(lib, \"MyCudaLib.lib\")\n#define DLL3_API __declspec(dllimport)\n#endif\n\nint* __stdcall test_array();\n\n#endif //DLL3_H\n</code></pre>\n\n<p>MyCudaLib.cpp</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"MyCudaLib.h\"\n#include &lt;Windows.h&gt;\n#include &lt;stdexcept&gt;\n#include &lt;sstream&gt;\nusing namespace std;\n\n#define DLL3_EXPORTS\n\n\nBOOL APIENTRY DllMain(HANDLE /*hModule*/,\n    DWORD  ul_reason_for_call,\n    LPVOID /*lpReserved*/\n)\n{\n    switch (ul_reason_for_call)\n    {\n    case DLL_PROCESS_ATTACH:\n    case DLL_THREAD_ATTACH:\n    case DLL_THREAD_DETACH:\n    case DLL_PROCESS_DETACH:\n        break;\n    }\n    return TRUE;\n}\nint* __stdcall test_array()\n{\nint arr[]{ 30,50,60,70 };\n\nreturn  arr;\n}\n</code></pre>\n\n<p>in VB part of the code</p>\n\n<pre><code>Private Declare Function test_array Lib \"MyCudaLib.dll\" () As Integer()\n\nPrivate Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load\n\n    Console.WriteLine(test_array(0))\n\nEnd Sub\n</code></pre>\n\n<p>is my exporting part of code is wrong? c++ part compiled wtihout error but VB part of the code wont work gives error.</p>\n\n<pre><code>System.Runtime.InteropServices.MarshalDirectiveException: ''return value' cannot arranged.\n</code></pre>\n\n<p>Note: My point to make a proper working function in c++ is to write a CUDA code to program the GPU. I can write and compile code in CUDA in c++ without problem. But students in my class cannot program in c++ and i can't write more complex code with c++. So, i thought, if i can use the cuda function outside the c++ environment, we all can code it with vb or other languages.</p>\n"}, {"tags": ["python", "c++", "opencv", "tensorflow", "object-detection"], "comments": [{"owner": {"reputation": 1000, "user_id": 9332988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRbxE.jpg?s=128&g=1", "display_name": "Surya Tej", "link": "https://stackoverflow.com/users/9332988/surya-tej"}, "edited": false, "score": 1, "creation_date": 1531917785, "post_id": 51402207, "comment_id": 89775349, "body": "Faster_rcnn_inception might be good for this, also why not Try YOLO?"}, {"owner": {"reputation": 1, "user_id": 10099340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7afcf2e6a10ae0888460d022177bf8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Luca3424", "link": "https://stackoverflow.com/users/10099340/luca3424"}, "reply_to_user": {"reputation": 1000, "user_id": 9332988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRbxE.jpg?s=128&g=1", "display_name": "Surya Tej", "link": "https://stackoverflow.com/users/9332988/surya-tej"}, "edited": false, "score": 0, "creation_date": 1531918279, "post_id": 51402207, "comment_id": 89775692, "body": "I want to load the model in the app which needs to be able to detect the hand poses. For this I&#39;m using OpenCV, which is not able to load YOLO models. Is it worth it to check this out?"}, {"owner": {"reputation": 1000, "user_id": 9332988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRbxE.jpg?s=128&g=1", "display_name": "Surya Tej", "link": "https://stackoverflow.com/users/9332988/surya-tej"}, "edited": false, "score": 0, "creation_date": 1531918806, "post_id": 51402207, "comment_id": 89776061, "body": "If by app you are referring to a Mobile APP, then YOLO does work in Android. You could use the Annotated data made for ssd architecture to YOLO too"}, {"owner": {"reputation": 1, "user_id": 10099340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7afcf2e6a10ae0888460d022177bf8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Luca3424", "link": "https://stackoverflow.com/users/10099340/luca3424"}, "reply_to_user": {"reputation": 1000, "user_id": 9332988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRbxE.jpg?s=128&g=1", "display_name": "Surya Tej", "link": "https://stackoverflow.com/users/9332988/surya-tej"}, "edited": false, "score": 0, "creation_date": 1531919146, "post_id": 51402207, "comment_id": 89776296, "body": "I looked it up, OpenCV is also able to load Darknet models like YOLO. So there would be no problem with this. Can you tell me why YOLO is better for this purpose?"}], "owner": {"reputation": 1, "user_id": 10099340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7afcf2e6a10ae0888460d022177bf8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Luca3424", "link": "https://stackoverflow.com/users/10099340/luca3424"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531917413, "creation_date": 1531917413, "question_id": 51402207, "link": "https://stackoverflow.com/questions/51402207/how-to-get-better-results-when-using-the-tensorflow-object-detection-api-for-a-c", "title": "How to get better results when using the TensorFlow object detection API for a custom trained model to recognize hand poses?", "body": "<p>in my project I need to train a object detection model which is able to recognize hands in different poses in real-time from a rgb webcam.\nThus, I'm using the TensorFlow object detection API.\nWhat I did so far is training the model based on the ssd_inception_v2 architecture with the ssd_inception_v2_coco model as finetune-checkpoint.\nI want to detect 10 different classes of hand poses. Each class has 300 images which are augmented. In total there are 2400 images in for training and 600 for evaluation. The labeling was done with LabelImg.</p>\n\n<p>The Problem is that the model isn't able to detect the different classes properly. Even if it still wasn't good I got much better results by training with the same images, but only with like 3 different classes. It seems like the problem is the SSD architecture. I've read several times that SSD networks are not good in detecting small objects.</p>\n\n<p>Finally, my questions are the following:</p>\n\n<ul>\n<li>Could I receive better results by using a faster_rcnn_inception architecture for this use case?</li>\n<li>Has anyone some advice how to optimize the model?</li>\n<li>Do I need more images?</li>\n</ul>\n\n<p>Thanks for your answers!</p>\n"}, {"tags": ["c++", "regex", "sed"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 4, "creation_date": 1531916803, "post_id": 51401925, "comment_id": 89774697, "body": "Are you trying to just match <code>int</code> as a whole word? <code>sed -i -E &#39;s&#47;\\&lt;int\\&gt;&#47;int32_t&#47;g&#39; file.cpp</code>?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 7, "creation_date": 1531917044, "post_id": 51401925, "comment_id": 89774868, "body": "That&#39;s really hard because of edge cases. E.g. <code>operator++(int)</code> and <code>short int</code>."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 4, "creation_date": 1531917090, "post_id": 51401925, "comment_id": 89774889, "body": "Suppose you have a problem.  You then think &quot;I know, I can use a regular expression!&quot;.  You now have two problems, the original one and regukar expressions.  Or; there is a RE that will solve this problem almost always, there is no RE that will solve this problem always; C++ tokenization cannot be done perfectly by anything short of the front end of a C++ compiler.  How big is your code base?  How dangerous are false positives?  Negatives?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1531917439, "post_id": 51401925, "comment_id": 89775130, "body": "EVIL: <code>#define int int32_t</code>"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1531917973, "post_id": 51401925, "comment_id": 89775485, "body": "Actually, less evil, do the # define as a cross-check: compile to preprocessed output, and verify that you get the same output after doing your sed."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 2, "creation_date": 1531918032, "post_id": 51401925, "comment_id": 89775532, "body": "What about this: <code>char msg =&quot;For example splitting internaly would give int ern aly&quot;; cout &lt;&lt; msg &lt;&lt; endl;</code>? I wouldn&#39;t dare using naive text processing on a C++ source file"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1531918090, "post_id": 51401925, "comment_id": 89775564, "body": "You can either do &quot;non-capturing groups&quot;; &quot;\\b&quot;; or capture your prefix and suffix expressions and then instance them in the output: <code>s&#47;([\\(&lt;\\s])(int)([\\s&gt;\\)])&#47;\\1int32_t\\3&#47;g</code> But the <code>[]?</code> syntax does you no favours as that makes the wrapping characters optional. I&#39;m also not sure \\s works inside []?"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1531918610, "post_id": 51401925, "comment_id": 89775908, "body": "As usual there is this gnome in the back of my head, cackling madly and yelling, &quot;but <i>why</i>?&quot; -- The (optional!) precise-width types are useful for binary APIs; for virtually everything else, either the native types, the <code>*_leastX_t</code>, or <code>*_fastX_t</code> types are the better architectural choice."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1531918878, "post_id": 51401925, "comment_id": 89776115, "body": "Hmm. I would not use regexp for this. There are refactor tools to do the job. Otherwise <a href=\"https://stackoverflow.com/a/1732454/8157187\">bad things</a> happen."}, {"owner": {"reputation": 821, "user_id": 2912478, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bbfd1023cf7ba3aef7d10bcde4ccb2a4?s=128&d=identicon&r=PG&f=1", "display_name": "rph", "link": "https://stackoverflow.com/users/2912478/rph"}, "edited": false, "score": 0, "creation_date": 1531920552, "post_id": 51401925, "comment_id": 89777389, "body": "Thanks for all the comments. Please, refer to the edits I did in the question to clarify some things."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1531921284, "post_id": 51401925, "comment_id": 89777986, "body": "This task is not doable by regex period. You should use proper tool for that. For example you can dump AST from llvm and identify all places, where <code>int</code> is used as a type."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1531922296, "post_id": 51401925, "comment_id": 89778758, "body": "@slava but even after you have &quot;identified all the places&quot; you still have to do the actual replacement, right? I agree that I would be very  careful doing it on my own code."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1531922421, "post_id": 51401925, "comment_id": 89778844, "body": "@GemTaylor right script of some sort is required, but at least that behavior should be predictable, or existing refactoring tool can be used. Anyway pure regex cannot parse syntax of C++."}, {"owner": {"reputation": 821, "user_id": 2912478, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bbfd1023cf7ba3aef7d10bcde4ccb2a4?s=128&d=identicon&r=PG&f=1", "display_name": "rph", "link": "https://stackoverflow.com/users/2912478/rph"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1531922895, "post_id": 51401925, "comment_id": 89779165, "body": "@Slava It is not like I am trying to parse the entire C++ with regex. I am just capturing a tiny subset. Plus, I imagine that all improper replacements will lead to compilation errors which are safe enough for my context."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1531923280, "post_id": 51401925, "comment_id": 89779424, "body": "@rkioji then look into your particular tiny subset and ask yourself - can this one be done with regex? By asking question here you ask for this in general. And in general it cannot be done reliable. Will false positive create bad problems? That&#39;s another complicated question and I do not think it worse the effort to answer that."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1531923460, "post_id": 51401925, "comment_id": 89779546, "body": "Btw if you just need to do it once on pretty small file - just put <code>int</code> as search string on editor (not sed) click search/replace and validate each case visually."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1531923539, "post_id": 51401925, "comment_id": 89779604, "body": "If you want to grant that <code>int</code> is not greater than 32 bits - why? Even embedded CPUs may have bigger machine words with best performance - if not now than in the near future. If you want to grant that <code>int</code> hasn&#39;t accidentally less than 32 bits than <code>assert(sizeof (int) &gt;= 4);</code> could be sufficient (e.g. as one of the first lines in <code>main()</code>). BUT if you want to grant that <code>int</code> has granted 32 bits even if native machine word is smaller... Hmmm. ...then there is gone something wrong in your development from beginning. May be, it would be better to check everything by eye (instead of <code>sed</code>)."}, {"owner": {"reputation": 821, "user_id": 2912478, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bbfd1023cf7ba3aef7d10bcde4ccb2a4?s=128&d=identicon&r=PG&f=1", "display_name": "rph", "link": "https://stackoverflow.com/users/2912478/rph"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1531924132, "post_id": 51401925, "comment_id": 89780037, "body": "@Scheff The code was initially implemented assuming <code>int</code> was 32-bits. We want to guarantee the variables continue to be 32-bits across other archs. Using assertion will only make the code less portable."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1531924273, "post_id": 51401925, "comment_id": 89780149, "body": "For me, this sounds like the part of my comment after BUT is relevant... ;-) ...and I know (very well) that this is a tedious job..."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1531927004, "post_id": 51401925, "comment_id": 89782114, "body": "I would recommend a cross-check strategy, which is to generate a preprocesor dump of your modules before doing the change, then use your regex to convert all the symbols to something very unique (eg XXXintXXX search for it before using it) then #define your symbol to int, and generate another preprocessor output. The two outputs should be close enough to use diff to spot any issues (like changing text in a string). Once you are happy with this change the #define to typedef int32_tand build. Once you are happy with this, rename XXXintXXX to int32_t"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1531927191, "post_id": 51401925, "comment_id": 89782230, "body": "Note there are other special cases, like <code>unsigned int</code> will be difficult to detect. I would allow it to convert, then convert <code>unsigned\\s*XXXintXXX</code> back, or to XXXuintXXX or uint32_t"}], "owner": {"reputation": 821, "user_id": 2912478, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bbfd1023cf7ba3aef7d10bcde4ccb2a4?s=128&d=identicon&r=PG&f=1", "display_name": "rph", "link": "https://stackoverflow.com/users/2912478/rph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531920366, "creation_date": 1531916537, "last_edit_date": 1531920366, "question_id": 51401925, "link": "https://stackoverflow.com/questions/51401925/use-sed-to-replace-all-int-type-to-int32-t-in-c-files", "title": "Use sed to replace all &quot;int&quot; type to &quot;int32_t&quot; in c++ files", "body": "<p>I think this is two questions:</p>\n\n<p>Q1) What is the pattern I should use to capture all <code>int</code> declarations in the source codes?</p>\n\n<ul>\n<li>The regex pattern I have come up so far is: <code>[\\(&lt;\\s]?(int)[\\s&gt;\\)]?</code></li>\n<li>@WiktorStribi\u017cew suggested in the comments to match whole word <code>int</code>. His solution is simpler than my first approach and does not cause the problem I ask in Question 2.</li>\n</ul>\n\n<p>Q2) How do I tell <code>sed</code> to replace only the word inside the group capture? I.e.: replace <code>int</code> to <code>int32_t</code> but leave all other characters in the matching pattern untouched?</p>\n\n<ul>\n<li>If I use <code>sed -i -E 's/[\\(&lt;\\s]?(int)[\\s&gt;\\)]?/int32_t/g' file.cpp</code> it will cause the following undesired effect: <code>func(int a)</code> -> <code>funcint32_ta)</code></li>\n</ul>\n\n<p>Here are some examples of test cases:</p>\n\n<ol>\n<li><code>int a;</code> -> <code>int32_t a;</code></li>\n<li><code>func(int a);</code> -> <code>func(int32_t a)</code> </li>\n<li><code>template&lt;int&gt; a;</code>  -> <code>template&lt;int32_t&gt; a;</code></li>\n</ol>\n\n<p>EDIT 1: To simplify, the solution can ignore <code>unsigned int</code>, i.e., if it leads to <code>unsigned int32_t</code> it is okay for me.</p>\n\n<p>EDIT 2: Some of you are asking why: this is a scientific computation application that will be distributed in some embedded processors. We want to guarantee our integer types are fixed to 32-bits. </p>\n\n<p>EDIT 3: The source code is not large. In fact, I can (and probably will) verify each modification realized. I just took the opportunity to learn more about the regex. </p>\n"}, {"tags": ["c++", "visual-studio", "lambda", "path", "filesystems"], "answers": [{"tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 1, "last_activity_date": 1531916089, "creation_date": 1531916089, "answer_id": 51401770, "question_id": 51401689, "link": "https://stackoverflow.com/questions/51401689/c-visual-studio-error-identifier-cannot-be-implicitly-captured-because-no-def/51401770#51401770", "title": "C++ Visual Studio error: Identifier cannot be implicitly captured because no default capture mode has been specified", "body": "<p>You can't use surrounding variables in a lambda unless you capture them.</p>\n\n<p>You use <code>compFileName</code> which is defined in the surrounding scope, but it's not listed as a capture.</p>\n\n<p>Simple fix: Add <code>&amp;compFileName</code> to your capture list:</p>\n\n<pre><code>[&amp;file_name, &amp;compFileName](const auto &amp; dir_entry) { ... }\n</code></pre>\n\n<p>Even simpler: Capture <em>all</em> used variables:</p>\n\n<pre><code>[&amp;](const auto &amp; dir_entry) { ... }\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10092927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/085bc99050a1e730d4d4ef3fd35276fe?s=128&d=identicon&r=PG&f=1", "display_name": "Gus", "link": "https://stackoverflow.com/users/10092927/gus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "accepted_answer_id": 51401770, "answer_count": 1, "score": 1, "last_activity_date": 1531916089, "creation_date": 1531915807, "question_id": 51401689, "link": "https://stackoverflow.com/questions/51401689/c-visual-studio-error-identifier-cannot-be-implicitly-captured-because-no-def", "title": "C++ Visual Studio error: Identifier cannot be implicitly captured because no default capture mode has been specified", "body": "<p>I'm trying to extract the value of dir_entry.path() in this code and want to copy it into compFileName.\nThe problem is that I keep receiving the error 'compFileName cannot be implicitly captured because no default capture mode has been specified.</p>\n\n<p>I know it has to do with something related to lambda functions but I have zero experience in them.\nAny advice on how I should solve this issue to achieve what I want?</p>\n\n<pre><code>#include &lt;filesystem&gt;\n#include &lt;algorithm&gt;\n\nnamespace fs = std::filesystem;\n\nvoid search(const fs::path&amp; directory, const fs::path&amp; file_name, string &amp;compFileName)\n{\n    auto d = fs::recursive_directory_iterator(directory);\n\n    auto found = std::find_if(d, end(d), [&amp;file_name](const auto &amp; dir_entry)\n    {\n        string t = dir_entry.path().filename().string();\n        compFileName = t;\n        return t == file_name;\n    );\n\n}\n</code></pre>\n"}, {"tags": ["c++", "oop", "design-patterns"], "comments": [{"owner": {"reputation": 706, "user_id": 4070330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5de272559ba2ec727fe9b3108afa222f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Kashpur", "link": "https://stackoverflow.com/users/4070330/andrew-kashpur"}, "edited": false, "score": 0, "creation_date": 1531917377, "post_id": 51401613, "comment_id": 89775080, "body": "can you return from B vector of created objects and then insert these objects into map in A ?"}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 1, "creation_date": 1531918133, "post_id": 51401613, "comment_id": 89775598, "body": "Could you give a bit more information on what the actual problem is you&#39;re trying to solve with this design? Your question currently focuses on how to make a particular design work rather than explaining what you&#39;re trying to accomplish. It will be hard to suggest a better approach without know what the actual problem is\u2026"}], "answers": [{"tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 0, "last_activity_date": 1531917974, "creation_date": 1531917974, "answer_id": 51402408, "question_id": 51401613, "link": "https://stackoverflow.com/questions/51401613/creating-objects-that-are-owned-by-class-a-in-class-b-where-b-doesnt-know-of-a/51402408#51402408", "title": "Creating objects that are owned by class A in class B where B doesn&#39;t know of A", "body": "<p>You could provide an appropriate handler, similar to the following:</p>\n\n<pre><code>class B\n{\npublic:\n    template &lt;typename T&gt;\n    void execute(T newObjectHandler)\n    {\n        Foo* foo = new Foo();\n        newObjectHandler(foo);\n        executeTask(foo);\n    }\n};\n\nvoid A::executeTask()\n{\n    myB-&gt;executeTask([this](Foo* foo) { /* insert into map */ });\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 900, "user_id": 1885835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50d75ab8c233d44ca9db8def4d757b4d?s=128&d=identicon&r=PG", "display_name": "floppy12", "link": "https://stackoverflow.com/users/1885835/floppy12"}, "is_accepted": false, "score": 0, "last_activity_date": 1531918245, "creation_date": 1531918245, "answer_id": 51402492, "question_id": 51401613, "link": "https://stackoverflow.com/questions/51401613/creating-objects-that-are-owned-by-class-a-in-class-b-where-b-doesnt-know-of-a/51402492#51402492", "title": "Creating objects that are owned by class A in class B where B doesn&#39;t know of A", "body": "<p>Going for your 1. solution is ok to me as long as the ownership of Foo objects created from class B and transferred to class A is clearly stated because deletion will take place in/from A.</p>\n\n<p>Merging two maps shouldn't be a big deal.</p>\n\n<p>It has a strong advantage compared to your 2. solution:\n - there is no coupling with A's internal map > return type can vary independently in both A or B, allowing you to use the same from another class C in the future which could hold Foo objects in let's say a <code>vector&lt;Foo&gt;</code></p>\n"}], "owner": {"reputation": 345, "user_id": 6646922, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ca2c9138ed1fa987c60bca8b07642c69?s=128&d=identicon&r=PG&f=1", "display_name": "user6646922", "link": "https://stackoverflow.com/users/6646922/user6646922"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1541453640, "creation_date": 1531915575, "last_edit_date": 1541453640, "question_id": 51401613, "link": "https://stackoverflow.com/questions/51401613/creating-objects-that-are-owned-by-class-a-in-class-b-where-b-doesnt-know-of-a", "title": "Creating objects that are owned by class A in class B where B doesn&#39;t know of A", "body": "<p>I have a question about design. There is class A that owns a map of objects of type Foo. Objects of A create Foo objects and store them in the map, but when a certain indication comes, I want to do some work in class B and create further Foo objects there. A is aware of B and delegates the task to it, but not the other way round. Foo objects created in B still need to go into the map in A.</p>\n\n<p>Possible solutions:</p>\n\n<ol>\n<li>Return a map of shared_ptrs to created objects from a method in B.</li>\n<li>Pass the map from A to a method in B as a non-const reference.</li>\n</ol>\n\n<p>Somehow, I have a feeling that both of these approaches are bad and class B shouldn't really create objects that it doesn't own. Is there some design pattern that would help in this situation? I was thinking about some factory, but it's just adding a proxy to the problem and I don't really think it helps much. Or maybe I should get rid of class B altogether and have all the logic in A? The problem here, however, is that I don't want A to do too much.</p>\n"}, {"tags": ["c++", "cuda"], "comments": [{"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1531915706, "post_id": 51401459, "comment_id": 89773991, "body": "What is your actual question here?"}, {"owner": {"reputation": 17, "user_id": 10099303, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-prW__BQWpME/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qrz2M5RRcIz2N8OsrMdXSh11i44g/mo/photo.jpg?sz=128", "display_name": "KristofKockelkoren", "link": "https://stackoverflow.com/users/10099303/kristofkockelkoren"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1531915838, "post_id": 51401459, "comment_id": 89774096, "body": "Hi Talonmies, I saw already very interesting answers you gave. My question is, it is can be parallellised, and if yes, how i start"}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 1, "creation_date": 1531917622, "post_id": 51401459, "comment_id": 89775243, "body": "If my understanding is correct, then you basically just compute a bunch of values (&quot;properties&quot;) for a lot of different coordinates (rotation angles). Unless I missed something, I&#39;d say it looks like the computation of each of these properties is independent of the rest. So yes, this could be parallelized. If you&#39;d gain anything from using CUDA here, however, is hard to say without knowing more about the concrete application\u2026"}, {"owner": {"reputation": 17, "user_id": 10099303, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-prW__BQWpME/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qrz2M5RRcIz2N8OsrMdXSh11i44g/mo/photo.jpg?sz=128", "display_name": "KristofKockelkoren", "link": "https://stackoverflow.com/users/10099303/kristofkockelkoren"}, "edited": false, "score": 0, "creation_date": 1531918214, "post_id": 51401459, "comment_id": 89775644, "body": "Indeed, it is a computation of properties of a 3D model of a molecule.  The thing i struggle with : I thought, for parallellisation, all calls/functions must be independent of eachother . What I see, the loops are linked together (Mattrix_Y, Matrix_Z, Matrix_Z). Is is possibe to parralize then?"}, {"owner": {"reputation": 4311, "user_id": 1669370, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/E2t7h.jpg?s=128&g=1", "display_name": "Regis Portalez", "link": "https://stackoverflow.com/users/1669370/regis-portalez"}, "edited": false, "score": 2, "creation_date": 1531924510, "post_id": 51401459, "comment_id": 89780352, "body": "As usual, profiling your code is the right way to identify bottlenecks. Maybe it&#39;s in dotMatrix, maybe it&#39;s in getEnergy, maybe it&#39;s in memory allocaion in your innermost loop. I strongly suggest you to 1. profile your code 2. write a simple reproducer we can actually compile and run"}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1531930190, "post_id": 51401459, "comment_id": 89784257, "body": "It is quite likely that there is a sensible way to GPU accelerate the calculations this code performs. It is also quite likely that there is no way to naively &quot;parallelize&quot; the code in the way you seen to be implying. As for how to start, I generally find that making a fresh pot of tea, putting on some Miles Davis, sitting down at the computer and typing some code is a great way  to start writing in CUDA"}, {"owner": {"reputation": 17, "user_id": 10099303, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-prW__BQWpME/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qrz2M5RRcIz2N8OsrMdXSh11i44g/mo/photo.jpg?sz=128", "display_name": "KristofKockelkoren", "link": "https://stackoverflow.com/users/10099303/kristofkockelkoren"}, "edited": false, "score": 0, "creation_date": 1531933748, "post_id": 51401459, "comment_id": 89786303, "body": "Thanks for the good hints and feedback. I just noticed the &quot;parallelize&quot; typo ;) We already did some timings and iteration documentation, and in effect, the &quot;GetEnergy&quot; calculation takes about 75% of the time. So i want to look into solutions to put these calculations in parallel, as this can speed up things. I see they are in a loop together with the other 2 functions. Does anyone had to do some kind of function separation like this , and maybe some examples? thx for the help"}], "owner": {"reputation": 17, "user_id": 10099303, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-prW__BQWpME/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qrz2M5RRcIz2N8OsrMdXSh11i44g/mo/photo.jpg?sz=128", "display_name": "KristofKockelkoren", "link": "https://stackoverflow.com/users/10099303/kristofkockelkoren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531915255, "creation_date": 1531915074, "last_edit_date": 1531915255, "question_id": 51401459, "link": "https://stackoverflow.com/questions/51401459/possibility-to-parallelize-c-nested-for-loop-with-cuda-investigation", "title": "Possibility to parallelize c++ nested for loop with CUDA /Investigation", "body": "<p>I have a C++ (CPP) file which is very cpu intensive, and has a lot of loops/iterations. It is compiled and wrapped to python as a shared object.  A doctor asked me if it could be parrallellised and to work out a draft version on a cheap GPU , before he would buy expensive stuff (I am a student). I've read and did some basic cuda, which is working, but don't know how to start now.\nAnd it it possible to parallellize this.</p>\n\n<p>This is the loop we are talking about:</p>\n\n<pre><code>vector&lt;double&gt; Calculate (vector&lt; vector&lt;double&gt; &gt;  Oricoor, int size_coor, vector&lt; vector&lt;double&gt; &gt; Property, string normalization, \n        vector&lt;int&gt; rotationStepList, float resolution, int beginProbe, int endProbe, vector&lt;double&gt; radius) {\n    const int N_PROPERTIES = 4; \n    int size = rotationStepList.size(); \n    const int numberOfProbes = endProbe - beginProbe;\n\n    //self.__getBox__(oricoor)\n    vector&lt; vector&lt;double&gt; &gt; boxPoint = getBox(Oricoor, size_coor, resolution, radius);\n\n    //self.__getEnergies__(oricoor, prop)\n    vector&lt;double&gt; e = getEnergy(boxPoint, Oricoor, size_coor, Property, beginProbe, endProbe);\n\n    //self.sphore = self.energy\n    vector&lt;double&gt; sphore(N_PROPERTIES * numberOfProbes);\n    for (int i = 0; i &lt; N_PROPERTIES * numberOfProbes; ++i) {\n        sphore[i] = e[i];\n    }\n\n    for (int i = 0; i &lt; size; i++) {\n        int rotationStep = rotationStepList[i];\n        //cout &lt;&lt; \"Rotation Sterp: \" &lt;&lt; rotationStep &lt;&lt; endl;\n        for (int iTheta = 0; iTheta &lt; 180; iTheta += rotationStep){\n            double theta = 0.017453292519943 * iTheta;\n            double cos_theta = cos(theta);\n            double sin_theta = sin(theta);\n\n            double rotateY[3][3] = {{cos_theta, 0, -sin_theta},\n                {        0, 1,          0},\n                {sin_theta, 0, cos_theta}};\n\n            vector&lt; vector&lt;double&gt; &gt; Matrix_Y = dotMatrix(Oricoor, size_coor, rotateY);\n\n            for (int iPsi = 0; iPsi &lt; 360; iPsi += rotationStep) {\n                double psi = 0.017453292519943 * iPsi;\n                double cos_psi = cos(psi);\n                double sin_psi = sin(psi);\n\n                double rotateZ[3][3] = {{cos_psi, -sin_psi, 0},\n                    {sin_psi,  cos_psi, 0},\n                    {      0,        0, 1}};\n\n                vector&lt; vector&lt;double&gt; &gt; Matrix_Z = dotMatrix(Matrix_Y, size_coor, rotateZ);\n\n                for (int iPhi = 0; iPhi &lt; 360; iPhi += rotationStep){\n                    double phi = 0.017453292519943 * iPhi;\n                    double cos_phi = cos(phi);\n                    double sin_phi = sin(phi); \n\n                    double rotateX[3][3] = {{1,       0,        0},\n                        {0, cos_phi, -sin_phi},\n                        {0, sin_phi,  cos_phi}};\n\n                    vector&lt; vector&lt;double&gt; &gt; Matrix_X = dotMatrix(Matrix_Z, size_coor, rotateX);\n                    vector&lt; vector&lt;double&gt; &gt; boxP  = getBox(Matrix_X, size_coor, resolution, radius);\n\n                    //self.__getEnergies__(oricoor, prop)\n                    vector&lt;double&gt; energy = getEnergy(boxP, Matrix_X, size_coor, Property, beginProbe, endProbe); \n\n                    //self.sphore = self.energy\n                    for (int a = 0; a &lt; N_PROPERTIES * numberOfProbes; ++a) {\n                        if (energy[a] &lt; sphore[a]) {\n                            sphore[a] = energy[a];\n                        }\n                    }\n                }\n            }\n        }\n    }\n</code></pre>\n"}, {"tags": ["python", "c++", "opencv", "matrix-indexing"], "answers": [{"tags": [], "owner": {"reputation": 5482, "user_id": 2286337, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/A8dkr.jpg?s=128&g=1", "display_name": "zindarod", "link": "https://stackoverflow.com/users/2286337/zindarod"}, "is_accepted": false, "score": 0, "last_activity_date": 1531925698, "last_edit_date": 1531925698, "creation_date": 1531916138, "answer_id": 51401790, "question_id": 51401380, "link": "https://stackoverflow.com/questions/51401380/fast-indexing-in-c-opencv/51401790#51401790", "title": "Fast indexing in C++ OpenCV", "body": "<p>I don't know if this is the most efficient way of doing this and if it's not then someone will correct me.</p>\n\n<p>One way would be to set the image to value row by row</p>\n\n<pre><code>for (int i = 0; i &lt; image.rows-1; ++i)\n{\n  image.row(i).setTo(Scalar(0,0,0));\n}\n</code></pre>\n\n<p>Or if the image data pointer is continues then use <code>std::fill</code></p>\n\n<pre><code>if(image.isContinuous())\n    std::fill_n(image.data, (image.rows-1) * image.cols * image.elemSize(), 0);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 7522604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b9306c79eb7aba8de140afef02083e?s=128&d=identicon&r=PG&f=1", "display_name": "Eggman", "link": "https://stackoverflow.com/users/7522604/eggman"}, "edited": false, "score": 0, "creation_date": 1532005153, "post_id": 51402963, "comment_id": 89817489, "body": "That&#39;s what I needed, thank you! I just add that, looking into it, a couple of  <code>cv::Range</code> vectors can be used (e.g. <code>m(cv::Range(i0,i1), cv::Range(j0,j1))</code> does a trick equivalent to <code>m(cv::Rect(i0,i1,j0-i0,j1-i1))</code>."}, {"owner": {"reputation": 892, "user_id": 6114832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e88cb96ab965010731d7d9fa059d165?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Karlsson", "link": "https://stackoverflow.com/users/6114832/stefan-karlsson"}, "reply_to_user": {"reputation": 53, "user_id": 7522604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b9306c79eb7aba8de140afef02083e?s=128&d=identicon&r=PG&f=1", "display_name": "Eggman", "link": "https://stackoverflow.com/users/7522604/eggman"}, "edited": false, "score": 1, "creation_date": 1532080565, "post_id": 51402963, "comment_id": 89849792, "body": "great to help. Bear in mind that while the original numpy code you posted is the fastest way to do this for numpy, do not expect this to be the fastest way to do it in c++. In either case, it should be much faster then numpy"}], "tags": [], "owner": {"reputation": 892, "user_id": 6114832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e88cb96ab965010731d7d9fa059d165?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Karlsson", "link": "https://stackoverflow.com/users/6114832/stefan-karlsson"}, "is_accepted": true, "score": 1, "last_activity_date": 1531919572, "creation_date": 1531919572, "answer_id": 51402963, "question_id": 51401380, "link": "https://stackoverflow.com/questions/51401380/fast-indexing-in-c-opencv/51402963#51402963", "title": "Fast indexing in C++ OpenCV", "body": "<p>The best way is probably to use regions of interest. A cv mat can easily be partitioned by using a rect in the following way:</p>\n\n<pre><code>using namespace cv;\n\nMat a = Mat::ones(10, 15, CV_32FC1);\nRect rect(2, 2, 4, 4);\nMat roi = a(rect);\n</code></pre>\n\n<p>you can hereafter modify the <code>roi</code> in whatever fashion you like, put back in <code>a</code> by:</p>\n\n<pre><code> roi.copyTo(a(rect));\n</code></pre>\n\n<p>You can elegantly use a new <code>Rect</code> in the previous line, as long as its width and height are the same as the original <code>Rect</code>. To solve your specific question, the easiest way is to make a new matrix with all zeros, and then use copyTo with that one.</p>\n"}], "owner": {"reputation": 53, "user_id": 7522604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b9306c79eb7aba8de140afef02083e?s=128&d=identicon&r=PG&f=1", "display_name": "Eggman", "link": "https://stackoverflow.com/users/7522604/eggman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 0, "accepted_answer_id": 51402963, "answer_count": 2, "score": 1, "last_activity_date": 1531925698, "creation_date": 1531914868, "question_id": 51401380, "link": "https://stackoverflow.com/questions/51401380/fast-indexing-in-c-opencv", "title": "Fast indexing in C++ OpenCV", "body": "<p>I am quite comfortable with OpenCV in Python. I recently switched to the C++ version, and I keep having problems with the <code>cv::Mat</code> indexing, since I'm too used to <code>numpy</code>'s arrays.\nIn particular, I am trying to find if there is a better way of acting on a restricted area of an array without iterating through it.\nFor example, let's say I have a <code>10x15</code> unitary matrix and I would like to put everything but the last row to zero (or to another random number); in Python, I would do something like this:</p>\n\n<pre><code>import numpy as np\n\na = np.ones([10,15])\na[:-1,:-1] = 0\n</code></pre>\n\n<p>How can I achieve that in C++, having defined <code>cv::Mat a = cv::Mat::ones(10, 15, CV_32FC1);</code>?</p>\n"}, {"tags": ["c++", "unit-testing", "googlemock"], "comments": [{"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1531915057, "post_id": 51401360, "comment_id": 89773505, "body": "<code>getRecords</code> return object of type <code>CursorPtr</code>, and you mock method tries to return <code>CursorPtr*</code> Those are two different methods. And what is the meaning of <code>( no * )</code>? It seems to be the bit causing compiler errors."}, {"owner": {"reputation": 4897, "user_id": 1113997, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0b81915021f87732e45938efc6942947?s=128&d=identicon&r=PG", "display_name": "ghostrider", "link": "https://stackoverflow.com/users/1113997/ghostrider"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1531915271, "post_id": 51401360, "comment_id": 89773663, "body": "@Yksisarvinen ok let me retry, but returning CursorPtr gave me lots of compilation errors."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1531915377, "post_id": 51401360, "comment_id": 89773748, "body": "What kind of compiler errors you get? Please edit the question and add them (copy and paste them, don&#39;t paraphrase)."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1531915432, "post_id": 51401360, "comment_id": 89773791, "body": "You have protected <code>PostgresDb</code> constructor, are you not creating objects of that class anywhere?"}, {"owner": {"reputation": 4897, "user_id": 1113997, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0b81915021f87732e45938efc6942947?s=128&d=identicon&r=PG", "display_name": "ghostrider", "link": "https://stackoverflow.com/users/1113997/ghostrider"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1531915506, "post_id": 51401360, "comment_id": 89773851, "body": "@Yksisarvinen the public one takes argument a string, the protected is just for the Mock class that uses it. Argument is the environment the db connects to but dont need it for Mock. Editing my answer."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1531916204, "post_id": 51401360, "comment_id": 89774307, "body": "<code>Mismatched types errors</code> don&#39;t say much. If possible, copy the exact message (try to filter out gmock macros related ones). I see you try to return <code>MockCursor</code> object in function returning <code>CursorPtr</code>. What is <code>MockCursor</code> and how is it related to <code>CursorPtr</code>?"}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1531916337, "post_id": 51401360, "comment_id": 89774400, "body": "IIRC, methods mocked should be virtual, if your mock is inheriting from implementation class. Especially destructor (otherwise mock&#39;s destructor will not be called)."}], "answers": [{"tags": [], "owner": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "is_accepted": true, "score": 2, "last_activity_date": 1531985548, "last_edit_date": 1531985548, "creation_date": 1531919123, "answer_id": 51402796, "question_id": 51401360, "link": "https://stackoverflow.com/questions/51401360/c-google-mock-unit-tests-mock-method-not-called-and-original-one-is/51402796#51402796", "title": "C++ Google mock/unit tests : Mock method not called and original one is", "body": "<p>The main problem here is that in the function <code>void original_get_method( const int id_1, const int id_2 , PostgresDb db)</code> the <code>PostgresDb</code> is passed by value, i.e. the copy constructor of PostgresDb will be called. This means that inside of the <code>original_get_method</code> function you don't have a <code>MockPostgresDb</code>-Object but a simple <code>PostgresDb</code> and that's why not the mocked method gets called but simply the original implementation. Furthermore the <code>getRecords</code> function is not virtual, i.e. the mocked method in class <code>MockPostgresDb</code> just shadows the function of <code>PostgresDb</code> (and so there's no way to tell the program at run-time which function to call, i.e. if there is a <code>PostgresDb</code>-Object or reference to such an object it will always call the function in that class).</p>\n\n<p>So first things to change:</p>\n\n<pre><code>class PostgresDb\n{\npublic :\n    // typedef the CursorPtr, this is just a smart pointer.\n    // sth like \n    typedef shared_ptr&lt;DbDataType&gt; CursorPtr ;\n\n    PostgresDb( const std::string &amp; connString ) ;\n\n    // ===&gt; make this method virtual &lt;====\n    virtual CursorPtr getRecords( const int id_1 ,\n                          const int id_2 ) ;\n}\n\n// pass PostgresDb by reference\nvoid original_get_method( const int id_1, const int id_2 , PostgresDb&amp; db);\n</code></pre>\n\n<p>These two changes will call the mocked method in <code>original_get_method</code>.</p>\n\n<hr>\n\n<p>Next problem is as pointed out in the comments:</p>\n\n<pre><code>MOCK_METHOD2( getRecords, CursorPtr*( const int , const int  ) ) ;\n</code></pre>\n\n<p>The mock method has a different signature then the base class -> function will not get overwritten in derived (mocked) class (i.e. they are two completely different functions). This is what you want:</p>\n\n<pre><code>MOCK_METHOD2( getRecords, CursorPtr( const int , const int  ) ) ;\n</code></pre>\n\n<hr>\n\n<p>Next problem is the following:</p>\n\n<pre><code>typedef shared_ptr&lt;DbDataType&gt; CursorPtr ;\n</code></pre>\n\n<p>You define your new type <code>CursorPtr</code> and then inherit from it</p>\n\n<pre><code>class MockCursor : public CursorPtr {}\n</code></pre>\n\n<p>But <code>MockCursor</code> does not inherit from <code>DbDataType</code> but from <code>std::shared_ptr</code>, i.e. they are nothing alike. Instead let <code>MockDbDataType</code> inherit from <code>DbDataType</code> and create a new type <code>MockCursor</code>:</p>\n\n<pre><code>typedef std::shared_ptr&lt;MockDbDataType&gt; MockCursor;\n</code></pre>\n\n<p>And then this should compile fine:</p>\n\n<pre><code>setupGetRecords( MockPostgresDb* db     ,\n                 MockCursor     cursor ) \n{\n    EXPECT_CALL( *db, getRecords(_,_) )\n        .Times( 1 )\n        .WillRepeatedly(::testing::Return( cursor ) ) ;\n}\n</code></pre>\n\n<p>I haven't tested this code, so if there are any problems let me know.</p>\n"}], "owner": {"reputation": 4897, "user_id": 1113997, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0b81915021f87732e45938efc6942947?s=128&d=identicon&r=PG", "display_name": "ghostrider", "link": "https://stackoverflow.com/users/1113997/ghostrider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4128, "favorite_count": 0, "accepted_answer_id": 51402796, "answer_count": 1, "score": 3, "last_activity_date": 1531985548, "creation_date": 1531914824, "last_edit_date": 1531917754, "question_id": 51401360, "link": "https://stackoverflow.com/questions/51401360/c-google-mock-unit-tests-mock-method-not-called-and-original-one-is", "title": "C++ Google mock/unit tests : Mock method not called and original one is", "body": "<p>I am mocking a method but it seems that my <code>GoogleTest</code> keeps calling the original implementation. Probably missing something but can't find out what is this?</p>\n\n<p>My class is a Postgres database accessor:</p>\n\n<pre><code>namespace project\n{\n\nclass PostgresDb\n{\npublic :\n    // typedef the CursorPtr, this is just a smart pointer.\n    // sth like \n    typedef shared_ptr&lt;DbDataType&gt; CursorPtr ;\n\n    PostgresDb( const std::string &amp; connString ) ;\n\n    CursorPtr getRecords( const int id_1 ,\n                          const int id_2 ) ;\n\nprotected :\n\n    // this will be used by the MockPostgresDb in our unit tests.\n    // it leaves the object uninitialized\n     PostgresDb (){} ;\n\n }\n\n}// end of namespace\n</code></pre>\n\n<p>and here is my mock class:</p>\n\n<pre><code>namespace project_test\n{\n\nclass MockPostgresDb : public project::PostgresDb\n{\npublic :\n    MockPostgresDb(){} ;\n    MOCK_METHOD2( getRecords, CursorPtr*( const int , const int  ) ) ;\n} ;\n\nclass MockCursor : public CursorPtr\n{\n    // ....\n}\n\n}\n</code></pre>\n\n<p>and here is the method I am testing and the test:</p>\n\n<pre><code>void original_get_method( const int id_1, const int id_2 , PostgresDb db)\n{\n    // ....\n    db.getRecords( id_1, id_2 ) ;\n    // ....\n}\n\n// helper function\nsetupGetRecords( MockPostgresDb* db     ,\n                 MockCursor*     cursor ) \n{\n    EXPECT_CALL( *db, getRecords(_,_) )\n        .Times( 1 )\n        .WillRepeatedly(::testing::Return( cursor ) ) ;\n}\n\n\nTEST_F(....)\n{\n    MockPostgresDb db ;\n    MockCursor     cursor ;\n    // ....\n    setupGetRecords( &amp;db, &amp;cursor ) ; \n    // ....\n    // and then calling a functi\n    original_method( id_1, id_2, db ) ;\n}\n</code></pre>\n\n<p>So in my mind, I am calling <code>original_method</code> and pass a <code>mock_db</code>. The <code>mock_db</code> calls its method <code>getRecords</code> which returns a <code>MockCursor</code>. This is where it should get me the mock one but I do enter the <code>db::getRecords</code>.</p>\n\n<p>I am trying to find where the mismatch is but cannot figure out.</p>\n\n<p>EDIT :</p>\n\n<p>So, as pointed out - <code>getRecords</code> should return a <code>CursorPtr</code> and not a <code>CursorPtr*</code>. So here is what I did:</p>\n\n<p>I also tried to change</p>\n\n<pre><code>MOCK_METHOD2( getRecords, CursorPtr*( const int , const int  ) ) ;`\n</code></pre>\n\n<p>to </p>\n\n<pre><code>MOCK_METHOD2( getRecords, CursorPtr( const int , const int  ) ) ;  // ( no * ) \n</code></pre>\n\n<p>And change the helper to</p>\n\n<pre><code>// helper function\nsetupGetRecords( MockPostgresDb* db     ,\n                 MockCursor     cursor ) \n{\n    EXPECT_CALL( *db, getRecords(_,_) )\n        .Times( 1 )\n        .WillRepeatedly(::testing::Return( cursor ) ) ;\n}\n</code></pre>\n\n<p>and getting some mismatched types of compilation errors. What went wrong? Thanks.</p>\n"}, {"tags": ["android", "c++", "sockets", "tcp"], "comments": [{"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 0, "creation_date": 1531919486, "post_id": 51401104, "comment_id": 89776534, "body": "Does <code>new Socket</code> throw any exception when it does not connect?"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1531923142, "post_id": 51401104, "comment_id": 89779338, "body": "Are you looking at <code>errno</code> when the calls fail?"}, {"owner": {"reputation": 21, "user_id": 9256361, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AwtdE0TscLo/AAAAAAAAAAI/AAAAAAAAADk/9yvOsEulfdk/photo.jpg?sz=128", "display_name": "Ranjan Das", "link": "https://stackoverflow.com/users/9256361/ranjan-das"}, "edited": false, "score": 0, "creation_date": 1531997591, "post_id": 51401104, "comment_id": 89812432, "body": "The socket in java is throwing an exception. when i convert the exception to string and print it in a textview nothing gets displayed"}, {"owner": {"reputation": 21, "user_id": 9256361, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AwtdE0TscLo/AAAAAAAAAAI/AAAAAAAAADk/9yvOsEulfdk/photo.jpg?sz=128", "display_name": "Ranjan Das", "link": "https://stackoverflow.com/users/9256361/ranjan-das"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1532005027, "post_id": 51401104, "comment_id": 89817402, "body": "@Eljay I am sure the error is from java side. Error is observed for socket1 = new Socket(&quot;192.168.1.1&quot;, 5050); I have not checked errno."}], "owner": {"reputation": 21, "user_id": 9256361, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AwtdE0TscLo/AAAAAAAAAAI/AAAAAAAAADk/9yvOsEulfdk/photo.jpg?sz=128", "display_name": "Ranjan Das", "link": "https://stackoverflow.com/users/9256361/ranjan-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1531946781, "creation_date": 1531913981, "last_edit_date": 1531946781, "question_id": 51401104, "link": "https://stackoverflow.com/questions/51401104/socket-connection-successful-in-emulator-but-showing-error-in-mobile", "title": "Socket connection successful in emulator but showing error in mobile", "body": "<p>I am creating 2 sockets. Client is an android app and server code is written in c++.</p>\n\n<p>To create socket:\nin app:</p>\n\n<pre><code>socket = new Socket(\"192.168.1.1\", 5026);\nsocket1 = new Socket(\"192.168.1.1\", 5050);\n</code></pre>\n\n<p>in server side: </p>\n\n<pre><code>int sock::create_sock(int port_no, bool blocking)\n{\n    int sockfd, newsockfd;\n    int portno = port_no;\n    socklen_t clilen;\n    struct sockaddr_in serv_addr, cli_addr;\n    int n;\n\n    sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    if (sockfd &lt; 0)\n        error(\"ERROR opening socket\");\n\n    int enable = 1;\n\n    if (setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &amp;enable, sizeof(int)) &lt; 0)\n        error(\"setsockopt(SO_REUSEADDR) failed\");\n\n    bzero((char *)&amp;serv_addr, sizeof(serv_addr));\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_addr.s_addr = INADDR_ANY;\n    serv_addr.sin_port = htons(portno);\n\n    if (bind(sockfd, (struct sockaddr *) &amp;serv_addr, sizeof(serv_addr)) &lt; 0)\n        error(\"ERROR on binding\");\n\n    listen(sockfd, 5);\n    clilen = sizeof(cli_addr);\n\n    newsockfd = accept(sockfd, (struct sockaddr *) &amp;cli_addr, &amp;clilen);\n    if (newsockfd &lt; 0)\n        error(\"ERROR on accept\");\n\n    if (blocking == false)\n    {\n        fcntl(newsockfd, F_SETFL, O_NONBLOCK);  // Change the socket into non-blocking state\n        cout &lt;&lt; \"Creating non-blocking socket \" &lt;&lt; endl;\n    }\n\n    printf(\"server: got connection from %s port %d\\n\", inet_ntoa(cli_addr.sin_addr), ntohs(cli_addr.sin_port));\n\n    close(sockfd);\n    return newsockfd;\n}\n</code></pre>\n\n<p>There is a connect button in the app. When the button is clicked, socket the java code to create socket runs.</p>\n\n<p>Now the problem is the app runs fine in emulator. Both the sockets are getting connected no matter how many times I press connect. But when I run it in mobile, it connects only once. On subsequent clicking of the connect button, only the first socket is created and the second one stops before accepting function in server.</p>\n"}, {"tags": ["c++", "macros"], "comments": [{"owner": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 1, "creation_date": 1531914093, "post_id": 51401066, "comment_id": 89772798, "body": "Why are you writing C code and pretending it&#39;s C++?"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "reply_to_user": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1531914146, "post_id": 51401066, "comment_id": 89772836, "body": "@paxdiablo the name of the file is main.cpp, so I think it is C style C++ code."}, {"owner": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1531914188, "post_id": 51401066, "comment_id": 89772872, "body": "@mch: yes, hence the &quot;pretend&quot; clause in my comment :-) C-style C++ code, as you eloquently put it, is possibly the <i>worst</i> thing you can do to learn C++. Having said that, the fact that it is <code>main.cpp</code> <i>does</i> indicate C++, so I&#39;ll restore the C++ tag (and take away the C one) - it&#39;s very rare that a question should have both."}], "answers": [{"tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": true, "score": 2, "last_activity_date": 1531913985, "creation_date": 1531913985, "answer_id": 51401107, "question_id": 51401066, "link": "https://stackoverflow.com/questions/51401066/printing-macro-fails-to-concatenate/51401107#51401107", "title": "Printing macro fails to concatenate", "body": "<p>C string literals are joined automatically.  The <code>##</code> you have now is meant to join two \"tokens\" (not strings) into one, e.g. to take <code>ABC</code> and <code>XYZ</code> and make <code>ABCXYZ</code> as an identifier.</p>\n\n<p>You want this:</p>\n\n<pre><code>printf(\"Line: %d File %s \" msg, __LINE__ , __FILE__, __VA_ARGS__);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "is_accepted": false, "score": 2, "last_activity_date": 1531914012, "creation_date": 1531914012, "answer_id": 51401117, "question_id": 51401066, "link": "https://stackoverflow.com/questions/51401066/printing-macro-fails-to-concatenate/51401117#51401117", "title": "Printing macro fails to concatenate", "body": "<p>Exactly what it says on the tin: <code>\"Line: %d File %s \"\"Msg: %d\"</code> is not a single, valid preprocessing token as <code>##</code> is required to produce.</p>\n\n<p>Just drop the <code>##</code>, as adjacent string literals are already concatenated by the preprocessor.</p>\n"}], "owner": {"reputation": 249, "user_id": 10099283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a377d003a86ff78b7b9a99f5e73a805e?s=128&d=identicon&r=PG&f=1", "display_name": "flamasterrr", "link": "https://stackoverflow.com/users/10099283/flamasterrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "closed_date": 1531914611, "accepted_answer_id": 51401107, "answer_count": 2, "score": 1, "last_activity_date": 1531914366, "creation_date": 1531913852, "last_edit_date": 1531914366, "question_id": 51401066, "link": "https://stackoverflow.com/questions/51401066/printing-macro-fails-to-concatenate", "closed_reason": "Duplicate", "title": "Printing macro fails to concatenate", "body": "<p>I want to create a macro that prints some info and takes any number of arguments to print additional message(s) if needed.</p>\n\n<p>Here's a code snippet im talking about: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define print(msg, ...) \\\n    printf(\"Line: %d File %s \"## msg, __LINE__ , __FILE__, __VA_ARGS__);\n\nint main()\n{\n    print(\"Msg: %d\", 13);\n    print(\"Msg: %d, Msg2: %d\", 123, 234);\n}\n</code></pre>\n\n<p>Here's an error I'm getting:</p>\n\n<pre><code>main.cpp:12:9: error: pasting \"\"Line: %d File %s \"\" and \"\"Msg: %d\"\" does not give a valid preprocessing token\n  printf(\"Line: %d File %s \"## msg, __LINE__ , __FILE__, __VA_ARGS__);\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c++", "qt", "c++17"], "comments": [{"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 3, "creation_date": 1531914096, "post_id": 51400833, "comment_id": 89772802, "body": "Can you describe in words the problem you are trying to solve (not as it relates to Rust, but in terms of what you want to accomplish in C++ using plain English)?"}, {"owner": {"reputation": 833, "user_id": 3297655, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df1bc6c2cef925a8f52d36b3290958b9?s=128&d=identicon&r=PG&f=1", "display_name": "chabapok", "link": "https://stackoverflow.com/users/3297655/chabapok"}, "reply_to_user": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1531914619, "post_id": 51400833, "comment_id": 89773178, "body": "I need to move QByteArray from optional to my variable. Malloc should not be called."}, {"owner": {"reputation": 7180, "user_id": 2666212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874561e399041a45c82c2ca6652400b6?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2666212/mike"}, "edited": false, "score": 2, "creation_date": 1531927114, "post_id": 51400833, "comment_id": 89782182, "body": "@chabapok, please be aware that <code>QByteArray</code> has its own notion of being <a href=\"https://doc.qt.io/qt-5/qbytearray.html#isNull\" rel=\"nofollow noreferrer\">&quot;null&quot;</a> which is different from just being <a href=\"https://doc.qt.io/qt-5/qbytearray.html#isEmpty\" rel=\"nofollow noreferrer\">&quot;empty&quot;</a>, so wrapping a <code>QByteArray</code> inside a <code>std::optional</code> is pointless in most cases."}], "answers": [{"tags": [], "owner": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "is_accepted": false, "score": 6, "last_activity_date": 1531915159, "last_edit_date": 1531915159, "creation_date": 1531914538, "answer_id": 51401278, "question_id": 51400833, "link": "https://stackoverflow.com/questions/51400833/how-to-take-qbytearray-from-stdoptionalqbytearray-and-leave-stdnullopt-wit/51401278#51401278", "title": "How to take QByteArray from std::optional&lt;QByteArray&gt; and leave std::nullopt without additional mallocs?", "body": "<p>Your assumption about <a href=\"https://en.cppreference.com/w/cpp/utility/move\" rel=\"nofollow noreferrer\"><code>std::move</code></a> is wrong. Roughly speaking std::move casts to an rvalue reference, no actual code is generated in itself by that. The following line will create a <code>QByteArray</code> on the stack by calling its move constructor.</p>\n\n<pre><code>QByteArray optarr = std::move(*myopt);\n</code></pre>\n\n<p>The move constructor initializes the <code>Data</code> pointer from the other QByteArray and replaces the other's data pointer with pointer to shared empty data. No <code>malloc</code> is involved, just two pointer assignments.</p>\n\n<p>The <a href=\"https://code.woboq.org/qt5/qtbase/src/corelib/tools/qbytearray.h.html\" rel=\"nofollow noreferrer\">implementation</a> of the move constructor looks like this:</p>\n\n<pre><code>inline QByteArray(QByteArray &amp;&amp; other) Q_DECL_NOTHROW : d(other.d) { other.d = Data::sharedNull(); }\n</code></pre>\n\n<p>So your code is actually doing what you want.</p>\n"}, {"comments": [{"owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "edited": false, "score": 0, "creation_date": 1531916014, "post_id": 51401452, "comment_id": 89774200, "body": "Wow, I didn&#39;t know that the trailing return type syntax was possible in C++ :o"}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 6, "last_activity_date": 1531915549, "last_edit_date": 1531915549, "creation_date": 1531915053, "answer_id": 51401452, "question_id": 51400833, "link": "https://stackoverflow.com/questions/51400833/how-to-take-qbytearray-from-stdoptionalqbytearray-and-leave-stdnullopt-wit/51401452#51401452", "title": "How to take QByteArray from std::optional&lt;QByteArray&gt; and leave std::nullopt without additional mallocs?", "body": "<p>The equivalent<sup>&dagger;</sup> function in C++ would be:</p>\n\n<pre><code>auto func(optional&lt;QByteArray&gt;&amp;&amp; o) -&gt; QByteArray\n{\n    return std::move(o).value();\n}\n</code></pre>\n\n<p><code>std::move(o)</code> gives you an rvalue of type <code>optional&lt;QByteArray&gt;</code>. Invoking <code>value()</code> on that rvalue gives you a <code>QByteArray&amp;&amp;</code> (or throws if <code>o</code> is disengaged). That rvalue of type <code>QByteArray</code> is used to move construct the return object. This move construction is cheap, just a few pointer assignments - no memory allocation happens.</p>\n\n<hr />\n\n<p><sup>&dagger;</sup>Almost equivalent. Note that <code>o</code> here does <em>not</em> end up as a disengaged <code>optional</code>, unlike in Rust. It is still engaged, just holding an empty <code>QByteArray</code>. Truly equivalent, if really desired, would be:</p>\n\n<pre><code>auto func(optional&lt;QByteArray&gt;&amp;&amp; o) -&gt; QByteArray\n{\n    QByteArray result = std::move(o).value(); // NB: not a reference\n    o.reset();                                // or '= nullopt', or '= {}'\n    return result;                            // NB: no need to move\n}\n</code></pre>\n"}], "owner": {"reputation": 833, "user_id": 3297655, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df1bc6c2cef925a8f52d36b3290958b9?s=128&d=identicon&r=PG&f=1", "display_name": "chabapok", "link": "https://stackoverflow.com/users/3297655/chabapok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 1, "accepted_answer_id": 51401452, "answer_count": 2, "score": 3, "last_activity_date": 1531919807, "creation_date": 1531913091, "last_edit_date": 1531919807, "question_id": 51400833, "link": "https://stackoverflow.com/questions/51400833/how-to-take-qbytearray-from-stdoptionalqbytearray-and-leave-stdnullopt-wit", "title": "How to take QByteArray from std::optional&lt;QByteArray&gt; and leave std::nullopt without additional mallocs?", "body": "<p>I need to write a function that takes ownership of an <code>optional&lt;QByteArray&gt;</code>'s underlying array.</p>\n\n<p>In Rust, it is done by this way:</p>\n\n<pre class=\"lang-rust prettyprint-override\"><code>fn my_func(f: &amp;mut Option&lt;Box&lt;[u8]&gt;&gt;) -&gt; Box&lt;[u8]&gt; {\n     //how to do \"take\" in c++17?\n     f.take().unwrap()\n}\n</code></pre>\n\n<p>I know about <code>std::move</code>, but as far as I understand, this code will <code>malloc</code> data for a new array, swap pointers, and drop unneeded <code>QByteArray</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>std::optional&lt;QByteArray&gt; optarr = ...\nQByteArray optarr = std::move(*myopt);\noptarr.reset()\n</code></pre>\n\n<p>Is there any way to do this as well as in Rust (that is, without allocating memory for temporary <code>QByteArray</code>)?</p>\n"}, {"tags": ["c++", "range-v3"], "answers": [{"comments": [{"owner": {"reputation": 38390, "user_id": 923854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OecRr.png?s=128&g=1", "display_name": "Casey", "link": "https://stackoverflow.com/users/923854/casey"}, "edited": false, "score": 2, "creation_date": 1531925053, "post_id": 51404607, "comment_id": 89780715, "body": "FYI, this won&#39;t work when someone passes an rvalue <code>View</code> to your &quot;partial application&quot; overload: You&#39;ll return a <code>bind_expression</code> that stores a <code>reference_wrapper</code> to that (possibly temporary) <code>View</code> object."}], "tags": [], "owner": {"reputation": 2363, "user_id": 4588453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/51da95e02741a304f3620d3b9697eda9?s=128&d=identicon&r=PG&f=1", "display_name": "pseyfert", "link": "https://stackoverflow.com/users/4588453/pseyfert"}, "is_accepted": false, "score": 0, "last_activity_date": 1531924079, "creation_date": 1531924079, "answer_id": 51404607, "question_id": 51400817, "link": "https://stackoverflow.com/questions/51400817/make-custom-range-v3-view-pipeable/51404607#51404607", "title": "make custom range v3 view pipeable", "body": "<p>After more trying around, we figured out that the <code>std::bind</code> should receive a <code>std::ref</code> to the mask.</p>\n\n<pre><code>            return make_pipeable(\n                std::bind(*this,\n                          std::placeholders::_1,\n                          std::ref(msk));\n</code></pre>\n\n<p>If not, then - so my understanding - the <code>masker</code> would outlive a temporary copy of the <code>msk</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 38390, "user_id": 923854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OecRr.png?s=128&g=1", "display_name": "Casey", "link": "https://stackoverflow.com/users/923854/casey"}, "is_accepted": true, "score": 5, "last_activity_date": 1531924523, "creation_date": 1531924523, "answer_id": 51404777, "question_id": 51400817, "link": "https://stackoverflow.com/questions/51400817/make-custom-range-v3-view-pipeable/51404777#51404777", "title": "make custom range v3 view pipeable", "body": "<p><code>std::bind</code> is weird. If you pass a <code>bind_expression</code> - the result of a call to <code>std::bind</code> - to <code>std::bind</code>, it produces an expression tree that is evaluated from the \"leaves\" down. For example:</p>\n\n<pre><code>auto f = [](int i, int j){ return i * j; };\nauto g = [](int i) { return i + 1; };\nauto b = std::bind(f, std::bind(g, std::placeholders::_1), std::placeholders::_2);\nstd::cout &lt;&lt; b(0, 3) &lt;&lt; '\\n'; // prints 3\n</code></pre>\n\n<p>The call <code>b(0, 3)</code> here is equivalent to <code>f(g(0), 3)</code>.</p>\n\n<p><code>protect</code> is a range-v3 utility used to capture function objects inside the <code>bind</code> object that prevents <code>std::bind</code> from engaging this weirdness if those function objects happen to be <code>bind_expression</code>s. For non-<code>bind_expressions</code>, <code>protect</code> has \"capture rvalues by value and lvalues by reference\" behavior (most things in range-v3 assume that the caller guarantees lifetime of lvalues but that rvalues may \"disappear\" before needed and therefore must be stored).</p>\n\n<p>Unfortunately, you use <code>protect</code> with a <code>Range</code> in your \"partial application\" overload:</p>\n\n<pre><code>template&lt;typename Msk&gt;\nauto operator()(Msk&amp;&amp; msk) const -&gt; decltype(\n    make_pipeable(std::bind(*this, std::placeholders::_1,\n                            protect(std::forward&lt;Msk&gt;(msk)))))\n{   \n    CONCEPT_ASSERT(Range&lt;Msk&gt;());\n    return make_pipeable(\n        std::bind(*this,\n                  std::placeholders::_1,\n                  protect(std::forward&lt;Msk&gt;(msk))));\n}\n</code></pre>\n\n<p><code>std::bind</code> has a different design from range-v3: it stores copies of whatever you pass inside the returned <code>bind_expression</code> and passes lvalues denoting those stored objects to the wrapped function upon invocation. The end effect is that your overload returns a <code>bind_expression</code> wrapped in a <code>make_pipeable</code> that holds a copy of the <code>vector</code> the caller passed in.</p>\n\n<p>When the test program \"pipes\" in another range, the <code>make_pipeable</code> invokes your other overload with that range and an lvalue denoting the <code>vector</code> copy stored inside the bind expression. You pass that lvalue to <code>view::zip</code> which (as described above) assumes that its caller will guarantee that lvalue will remain alive as long as the <code>zip_view</code> it produces. This is of course not the case: The <code>make_pipeable</code> temporary - including the <code>vector</code> stored inside the <code>bind_expression</code> it contains - are destroyed after evaluating the initializer in the range-for statement in the test program. When the range-for tries to access that dead <code>vector</code>, UB occurs which manifests in this case as an empty range.</p>\n\n<p>The fix is to not use <code>protect</code> in your \"partial application\" overload, but to instead pass an <code>all_view</code> of the range to <code>std::bind</code>:</p>\n\n<pre><code>template&lt;typename Msk&gt;\nauto operator()(Msk&amp;&amp; msk) const -&gt; decltype(\n    make_pipeable(std::bind(*this, std::placeholders::_1,\n                            ranges::view::all(std::forward&lt;Msk&gt;(msk)))))\n{   \n    CONCEPT_ASSERT(Range&lt;Msk&gt;());\n    return make_pipeable(\n        std::bind(*this,\n                  std::placeholders::_1,\n                  ranges::view::all(std::forward&lt;Msk&gt;(msk))));\n}\n</code></pre>\n\n<p>(Admittedly, it would be nice if <code>protect</code> would guard against this error by refusing to accept <code>Range</code>s.)</p>\n"}], "owner": {"reputation": 2363, "user_id": 4588453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/51da95e02741a304f3620d3b9697eda9?s=128&d=identicon&r=PG&f=1", "display_name": "pseyfert", "link": "https://stackoverflow.com/users/4588453/pseyfert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 1, "accepted_answer_id": 51404777, "answer_count": 2, "score": 4, "last_activity_date": 1531924523, "creation_date": 1531913045, "last_edit_date": 1531917874, "question_id": 51400817, "link": "https://stackoverflow.com/questions/51400817/make-custom-range-v3-view-pipeable", "title": "make custom range v3 view pipeable", "body": "<p>I'm trying to implement masked range views with range v3. Somehow I ended up in the situation where my implementation of</p>\n\n<pre><code>ranges::view::masker(datarange, mask)\n</code></pre>\n\n<p>works, but the piped version</p>\n\n<pre><code>ranges::view::all(datarange) | ranges::view::masker(mask)\n</code></pre>\n\n<p>doesn't, although withing the <code>operators</code> of the internal structures, the masks arrive correctly. (I put my implementation of <code>masker</code> into the <code>ranges::view</code> namespace, although it is not part of range v3).</p>\n\n<p>My test program is relatively trivial, create some widgets and a meaningless mask</p>\n\n<pre><code>class Widget\n{\nprivate:\n  int   m_int{0};\n\npublic:\n  Widget() {}\n  Widget( int i ) : m_int( i ) {}\n  int   the_int() const { return m_int; }\n};\n\ninline std::ostream&amp; operator&lt;&lt;( std::ostream&amp; str, const Widget&amp; obj )\n{\n  str &lt;&lt; '\\t' &lt;&lt; obj.the_int();\n  return str;\n}\n\nint main()\n{\n  std::vector&lt;Widget&gt; widgets;\n  std::vector&lt;bool&gt;   mask;\n\n  for ( auto i : ranges::view::indices( 24 ) ) {\n    widgets.emplace_back( i );\n    mask.push_back( i % 3 != 1 );\n  }\n\n  std::cout &lt;&lt; \"wrapped\" &lt;&lt; std::endl;\n  for ( auto&amp; el : ranges::view::masker( widgets, mask ) ) {\n    std::cout &lt;&lt; el &lt;&lt; std::endl;\n  }\n  std::cout &lt;&lt; std::endl;\n  std::cout &lt;&lt; std::endl;\n\n  std::cout &lt;&lt; \"piped\" &lt;&lt; std::endl;\n  for ( auto&amp; el : ranges::view::all( widgets ) | ranges::view::masker( mask ) ) {\n    std::cout &lt;&lt; el &lt;&lt; std::endl;\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>Ignoring namespaces and debug printout the <code>masker</code> just zips the data range and the mask together, filters on the mask and returns the widgets as view:</p>\n\n<pre><code>        struct mask_fn\n        {\n            template&lt;typename Rng, typename Msk&gt;\n            auto operator()(Rng&amp;&amp; rng, Msk&amp;&amp; msk) const\n            {\n                CONCEPT_ASSERT(Range&lt;Rng&gt;());\n                CONCEPT_ASSERT(Range&lt;Msk&gt;());\n\n                return ranges::view::zip(std::forward&lt;Rng&gt;(rng),\n                                         std::forward&lt;Msk&gt;(msk)) |\n                       ranges::view::filter([](auto&amp;&amp; range_item) -&gt; bool {\n\n                           return range_item.second;\n                       }) |\n                       ranges::view::transform(\n                           [](auto&amp;&amp; range_item) -&gt; decltype(auto) {\n                               return range_item.first;\n                           });\n            }                  \n            template&lt;typename Msk&gt;\n            auto operator()(Msk&amp;&amp; msk) const -&gt; decltype(\n                make_pipeable(std::bind(*this, std::placeholders::_1,\n                                        protect(std::forward&lt;Msk&gt;(msk)))))\n            {   \n                CONCEPT_ASSERT(Range&lt;Msk&gt;());\n                return make_pipeable(\n                    std::bind(*this,\n                              std::placeholders::_1,\n                              protect(std::forward&lt;Msk&gt;(msk))));\n            }                 \n        };                    \n\n        RANGES_INLINE_VARIABLE(mask_fn, masker)\n</code></pre>\n\n<p>The above program is intended to print out the same resulting range twice, yet I only get:</p>\n\n<pre><code>wrapped\n    0\n    2\n    3\n    5\n    6\n    8\n    9\n    11\n    12\n    14\n    15\n    17\n    18\n    20\n    21\n    23\n\n\npiped\n</code></pre>\n\n<p>So while using <code>auto operator()(Rng&amp;&amp; rng, Msk&amp;&amp; msk) const</code> the right widgets are looped over, the version with <code>auto operator()(Msk&amp;&amp; msk) const</code> does not return anything.</p>\n\n<p>I tried adding some debug printout to the former (because it gets ultimately called by the latter) and observe that the mask arrives correctly.</p>\n\n<pre><code>        struct mask_fn\n        {\n            template&lt;typename Rng, typename Msk&gt;\n            auto operator()(Rng&amp;&amp; rng, Msk&amp;&amp; msk) const\n            {\n                CONCEPT_ASSERT(Range&lt;Rng&gt;());\n                CONCEPT_ASSERT(Range&lt;Msk&gt;());\n                for(auto t :\n                    ranges::view::zip(rng, msk) |\n                        ranges::view::filter([](auto&amp;&amp; range_item) -&gt;\n                        bool {\n                            return range_item.second;\n                        }) |\n                        ranges::view::transform(\n                            [](auto&amp;&amp; range_item) -&gt; decltype(auto) {\n                                return range_item.first;\n                            }))\n                    std::cout &lt;&lt; \"w: \" &lt;&lt; t &lt;&lt; std::endl;\n                return ranges::view::zip(std::forward&lt;Rng&gt;(rng),\n                                         std::forward&lt;Msk&gt;(msk)) |\n                       ranges::view::filter([](auto&amp;&amp; range_item) -&gt; bool {\n                           std::cout &lt;&lt; \"checking widget \"\n                                     &lt;&lt; range_item.first &lt;&lt; std::endl;\n                           std::cout &lt;&lt; \"returning \" &lt;&lt; range_item.second\n                                     &lt;&lt; std::endl;\n                           return range_item.second;\n                       }) |\n                       ranges::view::transform(\n                           [](auto&amp;&amp; range_item) -&gt; decltype(auto) {\n\n                               return range_item.first;\n                           });\n            }\n            template&lt;typename Msk&gt;\n            auto operator()(Msk&amp;&amp; msk) const -&gt; decltype(\n                make_pipeable(std::bind(*this, std::placeholders::_1,\n                                        protect(std::forward&lt;Msk&gt;(msk)))))\n            {\n                CONCEPT_ASSERT(Range&lt;Msk&gt;());\n                return make_pipeable(\n                    std::bind(*this,\n                              std::placeholders::_1,\n                              protect(std::forward&lt;Msk&gt;(msk))));\n            }\n        };\n\n        RANGES_INLINE_VARIABLE(mask_fn, masker)\n</code></pre>\n\n<p>(cutting the output a bit) one can see that using the supposed return range within <code>operator()</code> I loop over the correct widgets, but the printout from within the lambdas in the return line shows \"false\" flags for all items.</p>\n\n<pre><code>wrapped\nw:  0\nw:  2\nw:  3\nw:  5\n&lt;snap&gt;\nw:  20\nw:  21\nw:  23\nchecking widget     0\nreturning 1\n    0\nchecking widget     1\nreturning 0\nchecking widget     2\nreturning 1\n    2\nchecking widget     3\nreturning 1\n    3\n&lt;snap&gt;\nchecking widget     22\nreturning 0\nchecking widget     23\nreturning 1\n    23\n\n\npiped\nw:  0\nw:  2\nw:  3\nw:  5\n&lt;snap&gt;\nw:  20\nw:  21\nw:  23\nchecking widget     0\nreturning 0\nchecking widget     1\nreturning 0\nchecking widget     2\nreturning 0\nchecking widget     3\nreturning 0\n&lt;snap&gt;\nchecking widget     22\nreturning 0\nchecking widget     23\n</code></pre>\n\n<p>My best guess at the moment is that I messed up the <code>protect</code>, <code>std::forward</code>, <code>&amp;&amp;</code>, or <code>std::move</code> somewhere, though I tried to stick as close as possible to <code>filter.hpp</code> (since I thought I had understood it reasonably well) and also tried some random adding/removing of ampersands and forwards without success.</p>\n\n<p>Any suggestion how to fix this? (And ideally explanation of what's going on, along?).</p>\n\n<p>Thanks in advance.</p>\n\n<p>footnotes: I'm at the moment not concerned about c++11 compatibility.</p>\n\n<p>EDIT:</p>\n\n<p>I pushed the mess to <a href=\"https://github.com/pseyfert/range_v3_playground/tree/ed62595a157c8b26f71aea90edb9d989bbf326ec\" rel=\"nofollow noreferrer\">github</a>.</p>\n"}, {"tags": ["c++", "c", "bash"], "comments": [{"owner": {"reputation": 695068, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 0, "creation_date": 1531912577, "post_id": 51400575, "comment_id": 89771796, "body": "Why wouldn&#39;t you just install the missing library?"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1531913899, "post_id": 51400575, "comment_id": 89772674, "body": "as @TheTailgunner asked, can you add the exact command(s) you used to build the shared library ?"}, {"owner": {"reputation": 1178, "user_id": 1563037, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vhb7A.png?s=128&g=1", "display_name": "gabry", "link": "https://stackoverflow.com/users/1563037/gabry"}, "edited": false, "score": 0, "creation_date": 1531917309, "post_id": 51400575, "comment_id": 89775030, "body": "You can try to statically link libstdc++ to your binary, with the gcc option -static-libstdc++"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 1, "creation_date": 1531917429, "post_id": 51400575, "comment_id": 89775124, "body": "Did you link it using g++? (You should)"}, {"owner": {"reputation": 1, "user_id": 10098929, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XH0xLEVo27s/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7piZwm4xhQg5pPAyFR4RVnrP42LeQ/mo/photo.jpg?sz=128", "display_name": "Lothar Langer", "link": "https://stackoverflow.com/users/10098929/lothar-langer"}, "edited": false, "score": 0, "creation_date": 1531926211, "post_id": 51400575, "comment_id": 89781538, "body": "Thx to all of you! Looking more closely at the linker command i realized that i linked with gcc and compiled with g++. After changing that the &#39;__gxx_personality_v0&#39; problem disappeared. New problems came up concerning differences in name mangling by g++ as opposed to c but i will be able to handle those by using &#39;extern &quot;C&quot;&#39;."}], "owner": {"reputation": 1, "user_id": 10098929, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XH0xLEVo27s/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7piZwm4xhQg5pPAyFR4RVnrP42LeQ/mo/photo.jpg?sz=128", "display_name": "Lothar Langer", "link": "https://stackoverflow.com/users/10098929/lothar-langer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531912847, "creation_date": 1531912425, "last_edit_date": 1531912588, "question_id": 51400575, "link": "https://stackoverflow.com/questions/51400575/bash-dynamically-loadable-builtin-written-in-c-not-enablable", "title": "Bash dynamically loadable builtin written in c++ not enablable?", "body": "<p>I am writing a loadable builtin called <code>items</code> for <strong>bash</strong> using C++ instead of C and wrapped the relevant (interfacing) portions in an <code>extern \"C\"</code> directive. So everything builds fine and I get my shared library <code>items</code> ... only trying to enable it results in:</p>\n\n<pre><code>$ enable -f ./items items\nbash: enable: cannot open shared object ./items: ./items: undefined symbol: __gxx_personality_v0\n</code></pre>\n\n<p>Googling about <code>__gxx_personality_v0</code> gave me the hint that the involvement of <code>libstdc++</code> is missing - of course.</p>\n\n<p>My question is: Is there an easy and reasonable way to make the loadable enable or do I have to go back to plain C anyways?</p>\n"}, {"tags": ["c++", "oop", "visual-c++"], "comments": [{"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1531915098, "post_id": 51400541, "comment_id": 89773533, "body": "Neither.   Even if we assume <code>Class</code> is a typo and should be <code>class</code>, the functions are <code>private</code>, and neither class has another member function or friend, so neither function can be called by any function other than itself."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "reply_to_user": {"reputation": 4121, "user_id": 4290866, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0727d9acdc35a0359d0703da9e11f239?s=128&d=identicon&r=PG&f=1", "display_name": "user32434999", "link": "https://stackoverflow.com/users/4290866/user32434999"}, "edited": false, "score": 0, "creation_date": 1531915794, "post_id": 51400541, "comment_id": 89774053, "body": "@Pi Question is about <i>overloading</i> vs. hiding, not <i>overriding</i> vs. hiding. Two completely different concepts."}], "answers": [{"tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 8, "last_activity_date": 1531915349, "last_edit_date": 1531915349, "creation_date": 1531912522, "answer_id": 51400613, "question_id": 51400541, "link": "https://stackoverflow.com/questions/51400541/difference-between-function-hiding-and-overloading/51400613#51400613", "title": "difference between function hiding and overloading", "body": "<p>The function <code>B::print</code> <em>hides</em> the parent function <code>A::print</code>.</p>\n\n<p>If you want to <em>overload</em> you need to pull in the <code>A::print</code> function into the scope of <code>B</code>:</p>\n\n<pre><code>class B : public A {\npublic:\n    using A::print;  // Pull in (all) A::print symbols into the scope of B\n\n    void print(float);  // Now overloads A::print\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 874, "user_id": 6858550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fbd1aac23957d00bfb620319ddd38a13?s=128&d=identicon&r=PG&f=1", "display_name": "Han XIAO", "link": "https://stackoverflow.com/users/6858550/han-xiao"}, "edited": false, "score": 0, "creation_date": 1533613900, "post_id": 51401527, "comment_id": 90397958, "body": "Nice explanation. If you can explain Argument Dependent Lookup and Global Scope, this explanation could be more enlighting."}], "tags": [], "owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "is_accepted": false, "score": 3, "last_activity_date": 1531918510, "last_edit_date": 1531918510, "creation_date": 1531915287, "answer_id": 51401527, "question_id": 51400541, "link": "https://stackoverflow.com/questions/51400541/difference-between-function-hiding-and-overloading/51401527#51401527", "title": "difference between function hiding and overloading", "body": "<p>A name defined in a scope <strong>hides</strong> declarations of the same name in any outer scope. Like this:</p>\n\n<pre><code>int name; // global name\n\nvoid f() {\n    int name; // name 1, hides global name\n    for (int i = 0; i &lt; 10; i++) }\n        int name; // name 2, hides name 1 and global name\n        name = 3; // assigns 3 to name 2\n    }\n    name = 4; // assigns 4 to name 1\n}\n\nint other = name; // copies value of global name into other\n</code></pre>\n\n<p>When two or more functions with the same name are declared <strong>in the same scope</strong>, the name is overloaded:</p>\n\n<pre><code>// two functions in global scope:\nvoid f();\nvoid f(int);\n\nvoid g() {\n    f();  // ok: calls first version of f\n    f(1); // ok: calls second version of f\n}\n</code></pre>\n\n<p>Definitions in different scopes <strong>do not define overload sets</strong>, because the declaration in the inner scope hides the same name in any outer scope.</p>\n\n<pre><code>class cl1 {\npublic:\n    // hides global f's:\n    void f();\n\n    void g() {\n        f();  // ok: calls cl1::f()\n        f(1); // error: no f takes an int; global f(int) is hidden\n    }\n};\n</code></pre>\n\n<p>Of course, defining more than one function in the same scope still defines overloads, even if there are functions with the same (hidden) name in an outer scope.</p>\n\n<pre><code>class cl2 {\npublic:\n    // these hide global f's, and provided overloads:\n    void f();\n    void f(int);\n\n    void g() {\n        f();  // calls cl2::f()\n        f(1); // calls cl2::f(int)\n    }\n};\n</code></pre>\n\n<p>A class definition provides a new scope, so the rules about name hiding and overloading apply to names defined in the class.</p>\n\n<pre><code>class cl3 : public cl2 {\n        void g() {\n            f();  // calls cl2::f()\n            f(1); // calls cl2::f(int)\n        }\n    };\n\nclass cl4 : public cl2 {\n    // hides all f's:\n    void f();\n\n    void g() {\n        f();  // ok: calls cl4::f();\n        f(3); // error: no f takes an int; global f(int) and cl2::f(int) are hidden\n    }\n};\n\nclass cl5 : public cl2 {\n    // hides all f's and provides overloads:\n    void f();\n    void f(int);\n\n    void g() {\n        f();  // ok: calls cl5::f()\n        f(3); // ok: calls cl5::f(int)\n    }\n};\n</code></pre>\n\n<p>You can also use a signature that doesn't match any of the signatures in the base class. After all, the name of those base class functions is hidden.</p>\n\n<pre><code>class cl5 : public cl2 {\npublic:\n    // hides all f's:\n    void f(std::string);\n\n    void g() {\n        f();       // error: no f taking no arguments\n        f(3);      // error: no f taking int\n        std::string arg(\"test\");\n        f(arg); // ok: calls cl5::f(std::string)\n    }\n};\n</code></pre>\n\n<p>And, finally, if you want to write a derived class that adds signatures to the set of overloaded functions defined in a base class, you have to add the name of those overloaded functions to the derived class:</p>\n\n<pre><code>class cl6 : public cl2 {\npublic:\n    using cl2::f;        // pull cl2::f into current scope\n    void f(std::string); // add overload to names from cl2\n\n    void g() {\n        f();    // ok: calls cl2::f()\n        f(3);   // ok: calls cl2::f(int)\n        std::string arg(\"test\");\n        f(arg); // ok: calls cl6::f(std::string)\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 4833061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-BmnwWxYE4Ss/AAAAAAAAAAI/AAAAAAAAAHQ/OpIO-kSnNUo/photo.jpg?sz=128", "display_name": "Mishal Baig", "link": "https://stackoverflow.com/users/4833061/mishal-baig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 1, "accepted_answer_id": 51400613, "answer_count": 2, "score": 5, "last_activity_date": 1531922926, "creation_date": 1531912340, "last_edit_date": 1531922926, "question_id": 51400541, "link": "https://stackoverflow.com/questions/51400541/difference-between-function-hiding-and-overloading", "title": "difference between function hiding and overloading", "body": "<p>I can't find any difference between function hiding and overloading. As the function hiding is the function that is present in derived class and hides the function of a base class. Having same name of the function in both of them. \nOverloading: having same name but different signature in both derived and base class.</p>\n\n<pre><code>class A {\n    void print(int);\n};\nclass B: public A {\n    void print(float);\n};\n</code></pre>\n\n<p>does it hide function or overload ? </p>\n"}, {"tags": ["java", "android", "c++", "c"], "comments": [{"owner": {"reputation": 3, "user_id": 7812781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4869ec9920e8c7f810d8501bbd5cf45d?s=128&d=identicon&r=PG&f=1", "display_name": "H. Qyutukyan", "link": "https://stackoverflow.com/users/7812781/h-qyutukyan"}, "reply_to_user": {"reputation": 20970, "user_id": 2252830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7f66d50bf99dc20b5aac2f165c31676?s=128&d=identicon&r=PG", "display_name": "pskink", "link": "https://stackoverflow.com/users/2252830/pskink"}, "edited": false, "score": 0, "creation_date": 1531914339, "post_id": 51400454, "comment_id": 89772977, "body": "big info about lib"}, {"owner": {"reputation": 3, "user_id": 7812781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4869ec9920e8c7f810d8501bbd5cf45d?s=128&d=identicon&r=PG&f=1", "display_name": "H. Qyutukyan", "link": "https://stackoverflow.com/users/7812781/h-qyutukyan"}, "reply_to_user": {"reputation": 20970, "user_id": 2252830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7f66d50bf99dc20b5aac2f165c31676?s=128&d=identicon&r=PG", "display_name": "pskink", "link": "https://stackoverflow.com/users/2252830/pskink"}, "edited": false, "score": 0, "creation_date": 1531914809, "post_id": 51400454, "comment_id": 89773336, "body": "030d470 d _ZZNK2cv20CvtColorLoop_InvokerINS_10RGBA2mRGBAIhEEEclERKNS_5&zwnj;&#8203;RangeEE25__cv_trace_&zwnj;&#8203;location_fn279 003306b4 b _ZZNK2cv20CvtColorLoop_InvokerINS_10RGBA2mRGBAIhEEEclERKNS_5&zwnj;&#8203;RangeEE31__cv_trace_&zwnj;&#8203;location_extra_fn279 0030d4a4 d _ZZNK2cv20CvtColorLoop_InvokerINS_10mRGBA2RGBAIhEEEclERKNS_5&zwnj;&#8203;RangeEE25__cv_trace_&zwnj;&#8203;location_fn279 003306b8 b _ZZNK2cv20CvtColorLoop_InvokerINS_10mRGBA2RGBAIhEEEclERKNS_5&zwnj;&#8203;RangeEE31__cv_trace_&zwnj;&#8203;location_extra_fn279 0030cb8c d _ZZNK2cv20CvtColorLoop_InvokerINS_11Gray2RGB5x5EEclERKNS_5Ra&zwnj;&#8203;ngeEE25__cv_trace_lo&zwnj;&#8203;cation_fn279 0032f9ec b _ZZNK2cv20CvtColorLoop_I........"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7812781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4869ec9920e8c7f810d8501bbd5cf45d?s=128&d=identicon&r=PG&f=1", "display_name": "H. Qyutukyan", "link": "https://stackoverflow.com/users/7812781/h-qyutukyan"}, "edited": false, "score": 0, "creation_date": 1531913570, "post_id": 51400846, "comment_id": 89772457, "body": "Thanks for the answer. I did all this, but the problem in this, I don&#39;t know what type return myFunction and what kind of argument take it."}, {"owner": {"reputation": 1942, "user_id": 5458344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c732ce4032f4b690f5b4e33e5031ec?s=128&d=identicon&r=PG&f=1", "display_name": "E.Abdel", "link": "https://stackoverflow.com/users/5458344/e-abdel"}, "reply_to_user": {"reputation": 3, "user_id": 7812781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4869ec9920e8c7f810d8501bbd5cf45d?s=128&d=identicon&r=PG&f=1", "display_name": "H. Qyutukyan", "link": "https://stackoverflow.com/users/7812781/h-qyutukyan"}, "edited": false, "score": 1, "creation_date": 1531914459, "post_id": 51400846, "comment_id": 89773064, "body": "Unfortunately, If you don&#39;t have the header then it is very difficult to do"}, {"owner": {"reputation": 3, "user_id": 7812781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4869ec9920e8c7f810d8501bbd5cf45d?s=128&d=identicon&r=PG&f=1", "display_name": "H. Qyutukyan", "link": "https://stackoverflow.com/users/7812781/h-qyutukyan"}, "edited": false, "score": 0, "creation_date": 1531915097, "post_id": 51400846, "comment_id": 89773531, "body": "Even if I had this header file, how I can connect my java function or JNI function to this function which exists in .so  file? I think in this file we have C or C++ function, and want call this function."}, {"owner": {"reputation": 1942, "user_id": 5458344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c732ce4032f4b690f5b4e33e5031ec?s=128&d=identicon&r=PG&f=1", "display_name": "E.Abdel", "link": "https://stackoverflow.com/users/5458344/e-abdel"}, "reply_to_user": {"reputation": 3, "user_id": 7812781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4869ec9920e8c7f810d8501bbd5cf45d?s=128&d=identicon&r=PG&f=1", "display_name": "H. Qyutukyan", "link": "https://stackoverflow.com/users/7812781/h-qyutukyan"}, "edited": false, "score": 0, "creation_date": 1531915369, "post_id": 51400846, "comment_id": 89773739, "body": "If you have the .h, so you have to follow the step by step in my answer or this answer to load it into the native side : <a href=\"https://stackoverflow.com/questions/45314478/how-to-load-native-library-into-native-android-code-androidstudio/50507825#50507825\" title=\"how to load native library into native android code androidstudio\">stackoverflow.com/questions/45314478/&hellip;</a>"}, {"owner": {"reputation": 1942, "user_id": 5458344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c732ce4032f4b690f5b4e33e5031ec?s=128&d=identicon&r=PG&f=1", "display_name": "E.Abdel", "link": "https://stackoverflow.com/users/5458344/e-abdel"}, "reply_to_user": {"reputation": 3, "user_id": 7812781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4869ec9920e8c7f810d8501bbd5cf45d?s=128&d=identicon&r=PG&f=1", "display_name": "H. Qyutukyan", "link": "https://stackoverflow.com/users/7812781/h-qyutukyan"}, "edited": false, "score": 0, "creation_date": 1531915728, "post_id": 51400846, "comment_id": 89774006, "body": "Another thing, you don&#39;t connect your java function to the native function, but you declare (same name, same params) your C/C++ function in the java side as a native function and you call it through JNI"}], "tags": [], "owner": {"reputation": 1942, "user_id": 5458344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c732ce4032f4b690f5b4e33e5031ec?s=128&d=identicon&r=PG&f=1", "display_name": "E.Abdel", "link": "https://stackoverflow.com/users/5458344/e-abdel"}, "is_accepted": true, "score": 1, "last_activity_date": 1531913147, "creation_date": 1531913147, "answer_id": 51400846, "question_id": 51400454, "link": "https://stackoverflow.com/questions/51400454/use-so-shared-object-file-in-android-studio/51400846#51400846", "title": "Use .so (Shared object) file in Android studio", "body": "<p>First, you need absolutly the header (.h) containing the function declaration.</p>\n\n<p>Secondly, you have to create a folder that contains your .so file, you can name it for example <code>jniLibs</code> and put it in <code>src/main/jniLibs</code>, then add the <code>sourceSets</code> to you gradle file, into the android block : </p>\n\n<pre><code>sourceSets {\n        main {\n            jniLibs.srcDirs = ['src/main/jniLibs']\n        }\n    }\n</code></pre>\n\n<p><strong>NOTE :</strong>  the jniLibs folder normally contains subfolders depending on the lib's target ABI (arm64-v8a, armeabi-v7a, x86, x86_64), so you have to know it.</p>\n\n<p>And finally you have to load the native library in the java side by adding : </p>\n\n<pre><code>   /*  Load jni .so on initialization */\n    static {\n        System.loadLibrary(\"my-native-lib-name\");\n    }\n</code></pre>\n\n<p>And declare your function to use it like below : </p>\n\n<pre><code>public static native void myFunction(String arg, int another_arg);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7812781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4869ec9920e8c7f810d8501bbd5cf45d?s=128&d=identicon&r=PG&f=1", "display_name": "H. Qyutukyan", "link": "https://stackoverflow.com/users/7812781/h-qyutukyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 1, "accepted_answer_id": 51400846, "answer_count": 1, "score": -3, "last_activity_date": 1531913147, "creation_date": 1531912080, "question_id": 51400454, "link": "https://stackoverflow.com/questions/51400454/use-so-shared-object-file-in-android-studio", "title": "Use .so (Shared object) file in Android studio", "body": "<p>I have *.so file, which is not generated by me in my project. I know that there is a function in this lib named 'x', and I want to use this function, but don't know how.. </p>\n\n<p>P.S. </p>\n\n<p>I don't have source files that used for generating *.so file.  </p>\n"}]