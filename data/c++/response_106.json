[{"tags": ["c#", "c++", "struct", "marshalling", "wrapper"], "comments": [{"owner": {"reputation": 14263, "user_id": 1255873, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dZChN.jpg?s=128&g=1", "display_name": "Abion47", "link": "https://stackoverflow.com/users/1255873/abion47"}, "edited": false, "score": 0, "creation_date": 1484782876, "post_id": 41731331, "comment_id": 70657093, "body": "What is <code>CommSet</code>?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1484783168, "post_id": 41731331, "comment_id": 70657177, "body": "Off topic: <code>typedef struct</code> is generally not required in C++. <code>struct Set</code> would be sufficient for <code>Set</code> to be a valid identifier. <code>using CommSet = Set *;</code> will provide <code>CommSet</code>."}], "answers": [{"tags": [], "owner": {"reputation": 10471, "user_id": 802203, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/aDIFP.png?s=128&g=1", "display_name": "Ani", "link": "https://stackoverflow.com/users/802203/ani"}, "is_accepted": false, "score": 1, "last_activity_date": 1484792739, "last_edit_date": 1495542282, "creation_date": 1484792739, "answer_id": 41732723, "question_id": 41731331, "link": "https://stackoverflow.com/questions/41731331/how-to-wrap-c-structs-that-have-multiple-types-for-c/41732723#41732723", "title": "How to wrap C++ structs that have multiple types for C#?", "body": "<p>This is simply shorthand notation for declaring both the <code>typedef struct</code> and a pointer to it. See <a href=\"https://stackoverflow.com/a/1543720/802203\">here</a>.</p>\n\n<p>In your PInvoke bindings, depending on how it's used, you can use an IntPtr and marshal structs of type <code>Set</code> as required, or use <a href=\"https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshalasattribute(v=vs.110).aspx\" rel=\"nofollow noreferrer\">MarshalAs</a> to marshal a pointer pointing to a known length of structures.</p>\n"}], "owner": {"reputation": 353, "user_id": 2167335, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-GCKcL236wXU/AAAAAAAAAAI/AAAAAAAAJSw/Jr_5-7rPaEM/photo.jpg?sz=128", "display_name": "The Whether Man", "link": "https://stackoverflow.com/users/2167335/the-whether-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484792739, "creation_date": 1484782462, "question_id": 41731331, "link": "https://stackoverflow.com/questions/41731331/how-to-wrap-c-structs-that-have-multiple-types-for-c", "title": "How to wrap C++ structs that have multiple types for C#?", "body": "<p>I'm trying to wrap a set of C++ functions and structs based on a header file. So far I think I understand the concepts behind wrapping each structure, but I'm not sure how to pull this one apart:</p>\n\n<pre><code>typedef struct\n{\n    BYTE    commCode;\n    *other stuff*\n\n    struct\n    {\n        DWORD   size;\n        LPBYTE  payload;\n    }\n    Data;    \n}\nSet, *CommSet;\n</code></pre>\n\n<p>Should I do something like this?:</p>\n\n<pre><code>[StructLayout(LayoutKind.Sequential)]\npublic class Set\n{\n    public byte commCode;\n\n    public class DATA\n    {\n        public uint size;\n        public byte[] payload;\n    }\n}\n</code></pre>\n\n<p>But at this point I'm not sure how to account for the other type, the <code>*CommSet</code> pointer. Do I need a separate structure/class for that?</p>\n"}, {"tags": ["c++", "operator-overloading", "this"], "comments": [{"owner": {"reputation": 3797, "user_id": 2874856, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kWxOm.jpg?s=128&g=1", "display_name": "Raindrop7", "link": "https://stackoverflow.com/users/2874856/raindrop7"}, "edited": false, "score": 0, "creation_date": 1484781075, "post_id": 41731070, "comment_id": 70656527, "body": "<code>while (true)   cout &lt;&lt; *this;</code>"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1484781091, "post_id": 41731070, "comment_id": 70656532, "body": "hint: <code>this</code> is a pointer, and acts like such."}], "answers": [{"tags": [], "owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "is_accepted": true, "score": 5, "last_activity_date": 1484780983, "creation_date": 1484780983, "answer_id": 41731088, "question_id": 41731070, "link": "https://stackoverflow.com/questions/41731070/pass-this-to-overloaded-operator/41731088#41731088", "title": "Pass this to overloaded &lt;&lt; operator", "body": "<p><code>this</code> is a pointer.  You need</p>\n\n<pre><code>cout &lt;&lt; *this;\n</code></pre>\n\n<p>Also, your definition of <code>operator&lt;&lt;</code> should probably use the parameter <code>os</code> rather than always using <code>cout</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 5511, "user_id": 5563569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77f4ceeaf2fba395d7c1e2029ef1a901?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Pope", "link": "https://stackoverflow.com/users/5563569/matthew-pope"}, "is_accepted": false, "score": 1, "last_activity_date": 1484781009, "creation_date": 1484781009, "answer_id": 41731095, "question_id": 41731070, "link": "https://stackoverflow.com/questions/41731070/pass-this-to-overloaded-operator/41731095#41731095", "title": "Pass this to overloaded &lt;&lt; operator", "body": "<p><code>this</code> is a pointer. You probably need to dereference it.</p>\n\n<pre><code>cout &lt;&lt; *this;\n</code></pre>\n"}], "owner": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 41731088, "answer_count": 2, "score": -3, "last_activity_date": 1484781028, "creation_date": 1484780861, "question_id": 41731070, "link": "https://stackoverflow.com/questions/41731070/pass-this-to-overloaded-operator", "title": "Pass this to overloaded &lt;&lt; operator", "body": "<p>How can I pass <code>this</code> to <code>operator&lt;&lt;</code> in c++ class?  Or am I just doing this wrong (likely).  </p>\n\n<p>For example, in the following class I just have a loop that repetitively asks for and prints an integer.  However, <code>cout&lt;&lt;this</code> just prints the address of the instance, but I would like to use the defined operator overload.</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing std::cout; using std::endl; using std::cin;\n\nclass C {\n  int n;\n public:\n  C(int n) : n(n) {};\n  friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp;, const C&amp;);\n  void set_n(int i) { n = i; }\n  void play() {\n    int input;\n    while (true) {\n      cout &lt;&lt; this;\n      cin &gt;&gt; input;\n      set_n(input);\n    }\n  }\n};\n\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, const C&amp; c) {\n  cout &lt;&lt; c.n &lt;&lt; \"\\n\";\n  return os;\n}\n\nint main(int argc, char *argv[]) {\n  C c = C(1);\n  c.play();\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "virtual-machine", "vectorization", "sse2"], "answers": [{"tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 4, "last_activity_date": 1484780176, "creation_date": 1484780176, "answer_id": 41730944, "question_id": 41730860, "link": "https://stackoverflow.com/questions/41730860/sse2-vectorization-and-virtual-machines/41730944#41730944", "title": "sse2 vectorization and virtual machines", "body": "<blockquote>\n  <p>I don't really know how a VM works. Is a binary entirely executed on a software-emulated virtual cpu?</p>\n</blockquote>\n\n<p>For serious purposes, no, because it's too slow. (But e.g. <a href=\"http://bochs.sourceforge.net/\" rel=\"nofollow noreferrer\">Bochs</a> does; it can be useful for kernel debugging among other things)</p>\n\n<p>The binary is executed \"normally\" as much as possible. This generally means any code that doesn't try to interact with the OS will be executed directly. For example, system calls are likely to require the involvement of the VM implementation.</p>\n\n<blockquote>\n  <p>If not, supposing the VM is run on a cpu with SSE2, could the VM use his cpu SSE2 instruction when executing a SSE2 instruction from my binary?</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<blockquote>\n  <p>Could my vectorization be beneficial on the VM?</p>\n</blockquote>\n\n<p>Yes.</p>\n"}, {"comments": [{"owner": {"reputation": 680, "user_id": 6599487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ddd2b21482646c3a8acade4555c324?s=128&d=identicon&r=PG&f=1", "display_name": "Holmz", "link": "https://stackoverflow.com/users/6599487/holmz"}, "edited": false, "score": 0, "creation_date": 1484855550, "post_id": 41731032, "comment_id": 70693342, "body": "What have you tried and what have you noticed? Rather than guess you need to just get stuck into it in a practice sense. I was surprised to find that on my VMs that the performance was actually very good. This includes vectorisation. You could post back here as to what you conclude."}], "tags": [], "owner": {"reputation": 10078, "user_id": 2709018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/p98Vl.png?s=128&g=1", "display_name": "myaut", "link": "https://stackoverflow.com/users/2709018/myaut"}, "is_accepted": false, "score": 3, "last_activity_date": 1484780681, "creation_date": 1484780681, "answer_id": 41731032, "question_id": 41730860, "link": "https://stackoverflow.com/questions/41730860/sse2-vectorization-and-virtual-machines/41731032#41731032", "title": "sse2 vectorization and virtual machines", "body": "<p>Depends on VM technology and CPU capabilities. First x86 VMs (like VMWare on 32-bit machines) used <em>recompilation</em>. They looked into binary code of VMs to seek for harmful instructions (like accessing raw memory or special registers) to replace them with hyper-calls. </p>\n\n<p>Since SSE2 instructions are not harmful, they would just left as is, and no performance penalty added in VM. Moreover, modern x86 CPUs use \"hardware virtualization\" which allows to avoid recompilation. Harmful instructions are caught by CPU and generate an interrupt, but again SSE2 instrs shouldn't trigger it.</p>\n\n<p>There are of course full processor emulators like QEMU (not QEMU-KVM) or Bochs, but it's a different story. Bochs-emulated CPU, for example, is about 1000 times slower than host CPU.</p>\n"}], "owner": {"reputation": 2065, "user_id": 2836552, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47c7b954e22c8f427b46edf4cc9c2432?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeStarProgrammer57", "link": "https://stackoverflow.com/users/2836552/threestarprogrammer57"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1484780681, "creation_date": 1484779699, "question_id": 41730860, "link": "https://stackoverflow.com/questions/41730860/sse2-vectorization-and-virtual-machines", "title": "sse2 vectorization and virtual machines", "body": "<p>I am considering vectorizing some floor() calls using sse2 intrinsics, then measuring the performance gain. But ultimately the binary is going to be run on a virtual machine which I have no access to.</p>\n\n<p>I don't really know how a VM works. Is a binary entirely executed on a software-emulated virtual cpu ?</p>\n\n<p>If not, supposing the VM is run on a cpu with SSE2, could the VM use his cpu SSE2 instruction when executing a SSE2 instruction from my binary ?</p>\n\n<p>Could my vectorization be beneficial on the VM ? </p>\n"}, {"tags": ["android", "c++", "android-ndk"], "comments": [{"owner": {"reputation": 77347, "user_id": 1631193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c713494416ceac454d71c524e15f1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gabe Sechan", "link": "https://stackoverflow.com/users/1631193/gabe-sechan"}, "edited": false, "score": 0, "creation_date": 1484778575, "post_id": 41730589, "comment_id": 70655652, "body": "Not unless you&#39;re rooted, for directories.  Of course you can do it easily through JNI."}, {"owner": {"reputation": 1555, "user_id": 1340021, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/7a12d786f68fedfc466c808ba67a5267?s=128&d=identicon&r=PG", "display_name": "Bungles", "link": "https://stackoverflow.com/users/1340021/bungles"}, "reply_to_user": {"reputation": 77347, "user_id": 1631193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c713494416ceac454d71c524e15f1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gabe Sechan", "link": "https://stackoverflow.com/users/1631193/gabe-sechan"}, "edited": false, "score": 0, "creation_date": 1484779663, "post_id": 41730589, "comment_id": 70656071, "body": "Cool. Let&#39;s assume the device is rooted. In what directory would I find all the .apk files?"}, {"owner": {"reputation": 5956, "user_id": 1249472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d2ac9163237829d11cbf4ee7d563d?s=128&d=identicon&r=PG", "display_name": "Nikita", "link": "https://stackoverflow.com/users/1249472/nikita"}, "edited": false, "score": 0, "creation_date": 1484779930, "post_id": 41730589, "comment_id": 70656178, "body": "User installed apps are in <i>/data/app</i> and preinstalled are in <i>/system/app</i>."}, {"owner": {"reputation": 77347, "user_id": 1631193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c713494416ceac454d71c524e15f1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gabe Sechan", "link": "https://stackoverflow.com/users/1631193/gabe-sechan"}, "reply_to_user": {"reputation": 5956, "user_id": 1249472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d2ac9163237829d11cbf4ee7d563d?s=128&d=identicon&r=PG", "display_name": "Nikita", "link": "https://stackoverflow.com/users/1249472/nikita"}, "edited": false, "score": 0, "creation_date": 1484780023, "post_id": 41730589, "comment_id": 70656203, "body": "@nikita the system for got split in two a Weedle back. App and priv_app"}, {"owner": {"reputation": 15397, "user_id": 3290339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CMy5l.jpg?s=128&g=1", "display_name": "Onik", "link": "https://stackoverflow.com/users/3290339/onik"}, "edited": false, "score": 0, "creation_date": 1484783547, "post_id": 41730589, "comment_id": 70657304, "body": "Try executing in the environment the command: <code>pm list packages</code> and read (later parse) the output."}, {"owner": {"reputation": 1555, "user_id": 1340021, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/7a12d786f68fedfc466c808ba67a5267?s=128&d=identicon&r=PG", "display_name": "Bungles", "link": "https://stackoverflow.com/users/1340021/bungles"}, "edited": false, "score": 0, "creation_date": 1484873230, "post_id": 41730589, "comment_id": 70700982, "body": "Using &quot;adb shell&quot; I am unable to view &#39;/data/app&#39; on either of my devices (one is rooted, one is not).  Says insufficient permissions in both cases."}, {"owner": {"reputation": 1555, "user_id": 1340021, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/7a12d786f68fedfc466c808ba67a5267?s=128&d=identicon&r=PG", "display_name": "Bungles", "link": "https://stackoverflow.com/users/1340021/bungles"}, "edited": false, "score": 0, "creation_date": 1484934154, "post_id": 41730589, "comment_id": 70730291, "body": "Didn&#39;t realize I had to &quot;su&quot; first.  Although that kinda ruins the test in my case."}], "owner": {"reputation": 1555, "user_id": 1340021, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/7a12d786f68fedfc466c808ba67a5267?s=128&d=identicon&r=PG", "display_name": "Bungles", "link": "https://stackoverflow.com/users/1340021/bungles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 459, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484779605, "creation_date": 1484778467, "last_edit_date": 1484779605, "question_id": 41730589, "link": "https://stackoverflow.com/questions/41730589/can-i-access-the-list-of-installed-packages-on-android-from-c", "title": "Can I access the list of installed packages on Android from C++", "body": "<p>I would like to examine the list of installed packages from within C++ code on Android.  I don't want to use JNI to invoke the regular Android package manager.  Ideally I could just list the contents of some directory...?</p>\n"}, {"tags": ["c++", "opencv", "pointers", "cuda"], "comments": [{"owner": {"reputation": 2346, "user_id": 5179465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d11933d9ee569ac40d0111430579f556?s=128&d=identicon&r=PG&f=1", "display_name": "ilke444", "link": "https://stackoverflow.com/users/5179465/ilke444"}, "edited": false, "score": 3, "creation_date": 1484792102, "post_id": 41730512, "comment_id": 70659561, "body": "Are you sure that <code>frame</code> is not empty?"}, {"owner": {"reputation": 922, "user_id": 5991102, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh4.googleusercontent.com/-82TFHov0JE0/AAAAAAAAAAI/AAAAAAAAADc/QHywlTFF-Uo/photo.jpg?sz=128", "display_name": "pSoLT", "link": "https://stackoverflow.com/users/5991102/psolt"}, "reply_to_user": {"reputation": 2346, "user_id": 5179465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d11933d9ee569ac40d0111430579f556?s=128&d=identicon&r=PG&f=1", "display_name": "ilke444", "link": "https://stackoverflow.com/users/5179465/ilke444"}, "edited": false, "score": 0, "creation_date": 1484817576, "post_id": 41730512, "comment_id": 70669195, "body": "Access violation reading location 0x00000000 means <code>createImageBuffer</code> returned null pointer. And the most possible cause is what @ilke444 indicated - <code>frame.size()</code> returning 0."}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 1, "last_activity_date": 1484779269, "creation_date": 1484779269, "answer_id": 41730768, "question_id": 41730512, "link": "https://stackoverflow.com/questions/41730512/bad-ptr-value-when-trying-to-allocate-the-memory-for-the-image-buffer/41730768#41730768", "title": "Bad ptr value when trying to allocate the memory for the image buffer", "body": "<p>The API is probably unable to allocate enough memory. Check return value of cudaHostAlloc (cf. <a href=\"http://horacio9573.no-ip.org/cuda/group__CUDART__MEMORY_g15a3871f15f8c38f5b7190946845758c.html\" rel=\"nofollow noreferrer\">doku on cudaHostAlloc</a>):</p>\n\n<pre><code>unsigned char* createImageBuffer(unsigned int bytes)\n{\n    unsigned char* ptr;\n    cudaSetDeviceFlags(cudaDeviceMapHost);\n    cudaError_t allocResult = cudaHostAlloc(&amp;ptr, bytes, cudaHostAllocMapped);\n    if (allocResult != cudaSuccess) {\n      // could be cudaErrorMemoryAllocation; The API call failed because\n      // it was unable to allocate enough memory to perform\n      // the requested operation.\n      return nullptr;\n    }\n    return ptr;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4658920, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xRJZ93BoEt8/AAAAAAAAAAI/AAAAAAAACRY/TtLZGJSsAmM/photo.jpg?sz=128", "display_name": "bunkovic", "link": "https://stackoverflow.com/users/4658920/bunkovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484819819, "creation_date": 1484778131, "last_edit_date": 1484819819, "question_id": 41730512, "link": "https://stackoverflow.com/questions/41730512/bad-ptr-value-when-trying-to-allocate-the-memory-for-the-image-buffer", "title": "Bad ptr value when trying to allocate the memory for the image buffer", "body": "<pre><code>unsigned char* createImageBuffer(unsigned int bytes)\n{\n    unsigned char* ptr;\n    cudaSetDeviceFlags(cudaDeviceMapHost);\n    cudaHostAlloc(&amp;ptr, bytes, cudaHostAllocMapped);    \n    return ptr;\n}\n\n\n    cv::Mat sGray(frame.size(), CV_8U, createImageBuffer(frame.size().width * frame.size().height));\n\n    cv::Mat dGray(frame.size(), CV_8U, createImageBuffer(frame.size().width * frame.size().height));\n\n    cv::Mat eGray(frame.size(), CV_8U, createImageBuffer(frame.size().width * frame.size().height));\n</code></pre>\n\n<p>The problem during debugging is regarding accessing restricted memory at 0x00000000. The function is supposed to return a pointer to the place of image bytes allocation however it gives me the bad ptr value. </p>\n\n<p>Output: </p>\n\n<blockquote>\n  <p>First-chance exception at 0x0c10e473 in improc.exe: 0xC0000005: Access\n  violation reading location 0x00000000. Unhandled exception at\n  0x0c10e473 in improc.exe: 0xC0000005: Access violation reading\n  location 0x00000000.</p>\n</blockquote>\n\n<p>The video to the tutorial I followed: <a href=\"https://youtu.be/j9vb5UjQCQg\" rel=\"nofollow noreferrer\">https://youtu.be/j9vb5UjQCQg</a></p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1484839161, "post_id": 41730474, "comment_id": 70683476, "body": "Does <code>this-&gt;(i, j)</code> actually compile??"}], "answers": [{"tags": [], "owner": {"reputation": 59630, "user_id": 636019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ba39c7ba510ac2951c010c26afb6a6?s=128&d=identicon&r=PG", "display_name": "ildjarn", "link": "https://stackoverflow.com/users/636019/ildjarn"}, "is_accepted": false, "score": 1, "last_activity_date": 1484837527, "creation_date": 1484837527, "answer_id": 41744803, "question_id": 41730474, "link": "https://stackoverflow.com/questions/41730474/error-cannot-bind-stdostream-aka-stdbasic-ostreamchar-lvalue-to-std/41744803#41744803", "title": "error: cannot bind \u2018std::ostream {aka std::basic_ostream&lt;char&gt;}\u2019 lvalue to \u2018std::basic_ostream&lt;char&gt;&amp;&amp;\u2019", "body": "<p><code>std::ostream&amp; Matrix&lt;U&gt;::operator &lt;&lt;(std::ostream&amp;)</code> has the equivalent free-function signature <code>std::ostream&amp; operator &lt;&lt;(Matrix&lt;U&gt;&amp;, ostream&amp;)</code>, which is <strong><em>not</em></strong> what you want (for multiple reasons).</p>\n\n<p>It is not possible to implement streaming <code>operator &lt;&lt;</code> or <code>operator &gt;&gt;</code> as a member function of a UDT, because the first parameter must always be the stream. You could make the operator a <code>friend</code>, in which case the signature would need to be:</p>\n\n<pre><code>template &lt;typename U&gt;\nfriend std::ostream&amp; operator &lt;&lt;(std::ostream&amp;, Matrix const&amp;);\n</code></pre>\n\n<p>(Again, note that the stream comes first, like in your working code.)</p>\n\n<p>Your templated <code>operator &lt;&lt;</code> looks just fine. What's your objection to it?</p>\n"}], "owner": {"reputation": 31, "user_id": 6334386, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Sn2X0QSe_Gw/AAAAAAAAAAI/AAAAAAAAABE/NMqqpvtIxVI/photo.jpg?sz=128", "display_name": "Suad Halilovi\u0107", "link": "https://stackoverflow.com/users/6334386/suad-halilovi%c4%87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1059, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484837527, "creation_date": 1484777985, "question_id": 41730474, "link": "https://stackoverflow.com/questions/41730474/error-cannot-bind-stdostream-aka-stdbasic-ostreamchar-lvalue-to-std", "title": "error: cannot bind \u2018std::ostream {aka std::basic_ostream&lt;char&gt;}\u2019 lvalue to \u2018std::basic_ostream&lt;char&gt;&amp;&amp;\u2019", "body": "<p>Hello everonye even I found many answers here about this questions one simply could not explain me how things going could not fix it trying everything.</p>\n\n<p>So my question is I have a class called Matrix when I try to implement operator &lt;&lt; as inline method I get following error </p>\n\n<pre><code> error: cannot bind \u2018std::ostream {aka std::basic_ostream&lt;char&gt;}\u2019 lvalue to \u2018std::basic_ostream&lt;char&gt;&amp;&amp;\u2019\n</code></pre>\n\n<p>Here is how implementation of my method looks in class</p>\n\n<pre><code> ostream&amp; operator&lt;&lt;(ostream&amp; out)\n{\n\n    for (int i = 0; i &lt; this-&gt;getHeight(); ++i) {\n        for (int j = 0; j &lt; this-&gt;getWidth(); ++j) {\n\n            out &lt;&lt; this-&gt;(i, j) &lt;&lt; \"\\t\";\n        }\n        out&lt;&lt; \"\\n\";\n    }\n\n    return out;\n}\n</code></pre>\n\n<p>When I implement it as function like this </p>\n\n<pre><code>    template &lt;typename U&gt;\nostream&amp; operator&lt;&lt;(ostream&amp; out, const Matrix&lt;U&gt;&amp; c)\n{\n\n    for (int i = 0; i &lt; c.getHeight(); ++i) {\n        for (int j = 0; j &lt; c.getWidth(); ++j) {\n\n            out &lt;&lt; c(i, j) &lt;&lt; \"\\t\";\n        }\n        out &lt;&lt; \"\\n\";\n    }\n\n    return out;\n} \n</code></pre>\n\n<p>It works :(\nCan anyone explain me what I m doing wrong here </p>\n"}, {"tags": ["c++", "boost"], "answers": [{"tags": [], "owner": {"reputation": 3990, "user_id": 270589, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/11cd12c93e05654e0857df948183514e?s=128&d=identicon&r=PG", "display_name": "Behrooz Karjoo", "link": "https://stackoverflow.com/users/270589/behrooz-karjoo"}, "is_accepted": false, "score": -1, "last_activity_date": 1484859865, "creation_date": 1484859865, "answer_id": 41751688, "question_id": 41730327, "link": "https://stackoverflow.com/questions/41730327/boost-library-error/41751688#41751688", "title": "Boost library error", "body": "<p>So I built Boost on my personal machine on which I have admin privileges. Then I transfered the build output to AppData on machine on which I don't have admin privs. Everything works beautiful now. </p>\n"}], "owner": {"reputation": 3990, "user_id": 270589, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/11cd12c93e05654e0857df948183514e?s=128&d=identicon&r=PG", "display_name": "Behrooz Karjoo", "link": "https://stackoverflow.com/users/270589/behrooz-karjoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484859865, "creation_date": 1484777295, "question_id": 41730327, "link": "https://stackoverflow.com/questions/41730327/boost-library-error", "title": "Boost library error", "body": "<p>Trying to install boost libraries ...</p>\n\n<p>Error : The system cannot find the path specified. Access is denied. </p>\n\n<p>I have installed MinGw and in User/AppData folder and added to path as I don't have admin privileges on this machine. Both work. My guess is either bootstrap.bat can't find gcc or it's trying to write to a place like c:\\boost\\ where it doesn't have permission to do so. </p>\n\n<p>I have also extracted boost in AppData folder for same permission rules. </p>\n\n<p>I tried </p>\n\n<pre><code>&gt;bootstrap.bat prefix=[Appdata full path]\n</code></pre>\n\n<p>still getting same error. Any suggestions? </p>\n"}, {"tags": ["c++", "stl"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1484776965, "post_id": 41730222, "comment_id": 70655006, "body": "Why do you think case A is different from case C. A is effectively <code>std::string(&quot;1&quot;)</code> and C is <code>std::string(&quot;&quot;)</code>"}, {"owner": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1484776982, "post_id": 41730222, "comment_id": 70655015, "body": "@KerrekSB Nothing"}, {"owner": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1484777355, "post_id": 41730222, "comment_id": 70655155, "body": "@EdHeal I believe for case C to be equivalent to <code>std::string(&quot;1&quot;)</code> copy elision has to happen or is there no difference from directly constructing into the return value? Or are the multiple return paths messing with copy elision? Anyway, that&#39;s what I&#39;m asking so don&#39;t ask me"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1484777363, "post_id": 41730222, "comment_id": 70655161, "body": "A smart compiler will construct all of these directly in the object being assigned to by the caller of the function."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1484777632, "post_id": 41730222, "comment_id": 70655259, "body": "@LorahAttkins Instead of guessing what may happen, <a href=\"https://godbolt.org/g/vASovb\" rel=\"nofollow noreferrer\">look at the generated assembly code when optimizations are used</a>"}, {"owner": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1484777677, "post_id": 41730222, "comment_id": 70655277, "body": "@PaulMcKenzie I can&#39;t read assembly , could you please explain me?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1484777728, "post_id": 41730222, "comment_id": 70655303, "body": "@LorahAttkins Do you see <code>std::string</code>&#39;s being constructed in that assembly listing?  Remove the <code>-O2</code> optimization and see what the unoptimized version looks like.  Also, the answer to the &quot;will the compiler do this?&quot; type questions can always be answered by looking at what the compiler is doing, and you do that by looking at the assembly language generated (which in this context is not hard to understand)."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1484777797, "post_id": 41730222, "comment_id": 70655335, "body": "I have reopened the question, as I do not believe it is the exact duplicate."}, {"owner": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1484778085, "post_id": 41730222, "comment_id": 70655450, "body": "@SergeyA Agreed, if that were the case then every question on the description of a feature would mark as duplicates all questions on use cases of those features. I was just trying to find the related discussion on meta; furthermore there wouldn&#39;t even be a <code>copy elision</code> / <code>rvo</code> tag since there&#39;s an answer saying what they are"}, {"owner": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1484778619, "post_id": 41730222, "comment_id": 70655674, "body": "@PaulMcKenzie I wanted to know what the Standard says. I wish I could read assembly and do what you suggest more often, but to my understanding, there&#39;s the implementation and then there&#39;s the canonical reference. And it&#39;s amazing to see that <b>tracking the Standard even in this small case is no easy task</b> (at least that&#39;s what it looks like based on the comments and the answers so far)"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1484778807, "post_id": 41730222, "comment_id": 70655748, "body": "@LorahAttkins, in this case standard is rather simple, actually. However, standard says nothing about copy elision in your case, as it doesn&#39;t talk about NRVO. See my answer on the case when standard actually has to say something."}, {"owner": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1484780053, "post_id": 41730222, "comment_id": 70656206, "body": "@PaulMcKenzie I think in the version you linked the compiler saw the no use of <code>nameof</code> and optmized a lot of things away. Even in this <a href=\"https://godbolt.org/g/y992uj\" rel=\"nofollow noreferrer\">case</a> where I make no mention of the function I see very different codegen and actual string constructions"}], "answers": [{"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 3, "last_activity_date": 1484778061, "creation_date": 1484778061, "answer_id": 41730497, "question_id": 41730222, "link": "https://stackoverflow.com/questions/41730222/whats-happening-in-this-return-statement/41730497#41730497", "title": "What&#39;s happening in this return statement?", "body": "<p>To make it NRVO-friendly, you should always return the same object. The value of the object might be different, but the object should be the same.</p>\n\n<p>However, following above rule makes program harder to read, and often one should opt for readability over unnoticeable performance improvement. Since <code>std::string</code> has a move constructor defined, the difference between moving a pointer and a length and not doing so would be so tiny that I see no way of actually noticing this in the application.</p>\n\n<p>As for your last question, <code>return std::string()</code> and <code>return {}</code> would be exactly the same.</p>\n\n<p>There are also some incorrect statements in your question. For example, <code>\"1\"</code> is not a temporary. It's a string literal. Temporary is created from this literal.</p>\n\n<p>Last, but not least, mandatory C++17 copy elision does not apply here. It is reserved for cases like</p>\n\n<pre><code>std::string x = \"X\";\n</code></pre>\n\n<p>which before the mandatory requirement could generate code to create a temporary <code>std::string</code> and initialize <code>x</code> with copy (or move) constructor.</p>\n"}, {"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 1, "last_activity_date": 1484778142, "creation_date": 1484778142, "answer_id": 41730520, "question_id": 41730222, "link": "https://stackoverflow.com/questions/41730222/whats-happening-in-this-return-statement/41730520#41730520", "title": "What&#39;s happening in this return statement?", "body": "<p>In all cases, the copy might or might not be elided. Consider:</p>\n\n<pre><code>std::string j = nameof(whatever);\n</code></pre>\n\n<p>This could be implemented one of two ways:</p>\n\n<ol>\n<li><p>Only one <code>std::string</code> object is ever constructed, <code>j</code>. (The copy is elided.)</p></li>\n<li><p>A temporary <code>std::string</code> object is constructed, its value is copied to <code>j</code>, then the temporary is destroyed. (The function returns a temporary that is copied.)</p></li>\n</ol>\n"}], "owner": {"reputation": 3684, "user_id": 4224575, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Nvq43.gif?s=128&g=1", "display_name": "Lorah Attkins", "link": "https://stackoverflow.com/users/4224575/lorah-attkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 3, "answer_count": 2, "score": 6, "last_activity_date": 1484778603, "creation_date": 1484776767, "last_edit_date": 1484778603, "question_id": 41730222, "link": "https://stackoverflow.com/questions/41730222/whats-happening-in-this-return-statement", "title": "What&#39;s happening in this return statement?", "body": "<p>I'm reading on copy elision (and how it's supposed to be guaranteed in C++17) and this got me a bit confused (I'm not sure I know things I thought I knew before). So here's a minimal test case: </p>\n\n<pre><code>std::string nameof(int param)\n{\n    switch (param)\n    {\n    case 1: \n        return \"1\"; // A\n    case 2: \n        return \"2\" // B\n    }\n    return std::string(); // C\n}\n</code></pre>\n\n<p>The way I see it, cases A and B perform a direct construction on the return value so copy elision has no meaning here, while case C cannot perform copy elision because there are multiple return paths. <strong>Are these assumptions correct</strong>? </p>\n\n<p>Also, I'd like to know if </p>\n\n<ul>\n<li>there's a better way of writing the above (e.g. have a <code>std::string retval;</code> and always return that one or write cases <code>A</code> and <code>B</code> as <code>return string(\"1\")</code> etc)</li>\n<li>there's any move happening, for example <code>\"1\"</code> is a temporary but I'm assuming it's being used as a parameter for the constructor of <code>std::string</code></li>\n<li>there are optimization concerns I ommited (e.g. I believe C could be written as <code>return{}</code>, would that be a better choice?)</li>\n</ul>\n"}, {"tags": ["c++", "multithreading", "c++11", "condition-variable"], "comments": [{"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 4, "creation_date": 1484788041, "post_id": 41730012, "comment_id": 70658518, "body": "But the move constructor/assignment operator in those answers doesn&#39;t move the mutex. It simply uses the mutex to lock access to the object, just like any other member function of <code>A</code>. And thus, it&#39;s based on the assumption of what that mutex is <i>for</i>. &quot;Moving&quot; the object does not move the locks of people who&#39;ve locked the object presently. As such, what behavior do you want with a <code>condition_variable</code>?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1484839321, "post_id": 41730012, "comment_id": 70683619, "body": "There are no clear and obvious semantics for what essential identity types (types for whom their identity is essential to their state) like mutex and condition variable should have when part of a composite object, especially when mixed with non-identity-essential data.  You cannot in general move or copy their identity (if they are value types).  Types like <code>std::future</code> <i>own</i> an identity, but they are not the identity themselves; they can be moved by moving the identity.  In short, it depends what you want it to mean to be copied or moved, as Nicol states."}, {"owner": {"reputation": 3504, "user_id": 224982, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e7b4b96492f8648f4e9372a9f3db752f?s=128&d=identicon&r=PG", "display_name": "ilya1725", "link": "https://stackoverflow.com/users/224982/ilya1725"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 1, "creation_date": 1484860696, "post_id": 41730012, "comment_id": 70696245, "body": "@NicolBolas Yes, as example shows, there is some proper algorithm how to write a move constructor/assignment operator for a class that has a <code>mutex</code>. I&#39;m looking for a similar algorithm for a <code>condition_variable</code>. And maybe it is very simple. But an explanation will be useful."}], "owner": {"reputation": 3504, "user_id": 224982, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e7b4b96492f8648f4e9372a9f3db752f?s=128&d=identicon&r=PG", "display_name": "ilya1725", "link": "https://stackoverflow.com/users/224982/ilya1725"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 457, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1484788385, "creation_date": 1484775865, "last_edit_date": 1495539946, "question_id": 41730012, "link": "https://stackoverflow.com/questions/41730012/how-to-deal-with-conditional-variables-in-movable-types", "title": "How to deal with conditional variables in movable types", "body": "<p>There is a <a href=\"https://stackoverflow.com/questions/29986208/how-should-i-deal-with-mutexes-in-movable-types-in-c\">great answer</a> how to write move constructors for classes that contain <a href=\"http://en.cppreference.com/w/cpp/thread/mutex\" rel=\"nofollow noreferrer\">std::mutex</a>. But I wonder what the process is in implementing move constructors for objects containing <a href=\"http://en.cppreference.com/w/cpp/thread/condition_variable\" rel=\"nofollow noreferrer\">condition_variable</a>.</p>\n"}, {"tags": ["c++", "c++11", "segmentation-fault"], "comments": [{"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 3, "creation_date": 1484775225, "post_id": 41729828, "comment_id": 70654133, "body": "so, using a debugger, where <i>exactly</i> does the segfault happen?"}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 2, "creation_date": 1484775401, "post_id": 41729828, "comment_id": 70654229, "body": "The size of a non-dynamic array must have a constant size known at compile-time. Something like <code>int size; int array[size];</code> is illegal C++. Plus you get the segfault because <code>size</code> is not initialized."}, {"owner": {"reputation": 3771, "user_id": 5386374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Justin Time - Reinstate Monica", "link": "https://stackoverflow.com/users/5386374/justin-time-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484855155, "post_id": 41729828, "comment_id": 70693120, "body": "Note that even with a compiler that allows this (such as GCC or Clang), you&#39;re using a non-standard extension; while variable-length arrays are a (currently optional, I believe) part of the C standard, they aren&#39;t in the C++ standard at all."}, {"owner": {"reputation": 703, "user_id": 2794395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Pbxie.jpg?s=128&g=1", "display_name": "fiorentinoing", "link": "https://stackoverflow.com/users/2794395/fiorentinoing"}, "edited": false, "score": 0, "creation_date": 1526479862, "post_id": 41729828, "comment_id": 87762392, "body": "<a href=\"https://stackoverflow.com/a/77336/2794395\">this</a> may help you on findout who fires the exception."}], "answers": [{"tags": [], "owner": {"reputation": 13883, "user_id": 6815131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c38385f9eb57b70176498fa5c3b4c99?s=128&d=identicon&r=PG&f=1", "display_name": "Joe C", "link": "https://stackoverflow.com/users/6815131/joe-c"}, "is_accepted": false, "score": 10, "last_activity_date": 1484778604, "creation_date": 1484778604, "answer_id": 41730622, "question_id": 41729828, "link": "https://stackoverflow.com/questions/41729828/segmentation-fault-error-11-c/41730622#41730622", "title": "Segmentation fault error 11 C++", "body": "<p>Because you are not initialising <code>size</code>, the value in that variable could literally be anything.  If it happens to be excessively large, say 106,840,406, then you won't be able to get an <code>int[]</code> of that size.</p>\n\n<p>So basically, initialise your <code>size</code> variable to something sensible.</p>\n"}, {"tags": [], "owner": {"reputation": 2645, "user_id": 7310344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jNHYg.png?s=128&g=1", "display_name": "BusyProgrammer", "link": "https://stackoverflow.com/users/7310344/busyprogrammer"}, "is_accepted": false, "score": 2, "last_activity_date": 1484853189, "creation_date": 1484853189, "answer_id": 41749848, "question_id": 41729828, "link": "https://stackoverflow.com/questions/41729828/segmentation-fault-error-11-c/41749848#41749848", "title": "Segmentation fault error 11 C++", "body": "<p>An array in c++ has to be initialized at the with a fixed size. In your case, size is not initialized to any fixed integer value, which is illegal in c++ and will cause the compiler to produce an error message.</p>\n\n<p>If you try the following line just before you initialize the array of size <em>size</em>, you can tell what the size originally is:</p>\n\n<pre><code>    cout &lt;&lt; size &lt;&lt; endl;\n</code></pre>\n\n<p>I compiled your code with this line and got this int size before the compiler failed: </p>\n\n<blockquote>\n  <p>1995231824 (This differs for every compiler and computer, but every number will be as big and useless as this one)</p>\n</blockquote>\n\n<p>Trying to have such a big array will naturally lead to a segmentation fault. That's why you would have to initialize the variable <strong>size</strong> to a fixed number. This will eliminate the segmentation fault.</p>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 9011227, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mviuWQpo6Jw/AAAAAAAAAAI/AAAAAAAAAHo/1G2TcFfXdf8/photo.jpg?sz=128", "display_name": "Mikeh Miiikeh", "link": "https://stackoverflow.com/users/9011227/mikeh-miiikeh"}, "is_accepted": false, "score": 2, "last_activity_date": 1546182386, "creation_date": 1546182386, "answer_id": 53978712, "question_id": 41729828, "link": "https://stackoverflow.com/questions/41729828/segmentation-fault-error-11-c/53978712#53978712", "title": "Segmentation fault error 11 C++", "body": "<p>Segmentation Fault 11 equals to say \"Index out of range\"... </p>\n\n<pre><code>               Index\n\n         0, 1, 2, 3, 4 ,5\n</code></pre>\n\n<p>Value        5, 6 ,1 ,9 ,8 ,7</p>\n\n<p>Array length is 6, but its last index is 5.. for example, if we control a for cycle with 6 then we got Segmentation Fault 11... </p>\n"}], "owner": {"reputation": 81, "user_id": 6944639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b852b0de7af325bace4a27e38a027fd4?s=128&d=identicon&r=PG&f=1", "display_name": "PrivatePatron", "link": "https://stackoverflow.com/users/6944639/privatepatron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18457, "favorite_count": 1, "answer_count": 3, "score": 6, "last_activity_date": 1546182386, "creation_date": 1484775107, "last_edit_date": 1484793235, "question_id": 41729828, "link": "https://stackoverflow.com/questions/41729828/segmentation-fault-error-11-c", "title": "Segmentation fault error 11 C++", "body": "<p>So I'm getting  a segmentation fault error in the beginning of the code. I've tried running some tests at the different points and the error seems to be when i allocate memory for the array. Ive just started learning about heap and stack memory so I'm not really sure if I'm doing something wrong there. Any help would be appreciated.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\n//Function Prototypes\nvoid sort(int A[], int n);\nint findMin(int A[], int n, int j);\nint swap(int&amp; a, int&amp; b);\ndouble median(int A[], int n);\nvoid output1(int median);\nvoid output2(double median);\n\nint main()\n{\n  int size;\n  int array[size]; //Segmentaion fault here\n  int i = 0;\n\n  cout &lt;&lt; \"Enter the size of the list (&lt; 1 to quit): \";\n  cin &gt;&gt; size;\n\n  while(size &gt;= 1)\n    {\n      double element;\n\n      cout &lt;&lt; \"Enter element \" &lt;&lt; i+1 &lt;&lt; \": \";\n      cin &gt;&gt; element;\n\n      array[i] = element;\n\n      i++;\n\n      while(i &lt; size)\n    {\n      cout &lt;&lt; \"Enter element \" &lt;&lt; i+1 &lt;&lt; \": \";\n      cin &gt;&gt; element;\n\n      array[i] = element;\n      i++;\n    }\n\n      sort(array, size);\n      median(array, size);\n\n       cout &lt;&lt; \"Enter the size of the list (&lt; 1 to quit): \";\n       cin &gt;&gt; size;\n    } \n  delete [] array;\n  return 0;\n\n}\n\n\nvoid sort(int A[], int n)\n{\n  int min;\n  for(int i = 0; i &lt; n; i++)\n    {\n      min = findMin(A,n,i);\n      //min = findMinIndex(p, size, i);\n\n      //if(min )\n        swap(A[i],A[min]);\n      //swap(p[i],p[min]);\n    }\n}\n\nint findMin(int A[], int n, int j)\n{\n  int minIndex = j;\n  for(int i = j+1; i &lt; n; i++)\n    if(A[i]&lt;A[minIndex])\n      minIndex = i;\n  return minIndex; \n}\n\nint swap(int&amp; a, int&amp; b)\n{\n  int temp;\n  temp = a;\n  a = b;\n  b = temp;\n}\n\nvoid output1(int median)\n{\n  cout &lt;&lt; \"The median is \" &lt;&lt; median &lt;&lt; \".\" &lt;&lt; endl;\n}\n\nvoid output2(double median)\n{\n  cout &lt;&lt; \"The median is \" &lt;&lt; median &lt;&lt; \".\" &lt;&lt; endl;\n}\n\n\ndouble median(int A[], int n)\n{\n\n\n  if(n % 2 == 0)\n    {\n      int div1 = n / 2;\n      int num1 = A[div1];\n      int num2 = A[div1 -1];\n      double median = (num1 + num2) / 2;\n      output2(median);\n    }\n  else\n    {\n      int div2 = n - 1;\n      int median = div2 / 2;\n      output1(median);\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "loops", "for-loop"], "comments": [{"owner": {"reputation": 1355, "user_id": 2099774, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b1616496d50ecbb4ddb4f6a431a2307?s=128&d=identicon&r=PG", "display_name": "BackDoorNoBaby", "link": "https://stackoverflow.com/users/2099774/backdoornobaby"}, "edited": false, "score": 3, "creation_date": 1484775352, "post_id": 41729785, "comment_id": 70654202, "body": "OP your code is copied almost word for word from <a href=\"https://msdn.microsoft.com/en-us/library/hh147277(v=vs.88).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/hh147277(v=vs.88).aspx</a>"}, {"owner": {"reputation": 1025, "user_id": 1539100, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9fd1a7d5e9b7b16c0f70cfdd049f7233?s=128&d=identicon&r=PG", "display_name": "sorosh_sabz", "link": "https://stackoverflow.com/users/1539100/sorosh-sabz"}, "reply_to_user": {"reputation": 1355, "user_id": 2099774, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b1616496d50ecbb4ddb4f6a431a2307?s=128&d=identicon&r=PG", "display_name": "BackDoorNoBaby", "link": "https://stackoverflow.com/users/2099774/backdoornobaby"}, "edited": false, "score": 0, "creation_date": 1484775430, "post_id": 41729785, "comment_id": 70654245, "body": "@BackDoorNoBaby how to found it?"}, {"owner": {"reputation": 1355, "user_id": 2099774, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b1616496d50ecbb4ddb4f6a431a2307?s=128&d=identicon&r=PG", "display_name": "BackDoorNoBaby", "link": "https://stackoverflow.com/users/2099774/backdoornobaby"}, "reply_to_user": {"reputation": 1025, "user_id": 1539100, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9fd1a7d5e9b7b16c0f70cfdd049f7233?s=128&d=identicon&r=PG", "display_name": "sorosh_sabz", "link": "https://stackoverflow.com/users/1539100/sorosh-sabz"}, "edited": false, "score": 0, "creation_date": 1484775475, "post_id": 41729785, "comment_id": 70654271, "body": "@sorosh_sabz I&#39;m not sure what you&#39;re asking.. I apologize"}, {"owner": {"reputation": 1025, "user_id": 1539100, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9fd1a7d5e9b7b16c0f70cfdd049f7233?s=128&d=identicon&r=PG", "display_name": "sorosh_sabz", "link": "https://stackoverflow.com/users/1539100/sorosh-sabz"}, "reply_to_user": {"reputation": 1355, "user_id": 2099774, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b1616496d50ecbb4ddb4f6a431a2307?s=128&d=identicon&r=PG", "display_name": "BackDoorNoBaby", "link": "https://stackoverflow.com/users/2099774/backdoornobaby"}, "edited": false, "score": 0, "creation_date": 1484775598, "post_id": 41729785, "comment_id": 70654338, "body": "@BackDoorNoBaby I apologize to asking inaudible questions. It was interesting to me how you find the code come from? :)"}, {"owner": {"reputation": 1355, "user_id": 2099774, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b1616496d50ecbb4ddb4f6a431a2307?s=128&d=identicon&r=PG", "display_name": "BackDoorNoBaby", "link": "https://stackoverflow.com/users/2099774/backdoornobaby"}, "reply_to_user": {"reputation": 1025, "user_id": 1539100, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9fd1a7d5e9b7b16c0f70cfdd049f7233?s=128&d=identicon&r=PG", "display_name": "sorosh_sabz", "link": "https://stackoverflow.com/users/1539100/sorosh-sabz"}, "edited": false, "score": 1, "creation_date": 1484775801, "post_id": 41729785, "comment_id": 70654440, "body": "@sorosh_sabz ohhh okay, I just copied out a portion of the code and googled it, its taken directly from an MSDN example in that link (Ex3_10.cpp) to be exact, same variables, spacing, etc. Just removed the comments, basically"}, {"owner": {"reputation": 1025, "user_id": 1539100, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9fd1a7d5e9b7b16c0f70cfdd049f7233?s=128&d=identicon&r=PG", "display_name": "sorosh_sabz", "link": "https://stackoverflow.com/users/1539100/sorosh-sabz"}, "reply_to_user": {"reputation": 1355, "user_id": 2099774, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b1616496d50ecbb4ddb4f6a431a2307?s=128&d=identicon&r=PG", "display_name": "BackDoorNoBaby", "link": "https://stackoverflow.com/users/2099774/backdoornobaby"}, "edited": false, "score": 0, "creation_date": 1484775846, "post_id": 41729785, "comment_id": 70654459, "body": "@BackDoorNoBaby :D thanks"}, {"owner": {"reputation": 1355, "user_id": 2099774, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b1616496d50ecbb4ddb4f6a431a2307?s=128&d=identicon&r=PG", "display_name": "BackDoorNoBaby", "link": "https://stackoverflow.com/users/2099774/backdoornobaby"}, "edited": false, "score": 3, "creation_date": 1484776075, "post_id": 41729785, "comment_id": 70654581, "body": "@ConfusedCollegeStudent I would certainly suggest re-evaluating what you&#39;ve presented here. If I can figure out its copied code in 2 minutes on google, I&#39;m sure your professor would be able to do the same.."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7437927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce04d59e9f75558791b49bba00886eae?s=128&d=identicon&r=PG&f=1", "display_name": "ConfusedCollegeStudent", "link": "https://stackoverflow.com/users/7437927/confusedcollegestudent"}, "edited": false, "score": 0, "creation_date": 1484822126, "post_id": 41729879, "comment_id": 70672137, "body": "Thank you all for the answers. You&#39;re not going to believe me, but I didn&#39;t mean to cheat. Is it cheating, for example, if I take half of someone&#39;s code and change it, or just twenty five percent? Ten percent? Thank you, especially, ssell, for your answer, because I think you explained it the best."}, {"owner": {"reputation": 1, "user_id": 7437927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce04d59e9f75558791b49bba00886eae?s=128&d=identicon&r=PG&f=1", "display_name": "ConfusedCollegeStudent", "link": "https://stackoverflow.com/users/7437927/confusedcollegestudent"}, "edited": false, "score": 0, "creation_date": 1484822245, "post_id": 41729879, "comment_id": 70672219, "body": "Anyway, I will try my best to rewrite it using a different version, and not one on here, either. I have read my textbook, but it&#39;s just hard to understand at this point. I think I might have to go over everything again, even though I&#39;ve already read it. Anyway, thanks for the help! Like I said, I wasn&#39;t trying to cheat (not that you&#39;ll believe me) but thanks for answering my question anyway. I think it would be best for me to go over data types and the loop chapter again. Thanks again!"}, {"owner": {"reputation": 1025, "user_id": 1539100, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9fd1a7d5e9b7b16c0f70cfdd049f7233?s=128&d=identicon&r=PG", "display_name": "sorosh_sabz", "link": "https://stackoverflow.com/users/1539100/sorosh-sabz"}, "reply_to_user": {"reputation": 1, "user_id": 7437927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce04d59e9f75558791b49bba00886eae?s=128&d=identicon&r=PG&f=1", "display_name": "ConfusedCollegeStudent", "link": "https://stackoverflow.com/users/7437927/confusedcollegestudent"}, "edited": false, "score": 0, "creation_date": 1484859380, "post_id": 41729879, "comment_id": 70695500, "body": "@ConfusedCollegeStudent that&#39;s ok, best regards you :)"}], "tags": [], "owner": {"reputation": 1025, "user_id": 1539100, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9fd1a7d5e9b7b16c0f70cfdd049f7233?s=128&d=identicon&r=PG", "display_name": "sorosh_sabz", "link": "https://stackoverflow.com/users/1539100/sorosh-sabz"}, "is_accepted": false, "score": 0, "last_activity_date": 1484776041, "last_edit_date": 1484776041, "creation_date": 1484775285, "answer_id": 41729879, "question_id": 41729785, "link": "https://stackoverflow.com/questions/41729785/issue-with-a-for-loop-c-visual-studio/41729879#41729879", "title": "Issue with a for loop (C++, Visual Studio", "body": "<p>ITNOA</p>\n\n<p>You can just change </p>\n\n<pre><code>cout &lt;&lt; endl\n        &lt;&lt; \"Do you want to enter another value (enter y or n)? \";\ncin &gt;&gt; indicator;\nif (('n' == indicator) || ('N' == indicator))\n    break;\n</code></pre>\n\n<p>with</p>\n\n<pre><code>cout &lt;&lt; endl\n        &lt;&lt; \"Do you want to enter another value (enter 0 for exit or not zero to continue)? \";\nint indicator = -1;\ncin &gt;&gt; indicator;\nif (indicator == 0)\n     break;\n</code></pre>\n\n<p>If you do not want to ask user to continue enter new value in every time @Govind Parmar and @Vlad from Moscow write cleaner code than you write.</p>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1484775690, "creation_date": 1484775690, "answer_id": 41729979, "question_id": 41729785, "link": "https://stackoverflow.com/questions/41729785/issue-with-a-for-loop-c-visual-studio/41729979#41729979", "title": "Issue with a for loop (C++, Visual Studio", "body": "<p>Just compare <code>value</code> to zero after it is inputted:</p>\n\n<pre><code>for (;;)\n{\n\n    cout &lt;&lt; endl\n        &lt;&lt; \"Enter a value here; enter 0 to stop: \";\n        cin &gt;&gt; value;\n   if(value==0.0) break;\n   sum += value;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1484776653, "last_edit_date": 1484776653, "creation_date": 1484775849, "answer_id": 41730009, "question_id": 41729785, "link": "https://stackoverflow.com/questions/41729785/issue-with-a-for-loop-c-visual-studio/41730009#41730009", "title": "Issue with a for loop (C++, Visual Studio", "body": "<p>There is no sense to ask the user each time whether he wants to continue.</p>\n\n<p>So I would write the loop the following way</p>\n\n<pre><code>cout &lt;&lt; \"Enter a sequence of real numbers (0 - exit): \"; \nfor (;;)\n{\n    if ( !( cin &gt;&gt; value ) || ( value == 0.0 ) ) break;\n    sum += value;\n}\n</code></pre>\n\n<p>Also as the variable <code>value</code> is used only in the body of the loop it should be declared there. So the loop can look like</p>\n\n<pre><code>cout &lt;&lt; \"Enter a sequence of real numbers (0 - exit): \"; \nfor (;;)\n{\n    double value;\n\n    if ( !( cin &gt;&gt; value ) || ( value == 0.0 ) ) break;\n\n    sum += value;\n}\n</code></pre>\n\n<p>An alternative for this for loop is while loop of the following form</p>\n\n<pre><code>cout &lt;&lt; \"Enter a sequence of real numbers (0 - exit): \"; \nwhile ( true )\n{\n    double value;\n\n    if ( !( cin &gt;&gt; value ) || ( value == 0.0 ) ) break;\n\n    sum += value;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5812, "user_id": 735425, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x7BUU.png?s=128&g=1", "display_name": "ssell", "link": "https://stackoverflow.com/users/735425/ssell"}, "is_accepted": false, "score": 1, "last_activity_date": 1484776306, "last_edit_date": 1495540392, "creation_date": 1484776306, "answer_id": 41730110, "question_id": 41729785, "link": "https://stackoverflow.com/questions/41729785/issue-with-a-for-loop-c-visual-studio/41730110#41730110", "title": "Issue with a for loop (C++, Visual Studio", "body": "<p>I would like to make a few suggestions to you which you may find helpful.</p>\n\n<p>To begin, any of the loops you mentioned (<code>for</code>, <code>while</code>, <code>do while</code>) may be used in solving this problem. But I believe that the <code>do while</code> lends itself best to this particular problem.</p>\n\n<p>The use of a <code>for</code> is especially bad for this exercise as <code>for</code> loops are typically employed while performing iterations over a set of values or some sort of finite counting. Being asked to perform an action an indefinite number of times is better suited for a <code>while</code> or <code>do while</code>.</p>\n\n<p>Just look at your <code>for</code> declaration:</p>\n\n<pre><code>for(;;)\n{\n    // ...\n}\n</code></pre>\n\n<p>What benefit does using <code>for</code> have in this situation if you make use of none of it's functionality.</p>\n\n<p>Second, the use of <code>double</code> is for your <code>value</code> and <code>sum</code> is not recommended either. This is because of something called floating-point precision. You can not reliably compare a <code>double</code> value using <code>==</code>. See: <a href=\"https://stackoverflow.com/questions/17333/what-is-the-most-effective-way-for-float-and-double-comparison\">What is the most effective way for float and double comparison?</a></p>\n\n<p>Instead, unless specified by the problem statement, I would opt to use an integer value type. Either <code>int</code> or <code>unsigned int</code>. </p>\n\n<p>Third, you are not correctly initializing your variables. Instead, it should be done as:</p>\n\n<pre><code>int value = 0;\nint sum = 0;\n</code></pre>\n\n<p>Improper variable initialization can lead to countless bugs and is a very common source of problems.</p>\n\n<p>Finally, I would recommend against the use of <code>using namespace</code>. This is used commonly by beginner developers who then are taught better practices and then have to unlearn the behavior. See: <a href=\"https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-bad-practice\">Why is &quot;using namespace std&quot; considered bad practice?</a></p>\n\n<p>Taking this advice into consideration would lead to a solution such as:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main(int argc, char** argv)\n{\n    int sum   = 0;\n    int value = 0;\n\n    do\n    {\n        sum += value;\n        std::cout &lt;&lt; \"Please enter a value: \";\n        std::cin &gt;&gt; value;\n    } while(value != 0);\n\n    std::cout &lt;&lt; \"The sum of all values entered is: \" &lt;&lt; sum;\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7437927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce04d59e9f75558791b49bba00886eae?s=128&d=identicon&r=PG&f=1", "display_name": "ConfusedCollegeStudent", "link": "https://stackoverflow.com/users/7437927/confusedcollegestudent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "closed_date": 1484817010, "answer_count": 4, "score": -5, "last_activity_date": 1484776653, "creation_date": 1484774960, "last_edit_date": 1484776243, "question_id": 41729785, "link": "https://stackoverflow.com/questions/41729785/issue-with-a-for-loop-c-visual-studio", "closed_reason": "Needs details or clarity", "title": "Issue with a for loop (C++, Visual Studio", "body": "<p>I have only really been coding for a few days, though I've reading the textbook for my Intro to C++ class for two weeks. I'm having an issue with an assignment, and I feel like I'm missing something super simple, but I can't understand what I've done wrong.</p>\n\n<p>The exercise calls for you to 'write a program that reads numbers from cin, and then sums them, stopping when 0 has been entered.'</p>\n\n<p>The professor told us we could write it with a for loop, a while loop, or a do-while loop. I am trying to write it with a for loop.</p>\n\n<p>The program compiles successfully, it allows me to enter multiple values, and it sums it correctly. It also stops on no successfully. The only thing that's wrong with it is when I enter 0, it does not stop the program. I have tried using different commands inside the for loop, such as goto, and trying to direct it to go to break; when the value entered is zero, but my knowledge is shoddy, to say the least. I've read the textbook but I don't have enough experience yet, and I don't remember everything, and I can't figure out what I'm doing wrong.</p>\n\n<p>This is what the program looks like:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing std::cin;\nusing std::cout;\nusing std::endl;\n\nint main()\n\n{\n    char indicator{ 'n' };\n    double value{};\n    double sum{};\n\n\n    for (;;)\n    {\n\n        cout &lt;&lt; endl\n            &lt;&lt; \"Enter a value here: \";\n            cin &gt;&gt; value;\n        sum += value;\n        cout &lt;&lt; endl\n            &lt;&lt; \"Do you want to enter another value (enter y or n)? \";\n            cin &gt;&gt; indicator;\n            if (('n' == indicator) || ('N' == indicator))\n                break;\n\n\n    }\n\n    cout &lt;&lt; endl\n        &lt;&lt; \"The sum of the values you entered is \" &lt;&lt; sum &lt;&lt; \".\"\n        &lt;&lt; endl;\n    return 0;\n\n}\n</code></pre>\n\n<p>Please point out my stupid mistake, I'd be grateful to learn. Thank you!</p>\n"}, {"tags": ["c++", "c++11", "sfml"], "comments": [{"owner": {"reputation": 1211, "user_id": 3313819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yKM0Y.png?s=128&g=1", "display_name": "ShadowMitia", "link": "https://stackoverflow.com/users/3313819/shadowmitia"}, "edited": false, "score": 0, "creation_date": 1484775899, "post_id": 41729773, "comment_id": 70654487, "body": "How are you defining your class? Specifically the variables involved and your constructor and your drawsprite method."}, {"owner": {"reputation": 1006, "user_id": 6212957, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/fGa3R.png?s=128&g=1", "display_name": "Feelsbadman", "link": "https://stackoverflow.com/users/6212957/feelsbadman"}, "reply_to_user": {"reputation": 1211, "user_id": 3313819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yKM0Y.png?s=128&g=1", "display_name": "ShadowMitia", "link": "https://stackoverflow.com/users/3313819/shadowmitia"}, "edited": false, "score": 0, "creation_date": 1484776050, "post_id": 41729773, "comment_id": 70654563, "body": "@ShadowMitia there, Updated the question."}], "answers": [{"tags": [], "owner": {"reputation": 1211, "user_id": 3313819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yKM0Y.png?s=128&g=1", "display_name": "ShadowMitia", "link": "https://stackoverflow.com/users/3313819/shadowmitia"}, "is_accepted": true, "score": 1, "last_activity_date": 1484776747, "creation_date": 1484776747, "answer_id": 41730217, "question_id": 41729773, "link": "https://stackoverflow.com/questions/41729773/sfml-place-sprite-on-center/41730217#41730217", "title": "SFML Place Sprite on center", "body": "<p>You are not initialising your attributes in your constructor correctly.</p>\n\n<pre><code>Spaceship::Spaceship(sf::RenderWindow&amp; game_window){\n    auto surface = sf::VideoMode::getDesktopMode();\n    signed int ss_x = surface.width/2;\n    signed int ss_y = surface.height/2;\n\n    int ss_width = 128;\n    int ss_height = 128;\n    int ss_radius = ss_width/2;\n}\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>Spaceship::Spaceship(sf::RenderWindow&amp; game_window){\n    auto surface = sf::VideoMode::getDesktopMode();\n    ss_x = surface.width/2;\n    ss_y = surface.height/2;\n\n    ss_width = 128;\n    ss_height = 128;\n    ss_radius = ss_width/2;\n}\n</code></pre>\n\n<p>Declaring variables in the body of the class means they are seen globally by the class, if you redeclare a variable in the constructor, it will take over the role from the global variable. This is called <em>variable shadowing</em>. All modifications to the variable will work, but once you leave the scope of your constructor/function/method, then you lose the information since your attribute variable wasn't modified.</p>\n\n<p>More on scopes: <a href=\"http://en.cppreference.com/w/cpp/language/scope\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/language/scope</a></p>\n\n<p>More on variable shadowing: <a href=\"https://en.wikipedia.org/wiki/Variable_shadowing?oldformat=true\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Variable_shadowing?oldformat=true</a></p>\n"}], "owner": {"reputation": 1006, "user_id": 6212957, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/fGa3R.png?s=128&g=1", "display_name": "Feelsbadman", "link": "https://stackoverflow.com/users/6212957/feelsbadman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 898, "favorite_count": 0, "accepted_answer_id": 41730217, "answer_count": 1, "score": 0, "last_activity_date": 1484777103, "creation_date": 1484774906, "last_edit_date": 1592644375, "question_id": 41729773, "link": "https://stackoverflow.com/questions/41729773/sfml-place-sprite-on-center", "title": "SFML Place Sprite on center", "body": "<p>I have been trying to fix this problem for about an hour or more... But couldn't find any usefull answers.\nI am trying to place a sprite on the center of the window, but it shows up on TOP_LEFT. Here is the constructor for my class and as you can see I am dividing surface.width and surface.height by 2</p>\n<pre><code>Spaceship::Spaceship(sf::RenderWindow&amp; game_window){\n    auto surface = game_window.getSize();\n    signed int ss_x = surface.x/2;\n    signed int ss_y = surface.y/2;\n    \n    int ss_width = 128;\n    int ss_height = 128;\n    int ss_radius = ss_width/2;\n}\n  ///////////////////////////////////////////\n // For displaying the sprite on window   //\n///////////////////////////////////////////\nvoid Spaceship::drawsprite(sf::RenderWindow&amp; game_window){\n    sf::Texture ship;\n    if (!ship.loadFromFile(resourcePath() + &quot;space-shuttle-64.png&quot;)) {\n        return EXIT_FAILURE;\n    }\n    sf::Sprite ss_sprite(ship);\n    ss_sprite.setPosition(ss_x, ss_y);\n    game_window.draw(ss_sprite);\n}\n</code></pre>\n<p>I have also tried with:</p>\n<pre><code>   auto surface = game_window.RenderWindow::getSize();\n    signed int ss_x = surface.x/2;\n    signed int ss_y = surface.y/2;\n</code></pre>\n<p>but that didn't help either.</p>\n<h1>UPDATE:</h1>\n<p>I have tried to print the variables which are defined inside the constructor and I got 0 on all of them. So my problems seems to be the accessing problem. but there were no errors or warnings that have told me that.</p>\n<h1>UPDATE 2:</h1>\n<p>this is the header file:</p>\n<pre><code>#ifndef Spaceship_hpp\n#define Spaceship_hpp\n#include &lt;iostream&gt;\n#include &lt;SFML/Audio.hpp&gt;\n#include &lt;SFML/Graphics.hpp&gt;\n#include &lt;stdio.h&gt;\n\nusing namespace std;\n\nclass Spaceship {\npublic:\n    Spaceship();\n    Spaceship(sf::RenderWindow&amp;);\n    ~Spaceship();\n     void moveship(char);\n     void drawsprite(sf::RenderWindow&amp;);\n    \nprivate:\n    signed int ss_x, ss_y;\n    unsigned int ss_speed;\n    int ss_width, ss_height, ss_radius;\n    \n};\n\n#endif /* Spaceship_hpp */\n</code></pre>\n"}, {"tags": ["c++", "function", "root-framework"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 3, "creation_date": 1484778784, "post_id": 41729721, "comment_id": 70655733, "body": "This may be a hint: <code>Limitation: Function can not be defined in a command line or a tempfile You need to write it in a source file (tmpfile)(1)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4305, "user_id": 2640636, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/NWXEh.jpg?s=128&g=1", "display_name": "SU3", "link": "https://stackoverflow.com/users/2640636/su3"}, "is_accepted": false, "score": 0, "last_activity_date": 1486166363, "creation_date": 1486166363, "answer_id": 42034910, "question_id": 41729721, "link": "https://stackoverflow.com/questions/41729721/cern-root-5-34-error-message-using-functions/42034910#42034910", "title": "Cern ROOT 5.34 error message using functions", "body": "<p>If you used root 6, which supports all C++11 features, you could define a <a href=\"http://en.cppreference.com/w/cpp/language/lambda\" rel=\"nofollow noreferrer\">lambda</a> function instead, like so</p>\n\n<pre><code>auto hello = [](){ cout &lt;&lt; \"Hi!\" &lt;&lt; endl; };\n</code></pre>\n\n<p>You can then call it just like a regular function</p>\n\n<pre><code>hello();\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 7437934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DCkjx.png?s=128&g=1", "display_name": "S&#248;r&#235;n", "link": "https://stackoverflow.com/users/7437934/s%c3%b8r%c3%abn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 429, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1486166363, "creation_date": 1484774719, "last_edit_date": 1484813035, "question_id": 41729721, "link": "https://stackoverflow.com/questions/41729721/cern-root-5-34-error-message-using-functions", "title": "Cern ROOT 5.34 error message using functions", "body": "<p>I'm using the Cern ROOT version 5.34 and I have a problem using functions. The same message error always appear.</p>\n\n<p>For example (using a very simple function):</p>\n\n<pre><code> *******************************************\n  *                                         *\n  *        W E L C O M E  to  R O O T       *\n  *                                         *\n  *   Version   5.34/36      5 April 2016   *\n  *                                         *\n  *  You are welcome to visit our Web site  *\n  *          http://root.cern.ch            *\n  *                                         *\n  *******************************************\n\nROOT 5.34/36 (v5-34-36@v5-34-36, Apr 05 2016, 10:25:45 on win32)\n\nCINT/ROOT C/C++ Interpreter version 5.18.00, July 2, 2010\nType ? for help. Commands must be C++ statements.\nEnclose multiple statements between { }.\nroot [0] #include &lt;iostream&gt;\nNote: File \"iostream\" already loaded\nroot [1] using namespace std;\nroot [2] void hello(){cout &lt;&lt; \"Hi!\" &lt;&lt; endl;}\nLimitation: Function can not be defined in a command line or a tempfile\nYou need to write it in a source file (tmpfile)(1)\n*** Interpreter error recovered ***\nroot [3]\n</code></pre>\n\n<p>How can I fix this? </p>\n"}, {"tags": ["c++", "unit-testing", "visual-studio-2015", "assert", "googletest"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1484775209, "post_id": 41729688, "comment_id": 70654119, "body": "Are you sure this gtest unit was linked with debug version of CRT?"}, {"owner": {"reputation": 5594, "user_id": 1645784, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/xZW4T.jpg?s=128&g=1", "display_name": "Aleksei Petrenko", "link": "https://stackoverflow.com/users/1645784/aleksei-petrenko"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1484775750, "post_id": 41729688, "comment_id": 70654415, "body": "In the project settings it says: <code>Multi-threaded Debug DLL (&#47;MDd)</code>. Just like the project where asserts work. Also in gtest CMake file I found this option: <code>-Dgtest_force_shared_crt=ON</code>"}, {"owner": {"reputation": 5594, "user_id": 1645784, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/xZW4T.jpg?s=128&g=1", "display_name": "Aleksei Petrenko", "link": "https://stackoverflow.com/users/1645784/aleksei-petrenko"}, "reply_to_user": {"reputation": 8889, "user_id": 3493731, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0ccfa8c5c786e748c8cf4f1d3bae9694?s=128&d=identicon&r=PG&f=1", "display_name": "MuertoExcobito", "link": "https://stackoverflow.com/users/3493731/muertoexcobito"}, "edited": false, "score": 0, "creation_date": 1484816031, "post_id": 41729688, "comment_id": 70668253, "body": "@MuertoExcobito thank you, this is what I was looking for! There is a note about this in documentation, but I somehow missed it: <a href=\"https://github.com/google/googletest/blob/master/googletest/docs/V1_7_AdvancedGuide.md#turning-assertion-failures-into-break-points\" rel=\"nofollow noreferrer\">github.com/google/googletest/blob/master/googletest/docs/&hellip;</a> If there was also a way to make this a default behavior for CMake project (e.g. set define instead of command line option). But this is already great."}], "owner": {"reputation": 5594, "user_id": 1645784, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/xZW4T.jpg?s=128&g=1", "display_name": "Aleksei Petrenko", "link": "https://stackoverflow.com/users/1645784/aleksei-petrenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "closed_date": 1484816089, "answer_count": 0, "score": 1, "last_activity_date": 1484774593, "creation_date": 1484774593, "question_id": 41729688, "link": "https://stackoverflow.com/questions/41729688/visual-studio-2015-does-not-break-on-assert-in-gtest", "closed_reason": "Duplicate", "title": "Visual Studio 2015 does not break on assert in gtest", "body": "<p>When I debug a normal application and <code>assert()</code> happens, I get the usual error window which allows me to stop execution and analyze call stack, local variables etc, which is very convenient:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0NcTD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0NcTD.png\" alt=\"assert\"></a></p>\n\n<p>However when I am running a Google Test unit test, assertions never trigger the debugger. Instead I get this error text in cmd window:</p>\n\n<pre><code>Assertion failed: indexMap.size() == points.size(), file test.cpp, line 220\nPress any key to continue . . .\n</code></pre>\n\n<p>Which is not nearly as helpful. I am pretty sure gtest messes up asserts somehow and prevents creation of the error window. Is there a way to have traditional assert behavior when I'm running unit tests?</p>\n"}, {"tags": ["c++", "opengl", "glsl", "shader"], "comments": [{"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 1, "creation_date": 1484774465, "post_id": 41729606, "comment_id": 70653752, "body": "You can&#39;t mix <code>in&#47;out</code> and <code>attribute&#47;varying</code>. These are similar things but in different versions of GLSL/OpenGL."}, {"owner": {"reputation": 703, "user_id": 5778900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh1qL.png?s=128&g=1", "display_name": "pleluron", "link": "https://stackoverflow.com/users/5778900/pleluron"}, "edited": false, "score": 2, "creation_date": 1484774504, "post_id": 41729606, "comment_id": 70653772, "body": "Either version 120 and <code>attribute&#47;varying</code>, or version 150+ and <code>in&#47;out</code>."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1484774787, "post_id": 41729606, "comment_id": 70653906, "body": "@BDL: I think you can mix them, since <code>attribute &#47; varying</code> are merely deprecated.  Depending on the version they may only be available in compatibility profile."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1484778343, "post_id": 41729606, "comment_id": 70655562, "body": "Also make sure that you&#39;re getting the results of <code>glGetShaderInfoLog</code> and <code>glGetProgramInfoLog</code> in debug versions of your code."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1484779821, "post_id": 41729606, "comment_id": 70656136, "body": "&quot;<i>but is linked without a vertex shader</i>&quot; Then your C++ code is to blame. You&#39;re not building your program correctly."}, {"owner": {"reputation": 50, "user_id": 7437896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14437f8c695a29cc7500962f715961d?s=128&d=identicon&r=PG&f=1", "display_name": "user7437896", "link": "https://stackoverflow.com/users/7437896/user7437896"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1484780867, "post_id": 41729606, "comment_id": 70656456, "body": "@DietrichEpp @NicolBolas I am, <code>glGetProgramInfoLog</code> is the one giving me this error. Again if i dont send anything from shader to shader, the code works fine. plus i was following a tutorial."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1484782243, "post_id": 41729606, "comment_id": 70656901, "body": "@user7437896: Sounds like a problem in the shader loading code, then.  I&#39;ve updated the answer.  If that helps, great, but if it doesn&#39;t then you should be posting your shader loading code."}, {"owner": {"reputation": 50, "user_id": 7437896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14437f8c695a29cc7500962f715961d?s=128&d=identicon&r=PG&f=1", "display_name": "user7437896", "link": "https://stackoverflow.com/users/7437896/user7437896"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1484838085, "post_id": 41729606, "comment_id": 70682673, "body": "@DietrichEpp The shader code looks fine compared to what you uploaded, all steps are there. but ill post it anyway."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1484844814, "post_id": 41729606, "comment_id": 70687459, "body": "@user7437896: All the steps are there, but there&#39;s a mistake\u2026 obvious once you see it, even if you don&#39;t know OpenGL, but it&#39;s easy to miss."}, {"owner": {"reputation": 50, "user_id": 7437896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14437f8c695a29cc7500962f715961d?s=128&d=identicon&r=PG&f=1", "display_name": "user7437896", "link": "https://stackoverflow.com/users/7437896/user7437896"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1484864181, "post_id": 41729606, "comment_id": 70697968, "body": "@DietrichEpp oh my god, so silly :p, it worked, thanks a lot for your time"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1484865912, "post_id": 41729606, "comment_id": 70698738, "body": "As a minor note, you can call <code>glDeleteShader</code> in the constructor instead of the destructor.  This way, you only need to call <code>glDeleteProgram</code> in the destructor.  The shaders are only needed for linking the program, you don&#39;t need to keep them around."}, {"owner": {"reputation": 50, "user_id": 7437896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14437f8c695a29cc7500962f715961d?s=128&d=identicon&r=PG&f=1", "display_name": "user7437896", "link": "https://stackoverflow.com/users/7437896/user7437896"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1484867514, "post_id": 41729606, "comment_id": 70699324, "body": "@DietrichEpp thanks for the tip, ill do that"}], "answers": [{"comments": [{"owner": {"reputation": 50, "user_id": 7437896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14437f8c695a29cc7500962f715961d?s=128&d=identicon&r=PG&f=1", "display_name": "user7437896", "link": "https://stackoverflow.com/users/7437896/user7437896"}, "edited": false, "score": 0, "creation_date": 1484776799, "post_id": 41729677, "comment_id": 70654931, "body": "i said in the question that i already tried using varying (instead of in and out), also changing the version didn&#39;t work :/ its weird i have tried everything"}, {"owner": {"reputation": 26262, "user_id": 85306, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4283ac48d7f22118cc4e47a514b3269c?s=128&d=identicon&r=PG", "display_name": "Jherico", "link": "https://stackoverflow.com/users/85306/jherico"}, "edited": false, "score": 0, "creation_date": 1484776843, "post_id": 41729677, "comment_id": 70654944, "body": "Why don&#39;t you update the question with your <code>varying</code> version of the shaders, instead of the ones you have now which clearly can&#39;t work because of the keyword / version mismatch."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 2, "last_activity_date": 1484844730, "last_edit_date": 1484844730, "creation_date": 1484774553, "answer_id": 41729677, "question_id": 41729606, "link": "https://stackoverflow.com/questions/41729606/opengl-cant-send-variables-from-vertex-shader-to-fragment-shader/41729677#41729677", "title": "OpenGL cant send variables from vertex shader to fragment shader", "body": "<p>Final update:</p>\n\n<p>Here's the error.</p>\n\n<pre><code>m_shaders[0] = \nm_shaders[0] = \n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>Fragment Shader contains a user varying but is linked without a vertex shader.</p>\n</blockquote>\n\n<p>Linked without a vertex shader?  That would definitely cause problems.  The code should look something <em>vaguely</em> like this:</p>\n\n<pre><code>GLuint load_shader(GLenum shader_type, ...) {\n    GLuint shader = glCreateShader(shader_type);\n    ... load shader source code ...\n    glCompileShader(shader);\n    GLint success;\n    glGetShaderiv(shader, GL_COMPILE_STATUS, &amp;success);\n    if (!success) {\n        // boom\n    }\n    ... glGetShaderInfoLog ...\n    return shader;\n}\n\nGLuint load_program(...) {\n    GLuint prog = glCreateProgram();\n    // Attach both fragment and vertex shader\n    glAttachShader(prog, load_shader(GL_VERTEX_SHADER, ...));\n    glAttachShader(prog, load_shader(GL_FRAGMENT_SHADER, ...));\n    // Then link them together\n    glLinkProgram(prog);\n    GLint success;\n    glGetProgramiv(program, GL_LINK_STATUS, &amp;success);\n    if (!success) {\n        // boom\n    }\n    ... glGetProgramInfoLog ...\n}\n</code></pre>\n\n<p>It's a fair bit of boilerplate code, and there are a lot of opportunities for the code to contain errors, so it's common for something to be wrong, especially since practically everything in OpenGL is just <code>typedef int GLxxx;</code> or something like that.</p>\n\n<hr>\n\n<p>In GLSL 120, <code>in</code> and <code>out</code> are not storage qualifiers.  Use <code>varying</code> instead.</p>\n\n<pre><code>// Same in vertex and fragment shader.\nvarying vec4 ourColor;\n</code></pre>\n\n<p>Alternatively, use a newer GLSL version.</p>\n\n<pre><code>#version 330\nout vec4 ourColor;\nin vec3 position;\n\n#version 330\nin vec4 ourColor;\nout vec4 fragColor;\n</code></pre>\n"}], "owner": {"reputation": 50, "user_id": 7437896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14437f8c695a29cc7500962f715961d?s=128&d=identicon&r=PG&f=1", "display_name": "user7437896", "link": "https://stackoverflow.com/users/7437896/user7437896"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1542, "favorite_count": 0, "accepted_answer_id": 41729677, "answer_count": 1, "score": -1, "last_activity_date": 1604572625, "creation_date": 1484774314, "last_edit_date": 1484838604, "question_id": 41729606, "link": "https://stackoverflow.com/questions/41729606/opengl-cant-send-variables-from-vertex-shader-to-fragment-shader", "title": "OpenGL cant send variables from vertex shader to fragment shader", "body": "<p>I'm pretty new to OpenGL and just started with a basic program that has a vertex shader and a fragment shader. Everything worked until i tried to send data from the vertex shader to the fragment shader. I read code online and did it perfectly. i use out in the vertex shader and in in the fragment shader, i looked online everywhere for a solution and could not find a thing, and its hard to debug when you dont know much about GLSL or OpenGL. Here are shaders. ( ill only post the shaders since everything else is working fine. The Vertex </p>\n\n<pre><code>#version 120\nvarying vec4 ourColor;\nattribute vec3 position;\n\nvoid main()\n{\ngl_Position = vec4(position, 1.0);\nourColor = vec4(1.0,0.1,0.2,0.5);\n}\n</code></pre>\n\n<p>And the Fragment:</p>\n\n<pre><code>#version 120 \nvarying vec4 ourColor;\n\nvoid main()\n{\ngl_FragColor = ourColor;\n}\n</code></pre>\n\n<p>The error is: Fragment Shader contains a user varying but is linked without a vertex shader.\nI tried using the flat keyword, and the varying keyword, same result. And thanks in advanced for your time. Also I've tried changing the version and then using in and out, same error. \nHere is the Shader Code: (its in a shader class, this is Shader.cpp)</p>\n\n<pre><code>     Shader::Shader(const std::string &amp; fileName)\n    {\n    m_program = glCreateProgram();\n    //vertex shader\n    m_shaders[0] = CreateShader(LoadShader(fileName + \".vs\"), GL_VERTEX_SHADER); \n    m_shaders[0] = CreateShader(LoadShader(fileName + \".fs\"),       \n            GL_FRAGMENT_SHADER); \n\n\n    for(unsigned int i = 0; i &lt; NUM_SHADERS; i++)\n        glAttachShader(m_program, m_shaders[i]);\n\n\n    glBindAttribLocation(m_program, 0, \"position\");\n\n\n    glLinkProgram(m_program);\n    CheckShaderError(m_program, GL_LINK_STATUS, true, \"Error: Program linking failed. \");\n\n    glValidateProgram(m_program);\n    CheckShaderError(m_program, GL_VALIDATE_STATUS, true, \"Error: Program is invalid. \");\n}\n//-----------\nShader::~Shader(void)\n{\n    for(unsigned int i = 0; i &lt; NUM_SHADERS; i++)\n    {\n        glDetachShader(m_program, m_shaders[i]);\n        glDeleteShader(m_shaders[i]);\n    }\n\n    glDeleteProgram(m_program);\n\n}\n//----------\nvoid Shader::Bind()\n{\n    glUseProgram(m_program);\n}\nstatic GLuint CreateShader(const std::string &amp; text, GLenum shaderType)\n{\n    GLuint shader = glCreateShader(shaderType);\n    if(shader == 0)\n    {\n        std::cerr &lt;&lt; \"Error: Shader creation failed! \" &lt;&lt; std::endl;\n    }\n    const GLchar* ShaderSourceStrings[1];\n    GLint ShaderSourceStringsLengths[1];\n    ShaderSourceStrings[0] = text.c_str();\n    ShaderSourceStringsLengths[0] = text.length();\n    glShaderSource(shader, 1, ShaderSourceStrings, ShaderSourceStringsLengths);\n    glCompileShader(shader);\n    CheckShaderError(shader, GL_COMPILE_STATUS, false, \"Error: Shader compilation failed\");\n    return shader;\n}\n//-----------\nstatic std::string LoadShader(const std::string &amp; fileName)\n{\n    std::ifstream file;\n    file.open((fileName).c_str());\n    std::string output;\n    std::string line;\n    if(file.is_open())\n    {\n        while(file.good())\n        {\n            getline(file, line);\n            output.append(line + \"\\n\");\n        }\n    }\n    else\n    {\n        std::cerr &lt;&lt; \"unable to load shader file: \" &lt;&lt; fileName &lt;&lt; std::endl;\n    }\n    return output;\n}\n//-----------\nstatic void CheckShaderError(GLuint shader, GLuint flag, bool isProgram, const std::string &amp; errorMessage)\n{\n    GLint success = 0;\n    GLchar error[1024] = {0};\n    if(isProgram)\n        glGetProgramiv(shader, flag, &amp;success);\n    else\n        glGetShaderiv(shader, flag, &amp;success);\n    if(success == GL_FALSE)\n    {\n        if(isProgram){\n            glGetProgramInfoLog(shader, sizeof(error), NULL, error);\n        std::cout &lt;&lt; \"error from program\" &lt;&lt; std::endl;\n        }\n        else{\n            glGetShaderInfoLog(shader, sizeof(error), NULL, error);\n            std::cout &lt;&lt; \"error from shader\" &lt;&lt; std::endl;\n        }\n            std::cerr &lt;&lt; errorMessage &lt;&lt; \": '\"  &lt;&lt; error &lt;&lt; \"'\" &lt;&lt; std::endl;\n        }\n    }\n</code></pre>\n"}, {"tags": ["c++", "xcode", "qt"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6580159, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b8128ec26623434f05f1d1636fab276b?s=128&d=identicon&r=PG&f=1", "display_name": "johndoesnow", "link": "https://stackoverflow.com/users/6580159/johndoesnow"}, "edited": false, "score": 0, "creation_date": 1484774575, "post_id": 41729598, "comment_id": 70653813, "body": "thanks for the help it worked, what exactly does setupUI do? <a href=\"http://stackoverflow.com/questions/5692991/qt-setupui\">stackoverflow.com/questions/5692991/qt-setupui</a> here it says it creates the actual instances of the objects but aren&#39;t we already initializing it manually?"}], "tags": [], "owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1484775822, "last_edit_date": 1484775822, "creation_date": 1484774279, "answer_id": 41729598, "question_id": 41729401, "link": "https://stackoverflow.com/questions/41729401/qpushbutton-not-clickable-in-mainwindow/41729598#41729598", "title": "QPushButton not clickable in MainWindow", "body": "<p>The reason is quite simple: you have other transparent widgets overlaid on top of <code>m_button</code>. You must ensure that the button is not covered by anything else. E.g. move the creation of the button after the <code>setupUi</code> call <em>or</em> make the button a child of the central widget. Generally speaking, the <code>setupUi</code> call should be the first thing in a widget's constructor.</p>\n\n<p>You also don't need to dynamically allocate the child widgets: prefer holding things by value: less things can go wrong then, and you're having less overhead, too!</p>\n\n<p>Thus, pretending that the <code>Ui_MainWindow</code> class was really generated by uic:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zfUQZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zfUQZ.png\" alt=\"screenshot of the example\"></a></p>\n\n<pre><code>// https://github.com/KubaO/stackoverflown/tree/master/questions/simple-button-main-41729401\n#include &lt;QtWidgets&gt;\n\nclass Ui_MainWindow {\npublic:\n   QWidget *central;\n   QGridLayout *layout;\n   QLabel *label;\n   void setupUi(QMainWindow *parent);\n};\n\nclass MainWindow : public QMainWindow, private Ui_MainWindow {\n   Q_OBJECT\n   QPushButton m_button{\"Click Me\"};\npublic:\n   MainWindow(QWidget *parent = nullptr) : QMainWindow(parent) {\n      setupUi(this);\n      m_button.setParent(centralWidget());\n      m_button.setGeometry({{50, 50}, m_button.sizeHint()});\n   }\n};\n\nvoid Ui_MainWindow::setupUi(QMainWindow *parent) {\n   central = new QWidget{parent};\n   layout = new QGridLayout{central};\n   label = new QLabel{\"Hello\"};\n   label-&gt;setAlignment(Qt::AlignCenter);\n   label-&gt;setStyleSheet(\"background-color:blue; color:white;\");\n   layout-&gt;addWidget(label, 0, 0);\n   parent-&gt;setCentralWidget(central);\n   parent-&gt;setMinimumSize(200, 200);\n}\n\nint main(int argc, char ** argv) {\n   QApplication app{argc, argv};\n   MainWindow w;\n   w.show();\n   return app.exec();\n}\n#include \"main.moc\"\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6580159, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b8128ec26623434f05f1d1636fab276b?s=128&d=identicon&r=PG&f=1", "display_name": "johndoesnow", "link": "https://stackoverflow.com/users/6580159/johndoesnow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1726, "favorite_count": 0, "accepted_answer_id": 41729598, "answer_count": 1, "score": 0, "last_activity_date": 1484775822, "creation_date": 1484773454, "question_id": 41729401, "link": "https://stackoverflow.com/questions/41729401/qpushbutton-not-clickable-in-mainwindow", "title": "QPushButton not clickable in MainWindow", "body": "<p>I'm writing a QT project in Xcode, I made a Widget application in the QT Editor and used the \"qmake -spec macx-xcode\" to convert the project into an Xcode project. </p>\n\n<p>I have a standard project: </p>\n\n<p>main.cpp</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    QApplication app(argc, argv);\n    MainWindow w;\n    w.show();\n    return app.exec();\n}\n</code></pre>\n\n<p>main window.cpp</p>\n\n<pre><code>MainWindow::MainWindow(QWidget *parent) : QMainWindow(parent), ui(new   Ui::MainWindow)\n{\n\n    m_button = new QPushButton(this);\n    m_button -&gt; setText(\"button\");\n    m_button-&gt;setGeometry(QRect(QPoint(100, 100),QSize(200, 50)));\n    QPushButton *workingButton = new QPushButton(\"Hello\");\n    workingButton -&gt; show();\n    connect(m_button, SIGNAL(clicked()), this, SLOT(quitButton()));\n    ui-&gt;setupUi(this);\n}\nvoid MainWindow::quitButton() {\n     m_button-&gt;setText(\"Example\");\n}\n\nMainWindow::~MainWindow()\n{\n    delete ui;\n}\n</code></pre>\n\n<p>main window.h</p>\n\n<pre><code>namespace Ui {\nclass MainWindow;\n}\n\nclass MainWindow : public QMainWindow\n{\n\n    Q_OBJECT\n\n    public:\n    explicit MainWindow(QWidget *parent = 0);\n\n    ~MainWindow();\n\nprivate slots:\n    void quitButton();\n\n\nprivate:\n    Ui::MainWindow *ui;\n    QPushButton *m_button;\n};\n\n#endif\n</code></pre>\n\n<p>The m_button shows up in the mainWindow but it is not clickable but the workingButton, shows up in its own separate window, and in the connect, when I replace the m_button with the workingButton, it is able to call the function. Any idea why the m_button is not sending a signal or function not being called? </p>\n"}, {"tags": ["c++", "oop", "matrix"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1484773861, "post_id": 41729360, "comment_id": 70653454, "body": "<i>Code works fine</i> -- No it doesn&#39;t.  The destructor is exposing the bugs in your code.  Put it back and fix the bugs.  Second, where is your copy constructor for <code>Matrix</code>?  Third, your assignment operator introduces a memory leak, and is way off as to the proper way to perform a copy of <code>Matrix</code>."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1484774176, "post_id": 41729360, "comment_id": 70653621, "body": "<i>SO i asked to create matrix class</i> -- You could have simply used <code>std::vector&lt;std::vector&lt;int&gt;&gt; matrix;</code> and not have any of the issues you&#39;re having now."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1484774378, "post_id": 41729360, "comment_id": 70653704, "body": "Worth reading: <a href=\"https://isocpp.org/wiki/faq/operator-overloading#matrix-subscript-op\" rel=\"nofollow noreferrer\">isocpp.org/wiki/faq/operator-overloading#matrix-subscript-op</a> Note how it uses a 1D array and performs the math to do the 2D to 1D indexing. This is much faster and as you can see, much simpler than mucking about with arrays of arrays."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 3, "creation_date": 1484774593, "post_id": 41729360, "comment_id": 70653820, "body": "Also give <a href=\"http://stackoverflow.com/questions/4172722/what-is-the-rule-of-three\">What is the Rule of Three?</a> a read. It will pre-emtively answer what&#39;s probably going to be the next question."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1484775019, "post_id": 41729360, "comment_id": 70654025, "body": "It is hard to answer a question like this without practically writing the code correctly.  The current code needs much more than a couple of minor adjustments."}], "owner": {"reputation": 1, "user_id": 2904110, "user_type": "registered", "profile_image": "https://graph.facebook.com/1058092478/picture?type=large", "display_name": "Emil Zack", "link": "https://stackoverflow.com/users/2904110/emil-zack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484773299, "creation_date": 1484773299, "question_id": 41729360, "link": "https://stackoverflow.com/questions/41729360/access-violation-reading-location-creating-matrix-class", "title": "Access violation reading location - creating matrix class", "body": "<p>This is supposed to be my HW  in OOP course. SO i asked to create matrix class. Code works fine -  all methods and new operands works fine BUT when my D`tor is empty and when i write there code to free memory i get this error. Thanks for help</p>\n\n<pre><code>int main()\n{\nMyMatrix m1(3, 3);\nMyMatrix m2(3, 3);\nMyMatrix res(3, 3);\n\nm1.Set();\nm2.Set();\n\ncout &lt;&lt; m1;\ncout &lt;&lt; m2;\n\nres = m1 + m2;\n\ncout &lt;&lt; res;\n\n}\n</code></pre>\n\n<p>CPP </p>\n\n<pre><code>MyMatrix::MyMatrix(int row, int col) // C`tor with specific data\n{\nn = row;\nm = col;\n\nmatrix = new int* [n]; // Memory  allocation for rows\n\nfor (int i = 0; i &lt; n; i++)\n{\n    matrix[i] = new int[m]; // Memory Allocation for columns\n}\n\n\nfor (int i = 0; i &lt; n; i++)\n{\n\n    for (int j = 0; j &lt; m; j++)\n    {\n\n        matrix[i][j] = 0;\n\n    }\n}\n}\n\nMyMatrix::~MyMatrix() // Default d`tor \n{\n\nfor (int i = 0; i &lt; n; i++)\n{\n    delete[] matrix[i];\n}\ndelete[] matrix;\n}\n\nvoid MyMatrix::Set()\n{\ncout &lt;&lt; \"Enter new row\" &lt;&lt; endl;\nfor (int i = 0; i &lt; n; i++)\n{\n\n    for (int j = 0; j &lt; m; j++)\n    {\n\n        cin &gt;&gt; matrix[i][j];\n\n    }\n\n    if (i != (n - 1))\n    {\n        cout &lt;&lt; \"Enter new row\" &lt;&lt; endl;\n    }\n\n  }\n}\n\n\nostream&amp; operator&lt;&lt;(ostream&amp; out, const MyMatrix&amp; matrix)\n{\n\nfor (int i = 0; i &lt; matrix.n; i++)\n{\n\n    //run in loop on every column.\n    for (int j = 0; j &lt; matrix.m; j++)\n        //print value with a space.\n        out &lt;&lt; matrix.matrix[i][j] &lt;&lt; \"t\";\n    //at the end of every row jump line.\n    out &lt;&lt; endl;\n}\n\nout &lt;&lt; endl;\nreturn out;\n}\n\n\nMyMatrix&amp; MyMatrix::operator= (const MyMatrix&amp; mat1)\n{\nn = mat1.n;\nm = mat1.m;\n\nfor (int i = 0; i &lt; n; i++)\n{\n\n    for (int j = 0; j &lt; m; j++)\n    {\n\n        matrix[i][j] = mat1.matrix[i][j];\n\n    }\n\n}\n\nreturn *this;\n\n}\n\nconst MyMatrix MyMatrix::operator+(const MyMatrix&amp; mat1) const\n{\nMyMatrix temp(n, m);\n\nfor (int i = 0; i &lt; n; i++)\n{\n\n    for (int j = 0; j &lt; m; j++)\n    {\n\n        temp.matrix[i][j] = matrix[i][j] + mat1.matrix[i][j];\n\n    }\n\n}\n\nreturn temp;\n\n}\n</code></pre>\n\n<p>H file   </p>\n\n<pre><code>class MyMatrix\n{\n\nprivate:\n\nint **matrix;\nint n, m;\n\npublic:\n\nMyMatrix(int a, int b);\n~MyMatrix();\n\nvoid Set();\n\nconst MyMatrix  operator+ (const MyMatrix&amp; mat1) const;\nMyMatrix&amp; operator= (const MyMatrix&amp; mat1);\n\nfriend ostream&amp; operator&lt;&lt;(ostream&amp; out, const MyMatrix&amp; matrix);\n};\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "data-structures", "stdmap", "stdset"], "comments": [{"owner": {"reputation": 638, "user_id": 4262207, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-iHUQgHLj_t0/AAAAAAAAAAI/AAAAAAAAACM/nE_ak8mRoJE/photo.jpg?sz=128", "display_name": "lolololol ol", "link": "https://stackoverflow.com/users/4262207/lolololol-ol"}, "edited": false, "score": 0, "creation_date": 1484773192, "post_id": 41729233, "comment_id": 70653095, "body": "Ring buffer, IMO."}], "answers": [{"tags": [], "owner": {"reputation": 375, "user_id": 7437816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec3a0968fe49876bd821eee0f9e657a?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rozkin", "link": "https://stackoverflow.com/users/7437816/martin-rozkin"}, "is_accepted": false, "score": 3, "last_activity_date": 1484785542, "creation_date": 1484785542, "answer_id": 41731785, "question_id": 41729233, "link": "https://stackoverflow.com/questions/41729233/count-distinct-elements-from-a-concurrently-read-stream/41731785#41731785", "title": "Count distinct elements from a concurrently read stream", "body": "<p><code>std::unordered_map</code> would be better. But you should consider using something like <strong>HyperLogLog</strong></p>\n"}], "owner": {"reputation": 2184, "user_id": 1112010, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2c06679b27da6bbc84a4bf036da82648?s=128&d=identicon&r=PG", "display_name": "Mukul Gupta", "link": "https://stackoverflow.com/users/1112010/mukul-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 2, "closed_date": 1484809119, "answer_count": 1, "score": 2, "last_activity_date": 1484785542, "creation_date": 1484772780, "last_edit_date": 1484773189, "question_id": 41729233, "link": "https://stackoverflow.com/questions/41729233/count-distinct-elements-from-a-concurrently-read-stream", "closed_reason": "Needs more focus", "title": "Count distinct elements from a concurrently read stream", "body": "<p>I have multiple listeners threads reading a stream of messages (Kafka). Each message has an identifier. The consumers/stream guarantees at-least once consumption. At most of the time, the stream would provide the message exactly once. The count of messages to expect is known beforehand. When all messages are received, I want to shutdown all listener threads. The number of messages can be at most 50 million. What data structure is most suitable for this?</p>\n\n<p>I was thinking of using <code>std::set</code>, <code>std::map</code> and using a <code>mutex</code> at each insertion of the thread. Can a single thread be actually faster in such a use-case? Is there something more optimal? </p>\n"}, {"tags": ["c++", "windows", "keyboard"], "comments": [{"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1484772776, "post_id": 41729185, "comment_id": 70652865, "body": "Does it stop if you send <code>keybd_event(VK_CONTROL,0x1C,0,0);</code> or you use the <code>KEYEVENTF_KEYUP</code> flag?"}, {"owner": {"reputation": 25, "user_id": 7366636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kmj4P.jpg?s=128&g=1", "display_name": "Ali Mahdavifar", "link": "https://stackoverflow.com/users/7366636/ali-mahdavifar"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1484772942, "post_id": 41729185, "comment_id": 70652965, "body": "@MargaretBloom No, it does not work for me."}], "answers": [{"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 2, "last_activity_date": 1484772822, "creation_date": 1484772822, "answer_id": 41729243, "question_id": 41729185, "link": "https://stackoverflow.com/questions/41729185/how-to-stop-pressing-a-key-after-using-keybd-event/41729243#41729243", "title": "How to stop pressing a key after using keybd_event?", "body": "<p>Read your own link - <code>keybd_event</code> function has <code>KEYEVENTF_UP</code> flag:</p>\n\n<blockquote>\n  <p>KEYEVENTF_KEYUP 0x0002 If specified, the key is being released. If not\n  specified, the key is being depressed.</p>\n</blockquote>\n"}], "owner": {"reputation": 25, "user_id": 7366636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kmj4P.jpg?s=128&g=1", "display_name": "Ali Mahdavifar", "link": "https://stackoverflow.com/users/7366636/ali-mahdavifar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "accepted_answer_id": 41729243, "answer_count": 1, "score": 2, "last_activity_date": 1484772822, "creation_date": 1484772570, "question_id": 41729185, "link": "https://stackoverflow.com/questions/41729185/how-to-stop-pressing-a-key-after-using-keybd-event", "title": "How to stop pressing a key after using keybd_event?", "body": "<p>I a problem using  <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms646304(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>keybd_event</code></a> function. When I call it to press Ctrl once:</p>\n\n<pre><code>keybd_event(VK_CONTROL,0x9C,0,0);\n</code></pre>\n\n<p>then if I call it to press X key, it will press Ctrl+X. For example, the next line is:</p>\n\n<pre><code>keybd_event(0x43,0x9C,0,0);  //0x43 is the Virtual-Key Code of 'C' key\n</code></pre>\n\n<p>So, it will copy the text (Ctrl+C) not type the letter 'C'. Actually, it does not stop pressing Ctrl, even after closing the program. So how can I stop pressing Ctrl key anymore? I have the same problem with Shift key.</p>\n"}, {"tags": ["c++", "linker-errors", "c++builder", "math.h"], "comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 1, "creation_date": 1484772514, "post_id": 41729109, "comment_id": 70652696, "body": "So what is the error? Unresolved symbol? Multiple defined symbols?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1484774057, "post_id": 41729109, "comment_id": 70653550, "body": "Been a while, but you used to use &quot;add to project&quot;, change the search filter to *.lib, hunt down the library, and click OK."}], "answers": [{"tags": [], "owner": {"reputation": 60, "user_id": 7562980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8f932824c368d7bfb7807747a54947?s=128&d=identicon&r=PG&f=1", "display_name": "S. Petri\u0107", "link": "https://stackoverflow.com/users/7562980/s-petri%c4%87"}, "is_accepted": false, "score": 1, "last_activity_date": 1487185656, "last_edit_date": 1487185656, "creation_date": 1487157840, "answer_id": 42247975, "question_id": 41729109, "link": "https://stackoverflow.com/questions/41729109/linking-error-with-math-h-what-option-to-tell-the-linker-to-link-with-it/42247975#42247975", "title": "Linking error with &quot;math.h&quot; - What option to tell the linker to link with it?", "body": "<p>This problem is not related to static/dynamic linkage but with name mangling.\nIf you inspect math.h closely, you'll find the difference between Win64 and Win32 declarations for floor function:</p>\n\n<pre><code>extern \"C++\" {\n...\n#if defined(_WIN64)\ninline float floor(float __x) { return floorf(__x); }\n...\n#else\n...\ninline float floor(float __x) { return (float)floor((double)__x); }\n...\n</code></pre>\n\n<p>To make a long story short, try to build you project on Win64 platform: <strong>floorf</strong> will be linked correctly. It will not work for Win32. My suggestion is to use <strong>floor</strong> instead of floorf. It will work on both platforms. </p>\n\n<p>Edit: Actually, floorf function is not defined for Win32 in Embarcadero std library. If you want to use some 3rd party std library, you must include appropriate header (not one from Embarcadero) and link library (#pragma link) statically. If library is compiled with gcc/msvc you must convert library to omf format.</p>\n"}], "owner": {"reputation": 677, "user_id": 7181607, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-zWEyfhw7itM/AAAAAAAAAAI/AAAAAAAAAEg/ETHZRlGuvt4/photo.jpg?sz=128", "display_name": "FlKo", "link": "https://stackoverflow.com/users/7181607/flko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 895, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1487185656, "creation_date": 1484772304, "last_edit_date": 1495540395, "question_id": 41729109, "link": "https://stackoverflow.com/questions/41729109/linking-error-with-math-h-what-option-to-tell-the-linker-to-link-with-it", "title": "Linking error with &quot;math.h&quot; - What option to tell the linker to link with it?", "body": "<p>I'd like to use <code>math.h</code> in C++ Builder 10.1.2.</p>\n\n<p>Unfortunately, there is a linker error when I try to call one of <code>math.h</code>'s functions.\nWhat I do already know is, that (for historical reasons) the linker must be explicitly set to link to use the <strong>math</strong> lib.\n<a href=\"https://stackoverflow.com/questions/1033898/why-do-you-have-to-link-the-math-library-in-c\">See here</a>.</p>\n\n<p>In <strong>gcc</strong> this can be done via the <code>-lm</code> flag.</p>\n\n<p>But what do I have to enter for C++ Builder in the <em>Project options</em> => <em>C++ Linker</em> =><em>Advanced options</em> field to make this work?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>So here is an example:\nCreate a new VCL project and change the Form1 code like that:</p>\n\n<pre><code>//---------------------------------------------------------------------------\n\n#include &lt;vcl.h&gt;\n#pragma hdrstop\n\n#include \"Unit1.h\"\n\n#include &lt;math.h&gt;\n//-------------------------------------------------------------------------- -\n#pragma package(smart_init)\n#pragma resource \"*.dfm\"\nTForm1 *Form1;\n//---------------------------------------------------------------------------\n__fastcall TForm1::TForm1(TComponent* Owner)\n    : TForm(Owner)\n{\n    float a = floorf(0.0f);\n}\n//---------------------------------------------------------------------------\n</code></pre>\n\n<p>That will give you the linker error</p>\n\n<pre><code>[ilink32 Error] Error: Unresolved external '_floorf' referenced by C:\\USERS\\FLKO\\DOCUMENTS\\EMBARCADERO\\STUDIO\\PROJECTS\\WIN32\\DEBUG\\UNIT1.OBJ\n</code></pre>\n\n<p>So I need to tell the linker to link with the <code>math</code> lib.</p>\n\n<p>But how?</p>\n"}, {"tags": ["c++", "operator-overloading", "sfinae", "friend-function", "function-templates"], "answers": [{"comments": [{"owner": {"reputation": 1027, "user_id": 1559050, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f99f612ef9547e9eea6a8c4f5c9be218?s=128&d=identicon&r=PG", "display_name": "Dejavu", "link": "https://stackoverflow.com/users/1559050/dejavu"}, "edited": false, "score": 0, "creation_date": 1484777124, "post_id": 41730088, "comment_id": 70655070, "body": "Nice, this seems to work around the compilation errors for both g++ and vc++! But behavior wise, did clang++ behave correctly or g++/vc++?"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "reply_to_user": {"reputation": 1027, "user_id": 1559050, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f99f612ef9547e9eea6a8c4f5c9be218?s=128&d=identicon&r=PG", "display_name": "Dejavu", "link": "https://stackoverflow.com/users/1559050/dejavu"}, "edited": false, "score": 0, "creation_date": 1484777723, "post_id": 41730088, "comment_id": 70655300, "body": "Added some more details."}, {"owner": {"reputation": 1027, "user_id": 1559050, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f99f612ef9547e9eea6a8c4f5c9be218?s=128&d=identicon&r=PG", "display_name": "Dejavu", "link": "https://stackoverflow.com/users/1559050/dejavu"}, "edited": false, "score": 0, "creation_date": 1484779060, "post_id": 41730088, "comment_id": 70655841, "body": "So you mean that clang is the faulty one here by not preventing the conflicting definitions? Or, clang was able to somehow &quot;merge&quot; any conflicting definitions if they are <i>exactly</i> the same?"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "reply_to_user": {"reputation": 1027, "user_id": 1559050, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f99f612ef9547e9eea6a8c4f5c9be218?s=128&d=identicon&r=PG", "display_name": "Dejavu", "link": "https://stackoverflow.com/users/1559050/dejavu"}, "edited": false, "score": 0, "creation_date": 1484816992, "post_id": 41730088, "comment_id": 70668808, "body": "Refactored the answer. Yes, I think clang is wrong here."}, {"owner": {"reputation": 1027, "user_id": 1559050, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f99f612ef9547e9eea6a8c4f5c9be218?s=128&d=identicon&r=PG", "display_name": "Dejavu", "link": "https://stackoverflow.com/users/1559050/dejavu"}, "edited": false, "score": 0, "creation_date": 1484840910, "post_id": 41730088, "comment_id": 70684760, "body": "Thanks for more details!"}], "tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": true, "score": 3, "last_activity_date": 1484816949, "last_edit_date": 1495541333, "creation_date": 1484776218, "answer_id": 41730088, "question_id": 41729107, "link": "https://stackoverflow.com/questions/41729107/c-friend-function-template-overloading-and-sfinae-different-behaviors-in-clang/41730088#41730088", "title": "C++ friend function template overloading and SFINAE different behaviors in clang++, g++, vc++ (C++14 mode)", "body": "<p>SFINAE works at template instantiation level, i.e. at <code>struct awaitable&lt;T&gt;</code>, not at the level of individual members of the template. <code>awaitable&lt;void&gt;</code> is a valid instantiation and as such it instantiates the declarations of all 3 members of the class, duplicating the latter 2.</p>\n\n<p>It is not that the two definitions conflict with each other - it is that each definition conflicts with itself (<a href=\"http://rextester.com/XRLN87339\" rel=\"nofollow noreferrer\">example</a>) (<a href=\"https://stackoverflow.com/questions/6972368/stdenable-if-to-conditionally-compile-a-member-function\">more details</a>).</p>\n\n<p><strong>Workaround 1</strong></p>\n\n<p>Define the helper operators out-of-class (granted, not exactly the same as what you had - these would be friends to <em>any</em> instance of the template)</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\ntemplate &lt;typename T&gt;\nstruct awaitable\n{\n    friend awaitable&lt;void&gt; operator&amp;&amp;(awaitable a1, awaitable a2)\n    {\n        std::cout &lt;&lt; \"operator&amp;&amp;(awaitable a1, awaitable a2) - T: \" &lt;&lt; typeid(T).name() &lt;&lt; std::endl;\n        return {};\n    }\n\n    template&lt;typename U&gt;\n    friend std::enable_if_t&lt;!std::is_void&lt;U&gt;::value, awaitable&lt;void&gt;&gt; operator&amp;&amp;(awaitable&lt;void&gt; a1, awaitable&lt;U&gt; a2);\n\n    template&lt;typename U&gt;\n    friend std::enable_if_t&lt;!std::is_void&lt;U&gt;::value, awaitable&lt;void&gt;&gt; operator&amp;&amp;(awaitable&lt;U&gt; a1, awaitable&lt;void&gt; a2);\n\n};\n\ntemplate&lt;typename U&gt;\nstd::enable_if_t&lt;!std::is_void&lt;U&gt;::value, awaitable&lt;void&gt;&gt; operator&amp;&amp;(awaitable&lt;void&gt; a1, awaitable&lt;U&gt; a2)\n{\n    std::cout &lt;&lt; \"operator&amp;&amp;(awaitable&lt;void&gt; a1, awaitable&lt;U&gt; a2) - U: \" &lt;&lt; typeid(U).name() &lt;&lt; std::endl;\n    return {};\n}\n\ntemplate&lt;typename U&gt;\nstd::enable_if_t&lt;!std::is_void&lt;U&gt;::value, awaitable&lt;void&gt;&gt; operator&amp;&amp;(awaitable&lt;U&gt; a1, awaitable&lt;void&gt; a2)\n{\n    std::cout &lt;&lt; \"operator&amp;&amp;(awaitable&lt;U&gt; a1, awaitable&lt;void&gt; a2) - U: \" &lt;&lt; typeid(U).name() &lt;&lt; std::endl;\n    return {};\n}\n\nint main(int argc, const char * argv[])\n{\n    awaitable&lt;int&gt; a1, a2, a3, a4;\n    auto ar = a1 &amp;&amp; (a1 &amp;&amp; a2) &amp;&amp; (a2 &amp;&amp; a3) &amp;&amp; a4;\n}\n</code></pre>\n\n<p><strong>Workaround 2</strong></p>\n\n<p>Use no SFINAE at all, but a specialization of <code>awaitable</code>. Note the specialization is reversed - the base implementation is a special case for <code>awaitable&lt;void&gt;</code> and the specialization is for everything else.</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\ntemplate &lt;typename T, bool isvoid = std::is_void&lt;T&gt;::value&gt;\nstruct awaitable\n{\n    friend awaitable&lt;void&gt; operator&amp;&amp;(awaitable a1, awaitable a2)\n    {\n        std::cout &lt;&lt; \"operator&amp;&amp;(awaitable a1, awaitable a2) - void\" &lt;&lt; std::endl;\n        return {};\n    }\n};\n\ntemplate &lt;typename T&gt;\nstruct awaitable&lt;T, false&gt;\n{\n    friend awaitable&lt;void&gt; operator&amp;&amp;(awaitable a1, awaitable a2)\n    {\n        std::cout &lt;&lt; \"operator&amp;&amp;(awaitable a1, awaitable a2) - T: \" &lt;&lt; typeid(T).name() &lt;&lt; std::endl;\n        return {};\n    }\n\n    friend awaitable&lt;void&gt; operator&amp;&amp;(awaitable&lt;void&gt; a1, awaitable&lt;T&gt; a2)\n    {\n        std::cout &lt;&lt; \"operator&amp;&amp;(awaitable&lt;void&gt; a1, awaitable&lt;T&gt; a2) - U: \" &lt;&lt; typeid(T).name() &lt;&lt; std::endl;\n        return {};\n    }\n\n    friend awaitable&lt;void&gt; operator&amp;&amp;(awaitable&lt;T&gt; a1, awaitable&lt;void&gt; a2)\n    {\n        std::cout &lt;&lt; \"operator&amp;&amp;(awaitable&lt;T&gt; a1, awaitable&lt;void&gt; a2) - void\" &lt;&lt; std::endl;\n        return {};\n    }\n};\n\nint main(int argc, const char * argv[])\n{\n    awaitable&lt;int&gt; a1, a2, a3, a4;\n    auto ar = a1 &amp;&amp; (a1 &amp;&amp; a2) &amp;&amp; (a2 &amp;&amp; a3) &amp;&amp; a4;\n}\n</code></pre>\n"}], "owner": {"reputation": 1027, "user_id": 1559050, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f99f612ef9547e9eea6a8c4f5c9be218?s=128&d=identicon&r=PG", "display_name": "Dejavu", "link": "https://stackoverflow.com/users/1559050/dejavu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 41730088, "answer_count": 1, "score": 3, "last_activity_date": 1484816949, "creation_date": 1484772298, "last_edit_date": 1484772774, "question_id": 41729107, "link": "https://stackoverflow.com/questions/41729107/c-friend-function-template-overloading-and-sfinae-different-behaviors-in-clang", "title": "C++ friend function template overloading and SFINAE different behaviors in clang++, g++, vc++ (C++14 mode)", "body": "<p>So, the following code builds and runs successfully under clang++ (3.8.0), but fails both under g++ (6.3.0) and vc++ (19.10.24903.0). Both g++ and vc++ complain about redefinition of operator&amp;&amp;.</p>\n\n<p>Does anyone know which compiler is at fault here. For the compilers that fails to compile the code, what would be the workarounds for the compilation error?</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\ntemplate &lt;typename T&gt;\nstruct awaitable\n{\n    friend awaitable&lt;void&gt; operator&amp;&amp;(awaitable a1, awaitable a2)\n    {\n        std::cout &lt;&lt; \"operator&amp;&amp;(awaitable a1, awaitable a2) - T: \" &lt;&lt; typeid(T).name() &lt;&lt; std::endl;\n        return awaitable&lt;void&gt;{};\n    }\n\n    template &lt;typename U = T, typename std::enable_if&lt;!std::is_same&lt;U, void&gt;::value&gt;::type* = nullptr&gt;\n    friend awaitable&lt;void&gt; operator&amp;&amp;(awaitable&lt;void&gt; a1, awaitable&lt;U&gt; a2)\n    {\n        std::cout &lt;&lt; \"operator&amp;&amp;(awaitable&lt;void&gt; a1, awaitable&lt;U&gt; a2) - U: \" &lt;&lt; typeid(T).name() &lt;&lt; std::endl;\n        return awaitable&lt;void&gt;{};\n    }\n\n    template &lt;typename U = T, typename std::enable_if&lt;!std::is_same&lt;U, void&gt;::value&gt;::type* = nullptr&gt;\n    friend awaitable&lt;void&gt; operator&amp;&amp;(awaitable&lt;U&gt; a1, awaitable&lt;void&gt; a2)\n    {\n        std::cout &lt;&lt; \"operator&amp;&amp;(awaitable&lt;U&gt; a1, awaitable&lt;void&gt; a2) - U: \" &lt;&lt; typeid(T).name() &lt;&lt; std::endl;\n        return awaitable&lt;void&gt;{};\n    }\n};\n\nint main(int argc, const char * argv[])\n{\n    awaitable&lt;int&gt; a1, a2, a3, a4;\n    auto ar = a1 &amp;&amp; (a1 &amp;&amp; a2) &amp;&amp; (a2 &amp;&amp; a3) &amp;&amp; a4;\n}\n</code></pre>\n\n<p>clang++: <a href=\"http://coliru.stacked-crooked.com/a/cb01926bbcacdfb0\" rel=\"nofollow noreferrer\">http://coliru.stacked-crooked.com/a/cb01926bbcacdfb0</a></p>\n\n<p>g++: <a href=\"http://coliru.stacked-crooked.com/a/73d17a5ae26f22eb\" rel=\"nofollow noreferrer\">http://coliru.stacked-crooked.com/a/73d17a5ae26f22eb</a></p>\n\n<p>vc++: <a href=\"http://webcompiler.cloudapp.net/\" rel=\"nofollow noreferrer\">http://webcompiler.cloudapp.net/</a></p>\n"}, {"tags": ["c++", "xml", "qt", "sax"], "comments": [{"owner": {"reputation": 3189, "user_id": 7016303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dYmXc.jpg?s=128&g=1", "display_name": "Mikel F", "link": "https://stackoverflow.com/users/7016303/mikel-f"}, "edited": false, "score": 1, "creation_date": 1484783259, "post_id": 41728927, "comment_id": 70657210, "body": "I am not seeing a <code>&lt;&#47;diagram&gt;</code> tag to close the document"}, {"owner": {"reputation": 11, "user_id": 7437617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/158404b373dce3d7bbd7e95d6f863c77?s=128&d=identicon&r=PG&f=1", "display_name": "Sasora", "link": "https://stackoverflow.com/users/7437617/sasora"}, "reply_to_user": {"reputation": 3189, "user_id": 7016303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dYmXc.jpg?s=128&g=1", "display_name": "Mikel F", "link": "https://stackoverflow.com/users/7016303/mikel-f"}, "edited": false, "score": 0, "creation_date": 1484855113, "post_id": 41728927, "comment_id": 70693092, "body": "For some weird reason, &lt;/diagram&gt; was in the original code  but didn&#39;t show up. I have since changed the XML document I am working with to a simpler one to make locating issues easier.  I have a feeling the issue lies within &quot;QXmlInputSource source (&amp;xmlFile);&quot; because the example code for simplereader is &quot;QXmlInputSource *source = new QXmlInputSource(file);&quot; but everytime I type it out exactly like that, I get an error. Do you know of any examples of what file exactly is? (Is it a QString, QFile, Exact filepath, etc)?"}], "owner": {"reputation": 11, "user_id": 7437617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/158404b373dce3d7bbd7e95d6f863c77?s=128&d=identicon&r=PG&f=1", "display_name": "Sasora", "link": "https://stackoverflow.com/users/7437617/sasora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484855147, "creation_date": 1484771580, "last_edit_date": 1484855147, "question_id": 41728927, "link": "https://stackoverflow.com/questions/41728927/cant-read-in-a-xml-file-using-qxml-sax-and-c", "title": "Can&#39;t read in a XML file using QXML/SAX and C++", "body": "<p>I'm trying to read in a .xml file in QT but every time I do, <code>QXmlSimpleReader.parse</code> will return false - see: <em>qDebug()&lt;&lt; \"parse fail\";</em> at the bottom of the <em>descriptionfilereader</em> class.</p>\n\n<p>Why is this failing? I have the .xml file in the same folder as the code. (Note: I copied the XML into notepad and saved it as a .xml with ANSI enconding. My computer is also showing the file is an XML document).</p>\n\n<p>Explanation of code: DescriptionFileReader object is created in main and the handler of the reading is done by using an instance of the parser class.</p>\n\n<p>(edit: I have changed the XML document to read in to a simpler one in hopes of finding the problem easier)</p>\n\n<p>Descriptionfilereader.cpp:</p>\n\n<pre><code>#include \"descriptionfilereader.h\"\n#include \"parser.h\"\n#include &lt;QDebug&gt;\n#include &lt;iostream&gt;\n#include &lt;QXml.h&gt;\n#include &lt;string&gt;\n#include &lt;QXmlDefaultHandler&gt;\nusing namespace std;\n\nDescriptionFileReader::DescriptionFileReader()\n{\n\n}\n\nDescriptionFileReader::~DescriptionFileReader()\n{\n\n}\n\n\n\nvoid DescriptionFileReader::Read()\n{\n\nParser handler;\nQXmlSimpleReader xmlReader; //Intialize xmlReader\n\nxmlReader.setContentHandler(&amp;handler);\nxmlReader.setErrorHandler(&amp;handler);\n\nQFile xmlFile (\"notes.xml\");\n\nQXmlInputSource source (&amp;xmlFile);\n\n//handler.start     \\/ this returns false\nbool ok = xmlReader.parse (source); \n\nif (!ok)\n     qDebug()&lt;&lt; \"parse fail\";\n\n}\n</code></pre>\n\n<p>parser.cpp:</p>\n\n<pre><code>#include \"parser.h\"\n#include &lt;stdio.h&gt;\n#include &lt;qstring.h&gt;\n#include &lt;qxml.h&gt;\n#include &lt;QTextStream&gt;\n#include &lt;iostream&gt;\n#include &lt;QDebug&gt;\n\n using namespace std;\n\nstatic const char TAG_ITEM[] = \"description\";\nstatic const char TAG_MATERIAL[]= \"Material\";\nstatic const char TAG_MOUNT[] = \"Mount\";\nQString currElement_;\n\n\n\nbool Parser::characters(const QString&amp; text)\n{\n    if( currElement_ == TAG_ITEM) {}\n\n    else\n      {return false;}\n    return true;\n}\n\nbool Parser::startElement(const QString&amp;, const QString&amp; localName,\n                          const QString&amp; qName,\n                          const QXmlAttributes&amp; atts)\n{\n    if( localName == TAG_ITEM)\n    {\n        qDebug()&lt;&lt; \"It's coming\";\n    }\n    else if( localName == TAG_MATERIAL ) {}\n    else if( localName == TAG_MOUNT ){}\n    else{return false;}\n\n    currElement_ = localName;\n    return true;\n}\nbool Parser::endElement( const QString&amp;, const QString&amp; localName, const QString&amp; )\n{\n    if( localName == TAG_ITEM)\n    {\n        qDebug()&lt;&lt; \"It's gone\";\n    }\n    else if( localName == TAG_MATERIAL ) {}\n    else if( localName == TAG_MOUNT ){}\n    else{return false;}\n\n    currElement_ = localName;\n\n    return true;\n}\n</code></pre>\n\n<p>XML Document:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;note&gt;\n  &lt;to&gt;Tove&lt;/to&gt;\n  &lt;from&gt;Jani&lt;/from&gt;\n  &lt;heading&gt;Reminder&lt;/heading&gt;\n  &lt;body&gt;Don't forget me this weekend!&lt;/body&gt;\n&lt;/note&gt;\n</code></pre>\n"}, {"tags": ["c++", "c", "floating-point", "overflow", "rounding-error"], "comments": [{"owner": {"reputation": 127019, "user_id": 59303, "user_type": "moderator", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/gIt1g.png?s=128&g=1", "display_name": "ChrisF", "link": "https://stackoverflow.com/users/59303/chrisf"}, "edited": false, "score": 1, "creation_date": 1484773832, "post_id": 41728910, "comment_id": 70653438, "body": "All comments removed as they were getting noisy and veering into antagonistic territory. If there is anything that still needs clarifying repost your comment but <b>be civil</b>"}, {"owner": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "edited": false, "score": 1, "creation_date": 1484773869, "post_id": 41728910, "comment_id": 70653456, "body": "Hopefully this will be reopened soon, but what you want is called a &quot;superaccumulator&quot;. Some relevant code and references are here: <a href=\"https://github.com/aseldawy/sumn\" rel=\"nofollow noreferrer\">github.com/aseldawy/sumn</a>"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 4, "creation_date": 1484773883, "post_id": 41728910, "comment_id": 70653463, "body": "If there is additional information that can be added to this question to make it clear that it is not a duplicate, please edit it into the question."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484773955, "post_id": 41728910, "comment_id": 70653505, "body": "This question does not require any additional information. I could provide additional information as soon as it is agreed that it is not required but just helpful."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 1, "creation_date": 1484774025, "post_id": 41728910, "comment_id": 70653536, "body": "@EOF The accepted solution for this is to use Kahan&#39;s Summation. That&#39;s spelled out in one of the answers to: <a href=\"http://stackoverflow.com/q/6699066/2642059\">stackoverflow.com/q/6699066/2642059</a>"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 4, "creation_date": 1484774170, "post_id": 41728910, "comment_id": 70653620, "body": "@szpanczyk any clarifying comments you made earlier are now lost, which is why I ask you to edit the question. And a question can be considered duplicate if the answers to that question answer yours as well."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484774268, "post_id": 41728910, "comment_id": 70653663, "body": "And I can clarify the question, sure, but all my clarifying was actually informing that what should have been assumed as default was indeed what I meant.  For example, if I did not provide information on limited range of values in the question, there is no reason to assume this information is missing. It&#39;s obvious, that there is no limited range and all values are possible."}, {"owner": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484774292, "post_id": 41728910, "comment_id": 70653668, "body": "@JonathanMee Kahan summation, while more accurate, still isn&#39;t exact. e.g. try adding <code>1e40</code>, <code>1e20</code> and <code>1.0</code>"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484774304, "post_id": 41728910, "comment_id": 70653676, "body": "As for inifinites and nans, those are specific values which as such do not pose problem for any solution, because they can be checked for in constant time per variable."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "edited": false, "score": 2, "creation_date": 1484774392, "post_id": 41728910, "comment_id": 70653712, "body": "@SimonByrne I&#39;m just saying that it&#39;s the accepted solution for this problem. If we needed an exact solution we wouldn&#39;t be using floating point numbers in the first place."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484774435, "post_id": 41728910, "comment_id": 70653733, "body": "I may have made a mistake somewhere in the question, forgotten about something or made something unclear, but nobody as of yet has pointed me to such mistake that I would accept as mistake. If I was politely asked to clarify anything that doesn&#39;t necessarily  require clarifying, I would have just done it without hesitation. But I wasn&#39;t, I was told that my question is missing some information and generally is a bad question. Which it is not."}, {"owner": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484774553, "post_id": 41728910, "comment_id": 70653798, "body": "@JonathanMee there are perfectly valid reasons for wanting exact sums of floating point numbers. e.g. computational geometry"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484774582, "post_id": 41728910, "comment_id": 70653818, "body": "I have already said both: I assume the values are exact because such are the constraints of my problem. Why? There may be various reasons, one of which is to provide reliable comparison that does not depend on ordering of values.   This is a good reason for this question, but I don&#39;t think that every question must have it&#39;s reason stated explicitly. If a question is good and could have been asked for various reasons, why would You need particular one stated?  I think I have had enough. It just can&#39;t be reasoned in some circumstances and my time is probably better spent elsewhere."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484774786, "post_id": 41728910, "comment_id": 70653905, "body": "Assume this comparison is to be performed in many, many environments. One of which is a C++ implementation of some service. Reliable is the keyword here - I want for those two sets of data to have the exact same result of comparison everywhere. So I have to establish a standard on what should be the right answer, that is perfectly precise. It doesn&#39;t matter that precision was lost upon storing data in this format. It&#39;s irrelevant."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "edited": false, "score": 0, "creation_date": 1484774797, "post_id": 41728910, "comment_id": 70653909, "body": "@SimonByrne You&#39;re saying that there is a need for an exact solution using floating point numbers o.O Floating point numbers are inherently inexact? Is there an alternative to Kahan&#39;s Summation that you&#39;re proposing, cause if so, you&#39;ve snagged my interest."}, {"owner": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 2, "creation_date": 1484775033, "post_id": 41728910, "comment_id": 70654032, "body": "@JonathanMee Floating point numbers themselves are exact, it&#39;s the operations with them (arithmetic, conversion to/from decimal) that are inexact. As I mentioned in a comment above, there are algorithms called superaccumulators which can be used to compute exact sums."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484775338, "post_id": 41728910, "comment_id": 70654194, "body": "Let me say that I think this question is a duplicate of: <a href=\"http://stackoverflow.com/q/6699066/2642059\">stackoverflow.com/q/6699066/2642059</a> but other than that I&#39;ve read through <a href=\"http://stackoverflow.com/help/how-to-ask\">the asking guidelines</a> and the only point that I&#39;m seeing this answer failing on is the &quot;Help Others Reproduce the Problem&quot; section."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484775363, "post_id": 41728910, "comment_id": 70654205, "body": "And this section is not universally relevant too."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484775452, "post_id": 41728910, "comment_id": 70654255, "body": "I mean, I can provide code that shows how order of addition changes result of comparison, but do I really need to? Isn&#39;t that a little bit too obvious for those that may be interested in the problem?"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484775466, "post_id": 41728910, "comment_id": 70654268, "body": "@szpanczyk In my proud opinion an example would have been beneficial to the question. (Though I wouldn&#39;t go add it at this point.)"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484775557, "post_id": 41728910, "comment_id": 70654316, "body": "Yeah it could have been helpful. Now, why would it be? In my opinion not because it is needed for the merit discussion. Just because if there was an example provided, it would help the odds. Because after asking a couple of questions recently, I really think this is a matter of chance. If You happen to be well understood, Your question will be upvoted. If You&#39;re misunderstood, there&#39;s just no reasoning with downvoters."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484775576, "post_id": 41728910, "comment_id": 70654326, "body": "One of my questions was downvoted for lack of my code too."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484775676, "post_id": 41728910, "comment_id": 70654380, "body": "<a href=\"http://stackoverflow.com/questions/41660299/using-objects-of-two-or-more-data-types-as-key-for-c-map-oop\" title=\"using objects of two or more data types as key for c map oop\">stackoverflow.com/questions/41660299/&hellip;</a>  they told me to provide mcv example. Of what? This kind of thing is useful if there is a dissonance between understanding and observed phenomena, I thought my code would work, it doesn&#39;t. My question was not of the kind, yet two people commented I should provide minimal example of my own code. It seems some people on this website are really not helpful."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "edited": false, "score": 0, "creation_date": 1484775724, "post_id": 41728910, "comment_id": 70654405, "body": "@SimonByrne So my understanding of superaccumulators was just that you&#39;d use multiple accumulators where Kahan&#39;s summation only uses one. Is that accurate?"}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 2, "creation_date": 1484775762, "post_id": 41728910, "comment_id": 70654421, "body": "This post may have suffered because no explicit question was ever asked.  This site has a history of dismissing &quot;questions&quot; that just describe a program that someone should write."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484775856, "post_id": 41728910, "comment_id": 70654463, "body": "My next question is dedicated to you personally - please, tell me how did you become a telepath."}, {"owner": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 1, "creation_date": 1484775959, "post_id": 41728910, "comment_id": 70654517, "body": "@JonathanMee Yes, that&#39;s more or less the idea (though I would say that Kahan summation uses 2 accumulators)."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 1, "creation_date": 1484776034, "post_id": 41728910, "comment_id": 70654556, "body": "@szpanczyk don&#39;t get upset on my account.  That&#39;s not my goal."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484776111, "post_id": 41728910, "comment_id": 70654597, "body": "@szpanczyk I glanced at your linked question you have an answer from <a href=\"http://stackoverflow.com/users/335858/dasblinkenlight\">dasblinkenlight</a> who is one of the brightest minds on here. I share your frustration with asking <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a> questions though. That tag is commonly known as the shark-tank. It just has a lot of negativity. Ultimately I resolved my thoughts in the meta here: <a href=\"http://stackoverflow.com/users/335858/dasblinkenlight\">stackoverflow.com/users/335858/dasblinkenlight</a> I hope you find this encouraging."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484776218, "post_id": 41728910, "comment_id": 70654643, "body": "I don&#39;t know what&#39;s you goal. I am upset because this whole situation was very frustrating for me. This is a valid question and I am not yet convinced Kahan summation solves the problem the way I need. I feel I was treated unjustly, I am still sure there is nothing wrong with my question (maybe it could be better, but it&#39;s good already), it was asked with best intentions and after all that all that was missing in this discussion was accusing me of laziness and wanting others to provide me with a working program. What You wrote was inconsiderate and not thoughtful at all. That&#39;s why I am upset."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "edited": false, "score": 0, "creation_date": 1484776244, "post_id": 41728910, "comment_id": 70654651, "body": "@SimonByrne Yeah, I hadn&#39;t considered the idea of using more accumulators, but thanks to you I started reading through a paper on accumulator distribution. It&#39;s quite an interesting topic. Thanks for the tip!"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484776331, "post_id": 41728910, "comment_id": 70654692, "body": "The answer on that question was good. I really like this website. It&#39;s just annoying when someone declares there si something wrong with your question and does not have to prove it. I know the mechanism. People with certain amount of points get to close questions. It would be nice if they did not act like despotic monarchs, but rather restrain themselves to the role of judges."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484776411, "post_id": 41728910, "comment_id": 70654737, "body": "@szpanczyk My apologies. I&#39;d encourage you to spend more time with Kahan&#39;s Summation, if you feel like that doesn&#39;t totally solve your problem I&#39;d encourage you to ask a follow up question on it. (If you place a link here I&#39;d be happy to come assist.)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484780889, "post_id": 41728910, "comment_id": 70656466, "body": "&quot;which set has larger sum&quot; --&gt; This can be converted into another problem.  By negating each element of the 2nd group and simply adding the 2 groups together, all we need to do is find if the sum if + or - or 0.  The <a href=\"https://en.wikipedia.org/wiki/Kahan_summation_algorithm\" rel=\"nofollow noreferrer\">Kahan summation</a> is similar, yet we do not need to know the sum, just the sign of the sum.  Now how to precisely add and maintain the sign ...."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484784890, "post_id": 41728910, "comment_id": 70657713, "body": "@chux I have been thinking about it, and I think this still is non-trivial. Does this address the issue of intermediate result overflowing?"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1484784915, "post_id": 41728910, "comment_id": 70657720, "body": "@MarkRansom what resulted in the question being reopened?"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1484785658, "post_id": 41728910, "comment_id": 70657925, "body": "It takes a vote, and evidently enough people thought the question was worthwhile. As far as keeping it open, I&#39;d put as much detail and supporting information into the question as you can. For example, in a comment that was deleted you had the reason why you needed the comparison to be stable. If the duplicates you&#39;ve seen don&#39;t solve your problem, mention why."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484785775, "post_id": 41728910, "comment_id": 70657945, "body": "I&#39;ll do whatever I decide to do. Thanks."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484794938, "post_id": 41728910, "comment_id": 70660252, "body": "And I have decided to create a rewrite to use the opportunity that question reopening has given to show with superfluous content how this was a proper question from the beginning. Everything I mentioned, people of good will would have been either able to correctly assume as obvious (fe. in absence of range limit for values, it&#39;s obvious all values are to be expected, including NaNs and infs whose presence is nevertheless irrelevant.)."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484795082, "post_id": 41728910, "comment_id": 70660290, "body": "Whatever clarification would&#39;ve been asked for with respect to common courtesy and with recognition of the fact that problem was already defined well enough, would&#39;ve been gladly given and probably edited into the text of question. But if somebody judges and acts rather than ask first to give someone benefit of doubt, that&#39;s a different case completely."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484828181, "post_id": 41728910, "comment_id": 70675807, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/6699066/in-which-order-should-floats-be-added-to-get-the-most-precise-result\">In which order should floats be added to get the most precise result?</a>"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484836948, "post_id": 41728910, "comment_id": 70681759, "body": "@JonathanMee do you genuinely don&#39;t understand the difference between minimizing error and obtaining perfect answer in a well defined bool function?"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484837451, "post_id": 41728910, "comment_id": 70682162, "body": "@szpanczyk As I mention in my answer: You will not obtain a perfect answer with a floating point number. Does that answer your question? I may have misunderstood what you&#39;re asking."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484837978, "post_id": 41728910, "comment_id": 70682590, "body": "Yes, You did misunderstand it. I tried to explain that since yesterday, this is one of the reasons why I&#39;m so frustrated and fed up. I can&#39;t help You anymore, I&#39;ve put more than a fair share of effort and now all I can say is - read the question once again perhaps."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484838152, "post_id": 41728910, "comment_id": 70682740, "body": "Compare my self posted answer."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484838396, "post_id": 41728910, "comment_id": 70682920, "body": "&quot;While for some the idea that it may be useful exercise seems controversial at best, consider the following scenario: comparison between those value sets could be a cornerstone of other operations performed on entire datasets independently in various environments. Synchronized, flawless operation of some systems may depend on this comparison being well defined and deterministically implemented, irregardless of addends order and particular architecture implementing IEEE754 or not.  This, or just curiosity.&quot;"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484838568, "post_id": 41728910, "comment_id": 70683039, "body": "Perhaps we&#39;re in a setting where we take responsibility for results of this comparison, and we&#39;re not supposed to make any assumptions about acceptable approximation. We&#39;re given data in this form from the outside and we&#39;re doing whatever we&#39;re doing, but have to treat every value as equal exactly what it represents in IEEE754.  As was earlier stated - values are exactly what they are, it&#39;s the operations that are approximate. I don&#39;t have a problem with operations yielding 1000.0 when the correct answer would be 0.001. All I care about is the sign. It has to be perfectly correct."}], "answers": [{"comments": [{"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484828260, "post_id": 41741276, "comment_id": 70675858, "body": "Incidentally you can find pseudo-code for Kahan&#39;s Summation here: <a href=\"https://en.wikipedia.org/wiki/Kahan_summation_algorithm\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Kahan_summation_algorithm</a>"}], "tags": [], "owner": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "is_accepted": false, "score": 6, "last_activity_date": 1484827155, "creation_date": 1484827155, "answer_id": 41741276, "question_id": 41728910, "link": "https://stackoverflow.com/questions/41728910/comparing-two-sums-of-floating-point-values-in-c-or-c/41741276#41741276", "title": "comparing two sums of floating point values in C or C++", "body": "<p>One possible approach is to compute the sum using a <em>superaccumulator</em>: this is an algorithm for computing exact sums of floating point numbers. Although these ideas have been around for a while, the term is a relatively new one.</p>\n\n<p>In some sense, you can think of it as an extension of Kahan summation, where the sequential sum is stored as an array of values, rather than just a pair. The main challenge then becomes figuring out how to allocate the precision amongst the various values.</p>\n\n<p>Some relevant papers and code:</p>\n\n<ul>\n<li><p>Y. K. Zhu and W. B. Hayes. \"Algorithm 908: Online Exact Summation of Floating-Point Streams\". <em>ACM Transactions on Mathematical Software</em> (ACM TOMS), 37(3):37:1-37:13, September 2010. doi: <a href=\"http://dx.doi.org/10.1145/1824801.1824815\">10.1145/1824801.1824815</a></p>\n\n<ul>\n<li>Unfortunately the paper and code are behind a paywall, but this appears to be <a href=\"https://github.com/aseldawy/sumn/tree/master/908\">the C++ code</a>.</li>\n</ul></li>\n<li><p>R. M. Neal, \"Fast Exact Summation using Small and Large Superaccumulators\". 2015. arXiv: <a href=\"https://arxiv.org/abs/1505.05571\">1505.05571</a></p>\n\n<ul>\n<li><a href=\"https://arxiv.org/src/1505.05571v1\">C code available</a></li>\n</ul></li>\n<li><p>M. T. Goodrich, A. Eldawy \"Parallel Algorithms for Summing Floating-Point Numbers\". 2016. arXiv: <a href=\"https://arxiv.org/abs/1605.05436\">1605.05436</a></p>\n\n<ul>\n<li><a href=\"https://github.com/aseldawy/sumn\">Java code of this and the above</a></li>\n</ul></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484836776, "post_id": 41743731, "comment_id": 70681635, "body": "You&#39;re kind of saying that because what I need to do is costly, I should do something else."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484837732, "post_id": 41743731, "comment_id": 70682387, "body": "@szpanczyk More specifically I&#39;m saying that pouring massive computation into finding the exact number but using floating point numbers to evaluate is wasted effort. It&#39;s like measuring a cut to the picometer, then making the cut with a chainsaw. Measuring to the millimeter is more than sufficient. Since you can&#39;t represent that level of precision with your tool."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484837907, "post_id": 41743731, "comment_id": 70682538, "body": "The point where you&#39;re mistaken is the order of operations. What if you&#39;re making the cut with a chainsaw, and then measuring it to the milimeter? Anyway, rationale for this question was presented in revised version, you&#39;re free to ignore that."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484838096, "post_id": 41743731, "comment_id": 70682685, "body": "@szpanczyk Clearly I&#39;ve misunderstood something. I read through the question and thought that I was answering it? Perhaps you can elaborate on your order of operations statement?"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484838750, "post_id": 41743731, "comment_id": 70683175, "body": "&quot;While for some the idea that it may be useful exercise seems controversial at best, consider the following scenario: comparison between those value sets could be a cornerstone of other operations performed on entire datasets independently in various environments. Synchronized, flawless operation of some systems may depend on this comparison being well defined and deterministically implemented, irregardless of addends order and particular architecture implementing IEEE754 or not. This, or just curiosity.&quot;"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484838760, "post_id": 41743731, "comment_id": 70683184, "body": "Perhaps we&#39;re in a setting where we take responsibility for results of this comparison, and we&#39;re not supposed to make any assumptions about acceptable approximation. We&#39;re given data in this form from the outside and we&#39;re doing whatever we&#39;re doing, but have to treat every value as equal exactly what it represents in IEEE754. As was earlier stated - values are exactly what they are, it&#39;s the operations that are approximate. I don&#39;t have a problem with operations yielding 1000.0 when the correct answer would be 0.001. All I care about is the sign. It has to be perfectly correct."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484839646, "post_id": 41743731, "comment_id": 70683858, "body": "@szpanczyk The result of the total comparison will always be inexact, there&#39;s no escaping it while using floating point numbers. Whether you&#39;re summing both sets and comparing results or finding the difference between each pair from the sets then summing those differences, you must perform operations which will give you inexact results, this inexactness may well cause a change in the final sign as well. Summing both sets with Kahan&#39;s and comparing the results is as about as good as you can do."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484839703, "post_id": 41743731, "comment_id": 70683902, "body": "Compare to my answer. You&#39;re assuming constraints that just aren&#39;t there in the question."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484840494, "post_id": 41743731, "comment_id": 70684485, "body": "@szpanczyk Fixed point is an option. It will give you exact results. I&#39;d encourage you to attempt implementation though. You won&#39;t be able to use a <code>bitset</code> as you&#39;ve suggested. <code>vector&lt;bool&gt;</code> will work. If you can demonstrate functionality rather than just hand waving I&#39;d be thrilled to offer your answer a +1."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484842417, "post_id": 41743731, "comment_id": 70685825, "body": "I am only interested in alternatives to my concept, not in points. If my answer was the best answer to my own question, that would leave me dissatisfied."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 1, "creation_date": 1484843069, "post_id": 41743731, "comment_id": 70686280, "body": "@szpanczyk If you&#39;re saying input floating point numbers are perfectly accurate already and you must preserve perfect accuracy, the only way to do that is fixed point math, exactly as you have suggested. If you&#39;re interested you will probably find Dr. Dobb&#39;s article on fixed point helpful: <a href=\"http://www.drdobbs.com/cpp/fixed-point-arithmetic-types-for-c/184401992?pgno=1\" rel=\"nofollow noreferrer\">drdobbs.com/cpp/fixed-point-arithmetic-types-for-c/&hellip;</a>"}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484843400, "post_id": 41743731, "comment_id": 70686507, "body": "I do not need perfect accuracy. I use perfect accuracy to perform comparison to zero with certainty. However since I am comparing to a very specific value, which zero is, perhaps there is room for alternative approaches."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484846391, "post_id": 41743731, "comment_id": 70688334, "body": "@szpanczyk and Jonathan, the key consideration here is that this is not about calculating a single sum, it&#39;s about the <i>difference</i> between <i>two</i> sums. It took me a while yesterday to grasp the distinction. Obviously one approach is to calculate both sums perfectly, but there might be other approaches as well."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484853057, "post_id": 41743731, "comment_id": 70691950, "body": "If the general direction to take is to calculate sum, any error is acceptable as long, as it can be proven the sign is correct."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1484863294, "post_id": 41743731, "comment_id": 70697562, "body": "Respected @MarkRansom, that&#39;s an interesting perspective.  But I think a generic solution would <i>have to</i> be able to calculate a single perfect sum.  If one of the two sets contained only the number <code>0.0</code>, then the solution would need to observe the perfect sum of the other set.  No?"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 1, "creation_date": 1484867022, "post_id": 41743731, "comment_id": 70699158, "body": "@DrewDormann no, not true. If you could prove that the error for a positive sum would always be positive, and the error for a negative sum would always be negative, it would still work with your example. (I&#39;m not claiming such an algorithm exists, just that I don&#39;t dismiss it out of hand)."}], "tags": [], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "is_accepted": false, "score": 0, "last_activity_date": 1484834722, "creation_date": 1484834722, "answer_id": 41743731, "question_id": 41728910, "link": "https://stackoverflow.com/questions/41728910/comparing-two-sums-of-floating-point-values-in-c-or-c/41743731#41743731", "title": "comparing two sums of floating point values in C or C++", "body": "<p>The floating point number resulting from the summation of 2 floating point numbers is only an <em>approximation</em>. Given <em>i<sub>1</sub></em> and <em>i<sub>2</sub></em> to sum we can find an <em>approximation</em> of the error in floating point summation by doing this:</p>\n\n<p><em>i<sub>1</sub></em> + <em>i<sub>2</sub></em> = <em>i<sub>12</sub></em><br>\n<em>i<sub>12</sub></em> - <em>i<sub>2</sub></em> = <em>i<sub>~1</sub></em><br>\n<em>i<sub>1</sub></em> - <em>i<sub>~1</sub></em> = <em>i<sub>\u0394</sub></em></p>\n\n<p>The closest <em>approximation</em> we could come up with for the summation of <em>n</em> numbers would be the to calculate the error for the <em>n</em> - <em>1</em> addition operations, then to sum those <em>n</em> - <em>1</em> errors again taking the <em>n</em> - <em>2</em>. And you'll repeat this process <em>n</em> - <em>2</em> times or until all the errors have gone to 0.0</p>\n\n<p>There are a couple things that could be done to drive the error calculations to 0.0 faster:</p>\n\n<ol>\n<li>Use a larger floating point type, for example <code>long double</code></li>\n<li>Sort the list prior to summing so that you're adding small numbers to small numbers and large numbers to large numbers</li>\n</ol>\n\n<p>Now you can make an assessment of how important accuracy is to you. I will tell you that in the general case the computational expense of the above operation is outrageous considering the result you get will <em>still be an approximation</em>.</p>\n\n<p>The generally accepted solution is <a href=\"https://en.wikipedia.org/wiki/Kahan_summation_algorithm\" rel=\"nofollow noreferrer\">Kahan's Summation</a> it's a happy marriage between speed and precision. Rather than holding the error to the end of the summation Kahan will roll it into each addition, preventing it's value from escalating outside the hghest precision floating point range. Say that we're given <code>vector&lt;long double&gt; i1</code> we could run Kahan's Summation on it as follows:</p>\n\n<pre><code>auto c = 0.0L;\nconst auto sum = accumulate(next(cbegin(i1)), cend(i1), i1.front(), [&amp;](const auto&amp; sum, const auto&amp; input) {\n    const auto y = input - c;\n    const auto t = sum + y;\n\n    c = t - sum - y;\n    return t;\n} ) - c;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1484840291, "last_edit_date": 1484840291, "creation_date": 1484838125, "answer_id": 41745019, "question_id": 41728910, "link": "https://stackoverflow.com/questions/41728910/comparing-two-sums-of-floating-point-values-in-c-or-c/41745019#41745019", "title": "comparing two sums of floating point values in C or C++", "body": "<p>One of the possibilities to perform this comparison with certainty is to create a class for fixed point arithmetic of precision equal to the types in use and without limit on absolute value.</p>\n\n<p>It could be a class implementing following public methods:</p>\n\n<pre><code>    FixedPoint(double d);\n    ~FixedPoint();\n\n    FixedPoint operator+(const FixedPoint&amp; rhs);\n    FixedPoint operator-(const FixedPoint&amp; rhs);\n    bool isPositive();\n</code></pre>\n\n<p>(Every supported floating point type needs separate constructor.)</p>\n\n<p>Depending upon circumstances implementation would require a collection of <code>bool</code> of fixed, decided upon construction or dynamic size; possibly <code>std::bitset</code>, <code>vector&lt;bool&gt;</code> or static or dynamic <code>bool</code> array.</p>\n\n<p>For ease of implementation I would suggest implementing the 2's complement encoding.</p>\n\n<p><em>This is an obvious and very costly solution, that would hurt performance if this comparison was core of some system. Hopefully there is a better solution.</em></p>\n"}, {"comments": [{"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484850912, "post_id": 41748978, "comment_id": 70690809, "body": "Thank You for an on point answer. <code>c</code> tag was removed by someone else, as part of the whole know-it-all-better deal that took place."}, {"owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 1, "creation_date": 1484851054, "post_id": 41748978, "comment_id": 70690893, "body": "It seems this answer is much better than mine, in terms of performance. I&#39;ll wait some more to see if other answers emerge."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "edited": false, "score": 0, "creation_date": 1484988452, "post_id": 41748978, "comment_id": 70745557, "body": "Differences between <a href=\"http://stackoverflow.com/a/41748978/2410359\">this</a> and <a href=\"http://stackoverflow.com/a/41741276/2410359\">that</a> are 1) explicit precision requirements of <code>log2(FLT_MAX) - log2(FLT_TRUE_MIN) + log2(SIZE_MAX)</code> vs. a TBD <code>log2(superaccumulator)</code>  2) efficiency of having the array <code>sums[]</code> vs. one very <i>wide superaccumulator</i> and 3) reality vs. conceptual."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1484850433, "last_edit_date": 1484850433, "creation_date": 1484850021, "answer_id": 41748978, "question_id": 41728910, "link": "https://stackoverflow.com/questions/41728910/comparing-two-sums-of-floating-point-values-in-c-or-c/41748978#41748978", "title": "comparing two sums of floating point values in C or C++", "body": "<p>Post was originally also a C one and so my code applies to that.<br>\nI now see post is C++ only, yet I see little in the following that would not readily apply to C++.</p>\n\n<p><strong>Simplify to finding the sign of the sum of a list of FP numbers</strong></p>\n\n<p>Comparing 2 sets of numbers is like appending the negation of the second set to the first and then finding the sign of the sum of the joint list.  This sign maps to <code>&gt;</code>, <code>==</code> or <code>&lt;</code> of the 2 original sets.</p>\n\n<p><strong>Perform only exact FP math</strong></p>\n\n<p><em>Assumption</em>: FP employs IEEE like numbers including sub-normals, base 2, and is exact for certain operations:</p>\n\n<ol>\n<li><p>Addition of <code>a +b</code> with the same binary exponent and differing sign.</p></li>\n<li><p>Subtraction of same sign 0.5 from a number in the <code>0.5 &lt;= |x| &lt; 1.0</code> range.</p></li>\n<li><p><code>ldexp*()</code> (break number into significant and exponent parts) function returns an exact value.</p></li>\n</ol>\n\n<p><strong>Form array per exponent</strong></p>\n\n<p>Form an array of sums <code>sums[]</code> whose values will only ever be <code>(0 or 0.5 &lt;= |sums[i]| &lt; 1.0)</code>, one for each possible exponent and for some exponents larger than the max.  The larger ones are needed to accumulate a <code>|total_sum|</code> that exceeds <code>FP_MAX</code>.  This needs up to <code>log2(SIZE_MAX)</code> more elements.</p>\n\n<p><strong>Add the set of numbers to <code>sums[]</code></strong></p>\n\n<p>For each element of the number set, add it to the corresponding <code>sums[]</code> per its binary exponent.    This is key as addition of same sign and differing sign FP numbers with a common FP binary exponent can be done <em>exactly</em>.  The addition may result in a carry with same sign values and cancellation with differing sign values - this is handled. The incoming set of numbers need not be sorted. </p>\n\n<p><strong>Normalize <code>sum[]</code></strong></p>\n\n<p>For each element on <code>ones[]</code>, insure any values not 0.5, 0.0 or -0.5 is reduced, the remaining portion added to smaller  <code>ones[]</code>.</p>\n\n<p><strong>Inspect <code>sum[]</code> for the most significant digit</strong></p>\n\n<p>The most significant (non-zero) <code>one[s]</code> is the sign of the result.</p>\n\n<hr>\n\n<p>The below code performs the task using <code>float</code> as the set's FP type.  Some parallel calculations are done using <code>double</code> to check for sanity, but do not contribute to the <code>float</code> calculation.</p>\n\n<p>The normalizing step in the end iterates typically twice.  Even a worst case set, I suspect would iterate the binary width of the <code>float</code> signicand, about 23 times.</p>\n\n<p>The solution appears to be about <code>O(n)</code>, but does use an array about the size of the FP's exponent range.</p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;float.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\n#if RAND_MAX/2 &gt;= 0x7FFFFFFFFFFFFFFF\n#define LOOP_COUNT 1\n#elif RAND_MAX/2 &gt;= 0x7FFFFFFF\n#define LOOP_COUNT 2\n#elif RAND_MAX/2 &gt;= 0x1FFFFFF\n#define LOOP_COUNT 3\n#elif RAND_MAX/2 &gt;= 0xFFFF\n#define LOOP_COUNT 4\n#else\n#define LOOP_COUNT 5\n#endif\n\nuint64_t rand_uint64(void) {\n  uint64_t r = 0;\n  for (int i = LOOP_COUNT; i &gt; 0; i--) {\n    r = r * (RAND_MAX + (uint64_t) 1u) + ((unsigned) rand());\n  }\n  return r;\n}\n\ntypedef float fp1;\ntypedef double fp2;\n\nfp1 rand_fp1(void) {\n  union {\n    fp1 f;\n    uint64_t u64;\n  } u;\n  do {\n    u.u64 = rand_uint64();\n  } while (!isfinite(u.f));\n  return u.f;\n}\n\nint pre = DBL_DECIMAL_DIG - 1;\n\n\nvoid exact_add(fp1 *sums, fp1 x, int expo);\n\n// Add x to sums[expo]\n// 0.5 &lt;= |x| &lt; 1\n// both same sign.\nvoid exact_fract_add(fp1 *sums, fp1 x, int expo) {\n  assert(fabsf(x) &gt;= 0.5 &amp;&amp; fabsf(x) &lt; 1.0);\n  assert(fabsf(sums[expo]) &gt;= 0.5 &amp;&amp; fabsf(sums[expo]) &lt; 1.0);\n  assert((sums[expo] &gt; 0.0) == ( x &gt; 0.0));\n\n  fp1 half = x &gt; 0.0 ? 0.5 : -0.5;\n  fp1 sum = (sums[expo] - half) + (x - half);\n  if (fabsf(sum) &gt;= 0.5) {\n    assert(fabsf(sums[expo]) &lt; 1.0);\n    sums[expo] = sum;\n  } else  {\n    sums[expo] = 0.0;\n    if (sum) exact_add(sums, sum, expo);\n  }\n  exact_add(sums, half, expo+1);  // carry\n}\n\n// Add  x to sums[expo]\n// 0.5 &lt;= |x| &lt; 1\n// differing sign\nvoid exact_fract_sub(fp1 *sums, fp1 x, int expo) {\n  if(!(fabsf(x) &gt;= 0.5 &amp;&amp; fabsf(x) &lt; 1.0)) {\n    printf(\"%d %e\\n\", __LINE__, x);\n    exit(-1);\n  }\n  assert(fabsf(x) &gt;= 0.5 &amp;&amp; fabsf(x) &lt; 1.0);\n  assert((sums[expo] &gt; 0.0) != ( x &gt; 0.0));\n  fp1 dif = sums[expo] + x;\n  sums[expo] = 0.0;\n  exact_add(sums, dif, expo);\n}\n\n// Add x to sums[]\nvoid exact_add(fp1 *sums, fp1 x, int expo) {\n  if (x == 0) return;\n  assert (x &gt;= -FLT_MAX &amp;&amp; x &lt;= FLT_MAX);\n  //while (fabsf(x) &gt;= 1.0) { x /= 2.0; expo++; }\n  while (fabsf(x) &lt; 0.5) { x *= (fp1)2.0; expo--; }\n  assert(fabsf(x) &gt;= 0.5 &amp;&amp; fabsf(x) &lt; 1.0);\n\n  if (sums[expo] == 0.0) {\n    sums[expo] = x;\n    return;\n  }\n  if(!(fabsf(sums[expo]) &gt;= 0.5 &amp;&amp; fabsf(sums[expo]) &lt; 1.0)) {\n    printf(\"%e\\n\", sums[expo]);\n    printf(\"%d %e\\n\", expo, x);\n    exit(-1);\n  }\n  assert(fabsf(sums[expo]) &gt;= 0.5 &amp;&amp; fabsf(sums[expo]) &lt; 1.0);\n  if ((sums[expo] &gt; 0.0) == (x &gt; 0.0)) {\n    exact_fract_add(sums, x, expo);\n  } else {\n    exact_fract_sub(sums, x, expo);\n  }\n}\n\nvoid exact_add_general(fp1 *sums, fp1 x) {\n  if (x == 0) return;\n  assert (x &gt;= -FLT_MAX &amp;&amp; x &lt;= FLT_MAX);\n  int expo;\n  x = frexpf(x, &amp;expo);\n  exact_add(sums, x, expo);\n}\n\nvoid sum_of_sums(const char *s, const fp1 *sums, int expo_min, int expo_max) {\n  fp1 sum1 = 0.0;\n  fp2 sum2 = 0.0;\n  int step = expo_max &gt;= expo_min ? 1 : -1;\n  for (int expo = expo_min; expo/step &lt;= expo_max/step; expo += step) {\n    sum1 += ldexpf(sums[expo], expo);\n    sum2 += ldexp(sums[expo], expo);\n  }\n  printf(\"%-20s = %+.*e %+.*e\\n\", s, pre, sum2, pre, sum1);\n}\n\n\nint test_sum(size_t N) {\n  fp1 a[N];\n  fp1 sum1 = 0.0;\n  fp2 sum2 = 0.0;\n  for (size_t i = 0; i &lt; N; i++) {\n    a[i] = (fp1) rand_fp1();\n    sum1 += a[i];\n    sum2 += a[i];\n  }\n  printf(\"%-20s = %+.*e %+.*e\\n\", \"initial  sums\", pre, sum2, pre, sum1);\n\n  int expo_min;\n  int expo_max;\n  frexpf(FLT_TRUE_MIN, &amp;expo_min);\n  frexpf(FLT_MAX, &amp;expo_max);\n  size_t ln2_size = SIZE_MAX;\n  while (ln2_size &gt; 0) {\n    ln2_size &gt;&gt;= 1;\n    expo_max++;\n  };\n  fp1 sum_memory[expo_max - expo_min + 1];\n  memset(sum_memory, 0, sizeof sum_memory);  // set to 0.0 cheat\n  fp1 *sums = &amp;sum_memory[-expo_min];\n\n  for (size_t i = 0; i&lt;N; i++)  {\n    exact_add_general(sums, a[i]);\n  }\n  sum_of_sums(\"post add  sums\", sums, expo_min,  expo_max);\n\n  // normalize\n  int done;\n  do {\n    done = 1;\n    for (int expo = expo_max; expo &gt;= expo_min; expo--) {\n      fp1 x = sums[expo];\n      if ((x &lt; -0.5) || (x &gt; 0.5)) {\n        //printf(\"xxx %4d %+.*e \", expo, 2, x);\n        done = 0;\n        if (x &gt; 0.0) {\n          sums[expo] = 0.5;\n          exact_add(sums, x - (fp1)0.5, expo);\n        } else {\n          sums[expo] = -0.5;\n          exact_add(sums, x - -(fp1)0.5, expo);\n        }\n      }\n    }\n    sum_of_sums(\"end  sums\", sums, expo_min,  expo_max);\n  } while (!done);\n\n  for (int expo = expo_max; expo &gt;= expo_min; expo--) {\n    if (sums[expo]) {\n      return (sums[expo] &gt; 0.5) ? 1 : -1;\n    }\n  }\n  return 0;\n}\n\n#define ITERATIONS 10000\n#define MAX_NUMBERS_PER_SET 10000\nint main() {\n  unsigned seed = (unsigned) time(NULL);\n  seed = 0;\n  printf(\"seed = %u\\n\", seed);\n  srand(seed);\n\n  for (unsigned i = 0; i &lt; ITERATIONS; i++) {\n    int cmp = test_sum((size_t)rand() % MAX_NUMBERS_PER_SET + 1);\n    printf(\"Compare %d\\n\\n\", cmp);\n    if (cmp == 0) break;\n  }\n  printf(\"Success\");\n  return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Infinities and NaN can also be handled, to a degree, leave that for later.</p>\n"}], "owner": {"reputation": 486, "user_id": 7302586, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/add2c35e26541725f67515dbb8ccd67a?s=128&d=identicon&r=PG&f=1", "display_name": "szpanczyk", "link": "https://stackoverflow.com/users/7302586/szpanczyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1484851174, "creation_date": 1484771536, "last_edit_date": 1495540889, "question_id": 41728910, "link": "https://stackoverflow.com/questions/41728910/comparing-two-sums-of-floating-point-values-in-c-or-c", "title": "comparing two sums of floating point values in C or C++", "body": "<p>Assume You're given two sets of floating point variables implemented according to IEEE754, meant to be treated as exact values calculated according to formulae present in standard. All legal values are possible. The amount of variables in set may be any natural number.</p>\n\n<p>What would be a good way to compare exact, in mathematical sense, sums of values represented by said variables. Due to domain's nature, the problem can easily be represented as comparing a single sum to zero. You can disregard the possibility of presence of NaNs or Infinities, as it is irrelevant to core problem. (Those values can be checked for easily and independently, and acted upon in a manner suiting particular application of this problem.)</p>\n\n<p>A naive approach would be to simply sum and compare, or sum values of one set and subtract values of another.</p>\n\n<pre><code>    bool compare(const std::vector&lt;float&gt;&amp; lhs, const std::vector&lt;float&gt;&amp; rhs)\n    {\n        float lSum = 0.0f;\n        for (auto value : lhs)\n        {\n            lSum += value;\n        }\n        float rSum = 0.0f;\n        for (auto value : rhs)\n        {\n            rSum += value;\n        }\n\n        return lSum &lt; rSum;\n    }\n</code></pre>\n\n<p>Quite obviously there are problems with naive approach, as mentioned in various other questions regarding floating point arithmetic. Most of the problems are related to two difficulties:</p>\n\n<ul>\n<li>result of addition of floating point values differs depending on order</li>\n<li><p>certain orders of addition of certain sets of values may result in intermediate overflow (intermediate result of calculations goes beyond range supported by available data type)</p>\n\n<pre><code>float small = strtof(\"0x1.0p-126\", NULL);\nfloat big = strtof(\"0x1.8p126\", NULL);\n\nstd::cout &lt;&lt; std::hexfloat &lt;&lt; small + big - big &lt;&lt; std::endl;\nstd::cout &lt;&lt; std::hexfloat &lt;&lt; (big-2*small) + (big-small) + big - (big+small) - (big+2*small) &lt;&lt; std::endl;\n</code></pre>\n\n<p>This code will result in <code>0</code> and <code>inf</code>; this illustrates how ordering affects the result. Hopefully, also that the problem of ordering is non-trivial.</p>\n\n<pre><code>float prev;\nfloat curr = 0.0f;\n\ndo\n{\n    prev = curr;\n    curr += strtof(\"0x1.0p-126\", NULL);\n} while (prev != curr);\n\nstd::cout &lt;&lt; std::hexfloat &lt;&lt; curr &lt;&lt; std::endl;\n</code></pre></li>\n</ul>\n\n<p>This code, given sufficient time to actually finish computing, would result in <code>0x1.000000p-102</code>, not, as could be naively expected, <code>0x1.fffffep127</code> (Change of curr initialization to `strtof(\"0x1.fff000p-103\") would be advised to actually observe this.); this illustrates how proportion between intermediate results of addition and particular addends affects the result.</p>\n\n<p>A lot has been said about obtaining best precision, eg. <a href=\"https://stackoverflow.com/questions/6699066/in-which-order-should-floats-be-added-to-get-the-most-precise-result\">this question</a>.</p>\n\n<p>The problem at hand differs in that we do not want to maximize precision, but we have a well-defined function that needs to be implemented exactly.</p>\n\n<p>While for some the idea that it may be useful exercise seems controversial at best, consider the following scenario: comparison between those value sets could be a cornerstone of other operations performed on entire datasets independently in various environments. Synchronized, flawless operation of some systems may depend on this comparison being well defined and deterministically implemented, irregardless of addends order and particular architecture implementing IEEE754 or not. </p>\n\n<p>This, or just curiosity.</p>\n\n<p>In the discussion, <a href=\"https://en.wikipedia.org/wiki/Kahan_summation_algorithm\" rel=\"nofollow noreferrer\">Kahan summation algorithm</a> has been mentioned as relevant. However this algorithm is a reasonable attempt at minimizing error. It neither guarantees correct sign of result, nor is independent of the order of operations (to at least guarantee consistent, if wrong, result, for permutations of sets).</p>\n\n<p>One of the most obvious solutions would be to employ/implement fixed point arithmetic using sufficient amount of bits to represent every possible operand value exactly and keep exact intermediate result.</p>\n\n<p>Perhaps however this can be done using only floating point arithmetic in a manner that guarantees correct sign of result. If so, the problem of overflow (as illustrated in one of the examples above) needs to be addressed in solution, as this question has particular technical aspect.</p>\n\n<p>(What follows is original question.)</p>\n\n<p><em>I have two sets of multiple floating point (float or double) values. I want to provide a perfect answer to the question, which set has larger sum. Because of artifacts in floating point arithmetic, in some corner cases the result of naive approach may be wrong, depending on order of operations. Not to mention simple sum can result in overflow.\nI can't provide any effort on my side, because all I have is vague ideas, all of them complicated and not convincing.</em></p>\n"}, {"tags": ["c++", "string", "constructor"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1484771396, "post_id": 41728826, "comment_id": 70652115, "body": "<code>name (string fName, string mName, string sName)</code> -- It&#39;s not a good idea to name your parameters the same as your member variables.  That&#39;s probably why you thought that the constructor you wrote magically sets those member variables by matching the names -- nope, doesn&#39;t work that way."}, {"owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "edited": false, "score": 0, "creation_date": 1484772133, "post_id": 41728826, "comment_id": 70652473, "body": "In addition and offtopic you can use the operaror &lt;&lt; of your class in cout line: <code>cout&lt;&lt;myName&lt;&lt;endl;</code>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "is_accepted": true, "score": 3, "last_activity_date": 1484773189, "last_edit_date": 1484773189, "creation_date": 1484771283, "answer_id": 41728849, "question_id": 41728826, "link": "https://stackoverflow.com/questions/41728826/c-strings-not-working/41728849#41728849", "title": "C++ strings not working", "body": "<p>Your constructor:</p>\n\n<pre><code>    name (string fName, string mName, string sName){};\n</code></pre>\n\n<p>doesn't do anything. You need to use the parameters to initialise your member variables.</p>\n\n<pre><code>   name (string f, string m, string s)\n         : fName(f), mName(m), sName(s)  {}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 3638734, "user_type": "registered", "profile_image": "https://graph.facebook.com/1232067119/picture?type=large", "display_name": "Marvin001", "link": "https://stackoverflow.com/users/3638734/marvin001"}, "edited": false, "score": 0, "creation_date": 1484771389, "post_id": 41728854, "comment_id": 70652108, "body": "It works!! Thank you very much!!! :D"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1484771437, "post_id": 41728854, "comment_id": 70652136, "body": "Well, not actually &quot;assign&quot; in this case."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1484771730, "post_id": 41728854, "comment_id": 70652273, "body": "@latedeveloper it&#39;s assigning values to those variables, even if it&#39;s technically not using assignment to do so. The distinction is far too subtle for me to think about normally."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1484771991, "post_id": 41728854, "comment_id": 70652405, "body": "I think the distinction between initialisation and assignment is a pretty key concept for a C++ programmer."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1484772352, "post_id": 41728854, "comment_id": 70652596, "body": "@latedeveloper I agree that it&#39;s important to be <i>aware</i> of the difference, it&#39;s just that it doesn&#39;t often matter in practice. In this case the only difference is whether a default constructor gets called on each of the strings, which in the end doesn&#39;t matter to the outcome."}], "tags": [], "owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "is_accepted": false, "score": 1, "last_activity_date": 1484771313, "creation_date": 1484771313, "answer_id": 41728854, "question_id": 41728826, "link": "https://stackoverflow.com/questions/41728826/c-strings-not-working/41728854#41728854", "title": "C++ strings not working", "body": "<p>Your constructor must assign the parameters you pass to the member variables, that doesn't happen automatically.</p>\n\n<pre><code>name (string fName, string mName, string sName) : fName(fName), mName(mName), sName(sName) {};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1484771750, "last_edit_date": 1484771750, "creation_date": 1484771418, "answer_id": 41728875, "question_id": 41728826, "link": "https://stackoverflow.com/questions/41728826/c-strings-not-working/41728875#41728875", "title": "C++ strings not working", "body": "<p>You forgot to initialize daya members of the class in the constructor.</p>\n\n<p>Define the constructor the following way</p>\n\n<pre><code>name( const string &amp;fName, const string &amp;mName, const string &amp;sName )\n    : fName( fName ), mName( mName ), sName( sName )\n{\n}\n</code></pre>\n\n<p>Correspondingly these member functions should be defined like</p>\n\n<pre><code>    void setFName ( const string &amp;fName)\n    {\n        this-&gt;fName = fName;\n    }\n    void setMName (const string &amp;mName)\n    {\n        this-&gt;mName = mName;\n    }\n    void setSName (const string &amp;sName)\n    {\n        this-&gt;sName = sName;\n    }\n</code></pre>\n\n<p>There is no need to make the <code>operator &lt;&lt;</code> as a friend function of the class. It can be defined like</p>\n\n<pre><code>ostream&amp; operator &lt;&lt;( ostream&amp; os, const name&amp; n ) {\n    return os &lt;&lt; n.getFName() &lt;&lt; \" \" &lt;&lt; n.getMName() &lt;&lt; \" \" &lt;&lt; n.getSName();\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4735, "user_id": 5270744, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/kPNwH.jpg?s=128&g=1", "display_name": "m_callens", "link": "https://stackoverflow.com/users/5270744/m-callens"}, "edited": false, "score": 0, "creation_date": 1484771584, "post_id": 41728888, "comment_id": 70652200, "body": "@Slava if i remember currently, the outer value is assumed as class-level variables and not looked for locally (in the function/constructor/etc). Perhaps it is best to switch the names of the parameters to be safe..."}], "tags": [], "owner": {"reputation": 4735, "user_id": 5270744, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/kPNwH.jpg?s=128&g=1", "display_name": "m_callens", "link": "https://stackoverflow.com/users/5270744/m-callens"}, "is_accepted": false, "score": 1, "last_activity_date": 1484771503, "last_edit_date": 1484771503, "creation_date": 1484771449, "answer_id": 41728888, "question_id": 41728826, "link": "https://stackoverflow.com/questions/41728826/c-strings-not-working/41728888#41728888", "title": "C++ strings not working", "body": "<p>For your constructor, you have the three strings as your parameters but you aren't setting the member variables to their values. You can use an initializer list on the constructor like this...</p>\n\n<pre><code>name (string f, string m, string s) \n    : fName(f), mName(m), sName(s) // member(parameter) format\n{\n\n}\n</code></pre>\n\n<p>...or you can implement the <code>setter</code> stubs you have...</p>\n\n<pre><code>void setFName(string name) { this-&gt;fName = name;}\n</code></pre>\n\n<p>... and use them inside of your constructor like...</p>\n\n<pre><code>name (string fName, string mName, string sName) {\n    setFName(fName);\n    //...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 42880, "user_id": 982161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/kutcC.png?s=128&g=1", "display_name": "\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4", "link": "https://stackoverflow.com/users/982161/%ce%a6xoc%c4%99-%ec%9b%83-%d0%9fepe%c3%bapa-%e3%83%84"}, "is_accepted": false, "score": 0, "last_activity_date": 1484771662, "creation_date": 1484771662, "answer_id": 41728948, "question_id": 41728826, "link": "https://stackoverflow.com/questions/41728826/c-strings-not-working/41728948#41728948", "title": "C++ strings not working", "body": "<p>Basically the parameters passed in the constructor are getting lost since you are not assigning it to the class vars..</p>\n\n<p>Do something like:</p>\n\n<pre><code>name (string f, string m, string s) : fName(f), mName(m), sName(s){....};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1484772712, "post_id": 41729171, "comment_id": 70652830, "body": "OP did implement the constructor. Unfortunately the implementation doesn&#39;t do anything."}], "tags": [], "owner": {"reputation": 143, "user_id": 4413040, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/ZaLdA.jpg?s=128&g=1", "display_name": "Kamran", "link": "https://stackoverflow.com/users/4413040/kamran"}, "is_accepted": false, "score": 0, "last_activity_date": 1484772539, "creation_date": 1484772539, "answer_id": 41729171, "question_id": 41728826, "link": "https://stackoverflow.com/questions/41728826/c-strings-not-working/41729171#41729171", "title": "C++ strings not working", "body": "<p>try this. You forgot to implement Constructor of the class </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string.h&gt;\n\nusing namespace std;\nclass name\n{\n    string sFName, sMName, sSName;\n    public:\n        name (string FName, string MName, string SName);\n        void Display();\n        void setFName (string fName);\n        void setMName (string mName);\n        void setSName (string sName);\n        string getFName() const {return sFName;}\n        string getSName() const {return sSName;}\n        string getMName() const {return sMName;}\n\n};\n\nname::name(string FName, string MName, string SName )\n{\n    sFName = FName;\n    sMName = MName;\n    sSName = SName;\n}\n\nvoid name::setFName(string fName)\n{\n      sFName = fName;\n}\n\nvoid name::setMName(string mName)\n{\n      sMName = mName;\n}\n\nvoid name::setSName(string sName)\n{\n      sSName = sName;\n}\n\nvoid name::Display()\n{\n    cout&lt;&lt; sFName&lt;&lt; endl;\n    cout&lt;&lt; sMName&lt;&lt; endl;\n    cout&lt;&lt; sSName&lt;&lt; endl;\n}\nint main ()\n{\n    name myName (\"Gianna\", \"Maria\", \"M\");\n    myName.Display();\n\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 3638734, "user_type": "registered", "profile_image": "https://graph.facebook.com/1232067119/picture?type=large", "display_name": "Marvin001", "link": "https://stackoverflow.com/users/3638734/marvin001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2178, "favorite_count": 0, "closed_date": 1484773803, "accepted_answer_id": 41728849, "answer_count": 6, "score": 0, "last_activity_date": 1484773189, "creation_date": 1484771160, "last_edit_date": 1484771834, "question_id": 41728826, "link": "https://stackoverflow.com/questions/41728826/c-strings-not-working", "closed_reason": "Not suitable for this site", "title": "C++ strings not working", "body": "<p>I would like to make this programm show the \"Gianna\" \"Maria\" and \"M\" strings on the screen but I can't. There's no error so I guess there's something wrong with my programm. Any suggestions what could fix my programm?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\nclass name\n{\n    string fName, mName, sName;\n    public:\n        name (string fName, string mName, string sName){};\n        void setFName (string fName);\n        void setMName (string mName);\n        void setSName (string sName);\n        string getFName() const {return fName;}\n        string getSName() const {return sName;}\n        string getMName() const {return mName;}\n        friend ostream &amp; operator &lt;&lt;(ostream &amp;, const name &amp;);\n};\nostream&amp; operator&lt;&lt;(ostream&amp; os, const name&amp; n) {\n    return os &lt;&lt; n.fName &lt;&lt; \" \" &lt;&lt; n.sName&lt;&lt; \" \" &lt;&lt; n.mName;\n}\n\nint main ()\n{\n    name myName (\"Gianna\", \"Maria\", \"M\");\n    cout&lt;&lt;myName.getFName()&lt;&lt;\" \"&lt;&lt;myName.getMName()&lt;&lt;\" \"&lt;&lt;myName.getSName()&lt;&lt;endl;\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "memory-management", "visual-studio-2015", "windows-phone-8.1"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1484771097, "post_id": 41728761, "comment_id": 70651978, "body": "Have you read <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/jj681682(v=vs.105).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/apps/&hellip;</a>"}, {"owner": {"reputation": 373, "user_id": 1766177, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/c7cf5c563d6b3f148f30a74bf265f522?s=128&d=identicon&r=PG", "display_name": "MNagy", "link": "https://stackoverflow.com/users/1766177/mnagy"}, "edited": false, "score": 0, "creation_date": 1484771812, "post_id": 41728761, "comment_id": 70652314, "body": "I haven&#39;t yet!  That&#39;s certainly quite relevant."}], "answers": [{"tags": [], "owner": {"reputation": 1025, "user_id": 1539100, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9fd1a7d5e9b7b16c0f70cfdd049f7233?s=128&d=identicon&r=PG", "display_name": "sorosh_sabz", "link": "https://stackoverflow.com/users/1539100/sorosh-sabz"}, "is_accepted": false, "score": 0, "last_activity_date": 1484774957, "last_edit_date": 1484774957, "creation_date": 1484771925, "answer_id": 41729013, "question_id": 41728761, "link": "https://stackoverflow.com/questions/41728761/what-are-good-ways-of-determining-at-runtime-how-much-memory-is-allowed-availabl/41729013#41729013", "title": "What are good ways of determining at runtime how much memory is allowed/available to a windows phone 8.1 app?", "body": "<p>ITNOA</p>\n\n<p>As you can see in <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/jj681682%28v=vs.105%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">App memory limits for Windows Phone 8</a>, you can found some info about memory limit for windows app.</p>\n\n<p><a href=\"https://i.stack.imgur.com/CCD0v.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CCD0v.png\" alt=\"enter image description here\"></a></p>\n\n<p>And as you can see some <a href=\"http://www.codeguru.com/win_mobile/phone_apps/how-to-work-with-the-memory-limits-of-windows-phone-apps.htm\" rel=\"nofollow noreferrer\">workaround about memory statistics</a> you can use some API as below in C#</p>\n\n<pre><code>private void buttonGetMemoryMetrics_Click(object sender, RoutedEventArgs e)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 {\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 long totalBytes = DeviceStatus.DeviceTotalMemory;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 long usageLimit = DeviceStatus.ApplicationMemoryUsageLimit;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0long currentUsage = DeviceStatus.ApplicationCurrentMemoryUsage;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ulong commitLimit = MemoryManager.ProcessCommittedLimit;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ulong currentCommit = MemoryManager.ProcessCommittedBytes;\n\u00a0\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 long workingsetLimit = 0;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 object temp;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 if(DeviceExtendedProperties.TryGetValue(\"ApplicationWorkingSetLimit\", out temp))\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 workingsetLimit = (long)temp;\n\u00a0\n\u00a0\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 textBlockApplicationCurrentMemoryUsage.Text = currentUsage.ToString();\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 textBlockApplicationMemoryUsageLimit.Text = usageLimit.ToString();\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 textBlockApplicationWorkingSetLimit.Text = workingsetLimit.ToString();\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 textBlockBytesCommitLimit.Text = commitLimit.ToString();\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 textBlockBytesCommitted.Text = currentCommit.ToString();\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 textBlockDeviceTotalMemory.Text = totalBytes.ToString();\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 }\n</code></pre>\n\n<p>For C++ usage you can see <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/windows.system.memorymanager.appmemoryusagelimit.aspx?cs-save-lang=1&amp;cs-lang=cpp#code-snippet-1\" rel=\"nofollow noreferrer\">MemoryManager.AppMemoryUsageLimit</a> . You can found some useful informations about APIs in <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/windows.system.memorymanager.aspx\" rel=\"nofollow noreferrer\">MemoryManager</a> section.</p>\n"}], "owner": {"reputation": 373, "user_id": 1766177, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/c7cf5c563d6b3f148f30a74bf265f522?s=128&d=identicon&r=PG", "display_name": "MNagy", "link": "https://stackoverflow.com/users/1766177/mnagy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484774957, "creation_date": 1484770893, "question_id": 41728761, "link": "https://stackoverflow.com/questions/41728761/what-are-good-ways-of-determining-at-runtime-how-much-memory-is-allowed-availabl", "title": "What are good ways of determining at runtime how much memory is allowed/available to a windows phone 8.1 app?", "body": "<p>Working in MSVS 2015, it's a c++ windows phone 8.1 project.</p>\n\n<p>I've jury-rigged a method that works--I do something like a binary search by allocating and freeing memory; if the allocation works, I increase the size, if it doesn't I decrease it, etc.  However, repeated allocation and deallocation seems clunky, inelegant, and likely to cause problems whose specifics I don't actually know yet, call it intuition.</p>\n\n<p>For instance, when testing on the 512 MB phone emulator, I end up finding that I actually have only in the neighborhood of 160 MB for my app to utilize.  That's fine and all, but I wouldn't have known what the actual amount of memory I could allocate was without testing.</p>\n\n<p>What options are available to me to find that number (with the available apis)?</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "edited": false, "score": 0, "creation_date": 1484771056, "post_id": 41728651, "comment_id": 70651956, "body": "Does it inherit from <code>QGraphicsEllipseItem</code>? If yes, you can retrieve position relative to the scene by calling <code>getSceneRect()</code> and then finding it&#39;s centre. Anyway, the <code>QGraphicsEllipseItem</code> should be enough for whatever you&#39;re doing in the <code>QGraphicsView</code>."}, {"owner": {"reputation": 75, "user_id": 3236150, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/20093ee5818ddb078b9ab2d1185b4660?s=128&d=identicon&r=PG&f=1", "display_name": "tbp", "link": "https://stackoverflow.com/users/3236150/tbp"}, "reply_to_user": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "edited": false, "score": 0, "creation_date": 1484771865, "post_id": 41728651, "comment_id": 70652337, "body": "No, it doesn&#39;t. But after inheriting, what does <code>getSceneRect()</code> do exactly? I just want to be sure if I&#39;ve got your explanation or not, I should find the center of the circle?"}, {"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "edited": false, "score": 0, "creation_date": 1484772079, "post_id": 41728651, "comment_id": 70652446, "body": "it returns upper left corner of the rectangle in which circle fits (from geometry it is a square with sides 2R). So you&#39;ll have to calculate the center using simple math yourself."}], "owner": {"reputation": 75, "user_id": 3236150, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/20093ee5818ddb078b9ab2d1185b4660?s=128&d=identicon&r=PG&f=1", "display_name": "tbp", "link": "https://stackoverflow.com/users/3236150/tbp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484770479, "creation_date": 1484770479, "question_id": 41728651, "link": "https://stackoverflow.com/questions/41728651/how-to-get-the-current-position-of-a-shape-in-qt", "title": "How to get the current position of a shape in qt", "body": "<p>I have a circle with these two methods in qt:</p>\n\n<pre><code>void MyGLWidget::drawCircle() {\nint n = vertices.count();\nqglColor(Qt::white);\nglBegin(GL_POLYGON);\nfor(int i = 0; i &lt; n; i++) {\n    glVertex2f(vertices[i].first, vertices[i].second);\n    }\nglEnd();\n}\n\n\n\nvoid MyGLWidget::calculateVetices()\n{\n    double a = 3.14 / 90;\n    vertices.append(QPair&lt;double, double&gt; (0,0));\n    for(int i = 0; i &lt;= 360; i++) {\n        vertices.append(QPair&lt;double, double&gt; (cos(i * a) * radius, sin(i * a) * radius));\n    }\n}\n</code></pre>\n\n<p>Now I want to get the current position of this circle. How can I do that? </p>\n"}, {"tags": ["c++", "linker", "static-libraries"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1484770153, "post_id": 41728517, "comment_id": 70651504, "body": "I would assume, it does. static library works fine because it is not even linked, this is just an archive or .o files."}, {"owner": {"reputation": 601, "user_id": 2321263, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/69136768e112181d36d0fece557f8684?s=128&d=identicon&r=PG", "display_name": "weblar83", "link": "https://stackoverflow.com/users/2321263/weblar83"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1484770396, "post_id": 41728517, "comment_id": 70651626, "body": "Thanks for your quick reply. The problem is, I can&#39;t find (via extensive Googling) any examples to show this working. I&#39;ve just tried now using the same linker.ld file as my main application and even more errors have been raised and ends in the <code>required section &#39;.rel.plt&#39; not found in the linker script</code> as before"}, {"owner": {"reputation": 601, "user_id": 2321263, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/69136768e112181d36d0fece557f8684?s=128&d=identicon&r=PG", "display_name": "weblar83", "link": "https://stackoverflow.com/users/2321263/weblar83"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1484772132, "post_id": 41728517, "comment_id": 70652472, "body": "Ok, so after a bit more digging, GCC has a <code>-pie</code> option for &quot;position independent code&quot;. Not quite sure to how apply this to my scenario but it&#39;s looking more promising."}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1484849505, "post_id": 41728517, "comment_id": 70690082, "body": "&quot;When I change the library over to shared..&quot;. We need to see the exact compile and link commands by which you compiling the object files contained in the shared library and linking them into that shared liubrary."}], "owner": {"reputation": 601, "user_id": 2321263, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/69136768e112181d36d0fece557f8684?s=128&d=identicon&r=PG", "display_name": "weblar83", "link": "https://stackoverflow.com/users/2321263/weblar83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 408, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484770012, "creation_date": 1484770012, "question_id": 41728517, "link": "https://stackoverflow.com/questions/41728517/gcc-shared-library-linkage", "title": "GCC Shared Library Linkage", "body": "<p>I'm using GCC to create both a shared library (.so) and an application to run on an Cortex-M4 microcontroller. </p>\n\n<p>If I compile the library as a static library and then compile the main application (with the library), everything compiles and the result is a single (but fairly large in size) binary.</p>\n\n<p>When I change the library over to shared and then recompile both this and the main application, the linking phase throws up numerous errors:</p>\n\n<p><code>Invoking: Cross ARM C++ Linker\narm-none-eabi-g++ -mcpu=cortex-m4 -mthumb -mfloat-abi=hard -mfpu=fpv4-sp-d16 -O0 -fmessage-length=0 -fsigned-char -ffunction-sections -fdata-sections  -g3 -T \"C:/Users/workspace.kds/MyProject/Project_Settings/Linker_Files/linker.ld\" -Xlinker --gc-sections -L\"C:/Users/workspace.kds/MyProject/Project_Settings/Linker_Files\" -L\"C:\\Users\\workspace.kds\\MyLibrary\\Debug\" -Wl,-Map,\"MyProject.map\" -specs=nano.specs -specs=nosys.specs -o \"MyProject.elf\"  ./Sources/main.o  ./Project_Settings/Startup_Code/startup.o   -lMyLibrary\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: section .dynamic loaded at [00011d28,00011ddf] overlaps section .romp loaded at [00011d28,00011d4b]\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: BFD (GNU Tools for ARM Embedded Processors) 2.23.2.20140731 assertion fail /home/build/work/GCC-4-8-build/src/binutils/bfd/elf32-arm.c:7730\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: BFD (GNU Tools for ARM Embedded Processors) 2.23.2.20140731 assertion fail /home/build/work/GCC-4-8-build/src/binutils/bfd/elf32-arm.c:7730\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: BFD (GNU Tools for ARM Embedded Processors) 2.23.2.20140731 assertion fail /home/build/work/GCC-4-8-build/src/binutils/bfd/elf32-arm.c:7730\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: BFD (GNU Tools for ARM Embedded Processors) 2.23.2.20140731 assertion fail /home/build/work/GCC-4-8-build/src/binutils/bfd/elf32-arm.c:7730\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: BFD (GNU Tools for ARM Embedded Processors) 2.23.2.20140731 assertion fail /home/build/work/GCC-4-8-build/src/binutils/bfd/elf32-arm.c:7730\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: BFD (GNU Tools for ARM Embedded Processors) 2.23.2.20140731 assertion fail /home/build/work/GCC-4-8-build/src/binutils/bfd/elf32-arm.c:7730\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: BFD (GNU Tools for ARM Embedded Processors) 2.23.2.20140731 assertion fail /home/build/work/GCC-4-8-build/src/binutils/bfd/elf32-arm.c:7730\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: BFD (GNU Tools for ARM Embedded Processors) 2.23.2.20140731 assertion fail /home/build/work/GCC-4-8-build/src/binutils/bfd/elf32-arm.c:7730\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: BFD (GNU Tools for ARM Embedded Processors) 2.23.2.20140731 assertion fail /home/build/work/GCC-4-8-build/src/binutils/bfd/elf32-arm.c:7730\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: BFD (GNU Tools for ARM Embedded Processors) 2.23.2.20140731 assertion fail /home/build/work/GCC-4-8-build/src/binutils/bfd/elf32-arm.c:7730\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: BFD (GNU Tools for ARM Embedded Processors) 2.23.2.20140731 assertion fail /home/build/work/GCC-4-8-build/src/binutils/bfd/elf32-arm.c:7730\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: BFD (GNU Tools for ARM Embedded Processors) 2.23.2.20140731 assertion fail /home/build/work/GCC-4-8-build/src/binutils/bfd/elf32-arm.c:7730\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: BFD (GNU Tools for ARM Embedded Processors) 2.23.2.20140731 assertion fail /home/build/work/GCC-4-8-build/src/binutils/bfd/elf32-arm.c:7730\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: BFD (GNU Tools for ARM Embedded Processors) 2.23.2.20140731 assertion fail /home/build/work/GCC-4-8-build/src/binutils/bfd/elf32-arm.c:7730\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: BFD (GNU Tools for ARM Embedded Processors) 2.23.2.20140731 assertion fail /home/build/work/GCC-4-8-build/src/binutils/bfd/elf32-arm.c:7730\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: BFD (GNU Tools for ARM Embedded Processors) 2.23.2.20140731 assertion fail /home/build/work/GCC-4-8-build/src/binutils/bfd/elf32-arm.c:7730\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: BFD (GNU Tools for ARM Embedded Processors) 2.23.2.20140731 assertion fail /home/build/work/GCC-4-8-build/src/binutils/bfd/elf32-arm.c:7730\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: error: required section '.rel.plt' not found in the linker script\nc:/freescale/kds_v3/toolchain/bin/../lib/gcc/arm-none-eabi/4.8.4/../../../../arm-none-eabi/bin/ld.exe: final link failed: Invalid operation\ncollect2.exe: error: ld returned 1 exit status\nmakefile:58: recipe for target 'MyProject.elf' failed\nmake: *** [MyProject.elf] Error 1</code></p>\n\n<p>Or to cut this a bit shorter</p>\n\n<p><code>section .dynamic loaded at [00011d28,00011ddf] overlaps section .romp loaded at [00011d28,00011d4b]</code></p>\n\n<p>Does the shared library need to be compiled with the same linker configuration as the main application? If so, why does the static build of the same library work fine?</p>\n\n<p>Thanks in advance for any suggestions.</p>\n"}, {"tags": ["c++", "module", "cmake", "shared-libraries"], "comments": [{"owner": {"reputation": 871, "user_id": 36034, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b12f32bfa45d983d3613b14563d7c0b1?s=128&d=identicon&r=PG", "display_name": "Chris Morley", "link": "https://stackoverflow.com/users/36034/chris-morley"}, "edited": false, "score": 0, "creation_date": 1485202311, "post_id": 41728301, "comment_id": 70817639, "body": "My alternatives appear to be: 1. add the platform-specific flags to produce the pdb files, or 2. to use the SHARED library type, and add a dummy exported symbol to these libraries so they produce LIB files."}], "answers": [{"tags": [], "owner": {"reputation": 871, "user_id": 36034, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b12f32bfa45d983d3613b14563d7c0b1?s=128&d=identicon&r=PG", "display_name": "Chris Morley", "link": "https://stackoverflow.com/users/36034/chris-morley"}, "is_accepted": true, "score": 0, "last_activity_date": 1485461443, "creation_date": 1485461443, "answer_id": 41882096, "question_id": 41728301, "link": "https://stackoverflow.com/questions/41728301/cmake-add-library-using-the-module-keyword-doesnt-create-pdb-file/41882096#41882096", "title": "CMake add_library using the MODULE keyword doesn&#39;t create PDB file", "body": "<p>I went back to using SHARED libraries and added a dummy symbol to be exported from each such library. This way the cmake files stay consistent with all the other libs.</p>\n"}], "owner": {"reputation": 871, "user_id": 36034, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b12f32bfa45d983d3613b14563d7c0b1?s=128&d=identicon&r=PG", "display_name": "Chris Morley", "link": "https://stackoverflow.com/users/36034/chris-morley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 41882096, "answer_count": 1, "score": 0, "last_activity_date": 1485461443, "creation_date": 1484769259, "last_edit_date": 1484907788, "question_id": 41728301, "link": "https://stackoverflow.com/questions/41728301/cmake-add-library-using-the-module-keyword-doesnt-create-pdb-file", "title": "CMake add_library using the MODULE keyword doesn&#39;t create PDB file", "body": "<p>In my CMake build using ninja as the back-end, DLLs with no exported symbols are always re-linked, so I use the <code>MODULE</code> keyword with <code>add_library</code> for those DLLs as recommended <a href=\"https://cmake.org/Bug/view.php?id=15885\" rel=\"nofollow noreferrer\">here</a> and in the <a href=\"https://cmake.org/cmake/help/v3.4/command/add_library.html\" rel=\"nofollow noreferrer\">add_library docs</a>.</p>\n\n<p>But now those DLLs do not have corresponding PDB files created with them (or perhaps they are being generated in the object directory with the default name, rather than in the output directory with the library name).</p>\n\n<p>The <a href=\"https://cmake.org/cmake/help/v3.4/prop_tgt/PDB_NAME.html\" rel=\"nofollow noreferrer\">PDB_NAME docs</a> imply that it only applies to executables and SHARED libraries (no mention of MODULEs):</p>\n\n<blockquote>\n  <p>Output name for the ... .pdb file generated by the linker for an\n  executable or shared library target.</p>\n</blockquote>\n\n<p>How can I get the PDB file created in the expected location with the right name for a MODULE library?</p>\n"}, {"tags": ["c++", "c++11", "bit-manipulation", "byte", "bit"], "answers": [{"comments": [{"owner": {"reputation": 6953, "user_id": 778533, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/XEGLp.jpg?s=128&g=1", "display_name": "tommy.carstensen", "link": "https://stackoverflow.com/users/778533/tommy-carstensen"}, "edited": false, "score": 0, "creation_date": 1484770941, "post_id": 41728309, "comment_id": 70651899, "body": "Thanks! You are right that I get <code>warning: &amp; has lower precedence than ==; == will be evaluated first [-Wparentheses]</code>, when doing <code>if ((s[i] &gt;&gt; (2*j)) &amp; 3 == 3) {</code> as in your original answer instead of <code>if (((s[i] &gt;&gt; (2*j)) &amp; 3) == 3) {</code> as in your edited answer. This shifts <code>s[i] &gt;&gt; (2*j)</code> and then <code>&amp; 3</code> masks. I get it. Thanks!"}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 6, "last_activity_date": 1484824130, "last_edit_date": 1484824130, "creation_date": 1484769283, "answer_id": 41728309, "question_id": 41728206, "link": "https://stackoverflow.com/questions/41728206/get-bits-from-byte-and-slice-2-bit-pairs/41728309#41728309", "title": "Get bits from byte and slice 2 bit pairs", "body": "<p>You can use the same bit manipulation trick that you used in Python:</p>\n\n<pre><code>for (std::size_t i = 0; i &lt; s.size(); ++i) {\n    for (int j = 0; j &lt; 4; ++j) {\n        if (((s[i] &gt;&gt; (2*j)) &amp; 3) == 3) {\n            std::cout &lt;&lt; i &lt;&lt; \" \" &lt;&lt; s[i] &lt;&lt; \" \" &lt;&lt; (int)s[i] &lt;&lt; \" \" &lt;&lt; j &lt;&lt; \" \" &lt;&lt; ((s[i] &gt;&gt; 2*j) &amp; 3) &lt;&lt; std::endl;\n        }\n    }\n}\n</code></pre>\n\n<p>You do not need to use <code>ord</code>, because character types of C++ are among the integral types, and are, therefore, freely convertible to integers.</p>\n\n<p>Note the use of parentheses to force the expected order of evaluation.</p>\n\n<p><a href=\"http://ideone.com/NE7Wxl\" rel=\"nofollow noreferrer\">Demo.</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5697768"}, "is_accepted": false, "score": 1, "last_activity_date": 1484770559, "creation_date": 1484770559, "answer_id": 41728672, "question_id": 41728206, "link": "https://stackoverflow.com/questions/41728206/get-bits-from-byte-and-slice-2-bit-pairs/41728672#41728672", "title": "Get bits from byte and slice 2 bit pairs", "body": "<p>To check the nth bit is set or not you can use something like below</p>\n\n<p><code>bit at position x of M = (M &amp; 1&lt;&lt;x) //0 if its zero 1 if its one</code></p>\n"}], "owner": {"reputation": 6953, "user_id": 778533, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/XEGLp.jpg?s=128&g=1", "display_name": "tommy.carstensen", "link": "https://stackoverflow.com/users/778533/tommy-carstensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "accepted_answer_id": 41728309, "answer_count": 2, "score": 4, "last_activity_date": 1484824130, "creation_date": 1484768947, "question_id": 41728206, "link": "https://stackoverflow.com/questions/41728206/get-bits-from-byte-and-slice-2-bit-pairs", "title": "Get bits from byte and slice 2 bit pairs", "body": "<p>I am new to C++. In Python 3 I can convert the string 'ABC' into selected bits like this and print, whenever a pair of bits are 11:</p>\n\n<pre><code>s = 'ABC'\nfor i, char in enumerate(s):\n    for j in range(4):\n        if ord(char) &gt;&gt; 2*j &amp; 0b11 == 3:\n            print(i, char, ord(char), j, ord(char) &gt;&gt; 2*j &amp; 0b11)\n</code></pre>\n\n<p>Which returns:</p>\n\n<pre><code>2 C 67 0 3\n</code></pre>\n\n<p>How do I do the same in C++; i.e. how do I identify bits 1 and 2 of the character 'C' being 11? I currently have this code:</p>\n\n<pre><code>//#include &lt;string&gt;\n//#include &lt;bitset&gt;\n#include &lt;iostream&gt;\n//using namespace std;\nint main(){\n  const int bits_in_byte = 8;\n  std::string s = \"ABC\";\n  for (std::size_t i = 0; i &lt; s.size(); ++i)\n  {\n    for (int j = 0; j &lt; 4; ++j) {\n      std::cout &lt;&lt; i &lt;&lt; ' ' &lt;&lt; s[i] &lt;&lt; ' ' &lt;&lt; std::bitset&lt;bits_in_byte&gt;(s[i]) &lt;&lt; std::endl;\n    }\n  }\n}\n</code></pre>\n\n<p>Which returns:</p>\n\n<pre><code>0 A 01000001\n0 A 01000001\n0 A 01000001\n0 A 01000001\n1 B 01000010\n1 B 01000010\n1 B 01000010\n1 B 01000010\n2 C 01000011\n2 C 01000011\n2 C 01000011\n2 C 01000011\n</code></pre>\n"}, {"tags": ["c++", "c", "arrays", "qt"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1484768446, "post_id": 41727943, "comment_id": 70650522, "body": "It already is. Are you having trouble printing it?"}, {"owner": {"reputation": 301, "user_id": 1743514, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/02da8087bd6dd9ef2bbae125c0634ff3?s=128&d=identicon&r=PG", "display_name": "user1743514", "link": "https://stackoverflow.com/users/1743514/user1743514"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1484769052, "post_id": 41727943, "comment_id": 70650858, "body": "yes, In debugger it is showing the values. But I print it , it is showing something different."}], "answers": [{"comments": [{"owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "edited": false, "score": 0, "creation_date": 1484768677, "post_id": 41728054, "comment_id": 70650667, "body": "why not add <code>std:size_t size = sizeof(arr) &#47; sizeof(char);</code>?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484768916, "post_id": 41728054, "comment_id": 70650785, "body": "It is not necessary to cast <code>char</code> when assigned to <code>int</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1484769595, "post_id": 41728054, "comment_id": 70651176, "body": "With respect to <code>int* ptr = new int[size]</code>, may I pitch <a href=\"http://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\"><code>std::vector&lt;int&gt; vec(size);</code></a> ?"}], "tags": [], "owner": {"reputation": 718, "user_id": 4885127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d03a4283a4fb815a1f77e8793b1c94cf?s=128&d=identicon&r=PG&f=1", "display_name": "Moshe D", "link": "https://stackoverflow.com/users/4885127/moshe-d"}, "is_accepted": true, "score": -1, "last_activity_date": 1484770567, "last_edit_date": 1484770567, "creation_date": 1484768427, "answer_id": 41728054, "question_id": 41727943, "link": "https://stackoverflow.com/questions/41727943/decimal-ascii-value-for-unsigned-char-array/41728054#41728054", "title": "decimal ascii value for unsigned char array", "body": "<p>This should work</p>\n\n<pre><code>char arr[] = {'1','9','2'};\nstd::vector&lt;int&gt; vec(size); //size of the char array - in this case 3\nfor(int i = 0; i &lt; size; i++)\n{\n   vec[i] = arr[i];\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 4, "last_activity_date": 1484768650, "creation_date": 1484768650, "answer_id": 41728117, "question_id": 41727943, "link": "https://stackoverflow.com/questions/41727943/decimal-ascii-value-for-unsigned-char-array/41728117#41728117", "title": "decimal ascii value for unsigned char array", "body": "<blockquote>\n  <p>How to convert char array to its equivalent ascii decimal array ?</p>\n</blockquote>\n\n<p>You do not, it is already stored that way. If you want to print your array as decimal numbers for ASCII just output it accordingly (as integers):</p>\n\n<pre><code>char str[] = \"1,9,10,2\";\nfor( const char *s = str; *s; ++s ) std::cout &lt;&lt; static_cast&lt;int&gt;( *s ) &lt;&lt; \",\"; \n// just output number instead of character\n</code></pre>\n\n<p><code>char</code> in C++ is a numerical type similar to <code>int</code>, difference is <code>std::ostream</code> outputs <code>char</code> as a symbol and <code>int</code> and other integer types as integer.</p>\n"}, {"comments": [{"owner": {"reputation": 362, "user_id": 1211158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e7342aaa16d399ef9e8e8ca4db185e?s=128&d=identicon&r=PG&f=1", "display_name": "NeverGoodEnough", "link": "https://stackoverflow.com/users/1211158/nevergoodenough"}, "edited": false, "score": 0, "creation_date": 1484770078, "post_id": 41728425, "comment_id": 70651463, "body": "@latedeveloper I&#39;m sorry you are not able to run it. Why shouldn&#39;t it?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484770125, "post_id": 41728425, "comment_id": 70651487, "body": "<code>char output[2*strlen(input) + 1];</code> is a VLA and is not standard C++."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1484770182, "post_id": 41728425, "comment_id": 70651514, "body": "@Nitro What Nathan said."}, {"owner": {"reputation": 362, "user_id": 1211158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e7342aaa16d399ef9e8e8ca4db185e?s=128&d=identicon&r=PG&f=1", "display_name": "NeverGoodEnough", "link": "https://stackoverflow.com/users/1211158/nevergoodenough"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484770398, "post_id": 41728425, "comment_id": 70651627, "body": "@NathanOliver right... I guess you may replace &quot;strlen&quot; with &quot;sizeof&quot;..."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484770586, "post_id": 41728425, "comment_id": 70651719, "body": "Still it is a very brittle solution.  You are basically using the assumption that the characters are mapped to values in the range of [10, 99].  If that is ever not the case then problems ensue."}, {"owner": {"reputation": 362, "user_id": 1211158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e7342aaa16d399ef9e8e8ca4db185e?s=128&d=identicon&r=PG&f=1", "display_name": "NeverGoodEnough", "link": "https://stackoverflow.com/users/1211158/nevergoodenough"}, "edited": false, "score": 0, "creation_date": 1484770605, "post_id": 41728425, "comment_id": 70651730, "body": "by the way, as it is constant, probably my compiler does not complain even if I ask --std=c++0x"}, {"owner": {"reputation": 362, "user_id": 1211158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e7342aaa16d399ef9e8e8ca4db185e?s=128&d=identicon&r=PG&f=1", "display_name": "NeverGoodEnough", "link": "https://stackoverflow.com/users/1211158/nevergoodenough"}, "edited": false, "score": 0, "creation_date": 1484770777, "post_id": 41728425, "comment_id": 70651817, "body": "you&#39;re totally right, I quickly copied the code with %X and when replaced to %d I forgot it; also output shall be initialised to 0, at least the first element."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484770783, "post_id": 41728425, "comment_id": 70651819, "body": "You need better compiler flags.  <a href=\"http://coliru.stacked-crooked.com/a/140c992a28be47cc\" rel=\"nofollow noreferrer\">See this example</a>"}, {"owner": {"reputation": 362, "user_id": 1211158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e7342aaa16d399ef9e8e8ca4db185e?s=128&d=identicon&r=PG&f=1", "display_name": "NeverGoodEnough", "link": "https://stackoverflow.com/users/1211158/nevergoodenough"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484771097, "post_id": 41728425, "comment_id": 70651979, "body": "Thanks @NathanOliver, &quot;-pedantic&quot; did the trick. I edited the proposed solution to mitigate the issues you kindly spotted"}, {"owner": {"reputation": 362, "user_id": 1211158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e7342aaa16d399ef9e8e8ca4db185e?s=128&d=identicon&r=PG&f=1", "display_name": "NeverGoodEnough", "link": "https://stackoverflow.com/users/1211158/nevergoodenough"}, "edited": false, "score": 0, "creation_date": 1484772388, "post_id": 41728425, "comment_id": 70652612, "body": "you think I better remove it?"}], "tags": [], "owner": {"reputation": 362, "user_id": 1211158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e7342aaa16d399ef9e8e8ca4db185e?s=128&d=identicon&r=PG&f=1", "display_name": "NeverGoodEnough", "link": "https://stackoverflow.com/users/1211158/nevergoodenough"}, "is_accepted": false, "score": 0, "last_activity_date": 1484771493, "last_edit_date": 1484771493, "creation_date": 1484769697, "answer_id": 41728425, "question_id": 41727943, "link": "https://stackoverflow.com/questions/41727943/decimal-ascii-value-for-unsigned-char-array/41728425#41728425", "title": "decimal ascii value for unsigned char array", "body": "<p>You can easily do this way. It's C++ but it will work in C with proper includes and printf in place of std:cout.</p>\n\n<pre><code>int main() {\n    char input[] = \"1,9,10,2\";\n    char output[3*sizeof(input) + 1];\n\n    output[0] = '\\0';\n    for (size_t i = 0; i &lt; strlen(input); i++) {\n        sprintf(output, \"%s%d\", output, input[i]);\n    }\n\n    std::cout &lt;&lt; input &lt;&lt; std::endl;\n    std::cout &lt;&lt; output &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>Followed some hint from @Nathan, it should be better now...</p>\n"}], "owner": {"reputation": 301, "user_id": 1743514, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/02da8087bd6dd9ef2bbae125c0634ff3?s=128&d=identicon&r=PG", "display_name": "user1743514", "link": "https://stackoverflow.com/users/1743514/user1743514"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1012, "favorite_count": 0, "accepted_answer_id": 41728054, "answer_count": 3, "score": 0, "last_activity_date": 1484771493, "creation_date": 1484768009, "question_id": 41727943, "link": "https://stackoverflow.com/questions/41727943/decimal-ascii-value-for-unsigned-char-array", "title": "decimal ascii value for unsigned char array", "body": "<p>How to convert char array to its equivalent ascii decimal array ? I tried in QT using QString and QbyteArray. But it is not working. </p>\n\n<p>i/p: \"1,9,10,2\" </p>\n\n<p>o/p:  \"4944574449484450\"  (1's ascii decimal value is 49, \n                            , ascii decimal value is 44, \n                            9's ascii decimal value is 57, and so on..). </p>\n"}, {"tags": ["c++", "homebrew", "eigen", "ceres-solver"], "comments": [{"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1484767429, "post_id": 41727736, "comment_id": 70649969, "body": "Well, you get a clear warning. What do you expect us to tell you? &quot;No, the developers of that software had no idea how their software works?&quot;"}, {"owner": {"reputation": 4083, "user_id": 3303546, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/1Xh6f.jpg?s=128&g=1", "display_name": "Cecilia", "link": "https://stackoverflow.com/users/3303546/cecilia"}, "reply_to_user": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1484768704, "post_id": 41727736, "comment_id": 70650680, "body": "Okay fair point. I assumed the answer to the first question would be no, but I&#39;m a bit stumped about what to try next."}], "answers": [{"tags": [], "owner": {"reputation": 4083, "user_id": 3303546, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/1Xh6f.jpg?s=128&g=1", "display_name": "Cecilia", "link": "https://stackoverflow.com/users/3303546/cecilia"}, "is_accepted": true, "score": 1, "last_activity_date": 1484770756, "creation_date": 1484770756, "answer_id": 41728727, "question_id": 41727736, "link": "https://stackoverflow.com/questions/41727736/what-is-the-simplest-way-to-match-the-versions-for-eigen-and-ceres-solver/41728727#41728727", "title": "What is the simplest way to match the versions for Eigen and Ceres-Solver?", "body": "<p>I was trying to build ceres from source using <a href=\"http://ceres-solver.org/installation.html\" rel=\"nofollow noreferrer\">the instructions on the ceres website</a>. I'm still not sure why this failed, but building from source using brew (an option that I did not previously know existed) works.</p>\n\n<p><code>brew install --build-from-source ceres-solver</code></p>\n\n<p>It uses the Eigen dependency installed via brew (Eigen 3.3.1) and does not produce any error messages.</p>\n"}], "owner": {"reputation": 4083, "user_id": 3303546, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/1Xh6f.jpg?s=128&g=1", "display_name": "Cecilia", "link": "https://stackoverflow.com/users/3303546/cecilia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1168, "favorite_count": 1, "accepted_answer_id": 41728727, "answer_count": 1, "score": 1, "last_activity_date": 1487185736, "creation_date": 1484767322, "last_edit_date": 1487185736, "question_id": 41727736, "link": "https://stackoverflow.com/questions/41727736/what-is-the-simplest-way-to-match-the-versions-for-eigen-and-ceres-solver", "title": "What is the simplest way to match the versions for Eigen and Ceres-Solver?", "body": "<p>I installed both Eigen and Ceres-Solver with brew as prerequisites for an existing project. </p>\n\n<p>When I run make for the project, I get the following message</p>\n\n<blockquote>\n  <p>Found Eigen dependency, but the version of Eigen found (3.3.1) does\n  not exactly match the version of Eigen Ceres was compiled with\n  (3.3.0). This can cause subtle bugs by triggering violations of the\n  One Definition Rule. See the Wikipedia article\n  <a href=\"http://en.wikipedia.org/wiki/One_Definition_Rule\" rel=\"nofollow noreferrer\">http://en.wikipedia.org/wiki/One_Definition_Rule</a> for more details</p>\n</blockquote>\n\n<p>My first idea was to compile Ceres-solver from source using the Eigen from brew, but this produced other error messages during make.</p>\n\n<p>Specifically, it builds up to 54% and then prints</p>\n\n<pre><code>[ 54%] Linking C executable ../bin/curve_fitting_c\nUndefined symbols for architecture x86_64:\n  \"___kmpc_atomic_fixed4_sub\", referenced from:\n      __ZN5Eigen8internal29general_matrix_matrix_productIldLi1ELb0EdLi1ELb0ELi0EE3runElllPKdlS4_lPdldRNS0_15level3_blockingIddEEPNS0_16GemmParallelInfoIlEE in libceres.a(gradient_checker.cc.o)\n      __ZN5Eigen8internal29general_matrix_matrix_productIldLi1ELb0EdLi0ELb0ELi0EE3runElllPKdlS4_lPdldRNS0_15level3_blockingIddEEPNS0_16GemmParallelInfoIlEE in libceres.a(dogleg_strategy.cc.o)\n\n__ZN5ceres8internal11EventLoggerC2ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE in libceres.a(wall_time.cc.o)\n  __ZN5ceres8internal11EventLoggerC1ERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE in libceres.a(wall_time.cc.o)\n  __ZN5ceres8internal11EventLoggerD2Ev in libceres.a(wall_time.cc.o)\n</code></pre>\n\n<p>... Skipping some lines ...</p>\n\n<pre><code>    __ZN5ceres8internal11EventLogger8AddEventERKNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE in libceres.a(wall_time.cc.o)\nld: symbol(s) not found for architecture x86_64\nclang-3.5: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>The <a href=\"http://ceres-solver.org/installation.html\" rel=\"nofollow noreferrer\">ceres installation page</a> recommends Eigen 3.2.2 or later, so 3.3.1 should be fine, unless there were some structural changes between 3.2 and 3.3. </p>\n\n<p><strong>My Question:</strong></p>\n\n<p><strong>What is the next step I should try? Installing an older version of Eigen?</strong> </p>\n"}, {"tags": ["c++", "sfinae"], "answers": [{"tags": [], "owner": {"reputation": 20670, "user_id": 26039, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/15aacb48f4c894a6341e1013e9b5a42f?s=128&d=identicon&r=PG", "display_name": "eran", "link": "https://stackoverflow.com/users/26039/eran"}, "is_accepted": true, "score": 2, "last_activity_date": 1484770018, "creation_date": 1484770018, "answer_id": 41728519, "question_id": 41727705, "link": "https://stackoverflow.com/questions/41727705/sfinae-for-callback-registration/41728519#41728519", "title": "SFINAE for callback registration", "body": "<p>Your SFINAE fails because it relies on the surrounding class type parameter. SFINAE only works on deduced type arguments, which are function type arguments the compiler tries to figure out based on the call.</p>\n\n<p>A fix could look like:</p>\n\n<pre><code>template&lt;class S = Callback, typename cb_test&lt;decltype(S::barEvent)&gt;::type=0&gt;\nvoid barEventRegister(has_member)\n</code></pre>\n\n<p>where the SFINAE is based on S, which the compiler will deduce rather then get explicitly.</p>\n\n<p>Also, note that your second overload should take a <code>has_not_member</code>, not <code>has_member</code>. As it is now, it will always be chosen, even if the member exists, since non-template overloads are chosen when equivalent to template ones.</p>\n"}], "owner": {"reputation": 5309, "user_id": 877329, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0b5c9fa7b8fa8139c1330b5fbbd5f934?s=128&d=identicon&r=PG", "display_name": "user877329", "link": "https://stackoverflow.com/users/877329/user877329"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 41728519, "answer_count": 1, "score": 2, "last_activity_date": 1484770018, "creation_date": 1484767202, "last_edit_date": 1495540376, "question_id": 41727705, "link": "https://stackoverflow.com/questions/41727705/sfinae-for-callback-registration", "title": "SFINAE for callback registration", "body": "<p>I tried to use this trick to register callback if it exists <a href=\"https://stackoverflow.com/questions/13786888/check-if-member-exists-using-enable-if\">check if member exists using enable_if</a>:</p>\n\n<pre><code>template&lt;class Callback&gt;\nclass Foo\n{\n  public:\n    Foo()\n    {barEventRegister(has_member{});}\n  private:\n\n  struct has_not_member{};\n\n  struct has_member:public has_not_member{};\n\n  template&lt;class X&gt; struct cb_test\n  {typedef int type;};\n\n  template&lt;typename cb_test&lt;decltype(&amp;Callback::barEvent)&gt;::type=0&gt;\n  void barEventRegister(has_member)\n  {\n    //register callback for bar\n  }\n\n  void barEventRegister(has_member)\n  {\n    //do nothing\n  }\n};\n\nstruct MyCallback\n{\n};\n\nint main()\n{\n  Foo&lt;MyCallback&gt; foo;\n}\n</code></pre>\n\n<p>But I get</p>\n\n<pre><code>template&lt;typename cb_test&lt;decltype(&amp;Callback::barEvent)&gt;::type=0&gt;\nvoid barEventRegister(has_not_member)\nerror: 'barEvent' is not a member of 'MyCallback' \n</code></pre>\n\n<p>It appears that the invalid template is instantiated anyways. Is that because <code>Callback</code> is part of the class template, and not the registration routine?</p>\n"}, {"tags": ["c++", "ios", "objective-c", "xcode", "cocos2d-x"], "comments": [{"owner": {"reputation": 8941, "user_id": 1395203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077aa768ec769dc595292f2496e17930?s=128&d=identicon&r=PG", "display_name": "dan", "link": "https://stackoverflow.com/users/1395203/dan"}, "edited": false, "score": 0, "creation_date": 1484767743, "post_id": 41727671, "comment_id": 70650110, "body": "See: <a href=\"https://www.raywenderlich.com/10209/my-app-crashed-now-what-part-1\" rel=\"nofollow noreferrer\">raywenderlich.com/10209/my-app-crashed-now-what-part-1</a>"}, {"owner": {"reputation": 896, "user_id": 5031606, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/oL6kk.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/5031606/alex"}, "edited": false, "score": 0, "creation_date": 1484773892, "post_id": 41727671, "comment_id": 70653470, "body": "The error was probably caused somewhere else. You should ad some NSlog along the path to identify what was the last instruction executed before crashing."}, {"owner": {"reputation": 10190, "user_id": 5236226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ffj4X.jpg?s=128&g=1", "display_name": "Caleb Kleveter", "link": "https://stackoverflow.com/users/5236226/caleb-kleveter"}, "edited": false, "score": 0, "creation_date": 1484839495, "post_id": 41727671, "comment_id": 70683725, "body": "Are there any blue arrows on the left side of the code? If so, select them and try running your project again."}, {"owner": {"reputation": 131, "user_id": 6828371, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/2f6ba189d2267604ef1ddcc76d3ee98d?s=128&d=identicon&r=PG&f=1", "display_name": "Bran", "link": "https://stackoverflow.com/users/6828371/bran"}, "reply_to_user": {"reputation": 10190, "user_id": 5236226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ffj4X.jpg?s=128&g=1", "display_name": "Caleb Kleveter", "link": "https://stackoverflow.com/users/5236226/caleb-kleveter"}, "edited": false, "score": 0, "creation_date": 1484866492, "post_id": 41727671, "comment_id": 70698960, "body": "@CalebKleveter nope there isn&#39;t any blue arrows."}], "owner": {"reputation": 131, "user_id": 6828371, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/2f6ba189d2267604ef1ddcc76d3ee98d?s=128&d=identicon&r=PG&f=1", "display_name": "Bran", "link": "https://stackoverflow.com/users/6828371/bran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 938, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484767461, "creation_date": 1484767032, "last_edit_date": 1484767461, "question_id": 41727671, "link": "https://stackoverflow.com/questions/41727671/error-after-compiling-thread-1-signal-sigabrt", "title": "Error after compiling &quot;Thread 1: signal SIGABRT", "body": "<p>I am getting this error after compile my app the app is just frozen it worked before, but now it freezing and not loading. Code where it shows this error:        </p>\n\n<pre><code>#import &lt;UIKit/UIKit.h&gt;\n\nint main(int argc, char *argv[]) {\n\nNSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];\n\nint retVal = UIApplicationMain(argc, argv, nil, @\"AppController\");//(error is on this line)\n\n[pool release];\n\nreturn retVal;\n\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "windows", "audio"], "comments": [{"owner": {"reputation": 2103, "user_id": 1865694, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bP5UU.jpg?s=128&g=1", "display_name": "Alex Zywicki", "link": "https://stackoverflow.com/users/1865694/alex-zywicki"}, "edited": false, "score": 0, "creation_date": 1484781757, "post_id": 41727448, "comment_id": 70656755, "body": "Have a look at PortAudio: <a href=\"http://www.portaudio.com\" rel=\"nofollow noreferrer\">portaudio.com</a>"}, {"owner": {"reputation": 6079, "user_id": 734335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9047f5d438178c9530b93f39f0126c2?s=128&d=identicon&r=PG", "display_name": "Mathieu Rodic", "link": "https://stackoverflow.com/users/734335/mathieu-rodic"}, "edited": false, "score": 0, "creation_date": 1486350335, "post_id": 41727448, "comment_id": 71291933, "body": "Have a look here: <a href=\"http://stackoverflow.com/questions/25291097/capture-global-audio-output-in-c-portaudio\" title=\"capture global audio output in c portaudio\">stackoverflow.com/questions/25291097/&hellip;</a>"}], "owner": {"reputation": 15, "user_id": 5372576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fkgFy.png?s=128&g=1", "display_name": "Hate9", "link": "https://stackoverflow.com/users/5372576/hate9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 687, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1484766286, "creation_date": 1484766286, "question_id": 41727448, "link": "https://stackoverflow.com/questions/41727448/recording-audio-from-output-device", "title": "Recording audio from output device", "body": "<p>I'm trying to set up a program to record audio in windows, and I need to record from the output device. I'm looking into using the waveform audio interface, but I can't find a way to use the output device for recording.</p>\n\n<p>Is there any way to make a hook in between the windows sound mixer and the physical output device?</p>\n"}, {"tags": ["c++", "arrays", "multidimensional-array", "new-operator"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1484767273, "post_id": 41727432, "comment_id": 70649871, "body": "@Muscampester  No, I do not add anything"}], "answers": [{"tags": [], "owner": {"reputation": 1694, "user_id": 1791696, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6cf769c74a837d280bdbf90d0d824e0?s=128&d=identicon&r=PG", "display_name": "joeking", "link": "https://stackoverflow.com/users/1791696/joeking"}, "is_accepted": false, "score": 1, "last_activity_date": 1484769256, "last_edit_date": 1484769256, "creation_date": 1484768850, "answer_id": 41728179, "question_id": 41727432, "link": "https://stackoverflow.com/questions/41727432/allocating-memory-to-pointer-multidimensional-array-with-new/41728179#41728179", "title": "Allocating memory to pointer multidimensional array with new", "body": "<p>Because in C, \"int *p\" has two interpretations.\nYou can consider P to be a pointer to a single integer, but it can also be considered to be a pointer to an array of integer.</p>\n\n<p>A common example, strings.\nchar *a = \"hello\";</p>\n\n<p>\"a\" is a pointer to a single character, 'h', but more commonly it is treated as a pointer to an array of characters, aka a string.</p>\n\n<p>So, you can do this:\n    char * a = new char[6];\n    strcpy(a, \"hello\");</p>\n\n<p>I believe that your third example is not valid C++.</p>\n\n<p>While this:\n   p = new int [9][3][4];\nAllocates an array of 9 two dimensional arrays of 3x4.</p>\n\n<p>Try this test:</p>\n\n<pre><code>int test()\n{\n    int(* p)[3][4] = new int[1][3][4];\n\n    printf(\"sizeof(p)=%d, sizeof(*p)=%d\\n\", sizeof(p), sizeof(*p) / sizeof(int));\n\n    size_t q1 = (size_t)&amp;p[0][0][0];\n    size_t q2 = (size_t)&amp;p[1][0][0];\n    printf(\"p, diff: %d\\n\", (q2 - q1) / sizeof(int));\n\n    size_t r1 = (size_t)&amp;p[0][0][0];\n    size_t r2 = (size_t)&amp;p[0][1][0];\n    printf(\"p, diff: %d\\n\", (r2 - r1) / sizeof(int));\n\n    size_t s1 = (size_t)&amp;p[0][0][0];\n    size_t s2 = (size_t)&amp;p[0][0][1];\n    printf(\"p, diff: %d\\n\", (s2 - s1) / sizeof(int));\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "is_accepted": false, "score": 2, "last_activity_date": 1484770445, "last_edit_date": 1495541338, "creation_date": 1484769349, "answer_id": 41728324, "question_id": 41727432, "link": "https://stackoverflow.com/questions/41727432/allocating-memory-to-pointer-multidimensional-array-with-new/41728324#41728324", "title": "Allocating memory to pointer multidimensional array with new", "body": "<p>c++ is a strongly typed language. <code>int</code> is not the same as <code>int*</code>. Likewise <code>int[3]</code> is not the same type as <code>int*</code>. But just lightly poke <code>int[3]</code> with a stick and it will fall apart and decay to an <code>int*</code>. c++ does this because c does it.</p>\n\n<hr>\n\n<blockquote>\n  <p>Why can't I allocate memory like following?</p>\n\n<pre><code>p = new int[3][4];\n</code></pre>\n</blockquote>\n\n<p>Because the <code>new</code> is returning a pointer to <code>int[4]</code>:</p>\n\n<pre><code>auto p1 = new int[3][4]; // int(*p1)[4]\n</code></pre>\n\n<p>The array has <a href=\"https://stackoverflow.com/a/14183554/1460794\">decayed</a> to a pointer. It has <a href=\"https://stackoverflow.com/a/1461449/1460794\">lost the type and first dimension</a>. It would be best to avoid pointers for arrays and stick to <a href=\"https://stackoverflow.com/a/17569578/1460794\">using templates and references</a>. Or better yet, prefer <code>std::vector</code> or <code>std::array</code>. </p>\n\n<p>You could have multiple pointers to the same address, <a href=\"https://stackoverflow.com/a/12674201/1460794\">but with different types</a>, which <a href=\"https://stackoverflow.com/a/22984784/1460794\">can be confusing</a>.</p>\n\n<hr>\n\n<blockquote>\n  <p>2) It should be like following to work. But why?</p>\n\n<pre><code>p = new int [1][3][4];\n</code></pre>\n</blockquote>\n\n<p>In this example the array of <code>int[3][4]</code>s has also decayed to a pointer:</p>\n\n<pre><code>auto p2 = new int [1][3][4]; // int(*p2)[3][4]\n</code></pre>\n\n<p>So here the value returned by <code>new</code> can be assigned to <code>p</code> because it has the same type. Note however that the pointer type doesn't include information about the size of the array, it only has a type that points to elements which happen to be arrays of a lower dimension (that haven't decayed to pointers).</p>\n\n<hr>\n\n<blockquote>\n  <p>3) What does following line of code mean? It is semantically correct\n  but what is it doing? What is significance of empty [] in following\n  line?</p>\n\n<pre><code>p = new int [ ][3][4];\n</code></pre>\n</blockquote>\n\n<p>This might not always compile, and if it does then it is a <a href=\"https://stackoverflow.com/a/2717851/1460794\">compiler extension</a> that will determine the value of the empty square brackets.</p>\n"}], "owner": {"reputation": 1136, "user_id": 532599, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5965a6f854eaca5f03dca49a54761b47?s=128&d=identicon&r=PG", "display_name": "Pervez Alam", "link": "https://stackoverflow.com/users/532599/pervez-alam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1484770445, "creation_date": 1484766219, "last_edit_date": 1484768018, "question_id": 41727432, "link": "https://stackoverflow.com/questions/41727432/allocating-memory-to-pointer-multidimensional-array-with-new", "title": "Allocating memory to pointer multidimensional array with new", "body": "<p>I can't understand some basic thing in c++ and have been wondering. Please help me.\nI understand that p points to memory that would be a 2D int matrix of 3x4 size.</p>\n\n<pre><code>int(*p)[3][4];\n</code></pre>\n\n<p>1) Why can't I allocate memory like following?</p>\n\n<pre><code>p = new int[3][4];\n</code></pre>\n\n<p>2) It should be like following to work. But why?</p>\n\n<pre><code>p = new int [1][3][4];    //or new int [5][3][4]; etc\n</code></pre>\n\n<p>3) What does following line of code mean? It is semantically correct but what is it doing? What is significance of empty [] in following line?</p>\n\n<pre><code>p = new int [ ][3][4];\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 3, "creation_date": 1484765742, "post_id": 41727246, "comment_id": 70649019, "body": "And what is the problem? Do you can not read the error message?"}, {"owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "edited": false, "score": 3, "creation_date": 1484765806, "post_id": 41727246, "comment_id": 70649056, "body": "Change <code>tmp[i]-&gt;check(tmp[0]);</code> by <code>tmp[i]-&gt;check(*(tmp[0]));</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7437344"}, "edited": false, "score": 0, "creation_date": 1484843351, "post_id": 41727246, "comment_id": 70686470, "body": "Thanks. tmp[i]-&gt;check(*(tmp[0])); solves the problem."}], "answers": [{"tags": [], "owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "is_accepted": false, "score": 3, "last_activity_date": 1484765782, "creation_date": 1484765782, "answer_id": 41727296, "question_id": 41727246, "link": "https://stackoverflow.com/questions/41727246/c-error-no-matching-function-for-call-g-compiler/41727296#41727296", "title": "C++ error: no matching function for call, G++ compiler", "body": "<p>Your vector contains pointers to <code>one</code>, </p>\n\n<pre><code>vector&lt;one*&gt; tmp;\n</code></pre>\n\n<p>but you try to call check, which takes a reference to one:</p>\n\n<pre><code>void check(one&amp; a)\n</code></pre>\n\n<p>and the compiler tells you exactly that.</p>\n\n<p>So, either you don't store pointers in <code>tmp</code>, or you derefence when calling <code>check</code>, or you make <code>check</code> accept pointers.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7437344"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 620, "favorite_count": 0, "closed_date": 1484785685, "answer_count": 1, "score": 0, "last_activity_date": 1484767775, "creation_date": 1484765581, "last_edit_date": 1484767775, "question_id": 41727246, "link": "https://stackoverflow.com/questions/41727246/c-error-no-matching-function-for-call-g-compiler", "closed_reason": "Not suitable for this site", "title": "C++ error: no matching function for call, G++ compiler", "body": "<p>Good evening,</p>\n\n<p>First of all I did search for question in topic, but unfortunately none of hints\nand suggestion work for me. Simple code below:</p>\n\n<pre><code>random_device rd;   \nmt19937 rng(rd());    \nuniform_int_distribution&lt;int&gt; wspolrzedna(1, 19); \nuniform_int_distribution&lt;int&gt; kierunek(0, 3); \n\nclass one {\n    public: \n        int x, y, direction; \n        bool collision = false;\n\n        one(int x, int y, int k):x(x),y(y),direction(k) {\n        };\n        one(){};\n        ~one() {};\n\n        void check(one&amp; a){\n            if((a.x==x) &amp;&amp; (a.y==y)){\n                a.collision =true;\n                collision =true;\n            }\n        };\n};\n\nclass two : public one {\n    public: \n        int x,y,k,ms;   \n\n        two(int x, int y, int k, int m):one(x,y,k),ms(m){                           \n        };\n        two(){};\n        ~two() {};  \n};\n\nint main(int argc, char *argv[]){\n\n    vector&lt;one*&gt; tmp;\n\n    tmp.push_back(new two(1, 2, 0,3)); \n    for(int i=0;i&lt;2;i++)\n        tmp.push_back(new one(wspolrzedna(rng),wspolrzedna(rng),kierunek(rng)));\n\n    for(int i=1;i&lt;2;i++)\n        tmp[i]-&gt;check(tmp[0]);\n\n    return 0;\n}\n</code></pre>\n\n<p>In short, I want to compare x of one object (tmp[0]) with x of the other object (tmp[1] and tmp[2]). (and the same for y coordinate). \nCompiler (G++) error:</p>\n\n<blockquote>\n  <p>g++ -std=gnu++11 stack.cpp -o stack</p>\n</blockquote>\n\n<pre><code>stack.cpp: In function 'int main(int, char**)':\nstack.cpp:56:23: error: no matching function for call to 'one::check(one*&amp;)'\ntmp[i]-&gt;check(tmp[0]);\n                   ^\nstack.cpp:26:7: note: candidate: void one::check(one&amp;)\nvoid check(one&amp; a){\n   ^&lt;p&gt;\nstack.cpp:26:7: note:   no known conversion for argument 1 from \n'__gnu_cxx::__al\nloc_traits&lt;std::allocator&lt;one*&gt; &gt;::value_type {aka one*}' to 'one&amp;'&lt;p&gt;\n</code></pre>\n\n<p>I have a default constructor and at the moment no clue how to fix this. </p>\n"}, {"tags": ["c++", "c++11", "intel", "icc"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1484765772, "post_id": 41727220, "comment_id": 70649037, "body": "Is it normal that your Intel compiler is using GCC headers? I have a feeling that&#39;s not going to work. Maybe you should use the Intel equivalent of same."}, {"owner": {"reputation": 256, "user_id": 6895884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eHvmo.jpg?s=128&g=1", "display_name": "Eisa", "link": "https://stackoverflow.com/users/6895884/eisa"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1484765962, "post_id": 41727220, "comment_id": 70649124, "body": "Well, the Piece of code is not written by me. It is part of a test for compiling a bigger software. If this code does not return an error, it let me compile. So changing the code is not what I can do. that is solid and given."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484766163, "post_id": 41727220, "comment_id": 70649211, "body": "You say that and yet your compiler disagrees. Each vendor has their own implementation of the Standard Library and you can&#39;t just arbitrarily mix and match headers with compilers."}, {"owner": {"reputation": 256, "user_id": 6895884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eHvmo.jpg?s=128&g=1", "display_name": "Eisa", "link": "https://stackoverflow.com/users/6895884/eisa"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484766273, "post_id": 41727220, "comment_id": 70649266, "body": "@tadman Intel says that to be able to use full functionality of c++11 I need to have gcc-4.8 or later, so they should be connected somehow: <i>1: * Full C++11 support requires gcc 4.8 environment or newer on Linux</i> <a href=\"https://software.intel.com/en-us/articles/c0x-features-supported-by-intel-c-compiler\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484766398, "post_id": 41727220, "comment_id": 70649335, "body": "So why not follow their advice and <i>use</i> the GCC compiler?"}, {"owner": {"reputation": 256, "user_id": 6895884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eHvmo.jpg?s=128&g=1", "display_name": "Eisa", "link": "https://stackoverflow.com/users/6895884/eisa"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484766673, "post_id": 41727220, "comment_id": 70649483, "body": "that advice was for 2014, you think it still applies? that will be bad news then"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484766948, "post_id": 41727220, "comment_id": 70649677, "body": "What I think is a bad idea is forcing one compiler to use another&#39;s internal headers. If you need to use GCC, if GCC works, then use GCC. If you need to support Intel&#39;s compiler, use Intel&#39;s compiler&#39;s headers."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 4, "creation_date": 1484771370, "post_id": 41727220, "comment_id": 70652099, "body": "<code>_Compare</code> is one of the template parameters of the <code>_Rb_tree&lt;_Key, _Val, _KeyOfValue, _Compare, _Alloc&gt;</code> defined in that file, so surely it is defined. A suspicion is that the Intel compiler perhaps doesn&#39;t know about <code>is_nothrow_move_assignable</code> which is kind of recently added to the type_traits. A bug report might be in order."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1484771507, "post_id": 41727220, "comment_id": 70652162, "body": "@tadman It&#39;s perfectly normal. ICC piggybacks on the platform compiler&#39;s standard library implementation (GCC&#39;s for Linux, MSVC&#39;s for Windows). It doesn&#39;t come with its own standard library implementation."}, {"owner": {"reputation": 256, "user_id": 6895884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eHvmo.jpg?s=128&g=1", "display_name": "Eisa", "link": "https://stackoverflow.com/users/6895884/eisa"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1484778185, "post_id": 41727220, "comment_id": 70655495, "body": "@BoPersson This is helpful enough. Thank you very much. Please provide an answer so I can mark it as the correct one."}], "answers": [{"tags": [], "owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "is_accepted": false, "score": 3, "last_activity_date": 1484810993, "creation_date": 1484810993, "answer_id": 41736135, "question_id": 41727220, "link": "https://stackoverflow.com/questions/41727220/error-with-intel-c-compiler-identifier-compare-is-undefined/41736135#41736135", "title": "Error with Intel C++ compiler: identifier &quot;_Compare&quot; is undefined", "body": "<p><em>From the comments above:</em></p>\n\n<p><code>_Compare</code> is one of the template parameters of the <code>_Rb_tree&lt;_Key, _Val, _KeyOfValue, _Compare, _Alloc&gt;</code> defined in that file, so surely it is defined. </p>\n\n<p>A more likely reason is that the Intel compiler perhaps doesn't know about <code>is_nothrow_move_assignable</code> which is kind of recently added to the type_traits.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 7638396, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6ba0b237364b36ec149dbd87e07d4dd8?s=128&d=identicon&r=PG", "display_name": "Doug Baxter", "link": "https://stackoverflow.com/users/7638396/doug-baxter"}, "is_accepted": false, "score": 3, "last_activity_date": 1488327101, "creation_date": 1488327101, "answer_id": 42521015, "question_id": 41727220, "link": "https://stackoverflow.com/questions/41727220/error-with-intel-c-compiler-identifier-compare-is-undefined/42521015#42521015", "title": "Error with Intel C++ compiler: identifier &quot;_Compare&quot; is undefined", "body": "<p>I had a user with a similar c++ difficulty using gcc-6.3.0 headers and the Intel 16.1.150 compiler. I opted for the compiler bug theory, tried with the Intel 17 compiler and things worked.\n-doug</p>\n"}, {"tags": [], "owner": {"reputation": 256, "user_id": 6895884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eHvmo.jpg?s=128&g=1", "display_name": "Eisa", "link": "https://stackoverflow.com/users/6895884/eisa"}, "is_accepted": true, "score": 0, "last_activity_date": 1488654266, "creation_date": 1488654266, "answer_id": 42600095, "question_id": 41727220, "link": "https://stackoverflow.com/questions/41727220/error-with-intel-c-compiler-identifier-compare-is-undefined/42600095#42600095", "title": "Error with Intel C++ compiler: identifier &quot;_Compare&quot; is undefined", "body": "<p>Well I checked with Intel agents and it turned out that Intel 16 do not support gcc6.3, the support comes in Intel 17.</p>\n"}], "owner": {"reputation": 256, "user_id": 6895884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eHvmo.jpg?s=128&g=1", "display_name": "Eisa", "link": "https://stackoverflow.com/users/6895884/eisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 844, "favorite_count": 0, "accepted_answer_id": 42600095, "answer_count": 3, "score": 0, "last_activity_date": 1488654266, "creation_date": 1484765467, "last_edit_date": 1484765735, "question_id": 41727220, "link": "https://stackoverflow.com/questions/41727220/error-with-intel-c-compiler-identifier-compare-is-undefined", "title": "Error with Intel C++ compiler: identifier &quot;_Compare&quot; is undefined", "body": "<p>I am able to compile the following a std=c++11 required code with g++ using the following command:</p>\n\n<p><code>g++ test.cpp -std=c++11 -Wl,-rpath,/share/apps/gcc/6.3.0/lib64</code></p>\n\n<p>the code:</p>\n\n<pre><code>#include &lt;chrono&gt;\n#include &lt;map&gt;\n#include &lt;memory&gt;\n#include &lt;thread&gt;\n#include &lt;utility&gt;\nint main() {\n  typedef std::unique_ptr&lt;int&gt; intPointer;\n  intPointer p(new int(10));\n  std::map&lt;int, std::unique_ptr&lt;int&gt;&gt; m;\n  m.insert(std::make_pair(5, std::move(p)));\n  auto start = std::chrono::system_clock::now();\n  if (std::chrono::system_clock::now() - start &lt; std::chrono::seconds(2))\n  {\n      std::thread t;\n  }\n}\n</code></pre>\n\n<p>The very same command(probably I don't know the correct one) wont work for intel compiler:</p>\n\n<pre><code>icpc test.cpp -std=c++11 -Wl,-rpath,/share/apps/intel/2016.1.056/vtune_amplifier_xe_2016.1.1.434111/target/linux64/lib64\n</code></pre>\n\n<p>The error is:</p>\n\n<pre><code>In file included from /share/apps/gcc/6.3.0/include/c++/6.3.0/map(60),\n             from test.cpp(2):\n/share/apps/gcc/6.3.0/include/c++/6.3.0/bits/stl_tree.h(1437): \nerror: identifier \"_Compare\" is undefined\n     &amp;&amp; is_nothrow_move_assignable&lt;_Compare&gt;::value)\n                                   ^\n\nIn file included from /share/apps/gcc/6.3.0/include/c++/6.3.0/map(60),\n             from test.cpp(2):\n/share/apps/gcc/6.3.0/include/c++/6.3.0/bits/stl_tree.h(1778): \nerror: identifier \"_Compare\" is undefined\n  _GLIBCXX_NOEXCEPT_IF(__is_nothrow_swappable&lt;_Compare&gt;::value)\n  ^\n</code></pre>\n\n<p>What am I doing wrong, and how should I fix this.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 2131, "user_id": 3726169, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ad0f33269912ab7a2fb9f30df6f2d392?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Chesterfield", "link": "https://stackoverflow.com/users/3726169/jon-chesterfield"}, "edited": false, "score": 0, "creation_date": 1485686343, "post_id": 41727129, "comment_id": 71020852, "body": "Have you considered structuring the application in terms of transactions? That provides most of the functionality and could push the save/undo logic above most of the application"}, {"owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "reply_to_user": {"reputation": 2131, "user_id": 3726169, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ad0f33269912ab7a2fb9f30df6f2d392?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Chesterfield", "link": "https://stackoverflow.com/users/3726169/jon-chesterfield"}, "edited": false, "score": 0, "creation_date": 1485692908, "post_id": 41727129, "comment_id": 71022543, "body": "@JonChesterfield What do you mean by transactions? Can you elaborate?"}, {"owner": {"reputation": 2131, "user_id": 3726169, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ad0f33269912ab7a2fb9f30df6f2d392?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Chesterfield", "link": "https://stackoverflow.com/users/3726169/jon-chesterfield"}, "edited": false, "score": 1, "creation_date": 1485721435, "post_id": 41727129, "comment_id": 71031510, "body": "I mean the standard database or source control mechanism. Build up a lot of state which is committed atomically (that&#39;s the &#39;transaction&#39;), then record what the net effect of the transaction was. How sophisticated you make this is up to you - one extreme is git&#39;s model. An easy approach is to feed the state into sqlite."}, {"owner": {"reputation": 4179, "user_id": 7282091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea62f0d9ff8ecd926a64b74f39aa73b?s=128&d=identicon&r=PG&f=1", "display_name": "fedepad", "link": "https://stackoverflow.com/users/7282091/fedepad"}, "edited": false, "score": 1, "creation_date": 1485733466, "post_id": 41727129, "comment_id": 71035112, "body": "Have you checked out the followings if they could help you in your case? For example: <a href=\"http://doc.qt.io/qt-5/qundocommand.html\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/qundocommand.html</a> and an extra example <a href=\"http://doc.qt.io/qt-5/qtwidgets-tools-undoframework-example.html\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/qtwidgets-tools-undoframework-example.html</a> ,  <a href=\"https://github.com/aseprite/undo\" rel=\"nofollow noreferrer\">github.com/aseprite/undo</a> , <a href=\"https://github.com/d-led/undoredo-cpp\" rel=\"nofollow noreferrer\">github.com/d-led/undoredo-cpp</a> , <a href=\"https://github.com/catnapgames/NLHistory\" rel=\"nofollow noreferrer\">github.com/catnapgames/NLHistory</a> ."}, {"owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "reply_to_user": {"reputation": 2131, "user_id": 3726169, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ad0f33269912ab7a2fb9f30df6f2d392?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Chesterfield", "link": "https://stackoverflow.com/users/3726169/jon-chesterfield"}, "edited": false, "score": 0, "creation_date": 1486060089, "post_id": 41727129, "comment_id": 71194870, "body": "@JonChesterfield: Is there anything similar to protocol buffers which will generate the boilerplate/nice-api for storing the state in sqlite? Or an easy way to do it?"}, {"owner": {"reputation": 4179, "user_id": 7282091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea62f0d9ff8ecd926a64b74f39aa73b?s=128&d=identicon&r=PG&f=1", "display_name": "fedepad", "link": "https://stackoverflow.com/users/7282091/fedepad"}, "edited": false, "score": 0, "creation_date": 1486066361, "post_id": 41727129, "comment_id": 71198330, "body": "@yairchu I know you&#39;re looking for kind of a code/API generator, but I added the link to ODB in the answer anyway, which might handle some details or using extra code for you in case you want to save in sqlite for example as you&#39;re mentioning."}, {"owner": {"reputation": 59687, "user_id": 951890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01c3ef0adae5153378a3f602ca068a03?s=128&d=identicon&r=PG", "display_name": "Vaughn Cato", "link": "https://stackoverflow.com/users/951890/vaughn-cato"}, "edited": false, "score": 0, "creation_date": 1486218844, "post_id": 41727129, "comment_id": 71256384, "body": "Have you consider just storing the entire state on every action and restoring it on undo?  It&#39;s potentially inefficient if the state is large, but easy to implement.  If necessary, you can improve efficiency by being more selective about the parts of the state you store for each action."}], "answers": [{"comments": [{"owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 1, "creation_date": 1485684418, "post_id": 41919668, "comment_id": 71020358, "body": "Ideally there will be an undo-stack for more than just the latest action.. Also saving to file after each action is quite costly / drains the battery."}, {"owner": {"reputation": 2174, "user_id": 2369389, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/f3URs.jpg?s=128&g=1", "display_name": "madduci", "link": "https://stackoverflow.com/users/2369389/madduci"}, "reply_to_user": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 1, "creation_date": 1485684544, "post_id": 41919668, "comment_id": 71020393, "body": "The filesystem store was an example, but without knowing how big the diagram is, I wasn&#39;t assuming to keep it in memory, which is also costly."}, {"owner": {"reputation": 2174, "user_id": 2369389, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/f3URs.jpg?s=128&g=1", "display_name": "madduci", "link": "https://stackoverflow.com/users/2369389/madduci"}, "reply_to_user": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 0, "creation_date": 1485686935, "post_id": 41919668, "comment_id": 71021010, "body": "@yairchu I&#39;ve updated the reply with an example of incremental undos and redisplay"}], "tags": [], "owner": {"reputation": 2174, "user_id": 2369389, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/f3URs.jpg?s=128&g=1", "display_name": "madduci", "link": "https://stackoverflow.com/users/2369389/madduci"}, "is_accepted": false, "score": 1, "last_activity_date": 1485684773, "last_edit_date": 1485684773, "creation_date": 1485684287, "answer_id": 41919668, "question_id": 41727129, "link": "https://stackoverflow.com/questions/41727129/mechanism-for-save-loadundo-redo-with-minimum-boilerplate/41919668#41919668", "title": "Mechanism for Save/Load+Undo/Redo with minimum boilerplate", "body": "<p>Assuming that you're calling save() on a temporary file for each edit of the  diagram (even if user doesn't explicitly call the <strong>save</strong> action) and that you undo only the latest action, you can do as follows:</p>\n\n<pre><code>LastDiagram load(const std::string &amp;path)\n{\n  /* Check for valid path (e.g. boost::filesystem here) */\n  if(!found)\n  {\n    throw std::runtime_exception{\"No diagram found\"};\n  } \n  //read LastDiagram\n  return LastDiagram;\n}\nLastDiagram undoLastAction()\n{\n    return loadLastDiagram(\"/tmp/tmp_diagram_file\");\n}\n</code></pre>\n\n<p>and in your main app you handle the exception if thrown. In case you want to allow more undos, then you should think to a solution like sqlite or a tmp file with more entries. </p>\n\n<p>If performance in time and space are issues due large diagrams, think to implement some strategy like keeping an incremental difference for each element of a diagram in a std::vector (limit it to 3/5 if objects are big) and call the renderer with the current statuses. I'm not an OpenGL expert, but I think it's the way it's done there. Actually you could 'steal' this strategy from game development best practices, or generally graphics related ones.</p>\n\n<p>One of those strategies could be something like this:</p>\n\n<p><a href=\"http://www.academia.edu/1070596/A_structure_for_efficient_update_incremental_redisplay_and_undo_in_graphical_editors\" rel=\"nofollow noreferrer\">A structure for efficient update, incremental redisplay and undo in graphical editors</a></p>\n"}, {"comments": [{"owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 1, "creation_date": 1485774909, "post_id": 41927362, "comment_id": 71049271, "body": "All of these links define an equivalent of the <code>UndoableAction</code> that I need, but don&#39;t seem to provide a solution to the boilerplate problem. Had Qt had a lot of implemented <code>QUndoCommand</code> subclasses to support modifying all of these structures that <code>QDataStream</code> support it would had been helpful (it would be a lot of tested existing boilerplate so that I won&#39;t need to implement it myself)."}, {"owner": {"reputation": 4179, "user_id": 7282091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea62f0d9ff8ecd926a64b74f39aa73b?s=128&d=identicon&r=PG&f=1", "display_name": "fedepad", "link": "https://stackoverflow.com/users/7282091/fedepad"}, "reply_to_user": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 1, "creation_date": 1486071457, "post_id": 41927362, "comment_id": 71201074, "body": "Added Flip, Txnmgr, ODB. I know you are looking basically for code/API generator, but I think these last projects I added, especially ODB might be useful for you."}, {"owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 0, "creation_date": 1486288712, "post_id": 41927362, "comment_id": 71273829, "body": "Flip and ODB seem very relevant and oriented towards my needs with a focus on reducing boilerplate, thanks!"}, {"owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 0, "creation_date": 1486291081, "post_id": 41927362, "comment_id": 71274370, "body": "I edited your answer to highlight the two solutions that seem most relevant, I hope its fine by you :)"}, {"owner": {"reputation": 4179, "user_id": 7282091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea62f0d9ff8ecd926a64b74f39aa73b?s=128&d=identicon&r=PG&f=1", "display_name": "fedepad", "link": "https://stackoverflow.com/users/7282091/fedepad"}, "reply_to_user": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 1, "creation_date": 1486298649, "post_id": 41927362, "comment_id": 71276471, "body": "@yairchu Wow, really cool! I REALLY like it, you were super fast in checking them out! Of course it&#39;s fine by me!!! I like when answer gets improved ;)"}], "tags": [], "owner": {"reputation": 4179, "user_id": 7282091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea62f0d9ff8ecd926a64b74f39aa73b?s=128&d=identicon&r=PG&f=1", "display_name": "fedepad", "link": "https://stackoverflow.com/users/7282091/fedepad"}, "is_accepted": false, "score": 7, "last_activity_date": 1486292012, "last_edit_date": 1486292012, "creation_date": 1485734717, "answer_id": 41927362, "question_id": 41727129, "link": "https://stackoverflow.com/questions/41727129/mechanism-for-save-loadundo-redo-with-minimum-boilerplate/41927362#41927362", "title": "Mechanism for Save/Load+Undo/Redo with minimum boilerplate", "body": "<p>Two reasonable approaches to this problem are implemented in the frameworks <a href=\"https://irisate.com/flip-overview/\" rel=\"nofollow noreferrer\">Flip</a> and <a href=\"http://www.codesynthesis.com/products/odb/\" rel=\"nofollow noreferrer\">ODB</a>.</p>\n\n<h3>Code-generation / ODB</h3>\n\n<p>With ODB you need to add <code>#pragma</code> declarations to your code, and have it's tool generate methods that you use for save/load and for editing the model, like so:</p>\n\n<pre><code>#pragma db object\nclass person\n{\npublic:\n    void setName (string);\n    string getName();\n    ...\nprivate:\n    friend class odb::access;\n    person () {}\n\n    #pragma db id\n    string email_;\n\n    string name_;\n };\n</code></pre>\n\n<p>Where the accessors declared in the class are auto-generated by ODB so that all changes to the model can get captured and undo-transactions may be made for them.</p>\n\n<h3>Reflection with minimal boilerplate / Flip</h3>\n\n<p>Unlike ODB, Flip doesn't generate C++ code for you, but rather it requires your program to call <code>Model::declare</code> to re-declare your structures like so:</p>\n\n<pre><code>class Song : public flip::Object\n{\npublic:\n    static void declare ();\n    flip::Float tempo;\n    flip::Array &lt;Track&gt; tracks;\n};\n\nvoid Song::declare ()\n{\n    Model::declare &lt;Song&gt; ()\n    .name (\"acme.product.Song\")\n    .member &lt;flip::Float, &amp;Song::tempo&gt; (\"tempo\");\n    .member &lt;flip::Array &lt;Track&gt;, &amp;Song::tracks&gt; (\"tracks\");\n}\n\nint main()\n{\n    Song::declare();\n    ...\n}\n</code></pre>\n\n<p>With the structured declared like so, <code>flip::Object</code>'s constructor can initialize all the fields so that they can point to the undo stack, and all the edits on them are recorded. It also has a list of all the members so that <code>flip::Object</code> can implement the serialization for you.</p>\n"}, {"comments": [{"owner": {"reputation": 1743, "user_id": 2192832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2217d886c1805ab7398ffefb379ff71?s=128&d=identicon&r=PG", "display_name": "ivan_onys", "link": "https://stackoverflow.com/users/2192832/ivan-onys"}, "edited": false, "score": 0, "creation_date": 1486284239, "post_id": 41977415, "comment_id": 71272614, "body": "When proposing a solution, a good thing to have is a list of pros and cons. Described approach requires explicitly specifying all actions and to extend actions list you have to edit the source, not just add new class implementing the interface as e.g. in command pattern."}], "tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": false, "score": 11, "last_activity_date": 1486042435, "last_edit_date": 1486042435, "creation_date": 1485945060, "answer_id": 41977415, "question_id": 41727129, "link": "https://stackoverflow.com/questions/41727129/mechanism-for-save-loadundo-redo-with-minimum-boilerplate/41977415#41977415", "title": "Mechanism for Save/Load+Undo/Redo with minimum boilerplate", "body": "<blockquote>\n  <p>The problem with the simple way described above is that it requires a lot of error-prone boilerplate work.</p>\n</blockquote>\n\n<p>I am not convinced that this is the case. Your approach sounds reasonable and using Modern C++ features and abstractions you can implement a safe and elegant interface for it.</p>\n\n<p>For starters, you could use <a href=\"http://en.cppreference.com/w/cpp/utility/variant\"><code>std::variant</code></a> as a <em>sum type</em> for <strong>\"undoable actions\"</strong> - this will give you a <em>type-safe tagged union</em> for every action. <em>(Consider using <code>boost::variant</code> or other implementations that can be easily found on Google if you do not have access to C++17)</em>. Example: </p>\n\n<pre><code>namespace action\n{\n    // User dragged the shape to a separate position.\n    struct move_shape\n    {\n        shape_id _id;\n        offset _offset;\n    };\n\n    // User changed the color of a shape.\n    struct change_shape_color\n    {\n        shape_id _id;\n        color _previous;\n        color _new;\n    };\n\n    // ...more actions...\n}\n\nusing undoable_action = std::variant&lt;\n    action::move_shape,\n    action::change_shape_color,\n    // ...\n&gt;;\n</code></pre>\n\n<p>Now that you have a <em>sum type</em> for all your possible \"undoable actions\", you can define <em>undo behavior</em> by using <strong>pattern matching</strong>. I wrote two articles on <code>variant</code> \"pattern matching\" by overloading lambdas that you could find interesting:</p>\n\n<ul>\n<li><p><a href=\"https://vittorioromeo.info/index/blog/variants_lambdas_part_1.html\">\"visiting variants using lambdas - part 1\"</a></p></li>\n<li><p><a href=\"https://vittorioromeo.info/index/blog/variants_lambdas_part_2.html\">\"visiting variants using lambdas - part 2\"</a></p></li>\n</ul>\n\n<p>Here's an example of how your <code>undo</code> function could look like:</p>\n\n<pre><code>void undo()\n{\n    auto action = undo_stack.pop_and_get();\n    match(action, [&amp;shapes](const move_shape&amp; y)\n                  {\n                      // Revert shape movement.\n                      shapes[y._id].move(-y._offset);\n                  },\n                  [&amp;shapes](const change_shape_color&amp; y)\n                  {\n                      // Revert shape color change.\n                      shapes[y._id].set_color(y._previous);\n                  },\n                  [](auto)\n                  {\n                      // Produce a compile-time error.\n                      struct undo_not_implemented;\n                      undo_not_implemented{};\n                  });\n}\n</code></pre>\n\n<p>If every branch of <code>match</code> gets large, it could be moved to its own function for readability. Trying to instantiate <code>undo_not_implemented</code> or using a <em>dependent</em> <code>static_assert</code> is also a good idea: a compile-time error will be produced if you forget to implement behavior for a specific \"undoable action\".</p>\n\n<p>That's pretty much it! If you want to save the <code>undo_stack</code> so that the history of actions is preserved in saved documents, you can implement a <code>auto serialize(const undoable_action&amp;)</code> that, again, uses pattern matching to serialize the various actions. You could then implement a <code>deserialize</code> function that repopulates the <code>undo_stack</code> on file load.</p>\n\n<p>If you find implementing serialization/deserialization for every action too tedious, consider using <a href=\"http://www.boost.org/doc/libs/1_63_0/libs/hana/doc/html/group__group-Struct.html#gab9efb238a82207d91643994c5295cf8c\"><code>BOOST_HANA_DEFINE_STRUCT</code></a> or similar solutions to automatically generate serialization/deserialization code.</p>\n\n<p>Since you're concerned about battery and performance, I would also like to mention that using <code>std::variant</code> or similar <em>tagged union</em> constructs is on average faster and more lightweight compared to polymorphic hierarchies, as heap allocation is not required and as there is no run-time <code>virtual</code> dispatch.</p>\n\n<hr>\n\n<p>About <code>redo</code> functionality: you could have a <code>redo_stack</code> and implement an <code>auto invert(const undoable_action&amp;)</code> function that inverts the behavior of an action. Example:</p>\n\n<pre><code>void undo()\n{\n    auto action = undo_stack.pop_and_get();\n    match(action, [&amp;](const move_shape&amp; y)\n                  {\n                      // Revert shape movement.\n                      shapes[y._id].move(-y._offset);\n                      redo_stack.push(invert(y));  \n                  },\n                  // ...\n</code></pre>\n\n<p></p>\n\n<pre><code>auto invert(const undoable_action&amp; x)\n{\n    return match(x, [&amp;](move_shape y)\n                {\n                    y._offset *= -1;\n                    return y;\n                },\n                // ...\n</code></pre>\n\n<p></p>\n\n<p>If you follow this pattern, you can implement <code>redo</code> in terms of <code>undo</code>! Simply call <code>undo</code> by popping from the <code>redo_stack</code> instead of the <code>undo_stack</code>: since you <em>\"inverted\"</em> the actions it will perform the desired operation.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> here's a <a href=\"http://melpon.org/wandbox/permlink/83vt1PjrS0gQ5Dc2\">minimal <strong>wandbox example</strong></a> that implements a <code>match</code> function that takes in a variant and returns a variant.</p>\n\n<ul>\n<li><p>The example uses <code>boost::hana::overload</code> to generate the visitor. </p></li>\n<li><p>The visitor is wrapped in a lambda <code>f</code> that unifies the return type to the type of the variant: this is necessary as <code>std::visit</code> requires that the visitor always returns the same type. </p>\n\n<ul>\n<li>If returning a type which is different from the variant is desirable, <code>std::common_type_t</code> could be used, otherwise the user could explicitly specify it as the first template parameter of <code>match</code>.</li>\n</ul></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 514, "user_id": 6655648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8572319f6de59c1d3e6d61e506ec4de?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo H", "link": "https://stackoverflow.com/users/6655648/pablo-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1486149861, "creation_date": 1486149861, "answer_id": 42031607, "question_id": 41727129, "link": "https://stackoverflow.com/questions/41727129/mechanism-for-save-loadundo-redo-with-minimum-boilerplate/42031607#42031607", "title": "Mechanism for Save/Load+Undo/Redo with minimum boilerplate", "body": "<p>Another approach you might want to consider is working with <strong>inmutable</strong> data structures and objects. Then, the undo/redo stack can be implemented as a stack of versions of the scene/diagram/document. Undo() replaces the current version with an older version from the stack, and so on. Because all data is inmutable, you can keep references instead of copies, so it is fast and (relatively) cheap.</p>\n\n<p>Pros:</p>\n\n<ul>\n<li>simple undo/redo</li>\n<li>multithread-friendly</li>\n<li>clean separation of \"structure\" and transient state (e.g. current selection)</li>\n<li>may simplify serialization</li>\n<li>caching/memoization/precomputation-friendly (e.g. bounding-box, gpu buffers)</li>\n</ul>\n\n<p>Cons:</p>\n\n<ul>\n<li>consumes a bit more memory</li>\n<li><em>forces</em> separation of \"structure\" and transient state </li>\n<li>probably more difficult: for example, for a typical tree-like scenegraph, to change a node you would also need to change all the nodes along the path to the root; the old and new versions can share the rest of the nodes</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "is_accepted": false, "score": 6, "last_activity_date": 1486207561, "last_edit_date": 1486207561, "creation_date": 1486207108, "answer_id": 42039725, "question_id": 41727129, "link": "https://stackoverflow.com/questions/41727129/mechanism-for-save-loadundo-redo-with-minimum-boilerplate/42039725#42039725", "title": "Mechanism for Save/Load+Undo/Redo with minimum boilerplate", "body": "<blockquote>\n  <p>The problem with the simple way described above is that it requires a lot of error-prone boilerplate work.</p>\n</blockquote>\n\n<p>I would say that the actual problem is that your undo/redo logic is part of a component, that should ship only a bunch of data as a position, a content and so on.</p>\n\n<p>A common OOP way to decouple the undo/redo logic from the data is the <a href=\"https://en.wikipedia.org/wiki/Command_pattern\" rel=\"noreferrer\">command design pattern</a>.<br>\nThe basic idea is that all the user interactions are converted to commands and those commands are executed on the diagram itself. They contain all the information required to perform an operation and to rollback it, as long as you maintain a sorted list of commands and undo/redo them in order (that is usually the user expectation).</p>\n\n<p>Another common OOP pattern that can help you either to design a custom serialization utility or to use the most common ones is the <a href=\"https://en.wikipedia.org/wiki/Visitor_pattern\" rel=\"noreferrer\">visitor design pattern</a>.<br>\nHere the basic idea is that your diagram should not care about the kind of components it contains. Whenever you want to serialize it, you provide a serializer and the components promote themselves to the right type when queried (see <em>double dispatching</em> for further details on this technique).</p>\n\n<p>That being said, a <a href=\"http://melpon.org/wandbox/permlink/rwbKXcrfzaB6rwIk\" rel=\"noreferrer\">minimal example</a> is worth more than a thousand words:</p>\n\n<pre><code>#include &lt;memory&gt;\n#include &lt;stack&gt;\n#include &lt;vector&gt;\n#include &lt;utility&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;string&gt;\n\nstruct Serializer;\n\nstruct Part {\n    virtual void accept(Serializer &amp;) = 0;\n    virtual void draw() = 0;\n};\n\nstruct Node: Part {\n    void accept(Serializer &amp;serializer) override;\n    void draw() override;\n    std::string label;\n    unsigned int x;\n    unsigned int y;\n};\n\nstruct Link: Part {\n    void accept(Serializer &amp;serializer) override;\n    void draw() override;\n    std::weak_ptr&lt;Node&gt; from;\n    std::weak_ptr&lt;Node&gt; to;\n};\n\nstruct Serializer {\n    void visit(Node &amp;node) {\n        std::cout &lt;&lt; \"serializing node \" &lt;&lt; node.label &lt;&lt; \" - x: \" &lt;&lt; node.x &lt;&lt; \", y: \" &lt;&lt; node.y &lt;&lt; std::endl;\n    }\n\n    void visit(Link &amp;link) {\n        auto pfrom = link.from.lock();\n        auto pto = link.to.lock();\n       std::cout &lt;&lt; \"serializing link between \" &lt;&lt; (pfrom ? pfrom-&gt;label : \"-none-\") &lt;&lt; \" and \" &lt;&lt; (pto ? pto-&gt;label : \"-none-\") &lt;&lt; std::endl;\n    }\n};\n\nvoid Node::accept(Serializer &amp;serializer) {\n    serializer.visit(*this);\n}\n\nvoid Node::draw() {\n    std::cout &lt;&lt; \"drawing node \" &lt;&lt; label &lt;&lt; \" - x: \" &lt;&lt; x &lt;&lt; \", y: \" &lt;&lt; y &lt;&lt; std::endl;\n}\n\nvoid Link::accept(Serializer &amp;serializer) {\n    serializer.visit(*this);\n}\n\nvoid Link::draw() {\n    auto pfrom = from.lock();\n    auto pto = to.lock();\n\n    std::cout &lt;&lt; \"drawing link between \" &lt;&lt; (pfrom ? pfrom-&gt;label : \"-none-\") &lt;&lt; \" and \" &lt;&lt; (pto ? pto-&gt;label : \"-none-\") &lt;&lt; std::endl;\n}\n\nstruct TreeDiagram;\n\nstruct Command {\n    virtual void execute(TreeDiagram &amp;) = 0;\n    virtual void undo(TreeDiagram &amp;) = 0;\n};\n\nstruct TreeDiagram {\n    std::vector&lt;std::shared_ptr&lt;Part&gt;&gt; parts;\n    std::stack&lt;std::unique_ptr&lt;Command&gt;&gt; commands;\n\n    void execute(std::unique_ptr&lt;Command&gt; command) {\n        command-&gt;execute(*this);\n        commands.push(std::move(command));\n    }\n\n    void undo() {\n        if(!commands.empty()) {\n            commands.top()-&gt;undo(*this);\n            commands.pop();\n        }\n    }\n\n    void draw() {\n        std::cout &lt;&lt; \"draw...\" &lt;&lt; std::endl;\n        for(auto &amp;part: parts) {\n            part-&gt;draw();\n        }\n    }\n\n    void serialize(Serializer &amp;serializer) {\n        std::cout &lt;&lt; \"serialize...\" &lt;&lt; std::endl;\n        for(auto &amp;part: parts) {\n            part-&gt;accept(serializer);\n        }\n    }\n};\n\nstruct AddNode: Command {\n    AddNode(std::string label, unsigned int x, unsigned int y):\n        label{label}, x{x}, y{y}, node{std::make_shared&lt;Node&gt;()}\n    {\n        node-&gt;label = label;\n        node-&gt;x = x;\n        node-&gt;y = y;\n    }\n\n    void execute(TreeDiagram &amp;diagram) override {\n        diagram.parts.push_back(node);\n    }\n\n    void undo(TreeDiagram &amp;diagram) override {\n        auto &amp;parts = diagram.parts;\n        parts.erase(std::remove(parts.begin(), parts.end(), node), parts.end());\n    }\n\n    std::string label;\n    unsigned int x;\n    unsigned int y;\n    std::shared_ptr&lt;Node&gt; node;\n};\n\nstruct AddLink: Command {\n    AddLink(std::shared_ptr&lt;Node&gt; from, std::shared_ptr&lt;Node&gt; to):\n        link{std::make_shared&lt;Link&gt;()}\n    {\n        link-&gt;from = from;\n        link-&gt;to = to;\n    }\n\n    void execute(TreeDiagram &amp;diagram) override {\n        diagram.parts.push_back(link);\n    }\n\n    void undo(TreeDiagram &amp;diagram) override {\n        auto &amp;parts = diagram.parts;\n        parts.erase(std::remove(parts.begin(), parts.end(), link), parts.end());\n    }\n\n    std::shared_ptr&lt;Link&gt; link;\n};\n\nstruct MoveNode: Command {\n    MoveNode(unsigned int x, unsigned int y, std::shared_ptr&lt;Node&gt; node):\n        px{node-&gt;x}, py{node-&gt;y}, x{x}, y{y}, node{node}\n    {}\n\n    void execute(TreeDiagram &amp;) override {\n        node-&gt;x = x;\n        node-&gt;y = y;\n    }\n\n    void undo(TreeDiagram &amp;) override {\n        node-&gt;x = px;\n        node-&gt;y = py;\n    }\n\n    unsigned int px;\n    unsigned int py;\n    unsigned int x;\n    unsigned int y;\n    std::shared_ptr&lt;Node&gt; node;\n};\n\nint main() {\n    TreeDiagram diagram;\n    Serializer serializer;\n\n    auto addNode1 = std::make_unique&lt;AddNode&gt;(\"foo\", 0, 0);\n    auto addNode2 = std::make_unique&lt;AddNode&gt;(\"bar\", 100, 50);\n    auto moveNode2 = std::make_unique&lt;MoveNode&gt;(10, 10, addNode2-&gt;node);\n    auto addLink = std::make_unique&lt;AddLink&gt;(addNode1-&gt;node, addNode2-&gt;node);\n\n    diagram.serialize(serializer);    \n    diagram.execute(std::move(addNode1));\n    diagram.execute(std::move(addNode2));\n    diagram.execute(std::move(addLink));\n    diagram.serialize(serializer);\n    diagram.execute(std::move(moveNode2));\n    diagram.draw();\n    diagram.undo();\n    diagram.undo();\n    diagram.serialize(serializer);\n}\n</code></pre>\n\n<p>I've not implemented the redo action and the code is far from being a production-ready piece of software, but it acts quite well as a starting point from which to create something more complex.</p>\n\n<p>As you can see, the goal is to create a <em>tree diagram</em> that contains both nodes an links. A component contains a bunch of data and knows how to draw itself. Moreover, as anticipated, a component accepts a serializer in case you want to write it down on a file or whatever.<br>\nAll the logic is contained in the so called <em>commands</em>. In the example there are three commands: add node, add link and move node. Neither the diagram nor the components know anything about what's going on under the hood. All what the diagram knows is that it's executing a set of commands and those commands can be executed back a step at the time.</p>\n\n<p>A more complex undo/redo system can contain a circular buffer of commands and a few indexes that indicate the one to substitute with the next one, the one valid when going forth and the one valid when going back.<br>\nIt's quite easy to implement indeed.</p>\n\n<p>This approach will help you decoupling the logic from the data and it's quite common when dealing with user interfaces.<br>\nTo be honest, it's not something that came up suddenly to my mind. I found something similar while looking at how open-source software solved the issue and I've used it a few years ago in a software of mine. The resulting code is really easy to maintain.</p>\n"}], "owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1716, "favorite_count": 5, "answer_count": 5, "score": 26, "last_activity_date": 1486292012, "creation_date": 1484765141, "last_edit_date": 1485076796, "question_id": 41727129, "link": "https://stackoverflow.com/questions/41727129/mechanism-for-save-loadundo-redo-with-minimum-boilerplate", "title": "Mechanism for Save/Load+Undo/Redo with minimum boilerplate", "body": "<p>I want to make an app where a user can edit a diagram (for example), which would provide the standard mechanisms of: Save, Load, Undo, and Redo.</p>\n\n<p>A simple way to do it is to have classes for the diagram and for the various shapes in it, which implement serialization via save and load methods, and where all methods to edit them return <code>UndoableAction</code>s that can be added to an <code>UndoManager</code> which calls their <code>perform</code> method and adds them to an undo stack.</p>\n\n<p>The problem with the simple way described above is that it requires a lot of error-prone boilerplate work.</p>\n\n<p>I know that the serialization (save/load) part of the work can be solved by using something like Google's Protocol Buffers or Apache Thrift, which generates the boiler-plate serialization code for you, but it doesn't solve the undo+redo problem. I know that for Objective C and Swift, Apple provides Core Data which does solve serialization + undo, but I'm not familiar with anything similar for C++.</p>\n\n<p>Is there a good way non-error-prone to solve save+load+undo+redo with little boilerplate?</p>\n"}, {"tags": ["c++", "visual-c++"], "comments": [{"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 1, "creation_date": 1484765244, "post_id": 41727120, "comment_id": 70648744, "body": "For one thing, the <code>what()</code> in your cpp file should be <code>IllegalArgumentException::what()</code>."}, {"owner": {"reputation": 1820, "user_id": 5611377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QEMg2.png?s=128&g=1", "display_name": "ssimm", "link": "https://stackoverflow.com/users/5611377/ssimm"}, "reply_to_user": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1484765460, "post_id": 41727120, "comment_id": 70648859, "body": "@0x5453, thanks.  Code modified, only one error left."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1484766124, "post_id": 41727120, "comment_id": 70649197, "body": "You forgot the include guards around your header."}], "answers": [{"tags": [], "owner": {"reputation": 80, "user_id": 5368125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bUeht.jpg?s=128&g=1", "display_name": "C&#233;sar HM", "link": "https://stackoverflow.com/users/5368125/c%c3%a9sar-hm"}, "is_accepted": false, "score": 0, "last_activity_date": 1484766255, "creation_date": 1484766255, "answer_id": 41727439, "question_id": 41727120, "link": "https://stackoverflow.com/questions/41727120/c-declare-exception-in-hpp-file/41727439#41727439", "title": "C++ declare exception in hpp file", "body": "<p>I am not sure, but I can comment so...</p>\n\n<p>I think your \"what\" function is two times implemented:\nFirst in your hpp file and then in the cpp file.</p>\n"}, {"tags": [], "owner": {"reputation": 70, "user_id": 6316841, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q1BIr.jpg?s=128&g=1", "display_name": "czimbortibor", "link": "https://stackoverflow.com/users/6316841/czimbortibor"}, "is_accepted": true, "score": 1, "last_activity_date": 1484768192, "last_edit_date": 1484768192, "creation_date": 1484767425, "answer_id": 41727777, "question_id": 41727120, "link": "https://stackoverflow.com/questions/41727120/c-declare-exception-in-hpp-file/41727777#41727777", "title": "C++ declare exception in hpp file", "body": "<p>You mixed up the <code>what()</code> function's declaration and definition. You tried refer to the function with the <strong>scope resolution</strong> operator (i.e <strong>::</strong>). In this case it should be done in the definition (i.e in the .cpp file)</p>\n\n<p>Also the <code>what()</code> function was implemented as an <strong>inline</strong> function in your <em>.hpp</em> file, which means that you don't need to define it again in the <em>.cpp</em> file. Therefore you got a <code>redefinition of \u2018const char* IllegalArgumentException::what()</code> error.</p>\n\n<p>P.S: In C++ class declarations one does not need to specify every attribute/method's access modifier, you can just group them under a single modifier. </p>\n\n<p>.hpp file:</p>\n\n<pre><code>struct IllegalArgumentException : public std::exception\n{\npublic: \n IllegalArgumentException(std::string ss);\n~IllegalArgumentException();\n\nconst char* what()  { return s.c_str(); }\n\nprivate: \n std::string s;\n\n};\n</code></pre>\n\n<p>.cpp file:</p>\n\n<pre><code>IllegalArgumentException::IllegalArgumentException(std::string ss) : s(ss) {}\n\nIllegalArgumentException::~IllegalArgumentException() {}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1820, "user_id": 5611377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QEMg2.png?s=128&g=1", "display_name": "ssimm", "link": "https://stackoverflow.com/users/5611377/ssimm"}, "edited": false, "score": 0, "creation_date": 1484848794, "post_id": 41727920, "comment_id": 70689707, "body": "It&#39;s very kind of you to have given me all these good tips (I&#39;ve reread it several times).  But I must reward the answer to czimbortibor because his answer better fit the ideals of minimalist and verifiable."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 1820, "user_id": 5611377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QEMg2.png?s=128&g=1", "display_name": "ssimm", "link": "https://stackoverflow.com/users/5611377/ssimm"}, "edited": false, "score": 0, "creation_date": 1484849685, "post_id": 41727920, "comment_id": 70690188, "body": "@ssimm Not a problem. The only point immediately relevant to the question is point 1 and czimbortibor explains it in a bit more detail."}], "tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": false, "score": 2, "last_activity_date": 1484767903, "last_edit_date": 1495540899, "creation_date": 1484767903, "answer_id": 41727920, "question_id": 41727120, "link": "https://stackoverflow.com/questions/41727120/c-declare-exception-in-hpp-file/41727920#41727920", "title": "C++ declare exception in hpp file", "body": "<h1>Point 1</h1>\n\n<pre><code>const char* IllegalArgumentException::what()  { return s.c_str(); }\n</code></pre>\n\n<p>is declared incorrectly if declared inside a <code>class</code> or <code>struct</code>. Since the declaration is being made inside the <code>IllegalArgumentException</code> class, <a href=\"https://en.wikipedia.org/wiki/Scope_resolution_operator\" rel=\"nofollow noreferrer\"><code>IllegalArgumentException::</code> is implied</a> and messes with the compiler because the compiler now thinks you are declaring something else. You want </p>\n\n<pre><code>const char* what()  { return s.c_str(); }\n</code></pre>\n\n<p>In addition, the <code>{ return s.c_str(); }</code> portion implements the function, so there is no need to implement it in the cpp file.</p>\n\n<h1>Point 2</h1>\n\n<p>Everything in a <code>struct</code> is <code>public</code> unless declared following the <code>private</code> keyword. This is the opposite of a <code>class</code> where everything is <code>private</code> unless stated otherwise. A <code>class</code> and a <code>struct</code> are pretty much identical other than the difference on default access.</p>\n\n<h1>Point 3</h1>\n\n<p>In C++ you can declare access level of members in blocks. There is no need to declare the access level of members one at a time.</p>\n\n<pre><code>struct IllegalArgumentException : public std::exception \n{ \n    // these are all public by default in a struct\n    IllegalArgumentException(std::string ss); \n   ~IllegalArgumentException(); \n    const char* IllegalArgumentException::what() { return s.c_str(); } \nprivate: // everything after this is private\n    std::string s; \n    int example; \n}; \n</code></pre>\n\n<p>or </p>\n\n<pre><code>class IllegalArgumentException : public std::exception \n{ \npublic: // these are all private by default in a class and need to be public\n    IllegalArgumentException(std::string ss); \n   ~IllegalArgumentException(); \n    const char* IllegalArgumentException::what() { return s.c_str(); }\nprivate: // switch back to private\n    std::string s; \n    int example; \n}; \n</code></pre>\n\n<p>or</p>\n\n<pre><code>class IllegalArgumentException : public std::exception \n{ \n    // these are all private by default in a class\n    std::string s; \n    int example; \npublic: // everything after this is public\n    IllegalArgumentException(std::string ss); \n   ~IllegalArgumentException(); \n    const char* IllegalArgumentException::what() { return s.c_str(); }\n}; \n</code></pre>\n\n<h1>Point 4</h1>\n\n<pre><code>IllegalArgumentException::~IllegalArgumentException() {}\n</code></pre>\n\n<p>doesn't do anything. It doesn't need to do anything so the <a href=\"http://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">Rule of Zero</a> recommends against having a destructor at all. The compiler will create it for you. If you don't have to write it, don't write it because code that doesn't exist has no bugs.</p>\n\n<pre><code>class IllegalArgumentException : public std::exception \n{ \n    // these are all private by default \n    std::string s; \n    int example; \npublic: // everything after this is public\n    IllegalArgumentException(std::string ss); \n    const char* IllegalArgumentException::what() { return s.c_str(); }\n}; \n</code></pre>\n\n<h1>Point 5</h1>\n\n<p>Stealing from KerrekSB here because it's a point that OP had another question on. <a href=\"https://en.wikipedia.org/wiki/Include_guard\" rel=\"nofollow noreferrer\">Use Include Guards</a></p>\n\n<p>Include guards prevent a header from being included multiple times in the same <a href=\"https://stackoverflow.com/questions/1106149/what-is-a-translation-unit-in-c\">translation unit</a>. This is a problem because of bloat and the possibility of the same thing being defined or declared more than once leading to confusion about which is the real one.</p>\n\n<p>A simple header guard:</p>\n\n<pre><code>#ifndef ILLEGALARGUMENTEXCEPTION_H // if we've never seen ILLEGALARGUMENTEXCEPTION_H \n                                   // before, do the following\n#define ILLEGALARGUMENTEXCEPTION_H // OK we've seen it now!\n\n// all subsequent includes of IllegalArgumentException.h will have seen \n// ILLEGALARGUMENTEXCEPTION_H and fail the ifndef, skipping everything \n// until it finds the closing #endif\n\n#include &lt;string&gt;\n#include &lt;exception&gt;\nclass IllegalArgumentException : public std::exception \n{ \n    // these are all private by default \n    std::string s; \n    int example; \npublic: // everything after this is public\n    IllegalArgumentException(std::string ss); \n    const char* IllegalArgumentException::what() { return s.c_str(); }\n}; \n\n#endif // end of Include Guard\n</code></pre>\n\n<p>You may also use <code>#pragma once</code>, but be warned that <code>#pragma</code> means non-standard compiler extension. <code>once</code> may not exist for your compiler and if it doesn't, the compiler is allowed to skip the instruction <strong>without telling you!</strong></p>\n\n<p>There are many reasons why <code>once</code> is not in the standard, most important is it has <a href=\"https://stackoverflow.com/a/34884735/4581301\">unresolved fail cases</a>. Use it with caution. </p>\n"}, {"comments": [{"owner": {"reputation": 118, "user_id": 262304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d65ed1c935095b1fb69d42052482feb4?s=128&d=identicon&r=PG&f=1", "display_name": "ech", "link": "https://stackoverflow.com/users/262304/ech"}, "edited": false, "score": 0, "creation_date": 1484768718, "post_id": 41728074, "comment_id": 70650683, "body": "ht. Kerrek SB and others who also deduced missing include guards."}], "tags": [], "owner": {"reputation": 118, "user_id": 262304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d65ed1c935095b1fb69d42052482feb4?s=128&d=identicon&r=PG&f=1", "display_name": "ech", "link": "https://stackoverflow.com/users/262304/ech"}, "is_accepted": false, "score": 0, "last_activity_date": 1484768483, "creation_date": 1484768483, "answer_id": 41728074, "question_id": 41727120, "link": "https://stackoverflow.com/questions/41727120/c-declare-exception-in-hpp-file/41728074#41728074", "title": "C++ declare exception in hpp file", "body": "<p>It seems you are possibly, perhaps indirectly, including the .hpp file more than once?</p>\n\n<p><code>#include</code> is a fairly primitive way to share code among several .cpp files: it tells the compiler (the preprocessor, specifically) to import the contents of the .hpp right there at that spot in the code. Then in a later pass, the compiler will compile the entire thing as if it is all one file. (There's a whole crazy turing-complete language for that preprocessor step; IMO you should avoid it as much as possible, mostly only using it for the stuff outlined in this note.)</p>\n\n<p>One problem with this approach is that if you end up importing one .hpp file more than once \u2013 a very common thing to do, since .hpp files typically include other .hpp files \u2013 you will have that code repeated. It's illegal to define a struct or class more than once, so you get the error about \"type redefinition\".</p>\n\n<p>The solution is to use include guards in every single .hpp file. At the very top, use lines like:</p>\n\n<pre><code>#ifndef SOME_STRING_THAT_UNIQUELY_IDENTIFIES_THIS_HEADER\n#define SOME_STRING_THAT_UNIQUELY_IDENTIFIES_THIS_HEADER\n</code></pre>\n\n<p>Then at the very bottom of the .hpp file:</p>\n\n<pre><code>#endif  // SOME_STRING_THAT_UNIQUELY_IDENTIFIES_THIS_HEADER\n</code></pre>\n\n<p>Those preprocessor directives, <code>#ifndef</code>, <code>#define</code>, etc will remove any text in the middle if the big unique string is already defined. Usually your codebase will establish conventions for that big string, such as encoding the path into it. My company even uses a lint tool to make sure you encoded it correctly.</p>\n\n<p>This ensures that if you #include a .hpp twice, or #include another .hpp that includes an already-included .hpp, you will get the contents of the .hpp file exactly once in the final preprocessor output.</p>\n\n<p>This, and the preprocessor in general, is one of the less charming parts of C++ that really shows its age. Soon the language will be getting a much more modern and pleasant system for sharing interfaces called \"modules\". In the meantime, each .hpp needs these 3 lines of boilerplate.</p>\n"}], "owner": {"reputation": 1820, "user_id": 5611377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QEMg2.png?s=128&g=1", "display_name": "ssimm", "link": "https://stackoverflow.com/users/5611377/ssimm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 787, "favorite_count": 0, "accepted_answer_id": 41727777, "answer_count": 4, "score": -1, "last_activity_date": 1484768483, "creation_date": 1484765102, "last_edit_date": 1495540899, "question_id": 41727120, "link": "https://stackoverflow.com/questions/41727120/c-declare-exception-in-hpp-file", "title": "C++ declare exception in hpp file", "body": "<p>I would like to modify <a href=\"https://stackoverflow.com/a/134612/5611377\">PierreBdR's exception example</a> of how to make a custom exception so that it is visible to other classes.  His example works for me but the exception is visible only inside that class.</p>\n\n<p>I'm using MS Visual Studio 2013 and I'm a C++ newbie encumbered by a Java mentality.</p>\n\n<p>Here is what is in the .hpp file:</p>\n\n<pre><code>\nstruct IllegalArgumentException : public std::exception\n{\npublic: IllegalArgumentException(std::string ss);\npublic: ~IllegalArgumentException();\n\nconst char* IllegalArgumentException::what()  { return s.c_str(); }\n\nprivate: std::string s;\n\n};\n</code></pre>\n\n<p>Here is part of the .cpp file:</p>\n\n<pre>\n\nIllegalArgumentException::IllegalArgumentException(std::string ss) : s(ss) {}\n\nIllegalArgumentException::~IllegalArgumentException() {}\n\nconst char * IllegalArgumentException::what()  { return s.c_str(); }\n</pre>\n\n<p>I'm getting:</p>\n\n<ul>\n<li>error C2011:  'IllegalArgumentExcpetion': 'struct' type redefinition (.hpp file)</li>\n</ul>\n"}, {"tags": ["c++", "compiler-warnings"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1484765218, "post_id": 41727089, "comment_id": 70648735, "body": "It&#39;s a good idea to include the entire message and not just its code. Believe it or not, but many of us haven&#39;t committed all Microsoft&#39;s error codes to memory."}, {"owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "edited": false, "score": 0, "creation_date": 1484765220, "post_id": 41727089, "comment_id": 70648736, "body": "Different types. Is true yellow?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "edited": false, "score": 0, "creation_date": 1484765274, "post_id": 41727089, "comment_id": 70648759, "body": "@ZDF Does truth have a colour?"}, {"owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1484765757, "post_id": 41727089, "comment_id": 70649026, "body": "@molbdnilo :) Is yellow true?"}], "answers": [{"comments": [{"owner": {"reputation": 52445, "user_id": 1253222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3a62746fb04e19c1656cd1df560911f?s=128&d=identicon&r=PG", "display_name": "twalberg", "link": "https://stackoverflow.com/users/1253222/twalberg"}, "edited": false, "score": 0, "creation_date": 1484766239, "post_id": 41727202, "comment_id": 70649248, "body": "On the other hand, I could imagine a situation where recoding it as <code>true == bool(151)</code> might be at least valid code (especially if you replace <code>151</code> with a variable), but even then it&#39;s probably a sign that something could be done more cleanly..."}, {"owner": {"reputation": 4007, "user_id": 1020484, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94c933a9303bcc5b6445fc9e310bcf57?s=128&d=identicon&r=PG", "display_name": "lcs", "link": "https://stackoverflow.com/users/1020484/lcs"}, "edited": false, "score": 0, "creation_date": 1484766444, "post_id": 41727202, "comment_id": 70649358, "body": "<code>bool</code> can only be <code>true</code> or <code>false</code>, nothing else without invoking undefined behavior."}, {"owner": {"reputation": 32602, "user_id": 7050130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efd06b6898f66b91234471a40cffae45?s=128&d=identicon&r=PG", "display_name": "Mark Adelsberger", "link": "https://stackoverflow.com/users/7050130/mark-adelsberger"}, "edited": false, "score": 0, "creation_date": 1484766914, "post_id": 41727202, "comment_id": 70649660, "body": "Yes... for better or worse this is the confusion of taking a language with a flexible application of boolean operators and sticking a <code>bool</code> type in it.  <code>if( 151 )</code> is perfectly well defined in spite of @Ics&#39;s observation, and its interpretation clarifies that 151 is a logically true value..."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1484778740, "post_id": 41727202, "comment_id": 70655716, "body": "@MarkAdelsberger  The problem is that the language requires that comparisons be perform with both operands of the same type (after promotions).  The bool value is converted to an integer not the integer to the bool.  So the compiler is seeing <code>if (1==151)</code>"}, {"owner": {"reputation": 32602, "user_id": 7050130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efd06b6898f66b91234471a40cffae45?s=128&d=identicon&r=PG", "display_name": "Mark Adelsberger", "link": "https://stackoverflow.com/users/7050130/mark-adelsberger"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1484800406, "post_id": 41727202, "comment_id": 70661725, "body": "@RichardCritten - In your opinion the problem is that comparisons have to be of like type?  I disagree.  The problem is that they bool type contradicts the logic idioms that C (and therefore C++) historically used.  I&#39;m not sure what part of this makes you think I don&#39;t know what the compiler sees; if you were to read my answer you&#39;d note that I already called that out."}], "tags": [], "owner": {"reputation": 32602, "user_id": 7050130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efd06b6898f66b91234471a40cffae45?s=128&d=identicon&r=PG", "display_name": "Mark Adelsberger", "link": "https://stackoverflow.com/users/7050130/mark-adelsberger"}, "is_accepted": true, "score": 5, "last_activity_date": 1484765394, "creation_date": 1484765394, "answer_id": 41727202, "question_id": 41727089, "link": "https://stackoverflow.com/questions/41727089/what-is-the-motivation-for-compiler-warning-c4806-number-bool-value/41727202#41727202", "title": "What is the motivation for Compiler Warning C4806 (number==bool value)?", "body": "<p>First let's answer your second question:  <code>true==151</code> is always false because <code>true</code> is defined to have the value <code>1</code>.</p>\n\n<p><em>In general</em> if you interpret a numeric value as a boolean, 0 will be false and anything else will be true; but the literal <code>true</code> has to have a specific value, and that value is 1.</p>\n\n<p>So why warn about an <code>==</code> where the operands are a bool and an integer?  Well, first of all because <code>151==true</code>, if you eyeball it, looks like it ought to be true (because 151 is a \"true\" value) but - as noted above - it's not.  It's a likely source of error, so that merits a warning.  More generally you're directly comparing two different types where the implicit conversion may not be obvious / may have non-obvious consequences.</p>\n"}], "owner": {"reputation": 190, "user_id": 2848762, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dcc36b70714a667ef2bebe32eb221a89?s=128&d=identicon&r=PG&f=1", "display_name": "Misha.P", "link": "https://stackoverflow.com/users/2848762/misha-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 799, "favorite_count": 0, "accepted_answer_id": 41727202, "answer_count": 1, "score": 1, "last_activity_date": 1484765593, "creation_date": 1484764976, "last_edit_date": 1484765593, "question_id": 41727089, "link": "https://stackoverflow.com/questions/41727089/what-is-the-motivation-for-compiler-warning-c4806-number-bool-value", "title": "What is the motivation for Compiler Warning C4806 (number==bool value)?", "body": "<p>Why is <code>true==151</code> regarded as unsafe operation while <code>true==true</code>, which is virtually holding the same expression, isn't. Moreover, why can <code>true==151</code> never be true, unlike <code>true&amp;&amp;151</code>?  </p>\n\n<pre><code>cout&lt;&lt;(true==151);      //0 and it gives compiler warning C4806\ncout&lt;&lt;(true==true);     //1 no warning\nif(true==151)cout&lt;&lt;\"1\"; //\"0\" and warning again\nif(true&amp;&amp;151)cout&lt;&lt;\"1\"; //1 no warning\nif(151)cout&lt;&lt;\"1\";       //1\n</code></pre>\n\n<p>The warning C4806 itself</p>\n\n<blockquote>\n  <p>'==': unsafe operation: no value of type 'bool' promoted to type 'int' can equal the given constant</p>\n</blockquote>\n"}, {"tags": ["c++", "visual-studio", "compiler-warnings", "bit-shift"], "answers": [{"comments": [{"owner": {"reputation": 3772, "user_id": 393756, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh4.googleusercontent.com/-eH6VEKfAEjQ/AAAAAAAAAAI/AAAAAAAAABg/uD2kRjrKOBY/photo.jpg?sz=128", "display_name": "Fran&#231;ois Beaune", "link": "https://stackoverflow.com/users/393756/fran%c3%a7ois-beaune"}, "edited": false, "score": 0, "creation_date": 1557153734, "post_id": 41727137, "comment_id": 98660349, "body": "The integer literal suffix <code>i64</code> is a Microsoft extension. It&#39;s better to use <code>ULL</code> or <code>ull</code> when portability matters."}, {"owner": {"reputation": 30265, "user_id": 3246555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziIu9.png?s=128&g=1", "display_name": "AlexD", "link": "https://stackoverflow.com/users/3246555/alexd"}, "reply_to_user": {"reputation": 3772, "user_id": 393756, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh4.googleusercontent.com/-eH6VEKfAEjQ/AAAAAAAAAAI/AAAAAAAAABg/uD2kRjrKOBY/photo.jpg?sz=128", "display_name": "Fran&#231;ois Beaune", "link": "https://stackoverflow.com/users/393756/fran%c3%a7ois-beaune"}, "edited": false, "score": 1, "creation_date": 1561424325, "post_id": 41727137, "comment_id": 100049738, "body": "@Fran&#231;oisBeaune I see your point. But <code>ULL</code>might be longer than 64 bits, so it is not ideal either. I changed to <code>uint64_t(1)</code>."}], "tags": [], "owner": {"reputation": 30265, "user_id": 3246555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziIu9.png?s=128&g=1", "display_name": "AlexD", "link": "https://stackoverflow.com/users/3246555/alexd"}, "is_accepted": true, "score": 3, "last_activity_date": 1561424249, "last_edit_date": 1561424249, "creation_date": 1484765170, "answer_id": 41727137, "question_id": 41727042, "link": "https://stackoverflow.com/questions/41727042/vs-compilation-warning-result-of-32-bit-shift-implicitly-converted-to-64-bits/41727137#41727137", "title": "VS compilation warning: result of 32-bit shift implicitly converted to 64 bits", "body": "<p>The compiler <a href=\"https://msdn.microsoft.com/en-us/library/ke55d167.aspx\" rel=\"nofollow noreferrer\">indeed suspects</a> that 64-bit was meant:</p>\n\n<blockquote>\n  <p>The result of 32-bit shift was implicitly converted to 64-bits, and the compiler suspects that a 64-bit shift was intended. To resolve this warning, either use 64-bit shift, or explicitly cast the shift result to 64-bit.</p>\n</blockquote>\n\n<p>You may consider</p>\n\n<pre><code>hi += uint64_t(1) &lt;&lt; (PRECISION - 1 - i);\n</code></pre>\n\n<p>Perhaps removing <code>i</code> suppresses the warning because the compiler treats expression as a constant.</p>\n"}, {"comments": [{"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1484765909, "post_id": 41727162, "comment_id": 70649100, "body": "So why is the warning cleared when I change <code>PRECISION - 1 - i</code> to <code>PRECISION - 1</code> (while still storing the result in a 64 bit variable)???"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1484766113, "post_id": 41727162, "comment_id": 70649193, "body": "@barakmanos My guess is the same as Alex&#39;s. <code>1 &lt;&lt; PRECISION - 1</code> is a compile time constant so it is probably optimized away to <code>hi += constant</code>."}, {"owner": {"reputation": 17175, "user_id": 1756636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92f14a1f21e57ba761c7163b2d00a78a?s=128&d=identicon&r=PG&f=1", "display_name": "SomeWittyUsername", "link": "https://stackoverflow.com/users/1756636/somewittyusername"}, "edited": false, "score": 0, "creation_date": 1601125829, "post_id": 41727162, "comment_id": 113311178, "body": "@NathanOliver Storage of the result is unrelated to this warning and if <code>hi</code> is 32-bit, the original error will persist. This warning is specific to the shift operation itself (possibly VS-specific behavior)"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 5, "last_activity_date": 1484765247, "creation_date": 1484765247, "answer_id": 41727162, "question_id": 41727042, "link": "https://stackoverflow.com/questions/41727042/vs-compilation-warning-result-of-32-bit-shift-implicitly-converted-to-64-bits/41727162#41727162", "title": "VS compilation warning: result of 32-bit shift implicitly converted to 64 bits", "body": "<p>The compiler is complaining because you store the result in a 64 bit variable so it assumes you actually wanted to do a 64 bit shift instead of a 32 bit shift.  You can fix that by using</p>\n\n<pre><code>hi += 1ULL &lt;&lt; (PRECISION - 1 - i);\n</code></pre>\n\n<p>To force it to be a 64 bit shift.</p>\n\n<p>It would also not complain if <code>hi</code> was a <code>unint32_t</code>.</p>\n"}], "owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4432, "favorite_count": 1, "accepted_answer_id": 41727137, "answer_count": 2, "score": 5, "last_activity_date": 1561424249, "creation_date": 1484764821, "last_edit_date": 1495535363, "question_id": 41727042, "link": "https://stackoverflow.com/questions/41727042/vs-compilation-warning-result-of-32-bit-shift-implicitly-converted-to-64-bits", "title": "VS compilation warning: result of 32-bit shift implicitly converted to 64 bits", "body": "<p>Visual Studio 2013 issues an annoying (and seemingly irrelevant) compilation warning on:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\n#define PRECISION 16\n\nuint64_t hi = 0;\nfor (uint8_t i = 0; i &lt; PRECISION; i++)\n{\n    if (some_condition)\n    {\n        hi += 1 &lt;&lt; (PRECISION - 1 - i);\n    }\n}\n</code></pre>\n\n<p>Here is the compilation warning:</p>\n\n<pre><code>warning C4334: '&lt;&lt;' :\nresult of 32-bit shift implicitly converted to 64 bits (was 64-bit shift intended?)\n</code></pre>\n\n<p>It seems to be resolved when changing <code>1 &lt;&lt; (PRECISION - 1 - i)</code> to <code>1 &lt;&lt; (PRECISION - 1)</code>.</p>\n\n<p>So I've been trying to figure out what could possibly go wrong in <code>1 &lt;&lt; (PRECISION - 1 - i)</code>.</p>\n\n<p>Obviously, if <code>i &gt;= PRECISION</code>, then the shift-left operation would yield undefined behavior.</p>\n\n<p>However, the variable <code>i</code> does not exceed the value of <code>PRECISION - 1</code>.</p>\n\n<p>Moreover, even if we assume that the compiler cannot infer this fact, I don't see what this compilation warning has to do with a potential undefined behavior due to the shift-left operand.</p>\n\n<p>Perhaps it assumes that the unsigned value of <code>PRECISION - 1 - i</code> can be larger than 31.</p>\n\n<p>But how exactly am I supposed to tell the compiler that it never does?</p>\n\n<p>I found <a href=\"https://stackoverflow.com/q/31558314/1382251\">one related question</a>, but there are no proper answers provided.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "c", "azure", "arduino-esp8266"], "comments": [{"owner": {"reputation": 13, "user_id": 7433247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf6b932d3c5261c21c0da51f3c2ca9f?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7433247/seth"}, "edited": false, "score": 0, "creation_date": 1484764717, "post_id": 41726934, "comment_id": 70648463, "body": "For an actual example of how this is done in the IoT Hub, see <a href=\"https://github.com/Azure-Samples/iot-hub-c-huzzah-getstartedkit/tree/master/remote_monitoring\" rel=\"nofollow noreferrer\">remote_monitoring</a>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1484766570, "post_id": 41726934, "comment_id": 70649428, "body": "Why are you printing <code>float</code> with <code>%d</code> modifier?"}, {"owner": {"reputation": 13, "user_id": 7433247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf6b932d3c5261c21c0da51f3c2ca9f?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7433247/seth"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1484846507, "post_id": 41726934, "comment_id": 70688400, "body": "Good point.  I replaced the %d with %f and the output becomes <code>Value seen in modifyFloat: 22.55 The value that was returned is: %f</code> Why does it escape the %f?  I looked around and can&#39;t find a reason for this behaviour."}, {"owner": {"reputation": 13, "user_id": 7433247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf6b932d3c5261c21c0da51f3c2ca9f?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7433247/seth"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1484847097, "post_id": 41726934, "comment_id": 70688751, "body": "I found the reason: <a href=\"http://stackoverflow.com/questions/27651012/arduino-sprintf-float-not-formatting\" title=\"arduino sprintf float not formatting\">stackoverflow.com/questions/27651012/&hellip;</a> Looks like it&#39;s working now.  I&#39;ll update the code to reflect the correct syntax. <code>Value seen in modifyFloat: 22.55 The value that was returned is: 22.55</code>"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 7433247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf6b932d3c5261c21c0da51f3c2ca9f?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7433247/seth"}, "is_accepted": true, "score": 0, "last_activity_date": 1484847400, "creation_date": 1484847400, "answer_id": 41748220, "question_id": 41726934, "link": "https://stackoverflow.com/questions/41726934/c-function-in-arduino-esp8266-modifies-a-float-generated-in-a-c-file-gibberis/41748220#41748220", "title": "c++ function in Arduino esp8266 modifies a float generated in a c file, gibberish seen in the c file after the c++ function exits", "body": "<p>The issue was the use of the %d in the printf string in RunTest.c.  Updating the code to that shown below fixes the issue and makes the output:</p>\n\n<pre><code>Value seen in modifyFloat: 22.55\nThe value that was returned is: 22.55\n</code></pre>\n\n<h1>RunTest.c</h1>\n\n<pre><code>#include \"FloatTest.h\"\n\nvoid runInLoop(void)\n{\n    while(1)\n    {\n        float testValue;\n        modifyFloat(&amp;testValue);\n        char str_tmp[6];\n        dtostrf(testValue, 4, 2, str_tmp);\n        (void)printf(\"The value that was returned is: %s\\r\\n\", str_tmp);\n        delay(1000);\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7433247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf6b932d3c5261c21c0da51f3c2ca9f?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7433247/seth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 41748220, "answer_count": 1, "score": -1, "last_activity_date": 1484847400, "creation_date": 1484764417, "question_id": 41726934, "link": "https://stackoverflow.com/questions/41726934/c-function-in-arduino-esp8266-modifies-a-float-generated-in-a-c-file-gibberis", "title": "c++ function in Arduino esp8266 modifies a float generated in a c file, gibberish seen in the c file after the c++ function exits", "body": "<p>I am writing code for the Azure IoT Hub, which requires the use of c-functions in the Arduino loop().  The issue that I'm having is that if I pass a pointer to a float created in the c-file to a c++ file and modify the value, what is seen in the c-file after the c++ function returns is gibberish.</p>\n\n<p>Here's a psuedocode example, and a working example is included below:</p>\n\n<p>loop() in ino file:<br>\nruns runInLoop(), defined in the c-file RunTest.c</p>\n\n<p>runInLoop() in RunTest.c:<br>\ncreate a float<br>\npass the address to modifyFloat(float *address) defined in FloatTest.cpp<br>\nprint the value of the float after modifyFloat() returns.</p>\n\n<p>modifyFloat(float *address) in FloatTest.cpp:<br>\nassign a vale to *address<br>\nprint the value<br>\nreturn</p>\n\n<p>I've executed this pseudocode in the working example below and the result in the serial monitor is:</p>\n\n<pre><code>Value assigned in modifyFloat: 22.55\nThe value that was returned is: 1077316812\n</code></pre>\n\n<p>I'm using an Adafruit Huzzah Feather, configured exactly as they indicate in their documentation.</p>\n\n<p>Here is a working example:</p>\n\n<h1>azure_troubleshoot.ino</h1>\n\n<pre><code>#include \"RunTest.h\"\n\nvoid setup()\n{\n    initSerial();\n}\n\nvoid loop()\n{\n    Serial.println(\"Starting main loop!\\r\\n\");\n    runInLoop();\n}\n\nvoid initSerial()\n{\n    Serial.begin(9600);\n}\n</code></pre>\n\n<h1>RunTest.c</h1>\n\n<pre><code>#include \"FloatTest.h\"\n\nvoid runInLoop(void)\n{\n    while(1)\n    {\n        float testValue;\n        modifyFloat(&amp;testValue);\n        (void)printf(\"The value that was returned is: %d\\r\\n\", testValue);\n        delay(1000);\n    }\n\n}\n</code></pre>\n\n<h1>RunTest.h</h1>\n\n<pre><code>#ifndef RUNTEST_H\n#define RUNTEST_H\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nvoid runInLoop(void);\n\n#ifdef __cplusplus\n}\n#endif\n\n#endif // RUNTEST_H\n</code></pre>\n\n<h1>FloatTest.cpp</h1>\n\n<pre><code>#include &lt;Arduino.h&gt;\n#include \"FloatTest.h\"\n\nvoid modifyFloat(float *address)\n{\n    *address = 22.55;\n    Serial.print(\"Value assigned in modifyFloat: \");\n    Serial.println(*address);\n}\n</code></pre>\n\n<h1>FloatTest.h</h1>\n\n<pre><code>#ifndef FLOATTEST_H\n#define FLOATTEST_H\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nvoid modifyFloat(float* address);\n\n#ifdef __cplusplus\n}\n#endif\n\n#endif // FLOATTEST_H\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "linker", "sfml", "portability"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5720228, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RuGPnDsSMBc/AAAAAAAAAAI/AAAAAAAAAM0/XoCAcFPMT9k/photo.jpg?sz=128", "display_name": "Jaagup Averin", "link": "https://stackoverflow.com/users/5720228/jaagup-averin"}, "edited": false, "score": 0, "creation_date": 1484771281, "post_id": 41727449, "comment_id": 70652061, "body": "Thanks! Building the libs through CMake solved the issue. Although it felt incomplete what I did: I built the library locally, but only got the some of the .lib files that were included in the direct SFML download. And I could not find the &quot;include directory&quot; at all. Is this normal? And is it okay to mix these .lib files with the other ones?"}, {"owner": {"reputation": 33251, "user_id": 409744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b055a62302498782454622c61e44aa51?s=128&d=identicon&r=PG", "display_name": "Mario", "link": "https://stackoverflow.com/users/409744/mario"}, "reply_to_user": {"reputation": 5, "user_id": 5720228, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RuGPnDsSMBc/AAAAAAAAAAI/AAAAAAAAAM0/XoCAcFPMT9k/photo.jpg?sz=128", "display_name": "Jaagup Averin", "link": "https://stackoverflow.com/users/5720228/jaagup-averin"}, "edited": false, "score": 0, "creation_date": 1484772059, "post_id": 41727449, "comment_id": 70652434, "body": "@JaagupAverin No, you&#39;ll get everything in the source download (or repository clone). Just set the CMake variable <code>CMAKE_INSTALL_PREFIX</code> to your preferred installation location, e.g. <code>C:&#47;SFML</code> and then build the install target to get everything the way it is in the download."}, {"owner": {"reputation": 5, "user_id": 5720228, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RuGPnDsSMBc/AAAAAAAAAAI/AAAAAAAAAM0/XoCAcFPMT9k/photo.jpg?sz=128", "display_name": "Jaagup Averin", "link": "https://stackoverflow.com/users/5720228/jaagup-averin"}, "edited": false, "score": 0, "creation_date": 1484775085, "post_id": 41727449, "comment_id": 70654065, "body": "Finally figured out how to properly install the build. That settles it for me now. Thanks for the leads."}], "tags": [], "owner": {"reputation": 33251, "user_id": 409744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b055a62302498782454622c61e44aa51?s=128&d=identicon&r=PG", "display_name": "Mario", "link": "https://stackoverflow.com/users/409744/mario"}, "is_accepted": true, "score": 1, "last_activity_date": 1484766289, "creation_date": 1484766289, "answer_id": 41727449, "question_id": 41726626, "link": "https://stackoverflow.com/questions/41726626/cannot-link-my-project-when-using-static-sfml-libraries/41727449#41727449", "title": "Cannot link my project when using static SFML libraries", "body": "<p>You're on the right track, you just have to use a version of SFML that's using the same runtime (or build it yourself). Otherwise you'll get a mismatch as detected by the linker.</p>\n\n<p>When invoking CMake, just set the variable <code>SFML_USE_STATIC_STD_LIBS</code> to <code>TRUE</code>, e.g. by running <code>cmake -DSFML_USE_STATIC_STD_LIBS=TRUE .</code> in your build directory for SFML. Then just build as usual.</p>\n"}], "owner": {"reputation": 5, "user_id": 5720228, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RuGPnDsSMBc/AAAAAAAAAAI/AAAAAAAAAM0/XoCAcFPMT9k/photo.jpg?sz=128", "display_name": "Jaagup Averin", "link": "https://stackoverflow.com/users/5720228/jaagup-averin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "accepted_answer_id": 41727449, "answer_count": 1, "score": 0, "last_activity_date": 1484766289, "creation_date": 1484763344, "last_edit_date": 1484763726, "question_id": 41726626, "link": "https://stackoverflow.com/questions/41726626/cannot-link-my-project-when-using-static-sfml-libraries", "title": "Cannot link my project when using static SFML libraries", "body": "<p>I am trying to build a project in Visual Studio using <strong>static SFML libraries</strong>.</p>\n\n<p>I set all the corresponding linker settings and it works: I can build an executable file that <strong>runs anywhere on my machine</strong>. However, <strong>my friends cannot run it: they do not have <em>msvcp140.dll</em></strong>. I do not want to pack extra DLLs with the executable, nor do I want them to install additional run-time libraries on their machines.</p>\n\n<p>So I assume <strong>I need to build the project using the \"Multi-threaded \\MT\" setting</strong> (As opposed to the \"Multi-threaded DLL \\MD\" setting)</p>\n\n<p><strong>But switching to that option causes several linker errors with the SFML library such as:</strong></p>\n\n<p><em>LNK2038: mismatch detected for 'RuntimeLibrary': value 'MD_DynamicRelease' doesn't match value 'MT_StaticRelease' in Program.obj</em></p>\n\n<p>I am certain I am using the static SFML libraries and they are linked properly, yet I cannot switch to the \\MT setting for full portability. In fact, using the dynamic version of the library allows the \\MT setting - which is obviously useless, because now SFML doesn't link statically. <strong>Suggestions?</strong></p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1484763447, "post_id": 41726610, "comment_id": 70647763, "body": "Its fine.  Unlike a vector only the current iterator is invalidated."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 1, "creation_date": 1484763487, "post_id": 41726610, "comment_id": 70647778, "body": "According to <a href=\"http://en.cppreference.com/w/cpp/container/set/erase\" rel=\"nofollow noreferrer\">the doc</a> only iterators to the element being erased are invalidated, any other is fine. (and since post-incr returns the non-incremented value...)"}, {"owner": {"reputation": 7542, "user_id": 1866775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4K99R.jpg?s=128&g=1", "display_name": "Tobias Hermann", "link": "https://stackoverflow.com/users/1866775/tobias-hermann"}, "edited": false, "score": 0, "creation_date": 1484763762, "post_id": 41726610, "comment_id": 70647924, "body": "Thanks for the quick responses. Sill I have a question left. Just edited my post accordingly."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484763908, "post_id": 41726610, "comment_id": 70648006, "body": "<code>it++</code> gives you two different iterators.  The function gets what the iterator was before incrementing and the loop has the next iterator.  It basically does what your OK example does."}, {"owner": {"reputation": 7542, "user_id": 1866775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4K99R.jpg?s=128&g=1", "display_name": "Tobias Hermann", "link": "https://stackoverflow.com/users/1866775/tobias-hermann"}, "edited": false, "score": 0, "creation_date": 1484764185, "post_id": 41726610, "comment_id": 70648165, "body": "Great. Thank you Nathan."}, {"owner": {"reputation": 7542, "user_id": 1866775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4K99R.jpg?s=128&g=1", "display_name": "Tobias Hermann", "link": "https://stackoverflow.com/users/1866775/tobias-hermann"}, "edited": false, "score": 0, "creation_date": 1484820473, "post_id": 41726610, "comment_id": 70671065, "body": "OK, and by implementing a dummy-version of operator++ I also understand why the code is equivalent to the OK version: <a href=\"http://ideone.com/UWOsFq\" rel=\"nofollow noreferrer\">ideone.com/UWOsFq</a>"}], "owner": {"reputation": 7542, "user_id": 1866775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4K99R.jpg?s=128&g=1", "display_name": "Tobias Hermann", "link": "https://stackoverflow.com/users/1866775/tobias-hermann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "closed_date": 1484763418, "answer_count": 0, "score": 2, "last_activity_date": 1484763698, "creation_date": 1484763301, "last_edit_date": 1484763698, "question_id": 41726610, "link": "https://stackoverflow.com/questions/41726610/is-this-undefined-behaviour-stdseteraseit", "closed_reason": "Duplicate", "title": "Is this undefined behaviour? (std::set::erase(it++);)", "body": "<p>Found this (simplified version below) in some old code and the Debugger (VC++ 2015) did not complain about an invalid iterator while executing it.</p>\n\n<pre><code>#include &lt;iterator&gt;\n#include &lt;set&gt;\nint main() {\n    std::set&lt;int&gt; s = {0,1,2,3,4};\n    auto it = std::begin(s);\n    while (it != std::end(s))\n    {\n        if (*it % 2 == 0)\n            s.erase(it++); // UB?\n        else\n            ++it;\n    }\n}\n</code></pre>\n\n<p>I know it should be <code>it = s.erase(it);</code> instead, but I was wondering if this actually is undefined behaviour. Is it, or is there something going on that renders the code OK?</p>\n\n<p><a href=\"http://en.cppreference.com/w/cpp/container/set/erase\" rel=\"nofollow noreferrer\">The documentation says \"References and iterators to the erased elements are invalidated. Other references and iterators are not affected.\"\"</a></p>\n\n<p>The following would of course be undefined:</p>\n\n<pre><code>s.erase(it);\n++it\n</code></pre>\n\n<p>And the now following would be OK:</p>\n\n<pre><code>auto temp = it;\n++temp;\ns.erase(it);\nit = temp;\n</code></pre>\n\n<p>But what about my code above?</p>\n\n<pre><code>s.erase(it++);\n</code></pre>\n"}, {"tags": ["c++", "c++11", "move-semantics", "unique-ptr"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7436994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90aae818715fb8ce8f572b3000f04153?s=128&d=identicon&r=PG&f=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/7436994/frank"}, "edited": false, "score": 0, "creation_date": 1484814562, "post_id": 41727249, "comment_id": 70667419, "body": "It is indeed the clone method although never used. I commented it out, thanks. There were other cases where the linker didn\u2019t fail, probably because of clever optimizations. (?) No matter."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 1, "last_activity_date": 1484765907, "last_edit_date": 1484765907, "creation_date": 1484765587, "answer_id": 41727249, "question_id": 41726501, "link": "https://stackoverflow.com/questions/41726501/move-semantic-unintentionally-superseded-by-copy-constructor-in-class-that-encap/41727249#41727249", "title": "Move semantic unintentionally superseded by copy constructor in class that encapsulates pointer", "body": "<p>Change</p>\n\n<pre><code>derived_object&amp; operator=(derived_object const&amp; rhs);\nderived_object(derived_object const&amp; other);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>derived_object&amp; operator=(derived_object const&amp; rhs)=delete;\nderived_object(derived_object const&amp; rhs)=delete;\n</code></pre>\n\n<p>this will give you errors at compile-time, not link time, if they are used.</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/9355f029049e2138\" rel=\"nofollow noreferrer\">When I do this (live example)</a>, I get a clear error here:</p>\n\n<pre><code>    static_assert(std::is_copy_constructible&lt;Derived&gt;::value, \"type of pointer must have copy constructor\");\n</code></pre>\n\n<p>Full error:</p>\n\n<pre><code>main.cpp:16:9: error: static_assert failed \"type of pointer must have copy constructor\"\n        static_assert(std::is_copy_constructible&lt;Derived&gt;::value, \"type of pointer must have copy constructor\");\n        ^             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nmain.cpp:109:24: note: in instantiation of function template specialization 'derived_object&lt;B2&gt;::derived_object&lt;D2&gt;' requested here\n    derived_object&lt;B2&gt; e(new D2(new D1()));\n                       ^\nmain.cpp:76:35: error: call to implicitly-deleted copy constructor of 'D2'\n        return new holder(new Derived(*held));\n                              ^       ~~~~~\nmain.cpp:71:9: note: in instantiation of member function 'derived_object&lt;B2&gt;::holder&lt;D2&gt;::clone' requested here\n        holder(Derived* der_ptr)\n        ^\n</code></pre>\n\n<p>which then points me here:</p>\n\n<pre><code>        placeholder* clone() const override\n        {\n            return new holder(new Derived(*held));\n        }\n</code></pre>\n\n<p>You'll notice you rae <em>copying</em> <code>*held</code> here, and what more you <em>intend</em> to copy <code>*held</code>.</p>\n\n<p>The class containing that <code>clone</code> is created here:</p>\n\n<pre><code>content(new holder&lt;Derived&gt;(ptr))\n</code></pre>\n\n<p>which then invokes the copy constructor of <code>D2</code>, which implicitly copies <code>member</code>, which is of type <code>derived_object</code>.</p>\n\n<p>When you include the copy constructor of <code>derived_object</code> but leave it unimplemented, that implicit copy of <code>derived_object</code> within the generated copy constructor of <code>D2</code> causes your link error.  It is used in <code>derived_object&lt;D2&gt;</code> when it creates the <code>holder&lt;D2&gt;</code> type.</p>\n\n<p>Virtual functions, even if never called, are implemented and compiled.</p>\n\n<p>We then implement the two methods:</p>\n\n<pre><code>derived_object(derived_object const&amp; other):\n  content(other.content?other.content-&gt;clone():nullptr)\n{}\nderived_object&amp; operator=(derived_object const&amp; rhs) {\n  auto tmp = rhs;\n  return (*this)=std::move(tmp);\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/a0420905aeb4a497\" rel=\"nofollow noreferrer\">and everything builds fine (live example)</a>.</p>\n\n<p>Note that the deep copy isn't copying based off the base type here.  We have type erased cloning of the actual derived type, not the base type.</p>\n\n<p>Alternatively, to confirm there are no stupid copies done, we both leave the copy assign and ctor unimplemented, and we remove <code>clone</code>.  <a href=\"http://coliru.stacked-crooked.com/a/c02bcd4ff1ca9e0b\" rel=\"nofollow noreferrer\">This also compiles (live example)</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1574, "user_id": 239189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mUAlH.png?s=128&g=1", "display_name": "jszpilewski", "link": "https://stackoverflow.com/users/239189/jszpilewski"}, "is_accepted": false, "score": 0, "last_activity_date": 1484766486, "creation_date": 1484766486, "answer_id": 41727507, "question_id": 41726501, "link": "https://stackoverflow.com/questions/41726501/move-semantic-unintentionally-superseded-by-copy-constructor-in-class-that-encap/41727507#41727507", "title": "Move semantic unintentionally superseded by copy constructor in class that encapsulates pointer", "body": "<p>Deleting the copy constructor (with <code>= delete</code>syntax) instead of leaving it undefined should give you a more relevant hint from the compiler that should draw your attention to the line:</p>\n\n<p><code>return new holder(new Derived(*held));</code></p>\n\n<p>There is an evident copy of a named member variable.</p>\n"}], "owner": {"reputation": 33, "user_id": 7436994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90aae818715fb8ce8f572b3000f04153?s=128&d=identicon&r=PG&f=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/7436994/frank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 41727249, "answer_count": 2, "score": 3, "last_activity_date": 1484766486, "creation_date": 1484762967, "question_id": 41726501, "link": "https://stackoverflow.com/questions/41726501/move-semantic-unintentionally-superseded-by-copy-constructor-in-class-that-encap", "title": "Move semantic unintentionally superseded by copy constructor in class that encapsulates pointer", "body": "<p>I made a template class <code>derived_object&lt;T&gt;</code> that is very similar to <code>std::unique_ptr</code>. It has the additional feature, that you can make a deep copy, although <code>T</code> is only a base class of the actual object. The technique is taken from <code>boost::any</code>. Here is the (unfortunately long) content of the file <code>derived_object.h</code>:</p>\n\n<pre><code>#pragma once\n#include &lt;type_traits&gt;\n#include &lt;algorithm&gt;\n\ntemplate&lt;class Base&gt;\nclass derived_object\n{\npublic:\n    derived_object()\n        : content(nullptr)\n    {}\n\n    template&lt;typename Derived&gt;\n    derived_object(Derived* ptr)\n        : content(new holder&lt;Derived&gt;(ptr))\n    {\n        static_assert(std::is_copy_constructible&lt;Derived&gt;::value, \"type of pointer must have copy constructor\");\n        static_assert(std::is_base_of&lt;Base, Derived&gt;::value, \"type of pointer must be derived from base type\");\n    }\n\n    derived_object(derived_object const&amp; other); // left unimplemented for testing\n//      : content(other.content ? other.content-&gt;clone() : nullptr)\n//  {}\n\n    derived_object&amp; operator=(derived_object const&amp; rhs); // left unimplemented for testing\n//  {\n//      derived_object&lt;Base&gt;(rhs).swap(*this);\n//      return *this;\n//  }\n\n    derived_object(derived_object&amp;&amp; other) noexcept\n        : content(other.content)\n    {\n        other.content = nullptr;\n    }\n\n    derived_object&amp; operator=(derived_object&amp;&amp; rhs) noexcept\n    {\n        rhs.swap(*this);\n        derived_object&lt;Base&gt;().swap(rhs);\n        return *this;\n    }\n\n    ~derived_object()\n    {\n        delete content;\n    }\n\n    Base* operator-&gt;() const\n    {\n        return content-&gt;operator Base*();\n    }\n\n    Base* get() const\n    {\n        return content-&gt;operator Base*();\n    }\n\n    derived_object&amp; swap(derived_object&amp; rhs) noexcept\n    {\n        std::swap(content, rhs.content);\n        return *this;\n    }\n\nprivate:\n    class placeholder\n    {\n    public:\n        virtual ~placeholder() {}\n        virtual operator Base*() const = 0;\n        virtual placeholder* clone() const = 0;\n    };\n\n    template&lt;typename Derived&gt;\n    class holder : public placeholder\n    {\n        Derived* held;\n    public:\n        holder(Derived* der_ptr)\n            : held(der_ptr)\n        { }\n        placeholder* clone() const override\n        {\n            return new holder(new Derived(*held));\n        }\n        ~holder() override\n        {\n            delete held;\n        }\n        operator Base*() const override { return held; }\n    };\n\n    placeholder* content;\n};\n</code></pre>\n\n<p>This works nice in general. But at a specific case, where I want to use move semantics instead of copying, my program fails. For testing purposes, I deactivated copying in derived_object by declaring but not defining the corresponding methods.</p>\n\n<p>Here are the contents of <code>classes.h</code></p>\n\n<pre><code>#pragma once\n#include \"derived_object.h\"\n\nclass B1\n{};\nclass D1 : public B1\n{};\n\n\nclass B2\n{};\nclass D2 : public B2\n{\npublic:\n    D2(derived_object&lt;B1&gt; member);\n    derived_object&lt;B1&gt; member;\n};\n</code></pre>\n\n<p><code>classes.cpp</code></p>\n\n<pre><code>#include \"classes.h\"\n\nD2::D2(derived_object&lt;B1&gt; m)\n:   member(std::move(m))\n{}\n</code></pre>\n\n<p>and <code>main.cpp</code></p>\n\n<pre><code>#include \"classes.h\"\n\nint main()\n{\n    derived_object&lt;B2&gt; e(new D2(new D1()));\n}\n</code></pre>\n\n<p>Compiling with Clang (version 3.8.0-2ubuntu4) via</p>\n\n<pre><code>clang++ -std=c++14 -o main.cpp.o -c main.cpp\nclang++ -std=c++14 -o classes.cpp.o -c classes.cpp\nclang++ main.cpp.o classes.cpp.o -o output\n</code></pre>\n\n<p>gives the linker error <code>main.cpp:(.text._ZN2D2C2ERKS_[_ZN2D2C2ERKS_]+0x19): undefined reference to `derived_object&lt;B1&gt;::derived_object(derived_object&lt;B1&gt; const&amp;)'</code>.</p>\n\n<p>But there should be no copying of derived_object, I always moved or used the constructor <code>derived_object(Derived* ptr)</code>.</p>\n\n<p>And strange, when I declare the D2 constructor inline or make other tiny changes, the error doesn\u2019t occur.<br/>\nWhy does the compiler want to copy my object although moving seems to be possible?<br/>\nHow could I change <code>derived_object.h</code> (apart from changing its method signatures)?</p>\n"}, {"tags": ["c++", "eclipse", "visual-studio"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1484763494, "post_id": 41726278, "comment_id": 70647781, "body": "I recommend using the function <code>std::tolower</code> to convert to lowercase.  Search the internet for &quot;c++ string transform tolower&quot; to find a one statement that will convert your string to all lowercase.  No need to reinvent the wheel."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1484763673, "post_id": 41726278, "comment_id": 70647875, "body": "Opening a DOS <b>command window</b> is outside the scope of StackOverflow.  Try searching SuperUser@stackexchange.com."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484764310, "post_id": 41726278, "comment_id": 70648244, "body": "You might find this helpful: <a href=\"http://stackoverflow.com/a/40741521/2642059\">stackoverflow.com/a/40741521/2642059</a>"}, {"owner": {"reputation": 116, "user_id": 7050326, "user_type": "registered", "profile_image": "https://graph.facebook.com/1280471058684311/picture?type=large", "display_name": "Alexandre Dias", "link": "https://stackoverflow.com/users/7050326/alexandre-dias"}, "edited": false, "score": 0, "creation_date": 1484767620, "post_id": 41726278, "comment_id": 70650056, "body": "I didnt know about &#39;std::tolower&#39; thanks about that."}, {"owner": {"reputation": 116, "user_id": 7050326, "user_type": "registered", "profile_image": "https://graph.facebook.com/1280471058684311/picture?type=large", "display_name": "Alexandre Dias", "link": "https://stackoverflow.com/users/7050326/alexandre-dias"}, "edited": false, "score": 0, "creation_date": 1484767678, "post_id": 41726278, "comment_id": 70650084, "body": "OK... Im on stack exchange... no idea which site should I use D:"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484768104, "post_id": 41726278, "comment_id": 70650309, "body": "Use <a href=\"http://superuser.com/\">superuser.com</a>"}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 7050326, "user_type": "registered", "profile_image": "https://graph.facebook.com/1280471058684311/picture?type=large", "display_name": "Alexandre Dias", "link": "https://stackoverflow.com/users/7050326/alexandre-dias"}, "is_accepted": false, "score": 0, "last_activity_date": 1484772336, "last_edit_date": 1592644375, "creation_date": 1484772336, "answer_id": 41729123, "question_id": 41726278, "link": "https://stackoverflow.com/questions/41726278/redirecting-i-o-only-with-iostream-windows/41729123#41729123", "title": "Redirecting I/O only with &lt;iostream&gt; [Windows]", "body": "<p>OK, so... I found instructions that helped me here:</p>\n<p><a href=\"https://msdn.microsoft.com/en-us/library/ms235639.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/ms235639.aspx</a></p>\n<p>I opened my project folder in the VisualStudio, created 2 files.</p>\n<blockquote>\n<p>input.txt</p>\n<p>output.txt</p>\n</blockquote>\n<p>I opened the Developer Command Prompt for VS2013 that I had in my PC.</p>\n<pre><code>cd [&quot;C://my_project_path&quot;]       //go to my project folder\ncl /EHsc file.cpp                \n/* \n    cl /EHsc will compile my program (I think it only compiles one file at a time. \n    I have yet to test it).\n*/\nfile &lt; input.txt &gt; output.txt    // this command will run my program\n</code></pre>\n<p>So when I run my program like this... Instead of waiting for an input from keyboard, my program will read input.txt as the standard input. And when I try to print something to the output, it will write on the output.txt instead.</p>\n<blockquote>\n<p>[EDIT] at the end of the link I pasted, there are explanations on how to compile multiple files and what exacly does the /EHsc do exacly</p>\n</blockquote>\n"}], "owner": {"reputation": 116, "user_id": 7050326, "user_type": "registered", "profile_image": "https://graph.facebook.com/1280471058684311/picture?type=large", "display_name": "Alexandre Dias", "link": "https://stackoverflow.com/users/7050326/alexandre-dias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484772336, "creation_date": 1484762228, "last_edit_date": 1484767581, "question_id": 41726278, "link": "https://stackoverflow.com/questions/41726278/redirecting-i-o-only-with-iostream-windows", "title": "Redirecting I/O only with &lt;iostream&gt; [Windows]", "body": "<blockquote>\n  <p>[@tl;dr] I have Visual Studio Ultimate 2013 and Eclipse Neon v2(C++),\n  and I need to redirect the output of my program using DOS format, but\n  I have no idea how.</p>\n  \n  <p>Im on Windows btw.</p>\n</blockquote>\n\n<p>OK.. so I have this class assignment where I have to write a program like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\n/* Check if the Character is lower case or not */\nbool checkLowerCase(char c) {\n    if (c &gt;= 'a' &amp;&amp; c &lt;= 'z') return true;\n    return false;\n}\n\n/*\n* If there is any lower case letter, it will replace it will a upper case.\n* example:\n*   \"Tauros\" will become \"TAUROS\"\n*   \"auHU\" will become \"AUHU\"\n*/\nstring fixer(string s)\n{\n    char right = ('a' - 'A');\n    string a = s;\n    for (unsigned int i = 0; i &lt; a.length(); i++)\n    {\n        if (checkLowerCase(a[i])) {\n            a[i] = a[i] - right;\n        }\n    }\n    return a;\n}\n\nint main(void)\n{\n    while (1) //infinite loop\n    {\n        string line;\n        getline(cin, line);\n        if (!cin) { //Professor wants us to only check end of input like this\n            return 0;\n        }\n        line = fixer(line);\n        cout &lt;&lt; line &lt;&lt; endl;\n    }\n}\n</code></pre>\n\n<p>The input was:</p>\n\n<pre><code>aaaaaa\nbbbbbb\ncccccc\n</code></pre>\n\n<p>The output was:</p>\n\n<pre><code>aaaaaa\nAAAAAA\nbbbbbb\nBBBBBB\ncccccc\nCCCCCC\n</code></pre>\n\n<hr>\n\n<p>Thanks for reading this far. Ok, so here's my problem.\nThe output is all messed up, so I need to redirect the output somewhere else (at least for testing).</p>\n\n<p>I know how to do that using , , holding each line in a Array of String, reallocating if needed and then print what is on the array, but, unfortunately, my lecturer demanded us only to include  and \nOhh, I dont know if it will matter, but we may not use char*, only the class string.</p>\n\n<p>My lecturer told us that we have to use DOS format. But I have no clue how to do that. If someone can tell me how to do either redirect the input or the output is finee...</p>\n\n<p>I have in my PC both Eclipse C++ (working glitchy) and Visual Studio Ultimate 2013 (working fine).</p>\n\n<p>[Edit] Im on Windows.</p>\n\n<p>AGAIN: I may only include  and </p>\n\n<p>For more information, here's his slide on DOS format.</p>\n\n<pre><code>*For testing purposes one redirect to/from a file\n*DOS formatting will have unexpected consequences\n   \u2013 The end-of-line is the CR-NL combination\n   \u2013 A line read from the file will end with CR\n   \u2013 The CR character is the command to erase the\n   previous line!\n\n./main &lt; infile.txt                   Input is from infile.txt\n./main &gt; outfile.txt                  Output is to outfile.txt\n./main &lt; infile.txt &gt; outfile.txt     Both input and output are redirected\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "mutex"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1484762272, "post_id": 41726203, "comment_id": 70647035, "body": "You use mutexes improperly hense the problem. No, you cannot lock 2 mutexes atomically, you need semaphores. For example System V semaphore would work as inteded, but that&#39;s OS specific."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1484762434, "post_id": 41726203, "comment_id": 70647141, "body": "if you&#39;ve got a c++17 library there is always <a href=\"http://en.cppreference.com/w/cpp/thread/scoped_lock\" rel=\"nofollow noreferrer\"><code>std::scoped_lock</code></a>"}, {"owner": {"reputation": 44714, "user_id": 731620, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6e2168c4647a4f096a14c254bd3d3f68?s=128&d=identicon&r=PG", "display_name": "ratchet freak", "link": "https://stackoverflow.com/users/731620/ratchet-freak"}, "edited": false, "score": 0, "creation_date": 1484841576, "post_id": 41726203, "comment_id": 70685255, "body": "I think you want to use condition_variables instead of some of those mutexes"}], "answers": [{"comments": [{"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1484762707, "post_id": 41726322, "comment_id": 70647304, "body": "while you can&#39;t lock both at the exact same time you can use a <a href=\"http://en.cppreference.com/w/cpp/thread/scoped_lock\" rel=\"nofollow noreferrer\"><code>std::scoped_lock</code></a> if your library already has it, if not I&#39;m sure boost has something equivalent"}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1484762771, "post_id": 41726322, "comment_id": 70647349, "body": "@Mgetz That&#39;s definitely another valid approach. Would you like me to add it to the answer?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1484762773, "post_id": 41726322, "comment_id": 70647351, "body": "@Mgetz how <code>scoped_lock</code> would help here? Whole idea of using mutexes this way is wrong, does not matter how they locked/unlocked manually or through RAII helper"}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1484762797, "post_id": 41726322, "comment_id": 70647366, "body": "@skypjack it&#39;s probably worthwhile yes"}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1484762857, "post_id": 41726322, "comment_id": 70647396, "body": "@Slava scoped lock does deadlock prevention and tries to acquire both at the same time. Moreover it ensures that both will be released if you leave the scope for any reason. Ensuring you shouldn&#39;t be able to dead lock because you forgot to release earlier. Also the OP asked &quot;Can I&quot; not &quot;Is this a good idea?&quot;"}, {"owner": {"reputation": 483, "user_id": 2776504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16c5e7e3a764885200bd730510cb0db?s=128&d=identicon&r=PG&f=1", "display_name": "lud1977", "link": "https://stackoverflow.com/users/2776504/lud1977"}, "edited": false, "score": 0, "creation_date": 1484763005, "post_id": 41726322, "comment_id": 70647490, "body": "You can also create another mutex to guard lock acquisition, that way you can ensure atomicity"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1484763013, "post_id": 41726322, "comment_id": 70647498, "body": "@Mgetz avoiding deadlock will not make this operation atomic with all related problems. I doubt it would help here. It will not aquire both <b>at the same time</b>"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1486178919, "post_id": 41726322, "comment_id": 71246566, "body": "@Slava doesn&#39;t matter. What matters is that the observable behavior is the same. Please do read up on <code>scoped_lock</code>. Even what you <i>would</i> consider &quot;atomic&quot; is never completely atomic at the hardware level. It&#39;s about observable guarantees."}], "tags": [], "owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "is_accepted": false, "score": 0, "last_activity_date": 1484762337, "creation_date": 1484762337, "answer_id": 41726322, "question_id": 41726203, "link": "https://stackoverflow.com/questions/41726203/lock-two-mutex-at-same-time/41726322#41726322", "title": "Lock two mutex at same time", "body": "<p>No, you cannot lock two mutexes at once, but you can use a <code>std::condition_variable</code> for the waiting threads and invoke <code>notify_one</code> when you are done.<br>\nSee <a href=\"http://en.cppreference.com/w/cpp/thread/condition_variable\" rel=\"nofollow noreferrer\">here</a> for further details.</p>\n"}, {"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484763787, "post_id": 41726650, "comment_id": 70647939, "body": "This may avoid deadlock but would not solve race condition problem as 2 mutexes would not be locked atomically."}, {"owner": {"reputation": 208848, "user_id": 46642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wjb79.jpg?s=128&g=1", "display_name": "R. Martinho Fernandes", "link": "https://stackoverflow.com/users/46642/r-martinho-fernandes"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484811366, "post_id": 41726650, "comment_id": 70665833, "body": "@Slava there&#39;s not race because, uh, these are mutexes."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 208848, "user_id": 46642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wjb79.jpg?s=128&g=1", "display_name": "R. Martinho Fernandes", "link": "https://stackoverflow.com/users/46642/r-martinho-fernandes"}, "edited": false, "score": 0, "creation_date": 1484837773, "post_id": 41726650, "comment_id": 70682424, "body": "@R.MartinhoFernandes using mutexes does not automatically eliminate race, only if you use them properly."}, {"owner": {"reputation": 208848, "user_id": 46642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wjb79.jpg?s=128&g=1", "display_name": "R. Martinho Fernandes", "link": "https://stackoverflow.com/users/46642/r-martinho-fernandes"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484840216, "post_id": 41726650, "comment_id": 70684243, "body": "@Slava please explain how you can have two mutex operations racing."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 208848, "user_id": 46642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wjb79.jpg?s=128&g=1", "display_name": "R. Martinho Fernandes", "link": "https://stackoverflow.com/users/46642/r-martinho-fernandes"}, "edited": false, "score": 0, "creation_date": 1484841475, "post_id": 41726650, "comment_id": 70685188, "body": "@R.MartinhoFernandes easily, for example mutex <code>m1</code> is used as signal &quot;data available&quot;, <code>m2</code> to lock data. thread 1 locks <code>m1</code> and <code>m2</code> and pushes data. thread 2 checks <code>m1</code> it is locked - data available, then locks <code>m2</code> and unconditionally reads data."}, {"owner": {"reputation": 208848, "user_id": 46642, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wjb79.jpg?s=128&g=1", "display_name": "R. Martinho Fernandes", "link": "https://stackoverflow.com/users/46642/r-martinho-fernandes"}, "edited": false, "score": 2, "creation_date": 1484842809, "post_id": 41726650, "comment_id": 70686116, "body": "What you described is not relevant in the context of this answer. Both threads lock both mutexes, and both threads do so in a deadlock-free manner. Can you explain how such a problem happens under these conditions?"}, {"owner": {"reputation": 44714, "user_id": 731620, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6e2168c4647a4f096a14c254bd3d3f68?s=128&d=identicon&r=PG", "display_name": "ratchet freak", "link": "https://stackoverflow.com/users/731620/ratchet-freak"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484842973, "post_id": 41726650, "comment_id": 70686206, "body": "@Slava Mutexes shouldn&#39;t be used as a &quot;signal&quot; at all. Instead use condition variables for that."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 44714, "user_id": 731620, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6e2168c4647a4f096a14c254bd3d3f68?s=128&d=identicon&r=PG", "display_name": "ratchet freak", "link": "https://stackoverflow.com/users/731620/ratchet-freak"}, "edited": false, "score": 0, "creation_date": 1484843099, "post_id": 41726650, "comment_id": 70686305, "body": "@ratchetfreak exactly and as I said before mutexes have to be used properly, and that&#39;s why providing answer how to avoid deadlock with locking 2 mutexes does not provide any value to this question."}], "tags": [], "owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "is_accepted": false, "score": 5, "last_activity_date": 1484763407, "creation_date": 1484763407, "answer_id": 41726650, "question_id": 41726203, "link": "https://stackoverflow.com/questions/41726203/lock-two-mutex-at-same-time/41726650#41726650", "title": "Lock two mutex at same time", "body": "<p>Yes, use <code>std::lock(full , th);</code>, this could avoid some deadlocks</p>\n\n<p>for example:\nthread1:</p>\n\n<pre><code>full.lock();\nth.lock();\n</code></pre>\n\n<p>thread2:</p>\n\n<pre><code>th.lock();\nfull.lock();\n</code></pre>\n\n<p>this could cause a deadlock, but the following don't:</p>\n\n<p>thread1:</p>\n\n<pre><code>std::lock(full, th);\n</code></pre>\n\n<p>thread2:</p>\n\n<pre><code>std::lock(th, full);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4668, "user_id": 465159, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/4p1sN.jpg?s=128&g=1", "display_name": "Ant", "link": "https://stackoverflow.com/users/465159/ant"}, "edited": false, "score": 0, "creation_date": 1533024821, "post_id": 41726657, "comment_id": 90181943, "body": "I thought you could with defer_lock. i.e. unique_lock&lt;mutex&gt; l1{m1, defer_lock}; unique_lock&lt;mutex&gt; l2{m2, defer_lock}; lock(l1, l2); // lock both at the same time"}, {"owner": {"reputation": 1399, "user_id": 7359606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f9eca7f3b7853fa067205299f3ebc89?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Artsimovich", "link": "https://stackoverflow.com/users/7359606/joseph-artsimovich"}, "reply_to_user": {"reputation": 4668, "user_id": 465159, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/4p1sN.jpg?s=128&g=1", "display_name": "Ant", "link": "https://stackoverflow.com/users/465159/ant"}, "edited": false, "score": 0, "creation_date": 1533542920, "post_id": 41726657, "comment_id": 90367086, "body": "@Ant std::lock(l1, l2) would guarantee a consistent locking order, yet the mutexes would still be locked one after the other, that is non-atomically."}, {"owner": {"reputation": 4668, "user_id": 465159, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/4p1sN.jpg?s=128&g=1", "display_name": "Ant", "link": "https://stackoverflow.com/users/465159/ant"}, "edited": false, "score": 0, "creation_date": 1533549548, "post_id": 41726657, "comment_id": 90370806, "body": "1) Even two separate statements would provide a consistent locking order; the problem is that i can lead to deadlock. 2) in the book &quot;The c++ programming language&quot;, Stroustrup writes &quot;It is not uncommon to need to simultaneously access several resources to perform some action. This can lead to deadlock. For example, if thread1 acquires mutex1 and then tries to acquire mutex2 while thread2 acquires mutex2 and then tries to acquire mutex1, then neither task will ever proceed further. The standard library offers help in the form of an operation for acquiring several locks simultaneously&quot;"}, {"owner": {"reputation": 4668, "user_id": 465159, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/4p1sN.jpg?s=128&g=1", "display_name": "Ant", "link": "https://stackoverflow.com/users/465159/ant"}, "edited": false, "score": 0, "creation_date": 1533549589, "post_id": 41726657, "comment_id": 90370832, "body": "... and then reports the example with defer_lock and lock(l1, l2). Doesn&#39;t that mean that mutexes are both locked at the same time?"}], "tags": [], "owner": {"reputation": 1399, "user_id": 7359606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f9eca7f3b7853fa067205299f3ebc89?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Artsimovich", "link": "https://stackoverflow.com/users/7359606/joseph-artsimovich"}, "is_accepted": true, "score": 2, "last_activity_date": 1484763451, "creation_date": 1484763451, "answer_id": 41726657, "question_id": 41726203, "link": "https://stackoverflow.com/questions/41726203/lock-two-mutex-at-same-time/41726657#41726657", "title": "Lock two mutex at same time", "body": "<p>No, you can't atomically lock two mutexes.</p>\n\n<p>Additionally, it looks like you are locking a mutex in one thread and then unlocking it in another. That's not allowed.</p>\n\n<p>I suggest switching to condition variables for this problem. Note that it's perfectly fine to have one mutex associated with multiple condition variables.</p>\n"}, {"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": -1, "last_activity_date": 1484763705, "creation_date": 1484763705, "answer_id": 41726729, "question_id": 41726203, "link": "https://stackoverflow.com/questions/41726203/lock-two-mutex-at-same-time/41726729#41726729", "title": "Lock two mutex at same time", "body": "<p>Functonality you try to achieve would require something similar to System V semaphores, where group of operations on semaphors could be applied atomically. In your case you would have 3 semaphores:</p>\n\n<ul>\n<li>semaphore 1 - locking, initialized to 0</li>\n<li>semaphore 2 - counter of available data, initialized to 0</li>\n<li>semaphore 3 - counter of available buffers, initialized how much buffers you have</li>\n</ul>\n\n<p>then push operation would do this group to lock:</p>\n\n<ul>\n<li>check semaphore 1 is 0</li>\n<li>increase semaphore 1 by +1</li>\n<li>increase semaphore 2 by +1</li>\n<li>decrease semaphore 3 by -1</li>\n</ul>\n\n<p>then</p>\n\n<ul>\n<li>decrease semaphore 1 by -1</li>\n</ul>\n\n<p>to unlock. then to pull data first group would be changed to:</p>\n\n<ul>\n<li>check semaphore 1 is 0</li>\n<li>increase semaphore 1 by +1</li>\n<li>decrease semaphore 2 by -1</li>\n<li>increase semaphore 3 by +1</li>\n</ul>\n\n<p>unlock is the same as before. Using mutexes, which are special case semaphores  most probably would not solve your problem this way. First of all they are binary ie only have 2 states but more important API does not provide group operations on them. So you either find semaphore implementation for your platform or use single mutex with condition variable(s) to signal waiting threads that data or buffer is available.</p>\n"}], "owner": {"reputation": 1240, "user_id": 4192366, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b6bf1ce902b1530a88a47e781d3c3bdc?s=128&d=identicon&r=PG&f=1", "display_name": "ZisIsNotZis", "link": "https://stackoverflow.com/users/4192366/zisisnotzis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2993, "favorite_count": 0, "accepted_answer_id": 41726657, "answer_count": 4, "score": 1, "last_activity_date": 1484763705, "creation_date": 1484761979, "question_id": 41726203, "link": "https://stackoverflow.com/questions/41726203/lock-two-mutex-at-same-time", "title": "Lock two mutex at same time", "body": "<p>I'm trying to implement a multi-in multi-out interthread channel class. I have three mutexes: <code>full</code> locks when buffer is full. <code>empty</code> locks when buffer is empty. <code>th</code> locks when anyone else is modifying buffer. My single IO program looks like</p>\n\n<pre><code>operator&lt;&lt;(...){\n  full.lock()        // locks when trying to push to full buffer\n  full.unlock()      // either it's locked or not, unlock it\n  th.lock()\n  ...\n  empty.unlock()     // it won't be empty\n  if(...)full.lock() // it might be full\n  th.unlock()\noperator&gt;&gt;(...){\n  // symmetric\n}\n</code></pre>\n\n<p>This works totally fine for single IO. But for multiple IO, when consumer thread unlocks <code>full</code>, all provider thread will go down, only one will obtain <code>th</code> and buffer might be full again because of that single thread, while there's no full check anymore. I can add a <code>full.lock()</code> again of course, but this is endless. Is there anyway to lock <code>full</code> and <code>th</code> at same time? I do see a similar question about this, but I don't see order is the problem here.</p>\n"}, {"tags": ["c++", "class", "vector"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484761349, "post_id": 41725991, "comment_id": 70646584, "body": "Here is a nice little blog about it: <a href=\"http://fusharblog.com/3-ways-to-define-comparison-functions-in-cpp/\" rel=\"nofollow noreferrer\">fusharblog.com/3-ways-to-define-comparison-functions-in-cpp</a>"}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1484761357, "post_id": 41725991, "comment_id": 70646591, "body": "The way you tried to use max_element is the key to your question. Why did you leave it out of it?"}, {"owner": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "edited": false, "score": 0, "creation_date": 1484761361, "post_id": 41725991, "comment_id": 70646593, "body": "<code>I&#39;ve tried using a max_element </code> Then show us what you wrote so we can explain the correct usage. Else, just take a look <a href=\"http://en.cppreference.com/w/cpp/algorithm/max_element\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1484761361, "post_id": 41725991, "comment_id": 70646594, "body": "Never loop on eof() - see <a href=\"https://latedev.wordpress.com/2012/12/04/all-about-eof\" rel=\"nofollow noreferrer\">latedev.wordpress.com/2012/12/04/all-about-eof</a> for why."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 6, "creation_date": 1484761397, "post_id": 41725991, "comment_id": 70646613, "body": "&quot;I&#39;m currently using C++ 98 as it is what my course requires.&quot; Find another course."}, {"owner": {"reputation": 743, "user_id": 6054783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/922aee43b4bae39e227e3d6682e6bb4d?s=128&d=identicon&r=PG&f=1", "display_name": "theVoid", "link": "https://stackoverflow.com/users/6054783/thevoid"}, "edited": false, "score": 0, "creation_date": 1484761661, "post_id": 41725991, "comment_id": 70646742, "body": "Take a look <a href=\"http://stackoverflow.com/questions/7102246/sorting-a-vector-of-objects-in-c\">here</a>"}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1484761719, "post_id": 41725991, "comment_id": 70646777, "body": "It&#39;s been 19 years since 1998. It&#39;s time to move on..."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 1, "creation_date": 1484761759, "post_id": 41725991, "comment_id": 70646803, "body": "@DeiDei: But it&#39;s only been just over 5 years since C++98."}], "answers": [{"comments": [{"owner": {"reputation": 1838, "user_id": 4525052, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0780adfbbb6b445dac0c9e12d3c73f50?s=128&d=identicon&r=PG&f=1", "display_name": "RyanP", "link": "https://stackoverflow.com/users/4525052/ryanp"}, "edited": false, "score": 0, "creation_date": 1484761836, "post_id": 41726102, "comment_id": 70646838, "body": "std::max_element returns an iterator, not a reference"}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "reply_to_user": {"reputation": 1838, "user_id": 4525052, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0780adfbbb6b445dac0c9e12d3c73f50?s=128&d=identicon&r=PG&f=1", "display_name": "RyanP", "link": "https://stackoverflow.com/users/4525052/ryanp"}, "edited": false, "score": 0, "creation_date": 1484761880, "post_id": 41726102, "comment_id": 70646854, "body": "@RyanP Thanks. Fixed."}, {"owner": {"reputation": 27, "user_id": 6901301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1442712cb8fb8a8d50ee6157350344d0?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6901301/daniel"}, "edited": false, "score": 0, "creation_date": 1484763235, "post_id": 41726102, "comment_id": 70647632, "body": "I&#39;m now getting this error: - passing \u2018const Atom\u2019 as \u2018this\u2019 argument of \u2018float Atom::getMass()\u2019 discards qualifiers [-fpermissive]          return lhs.getMass() &lt; rhs.getMass();"}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1484763304, "post_id": 41726102, "comment_id": 70647683, "body": "You need to make your getter functions const. I will edit the answer in a bit."}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "reply_to_user": {"reputation": 27, "user_id": 6901301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1442712cb8fb8a8d50ee6157350344d0?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6901301/daniel"}, "edited": false, "score": 0, "creation_date": 1484764143, "post_id": 41726102, "comment_id": 70648134, "body": "@Daniel Great! Make sure you accept an answer to wrap up the question."}], "tags": [], "owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "is_accepted": true, "score": 2, "last_activity_date": 1484763436, "last_edit_date": 1484763436, "creation_date": 1484761643, "answer_id": 41726102, "question_id": 41725991, "link": "https://stackoverflow.com/questions/41725991/comparing-the-private-member-variables-of-class-objects-stored-in-a-vector-c/41726102#41726102", "title": "Comparing the private member variables of class objects stored in a vector - C++", "body": "<p>I don't know what you did wrong with <code>std::max_element</code>, as you haven't provided what you've tried with it. </p>\n\n<pre><code>struct CompareAtomMass\n{\n    bool operator()(const Atom&amp; lhs, const Atom&amp; rhs) {\n        return lhs.getMass() &lt; rhs.getMass();\n    }\n};\n</code></pre>\n\n<p>and then:</p>\n\n<pre><code>vector &lt;Atom&gt; periodic;\nAtom max_atom = *max_element(periodic.begin(), periodic.end(), CompareAtomMax());\n</code></pre>\n\n<p><code>struct CompareAtomMass</code> is called a function object. It's a class with <code>operator()</code> overloaded to return a <code>bool</code>. <code>std::max_element</code> requires just such a function object to spit out the max element as it needs a way to compare your <code>Atom</code>s. </p>\n\n<p><strong>EDIT:</strong>\nYou should mark your getter functions as <code>const</code> since they don't change the inner state of the class. </p>\n\n<pre><code>string getElement() const;\nstring getSymbol() const;\nfloat getNumber() const;\nfloat getMass() const;\n</code></pre>\n\n<p>This will allow you to call them from a <code>const</code> object of type <code>Atom</code> just as the above function object requires (<code>const Atom&amp;</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 23041, "user_id": 1149664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac4f96b553d2e45776bd6235fee4222d?s=128&d=identicon&r=PG", "display_name": "Johan Lundberg", "link": "https://stackoverflow.com/users/1149664/johan-lundberg"}, "edited": false, "score": 0, "creation_date": 1485105134, "post_id": 41726372, "comment_id": 70775808, "body": ".. what did I miss?"}], "tags": [], "owner": {"reputation": 23041, "user_id": 1149664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac4f96b553d2e45776bd6235fee4222d?s=128&d=identicon&r=PG", "display_name": "Johan Lundberg", "link": "https://stackoverflow.com/users/1149664/johan-lundberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1484762499, "creation_date": 1484762499, "answer_id": 41726372, "question_id": 41725991, "link": "https://stackoverflow.com/questions/41725991/comparing-the-private-member-variables-of-class-objects-stored-in-a-vector-c/41726372#41726372", "title": "Comparing the private member variables of class objects stored in a vector - C++", "body": "<p>Variation of DeiDeis answer: If you only do this at one place, and don't feel a need to keep a CompareAtomMass function class, you can use a lambda:</p>\n\n<pre><code>const auto maxIt = max_element(periodic.begin(), periodic.end(), \n   [](const Atom&amp; lhs, const Atom&amp; rhs) {\n    return lhs.getMass() &lt; rhs.getMass();\n));\nif(maxIt != periodic.end()){\n  // use *maxIt ;\n}\n</code></pre>\n\n<p>in C++14 and later you can also use <code>auto</code> in lambdas:</p>\n\n<pre><code>const auto maxIt = max_element(periodic.begin(), periodic.end(), \n   [](const auto&amp; lhs, const auto&amp; rhs) {\n    return lhs.getMass() &lt; rhs.getMass();\n));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 337, "user_id": 2102000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0244978121b5b715cca7661a2745579?s=128&d=identicon&r=PG", "display_name": "Alan Milton", "link": "https://stackoverflow.com/users/2102000/alan-milton"}, "is_accepted": false, "score": 0, "last_activity_date": 1484762747, "creation_date": 1484762747, "answer_id": 41726434, "question_id": 41725991, "link": "https://stackoverflow.com/questions/41725991/comparing-the-private-member-variables-of-class-objects-stored-in-a-vector-c/41726434#41726434", "title": "Comparing the private member variables of class objects stored in a vector - C++", "body": "<p>It is a good idea to make your member functions <code>const</code>.\nThis will allow this code. Otherwise just remove all <code>const</code> from my code.\nIn case your vector is empty, you will get null pointer.</p>\n\n<pre><code>struct AtomMassComparator\n{\n    bool operator()(const Atom&amp; lhs, const Atom&amp; rhs)\n    {\n        return lhs.getMass() &lt; rhs.getMass();\n    }\n};\n\nconst Atom* getAtomWithHighestMass(const vector&lt;Atom&gt;&amp; v)\n{\n    vector&lt;Atom&gt;::const_iterator it = max_element(\n        v.begin(), v.end(), AtomMassComparator());\n    return v.end() == it ? 0 : &amp;*it;\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6901301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1442712cb8fb8a8d50ee6157350344d0?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6901301/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 41726102, "answer_count": 3, "score": 0, "last_activity_date": 1484763436, "creation_date": 1484761223, "question_id": 41725991, "link": "https://stackoverflow.com/questions/41725991/comparing-the-private-member-variables-of-class-objects-stored-in-a-vector-c", "title": "Comparing the private member variables of class objects stored in a vector - C++", "body": "<p>So I have created a program which can read a .dat file of about 20 lines containing info about different atoms (name, symbol, mass etc) and added them all to a vector of class type I made called Atom. </p>\n\n<p>How would I write a function to find the atom with the highest mass? </p>\n\n<p>Here is my class:</p>\n\n<pre class=\"lang-C++ prettyprint-override\"><code>class Atom\n{\n    string element, symbol;\n    float number;\n    float mass;\npublic:\n    Atom(string e, string s, float n, float m){\n        element = e; symbol = s; number = n; mass = m;\n    }\n    string getElement();\n    string getSymbol();\n    float getNumber();\n    float getMass();\n    float ratio();\n    friend ostream&amp; operator&lt;&lt;(ostream&amp; os, Atom c);\n};\n</code></pre>\n\n<p>and the information is added to a vector with the following statements</p>\n\n\n\n<pre><code>    ifstream fin(\"atoms.dat\");  \n\n    string E, S;\n    float M, N;\n\n    vector &lt;Atom&gt; periodic;\n\n    while(!fin.eof()){\n        fin &gt;&gt; E &gt;&gt; S &gt;&gt; M &gt;&gt; N;\n        Atom Atom(E, S, M, N);\n        periodic.push_back(Atom);\n    }\n</code></pre>\n\n<p>I want to be able to write a function which finds which atom has the highest mass, I've tried using a max_element function but I keep getting errors. Is there a quick way of comparing the member variables of class objects stored in a vector?</p>\n\n<p>I'm currently using C++ 98 as it is what my course requires.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "boolean", "conditional", "conditional-statements"], "comments": [{"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 2, "creation_date": 1484761136, "post_id": 41725929, "comment_id": 70646468, "body": "The right operand is not evaluated if the left operand is evaluated to false."}, {"owner": {"reputation": 1074, "user_id": 3560202, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/091b39f1456adeef5a255321f850e27a?s=128&d=identicon&r=PG&f=1", "display_name": "Post Self", "link": "https://stackoverflow.com/users/3560202/post-self"}, "reply_to_user": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1484761166, "post_id": 41725929, "comment_id": 70646489, "body": "Thanks. Sorry for the duplicate. Didn&#39;t know with what wording I&#39;d find that question"}], "owner": {"reputation": 1074, "user_id": 3560202, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/091b39f1456adeef5a255321f850e27a?s=128&d=identicon&r=PG&f=1", "display_name": "Post Self", "link": "https://stackoverflow.com/users/3560202/post-self"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "closed_date": 1484761083, "answer_count": 0, "score": 0, "last_activity_date": 1484760990, "creation_date": 1484760990, "question_id": 41725929, "link": "https://stackoverflow.com/questions/41725929/does-the-program-check-boolean-conditions-after-if-the-first-one-is-false", "closed_reason": "Duplicate", "title": "Does the program check boolean conditions after &amp;&amp; if the first one is false?", "body": "<pre><code>if (foo() &amp;&amp; bar())\n</code></pre>\n\n<p>Does the program still execute <code>bar()</code> even if <code>foo()</code> is false? Or is it a better idea to write</p>\n\n<pre><code>if (foo())\n    if (bar())\n</code></pre>\n\n<p>to avoid <code>bar()</code> from being called, if it is a heavy function, for example?</p>\n"}, {"tags": ["c++", "performance", "vector", "stl"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1484759947, "post_id": 41725580, "comment_id": 70645800, "body": "&quot;but this is not guaranteed&quot;. I believe it is."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 4, "creation_date": 1484759954, "post_id": 41725580, "comment_id": 70645802, "body": "Use std::deque."}, {"owner": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1484759973, "post_id": 41725580, "comment_id": 70645819, "body": "@Barmar Not by the C++ standard. To be clear: I&#39;m referring to the ability to store the array data in CPU cache, not talking about the requirement that vector&#39;s data be contiguous."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1484760001, "post_id": 41725580, "comment_id": 70645837, "body": "@void Yes, it is."}, {"owner": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "edited": false, "score": 0, "creation_date": 1484760030, "post_id": 41725580, "comment_id": 70645848, "body": "@latedeveloper Reference please."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1484760037, "post_id": 41725580, "comment_id": 70645854, "body": "@void.pointer <a href=\"http://stackoverflow.com/questions/849168/are-stdvector-elements-guaranteed-to-be-contiguous\" title=\"are stdvector elements guaranteed to be contiguous\">stackoverflow.com/questions/849168/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1484760088, "post_id": 41725580, "comment_id": 70645886, "body": "@void Not the standard, but <a href=\"http://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/vector</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1484760097, "post_id": 41725580, "comment_id": 70645894, "body": "@void.pointer I&#39;m not sure what the difference between those are. If the data is contiguous in memory, then it can be cached together, so long as it fits in a cache line."}, {"owner": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1484760119, "post_id": 41725580, "comment_id": 70645910, "body": "@Barmar: Please go back and read my OP more carefully. I was not talking about vector contiguity."}, {"owner": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "edited": false, "score": 0, "creation_date": 1484760191, "post_id": 41725580, "comment_id": 70645948, "body": "We&#39;re veering off topic here, but my point was more general: Cache locality is not standardized because it depends on the hardware, size of the vector, etc. Many factors. In a truly portable implementation, I cannot use vector under those kinds of assumptions. So I want to focus on what makes the most sense, algorithmically."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1484760212, "post_id": 41725580, "comment_id": 70645962, "body": "@void.pointer As I said, I don&#39;t understand the distinction you&#39;re making between vector contiguity and cacheability."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1484760889, "post_id": 41725580, "comment_id": 70646321, "body": "You are remembering to lock a mutex when you write to the queue and read from it aren&#39;t you?  Thinks will end badly if you don&#39;t.  (It is <i>possible</i> to write a lock-free single producer single consumer queue, but I don&#39;t think there&#39;s one in the STL)."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1484760962, "post_id": 41725580, "comment_id": 70646360, "body": "@MartinBonner Unfortunately the STL does not but boos does have a <a href=\"http://www.boost.org/doc/libs/1_53_0/doc/html/boost/lockfree/queue.html\" rel=\"nofollow noreferrer\">lock free queue</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1484761060, "post_id": 41725580, "comment_id": 70646427, "body": "Worrying if something will fit in the CPU cache when you are dealing with serial interface speeds seems a little OTT."}, {"owner": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "edited": false, "score": 0, "creation_date": 1484777379, "post_id": 41725580, "comment_id": 70655172, "body": "I worded my &quot;this is not guaranteed&quot; statement in my OP. I see where the confusion is. I edited my post to clarify. What I was trying to say was that usage of CPU cache is not guaranteed."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1484777765, "post_id": 41725580, "comment_id": 70655320, "body": "@void.pointer what is the significance of the &quot;non-guarantee&quot;? Indeed, it is not guaranteed that a CPU must have a cache, but is that relevant to your question?"}, {"owner": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "edited": false, "score": 0, "creation_date": 1484785687, "post_id": 41725580, "comment_id": 70657932, "body": "My point was, the element shifting that occurs in the vector might be negligible if the CPU cache can perform that operation fast enough that it won&#39;t matter. That&#39;s one of the reasons Bjarne recommends vector as a good default container, because even if something is algorithmically slower, it might end up being faster in real world applications because of cache locality. Ultimately my point is: I&#39;m not counting on this behavior in my decision, because it&#39;s not guaranteed or reliable. In other words, I want to focus on the right algorithm."}], "answers": [{"comments": [{"owner": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "edited": false, "score": 0, "creation_date": 1484760485, "post_id": 41725683, "comment_id": 70646102, "body": "I&#39;m not that familiar with boost&#39;s circular buffer, but does it allow pushing to the back without overwriting, or using two iterators (the push iterator and the read iterator) to keep track of positioning, and determining if they overlap?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484760642, "post_id": 41725683, "comment_id": 70646186, "body": "Might also want a <code>std::deque</code> if they want more control."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "edited": false, "score": 0, "creation_date": 1484760650, "post_id": 41725683, "comment_id": 70646189, "body": "@void.pointer I&#39;m not familiar with Boosts implementation of the circular buffer. You better check the docs."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484760717, "post_id": 41725683, "comment_id": 70646235, "body": "@NathanOliver yeah, I recommended it first before remembering std::queue. Now I mention both."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484760771, "post_id": 41725683, "comment_id": 70646266, "body": "I thought it was there.  Sometimes I see one when really it is the other so I wasn&#39;t sure.  +1 from me"}, {"owner": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "edited": false, "score": 0, "creation_date": 1484777417, "post_id": 41725683, "comment_id": 70655186, "body": "I had misworded portion of my original question (the part you quoted). I meant to say that the CPU caching is not guaranteed. I have edited my original question to clarify this properly."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 5, "last_activity_date": 1484761318, "last_edit_date": 1484761318, "creation_date": 1484760104, "answer_id": 41725683, "question_id": 41725580, "link": "https://stackoverflow.com/questions/41725580/using-stl-vector-as-a-fifo-container-for-byte-data/41725683#41725683", "title": "Using STL vector as a FIFO container for byte data", "body": "<p>Erasing a from the front of a vector an element at the time can be quite slow, especially if the buffer is large (unless you can reorder elements, which you cannot with a FIFO queue).</p>\n\n<p>A circular buffer is an excellent, perhaps ideal data structure for a FIFO queue of fixed size. But there is no implementation in the standard library. You'll have to implement it yourself or use a third party implementation such as the Boost one you've discovered.</p>\n\n<p>The standard library provides a high level structure for a growing FIFO queue: <code>std::queue</code>. For a lower level data structure, the double ended queue is a good choice (<code>std::deque</code>, which is the default underlying container of <code>std::queue</code>).</p>\n\n<blockquote>\n  <p>On the flip side, vectors are candidates for CPU cache locality because of the contiguous nature of the data (but this is not guaranteed).</p>\n</blockquote>\n\n<p>The continuous storage of <code>std::vector</code> is guaranteed. A fixed circular buffer also has continuous storage.</p>\n\n<p>I'm not sure what is guaranteed about cache locality of <code>std::deque</code> but it is typically quite good in practice as the typical implementation is a linked list of arrays.</p>\n"}, {"comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1484760633, "post_id": 41725686, "comment_id": 70646180, "body": "&quot;will be&quot; is overstating it.  If the queue is typically less than 16 bytes, I bet this simplistic approach will be as fast or faster than anything else.  Of course, if the queue can grow to several megabytes, then performance will certainly suffer."}, {"owner": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1484760689, "post_id": 41725686, "comment_id": 70646214, "body": "@MartinBonner Are you talking about the vector or the queue?"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1484760782, "post_id": 41725686, "comment_id": 70646273, "body": "By &quot;this simplistic approach&quot;, I meant &quot;using a vector&quot;."}], "tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": false, "score": 0, "last_activity_date": 1484760115, "creation_date": 1484760115, "answer_id": 41725686, "question_id": 41725580, "link": "https://stackoverflow.com/questions/41725580/using-stl-vector-as-a-fifo-container-for-byte-data/41725686#41725686", "title": "Using STL vector as a FIFO container for byte data", "body": "<p>Performance will be poor, which may or may not matter. Taking from the head entails a cascade of moves. But STL has queues for exactly this purpose, just use one. </p>\n"}], "owner": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1399, "favorite_count": 0, "accepted_answer_id": 41725683, "answer_count": 2, "score": 0, "last_activity_date": 1484777343, "creation_date": 1484759841, "last_edit_date": 1484777343, "question_id": 41725580, "link": "https://stackoverflow.com/questions/41725580/using-stl-vector-as-a-fifo-container-for-byte-data", "title": "Using STL vector as a FIFO container for byte data", "body": "<p>I have a thread running that reads a stream of bytes from a serial port. It does this continuously in the background, and reads from the stream come in at different, separate times. I store the data in a container like so:</p>\n\n<pre><code>using ByteVector = std::vector&lt;std::uint8_t&gt;;\nByteVector receive_queue;\n</code></pre>\n\n<p>When data comes in from the serial port, I append it to the end of the byte queue:</p>\n\n<pre><code>ByteVector read_bytes = serial_port-&gt;ReadBytes(100); // read 100 bytes; returns as a \"ByteVector\"\nreceive_queue.insert(receive_queue.end(), read_bytes.begin(), read_bytes.end());\n</code></pre>\n\n<p>When I am ready to read data in the receive queue, I remove it from the front:</p>\n\n<pre><code>unsigned read_bytes = 100;\n// Read 100 bytes from the front of the vector by using indices or iterators, then:\nreceive_queue.erase(receive_queue.begin(), receive_queue.begin() + read_bytes);\n</code></pre>\n\n<p>This isn't the full code, but gives a good idea of how I'm utilizing the vector for this data streaming mechanism.</p>\n\n<p>My main concern with this implementation is the removal from the front, which requires shifting each element removed (I'm not sure how optimized <code>erase()</code> is for vector, but in the worst case, each element removal results in a shift of the entire vector). On the flip side, vectors are candidates for CPU cache locality because of the contiguous nature of the data (but CPU cache usage is not guaranteed).</p>\n\n<p>I've thought of maybe using <code>boost::circular_buffer</code>, but I'm not sure if it's the right tool for the job.</p>\n\n<p>I have not yet coded an upper-limit for the growth of the receive queue, however I could easily do a <code>reserve(MAX_RECEIVE_BYTES)</code> somewhere, and make sure that <code>size()</code> is never greater than <code>MAX_RECEIVE_BYTES</code> as I continue to append to the back of it.</p>\n\n<p>Is this approach generally OK? If not, what performance concerns are there? What container would be more appropriate here?</p>\n"}, {"tags": ["c++", "sockets", "sfml"], "comments": [{"owner": {"reputation": 1518, "user_id": 2434628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f694c7757c0085ac1f0ed88d960ff657?s=128&d=identicon&r=PG", "display_name": "AresCaelum", "link": "https://stackoverflow.com/users/2434628/arescaelum"}, "edited": false, "score": 0, "creation_date": 1484761145, "post_id": 41725557, "comment_id": 70646475, "body": "When you restart the client are you telling it to listen to the same port it was listening on previously?"}, {"owner": {"reputation": 1518, "user_id": 2434628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f694c7757c0085ac1f0ed88d960ff657?s=128&d=identicon&r=PG", "display_name": "AresCaelum", "link": "https://stackoverflow.com/users/2434628/arescaelum"}, "edited": false, "score": 0, "creation_date": 1484761332, "post_id": 41725557, "comment_id": 70646576, "body": "Where are you binding the port on your client?"}, {"owner": {"reputation": 2159, "user_id": 1080517, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2716302deba4765ec00122e0b0da833d?s=128&d=identicon&r=PG", "display_name": "sebap123", "link": "https://stackoverflow.com/users/1080517/sebap123"}, "reply_to_user": {"reputation": 1518, "user_id": 2434628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f694c7757c0085ac1f0ed88d960ff657?s=128&d=identicon&r=PG", "display_name": "AresCaelum", "link": "https://stackoverflow.com/users/2434628/arescaelum"}, "edited": false, "score": 0, "creation_date": 1484761397, "post_id": 41725557, "comment_id": 70646614, "body": "@Eddge 1. Yes, I provide it with the same data. 2. I just realized, I&#39;m only binding server. Yet, client is working (only once however)."}, {"owner": {"reputation": 1518, "user_id": 2434628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f694c7757c0085ac1f0ed88d960ff657?s=128&d=identicon&r=PG", "display_name": "AresCaelum", "link": "https://stackoverflow.com/users/2434628/arescaelum"}, "edited": false, "score": 0, "creation_date": 1484761443, "post_id": 41725557, "comment_id": 70646635, "body": "I am willing to bet that if you binded the port on the client and rebinded it to the same port everytime it would work, since you are creating a UdpSocket.  When you close the client make sure it is removing its binding to the port as well."}, {"owner": {"reputation": 1518, "user_id": 2434628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f694c7757c0085ac1f0ed88d960ff657?s=128&d=identicon&r=PG", "display_name": "AresCaelum", "link": "https://stackoverflow.com/users/2434628/arescaelum"}, "edited": false, "score": 1, "creation_date": 1484761502, "post_id": 41725557, "comment_id": 70646670, "body": "if you send a message to the servers on the same server port there is no gurantee that your client when it creates its udpsocket that it is using the same port(clientside) everytime you can test this by printing out the port it is currently using when it sends the data."}, {"owner": {"reputation": 2159, "user_id": 1080517, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2716302deba4765ec00122e0b0da833d?s=128&d=identicon&r=PG", "display_name": "sebap123", "link": "https://stackoverflow.com/users/1080517/sebap123"}, "reply_to_user": {"reputation": 1518, "user_id": 2434628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f694c7757c0085ac1f0ed88d960ff657?s=128&d=identicon&r=PG", "display_name": "AresCaelum", "link": "https://stackoverflow.com/users/2434628/arescaelum"}, "edited": false, "score": 0, "creation_date": 1484762112, "post_id": 41725557, "comment_id": 70646972, "body": "@Eddge I&#39;ve tested ports on client and indeed there is some error. I have port 0."}], "answers": [{"tags": [], "owner": {"reputation": 1518, "user_id": 2434628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f694c7757c0085ac1f0ed88d960ff657?s=128&d=identicon&r=PG", "display_name": "AresCaelum", "link": "https://stackoverflow.com/users/2434628/arescaelum"}, "is_accepted": true, "score": 1, "last_activity_date": 1484761930, "creation_date": 1484761930, "answer_id": 41726182, "question_id": 41725557, "link": "https://stackoverflow.com/questions/41725557/blocking-connection-between-server-client-using-socket-communication/41726182#41726182", "title": "Blocking connection between server-client using socket communication", "body": "<p>With networking there are 2 very important key notes to remember with UDP and TCP.</p>\n\n<p>TCP - is connection based, this means everytime it attempts to send it a message it needs to have someone on the other end.</p>\n\n<p>UDP - is connectionless based, this means he will send information to where ever you want him to.  He can send and receive information, but in order to receive data he needs to be binded to a port.  So in your server you are binding him to the same port everytime.</p>\n\n<p>In your client you are giving him a port to send information to, not binding him to a specific port. Whenever you shut down your client he should release the port, and whenever you restart the client he should bind to the same port, if you want him to be able to receive data from your server.  If you don't essentially whats going on is the data gets to the IP and port it was sent to, but there is no application associated with that port so the packet is lost.</p>\n"}, {"comments": [{"owner": {"reputation": 2159, "user_id": 1080517, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2716302deba4765ec00122e0b0da833d?s=128&d=identicon&r=PG", "display_name": "sebap123", "link": "https://stackoverflow.com/users/1080517/sebap123"}, "edited": false, "score": 0, "creation_date": 1484763257, "post_id": 41726468, "comment_id": 70647652, "body": "Thank you for extensive explanation. So just to be clear - whenever I want to receive new information from server I should send request from my client with it&#39;s receiving port number and after one packet repeat? Is that correct?"}, {"owner": {"reputation": 10901, "user_id": 1076479, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/eLQUX.jpg?s=128&g=1", "display_name": "Gil Hamilton", "link": "https://stackoverflow.com/users/1076479/gil-hamilton"}, "reply_to_user": {"reputation": 2159, "user_id": 1080517, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2716302deba4765ec00122e0b0da833d?s=128&d=identicon&r=PG", "display_name": "sebap123", "link": "https://stackoverflow.com/users/1080517/sebap123"}, "edited": false, "score": 2, "creation_date": 1484765090, "post_id": 41726468, "comment_id": 70648665, "body": "Yes. Well, you&#39;d likely be better off creating a TCP connection for what you&#39;re trying to do. You want the client in effect to check in once and say &quot;I&#39;m here&quot; then the server is sending (only) to the client. UDP is poorly suited to this use case. It will work fine until the client goes away, but there is no way for the server to know when this happens. If you want to do this with UDP, you&#39;d at least need to have the client check in again periodically and have the server time out the client if it doesn&#39;t check in. (Alternatively, yes you can have the client send a new check-in every packet.)"}], "tags": [], "owner": {"reputation": 10901, "user_id": 1076479, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/eLQUX.jpg?s=128&g=1", "display_name": "Gil Hamilton", "link": "https://stackoverflow.com/users/1076479/gil-hamilton"}, "is_accepted": false, "score": 1, "last_activity_date": 1484762854, "creation_date": 1484762854, "answer_id": 41726468, "question_id": 41725557, "link": "https://stackoverflow.com/questions/41725557/blocking-connection-between-server-client-using-socket-communication/41726468#41726468", "title": "Blocking connection between server-client using socket communication", "body": "<p>In order to communicate between two parties via UDP, each side needs a unique (address, port) pair. Typically the server binds its socket to a fixed/well-known port, and the client port varies by client -- hence allowing multiple clients to communicate with the same server, each on their own port.</p>\n\n<p>If your client, as here, <em>doesn't</em> explicitly bind its socket to a port, the operating system will dynamically allocate a \"random\" unused port to it and automatically bind it on the first use of the port for sending data. As long as that client continues to use the same socket, the port number is fixed.</p>\n\n<p>However, when you restart the client side, it gets a <em>new</em> socket and on its first send using the new socket, the OS binds the socket to a new port. Your server however, is assuming that the client port number is still the number that it received from the first client. </p>\n\n<p>Because of the way this works, for UDP servers, the usual pattern is that every message stands alone. The server makes note of the client's address and port number every time it receives a message and then responds back to that address/port. The server typically doesn't assume that any two consecutive messages will come from the same client as there is no way for it to know when any given client has disappeared.</p>\n\n<p>(You <em>can</em> build your own more durable \"connection\" notion atop UDP -- as NFS traditionally did, for example -- but that is a significant amount of work that requires due care in designing your protocol. And it works within this same fundamental model described above.)</p>\n\n<p>It is also possible for your client to always explicitly bind to a port you select. However, that would limit you to running one instance of the client on any one machine (well, on any one network address really).</p>\n"}], "owner": {"reputation": 2159, "user_id": 1080517, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2716302deba4765ec00122e0b0da833d?s=128&d=identicon&r=PG", "display_name": "sebap123", "link": "https://stackoverflow.com/users/1080517/sebap123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "accepted_answer_id": 41726182, "answer_count": 2, "score": 1, "last_activity_date": 1484762854, "creation_date": 1484759795, "question_id": 41725557, "link": "https://stackoverflow.com/questions/41725557/blocking-connection-between-server-client-using-socket-communication", "title": "Blocking connection between server-client using socket communication", "body": "<p>I am having some strange problem with my client-server connection using UDP and SFML and I am slowly running out of ideas what might be wrong, so maybe someone will be able to help me.</p>\n\n<p>Currently I can connect client to server and send message from server to client. When I kill the client application and restart it again (on this same machine), provide this same connection parameters of server, nothing happens. It appears like if there is no connection established. Client is just waiting for message form server, while server is constantly sending messages at the same time.</p>\n\n<p>My server side looks like that:</p>\n\n<pre><code>std::shared_ptr&lt;sf::UdpSocket&gt; startUdpServer()\n{\n    std::cout &lt;&lt; \"Local address: \";\n    std::cout &lt;&lt; sf::IpAddress::getLocalAddress().toString() &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"Public address: \";\n    std::cout &lt;&lt; sf::IpAddress::getPublicAddress().toString() &lt;&lt; std::endl;\n    std::shared_ptr&lt;sf::UdpSocket&gt; socket(new sf::UdpSocket());\n\n    if(socket-&gt;bind(sf::Socket::AnyPort) != sf::Socket::Done)\n        return nullptr;\n    std::cout &lt;&lt; \"Server is listening to port \" &lt;&lt; socket-&gt;getLocalPort() &lt;&lt; \", waiting for a message... \" &lt;&lt; std::endl;\n    return socket;\n}\n\nstd::pair&lt;sf::IpAddress, unsigned short&gt; runUdpServer(std::shared_ptr&lt;sf::UdpSocket&gt; socket)\n{\n    // Wait for a message\n    char in[128];\n    std::size_t received;\n    sf::IpAddress sender;\n    unsigned short senderPort;\n    if (socket-&gt;receive(in, sizeof(in), received, sender, senderPort) != sf::Socket::Done)\n    {\n        std::cout &lt;&lt; \"Connection error\" &lt;&lt; std::endl;\n        return std::make_pair(sender, senderPort);\n    }\n    std::cout &lt;&lt; \"Message received from client \" &lt;&lt; sender &lt;&lt; \": \\\"\" &lt;&lt; in &lt;&lt; \"\\\"\" &lt;&lt; std::endl;\n    return std::make_pair(sender, senderPort);\n}\n\nvoid sendUdpMessage(std::shared_ptr&lt;sf::UdpSocket&gt; socket, std::pair&lt;sf::IpAddress, unsigned short&gt; config,\n                    std::string message)\n{\n    const char* out = message.c_str();\n    if (socket-&gt;send(out, sizeof(char) * message.length(), config.first, config.second) != sf::Socket::Done)\n    {\n        std::cout &lt;&lt; \"Message not send\" &lt;&lt; std::endl;\n        return;\n    }\n}\n\nvoid sendMessages(std::shared_ptr&lt;sf::UdpSocket&gt; socket, std::pair&lt;sf::IpAddress, unsigned short&gt; config)\n{\n    if(config.first != sf::IpAddress::None)\n    {\n        while(true)\n            sendUdpMessage(socket,config,\"Test msg\");\n    }\n    else\n        std::cout &lt;&lt; \"Message sending error\" &lt;&lt; std::endl;\n}\n\nauto socket = startUdpServer();\nauto config = runUdpServer(socket);\nstd::thread messages_thread(sendMessages,socket,config);\n</code></pre>\n\n<p>and my client:</p>\n\n<pre><code>std::shared_ptr&lt;sf::UdpSocket&gt; startUdpClient()\n{\n    sf::IpAddress server;\n    do\n    {\n        std::cout &lt;&lt; \"Type the address or name of the server to connect to: \";\n        std::cin  &gt;&gt; server;\n    }\n    while (server == sf::IpAddress::None);\n\n    unsigned short port;\n    std::cout &lt;&lt; \"Type the port number: \";\n    std::cin &gt;&gt; port;\n\n    std::shared_ptr&lt;sf::UdpSocket&gt; socket(new sf::UdpSocket());\n    sf::Packet packet;\n    const char out[] = \"Hi, I'm a client\";\n    if (socket-&gt;send(out, sizeof(out), server, port) != sf::Socket::Done)\n        return nullptr;\n    return socket;\n}\n\nvoid runUdpClient(std::shared_ptr&lt;sf::UdpSocket&gt; socket)\n{\n    char in[256];\n    std::size_t received;\n    sf::IpAddress sender;\n    unsigned short senderPort;\n    if (socket-&gt;receive(in, sizeof(in), received, sender, senderPort) != sf::Socket::Done)\n        return;\n    std::cout &lt;&lt; \"Message received: \\\"\" &lt;&lt; in &lt;&lt; \"\\\"\" &lt;&lt; std::endl;\n}\n\nauto socketUDP = startUdpClient();\nstd::thread messagesThread(receiveMessages,socketUDP);\n\nvoid receiveMessages(std::shared_ptr&lt;sf::UdpSocket&gt; socket)\n{\n    while(true)\n        runUdpClient(socket);\n}\n</code></pre>\n"}, {"tags": ["c++", "system", "stdstring"], "comments": [{"owner": {"reputation": 5673, "user_id": 2376156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2s2R4.jpg?s=128&g=1", "display_name": "edtheprogrammerguy", "link": "https://stackoverflow.com/users/2376156/edtheprogrammerguy"}, "edited": false, "score": 0, "creation_date": 1484759830, "post_id": 41725525, "comment_id": 70645728, "body": "What&#39;s the error?"}], "answers": [{"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1484759858, "creation_date": 1484759858, "answer_id": 41725584, "question_id": 41725525, "link": "https://stackoverflow.com/questions/41725525/using-a-string-variable-to-ping-and-save-a-file-in-c/41725584#41725584", "title": "using a string variable to ping and save a file in C++", "body": "<p><code>ip</code> is not a shell command. I'm guessing you thought the string <code>\"ip\"</code> in the <code>system</code> call would be implicitly replaced with the string <code>ip</code> in your program; it doesn't work that way.</p>\n\n<p>You can put the entire command string in <code>ip</code> then use the <code>.c_str()</code> method to convert the string to the <code>const char *</code> array that <code>system</code> expects:</p>\n\n<pre><code>ip += \" &gt; pingresult.txt\";\nsystem(ip.c_str());\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7436966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4ab3a01345c9f99bef845ddf6dfd26a?s=128&d=identicon&r=PG&f=1", "display_name": "Zihaan", "link": "https://stackoverflow.com/users/7436966/zihaan"}, "edited": false, "score": 0, "creation_date": 1484762282, "post_id": 41725830, "comment_id": 70647044, "body": "Well now i got it right Thank you very much!"}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 0, "last_activity_date": 1484761238, "last_edit_date": 1484761238, "creation_date": 1484760659, "answer_id": 41725830, "question_id": 41725525, "link": "https://stackoverflow.com/questions/41725525/using-a-string-variable-to-ping-and-save-a-file-in-c/41725830#41725830", "title": "using a string variable to ping and save a file in C++", "body": "<p>You must first build the full command into an <code>std::string</code>, and then pass it as a <code>const char *</code> to the <code>system</code> function:</p>\n\n<pre><code>string ipAddress;\n\ncout &lt;&lt; \"Enter the ip address: \";\ncin &gt;&gt; ipAddress;\n\nstring cmd = \"ping \" + ipAddress + \" &gt; pingresult.txt\";\nsystem (cmd.c_str()); // pass a const char *\n//system(\"exit\"); this is a no-op spawning a new shell to only execute exit...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7436966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4ab3a01345c9f99bef845ddf6dfd26a?s=128&d=identicon&r=PG&f=1", "display_name": "Zihaan", "link": "https://stackoverflow.com/users/7436966/zihaan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 792, "favorite_count": 0, "closed_date": 1484762294, "answer_count": 2, "score": -2, "last_activity_date": 1484761238, "creation_date": 1484759703, "last_edit_date": 1484760305, "question_id": 41725525, "link": "https://stackoverflow.com/questions/41725525/using-a-string-variable-to-ping-and-save-a-file-in-c", "closed_reason": "Duplicate", "title": "using a string variable to ping and save a file in C++", "body": "<pre><code>system( \"ping www.google.com  &gt;  pingresult.txt\") \n</code></pre>\n\n<p>From this code can the string <code>\"ping www.google.com\"</code>  be taken from an <code>std::string</code> variable? For example:</p>\n\n<pre><code>string ipAddress;\n\ncout &lt;&lt; \"Enter the ip address: \";\ncin &gt;&gt; ipAddress;\n\nstring ip = \"ping\" + ipAddress;\n**system (\"ip &gt; pingresult.txt\");** //error here\nsytem(\"exit\");\n</code></pre>\n"}, {"tags": ["c++", "c", "r"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 3, "creation_date": 1484759773, "post_id": 41725476, "comment_id": 70645692, "body": "<i>&quot;The existing solutions for this type of problem did not help me.&quot;</i> - We ain&#39;t mind readers. We don&#39;t know which solutions you have tried that apparently didn&#39;t help. Anyway, you are loading a 64-bit module into a 32-bit process. This isn&#39;t going to end well. You&#39;ll have to get a hold of a 32-bit module."}], "answers": [{"tags": [], "owner": {"reputation": 1031, "user_id": 7158505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ucFS3.jpg?s=128&g=1", "display_name": "Eduard Malakhov", "link": "https://stackoverflow.com/users/7158505/eduard-malakhov"}, "is_accepted": false, "score": -1, "last_activity_date": 1484760092, "creation_date": 1484760092, "answer_id": 41725679, "question_id": 41725476, "link": "https://stackoverflow.com/questions/41725476/loadlibrary-failure-1-is-not-a-valid-win32-application-in-r/41725679#41725679", "title": "LoadLibrary failure: %1 is not a valid Win32 application. in R", "body": "<p>Such errors often refer to architecture mismatch, apparently when one tries to load a x86-64 module on a x86 machine. Please, make sure that on the x86 machine you're loading a .dll compiled specifically for the x86 architecture.</p>\n"}], "owner": {"reputation": 29, "user_id": 7436887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b345e0f366046789fb9c8f8d4aa21f57?s=128&d=identicon&r=PG&f=1", "display_name": "Quincy", "link": "https://stackoverflow.com/users/7436887/quincy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4652, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484768353, "creation_date": 1484759550, "last_edit_date": 1484768353, "question_id": 41725476, "link": "https://stackoverflow.com/questions/41725476/loadlibrary-failure-1-is-not-a-valid-win32-application-in-r", "title": "LoadLibrary failure: %1 is not a valid Win32 application. in R", "body": "<p>I have a C code which is loaded through R for my project. Using dyn.load, I was able to load the C code in Windows 64 bit machine and Linux server. However, I am getting the following error when I try to load .dll in Windows 32bit machine. </p>\n\n<p><a href=\"https://i.stack.imgur.com/t68fR.png\" rel=\"nofollow noreferrer\">R error while using dyn.load</a></p>\n\n<p>I tried using the whole path, running the dyn.load command from working directory but none of them worked. \nMy R version:\n<a href=\"https://i.stack.imgur.com/RWEYC.png\" rel=\"nofollow noreferrer\">R version</a></p>\n\n<p>Also, I have edited the system variables and below you can find the system variables.</p>\n\n<pre><code>`C:\\ProgramData\\Oracle\\Java\\javapath;\n%SystemRoot%\\system32;\n%SystemRoot%;\n%SystemRoot%\\System32\\Wbem;\n%SYSTEMROOT%\\System32\\WindowsPowerShell\\v1.0\\;\nC:\\Program Files\\Common Files\\Roxio Shared\\DLLShared\\;\nC:\\Program Files\\Common Files\\Roxio Shared\\10.0\\Roxio Central36;\nC:\\Program Files\\Windows Imaging\\;\nC:\\Program Files\\QuickTime\\QTSystem\\;\nC:\\Program Files\\R\\R-3.3.2\\bin;\nC:\\Rtools\\bin;\nC:\\Rtools\\mingw_32\\bin;\nC:\\Rtools\\mingw_32\\lib\\gcc\\i686-w64-mingw32\\4.9.3;\nC:\\Users\\******\\Documents\\R\\R-3.3.2\\library\\Rcpp`\n</code></pre>\n\n<p>The existing solutions for this type of problem did not help me.</p>\n\n<p>It would be great if someone can help me solve this problem.</p>\n"}, {"tags": ["c++", "qt", "opencv", "opengl"], "answers": [{"tags": [], "owner": {"reputation": 2346, "user_id": 5179465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d11933d9ee569ac40d0111430579f556?s=128&d=identicon&r=PG&f=1", "display_name": "ilke444", "link": "https://stackoverflow.com/users/5179465/ilke444"}, "is_accepted": true, "score": 0, "last_activity_date": 1484791448, "creation_date": 1484791448, "answer_id": 41732564, "question_id": 41725395, "link": "https://stackoverflow.com/questions/41725395/properly-using-qt-wrappers-to-upload-3d-texture/41732564#41732564", "title": "Properly using QT wrappers to upload 3D texture", "body": "<p>You create and fill a <code>QOpenGLTexture</code> object, however the OpenGL pipeline does not actually start using that object unless you bind it to a unit ready for rendering. You should call it either as <code>m_texture-&gt;bind()</code> or <code>m_texture-&gt;bind(uint unit)</code>, depending on your renderable object.</p>\n\n<p>The second print outputs garbage values, because the following line tries to read from an empty texture, into an <code>unsigned char</code> array of size <code>m_vol_data.total()</code>. </p>\n\n<pre><code>glGetTexImage(GL_TEXTURE_3D, 0, GL_RED, GL_UNSIGNED_BYTE, check);\n</code></pre>\n\n<p>More documentation about the class is <a href=\"http://doc.qt.io/qt-5/qopengltexture.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 7481, "user_id": 2666270, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8b08ff3f628c4d11f81fe113c6eda6b9?s=128&d=identicon&r=PG", "display_name": "pceccon", "link": "https://stackoverflow.com/users/2666270/pceccon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "accepted_answer_id": 41732564, "answer_count": 1, "score": 0, "last_activity_date": 1484791448, "creation_date": 1484759300, "question_id": 41725395, "link": "https://stackoverflow.com/questions/41725395/properly-using-qt-wrappers-to-upload-3d-texture", "title": "Properly using QT wrappers to upload 3D texture", "body": "<p>I'm trying to upload a texture from a OpenCV 3D matrix using the QT wrappers. </p>\n\n<p>This is my code (including tests):</p>\n\n<pre><code> unsigned char * buffer = new unsigned char[m_vol_data.total()];\n    for (int i = 0; i &lt; m_vol_data.size[0]; i ++)\n        for (int j = 0; j &lt; m_vol_data.size[1]; j ++)\n            for (int k= 0; k &lt; m_vol_data.size[2]; k ++)\n            {\n                buffer[i + m_vol_data.size[0] * (j + m_vol_data.size[2] * k)] = m_vol_data.at&lt;uint8_t&gt;(i, j, k);\n//                      printf(\"%d, %d \\n\", m_vol_data.at&lt;uint8_t&gt;(i, j, k),buffer[i + m_vol_data.size[0] * (j + m_vol_data.size[2] * k)]);\n            }\n\n    m_texture = new QOpenGLTexture(QOpenGLTexture::Target3D);\n    m_texture-&gt;setSize(m_vol_data.size[0], m_vol_data.size[1], m_vol_data.size[2]);\n    m_texture-&gt;allocateStorage(QOpenGLTexture::Luminance, QOpenGLTexture::UInt8);\n    m_texture-&gt;setData(QOpenGLTexture::Luminance, QOpenGLTexture::UInt8, buffer);\n    m_vol_uploaded = true;\n\n    unsigned char * check = new unsigned char[m_vol_data.total()];\n    glGetTexImage(GL_TEXTURE_3D, 0, GL_RED, GL_UNSIGNED_BYTE, check);\n    for (int i = 0; i &lt; 100; i++)\n        printf(\"%d\\n\", check[i]);\n    std::cout &lt;&lt; m_vol_data.total() &lt;&lt; std::endl;\n</code></pre>\n\n<p>The first (commented) print shows me what I expected, all values being 255 (dummy test). However, my cube is appearing all black in the screen. The second print shows unexpected values, ranging from 0 to 255. </p>\n\n<p>These are the shaders:</p>\n\n<pre><code>  m_program-&gt;addShaderFromSourceCode(QOpenGLShader::Vertex, \"#version 410 core\\n\"\n                                                            \"in vec4 vPosition;\\n\"\n                                                            \"uniform mat4 pMatrix;\\n\"\n                                                            \"uniform mat4 mvMatrix;\\n\"\n                                                            \"smooth out vec3 uv;\\n\"\n                                                            \"void main() {\\n\"\n                                                            \"   gl_Position = pMatrix * mvMatrix * vPosition;\\n\"\n                                                            \"   uv = (vPosition.xyz + vec3(1.0, 1.0, 1.0))/2.0;\\n\"\n                                                            \"}\");\n  m_program-&gt;addShaderFromSourceCode(QOpenGLShader::Fragment, \"#version 410 core\\n\"\n                                                              \"in vec3 uv;\\n\"\n                                                              \"uniform sampler3D tex;\\n\"\n                                                              \"out vec4 fragColor;\\n\"\n                                                              \"void main(){\\n\"\n                                                              \"  vec3 color = texture(tex, uv).rrr;\\n\"\n                                                              \"  fragColor.rgb = color;\\n\"\n                                                              \"};\");\n</code></pre>\n\n<p>I'm trying to figure it out the problem, with no success. Any clue wold be appreciated. Thanks.</p>\n"}, {"tags": ["c++", "makefile"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1484758418, "post_id": 41724985, "comment_id": 70644808, "body": "Had you considered that maybe there is <i>&quot;no rule to make target &#39;bin/smartCart_app&#39;&quot;</i> (which is required by the target <i>all</i>)?"}, {"owner": {"reputation": 303, "user_id": 1867459, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e6c7baf3bea6b75a4d73b7da29ed8799?s=128&d=identicon&r=PG", "display_name": "user1867459", "link": "https://stackoverflow.com/users/1867459/user1867459"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1484759373, "post_id": 41724985, "comment_id": 70645449, "body": "I added the rule now as below. Now, it gives no rule to make target baseStation.cpp&quot; needed by build/baseStation.o # Explicit rules. .PHONY: all clean $(PHONY) all: $(BIN)/smartCart_app  $(BIN)/smartCart_app: $(SC_OBJS) \t\t @echo &quot;Linking $(notdir $@)&quot; \t\t@$(CPP) -o $@ $^ $(CC_LDFLAGS) clean:  \t\t..    Looks like I am missing something very important. Please explain."}, {"owner": {"reputation": 1552, "user_id": 2362671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0585760afe78ec9aafe1836b826ed495?s=128&d=identicon&r=PG", "display_name": "Come Raczy", "link": "https://stackoverflow.com/users/2362671/come-raczy"}, "edited": false, "score": 0, "creation_date": 1484850721, "post_id": 41724985, "comment_id": 70690716, "body": "Have you considered that maybe there is &quot;no rule to make target &#39;&#39;baseStation.cpp&quot; (which is required by the target build/baseStation.o)? :-) If baseStation.cpp is not in the current directory, you need to add the path to VPATH (I guess it isn&#39;t in src/config or src/util otherwise you&#39;d get another error)"}, {"owner": {"reputation": 1552, "user_id": 2362671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0585760afe78ec9aafe1836b826ed495?s=128&d=identicon&r=PG", "display_name": "Come Raczy", "link": "https://stackoverflow.com/users/2362671/come-raczy"}, "edited": false, "score": 1, "creation_date": 1484850775, "post_id": 41724985, "comment_id": 70690746, "body": "also, <code>SC_SRC_RELDIRS</code> is incorrect (missing <code>&#47;</code> after <code>$(SC_SRC_ROOT)</code>)"}, {"owner": {"reputation": 303, "user_id": 1867459, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e6c7baf3bea6b75a4d73b7da29ed8799?s=128&d=identicon&r=PG", "display_name": "user1867459", "link": "https://stackoverflow.com/users/1867459/user1867459"}, "reply_to_user": {"reputation": 1552, "user_id": 2362671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0585760afe78ec9aafe1836b826ed495?s=128&d=identicon&r=PG", "display_name": "Come Raczy", "link": "https://stackoverflow.com/users/2362671/come-raczy"}, "edited": false, "score": 0, "creation_date": 1484941983, "post_id": 41724985, "comment_id": 70734107, "body": "I am able to compile the code. I was able to fix the above issue &quot;/&quot; which was also found by @ComeRaczy."}], "owner": {"reputation": 303, "user_id": 1867459, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e6c7baf3bea6b75a4d73b7da29ed8799?s=128&d=identicon&r=PG", "display_name": "user1867459", "link": "https://stackoverflow.com/users/1867459/user1867459"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 494, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484760721, "creation_date": 1484758122, "question_id": 41724985, "link": "https://stackoverflow.com/questions/41724985/c-make-file-issue-no-rule-to-make-target", "title": "C++ Make file issue &quot;No rule to make target ...&quot;", "body": "<p>I just started working with makefile. \nI am getting the error with makefile of my C++ project. </p>\n\n<p><strong>make:  No rule to make target 'bin/smartCart_app', needed by all.</strong>\n Below is the directory structure and files associated with it. </p>\n\n<pre><code>VBOX:~BASE$ls\nbuild src \nVBOX:~BASE$cd build\nVBOX:~BASE/build$ ls\nbin build Makefile.sc \nVBOX:~BASE/build$ cd ../src\nVBOX:~BASE/src$ls\nbaseStation.cpp config util //config and util has header and cpp files \n</code></pre>\n\n<p>Here is my Make file </p>\n\n<pre><code>CC=gcc\nCPP=g++\nCCFLAGS=-g -Wall -std=gnu+0x -o0 \nCC_LDFLAGS = -g -Wl \n\nBUILD=./build\nBIN = ./bin\n\nSC_SRC_ROOT = ../src\nSC_SRC_SUBDIRS = config util \nSC_SRC_RELDIRS = $(addprefix $(strip $(SC_SRC_ROOT)), $(strip $(SC_SRC_SUBDIRS)))\nSC_SRCS_ = $(shell /usr/bin/find $(SC_SRC_ROOT)/config $(SC_SRC_ROOT)/util -name \"*.cpp\")\nSC_SRCS = $(SC_SRCS_) baseStation.cpp\nSC_NEW_SRCS = $(notdir $(SC_SRCS))\n\nSPACE :=\nSPACE += \nINCLUDE = $(addprefix -I, $(SRC_RELDIRS))\nVPATH = $(subst $(SPACE),:,$(SRC_RELDIRS)) $(subst $(SPACE),:,$(SC_SRC_RELDIRS))\nSC_INCLUDE = $(addprefix -I, $(SC_SRC_RELDIRS))\n\nSC_OBJS = $(SC_NEW_SRCS:%.cpp=$(BUILD)/%.o)\nSC_DEPS = $(SC_OBJS:%.o=%.d)\n\n# Ensure paths exist.\n$(shell [ -d \"$(BIN)\"   ] || mkdir -p $(BIN))\n$(shell [ -d \"$(BUILD)\" ] || mkdir -p $(BUILD))\n\n# Explicit rules.\n.PHONY: all clean $(PHONY)\nall: $(BIN)/smartCart_app\n\nclean: \n        @echo \"Cleaning...\"\n        -@rm -f $(BIN)/smartCart_app $(SC_OBJS) \n\n$(SC_OBJS): $(BUILD)/%.o: %.cpp\n     @echo \"Compiling $(notdir $&lt;)\"\n    @$(CPP) $(CCFLAGS) $(INCLUDE) $(SC_INCLUDE) -MD -c -o $@ $&lt;\n\n$(MACRO_DEPS):\n    -@rm -f $(patsubst %_ON.d,%_OFF.d,$@) $(patsubst %_OFF.d,%_ON.d,$@) $@\n    @touch $@\n\n#$(ALL_OBJS): %.o: %.d\n\n$(DEPS): $(BUILD)/%.d: %.cpp\n    @$(CC) $&lt; -MM -MF $@ $(INCLUDE)\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 828, "user_id": 3110529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a4e7cd657480d3e547be462d7a8aff5?s=128&d=identicon&r=PG", "display_name": "Dillanm", "link": "https://stackoverflow.com/users/3110529/dillanm"}, "edited": false, "score": 3, "creation_date": 1484758310, "post_id": 41724981, "comment_id": 70644732, "body": "Your example will fail because func2 is declared after func"}, {"owner": {"reputation": 7, "user_id": 5147476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2574699b3fec8724e93cf80002830c5c?s=128&d=identicon&r=PG&f=1", "display_name": "Nasx", "link": "https://stackoverflow.com/users/5147476/nasx"}, "edited": false, "score": 0, "creation_date": 1484758533, "post_id": 41724981, "comment_id": 70644890, "body": "I can&#39;t seems to pass the array to func2()"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 828, "user_id": 3110529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a4e7cd657480d3e547be462d7a8aff5?s=128&d=identicon&r=PG", "display_name": "Dillanm", "link": "https://stackoverflow.com/users/3110529/dillanm"}, "edited": false, "score": 2, "creation_date": 1484758625, "post_id": 41724981, "comment_id": 70644964, "body": "See @Dillanm &#39;s comment. You must declare <code>func2</code> before you use it."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1484758644, "post_id": 41724981, "comment_id": 70644979, "body": "@Nasx Why can&#39;t you do it? Is there an error? What is the error message? It may hint at the issue."}, {"owner": {"reputation": 7, "user_id": 5147476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2574699b3fec8724e93cf80002830c5c?s=128&d=identicon&r=PG&f=1", "display_name": "Nasx", "link": "https://stackoverflow.com/users/5147476/nasx"}, "reply_to_user": {"reputation": 828, "user_id": 3110529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a4e7cd657480d3e547be462d7a8aff5?s=128&d=identicon&r=PG", "display_name": "Dillanm", "link": "https://stackoverflow.com/users/3110529/dillanm"}, "edited": false, "score": 0, "creation_date": 1484758721, "post_id": 41724981, "comment_id": 70645021, "body": "@Dillanm Oh it works, seems like I just got the order wrong. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 1, "creation_date": 1484759569, "post_id": 41725248, "comment_id": 70645551, "body": "There is no copying of arrays here.  <code>func</code> and <code>func2</code> both actually take a <code>char*</code> parameter."}], "tags": [], "owner": {"reputation": 140, "user_id": 3986685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c8b7fd610afb090b13abf4ae7f4a85?s=128&d=identicon&r=PG&f=1", "display_name": "Algorithmic", "link": "https://stackoverflow.com/users/3986685/algorithmic"}, "is_accepted": true, "score": 0, "last_activity_date": 1484759183, "last_edit_date": 1484759183, "creation_date": 1484758843, "answer_id": 41725248, "question_id": 41724981, "link": "https://stackoverflow.com/questions/41724981/c-passing-array-to-function-and-then-passing-it-to-another-function/41725248#41725248", "title": "C++ Passing Array to Function and Then Passing It to Another Function", "body": "<p>Try, swap your functions around: </p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nvoid func2(char arr[2])\n{\n    cout &lt;&lt; arr[0] &lt;&lt; arr[1];\n}\n\nvoid func(char arr[2])\n{\n    func2(arr);\n}\n\n\n\nint main()\n{\n    char arr[2] = {1,2};\n    func(arr);\n}\n</code></pre>\n\n<p>The problem is that you're referencing <code>func2</code> which <code>func</code> doesn't know anything about.</p>\n\n<p>Also, try using pointers instead of copying whole arrays into functions. It's much more efficient.</p>\n"}], "owner": {"reputation": 7, "user_id": 5147476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2574699b3fec8724e93cf80002830c5c?s=128&d=identicon&r=PG&f=1", "display_name": "Nasx", "link": "https://stackoverflow.com/users/5147476/nasx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 41725248, "answer_count": 1, "score": 0, "last_activity_date": 1484759183, "creation_date": 1484758107, "last_edit_date": 1484758998, "question_id": 41724981, "link": "https://stackoverflow.com/questions/41724981/c-passing-array-to-function-and-then-passing-it-to-another-function", "title": "C++ Passing Array to Function and Then Passing It to Another Function", "body": "<p>I try to use array from main function that is pass into a function and into another function. Below is the simplified version of what I'm trying to do.</p>\n\n<p>I can't put <code>func2()</code> in the main function because the code I was doing require me to do something in <code>void func()</code> and then apply to <code>void func2()</code>.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nvoid func(char arr[2])\n{\n    func2(arr);\n}\n\nvoid func2(char arr[2])\n{\n    cout &lt;&lt; arr[0] &lt;&lt; arr[1];\n}\n\nint main()\n{\n    char arr[2] = {1,2};\n    func(arr);\n}\n</code></pre>\n\n<p><strong>Edit:</strong>\nSeems like the problem is the order of the function instead of something wrong with the array which I originally thought it was.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nvoid func2(char arr[2])\n{\n    cout &lt;&lt; arr[0] &lt;&lt; arr[1];\n}\n\nvoid func(char arr[2])\n{\n    func2(arr);\n}\n\nint main()\n{\n     char arr[2] = {1,2};\n     func(arr);\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays", "c++11", "vector"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1484758060, "post_id": 41724950, "comment_id": 70644532, "body": "<code>*URGENT*</code>---&gt; asking for DV."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1484758118, "post_id": 41724950, "comment_id": 70644572, "body": "Welcome to Stack Overflow! Sorry to say, but your urgency has nothing to do with people investing their time. Please show your research/debugging effort so far. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> page first."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1484758162, "post_id": 41724950, "comment_id": 70644617, "body": "<code>this[j]</code> does not do what you think it does."}, {"owner": {"reputation": 1, "user_id": 7436771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc9ad39fa5499322f2b2ca6a7bcde6fc?s=128&d=identicon&r=PG&f=1", "display_name": "GadGad", "link": "https://stackoverflow.com/users/7436771/gadgad"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1484758285, "post_id": 41724950, "comment_id": 70644704, "body": "@SouravGhosh about the URGENT i apologize, i appreciate the help, its the first time im asking a question here, i edited"}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484758517, "post_id": 41725067, "comment_id": 70644878, "body": "First of all <code>this</code> does not exist there as <code>sort</code> not a method of a class."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484758658, "post_id": 41725067, "comment_id": 70644983, "body": "@Slava You can&#39;t know that unless you&#39;ve seen the context where it was declared. I haven&#39;t seen the context either, but according to the error message, <code>*this</code> appears to be of type <code>mathVector&lt;double&gt;</code>."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484758752, "post_id": 41725067, "comment_id": 70645047, "body": "context is provided, source of standalone function <code>sort</code> is there."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484759223, "post_id": 41725067, "comment_id": 70645350, "body": "@Slava I looked into my crystal ball and saw that the provided code is incomplete and that you have been mislead by OP. However, I understand your confusion; the question is not of high quality."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 2, "last_activity_date": 1484759362, "last_edit_date": 1484759362, "creation_date": 1484758338, "answer_id": 41725067, "question_id": 41724950, "link": "https://stackoverflow.com/questions/41724950/invalid-operands-to-binary-expression-while-implementing-vector/41725067#41725067", "title": "Invalid operands to binary expression while implementing vector", "body": "<p><code>this[j]</code> is hardly ever the right thing to do. It can only be correct, if <code>*this</code> happens to be a subobject within an array, and have at least <code>j</code> siblings after it. <code>this[j]</code> is equivalent to <code>*(this + j)</code>. As you can see, it dereferences a pointer to <code>j</code>th sibling after <code>*this</code>.</p>\n\n<p>I suspect, that you instead intended to access the elements of the buffer by calling <code>Vector::operator[]</code>. You'd do that by dereferencing the pointer first: <code>(*this)[j]</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 7436771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc9ad39fa5499322f2b2ca6a7bcde6fc?s=128&d=identicon&r=PG&f=1", "display_name": "GadGad", "link": "https://stackoverflow.com/users/7436771/gadgad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 767, "favorite_count": 0, "closed_date": 1484758380, "answer_count": 1, "score": -6, "last_activity_date": 1484759362, "creation_date": 1484758027, "last_edit_date": 1484758388, "question_id": 41724950, "link": "https://stackoverflow.com/questions/41724950/invalid-operands-to-binary-expression-while-implementing-vector", "closed_reason": "Not suitable for this site", "title": "Invalid operands to binary expression while implementing vector", "body": "<p>In an assigment, I was asked to create my own <code>Vector&lt;T&gt;</code>, <code>Mathvector&lt;T&gt;</code> (which inherits from vector) and a <code>Polynomial</code> class type.\nI'm getting the following error and couldn't figure out why.</p>\n\n<pre><code>MathVector.h:37:32: error: invalid operands to binary expression ('mathVector&lt;double&gt;' and 'mathVector&lt;double&gt;')\n                if (this[j]&gt;this[j+1])\n</code></pre>\n\n<p>Ihe sort function is in \"mathVector.h\" and its goal is to sort the vector in ascending or descending order.</p>\n\n<p><strong>This is the error part of the \"MathVector.h\":</strong></p>\n\n<pre><code>void sort(int index) {\n        int i,j;\n        int n=this-&gt;get_size();\n        if (index==1) {\n            for (i=0; i&lt;n-1; i++)\n                for (j=0; j&lt;n-i-1; j++) {\n\n                    if (this[j]&gt;this[j+1]) {\n                        T temp;\n                        temp=this[j+1];\n                        this[j+1]=this[j];\n                        this[j]=temp;\n                    }\n                }\n        }\n        else {\n            for (i=0; i&lt;n-1; i++)\n                for (j=0; j&lt;n-i-1; j++) {\n                    if (this[j]&lt;this[j+1]) {\n                        T temp;\n                        temp=this[j+1];\n                        this[j+1]=this[j];\n                        this[j]=temp;\n                    }\n                }\n        }\n        return;\n    }\n</code></pre>\n\n<p><strong>This is the \"vector.h\":</strong></p>\n\n<pre><code>template&lt;class T&gt;\nclass Vector {\nprivate:\n    int _size;\n    int _capacity;\n    T *_data;\n\n    static T *allocate(int size) {\n        return static_cast&lt;T *&gt;(malloc(sizeof(T) * size));\n    }\n\n    static void copyRange(T *begin, T *end, T *dest) {\n        while (begin != end) {\n            new((void *) dest) T(*begin);\n            ++begin;\n            ++dest;\n        }\n    }\n\n    static void deleteRange(T *begin, T *end) {\n        while (begin != end) {\n            begin-&gt;~T();\n            ++begin;\n        }\n    }\n\npublic:\n\n    Vector() {\n        _size = 0;\n        _capacity = 0;\n        _data = 0;\n    }\n\n    ~Vector() {\n        deleteRange(_data, _data + _size);\n        free(_data);\n    }\n\n    Vector(const Vector &amp;obj) {\n        this-&gt;_size = obj.get_size();\n        this-&gt;_data = obj.get_data();\n        this-&gt;_capacity = obj.get_capacity();\n    }\n\n    void insert(const T &amp;value) {\n        if (_size != _capacity) {\n            new((void *) (_data + _size)) T(value);\n            ++_size;\n            return;\n        }\n        int newCapacity;\n        if (_capacity == 0) { newCapacity = 1; }\n        else (newCapacity = _capacity * 2);\n        T *newData = allocate(newCapacity);\n        copyRange(_data, _data + _size, newData);\n        new((void *) (newData + _size)) T(value);\n        deleteRange(_data, _data + _size);\n        free(_data);\n        _data = newData;\n        _capacity = newCapacity;\n        ++_size;\n    }\n\n    void resize(int index) {\n        if (index == _capacity) { return; }\n        else if (index &gt; _capacity) { _capacity = index; }\n        else {\n            _capacity = index;\n            if (index &lt; _size) {\n                deleteRange(_data + index, _data + _size);\n                _size = index;\n            }\n        }\n    }\n\n    T &amp;operator[](int index) {\n        T empty;\n        if ((index &lt; 0) || (index &gt;= _size)) {\n            cout&lt;&lt;\"Wrong Index\";\n            return empty;\n        }\n        return _data[index];\n    }\n\n    const T &amp;\n    operator[](int index) const {\n        T empty;\n        if ((index &lt; 0) || (index &gt;= _size)) {\n            cout&lt;&lt;\"Wrong Index\";\n            return empty;\n        } else return _data[index];\n    }\n\n    Vector &amp;operator=(const Vector &amp;other) {\n        this-&gt;_size = other.get_size();\n        this-&gt;_data = other.get_data();\n        this-&gt;_capacity = other.get_capacity();\n        return *this;\n    }\n\n\n    friend ostream &amp;operator&lt;&lt;(ostream &amp;os, const Vector &amp;other) {\n        os &lt;&lt; \"Size: \" &lt;&lt; other._size &lt;&lt; \" | Capacity: \" &lt;&lt; other._capacity &lt;&lt; \" | \";\n        int i;\n        for (i = 0; i &lt; other._size; i++) {\n            os &lt;&lt; other[i] &lt;&lt; \",\";\n        }\n        return os;\n    }\n\n    T *begin() const {\n        return _data;\n    }\n\n    T *end() const {\n        return _data + _size;\n    }\n\n    int get_size() const {\n        return _size;\n    }\n\n    T* get_data() const {\n        return _data;\n    }\n\n    int get_capacity() const {\n        return _capacity;\n    }\n};\n</code></pre>\n"}, {"tags": ["c++", "c++11", "c++14", "variadic-templates", "constexpr"], "comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 1, "creation_date": 1484757904, "post_id": 41724696, "comment_id": 70644407, "body": "What is the error you are getting and with what compiler?"}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 1, "creation_date": 1484757939, "post_id": 41724696, "comment_id": 70644441, "body": "Compiles on VS2015"}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 2, "creation_date": 1484757994, "post_id": 41724696, "comment_id": 70644482, "body": "<a href=\"http://coliru.stacked-crooked.com/a/604bd7401ede4373\" rel=\"nofollow noreferrer\">Compiles with clang</a>"}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 1, "creation_date": 1484758022, "post_id": 41724696, "comment_id": 70644504, "body": "<a href=\"http://coliru.stacked-crooked.com/a/d27a529a01534076\" rel=\"nofollow noreferrer\">Compiles with gcc</a>"}, {"owner": {"reputation": 3026, "user_id": 3359751, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/91b28e94ea506bc9331a489712096b2c?s=128&d=identicon&r=PG&f=1", "display_name": "wimalopaan", "link": "https://stackoverflow.com/users/3359751/wimalopaan"}, "edited": false, "score": 1, "creation_date": 1484758151, "post_id": 41724696, "comment_id": 70644602, "body": "Sorry for being unclear here: there is no compilation error, but the &quot;container&quot; is empty."}], "answers": [{"comments": [{"owner": {"reputation": 3026, "user_id": 3359751, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/91b28e94ea506bc9331a489712096b2c?s=128&d=identicon&r=PG&f=1", "display_name": "wimalopaan", "link": "https://stackoverflow.com/users/3359751/wimalopaan"}, "edited": false, "score": 0, "creation_date": 1484762114, "post_id": 41725706, "comment_id": 70646973, "body": "Yes, thats indeed impossible, since a constexpr function must also be callable in a non-constexpr context."}, {"owner": {"reputation": 3026, "user_id": 3359751, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/91b28e94ea506bc9331a489712096b2c?s=128&d=identicon&r=PG&f=1", "display_name": "wimalopaan", "link": "https://stackoverflow.com/users/3359751/wimalopaan"}, "edited": false, "score": 0, "creation_date": 1484762233, "post_id": 41725706, "comment_id": 70647022, "body": "I wonder if there could be a solution using std::integral_constant&lt;&gt; as a template template parameter of make_static_container together with a explicit instantiation of make_static_container instead of a parameter list.... But I can&#39;t get it right."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 3, "last_activity_date": 1484763692, "last_edit_date": 1484763692, "creation_date": 1484760172, "answer_id": 41725706, "question_id": 41724696, "link": "https://stackoverflow.com/questions/41724696/create-a-container-like-stdintegral-constant/41725706#41725706", "title": "Create a container like std::integral_constant", "body": "<p>Your problem is that you don't pass the arguments of the function to the list of template arguments for the returned value creation</p>\n\n<pre><code>template&lt;typename T, T... Ts&gt;\nconstexpr auto make_static_container(T... /* !!! unused values !!! */) { // wrong\n    return static_container&lt;T, Ts...&gt;{};\n}\n</code></pre>\n\n<p>So the only deduced template is <code>T</code>; no template not-type values <code>Ts</code> are deduced; so the type returned is</p>\n\n<pre><code>return static_container&lt;T&gt;{};\n</code></pre>\n\n<p>that is with zero values.</p>\n\n<p>You should be able to use the arguments of the function and pass they as template not type paramenters; something like</p>\n\n<pre><code>template&lt;typename T0, typename ... Ts&gt;\nconstexpr auto make_static_container (T0 const t0, Ts const ... ts)\n { return static_container&lt;T0, t0, ts...&gt;{}; }\n</code></pre>\n\n<p>but this is impossible (as far I know) in C++11/C++14 because the <code>t0</code>/<code>ts</code> values aren't <code>constexpr</code> values</p>\n"}, {"comments": [{"owner": {"reputation": 3026, "user_id": 3359751, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/91b28e94ea506bc9331a489712096b2c?s=128&d=identicon&r=PG&f=1", "display_name": "wimalopaan", "link": "https://stackoverflow.com/users/3359751/wimalopaan"}, "edited": false, "score": 0, "creation_date": 1484833203, "post_id": 41734174, "comment_id": 70679144, "body": "Interesting idea with template variables."}, {"owner": {"reputation": 59630, "user_id": 636019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ba39c7ba510ac2951c010c26afb6a6?s=128&d=identicon&r=PG", "display_name": "ildjarn", "link": "https://stackoverflow.com/users/636019/ildjarn"}, "reply_to_user": {"reputation": 3026, "user_id": 3359751, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/91b28e94ea506bc9331a489712096b2c?s=128&d=identicon&r=PG&f=1", "display_name": "wimalopaan", "link": "https://stackoverflow.com/users/3359751/wimalopaan"}, "edited": false, "score": 0, "creation_date": 1484833492, "post_id": 41734174, "comment_id": 70679314, "body": "@wimalopaan : Until recently I had no opinion of or use for them, but using <a href=\"http://www.boost.org/libs/hana/\" rel=\"nofollow noreferrer\">Boost.Hana</a> lately has given me new perspective. :-]"}], "tags": [], "owner": {"reputation": 59630, "user_id": 636019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ba39c7ba510ac2951c010c26afb6a6?s=128&d=identicon&r=PG", "display_name": "ildjarn", "link": "https://stackoverflow.com/users/636019/ildjarn"}, "is_accepted": true, "score": 3, "last_activity_date": 1484829825, "last_edit_date": 1484829825, "creation_date": 1484802484, "answer_id": 41734174, "question_id": 41724696, "link": "https://stackoverflow.com/questions/41724696/create-a-container-like-stdintegral-constant/41734174#41734174", "title": "Create a container like std::integral_constant", "body": "<p>As a followup to your comment regarding <code>std::integral_constant</code>, here's what that would look like:</p>\n\n<pre><code>template&lt;typename T, T... Values&gt;\nconstexpr auto make_static_container(std::integral_constant&lt;T, Values&gt;...) noexcept {\n    return static_container&lt;T, Values...&gt;{};\n}\n</code></pre>\n\n<p>The callsite will have to change since the function is now taking <code>std::integral_constant&lt;T&gt;</code>s rather than <code>T</code>s directly; it is a bit noisier, but variable templates keep it from being <em>too</em> painful:</p>\n\n<pre><code>template&lt;A a&gt;\nusing A_ = std::integral_constant&lt;A, a&gt;;\n\ntemplate&lt;A a&gt;\nconstexpr A_&lt;a&gt; a_{};\n\nint main() {\n    // explicit construction via alias template:\n    constexpr auto sc1 = make_static_container(A_&lt;A::a&gt;{}, A_&lt;A::b&gt;{});\n    // implicit construction via variable template:\n    constexpr auto sc2 = make_static_container(a_&lt;A::a&gt;, a_&lt;A::c&gt;);\n\n    set(sc1);\n    set(sc2);\n}\n</code></pre>\n\n<p><kbd><strong><a href=\"http://coliru.stacked-crooked.com/a/7a0c61b42501ecf0\" rel=\"nofollow noreferrer\">Online Demo</a></strong></kbd></p>\n\n<p>(As an aside, the separate definition of <code>static_container::value</code> in the demo <a href=\"http://melpon.org/wandbox/permlink/f8sQCU5iraZcdJvk\" rel=\"nofollow noreferrer\">becomes unnecessary in C++17</a>.)</p>\n"}], "owner": {"reputation": 3026, "user_id": 3359751, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/91b28e94ea506bc9331a489712096b2c?s=128&d=identicon&r=PG&f=1", "display_name": "wimalopaan", "link": "https://stackoverflow.com/users/3359751/wimalopaan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 41734174, "answer_count": 2, "score": 3, "last_activity_date": 1484829825, "creation_date": 1484757360, "last_edit_date": 1484760804, "question_id": 41724696, "link": "https://stackoverflow.com/questions/41724696/create-a-container-like-stdintegral-constant", "title": "Create a container like std::integral_constant", "body": "<p>I would like to create a \"container-version\" of <code>std::integral_constant</code>. That is a type parametrized with an element-type and non-type parameters:</p>\n\n<pre><code>enum class A {\n    a = 1 &lt;&lt; 0, \n    b = 1 &lt;&lt; 1, \n    c = 1 &lt;&lt; 2\n};\n\ntemplate&lt;typename T, T... Values&gt;\nstruct static_container final {};\n\ntemplate&lt;typename T, T... Ts&gt;\nconstexpr auto make_static_container(T...) { // wrong\n    return static_container&lt;T, Ts...&gt;{};\n}\n\ntemplate&lt;typename F, F... FF&gt;\nvoid inline set(static_container&lt;F, FF...&gt;) {\n    std::cout &lt;&lt; sizeof... (FF) &lt;&lt; std::endl;\n}\n\nint main() {\n    constexpr static_container&lt;A, A::a, A::b&gt; sc1{}; //ok\n    constexpr auto sc2 = make_static_container(A::a, A::c); // not-ok\n\n    set(sc1);    \n    set(sc2);    \n}\n</code></pre>\n\n<p>Above you can see that I can create <code>sc1</code> with explict type.</p>\n\n<p>Now I like to have a helper function to create such a type without specifying the (redundant) enum-type.</p>\n\n<p>The output here is:</p>\n\n<pre><code>2\n0\n</code></pre>\n\n<p>Any hints?</p>\n"}, {"tags": ["c++", "include"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 7, "creation_date": 1484757485, "post_id": 41724684, "comment_id": 70644110, "body": "&quot; I haven&#39;t created a .dll or a .lib so I really don&#39;t know what&#39;s causing this.&quot; Not creating an using a library is what&#39;s causing it."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1484757595, "post_id": 41724684, "comment_id": 70644188, "body": "You might want to create a separate library project for the shared parts, and then use that in your other projects."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1484757767, "post_id": 41724684, "comment_id": 70644308, "body": "I suspect all those &quot;unresolved externals&quot; are in the .cpp implementation files that you never added to your new project. And you would have the <i>identical</i> problem in your original project if you simply removed the .cpp files from there. You <i>can</i> share source files across multiple projects, but doing so is a sign a dll/lib is likely on the menu, rather than replicating compiled translation units all over the place."}, {"owner": {"reputation": 3808, "user_id": 1597714, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/mH9hv.png?s=128&g=1", "display_name": "AMA", "link": "https://stackoverflow.com/users/1597714/ama"}, "edited": false, "score": 0, "creation_date": 1484757931, "post_id": 41724684, "comment_id": 70644434, "body": "You get unres.externals because your project can&#39;t find implementations of the functions defined in headers. You have 3 ways to approach this: 1) make your math a static or dynamic library and link it 2) make your math library header-only (move implementations into headers) 3) add source files of math project to your new project (don&#39;t do this :) )"}, {"owner": {"reputation": 15, "user_id": 4494239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f369059a094531500f33dfe9c42903ca?s=128&d=identicon&r=PG&f=1", "display_name": "Jigo", "link": "https://stackoverflow.com/users/4494239/jigo"}, "edited": false, "score": 0, "creation_date": 1484760789, "post_id": 41724684, "comment_id": 70646277, "body": "Thank you for the response guys! It was as Christian suggested below, I was supposing that the linker is a magical being and that it can know everything I do.   Creating a .lib solved the issue I was having."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4494239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f369059a094531500f33dfe9c42903ca?s=128&d=identicon&r=PG&f=1", "display_name": "Jigo", "link": "https://stackoverflow.com/users/4494239/jigo"}, "edited": false, "score": 0, "creation_date": 1484760720, "post_id": 41725060, "comment_id": 70646236, "body": "Thanks a bunch, Christian! I made a small test and was able to load the functions and use them with the .lib   I thought it was going to be like including GLM where you don&#39;t need dll or static lib but it`s probably a different case there :)  Again, thank you very much!"}], "tags": [], "owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "is_accepted": true, "score": 3, "last_activity_date": 1518536031, "last_edit_date": 1518536031, "creation_date": 1484758328, "answer_id": 41725060, "question_id": 41724684, "link": "https://stackoverflow.com/questions/41724684/how-to-reuse-c-classes-from-one-project-to-another-without-copying/41725060#41725060", "title": "How to reuse C++ classes from one project to another without copying", "body": "<blockquote>\n  <p>When I try to #include them it works and I can see my classes but\n  upon trying to use them I get \"Unresolved external\". I haven't created\n  a .dll or a .lib so I really don't know what's causing this.</p>\n</blockquote>\n\n<p>That you have not created a library is precisely the <em>reason</em> why you get the error. The compilation units in your new project (<em>\"the <code>*.cpp</code> files\"</em>) include the headers for your classes and make use of the class definitions, but the definitions of the members are missing.</p>\n\n<p>For example, let's say you have a file called <code>\"c.h\"</code> in your old project:</p>\n\n<pre><code>#ifndef C_H\n#define C_H\n\nclass C\n{\npublic:\n    C();\n    void f();\n};\n\n#endif\n</code></pre>\n\n<p>Some <code>*.cpp</code> file in your new project includes the header and uses the class:</p>\n\n<pre><code>#include \"somepath/oldproject/c.h\"\n\nvoid someFunction()\n{\n    C c;\n    c.f();\n}\n</code></pre>\n\n<p>This compiles fine, but it will cause linker errors, because the <strong>definitions of <code>C::C</code> and <code>C::f</code></strong> will be missing.</p>\n\n<p>Now, the clean solution to this is certainly <em>not</em> adding <code>somepath/oldproject/c.cpp</code> from your old project to your new project, although that would fix the linker error, but to employ a library-based approach. Turn your math classes into a library project, let's call it \"Math Utils\", which produces a <code>*.lib</code> file (as you seem to be on Windows), for example <code>math-utils.lib</code>. Add the library's include and release path to your global include and library paths. Then add the <code>math-utils.lib</code> file to the new project's linker dependencies.</p>\n\n<p>And change the code in your new project to:</p>\n\n<pre><code>#include &lt;math-utils/c.h&gt;\n\nvoid someFunction()\n{\n    C c;\n    c.f();\n}\n</code></pre>\n\n<p>Do the same thing in the old project! You will end up with three different projects. Two application projects and one library project, the former two depending on the latter.</p>\n\n<p>Creating your own libraries for the first time can be a bit intimidating, but the benefits are worth the trouble.</p>\n\n<hr>\n\n<p>See also <a href=\"http://programmer.97things.oreilly.com/wiki/index.php/The_Linker_Is_not_a_Magical_Program\" rel=\"nofollow noreferrer\">The Linker Is not a Magical Program</a>.</p>\n"}], "owner": {"reputation": 15, "user_id": 4494239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f369059a094531500f33dfe9c42903ca?s=128&d=identicon&r=PG&f=1", "display_name": "Jigo", "link": "https://stackoverflow.com/users/4494239/jigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1384, "favorite_count": 0, "accepted_answer_id": 41725060, "answer_count": 1, "score": 1, "last_activity_date": 1518536031, "creation_date": 1484757317, "question_id": 41724684, "link": "https://stackoverflow.com/questions/41724684/how-to-reuse-c-classes-from-one-project-to-another-without-copying", "title": "How to reuse C++ classes from one project to another without copying", "body": "<p>I am facing the following problem:</p>\n\n<p>I have a project which contains math classes (.h and .cpp files).\nI want to use these classes in a different project (not int he same solution) but I can't. </p>\n\n<p>In the new project I add a path to the include files of my math project. When I try to #include them it works and I can see my classes but upon trying to use them I get \"Unresolved external\". I haven't created a .dll or a .lib so I really don't know what's causing this.</p>\n\n<p>If you have any suggestions, I`ll appreciate it. </p>\n\n<p>Thank you very much in advance.</p>\n"}, {"tags": ["c++", "list", "sorting", "templates"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484756971, "post_id": 41724506, "comment_id": 70643770, "body": "You can do it like how <a href=\"http://en.cppreference.com/w/cpp/container/list/sort\" rel=\"nofollow noreferrer\"><code>std::list::sort</code></a> does it."}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1484756992, "post_id": 41724506, "comment_id": 70643781, "body": "Just use standard C++ containers. And Stack Overflow is not a &quot;forum&quot;."}, {"owner": {"reputation": 369, "user_id": 7421554, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e9de7e749bb8bc74f2f3c9dcb021d22b?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7421554/michael"}, "reply_to_user": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1484757074, "post_id": 41724506, "comment_id": 70643842, "body": "@ChristianHackl So, It&#39;s not possible to do this? I want to have own implementations."}, {"owner": {"reputation": 369, "user_id": 7421554, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e9de7e749bb8bc74f2f3c9dcb021d22b?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7421554/michael"}, "edited": false, "score": 0, "creation_date": 1484757223, "post_id": 41724506, "comment_id": 70643932, "body": "I know I can possible do it in one method and next recognize type of list, but I ask about two methods."}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484757246, "post_id": 41724506, "comment_id": 70643947, "body": "@Michael: Of course it&#39;s possible. See @NathanOliver&#39;s comment. Do it like <code>std::list</code> does and allow users to provide a functor which defaults to <code>std::less</code>. But it&#39;s a completely uninteresting thing to do, because it reinvents the wheel and will be a solution inferior to <code>std::list</code>, with not much to do about other than throwing it away and using <code>std::list</code> instead."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1484764243, "post_id": 41724506, "comment_id": 70648206, "body": "There is another issue to deal with since C++ 11, not having a default allocator. Visual Studio 2015 changed std::list::sort from a bottom up merge sort using a small (25) array of lists to a slower top down merge sort that only uses the iterators. You can read more about this <a href=\"http://stackoverflow.com/questions/40622430/stdlistsort-why-the-sudden-switch-to-top-down-strategy\">here</a>. Note that it is faster to copy a linked list to a vector, sort the vector and copy back, than it is to use std::list::sort."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484757457, "post_id": 41724700, "comment_id": 70644088, "body": "I would default <code>compare</code> to <code>std::less&lt;type&gt;</code> just so you do not always have to provide a functor."}, {"owner": {"reputation": 369, "user_id": 7421554, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e9de7e749bb8bc74f2f3c9dcb021d22b?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7421554/michael"}, "edited": false, "score": 0, "creation_date": 1484757528, "post_id": 41724700, "comment_id": 70644139, "body": "Your code looks pretty clear and proffesional, what do you think about this? <a href=\"http://pastebin.com/6rSJfF4Z\" rel=\"nofollow noreferrer\">pastebin.com/6rSJfF4Z</a>  I know that this code is bad."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 369, "user_id": 7421554, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e9de7e749bb8bc74f2f3c9dcb021d22b?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7421554/michael"}, "edited": false, "score": 0, "creation_date": 1484757962, "post_id": 41724700, "comment_id": 70644458, "body": "@Michael That approach will not work in practice . It will only work as long as your supported types have compatible interfaces. That means will only be able to do things to your <code>type</code> that works for <code>int</code>, <code>std::string</code> and <i>all</i> other types you choose to support. Remember that even if only one of your branches is taken, they all have to compile for all <code>type</code> you support. For example, you couldn&#39;t access the characters in the case of <code>string</code> because when you tried to instantiate with <code>int</code> it would fail to find an <code>operator[]</code> for the type <code>int</code>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 369, "user_id": 7421554, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e9de7e749bb8bc74f2f3c9dcb021d22b?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7421554/michael"}, "edited": false, "score": 0, "creation_date": 1484758282, "post_id": 41724700, "comment_id": 70644696, "body": "@Michael I&#39;ve modified your example to demonstrate why it can&#39;t work. <a href=\"http://pastebin.com/4zSmXDws\" rel=\"nofollow noreferrer\">pastebin</a>"}, {"owner": {"reputation": 369, "user_id": 7421554, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e9de7e749bb8bc74f2f3c9dcb021d22b?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7421554/michael"}, "edited": false, "score": 0, "creation_date": 1484758373, "post_id": 41724700, "comment_id": 70644780, "body": "@Fran&#231;oisAndrieux Ok, thanks! Can you tell me what I must do in Sort() method with that lambda to sort int&#39;s? If I have that lambda as parameter: <a href=\"http://pastebin.com/DAVjCqWP\" rel=\"nofollow noreferrer\">pastebin.com/DAVjCqWP</a> And I don&#39;t know how to use it in Sort()."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 369, "user_id": 7421554, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e9de7e749bb8bc74f2f3c9dcb021d22b?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7421554/michael"}, "edited": false, "score": 0, "creation_date": 1484758563, "post_id": 41724700, "comment_id": 70644912, "body": "@Michael Whichever sort algorithm you are using, it will at one point compare elements. Wherever it would compare two elements (like <code>x &lt; y</code>) change it to use the lamdba (like this <code>comparer(x, y)</code>)."}], "tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": true, "score": 1, "last_activity_date": 1484757466, "last_edit_date": 1484757466, "creation_date": 1484757386, "answer_id": 41724700, "question_id": 41724506, "link": "https://stackoverflow.com/questions/41724506/different-sort-methods-with-template-collection/41724700#41724700", "title": "Different sort methods with template collection", "body": "<p>The way the standard library generally deals with this problem is to allow users to specify their own compare functions. You can add a templated parameter that users of your type can use to provide a Compare function, like <a href=\"http://en.cppreference.com/w/cpp/algorithm/sort\" rel=\"nofollow noreferrer\">std::sort</a> does. In the implementation of sort, you assume that <code>comparer</code> is a function that compares two elements of the list and returns rather or not the first should be before the second.</p>\n\n<pre><code>#include &lt;string&gt;\ntemplate&lt;typename type&gt;\nclass DoublyLinkedList\n{\npublic:\n    template&lt;class Comp&gt;\n    void Sort(Comp comparer);\n\n};\n\nvoid foo(DoublyLinkedList&lt;std::string&gt; &amp; list)\n{\n    // Sort list by length of strings\n    list.Sort([](const std::string p_left, const std::string p_right){\n        return p_left.size() &lt; p_right.size();\n    });\n}\n</code></pre>\n"}], "owner": {"reputation": 369, "user_id": 7421554, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e9de7e749bb8bc74f2f3c9dcb021d22b?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7421554/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 41724700, "answer_count": 1, "score": 0, "last_activity_date": 1484757466, "creation_date": 1484756790, "question_id": 41724506, "link": "https://stackoverflow.com/questions/41724506/different-sort-methods-with-template-collection", "title": "Different sort methods with template collection", "body": "<p>I sorry if similar question already exists on this forum, if you could, give me the link.</p>\n\n<p>I have a template class </p>\n\n<pre><code>template&lt;typename type&gt;\nclass DoublyLinkedList {};\n</code></pre>\n\n<p>And I want to have Sort method in it.</p>\n\n<pre><code>template&lt;typename type&gt;\nclass DoublyLinkedList\n{\npublic:\n\nvoid Sort(){}\n\n};\n</code></pre>\n\n<p>But list is template so it can contains different types. So how I can create methods for all types that I foresee? I tried in this way:</p>\n\n<pre><code>template&lt;typename type&gt;\nclass DoublyLinkedList\n{\npublic:\n\nvoid DoublyLinkedList&lt;int&gt;::Sort(){}\nvoid DoublyLinkedList&lt;string&gt;::Sort(){} \n\n};\n</code></pre>\n\n<p>But it's wrong. Please help.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 3, "creation_date": 1484756805, "post_id": 41724439, "comment_id": 70643651, "body": "Use <a href=\"http://en.cppreference.com/w/cpp/algorithm/lower_bound\" rel=\"nofollow noreferrer\">std::lower_bound</a> with a custom comparison functor?"}], "answers": [{"tags": [], "owner": {"reputation": 3617, "user_id": 2279977, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/892def4356c5da2ac443e7a8d5787081?s=128&d=identicon&r=PG&f=1", "display_name": "MRB", "link": "https://stackoverflow.com/users/2279977/mrb"}, "is_accepted": true, "score": 2, "last_activity_date": 1484758954, "last_edit_date": 1484758954, "creation_date": 1484758070, "answer_id": 41724967, "question_id": 41724439, "link": "https://stackoverflow.com/questions/41724439/binary-search-on-vector-objects-of-an-element-greater-than-an-attribute/41724967#41724967", "title": "Binary search on vector objects of an element greater than an attribute", "body": "<p>For <code>std::binary_search</code> to succeed, the range need to be sorted.<code>std::binary_search</code>, <code>std::lower_bound</code> works on sorted containers. So every time you add a new element into your <code>vector</code> you need to keep it sorted.</p>\n\n<p>For this purpose you can use <code>std::lower_bound</code> in your insertion:</p>\n\n<pre><code>class X;\nclass XCompare\n{\npublic:\n    bool operator()(const X&amp; first, const X&amp; second) const\n    {\n        // your sorting logic\n    }\n};\n\nX value(...);\nauto where = std::lower_bound(std::begin(vector), std::end(vector), value, XCompare());\nvector.insert(where, value);\n</code></pre>\n\n<p>And again you can use <code>std::lower_bound</code> to search in your vector:</p>\n\n<pre><code>auto where = std::lower_bound(std::begin(vector), std::end(vector), searching_value, XCompare());\n</code></pre>\n\n<p>Don't forget to check if <code>std::lower_bound</code> was successful:</p>\n\n<pre><code>bool successed = where != std::end(vector) &amp;&amp; !(XCompare()(value, *where));\n</code></pre>\n\n<p>Or directly use <code>std::binary_search</code> if you only want to know that element is in vector.</p>\n"}, {"tags": [], "owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "is_accepted": false, "score": 3, "last_activity_date": 1484758899, "creation_date": 1484758899, "answer_id": 41725268, "question_id": 41724439, "link": "https://stackoverflow.com/questions/41724439/binary-search-on-vector-objects-of-an-element-greater-than-an-attribute/41725268#41725268", "title": "Binary search on vector objects of an element greater than an attribute", "body": "<p>A binary search can only be done if the vector is in sorted order <strong><em>according to the binary search's predicate</em></strong>, by definition.</p>\n\n<p>So, unless all elements in your vector for which \"<em>S.attribute1 > someVariable</em>\" are located after all elements that are not, this is going to be a non-starter, right out of the gate.</p>\n\n<p>If all elements in your vector are sorted in some other way, that \"some other way\" is the only binary search that can be implemented.</p>\n\n<p>Assuming that they are, you must be using a comparator, of some sort, that specifies strict weak ordering on the attribute, in order to come up with your sorted vector in the first place:</p>\n\n<pre><code>class comparator {\n\npublic:\n    bool operator()(const your_class &amp;a, const your_class &amp;b) const\n    {\n          return a.attribute1 &lt; b.attribute1;\n    }\n};\n</code></pre>\n\n<p>The trick is that if you want to search using the attribute value alone, you need to use a comparator that can be used with <code>std::binary_search</code> which is <a href=\"http://en.cppreference.com/w/cpp/algorithm/binary_search\" rel=\"nofollow noreferrer\">defined as follows</a>:</p>\n\n<blockquote>\n<pre><code>template&lt; class ForwardIt, class T, class Compare &gt;\nbool binary_search( ForwardIt first, ForwardIt last,\n                    const T&amp; value, Compare comp );\n</code></pre>\n  \n  <p>For std::binary_search to succeed, the range [first, last) must be\n  at least partially ordered, i.e. it must satisfy all of the following\n  requirements: </p>\n  \n  <p>for all elements, if element &lt; value or comp(element, value) is true\n  then !(value &lt; element) or !comp(value, element) is also true</p>\n</blockquote>\n\n<p>So, the only requirement is that <code>comp(value, element)</code> and <code>comp(element, value)</code> needs to work. You can pass the attribute value for <code>T</code>, rather than the entire element in the vector to search for, as long as your comparator can deal with it:</p>\n\n<pre><code>class search_comparator {\n\npublic:\n    bool operator()(const your_class &amp;a, const attribute_type &amp;b) const\n    {\n          return a.attribute1 &lt; b;\n    }\n\n    bool operator()(const attribute_type &amp;a, const your_class &amp;b) const\n    {\n          return a &lt; b.attribute1;\n    }\n};\n</code></pre>\n\n<p>Now, you should be able to use <code>search_comparator</code> instead of <code>comparator</code>, and do a binary search by the attribute value.</p>\n\n<p>And, all bets are off, as I said, if the vector is not sorted by the given attribute. In that case, you'll need to use <code>std::sort</code> it explicitly, first, or come up with some custom container that keeps track of the vector elements, in the right order, separately and in addition to the main vector that holds them. Using pointers, perhaps, in which case you should be able to execute a binary search on the pointers themselves, using a similar search comparator, that looks at the pointers, instead.</p>\n"}], "owner": {"reputation": 2324, "user_id": 1636300, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/j1CeQ.jpg?s=128&g=1", "display_name": "MAG", "link": "https://stackoverflow.com/users/1636300/mag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1057, "favorite_count": 0, "accepted_answer_id": 41724967, "answer_count": 2, "score": 1, "last_activity_date": 1484758954, "creation_date": 1484756641, "question_id": 41724439, "link": "https://stackoverflow.com/questions/41724439/binary-search-on-vector-objects-of-an-element-greater-than-an-attribute", "title": "Binary search on vector objects of an element greater than an attribute", "body": "<p>I have a vector which contains lot of elements of my class X . \nI need to find the first occurrence of an element in this vector say S such that S.attrribute1 > someVariable. someVariable will not be fixed    . How can I do binary_search for this ? (NOT c++11/c++14) . I can write std::binary_search with search function of greater  (which ideally means check of equality) but that would be wrong ? Whats the right strategy for fast searching ?</p>\n"}, {"tags": ["c++", "c++14", "language-lawyer", "return-type", "auto"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1484756854, "post_id": 41724428, "comment_id": 70643681, "body": "Ouch, that&#39;s nasty. This does look like a loophole, and probably triggers undefined behaviour..."}, {"owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 1, "creation_date": 1484757821, "post_id": 41724428, "comment_id": 70644342, "body": "Hmm. &quot;Local class declarations&quot; only talks about the name not being visible outside. That does not necessarily mean that the type can&#39;t be used outside as I see it. I am not quite sure how you would make use of such a function pre-C++11 as you couldn&#39;t even declare it with <code>local</code> being local.   But maybe I am just missing the point here."}, {"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 1, "creation_date": 1484758715, "post_id": 41724428, "comment_id": 70645016, "body": "&#167;9.8 only says that the <i>name</i> is local. It is not a new thing that you can use an entity without spelling out its name."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1484759069, "post_id": 41724428, "comment_id": 70645247, "body": "Yes, this is UB, and definitely in Machiavelli territory. [class.cdtor]/1, [basic.life]/6-7."}, {"owner": {"reputation": 20507, "user_id": 1463922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3878980c7836d9e36f3a9ac100ff36a8?s=128&d=identicon&r=PG", "display_name": "PiotrNycz", "link": "https://stackoverflow.com/users/1463922/piotrnycz"}, "reply_to_user": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 0, "creation_date": 1484759746, "post_id": 41724428, "comment_id": 70645671, "body": "@SimonKraemer using local type not in the block of its definition is not my main concern. I am worrying that in this way I can access local static variables before they are constructed"}, {"owner": {"reputation": 20507, "user_id": 1463922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3878980c7836d9e36f3a9ac100ff36a8?s=128&d=identicon&r=PG", "display_name": "PiotrNycz", "link": "https://stackoverflow.com/users/1463922/piotrnycz"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1484760189, "post_id": 41724428, "comment_id": 70645946, "body": "@T.C. So, are there explicit rules about not using object before it is c-cted? Or this is some kind of &quot;obvious&quot; implicit rule? I can accept answer with citation from standard that disallows what I did in my question."}, {"owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 0, "creation_date": 1484761679, "post_id": 41724428, "comment_id": 70646752, "body": "@PiotrNycz But that would happen the same (or even easier) if the type wasn&#39;t local. I have to correct my previous comment: Pre-C++14 you couldn&#39;t even use such a type as return type. So the standard doesn&#39;t break any behaviour here. For me you are simply not initializing a static variable (apart from the auto-initialization of static variables). The only problem with your code is that you don&#39;t call <code>f()</code>."}, {"owner": {"reputation": 20507, "user_id": 1463922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3878980c7836d9e36f3a9ac100ff36a8?s=128&d=identicon&r=PG", "display_name": "PiotrNycz", "link": "https://stackoverflow.com/users/1463922/piotrnycz"}, "reply_to_user": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 0, "creation_date": 1484766709, "post_id": 41724428, "comment_id": 70649504, "body": "@SimonKraemer But I assume it is valid to construct this object <code>decltype(f()) l;</code> in main, even if never, ever call <code>f()</code>? The only invalid &quot;move&quot; in my example is calling <code>local::h()</code> in <code>main()</code>, because w/o calling  <code>f()</code>- the access to <code>f()::s</code> is invalid? At least, I interpreted the Columbo&#39;s answer in that way."}], "answers": [{"comments": [{"owner": {"reputation": 20507, "user_id": 1463922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3878980c7836d9e36f3a9ac100ff36a8?s=128&d=identicon&r=PG", "display_name": "PiotrNycz", "link": "https://stackoverflow.com/users/1463922/piotrnycz"}, "edited": false, "score": 0, "creation_date": 1484766392, "post_id": 41725812, "comment_id": 70649332, "body": "I assume that you mean access to <code>f()::s.value</code>is wrong in my question, I believe calling <code>main():l.h()</code> would be valid if the implementation of this function would not touch <code>f()::s</code>?"}], "tags": [], "owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "is_accepted": true, "score": 8, "last_activity_date": 1484760585, "creation_date": 1484760585, "answer_id": 41725812, "question_id": 41724428, "link": "https://stackoverflow.com/questions/41724428/are-local-class-rules-aligned-to-c14-return-type-deduction/41725812#41725812", "title": "Are local class rules aligned to c++14 return type deduction?", "body": "<p>The rule for static local variables is <a href=\"http://eel.is/c++draft/stmt.dcl#4\">plain and simple</a>:</p>\n\n<blockquote>\n  <p>Dynamic initialization of a block-scope variable with static storage\n  duration (3.7.1) or thread storage duration (3.7.2) is performed the\n  first time control passes through its declaration; such a variable is\n  considered initialized upon the completion of its initialization.</p>\n</blockquote>\n\n<p>And accessing an object's members before its construction is disallowed by <a href=\"http://eel.is/c++draft/basic.life#7\">[basic.life]/(7.1)</a>.</p>\n"}], "owner": {"reputation": 20507, "user_id": 1463922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3878980c7836d9e36f3a9ac100ff36a8?s=128&d=identicon&r=PG", "display_name": "PiotrNycz", "link": "https://stackoverflow.com/users/1463922/piotrnycz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "accepted_answer_id": 41725812, "answer_count": 1, "score": 7, "last_activity_date": 1484760585, "creation_date": 1484756622, "question_id": 41724428, "link": "https://stackoverflow.com/questions/41724428/are-local-class-rules-aligned-to-c14-return-type-deduction", "title": "Are local class rules aligned to c++14 return type deduction?", "body": "<p>While reading this part of C++14 (<a href=\"https://github.com/cplusplus/draft/blob/master/papers/n4140.pdf\">a free draft N4141, closest to C++14</a>):</p>\n\n<blockquote>\n  <p>9.8 Local class declarations [class.local] </p>\n  \n  <p>[..]\n  The name of a local class is local to its enclosing scope. [..]</p>\n  \n  <p>Declarations in a local class shall not odr-use (3.2) a variable with\n  automatic storage duration from an enclosing scope. [ Example: </p>\n\n<pre><code>//[..]\nvoid f() \n{ \n    static int s ; \n    int x; \n    // [..]\n    struct local { \n       int g() { return x; } // error: odr-use of automatic variable x \n       int h() { return s; } // OK \n       // [..]\n   };\n}\nlocal* p = 0; // error: local not in scope\n</code></pre>\n  \n  <p>\u2014end example ]</p>\n</blockquote>\n\n<p>I noticed, that, first - I can define <code>p</code> with return value auto deduction:</p>\n\n<pre><code>auto f()\n{\n  static int s;\n  int x;\n  struct local\n  {\n     int h() { return s; }\n  };\n  return local{};\n}\ndecltype(f())* p = 0; // OK - ignored, that local is not in scope!\n</code></pre>\n\n<p>Maybe it seems ok, why not to use local type by deducing it from function return value, but - it seems in this way I can access local <code>s</code> variable before it is constructed:</p>\n\n<pre><code>struct TalkativeInt\n{\n    TalkativeInt() : value() \n    {\n        std::cout &lt;&lt; \"TalkativeInt()\\n\";\n    }\n    TalkativeInt(int value) : value(value) \n    {\n        std::cout &lt;&lt; \"TalkativeInt(\" &lt;&lt; value &lt;&lt; \")\\n\";\n    }\n\n    int value;\n};\n\nauto f()\n{\n  static TalkativeInt s = 7;\n  int x;\n  struct local\n  {\n     auto h() { return s.value; }\n  };\n  return local{};\n}\ndecltype(f())* p = 0;\n\nint main() {\n    decltype(f()) l;\n    std::cout &lt;&lt; l.h();\n}\n</code></pre>\n\n<p>Output is just::</p>\n\n<pre><code>0\n</code></pre>\n\n<p>But one might expect:</p>\n\n<pre><code>TalkativeInt(7)\n7\n</code></pre>\n\n<p>Both clang and gcc do not protest in any way, see <a href=\"http://melpon.org/wandbox/permlink/dP15ThN3TLZSVPiN\">demo</a>.</p>\n\n<p>I wonder, maybe such case should be mentioned somehow either in  </p>\n\n<blockquote>\n  <p>9.8 Local class declarations [class.local]</p>\n</blockquote>\n\n<p>or in</p>\n\n<blockquote>\n  <p>7.1.6.4 auto specifier [dcl.spec.auto]</p>\n</blockquote>\n\n<p>?</p>\n\n<p>Of course, I feel that reading (and writing) from variable before it is constructed is <strong>bad thing</strong>, but I have not found anything about that in standard - probably, it was not possible before C++14? Or there are some basic rules I just overlooked?</p>\n"}, {"tags": ["c++", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 5, "creation_date": 1484756423, "post_id": 41724326, "comment_id": 70643370, "body": "Welcome to Stack Overflow! Sounds like you could use a <a href=\"http://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">good C++ book</a>"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1484756500, "post_id": 41724326, "comment_id": 70643420, "body": "And.. What you are confused about?"}, {"owner": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 1, "creation_date": 1484756517, "post_id": 41724326, "comment_id": 70643433, "body": "The <i>reason</i> we say you could use one, is because this is a set of problems that really are best answered with a book, since the authors have the time and space to give you an explanation of things like initialization, object lifetime, and management of memory and other resources."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 1, "creation_date": 1484756578, "post_id": 41724326, "comment_id": 70643471, "body": "Also missing: <code>delete[] s</code>."}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484770206, "post_id": 41724436, "comment_id": 70651525, "body": "Actually that should be error, not warning if compiler would be used properly."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484776068, "post_id": 41724436, "comment_id": 70654575, "body": "@Slava: The standard merely describes it as a &quot;diagnostic&quot;."}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": true, "score": 2, "last_activity_date": 1484756635, "creation_date": 1484756635, "answer_id": 41724436, "question_id": 41724326, "link": "https://stackoverflow.com/questions/41724326/confusion-with-ints-new-inti-and-intf-new-int/41724436#41724436", "title": "Confusion with &#39; int*s = new int[i]; &#39; and &#39; int*f = new int; &#39;", "body": "<p>The reason that you get a warning is because <code>s[t]</code> is shorthand for <code>*(s+t)</code>, so <code>*s[t]</code> is shorthand for <code>**(s+t)</code>. That's one too many <code>*</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 8289, "user_id": 391806, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/88a2ea78dadbdaf73e1033fe7cbdeb73?s=128&d=identicon&r=PG", "display_name": "Dale Wilson", "link": "https://stackoverflow.com/users/391806/dale-wilson"}, "is_accepted": false, "score": 0, "last_activity_date": 1484756650, "creation_date": 1484756650, "answer_id": 41724443, "question_id": 41724326, "link": "https://stackoverflow.com/questions/41724326/confusion-with-ints-new-inti-and-intf-new-int/41724443#41724443", "title": "Confusion with &#39; int*s = new int[i]; &#39; and &#39; int*f = new int; &#39;", "body": "<p>The [] operator includes an implicit '*'.   Assign your value to s[t] rather than *s[t]</p>\n"}], "owner": {"reputation": 3, "user_id": 7436328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KyVYT_PkleY/AAAAAAAAAAI/AAAAAAAAAZw/WUmw8GQRpDA/photo.jpg?sz=128", "display_name": "DD_IaZ", "link": "https://stackoverflow.com/users/7436328/dd-iaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 41724436, "answer_count": 2, "score": -2, "last_activity_date": 1484785443, "creation_date": 1484756366, "last_edit_date": 1484770133, "question_id": 41724326, "link": "https://stackoverflow.com/questions/41724326/confusion-with-ints-new-inti-and-intf-new-int", "title": "Confusion with &#39; int*s = new int[i]; &#39; and &#39; int*f = new int; &#39;", "body": "<pre><code>int t, i;\ncin &gt;&gt; i;\n\nint*s = new int[i];\n\nfor (t = 0; t &lt; i; t++) {\n    s[t] = t;//How??\n    cout &lt;&lt; s[t] &lt;&lt; \"_\" &lt;&lt; &amp;s[t] &lt;&lt; endl;\n}\n\nint*f = new int;\n*f = t; // Whhhhhy???\ndelete f;\ndelete[] s\n</code></pre>\n\n<p>I declared an array type and an integer as dynamic memory.</p>\n\n<p>While I can assign any ordinary integer value to *f (and pointer value for f),\nit keeps warning me when assigning an integer value to *s[t].</p>\n\n<p>I have no idea as to why.</p>\n"}, {"tags": ["c++", "cin", "istream"], "comments": [{"owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 1, "creation_date": 1484756365, "post_id": 41724287, "comment_id": 70643328, "body": "<a href=\"http://de.cppreference.com/w/cpp/io/ios_base/openmode\" rel=\"nofollow noreferrer\">de.cppreference.com/w/cpp/io/ios_base/openmode</a>"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1484756369, "post_id": 41724287, "comment_id": 70643332, "body": "Did you try <a href=\"http://en.cppreference.com/w/cpp/io/ios_base/openmode\" rel=\"nofollow noreferrer\">looking at the documentation</a>?"}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1484756560, "post_id": 41724287, "comment_id": 70643460, "body": "IntelliSense is not documentation."}, {"owner": {"reputation": 41806, "user_id": 1870232, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rbI29.jpg?s=128&g=1", "display_name": "P0W", "link": "https://stackoverflow.com/users/1870232/p0w"}, "edited": false, "score": 0, "creation_date": 1484756570, "post_id": 41724287, "comment_id": 70643467, "body": "you could have saved some typing if you simply searched those on web"}, {"owner": {"reputation": 187, "user_id": 2429481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XcSLs.jpg?s=128&g=1", "display_name": "peedurrr", "link": "https://stackoverflow.com/users/2429481/peedurrr"}, "edited": false, "score": 0, "creation_date": 1484757439, "post_id": 41724287, "comment_id": 70644068, "body": "Of course I did try looking on the web. &quot;cin.binary&quot; doesn&#39;t give any result that actually include that exact string."}], "answers": [{"tags": [], "owner": {"reputation": 2581, "user_id": 1242646, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2b686cb8d225bf0023e20013bbd3a987?s=128&d=identicon&r=PG", "display_name": "roalz", "link": "https://stackoverflow.com/users/1242646/roalz"}, "is_accepted": false, "score": 0, "last_activity_date": 1484756603, "last_edit_date": 1495540465, "creation_date": 1484756603, "answer_id": 41724421, "question_id": 41724287, "link": "https://stackoverflow.com/questions/41724287/unknown-cin-properties/41724421#41724421", "title": "Unknown cin properties", "body": "<p>Reference: <a href=\"http://en.cppreference.com/w/cpp/io/ios_base/openmode\" rel=\"nofollow noreferrer\">std::ios_base::openmode</a>  </p>\n\n<p>binary is used to open a istream in binary mode (as opposed to text mode).</p>\n\n<p>std::cin is not open in binary mode, please read the answers <a href=\"https://stackoverflow.com/questions/7587595/read-binary-data-from-stdcin\">here</a> for more details.</p>\n"}, {"tags": [], "owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "is_accepted": true, "score": 1, "last_activity_date": 1484756682, "creation_date": 1484756682, "answer_id": 41724463, "question_id": 41724287, "link": "https://stackoverflow.com/questions/41724287/unknown-cin-properties/41724463#41724463", "title": "Unknown cin properties", "body": "<p><code>binary</code> is a flag to tell the stream to be opened in binary mode (instead of textual mode).</p>\n\n<p>You can find documentation on these flags here: <a href=\"http://en.cppreference.com/w/cpp/io/ios_base/openmode\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/io/ios_base/openmode</a></p>\n\n<p>You might also search on this site for other flags and functions of <code>std::basic_istream</code>(e.g. <code>std::cin</code>):\n<a href=\"http://en.cppreference.com/w/cpp/io/basic_istream\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/io/basic_istream</a></p>\n"}], "owner": {"reputation": 187, "user_id": 2429481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XcSLs.jpg?s=128&g=1", "display_name": "peedurrr", "link": "https://stackoverflow.com/users/2429481/peedurrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "closed_date": 1484756687, "accepted_answer_id": 41724463, "answer_count": 2, "score": -3, "last_activity_date": 1484756682, "creation_date": 1484756259, "question_id": 41724287, "link": "https://stackoverflow.com/questions/41724287/unknown-cin-properties", "closed_reason": "Duplicate", "title": "Unknown cin properties", "body": "<p>Try as I might, I cannot find any information on what <code>cin.binary</code> is for.  </p>\n\n<p>similar ones, thinking bases, dec, hex, octal only seem to appear when used with cout - e.g.,</p>\n\n<p><code>cout &lt;&lt; std::hex &lt;&lt; n;</code>.</p>\n\n<p>However <code>cout &lt;&lt; std::binary &lt;&lt; n;</code> isn't valid</p>\n\n<p>Entering <code>cin.</code> produces this intellisense popup</p>\n\n<p><a href=\"https://i.stack.imgur.com/kURtK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kURtK.png\" alt=\"intellisense popup for &lt;code&gt;cin.&lt;/code&gt;\"></a></p>\n\n<p>I'm left assuming that these are some sort of flags. Sure would be nice to know for sure though.</p>\n"}, {"tags": ["c++", "templates", "template-meta-programming", "sfinae"], "answers": [{"comments": [{"owner": {"reputation": 4369, "user_id": 3102935, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/22985d9fffff3b76a11b1f2bccbf2f42?s=128&d=identicon&r=PG&f=1", "display_name": "WorldSEnder", "link": "https://stackoverflow.com/users/3102935/worldsender"}, "edited": false, "score": 0, "creation_date": 1484756533, "post_id": 41724270, "comment_id": 70643446, "body": "I think op is more interested in how the condition would look rather than std::conditional"}, {"owner": {"reputation": 1343, "user_id": 4480394, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-QwHzVkP4n0Y/AAAAAAAAAAI/AAAAAAAAAGo/xwQ_WdtwEjQ/photo.jpg?sz=128", "display_name": "Mona the Monad", "link": "https://stackoverflow.com/users/4480394/mona-the-monad"}, "edited": false, "score": 0, "creation_date": 1484757994, "post_id": 41724270, "comment_id": 70644483, "body": "The implementation of <code>std::conditional</code> seems easy to understand, but how does <code>is_detected</code> work? Also, though I&#39;m a fan of the new C++17 features, <code>pointer_traits</code> was implemented in C++11. Without using [experimental] C++17 features, how would one implement this?"}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "reply_to_user": {"reputation": 1343, "user_id": 4480394, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-QwHzVkP4n0Y/AAAAAAAAAAI/AAAAAAAAAGo/xwQ_WdtwEjQ/photo.jpg?sz=128", "display_name": "Mona the Monad", "link": "https://stackoverflow.com/users/4480394/mona-the-monad"}, "edited": false, "score": 0, "creation_date": 1484758117, "post_id": 41724270, "comment_id": 70644571, "body": "@AliciaRose <i>Without using [experimental] C++17 features, how would one implement this?</i> Ugly and painfully. You can look up the source code for your standard library online."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1484770769, "post_id": 41724270, "comment_id": 70651813, "body": "&quot;<code>std::is_detected</code> is present in C++17&quot; Nope. &quot;<code>using difference_type = conditional_t&lt;is_detected&lt;detail::ptrait_diff, Ptr&gt;::value, typename Ptr::difference_type, ptrdiff_t&gt;;</code>&quot; Double nope. You can&#39;t attempt to access <code>typename Ptr::difference_type</code> until you know that it exists. And if you are trying to use the detection idiom, this is the textbook use case for <code>detected_or</code>, not <code>is_detected</code>."}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1484771914, "post_id": 41724270, "comment_id": 70652364, "body": "@T.C. Right. Thanks for noticing. I didn&#39;t test-run any of this. For some reason I was of the belief that std::is_detected had made it into the standard. You get disappointed every day..."}], "tags": [], "owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "is_accepted": true, "score": 6, "last_activity_date": 1484771924, "last_edit_date": 1484771924, "creation_date": 1484756241, "answer_id": 41724270, "question_id": 41724111, "link": "https://stackoverflow.com/questions/41724111/conditional-alias-templates/41724270#41724270", "title": "&quot;Conditional&quot; alias templates", "body": "<p>By using <code>std::conditional</code> from <code>&lt;type_traits&gt;</code>. It's as simple as:</p>\n\n<pre><code>using type = typename std::conditional&lt;bool, int, float&gt;::type;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>using type = std::conditional_t&lt;bool, int, float&gt;;\n</code></pre>\n\n<p>where you replace <code>bool</code> with some condition, evaluable at compile-time to a boolean value. In this case the condition is the check for an existing member.</p>\n\n<p>If the condition is <code>true</code> type becomes an alias to <code>int</code>, otherwise to <code>float</code>. </p>\n\n<p><strong>FULL EXAMPLE</strong> (Check if <code>difference_type</code> is a member type.)</p>\n\n<pre><code>namespace detail {\n\ntemplate&lt;class Ptr&gt;\nusing ptrait_diff = typename Ptr::difference_type;\n\ntemplate&lt;class Ptr, bool = is_detected&lt;ptrait_diff, Ptr&gt;::value&gt;\nstruct ptrait_diff_t { \n    using type = ptrdiff_t;\n};\n\ntemplate&lt;class Ptr&gt;\nstruct ptrait_diff_t&lt;Ptr, true&gt; {\n    using type = typename Ptr::difference_type;\n};\n\n} // namespace detail\n</code></pre>\n\n<p>and then:</p>\n\n<pre><code>template&lt;class Ptr&gt;\nstruct pointer_traits\n{\n    using difference_type = typename detail::ptrait_diff_t&lt;Ptr&gt;::type;\n};\n</code></pre>\n\n<p>Implementation of <code>is_detected</code> can be found <a href=\"http://en.cppreference.com/w/cpp/experimental/is_detected\" rel=\"nofollow noreferrer\">HERE</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": false, "score": 3, "last_activity_date": 1484756332, "creation_date": 1484756332, "answer_id": 41724313, "question_id": 41724111, "link": "https://stackoverflow.com/questions/41724111/conditional-alias-templates/41724313#41724313", "title": "&quot;Conditional&quot; alias templates", "body": "<p>This is the problem <a href=\"http://en.cppreference.com/w/cpp/types/conditional\" rel=\"nofollow noreferrer\">std::conditional</a> is designed to solve.</p>\n\n<pre><code>#include &lt;type_traits&gt;\ntemplate&lt;bool condition&gt; \nusing type = std::conditional_t&lt;condition, int, float&gt;;\n\nstatic_assert(std::is_same&lt;type&lt;true&gt;,  int&gt;::value,   \"type&lt;true&gt; should be int\");\nstatic_assert(std::is_same&lt;type&lt;false&gt;, float&gt;::value, \"type&lt;false&gt; should be float\");\n</code></pre>\n"}], "owner": {"reputation": 1343, "user_id": 4480394, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-QwHzVkP4n0Y/AAAAAAAAAAI/AAAAAAAAAGo/xwQ_WdtwEjQ/photo.jpg?sz=128", "display_name": "Mona the Monad", "link": "https://stackoverflow.com/users/4480394/mona-the-monad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1470, "favorite_count": 0, "accepted_answer_id": 41724270, "answer_count": 2, "score": 4, "last_activity_date": 1484771924, "creation_date": 1484755745, "question_id": 41724111, "link": "https://stackoverflow.com/questions/41724111/conditional-alias-templates", "title": "&quot;Conditional&quot; alias templates", "body": "<p>In a type like the unspecialized template struct <code>pointer_traits</code> (i.e. <code>template &lt;class Ptr&gt; struct pointer_traits</code>), there exists a member alias template <code>rebind</code> that is defined to be <code>Ptr::rebind&lt;U&gt;</code>, if it exists, or some other type otherwise. Though I have seen a few answers on <em>checking</em> whether a certain member exists, how does one implement a \"conditional\" alias template like <code>pointer_traits::rebind</code>? That is, as if by the following pseudo-C++:</p>\n\n<pre><code>template &lt;typename T&gt; using type = has_type&lt;T::U&gt; ? int : float;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>template &lt;typename T&gt; using type = if_has_type&lt;T::U, int, float&gt;::type;\n</code></pre>\n\n<p>I considered using something like the method depicted at <a href=\"https://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Member_Detector\" rel=\"nofollow noreferrer\">https://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Member_Detector</a> (section \"Detecting member types\"), but I don't know how to implement a helper struct whose [sole] member type depends on the existence of another member type.</p>\n"}, {"tags": ["c++", "c++11", "atomic"], "comments": [{"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1484756311, "post_id": 41724093, "comment_id": 70643292, "body": "Are you essentially just asking &quot;does an implementation exist where X is true?&quot;"}, {"owner": {"reputation": 32089, "user_id": 266198, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7x8PT.jpg?s=128&g=1", "display_name": "Nim", "link": "https://stackoverflow.com/users/266198/nim"}, "reply_to_user": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1484756359, "post_id": 41724093, "comment_id": 70643325, "body": "@TylerH: yes a - practical implementation?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 1, "creation_date": 1484756515, "post_id": 41724093, "comment_id": 70643431, "body": "@Mat There are <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr/atomic\" rel=\"nofollow noreferrer\">free functions added by <code>shared_ptr</code></a>"}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484756574, "post_id": 41724093, "comment_id": 70643468, "body": "@NathanOliver: Ah, neat. Thanks for the info."}, {"owner": {"reputation": 27522, "user_id": 6394138, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/u64Lc.png?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/6394138/leon"}, "edited": false, "score": 0, "creation_date": 1484756909, "post_id": 41724093, "comment_id": 70643720, "body": "I don&#39;t believe that such a platform/implementation exists"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1484816492, "post_id": 41724093, "comment_id": 70668516, "body": "Williams&#39;s own implementation of the concurrency TS has an <a href=\"http://www.stdthread.co.uk/doc/headers/experimental_atomic/atomic_shared_ptr.html\" rel=\"nofollow noreferrer\"><code>atomic_shared_ptr</code></a> that is lock-free for CPUs supporting double-width CAS."}], "owner": {"reputation": 32089, "user_id": 266198, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7x8PT.jpg?s=128&g=1", "display_name": "Nim", "link": "https://stackoverflow.com/users/266198/nim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1484755706, "creation_date": 1484755706, "question_id": 41724093, "link": "https://stackoverflow.com/questions/41724093/is-there-a-platform-where-atomic-is-lock-free-on-shared-ptr-returns-true", "title": "Is there a platform where atomic_is_lock_free on shared_ptr&lt;&gt; returns true?", "body": "<p>I'm currently reading \"Concurrency in Action\" by A. Williams and during a discussion on lock-free stack implementations, he mentions that if a platform returns <code>true</code> for <code>atomic_is_lock_free()</code> on a <code>shared_ptr&lt;&gt;</code> instance, then a <code>shared_ptr&lt;&gt;</code> can be used to cleanly implement the stack. However, the following on my platform (fedora, gcc 6.3.1 with c++14 option) returns <code>0</code>. So my question is, is there a platform where this returns true?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\n#include &lt;atomic&gt;\n\nint main(void) {\n  auto f = std::make_shared&lt;int&gt;(10);\n  std::cout &lt;&lt; std::atomic_is_lock_free(&amp;f) &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "vector", "complex-numbers"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1484755611, "post_id": 41724008, "comment_id": 70642794, "body": "Do note it is hard to tell what the performance problem is without any code."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 3, "creation_date": 1484755928, "post_id": 41724008, "comment_id": 70643012, "body": "Please one question per question, and provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for speed testing."}, {"owner": {"reputation": 3463, "user_id": 508175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ca8c547ecf1fad821a9932396820baf2?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro Teruzzi", "link": "https://stackoverflow.com/users/508175/alessandro-teruzzi"}, "edited": false, "score": 0, "creation_date": 1484756212, "post_id": 41724008, "comment_id": 70643205, "body": "&quot;Is my compiler missing some optimization or do I have to go with raw pointers and the hassle of memory?&quot; Which compiler are you using? Which flags?"}, {"owner": {"reputation": 161, "user_id": 7399202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15af7ee28188596d1a4e2e3f6cbcb6b?s=128&d=identicon&r=PG&f=1", "display_name": "Laray", "link": "https://stackoverflow.com/users/7399202/laray"}, "edited": false, "score": 0, "creation_date": 1484756298, "post_id": 41724008, "comment_id": 70643277, "body": "I&#39;m working on a minimal example. Have to make one up from scratch, since copying from all other the project is a mess!"}], "answers": [{"comments": [{"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1484755996, "post_id": 41724158, "comment_id": 70643056, "body": "Wouldn&#39;t std::copy work, since there is an implicit conversion? Or even vector::insert?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1484756243, "post_id": 41724158, "comment_id": 70643235, "body": "@MarcGlisse this is just an example, I am not sure that OP uses <code>std::complex</code> and if not if that class has implicit ctor."}, {"owner": {"reputation": 161, "user_id": 7399202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15af7ee28188596d1a4e2e3f6cbcb6b?s=128&d=identicon&r=PG&f=1", "display_name": "Laray", "link": "https://stackoverflow.com/users/7399202/laray"}, "edited": false, "score": 0, "creation_date": 1484756260, "post_id": 41724158, "comment_id": 70643243, "body": "I have two vectors a and b. I want vector c, so that c[n]=a[n]+i*b[n] with(i=sqrt(-1)). This is not given here."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 161, "user_id": 7399202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15af7ee28188596d1a4e2e3f6cbcb6b?s=128&d=identicon&r=PG&f=1", "display_name": "Laray", "link": "https://stackoverflow.com/users/7399202/laray"}, "edited": false, "score": 1, "creation_date": 1484756329, "post_id": 41724158, "comment_id": 70643303, "body": "@Laray my telepathy machine is broken today, here is given what you asked for, not what you had in mind. Though updated answer for your new request"}, {"owner": {"reputation": 161, "user_id": 7399202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15af7ee28188596d1a4e2e3f6cbcb6b?s=128&d=identicon&r=PG&f=1", "display_name": "Laray", "link": "https://stackoverflow.com/users/7399202/laray"}, "edited": false, "score": 0, "creation_date": 1484756614, "post_id": 41724158, "comment_id": 70643502, "body": "Sorry, I redrafted the Question multiple times. It was in there before I erased something and forgot to put it back in."}, {"owner": {"reputation": 161, "user_id": 7399202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15af7ee28188596d1a4e2e3f6cbcb6b?s=128&d=identicon&r=PG&f=1", "display_name": "Laray", "link": "https://stackoverflow.com/users/7399202/laray"}, "edited": false, "score": 0, "creation_date": 1484759087, "post_id": 41724158, "comment_id": 70645260, "body": "Thank you, that could help me! But another request: the sizes are (in some cases) size(a)=n, size(b)=n+1 and size(c)=2n. Is there a good way then?"}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 2, "last_activity_date": 1484756663, "last_edit_date": 1484756663, "creation_date": 1484755875, "answer_id": 41724158, "question_id": 41724008, "link": "https://stackoverflow.com/questions/41724008/how-to-fill-an-stdvector-of-complex-doubles-from-an-stdvector-of-real-double/41724158#41724158", "title": "How to fill an std::vector of complex doubles from an std::vector of real doubles", "body": "<blockquote>\n  <p>I have not found any way to do this with std::fill or any other method more sophisticated than looping over all entries.</p>\n</blockquote>\n\n<p>Just use <code>std::transform</code> with lambda:</p>\n\n<pre><code>std::vector&lt;double&gt; a{ 1.0, 2.0, 3.0 };\nstd::vector&lt;double&gt; b{ 4.0, 5.0, 6.0 };\nstd::vector&lt;std::complex&lt;double&gt;&gt; cvec( a.size() );\nstd::transform( a.begin(), a.end(), b.begin(), cvec.begin(), []( double da, double db ) {\n    return std::complex&lt;double&gt;( da, db );\n} );\n</code></pre>\n\n<p>you have to make sure that <code>b</code> and <code>cvec</code> at least as big as <code>a</code>, though for <code>cvec</code> you can use <code>std::back_inserter</code> but that maybe slightly slower if you do not call reserve for it.</p>\n"}], "owner": {"reputation": 161, "user_id": 7399202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15af7ee28188596d1a4e2e3f6cbcb6b?s=128&d=identicon&r=PG&f=1", "display_name": "Laray", "link": "https://stackoverflow.com/users/7399202/laray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4897, "favorite_count": 3, "answer_count": 1, "score": 1, "last_activity_date": 1484765903, "creation_date": 1484755501, "last_edit_date": 1484765903, "question_id": 41724008, "link": "https://stackoverflow.com/questions/41724008/how-to-fill-an-stdvector-of-complex-doubles-from-an-stdvector-of-real-double", "title": "How to fill an std::vector of complex doubles from an std::vector of real doubles", "body": "<p>I'm working on a math code, that heavily relies on convolution via inplace-FFT of real data. </p>\n\n<p>Since my data is real up until it enters the convolution and will be real right when the convolution is done, I use <code>std::vector&lt;double&gt;</code> everywhere. </p>\n\n<p>So inside my convolution, I have to copy my real data into my complex data. I have not found any way to do this with <code>std::fill()</code> or any other method more sophisticated than looping over all entries. </p>\n\n<p>In addition: When measuring the time taken when using raw pointers vs. <code>unique_ptr</code> vs. <code>std::vector</code> the first one wins with about half the time taken, with many <code>get()</code> operations through the wrappers. \nIs my compiler missing some optimization or do I have to go with raw pointers and the hassle of memory?</p>\n\n<p>Working Example: I can not test this right now, but I have old times heavily supporting my claim. These timing were made by building the solution with Visual Studio  Community 2015 by using (Build Solution) from Build-Dropdown. \nPerformance-Analysis shows, much time is spent in getting from wrapper to data. </p>\n\n<pre><code>#include &lt;chrono&gt;\n#include &lt;complex&gt;\n#include &lt;vector&gt;\n\nvoid FFT();\nvoid IFFT();\n\nint main() {\n    unsigned int N=1024;\n\n    std::vector&lt;double&gt; real;\n    real.resize(N);\n    std::vector&lt;double&gt; imag;\n    imag.resize(N);\n    for (unsigned int i = 0; i &lt; N; ++i) {\n        real[i] = i;\n        imag[i] = i;\n    }\n\n    std::chrono::steady_clock::time_point begin = std::chrono::steady_clock::now();\n\n    std::complex&lt;double&gt; I = std::complex&lt;double&gt; (0, 1);\n    std::vector&lt;std::complex&lt;double&gt;&gt; data;\n    data.resize(2048);\n    for (unsigned int i = 0; i &lt; N; ++i) {\n        data[i] = real[i] + I*imag[i];\n    }\n    FFT();\n\n    data[0] = 0.25*I*(conj(data[0] * data[0]) - data[0]*data[0]);\n    for (unsigned int r = 1; r &lt; 2 * N - r; ++r) {\n        std::complex&lt;double&gt; z1 = data[2 * N - r];\n        std::complex&lt;double&gt; z2 = data[r];\n        std::complex&lt;double&gt; res = 0.25*I*(conj(z1 * z1) - z2*z2);\n        data[r]=res;\n        data[2*N - r]= conj(res);\n    }\n    IFFT();\n\n    std::vector&lt;double&gt; result;\n    result.resize(2 * N);\n    for (unsigned int i = 0; i &lt; 2 * N; ++i) {\n        result[i] = data[i].real();\n    }\n\n    std::chrono::steady_clock::time_point end = std::chrono::steady_clock::now();\n    return std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(end - begin).count();\n}\n</code></pre>\n"}, {"tags": ["c++", "algorithm", "c++11", "kadanes-algorithm"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1484755531, "post_id": 41723987, "comment_id": 70642736, "body": "Is there a reason for the <code>c</code>-tag or do you just find it aesthetically pleasing?"}, {"owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "edited": false, "score": 0, "creation_date": 1484756334, "post_id": 41723987, "comment_id": 70643310, "body": "Seem problem is unclear. Try to formulate it better and give an example."}, {"owner": {"reputation": 135, "user_id": 5719638, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/918f82c548321750dd3b9ebf51be9488?s=128&d=identicon&r=PG&f=1", "display_name": "axaysd", "link": "https://stackoverflow.com/users/5719638/axaysd"}, "reply_to_user": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "edited": false, "score": 0, "creation_date": 1484757529, "post_id": 41723987, "comment_id": 70644140, "body": "formulated better by adding an example i/o case. @MBo"}], "answers": [{"tags": [], "owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "is_accepted": false, "score": 0, "last_activity_date": 1484758808, "last_edit_date": 1484758808, "creation_date": 1484758315, "answer_id": 41725053, "question_id": 41723987, "link": "https://stackoverflow.com/questions/41723987/how-do-i-modify-kadanes-algorithm-to-find-out-the-subarray-elements-that-contri/41725053#41725053", "title": "How do I modify Kadane&#39;s algorithm to find out the subarray elements that contribute to the maximum sum?", "body": "<p>Note that you execute</p>\n\n<pre><code>res.push_back(a[i]);\n</code></pre>\n\n<p>in any case and don't refresh res if <code>if(temp_sum&gt;final_sum)</code> failed</p>\n\n<p>By the way, condition <code>if(a[i]&gt;temp_sum+a[i])</code> is equal to  <code>temp_sum &lt;0</code>  (does not influence the result)</p>\n"}], "owner": {"reputation": 135, "user_id": 5719638, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/918f82c548321750dd3b9ebf51be9488?s=128&d=identicon&r=PG&f=1", "display_name": "axaysd", "link": "https://stackoverflow.com/users/5719638/axaysd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 214, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1484758808, "creation_date": 1484755457, "last_edit_date": 1484757479, "question_id": 41723987, "link": "https://stackoverflow.com/questions/41723987/how-do-i-modify-kadanes-algorithm-to-find-out-the-subarray-elements-that-contri", "title": "How do I modify Kadane&#39;s algorithm to find out the subarray elements that contribute to the maximum sum?", "body": "<p><strong>What I've done so far:</strong></p>\n\n<p>I've found out the sum using Kadane's algorithm.</p>\n\n<p>I created a vector \"res\" that stores the elements when conditions are satisfied.</p>\n\n<p><strong>Problem:</strong>\nFor example, when the input is an array: {-2, -3, 4, -1, -2, 1, 5, -3}\nThe result array contains the right subarray elements along with 1 extra element which is added when the condition fails.</p>\n\n<p><strong>tldr:</strong> The code returns the output subarray as : {4 -1 -2 1 5 -3}\nwhereas, the correct output should be {4, -1, -2, 1, 5}</p>\n\n<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\nint main()\n{\n    int i, a[10], n, temp_sum=0, final_sum=0;\n    vector&lt;int&gt; res;\n    cin &gt;&gt; n;                               //getting array size input\n    for(i=0; i&lt;n; i++)\n    {\n        cin &gt;&gt; a[i];                        //getting array elements input\n    }\n    temp_sum=a[0];                          //initializing to first element\n    final_sum=a[0];\n    for(i=1; i&lt;n; i++)\n    {\n        if(a[i]&gt;temp_sum+a[i])       //if element is greater than sum so far\n        {\n            temp_sum = a[i];\n            res.clear();\n            res.push_back(a[i]);\n        }\n        else\n        {\n            temp_sum = a[i] + temp_sum;\n            cout &lt;&lt; temp_sum &lt;&lt; \" \" &lt;&lt; final_sum &lt;&lt; \" \" &lt;&lt; a[i] &lt;&lt; \"\\n\";\n            res.push_back(a[i]);\n        }\n        if(temp_sum&gt;final_sum)\n        {\n            final_sum = temp_sum;\n        }\n    }\n    cout &lt;&lt; final_sum &lt;&lt; \"\\n\";                  //displaying maximum sum\n    for(i=0; i&lt;res.size(); i++)                 //displaying result vector\n    {\n        cout &lt;&lt; res[i] &lt;&lt; \" \";\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "object", "stdvector", "push-back"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 2, "creation_date": 1484755226, "post_id": 41723846, "comment_id": 70642525, "body": "Can you create a <b>complete</b> code example that anyone can copy-and-paste, run, and compile themselves?"}, {"owner": {"reputation": 341, "user_id": 1293111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/681da9bbb30b0eef5b71e3ac72182e00?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1293111/gene"}, "edited": false, "score": 1, "creation_date": 1484755236, "post_id": 41723846, "comment_id": 70642533, "body": "Can you show us the of the class &quot;Instance&quot;? It is most likely that there is somewhere a pointer issue."}, {"owner": {"reputation": 413, "user_id": 3725053, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/51596348329beb6629e39c1c282143d7?s=128&d=identicon&r=PG&f=1", "display_name": "Elias Kosunen", "link": "https://stackoverflow.com/users/3725053/elias-kosunen"}, "edited": false, "score": 2, "creation_date": 1484755288, "post_id": 41723846, "comment_id": 70642569, "body": "As a side-comment: Don&#39;t heap-allocate STL containers."}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "reply_to_user": {"reputation": 413, "user_id": 3725053, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/51596348329beb6629e39c1c282143d7?s=128&d=identicon&r=PG&f=1", "display_name": "Elias Kosunen", "link": "https://stackoverflow.com/users/3725053/elias-kosunen"}, "edited": false, "score": 0, "creation_date": 1484755571, "post_id": 41723846, "comment_id": 70642762, "body": "@EliasKosunen: What? That&#39;s not a rule. You would heap allocate a standard library container for the same reasons you would heap allocate any other object."}, {"owner": {"reputation": 413, "user_id": 3725053, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/51596348329beb6629e39c1c282143d7?s=128&d=identicon&r=PG&f=1", "display_name": "Elias Kosunen", "link": "https://stackoverflow.com/users/3725053/elias-kosunen"}, "reply_to_user": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 1, "creation_date": 1484755777, "post_id": 41723846, "comment_id": 70642911, "body": "@BenjaminLindley A <code>std::vector</code> is basically composed of three data members: size, capacity (both size_t) and a pointer to the data which is dynamically allocated. There&#39;s no benefit of putting the whole vector on the heap when the data is already there."}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "reply_to_user": {"reputation": 413, "user_id": 3725053, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/51596348329beb6629e39c1c282143d7?s=128&d=identicon&r=PG&f=1", "display_name": "Elias Kosunen", "link": "https://stackoverflow.com/users/3725053/elias-kosunen"}, "edited": false, "score": 0, "creation_date": 1484755855, "post_id": 41723846, "comment_id": 70642964, "body": "@EliasKosunen: What if you need a persistent address for the vector? For example, if you want shared ownership."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 413, "user_id": 3725053, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/51596348329beb6629e39c1c282143d7?s=128&d=identicon&r=PG&f=1", "display_name": "Elias Kosunen", "link": "https://stackoverflow.com/users/3725053/elias-kosunen"}, "edited": false, "score": 1, "creation_date": 1484755865, "post_id": 41723846, "comment_id": 70642972, "body": "@EliasKosunen There is if you need ownership semantics.  it all depends on the use case."}, {"owner": {"reputation": 1574, "user_id": 239189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mUAlH.png?s=128&g=1", "display_name": "jszpilewski", "link": "https://stackoverflow.com/users/239189/jszpilewski"}, "edited": false, "score": 0, "creation_date": 1484760227, "post_id": 41723846, "comment_id": 70645974, "body": "When you use <code>push_back</code> creating a <code>Commodity</code> object inside of the vector may invoke the copy constructor (not shown here) which may have some side effects. You may start with replacing <code>push_back</code> with <code>emplace_back</code> (uses perfect forwarding)."}, {"owner": {"reputation": 1694, "user_id": 1791696, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6cf769c74a837d280bdbf90d0d824e0?s=128&d=identicon&r=PG", "display_name": "joeking", "link": "https://stackoverflow.com/users/1791696/joeking"}, "edited": false, "score": 2, "creation_date": 1484772949, "post_id": 41723846, "comment_id": 70652969, "body": "hex(12297829382473034412) = 0xaaaaaaaaaaaaaaac.&lt;br&gt;This looks a lot like a malloc sentinel value for something like uninitialized memory or freed memory -- the _commities vector is being corrupted somehow."}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 2, "creation_date": 1484912433, "post_id": 41723846, "comment_id": 70716966, "body": "I <a href=\"http://melpon.org/wandbox/permlink/m9UaBbQ9wFVFwiuJ\" rel=\"nofollow noreferrer\">cannot reproduce the issue in your minimal example</a>."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1484913694, "post_id": 41723846, "comment_id": 70717775, "body": "Did you 100% confirm that your minimal example replicates the problem? (Because if the real <code>Commodity</code> class violates the rule of 0/3/5 more seriously than the example class does, that would explain everything.)"}, {"owner": {"reputation": 18565, "user_id": 10593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3eeb7653c4df9b0f1332b9b0ec201ec?s=128&d=identicon&r=PG", "display_name": "Max Lybbert", "link": "https://stackoverflow.com/users/10593/max-lybbert"}, "edited": false, "score": 0, "creation_date": 1484915145, "post_id": 41723846, "comment_id": 70718689, "body": "The advice shouldn&#39;t be &quot;never allocate a container on the heap&quot; but &quot;don&#39;t allocate anything on the heap that you don&#39;t need to.&quot; On the one hand, the question uses a smart pointer, so that&#39;s an improvement over what you normally see. On the other hand, we&#39;re talking about private member variables, so there shouldn&#39;t be any shared ownership."}, {"owner": {"reputation": 18565, "user_id": 10593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3eeb7653c4df9b0f1332b9b0ec201ec?s=128&d=identicon&r=PG", "display_name": "Max Lybbert", "link": "https://stackoverflow.com/users/10593/max-lybbert"}, "edited": false, "score": 0, "creation_date": 1484915815, "post_id": 41723846, "comment_id": 70719063, "body": "You&#39;re focused on the wrong thing. I have no problem using<code>push_back</code> or<code>emplace_back</code> to turn an empty <code>std::vector</code> into a one-element <code>std::vector</code>. It works even if I wrap the vector in a <code>std::shared_ptr</code>. You appear to have undefined behavior somewhere else. Note: undefined behavior can cause unrelated valid code to misbehave ( <a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html\" rel=\"nofollow noreferrer\">blog.llvm.org/2011/05/what-every-c-programmer-should-know.ht&zwnj;&#8203;ml</a> ). There&#39;s no defined scope that might be affected by undefined behavior."}], "answers": [{"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 1, "last_activity_date": 1484913954, "creation_date": 1484913954, "answer_id": 41763299, "question_id": 41723846, "link": "https://stackoverflow.com/questions/41723846/vector-push-back-of-one-object-results-in-a-vector-of-enormous-size/41763299#41763299", "title": "Vector push_back of one object results in a vector of enormous size", "body": "<p>Your <code>Commodity</code> class violates the <a href=\"https://en.wikipedia.org/wiki/Rule_of_three_(C%2B%2B_programming)\" rel=\"nofollow noreferrer\">rule of 0/3/5</a>.</p>\n\n<p>Your code (inexplicably) does this:</p>\n\n<pre><code>commodities-&gt;emplace_back(Commodity(a,b,c,d));\n</code></pre>\n\n<p>This is really strange. Presumably, you're calling <code>emplace_back</code> to avoid having to construct a separate <code>Commodity</code> from the one in the vector. But you <em>force</em> that to happen by explicitly constructing a separate <code>Commodity</code> as the parameter to <code>emplace_back</code>.</p>\n\n<p>That invokes <code>Commodity</code>'s copy constructor to construct the <code>Commodity</code> in the vector as a copy of the one you explicitly created. Except <code>Commodity</code> doesn't have one. Most likely, the real <code>Commmodity</code> class needs one, since it has a destructor.</p>\n"}], "owner": {"reputation": 21, "user_id": 7435376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09e16faf62883d5922a064ed8ffd5e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Scartzaw", "link": "https://stackoverflow.com/users/7435376/scartzaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1484913954, "creation_date": 1484755071, "last_edit_date": 1484912276, "question_id": 41723846, "link": "https://stackoverflow.com/questions/41723846/vector-push-back-of-one-object-results-in-a-vector-of-enormous-size", "title": "Vector push_back of one object results in a vector of enormous size", "body": "<p>i'm working on a project in c++, and I have a vector of objects, where I want to push_back an object on the existing vector. However, when checking the size before and after the object is added, the size goes from 0 to 12297829382473034412 which puzzles me greatly. The code in question is the addCommodity function below. (I have created a smaller example of the same problem further down, so skip to \"<strong>SMALL PROBLEM</strong>\")</p>\n\n<pre><code>void Instance::addCommodity(std::vector&lt;std::string&gt; &amp; tokens) {\n  /*if(tokens.size()!=5){\n    std::cerr &lt;&lt; \"Error in commodity data format\"&lt;&lt; std::endl;\n    exit(-1);\n  }*/\n  // size_t so = std::atoi(tokens[1].c_str());\n  // size_t si = std::atoi(tokens[2].c_str());\n  // size_t demand = std::atoi(tokens[3].c_str());\n  // size_t ti = std::atoi(tokens[4].c_str());\n  std::cout &lt;&lt; \"size: \" &lt;&lt; this-&gt;_commodities-&gt;size() &lt;&lt; \"\\n\"; \n\n  this-&gt;_commodities-&gt;push_back(Commodity(1,2,3,4));  // ???\n\n  std::cout &lt;&lt; \"size: \" &lt;&lt; this-&gt;_commodities-&gt;size() &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>Here I have commented out the parts of the code which are used to read data from a string which was loaded from a file. Commodity is defined as follows:</p>\n\n<pre><code>#include \"commodity.h\"\n\nCommodity::Commodity(size_t so, size_t si, size_t d, size_t ti):\n  _source(so),\n  _sink(si),\n  _demand(d),\n  _maxTime(ti)\n{}\n\nCommodity::~Commodity(){}\n\nsize_t Commodity::getSource() const{\n  return _source;\n}\n\nsize_t Commodity::getSink() const {\n  return _sink;\n}\n\nsize_t Commodity::getDemand() const {\n  return _demand;\n}\n\nsize_t Commodity::getTime() const {\n  return _maxTime;\n}\n</code></pre>\n\n<p>Where Instance is initialised as:</p>\n\n<pre><code>Instance::Instance(std::shared_ptr&lt;Param&gt; p, size_t n):\n  _params(p),\n  _nNodes(n)\n{\n  this-&gt;_commodities.reset(new std::vector&lt;Commodity&gt;());\n  this-&gt;_arcs.reset(new std::vector&lt;Arc&gt;());\n  }\n</code></pre>\n\n<p>As mentioned before my issue lies in the addCommodity code, when trying to push_back a Commodity. Hopefully this is enough code to identify any stupid mistakes that I have made. I left out most of the other code for this project as it doesn't seem to have an impact on the addCommodity function. </p>\n\n<p>The output received when calling the function is:</p>\n\n<pre><code>size: 0\nsize: 12297829382473034412\n</code></pre>\n\n<p><strong>SMALL PROBLEM</strong></p>\n\n<p>Instead of showing all the code, I have run the push_back on the vector in main:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;vector&gt;\n\n\n#include \"commodity.h\"\n\nint main(int argc, char* argv[]){\n\n\n std::shared_ptr&lt; std::vector&lt;Commodity&gt;&gt; commodities;\n\n  commodities.reset(new std::vector&lt;Commodity&gt;());\n\n  std::cout &lt;&lt; \"size: \" &lt;&lt; commodities-&gt;size() &lt;&lt; \"\\n\";\n\n  size_t a = 1;\n  size_t b = 2;\n  size_t c = 3;\n  size_t d = 4;\n\n  commodities-&gt;emplace_back(Commodity(a,b,c,d));\n\n  std::cout &lt;&lt; \"size: \" &lt;&lt; commodities-&gt;size() &lt;&lt; std::endl;\n\n  return 0;\n\n}\n</code></pre>\n\n<p>This is basically a smaller instance of the same code. The commodity cpp and h files are as follows:</p>\n\n<pre><code>#include \"commodity.h\"\n\nCommodity::Commodity(size_t so, size_t si, size_t d, size_t ti):\n  _source(so),\n  _sink(si),\n  _demand(d),\n  _maxTime(ti)\n{}\n\nCommodity::~Commodity(){}\n\nsize_t Commodity::getSource() const{\n  return _source;\n}\n\nsize_t Commodity::getSink() const {\n  return _sink;\n}\n\nsize_t Commodity::getDemand() const {\n  return _demand;\n}\n\nsize_t Commodity::getTime() const {\n  return _maxTime;\n}\n</code></pre>\n\n<p>The header file:</p>\n\n<pre><code>#ifndef CG_MCF_COMMODITY_H\n#define CG_MCF_COMMODITY_H\n\n#include &lt;stdlib.h&gt;\n\nclass Commodity {\n\n public:\n\n  Commodity(size_t so, size_t si, size_t d, size_t t);\n\n  ~Commodity();\n\n  size_t getSource() const;\n\n  size_t getSink() const;\n\n  size_t getDemand() const;\n\n  size_t getTime() const;\n\n private:\n\n  size_t _source;\n\n  size_t _sink;\n\n  size_t _demand;\n\n  size_t _maxTime;\n\n};\n\n#endif /*CG_MCF_COMMODITY_H*/\n</code></pre>\n\n<p>The output received when calling the function is:</p>\n\n<pre><code>size: 0\nsize: 12297829382473034412\n</code></pre>\n"}, {"tags": ["c++", "c++17"], "answers": [{"tags": [], "owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "is_accepted": true, "score": 7, "last_activity_date": 1484923525, "last_edit_date": 1592644375, "creation_date": 1484754666, "answer_id": 41723705, "question_id": 41723704, "link": "https://stackoverflow.com/questions/41723704/how-to-filter-a-stdinteger-sequence/41723705#41723705", "title": "How to filter a std::integer_sequence", "body": "<h3>Edit 2</h3>\n<p>After some back and forth on Barry's answer, I've come up with the following answer that merges the concepts and handles some empty-sequence edge cases (<a href=\"http://melpon.org/wandbox/permlink/aXar83yRPdBj4b0f\" rel=\"nofollow noreferrer\">Full code</a>):</p>\n<p>We are allowed to pass a predicate to a function only if it is a <code>constexpr</code> lambda, as only literal types are allowed in <a href=\"http://en.cppreference.com/w/cpp/language/constexpr\" rel=\"nofollow noreferrer\"><code>constexpr</code> functions</a>, and normal free-floating functions aren't literal types (although I suppose you could wrap one within your lambda).</p>\n<p>Our generic filter function will accept a sequence and a predicate, and return a new sequence. We will use <a href=\"http://en.cppreference.com/w/cpp/language/if#Constexpr_If\" rel=\"nofollow noreferrer\"><code>constexpr if</code></a> to handle empty sequence cases (which also requires the <a href=\"http://en.cppreference.com/w/cpp/language/attributes\" rel=\"nofollow noreferrer\"><code>maybe_unused</code></a> attribute on the predicate, because it's unused) :</p>\n<pre><code>template&lt;class INT, INT... b, class Predicate&gt;\nconstexpr auto Filter(std::integer_sequence&lt;INT, b...&gt;, [[maybe_unused]] Predicate pred)\n{\n    if constexpr (sizeof...(b) &gt; 0) // non empty sequence\n       return concat_sequences(FilterSingle(std::integer_sequence&lt;INT, b&gt;{}, pred)...);\n    else // empty sequence case\n        return std::integer_sequence&lt;INT&gt;{};\n}\n</code></pre>\n<p>The <code>Filter</code> function calls <code>FilterSingle</code> for each element in the provided sequence, and concatenates the result of all of them:</p>\n<pre><code>template&lt;class INT, INT a, class Predicate&gt;\nconstexpr auto FilterSingle(std::integer_sequence&lt;INT, a&gt;, Predicate pred)\n{\n    if constexpr (pred(a))\n        return std::integer_sequence&lt;INT, a&gt;{};\n    else\n        return std::integer_sequence&lt;INT&gt;{};\n}\n</code></pre>\n<p>To concatenate sequences, the basic approach is thus:</p>\n<pre><code>template&lt;typename INT, INT... s, INT... t&gt;\nconstexpr std::integer_sequence&lt;INT,s...,t...&gt;\nconcat_sequences(std::integer_sequence&lt;INT, s...&gt;, std::integer_sequence&lt;INT, t...&gt;){\n    return {};\n}\n</code></pre>\n<p>Although because of template expansion we'll have more than 2 sequences a lot of time, so we need a recursive case:</p>\n<pre><code>template&lt;typename INT, INT... s, INT... t, class... R&gt;\nconstexpr auto\nconcat_sequences(std::integer_sequence&lt;INT, s...&gt;, std::integer_sequence&lt;INT, t...&gt;, R...){\n    return concat_sequences(std::integer_sequence&lt;INT,s...,t...&gt;{}, R{}...);\n}\n</code></pre>\n<p>And since we may try to concatenate an empty sequence with nothing (can happen if no elements pass the filter), we need another base case:</p>\n<pre><code>template&lt;typename INT&gt;\nconstexpr std::integer_sequence&lt;INT&gt;\nconcat_sequences(std::integer_sequence&lt;INT&gt;){\n    return {};\n}\n</code></pre>\n<p>Now, for our predicate we will use a <a href=\"http://en.cppreference.com/w/cpp/language/lambda\" rel=\"nofollow noreferrer\"><code>constexpr</code> lambda</a>. Note that we do not need to specify it as <code>constexpr</code> explicitly because it already satisfies the criteria to automatically become <code>constexpr</code></p>\n<pre><code>auto is_even = [](int _in) {return _in % 2 == 0;};\n</code></pre>\n<p>So our full test looks like this:</p>\n<pre><code>auto is_even = [](int _in) {return _in % 2 == 0;};\nusing expected_type = std::integer_sequence&lt;int, 0, 2, 4, 6, 8&gt;;\nusing test_type = std::integer_sequence&lt;int, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9&gt;;\nconstexpr auto result = Filter(test_type{}, is_even);\nusing result_type = std::decay_t&lt;decltype(result)&gt;;\nstatic_assert(std::is_same_v&lt;expected_type, result_type&gt;, &quot;Integer sequences should be equal&quot;);\n</code></pre>\n<hr />\n<h3>Previous approach</h3>\n<p>My approach is repeatedly construct and concatenate sub-sequences, where the base case (sequence of one) will either return an empty sequence or the same sequence if the predicate is satisfied.</p>\n<p>For writing the predicate, I'll take advantage of C++17's <a href=\"http://en.cppreference.com/w/cpp/language/if#Constexpr_If\" rel=\"nofollow noreferrer\">constexpr if</a> for defining a predicate.</p>\n<p>Predicate:</p>\n<pre><code>// base case; empty sequence\ntemplate&lt;class INT&gt;\nconstexpr auto FilterEvens(std::integer_sequence&lt;INT&gt;)\n{\n    return std::integer_sequence&lt;INT&gt;{};\n}\n\n// base case; one element in the sequence\ntemplate&lt;class INT, INT a&gt;\nconstexpr auto FilterEvens(std::integer_sequence&lt;INT, a&gt;)\n{\n    if constexpr (a % 2 == 0)\n        return std::integer_sequence&lt;INT, a&gt;{};\n    else\n        return std::integer_sequence&lt;INT&gt;{};\n}\n\n// recursive case\ntemplate&lt;class INT, INT a, INT... b&gt;\nconstexpr auto FilterEvens(std::integer_sequence&lt;INT, a, b...&gt;)\n{\n    return concat_sequence(FilterEvens(std::integer_sequence&lt;INT, a&gt;{}), \n                           FilterEvens(std::integer_sequence&lt;INT, b...&gt;{}));\n}\n</code></pre>\n<p>Concatenation logic:</p>\n<pre><code>template &lt;typename INT, INT ...s, INT ...t&gt;\nconstexpr auto\nconcat_sequence(std::integer_sequence&lt;INT,s...&gt;,std::integer_sequence&lt;INT,t...&gt;){\n   return std::integer_sequence&lt;INT,s...,t...&gt;{};\n}\n</code></pre>\n<p>And the test:</p>\n<pre><code>int main()\n{\n   static_assert(std::is_same_v&lt;std::integer_sequence&lt;int, 0, 2, 4, 6, 8&gt;, decltype(FilterEvens(std::integer_sequence&lt;int, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9&gt;{}))&gt;, &quot;Integer sequences should be equal&quot;);\n}\n</code></pre>\n<p><a href=\"http://melpon.org/wandbox/permlink/SwLOQTT6cmkxp0QT\" rel=\"nofollow noreferrer\">Live Demo</a></p>\n<hr />\n<h3>Edit:</h3>\n<p>I used this approach to solve the &quot;Bonus&quot; question for removing matched bits here: <a href=\"https://stackoverflow.com/a/41727221/27678\">https://stackoverflow.com/a/41727221/27678</a></p>\n"}, {"comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1484775242, "post_id": 41729394, "comment_id": 70654140, "body": "I like this. The slightly tricky part is that <code>predicate</code> can&#39;t really have state. Also, the explicit <code>constexpr</code> on the lambda is unnecessary."}, {"owner": {"reputation": 59630, "user_id": 636019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ba39c7ba510ac2951c010c26afb6a6?s=128&d=identicon&r=PG", "display_name": "ildjarn", "link": "https://stackoverflow.com/users/636019/ildjarn"}, "edited": false, "score": 0, "creation_date": 1484831562, "post_id": 41729394, "comment_id": 70678068, "body": "@Barry : I think the proposed <a href=\"https://ned14.github.io/boost.outcome/\" rel=\"nofollow noreferrer\">Boost.Outcome</a> would work fine, and already has both member function and operator-based chaining available."}, {"owner": {"reputation": 59630, "user_id": 636019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ba39c7ba510ac2951c010c26afb6a6?s=128&d=identicon&r=PG", "display_name": "ildjarn", "link": "https://stackoverflow.com/users/636019/ildjarn"}, "edited": false, "score": 0, "creation_date": 1484832743, "post_id": 41729394, "comment_id": 70678852, "body": "@Barry : It has a monadic (inc. chainable) <code>pair&lt;bool, NewPredicate&gt;</code>, or rather you can easily compose one. You get your nice chaining semantics for free. (My experience with the library is limited but very positive; I have no investment here.)"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1484844820, "post_id": 41729394, "comment_id": 70687465, "body": "I like the idea of using a constexpr lambda as the predicate, although gcc needs a little catching up for this to work (right now get an ICE): <a href=\"http://melpon.org/wandbox/permlink/2m8MRkTyMwbYUyUJ\" rel=\"nofollow noreferrer\">melpon.org/wandbox/permlink/2m8MRkTyMwbYUyUJ</a>  What is strange is the choice of <code>operator+</code> as the concatenation operator for value sequences. One might think instead they would imply some kind of mathematical addition instead (esp. with the analog to integer sequences)"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1484849850, "post_id": 41729394, "comment_id": 70690265, "body": "@Barry: I&#39;m also a little confused regarding the predicate parameter to <code>filter</code> and <code>filter_single</code>. If I instead use a <code>constexpr bool</code> function, gcc tells me that it&#39;s not a constant expression (<a href=\"http://melpon.org/wandbox/permlink/LiAmgxrDGkj1QWZF\" rel=\"nofollow noreferrer\">link</a>). That <code>F</code> becomes <code>bool (*)(int)</code> makes sense, and my intuition tells me that it <i>could</i> be a constant expression, so is gcc wrong here?"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1484918932, "post_id": 41729394, "comment_id": 70720903, "body": "I suppose a function pointer wouldn&#39;t qualify as a literal type and thus couldn&#39;t be an arg to a constexpr function (so you&#39;d need to specify it as a non-type template arg). It should really be a constexpr lambda as you&#39;ve done."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1484921058, "post_id": 41729394, "comment_id": 70722231, "body": "I&#39;ve merged yours and my answer into one that does the trick: <a href=\"http://melpon.org/wandbox/permlink/81WusFnYQCXzpGMC\" rel=\"nofollow noreferrer\">Demo</a>"}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 13, "last_activity_date": 1484773410, "creation_date": 1484773410, "answer_id": 41729394, "question_id": 41723704, "link": "https://stackoverflow.com/questions/41723704/how-to-filter-a-stdinteger-sequence/41729394#41729394", "title": "How to filter a std::integer_sequence", "body": "<p>Filtering a sequence is equivalent to transforming a sequence of values into a sequence of sequences of at most one value and then concatenating them. That is, filtering the even values from <code>&lt;0,1,2,3&gt;</code> would be the same as transforming that into the sequence <code>&lt;&lt;0&gt;,&lt;&gt;,&lt;2&gt;,&lt;&gt;&gt;</code> and concatenating to yield <code>&lt;0,2&gt;</code>.</p>\n\n<p>With C++17, this takes remarkably little code. We'll start with our own value and sequence type (you can easily convert a <code>std::integer_sequence</code> to a <code>value_sequence</code>):</p>\n\n<pre><code>template &lt;auto &gt;\nstruct value { };\n\ntemplate &lt;auto... Vals&gt;\nstruct value_sequence { };\n</code></pre>\n\n<p>The reason we use our own is so we can add operators to it. Like <code>+</code>:</p>\n\n<pre><code>template &lt;auto... As, auto... Bs&gt;\nconstexpr value_sequence&lt;As..., Bs...&gt; operator+(value_sequence&lt;As...&gt;,\n                                                 value_sequence&lt;Bs...&gt; )\n{\n    return {};\n}\n</code></pre>\n\n<p>We'll use that for concatenation. Next, we add a function to transform a single value into a sequence of zero or one element:</p>\n\n<pre><code>template &lt;auto Val, class F&gt;\nconstexpr auto filter_single(value&lt;Val&gt;, F predicate) {\n    if constexpr (predicate(Val)) {\n        return value_sequence&lt;Val&gt;{};\n    }\n    else {\n        return value_sequence&lt;&gt;{};\n    }\n}\n</code></pre>\n\n<p>And lastly, we just need our top-level <code>filter</code> to put it all together:</p>\n\n<pre><code>template &lt;auto... Vals, class F&gt;\nconstexpr auto filter(value_sequence&lt;Vals...&gt;, F predicate) {\n    return (filter_single(value&lt;Vals&gt;{}, predicate) + ...);\n}\n</code></pre>\n\n<p>Usage from the original example:</p>\n\n<pre><code>constexpr auto evens = filter(\n    value_sequence&lt;0, 1, 2, 3, 4, 5, 6, 7, 8, 9&gt;{},\n    [](int i) constexpr { return i%2 == 0; });\n</code></pre>\n\n<p>How cool is C++17!</p>\n"}, {"comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1570226221, "post_id": 58241717, "comment_id": 102859272, "body": "Clever use of non type class template arguments"}], "tags": [], "owner": {"reputation": 161, "user_id": 1973634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/072db03fe8cc4d839fdd74f3240f217b?s=128&d=identicon&r=PG", "display_name": "Jason Lim", "link": "https://stackoverflow.com/users/1973634/jason-lim"}, "is_accepted": false, "score": 2, "last_activity_date": 1590433753, "last_edit_date": 1590433753, "creation_date": 1570214647, "answer_id": 58241717, "question_id": 41723704, "link": "https://stackoverflow.com/questions/41723704/how-to-filter-a-stdinteger-sequence/58241717#58241717", "title": "How to filter a std::integer_sequence", "body": "<p>An alternative solution leveraging tuples:</p>\n\n<pre><code>template &lt;auto Pred, class Type, Type... I&gt;\nstruct filter_integer_sequence_impl\n{\n    template &lt;class... T&gt;\n    static constexpr auto Unpack(std::tuple&lt;T...&gt;)\n    {\n        return std::integer_sequence&lt;Type, T::value...&gt;();\n    }\n\n    template &lt;Type Val&gt;\n    using Keep = std::tuple&lt;std::integral_constant&lt;Type, Val&gt;&gt;;\n    using Ignore = std::tuple&lt;&gt;;\n    using Tuple = decltype(std::tuple_cat(std::conditional_t&lt;(*Pred)(I), Keep&lt;I&gt;, Ignore&gt;()...));\n    using Result = decltype(Unpack(Tuple()));\n};\n\ntemplate &lt;auto Pred, class Type, Type... I&gt;\nconstexpr auto filter_integer_sequence(std::integer_sequence&lt;Type, I...&gt;)\n{\n    return typename filter_integer_sequence_impl&lt;Pred, Type, I...&gt;::Result();\n}\n\ntemplate &lt;class Pred, class Type, Type... I&gt;\nconstexpr auto filter_integer_sequence(std::integer_sequence&lt;Type, I...&gt; sequence, Pred)\n{\n    return filter_integer_sequence&lt;(Pred*)nullptr&gt;(sequence);\n}\n</code></pre>\n\n<p>Used like this:</p>\n\n<pre><code>constexpr auto predicate = [](int val) { return (val % 2) == 0; };\n\nconstexpr auto start = std::integer_sequence&lt;int, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9&gt;();\nconstexpr auto filtered = filter_integer_sequence(start, predicate);\nconstexpr auto expected = std::integer_sequence&lt;int, 0, 2, 4, 6, 8&gt;();\n\nstatic_assert(std::is_same_v&lt;decltype(filtered), decltype(expected)&gt;);\n</code></pre>\n\n<p>The second overload of <code>filter_integer_sequence</code> is only necessary for C++17 which doesn't allow us to use lambdas for non-type template parameters. C++20 lifts that restriction, so in that case only the first overload is needed. Note that the first overload is still necessary in C++17 for handling regular function pointers.</p>\n\n<p>Like the other solutions here, the second overload only works for non-capturing lambdas. This is why we can safely evaluate <code>(*(Pred*)nullptr)(I)</code> as constexpr since the lambda body doesn't actually use the <code>this</code> pointer.</p>\n"}], "owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2088, "favorite_count": 3, "accepted_answer_id": 41723705, "answer_count": 3, "score": 5, "last_activity_date": 1590433753, "creation_date": 1484754666, "last_edit_date": 1495542749, "question_id": 41723704, "link": "https://stackoverflow.com/questions/41723704/how-to-filter-a-stdinteger-sequence", "title": "How to filter a std::integer_sequence", "body": "<p>If I theoretically have a sequence of integers like</p>\n\n<pre><code>std::integer_sequence&lt;int, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9&gt;\n</code></pre>\n\n<p>How can I filter it with some compile-time predicate to get a potentially smaller <code>std::integer_sequence&lt;int, ...&gt;</code>?</p>\n\n<p>For the sake of argument, let's say that I want only the even values,\nwhich leads to the question of \"How can I make the following static_assert (or something close) pass?\"</p>\n\n<pre><code>static_assert(std::is_same_v&lt;std::integer_sequence&lt;int, 0, 2, 4, 6, 8&gt;,\n              decltype(FilterEvens(std::integer_sequence&lt;int, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9&gt;{}))&gt;, \n              \"Integer sequences should be equal\");\n</code></pre>\n\n<p><br/><br/>\n<sup>This question was inspired by thinking about how we might accomplish removing duplicates between two bitsets (<a href=\"https://stackoverflow.com/questions/41720249/detecting-matching-bits-in-c#comment70636187_41720249\">this question</a>), assuming we could represent the bitsets as <code>integer_sequences</code> containing only 0 and 1. Bonus points if you can solve that one in this manner, too</sup></p>\n"}, {"tags": ["c++", "v8", "node-gyp", "embedded-v8", "node.js-addon"], "answers": [{"tags": [], "owner": {"reputation": 450, "user_id": 4292309, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Msp6k.jpg?s=128&g=1", "display_name": "moonraker", "link": "https://stackoverflow.com/users/4292309/moonraker"}, "is_accepted": false, "score": 0, "last_activity_date": 1484824714, "creation_date": 1484824714, "answer_id": 41740506, "question_id": 41723580, "link": "https://stackoverflow.com/questions/41723580/node-addon-node-gyp-build-missing-v8-dlls/41740506#41740506", "title": "Node Addon node-gyp build missing V8 dll&#39;s", "body": "<p>Turns out this has nothing to do with the v8 libraries! The problem was the Visual Studio Solution would't compile with the node.lib file created when i built node.js from source. the .dll part was a bit of a red herring!</p>\n\n<p>To get around this i built it on a system connected to the internet and copied over the folder in the .node-gyp folder (where it stores the downloaded .lib file and headers) and linked against that.</p>\n\n<p>I don't know why i can't link against the .lib i had built but will let you know if i find out.</p>\n"}], "owner": {"reputation": 450, "user_id": 4292309, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Msp6k.jpg?s=128&g=1", "display_name": "moonraker", "link": "https://stackoverflow.com/users/4292309/moonraker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 329, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486886279, "creation_date": 1484754314, "last_edit_date": 1486886279, "question_id": 41723580, "link": "https://stackoverflow.com/questions/41723580/node-addon-node-gyp-build-missing-v8-dlls", "title": "Node Addon node-gyp build missing V8 dll&#39;s", "body": "<p>I\u2019m trying to compile the node-addon example taken from :</p>\n\n<p><a href=\"https://nodejs.org/dist/latest-v6.x/docs/api/addons.html\" rel=\"nofollow noreferrer\">https://nodejs.org/dist/latest-v6.x/docs/api/addons.html</a></p>\n\n<p>I\u2019m trying to do it on an offline system.</p>\n\n<p>I\u2019ve pointed node-gyp configure to a local source of node using \u2013nodedir.</p>\n\n<p>My problem is I\u2019m getting a load of linker errors (9 in total) when I come to node-gyp build.</p>\n\n<pre><code>1&gt;hello.obj : error LNK2001: unresolved external symbol \"__declspec(dllimport) public: static class v8::Isolate * __cdecl v8::Isolate::GetCurrent(void)\" (__imp_?GetCurrent@Isolate@v8@@SAPEAV12@XZ)\n</code></pre>\n\n<p>and I don\u2019t really understand why.</p>\n\n<p>From what i understand the error is telling me that the header file i'm using (v8.h) needs a dll.</p>\n\n<p>I\u2019ve build both the node source and the v8 source and I can\u2019t find any dll\u2019s, just a bunch of .lib files in node\u2026\\build\\release\\libs.</p>\n\n<p>I think it may have something to do with BUILDING_V8_SHARED nor USING_V8_SHARED but not sure how to set them.</p>\n\n<p>Changing the Visual Studio flags in the properties does nothing.</p>\n\n<p>I'm using node v6.9.4 with VS 2015 on windows 7</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "string", "gcc", "pass-by-reference"], "comments": [{"owner": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484754546, "post_id": 41723435, "comment_id": 70642072, "body": "@slava, it would be nice if you could share the link of the post along with marking it as duplicate."}, {"owner": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "edited": false, "score": 0, "creation_date": 1484754674, "post_id": 41723435, "comment_id": 70642151, "body": "Thanks, got it here (<a href=\"http://stackoverflow.com/questions/4157687/using-char-as-a-key-in-stdmap\" title=\"using char as a key in stdmap\">stackoverflow.com/questions/4157687/&hellip;</a>). But that post is not really a duplicate, as my post relates to behavior with const char* as key in map + with inconsistent working on different compiler versions."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1484754682, "post_id": 41723435, "comment_id": 70642156, "body": "link is there on top, right under subject. Your problem is exactly the same - you do not use proper comparator."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1484756174, "post_id": 41723435, "comment_id": 70643179, "body": "This can happen if 4.9.2 uses the &quot;copy on write&quot; optimisation on strings (which is not allowed since C++11). I have no idea whether g++ ever did that, though."}, {"owner": {"reputation": 1178, "user_id": 1563037, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vhb7A.png?s=128&g=1", "display_name": "gabry", "link": "https://stackoverflow.com/users/1563037/gabry"}, "edited": false, "score": 1, "creation_date": 1484756333, "post_id": 41723435, "comment_id": 70643309, "body": "The fact it works on gcc &lt; 5.x is due to the std::string implementation of gcc (up to 5.x as you found), GCC used to alloc a single buffer and share it between all the strings that used it until one of the strings change ( copy on write), newer gcc versions, to comply to c++ 11 standard moved to an std::string based on the small string optimization."}, {"owner": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "reply_to_user": {"reputation": 1178, "user_id": 1563037, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vhb7A.png?s=128&g=1", "display_name": "gabry", "link": "https://stackoverflow.com/users/1563037/gabry"}, "edited": false, "score": 0, "creation_date": 1484758053, "post_id": 41723435, "comment_id": 70644524, "body": "Thanks @gabry for checking this out. Very much appreciate it. But i guess, using const char* pointer as KEY should never be used. What do you think? +1 One of the best answer to my question."}, {"owner": {"reputation": 1178, "user_id": 1563037, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vhb7A.png?s=128&g=1", "display_name": "gabry", "link": "https://stackoverflow.com/users/1563037/gabry"}, "edited": false, "score": 0, "creation_date": 1484899816, "post_id": 41723435, "comment_id": 70709214, "body": "@Sammy there are use cases also for const char * keys, for instance I used them in a map of 100 millions records of 8 to 10 bytes string with strict memory constraints and the std::string overhead was not negligible, I used a single memory allocation for all the keys and all the values, and obviously strcmp() as compare function."}, {"owner": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "reply_to_user": {"reputation": 1178, "user_id": 1563037, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vhb7A.png?s=128&g=1", "display_name": "gabry", "link": "https://stackoverflow.com/users/1563037/gabry"}, "edited": false, "score": 0, "creation_date": 1484986910, "post_id": 41723435, "comment_id": 70745235, "body": "@gabry, can you show me specifically then how you could avoid this problem? I believe using const char* would be way more efficient for larger number of records than std:string. Pls. correctmeif i am wrong. Any sample example would be great."}], "answers": [{"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1484754240, "post_id": 41723498, "comment_id": 70641866, "body": "There may even be UB here because the copy constructor is not a <code>const</code> member function, invalidating the result of <code>.c_str()</code>. I wouldn&#39;t really expect a difference in behaviour here but it may help explain why observable behaviour is being changed apparently due to a copy-elision optimisation. Doesn&#39;t really matter anyway. Like I said, just don&#39;t do it!"}, {"owner": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "edited": false, "score": 0, "creation_date": 1484754267, "post_id": 41723498, "comment_id": 70641880, "body": "Thanks, it makes sense. However, could you tell me why would there be inconsistent behavior across different compiler versions (as specified above)?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "edited": false, "score": 1, "creation_date": 1484754325, "post_id": 41723498, "comment_id": 70641922, "body": "@Sammy: I could probably work it out exactly but I&#39;m not inclined to spend time on it because there is no value in doing so. Perhaps someone else has more time to spare :)"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "edited": false, "score": 0, "creation_date": 1484754424, "post_id": 41723498, "comment_id": 70641994, "body": "@Sammy I bet it depends if actual copy is created or eliminated by optimization. But it is pretty much useless to find exact reason."}, {"owner": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "edited": false, "score": 0, "creation_date": 1484754429, "post_id": 41723498, "comment_id": 70641996, "body": "Ok, so basically what you are trying to suggest is to use non-pointer type for the &#39;key field&#39;. Using a pointer for the key field is not a good practice. Am I right? The value field however could be a pointer."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "edited": false, "score": 2, "creation_date": 1484754476, "post_id": 41723498, "comment_id": 70642025, "body": "@Sammy: Even having a pointer in the value field is suspicious in many cases (and sometimes you do want a pointer in the key field, when it is actually pointers that you want to map) but, yes, that&#39;s basically right. I can&#39;t think of a valid use case for putting the result of <code>std::string::c_str()</code> in a container at all."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "edited": false, "score": 1, "creation_date": 1484754528, "post_id": 41723498, "comment_id": 70642057, "body": "@Sammy read answer of duplicate, you can use pointer with proper comparator. But your code is dangerous - you insert pointer of local object into global map."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1484754540, "post_id": 41723498, "comment_id": 70642066, "body": "Yes but don&#39;t.."}, {"owner": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "edited": false, "score": 0, "creation_date": 1484755126, "post_id": 41723498, "comment_id": 70642458, "body": "@ Lightness Races in Orbit: Thanks for the insight. This mostly does answer my question. However, just curious to see if someone does get hands-on why there is this consistently &#39;inconsistent&#39; compiler behavior. I will then mark the question as answered ;)"}, {"owner": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "edited": false, "score": 1, "creation_date": 1484758067, "post_id": 41723498, "comment_id": 70644538, "body": "Well found and answered by @gabry:\t  &quot;The fact it works on gcc &lt; 5.x is due to the std::string implementation of gcc (up to 5.x as you found), GCC used to alloc a single buffer and share it between all the strings that used it until one of the strings change ( copy on write), newer gcc versions, to comply to c++ 11 standard moved to an std::string based on the small string optimization.&quot;"}, {"owner": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "edited": false, "score": 0, "creation_date": 1484758167, "post_id": 41723498, "comment_id": 70644620, "body": "Marked as answered. Thanks LightnessRacesinOrbit and @gabry for best answers.."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 4, "last_activity_date": 1484754073, "creation_date": 1484754073, "answer_id": 41723498, "question_id": 41723435, "link": "https://stackoverflow.com/questions/41723435/strange-behavior-in-c-with-different-compiler-versions-string-pass-by-referen/41723498#41723498", "title": "Strange behavior in C++ with different compiler versions (String pass by reference): See simple program illustration", "body": "<p>You're putting pointers in a map and trying to match them to other pointers. This only compares the \"memory address\" held by those pointers; it does not compare the things that they point to (i.e. your string data).</p>\n\n<p>When your pointers are pointers to the data from a single <code>std::string</code>, odds are good that they are the same pointers (because the data is in the same place). However, when your pointers are to different strings, the odds of that are very small.</p>\n\n<p>Don't put <code>char</code> pointers in maps. Compare actual strings instead.</p>\n"}], "owner": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 1, "closed_date": 1484754080, "accepted_answer_id": 41723498, "answer_count": 1, "score": 0, "last_activity_date": 1484754132, "creation_date": 1484753888, "last_edit_date": 1484754132, "question_id": 41723435, "link": "https://stackoverflow.com/questions/41723435/strange-behavior-in-c-with-different-compiler-versions-string-pass-by-referen", "closed_reason": "Duplicate", "title": "Strange behavior in C++ with different compiler versions (String pass by reference): See simple program illustration", "body": "<p>I am facing some strange problem in C++ execution. My project is big where I have used pass by reference in several places but I am showing you a sample of the issue you can test easily.</p>\n\n<p>I wrote this simple program and tested it below under GCC version: v4.9.2 and v5.4.0. I get different behavior esp. when passing std::string with and without reference. In this program, I simply add two entries to a map and find the value for a key. The problem is with map::find(..). I expect consistent behavior irrespective of any gcc compiler version used.</p>\n\n<blockquote>\n  <p>GCC version: 4.9.2 output: FOUND, FOUND (tested on Raspberry Pi3, <a href=\"http://cpp.sh\" rel=\"nofollow noreferrer\">http://cpp.sh</a>)</p>\n  \n  <p>GCC version: 5.4.0 output: NOT FOUND, FOUND (tested on Ubuntu v16.04)</p>\n</blockquote>\n\n<p>Why is such a case? Is there something wrong with the program or is that a compiler bug somewhere? The program below should compile as is.</p>\n\n<pre><code>// program.cpp\n// Compile using: \"g++ -o program program.cpp\"\n\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;map&gt;\n#include &lt;stdio.h&gt;\nusing namespace std;\n\nstd::map&lt;const char*,int&gt; mymap;\n\nbool FindWithoutPassByRef(const std::string id_)\n{\n    const char* id = id_.c_str();\n\n    std::map&lt;const char*, int&gt;::iterator it;\n    it = mymap.find(id);\n\n    if (it != mymap.end())\n    {\n        cout &lt;&lt;\"FOUND\";\n        return true;\n    }\n\n    cout &lt;&lt;\"NOT FOUND\";\n    return false;\n}\n\nbool FindWithPassByRef(const std::string&amp; id_)\n{\n    const char* id = id_.c_str();\n\n    std::map&lt;const char*, int&gt;::iterator it;\n    it = mymap.find(id);\n\n    if (it != mymap.end())\n    {\n        cout &lt;&lt;\"\\nFOUND\";\n        return true;\n    }\n\n    cout &lt;&lt;\"\\nNOT FOUND\";\n    return false;\n}\n\nint main(int argc, char *argv[])\n{\n    printf(\"gcc version: %d.%d.%d\\n\",__GNUC__,__GNUC_MINOR__,__GNUC_PATCHLEVEL__);\n\n    const std::string key1 = \"key1\";\n    const std::string key2 = \"key2\";\n\n    mymap[key1.c_str()] = 50;\n    mymap[key2.c_str()] = 60;\n\n    FindWithoutPassByRef(key1); // should print FOUND\n    FindWithPassByRef(key1);    // should print FOUND\n\n    cout&lt;&lt; endl;\n}\n</code></pre>\n\n<p>I would have expected FOUND and FOUND under any gcc compiler.\nSee the example running fine under GCC v4.9.2 <a href=\"http://cpp.sh/9dn6a\" rel=\"nofollow noreferrer\">here</a> or add the above code on <a href=\"http://cpp.sh\" rel=\"nofollow noreferrer\">cpp.sh</a> (uses v4.9.2). For compiler v5.4.0, you can test this on Ubuntu or elsewhere appropriately.</p>\n"}, {"tags": ["c++", "clang++", "designated-initializer"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1484754153, "post_id": 41723401, "comment_id": 70641812, "body": "g++ thorws <i>sorry, unimplemented: non-trivial designated initializers not supported</i>.  Clang might not support it as well but instead of issuing an error it just drops the code."}, {"owner": {"reputation": 1556, "user_id": 552014, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/4535212e0091c28607319e01fbef96f8?s=128&d=identicon&r=PG", "display_name": "Alexei Averchenko", "link": "https://stackoverflow.com/users/552014/alexei-averchenko"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484756211, "post_id": 41723401, "comment_id": 70643203, "body": "@NathanOliver clang&#39;s attitude towards UB and things not in the standard: <a href=\"http://i3.kym-cdn.com/photos/images/newsfeed/001/012/861/520.jpg\" rel=\"nofollow noreferrer\">i3.kym-cdn.com/photos/images/newsfeed/001/012/861/520.jpg</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 1556, "user_id": 552014, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/4535212e0091c28607319e01fbef96f8?s=128&d=identicon&r=PG", "display_name": "Alexei Averchenko", "link": "https://stackoverflow.com/users/552014/alexei-averchenko"}, "edited": false, "score": 0, "creation_date": 1484756294, "post_id": 41723401, "comment_id": 70643273, "body": "@AlexeiAverchenko LMAO.  I think  that how most compilers behave."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1484758093, "post_id": 41723401, "comment_id": 70644555, "body": "@NathanOliver: I think that at least a diagnostic should be issued because it is incorrect syntax according to the standard and it is not a <b>supported</b> extension either, because the generated code discards the offending lines."}], "answers": [{"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 3, "last_activity_date": 1484757910, "last_edit_date": 1484757910, "creation_date": 1484757115, "answer_id": 41724629, "question_id": 41723401, "link": "https://stackoverflow.com/questions/41723401/clang-can-remove-function-call-when-order-of-designated-initializers-does-not-co/41724629#41724629", "title": "clang can remove function call when order of designated initializers does not correspond to fields declaration", "body": "<p>I think that is at least unfair if not a bug, because the warning is only at pedandic level when Clang simply removes all references to <code>foo</code> in function <code>nocall</code>. We can confirm it by looking at assembly code in debug mode (<code>c++ -S -g file.cpp</code>) to see exactly how the compiler interprets each and every line.</p>\n\n<p>When we look at the .s genererated file, we can see that in call, lines 20 <code>Foo foo = {...</code> and 25 <code>printInfo(foo)</code> are generated:</p>\n\n<pre><code>    .loc    1 20 0                  # ess.cpp:20:0\n    movq    %rcx, -64(%rbp)\n    movq    -40(%rbp), %rcx\n.Ltmp45:\n    movq    %rcx, -56(%rbp)\n    .loc    1 24 0                  # ess.cpp:24:0\n    movq    %rax, %rdi\n    callq   _ZNSt3__1lsINS_11char_traitsIcEEEERNS_13basic_ostreamIcT_EES6_PKc\n    leaq    -64(%rbp), %rdi\n    leaq    _ZNSt3__14endlIcNS_11char_traitsIcEEEERNS_13basic_ostreamIT_T0_EES7_, %rcx\n    movq    %rax, -24(%rbp)\n    movq    %rcx, -32(%rbp)\n    movq    -24(%rbp), %rax\n    .loc    5 322 0                 # /usr/include/c++/v1/ostream:322:0\n.Ltmp46:\n    movq    %rdi, -72(%rbp)         # 8-byte Spill\n    movq    %rax, %rdi\n    callq   *-32(%rbp)\n.Ltmp47:\n    .loc    1 25 0                  # ess.cpp:25:0\n    movq    -72(%rbp), %rdi         # 8-byte Reload\n    movq    %rax, -80(%rbp)         # 8-byte Spill\n    callq   _Z9printInfoRK3Foo\n    leaq    _ZNSt3__14coutE, %rdi\n    leaq    .L.str2, %rsi\n</code></pre>\n\n<p>But for nocall, the corresponding lines (30 and 35) are not:</p>\n\n<pre><code>    .loc    1 29 0 prologue_end     # ess.cpp:29:0\n.Ltmp57:\n    movl    .L_ZZ6noCallR3BuuE3acc, %ecx\n    movl    %ecx, -48(%rbp)\n    .loc    1 34 0                  # ess.cpp:34:0\n    movq    %rax, %rdi\n    callq   _ZNSt3__1lsINS_11char_traitsIcEEEERNS_13basic_ostreamIcT_EES6_PKc\n    leaq    _ZNSt3__14coutE, %rdi\n    leaq    .L.str2, %rsi\n    leaq    _ZNSt3__14endlIcNS_11char_traitsIcEEEERNS_13basic_ostreamIT_T0_EES7_, %rdx\n    movq    %rax, -24(%rbp)\n    movq    %rdx, -32(%rbp)\n    movq    -24(%rbp), %rax\n    .loc    5 322 0                 # /usr/include/c++/v1/ostream:322:0\n.Ltmp58:\n    movq    %rdi, -72(%rbp)         # 8-byte Spill\n    movq    %rax, %rdi\n    movq    %rsi, -80(%rbp)         # 8-byte Spill\n    callq   *-32(%rbp)\n.Ltmp59:\n    .loc    1 36 0                  # ess.cpp:36:0\n    movq    -72(%rbp), %rdi         # 8-byte Reload\n    movq    -80(%rbp), %rsi         # 8-byte Reload\n    movq    %rax, -88(%rbp)         # 8-byte Spill\n    callq   _ZNSt3__1lsINS_11char_traitsIcEEEERNS_13basic_ostreamIcT_EES6_PKc\n    leaq    _ZNSt3__14endlIcNS_11char_traitsIcEEEERNS_13basic_ostreamIT_T0_EES7_, %rdx\n    movq    %rax, -8(%rbp)\n    movq    %rdx, -16(%rbp)\n    movq    -8(%rbp), %rdi\n    .loc    5 322 0                 # /usr/include/c++/v1/ostream:322:0\n.Ltmp60:\n    callq   *-16(%rbp)\n.Ltmp61:\n    .loc    1 37 0                  # ess.cpp:37:0\n</code></pre>\n\n<p>Where the numbered lines in the cpp file are:   </p>\n\n<pre><code>18  void call( Buu&amp; buu ) {\n19      Acc acc = { 1 };\n20      Foo foo = {\n21          .acc = acc,\n22          .buu = buu,\n23      };\n24      std::cout &lt;&lt; \"before\" &lt;&lt; std::endl;\n25      printInfo( foo );\n26      std::cout &lt;&lt; \"after\" &lt;&lt; std::endl;\n27  }\n28  void noCall( Buu&amp; buu ) {\n29      Acc acc = { 1 };\n30      Foo foo = {\n31              .buu = buu,\n32              .acc = acc\n33      };\n34      std::cout &lt;&lt; \"before\" &lt;&lt; std::endl;\n35      printInfo( foo );\n36      std::cout &lt;&lt; \"after\" &lt;&lt; std::endl;\n37  }\n</code></pre>\n\n<p>My understanding is that clang pretends to process the C99 syntax in C++ mode when it does not.</p>\n\n<hr>\n\n<p>IMHO, this is a bug that could be reported to clang, because at least a diagnostic should be issued per 1.4 Implementation compliance [intro.compliance]</p>\n\n<blockquote>\n  <p>1 <strong>The set of diagnosable rules consists of all syntactic and semantic rules in this International Standard</strong> except\n  for those rules containing an explicit notation that \u201cno diagnostic is required\u201d or which are described as\n  resulting in \u201cundefined behavior.\u201d\n  <br/>2 Although this International Standard states only requirements on C++ implementations, those requirements\n  are often easier to understand if they are phrased as requirements on programs, parts of programs, or\n  execution of programs. Such requirements have the following meaning:</p>\n  \n  <ul>\n  <li>If a program contains no violations of the rules in this International Standard, a conforming implementation\n  shall, within its resource limits, accept and correctly execute2 that program.</li>\n  <li>If a program contains <strong>a violation of any diagnosable rule</strong> or an occurrence of a construct described in\n  this Standard as \u201cconditionally-supported\u201d when the implementation does not support that construct,\n  <strong>a conforming implementation shall issue at least one diagnostic message</strong>.</li>\n  </ul>\n  \n  <p>...<br/>8 A conforming implementation may have extensions (including additional library functions), provided they do\n  not alter the behavior of any well-formed program. <strong>Implementations are required to diagnose programs that\n  use such extensions that are ill-formed</strong> according to this International Standard. Having done so, however,\n  they can compile and execute such programs.</p>\n</blockquote>\n"}], "owner": {"reputation": 33, "user_id": 7436383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b6aa4d4d0c9dcaa3f4968cf25b46ab8?s=128&d=identicon&r=PG&f=1", "display_name": "Petr Manokhin", "link": "https://stackoverflow.com/users/7436383/petr-manokhin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 1, "accepted_answer_id": 41724629, "answer_count": 1, "score": 3, "last_activity_date": 1484757910, "creation_date": 1484753803, "last_edit_date": 1484754098, "question_id": 41723401, "link": "https://stackoverflow.com/questions/41723401/clang-can-remove-function-call-when-order-of-designated-initializers-does-not-co", "title": "clang can remove function call when order of designated initializers does not correspond to fields declaration", "body": "<p>this code:</p>\n\n<pre><code>#include &lt;iostream&gt;\nstruct Acc {\n    int a;\n};\nstruct Buu {\n    int b;\n};\n\nstruct Foo {\n    const Acc&amp; acc;\n    Buu&amp; buu;\n};\n\nvoid printInfo( const Foo&amp; ) {\n    std::cout &lt;&lt; \"hi!\" &lt;&lt; std::endl;\n}\n\nvoid call( Buu&amp; buu ) {\n    Acc acc = { 1 };\n    Foo foo = {\n        .acc = acc,\n        .buu = buu,\n    };\n    std::cout &lt;&lt; \"before\" &lt;&lt; std::endl;\n    printInfo( foo );\n    std::cout &lt;&lt; \"after\" &lt;&lt; std::endl;\n}\nvoid noCall( Buu&amp; buu ) {\n    Acc acc = { 1 };\n    Foo foo = {\n        .buu = buu,\n        .acc = acc,\n    };\n    std::cout &lt;&lt; \"before\" &lt;&lt; std::endl;\n    printInfo( foo );\n    std::cout &lt;&lt; \"after\" &lt;&lt; std::endl;\n}\n\nint main() {\n    Buu buu = { 2 };\n    call( buu );\n    noCall( buu );\n    return 0;\n}\n</code></pre>\n\n<p>when compliled by clang (I tried 3.7.0, 3.7.1) will out:</p>\n\n<pre><code>before\nhi!\nafter\nbefore\nafter\n</code></pre>\n\n<p>The second call of <code>printInfo</code> was removed... Difference between <code>call</code> and <code>noCall</code> only in order of designated initializers.</p>\n\n<p>With <code>-pedantic</code> option it will produce warnings that designated initializers is the feature of C99 but not C++ but still create code without the second call of <code>printInfo</code>.</p>\n\n<p>Is it known bug?</p>\n"}, {"tags": ["c++", "qt", "sockets", "networking", "boost-asio"], "comments": [{"owner": {"reputation": 63, "user_id": 7272199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kSnOh.jpg?s=128&g=1", "display_name": "jmatthieu", "link": "https://stackoverflow.com/users/7272199/jmatthieu"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1484756322, "post_id": 41723231, "comment_id": 70643295, "body": "@molbdnilo well a float is 4 bytes and a vector of two floats is 8 bytes, and see <a href=\"http://stackoverflow.com/a/22869206/7272199\">stackoverflow.com/a/22869206/7272199</a> . My understanding is that there is no serialization going on here, am I right ?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1484758315, "post_id": 41723231, "comment_id": 70644737, "body": "@molbdnilo yes it is (IOW asio does not <i>have</i> a serialization format, that&#39;s your job)"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 7272199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kSnOh.jpg?s=128&g=1", "display_name": "jmatthieu", "link": "https://stackoverflow.com/users/7272199/jmatthieu"}, "edited": false, "score": 0, "creation_date": 1484758177, "post_id": 41723786, "comment_id": 70644625, "body": "I get huge non-sense values for my floats using this, so asio might mess with the endianness"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1484758367, "post_id": 41723786, "comment_id": 70644776, "body": "The send method on the asio side is as lowlevel as it gets! It&#39;s bitwise serialization. It does <i>not</i> meddle with endianness."}, {"owner": {"reputation": 63, "user_id": 7272199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kSnOh.jpg?s=128&g=1", "display_name": "jmatthieu", "link": "https://stackoverflow.com/users/7272199/jmatthieu"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1484758678, "post_id": 41723786, "comment_id": 70645000, "body": "@sehe would you have any clue of what is going on there ?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1484758734, "post_id": 41723786, "comment_id": 70645030, "body": "I&#39;d surely be writing answers then. Maybe if you can present a SSCCE client/server (I&#39;ll even install Qt for you)"}, {"owner": {"reputation": 63, "user_id": 7272199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kSnOh.jpg?s=128&g=1", "display_name": "jmatthieu", "link": "https://stackoverflow.com/users/7272199/jmatthieu"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1484762338, "post_id": 41723786, "comment_id": 70647079, "body": "@sehe I managed to work it out, writing my own conversion functions. thanks to both of you"}], "tags": [], "owner": {"reputation": 1178, "user_id": 1563037, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vhb7A.png?s=128&g=1", "display_name": "gabry", "link": "https://stackoverflow.com/users/1563037/gabry"}, "is_accepted": false, "score": 0, "last_activity_date": 1484754903, "creation_date": 1484754903, "answer_id": 41723786, "question_id": 41723231, "link": "https://stackoverflow.com/questions/41723231/send-stdvectorfloat-over-tcp-from-boostasio-to-qtcpsocket/41723786#41723786", "title": "Send std::vector&lt;float&gt; over TCP, from boost::asio to QTcpSocket", "body": "<p>I think it's a bad idea to use high level send method server side (you try to send a c++ vector) and low level client side.</p>\n\n<p>I'm quite sure there is an endianness problem somewhere.</p>\n\n<p>Anyway try to do this client side:</p>\n\n<pre><code>char buffer[FLOATSIZE];\nbytes = m_in.readRawData(buffer, FLOATSIZE);    \n\nif (bytes != FLOATSIZE) \n     return ERROR;\n\nconst float f = (float)(ntohl(*((int32_t *)buffer)));\n</code></pre>\n\n<p>If boost::asio uses the network byte order for the floats (as it should), this will work.</p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 7272199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kSnOh.jpg?s=128&g=1", "display_name": "jmatthieu", "link": "https://stackoverflow.com/users/7272199/jmatthieu"}, "is_accepted": true, "score": 1, "last_activity_date": 1484817881, "last_edit_date": 1495541805, "creation_date": 1484762202, "answer_id": 41726262, "question_id": 41723231, "link": "https://stackoverflow.com/questions/41723231/send-stdvectorfloat-over-tcp-from-boostasio-to-qtcpsocket/41726262#41726262", "title": "Send std::vector&lt;float&gt; over TCP, from boost::asio to QTcpSocket", "body": "<p>I managed to resolve the issue, by editing the <code>Qt</code> side (client), to read the socket:</p>\n\n<pre><code>uint availbytes = m_socket-&gt;bytesAvailable();\nwhile (availbytes &gt;= 4)\n{\n    char buffer[FLOATSIZE];\n    nbytes = m_in.readRawData(buffer, FLOATSIZE);    \n    float f = bytes2float(buffer);\n    availbytes = m_socket-&gt;bytesAvailable();\n}\n</code></pre>\n\n<p>I use those two conversion functions, <code>bytes2float</code> and <code>bytes2int</code>:</p>\n\n<pre><code>float bytes2float(char* buffer)\n{\n    union {\n        float f;\n        uchar b[4];\n    } u;\n\n    u.b[3] = buffer[3];\n    u.b[2] = buffer[2];\n    u.b[1] = buffer[1];\n    u.b[0] = buffer[0];\n\n    return u.f;\n}\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>int bytes2int(char* buffer)\n{\n    int a = int((unsigned char)(buffer[3]) &lt;&lt; 24 |\n        (unsigned char)(buffer[2]) &lt;&lt; 16 |\n        (unsigned char)(buffer[1]) &lt;&lt; 8 |\n        (unsigned char)(buffer[0]));\n    return a;\n}\n</code></pre>\n\n<p>I also found that function to display bytes, which is useful to see what is going on behind the scene (from <a href=\"https://stackoverflow.com/a/16063757/7272199\">https://stackoverflow.com/a/16063757/7272199</a>):</p>\n\n<pre><code>template &lt;typename T&gt;\nvoid print_bytes(const T&amp; input, std::ostream&amp; os = std::cout)\n{\n  const unsigned char* p = reinterpret_cast&lt;const unsigned char*&gt;(&amp;input);\n  os &lt;&lt; std::hex &lt;&lt; std::showbase;\n  os &lt;&lt; \"[\";\n  for (unsigned int i=0; i&lt;sizeof(T); ++i)\n    os &lt;&lt; static_cast&lt;int&gt;(*(p++)) &lt;&lt; \" \";\n  os &lt;&lt; \"]\" &lt;&lt; std::endl;;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 7272199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kSnOh.jpg?s=128&g=1", "display_name": "jmatthieu", "link": "https://stackoverflow.com/users/7272199/jmatthieu"}, "edited": false, "score": 0, "creation_date": 1484817956, "post_id": 41729063, "comment_id": 70669427, "body": "I edited my answer so it is clearer. Yes everything runs on the same PC/compiler. Thank you for your input it helps me understand better what is going on, I will have a look at boost endian to improve my code"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": false, "score": 1, "last_activity_date": 1484776021, "last_edit_date": 1495540916, "creation_date": 1484772113, "answer_id": 41729063, "question_id": 41723231, "link": "https://stackoverflow.com/questions/41723231/send-stdvectorfloat-over-tcp-from-boostasio-to-qtcpsocket/41729063#41729063", "title": "Send std::vector&lt;float&gt; over TCP, from boost::asio to QTcpSocket", "body": "<p>Re. <a href=\"https://stackoverflow.com/a/41726262/85371\">your answer</a>: Which side is this on? Also, are your platforms not the same (OS/architecture?). I had assumed from the question that both processes run on the same PC and compiler etc. </p>\n\n<p>For one thing, you can see that <a href=\"http://coliru.stacked-crooked.com/a/05f8f1cb2de51536\" rel=\"nofollow noreferrer\">ASIO does <strong>not</strong> do anything related to endianness</a>. </p>\n\n<pre><code>#include &lt;boost/asio.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\nnamespace asio = boost::asio;\n\n#include &lt;iostream&gt;\n\nvoid print_bytes(unsigned char const* b, unsigned char const* e)\n{\n    std::cout &lt;&lt; std::hex &lt;&lt; std::setfill('0') &lt;&lt; \"[ \";\n    while (b!=e)\n        std::cout &lt;&lt; std::setw(2) &lt;&lt; static_cast&lt;int&gt;(*b++) &lt;&lt; \" \";\n    std::cout &lt;&lt; \"]\\n\";\n}\n\ntemplate &lt;typename T&gt; void print_bytes(const T&amp; input) {\n    using namespace std;\n    print_bytes(reinterpret_cast&lt;unsigned char const*&gt;(std::addressof(*begin(input))), \n                reinterpret_cast&lt;unsigned char const*&gt;(std::addressof(*end(input))));\n}\n\nint main() {\n    float const fs[] { 1.2, 8.5 };\n    std::cout &lt;&lt; \"fs:     \"; print_bytes(fs);\n\n    {\n        std::vector&lt;float&gt; gs(2);\n        asio::buffer_copy(asio::buffer(gs), asio::buffer(fs));\n\n        for (auto g : gs) std::cout &lt;&lt; g &lt;&lt; \" \"; std::cout &lt;&lt; \"\\n\";\n        std::cout &lt;&lt; \"gs:     \"; print_bytes(gs);\n    }\n    {\n        std::vector&lt;char&gt; binary(2*sizeof(float));\n        asio::buffer_copy(asio::buffer(binary), asio::buffer(fs));\n        std::cout &lt;&lt; \"binary: \"; print_bytes(binary);\n\n        std::vector&lt;float&gt; gs(2);\n        asio::buffer_copy(asio::buffer(gs), asio::buffer(binary));\n\n        for (auto g : gs) std::cout &lt;&lt; g &lt;&lt; \" \"; std::cout &lt;&lt; \"\\n\";\n        std::cout &lt;&lt; \"gs:     \"; print_bytes(gs);\n    }\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>fs:     [ 9a 99 99 3f 00 00 08 41 ]\n1.2 8.5 \ngs:     [ 9a 99 99 3f 00 00 08 41 ]\nbinary: [ 9a 99 99 3f 00 00 08 41 ]\n1.2 8.5 \ngs:     [ 9a 99 99 3f 00 00 08 41 ]\n</code></pre>\n\n<h2>Theory</h2>\n\n<p>I suspect the Qt side ruins things. Since the naming of the function <code>readRawData</code> certainly implies a lack of endianness awareness, I'd guess your system's endianness wreaks havoc (<a href=\"https://stackoverflow.com/a/2945192/85371\">https://stackoverflow.com/a/2945192/85371</a>, also the comment). </p>\n\n<h2>Suggestion</h2>\n\n<p>In that case, consider using Boost Endian.</p>\n"}], "owner": {"reputation": 63, "user_id": 7272199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kSnOh.jpg?s=128&g=1", "display_name": "jmatthieu", "link": "https://stackoverflow.com/users/7272199/jmatthieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 737, "favorite_count": 0, "accepted_answer_id": 41726262, "answer_count": 3, "score": 1, "last_activity_date": 1484818047, "creation_date": 1484753294, "last_edit_date": 1484818047, "question_id": 41723231, "link": "https://stackoverflow.com/questions/41723231/send-stdvectorfloat-over-tcp-from-boostasio-to-qtcpsocket", "title": "Send std::vector&lt;float&gt; over TCP, from boost::asio to QTcpSocket", "body": "<p>The server needs to send a <code>std::vector&lt;float&gt;</code> to a <code>Qt</code> application over a TCP socket. I am using Qt 5.7.</p>\n\n<p>On the server side, using <code>boost::asio</code>:</p>\n\n<pre><code>std::vector&lt;float&gt; message_ = {1.2, 8.5};\nasio::async_write(socket_, asio::buffer&lt;float&gt;(message_),\n    [this, self](std::error_code ec, std::size_t)\n</code></pre>\n\n<p>This works and I manage to get it back on my client using <code>boost::asio</code>'s <code>read_some()</code>. As both <code>Qt</code> and <code>asio</code> have their own event manager, I want to avoid using <code>asio</code> in my <code>Qt</code> app.</p>\n\n<p>So on the client side I have (which does not work):</p>\n\n<p>client.h:</p>\n\n<pre><code>#define FLOATSIZE 4\nQTcpSocket *m_socket;\nQDataStream m_in;\nQString *m_string;\nQByteArray m_buff;\n</code></pre>\n\n<p>client.cpp (constructor):</p>\n\n<pre><code>m_in.setDevice(m_socket);\nm_in.setFloatingPointPrecision(QDataStream::SinglePrecision);\n// m_in.setByteOrder(QDataStream::LittleEndian);\n</code></pre>\n\n<p>client.cpp (read function, which is connected via <code>QObject::connect(m_socket, &amp;QIODevice::readyRead, this, &amp;mywidget::ask2read);</code> ):</p>\n\n<pre><code>uint availbytes = m_socket-&gt;bytesAvailable(); // which is 8, so that seems good\nwhile (availbytes &gt;= FLOATSIZE)\n{\n    nbytes = m_in.readRawData(m_buff.data(), FLOATSIZE);\n\n    bool conv_ok = false;\n    const float f = m_buff.toFloat(&amp;conv_ok);\n\n    availbytes = m_socket-&gt;bytesAvailable();\n\n    m_buff.clear();\n}\n</code></pre>\n\n<p>The <code>m_buff.toFloat()</code> call returns <code>0.0</code> which is a fail according to the Qt doc. I have tried to change the float precision, little or big endian, but I can not manage to get my <code>std::vector&lt;float&gt;</code> back. Any hints?</p>\n\n<p>Edit: everything runs on the same PC/compiler.</p>\n\n<p>Edit: see my answer for a solution and sehe's for more detail on what is going on</p>\n"}, {"tags": ["c++", "direct2d"], "comments": [{"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1484753750, "post_id": 41723208, "comment_id": 70641522, "body": "Should the bitmap even exist when this call happens? Not enough info to really help, but I would if check them, and if you&#39;re tesing and actively want it to crash to get more info then assert <code>context</code> and <code>btimap</code>."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1484754085, "post_id": 41723208, "comment_id": 70641757, "body": "@George: If <code>context</code> is a <code>nullptr</code>, you wouldn&#39;t get a COM <code>HRESULT</code> error. You&#39;d trigger an SEH exception instead."}], "owner": {"reputation": 253, "user_id": 1721250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3250e1f154c4f3494681184dd5f57abe?s=128&d=identicon&r=PG", "display_name": "pdondziak", "link": "https://stackoverflow.com/users/1721250/pdondziak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484753216, "creation_date": 1484753216, "question_id": 41723208, "link": "https://stackoverflow.com/questions/41723208/direct2d-attempt-to-access-invalid-address-error-on-enddraw", "title": "Direct2D &quot;Attempt to access invalid address error&quot; on EndDraw", "body": "<p>Users of our application experience intermittent bug where ID2D1RenderTarget::EndDraw returns an HRRESULT 0x800701E7 which means \"Attempt to access invalid address error\". Using EndDraw tags we did pinned down the drawing operation that is causing the error using which is simple:</p>\n\n<pre><code>context-&gt;DrawImage(bitmap, offsetPoint, imageRectangle);\n</code></pre>\n\n<p>The problem is that we are not able to reproduce the error even if we are really trying by deleting the bitmap after drawing operation. It looks like Direct2D maintains it's own copy for drawing. Does anybody experience the same error and know how to cause it?</p>\n"}, {"tags": ["c++", "string", "function", "recursion", "palindrome"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1484752826, "post_id": 41723077, "comment_id": 70640832, "body": "It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming.  Further reading: <b><a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a></b>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1484753004, "post_id": 41723077, "comment_id": 70640972, "body": "There are paths in your <code>testPalindrome</code> that doesn&#39;t return anything. That leads to <i>undefined behavior</i>. A good compiler should have shouted warnings at you for it."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1484753057, "post_id": 41723077, "comment_id": 70641013, "body": "Please be more specific than &quot;not working&quot;. There are countless ways that a program can &quot;not work&quot;."}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 2, "creation_date": 1484753131, "post_id": 41723077, "comment_id": 70641072, "body": "Why don&#39;t you compile with warnings turned on? <code>main.cpp:16:1: warning: control may reach end of non-void function</code> should help you."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1484760285, "post_id": 41723077, "comment_id": 70645999, "body": "You must have forgot to read the accepted answer to that other question, since you reproduced exactly the same problem."}], "answers": [{"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 6, "last_activity_date": 1484752994, "creation_date": 1484752994, "answer_id": 41723134, "question_id": 41723077, "link": "https://stackoverflow.com/questions/41723077/find-palindrome/41723134#41723134", "title": "Find Palindrome", "body": "<p>You need to return the result of the recursive call, just like when you call any other function.</p>\n\n<p>If you don't, the behaviour is undefined.</p>\n"}, {"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 2, "last_activity_date": 1484756929, "last_edit_date": 1484756929, "creation_date": 1484753770, "answer_id": 41723392, "question_id": 41723077, "link": "https://stackoverflow.com/questions/41723077/find-palindrome/41723392#41723392", "title": "Find Palindrome", "body": "<p>I think you forgot the return statement in the function</p>\n\n<pre><code>    if (first&lt;last)\n        return testPalindrome(pal,last-1,first+1);\n        ^^^^^^^\n</code></pre>\n\n<p>Usually the first parameter of a range specifies the lower value and the second parameter specifies either the upper value of the range that is not included in the range or the number of elements in the sequence..</p>\n\n<p>And the first parameter should be declared as having constant reference type because the string itself is not changed and you will escape additional memory allocation.</p>\n\n<p>The recursive function can be written like</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nbool testPalindrome(const std::string &amp;s,\n    std::string::size_type i,\n    std::string::size_type n)\n{\n    return n &lt; 2 || (s[i] == s[n-1] &amp;&amp; testPalindrome(s, i + 1, n - 2) );\n}\n\nint main()\n{\n    std::cout &lt;&lt; testPalindrome(\"abba\", 0, 4) &lt;&lt; std::endl;\n    std::cout &lt;&lt; testPalindrome(\"aba\", 0, 3) &lt;&lt; std::endl;\n    std::cout &lt;&lt; testPalindrome(\"aa\", 0, 2) &lt;&lt; std::endl;\n    std::cout &lt;&lt; testPalindrome(\"a\", 0, 1) &lt;&lt; std::endl;\n    std::cout &lt;&lt; testPalindrome(\"ab\", 0, 2) &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>1\n1\n1\n1\n0\n</code></pre>\n\n<p>The simplest way to check whether an object of the type <code>std::string</code> is a palindrome is to write the expression</p>\n\n<pre><code>s == std::string( s.rbegin(), s.rend() )\n</code></pre>\n"}], "owner": {"reputation": 1543, "user_id": 5661319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pgZ8b.jpg?s=128&g=1", "display_name": "eylay", "link": "https://stackoverflow.com/users/5661319/eylay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "accepted_answer_id": 41723392, "answer_count": 2, "score": -2, "last_activity_date": 1484764269, "creation_date": 1484752805, "last_edit_date": 1495541336, "question_id": 41723077, "link": "https://stackoverflow.com/questions/41723077/find-palindrome", "title": "Find Palindrome", "body": "<p>I want to find Palindrome of a word. Whats Wrong Here?  </p>\n\n<p>main function: </p>\n\n<pre><code>  int size;\n  string input;\n  cin&gt;&gt;input;\n  size = input.length();  \n  if(testPalindrome(input,size-1,0))\n    cout&lt;&lt;\"It's Palindrome\";\n  else\n    cout&lt;&lt;\"It's not Palindrome\";\n</code></pre>\n\n<p>And the testPalindrome function is: </p>\n\n<pre><code>bool testPalindrome (string pal , int last, int first){\n\n    if (pal[first] != pal[last])\n        return false;\n    else{\n        if (first&lt;last)\n            testPalindrome(pal,last-1,first+1);\n        else\n            return true;\n    }\n}\n</code></pre>\n\n<p>I have read <a href=\"https://stackoverflow.com/questions/22890946/finding-a-string-palindrome-with-a-recursive-function\">this link</a> and found the answer for determining Palindromes, but why this one is not working?</p>\n"}, {"tags": ["c++", "winapi", "shellexecute", "beginthread"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 3, "creation_date": 1484753598, "post_id": 41723033, "comment_id": 70641427, "body": "Pretty unlikely that you need a new thread. <code>ShellExecute</code> is asynchronous. It will return immediately. It won&#39;t block on the other process. If you are starting a new process, <code>CreateProcess</code> is usually preferable anyway. If you want to do it in a new thread, create a function with this signature <code>void( __cdecl *start_address )( void * )</code> that calls <code>ShellExecute</code>. Then pass that function to <code>_beginthread</code>. If you are using C++ then it would make more sense to use <code>std::thread</code> surely."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 2, "creation_date": 1484754482, "post_id": 41723033, "comment_id": 70642029, "body": "The only reason why you&#39;d ever want to run <code>ShellExecute</code> (or <code>ShellExecuteEx</code> really) in its own thread is, because you need to initialize COM on that thread and it may collide with the calling thread&#39;s apartment. However, you aren&#39;t even attempting to do that, so it&#39;s completely unclear, why you believe that you need to spin up a thread, and then block for it to finish executing. This doesn&#39;t implement anything useful."}], "answers": [{"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1484781199, "post_id": 41730135, "comment_id": 70656564, "body": "Both the <code>ThreadFunc</code> definition as well as the lambda function are missing the respective calling convention. What&#39;s more, this answer doesn&#39;t even question the necessity for spinning up a new thread, even though there is absolutely nothing in the question indicating, that this were beneficial."}, {"owner": {"reputation": 3413, "user_id": 306930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050d410352880572736fc85f30c170b8?s=128&d=identicon&r=PG", "display_name": "conio", "link": "https://stackoverflow.com/users/306930/conio"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1484782940, "post_id": 41730135, "comment_id": 70657113, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/zkwh89ks.aspx\" rel=\"nofollow noreferrer\"><code>_cdecl</code> is the default calling convention in MSVC</a>. I considrerd this to be common knowledge,but perhaps I was wrong. Though this wasn&#39;t states explicitly to be case, since OP is using a function from the MSVC CRT, I deduced him to be using MSVC or a compatible compiler and toolchain."}, {"owner": {"reputation": 3413, "user_id": 306930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050d410352880572736fc85f30c170b8?s=128&d=identicon&r=PG", "display_name": "conio", "link": "https://stackoverflow.com/users/306930/conio"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1484782991, "post_id": 41730135, "comment_id": 70657122, "body": "The answer doesn&#39;t question the necessity of creating a new thread for three reasons: (1) An <b>answer</b> is not the place for this, but rather the <b>comments</b> area, that indeed was already used for it; (2) It is irrelevant to the answer, and (3) OP stated that he &quot;need[s] to run for <b>example</b>: <code>ShellExecute(...)</code>&quot;. For example. Perhaps he really wants to run something else. Perhaps he runs various tasks, this being only one of them. That was an <b>example</b>. The generalized question, <b>disregarding the example</b>, was how to call a function on a new thread. This I answered."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1484792003, "post_id": 41730135, "comment_id": 70659541, "body": "@IInspectable: At least in VC++, and probably other compilers, when a captureless lambda is implicitly converted to a function pointer, it takes on whatever calling convention is needed (the compiler generates code for all calling conventions, and then the linker eliminates any unused code). See <a href=\"http://stackoverflow.com/questions/14845706/\">What&#39;s the default calling convention of a C++ lambda function?</a> and <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20150220-00/?p=44623\" rel=\"nofollow noreferrer\">Non-capturing C++ lambdas can be converted to a pointer to function, but what about the calling convention?</a>"}], "tags": [], "owner": {"reputation": 3413, "user_id": 306930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050d410352880572736fc85f30c170b8?s=128&d=identicon&r=PG", "display_name": "conio", "link": "https://stackoverflow.com/users/306930/conio"}, "is_accepted": false, "score": 3, "last_activity_date": 1485270297, "last_edit_date": 1592644375, "creation_date": 1484776429, "answer_id": 41730135, "question_id": 41723033, "link": "https://stackoverflow.com/questions/41723033/shellexecute-in-beginthread/41730135#41730135", "title": "ShellExecute in _beginthread", "body": "<p>What you tried is indeed obviously wrong, but the question is whether you understand what's wrong with it. <code>_beginthread</code> takes a <strong>pointer to function</strong> (with a specific prototype and calling convention) as its first parameter.</p>\n<p>When you write</p>\n<pre><code>HANDLE hThread = (HANDLE) _beginthread(ShellExecute(NULL, &quot;open&quot;, &quot;program.exe&quot;, NULL, NULL, SW_HIDE), 0, NULL);\n</code></pre>\n<p>you're trying to pass <code>_beginthread</code> the <strong>result</strong> of calling <code>ShellExecute</code> (in the current thread) which is an <code>HINSTANCE</code>, while <code>_beginthread</code> expects a <code>void( __cdecl *)( void * )</code> (pointer to a <code>__cdecl</code> function taking one <code>void*</code> parameter and returning <code>void</code>).</p>\n<p>Not only your code doesn't work because you're trying to pass an <code>HINSTANCE</code> where a function to pointer is expected, it doesn't make any sense. Have you read the <a href=\"https://msdn.microsoft.com/en-us/library/kdzttdcb.aspx\" rel=\"nofollow noreferrer\"><code>_beginthread</code> documentation</a>? There are examples there. Plural.</p>\n<p>What you meant to write is:</p>\n<pre><code>HANDLE hThread = (HANDLE) _beginthread(ThreadFunc, 0, NULL);\n</code></pre>\n<p>given:</p>\n<pre><code>void __cdecl ThreadFunc(void*) {\n    ShellExecute(NULL, &quot;open&quot;, &quot;program.exe&quot;, NULL, NULL, SW_HIDE);\n}\n</code></pre>\n<p>Or, in a more compact and easy to read form:</p>\n<pre><code>HANDLE hThread = (HANDLE)\n                 _beginthread([](void*) {\n                     ShellExecute(NULL, &quot;open&quot;, &quot;program.exe&quot;, NULL, NULL, SW_HIDE);\n                 },\n                 0, NULL);\n</code></pre>\n<p>Unless you're doing something beyong what we're seeing here, David'scomment is probably right and you should be using <code>std::thread</code> or <code>std::async</code>.</p>\n<p>Also note that taking the result of <code>_beginthread</code> (int contrast to the result of <code>_beginthreadex</code> or <code>CreateThread</code>) in unsafe because it may not be valid, as noted in the documentation. Not only that, but <code>_beginthread</code>'s return value isn't really a <code>HANDLE</code> (it is some sore of a handle, but not a <code>HANDLE</code>!), so you can't <code>WaitForSingleObject</code> on it:</p>\n<blockquote>\n<p>The <code>_beginthreadex</code> function gives you more control over how the thread is created than <code>_beginthread</code> does. The <code>_endthreadex</code> function is also more flexible. For example, with <code>_beginthreadex</code>, you can use security information, set the initial state of the thread (running or suspended), and get the thread identifier of the newly created thread. <strong>You can also use the thread handle that's returned by <code>_beginthreadex</code> with the synchronization APIs, which you cannot do with <code>_beginthread</code></strong>.</p>\n<p>It's safer to use <code>_beginthreadex</code> than <code>_beginthread</code>. If the thread that's generated by <code>_beginthread</code> exits quickly, the handle that's returned to the caller of <code>_beginthread</code> might be invalid or point to another thread. However, the handle that's returned by <code>_beginthreadex</code> has to be closed by the caller of <code>_beginthreadex</code>, so it is guaranteed to be a valid handle if <code>_beginthreadex</code> did not return an error.</p>\n</blockquote>\n<p>Since this thread only calls one function and exits, it almost maximizes the chance of this handle not being valid. And even if it were, you still couldn't use it to <code>WaitForSingleObject</code>.</p>\n"}], "owner": {"reputation": 79, "user_id": 7281521, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UMpJNIgfoEE/AAAAAAAAAAI/AAAAAAAAAEY/q-dWWZfcIVI/photo.jpg?sz=128", "display_name": "Lukasz Re", "link": "https://stackoverflow.com/users/7281521/lukasz-re"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485270297, "creation_date": 1484752679, "last_edit_date": 1484753378, "question_id": 41723033, "link": "https://stackoverflow.com/questions/41723033/shellexecute-in-beginthread", "title": "ShellExecute in _beginthread", "body": "<p>I need to run for example:</p>\n\n<pre><code>ShellExecute(NULL, \"open\", \"program.exe\", NULL, NULL, SW_HIDE);\n</code></pre>\n\n<p>as new thread, but I don't know how.\nI tried this:</p>\n\n<pre><code>HANDLE hThread = (HANDLE) _beginthread(ShellExecute(NULL, \"open\", \"program.exe\", NULL, NULL, SW_HIDE), 0, NULL);\nWaitForSingleObject( hThread, INFINITE );\n</code></pre>\n\n<p>but obviously it's wrong and can't be compiled. How should I do this?</p>\n"}, {"tags": ["c++", "c", "performance", "gcc", "optimization"], "comments": [{"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 3, "creation_date": 1484765005, "post_id": 41723001, "comment_id": 70648627, "body": "Best bet is to profile the code, then put in exp2 calls by hand. (pow() will also call exp()). Often the code will fall over because of the lost accuracy, you need to do this sort of thing carefully."}], "answers": [{"tags": [], "owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "is_accepted": true, "score": 1, "last_activity_date": 1484765312, "last_edit_date": 1484765312, "creation_date": 1484764697, "answer_id": 41727014, "question_id": 41723001, "link": "https://stackoverflow.com/questions/41723001/how-to-replace-ieee754-exp-avx-calls-from-source-code-or-library/41727014#41727014", "title": "How to replace __ieee754_exp_avx calls from source code or library?", "body": "<p>This is more like a workaround (<em>gainarie</em>): </p>\n\n<p>Place <code>exp2</code> definition in a <em>.h</em> file:</p>\n\n<pre><code>//  exp2.h\n\n#if !defined(__EXP2__H__)\n#define __EXP2__H__\n\ninline double exp2(double x) {\n    x = 1.0 + x / 1024;\n    x *= x; x *= x; x *= x; x *= x;\n    x *= x; x *= x; x *= x; x *= x;\n    x *= x; x *= x;\n    return x;\n}\n\n#endif  //__EXP2__H__\n</code></pre>\n\n<p>Now, this file must end up included (whether directly or indirectly) in <strong>all</strong> the <em>.c(xx)</em> files that call <code>exp</code> - which might be a painful job if the existing codebase is large.</p>\n\n<p>Then, when compiling the code, pass <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Preprocessor-Options.html\" rel=\"nofollow noreferrer\">-D</a>(preprocessor definition) to <em>gcc</em> (I don't know the minimum version that supports this form; <em>v5.4.0</em> does) like this: <code>-D'exp(X)=exp2(X)'</code>.</p>\n\n<p><strong>Note</strong>: You no longer need <em>libm.so.*</em>(<code>-lm</code>) at link time (at least not as far as <code>exp</code> is concerned), so you can remove it. Actually, it would be a good idea to remove it (temporarily - if you're using other math functions, permanently - otherwise), so that if there are any <em>.c(xx)</em> files that don't include <em>exp2.h</em>, the linker will spit an <code>exp</code> related <em>undefined reference</em> error (if using other math functions, after resolving all these errors by including <em>exp2.h</em> in the appropriate <em>.c(xx)</em> file you must add it back), otherwise you might end up with a mixture of <code>exp</code>/<code>exp2</code> calls in the code.</p>\n"}, {"comments": [{"owner": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "edited": false, "score": 1, "creation_date": 1484774067, "post_id": 41727786, "comment_id": 70653555, "body": "Good point. I will note that the author of the article that the OP got the implementation from led with &quot;In neutral networks, where the math function <code>e^n</code> where <code>n</code> is usually small (less than 2, for instance), you can avoid the expensive <code>exp()</code> provided by math.h (for other programming languages, similar inbuilt system functions are provided)&quot;, so it is intended only for small arguments. I agree though that the speed claims are unreasonable. The recursive self-multiplication would yield a ton of data dependencies, making it very much limited by instruction latency."}, {"owner": {"reputation": 285, "user_id": 5009965, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c7e373406444bbef6f503b62ce8770eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jones G", "link": "https://stackoverflow.com/users/5009965/jones-g"}, "edited": false, "score": 0, "creation_date": 1484800862, "post_id": 41727786, "comment_id": 70661860, "body": "I almost tried to Implement it, I guess I should be looking for a faster exp(x) implementation then."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 285, "user_id": 5009965, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c7e373406444bbef6f503b62ce8770eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jones G", "link": "https://stackoverflow.com/users/5009965/jones-g"}, "edited": false, "score": 1, "creation_date": 1484802144, "post_id": 41727786, "comment_id": 70662252, "body": "@DominicGuana No. You should be looking for a way to optimize your application to reduce the number of calls to <code>exp()</code>."}], "tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 8, "last_activity_date": 1484774067, "last_edit_date": 1484774067, "creation_date": 1484767461, "answer_id": 41727786, "question_id": 41723001, "link": "https://stackoverflow.com/questions/41723001/how-to-replace-ieee754-exp-avx-calls-from-source-code-or-library/41727786#41727786", "title": "How to replace __ieee754_exp_avx calls from source code or library?", "body": "<p>Don't. This function is slower than the native implementation of <code>exp</code>, and is an extremely poor approximation.</p>\n\n<p>First, the speed. My benchmarking indicates that, depending on your compiler and CPU, this implementation of <code>exp2</code> may be anywhere between 1.5x and 4.5x <strong>slower</strong> than the native <code>exp</code>. I'm not sure where the web site got their figures -- \"360 times faster than the traditional <code>exp</code>\" seems absurd, and is completely inconsistent with my tests.</p>\n\n<p>Second, the accuracy. <code>exp2(x)</code> is reasonably close to <code>exp(x)</code> for <code>x \u2264 1</code>, but fails badly for larger values. For instance:</p>\n\n<pre><code>exp(1)   = 2.7182818\nexp2(1)  = 2.7169557 (0.05% too low)\n\nexp(2)   = 7.3890561\nexp2(2)  = 7.3746572 (0.20% too low)\n\nexp(5)   = 148.41316\nexp2(5)  = 146.61829 (1.21% too low)\n\nexp(10)  = 22026.466\nexp2(10) = 20983.411 (4.74% too low)\n\nexp(20)  = 4.851652e+08\nexp2(20) = 4.0008755e+08 (17.5% too low)\n</code></pre>\n\n<p>While the web site you got this function from claims that there is \"very good agreement for input smaller than 5\", this is simply not true. A 1.21% difference (for <code>x=5</code>) is <em>huge</em>, and is likely to cause significant errors in any calculations using this approximation.</p>\n"}, {"comments": [{"owner": {"reputation": 285, "user_id": 5009965, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c7e373406444bbef6f503b62ce8770eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jones G", "link": "https://stackoverflow.com/users/5009965/jones-g"}, "edited": false, "score": 0, "creation_date": 1484801250, "post_id": 41729752, "comment_id": 70661966, "body": "Hi, I accepted the other answer but upvoted you as well for showing much faster exp(x) implementation, I think I will try to Implement this one based on Cristi&#39;s post."}], "tags": [], "owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "is_accepted": false, "score": 3, "last_activity_date": 1484774847, "creation_date": 1484774847, "answer_id": 41729752, "question_id": 41723001, "link": "https://stackoverflow.com/questions/41723001/how-to-replace-ieee754-exp-avx-calls-from-source-code-or-library/41729752#41729752", "title": "How to replace __ieee754_exp_avx calls from source code or library?", "body": "<p>Simply don't. That function looks <em>way</em> slower than the built-in code, and it's definitely not OK with respect to precision. </p>\n\n<p>If you need SIMD (single instruction, multiple data) optimized exp functionality, ie. you're not calculating a single value but a series of those, there's C libraries that do that for you. I'd like to highlight <a href=\"http://libvolk.org\" rel=\"nofollow noreferrer\">VOLK</a>, the <em>Vector Optimized Library of Kernels</em>, a spin-off of the DSP-intense GNU Radio project.</p>\n\n<p>It implements its own <code>expf</code> (single precision exponentiation \u2013 if you're willing to accept errors, there's certainly no reason to lug double precision floats around); here's how that compares on my machine :</p>\n\n<pre><code>RUN_VOLK_TESTS: volk_32f_expfast_32f(131071,1987)\na_avx completed in 60.119ms\na_sse4_1 completed in 62.052ms\nu_avx completed in 60.376ms\nu_sse4_1 completed in 62.131ms\ngeneric completed in 2383.73ms\n</code></pre>\n\n<p>So, for 1987 iterations over a vector of 131071 elements, all the SIMD-optimized kernels were faster by a factor of 40 \u2013 that's pretty OK, but it's far away from the audacious 360x claim of the website you quote.</p>\n\n<p>The source code of the expfast functions used can be found <a href=\"https://github.com/gnuradio/volk/blob/master/kernels/volk/volk_32f_expfast_32f.h\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>In its core, that implementation relies on the floating point representation \u2013 which is a pretty good idea.</p>\n\n<p>It admits it has a 7% error boundary \u2013 that's pretty much!</p>\n"}], "owner": {"reputation": 285, "user_id": 5009965, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c7e373406444bbef6f503b62ce8770eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jones G", "link": "https://stackoverflow.com/users/5009965/jones-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 0, "accepted_answer_id": 41727014, "answer_count": 3, "score": 2, "last_activity_date": 1484774847, "creation_date": 1484752594, "question_id": 41723001, "link": "https://stackoverflow.com/questions/41723001/how-to-replace-ieee754-exp-avx-calls-from-source-code-or-library", "title": "How to replace __ieee754_exp_avx calls from source code or library?", "body": "<p>__ieee754_exp_avx from libm*.so being used intensively in a certain source code, I would like to replace it with a faster exp(x) implementation?</p>\n\n<p>custom exp(x):</p>\n\n<pre><code>inline\ndouble exp2(double x) {\n   x = 1.0 + x / 1024;\n   x *= x; x *= x; x *= x; x *= x;\n   x *= x; x *= x; x *= x; x *= x;\n   x *= x; x *= x;\nreturn x;\n}\n</code></pre>\n\n<p>What gcc tags should I use to make gcc automatically use a custom exp(x) implementation? If it is not possible with gcc how can I do it then?</p>\n\n<p><a href=\"https://codingforspeed.com/using-faster-exponential-approximation/\" rel=\"nofollow noreferrer\">https://codingforspeed.com/using-faster-exponential-approximation/</a></p>\n"}, {"tags": ["c++", "r", "dll"], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 478590, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/yFtLy.jpg?s=128&g=1", "display_name": "jjunju", "link": "https://stackoverflow.com/users/478590/jjunju"}, "edited": false, "score": 0, "creation_date": 1484924314, "post_id": 41723217, "comment_id": 70724340, "body": "This worked to get the function name, but I am still struggling with the parameters."}], "tags": [], "owner": {"reputation": 398, "user_id": 4461389, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2zo0ylRwOwE/AAAAAAAAAAI/AAAAAAAAIG8/8fmGYstxAFU/photo.jpg?sz=128", "display_name": "Dragos Pop", "link": "https://stackoverflow.com/users/4461389/dragos-pop"}, "is_accepted": false, "score": -1, "last_activity_date": 1484753246, "creation_date": 1484753246, "answer_id": 41723217, "question_id": 41722745, "link": "https://stackoverflow.com/questions/41722745/how-to-get-list-of-functions-inside-a-dll-loaded-into-r-using-dyn-load/41723217#41723217", "title": "How to get list of functions inside a DLL loaded into R using dyn.load", "body": "<p>Best solution: use a disassembly.</p>\n\n<p>It is easy to read the functions with a tool( <a href=\"http://www.nirsoft.net/utils/dll_export_viewer.html\" rel=\"nofollow noreferrer\">http://www.nirsoft.net/utils/dll_export_viewer.html</a> for example), but it's hard to find the parameters.</p>\n"}, {"tags": [], "owner": {"reputation": 162178, "user_id": 271616, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/780efa18d6ac335453cddf3713f55b3a?s=128&d=identicon&r=PG", "display_name": "Joshua Ulrich", "link": "https://stackoverflow.com/users/271616/joshua-ulrich"}, "is_accepted": false, "score": 4, "last_activity_date": 1484753779, "creation_date": 1484753779, "answer_id": 41723394, "question_id": 41722745, "link": "https://stackoverflow.com/questions/41722745/how-to-get-list-of-functions-inside-a-dll-loaded-into-r-using-dyn-load/41723394#41723394", "title": "How to get list of functions inside a DLL loaded into R using dyn.load", "body": "<p><code>is.loaded(\"hbv_R64\")</code> would only return <code>TRUE</code> if hbv_R64.dll had a symbol (function) named <code>hbv_R64</code>.</p>\n\n<p>You can get a list of the registered name (not necessarily the name in the source code) and the interface by using <code>getDLLRegisteredRoutines</code>.</p>\n\n<pre><code>R&gt; dlls &lt;- getLoadedDLLs()\nR&gt; getDLLRegisteredRoutines(dlls$base)\n                   .Call .Call.numParameters .Fortran .Fortran.numParameters\n1      R_addTaskCallback                   4    dqrcf                      8\n2 R_getTaskCallbackNames                   0   dqrdc2                      9\n3   R_removeTaskCallback                   1   dqrqty                      7\n4                                               dqrqy                      7\n5                                              dqrrsd                      7\n6                                               dqrxb                      7\n7                                               dtrco                      6\n</code></pre>\n\n<p>In your case:</p>\n\n<pre><code>x &lt;- dyn.load(\"hbv_R64.dll\")\ngetDLLRegisteredRoutines(x)\n</code></pre>\n\n<p><code>?getDLLRegisteredRoutines</code> says, \"In the future, we will provide information about the types of the parameters also.\" So that information could already be accessible, though I'm not sure how.</p>\n"}], "owner": {"reputation": 319, "user_id": 478590, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/yFtLy.jpg?s=128&g=1", "display_name": "jjunju", "link": "https://stackoverflow.com/users/478590/jjunju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1677, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1565534590, "creation_date": 1484751855, "question_id": 41722745, "link": "https://stackoverflow.com/questions/41722745/how-to-get-list-of-functions-inside-a-dll-loaded-into-r-using-dyn-load", "title": "How to get list of functions inside a DLL loaded into R using dyn.load", "body": "<p>A few years ago I wrote a dll with some functions for running a hydrological model. I have forgotten the names and arguments of the functions inside the dll and unfortunately I forgot to write a good documentation file. The functions were complicated so I don't want to go through the alternativs I could have used that entail rewriting the code.</p>\n\n<p>I have loaded my dll into R but as I said, I neither recall the names nor the syntax of the functions.</p>\n\n<p>How can I list the functions and how can i get to see the syntax of the functions and the arguments I am supposed to provide? I know that the arguments were common model inputs but honestly I dont remember the formats.</p>\n\n<p>In addition loading the dll doesn't give an error but checking if it's loaded gives a <strong>FALSE</strong>. How can I fix this?</p>\n\n<pre><code>&gt; x&lt;-dyn.load(\"hbv_R64.dll\")\n&gt; is.loaded(\"hbv_R64\")\n[1] FALSE\n</code></pre>\n"}, {"tags": ["c++", "gcc", "flags"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484753237, "post_id": 41722742, "comment_id": 70641154, "body": "I don&#39;t get any warnings when I go from double to float, only from float to double. <code>-std=c11 -pedantic-errors -Wconversion -Wextra -Wall</code>. Also, see this: <a href=\"https://gcc.gnu.org/wiki/NewWconversion\" rel=\"nofollow noreferrer\">gcc.gnu.org/wiki/NewWconversion</a>"}, {"owner": {"reputation": 2190, "user_id": 1717026, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/5oC0y.png?s=128&g=1", "display_name": "David Bensoussan", "link": "https://stackoverflow.com/users/1717026/david-bensoussan"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484754054, "post_id": 41722742, "comment_id": 70641740, "body": "I just tried again: <code>conversion to \u2018std::vector&lt;float&gt;::value_type {aka float}\u2019 from \u2018double\u2019 may alter its value [-Werror=float-conversion]</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484754281, "post_id": 41722742, "comment_id": 70641893, "body": "C++ is not C. Which programming language is it that you are actually using?"}, {"owner": {"reputation": 2190, "user_id": 1717026, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/5oC0y.png?s=128&g=1", "display_name": "David Bensoussan", "link": "https://stackoverflow.com/users/1717026/david-bensoussan"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484754331, "post_id": 41722742, "comment_id": 70641926, "body": "You are right, I am using C++, wrote wrong :/"}], "owner": {"reputation": 2190, "user_id": 1717026, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/5oC0y.png?s=128&g=1", "display_name": "David Bensoussan", "link": "https://stackoverflow.com/users/1717026/david-bensoussan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 696, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484754355, "creation_date": 1484751849, "last_edit_date": 1484754355, "question_id": 41722742, "link": "https://stackoverflow.com/questions/41722742/gcc-flag-for-float-to-int-conversion-only-in-c", "title": "Gcc flag for float to int conversion only in C++", "body": "<p>I am setting some GCC flags and I would need to generate errors only when converting floats/double to integers.</p>\n\n<p>For now <code>-Werror=float-conversion</code> generates errors for this but also when converting from double to float which I want to ignore for some reasons.</p>\n\n<p>I know there are multiple flags around conversions, see <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html\" rel=\"nofollow noreferrer\">here</a>, but I didn't see any for this.</p>\n\n<p>Any idea?</p>\n"}, {"tags": ["c++", "opencv"], "answers": [{"tags": [], "owner": {"reputation": 448, "user_id": 2351496, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/nC1Z7.jpg?s=128&g=1", "display_name": "Anubhav Rohatgi", "link": "https://stackoverflow.com/users/2351496/anubhav-rohatgi"}, "is_accepted": true, "score": 2, "last_activity_date": 1484766405, "creation_date": 1484766405, "answer_id": 41727480, "question_id": 41722688, "link": "https://stackoverflow.com/questions/41722688/what-folders-can-be-deleted-after-compiling-opencv-from-source/41727480#41727480", "title": "What folders can be deleted after compiling opencv from source?", "body": "<p>I would recommend to keep only the include files, the libs and the bin () namely debug and release) both. </p>\n\n<p>so in all only the .dll and the .lib is required on windows and on unix only .so, .a ,.so.v.v(versioning) . along with headers are required.</p>\n"}, {"tags": [], "owner": {"reputation": 13359, "user_id": 489590, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e16b3d117fa188c4dbdafb8dc27a4df0?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Cain", "link": "https://stackoverflow.com/users/489590/brian-cain"}, "is_accepted": false, "score": 3, "last_activity_date": 1484766636, "creation_date": 1484766636, "answer_id": 41727551, "question_id": 41722688, "link": "https://stackoverflow.com/questions/41722688/what-folders-can-be-deleted-after-compiling-opencv-from-source/41727551#41727551", "title": "What folders can be deleted after compiling opencv from source?", "body": "<p>Once you do the <code>make install</code> step you can delete everything under your source dir.  </p>\n\n<p>Prior to the build you should have specified a <code>CMAKE_INSTALL_PREFIX=/usr/local/</code> or something similar.  That path will contain all of the outputs of the build that must remain.</p>\n"}], "owner": {"reputation": 4949, "user_id": 2191652, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/3cfa80e86236c34a19d11dfa54262d40?s=128&d=identicon&r=PG", "display_name": "mcExchange", "link": "https://stackoverflow.com/users/2191652/mcexchange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 786, "favorite_count": 0, "accepted_answer_id": 41727480, "answer_count": 2, "score": 3, "last_activity_date": 1484766636, "creation_date": 1484751710, "question_id": 41722688, "link": "https://stackoverflow.com/questions/41722688/what-folders-can-be-deleted-after-compiling-opencv-from-source", "title": "What folders can be deleted after compiling opencv from source?", "body": "<p>I compiled opencv from source many times and it consumes a lot of space on my hard drive. Especially the folder in <code>build/modules</code> seems to use a lot of space. Is it safe to remove this folder and everything except for </p>\n\n<pre><code>./opencv-2.X.X/include\n./opencv-2.X.X/build/lib\n</code></pre>\n\n<p>The first folder contains the headers necessary for <code>#include</code> in my c++ programs and the latter contains the dynamic libraries that the compiled programs are linked against. Is there anything else in another folder that is needed / linked against by any program using opencv or can I just delete the rest of it? </p>\n"}, {"tags": ["c++", "allocation", "constexpr", "compile-time"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1484751571, "post_id": 41722584, "comment_id": 70639855, "body": "Choose C or C++"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1484751633, "post_id": 41722584, "comment_id": 70639908, "body": "Isn&#39;t <code>std::array</code> a kind of &quot;constexpr vector&quot;?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1484751640, "post_id": 41722584, "comment_id": 70639917, "body": "Sounds like you might be looking for placement new if you are using C++."}, {"owner": {"reputation": 2135, "user_id": 4967497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0c6d09001cf39a7646ed2d22bc23352?s=128&d=identicon&r=PG", "display_name": "JojOatXGME", "link": "https://stackoverflow.com/users/4967497/jojoatxgme"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1484751905, "post_id": 41722584, "comment_id": 70640106, "body": "@KerrekSB I know <code>std::array</code> but it requires to specify the size as template argument. The size should not be part of the type. It should even be possible to change pointer in a way that it point to memory that was allocated dynamically."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484752027, "post_id": 41722584, "comment_id": 70640201, "body": "@JojOatXGME write your own template function <code>joj_new&lt;T&gt;()</code> which would create object in static or dynamic data as you need. You have to preallocate static memory though."}, {"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1484752029, "post_id": 41722584, "comment_id": 70640203, "body": "@JojOatXGME What is the point of having an array with out size? And it&#39;s not part of the type. It&#39;s a const member of a const data structure, which seems what you want to have in here <code>int * const x_array = static_new int[10];</code>"}, {"owner": {"reputation": 2135, "user_id": 4967497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0c6d09001cf39a7646ed2d22bc23352?s=128&d=identicon&r=PG", "display_name": "JojOatXGME", "link": "https://stackoverflow.com/users/4967497/jojoatxgme"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484752122, "post_id": 41722584, "comment_id": 70640272, "body": "@NathanOliver No, I want allocate memory at compile time. For example from data section. Placement new does not allocate memory. It constructs an object on memory that was previously allocated."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1484752169, "post_id": 41722584, "comment_id": 70640299, "body": "What&#39;s the difference between your <code>int * const x = static_new int;</code> and <code>static int y;</code> and using <code>&amp;y</code> in place of <code>x</code>?"}, {"owner": {"reputation": 2135, "user_id": 4967497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0c6d09001cf39a7646ed2d22bc23352?s=128&d=identicon&r=PG", "display_name": "JojOatXGME", "link": "https://stackoverflow.com/users/4967497/jojoatxgme"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484752342, "post_id": 41722584, "comment_id": 70640454, "body": "@Slava Im not sure whether this works as <code>constexpr</code> if you use it more than one time because you have to save the state between function calls. Furthermore, it would be error-prone to preallocate the right amount of memory."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1484752346, "post_id": 41722584, "comment_id": 70640458, "body": "You could always use std::vector with an arena allocator pointing to a static arena. It wouldn&#39;t be constexpr because the allocator interface isn&#39;t, but it&#39;d be close enough."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484752479, "post_id": 41722584, "comment_id": 70640555, "body": "&quot; it would be error-prone to preallocate the right amount of memory&quot; then you are out of luck - you have to preallocate static memory, that&#39;s how it works."}, {"owner": {"reputation": 2135, "user_id": 4967497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0c6d09001cf39a7646ed2d22bc23352?s=128&d=identicon&r=PG", "display_name": "JojOatXGME", "link": "https://stackoverflow.com/users/4967497/jojoatxgme"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1484752626, "post_id": 41722584, "comment_id": 70640666, "body": "@Kevin The difference between <code>&amp;value_behind</code> and <code>static_new int</code> is, that the second one does not need a static object before. This means I can use and return a new storage/pointer in each call of a <code>constexpr</code>-function."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1484752859, "post_id": 41722584, "comment_id": 70640853, "body": "@JojOatXGME then what&#39;s the difference between <code>int* const x = get_static_int(); int* const y = get_static_int();</code> and <code>static int x; static int y;</code>? Anywhere you need a pointer to static data you can just use the static data instead."}, {"owner": {"reputation": 2135, "user_id": 4967497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0c6d09001cf39a7646ed2d22bc23352?s=128&d=identicon&r=PG", "display_name": "JojOatXGME", "link": "https://stackoverflow.com/users/4967497/jojoatxgme"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1484753250, "post_id": 41722584, "comment_id": 70641166, "body": "@KerrekSB This could work. But something like <code>static_new</code> would make it simpler to read and write. It would also make it possible while using less code and redundancy. Maybe it would be a nice feature but it seems no to be there yet. Thanks for your help."}, {"owner": {"reputation": 2135, "user_id": 4967497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0c6d09001cf39a7646ed2d22bc23352?s=128&d=identicon&r=PG", "display_name": "JojOatXGME", "link": "https://stackoverflow.com/users/4967497/jojoatxgme"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1484754459, "post_id": 41722584, "comment_id": 70642015, "body": "@Kevin Sure, you can do it in this simple case but software might be more comlex. For example, you may have a static list of data that is initialized with some values at compile-time. You could preallocate the data within an array but it may make the code less readable then specifying it inline. Furthermore, you may process the input first. You could preallocate the input but you don&#39;t know the size of data you need. For example, you may want a function that parses a regex at compile time. You know the size of compiled data in constructor only. This means the constructor have to allocate ist."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1484762742, "post_id": 41722584, "comment_id": 70647331, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/29394937/array-equivalent-of-bare-string\">Array Equivalent of Bare-String</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2135, "user_id": 4967497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0c6d09001cf39a7646ed2d22bc23352?s=128&d=identicon&r=PG", "display_name": "JojOatXGME", "link": "https://stackoverflow.com/users/4967497/jojoatxgme"}, "edited": false, "score": 0, "creation_date": 1484756679, "post_id": 41722999, "comment_id": 70643557, "body": "As far as I know, VLAs are not allocated at compile-time / linking time (The don&#39;t have static duration). After all, they have local scobe and can&#39;t be located in static memory since you may need more then one instance in some situations. As far as I know, they are placed on the stack."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 1, "last_activity_date": 1484752584, "creation_date": 1484752584, "answer_id": 41722999, "question_id": 41722584, "link": "https://stackoverflow.com/questions/41722584/inline-allocation-of-memory-at-compile-time/41722999#41722999", "title": "Inline allocation of memory at compile time", "body": "<p>First of all, memory for variables with static duration is not really allocated at compile time. It is allocated at linking time or even at startup time. While the difference is subtle, it matters in some cases.</p>\n\n<p>Second of all, what you are looking for seems to be a way to allocate chunks of data with automatic or static duration. Traditionally it is done with C-style arrays, <code>std::array</code>, and, using VLA extension when available, as VLA arrays. </p>\n"}, {"comments": [{"owner": {"reputation": 2135, "user_id": 4967497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0c6d09001cf39a7646ed2d22bc23352?s=128&d=identicon&r=PG", "display_name": "JojOatXGME", "link": "https://stackoverflow.com/users/4967497/jojoatxgme"}, "edited": false, "score": 0, "creation_date": 1484755150, "post_id": 41723631, "comment_id": 70642471, "body": "I know that <code>static std::vector x = {a, b, c}</code> will allocate memory at runtime before calling <code>main()</code>. However, with something like <code>static_new</code>, it would be possible to implement of version of <code>std::vector</code> that can handle such situations without allocating and initializing memory at runtime. It would have a teeny overhead at destruction only since it must check wether the memory is static or not. Maybe an implementation would also need an alternativ keyword for <code>constexpr</code> that allows execution at compile-time only (not both)."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 2135, "user_id": 4967497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0c6d09001cf39a7646ed2d22bc23352?s=128&d=identicon&r=PG", "display_name": "JojOatXGME", "link": "https://stackoverflow.com/users/4967497/jojoatxgme"}, "edited": false, "score": 0, "creation_date": 1484755401, "post_id": 41723631, "comment_id": 70642636, "body": "@JojOatXGME Ah so you&#39;re asking this: <a href=\"http://stackoverflow.com/questions/29394937/array-equivalent-of-bare-string\" title=\"array equivalent of bare string\">stackoverflow.com/questions/29394937/&hellip;</a> or perhaps you&#39;re asking about the application: <a href=\"http://stackoverflow.com/q/29848547/2642059\">stackoverflow.com/q/29848547/2642059</a>"}, {"owner": {"reputation": 2135, "user_id": 4967497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0c6d09001cf39a7646ed2d22bc23352?s=128&d=identicon&r=PG", "display_name": "JojOatXGME", "link": "https://stackoverflow.com/users/4967497/jojoatxgme"}, "edited": false, "score": 0, "creation_date": 1484756072, "post_id": 41723631, "comment_id": 70643113, "body": "Yes, the second one <i>(int* to Constant Array)</i> matches a part of my question. I would extend the question for non-constant arrays and for arrays of given size without specifying each item (aka. <code>static_new int[4]</code>). Since I guessed that there is no such feature yet, I further asked if some feature may be added to C++ in the future."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 2135, "user_id": 4967497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0c6d09001cf39a7646ed2d22bc23352?s=128&d=identicon&r=PG", "display_name": "JojOatXGME", "link": "https://stackoverflow.com/users/4967497/jojoatxgme"}, "edited": false, "score": 0, "creation_date": 1484757704, "post_id": 41723631, "comment_id": 70644267, "body": "@JojOatXGME I think you&#39;ve still got a bit of a misconception of string literals for example. I&#39;ve tried to clarify my answer a bit.You bring up <code>constexpr</code> which should probably be addressed. These variables are fully initalizable at compile time, and may be used by the compiler to make decisions in optimizing and potentially pruning code braches. But even <code>constexpr</code> variables that are used at run-time will have Static or Automatic Storage Duration."}, {"owner": {"reputation": 2135, "user_id": 4967497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0c6d09001cf39a7646ed2d22bc23352?s=128&d=identicon&r=PG", "display_name": "JojOatXGME", "link": "https://stackoverflow.com/users/4967497/jojoatxgme"}, "edited": false, "score": 0, "creation_date": 1484760788, "post_id": 41723631, "comment_id": 70646275, "body": "There is some type of stoarge allocation and initialization at compile time. If you write <code>int x = 4;</code>, your compiler allocates 4 bytes in the data section and writes <i>4</i> to it. However, since <code>constexpr</code>-functions can be executed at runtime with dynamic arguments, such allocation can&#39;t work here. This means you are right that an implementation that can handle allocations in both situation is impossible. Even so, by providing an alternative keyword for <code>constexpr</code> that allows execution at compile-time only, you would bypass the problem. But I had not thought so far as I wrote the question. :/"}], "tags": [], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "is_accepted": false, "score": 2, "last_activity_date": 1484757283, "last_edit_date": 1495535361, "creation_date": 1484754441, "answer_id": 41723631, "question_id": 41722584, "link": "https://stackoverflow.com/questions/41722584/inline-allocation-of-memory-at-compile-time/41723631#41723631", "title": "Inline allocation of memory at compile time", "body": "<p><a href=\"https://stackoverflow.com/questions/41722584/inline-allocation-of-memory-at-compile-time#comment70640272_41722584\">Your statement</a> that <code>static</code> will:</p>\n\n<blockquote>\n  <p>Allocate memory at compile time</p>\n</blockquote>\n\n<p>This indicates a misconception. <a href=\"http://en.cppreference.com/w/cpp/language/storage_duration#Storage_duration\" rel=\"nofollow noreferrer\">Static Storage Durration</a> is defined:</p>\n\n<blockquote>\n  <p>The storage for the object <em>is allocated when the program begins</em> and deallocated when the program ends. Only one instance of the object exists. All objects declared at namespace scope (including global namespace) have this storage duration, plus those declared with <code>static</code> or <code>extern</code>.</p>\n</blockquote>\n\n<p>Understanding Static Storage Duration is essential to combating the <a href=\"https://isocpp.org/wiki/faq/ctors#static-init-order\" rel=\"nofollow noreferrer\">\"static initialization fiasco\"</a>.</p>\n\n<p>With that understanding we can see that there is no performance benefit to constructing a <code>static</code> pointer to a variable, such as <strike><code>static unique_ptr&lt;const int&gt; x(new int(13));</code></strike> Instead just using the address of <code>value_behind_x</code> as necessary is preferable.</p>\n\n<p>The same thing applies to allocating an array with Static Storage Duration. You could use a container such as <a href=\"http://en.cppreference.com/w/cpp/container/array\" rel=\"nofollow noreferrer\"><code>array</code></a> if you need container encapsulation of your array: <strike><code>static array&lt;int, 10&gt; x_array = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 }</code></strike> But generally speaking with the improvements to range access and container access provided by <a href=\"/questions/tagged/c%2b%2b11\" class=\"post-tag\" title=\"show questions tagged &#39;c++11&#39;\" rel=\"tag\">c++11</a>, <a href=\"/questions/tagged/c%2b%2b14\" class=\"post-tag\" title=\"show questions tagged &#39;c++14&#39;\" rel=\"tag\">c++14</a>, and <a href=\"/questions/tagged/c%2b%2b17\" class=\"post-tag\" title=\"show questions tagged &#39;c++17&#39;\" rel=\"tag\">c++17</a> in the <a href=\"http://en.cppreference.com/w/cpp/iterator\" rel=\"nofollow noreferrer\">iterator library</a> I'd just suggest that you stick with:</p>\n\n<pre><code>static const x_array[10] = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 };\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Just so you are aware, <a href=\"http://en.cppreference.com/w/cpp/language/string_literal\" rel=\"nofollow noreferrer\">string literals</a> also have Static Storage Duration, meaning that thy are not \"allocated at compile time.\" In fact There are only <a href=\"http://en.cppreference.com/w/cpp/language/storage_duration#Storage_duration\" rel=\"nofollow noreferrer\">3 storage durations</a> other than Static Storage Duration used by C++:</p>\n\n<blockquote>\n  <ul>\n  <li>Automatic Storage Duration. The object is allocated at the beginning of the enclosing code block and deallocated at the end. All local objects have this storage duration, except those declared <code>static</code>, <code>extern</code> or thread_local.</li>\n  <li>Thread Storage Duration. The object is allocated when the thread begins and deallocated when the thread ends. Each thread has its own instance of the object. Only objects declared thread_local have this storage duration. thread_local can appear together with <code>static</code> or <code>extern</code> to adjust linkage.</li>\n  <li>Dynamic Storage Duration. The object is allocated and deallocated per request by using dynamic memory allocation functions.</li>\n  </ul>\n</blockquote>\n\n<p>So no, there is no allocation or initialization before runtime. Nor do I expect there to ever be, as that would require a fundamental C++ ideology change <em>and</em> a computer architectural change at some level.</p>\n"}, {"tags": [], "owner": {"reputation": 2135, "user_id": 4967497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0c6d09001cf39a7646ed2d22bc23352?s=128&d=identicon&r=PG", "display_name": "JojOatXGME", "link": "https://stackoverflow.com/users/4967497/jojoatxgme"}, "is_accepted": true, "score": 0, "last_activity_date": 1578505527, "last_edit_date": 1578505527, "creation_date": 1578505074, "answer_id": 59651107, "question_id": 41722584, "link": "https://stackoverflow.com/questions/41722584/inline-allocation-of-memory-at-compile-time/59651107#59651107", "title": "Inline allocation of memory at compile time", "body": "<p>The requested feature is partly scheduled for <strong>C++20</strong>. Only transient allocations are allowed for now.</p>\n\n<p>This means <code>new</code> will be valid at compile time. However, the memory allocated at compile time is currently not allowed to leak into the runtime. The reasoning behind this limitation can be found in <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p0784r7.html\" rel=\"nofollow noreferrer\">P0784</a>. Support for non-transient allocations might be added in future versions.</p>\n"}], "owner": {"reputation": 2135, "user_id": 4967497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0c6d09001cf39a7646ed2d22bc23352?s=128&d=identicon&r=PG", "display_name": "JojOatXGME", "link": "https://stackoverflow.com/users/4967497/jojoatxgme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1467, "favorite_count": 1, "accepted_answer_id": 59651107, "answer_count": 3, "score": 0, "last_activity_date": 1578505527, "creation_date": 1484751442, "last_edit_date": 1484751750, "question_id": 41722584, "link": "https://stackoverflow.com/questions/41722584/inline-allocation-of-memory-at-compile-time", "title": "Inline allocation of memory at compile time", "body": "<p><em>C/C++</em> have multiple ways to allocate memory at compile time. For example, I can add a global or static variable. The memory to store the value is allocated at compile time:</p>\n\n<pre><code>int x;\n// -- or --\nvoid f() {\n    static int y;\n}\n// -- or --\nclass C {\n    static int z;\n};\nint C::z;\n</code></pre>\n\n<p>But this solutions can't be used to allocate memory \"inline\". Is there a possibility to do something like the following in one line?</p>\n\n<pre><code>static int value_behind_x; // does not need to be \"named\"\nint * const x = &amp;value_behind_x;\n</code></pre>\n\n<p>I mean something that looks like this:</p>\n\n<pre><code>int * const x = static_new int;\n// -- or --\nint * const x_array = static_new int[10];\n</code></pre>\n\n<p>I know about one thing in C/C++ that allows something like this: string literals. However, they must be constant and they don't allow specifying the size as number.</p>\n\n<p>If there is no such way, is there a reason for that or may it be implemented in the future? It would be nice because it would make it possible to implement a <code>constexpr</code> version of containers like <code>std::vector</code>.</p>\n"}, {"tags": ["c++", "linux", "multithreading", "memory", "virtual-memory"], "comments": [{"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1484750295, "post_id": 41722067, "comment_id": 70638944, "body": "Dump the memory map of the process.  IIRC it&#39;s <code>&#47;proc&#47;PID&#47;maps</code> on Linux."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484750526, "post_id": 41722067, "comment_id": 70639127, "body": "Do you really intend to have a memory leak in your function?"}, {"owner": {"reputation": 11, "user_id": 7384231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47a174cf166f0f9d67f67529eeabc55?s=128&d=identicon&r=PG&f=1", "display_name": "rebaca", "link": "https://stackoverflow.com/users/7384231/rebaca"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1484752572, "post_id": 41722067, "comment_id": 70640627, "body": "@AndrewHenle - I have updated the memory map in my question"}, {"owner": {"reputation": 11, "user_id": 7384231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47a174cf166f0f9d67f67529eeabc55?s=128&d=identicon&r=PG&f=1", "display_name": "rebaca", "link": "https://stackoverflow.com/users/7384231/rebaca"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484752668, "post_id": 41722067, "comment_id": 70640696, "body": "@NathanOliver - Please suggest me does the memory leak in the code is going to affect VIRTUAL memory in any manner ?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484752742, "post_id": 41722067, "comment_id": 70640762, "body": "It is certainly not gong to help.  As far as what the OS is going to do I&#39;m not sure."}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1484752937, "post_id": 41722067, "comment_id": 70640914, "body": "@rebaca You need to compare memory maps between runs of your test process with different numbers of threads and see what&#39;s different."}, {"owner": {"reputation": 11, "user_id": 7384231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47a174cf166f0f9d67f67529eeabc55?s=128&d=identicon&r=PG&f=1", "display_name": "rebaca", "link": "https://stackoverflow.com/users/7384231/rebaca"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1484823136, "post_id": 41722067, "comment_id": 70672766, "body": "@AndrewHenle - Thanks for the reply. I will compare the memory maps and update on the findings."}], "owner": {"reputation": 11, "user_id": 7384231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47a174cf166f0f9d67f67529eeabc55?s=128&d=identicon&r=PG&f=1", "display_name": "rebaca", "link": "https://stackoverflow.com/users/7384231/rebaca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484803167, "creation_date": 1484749881, "last_edit_date": 1484803167, "question_id": 41722067, "link": "https://stackoverflow.com/questions/41722067/unexplainable-virtual-memory-behavior-for-multi-threading-code-heap-allocation", "title": "Unexplainable VIRTUAL memory behavior for multi-threading code heap allocation", "body": "<p>I am trying to study the effect of pthread based Multi-threading code modifications on VIRTUAL memory on a 64-bit Centos based Linux system</p>\n\n<p>I am attaching a spreadsheet where the observations were made on VIRTUAL MEMORY (using Linux based top command) with increasing the number of threads and each thread is allocating 1MB each.</p>\n\n<p>I am pasting C++ code used for observation (below) for the reference:</p>\n\n<p>From the observations made shown in the table below, for a single thread allocating 1MB data VIRTUAL memory used is 89.824MB, for 2 threads allocating 1MB each VIRTUAL memory is 165.604MB, for 3 threads allocating 1MB each VIRTUAL memory is 235MB and then onwards VIRTUAL memory increases by 1MB per thread.</p>\n\n<p><a href=\"https://i.stack.imgur.com/69IwM.png\" rel=\"nofollow noreferrer\">Click here to view the table having observations made</a></p>\n\n<p>To summarize, VIRTUAL memory starts with 89MB, becomes double after adding 2nd thread, again becomes almost double after adding 3rd thread, then increases by 1MB for addition of each thread, each allocating 1MB of heap.</p>\n\n<p>Can anyone explain why is this behavior exhibited by the system ?</p>\n\n<p>Please post if you need any other details. Looking forward for the help.</p>\n\n<p><strong>Note:</strong><br>\nthe code was compiled using g++ (g++ -o vma CODE_FILE.cpp -lpthread)<br>\nonly 1MB of heap was allocated by each thread but were not populated<br>\nthe generated binary size is only ~9KB (got using ls command)  </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;pthread.h&gt;\n\nusing namespace std;\n\n/*\n  NOTE: Make sure you provide NUM_THREADS in the range (1..5)\n*/\n#define NUM_THREADS 5\n\nstruct thread_struct\n{\n    int id;\n    char *msg;\n};\n\nvoid *thrdFunc(void *i)\n{\n    char *it = (char*)i;\n    cout &lt;&lt; \"\\nthis is thread named :\"&lt;&lt; it ;\n\n    char *mallocBlk = new char [1000000];\n}\n\nint main()\n{\n    int rc = 0;\n    void *status;\n    char threadNames[8][8] = { \"Thread1\" , \"Thread2\", \"Thread3\",  \"Thread4\", \"Thread5\", \"Thread6\", \"Thread7\", \"Thread8\"};\n\n    pthread_t     threads[NUM_THREADS];\n    thread_struct thrStructs[NUM_THREADS];\n\n    cout &lt;&lt; \"\\nIn Main, creating threads!\" ;\n\n    /*\n       Create threads\n    */\n    for (int i = 0; i &lt; NUM_THREADS; i++)\n    {\n        rc = pthread_create(&amp;threads[i], NULL, thrdFunc, &amp;threadNames[i] );\n\n        if (rc)\n        {\n            cout &lt;&lt; \"Thrd\" &lt;&lt; i+1 &lt;&lt; \" cant be created\";\n        }\n    }\n\n    /*\n       Wait till all the threads complete\n   */\n    for (int i = 0; i &lt; NUM_THREADS; i++)\n    {\n        pthread_join(threads[i], &amp;status);\n    }\n    cout &lt;&lt; endl;\n\n    cout &lt;&lt; \"Done! Waiting for your input!\";\n    cin.get();\n    return 0;\n}\n</code></pre>\n\n<p>Below is the memory map for 5 threads:</p>\n\n<blockquote>\n  <p>[rebaca@localhost stackoverflow]$ cat /proc/31528/maps\n  00400000-00401000 r-xp 00000000 fd:02 20451094                           /home/rebaca/stackoverflow/vma\n  00601000-00602000 rw-p 00001000 fd:02 20451094                           /home/rebaca/stackoverflow/vma\n  01784000-017a5000 rw-p 00000000 00:00 0                                  [heap]\n  305b400000-305b420000 r-xp 00000000 fd:00 1703944                        /lib64/ld-2.12.so\n  305b61f000-305b620000 r--p 0001f000 fd:00 1703944                        /lib64/ld-2.12.so\n  305b620000-305b621000 rw-p 00020000 fd:00 1703944                        /lib64/ld-2.12.so\n  305b621000-305b622000 rw-p 00000000 00:00 0 \n  305b800000-305b98a000 r-xp 00000000 fd:00 1703966                        /lib64/libc-2.12.so\n  305b98a000-305bb8a000 ---p 0018a000 fd:00 1703966                        /lib64/libc-2.12.so\n  305bb8a000-305bb8e000 r--p 0018a000 fd:00 1703966                        /lib64/libc-2.12.so\n  305bb8e000-305bb90000 rw-p 0018e000 fd:00 1703966                        /lib64/libc-2.12.so\n  305bb90000-305bb94000 rw-p 00000000 00:00 0 \n  305bc00000-305bc17000 r-xp 00000000 fd:00 1703968                        /lib64/libpthread-2.12.so\n  305bc17000-305be17000 ---p 00017000 fd:00 1703968                        /lib64/libpthread-2.12.so\n  305be17000-305be18000 r--p 00017000 fd:00 1703968                        /lib64/libpthread-2.12.so\n  305be18000-305be19000 rw-p 00018000 fd:00 1703968                        /lib64/libpthread-2.12.so\n  305be19000-305be1d000 rw-p 00000000 00:00 0 \n  305c800000-305c883000 r-xp 00000000 fd:00 1704110                        /lib64/libm-2.12.so\n  305c883000-305ca82000 ---p 00083000 fd:00 1704110                        /lib64/libm-2.12.so\n  305ca82000-305ca83000 r--p 00082000 fd:00 1704110                        /lib64/libm-2.12.so\n  305ca83000-305ca84000 rw-p 00083000 fd:00 1704110                        /lib64/libm-2.12.so\n  3066800000-3066816000 r-xp 00000000 fd:00 1704139                        /lib64/libgcc_s-4.4.7-20120601.so.1\n  3066816000-3066a15000 ---p 00016000 fd:00 1704139                        /lib64/libgcc_s-4.4.7-20120601.so.1\n  3066a15000-3066a16000 rw-p 00015000 fd:00 1704139                        /lib64/libgcc_s-4.4.7-20120601.so.1\n  3066c00000-3066ce8000 r-xp 00000000 fd:00 809560                         /usr/lib64/libstdc++.so.6.0.13\n  3066ce8000-3066ee8000 ---p 000e8000 fd:00 809560                         /usr/lib64/libstdc++.so.6.0.13\n  3066ee8000-3066eef000 r--p 000e8000 fd:00 809560                         /usr/lib64/libstdc++.so.6.0.13\n  3066eef000-3066ef1000 rw-p 000ef000 fd:00 809560                         /usr/lib64/libstdc++.so.6.0.13\n  3066ef1000-3066f06000 rw-p 00000000 00:00 0 \n  7fd3ec000000-7fd3ec115000 rw-p 00000000 00:00 0 \n  7fd3ec115000-7fd3f0000000 ---p 00000000 00:00 0 \n  7fd3f0000000-7fd3f0115000 rw-p 00000000 00:00 0 \n  7fd3f0115000-7fd3f4000000 ---p 00000000 00:00 0 \n  7fd3f4000000-7fd3f4115000 rw-p 00000000 00:00 0 \n  7fd3f4115000-7fd3f8000000 ---p 00000000 00:00 0 \n  7fd3f8000000-7fd3f8115000 rw-p 00000000 00:00 0 \n  7fd3f8115000-7fd3fc000000 ---p 00000000 00:00 0 \n  7fd3fc000000-7fd3fc115000 rw-p 00000000 00:00 0 \n  7fd3fc115000-7fd400000000 ---p 00000000 00:00 0 \n  7fd4032b6000-7fd4032b7000 ---p 00000000 00:00 0 \n  7fd4032b7000-7fd403cb7000 rw-p 00000000 00:00 0 \n  7fd403cb7000-7fd403cb8000 ---p 00000000 00:00 0 \n  7fd403cb8000-7fd4046b8000 rw-p 00000000 00:00 0 \n  7fd4046b8000-7fd4046b9000 ---p 00000000 00:00 0 \n  7fd4046b9000-7fd4050b9000 rw-p 00000000 00:00 0 \n  7fd4064bb000-7fd4064c1000 rw-p 00000000 00:00 0 \n  7fd4064db000-7fd4064de000 rw-p 00000000 00:00 0 \n  7ffc72456000-7ffc7246b000 rw-p 00000000 00:00 0                          [stack]\n  7ffc72568000-7ffc72569000 r-xp 00000000 00:00 0                          [vdso]\n  ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]</p>\n</blockquote>\n"}, {"tags": ["c++", "promise", "rpc", "pipelining", "capnproto"], "answers": [{"comments": [{"owner": {"reputation": 286, "user_id": 6853526, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f0192aaff9800529eb0abf91b3c804d?s=128&d=identicon&r=PG&f=1", "display_name": "B. Clement", "link": "https://stackoverflow.com/users/6853526/b-clement"}, "edited": false, "score": 0, "creation_date": 1484817659, "post_id": 41726541, "comment_id": 70669236, "body": "Thank you for your answer. It is clearer for me now. However, I have some difficulties to implement the methods on the server. I have edited my first post to show you my problem. Thank you again."}, {"owner": {"reputation": 30998, "user_id": 2686899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/StqEe.jpg?s=128&g=1", "display_name": "Kenton Varda", "link": "https://stackoverflow.com/users/2686899/kenton-varda"}, "reply_to_user": {"reputation": 286, "user_id": 6853526, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f0192aaff9800529eb0abf91b3c804d?s=128&d=identicon&r=PG&f=1", "display_name": "B. Clement", "link": "https://stackoverflow.com/users/6853526/b-clement"}, "edited": false, "score": 1, "creation_date": 1484947135, "post_id": 41726541, "comment_id": 70736453, "body": "@B.Clement I recommend checking out the &quot;calculator&quot; example in the Cap&#39;n Proto repository -- it&#39;s very similar to what you&#39;re doing. See: <a href=\"https://github.com/sandstorm-io/capnproto/tree/master/c++/samples\" rel=\"nofollow noreferrer\">github.com/sandstorm-io/capnproto/tree/master/c++/samples</a>"}], "tags": [], "owner": {"reputation": 30998, "user_id": 2686899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/StqEe.jpg?s=128&g=1", "display_name": "Kenton Varda", "link": "https://stackoverflow.com/users/2686899/kenton-varda"}, "is_accepted": true, "score": 2, "last_activity_date": 1484763083, "creation_date": 1484763083, "answer_id": 41726541, "question_id": 41722021, "link": "https://stackoverflow.com/questions/41722021/capn-proto-and-promise-pipelining/41726541#41726541", "title": "Cap&#39;n Proto and promise pipelining", "body": "<p>The problem here is that you're trying to pipeline on an int, but pipelining only works with object references. You can solve this by wrapping the int in an object, like so:</p>\n\n<pre><code>interface Int32Box {\n  get @0 () -&gt; (value :Int32);\n}\n\ninterface Test {\n  getInt @0 () -&gt; (intResult :Int32Box);\n  increment @1 (intParam :Int32Box) -&gt; (intResult :Int32Box);\n}\n</code></pre>\n\n<p>Now your code will work as written.</p>\n\n<p>Of course, now you have to additionally call <code>.get()</code> on the final <code>Int32Box</code> in order to read the value. Luckily, though, you can pipeline this call, so that it doesn't require any additional network round trips.</p>\n\n<pre><code>auto request1 = test.getIntRequest();\nauto promise = request1.send();\n\nauto request2 = test.incrementRequest();\nrequest2.setIntParam(promise.getIntResult());\nauto promise2 = request2.send();\n\nauto request3 = promise2.getIntResult().getRequest();\nauto promise3 = request3.send();\n\n// This is the only wait!\nint finalResult = promise3.wait().getValue();\n</code></pre>\n\n<p>The above sequence executes with only one network round trip.</p>\n"}], "owner": {"reputation": 286, "user_id": 6853526, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f0192aaff9800529eb0abf91b3c804d?s=128&d=identicon&r=PG&f=1", "display_name": "B. Clement", "link": "https://stackoverflow.com/users/6853526/b-clement"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 41726541, "answer_count": 1, "score": 1, "last_activity_date": 1484817803, "creation_date": 1484749751, "last_edit_date": 1484817803, "question_id": 41722021, "link": "https://stackoverflow.com/questions/41722021/capn-proto-and-promise-pipelining", "title": "Cap&#39;n Proto and promise pipelining", "body": "<p>I would like to try promise pipelining with Cap'n Proto C++ RPC but I don't know how to do it.</p>\n\n<p>Here is my schema :</p>\n\n<pre><code>interface Test {\n  getInt @0 () -&gt; (intResult :Int32);\n  increment @1 (intParam :Int32) -&gt; (intResult :Int32);\n}\n</code></pre>\n\n<p>Here is what I would like to do (pseudo-code) :</p>\n\n<pre><code>increment(getInt());\n</code></pre>\n\n<p>I tried to do something like that :</p>\n\n<pre><code>auto request1 = test.getIntRequest();\nauto promise = request1.send();\n\nauto request2 = test.incrementRequest();\nrequest2.setIntParam(promise.getIntResult()) // HERE IS THE PROBLEM\nauto promise2 = request2.send();\n</code></pre>\n\n<p>but it is not the good way to use promises.\nI hope you understand what I want to do.</p>\n\n<p>Thank you.</p>\n\n<p>EDIT : an other question : how to implement the methods on the server ?</p>\n\n<p>I have written this code :</p>\n\n<pre><code>#include &lt;kj/debug.h&gt;\n#include &lt;capnp/ez-rpc.h&gt;\n#include &lt;capnp/message.h&gt;\n#include &lt;iostream&gt;\n#include \"test.capnp.h\"\n\nusing namespace std;\n\n\nclass TestI : virtual public Test::Server\n{\npublic:\n      TestI() {}\n      ::kj::Promise&lt;void&gt; getInt(GetIntContext context) \n      {\n            // ????\n      }\n      ::kj::Promise&lt;void&gt; increment(IncrementContext context) \n      {\n            // ????\n      }\n};\n\nclass Int32BoxI : virtual public Int32Box::Server\n{\nprivate:\n      int val = 12;\npublic:\n      Int32BoxI(int value): val(value) {}\n      ::kj::Promise&lt;void&gt; get(GetContext context)\n      {\n            context.getResults().setValue(this-&gt;val);\n            return kj::READY_NOW;\n      }\n}\n</code></pre>\n\n<p>but I don't know how to implement getInt() and increment().</p>\n"}, {"tags": ["c++", "pointers", "vector", "operator-keyword"], "comments": [{"owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "edited": false, "score": 2, "creation_date": 1484749954, "post_id": 41721947, "comment_id": 70638671, "body": "You might want <code>(*vec)[pos].getSurname()</code>."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1484750084, "post_id": 41721947, "comment_id": 70638781, "body": "Also, you could make things less complicated by passing a reference instead: <code>bool binFindInVec(vector&lt;Client&gt;&amp; vec, string sur){</code>. Then you can just use: <code>vec[pos].getSurname()</code>."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 4, "creation_date": 1484750085, "post_id": 41721947, "comment_id": 70638783, "body": "You might also want to think about why you need to pass a pointer to your vector rather than a reference."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1484751285, "post_id": 41721947, "comment_id": 70639678, "body": "Since <code>vec</code> is a <code>vector&lt;Client&gt; *</code>, <code>vec[x]</code> (a.k.a. <code>*(vec + x)</code>) is a <code>vector&lt;Client&gt;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1484750640, "post_id": 41722164, "comment_id": 70639224, "body": "Also pass by <code>const&amp;</code> if you are not actually manipulating the vector."}, {"owner": {"reputation": 33, "user_id": 6325505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c817f5ed9d789f0eaa2d3253c0404eed?s=128&d=identicon&r=PG&f=1", "display_name": "Sini", "link": "https://stackoverflow.com/users/6325505/sini"}, "edited": false, "score": 0, "creation_date": 1484757658, "post_id": 41722164, "comment_id": 70644232, "body": "thanks i used const&amp; because i don&#39;t actually manipulate the vector"}], "tags": [], "owner": {"reputation": 2581, "user_id": 1242646, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2b686cb8d225bf0023e20013bbd3a987?s=128&d=identicon&r=PG", "display_name": "roalz", "link": "https://stackoverflow.com/users/1242646/roalz"}, "is_accepted": true, "score": 3, "last_activity_date": 1484753457, "last_edit_date": 1484753457, "creation_date": 1484750164, "answer_id": 41722164, "question_id": 41721947, "link": "https://stackoverflow.com/questions/41721947/cant-access-vector-objects-function-through-operator/41722164#41722164", "title": "cant access vector object&#39;s function through -&gt; operator", "body": "<p>You should dereference 'vec' before calling its operator[]:  </p>\n\n<pre><code>(*vec)[pos].getSurname();\n</code></pre>\n\n<p>Better yet (and much safer), pass the vector parameter by reference. NOT as pointer:  </p>\n\n<pre><code>bool binFindInVec(vector&lt;Client&gt; const&amp; vec,string sur)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484751719, "post_id": 41722591, "comment_id": 70639973, "body": "Not sure why this was down voted.  This looks correct.  Not sure what you mean by <i>you need to dereference it as pointed by roalz.</i> though"}, {"owner": {"reputation": 89, "user_id": 2679769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0392196b1ad70818744743a47caad444?s=128&d=identicon&r=PG&f=1", "display_name": "Vutz", "link": "https://stackoverflow.com/users/2679769/vutz"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484815698, "post_id": 41722591, "comment_id": 70668040, "body": "i meant you need to write this <code>(*vec)</code> to be able to use <code>operator[]</code>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484829066, "post_id": 41722591, "comment_id": 70676391, "body": "You might want to edit that into the answer then to improve it."}], "tags": [], "owner": {"reputation": 89, "user_id": 2679769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0392196b1ad70818744743a47caad444?s=128&d=identicon&r=PG&f=1", "display_name": "Vutz", "link": "https://stackoverflow.com/users/2679769/vutz"}, "is_accepted": false, "score": -1, "last_activity_date": 1484833498, "last_edit_date": 1484833498, "creation_date": 1484751460, "answer_id": 41722591, "question_id": 41721947, "link": "https://stackoverflow.com/questions/41721947/cant-access-vector-objects-function-through-operator/41722591#41722591", "title": "cant access vector object&#39;s function through -&gt; operator", "body": "<p>Writing <code>vec[pos]-&gt;getSurname()</code> assumes the elements of <code>vec</code> are pointers (or smart pointers). Since you pass a vector of plain <code>Client</code> objects as pointer, you need to dereference <code>vec</code> to be able to use <code>operator[]</code></p>\n"}], "owner": {"reputation": 33, "user_id": 6325505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c817f5ed9d789f0eaa2d3253c0404eed?s=128&d=identicon&r=PG&f=1", "display_name": "Sini", "link": "https://stackoverflow.com/users/6325505/sini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 41722164, "answer_count": 2, "score": 0, "last_activity_date": 1484833498, "creation_date": 1484749553, "last_edit_date": 1484753418, "question_id": 41721947, "link": "https://stackoverflow.com/questions/41721947/cant-access-vector-objects-function-through-operator", "title": "cant access vector object&#39;s function through -&gt; operator", "body": "<p>This is a basic binary search function for a vector.I want to access an object's get function but i get error.</p>\n\n<pre><code>bool binFindInVec(vector&lt;Client&gt; *vec,string sur){\n\n\n    int from,to,pos;\n\n    from = 0;\n    to = vec-&gt;size()-1;\n\n\n    while(from&lt;=to){\n\n        pos = (from+to)/2;\n        if(vec[pos]-&gt;getSurname() == sur){\n            return true;\n        }\n        else if(vec[pos]-&gt;getSurname() &gt; sur){\n            to = pos-1;\n        }\n        else{\n            from = pos + 1;\n        }\n    }\n    return NULL;    \n}\n</code></pre>\n\n<p>the error:</p>\n\n<blockquote>\n  <p>In function 'bool binFindInVec(std::vector*, std::string)':<br/>\n     176    14  [Error] base operand of '->' has non-pointer type 'std::vector'<br/>\n     179    19  [Error] base operand of '->' has non-pointer type 'std::vector'</p>\n</blockquote>\n"}, {"tags": ["c++", "libxml2"], "comments": [{"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1484750417, "post_id": 41721908, "comment_id": 70639030, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/10486116/what-does-this-gcc-error-relocation-truncated-to-fit-mean\">What does this GCC error &quot;... relocation truncated to fit...&quot; mean?</a>"}, {"owner": {"reputation": 115, "user_id": 6742711, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7b154da00e6e7abc4a6444adc7bbd190?s=128&d=identicon&r=PG&f=1", "display_name": "rpanske", "link": "https://stackoverflow.com/users/6742711/rpanske"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1484760614, "post_id": 41721908, "comment_id": 70646170, "body": "As I have written, I read the post, but found no solution for my problem."}, {"owner": {"reputation": 329, "user_id": 1998463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a91285d3628134789a88367ef60de09f?s=128&d=identicon&r=PG", "display_name": "JMD", "link": "https://stackoverflow.com/users/1998463/jmd"}, "edited": false, "score": 0, "creation_date": 1512185981, "post_id": 41721908, "comment_id": 82167425, "body": "Hi @rpanske! Did you find a solution to this problem now? I am compiling C++ code with SQLite and Python that used to work fine in Mac in Windows using Netbeans IDE and Cygwin compiler. I am getting same error"}], "answers": [{"tags": [], "owner": {"reputation": 145, "user_id": 7345978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VG8Nu.png?s=128&g=1", "display_name": "Daniel D.", "link": "https://stackoverflow.com/users/7345978/daniel-d"}, "is_accepted": false, "score": 2, "last_activity_date": 1485390137, "last_edit_date": 1485390137, "creation_date": 1485388737, "answer_id": 41863884, "question_id": 41721908, "link": "https://stackoverflow.com/questions/41721908/how-to-resolve-relocation-truncated-to-fit-r-x86-64-pc32-against-undefined-sym/41863884#41863884", "title": "How to resolve &quot;relocation truncated to fit: R_X86_64_PC32 against undefined symbol `xmlStrcmp&#39;&quot;", "body": "<p>How did you install the library ?</p>\n\n<p>I came across the same problem a few days ago with <a href=\"https://curl.haxx.se/\" rel=\"nofollow noreferrer\">Curl</a>, and after hours and hours of Googling and digging every corner of the web to find a solution (because I'm still a newbit), I finally found it.</p>\n\n<p>The solution that worked for me might not work for you, but it still worth it to give it a try, following these steps:</p>\n\n<ul>\n<li>Try to build your library into a static one instead of including it (Google will help you with this but it's as easy as <code>./configure</code> and <code>make</code>)</li>\n<li>Make sure the program can use the library without including it (<code>-v</code> flag can help)</li>\n<li>Add a compiler option <code>-llibname</code> (for example <code>-llibxml</code>). This option <a href=\"https://gcc.gnu.org/onlinedocs/gcc-3.0/gcc_3.html#SEC16\" rel=\"nofollow noreferrer\">Search the library named libname when linking.</a></li>\n<li>Try to compile and run the program as usual.</li>\n</ul>\n\n<p>Goodluck !</p>\n"}, {"tags": [], "owner": {"reputation": 329, "user_id": 1998463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a91285d3628134789a88367ef60de09f?s=128&d=identicon&r=PG", "display_name": "JMD", "link": "https://stackoverflow.com/users/1998463/jmd"}, "is_accepted": false, "score": 1, "last_activity_date": 1512360176, "creation_date": 1512360176, "answer_id": 47626316, "question_id": 41721908, "link": "https://stackoverflow.com/questions/41721908/how-to-resolve-relocation-truncated-to-fit-r-x86-64-pc32-against-undefined-sym/47626316#47626316", "title": "How to resolve &quot;relocation truncated to fit: R_X86_64_PC32 against undefined symbol `xmlStrcmp&#39;&quot;", "body": "<p>Looks like you are using Netbeans IDE for your C++ project. I faced similar issue and I solved it by </p>\n\n<pre><code>Right clicking on Project ==&gt; Properties ==&gt; Linker ==&gt; Compilation Line ==&gt; Additional Options ==&gt; -llibxml \n</code></pre>\n\n<p>When I was using Mac OS, I had -llibxml under </p>\n\n<pre><code>C++ compiler ==&gt; Compilation Line ==&gt; Additional Options\n</code></pre>\n\n<p>In Mac OS that worked but NOT in Windows. As Daniel D. suggested, since --llibxml must be at end of execution command. placing it in Linker helped me</p>\n"}], "owner": {"reputation": 115, "user_id": 6742711, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7b154da00e6e7abc4a6444adc7bbd190?s=128&d=identicon&r=PG&f=1", "display_name": "rpanske", "link": "https://stackoverflow.com/users/6742711/rpanske"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9163, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1512360176, "creation_date": 1484749414, "last_edit_date": 1495540889, "question_id": 41721908, "link": "https://stackoverflow.com/questions/41721908/how-to-resolve-relocation-truncated-to-fit-r-x86-64-pc32-against-undefined-sym", "title": "How to resolve &quot;relocation truncated to fit: R_X86_64_PC32 against undefined symbol `xmlStrcmp&#39;&quot;", "body": "<p>I'm trying to use the libxml2 library in C++, but I get some errors which I do not know how to solve. My code is a basic example of the library.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;libxml/xmlmemory.h&gt;\n#include &lt;libxml/parser.h&gt;\n\nvoid\nparseStory (xmlDocPtr doc, xmlNodePtr cur) {\n\n    xmlChar *key;\n    cur = cur-&gt;xmlChildrenNode;\n    while (cur != NULL) {\n        if ((!xmlStrcmp(cur-&gt;name, (const xmlChar *)\"keyword\"))) {\n            key = xmlNodeListGetString(doc, cur-&gt;xmlChildrenNode, 1);\n            printf(\"keyword: %s\\n\", key);\n            xmlFree(key);\n        }\n    cur = cur-&gt;next;\n    }\n    return;\n}\n\nstatic void\nparseDoc(char *docname) {\n\n    xmlDocPtr doc;\n    xmlNodePtr cur;\n\n    doc = xmlParseFile(docname);\n\n    if (doc == NULL ) {\n        fprintf(stderr,\"Document not parsed successfully. \\n\");\n        return;\n    }\n\n    cur = xmlDocGetRootElement(doc);\n\n    if (cur == NULL) {\n        fprintf(stderr,\"empty document\\n\");\n        xmlFreeDoc(doc);\n        return;\n    }\n\n    if (xmlStrcmp(cur-&gt;name, (const xmlChar *) \"story\")) {\n        fprintf(stderr,\"document of the wrong type, root node != story\");\n        xmlFreeDoc(doc);\n        return;\n    }\n\n    cur = cur-&gt;xmlChildrenNode;\n    while (cur != NULL) {\n        if ((!xmlStrcmp(cur-&gt;name, (const xmlChar *)\"storyinfo\"))){\n            parseStory (doc, cur);\n        }\n\n    cur = cur-&gt;next;\n    }\n\n    xmlFreeDoc(doc);\n    return;\n}\n\nint\nmain(int argc, char **argv) {\n\n    char *docname;\n\n    if (argc &lt;= 1) {\n        printf(\"Usage: %s docname\\n\", argv[0]);\n        return(0);\n    }\n\n    docname = argv[1];\n    parseDoc (docname);\n\n    return (1);\n}\n</code></pre>\n\n<p>And I get these errors while building the project.</p>\n\n<blockquote>\n  <p>/cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:26:\n  undefined reference to `xmlStrcmp'</p>\n  \n  <p>/cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:26:(.text+0x36):\n  relocation truncated to fit: R_X86_64_PC32 against undefined symbol\n  `xmlStrcmp'</p>\n  \n  <p>/cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:27:\n  undefined reference to `xmlNodeListGetString'</p>\n  \n  <p>/cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:27:(.text+0x59):\n  relocation truncated to fit: R_X86_64_PC32 against undefined symbol\n  `xmlNodeListGetString' </p>\n  \n  <p>build/Debug/Cygwin-Windows/main.o: In function\n  <code>parseDoc':\n  /cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:42:\n  undefined reference to</code>xmlParseFile'</p>\n  \n  <p>/cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:42:(.text+0xad):\n  relocation truncated to fit: R_X86_64_PC32 against undefined symbol\n  `xmlParseFile'</p>\n  \n  <p>/cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:49:\n  undefined reference to `xmlDocGetRootElement'</p>\n  \n  <p>/cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:49:(.text+0xec):\n  relocation truncated to fit: R_X86_64_PC32 against undefined symbol\n  `xmlDocGetRootElement'</p>\n  \n  <p>/cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:53:\n  undefined reference to `xmlFreeDoc'</p>\n  \n  <p>/cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:53:(.text+0x126):\n  relocation truncated to fit: R_X86_64_PC32 against undefined symbol\n  `xmlFreeDoc'</p>\n  \n  <p>/cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:57:\n  undefined reference to `xmlStrcmp'</p>\n  \n  <p>/cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:57:(.text+0x142):\n  relocation truncated to fit: R_X86_64_PC32 against undefined symbol\n  `xmlStrcmp'</p>\n  \n  <p>/cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:59:\n  undefined reference to `xmlFreeDoc'</p>\n  \n  <p>/cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:59:(.text+0x17a):\n  relocation truncated to fit: R_X86_64_PC32 against undefined symbol\n  `xmlFreeDoc'</p>\n  \n  <p>/cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:65:\n  undefined reference to `xmlStrcmp'</p>\n  \n  <p>/cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:65:(.text+0x1a6):\n  relocation truncated to fit: R_X86_64_PC32 against undefined symbol\n  `xmlStrcmp'</p>\n  \n  <p>/cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:72:\n  undefined reference to `xmlFreeDoc'</p>\n  \n  <p>/cygdrive/c/Users/robin/Documents/NetBeansProjects/xml/main.cpp:72:(.text+0x1d9):\n  relocation truncated to fit: R_X86_64_PC32 against undefined symbol\n  `xmlFreeDoc'</p>\n  \n  <p>build/Debug/Cygwin-Windows/main.o:main.cpp:(.rdata$.refptr.xmlFree[.refptr.xmlFree]+0x0):\n  undefined reference to `xmlFree'</p>\n</blockquote>\n\n<p>I've read this post <a href=\"https://stackoverflow.com/questions/10486116/what-does-this-gcc-error-relocation-truncated-to-fit-mean\">What does this GCC error &quot;... relocation truncated to fit...&quot; mean?</a>, but I have no clue how to solve my problem. My IDE is Netbeans 8.2 with Cygwin64 on a Windows 10 64 bit machine. I've included <em>libxml2-2.9.3-win32-x86_64.7z</em> and <em>iconv-1.14-win32-x86_64.7z</em>. I hope you can help me, thank you.</p>\n"}, {"tags": ["c++", "multithreading", "qt"], "comments": [{"owner": {"reputation": 181, "user_id": 5788871, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/60a6f7e364aa9dad313b3e3af69a22eb?s=128&d=identicon&r=PG&f=1", "display_name": "An\u017ee ", "link": "https://stackoverflow.com/users/5788871/an%c5%bee"}, "edited": false, "score": 0, "creation_date": 1484749435, "post_id": 41721825, "comment_id": 70638261, "body": "Check out invoke function <a href=\"http://doc.qt.io/qt-5/qmetamethod.html#invoke\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/qmetamethod.html#invoke</a>, you can call slots without using a signal."}, {"owner": {"reputation": 357, "user_id": 2908202, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/100001195648592/picture?type=large", "display_name": "Patrick Jeeves", "link": "https://stackoverflow.com/users/2908202/patrick-jeeves"}, "reply_to_user": {"reputation": 181, "user_id": 5788871, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/60a6f7e364aa9dad313b3e3af69a22eb?s=128&d=identicon&r=PG&f=1", "display_name": "An\u017ee ", "link": "https://stackoverflow.com/users/5788871/an%c5%bee"}, "edited": false, "score": 0, "creation_date": 1484750327, "post_id": 41721825, "comment_id": 70638964, "body": "@An\u017ee Thank you! that looks right."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1484752450, "post_id": 41721825, "comment_id": 70640537, "body": "<a href=\"http://stackoverflow.com/a/40382821/3484570\">Related</a>."}], "answers": [{"tags": [], "owner": {"reputation": 644, "user_id": 7333037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3a4873895bfc709cb4c1725bafc87a?s=128&d=identicon&r=PG&f=1", "display_name": "Laszlo", "link": "https://stackoverflow.com/users/7333037/laszlo"}, "is_accepted": true, "score": 1, "last_activity_date": 1484774946, "last_edit_date": 1495541333, "creation_date": 1484752094, "answer_id": 41722825, "question_id": 41721825, "link": "https://stackoverflow.com/questions/41721825/how-to-manually-send-a-qsignal-from-multiple-stdthreads/41722825#41722825", "title": "How to manually send a QSignal from multiple std::threads?", "body": "<p>This should be sufficient. You can let Qt do the queueing, if needed, by setting the connection type to <a href=\"http://doc.qt.io/qt-5.7/qt.html#ConnectionType-enum\" rel=\"nofollow noreferrer\">Qt::QueuedConnection</a>, the value of the third argument of the <a href=\"http://doc.qt.io/qt-5.7/qobject.html#connect\" rel=\"nofollow noreferrer\">connect()</a> call.</p>\n\n<pre><code>#include &lt;QObject&gt;\n\nvoid passMessage(int a, MessageType b) {\n   Relay r(a,b);\n}\n\nclass Relay: public QObject {\n    Q_OBJECT\npublic:\n    Relay(int a, MessageType b) {\n      emit passMessage(a, b);\n    }\nsignals:\n    void passMessage(int, MessageType);\n};\n</code></pre>\n\n<p>You will also need to register a metatype for MessageType. See <a href=\"https://stackoverflow.com/questions/7872578/how-to-properly-use-qregistermetatype-on-a-class-derived-from-qobject?rq=1\">here</a>.</p>\n"}], "owner": {"reputation": 357, "user_id": 2908202, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/100001195648592/picture?type=large", "display_name": "Patrick Jeeves", "link": "https://stackoverflow.com/users/2908202/patrick-jeeves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 41722825, "answer_count": 1, "score": 0, "last_activity_date": 1484774946, "creation_date": 1484749175, "question_id": 41721825, "link": "https://stackoverflow.com/questions/41721825/how-to-manually-send-a-qsignal-from-multiple-stdthreads", "title": "How to manually send a QSignal from multiple std::threads?", "body": "<p>Essentially, I'm trying to add a Qt GUI onto an already existing GLUT application I made, and I'm not sure how to pass signals from the existing code into Qt, without introducing the overhead of making dozens of existing classes QObjects. Currently I'm using a QTimer and an event loop, but that isn't scaling very well, seeming to involve a lot of waiting for mutexes to then decide there's no work, with attempts to resolve this more increasing coupling than fixing it. </p>\n\n<p>The best alternate I could come up with is this:</p>\n\n<pre><code>static std::mutex relay_mutex;\nstatic std::condition_variable relay_condition;\nstatic std::queue&lt;std::pair&lt;int, void*&gt; &gt; relay_queue;\n\nextern \"C\"\nvoid passMessage(int a, void * b)\n{\n    std::lock_guard&lt;std::mutex&gt; lock(relay_mutex);\n    relay_queue.emplace_back(a, b);\n    relay_condition.notify_all();\n}\n\nclass RelayThread : public QThread\n{\n    Q_OBJECT\n\npublic:\n    RelayThread() {}\n\nsignals:\n    void passMessage(int, void *);\n\nprotected:\n    void run() override\n    {\n        std::unique_lock&lt;std::mutex&gt; lock(relay_mutex);\n\n        for(;;)\n        {\n            while(relay_queue.empty())\n                relay_condition.wait();\n\n            do {\n                emit passMessage(relay_queue.front().first, relay_queue.front().second);\n\n                if(relay_queue.front().first == 0)\n                    return;\n\n                relay_queue.pop()\n            } while(relay_queue.size());\n        }\n    }\n};\n</code></pre>\n\n<p>But this will obviously incur the overhead of an extra context switch, which is no good either.  Is there a way to manually queue up a signal without going through a QThread like this?</p>\n"}, {"tags": ["c++", "stl", "c++17", "string-view"], "comments": [{"owner": {"reputation": 19910, "user_id": 1621391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ec331963e9d60347c1e80e294b14940c?s=128&d=identicon&r=PG", "display_name": "WhiZTiM", "link": "https://stackoverflow.com/users/1621391/whiztim"}, "edited": false, "score": 8, "creation_date": 1484749268, "post_id": 41721808, "comment_id": 70638123, "body": "Err, but a <i>string-literal</i> is null terminated."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 19910, "user_id": 1621391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ec331963e9d60347c1e80e294b14940c?s=128&d=identicon&r=PG", "display_name": "WhiZTiM", "link": "https://stackoverflow.com/users/1621391/whiztim"}, "edited": false, "score": 0, "creation_date": 1484749463, "post_id": 41721808, "comment_id": 70638297, "body": "@WhiZTiM What do you mean?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1484749594, "post_id": 41721808, "comment_id": 70638398, "body": "I fail to see why you need <code>data</code> to null terminated.  If you give it a null terminated <code>const char*</code> the view will still have it.  If you don&#39;t have one then view will not add one.  That is expected behavior IMHO."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484749754, "post_id": 41721808, "comment_id": 70638513, "body": "@NathanOliver If I call <code>foo(&quot;foo&quot;)</code>, the string view will not be null-terminated, even though the literal is. For practical purposes where you need a null-terminated string it would be nice to have such a function if there is no alternative."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1484749821, "post_id": 41721808, "comment_id": 70638569, "body": "@Rakete1111 Really?!?  If that is true then yes it is broken."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484749857, "post_id": 41721808, "comment_id": 70638597, "body": "@NathanOliver See constructor (4) &quot;Constructs a view of the null-terminated character string pointed to by s, not including the terminating null character. &quot; <a href=\"http://en.cppreference.com/w/cpp/string/basic_string_view/basic_string_view\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/string/basic_string_view/&hellip;</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484749991, "post_id": 41721808, "comment_id": 70638702, "body": "@Rakete1111 Oh wow.  That is not intuitive at all.  I hope the core guidelines array_view does better."}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 2, "creation_date": 1484750440, "post_id": 41721808, "comment_id": 70639051, "body": "That means simply that the size of the string_view won&#39;t include the null byte. But of course the actual string pointed to is still null-terminated."}, {"owner": {"reputation": 19910, "user_id": 1621391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ec331963e9d60347c1e80e294b14940c?s=128&d=identicon&r=PG", "display_name": "WhiZTiM", "link": "https://stackoverflow.com/users/1621391/whiztim"}, "edited": false, "score": 9, "creation_date": 1484750923, "post_id": 41721808, "comment_id": 70639424, "body": "@Rakete1111, While we shouldn&#39;t rely on <code>std::string_view::data()</code>, because we can construct a non-null terminated view using the <code>std::string_view(const char*, std::size_t)</code> constructor and the <i>default constructor</i>. I don&#39;t see any legal way to construct a non-null terminated view using the <code>std::string_view(const char*)</code> constructor (as per your example) without already invoking UB. Because that constructor supposedly calls <a href=\"http://en.cppreference.com/w/cpp/string/char_traits/length\" rel=\"nofollow noreferrer\"><code>std::char_traits&lt;char&gt;::length</code></a> to determine the length of the string which requires a null terminator."}, {"owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 0, "creation_date": 1484751015, "post_id": 41721808, "comment_id": 70639496, "body": "As far as I understood <code>std::string_view</code> is supposed only take data (as parameter) not to pass it on. It is more or less just a pointer plus the length and can be used instead of <code>(const char* data, size_t len)</code>. Also it doesn&#39;t copy any data which makes it preferable over <code>std::string</code> in some cases. I think all <code>_view</code>s work like that."}], "answers": [{"tags": [], "owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": true, "score": 19, "last_activity_date": 1533082398, "last_edit_date": 1533082398, "creation_date": 1484749781, "answer_id": 41722032, "question_id": 41721808, "link": "https://stackoverflow.com/questions/41721808/why-does-stdstring-viewdata-not-include-a-null-terminator/41722032#41722032", "title": "Why does std::string_view::data not include a null terminator?", "body": "<blockquote>\n  <p>So, why does std::string_view::data not return a null-terminated\n  string like std::string::data</p>\n</blockquote>\n\n<p>Simply because it can't. A <code>string_view</code> can be a narrower view into a larger string (a substring of a string). That means that the string <em>viewed</em> will not necessary have the null termination at the end of a particular view. You can't write the null terminator into the underlying string for obvious reasons and you can't create a copy of the string and return <code>char *</code> without a memory leak.</p>\n\n<p>If you want a null terminating string, you would have to create a <code>std::string</code> copy out of it.</p>\n\n<p>Let me show a good use of <code>std::string_view</code>:</p>\n\n<pre><code>auto tokenize(std::string_view str, Pred is_delim) -&gt; std::vector&lt;std::string_view&gt;\n</code></pre>\n\n<p>Here the resulting vector contains tokens as views into the larger string.</p>\n"}, {"comments": [{"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1484751407, "post_id": 41722533, "comment_id": 70639759, "body": "so <code>zstring_view</code> can be only a view into the tail of a string. Interesting."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1560756420, "post_id": 41722533, "comment_id": 99825393, "body": "Has anyone proposed such a class for inclusion in the Standard? It would be really useful for interop with C libraries, to avoid constructing full C++ string types in their interfaces if a string literal can be wrapped/viewed instead."}], "tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": false, "score": 12, "last_activity_date": 1484751246, "creation_date": 1484751246, "answer_id": 41722533, "question_id": 41721808, "link": "https://stackoverflow.com/questions/41721808/why-does-stdstring-viewdata-not-include-a-null-terminator/41722533#41722533", "title": "Why does std::string_view::data not include a null terminator?", "body": "<p>The purpose of <code>string_view</code> is to be a range representing a contiguous sequence of characters. Limiting such a range to one that ends in a NUL-terminator limits the usefulness of the class.</p>\n\n<p>That being said, it would still be useful to have an alternate version of <code>string_view</code> which is intended only to be created from strings that truly are NUL-terminated.</p>\n\n<p>My <code>zstring_view</code> class is privately inherited from <code>string_view</code>, and it provides support for removing elements from the front and other operations that cannot make the string non-NUL-terminated. It provides the rest of the operations, but they return a <code>string_view</code>, not a <code>zstring_view</code>.</p>\n\n<p>You'd be surprised how few operations you have to lose from <code>string_view</code> to make this work:</p>\n\n<pre><code>template&lt;typename charT, typename traits = std::char_traits&lt;charT&gt;&gt;\nclass basic_zstring_view : private basic_string_view&lt;charT, traits&gt;\n{\npublic:\n    using base_view_type = basic_string_view&lt;charT, traits&gt;;\n\n    using base_view_type::traits_type;\n    using base_view_type::value_type;\n    using base_view_type::pointer;\n    using base_view_type::const_pointer;\n    using base_view_type::reference;\n    using base_view_type::const_reference;\n\n    using base_view_type::const_iterator;\n    using base_view_type::iterator;\n    using base_view_type::const_reverse_iterator;\n    using base_view_type::reverse_iterator;\n\n    using typename base_view_type::size_type;\n    using base_view_type::difference_type;\n\n    using base_view_type::npos;\n\n    basic_zstring_view(const charT* str) : base_view_type(str) {}\n    constexpr explicit basic_zstring_view(const charT* str, size_type len) : base_view_type(str, len) {}\n    constexpr explicit basic_zstring_view(const base_view_type &amp;view) : base_view_type(view) {}\n\n    constexpr basic_zstring_view(const basic_zstring_view&amp;) noexcept = default;\n    basic_zstring_view&amp; operator=(const basic_zstring_view&amp;) noexcept = default;\n\n    using base_view_type::begin;\n    using base_view_type::end;\n    using base_view_type::cbegin;\n    using base_view_type::cend;\n    using base_view_type::rbegin;\n    using base_view_type::rend;\n    using base_view_type::crbegin;\n    using base_view_type::crend;\n\n    using base_view_type::size;\n    using base_view_type::length;\n    using base_view_type::max_size;\n    using base_view_type::empty;\n\n    using base_view_type::operator[];\n    using base_view_type::at;\n    using base_view_type::front;\n    using base_view_type::back;\n    using base_view_type::data;\n\n    using base_view_type::remove_prefix;\n\n    //`using base_view_type::remove_suffix`; Intentionally not provided.\n\n    ///Creates a `basic_string_view` that lacks the last few characters.\n    constexpr basic_string_view&lt;charT, traits&gt; view_suffix(size_type n) const\n    {\n        return basic_string_view&lt;charT, traits&gt;(data(), size() - n);\n    }\n\n    using base_view_type::swap;\n\n    template&lt;class Allocator = std::allocator&lt;charT&gt; &gt;\n    std::basic_string&lt;charT, traits, Allocator&gt; to_string(const Allocator&amp; a = Allocator()) const\n    {\n        return std::basic_string&lt;charT, traits, Allocator&gt;(begin(), end(), a);\n    }\n\n    constexpr operator base_view_type() const {return base_view_type(data(), size());}\n\n    using base_view_type::to_string;\n\n    using base_view_type::copy;\n\n    using base_view_type::substr;\n\n    using base_view_type::operator==;\n    using base_view_type::operator!=;\n    using base_view_type::compare;\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1585687281, "post_id": 60959034, "comment_id": 107849275, "body": "Make it <code>constexpr</code> and it&#39;s perfect :) Also you don&#39;t really need the function, <code>string_view(&quot;test&quot;)</code> works."}, {"owner": {"reputation": 61, "user_id": 5731383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa0b269b2f8c8cc412bcd218efa57963?s=128&d=identicon&r=PG&f=1", "display_name": "justdoityourself", "link": "https://stackoverflow.com/users/5731383/justdoityourself"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 1, "creation_date": 1585687944, "post_id": 60959034, "comment_id": 107849560, "body": "string_view(&quot;test&quot;).size() == 4; string_viewz(&quot;test&quot;).size() == 5;"}, {"owner": {"reputation": 5631, "user_id": 1198321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f792e733fbf4e4edd6d64842093b7691?s=128&d=identicon&r=PG", "display_name": "lxop", "link": "https://stackoverflow.com/users/1198321/lxop"}, "edited": false, "score": 0, "creation_date": 1585688364, "post_id": 60959034, "comment_id": 107849763, "body": "This will only help with a string_view of a complete null-terminated string; it will not work properly if the view is a substring of a larger string"}, {"owner": {"reputation": 61, "user_id": 5731383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa0b269b2f8c8cc412bcd218efa57963?s=128&d=identicon&r=PG&f=1", "display_name": "justdoityourself", "link": "https://stackoverflow.com/users/5731383/justdoityourself"}, "edited": false, "score": 0, "creation_date": 1585688698, "post_id": 60959034, "comment_id": 107849915, "body": "You are right lxop. I attempt to say that in the answer, however I can see how what I wrote could be more succinct."}], "tags": [], "owner": {"reputation": 61, "user_id": 5731383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa0b269b2f8c8cc412bcd218efa57963?s=128&d=identicon&r=PG&f=1", "display_name": "justdoityourself", "link": "https://stackoverflow.com/users/5731383/justdoityourself"}, "is_accepted": false, "score": 1, "last_activity_date": 1585688786, "last_edit_date": 1585688786, "creation_date": 1585685366, "answer_id": 60959034, "question_id": 41721808, "link": "https://stackoverflow.com/questions/41721808/why-does-stdstring-viewdata-not-include-a-null-terminator/60959034#60959034", "title": "Why does std::string_view::data not include a null terminator?", "body": "<p>When dealing with string literals with known null terminators I usually use something like this to make sure the null is included in the counted chars.</p>\n\n<pre><code>template &lt; size_t L &gt; std::string_view string_viewz(const char (&amp;t) [L])\n{\n    return std::string_view(t, L);\n}\n</code></pre>\n\n<p>The aim here is not to try to fix the compatibility issue, there are too many. But if you know what you are doing at want the string_view span to have a null ( Serialization ) then it is a nice trick.</p>\n\n<pre><code>auto view = string_viewz(\"Surrogate String\");\n</code></pre>\n"}], "owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3404, "favorite_count": 1, "accepted_answer_id": 41722032, "answer_count": 3, "score": 8, "last_activity_date": 1585688786, "creation_date": 1484749129, "last_edit_date": 1533082340, "question_id": 41721808, "link": "https://stackoverflow.com/questions/41721808/why-does-stdstring-viewdata-not-include-a-null-terminator", "title": "Why does std::string_view::data not include a null terminator?", "body": "<p>This code has undefined behavior:</p>\n\n<pre><code>#include &lt;string_view&gt;\n#include &lt;iostream&gt;\n\nusing namespace std::string_view_literals;\n\nvoid foo(std::string_view msg) {\n    std::cout &lt;&lt; msg.data() &lt;&lt; '\\n'; // undefined behavior if 'msg' is not null-\n                                     // terminated\n\n    // std::cout &lt;&lt; msg &lt;&lt; '\\n'; is not undefined because operator&lt;&lt; uses\n    //                           iterators to print 'msg', but that's not the point\n}\n\nint main() {\n    foo(\"hello\"sv); // not null-terminated - undefined behavior\n    foo(\"foo\");     // same, even more dangerous\n}\n</code></pre>\n\n<p>The reason why is that <a href=\"http://en.cppreference.com/w/cpp/string/basic_string_view\" rel=\"nofollow noreferrer\"><code>std::string_view</code></a> can store non-null terminated strings, and doesn't include a null terminator when calling <code>data</code>. That's really limiting, as to make the above code defined behavior, I have to construct a <code>std::string</code> out of it:</p>\n\n<pre><code>std::string str{ msg };\nstd::cout &lt;&lt; str.data() &lt;&lt; '\\n';\n</code></pre>\n\n<p>This really makes <code>std::string_view</code> unnecessary in this case, I still have to copy the string passed to <code>foo</code>, so why not use move semantics and change <code>msg</code> to a <code>std::string</code>? This might be faster, but I didn't measure.</p>\n\n<p>Either way, having to construct a <code>std::string</code> every time I want to pass a <code>const char*</code> to a function which only accepts a <code>const char*</code> is a bit unnecessary, but there has to be a reason why the Committee decided it this way. </p>\n\n<p>So, why does <a href=\"http://en.cppreference.com/w/cpp/string/basic_string_view/data\" rel=\"nofollow noreferrer\"><code>std::string_view::data</code></a> not return a null-terminated string like <code>std::string::data</code>?</p>\n"}, {"tags": ["c++", "opencv", "matrix"], "comments": [{"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 1, "creation_date": 1484749453, "post_id": 41721683, "comment_id": 70638281, "body": "If you can have more than 4 columns, you&#39;d better to follow the first approach."}, {"owner": {"reputation": 1034, "user_id": 2249787, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e6f801383a4160a8cc8f5f7a9238782e?s=128&d=identicon&r=PG", "display_name": "karl71", "link": "https://stackoverflow.com/users/2249787/karl71"}, "reply_to_user": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1485353825, "post_id": 41721683, "comment_id": 70891398, "body": "Is there some performance difference between both approaches?"}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 1, "creation_date": 1485353927, "post_id": 41721683, "comment_id": 70891481, "body": "No, data are laid out in memory the same way."}], "answers": [{"tags": [], "owner": {"reputation": 14960, "user_id": 135862, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a5a2dd5f01a60b5953b09002ae6a344b?s=128&d=identicon&r=PG", "display_name": "Adi Shavit", "link": "https://stackoverflow.com/users/135862/adi-shavit"}, "is_accepted": true, "score": 3, "last_activity_date": 1484749364, "creation_date": 1484749364, "answer_id": 41721887, "question_id": 41721683, "link": "https://stackoverflow.com/questions/41721683/multi-channel-or-multi-colum-matrix-in-opencv/41721887#41721887", "title": "Multi-channel or multi-colum matrix in OpenCV", "body": "<p>It really depends on what you want to do with this data.<br>\nSome OpenCV operations are easier to do on a single pixel plane but others might be multichannel oriented.  </p>\n\n<p>I would guess that single plane (<code>C1</code>) would be more suitable for most situations though you can easily switch representations using <code>cv::reshape()</code>. In fact, choose any one and use <code>reshape()</code> to generate another view of the same memory. </p>\n"}], "owner": {"reputation": 1034, "user_id": 2249787, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e6f801383a4160a8cc8f5f7a9238782e?s=128&d=identicon&r=PG", "display_name": "karl71", "link": "https://stackoverflow.com/users/2249787/karl71"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 41721887, "answer_count": 1, "score": 0, "last_activity_date": 1484749364, "creation_date": 1484748746, "question_id": 41721683, "link": "https://stackoverflow.com/questions/41721683/multi-channel-or-multi-colum-matrix-in-opencv", "title": "Multi-channel or multi-colum matrix in OpenCV", "body": "<p>In OpenCV I'm working with some data that looks like this:</p>\n\n<pre><code>//label     A    B    C\n//   0      1    2    0\n//   1      2    1    1\n//   2      3    0    4\n//   3      4    2    3\n//   4      1    1    1\n</code></pre>\n\n<p>This data (columns A, B and C) can be stored in either a single-channel 5x3 matrix or in a 5x1 matrix with three channels. More concretely, for this example both definitions of <em>data</em> will do the job:</p>\n\n<pre><code>cv::Mat data(5, 3, CV_8UC1);\ncv::Mat data(5, 1, CV_8UC3);\n</code></pre>\n\n<p>My question is: Is there a reason for choosing one of the declarations from above and not the other?</p>\n\n<p>P.S.:This is a general doubt and not a question to a particular problem. </p>\n"}, {"tags": ["c++", "string", "c++11", "std", "string-comparison"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1484748287, "post_id": 41721450, "comment_id": 70637429, "body": "Why do you think it should say &quot;yes&quot;? Do you understand what&#39;s being compared here?"}, {"owner": {"reputation": 239269, "user_id": 464709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ab3363d257d780bd4c1f0c844b020a2?s=128&d=identicon&r=PG", "display_name": "Fr&#233;d&#233;ric Hamidi", "link": "https://stackoverflow.com/users/464709/fr%c3%a9d%c3%a9ric-hamidi"}, "edited": false, "score": 1, "creation_date": 1484748303, "post_id": 41721450, "comment_id": 70637437, "body": "<code>abc.c_str() == &quot;hello&quot;</code> compares pointers. The constant string <code>&quot;hello&quot;</code> does not reside at the same address as the heap-allocated <code>abc.c_str()</code>, therefore NO, it isn&#39;t a compiler bug."}, {"owner": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "edited": false, "score": 0, "creation_date": 1484748933, "post_id": 41721450, "comment_id": 70637884, "body": "Yes, I misinterpreted this. I get it that its comparing the buffer pointer with the literal and both of them at this point are not pointing to the same memory location. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "edited": false, "score": 0, "creation_date": 1484748424, "post_id": 41721505, "comment_id": 70637510, "body": "Thanks, so what would you suggest as the right approach with using c_str() and std::string?"}, {"owner": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "edited": false, "score": 0, "creation_date": 1484748518, "post_id": 41721505, "comment_id": 70637585, "body": "&quot;hello&quot; can be considered as both a string literal and also as a &quot;const char*&quot;, somehow I find your answer is incomplete in this regard. Thanks!"}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "reply_to_user": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "edited": false, "score": 3, "creation_date": 1484748525, "post_id": 41721505, "comment_id": 70637587, "body": "Right approach for what? To compare c style strings use one of the <code>strcmp</code> variants. To compare std::strings use <code>operator==</code>"}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "reply_to_user": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "edited": false, "score": 1, "creation_date": 1484748748, "post_id": 41721505, "comment_id": 70637750, "body": "The string literal &quot;hello&quot; is stored at a different place in memory to the internal buffer of the <code>abc</code> object. Comparing pointers to both thus returns false. Does that clear it up?"}], "tags": [], "owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "is_accepted": false, "score": 2, "last_activity_date": 1484748322, "last_edit_date": 1484748322, "creation_date": 1484748263, "answer_id": 41721505, "question_id": 41721450, "link": "https://stackoverflow.com/questions/41721450/c-str-vs-stdstring-whats-the-real-difference-in-this-piece-of-small-code/41721505#41721505", "title": "c_str() vs std::string - what&#39;s the real difference in this piece of small code?", "body": "<p><code>abc.c_str()</code> is a pointer to the internal buffer of the <code>abc</code> object, you're then doing a pointer comparison with the string literal \"hello\" which returns <code>false</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "edited": false, "score": 0, "creation_date": 1484748731, "post_id": 41721551, "comment_id": 70637738, "body": "Thanks. Very well ellucidated!"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1484748768, "post_id": 41721551, "comment_id": 70637765, "body": "I still think it was possible in C++03. I&#39;d love an expert to comment."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1484749008, "post_id": 41721551, "comment_id": 70637937, "body": "@Bathsheba I wouldn&#39;t know enough about C++03 to deny the possibility. From what I remember having read, I suppose it would be possible. A case where this programming mistake would go unnoticed until compiler/library upgrade."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 4, "last_activity_date": 1538431419, "last_edit_date": 1538431419, "creation_date": 1484748352, "answer_id": 41721551, "question_id": 41721450, "link": "https://stackoverflow.com/questions/41721450/c-str-vs-stdstring-whats-the-real-difference-in-this-piece-of-small-code/41721551#41721551", "title": "c_str() vs std::string - what&#39;s the real difference in this piece of small code?", "body": "<blockquote>\n  <p>\"hello\" should be interpreted as either const char* or std::string both are valid.</p>\n</blockquote>\n\n<p>No. <code>\"hello\"</code>  is never interpreted as <code>std::string</code>. It has the type <code>const char[6]</code>, which in this case is converted to <code>const char*</code>. This conversion for arrays is called decaying.</p>\n\n<blockquote>\n  <p>But why doesn't it print YES.</p>\n</blockquote>\n\n<p>When you compare two pointers, you compare whether they point to the same object. The pointers that you use compare unequal because the string literal, and the buffer of the <code>std::string</code> are not the same object.</p>\n\n<blockquote>\n  <p>is this a compiler bug?</p>\n</blockquote>\n\n<p>No. It is a bug in your code.</p>\n\n<blockquote>\n  <p>so what would you suggest as the right approach with using c_str() and std::string?</p>\n</blockquote>\n\n<p>The correct way is to compare the content of null terminated character arrays is <code>std::strcmp</code>.</p>\n\n<p>Alternatively, you could use the comparison operator with the <code>std::string</code> directly, without using the pointer returned by <code>c_str</code>. The comparison operator of <code>std::string</code> compares with the content of a null terminated string.</p>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 3, "last_activity_date": 1484748678, "last_edit_date": 1484748678, "creation_date": 1484748362, "answer_id": 41721552, "question_id": 41721450, "link": "https://stackoverflow.com/questions/41721450/c-str-vs-stdstring-whats-the-real-difference-in-this-piece-of-small-code/41721552#41721552", "title": "c_str() vs std::string - what&#39;s the real difference in this piece of small code?", "body": "<p>It's not a compiler bug. <code>abc.c_str()</code> is giving you the value of a pointer to the <code>std::string</code> data buffer and since C++11, it's impossible for that to be the same address as the address of the literal <code>\"hello\"</code> as that standard forbids copy-on-write semantics for <code>std::string</code>. (I believe this was theoretically possible in C++03 and earlier, out of interest.)</p>\n\n<p>If you want to compare a literal with a <code>std::string</code>, use</p>\n\n<p><code>if (abc == \"hello\")</code></p>\n\n<p>as <code>std::string</code> has an appropriate overload for the <code>==</code> operator.</p>\n"}, {"comments": [{"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 3, "creation_date": 1484749135, "post_id": 41721796, "comment_id": 70638023, "body": "Why not just <code>if(abc == &quot;hello)</code> ?"}, {"owner": {"reputation": 12625, "user_id": 1095108, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f26c5fe39742b7be7d859c2ddc11b55b?s=128&d=identicon&r=PG", "display_name": "user1095108", "link": "https://stackoverflow.com/users/1095108/user1095108"}, "reply_to_user": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 1, "creation_date": 1484749191, "post_id": 41721796, "comment_id": 70638070, "body": "that&#39;s possible too :)"}], "tags": [], "owner": {"reputation": 12625, "user_id": 1095108, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f26c5fe39742b7be7d859c2ddc11b55b?s=128&d=identicon&r=PG", "display_name": "user1095108", "link": "https://stackoverflow.com/users/1095108/user1095108"}, "is_accepted": false, "score": 1, "last_activity_date": 1484749094, "creation_date": 1484749094, "answer_id": 41721796, "question_id": 41721450, "link": "https://stackoverflow.com/questions/41721450/c-str-vs-stdstring-whats-the-real-difference-in-this-piece-of-small-code/41721796#41721796", "title": "c_str() vs std::string - what&#39;s the real difference in this piece of small code?", "body": "<p>You are comparing the wrong way, try:</p>\n\n<p>Instead of:</p>\n\n<pre><code>if (abc.c_str() == \"hello\")\n</code></pre>\n\n<p>use:</p>\n\n<pre><code>if (!strcmp(abc.c_str(), \"hello\"))\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 1620932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a54332cf763d5feb2bee6d7c18511?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/1620932/sammy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 844, "favorite_count": 0, "accepted_answer_id": 41721551, "answer_count": 4, "score": 3, "last_activity_date": 1538431485, "creation_date": 1484748100, "last_edit_date": 1538431485, "question_id": 41721450, "link": "https://stackoverflow.com/questions/41721450/c-str-vs-stdstring-whats-the-real-difference-in-this-piece-of-small-code", "title": "c_str() vs std::string - what&#39;s the real difference in this piece of small code?", "body": "<p>Why does the code below print \"NO\"?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid main()\n{\n    const std::string abc = \"hello\";\n\n    if (abc.c_str() == \"hello\")\n    {\n        cout &lt;&lt; \"\\nYES\";\n    }\n    else\n    {\n        cout &lt;&lt; \"NO\";\n    }\n}\n</code></pre>\n\n<p>The <code>.c_str()</code> returns <code>const char*</code> whereas <code>\"hello\"</code> should be interpreted as either <code>const char*</code> or <code>std::string</code>, both are valid. But why doesn't it print \"YES\". <code>strcmp()</code> does print \"YES\", when used instead. But my question is on the code above, is this a compiler bug?</p>\n"}, {"tags": ["c++", "shell", "c++11"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1484748106, "post_id": 41721390, "comment_id": 70637315, "body": "The abuse of <code>eof</code> in that code and the pointless top-level qualifiers on function parameters worry me a great deal."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 3, "creation_date": 1484748200, "post_id": 41721390, "comment_id": 70637368, "body": "No, post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> as part of the question, instead of dumping a link to some external web site that can stop working at any time, rendering the question meaningless. Having said that, and without looking at some external site, it looks to me like these are not functions, but class methods, and the problem is very obvious."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1484748229, "post_id": 41721390, "comment_id": 70637395, "body": "I am worried about all those C casts. They are probably not correct."}, {"owner": {"reputation": 2315, "user_id": 4030223, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/1eoit.png?s=128&g=1", "display_name": "Erik Alap&#228;&#228;", "link": "https://stackoverflow.com/users/4030223/erik-alap%c3%a4%c3%a4"}, "edited": false, "score": 1, "creation_date": 1484748976, "post_id": 41721390, "comment_id": 70637916, "body": "FWIW, I usually go with a lambda that captures &#39;this&#39; when wanting to save a member function as an object."}, {"owner": {"reputation": 27, "user_id": 5276633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99cae6c670a4d93f6683d8b602aba44c?s=128&d=identicon&r=PG", "display_name": "Hugo Rodrigues", "link": "https://stackoverflow.com/users/5276633/hugo-rodrigues"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1484749631, "post_id": 41721390, "comment_id": 70638428, "body": "I&#39;m starting with c++, thats why I have some issues in my code @SamVarshavchik the post was a Stack Overflow one, thats why I posted a  link. I edited the question to fix it. Yes they are class methods, how can I do it to store the method on the map?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1484749757, "post_id": 41721390, "comment_id": 70638516, "body": "The &quot;entire project&quot; link most definitely does not go to stackoverflow."}, {"owner": {"reputation": 27, "user_id": 5276633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99cae6c670a4d93f6683d8b602aba44c?s=128&d=identicon&r=PG", "display_name": "Hugo Rodrigues", "link": "https://stackoverflow.com/users/5276633/hugo-rodrigues"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1484749896, "post_id": 41721390, "comment_id": 70638632, "body": "@SamVarshavchik Yes I know, it&#39;t going to GitHub, I thought that refering it may be helpfull"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1484750449, "post_id": 41721390, "comment_id": 70639058, "body": "It is not just helpful, it contains all the pertinent information that&#39;s needed to understand this question. That&#39;s the issue. It&#39;s going to get downvoted, until it&#39;s replaced by a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. I didn&#39;t make the rules. An external link is fine, but only if it&#39;s completely optional."}, {"owner": {"reputation": 27, "user_id": 5276633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99cae6c670a4d93f6683d8b602aba44c?s=128&d=identicon&r=PG", "display_name": "Hugo Rodrigues", "link": "https://stackoverflow.com/users/5276633/hugo-rodrigues"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1484757975, "post_id": 41721390, "comment_id": 70644468, "body": "@SamVarshavchik Hmmm alright, sorry. I fix it"}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 5276633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99cae6c670a4d93f6683d8b602aba44c?s=128&d=identicon&r=PG", "display_name": "Hugo Rodrigues", "link": "https://stackoverflow.com/users/5276633/hugo-rodrigues"}, "is_accepted": true, "score": 0, "last_activity_date": 1485863084, "creation_date": 1485863084, "answer_id": 41956734, "question_id": 41721390, "link": "https://stackoverflow.com/questions/41721390/c-shell-interface/41956734#41956734", "title": "C++ Shell interface", "body": "<p>I fix it by converting the methods to static</p>\n"}], "owner": {"reputation": 27, "user_id": 5276633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99cae6c670a4d93f6683d8b602aba44c?s=128&d=identicon&r=PG", "display_name": "Hugo Rodrigues", "link": "https://stackoverflow.com/users/5276633/hugo-rodrigues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 960, "favorite_count": 0, "accepted_answer_id": 41956734, "answer_count": 1, "score": 0, "last_activity_date": 1485863116, "creation_date": 1484747930, "last_edit_date": 1485863116, "question_id": 41721390, "link": "https://stackoverflow.com/questions/41721390/c-shell-interface", "title": "C++ Shell interface", "body": "<p>I'm building an application where the interface is like a shell. The idea is to write the function name and the function is called. I saw a post in stackoverflow (see below) that explains a way to do this storing the function pointer.\nI'm storing my functions in a map of type <code>std::map&lt;std::string, std::function&lt;void(const std::vector&lt;std:.string&gt;, const std::map&lt;std:.string, std::string&gt;)&gt; &gt;</code> but when I compile it gives the follwing error</p>\n\n<pre><code>error: could not convert \u2018{{\"exit\", ((GitDeploy::Shell*)this)-&gt;GitDeploy::Shell::exit}, {\"help\", ((GitDeploy::Shell*)this)-&gt;GitDeploy::Shell::help}, {\"dbinfo\", ((GitDeploy::Shell*)this)-&gt;GitDeploy::Shell::dbinfo}, {\"list\", ((GitDeploy::Shell*)this)-&gt;GitDeploy::Shell::list}, {\"create\", ((GitDeploy::Shell*)this)-&gt;GitDeploy::Shell::create}, {\"update\", ((GitDeploy::Shell*)this)-&gt;GitDeploy::Shell::update}, {\"remove\", ((GitDeploy::Shell*)this)-&gt;GitDeploy::Shell::remove}}\u2019 from \u2018&lt;brace-enclosed initializer list&gt;\u2019 to \u2018const std::map&lt;std::basic_string&lt;char&gt;, std::function&lt;void(std::vector&lt;std::basic_string&lt;char&gt; &gt;, std::map&lt;std::basic_string&lt;char&gt;, std::basic_string&lt;char&gt; &gt;)&gt; &gt;\u2019\n         };\n</code></pre>\n\n<h1>shell.h</h1>\n\n<pre><code>#ifndef SHELL_CLASS\n#define SHELL_CLASS\n#include &lt;string&gt;\n#include &lt;map&gt;\n#include &lt;functional&gt;\n#include &lt;vector&gt;\n\nnamespace GitDeploy {\n\n    class Shell {\n        private:\n            std::map&lt;std::string, std::function&lt;void(const std::vector&lt;std::string&gt;, const std::map&lt;std::string, std::string&gt;)&gt; &gt; const methods {\n                {\"exit\", exit},\n                {\"help\", help},\n                {\"dbinfo\", dbinfo},\n                {\"list\", list},\n                {\"create\", create},\n                {\"update\", update},\n                {\"remove\", remove}\n            };\n\n            std::map&lt;std::string, std::string&gt; const method_help {\n                {\"exit\", \"Exists GitDeploy\"},\n                {\"help\", \"Prints available commands\"},\n                {\"dbinfo\", \"Prints database information\"},\n                {\"list\", \"Lists repositories.\"},\n                {\"create\", \"Adds a new repository\"},\n                {\"update\", \"Updates a existing repositor\\nyou must pass is uuid or partial uuid and the values to update\\nupdate &lt;uuid&gt; path=&lt;path&gt; reset=&lt;reset&gt;\"},\n                {\"remove\", \"Deletes a repository\\nTo delete a repository, pass the uuids or partial uuids to delete\\ndelete &lt;uuid&gt; &lt;uuid&gt; [...]\"}\n            };\n\n            bool exit_shell;\n        public:\n            void serve();\n\n            void exit(const std::vector&lt;std::string&gt;, const std::map&lt;std::string, std::string&gt;);\n            void help(const std::vector&lt;std::string&gt;, const std::map&lt;std::string, std::string&gt;);\n            void dbinfo(const std::vector&lt;std::string&gt;, const std::map&lt;std::string, std::string&gt;);\n            void list(const std::vector&lt;std::string&gt;, const std::map&lt;std::string, std::string&gt;);\n            void create(const std::vector&lt;std::string&gt;, const std::map&lt;std::string, std::string&gt;);\n            void update(const std::vector&lt;std::string&gt;, const std::map&lt;std::string, std::string&gt;);\n            void remove(const std::vector&lt;std::string&gt;, const std::map&lt;std::string, std::string&gt;);\n    };\n}\n\n#endif\n</code></pre>\n\n<h1>Answer to StackOverflow <a href=\"https://stackoverflow.com/questions/19473313/how-to-call-a-function-by-its-name-stdstring-in-c\">post</a></h1>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;map&gt;\n\nint add(int i, int j) { return i+j; }\nint sub(int i, int j) { return i-j; }\n\ntypedef int (*FnPtr)(int, int);\n\nint main() {\n    // initialization:\n    std::map&lt;std::string, FnPtr&gt; myMap;\n    myMap[\"add\"] = add;\n    myMap[\"sub\"] = sub;\n\n    // usage:\n    std::string s(\"add\");\n    int res = myMap[s](2,3);\n    std::cout &lt;&lt; res;\n}\n</code></pre>\n\n<p>Thanks,</p>\n\n<p>Hugo Rodrigues</p>\n"}, {"tags": ["c++", "c++11", "clang"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1484748000, "post_id": 41721370, "comment_id": 70637248, "body": "You compile with <code>libstdc++</code> but link with <code>libc++</code>, are you sure about that?"}, {"owner": {"reputation": 1342, "user_id": 6946652, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/6W5x0.jpg?s=128&g=1", "display_name": "Bobby", "link": "https://stackoverflow.com/users/6946652/bobby"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1484748116, "post_id": 41721370, "comment_id": 70637322, "body": "@Someprogrammerdude Dude you are a genius!!!!!!!  IM SO STUPID. post an answer I&#39;ll accept that."}], "answers": [{"tags": [], "owner": {"reputation": 375, "user_id": 7437816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec3a0968fe49876bd821eee0f9e657a?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rozkin", "link": "https://stackoverflow.com/users/7437816/martin-rozkin"}, "is_accepted": false, "score": 5, "last_activity_date": 1484786207, "creation_date": 1484786207, "answer_id": 41731895, "question_id": 41721370, "link": "https://stackoverflow.com/questions/41721370/clang-3-8-make-file-fails/41731895#41731895", "title": "clang 3.8 make file fails", "body": "<p>You need to add one of the following pairs to your build line:</p>\n\n<ul>\n<li><p>-L/usr/lib -lstdc++</p></li>\n<li><p>-L/usr/lib -llibc++</p></li>\n</ul>\n"}], "owner": {"reputation": 1342, "user_id": 6946652, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/6W5x0.jpg?s=128&g=1", "display_name": "Bobby", "link": "https://stackoverflow.com/users/6946652/bobby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1010, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1484786207, "creation_date": 1484747874, "last_edit_date": 1484748022, "question_id": 41721370, "link": "https://stackoverflow.com/questions/41721370/clang-3-8-make-file-fails", "title": "clang 3.8 make file fails", "body": "<p>After scratching my head for over 3 hours I finally gave up and decided ask for you guys help.</p>\n\n<p>I have a few files, which is gonna compile into one executable. </p>\n\n<p>With the <code>-stdlib=libc++ flag</code>, I will get </p>\n\n<pre><code>/usr/include/c++/v1/string:1938:44: error: 'basic_string&lt;_CharT, _Traits, _Allocator&gt;' is missing exception specification 'noexcept(is_nothrow_copy_constructible&lt;allocator_type&gt;::value)'\nbasic_string&lt;_CharT, _Traits, _Allocator&gt;::basic_string(const allocator_type&amp; __a)\n                                           ^\n/usr/include/c++/v1/string:1326:40: note: previous declaration is here\n    _LIBCPP_INLINE_VISIBILITY explicit basic_string(const allocator_type&amp; __a)\n</code></pre>\n\n<p>I did some search and as another SO question susggests. changed to  <code>-stdlib=libstdc++</code> , I get a Whole lots of output in the console.</p>\n\n<pre><code>/home/bobby/Documents/freshmen/225/cs225/lab_intro/png.cpp:382: undefined reference to `std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::~basic_string()'\n/home/bobby/Documents/freshmen/225/cs225/lab_intro/png.cpp:382: undefined reference to `std::allocator&lt;char&gt;::~allocator()'\n/home/bobby/Documents/freshmen/225/cs225/lab_intro/png.cpp:382: undefined reference to `std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::~basic_string()'\n/home/bobby/Documents/freshmen/225/cs225/lab_intro/png.cpp:382: undefined reference to `std::allocator&lt;char&gt;::~allocator()'\n/home/bobby/Documents/freshmen/225/cs225/lab_intro/png.cpp:399: undefined reference to `std::allocator&lt;char&gt;::allocator()'\n/home/bobby/Documents/freshmen/225/cs225/lab_intro/png.cpp:399: undefined reference to `std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::basic_string(char const*, std::allocator&lt;char&gt; const&amp;)'\n/home/bobby/Documents/freshmen/225/cs225/lab_intro/png.cpp:399: undefined reference to `std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::~basic_string()'\n/home/bobby/Documents/freshmen/225/cs225/lab_intro/png.cpp:399: undefined reference to `std::allocator&lt;char&gt;::~allocator()'\n/home/bobby/Documents/freshmen/225/cs225/lab_intro/png.cpp:399: undefined reference to `std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::~basic_string()'\n/home/bobby/Documents/freshmen/225/cs225/lab_intro/png.cpp:399: undefined reference to `std::allocator&lt;char&gt;::~allocator()'\npng.o: In function `__cxx_global_var_init':\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/iostream:74: undefined reference to `std::ios_base::Init::Init()'\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/iostream:74: undefined reference to `std::ios_base::Init::~Init()'\npng.o: In function `epng_err(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;)':\n/home/bobby/Documents/freshmen/225/cs225/lab_intro/png.cpp:18: undefined reference to `std::cerr'\n/home/bobby/Documents/freshmen/225/cs225/lab_intro/png.cpp:19: undefined reference to `std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp; std::operator&lt;&lt; &lt;std::char_traits&lt;char&gt; &gt;(std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp;, char const*)'\n/home/bobby/Documents/freshmen/225/cs225/lab_intro/png.cpp:19: undefined reference to `std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp; std::operator&lt;&lt; &lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;(std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp;, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;)'\n/home/bobby/Documents/freshmen/225/cs225/lab_intro/png.cpp:19: undefined reference to `std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp; std::endl&lt;char, std::char_traits&lt;char&gt; &gt;(std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp;)'\n/home/bobby/Documents/freshmen/225/cs225/lab_intro/png.cpp:19: undefined reference to `std::ostream::operator&lt;&lt;(std::ostream&amp; (*)(std::ostream&amp;))'\npng.o: In function `std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; std::operator+&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;(char const*, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;)':\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/bits/basic_string.tcc:1158: undefined reference to `std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::basic_string()'\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/bits/basic_string.tcc:1159: undefined reference to `std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::size() const'\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/bits/basic_string.tcc:1159: undefined reference to `std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::reserve(unsigned long)'\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/bits/basic_string.tcc:1160: undefined reference to `std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::append(char const*, unsigned long)'\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/bits/basic_string.tcc:1161: undefined reference to `std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::append(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;)'\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/bits/basic_string.tcc:1163: undefined reference to `std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::~basic_string()'\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/bits/basic_string.tcc:1163: undefined reference to `std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::~basic_string()'\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>This is just the last part of the information spitted out.</p>\n\n<p>Make file is here</p>\n\n<pre><code>EXENAME = lab_intro\nOBJS = main.o png.o rgbapixel.o\n\nCXX = clang++\nCXXFLAGS = -std=c++1y -stdlib=libstdc++ -c -g -O0 -Wall -Wextra -pedantic\nLD = clang++\nLDFLAGS = -std=c++1y -stdlib=libc++ -lpng -lc++abi -lpthread\n\nall : $(EXENAME)\n\n$(EXENAME) : $(OBJS)\n    $(LD) $(OBJS) $(LDFLAGS) -o $(EXENAME)\n\nmain.o : main.cpp png.h rgbapixel.h\n    $(CXX) $(CXXFLAGS) main.cpp\n\npng.o : png.cpp png.h rgbapixel.h\n    $(CXX) $(CXXFLAGS) png.cpp\n\nrgbapixel.o : rgbapixel.cpp rgbapixel.h\n    $(CXX) $(CXXFLAGS) rgbapixel.cpp\n\nclean :\n    -rm -f *.o $(EXENAME)\n</code></pre>\n\n<p>Operating system is Ubuntu 16.04LTS, with all necessary dependencies installed(Or I think I correctly installed).</p>\n\n<p>FileTree</p>\n\n<pre><code>lab_intro/\n    Makefile\n    main.cpp\n    png.cpp\n    png.h\n    rgbapixel.h\n    rgbapixel.cpp\n    sample.png\n</code></pre>\n"}, {"tags": ["c++", "credentials", "credential-providers"], "answers": [{"tags": [], "owner": {"reputation": 550, "user_id": 4213607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d47c495b1260d22114388d5d5768b3a3?s=128&d=identicon&r=PG&f=1", "display_name": "fkorsa", "link": "https://stackoverflow.com/users/4213607/fkorsa"}, "is_accepted": false, "score": 1, "last_activity_date": 1492178726, "creation_date": 1492178726, "answer_id": 43413165, "question_id": 41721366, "link": "https://stackoverflow.com/questions/41721366/custom-credential-provider/43413165#43413165", "title": "Custom Credential Provider", "body": "<p>This is by design. For security reasons, in this particular case Microsoft forces users to authenticate twice.</p>\n\n<p>See <a href=\"https://blogs.msdn.microsoft.com/winsdk/2009/07/14/rdc-and-custom-credential-providers/\" rel=\"nofollow noreferrer\" title=\"RDC and Custom Credential Providers\">RDC and Custom Credential Providers</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 3904639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4565125a9650de3a6ebe19dfc6beaae?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim MESLEM", "link": "https://stackoverflow.com/users/3904639/ibrahim-meslem"}, "is_accepted": false, "score": 1, "last_activity_date": 1598789372, "last_edit_date": 1598789372, "creation_date": 1504187613, "answer_id": 45983199, "question_id": 41721366, "link": "https://stackoverflow.com/questions/41721366/custom-credential-provider/45983199#45983199", "title": "Custom Credential Provider", "body": "<p>You have to implement the <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/credentialprovider/nf-credentialprovider-icredentialproviderfilter-updateremotecredential\" rel=\"nofollow noreferrer\">UpdateRemoteCredential</a> in your filter.</p>\n"}], "owner": {"reputation": 41, "user_id": 983867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c265c595362a4f3dc3ed42a10c498a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Ibrahim", "link": "https://stackoverflow.com/users/983867/mohamed-ibrahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1598789372, "creation_date": 1484747866, "last_edit_date": 1504192104, "question_id": 41721366, "link": "https://stackoverflow.com/questions/41721366/custom-credential-provider", "title": "Custom Credential Provider", "body": "<p>I have built a custom Credential Provider which is provided as a sample in Windows SDK. It is working great on computers.</p>\n\n<p>the problem comes when the CR is installed on a remote server and people connect to it through RDP , the user is prompted twice for his username/password pairs, the first time in native rdp client and the second time in the custom credential provider itself when he logs in successfully through the native rdp client.</p>\n\n<p>is there a way to grab the username and password which were entered in the first step and write it on the CR fields.</p>\n"}, {"tags": ["c++", "opencv", "raspberry-pi", "video-streaming", "gstreamer"], "answers": [{"tags": [], "owner": {"reputation": 1471, "user_id": 7240025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t8kKh.png?s=128&g=1", "display_name": "Alper Kucukkomurler", "link": "https://stackoverflow.com/users/7240025/alper-kucukkomurler"}, "is_accepted": true, "score": 0, "last_activity_date": 1485161553, "creation_date": 1485161553, "answer_id": 41802276, "question_id": 41721336, "link": "https://stackoverflow.com/questions/41721336/opencv-cant-open-network-stream-from-gstreamer-created-by-raspberry/41802276#41802276", "title": "OpenCV can&#39;t open network stream from gstreamer created by raspberry", "body": "<p>OpenCv supports gstreamer and you can input pipes to VideoCapture. What you need to do is finish your pipe with appsink.</p>\n\n<p>In your case you might use</p>\n\n<pre><code>const char* pipe = \"udpsrc port=5001 ! application/x-rtp, payload=96 ! rtpjitterbuffer ! rtph264depay ! avdec_h264 ! appsink\"\ncv::VideoCapture cap(pipe);\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7042271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ad13fcf2c812d74e08fe3da95fc058?s=128&d=identicon&r=PG&f=1", "display_name": "Mark6028", "link": "https://stackoverflow.com/users/7042271/mark6028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 783, "favorite_count": 0, "accepted_answer_id": 41802276, "answer_count": 1, "score": 2, "last_activity_date": 1487301358, "creation_date": 1484747782, "question_id": 41721336, "link": "https://stackoverflow.com/questions/41721336/opencv-cant-open-network-stream-from-gstreamer-created-by-raspberry", "title": "OpenCV can&#39;t open network stream from gstreamer created by raspberry", "body": "<p>I'm trying to open an unicast udp stream from my Raspberry pi using Gstreamer. This stream will be received on a Windows PC using a C++ application with OpenCV. This is the shellscript i use on the raspberry to start the stream:</p>\n\n<pre><code>raspivid -t 0 -h 1080 -w 1920 -fps 30 -hf -vf -n -b 6000000 -o - | gst-launch-1.0 -e -vvvv  fdsrc ! h264parse !  rtph264pay config-interval=5 pt=96 ! udpsink host=192.168.0.101 port=5001\n</code></pre>\n\n<p>I am able to receive and display the footage on my Windows PC using a batch file like this:</p>\n\n<pre><code>@echo off\ncd C:\\gstreamer\\1.0\\x86_64\\bin\ngst-launch-1.0 -e -v udpsrc port=5001 ! application/x-rtp, payload=96 ! rtpjitterbuffer ! rtph264depay ! avdec_h264 ! fpsdisplaysink sync=false text-overlay=false\n</code></pre>\n\n<p>To be able to use this stream in my C++ application I use Opencv. I am not familiar with opening a stream using Opencv. I'm trying to open the stream using the following code:</p>\n\n<pre><code>    cv::VideoCapture cap(\"udp://@:5001\");\n    if (!cap.isOpened()) {\n        printf(\"=ERR= can't create video capture\\n\");\n        return -1;\n    }\n</code></pre>\n\n<p>When I run my application it gets stuck (not crashing) at cv::VideoCapture cap(\"udp://@:5001\"); every time. I'm not sure what the input parameters are between the quotation marks. When I wireshark the stream I get this result: </p>\n\n<blockquote>\n  <p>Source:192.186.0.103 Destination:192.168.0.101 Protocol:UDP Length:1442 Info:35946->5001 Len=1400</p>\n</blockquote>\n\n<p>Obviously this is just one of the many packages.</p>\n\n<p>Can anyone help me with those input parameters or show me another way to open the stream in OpenCV?</p>\n"}, {"tags": ["c++", "operator-overloading", "lvalue", "rvalue"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484747990, "post_id": 41721316, "comment_id": 70637239, "body": "Why not add an overload for the assignment operator to take a <code>B</code>?"}, {"owner": {"reputation": 1250, "user_id": 2702753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LGPWj.jpg?s=128&g=1", "display_name": "kalj", "link": "https://stackoverflow.com/users/2702753/kalj"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484748265, "post_id": 41721316, "comment_id": 70637412, "body": "@NathanOliver Because I am hoping to maintain const-correctness for <code>x</code> which in the real code is a large vector. Having a const reference instead of just a reference seems like a good thing for compiler optimizations."}], "owner": {"reputation": 1250, "user_id": 2702753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LGPWj.jpg?s=128&g=1", "display_name": "kalj", "link": "https://stackoverflow.com/users/2702753/kalj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1484747715, "creation_date": 1484747715, "question_id": 41721316, "link": "https://stackoverflow.com/questions/41721316/enforce-operator-version-from-lvalue-rvalue-context", "title": "Enforce operator version from lvalue/rvalue context", "body": "<p>I'm trying to make some nice syntax for assignment of array slices using operator overloading. Due to some peculiarities with const-correctness of references, different classes are needed for lvalue and rvalue slices. However, I cannot get the compiler to understand which version to use in a given context.</p>\n\n<p>The code below shows a simplified version of the original code, and while it looks a bit contrived, it captures the issue fairly well. In the real code, <code>i</code> is a whole set of indices, and <code>B</code>/<code>ConstB</code> represents slices of huge arrays that cannot be copied around, motivating the reference <code>x</code>.</p>\n\n<p>The problem occurs when I want to do the assignment in <code>foo</code>. I want all slices on the right to yield a <code>ConstB</code> object, but since <code>a1</code> happens to be non-const in this case, the wrong one is used. I can enforce it by introducing a <code>const_cast</code>, but I would prefer some way that does not destroy the user code (i.e. the thing inside <code>foo</code>). Is there a way to enforce that a given overload is called for lvalues or rvalues, respectively?</p>\n\n<p>The code:</p>\n\n<pre><code>struct B;\nstruct ConstB;\n\nstruct A\n{\n  double data[10];\n\n  A() {}\n  A&amp;     operator=(const ConstB &amp;b);\n  ConstB operator()(int i) const;\n  B      operator()(int i);\n};\n\n\nstruct B\n{\n  double &amp;x;\n\n  B(double *d, int i);\n  B&amp; operator=(const A &amp;a);\n};\n\nstruct ConstB\n{\n  const double x;\n\n  ConstB(const double *d, int i);\n};\n\n\n\nA&amp; A::operator=(const ConstB &amp;b) {\n  data[0] = b.x;\n  return *this;\n}\n\nConstB A::operator()(int i) const {\n  return ConstB(data,i);\n}\n\nB A::operator()(int i) {\n  return B(data,i);\n}\n\n\nB::B(double *d, int i)\n  : x(d[i]) {}\n\nB&amp; B::operator=(const A &amp;a) {\n  x=a.data[0];\n  return *this;\n}\n\nConstB::ConstB(const double *d, int i)\n  : x(d[i]) {}\n\n\n\nvoid foo(A &amp;a1, A &amp;a2, A&amp;a3)\n{\n  a1(2) = a2;\n\n  a3 = a1(3);\n  // a3 = const_cast&lt;const A&amp;&gt;(a1)(3);\n}\n\nint main(int argc, char *argv[])\n{\n  A a1;\n  A a2;\n  A a3;\n\n  foo(a1,a2,a3);\n\n  return 0;\n}\n</code></pre>\n\n<p>Resulting error message:</p>\n\n<pre><code>test.cc: In function \u2018void foo(A&amp;, A&amp;, A&amp;)\u2019:\ntest.cc:67:6: error: no match for \u2018operator=\u2019 (operand types are \u2018A\u2019 and \u2018B\u2019)\n   a3 = a1(3);\n      ^\ntest.cc:36:4: note: candidate: A&amp; A::operator=(const ConstB&amp;)\n A&amp; A::operator=(const ConstB &amp;b) {\n    ^\ntest.cc:36:4: note:   no known conversion for argument 1 from \u2018B\u2019 to \u2018const ConstB&amp;\u2019\ntest.cc:5:8: note: candidate: A&amp; A::operator=(const A&amp;)\n struct A\n        ^\ntest.cc:5:8: note:   no known conversion for argument 1 from \u2018B\u2019 to \u2018const A&amp;\u2019\ntest.cc:5:8: note: candidate: A&amp; A::operator=(A&amp;&amp;)\ntest.cc:5:8: note:   no known conversion for argument 1 from \u2018B\u2019 to \u2018A&amp;&amp;\u2019\n</code></pre>\n"}, {"tags": ["c++", "parallel-processing", "segmentation-fault", "mpi", "freeze"], "answers": [{"comments": [{"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "reply_to_user": {"reputation": 143, "user_id": 4770829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d602175f0d9756b1c8bdc3bab932329?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Ellis", "link": "https://stackoverflow.com/users/4770829/matt-ellis"}, "edited": false, "score": 1, "creation_date": 1484904057, "post_id": 41722158, "comment_id": 70711583, "body": "@MichaelPortobello: Initialise both <code>request</code> and <code>request2</code> to <code>MPI_REQUEST_NULL</code>. That way you can unconditionally call <code>MPI_Wait</code>."}], "tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": true, "score": 0, "last_activity_date": 1484750156, "creation_date": 1484750156, "answer_id": 41722158, "question_id": 41721159, "link": "https://stackoverflow.com/questions/41721159/why-is-mpi-isend-hanging-here/41722158#41722158", "title": "Why is MPI_Isend hanging here?", "body": "<p>You are unconditionally doing <code>MPI_Wait</code> on both <code>request</code> and <code>request2</code>, whereas you conditionally doing <code>MPI_Isend</code> / <code>MPI_Irecv</code>. You must only wait on requests that are actually initiated.</p>\n"}], "owner": {"reputation": 143, "user_id": 4770829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d602175f0d9756b1c8bdc3bab932329?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Ellis", "link": "https://stackoverflow.com/users/4770829/matt-ellis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 41722158, "answer_count": 1, "score": 1, "last_activity_date": 1484750156, "creation_date": 1484747318, "question_id": 41721159, "link": "https://stackoverflow.com/questions/41721159/why-is-mpi-isend-hanging-here", "title": "Why is MPI_Isend hanging here?", "body": "<p>I am trying to send a buffer from left to right (0->1, 1->2 2->3 etc...). I am pretty sure that the processes are sending and receiving from the correct partner but the code hangs or outputs a seg fault.</p>\n\n<pre><code>#include \"mpi.h\"\n#include &lt;iostream&gt;\nint main(int argc, char *argv[])\n{\nint comm_rank, num_procs, recieve1, send1;\nint buffer[10];\nMPI_Request request, request2;\nMPI_Status status;\n\nMPI_Init(&amp;argc,&amp;argv);\nMPI_Comm_size(MPI_COMM_WORLD, &amp;num_procs);\nMPI_Comm_rank(MPI_COMM_WORLD, &amp;comm_rank);\n\n\nsend1 = (comm_rank + 1) % num_procs;\nrecieve1 = comm_rank - 1;\nif (recieve1 &lt; 0)\n    recieve1 = num_procs - 1;\n\n//std::cout &lt;&lt; \"Comm Rank = \" &lt;&lt; comm_rank &lt;&lt; \"\\trecieve1 = \" &lt;&lt; recieve1 &lt;&lt; \"\\tsend1 = \" &lt;&lt; send1 &lt;&lt; std::endl;     \n\nif (comm_rank == 0)\n    send1 = 1;\nif (comm_rank == num_procs-1)\n    recieve1 = num_procs-2;\n\nif (comm_rank != 0) \n{\n    MPI_Irecv(buffer, 10, MPI_INT, recieve1, 123, MPI_COMM_WORLD, &amp;request);\n    std::cout &lt;&lt; comm_rank &lt;&lt; \" &lt;- \" &lt;&lt; recieve1 &lt;&lt; std::endl;\n}\nif (comm_rank != num_procs-1)\n{\n    MPI_Isend(buffer, 10, MPI_INT, send1, 123, MPI_COMM_WORLD, &amp;request2);\n    std::cout &lt;&lt; comm_rank &lt;&lt; \" -&gt; \" &lt;&lt; send1 &lt;&lt; std::endl;\n}\nMPI_Wait(&amp;request, &amp;status);\nMPI_Wait(&amp;request2, &amp;status);\n\n\nMPI_Finalize();\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "tcp", "client", "poco", "nonblocking"], "answers": [{"tags": [], "owner": {"reputation": 375, "user_id": 7437816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec3a0968fe49876bd821eee0f9e657a?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rozkin", "link": "https://stackoverflow.com/users/7437816/martin-rozkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1484786626, "creation_date": 1484786626, "answer_id": 41731942, "question_id": 41721053, "link": "https://stackoverflow.com/questions/41721053/how-to-use-the-streamsocket-as-a-non-blocking-tcp-client-in-the-poco-library/41731942#41731942", "title": "how to use the streamsocket as a non-blocking tcp client in the poco library?", "body": "<p>The recommendation for networking I/O in C++ is to use <a href=\"http://think-async.com/\" rel=\"nofollow noreferrer\"><strong>ASIO</strong></a> as it is being prepared for inclusion within the C++ language standard.</p>\n"}], "owner": {"reputation": 21, "user_id": 7428079, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gACfQgla7fc/AAAAAAAAAAI/AAAAAAAAADE/7yNMo0Y_LcU/photo.jpg?sz=128", "display_name": "richardor", "link": "https://stackoverflow.com/users/7428079/richardor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 438, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1484786626, "creation_date": 1484747043, "question_id": 41721053, "link": "https://stackoverflow.com/questions/41721053/how-to-use-the-streamsocket-as-a-non-blocking-tcp-client-in-the-poco-library", "title": "how to use the streamsocket as a non-blocking tcp client in the poco library?", "body": "<p>the poco library provides a reactor framework for tcp server. and there are some samples demonstrated how to use it.</p>\n\n<p>but I couldnot find any example of the streamsocket. I just want to use it in the tcp client with non-blocking mode, how to use it?</p>\n\n<p>thanks.</p>\n"}, {"tags": ["c++", "linux", "gcc"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1484747225, "post_id": 41721040, "comment_id": 70636734, "body": "Is the setting of <code>b</code> and the testing of <code>a</code> a typo?  Also is the callback and loop on the same thread?"}, {"owner": {"reputation": 7481, "user_id": 2527795, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8359590ce3a66e5c58407ae5c83c9bbe?s=128&d=identicon&r=PG&f=1", "display_name": "vll", "link": "https://stackoverflow.com/users/2527795/vll"}, "edited": false, "score": 0, "creation_date": 1484747334, "post_id": 41721040, "comment_id": 70636809, "body": "If you change your variables to <code>std::atomic_bool</code>, does the difference disappear?"}, {"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 0, "creation_date": 1484747549, "post_id": 41721040, "comment_id": 70636939, "body": "(assuming the aforementioned typo is, in fact, a typo) Supposing <code>test()</code> and <code>callbackHandler()</code> are called from different threads, you would be doing concurrent read and write to <code>a</code>, which, in short, is not guaranteed to work as expected. You could see what happens with <code>std::atomic_bool</code>, as suggested, or even just declaring <code>a</code> to be <code>volatile</code>; it is very possible that one compiler version decides that <code>a</code> is not changing in the loop and keeps reading it from e.g. a register instead of memory."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "reply_to_user": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 0, "creation_date": 1484747861, "post_id": 41721040, "comment_id": 70637143, "body": "@jdehesa <code>volatile</code> is not for solving threading problems."}, {"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1484748332, "post_id": 41721040, "comment_id": 70637452, "body": "@RichardCritten Right, but I think it would make the enough difference in this case to get both compilers to produce programs behave similarly (and reveal why it was not the case before). Of course, it would probably not be enough for the real application."}, {"owner": {"reputation": 2341, "user_id": 727366, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/15362554dff032d3d6a3f52921115d3f?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Mesquita Alfaiate", "link": "https://stackoverflow.com/users/727366/miguel-mesquita-alfaiate"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1484754856, "post_id": 41721040, "comment_id": 70642274, "body": "@RichardCritten yes its a typo, I will correct it."}, {"owner": {"reputation": 2341, "user_id": 727366, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/15362554dff032d3d6a3f52921115d3f?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Mesquita Alfaiate", "link": "https://stackoverflow.com/users/727366/miguel-mesquita-alfaiate"}, "reply_to_user": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 0, "creation_date": 1484755075, "post_id": 41721040, "comment_id": 70642423, "body": "@jdehesa I never used atomic_bool before and I don&#39;t know how to declare and initialize atomic_bools. I tried a few options but since I was not sure this was the case, I tried different things. I tried volatile and the issue remains."}], "answers": [{"comments": [{"owner": {"reputation": 2341, "user_id": 727366, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/15362554dff032d3d6a3f52921115d3f?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Mesquita Alfaiate", "link": "https://stackoverflow.com/users/727366/miguel-mesquita-alfaiate"}, "edited": false, "score": 0, "creation_date": 1484754973, "post_id": 41721269, "comment_id": 70642356, "body": "can you ellaborate more? I agree that the lack of a mutex means that I can read a variable with an incorrect value, while it is being changed. Nonetheless, on the next while iteration, shouldn&#39;t the read had the updated value?"}, {"owner": {"reputation": 2336, "user_id": 31152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BozWc.jpg?s=128&g=1", "display_name": "Malkocoglu", "link": "https://stackoverflow.com/users/31152/malkocoglu"}, "reply_to_user": {"reputation": 2341, "user_id": 727366, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/15362554dff032d3d6a3f52921115d3f?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Mesquita Alfaiate", "link": "https://stackoverflow.com/users/727366/miguel-mesquita-alfaiate"}, "edited": false, "score": 0, "creation_date": 1484755039, "post_id": 41721269, "comment_id": 70642400, "body": "@BlunT: Why should it ?"}, {"owner": {"reputation": 2341, "user_id": 727366, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/15362554dff032d3d6a3f52921115d3f?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Mesquita Alfaiate", "link": "https://stackoverflow.com/users/727366/miguel-mesquita-alfaiate"}, "edited": false, "score": 0, "creation_date": 1484755174, "post_id": 41721269, "comment_id": 70642485, "body": "when the read is made while a write is being made, I understand that the value being read is incorrect. But on subsequent reads, shouldn&#39;t the value be retrieved from the object, which has been updated in the meanwhile? Why then? Is the value cached for undefined time?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1484755287, "post_id": 41721269, "comment_id": 70642567, "body": "A C++ compiler is allowed to generate any code that&#39;s optimized in any way that does not change observable results. <code>int a=b+c; int d=b+e;</code> The C++ compiler is permitted to generate code that reads <code>b</code> only once, even though it&#39;s used twice. This has no observable changes in the results, since nothing changes the value of <code>b</code>. There&#39;s nothing in <code>test()</code> that changes the observable value of <code>b</code>, so the compiler is permitted to generate the code that reads <code>b</code> once, if <code>true</code> returns from the function, otherwise it enters an infinite loop."}, {"owner": {"reputation": 2341, "user_id": 727366, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/15362554dff032d3d6a3f52921115d3f?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Mesquita Alfaiate", "link": "https://stackoverflow.com/users/727366/miguel-mesquita-alfaiate"}, "edited": false, "score": 0, "creation_date": 1484756676, "post_id": 41721269, "comment_id": 70643554, "body": "@SamVarshavchik Ok, in that case, how can I tell the compiler to get its hands out of my code? :) How can I make it re-read the value of those variables everytime?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1484757693, "post_id": 41721269, "comment_id": 70644258, "body": "I told you already: use a mutex or an atomic variable. That tells the compiler that another execution thread might modify the <code>bool</code> at any time. Even if the compiler generates explicit code, unless you&#39;re using a single-core CPU, you&#39;re still at the whim&#39;s of your CPU&#39;s multi-core caches. Only explicit sequencing/atomic variables is going to issue special CPU instructions that makes everything happen correctly."}], "tags": [], "owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "is_accepted": true, "score": 0, "last_activity_date": 1484747587, "creation_date": 1484747587, "answer_id": 41721269, "question_id": 41721040, "link": "https://stackoverflow.com/questions/41721040/same-code-compiled-with-different-versions-provides-different-result/41721269#41721269", "title": "Same code compiled with different versions provides different result", "body": "<p>It is obvious from your <code>test()</code> method that there are multiple execution threads involved. <code>test()</code> is in one execution thread, and the callbacks get invoked by the other execution thread.</p>\n\n<p>Setting the <code>bool</code> flags in the other execution thread, and reading the same flags in the <code>test()</code> execution thread are not sequenced with each other.</p>\n\n<p>The usual solution is to either use <code>std::atomic_bool</code>; or use a <code>std::mutex</code> to implement sequencing, and accessing the variables, either to set them in one execution thread, or read their current values in the other execution thread, only while the mutex is locked.</p>\n"}], "owner": {"reputation": 2341, "user_id": 727366, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/15362554dff032d3d6a3f52921115d3f?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Mesquita Alfaiate", "link": "https://stackoverflow.com/users/727366/miguel-mesquita-alfaiate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 41721269, "answer_count": 1, "score": 1, "last_activity_date": 1484754879, "creation_date": 1484746998, "last_edit_date": 1484754879, "question_id": 41721040, "link": "https://stackoverflow.com/questions/41721040/same-code-compiled-with-different-versions-provides-different-result", "title": "Same code compiled with different versions provides different result", "body": "<p>I am using an external library which I do not control nor know the internals (lets call it proprietarycallbacks).</p>\n\n<p>I know that I have a class called callbacks that has two bool variables:</p>\n\n<pre><code>class callbacks : public proprietarycallbacks {\n  bool a = false;\n  bool b = false;\n  virtual callbackHandler() {\n    cout \"callback received\\n\";\n    b = true;\n  }\n}\n</code></pre>\n\n<p>then I have another class which inherits from the callbacks class:</p>\n\n<pre><code>class MyObject : public callbacks {\n\n  void test() {\n    while (!b) {\n      cout &lt;&lt; \"test \" &lt;&lt; a &lt;&lt; \" \" &lt;&lt; b &lt;&lt; endl;\n      usleep(100000);\n    }\n  }\n}\n</code></pre>\n\n<p>This code compiles correctly in two different linux versions, with two different GCC versions and LIBC versions.</p>\n\n<p>On the most recent one (linux mint, GCC 5.4 LIBC 2.23), I run the app, see the cout in the while and when the callback is called, the code exists the while.</p>\n\n<p>On the older one (debian, GCC 4.9.2, LIBC 2.19), the while never exists, the variable is always false, even though I can see the print from inside the callback.</p>\n\n<p>Is there something wrong with the way I am structuring the code, and the variable inheritance, or does this have something to do with the software versions I am using?</p>\n\n<p>Thank you for your time</p>\n"}, {"tags": ["c++", "lambda", "boolean", "language-lawyer"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 11, "creation_date": 1484747161, "post_id": 41720989, "comment_id": 70636692, "body": "Not sure if this is legal or not but it appears to be converting the lambda into a function pointer and then using that value (which is not null) into the bool so it compiles.  If you add a capture <a href=\"http://coliru.stacked-crooked.com/a/f28beac0173e86e4\" rel=\"nofollow noreferrer\">it fails to compile</a>."}, {"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 8, "creation_date": 1484748188, "post_id": 41720989, "comment_id": 70637362, "body": "MSVC has <a href=\"https://adishavit.github.io/2016/magical-captureless-lambdas/\" rel=\"nofollow noreferrer\">a nonstandard extension</a>, so it requires you to explicitly spell out the destination function pointer type, otherwise the conversion will fail."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1484774745, "post_id": 41720989, "comment_id": 70653885, "body": "Also see <a href=\"http://stackoverflow.com/q/28746744/1708801\">Passing lambda as function pointer</a>"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1484775779, "post_id": 41720989, "comment_id": 70654432, "body": "@NathanOliver yes it is legal see <a href=\"http://eel.is/c++draft/conv.bool\" rel=\"nofollow noreferrer\">&#91;conv.bool&#93;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "is_accepted": true, "score": 45, "last_activity_date": 1486328998, "last_edit_date": 1486328998, "creation_date": 1484747782, "answer_id": 41721337, "question_id": 41720989, "link": "https://stackoverflow.com/questions/41720989/why-does-a-lambda-convert-to-a-bool-whose-value-is-true/41721337#41721337", "title": "Why does a lambda convert to a bool whose value is true?", "body": "<p>The C++14 standard (<em>\u00a75.1.2</em>) says:</p>\n\n<blockquote>\n  <p><strong>The closure type for a non-generic lambda-expression with no</strong>\n  <strong>lambda-capture has a public non-virtual non-explicit const conversion</strong>\n  <strong>function to pointer to function</strong> with C++ language linkage (7.5)\n  having the same parameter and return types as the closure type\u2019s\n  function call operator. The value returned by this conversion function\n  shall be the address of a function that, when invoked, has the same\n  effect as invoking the closure type\u2019s function call operator.</p>\n</blockquote>\n\n<p>Since a function pointer is implicitly convertible to <code>bool</code>, you get the result you have shown. This is perfectly legal.</p>\n\n<p>MSVC doesn't compile this because this conversion operator is overloaded with different calling conventions (<code>__stdcall</code>, <code>__cdecl</code>, etc).\nWhen compiling for <code>x64</code> all those calling conventions are not used, so there's just one conversion operator and it compiles fine.</p>\n"}], "owner": {"reputation": 7392, "user_id": 1555823, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2b69fc6d16ff23e3509b2f3602838acd?s=128&d=identicon&r=PG", "display_name": "vladon", "link": "https://stackoverflow.com/users/1555823/vladon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2435, "favorite_count": 0, "accepted_answer_id": 41721337, "answer_count": 1, "score": 47, "last_activity_date": 1486328998, "creation_date": 1484746872, "last_edit_date": 1484769681, "question_id": 41720989, "link": "https://stackoverflow.com/questions/41720989/why-does-a-lambda-convert-to-a-bool-whose-value-is-true", "title": "Why does a lambda convert to a bool whose value is true?", "body": "<pre><code>#include &lt;iostream&gt;\n\nvoid IsTrue(const bool value) {\n  if (value) {\n    std::cout &lt;&lt; \"value is True!\\n\";\n  }\n}\n\nint main()\n{\n  IsTrue([]() { ; /* some lambda */ });\n\n  return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>value is True!\n</code></pre>\n\n<p>Why does the lambda evaluate to <code>true</code> on GCC &amp; Clang? MSVC cannot build this (cannot convert lambda to bool).</p>\n\n<p>Is it a compiler bug? Or which paragraph of the standard allows this?</p>\n"}, {"tags": ["c++", "qt", "types", "qml"], "answers": [{"comments": [{"owner": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "edited": false, "score": 1, "creation_date": 1484820916, "post_id": 41723771, "comment_id": 70671326, "body": "I advice to use <code>objectName</code> as a magic key. In this case you can access it by <code>obj-&gt;objectName</code> and also will be able to use <code>rootItem-&gt;findChild&lt;QQuickItem*&gt;(&quot;myObjectName&quot;)</code> to find the item."}, {"owner": {"reputation": 10571, "user_id": 122687, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/9b4e0447e8d049ba853fe368765f6f76?s=128&d=identicon&r=PG", "display_name": "Stefan Monov", "link": "https://stackoverflow.com/users/122687/stefan-monov"}, "edited": false, "score": 0, "creation_date": 1484832323, "post_id": 41723771, "comment_id": 70678564, "body": "@ddriver: Thanks, yeah, I&#39;m using your <code>isFoo</code> solution currently, I&#39;d prefer something cleaner though. I do like that it works for &quot;derived&quot; objects too. Also useful note about overhead, though in my case that&#39;s not a problem."}, {"owner": {"reputation": 10571, "user_id": 122687, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/9b4e0447e8d049ba853fe368765f6f76?s=128&d=identicon&r=PG", "display_name": "Stefan Monov", "link": "https://stackoverflow.com/users/122687/stefan-monov"}, "reply_to_user": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "edited": false, "score": 0, "creation_date": 1484832412, "post_id": 41723771, "comment_id": 70678634, "body": "@folibis: <code>objectName</code> works if I only want to find one object. I want to find a bunch of items that have the same type."}, {"owner": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "reply_to_user": {"reputation": 10571, "user_id": 122687, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/9b4e0447e8d049ba853fe368765f6f76?s=128&d=identicon&r=PG", "display_name": "Stefan Monov", "link": "https://stackoverflow.com/users/122687/stefan-monov"}, "edited": false, "score": 0, "creation_date": 1484834874, "post_id": 41723771, "comment_id": 70680270, "body": "@StefanMonov, you&#39;re wrong. I&#39;ve adviced that because I use it in my own applications. You can easy find list of objects by <code>objectName</code>, for example: <code>QList&lt;QQuickItem *&gt; list = item-&gt;findChildren&lt;QQuickItem *&gt;(&quot;Rectangle&quot;);</code> where Rectangle is a <code>objectName</code> set for several items. Anyway, in general that&#39;s already the same as @ddriver solution. But you already have ready helper function."}, {"owner": {"reputation": 10571, "user_id": 122687, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/9b4e0447e8d049ba853fe368765f6f76?s=128&d=identicon&r=PG", "display_name": "Stefan Monov", "link": "https://stackoverflow.com/users/122687/stefan-monov"}, "reply_to_user": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "edited": false, "score": 0, "creation_date": 1484835165, "post_id": 41723771, "comment_id": 70680465, "body": "@folibis: Oh, I didn&#39;t know that. Thanks. I still won&#39;t use that though, because it&#39;s confusing - I&#39;d expect an <code>objectName</code> to be unique in a context, just like an <code>id</code> is."}, {"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "edited": false, "score": 0, "creation_date": 1484836135, "post_id": 41723771, "comment_id": 70681174, "body": "That&#39;s an option too. I am kind of an efficiency freak because my project deals with very high object counts and qml is a memory hog. I don&#39;t even use strings for object names, I use an integer id, which leads to a dictionary of ref counted phrases, which are consisted of a list of intenger ids, which lead to a dictionary of ref counted words, in order to share every repeating word and phrase, with those being used to reconstruct the actual string only when its needed :D"}], "tags": [], "owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "is_accepted": true, "score": 3, "last_activity_date": 1484754863, "creation_date": 1484754863, "answer_id": 41723771, "question_id": 41720757, "link": "https://stackoverflow.com/questions/41720757/qt-how-to-check-from-c-whether-an-object-is-of-qml-type-foo/41723771#41723771", "title": "Qt: How to check from C++ whether an object is of QML type Foo", "body": "<p>You could use a magic key property:</p>\n\n<pre><code>Foo {\n  property bool isFoo : true\n}\n</code></pre>\n\n<p>And then from C++:</p>\n\n<pre><code>if (obj-&gt;property(\"isFoo\").toBool())\n</code></pre>\n\n<p>If the object doesn't have that property, then the condition should fail. This will also work for \"derived\" objects as the property will be \"inherited\", for example if something extends <code>Foo</code> but is not necessarily named <code>FooSomething</code> but rather <code>SomethingFoo</code>.</p>\n\n<p>Naturally, there will be some overhead, which could get pronounced in scenarios where you need a lot of type checks on many instances. What I tend to do is have a single <code>quint32 type</code> property implemented efficiently on C++ level, then from QML this is explicitly set in objects where type information is necessary. This way the overhead is minimized, and it is also faster to access than using <code>property(name)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 10571, "user_id": 122687, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/9b4e0447e8d049ba853fe368765f6f76?s=128&d=identicon&r=PG", "display_name": "Stefan Monov", "link": "https://stackoverflow.com/users/122687/stefan-monov"}, "edited": false, "score": 0, "creation_date": 1484832764, "post_id": 41737847, "comment_id": 70678867, "body": "As I wrote in the question, <code>className()</code> returns something like &quot;Foo_QMLTYPE_0&quot;, not &quot;Foo&quot;, so unfortunately that doesn&#39;t work."}], "tags": [], "owner": {"reputation": 101, "user_id": 6453340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FH73U.png?s=128&g=1", "display_name": "Daniel Chapman", "link": "https://stackoverflow.com/users/6453340/daniel-chapman"}, "is_accepted": false, "score": 0, "last_activity_date": 1484817167, "creation_date": 1484817167, "answer_id": 41737847, "question_id": 41720757, "link": "https://stackoverflow.com/questions/41720757/qt-how-to-check-from-c-whether-an-object-is-of-qml-type-foo/41737847#41737847", "title": "Qt: How to check from C++ whether an object is of QML type Foo", "body": "<p>IMO you are part of the way there. Your best bet is using a combination of <code>QQuickItem::inherits</code> and <code>QMetaObject::className</code>. </p>\n\n<p>This way you can figure out if it is actually a <code>Foo</code> or derived from <code>Foo</code>.</p>\n\n<pre><code>const QByteArray foo = QByteArrayLiteral(\"Foo\");\n\nif (item-&gt;metaObject()-&gt;className() == foo || item-&gt;inherits(foo)) {\n    // It's a Foo\n}\n</code></pre>\n"}], "owner": {"reputation": 10571, "user_id": 122687, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/9b4e0447e8d049ba853fe368765f6f76?s=128&d=identicon&r=PG", "display_name": "Stefan Monov", "link": "https://stackoverflow.com/users/122687/stefan-monov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 41723771, "answer_count": 2, "score": 2, "last_activity_date": 1484817167, "creation_date": 1484746198, "question_id": 41720757, "link": "https://stackoverflow.com/questions/41720757/qt-how-to-check-from-c-whether-an-object-is-of-qml-type-foo", "title": "Qt: How to check from C++ whether an object is of QML type Foo", "body": "<p>Consider a QML type (defined in QML, not in C++):</p>\n\n<pre><code>Foo {\n}\n</code></pre>\n\n<p>And assume I have a <code>QQuickItem* item</code> variable in C++. <strong>How do I check if the variable is of type Foo?</strong></p>\n\n<p>If Foo was a C++ type, I could do this:</p>\n\n<pre><code>qobject_cast&lt;Foo*&gt;(item) == nullptr\n</code></pre>\n\n<p>Since Foo is a QML type, one option would be</p>\n\n<pre><code>item-&gt;metaObject()-&gt;className().beginsWith(\"Foo\")\n</code></pre>\n\n<p>(<code>className()</code> returns something like <code>Foo_QMLTYPE_0</code>)</p>\n\n<p>But that seems unreliable and hacky.</p>\n"}]