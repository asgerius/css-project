[{"tags": ["c++", "heap", "infinite-loop"], "comments": [{"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 3, "creation_date": 1432164580, "post_id": 30362037, "comment_id": 48815634, "body": "Not <i>certain</i> that it&#39;s causing the problem you&#39;re seeing, but <code>while(!input.eof())</code> is generally broken."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1432164600, "post_id": 30362037, "comment_id": 48815643, "body": "One classic: ` while(!input.eof()) ` How do you know? You haven&#39;t read anything yet. How do you know you even opened the file?"}, {"owner": {"reputation": 17, "user_id": 4850914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/359f9eae9313bba8b36b581a98594748?s=128&d=identicon&r=PG&f=1", "display_name": "newb12345", "link": "https://stackoverflow.com/users/4850914/newb12345"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1432164725, "post_id": 30362037, "comment_id": 48815680, "body": "@user4581301 so what would you guys recommend me to do?"}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 4, "creation_date": 1432165004, "post_id": 30362037, "comment_id": 48815753, "body": "<a href=\"http://stackoverflow.com/questions/5605125\">Why is iostream::eof inside a loop condition considered wrong?</a>"}, {"owner": {"reputation": 994, "user_id": 4905579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe4c045d81145929c7ba8eec6e2bdcf?s=128&d=identicon&r=PG&f=1", "display_name": "Good Luck", "link": "https://stackoverflow.com/users/4905579/good-luck"}, "edited": false, "score": 0, "creation_date": 1432166929, "post_id": 30362037, "comment_id": 48816241, "body": "It&#39;s better you minimize your code before sending it...."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4850914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/359f9eae9313bba8b36b581a98594748?s=128&d=identicon&r=PG&f=1", "display_name": "newb12345", "link": "https://stackoverflow.com/users/4850914/newb12345"}, "edited": false, "score": 0, "creation_date": 1432166738, "post_id": 30362274, "comment_id": 48816200, "body": "wow this really helped, but lets say i dont want to store it in a file to avoid all this eof() how would i just keep it in c++ and not have to open a file?"}, {"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "reply_to_user": {"reputation": 17, "user_id": 4850914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/359f9eae9313bba8b36b581a98594748?s=128&d=identicon&r=PG&f=1", "display_name": "newb12345", "link": "https://stackoverflow.com/users/4850914/newb12345"}, "edited": false, "score": 0, "creation_date": 1432166988, "post_id": 30362274, "comment_id": 48816259, "body": "@newb12345: Your question would be much clearer if you corrected your spelling and punctuation, and spelled out what &quot;it&quot; is."}, {"owner": {"reputation": 17, "user_id": 4850914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/359f9eae9313bba8b36b581a98594748?s=128&d=identicon&r=PG&f=1", "display_name": "newb12345", "link": "https://stackoverflow.com/users/4850914/newb12345"}, "edited": false, "score": 0, "creation_date": 1432167138, "post_id": 30362274, "comment_id": 48816302, "body": "In C++ implement a crisis center (&quot;triage program&quot;) for a hurricane center. You may use STL or your own code. Reused code must be explicitly acknowledged and your contribution clearly marked. As a software engineer for a local meteorological institute, you will be receiving weather reports containing: Weather station name Time and date GPS location Barometric pressure (in hectoPascal or inches of mercury) Wind speed (in km/h, mph, or knots) Temperature (in Celsius or Fahrenheit) Humidity (in percent) Wind direction"}, {"owner": {"reputation": 17, "user_id": 4850914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/359f9eae9313bba8b36b581a98594748?s=128&d=identicon&r=PG&f=1", "display_name": "newb12345", "link": "https://stackoverflow.com/users/4850914/newb12345"}, "edited": false, "score": 0, "creation_date": 1432167157, "post_id": 30362274, "comment_id": 48816308, "body": "Add those reports to a data structure that is appropriate for this problem. Based on this data collection how would you:  Find the highest wind speed, followed by lesser speeds, showing each data entry (the weather report above) Find the lowest barometric pressure, followed by higher pressure, showing each data entry as above FInd the 10 most recent reports Find all the reports from a particular weather station"}, {"owner": {"reputation": 17, "user_id": 4850914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/359f9eae9313bba8b36b581a98594748?s=128&d=identicon&r=PG&f=1", "display_name": "newb12345", "link": "https://stackoverflow.com/users/4850914/newb12345"}, "reply_to_user": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1432167197, "post_id": 30362274, "comment_id": 48816319, "body": "This is what needs to be done @Beta and sorry for my spelling and punctuation errors."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 17, "user_id": 4850914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/359f9eae9313bba8b36b581a98594748?s=128&d=identicon&r=PG&f=1", "display_name": "newb12345", "link": "https://stackoverflow.com/users/4850914/newb12345"}, "edited": false, "score": 0, "creation_date": 1432169174, "post_id": 30362274, "comment_id": 48816819, "body": "@newb12345 best thing to do is answer a few questions for yourself before writing much more code. First is how do things get in and out? Are you fed data from the keyboard? A file? a network socket? How does the client, assuming an instructor, want the output? Do they want a file? A listing printed to the screen? An Alert E-mail? Once you know how you are getting data in and out, you can start worrying about how you are going to store and organize. If you get hung up at that point, best to ask a new question."}, {"owner": {"reputation": 17, "user_id": 4850914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/359f9eae9313bba8b36b581a98594748?s=128&d=identicon&r=PG&f=1", "display_name": "newb12345", "link": "https://stackoverflow.com/users/4850914/newb12345"}, "edited": false, "score": 0, "creation_date": 1432169526, "post_id": 30362274, "comment_id": 48816915, "body": "@user4581301 we didnt learn file handling yet so it would be displayed to the screen."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 17, "user_id": 4850914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/359f9eae9313bba8b36b581a98594748?s=128&d=identicon&r=PG&f=1", "display_name": "newb12345", "link": "https://stackoverflow.com/users/4850914/newb12345"}, "edited": false, "score": 0, "creation_date": 1432170302, "post_id": 30362274, "comment_id": 48817142, "body": "@newb12345 cin is a stream and operates the same as file stream you&#39;re playing with, so most of the stuff I&#39;m talking about, the <code>getline</code> and chaining <code>&gt;&gt;</code>, can be used to read from the keyboard. For example <code>if (getline(cin, report-&gt;unitType) &amp;&amp;  getline(cin, report-&gt;stationName) &amp;&amp; ...)</code>"}], "tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": false, "score": 0, "last_activity_date": 1432167285, "last_edit_date": 1432167285, "creation_date": 1432165932, "answer_id": 30362274, "question_id": 30362037, "link": "https://stackoverflow.com/questions/30362037/infinite-loop-in-c-why/30362274#30362274", "title": "Infinite loop in C++ why?", "body": "<p>Important part. If you read nothing else, read this: Always check the error codes and return values.</p>\n\n<p>After <code>ifstream input(filename);</code> you have no idea if the file opened. Testing with <code>input.is_open()</code> gets past that. </p>\n\n<p>If the file isn't open, all those calls to <code>getline</code> fail as does <code>eof()</code>. File not open, can't read end of file and can't exit loop. Even if the the file is open, if you don't check the output of getline, how do you know you read a line? </p>\n\n<p>One of the fun parts of streams is if you test the stream, it tells you if it is in a bad state, so you can write code that looks like </p>\n\n<pre><code>if (getline(...) &amp;&amp; getline(...) &amp;&amp; ...)\n</code></pre>\n\n<p>So you don't have to make a massive block of if-else-if or a sea of nested ifs. First bad read and you are out.</p>\n\n<p>The problem with <code>if eof()</code> is covered in the comments to the question. The basic is you don't know if you got the end of the file until you start reading. Also, what happen if you hit the end of the file in the middle of a bunch of reads? </p>\n\n<p>So read a line. If it's good, read the next line, etc... until done.</p>\n\n<p>getInt isn't necessary. </p>\n\n<pre><code>int val;\ninput &gt;&gt; val;\n</code></pre>\n\n<p>loads an integer into val, if the stream can be parsed into an int. If it can't, input is marked bad and you can check why. Could be unparsable. Could be end of file.</p>\n\n<pre><code>int val;\nif (input &gt;&gt; val)\n{\n    //do stuff\n} \nelse\n{\n    //no int here. Do other stuff\n}\n</code></pre>\n\n<p>Just like above, you can chain the instructions and get </p>\n\n<pre><code>if (input &gt;&gt; val &gt;&gt; anotherval &gt;&gt; ...)\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4850914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/359f9eae9313bba8b36b581a98594748?s=128&d=identicon&r=PG&f=1", "display_name": "newb12345", "link": "https://stackoverflow.com/users/4850914/newb12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1432167285, "creation_date": 1432164355, "question_id": 30362037, "link": "https://stackoverflow.com/questions/30362037/infinite-loop-in-c-why", "title": "Infinite loop in C++ why?", "body": "<p>Im sorry about posting a super long code, but when I run this code all I see is this-\nHeap size: 1638652\nGetting int: \nGetting int: \nGetting int: \nGetting int: \nGetting int: \nHeap size: 1638653\nand it keeps going in a loop with the heapsize being incremented by one.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;algorithm&gt;\n#include &lt;vector&gt;\n#include &lt;exception&gt;\n\n#ifndef WX_REPORT_H\n#define WX_REPORT_H\n\n\n#include &lt;string&gt;\n#include &lt;sstream&gt;\nusing std::string;\nusing std::stringstream;\n\ntypedef struct WX_REPORT\n\n{\n    string unitType;\n    string stationName;\n    string time;\n    string gpsLoc;\n    int pressure;\n    int windSpeed;\n    int temperature;\n    int humidity;\n    int windDirection;\n\n    string toString()\n    {\n        stringstream str;\n        str &lt;&lt; stationName &lt;&lt; \": \" &lt;&lt; time &lt;&lt; \"\\t\" &lt;&lt; gpsLoc &lt;&lt; \"\\n\";\n        str &lt;&lt; pressure &lt;&lt; \"\\n\" &lt;&lt; windSpeed &lt;&lt; \"\\n\" &lt;&lt; temperature &lt;&lt; \"\\n\";\n        str &lt;&lt; humidity &lt;&lt; \"\\n\" &lt;&lt; windDirection;\n        return str.str();\n    }\n}\nWXReport;\n\n#endif\n/*\n * Reports must be in the following format:\n * M or I // Metric or imperial units\n */\nusing namespace std;\n\nvector&lt;WXReport*&gt; heap;\n\nbool compTime(const WXReport* a, const WXReport* b) {\n    if(a-&gt;time &lt; b-&gt;time) { // timing\n        return false;\n    } else {\n        return true; // commands to return true\n    }\n}\n\nvoid heapAdd(WXReport* wx) {\n    heap.push_back(wx);\n    push_heap(heap.begin(), heap.end());\n}\n\nWXReport* heapPop() { // header popup\n    pop_heap(heap.begin(), heap.end());\n    WXReport* rep = heap.back();\n    heap.pop_back();\n    return rep;\n}\n\nvoid getInt(istream &amp;input, int &amp;i) {\n    string temp;\n    input&gt;&gt;temp;\n    cout&lt;&lt;\"Getting int: \"&lt;&lt;temp&lt;&lt;endl;\n    i = atoi(temp.c_str());\n}\n\nvoid readInFile(string filename) {\n    ifstream input(filename);\n    WXReport *report;\n    while(!input.eof()) {\n        report = new WXReport();\n        getline(input, report-&gt;unitType);\n        getline(input, report-&gt;stationName);\n        getline(input, report-&gt;time);\n        getline(input, report-&gt;gpsLoc);\n        getInt(input, report-&gt;pressure);\n        getInt(input, report-&gt;windSpeed);\n        getInt(input, report-&gt;temperature);\n        getInt(input, report-&gt;humidity);\n        getInt(input, report-&gt;windDirection);\n        heapAdd(report);\n        cout&lt;&lt;\"Heap size: \"&lt;&lt;heap.size()&lt;&lt;endl;\n    }\n}\n\nint menu() {\n    cout&lt;&lt;\"\\n\\nPlease select one: \"&lt;&lt;endl;\n    cout&lt;&lt;\"1) Read in another file\"&lt;&lt;endl;\n    cout&lt;&lt;\"2) Display the fastest wind speed\"&lt;&lt;endl;\n    cout&lt;&lt;\"3) Display weather stations by name\"&lt;&lt;endl;\n    cout&lt;&lt;\"4) Display all weather reports\"&lt;&lt;endl;\n    cout&lt;&lt;\"5) Remove a weather report\"&lt;&lt;endl;\n    cout&lt;&lt;\"6) Write weather reports to file\"&lt;&lt;endl;\n    cout&lt;&lt;\"0) Exit\"&lt;&lt;endl;\n    int choice;\n    cin&gt;&gt;choice;\n    return choice;\n}\n\nvoid printAllReports() {\n    cout&lt;&lt;\"Printing all reports\"&lt;&lt;endl;\n    for(WXReport* rep: heap) {\n        cout&lt;&lt;rep-&gt;toString()&lt;&lt;endl;\n    }\n    cout&lt;&lt;\"Done printing reports\"&lt;&lt;endl;\n}\n\nint main(int argc, char* argv[]) {\n    string filename = \"report.txt\";\n    readInFile(filename);\n\n    int choice = menu();\n    while(choice != 0) {\n        switch(choice) {\n            case 1:\n                cout&lt;&lt;\"What file would you like to read in?\"&lt;&lt;endl;\n                cin&gt;&gt;filename;\n                readInFile(filename);\n                break;\n            case 2:\n                cout&lt;&lt;\"Has not been implemented\"&lt;&lt;endl;\n                break;\n            case 3:\n                cout&lt;&lt;\"Has not been implemented\"&lt;&lt;endl;\n                break;\n            case 4:\n                printAllReports();\n                break;\n            case 5:\n                cout&lt;&lt;\"Has not been implemented\"&lt;&lt;endl;\n                break;\n            case 6:\n                cout&lt;&lt;\"Has not been implemented\"&lt;&lt;endl;\n                break;\n            default:\n                cout&lt;&lt;\"Invalid choice, please try again.\"&lt;&lt;endl;\n        }\n        choice = menu();\n    }\n    cout&lt;&lt;\"Thank you!\"&lt;&lt;endl;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "class", "oop", "polymorphism", "virtual"], "comments": [{"owner": {"reputation": 3282, "user_id": 1526037, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JEPKq.jpg?s=128&g=1", "display_name": "sbolel", "link": "https://stackoverflow.com/users/1526037/sbolel"}, "edited": false, "score": 0, "creation_date": 1432168940, "post_id": 30362011, "comment_id": 48816758, "body": "I made a <a href=\"https://gist.github.com/sbolel/c5502a42f29e1b2e6b07\" rel=\"nofollow noreferrer\">Gist</a> with your code, and slightly improved the code formatting. I also added some comments that may help. If you look at the <code>main()</code> function, my comment might address your last question with the error in <code>new Business()</code>."}, {"owner": {"reputation": 12139, "user_id": 2412846, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/eBJip.gif?s=128&g=1", "display_name": "davidhigh", "link": "https://stackoverflow.com/users/2412846/davidhigh"}, "edited": false, "score": 0, "creation_date": 1432171741, "post_id": 30362011, "comment_id": 48817499, "body": "(i) you don&#39;t need the destructor, so drop it (otherwise you&#39;d probably would have to consider the rule of three/five) (ii) use <code>virtual</code> in front of any polymorphic function (not just in the base class), and in addition, use <code>override</code>. That should avoid your overloading ambiguities."}], "answers": [{"tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 0, "last_activity_date": 1432165020, "creation_date": 1432165020, "answer_id": 30362135, "question_id": 30362011, "link": "https://stackoverflow.com/questions/30362011/conception-and-syntax-errors-in-oop-are-non-virtual-methods-in-daughter-classes/30362135#30362135", "title": "conception and syntax errors in OOP. Are non virtual methods in daughter classes that are redefined from the mother class masked?", "body": "<p>Almost all classes, if they are written in c++11 or better and are designed properly will not have user-defined destructors, user-defined copy operators or user-defined move operators.</p>\n\n<p>There is a very good reason for this, which is that if you don't define any of these, the compiler will generate correct versions for you.</p>\n\n<p>In your case, the vector of <code>Bill</code> is managing the lifetime of the bills through std::unique_ptr (good!!). This means that lifetimes will be correctly managed automatically and your first intuition was correct - simply remove the destructor and let the compiler do the right thing.</p>\n\n<p>Your friend's suggestion to replace delete with .reset() was also correct, but convoluted and un-necessary.</p>\n"}], "owner": {"reputation": 1, "user_id": 4793480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f511613c680e0149573180bc7ad785?s=128&d=identicon&r=PG&f=1", "display_name": "Computeramateur", "link": "https://stackoverflow.com/users/4793480/computeramateur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432169859, "creation_date": 1432164148, "last_edit_date": 1432169859, "question_id": 30362011, "link": "https://stackoverflow.com/questions/30362011/conception-and-syntax-errors-in-oop-are-non-virtual-methods-in-daughter-classes", "title": "conception and syntax errors in OOP. Are non virtual methods in daughter classes that are redefined from the mother class masked?", "body": "<p>For an example, we were given sample code where we had to find its errors and give explanations as to why there were errors. The questions I have are numbered 1-5.</p>\n\n<h3>First part</h3>\n\n<p>We had a class, <code>Flight</code>, declared as follows: </p>\n\n<pre><code>class Flight {\npublic:\n~Flight(){for(auto &amp; b: places) delete b; }\n....\n..\nprivate: \nvector&lt;unique_ptr&lt;Bill&gt;&gt;places; //bill is a previously declared class\n}; \n</code></pre>\n\n<p>I said that is because <code>b</code> is a unique_ptr and we can't delete them, they are deleted by default. So my suggestion was that we could either change the attribute and take normal points in C, <code>vector&lt;Bill*&gt;places;</code> or just remove the destructor. However, someone suggested that we write instead <code>b.reset();</code></p>\n\n<ol>\n<li>Can someone explain to me what is the purpose of that as opposed to just removing the destructor? Which is better to do, and why?</li>\n</ol>\n\n<h3>Second part</h3>\n\n<p>There are other conceptual mistakes, and I am not sure if I am right. The rest of the code is as follows: </p>\n\n<pre><code>class Sell {\npublic: \nvirtual ~ Sell(){}\nvirtual double price() const = 0; \nprotected: \ndouble base_price; \n}; \n\nclass Bill : public Sell {\npublic: \nBill(int id, double price, string name, bool vegetarian) etc{}\nvirtual ~Bill()\n\n{}\nvirtual ostream&amp; display(ostream&amp; out) const \nout &lt;&lt; \"no. \" &lt;&lt; id &lt;&lt; \" for \" &lt;&lt; name &lt;&lt; endl; return out; \n}\n\ndouble price() const{\nif(vegetarian) { return base_price() - 20; }\n else { return base_price(); }\n}\n\nprivate: int id; string name; bool vegetarian; \n}; \n\nostream&amp; operator &lt;&lt; (ostream&amp; out, const Bill&amp; bill){ return bill.display(out); }\n\nclass Business : public Bill {\npublic: Business(int id, double base_price.........)etc\nvirtual ~Business() { ~Bill(); }\n\nostream&amp; display(ostream&amp; out ) const {\nout &lt;&lt; \"business \"; \nBill::display(out); \nif (extra_space){ out &lt;&lt; \"with supplementary space. \" ; }\nreturn out; \n}\n\ndouble price() {\ndouble p(Bill::price()); \nif(extra_space) { p*= 1.5; }\nreturn p; \n}\n\nprivate: bool extra_space; \n}; \n\n//then there is class Flight as defined above. \nclass Flight {\n    public:\n    ~Flight(){for(auto &amp; b: places) delete b; }\n    void sold(Bill* b){ places.push_back(unique_ptr&lt;Bill&gt;(b)); }\n    void display() const {\nfor(auto const&amp; b: places){cout &lt;&lt; \"The Bill \" &lt;&lt; *b &lt;&lt; \"is \" &lt;&lt; b-&gt;price() &lt;&lt; \"Dollars. \" &lt;&lt; endl; \n}}\n\n    ..\n    private: \n    vector&lt;unique_ptr&lt;Bill&gt;&gt;places; //bill is a previously declared class\n    }; \n\nint main(){\nFlight f1; \nf1.sold(new Bill(1,100,\"Chopin\", true)); \nf1.sold(new Business(2, 100, \"Sand, false, true)): \nf1.display() &lt;&lt; endl; \nreturn 0; \n}\n</code></pre>\n\n<ol start=\"2\">\n<li>There is a warning that says <code>virtual double Bill::price() const</code> was hidden. I suggested this is masking and that the price function in the bill class should be virtual. Does this make sense?</li>\n<li>There was also a warning by <code>double Business::price() [Woverloaded-virtual]</code>. This, I don't understand, is this because there is no <code>const</code> in the <code>price()</code> class defined in <code>business</code>?</li>\n<li>Also, is <code>price()</code> considered as the same function in all the classes? Because I don't understand how if there is a missing <code>const</code> in the price of business, that it would compile. I would have thought it would not only display a warning but a compilation error...</li>\n<li>Finally, for the <code>main()</code> function, there is a problem with <code>(new Business)</code>, is this because we can only create an address for bill?</li>\n</ol>\n"}, {"tags": ["c++", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1432164180, "post_id": 30361988, "comment_id": 48815494, "body": "Those aren&#39;t objects; they&#39;re function declarations. I&#39;d start by fixing those first. And use <code>std::shared_ptr&lt;&gt;</code> if required. the last man out the door turns off the lights."}, {"owner": {"reputation": 19, "user_id": 4922226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10fdb6e156514fc3348d4b4bfb6e3d1d?s=128&d=identicon&r=PG&f=1", "display_name": "Kieren Pearson", "link": "https://stackoverflow.com/users/4922226/kieren-pearson"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1432164673, "post_id": 30361988, "comment_id": 48815662, "body": "Sorry for the noobieness, but what?"}, {"owner": {"reputation": 2493, "user_id": 4866989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8ea9d94abae12663ba3ad2564619081?s=128&d=identicon&r=PG&f=1", "display_name": "Tim3880", "link": "https://stackoverflow.com/users/4866989/tim3880"}, "edited": false, "score": 0, "creation_date": 1432166009, "post_id": 30361988, "comment_id": 48816032, "body": "To allocate the Lazer on heap, you need use Lazer * MyLazer= new Lazer(); MyShip.AddWeapon(MyLazer) ... And remember Delete it when you no longer need it."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1432166736, "post_id": 30361988, "comment_id": 48816199, "body": "<code>Ship MyShip();</code> means that <code>MyShip</code> is a function that takes no parameters and returns a <code>Ship</code>. Perhaps you meant <code>Ship MyShip;</code>?"}, {"owner": {"reputation": 19, "user_id": 4922226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10fdb6e156514fc3348d4b4bfb6e3d1d?s=128&d=identicon&r=PG&f=1", "display_name": "Kieren Pearson", "link": "https://stackoverflow.com/users/4922226/kieren-pearson"}, "edited": false, "score": 0, "creation_date": 1432169463, "post_id": 30361988, "comment_id": 48816894, "body": "Yes my bad I&#39;ll edit it thanks. So if I make it on the heap, it can&#39;t go out of scope?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1432169504, "post_id": 30361988, "comment_id": 48816904, "body": "Kieren, @WhozCraig is suggesting that you look up the <code>shared_ptr</code> class and use it wherever possible. It eliminates the <code>delete</code> book-keeping that @Tim3880 warns of by (simplified explanation) keeping a count of objects using the pointer. When there are no remaining users of the pointer, it is <code>delete</code>d for you. Handy."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4922226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10fdb6e156514fc3348d4b4bfb6e3d1d?s=128&d=identicon&r=PG&f=1", "display_name": "Kieren Pearson", "link": "https://stackoverflow.com/users/4922226/kieren-pearson"}, "edited": false, "score": 0, "creation_date": 1432188257, "post_id": 30362071, "comment_id": 48822388, "body": "Just a few more questions sorry, First, I&#39;m presuming that here <i>Weapon</i> that was a struct could be a class instead. Is this true? Second, why call the vector <i>_weapons</i>? Is the underscore a naming convention of vectors, or just to resolve a potential naming clash? Lastly what is <i>std::unique_ptr</i>? Is it the same as <i>shared_ptr</i>?"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 19, "user_id": 4922226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10fdb6e156514fc3348d4b4bfb6e3d1d?s=128&d=identicon&r=PG&f=1", "display_name": "Kieren Pearson", "link": "https://stackoverflow.com/users/4922226/kieren-pearson"}, "edited": false, "score": 0, "creation_date": 1432188407, "post_id": 30362071, "comment_id": 48822454, "body": "Yes, class and struct are the same thing except class is private by default and struct is public by default. The leading underscore is just the naming convention that I happen to use. Unique_ptr is a managed pointer that is not shareable. Have a read at cppreference.com"}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 2, "last_activity_date": 1432164618, "creation_date": 1432164618, "answer_id": 30362071, "question_id": 30361988, "link": "https://stackoverflow.com/questions/30361988/makng-instance-on-heap/30362071#30362071", "title": "Makng instance on &quot;Heap&quot;", "body": "<p>something like this is safest:</p>\n\n<pre><code>#include &lt;memory&gt;\n#include &lt;vector&gt;\n\nstruct Weapon {\n\n    virtual ~Weapon() = default;\n};\n\nstruct Lazer : Weapon {\n\n};\n\nclass Ship\n{\npublic:\n    void AddWeapon(std::unique_ptr&lt;Weapon&gt; weapon);\n\nprivate:\n    std::vector&lt;std::unique_ptr&lt;Weapon&gt;&gt; _weapons;\n};\n\nvoid Ship::AddWeapon(std::unique_ptr&lt;Weapon&gt; weapon)\n{\n    _weapons.push_back(std::move(weapon));\n}\n\n// test\n\nusing namespace std;\n\nint main(){\n    auto ship = std::make_unique&lt;Ship&gt;();\n    ship-&gt;AddWeapon(std::make_unique&lt;Lazer&gt;());\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 4922226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10fdb6e156514fc3348d4b4bfb6e3d1d?s=128&d=identicon&r=PG&f=1", "display_name": "Kieren Pearson", "link": "https://stackoverflow.com/users/4922226/kieren-pearson"}, "edited": false, "score": 0, "creation_date": 1432169544, "post_id": 30362433, "comment_id": 48816927, "body": "Yea this was what I thought would be possible thanks!"}], "tags": [], "owner": {"reputation": 176, "user_id": 4452480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3827ac4e0c56c3fef11ea4c64e385fa6?s=128&d=identicon&r=PG&f=1", "display_name": "chishui", "link": "https://stackoverflow.com/users/4452480/chishui"}, "is_accepted": false, "score": 0, "last_activity_date": 1432167003, "creation_date": 1432167003, "answer_id": 30362433, "question_id": 30361988, "link": "https://stackoverflow.com/questions/30361988/makng-instance-on-heap/30362433#30362433", "title": "Makng instance on &quot;Heap&quot;", "body": "<p>You should create weapon instance from heap using \"new\", then you can decide when to delete the instance you create. You also should use parent class pointer to point you instance, that's called dynamic binding.</p>\n\n<pre><code>int main()\n{\n    Ship MyShip();\n    Weapon * p = new MyLazer();\n    MyShip.AddWeapon(p)\n}    \n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 4922226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10fdb6e156514fc3348d4b4bfb6e3d1d?s=128&d=identicon&r=PG&f=1", "display_name": "Kieren Pearson", "link": "https://stackoverflow.com/users/4922226/kieren-pearson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1432169482, "creation_date": 1432164009, "last_edit_date": 1432169482, "question_id": 30361988, "link": "https://stackoverflow.com/questions/30361988/makng-instance-on-heap", "title": "Makng instance on &quot;Heap&quot;", "body": "<p>I have a class, called <code>Ship()</code> and it looks like this</p>\n\n<pre><code>class Ship()\n{\npublic:\n    vector&lt;Weapon*&gt; Weapon\n    void AddWeapon(Weapon*)\n}\n\nvoid MyShip::AddWeapon(Weapon*)\n{\n    Weapons.pushback(Weapon)\n}\n</code></pre>\n\n<p>The <code>Weapon</code> class is an abstract base class, that must be derived from, for each type of weapon in the game. One of which is called <code>Lazer</code></p>\n\n<p>So in my code I can do:</p>\n\n<pre><code>int main()\n{\n    Ship MyShip;\n    Lazer MyLazer;\n    MyShip.AddWeapon(&amp;MyLazer)\n}\n</code></pre>\n\n<p>How do I make sure the object pointed to by the vector in <code>Weapons</code> does not go out of scope? I believe the answer is making the instance on the <code>heap</code> but I don't know.</p>\n"}, {"tags": ["c#", "c++", "c", "marshalling", "free"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1432164052, "post_id": 30361975, "comment_id": 48815456, "body": "Do you have an idea of what <code>free()</code>ing memory means?, if you do the equivalent in c, you would cause undefined behavior, you shall not <code>free()</code> static memory."}, {"owner": {"reputation": 339, "user_id": 3406177, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/100003105027998/picture?type=large", "display_name": "Aladdin", "link": "https://stackoverflow.com/users/3406177/aladdin"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1432164433, "post_id": 30361975, "comment_id": 48815588, "body": "i can allocate the memory using Marshal class, and set the value and after finishing free it with the proper method, but it&#39;s too mush compared to MarshalAs magical attribute"}, {"owner": {"reputation": 339, "user_id": 3406177, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/100003105027998/picture?type=large", "display_name": "Aladdin", "link": "https://stackoverflow.com/users/3406177/aladdin"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1432164566, "post_id": 30361975, "comment_id": 48815630, "body": "using MSCRV free method on that marshaled memory location caused the application to abort, what I&#39;m asking is what&#39;s the proper method to free this location of memory"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1432166179, "post_id": 30361975, "comment_id": 48816074, "body": "The C code is very evil, it returns a <a href=\"http://en.wikipedia.org/wiki/Dangling_pointer\" rel=\"nofollow noreferrer\">dangling pointer</a>.  If it did not reallocate <i>text</i> then the memory was already released after it returns since the pinvoke marshaller owns it.  Looks like it works, but then it randomly doesn&#39;t when you&#39;re not looking.  Also high odds that it will corrupt the heap while writing *text.  If it does allocate then you can&#39;t release it unless it used an allocator that your C# code has access to."}], "owner": {"reputation": 339, "user_id": 3406177, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/100003105027998/picture?type=large", "display_name": "Aladdin", "link": "https://stackoverflow.com/users/3406177/aladdin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1432163953, "creation_date": 1432163953, "question_id": 30361975, "link": "https://stackoverflow.com/questions/30361975/free-c-automatically-marshalled-data-using-marashalas-attribute", "title": "Free C# Automatically Marshalled Data using MarashalAs Attribute", "body": "<p>CLR can marshal managed types into unmanaged c/c++ types using marshal as attrubte\nwhat I need is that what is the proper method to free this allocated memory.. for example::</p>\n\n<p>in C/C++ code</p>\n\n<pre><code>char* dummy(char* text){\n//do some thing\nreturn text;//dummy way to return it to the caller to free it.\n}\n</code></pre>\n\n<p>and in C#</p>\n\n<pre><code>[DllImport(\"test.dll\",CallingConvention=CallingConvention.Cdecl)]\nstatic extern IntPtr dummy([MarshalAs(UnmanagedType.LPStr)] string text);\n</code></pre>\n\n<p>and finally the test</p>\n\n<pre><code>    C# Test\nIntPtr marshaledData=dummy(\"any text\");\n//what is the proper way to free this memory location\n</code></pre>\n"}, {"tags": ["c++", "c++11", "static-members", "constexpr"], "comments": [{"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 1, "creation_date": 1432163162, "post_id": 30361706, "comment_id": 48815178, "body": "The bodies of member functions are compiled as if they were located after the class definition. That is, the class is complete within the member function bodies. (See also <a href=\"http://www.open-std.org/JTC1/SC22/WG21/docs/cwg_active.html#1255\" rel=\"nofollow noreferrer\">CWG 1255</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 2942, "user_id": 4821282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66fcf596fdff8b28c477a9105501c8a2?s=128&d=identicon&r=PG&f=1", "display_name": "phantom", "link": "https://stackoverflow.com/users/4821282/phantom"}, "is_accepted": true, "score": 9, "last_activity_date": 1432164442, "creation_date": 1432164442, "answer_id": 30362048, "question_id": 30361706, "link": "https://stackoverflow.com/questions/30361706/static-constexpr-members-of-same-type-as-class-defined-additional-details/30362048#30362048", "title": "Static constexpr members of same type as class defined (additional details)", "body": "<p>As @dyp mentioned the solution for <code>one</code> compiles because function definitions are compiled after the class body. So it is like <code>one</code> has been declared like this</p>\n\n<pre><code>class MyEnum\n{\npublic:\n    static constexpr const MyEnum one();\n    //... Definition here\n};  //Class is fully defined after here\n\ninline static constexpr const MyEnum MyEnum::one() { return MyEnum(1); }\n                      //Fine here because class is complete ^^^^\n</code></pre>\n\n<p>On the other hand, definitions in the class body are compiled as they are placed in the class body. So when <code>two</code> and <code>three</code> are being compiled the class is not fully defined yet.</p>\n"}], "owner": {"reputation": 556, "user_id": 2870660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UpxBk.png?s=128&g=1", "display_name": "Hurzelchen", "link": "https://stackoverflow.com/users/2870660/hurzelchen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 0, "accepted_answer_id": 30362048, "answer_count": 1, "score": 8, "last_activity_date": 1432164442, "creation_date": 1432162247, "last_edit_date": 1495542775, "question_id": 30361706, "link": "https://stackoverflow.com/questions/30361706/static-constexpr-members-of-same-type-as-class-defined-additional-details", "title": "Static constexpr members of same type as class defined (additional details)", "body": "<p>While writing my initial question, if this is even possible, I stumbled about the question <a href=\"https://stackoverflow.com/questions/11928089\">static constexpr member of same type as class being defined</a>, which quite clearly answered that my clean solution is not possible with C++11.</p>\n\n<p>But then I came up with this code which is quite close to the original poster and I want to achieve:</p>\n\n<pre><code>class MyEnum\n{\npublic:\n    constexpr MyEnum() : m_null(true), m_value(0) { }\n    constexpr MyEnum(const unsigned int v) : m_null(false), m_value(v) { }\n\n    constexpr operator unsigned int() const { return m_value; }\n\n    static constexpr const MyEnum one() { return MyEnum(1); }\n\nprivate:\n    bool m_null;\n    unsigned int m_value;\n};\n</code></pre>\n\n<p>So I'm rephrasing my question: Why does the solution for <code>one</code> compile and can be used as you would expect it but the following solutions give errors about using an incomplete class?</p>\n\n<pre><code>class MyEnum\n{\npublic:\n    // snip...\n\n    static constexpr const MyEnum two = MyEnum(2);\n    static constexpr const MyEnum three = 3;\n\n    // snip...\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "qt", "gcc", "shared-libraries"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1432163605, "post_id": 30361699, "comment_id": 48815319, "body": "Even if you could dump all the symbols from the shared library, you cannot provide the prototypes to call the functions correctly, I think I would write a python script to extract all the function prototypes from the header file and generate c++ code to be used in the program, you can even make it a step of the build process so the code is updated on demand. <b>clang</b> has a nice python and even c++ interface for parsing c code, which would help making the process robust. If you can hire me, I can do it."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1432165550, "post_id": 30361699, "comment_id": 48815919, "body": "The statement &quot;However, when I link at runtime via dlopen, I won&#39;t be able to include the header file.&quot; makes no sense. Even if you didn&#39;t &quot;link at runtime via dlopen&quot;, you still &quot;won&#39;t be able to include the header file.&quot; Header files have absolutely nothing to do with runtime. Header files are included at compile time. What happens at runtime is completely unrelated. You can include a header files, make use of its #define-s, etc., in your code, and as long as your code does not directly reference symbols from an external library, you can dlopen it, and resolve its symbols with dlsym."}, {"owner": {"reputation": 1719, "user_id": 2619479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/127aeef4e048febca4fd6560b465359d?s=128&d=identicon&r=PG", "display_name": "Marco", "link": "https://stackoverflow.com/users/2619479/marco"}, "edited": false, "score": 0, "creation_date": 1432197808, "post_id": 30361699, "comment_id": 48827854, "body": "if you want to link at runtime why do not you use QLibrary?"}], "answers": [{"comments": [{"owner": {"reputation": 257, "user_id": 933838, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c88f6d5cd429b54e371cb56f2cc8b083?s=128&d=identicon&r=PG", "display_name": "Josh A.", "link": "https://stackoverflow.com/users/933838/josh-a"}, "edited": false, "score": 0, "creation_date": 1432212885, "post_id": 30365040, "comment_id": 48838533, "body": "Mainly because this is an enormous project and this requirement would introduce the only compile-time, form factor specific dependency. Also, it would be nice if a stripped down desktop could load libfoo-phone.so in certain situations not determined at compile time."}], "tags": [], "owner": {"reputation": 753, "user_id": 2172459, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/750bdd93b854a92288fec857151718b4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/2172459/pat"}, "is_accepted": false, "score": 2, "last_activity_date": 1432185009, "creation_date": 1432185009, "answer_id": 30365040, "question_id": 30361699, "link": "https://stackoverflow.com/questions/30361699/how-to-use-a-library-loaded-at-runtime-in-c-and-qt/30365040#30365040", "title": "How to use a library loaded at runtime in C++ and Qt", "body": "<p>Why link at runtime?  Just link to the appropriate .so depending on the current build target (phone vs desktop).  The platforms dynamic linker will load the *.so for you automatically when the executable is run, and you don't have to worry about runtime loading of a library.  You can include the header, reference the symbols all you want, and there won't be any problems.</p>\n"}], "owner": {"reputation": 257, "user_id": 933838, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c88f6d5cd429b54e371cb56f2cc8b083?s=128&d=identicon&r=PG", "display_name": "Josh A.", "link": "https://stackoverflow.com/users/933838/josh-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432185009, "creation_date": 1432162219, "question_id": 30361699, "link": "https://stackoverflow.com/questions/30361699/how-to-use-a-library-loaded-at-runtime-in-c-and-qt", "title": "How to use a library loaded at runtime in C++ and Qt", "body": "<p>I currently have an application that runs on a desktop and a phone. The desktop requires a full-featured libfoo.so, but the mobile version only requires a small subset of libfoo.so. Someone else has already implemented libfoo-phone.so, and it uses the same function names as libfoo.so for the functions that it actually implements. </p>\n\n<p>I am currently including libfoo-phone.h, which works as usual because its being linked against at compile time. However, when I link at runtime via dlopen, I won't be able to include the header file. Is there an easy way to make this work without a huge wrapper that makes 100's of calls to dlsym?</p>\n"}, {"tags": ["c++", "parsing", "boost", "boost-spirit"], "comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1432167001, "post_id": 30361656, "comment_id": 48816262, "body": "You might like to see similar grammars: <a href=\"http://stackoverflow.com/questions/24122557/how-to-parse-mustache-with-boost-xpressive-correctly/24131286#24131286\">Parsing Mustache</a> or <a href=\"http://stackoverflow.com/q/18453062/85371\">nested <code>{}</code> parser</a>"}, {"owner": {"reputation": 79, "user_id": 956452, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dcf0a20d957dbeed0f6b8958ea92aa96?s=128&d=identicon&r=PG", "display_name": "tantra35", "link": "https://stackoverflow.com/users/956452/tantra35"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1432197334, "post_id": 30361656, "comment_id": 48827555, "body": "I sovle the issue when change <code>data = (text | imgtag | vartag | inctag | blktag | reftag) &gt;&gt; *data;</code> to <code>data = (text | imgtag | vartag | inctag | blktag | reftag) &gt;&gt; -data;</code>, but solution by <b>sehe</b> much better"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 956452, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dcf0a20d957dbeed0f6b8958ea92aa96?s=128&d=identicon&r=PG", "display_name": "tantra35", "link": "https://stackoverflow.com/users/956452/tantra35"}, "edited": false, "score": 0, "creation_date": 1432197075, "post_id": 30362395, "comment_id": 48827411, "body": "Wow, very cool.But in this situation i misunderstand, how filled CMyTag struct, this is not obvious"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 79, "user_id": 956452, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dcf0a20d957dbeed0f6b8958ea92aa96?s=128&d=identicon&r=PG", "display_name": "tantra35", "link": "https://stackoverflow.com/users/956452/tantra35"}, "edited": false, "score": 0, "creation_date": 1432197957, "post_id": 30362395, "comment_id": 48827964, "body": "Automatic attribute propagation: the fusion adaptation exposes the struct as a <code>fusion::vector2&lt;string, string&gt;</code> so when your parser &quot;naturally&quot; synthesizes a compatible attribute type (as documented <a href=\"http://www.boost.org/doc/libs/1_58_0/libs/spirit/doc/html/spirit/qi/reference/operator/sequence.html#spirit.qi.reference.operator.sequence.attributes\" rel=\"nofollow noreferrer\">here: <code>tuple&lt;A, B&gt;</code></a> assignment to the attribute referenced will be automatic."}, {"owner": {"reputation": 79, "user_id": 956452, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dcf0a20d957dbeed0f6b8958ea92aa96?s=128&d=identicon&r=PG", "display_name": "tantra35", "link": "https://stackoverflow.com/users/956452/tantra35"}, "edited": false, "score": 0, "creation_date": 1432199200, "post_id": 30362395, "comment_id": 48828826, "body": "Also this parser work unproperly for example <code>asd  {img} alksdla {blank} {img}s {ref S 0x5464564}s</code> and second text must be &quot; alksdla &quot;, but it have follow content &quot;alksdla &quot;, not space at begining"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 79, "user_id": 956452, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dcf0a20d957dbeed0f6b8958ea92aa96?s=128&d=identicon&r=PG", "display_name": "tantra35", "link": "https://stackoverflow.com/users/956452/tantra35"}, "edited": false, "score": 0, "creation_date": 1432199704, "post_id": 30362395, "comment_id": 48829193, "body": "@RuslanUsifov Well, I had to make up something &quot;reasonable&quot; out of a very complicated grammar that didn&#39;t work! Next time, specify the expected output. Changing that is exceedingly simple: <b><a href=\"http://coliru.stacked-crooked.com/a/78b0bedaa45f0072\" rel=\"nofollow noreferrer\">Live On Coliru</a></b>. It&#39;s probably ok if you spend some time learning the new things here :). Also note this is why I <a href=\"http://stackoverflow.com/questions/30361656/r/30362395?noredirect=1#comment48827555_30361656\">linked</a> the other two examples. Looks like they do exactly what you are doing here."}, {"owner": {"reputation": 79, "user_id": 956452, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dcf0a20d957dbeed0f6b8958ea92aa96?s=128&d=identicon&r=PG", "display_name": "tantra35", "link": "https://stackoverflow.com/users/956452/tantra35"}, "edited": false, "score": 0, "creation_date": 1432200288, "post_id": 30362395, "comment_id": 48829605, "body": "I didn&#39;t mean to offend you, You post if very useful fo me, as i nube. In the first example output is as expected. So I think that Skipper and phrase_parse is not apply in this situation, and i must use qi::parse, but its very strange that space cut only from begining, I was think that in case of phrase_parse spaces will be removed from beginning and end of string(like trim does)"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 79, "user_id": 956452, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dcf0a20d957dbeed0f6b8958ea92aa96?s=128&d=identicon&r=PG", "display_name": "tantra35", "link": "https://stackoverflow.com/users/956452/tantra35"}, "edited": false, "score": 0, "creation_date": 1432200387, "post_id": 30362395, "comment_id": 48829668, "body": "My answer already linked to this: <b><i>&quot;See also <a href=\"http://stackoverflow.com/questions/17072987/boost-spirit-skipper-issues/17073965#17073965\">Boost spirit skipper issues</a>&quot;</i></b> to explain the relation between skippers and <code>lexeme</code>. It explains it. Also I thought that was what you wanted, from reading the original rules (specifically your <code>+lit(&#39; &#39;)</code>)"}, {"owner": {"reputation": 79, "user_id": 956452, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dcf0a20d957dbeed0f6b8958ea92aa96?s=128&d=identicon&r=PG", "display_name": "tantra35", "link": "https://stackoverflow.com/users/956452/tantra35"}, "edited": false, "score": 0, "creation_date": 1432247913, "post_id": 30362395, "comment_id": 48860263, "body": "For example if we want to escape { symbol, and as result doesn&#39;t recognize \\{img\\} as tag, how can this be implemented more effectively? Thanks"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 79, "user_id": 956452, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dcf0a20d957dbeed0f6b8958ea92aa96?s=128&d=identicon&r=PG", "display_name": "tantra35", "link": "https://stackoverflow.com/users/956452/tantra35"}, "edited": false, "score": 0, "creation_date": 1432248081, "post_id": 30362395, "comment_id": 48860317, "body": "Please look at the linked samples. They do this, AFAIR."}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 2, "last_activity_date": 1432189533, "last_edit_date": 1495541155, "creation_date": 1432166791, "answer_id": 30362395, "question_id": 30361656, "link": "https://stackoverflow.com/questions/30361656/strange-static-cast-compilation-error-while-compile-boost-spirit-parser/30362395#30362395", "title": "Strange static_cast compilation error while compile boost spirit parser", "body": "<ol>\n<li><p>Firstly, I can only assume</p>\n\n<pre><code>data = (text | imgtag | vartag | inctag | blktag | reftag) &gt;&gt; *data;\n</code></pre>\n\n<p>was /meant/ as 1-or-more repeats of the (...) expression. Writing it as</p>\n\n<pre><code>data = +(text | imgtag | vartag | inctag | blktag | reftag);\n</code></pre>\n\n<p>expresses the same, but allows attribute propagation to match the exposes attribute type.</p></li>\n<li><p>There are a number of <code>lexeme[]</code> directives that have no purpose when not using a skipper</p></li>\n<li><p>There is a suspicious manual skipping of whitespace that might be better served by using a skipper</p></li>\n<li><p>Insofar as you do wish to require a mandatory space after the \"tag name\", consider using <code>operator&amp;</code> operator. That way you can still use a skipper. </p>\n\n<p>Anyhow, it's possible you were looking for something like the <a href=\"http://www.boost.org/doc/libs/1_58_0/libs/spirit/repository/doc/html/spirit_repository/qi_components/directives/distinct.html\" rel=\"nofollow noreferrer\">Qi Repository <code>distinct()[]</code> parser directive</a></p></li>\n<li><p>Even with a skipper</p>\n\n<pre><code>*(+lit(' ') &gt;&gt; lexeme[+(char_ - '{' - '}')])\n</code></pre>\n\n<p>doesn't make sense as <code>lexeme[...]</code> would eat any space up to closing '}' and hence the second repeat of the <code>*()</code> would never apply.</p>\n\n<blockquote>\n  <p>See also <a href=\"https://stackoverflow.com/questions/17072987/boost-spirit-skipper-issues/17073965#17073965\">Boost spirit skipper issues</a></p>\n</blockquote></li>\n<li><p>There is a lot of manual repetition between rules. Consider using <code>qi::symbols</code> to map the input to tag types.</p></li>\n<li><p>If you do, it becomes easier to avoid semantic actions (Good Thing: <a href=\"https://stackoverflow.com/questions/8259440/boost-spirit-semantic-actions-are-evil\">Boost Spirit: &quot;Semantic actions are evil&quot;?</a>). Even if you didn't, you could use <code>qi::attr</code> to expose a specific value as the <code>type</code> value.</p></li>\n<li><p>Consider adding debug information (see <code>BOOST_SPIRIT_DEBUG</code> in the demo below)</p></li>\n</ol>\n\n<h2>The grammar simplified</h2>\n\n<p>I'd reduce the whole grammar to just this:</p>\n\n<pre><code>data = +( ('{' &gt;&gt; tag &gt;&gt; '}') | text );\n\ntag  = lexeme[type &gt;&gt; &amp;char_(\" {}\")] &gt;&gt; lexeme[*~char_(\"{}\")];\ntext = attr(\"text\")                  &gt;&gt; lexeme[+~char_(\"{}\")];\n</code></pre>\n\n<p>Done! No more semantic actions, no more dozens of rules doing basically the same. No more complicated nested repeats with unclear multiplicities. <code>type</code> is a <code>qi::symbols</code> parser now, that contains the mapping of tag names:</p>\n\n<pre><code>type.add\n    (\"img\",   \"img\")\n    (\"var\",   \"var\")\n    (\"inc\",   \"inc\")\n    (\"blank\", \"blk\")\n    (\"ref\",   \"ref\");\n</code></pre>\n\n<p>And here's a complete demo:</p>\n\n<h1>DEMO</h1>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/eba1eab8516ba9e4\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>//#define BOOST_SPIRIT_DEBUG\n#include &lt;boost/fusion/adapted.hpp&gt;\n#include &lt;boost/spirit/include/qi.hpp&gt;\nnamespace qi  = boost::spirit::qi;\n\nstruct CMyTag\n{\n    std::string tagName;\n    std::string tagData;\n};\nBOOST_FUSION_ADAPT_STRUCT(::CMyTag, (std::string, tagName) (std::string, tagData))\n\ntemplate &lt;typename Iterator, typename Skipper = qi::space_type&gt;\nstruct testTag_grammar : qi::grammar&lt;Iterator, std::vector&lt;CMyTag&gt;(), Skipper&gt;\n{\n    testTag_grammar() :\n        testTag_grammar::base_type(data)\n    {\n        using namespace qi;\n\n        data = +( ('{' &gt;&gt; tag &gt;&gt; '}') | text );\n\n        type.add\n            (\"img\",   \"img\")\n            (\"var\",   \"var\")\n            (\"inc\",   \"inc\")\n            (\"blank\", \"blk\")\n            (\"ref\",   \"ref\");\n\n        tag  = lexeme[type &gt;&gt; &amp;char_(\" {}\")] &gt;&gt; lexeme[*~char_(\"{}\")];\n        text = attr(\"text\")                  &gt;&gt; lexeme[+~char_(\"{}\")];\n\n        BOOST_SPIRIT_DEBUG_NODES( (data) (tag) (text))\n    }\n\n  private:\n    qi::symbols&lt;char, std::string&gt; type;\n    qi::rule&lt;Iterator, CMyTag(), Skipper&gt;              tag, text;\n    qi::rule&lt;Iterator, std::vector&lt;CMyTag&gt;(), Skipper&gt; data;\n};\n\nint main() {\n    testTag_grammar&lt;std::string::const_iterator&gt; l_gramar;\n    std::string const l_test = \"asd {img} {ref I}sdkflsdlk {img} wmrwerml\";\n\n    std::vector&lt;CMyTag&gt; l_result;\n    auto f = l_test.begin(), l = l_test.end();\n    bool result = qi::phrase_parse(f, l, l_gramar, qi::space, l_result);\n\n    if (result) {\n        std::cout &lt;&lt; \"Parse success: \" &lt;&lt; l_result.size() &lt;&lt; \"\\n\";\n\n        for (auto&amp; v : l_result)\n            std::cout &lt;&lt; \"Name '\" &lt;&lt; v.tagName &lt;&lt; \"', Data '\" &lt;&lt; v.tagData &lt;&lt; \"'\\n\";\n    }\n    else {\n        std::cout &lt;&lt; \"Parse failed\\n\";\n    }\n\n    if (f!=l) {\n        std::cout &lt;&lt; \"Remaining unparsed: '\" &lt;&lt; std::string(f,l) &lt;&lt; \"'\\n\";\n    }\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>Parse success: 6\nName 'text', Data 'asd '\nName 'img', Data ''\nName 'ref', Data 'I'\nName 'text', Data 'sdkflsdlk '\nName 'img', Data ''\nName 'text', Data 'wmrwerml'\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 956452, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dcf0a20d957dbeed0f6b8958ea92aa96?s=128&d=identicon&r=PG", "display_name": "tantra35", "link": "https://stackoverflow.com/users/956452/tantra35"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 2, "accepted_answer_id": 30362395, "answer_count": 1, "score": 1, "last_activity_date": 1432189533, "creation_date": 1432161959, "last_edit_date": 1432162517, "question_id": 30361656, "link": "https://stackoverflow.com/questions/30361656/strange-static-cast-compilation-error-while-compile-boost-spirit-parser", "title": "Strange static_cast compilation error while compile boost spirit parser", "body": "<p>To parse expressions like follow:</p>\n\n<pre><code>\"asd {img} {ref I}sdkflsdlk {img} wmrwerml\"\n</code></pre>\n\n<p>I have code like this:</p>\n\n<pre><code>struct CMyTag\n{\n    std::string tagName;\n    std::string tagData;\n};\nBOOST_FUSION_ADAPT_STRUCT(::CMyTag, (std::string, tagName) (std::string, tagData));\n\nstruct fillMyTag\n{\n    template &lt;typename A, typename B = boost::spirit::unused_type, typename C = boost::spirit::unused_type, typename D = boost::spirit::unused_type&gt;\n    struct result { typedef void type; };\n\n\n    void operator()(::CMyTag&amp; _tag, const std::string&amp; _name, const std::string&amp; _type) const\n    {\n        _tag.tagName = _name;\n        _tag.tagData = _type;\n    }\n};\n\ntemplate &lt;typename Iterator&gt;\nstruct testTag_grammar : qi::grammar&lt;Iterator, std::vector&lt;CMyTag&gt;()&gt;\n{\n    testTag_grammar() :\n        testTag_grammar::base_type(data)\n    {\n        data = (text | imgtag | vartag | inctag | blktag | reftag) &gt;&gt; *data;\n\n        imgtagraw %= '{' &gt;&gt; qi::lit(\"img\") &gt;&gt; *(+qi::lit(' ') &gt;&gt; lexeme[+(char_ - '{' - '}')]) &gt;&gt; '}';\n        imgtag = imgtagraw[op(qi::labels::_val, \"img\", boost::spirit::_1)];\n\n        vartagraw %= '{' &gt;&gt; qi::lit(\"var\") &gt;&gt; *(+qi::lit(' ') &gt;&gt; lexeme[+(char_ - '{' - '}')]) &gt;&gt; '}';\n        vartag = vartagraw[op(qi::labels::_val, \"var\", boost::spirit::_1)];\n\n        inctagraw %= '{' &gt;&gt; qi::lit(\"inc\") &gt;&gt; *(+qi::lit(' ') &gt;&gt; lexeme[+(char_ - '{' - '}')]) &gt;&gt; '}';\n        inctag = inctagraw[op(qi::labels::_val, \"inc\", boost::spirit::_1)];\n\n        blktagraw %= '{' &gt;&gt; qi::lit(\"blank\") &gt;&gt; *(+qi::lit(' ') &gt;&gt; lexeme[+(char_ - '{' - '}')]) &gt;&gt; '}';\n        blktag = blktagraw[op(qi::labels::_val, \"blk\", boost::spirit::_1)];\n\n        reftagraw %= '{' &gt;&gt; lexeme[(\"ref\")] &gt;&gt; *(+qi::lit(' ') &gt;&gt; lexeme[+(char_ - '{' - '}')]) &gt;&gt; '}';\n        reftag = reftagraw[op(qi::labels::_val, \"ref\", boost::spirit::_1)];\n\n        textraw %= lexeme[+(char_ - '{' - '}')];\n        text = textraw[op(qi::labels::_val, \"text\", boost::spirit::_1)];\n    }\n\n    qi::rule&lt;Iterator, std::string()&gt; imgtagraw, vartagraw, inctagraw, blktagraw, reftagraw, textraw;\n    qi::rule&lt;Iterator, CMyTag()&gt; imgtag, vartag, inctag, blktag, reftag, text;\n    qi::rule&lt;Iterator, std::vector&lt;CMyTag&gt;()&gt; data;\n\n    boost::phoenix::function&lt;fillMyTag&gt; op;\n};\n</code></pre>\n\n<p>Usage of parser:</p>\n\n<pre><code>testTag_grammar&lt;std::string::iterator&gt; l_gramar;\nstd::string l_test = \"asd {img} {ref I}sdkflsdlk {img} wmrwerml\";\n\nstd::vector&lt;CMyTag&gt; l_result;\nbool result = qi::parse(l_test.begin(), l_test.end(), l_gramar, l_result);\n</code></pre>\n\n<p>As a result I expect to get a list of CmyTag structs, but compilation of code failed:</p>\n\n<pre><code>Error   1   error C2440: 'static_cast' : cannot convert from 'const std::vector&lt;CMyTag,std::allocator&lt;_Ty&gt;&gt;' to 'CMyTag'    d:\\lib\\boost\\include\\boost-1_57\\boost\\spirit\\home\\qi\\detail\\assign_to.hpp   152 1   TestSpiritParser\n</code></pre>\n\n<p>When I change data rule to follow:</p>\n\n<pre><code>data = ((text | imgtag | vartag | inctag | blktag | reftag)[opvec(qi::labels::_val, boost::spirit::_1)]) &gt;&gt; *data;\n</code></pre>\n\n<p>with definition of opvec:</p>\n\n<pre><code>struct fillMyVec\n{\n    template &lt;typename A, typename B = boost::spirit::unused_type, typename C = boost::spirit::unused_type, typename D = boost::spirit::unused_type&gt;\n    struct result { typedef void type; };\n\n\n    void operator()(std::vector&lt;CMyTag&gt;&amp; _tagvec, const CMyTag&amp; _name) const\n    {\n        _tagvec.push_back(_name);\n    }\n\n    void operator()(std::vector&lt;CMyTag&gt;&amp; _tagvec, std::vector&lt;CMyTag&gt;&amp; _name) const\n    {\n        _tagvec.insert(_tagvec.end(), _name.begin(), _name.end());\n    }\n};\n\nboost::phoenix::function&lt;fillMyVec&gt; opvec;\n</code></pre>\n\n<p>Code begin compile success, but as result of run I got list with only one item in it. Also before modification, when CMytag type was only std::string, I got a std::string list with correct numbers of items in it, </p>\n\n<p>Now I have no idea what wrong, and what to do for fix issue</p>\n"}, {"tags": ["c++", "templates", "inheritance"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 2, "creation_date": 1432161895, "post_id": 30361576, "comment_id": 48814801, "body": "You can read about <a href=\"http://en.wikipedia.org/wiki/Double_dispatch#Double_dispatch_in_C.2B.2B\" rel=\"nofollow noreferrer\">double dispatch in C++</a> to get some ideas."}, {"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1432166744, "post_id": 30361576, "comment_id": 48816201, "body": "Could you elaborate on &quot;a list of Animals&quot;? Do you mean a <code>list&lt;Animal*&gt;</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": true, "score": 3, "last_activity_date": 1432163758, "last_edit_date": 1432163758, "creation_date": 1432162811, "answer_id": 30361783, "question_id": 30361576, "link": "https://stackoverflow.com/questions/30361576/how-to-create-a-specialized-and-default-versions-of-a-function-that-take-base-an/30361783#30361783", "title": "How to create a specialized and default versions of a function that take base and derived classes?", "body": "<p>Here's one way - use the concept-model idiom (my name):</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nstruct AnimalConcept {\n    virtual ~AnimalConcept() = default;\n\n    virtual void make_noise() const = 0;\n};\n\n// default case\nvoid make_noise_for(const AnimalConcept&amp;)\n{\n    std::cout &lt;&lt; \"no noise\" &lt;&lt; std::endl;\n}\n\ntemplate&lt;class Model&gt;\nstruct AnimalModel : AnimalConcept\n{\n\n    void make_noise() const override {\n        make_noise_for(static_cast&lt;const Model&amp;&gt;(*this));\n    }\n};\n\n// some models\n\nstruct Cat : AnimalModel&lt;Cat&gt;\n{\n\n};\n\nstruct Dog : AnimalModel&lt;Dog&gt;\n{\n\n};\n\nstruct Giraffe : AnimalModel&lt;Giraffe&gt;\n{\n\n};\n\n// separation of concerns - specific overrides\n\nvoid make_noise_for(const Cat&amp;) {\n    std::cout &lt;&lt; \"meow\\n\";\n}\n\nvoid make_noise_for(const Dog&amp;) {\n    std::cout &lt;&lt; \"woof\\n\";\n}\n\n// test\n\nusing namespace std;\n\nint main(){\n    std::vector&lt;std::unique_ptr&lt;const AnimalConcept&gt;&gt; animals;\n    animals.emplace_back(new Cat);\n    animals.emplace_back(new Dog);\n    animals.emplace_back(new Giraffe);\n\n    for (const auto&amp; p : animals) {\n        p-&gt;make_noise();\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>expected output:</p>\n\n<pre><code>meow\nwoof\nno noise\n</code></pre>\n\n<p>And here's another way to implement it (this one is nicer since it allows all animals to have unrelated interfaces):</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nstruct AnimalConcept {\n    virtual ~AnimalConcept() = default;\n\n    virtual void make_noise() const = 0;\n};\n\n// default case\ntemplate&lt;class T&gt;\nvoid make_noise_for(const T&amp;)\n{\n    std::cout &lt;&lt; \"this animal makes no noise\" &lt;&lt; std::endl;\n}\n\ntemplate&lt;class Model&gt;\nstruct AnimalModel : AnimalConcept\n{\n    template&lt;class...Args&gt;\n    AnimalModel(Args&amp;&amp;...args)\n    : _model { std::forward&lt;Args&gt;(args)... }\n    {}\n\nprivate:\n    void make_noise() const override {\n        make_noise_for(_model);\n    }\n\n    Model _model;\n};\n\n// some models\n\nstruct Cat\n{\n    Cat(std::string name)\n    : _name { std::move(name) }\n    {}\n\n    const std::string&amp; name() const {\n        return _name;\n    }\n\nprivate:\n    std::string _name;\n};\n\nstruct Dog\n{\n    Dog(std::string name, int age)\n    : _name { std::move(name) }\n    , _age { age }\n    {}\n\n    const std::string&amp; name() const {\n        return _name;\n    }\n\n    int age() const {\n        return _age;\n    }\n\nprivate:\n    std::string _name;\n    int _age;\n};\n\nstruct Giraffe\n{\n\n};\n\n// separation of concerns - specific overrides\n\nvoid make_noise_for(const Cat&amp; c) {\n    std::cout &lt;&lt; c.name() &lt;&lt; \" says meow\\n\";\n}\n\nvoid make_noise_for(const Dog&amp; d) {\n    std::cout &lt;&lt; \"the dog called \" &lt;&lt; d.name() &lt;&lt; \" who is \" &lt;&lt; d.age() &lt;&lt; \" years old says woof\\n\";\n}\n\n// test\n\nusing namespace std;\n\nint main(){\n    std::vector&lt;std::unique_ptr&lt;const AnimalConcept&gt;&gt; animals;\n    animals.emplace_back(new AnimalModel&lt;Cat&gt; { \"felix\" });\n    animals.emplace_back(new AnimalModel&lt;Dog&gt; { \"fido\", 2 });\n    animals.emplace_back(new AnimalModel&lt;Giraffe&gt;);\n\n    for (const auto&amp; p : animals) {\n        p-&gt;make_noise();\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>expected output:</p>\n\n<pre><code>felix says meow\nthe dog called fido who is 2 years old says woof\nthis animal makes no noise\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1432163207, "creation_date": 1432163207, "answer_id": 30361838, "question_id": 30361576, "link": "https://stackoverflow.com/questions/30361576/how-to-create-a-specialized-and-default-versions-of-a-function-that-take-base-an/30361838#30361838", "title": "How to create a specialized and default versions of a function that take base and derived classes?", "body": "<p>You can use a combination of the following to get type based dispatch.</p>\n\n<ol>\n<li>Provide for every class to return a type ID associated with it.</li>\n<li>Provide a virtual function in the base class to get the type ID associated with an object.</li>\n<li>Provide a way for registration of functions based on type ID.</li>\n<li>When the time comes for execution of the top level function, search for a registered function given an animal's type ID. If a function is registered, call it. Otherwise, use the default function.</li>\n</ol>\n\n\n\n<pre><code>// Implement this function in a .cpp file.\nint getNextTypeID()\n{\n   static int typeID = 0;\n   return ++typeID;\n}\n\nclass Animal \n{\n   virtual int getTypeID();\n};\n\nclass Cat : public Animal\n{\n   static int getID()\n   {\n      static int typeID = getNextTypeID();\n   }\n\n   virtual int getTypeID()\n   {\n      return getID();\n   }\n};\n\nclass Dog : public Animal\n{\n   static int getID()\n   {\n      static int typeID = getNextTypeID();\n   }\n\n   virtual int getTypeID()\n   {\n      return getID();\n   }\n};\n</code></pre>\n\n<p>foo.h:</p>\n\n<pre><code>typedef void (*AnimalFunction)(Animal&amp; a);\n\nint registerAnimalFunctor(int typeID, AnimalFunction f);\n\nvoid foo(Animal&amp; a);\n</code></pre>\n\n<p>foo.cpp:</p>\n\n<pre><code>typedef std::map&lt;int, AnimalFunction&gt; AnimalFunctionMap;\n\nAnimalFunctionMap&amp; getAnimalFunctionMap()\n{\n   static AnimalFunctionMap theMap;\n   return theMap;\n}\n\nint registerAnimalFunctor(int typeID, AnimalFunction f)\n{\n   getAnimalFunctionMap()[typeID] = f;\n   return 0;\n}\n\nvoid defaultAnimalFunction(a)\n{\n   // Default action\n}\n\nvoid foo(Animal&amp; a)\n{\n   AnimalFunctionMap&amp; theMap = getAnimalFunctionMap();\n   AnimalFunctionMap::iterator iter = theMap.find(a.getTypeID());\n   if ( iter != theMap.end() )\n   {\n      iter-&gt;second(a);\n   }\n   else\n   {\n      defaultAnimalFunction(a);\n   }\n}\n</code></pre>\n\n<p>cat_foo.cpp:</p>\n\n<pre><code>void CatFunction(Animal&amp; a)\n{\n   // Cat action.\n}\n\nint dummy = registerAnimalFunctor(Cat::getID(), CatFunction);\n</code></pre>\n\n<p>dog_foo.cpp:</p>\n\n<pre><code>void DogFunction(Animal&amp; a)\n{\n   // Dog action.\n}\n\nint dummy = registerAnimalFunctor(Dog::getID(), DogFunction);\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 810645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/437c54ba6fd3ccc665fc1059c6f54e7c?s=128&d=identicon&r=PG", "display_name": "vrxacs", "link": "https://stackoverflow.com/users/810645/vrxacs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 30361783, "answer_count": 2, "score": 0, "last_activity_date": 1432163758, "creation_date": 1432161572, "question_id": 30361576, "link": "https://stackoverflow.com/questions/30361576/how-to-create-a-specialized-and-default-versions-of-a-function-that-take-base-an", "title": "How to create a specialized and default versions of a function that take base and derived classes?", "body": "<p>I have the following class architecture:</p>\n\n<pre><code>class Animal \n{\n // ...\n}\n\nclass Cat : public Animal\n{\n // ...\n}\n\nclass Dog : public Animal\n{\n // ...\n}\n\n// + Several other derived classes\n</code></pre>\n\n<p>In another section of my code, I have a function that goes through a list of Animals and needs to perform specialized actions in the case of several of the derived classes and a default action otherwise. How can I handle this situation elegantly, given the following constraints:</p>\n\n<ol>\n<li>I'd like to keep the new code outside of Animal and its derived\nclasses because of separation of concerns.</li>\n<li>I'd like to avoid using a switch statement on types or enums as it feels very smelly.</li>\n</ol>\n"}, {"tags": ["c++", "audio", "sdl", "sdl-2", "sdl-mixer"], "comments": [{"owner": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 0, "creation_date": 1432176841, "post_id": 30361423, "comment_id": 48818763, "body": "Have you allocated the channels you need to play multiple sounds? From what I understand of the documentation on <a href=\"http://www.libsdl.org/projects/SDL_mixer/docs/SDL_mixer.html#SEC26\" rel=\"nofollow noreferrer\">Mix_AllocateChannels</a> and its cousins, calling <code>Mix_PlayChannel</code> with -1 as the first argument will only work if you have enough channels allocated that a new channel can be assigned to the sound."}, {"owner": {"reputation": 1611, "user_id": 3810466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JUvyo.png?s=128&g=1", "display_name": "ricky3350", "link": "https://stackoverflow.com/users/3810466/ricky3350"}, "reply_to_user": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 0, "creation_date": 1432239980, "post_id": 30361423, "comment_id": 48856431, "body": "@jaggedSpire It should have 4 channels (<code>Mix_OpenAudio(44100, MIX_DEFAULT_FORMAT, 4, 2048)</code>), according to <a href=\"http://sdl.beuc.net/sdl.wiki/Mix_OpenAudio\" rel=\"nofollow noreferrer\">sdl.beuc.net/sdl.wiki/Mix_OpenAudio</a>. Does this not work?"}, {"owner": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 0, "creation_date": 1432241061, "post_id": 30361423, "comment_id": 48857072, "body": "It looks like you&#39;re correct. Sorry about that. I can see two other (fairly unlikely) possibilities, both dealing with the formatting of the sound: Are you sure that <code>MIX_DEFAULT_FORMAT</code> is not one of the non-portable formats? Finally, I&#39;ve had some mild issues with audio playback and endian-ness of the file used in the past. You could try opening up those files in Audacity and exporting them in the same format as the background music. Again: remote possibility. I don&#39;t know why SDL_Mixer wouldn&#39;t do this for you, though I&#39;m less familiar with it than SDL_Audio."}, {"owner": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 0, "creation_date": 1432316832, "post_id": 30361423, "comment_id": 48893389, "body": "You might want to try calling the channel allocation function anyway. The <code>Mix_OpenAudio</code> function&#39;s <code>channel</code> parameter might be referring to the audio format of the opened device, which discerns single track sound from stereo, and stereo sound from surround-sound."}], "owner": {"reputation": 1611, "user_id": 3810466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JUvyo.png?s=128&g=1", "display_name": "ricky3350", "link": "https://stackoverflow.com/users/3810466/ricky3350"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 510, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1432173059, "creation_date": 1432160673, "last_edit_date": 1432173059, "question_id": 30361423, "link": "https://stackoverflow.com/questions/30361423/sdl-mixer-plays-static-instead-of-wav-file", "title": "SDL_mixer plays static instead of .wav file", "body": "<p>I'm making a version of Tetris in SDL 2 that has sounds. I have background music, which works fine. However, the sound effects (move, rotate, etc.) play static instead of what they're supposed to play.</p>\n\n<p>Some code:</p>\n\n<p>Definitions:</p>\n\n<pre><code>Mix_Music *music;\nMix_Chunk *move, *rotate, *clear, *difficult, *gameOver;\n</code></pre>\n\n<p>At the beginning:</p>\n\n<pre><code>if (Mix_OpenAudio(44100, MIX_DEFAULT_FORMAT, 4, 2048) != 0) {\n    printf(\"Error: Failed to initiate Mixer subsystem. SDL_Mixer Error: %s\\n\", Mix_GetError());\n    return false;\n}\n\nmusic = Mix_LoadMUS(\"music.wav\");\nif (music == NULL) {\n    printf(\"Failed to load Music. SDL_Mixer Error: %s\\n\", Mix_GetError());\n}\n\nmove = Mix_LoadWAV(\"move.wav\");\nif (move == NULL) {\n    printf(\"Failed to load sound \\\"move\\\". SDL_Mixer Error: %s\\n\", Mix_GetError());\n}\n\nrotate = Mix_LoadWAV(\"rotate.wav\");\nif (rotate == NULL) {\n    printf(\"Failed to load sound \\\"rotate\\\". SDL_Mixer Error: %s\\n\", Mix_GetError());\n}\n...\nMix_VolumeMusic((128 * options[0].currentOption * options[1].currentOption) / 10000); // (128 * 20 * 100) / 10000 = 25;\nMix_VolumeChunk(move, (128 * options[0].currentOption * options[2].currentOption) / 10000); // (128 * 20 * 100) / 10000 = 25;\nMix_VolumeChunk(rotate, (128 * options[0].currentOption * options[2].currentOption) / 10000); // (128 * 20 * 100) / 10000 = 25;\n...\n</code></pre>\n\n<p>Play sound code:</p>\n\n<pre><code>Mix_PlayChannel(-1, move, 0);\n</code></pre>\n\n<p>Close:</p>\n\n<pre><code>Mix_FreeMusic(music);\nmusic = NULL;\nMix_FreeChunk(move);\nMix_FreeChunk(rotate);\nMix_FreeChunk(clear);\nMix_FreeChunk(difficult);\nMix_FreeChunk(gameOver);\nmove = NULL;\nrotate = NULL;\nclear = NULL;\ndifficult = NULL;\ngameOver = NULL;\n\nMix_Quit();\n</code></pre>\n\n<p>Miscellaneous info:</p>\n\n<ul>\n<li>Using C++ in VS 2013</li>\n<li>Using SDL_mixer 2.0.0, downloaded yesterday</li>\n<li>Sounds are ~11kB, music is 94,675kB</li>\n<li>The sounds play fine in Windows Media Player</li>\n</ul>\n\n<p>Let me know if you need any other info, and thanks in advance!</p>\n"}, {"tags": ["c++", "arithmetic-expressions"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1432160263, "post_id": 30361112, "comment_id": 48814285, "body": "Uses: <a href=\"http://stackoverflow.com/a/3182557/962089\">stackoverflow.com/a/3182557/962089</a> In addition, there&#39;s printing (or otherwise using) the integral value of a character type: <code>std::cout &lt;&lt; +c;</code> If this happens a lot, <code>static_cast</code> gets very cluttery."}, {"owner": {"reputation": 13278, "user_id": 688624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b0714eded10b5ccee614c7134360974b?s=128&d=identicon&r=PG", "display_name": "imallett", "link": "https://stackoverflow.com/users/688624/imallett"}, "edited": false, "score": 4, "creation_date": 1432170356, "post_id": 30361112, "comment_id": 48817150, "body": "Hint: what if you had intended to write a minus?"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1432174528, "post_id": 30361112, "comment_id": 48818220, "body": "What if the type of <code>e</code>?"}, {"owner": {"reputation": 102569, "user_id": 400547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bece78258b3847bca4ab1ee92ad92b88?s=128&d=identicon&r=PG", "display_name": "Jon Hanna", "link": "https://stackoverflow.com/users/400547/jon-hanna"}, "edited": false, "score": 1, "creation_date": 1432224407, "post_id": 30361112, "comment_id": 48847275, "body": "What does <code>2 &#215; (3 &#215; 4 &#215; +5)</code> do in normal arithmetic?"}, {"owner": {"reputation": 44734, "user_id": 964243, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/fL1rH.png?s=128&g=1", "display_name": "Boann", "link": "https://stackoverflow.com/users/964243/boann"}, "edited": false, "score": 0, "creation_date": 1432228845, "post_id": 30361112, "comment_id": 48850018, "body": "This isn&#39;t a question about programming so much as it&#39;s a question about reading basic math notation."}, {"owner": {"reputation": 2177, "user_id": 4492918, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/de9eac6e10fbb69a3a5a24a8b7795cdc?s=128&d=identicon&r=PG&f=1", "display_name": "Atsby", "link": "https://stackoverflow.com/users/4492918/atsby"}, "reply_to_user": {"reputation": 44734, "user_id": 964243, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/fL1rH.png?s=128&g=1", "display_name": "Boann", "link": "https://stackoverflow.com/users/964243/boann"}, "edited": false, "score": 2, "creation_date": 1432240926, "post_id": 30361112, "comment_id": 48856991, "body": "@Boann I think the question isn&#39;t as trivial as all that. Not all &quot;basic math notations&quot; work in programming. We all know that thinking in terms of math when programming is a recipe for disaster."}, {"owner": {"user_type": "does_not_exist", "display_name": "user719662"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1432315537, "post_id": 30361112, "comment_id": 48892697, "body": "@ShafikYaghmour and I&#39;ve seen, as I&#39;ve already told y&#39;all, <i>dozens</i> of them, most of them concerning C#/Java/JS/Python, but a couple of them also mentioning C directly. see <a href=\"http://stackoverflow.com/questions/6637005/what-is-the-purpose-of-the-unary-operator-in-c\" title=\"what is the purpose of the unary operator in c\">stackoverflow.com/questions/6637005/&hellip;</a> - would that Q/A fit your &quot;exact duplicate&quot;, or do I have to dig through <a href=\"http://stackoverflow.com/search?page=2&amp;tab=relevance&amp;q=unary%20plus\">stackoverflow.com/&hellip;</a> further? believe me or not, this <b>has</b> been asked before... <b>dozens</b> of times in <b>dozens</b> of flavours."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1432376753, "post_id": 30361112, "comment_id": 48909599, "body": "@vaxquis that one is actually much better but it is marked as <code>C</code> and since this one already has C++ specific answers we should not change this tag."}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 13, "creation_date": 1432161088, "post_id": 30361124, "comment_id": 48814567, "body": "For more detail on &quot;promoted&quot;, <a href=\"http://stackoverflow.com/a/24805967/1505939\">see here</a>"}, {"owner": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "edited": false, "score": 6, "creation_date": 1432177697, "post_id": 30361124, "comment_id": 48818961, "body": "The effect of this is identical to <code>int a = b * (c * d * (+e))</code>"}], "tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": true, "score": 118, "last_activity_date": 1473222260, "last_edit_date": 1495540009, "creation_date": 1432159179, "answer_id": 30361124, "question_id": 30361112, "link": "https://stackoverflow.com/questions/30361112/what-does-the-compiler-do-here-int-a-b-c-d-e/30361124#30361124", "title": "What does the compiler do here: int a = b * (c * d * + e)?", "body": "<p>The <code>+</code> is interpreted as an unary plus operator. It simply returns the <a href=\"https://stackoverflow.com/questions/24805580/does-unary-operator-do-type-conversions/24805967#24805967\">promoted</a> value of its operand.</p>\n"}, {"comments": [{"owner": {"reputation": 9922, "user_id": 1813853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c0275422e350591a9f1620cb90d581?s=128&d=identicon&r=PG", "display_name": "Chris Hayes", "link": "https://stackoverflow.com/users/1813853/chris-hayes"}, "edited": false, "score": 32, "creation_date": 1432179583, "post_id": 30361317, "comment_id": 48819418, "body": "&quot;Positive value&quot; is misleading. That makes it sound like it returns the absolute value of the operand, which is not the case."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 9, "creation_date": 1432199646, "post_id": 30361317, "comment_id": 48829142, "body": "Nor does <code>-</code> necessarily return &quot;the negative value&quot;: <code>int b = -5; std::cout &lt;&lt; -b;</code>"}, {"owner": {"reputation": 9606, "user_id": 3677097, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8c49e598194e53b9aba3a195da387a5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas DM", "link": "https://stackoverflow.com/users/3677097/andreas-dm"}, "reply_to_user": {"reputation": 9922, "user_id": 1813853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c0275422e350591a9f1620cb90d581?s=128&d=identicon&r=PG", "display_name": "Chris Hayes", "link": "https://stackoverflow.com/users/1813853/chris-hayes"}, "edited": false, "score": 0, "creation_date": 1432230261, "post_id": 30361317, "comment_id": 48850892, "body": "@ChrisHayes answer corrected, thank you"}, {"owner": {"reputation": 9606, "user_id": 3677097, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8c49e598194e53b9aba3a195da387a5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas DM", "link": "https://stackoverflow.com/users/3677097/andreas-dm"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1432230421, "post_id": 30361317, "comment_id": 48851000, "body": "@MSalters thank you, corrected the wording"}], "tags": [], "owner": {"reputation": 9606, "user_id": 3677097, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8c49e598194e53b9aba3a195da387a5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas DM", "link": "https://stackoverflow.com/users/3677097/andreas-dm"}, "is_accepted": false, "score": 27, "last_activity_date": 1535751587, "last_edit_date": 1535751587, "creation_date": 1432160190, "answer_id": 30361317, "question_id": 30361112, "link": "https://stackoverflow.com/questions/30361112/what-does-the-compiler-do-here-int-a-b-c-d-e/30361317#30361317", "title": "What does the compiler do here: int a = b * (c * d * + e)?", "body": "<p>Unary <code>+</code> returns the promoted value.<br>\nUnary <code>-</code> returns the negation:</p>\n\n<pre><code>int a = 5;\nint b = 6;\nunsigned int c = 3;\n\nstd::cout &lt;&lt; (a * +b); // = 30\nstd::cout &lt;&lt; (a * -b); // = -30\nstd::cout &lt;&lt; (1 * -c); // = 4294967293 (2^32 - 3)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "is_accepted": false, "score": 18, "last_activity_date": 1444672178, "last_edit_date": 1495541877, "creation_date": 1432173015, "answer_id": 30363234, "question_id": 30361112, "link": "https://stackoverflow.com/questions/30361112/what-does-the-compiler-do-here-int-a-b-c-d-e/30363234#30363234", "title": "What does the compiler do here: int a = b * (c * d * + e)?", "body": "<p>This compiles because the <code>+</code> is being interpreted as unary plus, which will perform the integral promotions on integral or enumeration types and the result will have the type of the promoted operand.</p>\n\n<p>Assuming <code>e</code> is an integral or unscoped enumeration type would end up having the integral promotions applied anyway since <code>*</code> applies the <em>usual arithmetic conversions</em> to its operands which ends up at the <em>integral promotions</em> for integral types.</p>\n\n<p>From the draft C++ standard <code>5.3.1</code> <em>[expr.unary.op]</em>:</p>\n\n<blockquote>\n  <p>The operand of the unary + operator shall have arithmetic, unscoped enumeration, or pointer type and the\n  result is the value of the argument. Integral promotion is performed on integral or enumeration operands.\n  The type of the result is the type of the promoted operand.</p>\n</blockquote>\n\n<p>The integral promotions are covered in section <code>4.5</code>  <em>[conv.prom]</em> and if the variables <code>e</code> is a type other than <code>bool, char16_t, char32_t, or wchar_t</code> and have conversion rank less than <em>int</em> then it would be covered by paragraph <code>1</code>:</p>\n\n<blockquote>\n  <p>A prvalue of an integer type other than bool, char16_t, char32_t, or wchar_t whose integer conversion\n  rank (4.13) is less than the rank of int can be converted to a prvalue of type int if int can represent all\n  the values of the source type; otherwise, the source prvalue can be converted to a prvalue of type unsigned\n  int.</p>\n</blockquote>\n\n<p>For a complete set of cases we can look at <a href=\"http://en.cppreference.com/w/cpp/language/implicit_cast#Integral_promotion\" rel=\"nofollow noreferrer\">cppreference</a>.</p>\n\n<p>Unary plus can also be useful in some cases to resolve ambiguity, an interesting case would be from <a href=\"https://stackoverflow.com/q/17822131/1708801\">Resolving ambiguous overload on function pointer and std::function for a lambda using +</a>.</p>\n\n<p>Note, for those answers, referring to unary <code>-</code> and negative values, this is misleading, as this example shows:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main()\n{\n    unsigned  x1 = 1 ;\n\n    std::cout &lt;&lt;  -x1 &lt;&lt; std::endl ;\n}\n</code></pre>\n\n<p>which results in:</p>\n\n<pre><code>4294967295\n</code></pre>\n\n<p>See it live <a href=\"http://melpon.org/wandbox/permlink/D1Os6rZyCEot3il7\" rel=\"nofollow noreferrer\">using gcc on wandbox</a>.</p>\n\n<p>It is interesting to note that unary plus was added to C99 for symmetry with unary minus, from the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/C99RationaleV5.10.pdf\" rel=\"nofollow noreferrer\"> Rationale for International Standard\u2014Programming Languages\u2014C</a>:</p>\n\n<blockquote>\n  <p>Unary plus was adopted by the C89 Committee from several implementations, for symmetry with unary minus.</p>\n</blockquote>\n\n<p>and I can not come up with a good case where casting would not be sufficient to achieve the same desired promotion/conversion. The lambda example I cite above, using unary plus to force a lambda expression to be converted to a function pointer:</p>\n\n<pre><code>foo( +[](){} ); // not ambiguous (calls the function pointer overload)\n</code></pre>\n\n<p>could be accomplished using a explicit cast:</p>\n\n<pre><code>foo( static_cast&lt;void (*)()&gt;( [](){} ) );\n</code></pre>\n\n<p>and it could be argued this code is better since the intention is explicit.</p>\n\n<p>Worth noting that <a href=\"http://www.stroustrup.com/arm.html\" rel=\"nofollow noreferrer\">Annotated C++ Reference Manual(<em>ARM</em>)</a> it has the following commentary:</p>\n\n<blockquote>\n  <p>Unary plus is a historical accident and generally useless.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 4289, "user_id": 4273446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ebndh.jpg?s=128&g=1", "display_name": "Dyrandz Famador", "link": "https://stackoverflow.com/users/4273446/dyrandz-famador"}, "is_accepted": false, "score": 9, "last_activity_date": 1432212878, "last_edit_date": 1432212878, "creation_date": 1432173050, "answer_id": 30363240, "question_id": 30361112, "link": "https://stackoverflow.com/questions/30361112/what-does-the-compiler-do-here-int-a-b-c-d-e/30363240#30363240", "title": "What does the compiler do here: int a = b * (c * d * + e)?", "body": "<p>As what they have explained, (+) and (-) were just used as unary operator:</p>\n\n<blockquote>\n  <p><a href=\"https://msdn.microsoft.com/en-us/library/hetcw0tx.aspx\" rel=\"nofollow\">Unary operators</a> act on only one operand in an expression</p>\n</blockquote>\n\n<pre><code>int value = 6;\nint negativeInt = -5;\nint positiveInt = +5;\n\ncout &lt;&lt; (value * negativeInt); // 6 * -5 = -30\ncout &lt;&lt; (value * positiveInt); // 6 * +5 = 30\n\ncout &lt;&lt; (value * - negativeInt); // 6 * -(-5) = 30\ncout &lt;&lt; (value * + negativeInt); // 6 * +(-5) = -30\n\ncout &lt;&lt; (value * - positiveInt); // 6 * -(+5) = -30\ncout &lt;&lt; (value * + positiveInt); // 6 * +(+5) = 30\n</code></pre>\n\n<p>so from your code: </p>\n\n<pre><code>int b = 2;\nint c = 3;\nint d = 4;\nint e = 5;\n\nint a = b * (c * d *  + e)\n\n//result: 2 * (3 * 4 * (+5) ) = 120\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "edited": false, "score": 1, "creation_date": 1432200369, "post_id": 30363430, "comment_id": 48829655, "body": "&quot;which will determine only sign of e&quot; How so?"}, {"owner": {"reputation": 221, "user_id": 4452804, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1usct.png?s=128&g=1", "display_name": "nitish-d", "link": "https://stackoverflow.com/users/4452804/nitish-d"}, "reply_to_user": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "edited": false, "score": 0, "creation_date": 1432200589, "post_id": 30363430, "comment_id": 48829830, "body": "I meant to say that + sign will work as +5 ,iff e=5..like that."}], "tags": [], "owner": {"reputation": 221, "user_id": 4452804, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1usct.png?s=128&g=1", "display_name": "nitish-d", "link": "https://stackoverflow.com/users/4452804/nitish-d"}, "is_accepted": false, "score": -1, "last_activity_date": 1432174448, "creation_date": 1432174448, "answer_id": 30363430, "question_id": 30361112, "link": "https://stackoverflow.com/questions/30361112/what-does-the-compiler-do-here-int-a-b-c-d-e/30363430#30363430", "title": "What does the compiler do here: int a = b * (c * d * + e)?", "body": "<p>The + operator between d and e will be treated as an unary + operator  which will determine only sign of e.\nSo the compiler will see this statement as follow:</p>\n\n<pre><code>int a = b*(c*d*e) ;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4289, "user_id": 4273446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ebndh.jpg?s=128&g=1", "display_name": "Dyrandz Famador", "link": "https://stackoverflow.com/users/4273446/dyrandz-famador"}, "edited": false, "score": 1, "creation_date": 1432213142, "post_id": 30370851, "comment_id": 48838724, "body": "it&#39;s not like that, how about this: <code>int a = -5; int val = -a; &#47;&#47;result val: 5</code>"}, {"owner": {"reputation": 4289, "user_id": 4273446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ebndh.jpg?s=128&g=1", "display_name": "Dyrandz Famador", "link": "https://stackoverflow.com/users/4273446/dyrandz-famador"}, "edited": false, "score": 1, "creation_date": 1432215307, "post_id": 30370851, "comment_id": 48840334, "body": "<code>--5</code> becomes <code>4</code> :p  <code>-(-5) = 5</code>..just kidding i know it&#39;s just a typo.. yeah you&#39;re right :) +1"}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1565700140, "post_id": 30370851, "comment_id": 101427682, "body": "<code>\u20145</code> is ill-formed because <code>5</code> is a prvalue."}], "tags": [], "owner": {"reputation": 5886, "user_id": 2459641, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/476093434123ec1626e3343ba427545a?s=128&d=identicon&r=PG&f=1", "display_name": "Loko", "link": "https://stackoverflow.com/users/2459641/loko"}, "is_accepted": false, "score": 3, "last_activity_date": 1432214528, "last_edit_date": 1432214528, "creation_date": 1432203398, "answer_id": 30370851, "question_id": 30361112, "link": "https://stackoverflow.com/questions/30361112/what-does-the-compiler-do-here-int-a-b-c-d-e/30370851#30370851", "title": "What does the compiler do here: int a = b * (c * d * + e)?", "body": "<p>This is just basic math. For example:</p>\n\n<pre><code>5 * -4 = -20\n\n5 * +4 = 5 * 4 = 20 \n\n-5 * -4 = 20\n</code></pre>\n\n<p><strong>Negative * Negative = Positive</strong></p>\n\n<p><strong>Positive * Negative = Negative</strong></p>\n\n<p><strong>Positive * Positive = Positive</strong></p>\n\n<p>This is the easiest explanation there is.</p>\n\n<p>The minus(-) and plus(+) just tell if the number is positive or negative.</p>\n"}, {"tags": [], "owner": {"reputation": 228178, "user_id": 87015, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2f9b099fb455d3ddedb0bfa7430e51a9?s=128&d=identicon&r=PG&f=1", "display_name": "Salman A", "link": "https://stackoverflow.com/users/87015/salman-a"}, "is_accepted": false, "score": 4, "last_activity_date": 1432211792, "last_edit_date": 1432211792, "creation_date": 1432211459, "answer_id": 30373870, "question_id": 30361112, "link": "https://stackoverflow.com/questions/30361112/what-does-the-compiler-do-here-int-a-b-c-d-e/30373870#30373870", "title": "What does the compiler do here: int a = b * (c * d * + e)?", "body": "<p>Why does it compile? It compiles because <code>+</code> is parsed as unary plus operator, not the addition operator. The compiler tries to parse as much as possible without generating syntax errors. So this:</p>\n\n<pre><code>d * + e\n</code></pre>\n\n<p>Is parsed as:</p>\n\n<ul>\n<li><code>d</code> (operand)</li>\n<li><code>*</code> (multiplication operator)</li>\n<li><code>+</code> (unary plus operator)\n<ul>\n<li><code>e</code> (operand)</li>\n</ul></li>\n</ul>\n\n<p>Whereas, this:</p>\n\n<pre><code>d*++e;\n</code></pre>\n\n<p>Is parsed as:</p>\n\n<ul>\n<li><code>d</code> (operand)</li>\n<li><code>*</code> (multiplication operator)</li>\n<li><code>++</code> (pre increment operator)\n<ul>\n<li><code>e</code> (operand)</li>\n</ul></li>\n</ul>\n\n<p>Moreover, this:</p>\n\n<pre><code>d*+++e;\n</code></pre>\n\n<p>Is parsed as:</p>\n\n<ul>\n<li><code>d</code> (operand)</li>\n<li><code>*</code> (multiplication operator)</li>\n<li><code>++</code> (pre increment operator)\n<ul>\n<li><code>+</code> (unary plus operator)\n<ul>\n<li><code>e</code> (operand)</li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>Note that it does not create a syntax error but the \"LValue requrired\" compiler error.</p>\n"}, {"tags": [], "owner": {"reputation": 1062, "user_id": 4925219, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nNRW9ZZ6jhY/AAAAAAAAAAI/AAAAAAAAAAA/qCzK-wkXNh0/photo.jpg?sz=128", "display_name": "ALAN WARD", "link": "https://stackoverflow.com/users/4925219/alan-ward"}, "is_accepted": false, "score": 4, "last_activity_date": 1432219195, "creation_date": 1432219195, "answer_id": 30376982, "question_id": 30361112, "link": "https://stackoverflow.com/questions/30361112/what-does-the-compiler-do-here-int-a-b-c-d-e/30376982#30376982", "title": "What does the compiler do here: int a = b * (c * d * + e)?", "body": "<p>To put a further twist on the correct answers already given here, if you compile with the -s flag, the C compiler will output an assembly file in which actual the instructions generated can be examined. With the following C code:</p>\n\n<pre><code>int b=1, c=2, d=3, e=4;\nint a = b * (c * d *  + e);\n</code></pre>\n\n<p>The generated assembly (using gcc, compiling for amd64) begins with:</p>\n\n<pre><code>    movl    $1, -20(%ebp)\n    movl    $2, -16(%ebp)\n    movl    $3, -12(%ebp)\n    movl    $4, -8(%ebp)\n</code></pre>\n\n<p>so we can identify individual memory positions -20(%ebp) as variable b, down to -8(%ebp) as variable e. -4(%epp) is variable a. Now, the calculation is rendered as:</p>\n\n<pre><code>    movl    -16(%ebp), %eax\n    imull   -12(%ebp), %eax\n    imull   -8(%ebp), %eax\n    imull   -20(%ebp), %eax\n    movl    %eax, -4(%ebp)\n</code></pre>\n\n<p>So, as has been commented by other people replying, the compiler simply treats \"+e\" as the unary positive operation. The first movl instruction places the contents of variable e into the EAX accumulator register, which is then promptly multiplied by the contents of variable d or -12(%ebp), etc. </p>\n"}], "owner": {"reputation": 6564, "user_id": 2109064, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/05bfc90904db2f3abb20860d6e56e562?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2109064/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8379, "favorite_count": 4, "closed_date": 1432250741, "accepted_answer_id": 30361124, "answer_count": 8, "score": 75, "last_activity_date": 1535751587, "creation_date": 1432159099, "last_edit_date": 1432187101, "question_id": 30361112, "link": "https://stackoverflow.com/questions/30361112/what-does-the-compiler-do-here-int-a-b-c-d-e", "closed_reason": "Duplicate", "title": "What does the compiler do here: int a = b * (c * d * + e)?", "body": "<p>I had a strange bug in my program, and after a few hours of debugging, I found the following very stupid line:</p>\n\n<pre><code>int a = b * (c * d *  + e)\n</code></pre>\n\n<p>If you don't see it: Between <code>d</code> and <code>e</code> I wrote <code>* +</code>, where just a <code>+</code>was intended.</p>\n\n<p>Why does this compile and what does it actually mean?</p>\n"}, {"tags": ["java", "c++", "c", "java-native-interface"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1432159002, "post_id": 30361046, "comment_id": 48813842, "body": "No, <code>sizeof()</code> will not give it the length of the string but the size of the type, are you sure of <code>(*this)-&gt;</code>?"}, {"owner": {"reputation": 805, "user_id": 3618509, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2ebf555307f721af722397544de00285?s=128&d=identicon&r=PG&f=1", "display_name": "JavaProphet", "link": "https://stackoverflow.com/users/3618509/javaprophet"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1432159557, "post_id": 30361046, "comment_id": 48814028, "body": "@iharob I found it online, testing will show whether it&#39;s good or not."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1432160303, "post_id": 30361046, "comment_id": 48814303, "body": "You can check how <code>JNIEnv</code> is defined and whether it&#39;s a pointer <code>typedef</code> which would mean that <code>(*this)</code> makes sense."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1432166294, "post_id": 30361046, "comment_id": 48816102, "body": "<code>JNIEnv</code> is indeed a pointer: <code>typedef const struct JNINativeInterface *JNIEnv;</code> thus the JNI functions effectively take a <code>JNINativeInterface**</code> as input, so <code>(*this)-&gt;</code> is correct syntax to use."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1432166397, "post_id": 30361097, "comment_id": 48816123, "body": "The second parameter of <code>bind()</code> expects a <code>sockaddr*</code> pointer as input: <code>bind(sockfd, (struct sockaddr*)&amp;sun, sizeof(sun))</code>"}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 2, "last_activity_date": 1432159034, "creation_date": 1432159034, "answer_id": 30361097, "question_id": 30361046, "link": "https://stackoverflow.com/questions/30361046/get-length-of-jstring-char/30361097#30361097", "title": "Get length of jstring/char *?", "body": "<p>Since the type of the variable is <code>const char *</code> it suggests that it's a <code>nul</code> terminated string, hence</p>\n\n<pre><code>size_t length = strlen(npath);\n</code></pre>\n\n<p>should be enough.</p>\n\n<p>Although, your call to <code>bind()</code> is wrong, you shold pass the size of the address structure, for which</p>\n\n<pre><code>return bind(sockfd, sun, sizeof(sun));\n</code></pre>\n\n<p>should be correct.</p>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1432166242, "creation_date": 1432166242, "answer_id": 30362316, "question_id": 30361046, "link": "https://stackoverflow.com/questions/30361046/get-length-of-jstring-char/30362316#30362316", "title": "Get length of jstring/char *?", "body": "<p>First, you have a memory leak.  The <code>char*</code> pointer returned by <code>GetStringUTFChars()</code> <em>must</em> be freed using <code>ReleaseStringUTFChars()</code>, which you are not doing.</p>\n\n<p>Second, <code>bind()</code> expects you to specify the byte size of the <code>sockaddr_un</code> struct, not the character length of <code>npath</code>.  Also, the second parameter of <code>bind()</code> expects a <code>sockaddr*</code> pointer as input.</p>\n\n<p>Third, <code>sockaddr_un::sun_path</code> is a <code>char[]</code> array, you cannot assign a <code>char*</code> pointer to it. You have to copy the content that is being pointed at.</p>\n\n<p>Try this:</p>\n\n<pre><code>JNIEXPORT jint JNICALL Java_org_avuna_httpd_util_CLibJNI_bind(JNIEnv * this, jclass cls, jint sockfd, jint family, jstring path, jint len)\n{\n    struct sockaddr_un sun;\n    memset(&amp;sun, 0, sizeof(sun));\n    sun.sun_family = family;\n    const char *npath = (*this)-&gt;GetStringUTFChars(this, path, 0);\n    strncpy(sun.sun_path, npath, UNIX_PATH_MAX);\n    (*this)-&gt;ReleaseStringUTFChars(this, path, npath);\n    return bind(sockfd, (struct sockaddr *) &amp;sun, sizeof(sun));\n}\n</code></pre>\n\n<p>With that said, <code>sockaddr_un</code> <em>always</em> uses <code>AF_UNIX</code> for its family, so it does not make sense to pass a <code>family</code> as an input value.  If you need to pass in different <code>family</code> values, you need to use a different <code>sockaddr_...</code> struct for each <code>family</code>, eg:</p>\n\n<pre><code>JNIEXPORT jint JNICALL Java_org_avuna_httpd_util_CLibJNI_bind(JNIEnv * this, jclass cls, jint sockfd, jint family, jstring path, jint len)\n{\n    switch (family)\n    {\n        case AF_UNIX:\n        {\n            struct sockaddr_un sun;\n            memset(&amp;sun, 0, sizeof(sun));\n            sun.sun_family = AF_UNIX;\n            const char *npath = (*this)-&gt;GetStringUTFChars(this, path, 0);\n            strncpy(sun.sun_path, npath, UNIX_PATH_MAX);\n            (*this)-&gt;ReleaseStringUTFChars(this, path, npath);\n            return bind(sockfd, (struct sockaddr *) &amp;sun, sizeof(sun));\n        }\n\n        case AF_INET:\n        {\n            struct sockaddr_in sin;\n            memset(&amp;sin, 0, sizeof(sin));\n            sin.sin_family = AF_INET;\n            const char *npath = (*this)-&gt;GetStringUTFChars(this, path, 0);\n            inet_pton(AF_INET, npath, &amp;sin.sin_addr);\n            sin.sin_port = 0;\n            (*this)-&gt;ReleaseStringUTFChars(this, path, npath);\n            return bind(sockfd, (struct sockaddr *) &amp;sin, sizeof(sin));\n        }\n\n        case AF_INET6:\n        {\n            struct sockaddr_in6 sin;\n            memset(&amp;sin, 0, sizeof(sin));\n            sin.sin6_family = AF_INET6;\n            const char *npath = (*this)-&gt;GetStringUTFChars(this, path, 0);\n            inet_pton(AF_INET6, npath, &amp;sin.sin6_addr);\n            sin.sin6_port = 0;\n            (*this)-&gt;ReleaseStringUTFChars(this, path, npath);\n            return bind(sockfd, (struct sockaddr *) &amp;sin, sizeof(sin));\n        }\n\n        // and so on ...\n    }\n\n    return -1;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 619, "user_id": 1805643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec3672cb06390666410b2c0f39de8e5?s=128&d=identicon&r=PG", "display_name": "Jack Culhane", "link": "https://stackoverflow.com/users/1805643/jack-culhane"}, "is_accepted": false, "score": 2, "last_activity_date": 1531477644, "creation_date": 1531477644, "answer_id": 51323059, "question_id": 30361046, "link": "https://stackoverflow.com/questions/30361046/get-length-of-jstring-char/51323059#51323059", "title": "Get length of jstring/char *?", "body": "<p>Regarding the length of the jstring, what is needed is GetStringUTFLength.</p>\n\n<p><a href=\"https://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/functions.html\" rel=\"nofollow noreferrer\">https://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/functions.html</a></p>\n\n<p>This should be more efficient than calling strlen on the null terminated char* as I don't think it will need to search for the final null.</p>\n"}], "owner": {"reputation": 805, "user_id": 3618509, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2ebf555307f721af722397544de00285?s=128&d=identicon&r=PG&f=1", "display_name": "JavaProphet", "link": "https://stackoverflow.com/users/3618509/javaprophet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4573, "favorite_count": 0, "accepted_answer_id": 30361097, "answer_count": 3, "score": 0, "last_activity_date": 1531477644, "creation_date": 1432158810, "question_id": 30361046, "link": "https://stackoverflow.com/questions/30361046/get-length-of-jstring-char", "title": "Get length of jstring/char *?", "body": "<p>This is my JNI C code:</p>\n\n<pre><code>JNIEXPORT jint JNICALL Java_org_avuna_httpd_util_CLibJNI_bind(JNIEnv * this, jclass cls, jint sockfd, jint family, jstring path, jint len) {\n    struct sockaddr_un sun;\n    sun.sun_family = family;\n    const char *npath = (*this)-&gt;GetStringUTFChars(this, path, 0);\n    sun.sun_path = npath;\n    return bind(sockfd, sun, sizeof(&amp;npath));\n}\n</code></pre>\n\n<p>I just guessed unsuccessfully (<code>sizeof(&amp;npath)</code>) how to get the length. I'm not well versed in C, but I figure there is a way to get a length out of a jstring.</p>\n\n<p>Google yields nothing, what basic thing am I missing?</p>\n"}, {"tags": ["c++", "struct"], "comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 1, "creation_date": 1432158765, "post_id": 30360958, "comment_id": 48813737, "body": "Use <code>std::uniqur_ptr</code> or <code>std::shared_ptr</code> and it&#39;ll be deleted for you automagically."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "reply_to_user": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 1, "creation_date": 1432158820, "post_id": 30360958, "comment_id": 48813765, "body": "@CaptainObvlious Not great advice if there&#39;s no reason for dynamic allocation."}, {"owner": {"reputation": 15257, "user_id": 648078, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9698c2f1c188de4ebf3c4496d9f07eb0?s=128&d=identicon&r=PG", "display_name": "Marius Bancila", "link": "https://stackoverflow.com/users/648078/marius-bancila"}, "edited": false, "score": 0, "creation_date": 1432158991, "post_id": 30360958, "comment_id": 48813835, "body": "You&#39;re pushing values in the <code>stack</code> container, but then threat them as pointers to objects from the heap. Then, trying to delete an object from the program stack (not to be confused with your <code>stack</code> container) crashes the program."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 2, "creation_date": 1432159098, "post_id": 30360958, "comment_id": 48813889, "body": "Is there some special reason you&#39;re using <code>new</code> here? Why not just <code>Person p; ... stack.push(p);</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1314, "user_id": 2402598, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91b0e9d6a7784337d7ea1deeac7f5f4a?s=128&d=identicon&r=PG", "display_name": "optional", "link": "https://stackoverflow.com/users/2402598/optional"}, "edited": false, "score": 0, "creation_date": 1432230978, "post_id": 30360974, "comment_id": 48851290, "body": "The stack stores its own copy of the object pushed into it on the <code>Stack</code> memory, right? What do I do if I don&#39;t have enough <code>Stack</code> memory since I push a lot of objects, around 40 000 000 <code>Person</code>?"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "reply_to_user": {"reputation": 1314, "user_id": 2402598, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91b0e9d6a7784337d7ea1deeac7f5f4a?s=128&d=identicon&r=PG", "display_name": "optional", "link": "https://stackoverflow.com/users/2402598/optional"}, "edited": false, "score": 1, "creation_date": 1432231127, "post_id": 30360974, "comment_id": 48851373, "body": "@optional You&#39;d probably get a <code>std::bad_alloc</code> exception."}], "tags": [], "owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "is_accepted": true, "score": 8, "last_activity_date": 1432159320, "last_edit_date": 1432159320, "creation_date": 1432158512, "answer_id": 30360974, "question_id": 30360958, "link": "https://stackoverflow.com/questions/30360958/free-the-memory-of-a-pointer-to-a-struct/30360974#30360974", "title": "Free the memory of a pointer to a struct", "body": "<p>You would need to <code>delete p</code> after pushing into the stack. The stack stores its own copy of the object pushed into it, so there is no need to do anything to it after popping.</p>\n\n<p>But the real solution is to not use <code>new</code> in the first place:</p>\n\n<pre><code>Person p = {\"name\", 211};\n...\nstack.push(p);\n</code></pre>\n\n<p>or just</p>\n\n<pre><code>stack.push(Person{\"name\", 211});\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>Person current = stack.front();\nstack.pop();\n</code></pre>\n\n<p>So, no need to deal directly with memory management.</p>\n"}, {"tags": [], "owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "is_accepted": false, "score": 4, "last_activity_date": 1432158570, "creation_date": 1432158570, "answer_id": 30360992, "question_id": 30360958, "link": "https://stackoverflow.com/questions/30360958/free-the-memory-of-a-pointer-to-a-struct/30360992#30360992", "title": "Free the memory of a pointer to a struct", "body": "<p>When you push something on to a stack, you don't push the original object - you push a <em>copy</em> of the object. To free the memory of the original object, you need to do it right at the point after you've pushed it.</p>\n\n<p>Or you can skip that altogether and don't use <code>new</code> to create the object in the first place:</p>\n\n<pre><code>Person p;\np.name = \"name\";\np.age = 211;\nstack.push(p);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9606, "user_id": 3677097, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8c49e598194e53b9aba3a195da387a5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas DM", "link": "https://stackoverflow.com/users/3677097/andreas-dm"}, "is_accepted": false, "score": 0, "last_activity_date": 1432159271, "creation_date": 1432159271, "answer_id": 30361153, "question_id": 30360958, "link": "https://stackoverflow.com/questions/30360958/free-the-memory-of-a-pointer-to-a-struct/30361153#30361153", "title": "Free the memory of a pointer to a struct", "body": "<p>You don't need to make a pointer. If you have to, then use a smart pointer to free the memory for you: <br><code>std::unique_ptr&lt;Person&gt; p(new Person);</code></p>\n"}], "owner": {"reputation": 1314, "user_id": 2402598, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91b0e9d6a7784337d7ea1deeac7f5f4a?s=128&d=identicon&r=PG", "display_name": "optional", "link": "https://stackoverflow.com/users/2402598/optional"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 30360974, "answer_count": 3, "score": 1, "last_activity_date": 1432159320, "creation_date": 1432158390, "last_edit_date": 1432158691, "question_id": 30360958, "link": "https://stackoverflow.com/questions/30360958/free-the-memory-of-a-pointer-to-a-struct", "title": "Free the memory of a pointer to a struct", "body": "<p>I am new to <code>C++</code> and implemented the following <code>struct</code>:  </p>\n\n<pre><code>struct Person {\n  String name;\n  int age;\n};\n</code></pre>\n\n<p>Now I create a new object:</p>\n\n<pre><code> Person *p = new Person();\n p-&gt;name = \"name\";\n p-&gt;age = 211;\n</code></pre>\n\n<p>and <code>push</code> it onto a <code>stack</code>:</p>\n\n<pre><code> stack.push(*p);\n</code></pre>\n\n<p>I have a <code>while(!stack.empty())</code> expression and in there I process every element I pushed onto the stack.<br>\nNow where do I free the memory? In the <code>while</code>-loop I do the following:</p>\n\n<pre><code>Person *current = &amp;stack.front();\nstack.pop();\n// do stuff\ndelete current;\n</code></pre>\n\n<p>Sadly, the <code>delete current</code> statement throws some kind of exception.  </p>\n\n<p>What do I do wrong? Thanks for your help.</p>\n"}, {"tags": ["c++", "asynchronous"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1432158100, "post_id": 30360822, "comment_id": 48813475, "body": "Use a mutex and a condition variable?"}, {"owner": {"reputation": 6472, "user_id": 259538, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/8zSjE.png?s=128&g=1", "display_name": "panofish", "link": "https://stackoverflow.com/users/259538/panofish"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1432158250, "post_id": 30360822, "comment_id": 48813525, "body": "It&#39;s my understanding that a condition variable is only available in vc++11?  I have made many various attempts along these lines, but due to inexperience, I have gotten no where."}, {"owner": {"reputation": 1552, "user_id": 2362671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0585760afe78ec9aafe1836b826ed495?s=128&d=identicon&r=PG", "display_name": "Come Raczy", "link": "https://stackoverflow.com/users/2362671/come-raczy"}, "edited": false, "score": 0, "creation_date": 1432159058, "post_id": 30360822, "comment_id": 48813866, "body": "@panofish if you really have to stick to older versions of c++, use the <a href=\"http://www.boost.org/\" rel=\"nofollow noreferrer\">boost library</a> - it provides mutex and condition variables. Alternatively you can implement the <a href=\"http://en.wikipedia.org/wiki/Peterson&#39;s_algorithm\" rel=\"nofollow noreferrer\">Peterson algorithm</a> or any other <a href=\"http://en.wikipedia.org/wiki/Mutual_exclusion\" rel=\"nofollow noreferrer\">mutual exclusion</a> algorithm"}], "answers": [{"comments": [{"owner": {"reputation": 6472, "user_id": 259538, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/8zSjE.png?s=128&g=1", "display_name": "panofish", "link": "https://stackoverflow.com/users/259538/panofish"}, "edited": false, "score": 0, "creation_date": 1432159524, "post_id": 30361074, "comment_id": 48814020, "body": "This looks very promising... give me some time to absorb and implement... I will respond sometime tomorrow.  Thanks. :)"}, {"owner": {"reputation": 6472, "user_id": 259538, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/8zSjE.png?s=128&g=1", "display_name": "panofish", "link": "https://stackoverflow.com/users/259538/panofish"}, "edited": false, "score": 0, "creation_date": 1432216942, "post_id": 30361074, "comment_id": 48841670, "body": "I implemented the Windows Event objects solution, but a strange thing is happening.  The WaitForSingleObject call is blocking the OnEvent from being triggered, so the loop is permanently stuck at WaitForSingleObject!?  Without the WaitForSingleObject, the OnEvent does get triggered."}, {"owner": {"reputation": 6472, "user_id": 259538, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/8zSjE.png?s=128&g=1", "display_name": "panofish", "link": "https://stackoverflow.com/users/259538/panofish"}, "edited": false, "score": 0, "creation_date": 1432240832, "post_id": 30361074, "comment_id": 48856942, "body": "I also tried the first suggestion with boost::conditional_variable and I got the same results as &quot;Windows Event objects&quot;.  The conditional_variable.wait() command is blocking the EVENT_LIBRARY_LOADED and the OnEvent function never gets called... so the program loop freezes!?  Any more ideas much appreciated."}, {"owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "reply_to_user": {"reputation": 6472, "user_id": 259538, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/8zSjE.png?s=128&g=1", "display_name": "panofish", "link": "https://stackoverflow.com/users/259538/panofish"}, "edited": false, "score": 0, "creation_date": 1432242711, "post_id": 30361074, "comment_id": 48857991, "body": "I must&#39;ve assumed <code>OnEvent</code> was being processed on a thread of sorts. If it&#39;s being processed on the same thread it will make things more difficult (and none of the options above will help, sorry). You will basically need to block code, but continue to process the code that handles your <code>OnEvent</code>. Ultimately I&#39;d recommend just putting your <code>pData</code> calls on another thread. <code>boost::thread</code> and <code>boost::mutex</code> will help you accomplish that"}], "tags": [], "owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "is_accepted": true, "score": 2, "last_activity_date": 1572572128, "last_edit_date": 1592644375, "creation_date": 1432158962, "answer_id": 30361074, "question_id": 30360822, "link": "https://stackoverflow.com/questions/30360822/creating-c-blocking-function-for-existing-asynchronous-code/30361074#30361074", "title": "Creating C++ Blocking Function for Existing Asynchronous code", "body": "<h1>If boost libraries are an option, use <code>boost::condition_variable</code></h1>\n<p>You've already made it clear C++11 isn't an option (otherwise you could use <code>std::condition_variable</code>). <code>boost::condition_variable</code> will accomplish what you need to do, and it's very simple to use. You only need to call <code>wait</code> and <code>notify_one</code>:</p>\n<pre><code>void MyApp::main() \n{\n    for(int i=0; i&lt;total; ++i) {\n        pData-&gt;RegisterEvent( EVENT_LIBRARY_LOADED, this );   \n        pData-&gt;OpenLibrary(&quot;c:/path/file.dat&quot;);  // asynchronous call\n        condition_variable.wait(); // wait until we've been signaled\n    }\n}\n\nvoid MyApp::OnEvent( ID eventType ) \n{\n    if (eventType == EVENT_LIBRARY_LOADED) {\n        qDebug() &lt;&lt; &quot;Library load has completed&quot;;\n        // signal completion:\n        condition_variable.notify_one();\n    }\n}\n</code></pre>\n<h1>Otherwise you could use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms686915(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Windows Event objects</a></h1>\n<p>These work very similar to the above but are a little more complicated to use (and also OS specific).</p>\n<pre><code>HANDLE hEvent = ::CreateEvent(NULL, TRUE, FALSE, NULL);\nvoid MyApp::main() \n{\n    for(int i=0; i&lt;total; ++i) {\n        // Prepare signal (otherwise if the signal has been Set already, Wait will return instantly)\n        ::ResetEvent(hEvent);\n        pData-&gt;RegisterEvent( EVENT_LIBRARY_LOADED, this );   \n        pData-&gt;OpenLibrary(&quot;c:/path/file.dat&quot;);  // asynchronous call\n        // wait for event to signal:\n        ::WaitForSingleObject(hEvent, INFINITE);\n    }\n}\n    \nvoid MyApp::OnEvent( ID eventType ) \n{\n    if (eventType == EVENT_LIBRARY_LOADED) {\n        qDebug() &lt;&lt; &quot;Library load has completed&quot;;\n        // Signal event:\n        ::SetEvent(hEvent);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 6472, "user_id": 259538, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/8zSjE.png?s=128&g=1", "display_name": "panofish", "link": "https://stackoverflow.com/users/259538/panofish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 610, "favorite_count": 0, "accepted_answer_id": 30361074, "answer_count": 1, "score": 2, "last_activity_date": 1572572128, "creation_date": 1432157746, "last_edit_date": 1432241098, "question_id": 30360822, "link": "https://stackoverflow.com/questions/30360822/creating-c-blocking-function-for-existing-asynchronous-code", "title": "Creating C++ Blocking Function for Existing Asynchronous code", "body": "<p>I have a C++ plugin I have written for a proprietary software which makes an asynchronous call to a function called OpenLibrary.  To know when the library load has completed, I must register for a specific event.  Then, when that event is triggered, an OnEvent routine is called.  This logic is somewhat sterilized for proprietary reasons, but the asynchronous call and onEvent trigger works correctly.  Unfortunately, since the OpenLibrary call is asynchronous, the loop is not blocked and continues without waiting for the EVENT_LIBRARY_LOADED event.  I need to process the files serially.</p>\n\n<pre><code>...\n\nvoid MyApp::main() \n{\n    for(int i=0; i&lt;total; ++i) {\n        pData-&gt;RegisterEvent( EVENT_LIBRARY_LOADED, this );   \n        pData-&gt;OpenLibrary(\"c:/path/file.dat\");  // asynchronous call\n    }\n}\n\n...\n\n\nvoid MyApp::OnEvent( ID eventType ) \n{\n    if (eventType == EVENT_LIBRARY_LOADED) {\n        qDebug() &lt;&lt; \"Library load has completed\";\n    }\n}\n\n...\n</code></pre>\n\n<p>The plugin requires VS2008 and also takes advantage of the Qt library.</p>\n\n<p>I would like to create a function called waitForEvent, where subsequent code is blocked until the event has occurred then waitForEvent can return control back to the calling routines loop.  This way, I can stay inside my main routines loop and simply wait for the event before continuing.  Any suggestions appreciated.</p>\n\n<p>UPDATE: I have tried both excellent suggestions below by Tas, but in either case, I get the same result.  The WaitForSingleObject OR the condition_variable.wait BOTH prevent the EVENT_LIBRARY_LOADED event from triggering the OnEvent function from being called, which freezes the loop.</p>\n\n<p>Any more suggestions appreciated. </p>\n"}, {"tags": ["c++", "copy-assignment"], "comments": [{"owner": {"reputation": 2918, "user_id": 706853, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9c30e27447b27ce9c8645eadb94efe92?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/706853/alex"}, "edited": false, "score": 1, "creation_date": 1432157910, "post_id": 30360809, "comment_id": 48813392, "body": "When you return <code>this*</code>, you&#39;re making it possible for the assignment operator to be chained like <code>i = j = k = ...</code>. You can return other stuff, but how useful that is would be based on your definitions and how you want your classes to be used"}, {"owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 4, "creation_date": 1432157921, "post_id": 30360809, "comment_id": 48813399, "body": "Expression templates."}, {"owner": {"reputation": 15257, "user_id": 648078, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9698c2f1c188de4ebf3c4496d9f07eb0?s=128&d=identicon&r=PG", "display_name": "Marius Bancila", "link": "https://stackoverflow.com/users/648078/marius-bancila"}, "reply_to_user": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 5, "creation_date": 1432158269, "post_id": 30360809, "comment_id": 48813534, "body": "@AlanStokes It would be nice if you elaborated on that, you know."}, {"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 0, "creation_date": 1432158324, "post_id": 30360809, "comment_id": 48813553, "body": "interesting question, but why are you asking? Is it really a <a href=\"http://stackoverflow.com/tour\">practical, detailed question</a>? Then try to show it."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1432162193, "post_id": 30360809, "comment_id": 48814890, "body": "note: the answers to the duplicate explore various scenarios where <code>*this</code> is not returned"}], "answers": [{"comments": [{"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 0, "creation_date": 1432158457, "post_id": 30360928, "comment_id": 48813607, "body": "Do you know other examples?"}, {"owner": {"reputation": 71857, "user_id": 47453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412dc332ab3593c636e5a5202cf98870?s=128&d=identicon&r=PG", "display_name": "Bill Lynch", "link": "https://stackoverflow.com/users/47453/bill-lynch"}, "reply_to_user": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 2, "creation_date": 1432158543, "post_id": 30360928, "comment_id": 48813648, "body": "@Wolf: Boost::Phoenix is a library to create lazy expressions. So the <code>operator=()</code> there would return some object that you could call <code>operator()()</code> on to actually perform the assignment."}, {"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "reply_to_user": {"reputation": 71857, "user_id": 47453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412dc332ab3593c636e5a5202cf98870?s=128&d=identicon&r=PG", "display_name": "Bill Lynch", "link": "https://stackoverflow.com/users/47453/bill-lynch"}, "edited": false, "score": 0, "creation_date": 1432158687, "post_id": 30360928, "comment_id": 48813712, "body": "@BillLynch this seems to be what Alan Stokes mentioned?"}], "tags": [], "owner": {"reputation": 14111, "user_id": 1126943, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yeuHw.png?s=128&g=1", "display_name": "zch", "link": "https://stackoverflow.com/users/1126943/zch"}, "is_accepted": true, "score": 9, "last_activity_date": 1432158258, "creation_date": 1432158258, "answer_id": 30360928, "question_id": 30360809, "link": "https://stackoverflow.com/questions/30360809/is-there-ever-a-valid-reason-to-not-return-this-from-copy-assignment-operator/30360928#30360928", "title": "Is there ever a valid reason to not return *this from copy assignment operator?", "body": "<p>The example from the standard is <a href=\"http://en.cppreference.com/w/cpp/atomic/atomic/operator%3D\"><code>std::atomic</code></a>. It returns the assigned value. If it returned reference, then reading through it might yield different result.</p>\n"}, {"tags": [], "owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "is_accepted": false, "score": 0, "last_activity_date": 1432161881, "creation_date": 1432161881, "answer_id": 30361641, "question_id": 30360809, "link": "https://stackoverflow.com/questions/30360809/is-there-ever-a-valid-reason-to-not-return-this-from-copy-assignment-operator/30361641#30361641", "title": "Is there ever a valid reason to not return *this from copy assignment operator?", "body": "<p>If you want to prevent assignment chaining.</p>\n\n<p>Sometimes its nice to prevent expressions like this:</p>\n\n<pre><code>x = y = z = a = b = c = d = foo{15};\n</code></pre>\n\n<p>So you make the assignment operator return void.</p>\n\n<pre><code>struct foo {\n    void operator=(const foo &amp;);\n};\n</code></pre>\n\n<p>For some types chaining does not make sense. But you have to look at that on a case be case basis.</p>\n"}], "owner": {"reputation": 942, "user_id": 1073784, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a826c65f4ff3e4fbffb972c3b16acde7?s=128&d=identicon&r=PG", "display_name": "Sami Liedes", "link": "https://stackoverflow.com/users/1073784/sami-liedes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 3, "closed_date": 1432162175, "accepted_answer_id": 30360928, "answer_count": 2, "score": 11, "last_activity_date": 1432161881, "creation_date": 1432157698, "question_id": 30360809, "link": "https://stackoverflow.com/questions/30360809/is-there-ever-a-valid-reason-to-not-return-this-from-copy-assignment-operator", "closed_reason": "Duplicate", "title": "Is there ever a valid reason to not return *this from copy assignment operator?", "body": "<p>Let <code>foo</code> be a struct or class with a copy assignment operator:</p>\n\n<pre><code>struct foo {\n    foo &amp;operator=(const foo &amp;);  // or with some other return type?\n};\n</code></pre>\n\n<p>Is there <em>ever</em> a sensible reason to return anything other than <code>*this</code> from the <code>operator=()</code>? Using it for something unrelated to assignment doesn't qualify as sensible.</p>\n"}, {"tags": ["c++", "c++11", "operator-overloading", "operators"], "comments": [{"owner": {"reputation": 706, "user_id": 549635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a23f6024e1f9e0c239dfb0c3ae72206?s=128&d=identicon&r=PG", "display_name": "Maze", "link": "https://stackoverflow.com/users/549635/maze"}, "edited": false, "score": 0, "creation_date": 1432191119, "post_id": 30360653, "comment_id": 48823930, "body": "When you mix your cocktails, do you pour them into a new glass? IMHO that would correspond to the external  <code>operator+</code> and should leave <code>c1</code> untouched. If, however, you put the second cocktail into the first it corresponds to the internal <code>operator+=</code> which modifies <code>c1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 3, "creation_date": 1432157925, "post_id": 30360777, "comment_id": 48813401, "body": "That is <i>a valid way</i> to do it, but &quot;the right way&quot; might be too bold a statement.  <code>Cocktail operator+(Cocktail c1, Cocktail const&amp; c2)</code> would apply the same implicit conversion rules to both operands <b>and</b> support more C++11 move semantics."}, {"owner": {"reputation": 1596, "user_id": 3431124, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xaBzf.jpg?s=128&g=1", "display_name": "Robert S.", "link": "https://stackoverflow.com/users/3431124/robert-s"}, "reply_to_user": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1432158105, "post_id": 30360777, "comment_id": 48813477, "body": "Ok the best way from the choices inside the question. And the most common signature that is used (e.g. for basic arithmetic purposes)."}, {"owner": {"reputation": 1596, "user_id": 3431124, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xaBzf.jpg?s=128&g=1", "display_name": "Robert S.", "link": "https://stackoverflow.com/users/3431124/robert-s"}, "reply_to_user": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1432158886, "post_id": 30360777, "comment_id": 48813792, "body": "@DrewDormann: My bad. I thought he had to use an internal operator (given by the task). An external operator makes more sense if the members are accessible."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 1, "creation_date": 1432162197, "post_id": 30360777, "comment_id": 48814892, "body": "I would have defined the <code>operator+</code> in terms of the <code>operator+=</code> to prevent duplicated code. So &quot;the right way&quot; does not seem to be universal &quot;right way&quot;."}, {"owner": {"reputation": 706, "user_id": 549635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a23f6024e1f9e0c239dfb0c3ae72206?s=128&d=identicon&r=PG", "display_name": "Maze", "link": "https://stackoverflow.com/users/549635/maze"}, "edited": false, "score": 0, "creation_date": 1432191773, "post_id": 30360777, "comment_id": 48824284, "body": "Code reuse in this case leads to IMHO unwanted and unexpected behavior"}], "tags": [], "owner": {"reputation": 1596, "user_id": 3431124, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xaBzf.jpg?s=128&g=1", "display_name": "Robert S.", "link": "https://stackoverflow.com/users/3431124/robert-s"}, "is_accepted": true, "score": -2, "last_activity_date": 1432157548, "creation_date": 1432157548, "answer_id": 30360777, "question_id": 30360653, "link": "https://stackoverflow.com/questions/30360653/best-way-to-create-an-operator-inside-a-class-without-declaring-so-many-unneces/30360777#30360777", "title": "best way to create an operator+ inside a class without declaring so many unnecessary variables", "body": "<pre><code>   Cocktail operator+(Cocktail const&amp; other) const {\n      Cocktail c; \n      c.name = name + \"mixed with\" + other.name; \n      c.volume = volume + other.volume; \n      return c; \n   }\n</code></pre>\n\n<p>This is the right way to implement the binary + operator. Think as: You create a new cocktail out of two others.</p>\n\n<p>If you want to add a cocktail to another one, the operator += would be correct.</p>\n\n<p>But based on your task I guess the first one would be better.</p>\n"}, {"tags": [], "owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "is_accepted": false, "score": 0, "last_activity_date": 1432164219, "last_edit_date": 1432164219, "creation_date": 1432163323, "answer_id": 30361862, "question_id": 30360653, "link": "https://stackoverflow.com/questions/30360653/best-way-to-create-an-operator-inside-a-class-without-declaring-so-many-unneces/30361862#30361862", "title": "best way to create an operator+ inside a class without declaring so many unnecessary variables", "body": "<p>Prefer this approach.</p>\n\n<pre><code>const Cocktail operator+(Cocktail c1, Cocktail const&amp; c2){\n    return c1+=c2; \n}\n</code></pre>\n\n<ul>\n<li>It does not duplicate code.</li>\n<li>It allows the same implicit conversions for <code>c1</code> and <code>c2</code>.  (<code>*this</code> doesn't implicitly convert)</li>\n<li>It allows move semantics or copy elision for <code>c1</code></li>\n<li>It allows better encapsulation</li>\n</ul>\n"}], "owner": {"reputation": 13, "user_id": 4903743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/710addfe309f2ab4754fe80d1885dd30?s=128&d=identicon&r=PG&f=1", "display_name": "johabachi", "link": "https://stackoverflow.com/users/4903743/johabachi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "accepted_answer_id": 30360777, "answer_count": 2, "score": -4, "last_activity_date": 1432164219, "creation_date": 1432157045, "question_id": 30360653, "link": "https://stackoverflow.com/questions/30360653/best-way-to-create-an-operator-inside-a-class-without-declaring-so-many-unneces", "title": "best way to create an operator+ inside a class without declaring so many unnecessary variables", "body": "<p>So we were given a question where we have a class called Cocktail with name and volume attributes. Now they want us to \"write an overloading operator addition to make the mix of two cocktails i.e. add two cocktails together which gives : \nvolume of cocktail 1 + volume of cocktail 2  is the resultant volume and name of cocktail 1 + \"mixed with \" + name of cocktail 2 as the resultant name. \nThey said make all the necessary hypothesis of the class Cocktail .(i supposed there are private attributes name and volume. )There is not however yet any other overloaded function in the class Cocktail. \nDoes that mean i am allowed to define two operators?\nBecause i was thinking of creating an internal operator += and then calling it in my external operator+ which would be the most logical solution in my opinion: </p>\n\n<pre><code>//inside my class Cocktail, INTERNAL OPERATOR\nCocktail&amp; operator+=(Cocktail const&amp; c1){\n    name = name + \"mixed with\" + c1.name; \n    volume = volume + c1.volume; \n    return *this; \n}\n\n//external operator\n\nconst Cocktail operator+(Cocktail c1, Cocktail const&amp; c2){\n    c1+=c2; \n    return c1; \n}\n</code></pre>\n\n<p>but i dont know if with their instructions i would be allowed to make two. So i tried to make one internal operator and the only thing i could think of is having to declare a new cocktail inside the definition and then returning its value as follows: </p>\n\n<pre><code>//internal operator\n\nCocktail operator+(Cocktail const&amp; other) const {\n   Cocktail c; \n   c.name = name + \"mixed with\" + other.name; \n   c.volume = volume + other.volume; \n   return c; \n}\n</code></pre>\n\n<p>but i find that kind of weird, so i thought maybe this would be better but im starting to question if my next option would compile: </p>\n\n<pre><code>//internal operator\nCocktail&amp; operator+(Cocktail const&amp; c){\n    name = name + \"mixed with\" + c.name; \n    volume = volume + c.volume; \n    return *this; \n}  \n</code></pre>\n\n<p>do i have the right to do that`?\nwhich is the best way to define an operator? \nis there a better way?\nthanks</p>\n"}, {"tags": ["c#", "c++", ".net", "enums", "mono"], "comments": [{"owner": {"reputation": 9055, "user_id": 996081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83817dc1e83cf8ac372b21cd5f010bc4?s=128&d=identicon&r=PG&f=1", "display_name": "cbr", "link": "https://stackoverflow.com/users/996081/cbr"}, "edited": false, "score": 0, "creation_date": 1432194630, "post_id": 30360649, "comment_id": 48825991, "body": "Try iterating all of the class methods with <a href=\"http://docs.go-mono.com/?link=xhtml%3adeploy%2fmono-api-class.html\" rel=\"nofollow noreferrer\"><code>mono_class_get_methods</code></a> - does the method show up there?"}, {"owner": {"reputation": 340, "user_id": 1623317, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/FFxns.jpg?s=128&g=1", "display_name": "Howard Rubin", "link": "https://stackoverflow.com/users/1623317/howard-rubin"}, "reply_to_user": {"reputation": 9055, "user_id": 996081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83817dc1e83cf8ac372b21cd5f010bc4?s=128&d=identicon&r=PG&f=1", "display_name": "cbr", "link": "https://stackoverflow.com/users/996081/cbr"}, "edited": false, "score": 0, "creation_date": 1432225970, "post_id": 30360649, "comment_id": 48848200, "body": "The method in question (SetType) shows up when iterating with mono_class_get_methods(). And using mono_method_signature(), mono_signature_get_params() and mono_type_get_name() shows that internally mono know its parameter type to be EnumTest.EnumClass.HelloType  So it would seem that my above code is correct."}], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 916216, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6986ef8f7dd031904a39f2f54db4372c?s=128&d=identicon&r=PG", "display_name": "Hikari", "link": "https://stackoverflow.com/users/916216/hikari"}, "edited": false, "score": 0, "creation_date": 1593484909, "post_id": 30380335, "comment_id": 110791140, "body": "your example code is not Not exactly correct, mono_method_get_param_names. your code will cause stack crash. try:const char* paramNames[128] = { 0 };                 mono_method_get_param_names(iter, paramNames);"}], "tags": [], "owner": {"reputation": 9055, "user_id": 996081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83817dc1e83cf8ac372b21cd5f010bc4?s=128&d=identicon&r=PG&f=1", "display_name": "cbr", "link": "https://stackoverflow.com/users/996081/cbr"}, "is_accepted": true, "score": 1, "last_activity_date": 1432231805, "last_edit_date": 1432231805, "creation_date": 1432228584, "answer_id": 30380335, "question_id": 30360649, "link": "https://stackoverflow.com/questions/30360649/passing-c-enum-from-c-using-mono/30380335#30380335", "title": "Passing C# enum from C++ using mono", "body": "<p>Looks like the parameter type requires the full type name.</p>\n\n<p>I used <code>mono_method_full_name</code> with the second argument <em>signature</em> <code>true</code> to get the signature (I used my own test class with identical structure but different names):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>MonoDomain* domain = mono_jit_init(CSHARP_LIB);\nMonoAssembly* assembly = mono_domain_assembly_open(domain, CSHARP_LIB);\nMonoImage* image = mono_assembly_get_image(assembly);\nMonoClass* sandboxClass = mono_class_from_name(image, \"CSharp_ClassLibrary\", \"Sandbox\");\n\nvoid* ptr = 0;\nMonoMethod* iter;\n\nwhile ((iter = mono_class_get_methods(sandboxClass, &amp;ptr)) != NULL)\n{\n    printf(\"--------------------------------\\n\");\n    const char* name = mono_method_get_name(iter);\n    MonoMethodDesc* methodDesc = mono_method_desc_from_method(iter);\n\n    const char* paramNames = \"\";\n    mono_method_get_param_names(iter, &amp;paramNames);\n\n    printf(\"Name: %s\\n\", name);\n    printf(\"Full name: %s\\n\", mono_method_full_name(iter, true));\n    printf(\"    namespace: %s\\n\", methodDesc -&gt;namespace);\n    printf(\"    class:     %s\\n\", methodDesc -&gt;klass);\n    printf(\"    name:      %s\\n\", methodDesc -&gt;name);\n    printf(\"    args:      %s\\n\", methodDesc -&gt;args);\n    printf(\"    num_args:  %d\\n\", methodDesc -&gt;num_args);\n    printf(\"    paramnames:%s\\n\", paramNames);\n}\n</code></pre>\n\n<p>The output I received was this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>--------------------------------\nName: SetDefault\nFull name: CSharp_ClassLibrary.Sandbox:SetDefault ()\n    namespace: CSharp_ClassLibrary\n    class:     Sandbox\n    name:      SetDefault\n    args:      (null)\n    num_args:  0\n    paramnames:\n--------------------------------\nName: SetType\nFull name: CSharp_ClassLibrary.Sandbox:SetType (CSharp_ClassLibrary.Sandbox/HelloType)\n    namespace: CSharp_ClassLibrary\n    class:     Sandbox\n    name:      SetType\n    args:      (null)\n    num_args:  0\n    paramnames:h\n--------------------------------\nName: .ctor\nFull name: CSharp_ClassLibrary.Sandbox:.ctor ()\n    namespace: CSharp_ClassLibrary\n    class:     Sandbox\n    name:      .ctor\n    args:      (null)\n    num_args:  0\n    paramnames:\n</code></pre>\n\n<p>So to fix your code, you'd just add the class name before the parameter type:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>MonoMethodDesc* typeDesc = mono_method_desc_new(\"EnumTest.EnumClass:SetType(EnumClass/HelloType)\", false);\nMonoMethod* typeMethod = mono_method_desc_search_in_class(typeDesc, enumClass);\n</code></pre>\n\n<p>This, at least for me, works just fine!</p>\n\n<p><a href=\"https://i.imgur.com/iZD2MQY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/iZD2MQY.png\" alt=\"\"></a></p>\n"}], "owner": {"reputation": 340, "user_id": 1623317, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/FFxns.jpg?s=128&g=1", "display_name": "Howard Rubin", "link": "https://stackoverflow.com/users/1623317/howard-rubin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "accepted_answer_id": 30380335, "answer_count": 1, "score": 1, "last_activity_date": 1432231805, "creation_date": 1432157035, "last_edit_date": 1432160902, "question_id": 30360649, "link": "https://stackoverflow.com/questions/30360649/passing-c-enum-from-c-using-mono", "title": "Passing C# enum from C++ using mono", "body": "<p>Why can't I get the MonoMethod* for the method that takes an enum,<br>\nand is there a way to list the methods that mono knows about?</p>\n\n<p>Here's a reduced example of what I'm trying to do. I tried different combinations of what (Windows) ildasm reported but no success.</p>\n\n<pre><code>// enum.cs\nnamespace EnumTest\n{\n    class EnumClass\n    {\n        public enum HelloType { Hi, Hey, Howdy, Greetings, Aloha };\n\n        public static void SetDefault() { type_ = HelloType.Hi; }\n\n        public static void SetType(HelloType h) { type_ = h; }\n\n        public static HelloType type_;\n    }\n}\n</code></pre>\n\n<hr>\n\n<pre><code>// enum.cpp\n#include &lt;mono/jit/jit.h&gt;\n#include &lt;mono/metadata/assembly.h&gt;\n#include &lt;mono/metadata/debug-helpers.h&gt;\n\nint main(int argc, char* argv[]) {\n  MonoDomain* domain = mono_jit_init(\"enum.dll\");\n  MonoAssembly* assembly = mono_domain_assembly_open(domain, \"enum.dll\");\n  MonoImage* image = mono_assembly_get_image(assembly);\n  MonoClass* enumClass = mono_class_from_name(image, \"EnumTest\", \"EnumClass\");\n\n  MonoMethodDesc* defaultDesc = mono_method_desc_new(\"EnumTest.EnumClass:SetDefault()\", false);\n  MonoMethod* defaultMethod = mono_method_desc_search_in_class(defaultDesc, enumClass);\n\n  printf(\"defaultDesc from mono_method_desc_new() is %p\\n\", defaultDesc);\n  printf(\"defaultMethod from mono_method_desc_search_in_class() is %p\\n\\n\", defaultMethod);\n\n\n  MonoMethodDesc* typeDesc = mono_method_desc_new(\"EnumTest.EnumClass:SetType(HelloType)\", false);\n  MonoMethod* typeMethod = mono_method_desc_search_in_class(typeDesc, enumClass);\n\n  printf(\"typeDesc from mono_method_desc_new() is %p\\n\", typeDesc);\n  printf(\"typeMethod from mono_method_desc_search_in_class() is %p      &lt;------\\n\", typeMethod);\n\n\n  mono_jit_cleanup(domain);\n}\n</code></pre>\n\n<hr>\n\n<pre><code>$ mcs /nologo /warn:4 /debug:pdbonly /o  /out:enum.dll /target:library enum.cs\n$ gcc enum.cpp -g3 `pkg-config --cflags --libs mono-2` -o enum\n$ ./enum\ndefaultDesc from mono_method_desc_new() is 0x1443920\ndefaultMethod from mono_method_desc_search_in_class() is 0x13dce40\n\ntypeDesc from mono_method_desc_new() is 0x1444590\ntypeMethod from mono_method_desc_search_in_class() is (nil)      &lt;------\n$ uname -a\nLinux U14-OOXML 3.16.0-37-generic #51~14.04.1-Ubuntu SMP Wed May 6 15:23:14 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux\n</code></pre>\n"}, {"tags": ["c++", "llvm", "compiler-optimization", "register-allocation"], "answers": [{"tags": [], "owner": {"reputation": 330, "user_id": 4594043, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001079458537/picture?type=large", "display_name": "Natanael Ramos", "link": "https://stackoverflow.com/users/4594043/natanael-ramos"}, "is_accepted": true, "score": 1, "last_activity_date": 1454932222, "creation_date": 1454932222, "answer_id": 35268966, "question_id": 30360468, "link": "https://stackoverflow.com/questions/30360468/implement-a-register-allocator-in-llvm/35268966#35268966", "title": "Implement a Register Allocator in LLVM", "body": "<p>Well, after a while I have finished my project and have written an tutorial of How to write an LLVM register allocator using the <code>RegAllocBase</code> interface.</p>\n\n<p>The tutorial have been written in <code>reStructuredText</code> and it's available on GitHub: <a href=\"https://github.com/nael8r/How-To-Write-An-LLVM-Register-Allocator\" rel=\"nofollow\">https://github.com/nael8r/How-To-Write-An-LLVM-Register-Allocator</a></p>\n"}], "owner": {"reputation": 330, "user_id": 4594043, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001079458537/picture?type=large", "display_name": "Natanael Ramos", "link": "https://stackoverflow.com/users/4594043/natanael-ramos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 700, "favorite_count": 0, "accepted_answer_id": 35268966, "answer_count": 1, "score": 3, "last_activity_date": 1454932222, "creation_date": 1432156415, "question_id": 30360468, "link": "https://stackoverflow.com/questions/30360468/implement-a-register-allocator-in-llvm", "title": "Implement a Register Allocator in LLVM", "body": "<p>I'm working on my project for completion undergraduate courses, consisting of an experimental analysis of registers allocation algorithms. For this task, I am using the set of tools from the LLVM project.</p>\n\n<p>However, I have read the documentation of the LLVM project and not yet found a way to put the pieces of the puzzle together. So far I know:</p>\n\n<ul>\n<li>As passes work as engage them to LLVM and know I must implement MachineFunctionPass <a href=\"http://llvm.org/docs/WritingAnLLVMPass.html\" rel=\"nofollow\">pass</a>.</li>\n<li>I follow some suggestions to look at the <a href=\"http://llvm.org/docs/doxygen/html/RegAllocBasic_8cpp.html\" rel=\"nofollow\">Basic Allocator</a> code, but could not understand much.</li>\n</ul>\n\n<p>The allocator I intend to implement is based on graph coloring heuristics, as the theory of operation of such methods I\u2019m well aware.</p>\n\n<p>So I look for is some sort of \"How to\", a defined set of steps to implement such allocator. It sounds like carelessness, but I have to deliver the work in about six months and I'm a little confused.</p>\n\n<p>If anyone can give me some guidance or reference to any supporting material (besides the own documentation), I would be grateful.</p>\n\n<p>My English may be a little wrong, I am a Brazilian student.</p>\n"}, {"tags": ["c++", "qt", "focus", "qtextedit"], "comments": [{"owner": {"reputation": 20165, "user_id": 498437, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d3fc61768229a2cb126ae7c28450b44d?s=128&d=identicon&r=PG", "display_name": "cmannett85", "link": "https://stackoverflow.com/users/498437/cmannett85"}, "edited": false, "score": 0, "creation_date": 1432187272, "post_id": 30360463, "comment_id": 48821985, "body": "Have you set the focus policy on the widget?"}, {"owner": {"reputation": 8160, "user_id": 1035613, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b4d6ce44848765d7b02e4309c9efe9bb?s=128&d=identicon&r=PG", "display_name": "Dmitry Sazonov", "link": "https://stackoverflow.com/users/1035613/dmitry-sazonov"}, "edited": false, "score": 0, "creation_date": 1432188556, "post_id": 30360463, "comment_id": 48822531, "body": "Worked fine for me. (Not in Maya)"}], "answers": [{"tags": [], "owner": {"reputation": 7482, "user_id": 313175, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/17983e85ea926e9e985c00d1a771f24a?s=128&d=identicon&r=PG", "display_name": "Alexander V", "link": "https://stackoverflow.com/users/313175/alexander-v"}, "is_accepted": false, "score": 1, "last_activity_date": 1432159735, "creation_date": 1432159735, "answer_id": 30361237, "question_id": 30360463, "link": "https://stackoverflow.com/questions/30360463/focusinevent-not-called-in-qlineedit-subclass/30361237#30361237", "title": "focusInEvent not called in QLineEdit subclass", "body": "<p>Try the below. For several occasions that worked for me when focusInEvent did not.</p>\n\n<pre><code>void YourWidget::changeEvent(QEvent* event)\n{\n    if (event-&gt;type() == QEvent::ActivationChange)\n    {\n        if (isActiveWindow())\n        {\n             // gaining the focus\n        }\n        else\n        {\n             // loosing the focus\n        }\n    }\n\n    // or whatever *parent* class call is\n    QWidget::changeEvent(event);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 614, "user_id": 4876536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36757ceb0bbec00338926fc2ab6cda58?s=128&d=identicon&r=PG&f=1", "display_name": "fassl", "link": "https://stackoverflow.com/users/4876536/fassl"}, "is_accepted": false, "score": 0, "last_activity_date": 1432217628, "last_edit_date": 1432217628, "creation_date": 1432217160, "answer_id": 30376159, "question_id": 30360463, "link": "https://stackoverflow.com/questions/30360463/focusinevent-not-called-in-qlineedit-subclass/30376159#30376159", "title": "focusInEvent not called in QLineEdit subclass", "body": "<p>The event gets intercepted by the editor widget. See <code>QItemDelegate::createEditor</code>. The widget returned there will get it.</p>\n"}, {"tags": [], "owner": {"reputation": 3363, "user_id": 786238, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2ad644dfd29b5e1705af19c770ff65d5?s=128&d=identicon&r=PG", "display_name": "Laurent Crivello", "link": "https://stackoverflow.com/users/786238/laurent-crivello"}, "is_accepted": true, "score": 0, "last_activity_date": 1432400181, "creation_date": 1432400181, "answer_id": 30415302, "question_id": 30360463, "link": "https://stackoverflow.com/questions/30360463/focusinevent-not-called-in-qlineedit-subclass/30415302#30415302", "title": "focusInEvent not called in QLineEdit subclass", "body": "<p>The issue was linked to the fact that the QLineEdit was in a QGraphicsView that was in another QGraphicsView. Bringing the QLineEdit to the higher-level QGraphicsView made it work.</p>\n"}], "owner": {"reputation": 3363, "user_id": 786238, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2ad644dfd29b5e1705af19c770ff65d5?s=128&d=identicon&r=PG", "display_name": "Laurent Crivello", "link": "https://stackoverflow.com/users/786238/laurent-crivello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 516, "favorite_count": 0, "accepted_answer_id": 30415302, "answer_count": 3, "score": 0, "last_activity_date": 1432400181, "creation_date": 1432156404, "last_edit_date": 1432217664, "question_id": 30360463, "link": "https://stackoverflow.com/questions/30360463/focusinevent-not-called-in-qlineedit-subclass", "title": "focusInEvent not called in QLineEdit subclass", "body": "<p>I have a Qt/cpp code and display a subclassed <code>QLineEdit</code>. When double-clicking the <code>QLineEdit</code>, the <code>focusInEvent</code> is never called (launched in Maya).</p>\n\n<pre><code>void myQLineEditClass::focusInEvent(QFocusEvent *e)\n{\n    MGlobal::displayInfo(MQtUtil::toMString(QString().sprintf(\"HERE\")));\n    QLineEdit::focusInEvent(e);\n}\n</code></pre>\n\n<p>HERE is never displayed, event if the <code>focusInEvent</code> is present in the .h protect part. Any idea how to get focusInEvents ?</p>\n"}, {"tags": ["c++", "vector", "copy-constructor", "dynamic-memory-allocation", "assertions"], "comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 2, "creation_date": 1432156424, "post_id": 30360437, "comment_id": 48812692, "body": "Read up on the <a href=\"http://en.wikipedia.org/wiki/Rule_of_three_(C%2B%2B_programming)\" rel=\"nofollow noreferrer\">rule of 3, rule of 5, and rule of 0</a>."}, {"owner": {"reputation": 69, "user_id": 4876706, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24f9c4f4da431a89d1b1ddd5ee36fd3f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Macvey", "link": "https://stackoverflow.com/users/4876706/joshua-macvey"}, "reply_to_user": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1432157247, "post_id": 30360437, "comment_id": 48813105, "body": "Thanks for pointing me in that direction!  The copy assignment operator is news to me and I can see it solving a lot of problems for me in the near future."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 4876706, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24f9c4f4da431a89d1b1ddd5ee36fd3f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Macvey", "link": "https://stackoverflow.com/users/4876706/joshua-macvey"}, "edited": false, "score": 0, "creation_date": 1432157174, "post_id": 30360575, "comment_id": 48813072, "body": "This makes perfect sense.  I can see that you&#39;ve dereferenced my original pointer and created a new object on the heap.  Via memory management, I can trust that two separate destructors will then also exist so that both the copy and the original are deleted once life ends?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 69, "user_id": 4876706, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24f9c4f4da431a89d1b1ddd5ee36fd3f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Macvey", "link": "https://stackoverflow.com/users/4876706/joshua-macvey"}, "edited": false, "score": 0, "creation_date": 1432157572, "post_id": 30360575, "comment_id": 48813261, "body": "@JoshuaMacvey, the last sentence can be phrased better but I think you understand the solution, and the answer is &quot;yes&quot;."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 0, "last_activity_date": 1432156780, "creation_date": 1432156780, "answer_id": 30360575, "question_id": 30360437, "link": "https://stackoverflow.com/questions/30360437/assertion-error-when-passing-object-by-value-it-is-my-copy-constructor/30360575#30360575", "title": "Assertion error when passing object by value -- it is my copy constructor?", "body": "<p>Use of </p>\n\n<pre><code>    squares.push_back(myMaze.squares[loopVar]);\n</code></pre>\n\n<p>in the copy constructor will lead to problems downstream.That will be vaild had the contents of <code>squares</code> been objects not pointers.</p>\n\n<p>There are now two objects holding on to the pointers. Both willl try to call <code>delete</code> on the same pointer, which easily leads to undefined behavior.</p>\n\n<p>You can fix the problem by:</p>\n\n<ol>\n<li>Using a <code>vector</code> objects instead of a <code>vector</code> of pointers, or  </li>\n<li><p>Creating new objects from the heap and adding them to the new object.</p>\n\n<pre><code>squares.push_back(new SquareData(*myMaze.squares[loopVar]));\n</code></pre></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 4876706, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24f9c4f4da431a89d1b1ddd5ee36fd3f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Macvey", "link": "https://stackoverflow.com/users/4876706/joshua-macvey"}, "edited": false, "score": 0, "creation_date": 1432157776, "post_id": 30360593, "comment_id": 48813345, "body": "Good point about the polymorphic qualities:  there really aren&#39;t any I can foresee using via the Maze class.  For my own knowledge, though, say I use a shared pointer.  If all the references are pointing to the same memory allocated on the heap, would I get an error after the life of the original ends and the copy attempts to deallocate that same memory?  Either way, I suppose some shared pointer studying is in order!  Thanks!"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "reply_to_user": {"reputation": 69, "user_id": 4876706, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24f9c4f4da431a89d1b1ddd5ee36fd3f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Macvey", "link": "https://stackoverflow.com/users/4876706/joshua-macvey"}, "edited": false, "score": 0, "creation_date": 1432160187, "post_id": 30360593, "comment_id": 48814252, "body": "@JoshuaMacvey: Shared pointer basically does ref counting on the pointer. Once the ref count reaches zero then the object is deleted. Thus it is safe to use from any number of other objects."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "reply_to_user": {"reputation": 69, "user_id": 4876706, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24f9c4f4da431a89d1b1ddd5ee36fd3f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Macvey", "link": "https://stackoverflow.com/users/4876706/joshua-macvey"}, "edited": false, "score": 0, "creation_date": 1432160253, "post_id": 30360593, "comment_id": 48814275, "body": "@JoshuaMacvey: But <code>SquareData</code> is not polymorphic why pay the cost of dynamic memory allocation. Just use a normal object in the vector. That is what you normally see in C++"}], "tags": [], "owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "is_accepted": false, "score": 1, "last_activity_date": 1432156839, "creation_date": 1432156839, "answer_id": 30360593, "question_id": 30360437, "link": "https://stackoverflow.com/questions/30360437/assertion-error-when-passing-object-by-value-it-is-my-copy-constructor/30360593#30360593", "title": "Assertion error when passing object by value -- it is my copy constructor?", "body": "<p>This is your problem.</p>\n\n<pre><code>    squares.push_back(myMaze.squares[loopVar]);\n</code></pre>\n\n<p>Basically each Maze has a vector full of the same pointers. When one copy of the maze goes out of scope it will delete all the pointers. Thus the other Maze now has a set of invalid pointers.</p>\n\n<p>Couple of solutions.</p>\n\n<ol>\n<li>Don't use pointers.</li>\n</ol>\n\n<p>Unless you <code>SquareData</code> is polymorphic there seems no reason to keep pointers.</p>\n\n<pre><code> std::vector&lt;SquareData&gt; squares;\n</code></pre>\n\n<ol start=\"2\">\n<li>If you want each copy of the maze to refer to the same squares.</li>\n</ol>\n\n<p>Then use a shared pointer. This will keep a count of the number of references to each <code>SquareData</code> and thus only delete them when they truly go out of scope.</p>\n\n<pre><code> std::vector&lt;std::shared_ptr&lt;SquareData&gt;&gt; squares;\n</code></pre>\n\n<ol start=\"3\">\n<li>Least attractive (and probably not needed).</li>\n</ol>\n\n<p>Change the code to actually copy the pointer content into a new object.</p>\n\n<pre><code>squares.push_back(new SquareData(myMaze.squares[loopVar]));\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 4876706, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24f9c4f4da431a89d1b1ddd5ee36fd3f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Macvey", "link": "https://stackoverflow.com/users/4876706/joshua-macvey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 30360575, "answer_count": 2, "score": 0, "last_activity_date": 1432156839, "creation_date": 1432156301, "question_id": 30360437, "link": "https://stackoverflow.com/questions/30360437/assertion-error-when-passing-object-by-value-it-is-my-copy-constructor", "title": "Assertion error when passing object by value -- it is my copy constructor?", "body": "<p>everyone!</p>\n\n<p>I just finished writing a 2-D maze (Class is an ADT titled \"Maze\"--how original) that uses dynamic memory allocation. I'm passing the Maze to a method of another class I've entitled \"MazeSolver,\" which uses recursion and backtracking to solve the maze. Good news is my code compiles wonderfully when I pass the object by reference.  News that I don't know if is good or bad is that I get an assertion error if I try to pass the Maze to MazeSolver by value. </p>\n\n<p>Given that the error occurs only when I pass by value, I can only assume it has something to do with my copy constructor.  Before going any further, here's some info on the code:  </p>\n\n<p>Maze is composed of squares.  Each square is represented by a struct called SquareData.</p>\n\n<pre><code>      struct SquareData \n    {\n        //data fields for the struct (NO POINTERS)\n    }\n</code></pre>\n\n<p>I've decided to represent the entire maze with a vector of SquareData pointers (this vector is in private section of the class \"Maze\").</p>\n\n<pre><code>vector&lt;SquareData*&gt; squares;\n</code></pre>\n\n<p>Implementation of my destructor looks like this (that last call referencing a Player class is just eliminating a dangling pointer I have declared as a static variable for that class, which I have pointing at the maze. I don't think it's important considering the question, but I am new to C++ after all and one of you may think it might be, so I've included it for \"hmmms\"):</p>\n\n<pre><code>// clears maze of its contents\nvoid Maze::clear() {\n    int totalSquares = squares.size();\n    for (int loopVar = 0; loopVar &lt; totalSquares; loopVar++)\n    {\n        delete squares[loopVar]; // deallocate memory by deleting the square structure\n        squares[loopVar] = nullptr; // eliminate dangling pointer\n    } // vector takes care of itself\n} // end clear\n\nMaze::~Maze(){\n    //clear the maze of contents (vector is full of pointers whose memory is on the heap)\n    clear();\n    //vector safe to deallocate itself now\n    Player::setMaze(nullptr); // remove the pointer from player\n}\n</code></pre>\n\n<p>I've declared the copy constructor in header as follows: </p>\n\n<pre><code>/** Copy Constructor */\n    Maze(const Maze&amp; myMaze);\n</code></pre>\n\n<p>with attempted implementation:</p>\n\n<pre><code>/** copy constructor */\nMaze::Maze(const Maze&amp; myMaze){\n    /** Initialize Constants */\n    mazeLength = myMaze.mazeLength;\n    mazeWidth = myMaze.mazeWidth;\n    exitRow = myMaze.exitRow;\n    exitCol = myMaze.exitCol;\n    entRow = myMaze.entRow;\n    entCol = myMaze.entCol;\n    /** copy the vector of pointers*/\n    for (int loopVar = 0; loopVar &lt; myMaze.squares.size(); loopVar++)\n    {\n        squares.push_back(myMaze.squares[loopVar]);\n    }\n} // end copy constructor\n</code></pre>\n\n<p>Here's how I attempted to understand what the problem was doing:</p>\n\n<p>I wrote this vector display function in for my Maze class.</p>\n\n<pre><code>void Maze::vectorDisplay() const {\n    for (int loopVar = 0; loopVar &lt; squares.size(); loopVar++)\n    {\n        cout &lt;&lt; \"Vector Index: \" &lt;&lt; loopVar &lt;&lt; endl;\n        cout &lt;&lt; \"Pointer: \" &lt;&lt; squares[loopVar] &lt;&lt; endl;\n        cout &lt;&lt; \"Row: \" &lt;&lt; squares[loopVar]-&gt;Row &lt;&lt; endl;\n        cout &lt;&lt; \"Col: \" &lt;&lt; squares[loopVar]-&gt;Col &lt;&lt; endl;\n        cout &lt;&lt; \"State: \" &lt;&lt; squares[loopVar]-&gt;State &lt;&lt; endl;\n    }\n} //end vectorDisplay\n</code></pre>\n\n<p>And found that the vector displays correctly when doing the following in the driver:</p>\n\n<pre><code>    Maze myMazeObject(// parameters);\n    myMazeObject.vectorDisplay();\n</code></pre>\n\n<p>and will produce output with no complaints.</p>\n\n<p>But now if I try to use code like this when passing by value:</p>\n\n<pre><code>Maze myMazeObject(// parameters);\nMazeSolver myMazeSolver;\nmyMazeSolver.someMazeSolverMethod(myMazeObject); \n</code></pre>\n\n<p>where someMazeSolverMethod has the line <code>myMazeObject.vectorDisplay();</code>I get an assertion error just as the final element in the vector is being printed.  </p>\n\n<p>I want to say this is my fault and my copy constructor is a p.o.s.  If any insight, please let me know how to fix it and what I can do in the future!</p>\n\n<p>Thanks for taking the time to read and even more so to answer should you choose to!</p>\n\n<p>-J</p>\n"}, {"tags": ["c++", "process", "ms-word", "ole", "pid"], "comments": [{"owner": {"reputation": 12800, "user_id": 214796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d05177bba9d853a9c546c4a965085e99?s=128&d=identicon&r=PG", "display_name": "Collin Dauphinee", "link": "https://stackoverflow.com/users/214796/collin-dauphinee"}, "edited": false, "score": 0, "creation_date": 1432168370, "post_id": 30360388, "comment_id": 48816605, "body": "This is because the Office Automation is an out-of-process COM object. It likely has no awareness of your process."}, {"owner": {"reputation": 2060, "user_id": 1231882, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nkdVI.jpg?s=128&g=1", "display_name": "Neil Weicher", "link": "https://stackoverflow.com/users/1231882/neil-weicher"}, "reply_to_user": {"reputation": 12800, "user_id": 214796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d05177bba9d853a9c546c4a965085e99?s=128&d=identicon&r=PG", "display_name": "Collin Dauphinee", "link": "https://stackoverflow.com/users/214796/collin-dauphinee"}, "edited": false, "score": 0, "creation_date": 1432207744, "post_id": 30360388, "comment_id": 48834710, "body": "Right. But the invoking PID must be available somewhere?"}], "owner": {"reputation": 2060, "user_id": 1231882, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nkdVI.jpg?s=128&g=1", "display_name": "Neil Weicher", "link": "https://stackoverflow.com/users/1231882/neil-weicher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1432156118, "creation_date": 1432156118, "question_id": 30360388, "link": "https://stackoverflow.com/questions/30360388/determine-parent-processid-in-word-when-launched-via-office-automation", "title": "Determine parent ProcessID in Word when launched via Office Automation", "body": "<p>This is a bit arcane, so I hope I am being clear. </p>\n\n<p>I have a custom, unmanaged DLL: MYDLL.DLL, that is invoked by Word via a VBA script using Declare Function.</p>\n\n<p>The DLL uses CreateToolhelp32Snapshot to get the Parent ProcessID. I.e., the process that invoked Winword.exe.</p>\n\n<p>It works fine in most situations. For example, </p>\n\n<ul>\n<li><p>If I double-click on the DOCX file, it shows the parent PID as Explorer.exe.</p></li>\n<li><p>If I \"Start\" the document from a CMD window, it shows the parent PID as CMD.EXE.</p></li>\n<li><p>If I launch Winword.exe from my application, MYAPP.EXE, using ShellExecute, it shows the Parent PID as MYAPP.EXE.</p></li>\n</ul>\n\n<p>So far, so good.</p>\n\n<p>However, if MYAPP.EXE opens the DOCX file via OLE / Office Automation, it shows the Parent PID as SVCHOST.EXE.  MYAPP.EXE is nowhere in the ancestor chain as far as I can see.</p>\n\n<p>Is there any way I can tell what the invoking PID is when launched via OLE / Office Automation?</p>\n"}, {"tags": ["c++", "stl", "valgrind"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 4, "creation_date": 1432156173, "post_id": 30360380, "comment_id": 48812563, "body": "Please show a complete example."}], "answers": [{"tags": [], "owner": {"reputation": 1299, "user_id": 1733239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59e2e0ce638ca008172efc846ebd17e0?s=128&d=identicon&r=PG", "display_name": "Soheil Hassas Yeganeh", "link": "https://stackoverflow.com/users/1733239/soheil-hassas-yeganeh"}, "is_accepted": true, "score": 2, "last_activity_date": 1432158291, "creation_date": 1432158291, "answer_id": 30360933, "question_id": 30360380, "link": "https://stackoverflow.com/questions/30360380/does-the-stl-generate-valgrind-errors-for-a-stdvector-of-stdvector-if-my-pro/30360933#30360933", "title": "Does the STL generate valgrind errors for a std::vector of std::vector if my program is fine?", "body": "<p>This is because <code>std::vector::reserve(n)</code> allocates the memory required to hold at least <code>n</code> elements, but it does not construct the actual elements. \nAs such, the allocated memory is just garbage, and you need to <code>emplace</code>/<code>insert</code> items onto the vector to actually construct the inner vectors.</p>\n\n<p>If you know the <code>firstDim</code> and you want to default-construct the inner vectors, use <code>std::vecotor</code>'s sized constructor:</p>\n\n<pre><code>vector&lt;vector&lt;int&gt;&gt; vec(firstDim);\n</code></pre>\n\n<p>or use <code>std::vector::resize</code> (which actually constructs the inner vectors you need):</p>\n\n<pre><code>vector&lt;vector&lt;int&gt;&gt; vec;\nvec.resize(firstDim);\n</code></pre>\n\n<p>Note that the first method is the preferred way of doing that.</p>\n"}], "owner": {"reputation": 6564, "user_id": 2109064, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/05bfc90904db2f3abb20860d6e56e562?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2109064/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 904, "favorite_count": 0, "accepted_answer_id": 30360933, "answer_count": 1, "score": -1, "last_activity_date": 1432158291, "creation_date": 1432156090, "question_id": 30360380, "link": "https://stackoverflow.com/questions/30360380/does-the-stl-generate-valgrind-errors-for-a-stdvector-of-stdvector-if-my-pro", "title": "Does the STL generate valgrind errors for a std::vector of std::vector if my program is fine?", "body": "<p>I use a vector of vectors in my program:</p>\n\n<pre><code>vector&lt;vector&lt;int&gt;&gt; vec;\n</code></pre>\n\n<p>The constructor does:</p>\n\n<pre><code>vec.reserve(firstDimension);\n</code></pre>\n\n<p>Now I checked my program with valgrind. Valgrind complains about a lot of: </p>\n\n<blockquote>\n  <p>Conditional jump or move depends on uninitialised value(s)</p>\n</blockquote>\n\n<p>It seems that they are related to <code>vector::reserve</code>. This functions seems to allocate uninitialized heap memory, which makes sense. Actually, they disapear when I replace the <code>vec.reserve(firstDimension)</code> with:</p>\n\n<pre><code>for(int i = 0; i &lt; firstDim; i ++){\n  vec.emplace(); // just constructs a sub-vector for the second dimension\n}\n</code></pre>\n\n<p>Nevertheless, I'm a bit confused now: I would expect that the STL would not generate such errors. So I wonder whether there ARE actually situations where the STL generates valgrind errors or whether this indicates a problem in my program?</p>\n"}, {"tags": ["c++", "c", "integer", "overflow"], "comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 3, "creation_date": 1432155963, "post_id": 30360335, "comment_id": 48812461, "body": "Upvoting for I think it&#39;s good that people seek explanations of things."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1432156002, "post_id": 30360335, "comment_id": 48812480, "body": "Most architectures use a single bit for the <i>sign</i>, and fill up with <code>1</code>&#39;s."}, {"owner": {"reputation": 1746, "user_id": 2636457, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29162c5b215ddb5b900c713c5eb2be9c?s=128&d=identicon&r=PG", "display_name": "Levi", "link": "https://stackoverflow.com/users/2636457/levi"}, "edited": false, "score": 1, "creation_date": 1432156107, "post_id": 30360335, "comment_id": 48812533, "body": "Have a look <a href=\"http://stackoverflow.com/questions/12335784/c-integer-overflow?rq=1\">here</a>"}, {"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 1, "creation_date": 1432156159, "post_id": 30360335, "comment_id": 48812557, "body": "MCQ? There&#39;s far too many TLAs these days..."}, {"owner": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "edited": false, "score": 0, "creation_date": 1432156207, "post_id": 30360335, "comment_id": 48812583, "body": "MCQ=&gt; Multiple Choice Q"}, {"owner": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "edited": false, "score": 0, "creation_date": 1432156288, "post_id": 30360335, "comment_id": 48812630, "body": "So 11^5 is 14? Not with my integer :p First specify the size, signed/unsigned etc.etc."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1432157574, "post_id": 30360335, "comment_id": 48813262, "body": "<code>11 ^ 5 --&gt; 14</code> (decimal) --&gt; <code>1011 xor 0101 --&gt; 1110</code> (binary).  No overflow involved."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "edited": false, "score": 0, "creation_date": 1432156538, "post_id": 30360471, "comment_id": 48812744, "body": "Appreciate your concern sir, But I run the program on c++ compiler it showed up being (b) 14."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "reply_to_user": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "edited": false, "score": 2, "creation_date": 1432156624, "post_id": 30360471, "comment_id": 48812789, "body": "@Moshin: Aha. You used the expression <code>11^5</code> in C++ source code. That does not calculate a power and wrap around. It is a bitlevel XOR operation."}, {"owner": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "edited": false, "score": 0, "creation_date": 1432156707, "post_id": 30360471, "comment_id": 48812846, "body": "Sir I need to understand that, Kindly if you could impart the knowledge."}, {"owner": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "reply_to_user": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "edited": false, "score": 1, "creation_date": 1432156715, "post_id": 30360471, "comment_id": 48812852, "body": "@MohsinAli Just as side note, the result 14 (with the correct operations) isn&#180;t possible at all, independent from the int size."}, {"owner": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "reply_to_user": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "edited": false, "score": 0, "creation_date": 1432156776, "post_id": 30360471, "comment_id": 48812876, "body": "@deviantfan how would it be possible sir?"}, {"owner": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "reply_to_user": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "edited": false, "score": 0, "creation_date": 1432156786, "post_id": 30360471, "comment_id": 48812881, "body": "@MohsinAli <code>Sir I need to understand that, Kindly if you could impart the knowledge.</code> He said that <code>11^5</code> in C++ code doesn&#180;t mean <code>11*11*11*11*11</code>. C++ is not maths. If you want 11^5 of maths, don&#180;t use <code>^</code> of C++"}, {"owner": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "reply_to_user": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "edited": false, "score": 0, "creation_date": 1432156871, "post_id": 30360471, "comment_id": 48812917, "body": "@MohsinAli <code>how would it be possible sir?</code> It is <i>not</i> possible. <code>11^5 % 2^x = 14</code> is not solvable with natural numbers x."}, {"owner": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "reply_to_user": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "edited": false, "score": 0, "creation_date": 1432156881, "post_id": 30360471, "comment_id": 48812924, "body": "@deviantfan I&#39;m not doing math here sir. I&#39;m trying to get the ways of c++."}, {"owner": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "edited": false, "score": 0, "creation_date": 1432157092, "post_id": 30360471, "comment_id": 48813040, "body": "@AlanStokes I&#180;m assuming that OP means exponentiation."}, {"owner": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "edited": false, "score": 0, "creation_date": 1432157281, "post_id": 30360471, "comment_id": 48813117, "body": "If the result goes out of the range of integer then is there any kind of truncating happens?"}, {"owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "reply_to_user": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "edited": false, "score": 0, "creation_date": 1432157313, "post_id": 30360471, "comment_id": 48813130, "body": "@deviantfan It&#39;s not merely possible, it&#39;s required. <code>^</code> in C++ denotes bitwise xor. This is clearer in binary. 1011 ^ 0101 = 1110. In  decimal, 11^5 = 14."}, {"owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "reply_to_user": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "edited": false, "score": 0, "creation_date": 1432157354, "post_id": 30360471, "comment_id": 48813157, "body": "@deviantfan Why? Question is tagged C++."}, {"owner": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "reply_to_user": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 0, "creation_date": 1432157440, "post_id": 30360471, "comment_id": 48813202, "body": "@AlanStokes Well, why... good question. Maybe because he&#180;s mentioning overflows. Mohsin Ali: Please clarify."}, {"owner": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "edited": false, "score": 0, "creation_date": 1432157499, "post_id": 30360471, "comment_id": 48813234, "body": "Right sir. I&#39;m dealing with overflowing problem. How does that go in c++?"}], "tags": [], "owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "is_accepted": false, "score": 1, "last_activity_date": 1432156816, "last_edit_date": 1432156816, "creation_date": 1432156425, "answer_id": 30360471, "question_id": 30360335, "link": "https://stackoverflow.com/questions/30360335/integer-overflow-concept/30360471#30360471", "title": "Integer overflow concept", "body": "<p>Since you're asking about wrap-around I'm answering that below. But as is clear from comments, you really tried the C++ expression <code>11^5</code>, a bitlevel XOR, and got the answer 14, which has nothing to do with wraparound. The XOR result of each pair of bits is 0 if they're the same value, and 1 if they're different.</p>\n\n<hr>\n\n<p>Now, in the following ^ denotes exponentiation; it's a common notation for that.</p>\n\n<p>11^5 = 161051.</p>\n\n<p>Now consider a situation where 16 bits are used to represent integers, and there's only magnitude, no sign. I.e. a 16-bit unsigned C++ integer type. Then there are 2^16 possible bit patterns, and they are numbered 0 through 2^16 - 1, and represent those numbers.</p>\n\n<p>161051 is larger than the largest possible value of that 16-bit type. If it were 2^16 exactly it would correspond to 0 (called <strong>wrap-around</strong>), if it were 2^16 + 1 it would correspond to 1, and so on. So it corresponds to 161051 - 2^16.</p>\n\n<p>Now if that in turn also was greater than 2^16 - 1 you would repeat the process.</p>\n\n<p>And this produces the remainder of integer division by 2^16.</p>\n\n<p>Essentially it correspond to just <em>removing</em> all the bits except the 16 least significant ones.</p>\n\n<p>By the way the result for this example is not any of your choices (a), (b), (c) or (d).</p>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "edited": false, "score": 0, "creation_date": 1432157657, "post_id": 30360782, "comment_id": 48813295, "body": "Yes here goes the answer. Thanks Sir you got my problem solved."}, {"owner": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "reply_to_user": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "edited": false, "score": 3, "creation_date": 1432157685, "post_id": 30360782, "comment_id": 48813307, "body": "@MohsinAli And how this is an overflow problem like you insisted several times?"}, {"owner": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "edited": false, "score": 0, "creation_date": 1432157754, "post_id": 30360782, "comment_id": 48813330, "body": "look sir I&#39;m new to all these, I thought if it nothing else then it would be overflow problem."}, {"owner": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "edited": false, "score": 0, "creation_date": 1432157807, "post_id": 30360782, "comment_id": 48813357, "body": "However Thanks To your effort sir."}, {"owner": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "reply_to_user": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 0, "creation_date": 1432157962, "post_id": 30360782, "comment_id": 48813418, "body": "@Alan Stokes Ok sir. What would we be calling it then?"}, {"owner": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "reply_to_user": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "edited": false, "score": 1, "creation_date": 1432158937, "post_id": 30360782, "comment_id": 48813817, "body": "@MohsinAli It&#180;s a XOR ([bitwise] <i>exclusive &quot;or&quot;</i>), a kind of bitwise operation. Essentially a calculation like plus and minus, just different from plus and minus."}, {"owner": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "reply_to_user": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "edited": false, "score": 1, "creation_date": 1432159069, "post_id": 30360782, "comment_id": 48813873, "body": "@deviantfan I really confused you sir, and I apologize for that."}], "tags": [], "owner": {"reputation": 5554, "user_id": 2352507, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZncEA.jpg?s=128&g=1", "display_name": "Sunsetquest", "link": "https://stackoverflow.com/users/2352507/sunsetquest"}, "is_accepted": false, "score": 5, "last_activity_date": 1432157729, "last_edit_date": 1432157729, "creation_date": 1432157564, "answer_id": 30360782, "question_id": 30360335, "link": "https://stackoverflow.com/questions/30360335/integer-overflow-concept/30360782#30360782", "title": "Integer overflow concept", "body": "<pre><code>   DecVal   BinVal\n    11   -&gt; 1011\nXOR 5    -&gt; 0101\n           -------\n    14   -&gt; 1110\n</code></pre>\n\n<p>fyi, This does not really have anything to do with int overflow.</p>\n"}], "owner": {"reputation": 125, "user_id": 4363405, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/040b0d2a55c10bd92d190f3508960ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsin Ali", "link": "https://stackoverflow.com/users/4363405/mohsin-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1432157729, "creation_date": 1432155874, "last_edit_date": 1432156722, "question_id": 30360335, "link": "https://stackoverflow.com/questions/30360335/integer-overflow-concept", "title": "Integer overflow concept", "body": "<p>How int overflow works. I mean to ask what would be the final result of an integer value if an overflow happens? I need to understand it on paper. Like I'm given a multiple choice question:</p>\n\n<blockquote>\n  <p>11^5 Produces:<br>\n  a. 12<br>\n  b. 14 <br>\n  c. 15 <br>\n  d. 17.<br></p>\n</blockquote>\n\n<p>I know the answer is <code>(b)14</code>, but want to know why?</p>\n"}, {"tags": ["c++", "multithreading", "stdthread"], "comments": [{"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 2, "creation_date": 1432156040, "post_id": 30360323, "comment_id": 48812501, "body": "I&#39;m confused what your problem is.  Couldn&#39;t you simply have each thread grab files from a list until that list eventually becomes empty which the threads realize and shut down?  Can you show (simplified) code how you would solve this in Java?  It should translate to C++11 quite straight-forwardly.  Btw, what is this lock good for?"}, {"owner": {"reputation": 1838, "user_id": 4525052, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0780adfbbb6b445dac0c9e12d3c73f50?s=128&d=identicon&r=PG&f=1", "display_name": "RyanP", "link": "https://stackoverflow.com/users/4525052/ryanp"}, "edited": false, "score": 2, "creation_date": 1432156148, "post_id": 30360323, "comment_id": 48812550, "body": "When you say &quot;send new file&quot;... where are you sending the file to, and where is it coming from?   For instance, if you are sending all of these files over the network and you can get them from memory, you are most likely capped by the speed of the network, so sending multiple files at once won&#39;t speed up your total throughput.   Also, if you are getting the files from the same HDD, reading them all at once could cause HDD thrashing on non-SSDs, and will greatly reduce how quickly you can read them. So your best bet is to read one contiguous file at a time.   Multi-threaded isn&#39;t always faster."}, {"owner": {"reputation": 9423, "user_id": 2809564, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9dbbaaa9c03d7a256eef869bf1d635e3?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/2809564/john"}, "edited": false, "score": 1, "creation_date": 1432156367, "post_id": 30360323, "comment_id": 48812667, "body": "We have SSD&#39;s running with all raid0 no mirroring. I wanted to try out this to see whether it improves anything or not."}], "answers": [{"tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": false, "score": 1, "last_activity_date": 1432160282, "last_edit_date": 1592644375, "creation_date": 1432160282, "answer_id": 30361335, "question_id": 30360323, "link": "https://stackoverflow.com/questions/30360323/how-to-launch-multiple-threads-and-each-thread-working-on-different-files/30361335#30361335", "title": "How to launch multiple threads and each thread working on different files?", "body": "<h1>A first approach</h1>\n<p>There's a first simple solution:</p>\n<ul>\n<li>your class contains a vector of files to be processed</li>\n<li>only one thread manages this vector through the function <code>execute_file()</code></li>\n<li>this function creates as many threads as needed, each processing one file</li>\n<li>at the end, all the threads are joined (mandatory)</li>\n</ul>\n<p>The code would look like that:</p>\n<pre><code>struct send_new_file_command {\n    vector&lt;string&gt; files_need_to_send;\npublic:\n    send_new_file_command(vector&lt;string&gt; f) : files_need_to_send(f) {}\n    void execute_file();\n};\nvoid send_new_file_command::execute_file()\n{\n    vector&lt;thread&gt; exec;\n    for(auto it = files_need_to_send.begin(); it != files_need_to_send.end(); ++it)\n    {\n        exec.push_back(thread(send_new_file, *it));\n    }\n    for(auto &amp;e : exec)\n        e.join();\n}\n</code></pre>\n<p>The code could be tested with the following:</p>\n<pre><code>void send_new_file(string x) { // simulator \n    for(int i = 0; i&lt;10; i++) {\n        cout &lt;&lt; x &lt;&lt; endl;\n        this_thread::sleep_for(chrono::milliseconds(500));\n    }\n}\nint main() {\n    vector&lt;string&gt;vs{&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;};\n    send_new_file_command sfc(vs);\n    sfc.execute_file();\n    return 0;\n}\n</code></pre>\n<p>This solution is very simple.  It has two major drawbacks:</p>\n<ul>\n<li>it may launch much more threads than your hardware can manage.  So that only a handful of them truly run concurrently.</li>\n<li>on thread is dedicated to a file.  FIf it's a short file and the thread is free again, it will not be reused.</li>\n</ul>\n<h1>Other solutions</h1>\n<p>There are plenty of other solutions. For example:</p>\n<ul>\n<li><p>A variant of this one, would to launch a fixed number of threads, each looking in the vector of files to be processed for the next item, as soon as it's ready.  You'd then need to introduce strong locking.</p>\n</li>\n<li><p>Instead of using raw threads, you could consider futures, launching <code>std::async(std::launch::async, send_new_file, *it);</code></p>\n</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 2218, "user_id": 417577, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b97505f62bef03bb36e83c7f985465de?s=128&d=identicon&r=PG", "display_name": "Zotta", "link": "https://stackoverflow.com/users/417577/zotta"}, "is_accepted": false, "score": 1, "last_activity_date": 1432161361, "last_edit_date": 1432161361, "creation_date": 1432160801, "answer_id": 30361437, "question_id": 30360323, "link": "https://stackoverflow.com/questions/30360323/how-to-launch-multiple-threads-and-each-thread-working-on-different-files/30361437#30361437", "title": "How to launch multiple threads and each thread working on different files?", "body": "<p>Performance-wise the best way to do it:</p>\n\n<ol>\n<li>declare a counter variable using <code>std::atomic&lt;int&gt;</code></li>\n<li>create the threads in a vector, array, whatever</li>\n<li>call join for every thread</li>\n</ol>\n\n<p>The main function of the thread then accesses and increments the shared counter and saves the result in a local variable in a loop:</p>\n\n<pre><code>std::atomic&lt;int&gt; counter = 0;\nfor(int j = 0;j&lt;4;j++)\n{\n    threads.push_back(std::thread([&amp;](){\n        for(int i; (i = counter++) &lt; size;)//the counter variable must be atomic!\n        {\n            do_work(i);\n        }\n    }));\n}\n\nfor(int j = 0;j&lt;4;j++)\n    threads[i].join();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6940, "user_id": 1559401, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/t9DjW.jpg?s=128&g=1", "display_name": "rbaleksandar", "link": "https://stackoverflow.com/users/1559401/rbaleksandar"}, "edited": false, "score": 0, "creation_date": 1611911101, "post_id": 30361663, "comment_id": 116607022, "body": "I avoid using <code>const</code> for <code>nthreads</code>. You should check if the return value is 0 (it is possible) and assign a value of 1 or something similar. Otherwise in a case of 0 your program will not really do much."}], "tags": [], "owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "is_accepted": true, "score": 1, "last_activity_date": 1432197957, "last_edit_date": 1432197957, "creation_date": 1432162009, "answer_id": 30361663, "question_id": 30360323, "link": "https://stackoverflow.com/questions/30360323/how-to-launch-multiple-threads-and-each-thread-working-on-different-files/30361663#30361663", "title": "How to launch multiple threads and each thread working on different files?", "body": "<p>This is a fairly simple approach using a work queue.  You can concatenate the code snippets into a self-contained program.  We will use the following standard library headers.</p>\n\n<pre><code>#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include &lt;mutex&gt;\n#include &lt;string&gt;\n#include &lt;thread&gt;\n#include &lt;vector&gt;\n</code></pre>\n\n<p>First, we define a function that takes a single file name and sends it wherever it should go to.  I'll simulate this by simply writing it to <code>/dev/null</code>.</p>\n\n<pre><code>void\nsend_file(const std::string&amp; filename)\n{\n  std::ifstream istr {};\n  std::ofstream ostr {};\n  std::string line {};\n  istr.exceptions(std::ifstream::badbit);\n  ostr.exceptions(std::ofstream::badbit);\n  istr.open(filename);\n  ostr.open(\"/dev/null\");\n  while (std::getline(istr, line))\n    ostr &lt;&lt; line &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>Next, we define a function that takes a pointer to a <code>std::vector</code> of files that still need to be sent and another pointer to a <code>std::mutex</code> that is supposed to protect that vector.  I'm using pointers instead of references because this allows me to create the <code>std::thread</code>s simpler later on.  You don't need to do this, if you don't like it.</p>\n\n<pre><code>int\nsend_files(std::vector&lt;std::string&gt; *const files_p, std::mutex *const mutex_p)\n{\n  auto count = 0;\n  while (true)\n    {\n      std::string next {};\n      {\n        const std::unique_lock&lt;std::mutex&gt; lck {*mutex_p};\n        if (files_p-&gt;empty())  // nothing left to do\n          return count;\n        next = std::move(files_p-&gt;back());\n        files_p-&gt;pop_back();\n      }\n      send_file(next);\n      count += 1;\n    }\n}\n</code></pre>\n\n<p>The important thing is that we don't hold the lock while the actual work of sending the file is performed.  Otherwise, we would completely kill concurrency.  I was also careful not to allocate any memory while holding to the lock.  Usually, you will see <code>std::list</code>s used as work queues and <code>std::condition_variable</code>s to signal when a change to the queue has occurred.  I have posted code showing this in <a href=\"https://stackoverflow.com/a/28641381/1392132\">another answer</a> some time ago.\n  However, in this simple case, the queue is only ever removed from so a <code>std::vector</code> is a perfect fit.</p>\n\n<p>Finally, we use what we have in a simple program that creates one thread per hardware concurrency unit and asks these threads to send all files named in the command line arguments.  Note that, as written, this will process the list in reversed order.  It is trivial to change, though, if this is an issue for you.</p>\n\n<pre><code>int\nmain(int argc, char * * argv)\n{\n  const auto nthreads = std::thread::hardware_concurrency();\n  std::mutex mutex {};\n  std::vector&lt;std::thread&gt; threads {};\n  std::vector&lt;std::string&gt; files {};\n  files.reserve(argc - 1);\n  for (auto i = 1; i &lt; argc; ++i)\n    files.push_back(argv[i]);\n  threads.reserve(nthreads);\n  for (auto t = 0U; t &lt; nthreads; ++t)\n    threads.emplace_back(send_files, &amp;files, &amp;mutex);\n  for (auto t = 0U; t &lt; nthreads; ++t)\n    threads[t].join();\n}\n</code></pre>\n"}], "owner": {"reputation": 9423, "user_id": 2809564, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9dbbaaa9c03d7a256eef869bf1d635e3?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/2809564/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1445, "favorite_count": 0, "accepted_answer_id": 30361663, "answer_count": 3, "score": 2, "last_activity_date": 1432197957, "creation_date": 1432155802, "question_id": 30360323, "link": "https://stackoverflow.com/questions/30360323/how-to-launch-multiple-threads-and-each-thread-working-on-different-files", "title": "How to launch multiple threads and each thread working on different files?", "body": "<p>I have a single thread application which is sending a file to other server by calling <code>send_new_file</code></p>\n\n<pre><code>void send_new_file_command::start_sending_file()\n{\n    m_thread = thread(&amp;send_new_file_command::execute_file, this);\n}\n\nvoid send_new_file_command::execute_file()\n{\n    for (auto it = files_need_to_send.begin(); it != files_need_to_send.end() &amp;&amp; !is_complete(); ++it)\n    {\n        {\n            std::unique_lock&lt;spinning_lock&gt; guard(lock_obj);\n            m_current_file = *it;\n        }\n        // send a file.\n        // I want to call this in parallel\n        send_new_file(*it);\n    }\n}\n</code></pre>\n\n<p>Is there any way I can have multiple threads and each thread sending one file each. As an example let's say we have 4 threads and thread 1,2,3,4 will send different files in parallel. I want to call <code>send_new_file</code> in parallel?</p>\n\n<p>I am using <code>std::thread</code>. I was looking at thread example on how can I do this in C++ but got confuse how can I divide number of files per thread here and make sure each thread works on subset of files.</p>\n\n<pre><code>  std::vector&lt;std::thread&gt; threads;\n  for (int i = 0; i &lt; 4; ++i)\n    threads.push_back(std::thread(send_new_file(*it)));\n</code></pre>\n\n<p>My background is in Java so slightly confuse how to do this in C++ using std::thread.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1432155904, "post_id": 30360307, "comment_id": 48812423, "body": "<a href=\"http://en.cppreference.com/w/cpp/io/basic_ios/clear\" rel=\"nofollow noreferrer\"><code>f.clear()</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 3, "last_activity_date": 1432156312, "last_edit_date": 1495541155, "creation_date": 1432156312, "answer_id": 30360443, "question_id": 30360307, "link": "https://stackoverflow.com/questions/30360307/get-stream-positioning-c/30360443#30360443", "title": "Get stream positioning c++", "body": "<p>Use of</p>\n\n<pre><code>while (!f.eof())\n{\n    f &gt;&gt; wordCount;\n    countWord++;\n}\n</code></pre>\n\n<p>is wrong.</p>\n\n<p>It should be</p>\n\n<pre><code>while (f &gt;&gt; wordCount)\n{\n    countWord++;\n}\n</code></pre>\n\n<p>Further reading: <a href=\"https://stackoverflow.com/questions/5605125/why-is-iostreameof-inside-a-loop-condition-considered-wrong\">Why is iostream::eof inside a loop condition considered wrong?</a>.</p>\n\n<p>Once EOF has reached, you'll need to clear the error flags of the stream before you can use it again.</p>\n\n<pre><code>f.clear();\nf.seekg(ios::beg);\nwhile (getline(f, charCount)) ...\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4734872, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aPtYbS4OjN8/AAAAAAAAAAI/AAAAAAAAAtI/0nfcAKKjNKs/photo.jpg?sz=128", "display_name": "Kristian Karadjov", "link": "https://stackoverflow.com/users/4734872/kristian-karadjov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 30360443, "answer_count": 1, "score": -1, "last_activity_date": 1432161192, "creation_date": 1432155703, "last_edit_date": 1432161192, "question_id": 30360307, "link": "https://stackoverflow.com/questions/30360307/get-stream-positioning-c", "title": "Get stream positioning c++", "body": "<p>I have the following task.</p>\n\n<p>I need to check how many characters, words and rows, are in the file, that I'm opening. So I came to this problem.</p>\n\n<p>When I need to position the get pointer, again in the beginning, it doesn't work. The <code>while((getline(f, charCount))</code>, just get passed away, it doesn't enter.</p>\n\n<p>Here's the code: </p>\n\n<pre><code>void count(ifstream &amp;f)\n{\n    int countChar = 0, countWord = 0, countRow = 0;\n    string charCount;\n    string wordCount;\n    while (!f.eof())\n    {\n        f &gt;&gt; wordCount;\n        countWord++;\n\n    }\n    cout &lt;&lt; \" Words : \" &lt;&lt; countWord &lt;&lt; endl;\n    f.seekg(ios::beg);\n    while (getline(f, charCount))\n    {\n        countChar += charCount.length();\n        countRow++;\n    }\n\n    cout &lt;&lt; \"Characters: \" &lt;&lt; countChar &lt;&lt; endl;\n    cout &lt;&lt; \"Rows : \" &lt;&lt; countRow &lt;&lt; endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "macos"], "comments": [{"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 2, "creation_date": 1432156204, "post_id": 30360301, "comment_id": 48812580, "body": "What are the contents of the <code>WebPage</code> variable? Also: Is your app sandboxed?"}, {"owner": {"reputation": 83109, "user_id": 1312143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d64f50f989e564c337a8a8bd653b8e6?s=128&d=identicon&r=PG", "display_name": "Ken Thomases", "link": "https://stackoverflow.com/users/1312143/ken-thomases"}, "edited": false, "score": 0, "creation_date": 1432157001, "post_id": 30360301, "comment_id": 48812988, "body": "This approach is still the right way, so duskwuff&#39;s questions are good ones. Also, what happens if you use the <code>open &lt;the URL&gt;</code> command in Terminal?"}, {"owner": {"reputation": 59, "user_id": 1356734, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2500ba4c9b57350bfcd1c17f70a7022d?s=128&d=identicon&r=PG", "display_name": "TheSilverHammer", "link": "https://stackoverflow.com/users/1356734/thesilverhammer"}, "edited": false, "score": 0, "creation_date": 1432162285, "post_id": 30360301, "comment_id": 48814921, "body": "opening the URL on the terminal works fine.  IE: If I just do www.google.com, it fails to load.  The web browser doesn&#39;t even open / launch.  As for our app being &quot;sandboxed&quot; I do not know what that really means.  This application was written many, many years ago.  I just booted the old dev machine after it had not really been used in years.  Is there some kind of config file I need to allow me to launch web pages?  Something in the package?"}, {"owner": {"reputation": 59, "user_id": 1356734, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2500ba4c9b57350bfcd1c17f70a7022d?s=128&d=identicon&r=PG", "display_name": "TheSilverHammer", "link": "https://stackoverflow.com/users/1356734/thesilverhammer"}, "edited": false, "score": 0, "creation_date": 1432162976, "post_id": 30360301, "comment_id": 48815128, "body": "I was reading some docs on app sandboxing, and it seems to be something you intentionally do.  You have to tell xcode to make it a sandboxed app.  I am fairly sure this is not the case.  Even the version of xcode is old, like 4.2 since that version still had some features we wanted like the ability to compile for the old non-intel architecture."}, {"owner": {"reputation": 59, "user_id": 1356734, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2500ba4c9b57350bfcd1c17f70a7022d?s=128&d=identicon&r=PG", "display_name": "TheSilverHammer", "link": "https://stackoverflow.com/users/1356734/thesilverhammer"}, "edited": false, "score": 0, "creation_date": 1432212956, "post_id": 30360301, "comment_id": 48838586, "body": "It is complied using XCode version 3.2.6, and linked against the 10.4 target libraries if this matters at all."}], "owner": {"reputation": 59, "user_id": 1356734, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2500ba4c9b57350bfcd1c17f70a7022d?s=128&d=identicon&r=PG", "display_name": "TheSilverHammer", "link": "https://stackoverflow.com/users/1356734/thesilverhammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 561, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1591096107, "creation_date": 1432155669, "last_edit_date": 1495541659, "question_id": 30360301, "link": "https://stackoverflow.com/questions/30360301/c-osx-how-do-i-open-a-web-page-in-the-default-browser", "title": "C++, OSX, how do I open a web page in the default browser?", "body": "<p>Until a very recent OSX security patch, I had a method that worked just fine:</p>\n\n<pre><code>void ShowWebPage(CStdString WebPage)\n{\nCFStringRef URL =  CFStringCreateWithCString(NULL, WebPage.c_str(), kCFStringEncodingASCII);\nCFURLRef pathRef = CFURLCreateWithString( NULL, URL, NULL );\n\nif( pathRef )\n{\n    LSOpenCFURLRef(pathRef, NULL);\n    CFRelease(pathRef);\n}\n\nCFRelease(URL);\n}\n</code></pre>\n\n<p>Now this no longer works.  I also found this article:\n<a href=\"https://stackoverflow.com/questions/4177744/c-osx-open-default-browser\">C++ OS X open default browser</a>\nWhich gives pretty much the same soliton.  I also tried the first system(\"open URL\") answer and that did not work either.</p>\n\n<p>I had a Mac that had been off for a while and our app worked fine, then it got the latest patches and now this no longer works.</p>\n\n<p>I have also tried googling this and I can only come up with objective C stuff.</p>\n\n<p>Anyway, does anyone know how to open a web page from a cpp app now? I think there may be some kind of security setting that is blocking this, but I have no idea what it would be.  </p>\n"}, {"tags": ["c++", "inheritance", "design-patterns", "vector", "dynamic-cast"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1432155428, "post_id": 30360189, "comment_id": 48812146, "body": "Did you really mean to make all those members <code>private</code>? If not, replace <code>class</code> by <code>struct</code>."}, {"owner": {"reputation": 1007, "user_id": 3848107, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4998af2eca9fdc126da761fd533a46d5?s=128&d=identicon&r=PG&f=1", "display_name": "FCR", "link": "https://stackoverflow.com/users/3848107/fcr"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1432155644, "post_id": 30360189, "comment_id": 48812267, "body": "Sorry, yes! Everything should be public. That is not the issue, I will try to change it"}, {"owner": {"reputation": 1156, "user_id": 3738040, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zKsuP.png?s=128&g=1", "display_name": "dlavila", "link": "https://stackoverflow.com/users/3738040/dlavila"}, "edited": false, "score": 0, "creation_date": 1432156083, "post_id": 30360189, "comment_id": 48812518, "body": "you should make this question in <a href=\"http://programmers.stackexchange.com/\">Programmers</a>"}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1432156254, "post_id": 30360189, "comment_id": 48812615, "body": "My gut tells me that <i>expensive</i> should be a <i>property</i> of <code>CarRetailer</code>, not a descendant class."}, {"owner": {"reputation": 30744, "user_id": 1768232, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/P6XgG.png?s=128&g=1", "display_name": "durron597", "link": "https://stackoverflow.com/users/1768232/durron597"}, "reply_to_user": {"reputation": 1156, "user_id": 3738040, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zKsuP.png?s=128&g=1", "display_name": "dlavila", "link": "https://stackoverflow.com/users/3738040/dlavila"}, "edited": false, "score": 1, "creation_date": 1432156268, "post_id": 30360189, "comment_id": 48812622, "body": "@dlavila if it was made on Programmers, it would be closed as a <a href=\"http://programmers.stackexchange.com/questions/284033/how-do-i-override-the-type-of-members-in-a-base-class-from-the-derived-class\">duplicate of this question</a>"}, {"owner": {"reputation": 1156, "user_id": 3738040, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zKsuP.png?s=128&g=1", "display_name": "dlavila", "link": "https://stackoverflow.com/users/3738040/dlavila"}, "reply_to_user": {"reputation": 30744, "user_id": 1768232, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/P6XgG.png?s=128&g=1", "display_name": "durron597", "link": "https://stackoverflow.com/users/1768232/durron597"}, "edited": false, "score": 0, "creation_date": 1432156425, "post_id": 30360189, "comment_id": 48812694, "body": "@durron597 then he shouldn&#39;t have asked the question"}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "reply_to_user": {"reputation": 1156, "user_id": 3738040, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zKsuP.png?s=128&g=1", "display_name": "dlavila", "link": "https://stackoverflow.com/users/3738040/dlavila"}, "edited": false, "score": 2, "creation_date": 1432157096, "post_id": 30360189, "comment_id": 48813044, "body": "@dlavila It&#39;s not off-topic here."}, {"owner": {"reputation": 184, "user_id": 1552766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050525b6d5df7ac28609fd791d1e384d?s=128&d=identicon&r=PG", "display_name": "timato", "link": "https://stackoverflow.com/users/1552766/timato"}, "edited": false, "score": 0, "creation_date": 1432159414, "post_id": 30360189, "comment_id": 48813985, "body": "Relevant <a href=\"http://ericlippert.com/2015/04/27/wizards-and-warriors-part-one/\" rel=\"nofollow noreferrer\">link</a> from Programmers &quot;duplicate&quot;"}, {"owner": {"reputation": 847, "user_id": 2180930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/fMw7n.jpg?s=128&g=1", "display_name": "CreativeMind", "link": "https://stackoverflow.com/users/2180930/creativemind"}, "edited": false, "score": 0, "creation_date": 1432185594, "post_id": 30360189, "comment_id": 48821342, "body": "@user3848107 Abstract Factory pattern is the perfect match for your example. Please check the UML diagram of this pattern and you will realize it."}, {"owner": {"reputation": 1007, "user_id": 3848107, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4998af2eca9fdc126da761fd533a46d5?s=128&d=identicon&r=PG&f=1", "display_name": "FCR", "link": "https://stackoverflow.com/users/3848107/fcr"}, "reply_to_user": {"reputation": 847, "user_id": 2180930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/fMw7n.jpg?s=128&g=1", "display_name": "CreativeMind", "link": "https://stackoverflow.com/users/2180930/creativemind"}, "edited": false, "score": 0, "creation_date": 1432210189, "post_id": 30360189, "comment_id": 48836528, "body": "@CreativeMind I dont think so. Abstract factory works if all inherited classes have the same interface. If applied in this case, you can use <code>ExpensiveCar</code> and <code>CheapCar</code> both as Car*. But if you want to use the specific function for <code>ExpensiveCar::apply_turbo</code> then you need to dynamic_cast the pointer coming from the factory."}, {"owner": {"reputation": 847, "user_id": 2180930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/fMw7n.jpg?s=128&g=1", "display_name": "CreativeMind", "link": "https://stackoverflow.com/users/2180930/creativemind"}, "edited": false, "score": 0, "creation_date": 1432212774, "post_id": 30360189, "comment_id": 48838451, "body": "@user3848107 You can create interface apply() only and pass the enum type that you want to apply and handle each type in switch case."}, {"owner": {"reputation": 847, "user_id": 2180930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/fMw7n.jpg?s=128&g=1", "display_name": "CreativeMind", "link": "https://stackoverflow.com/users/2180930/creativemind"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1432215492, "post_id": 30360189, "comment_id": 48840462, "body": "@RobertHarvey In fact, expensive should be property of car itself."}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "reply_to_user": {"reputation": 847, "user_id": 2180930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/fMw7n.jpg?s=128&g=1", "display_name": "CreativeMind", "link": "https://stackoverflow.com/users/2180930/creativemind"}, "edited": false, "score": 0, "creation_date": 1432216712, "post_id": 30360189, "comment_id": 48841444, "body": "@CreativeMind: Yes, that&#39;s true.  Perhaps the property on CarRetailer is <code>Lavish</code>."}, {"owner": {"reputation": 1007, "user_id": 3848107, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4998af2eca9fdc126da761fd533a46d5?s=128&d=identicon&r=PG&f=1", "display_name": "FCR", "link": "https://stackoverflow.com/users/3848107/fcr"}, "reply_to_user": {"reputation": 847, "user_id": 2180930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/fMw7n.jpg?s=128&g=1", "display_name": "CreativeMind", "link": "https://stackoverflow.com/users/2180930/creativemind"}, "edited": false, "score": 0, "creation_date": 1432285370, "post_id": 30360189, "comment_id": 48873085, "body": "@CreativeMind, @RobertHarvey If expensive is a property of the car, the then the <code>Car</code> would implement both exclusive member functions <code>apply_turbo()</code> and <code>get_cars_in_second_hand()</code> . Being exclusive, the API is mixed with functions that belong to one specific type of <code>Car</code>. If tomorrow there is a new car <code>LuxuryCar</code> with an excluvie function <code>get_hollywood_stars_who_drove_it()</code>  This new function will in the end be again in the common interface <code>Car</code> since Luxury will also be a property of car, according to your approach."}, {"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 0, "creation_date": 1432299988, "post_id": 30360189, "comment_id": 48882726, "body": "The vector of <code>Car</code> pointers you get from <code>get_cars</code>. Are they owning raw pointers that the caller is responsible for deleting or just pointers to the cars that are owned by the retailer?"}, {"owner": {"reputation": 1007, "user_id": 3848107, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4998af2eca9fdc126da761fd533a46d5?s=128&d=identicon&r=PG&f=1", "display_name": "FCR", "link": "https://stackoverflow.com/users/3848107/fcr"}, "edited": false, "score": 0, "creation_date": 1432303079, "post_id": 30360189, "comment_id": 48884983, "body": "I put the example of raw pointers, but could also be shared_ptr or unique_ptr ( const ). The ownership of the generated vector of <code>Car</code> is of the caller. The messy API is what bothers me the most."}], "answers": [{"comments": [{"owner": {"reputation": 1007, "user_id": 3848107, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4998af2eca9fdc126da761fd533a46d5?s=128&d=identicon&r=PG&f=1", "display_name": "FCR", "link": "https://stackoverflow.com/users/3848107/fcr"}, "edited": false, "score": 0, "creation_date": 1432290683, "post_id": 30378731, "comment_id": 48876434, "body": "Any hint on the shape of the templated classes in this example? I guess your approach will be different than the one I explained at the end of the main post ( including the reasons why I did not do it that way). So I am very curious :)"}], "tags": [], "owner": {"reputation": 1009, "user_id": 2453661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0a44afa0c663b486bff7891d92df52c?s=128&d=identicon&r=PG", "display_name": "Alberto M", "link": "https://stackoverflow.com/users/2453661/alberto-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1432372865, "last_edit_date": 1495541766, "creation_date": 1432223701, "answer_id": 30378731, "question_id": 30360189, "link": "https://stackoverflow.com/questions/30360189/inheritance-on-c-classes-that-contain-another-derived-classes/30378731#30378731", "title": "Inheritance on C++ Classes that contain another Derived classes", "body": "<p>The whole concept of \"coupling of classes that contains inherited classes as well\" is called covariance. On Wikipedia one can find an extensive review of the subject: <a href=\"http://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science)\" rel=\"nofollow noreferrer\">http://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science)</a>. But let's get back to the practical example: by writing</p>\n\n<pre><code>struct CarRetailer\n{\n    virtual std::vector&lt;Car*&gt; get_cars( ) = 0;\n};\n</code></pre>\n\n<p>you are promising too much, i.e. that the <code>get_cars()</code> function will return a vector which you can modify with whatever <code>Car</code> you want. That is probably not what you meaned:</p>\n\n<pre><code>CarRetailer* ferrari = new ExpensiveCarsRetailer();\nauto niceCars ferrari-&gt;get_cars();\nniceCars.push_back(new Car{\"Trabant\"}); // you promised in the declaration that it was possible!\n</code></pre>\n\n<p>The solution is reducing the \"promises\" you do in the root class, returning a range which cannot be altered with \"extraneous\" objects. A read-only container would be nice, but alas, C++ is not (yet?) smart enough to support convariance on it:</p>\n\n<pre><code>struct CarRetailer\n{\n    virtual const std::vector&lt;const Car*&gt; get_cars( ) = 0;\n};\n\nstruct ExpensiveCarsRetailer : public CarRetailer \n{\n    const std::vector&lt;const ExpensiveCar*&gt; get_cars( ) = 0;\n    // Alas, it won't override\n};\n</code></pre>\n\n<p>But ranges (i.e. pointers pairs, in the hope that C++17 will offer something better) will do:</p>\n\n<pre><code>struct CarRetailer\n{\n    virtual Car* const cars_begin( ) = 0;\n    virtual Car* const cars_end( ) = 0;\n};\n\nstruct ExpensiveCarsRetailer : public CarRetailer \n{\n    ExpensiveCar* const cars_begin( ) override {return cars-&gt;begin();}\n    ExpensiveCar* const cars_end( ) override {return cars-&gt;end();}\n\n    private:\n    vector&lt;ExpensiveCar&gt;* cars; \n};\n</code></pre>\n\n<p>(note: I did not test my code, so please forgive possible mistakes. The concept should be clear, though)</p>\n\n<p>This interface may seem uglier than the original one, but I am of the opposite opinion, since it integrates perfectly with the powerful <code>&lt;algorithm&gt;</code> C++ library and facilitates writing code in modern style. Here a simple example:</p>\n\n<pre><code>any_of(dealer.cars_begin( ), dealer.cars_end( ),\n       [](const auto&amp; car) -&gt; bool {return car.hasScratch();}\n) ? complain() : congratulate();\n</code></pre>\n\n<p>The biggest shortcoming of this design is that the <code>CarDealer</code> class has to own the <code>*cars</code> container and manage its existence, i.e. it must care that the pointers it returns stay alive. This is made difficult by the fact that one cannot return smart pointers, since C++ <a href=\"https://stackoverflow.com/questions/196733/how-can-i-use-covariant-return-types-with-smart-pointers\">does not support covariance on them</a>. Additionally one could end up having to mantain a container of <code>vector&lt;Car&gt;*</code>, if the <code>cars_begin</code> and <code>cars_end</code> functions are supposed to generate new collections on repeated invocations. So it's up to you to balance pros and cons of my proposal in your concrete use case.</p>\n\n<p>On a personal note, if I had the same issue I would use templated classes and avoid inheritance at all: such kind of problems IMHO well illustrates why OOP sometimes complicates things instead of simplifying them.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>If I understand well why you feel templated Dealers would not be indicated for your needs, I think this proposal should be more fit:</p>\n\n<pre><code>struct ExpensiveCarsRetailer /* not derived, not templated */\n{\n    std::vector&lt;ExpensiveCar&gt; get_cars( ) { /*..*/ }\n    // you can also return a vector of pointers or of unique_pointers, as you feel like.\n};\n\nstruct CheapCarsRetailer /* not derived, not templated */\n{\n    std::vector&lt;CheapCar&gt; get_cars( );\n};\n</code></pre>\n\n<p>Instead of overloading, templated functions are used:</p>\n\n<pre><code>template &lt;typename T&gt; print_car_table(T dealer) {\n    // This will work on both Expensive and Cheap dealers\n\n    // Not even a hierarchy for the Car classes is needed:\n    // they can be independent structs, like the Dealer ones\n\n    auto cars = dealer.get_cars();\n\n    for (const auto&amp; car : cars) { std::cout &lt;&lt; car.name() &lt;&lt; \"\\t\" &lt;&lt; car.color() &lt;&lt; \"\\n\"; }\n}\n\ntemplate &lt;typename T&gt; apply_turbo(T dealer) {\n    // This will work if dealer is an ExpensiveDealer,\n    // and fail on compile time if not, as wanted\n\n    auto cars = dealer.get_cars();\n\n    for (auto&amp; car : cars) { car.apply_turbo(); }\n}\n</code></pre>\n\n<p>The big advantage of this system is that you do not even have to plan the interface in advance, and each class can implement just the methods you need. So if in future you add a <code>CarMuseum</code>, you can decide to implement <code>get_cars()</code> to get <code>print_car_table(T)</code> work with it, but you are free not to create any other method. With inheritance, you are instad forced to implement all the functions declared in the base interface, or create many fragmented interfaces (<code>class CheapDealer : public HasACarList, public HasAPriceList, /* yuck ...*/</code>). .</p>\n\n<p>The disadvantages of this templated design are the consequence of the Dealer classes not being relatives. This means you cannot create a <code>vector&lt;Dealer&gt;</code> nor have <code>Dealer*</code> (even if you made them derive from a tiny common interface, you could not call get_cars() through a pointer to such interface).</p>\n\n<p>For completeness, I would point out the opposite, dynamic, solution:</p>\n\n<pre><code>struct Car {\n    virtual int get_price() = 0;\n    virtual void apply_turbo( ) = 0;\n};\n\nstruct CheapCar: public Car\n{\n    int get_price( ) {/*..*/}\n    void apply_turbo( ){throw OperationNonSupportedException();};\n};\n</code></pre>\n\n<p>It does not feel very idiomatic C++, does it? I find it quite inelegant, but still I think this design should be evaluated before discarding it. Advantages and disadvantages are more or less the opposite of the templated solution.</p>\n\n<p>Finally, I guess that the Visitor pattern or Scala (offering very powerful covariance facilities) could offer other alternative solutions to your problem. But I have no experience with both of them, so I leave them to others to illustrate.</p>\n"}, {"tags": [], "owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "is_accepted": false, "score": 0, "last_activity_date": 1432381096, "last_edit_date": 1432381096, "creation_date": 1432370846, "answer_id": 30410744, "question_id": 30360189, "link": "https://stackoverflow.com/questions/30360189/inheritance-on-c-classes-that-contain-another-derived-classes/30410744#30410744", "title": "Inheritance on C++ Classes that contain another Derived classes", "body": "<p>Why not have a non-virtual function to get the cars just like you have done with <code>get_cars_for_exhibitions</code>? In the example you have shown the caller knows they have an <code>ExpensiveCarsRetailer</code> so they do not need the polymorphism. I assume you do need the inheritance and polymorphism in other contexts but it would be easy enough to convert from a vector of <code>ExpensiveCar</code> pointers to a vector of <code>Car</code> pointers to fulfil the <code>CarRetailer</code> interface:</p>\n\n<pre><code>template&lt;typename T&gt;\nusing Ptrs = std::vector&lt;std::unique_ptr&lt;T&gt;&gt;;\n\ntemplate&lt;class T, class U&gt;\nPtrs&lt;U&gt; upcast(Ptrs&lt;T&gt; input) {\n  return Ptrs&lt;U&gt;(std::make_move_iterator(input.begin()),  \n                 std::make_move_iterator(input.end()));\n}\nstruct CarRetailer {\n  virtual Ptrs&lt;Car&gt; getCars() = 0;\n};\n\nstruct ExpensiveCarsRetailer : CarRetailer {\n  Ptrs&lt;ExpensiveCar&gt; getCarsImpl() { ... }\n  Ptrs&lt;Car&gt; getCars() override { return upcast&lt;Car&gt;(getCarsImpl()); }\n};\n</code></pre>\n\n<p>Then you can call the non-virtual function if you need a vector of <code>ExpensiveCar</code> pointers:</p>\n\n<pre><code>ExpensiveCarsRetailer ferrari;\n\nauto expensive_cars = ferrari.getCarsImpl();\nfor (auto&amp; expensive_car : expensive_cars)\n  expensive_car-&gt;apply_turbo();\n</code></pre>\n\n<p>And in a polymorphic context you can call the virtual function:</p>\n\n<pre><code>CarRetailer* retailer = &amp;ferrari;\nauto cars = retailer-&gt;getCars();\nfor (auto&amp; car : cars)\n   std::cout &lt;&lt; \"Car price \" &lt;&lt; car-&gt;get_price() &lt;&lt; \"\\n\";\n</code></pre>\n"}], "owner": {"reputation": 1007, "user_id": 3848107, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4998af2eca9fdc126da761fd533a46d5?s=128&d=identicon&r=PG&f=1", "display_name": "FCR", "link": "https://stackoverflow.com/users/3848107/fcr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 30378731, "answer_count": 2, "score": 4, "last_activity_date": 1432381096, "creation_date": 1432155264, "last_edit_date": 1432157721, "question_id": 30360189, "link": "https://stackoverflow.com/questions/30360189/inheritance-on-c-classes-that-contain-another-derived-classes", "title": "Inheritance on C++ Classes that contain another Derived classes", "body": "<p>Having the next C++ classes as a simplifiacation of the issue:</p>\n\n<pre><code>struct Car\n{\n    virtual int get_price() = 0;\n};\n\nstruct ExpensiveCar: public Car\n{\n    int get_price( ) {/*..*/ }\n    void apply_turbo( ){/*..*/};\n};\n\nstruct CheapCar: public Car\n{\n    int get_price( ) {/*..*/}\n};\n\nstruct CarRetailer\n{\n    virtual std::vector&lt;Car*&gt; get_cars( ) = 0;\n};\n\n\nstruct ExpensiveCarsRetailer : public CarRetailer\n{\n    virtual std::vector&lt;Car*&gt; get_cars( ) { /*..*/ }\n    std::vector&lt;ExpensiveCar*&gt; get_cars_for_exhibitions( );\n};\n\nstruct CheapCarsRetailer : public CarRetailer\n{\n    virtual std::vector&lt;Car*&gt; get_cars( ) { /*..*/ }\n    std::vector&lt;CheapCar*&gt; get_second_hand_cars( );\n};\n</code></pre>\n\n<p>The rules are: Expensive Cars are only sold in ExpensiveCarsRetailers (similar for Cheap Cars ). Cheap cars do not have turbo and expensive cars are not sold in second hand.</p>\n\n<p>The issue I face here is the coupling of classes that contains inherited classes as well. Therefore, if <code>ExpensiveCarRetailer</code> inherits from <code>CarRetailer</code>, it will need to implement \n<code>virtual std::vector&lt;Car*&gt; get_cars( )</code> that is actually returning a vector of <code>Car*</code>, however, internally <code>ExpensiveCarRetailer</code> only created objects of <code>ExpensiveCar</code>. Furthermore, the <code>get_cars_for_exhibitions()</code> is not included in the public interface <code>CarRetailer</code>therefore, it can return a <code>std::vector&lt;ExpensiveCar*&gt;</code> instead.</p>\n\n<p>The mixture in the API ( returning vector of <code>Car*</code> and <code>ExpensiveCar*</code> ) is very ugly, and so is the code that the user needs to write to use the <code>apply_turbo( )</code> function of the list of cars from a specific <code>ExpesiveCarsRetailer</code>.</p>\n\n<pre><code>ExpensiveCarsRetailer ferrari;\n\nstd::vector&lt;Car*&gt; car = ferrari.get_cars();\nExpensiveCar* expensive_car;\nfor( int i = 0; i &lt; car.size( ); ++i)\n{\nexpensive_car = dynamic_cast&lt;ExpensiveCar*&gt;(car[i]);\nexpensive_car-&gt;apply_turbo();\n}\n</code></pre>\n\n<p>I am sure I am missing some design pattern that helps in this situation, where to trees of class inheritances are coupled in a way that the abstract class of one of the inheritance tress need to return a vector (or set, list, etc ) of classes on the other inheritance tree. I am trying to avoid the dynamic casting as much as possible.</p>\n\n<p>I also thought about making <code>CarRetailer</code> a templated class, therefore:</p>\n\n<pre><code>template&lt;typename T&gt;\n    struct CarRetailer\n    {\n        virtual std::vector&lt;T*&gt; get_cars( ) = 0;\n    };\n</code></pre>\n\n<p>And then make:</p>\n\n<pre><code>struct ExpensiveCarRetailer: public CarRetailer&lt;ExpensiveCar&gt;\n{\n...\n}\n</code></pre>\n\n<p>But I don't think this would work since, for example, the <code>CarRetailer</code> can also start selling motorbikes ( similar structure as cars ) or bikes etc ( always applying the Expensive/Cheap pattern ) and eventually the number of template classes that need to be defined in <code>CarRetailer</code> will be huge.</p>\n"}, {"tags": ["c++", "operators"], "comments": [{"owner": {"reputation": 14761, "user_id": 290072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/ITEsv.png?s=128&g=1", "display_name": "Almo", "link": "https://stackoverflow.com/users/290072/almo"}, "edited": false, "score": 1, "creation_date": 1432155040, "post_id": 30360119, "comment_id": 48811956, "body": "delete *++x; What if you have a pointer to the pointer before the pointer you want to delete? (stolen from MickLH)"}], "answers": [{"comments": [{"owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 2, "creation_date": 1432155675, "post_id": 30360231, "comment_id": 48812282, "body": "Precedence is unrelated to associativity."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 2, "last_activity_date": 1432156416, "last_edit_date": 1432156416, "creation_date": 1432155459, "answer_id": 30360231, "question_id": 30360119, "link": "https://stackoverflow.com/questions/30360119/operator-delete-associativity/30360231#30360231", "title": "Operator delete associativity", "body": "<p>The C++ standard typically does not define operators in terms of precedence or associativity. It defines them in terms of grammar. From [expr.delete], <code>delete</code> is used in a <em>delete-expression</em> which is defined as:</p>\n\n<blockquote>\n  <p><em>delete-expression</em>:<br>\n  &nbsp;&nbsp;&nbsp;&nbsp;::opt <code>delete</code> <em>cast-expression</em><br>\n  &nbsp;&nbsp;&nbsp;&nbsp;::opt <code>delete []</code> <em>cast-expression</em></p>\n</blockquote>\n\n<p>Where <em>cast-expression</em> is defined in [expr.cast]:</p>\n\n<blockquote>\n  <p><em>cast-expression:</em><br>\n  &nbsp;&nbsp;&nbsp;&nbsp;<em>unary-expression</em><br>\n  &nbsp;&nbsp;&nbsp;&nbsp; <code>(</code> <em>type-id</em> <code>)</code> <em>cast-expression</em></p>\n</blockquote>\n\n<p>And <em>unary-expression</em> is a whole bunch of things defined [expr.unary], that are all unary expressions (increments, decrements, <code>delete</code>s themselves)</p>\n\n<p>That is, <code>delete *x</code> is right to-left associative because <code>(delete (*x))</code> is the only way to parse that expression according to the grammar.</p>\n\n<p>This is also reason that <a href=\"http://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"nofollow\">cppreference</a> cites <code>delete</code>'s precedence where it does is a direct consequence of that. For example, <code>delete</code> is higher than <code>+</code> because in an expression like this:</p>\n\n<pre><code>delete x+y\n</code></pre>\n\n<p><code>x+y</code> is not a <em>unary-expression</em>, so the only legitimate parsing of the grammar would be <code>(delete x) + y</code>. </p>\n"}, {"comments": [{"owner": {"reputation": 7072, "user_id": 1816262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IcKpN.png?s=128&g=1", "display_name": "OMGtechy", "link": "https://stackoverflow.com/users/1816262/omgtechy"}, "edited": false, "score": 0, "creation_date": 1432157056, "post_id": 30360342, "comment_id": 48813023, "body": "That was what I was thinking; it just doesn&#39;t make sense for it to have associativity! I was wondering if I was missing something that gave it a use."}], "tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": true, "score": 6, "last_activity_date": 1432156582, "last_edit_date": 1432156582, "creation_date": 1432155906, "answer_id": 30360342, "question_id": 30360119, "link": "https://stackoverflow.com/questions/30360119/operator-delete-associativity/30360342#30360342", "title": "Operator delete associativity", "body": "<p>As Barry said, precedence is determined by the grammar (and there are a few operators that don't really fit well with the basic idea of precedence so you can only really figure out what happens entirely correctly from the grammar, not a precedence table).</p>\n\n<p>Even if we ignore that, however, the precedence of delete only (at least usually) determines whether a statement is legal/allowed, not what it means. To give a counterexample, with <code>+</code> and <code>*</code>, precedence determines that <code>2 * 3 + 4</code> yields 10 rather than 14 (i.e., multiplication takes precedence).</p>\n\n<p>In the case of <code>delete</code>, no value is produced as a result of the <code>delete</code> statement, so a statement like <code>delete x + y;</code> simply isn't allowed. It would be parsed as <code>(delete x) + y;</code>, but since <code>delete x</code> doesn't produce a value that can be added to anything else, the result is always prohibited (and if you change the operator, that will remain true).</p>\n\n<p>Associativity doesn't really make sense for <code>delete</code>. In particular, associativity deals with whether something like: <code>a @ b @ c</code> will be parsed as <code>(a @ b) @ c</code> or <code>a @ (b @ c)</code> (where <code>@</code> is some operator). That's only really meaningful for operators that take two operands though. There's simply no way to combine <code>delete</code>s in a way that allows you to ask the question(s) that associativity answers.</p>\n"}, {"tags": [], "owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "is_accepted": false, "score": 1, "last_activity_date": 1432156001, "creation_date": 1432156001, "answer_id": 30360364, "question_id": 30360119, "link": "https://stackoverflow.com/questions/30360119/operator-delete-associativity/30360364#30360364", "title": "Operator delete associativity", "body": "<p>Associativity is about whether <code>a op b op c</code> is parsed as <code>(a op b) op c</code> or <code>a op (b op c)</code>.</p>\n\n<p><code>delete</code> is a unary operator, so it cannot associate. It has no associativity.</p>\n\n<p>And <code>delete delete x</code> is never valid.</p>\n"}], "owner": {"reputation": 7072, "user_id": 1816262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IcKpN.png?s=128&g=1", "display_name": "OMGtechy", "link": "https://stackoverflow.com/users/1816262/omgtechy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 30360342, "answer_count": 3, "score": 5, "last_activity_date": 1435786881, "creation_date": 1432154985, "last_edit_date": 1435786881, "question_id": 30360119, "link": "https://stackoverflow.com/questions/30360119/operator-delete-associativity", "title": "Operator delete associativity", "body": "<p>Whilst looking up operator associativity on wikipedia, I noticed that <code>delete</code> has an associativity of right to left. The source is cited as <a href=\"https://msdn.microsoft.com/en-us/library/126fe14k(v=vs.120).aspx\" rel=\"nofollow\">msdn</a>, I checked it and it comes under group 3 precedence, right to left associativity. So I checked <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4296.pdf\" rel=\"nofollow\">the C++ standard (n4296)</a></p>\n\n<blockquote>\n  <p><strong>5.3 Unary expressions [expr.unary]</strong></p>\n  \n  <p>1) Expressions with unary operators group right-to-left</p>\n\n<pre><code>unary-expression:\n    postfix-expression\n    ++ cast-expression\n    -- cast-expression\n    unary-operator cast-expression\n    sizeof unary-expression\n    sizeof ( type-id )\n    sizeof ... ( identifier )\n    alignof ( type-id )\n    noexcept-expression\n    new-expression\n    delete-expression\nunary-operator: one of\n    * &amp; + - ! ~\n</code></pre>\n</blockquote>\n\n<p>What implications does this have? What does <code>delete</code> have any associativity at all?</p>\n"}, {"tags": ["c++", "opengl"], "comments": [{"owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 1, "creation_date": 1432155013, "post_id": 30360058, "comment_id": 48811938, "body": "You already seem to have the coordinates, what troubles you at this point?"}, {"owner": {"reputation": 11, "user_id": 4636829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5d407989049fa7fa09d842e7d482a37?s=128&d=identicon&r=PG&f=1", "display_name": "erik", "link": "https://stackoverflow.com/users/4636829/erik"}, "reply_to_user": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 0, "creation_date": 1432155434, "post_id": 30360058, "comment_id": 48812153, "body": "the problem is that when I run the code  it forms a triangle."}], "answers": [{"comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1432156023, "post_id": 30360288, "comment_id": 48812496, "body": "<code>glFlush()</code> will result in a meaningless slowdown here, you should remove it."}, {"owner": {"reputation": 11, "user_id": 4636829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5d407989049fa7fa09d842e7d482a37?s=128&d=identicon&r=PG&f=1", "display_name": "erik", "link": "https://stackoverflow.com/users/4636829/erik"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1432156433, "post_id": 30360288, "comment_id": 48812696, "body": "without the flush does not appear nothing"}, {"owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 0, "creation_date": 1432197897, "post_id": 30360288, "comment_id": 48827921, "body": "<code>glFlush</code> only has to be called once per frame. It should not be included as part of a primitive drawing procedure."}], "tags": [], "owner": {"reputation": 11, "user_id": 4636829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5d407989049fa7fa09d842e7d482a37?s=128&d=identicon&r=PG&f=1", "display_name": "erik", "link": "https://stackoverflow.com/users/4636829/erik"}, "is_accepted": false, "score": 0, "last_activity_date": 1432155627, "creation_date": 1432155627, "answer_id": 30360288, "question_id": 30360058, "link": "https://stackoverflow.com/questions/30360058/draw-diamond-using-opengl/30360288#30360288", "title": "draw diamond using OpenGL", "body": "<p>draw-></p>\n\n<pre><code>void drawLine (int x1, int y1, int x2, int y2) {\nglBegin (GL_LINES);\nglVertex2d (x1, y1);\nglVertex2d (x2, y2);\nglEnd();\nglFlush();\n</code></pre>\n\n<p>}</p>\n\n<p>second this</p>\n\n<pre><code>  for (int i = 0; i &lt;3; i ++) {\n    for (int j = 0 ; j &lt; 3; j ++) {\n        drawLine (point [i], point [i +1], point [j], point [j +1]);\n    }\n}\n</code></pre>\n\n<p>first run this</p>\n\n<pre><code>point = (int *) malloc (sizeof (int) * n * 2) ;\nw = 2 * pi / n;\nwi = w / 2;\nfor (int i = 0; i &lt;7; i ++ ) {\n\n    point [i] = (int) (CX + R * cos (wi));\n    point [i +1] = (int) (CY + R * sin (wi));\n\n\n    printf(\"pointX = %d \\n\",(int)point[i]);\n    printf(\"pointY = %d \\n\",(int)point[i+1]);\n\n\n\n\n    wi += w;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4636829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5d407989049fa7fa09d842e7d482a37?s=128&d=identicon&r=PG&f=1", "display_name": "erik", "link": "https://stackoverflow.com/users/4636829/erik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1669, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1432155627, "creation_date": 1432154756, "last_edit_date": 1432155050, "question_id": 30360058, "link": "https://stackoverflow.com/questions/30360058/draw-diamond-using-opengl", "title": "draw diamond using OpenGL", "body": "<p>I try to draw a diamond </p>\n\n<p>here a go what i want</p>\n\n<p><a href=\"http://i.stack.imgur.com/SP9vK.png\" rel=\"nofollow\">http://i.stack.imgur.com/SP9vK.png</a></p>\n\n<p>consider the red part.</p>\n\n<p>what I want is to draw the diamond using this formula</p>\n\n<pre><code>point = (int *) malloc (sizeof (int) * n * 2) ;\nw = 2 * pi / n;\nwi = w / 2;\nfor (int i = 0; i &lt;3; i ++ ) {\n\n    point [i] = (int) (CX + R * cos (wi));\n    point [i +1] = (int) (CY + R * sin (wi));\n}\n</code></pre>\n\n<p>any ideia ?</p>\n"}, {"tags": ["c++", "list", "object"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1432154219, "post_id": 30359764, "comment_id": 48811499, "body": "Just use <code>std::list::remove_if</code> and a suitable functor as shown in the duplicate."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1432155351, "post_id": 30359764, "comment_id": 48812105, "body": "See: <a href=\"http://stackoverflow.com/q/263945/14065\">stackoverflow.com/q/263945/14065</a>"}], "answers": [{"comments": [{"owner": {"reputation": 140, "user_id": 4804663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gZxNaI1Kal8/AAAAAAAAAAI/AAAAAAAAAQ0/PQ0DlUrTHyQ/photo.jpg?sz=128", "display_name": "Jacob Oaks", "link": "https://stackoverflow.com/users/4804663/jacob-oaks"}, "edited": false, "score": 0, "creation_date": 1432154763, "post_id": 30359848, "comment_id": 48811783, "body": "Thank you, list.erase is working for me."}], "tags": [], "owner": {"reputation": 71857, "user_id": 47453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412dc332ab3593c636e5a5202cf98870?s=128&d=identicon&r=PG", "display_name": "Bill Lynch", "link": "https://stackoverflow.com/users/47453/bill-lynch"}, "is_accepted": true, "score": 3, "last_activity_date": 1432153985, "creation_date": 1432153985, "answer_id": 30359848, "question_id": 30359764, "link": "https://stackoverflow.com/questions/30359764/c-removing-an-object-from-a-list-not-working/30359848#30359848", "title": "c++ Removing an object from a list - not working", "body": "<h3>Missing operator==</h3>\n\n<p>You need to implement a proper <code>bool operator==(...)</code> overload. I'd tell you the arguments but it's not clear from what you've shown in the question.</p>\n\n<h3>Iterator invalidation</h3>\n\n<p>Once you call <code>events.remove(*eit);</code>, <code>eit</code> is no longer valid. So <code>eit++</code> causes undefined behavior.</p>\n\n<h3>You already have an iterator</h3>\n\n<p>Since you already have an iterator to the element you are removing, why not use it with <code>std::list::erase</code> which takes an iterator argument.</p>\n"}, {"tags": [], "owner": {"reputation": 3135, "user_id": 2648754, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/UWGAJ.png?s=128&g=1", "display_name": "a_pradhan", "link": "https://stackoverflow.com/users/2648754/a-pradhan"}, "is_accepted": false, "score": 1, "last_activity_date": 1432154142, "creation_date": 1432154142, "answer_id": 30359890, "question_id": 30359764, "link": "https://stackoverflow.com/questions/30359764/c-removing-an-object-from-a-list-not-working/30359890#30359890", "title": "c++ Removing an object from a list - not working", "body": "<p>Your <code>special_event</code> class/struct needs to have the right <code>==</code> overload (You may have overloaded it in a way where the left-hand type is something which is not <code>special_event</code> or can be converted to it). </p>\n\n<p><code>bool operator==(const special_event&amp;);</code></p>\n\n<p>If the operator overload is a member function.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 4890428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec1f9d0bd330200e8d2555c76b9cd53?s=128&d=identicon&r=PG&f=1", "display_name": "andreas nilsson", "link": "https://stackoverflow.com/users/4890428/andreas-nilsson"}, "is_accepted": false, "score": 0, "last_activity_date": 1432154711, "last_edit_date": 1432154711, "creation_date": 1432154398, "answer_id": 30359969, "question_id": 30359764, "link": "https://stackoverflow.com/questions/30359764/c-removing-an-object-from-a-list-not-working/30359969#30359969", "title": "c++ Removing an object from a list - not working", "body": "<blockquote>\n  <p>if ((*eit).getName() == eventName)</p>\n</blockquote>\n\n<p>You're asking for a comparison on your type <code>special_event</code>. The compiler can't possibly know how to compare this new type to anything. Therefore you have to overload the == operator to define how the comparison is made.</p>\n\n<pre><code>bool operator==(const special_event&amp; right_side){      \n    /* comparison */ \n}\n</code></pre>\n"}], "owner": {"reputation": 140, "user_id": 4804663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gZxNaI1Kal8/AAAAAAAAAAI/AAAAAAAAAQ0/PQ0DlUrTHyQ/photo.jpg?sz=128", "display_name": "Jacob Oaks", "link": "https://stackoverflow.com/users/4804663/jacob-oaks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "closed_date": 1432154145, "accepted_answer_id": 30359848, "answer_count": 3, "score": 0, "last_activity_date": 1432154711, "creation_date": 1432153727, "question_id": 30359764, "link": "https://stackoverflow.com/questions/30359764/c-removing-an-object-from-a-list-not-working", "closed_reason": "Duplicate", "title": "c++ Removing an object from a list - not working", "body": "<p>I have a function that is to remove an object from a list based on it's name, which is returned through the class function special_event.getName(). It takes the list and the name of the object it is to remove, and after removing it, it is to return the list with the object removed. Here is the code:</p>\n\n<pre><code>list&lt;special_event&gt; removeEvent(string eventName, list&lt;special_event&gt; events)\n{\nlist&lt;special_event&gt;::iterator eit;\nstring getName;\nfor (eit = events.begin(); eit != events.end(); eit++)\n{\n    if ((*eit).getName() == eventName)\n    {\n        events.remove(*eit);\n    }\n}\ncout &lt;&lt; endl &lt;&lt; endl &lt;&lt; eventName &lt;&lt; \" has been removed!\";\nreturn events;\n</code></pre>\n\n<p>}</p>\n\n<p>I get the error \"error C2678: binary '==' : no operator found which takes a left-hand operand of type 'special_event' (or there is no acceptable conversion). </p>\n\n<p>Any help would be appreciated, thanks</p>\n"}, {"tags": ["c++", "oop", "operator-overloading", "assignment-operator"], "comments": [{"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1432153623, "post_id": 30359726, "comment_id": 48811130, "body": "Please fix your title and your shift key."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1432153731, "post_id": 30359726, "comment_id": 48811188, "body": "<a href=\"http://stackoverflow.com/questions/4172722/what-is-the-rule-of-three\" title=\"what is the rule of three\">stackoverflow.com/questions/4172722/what-is-the-rule-of-thre&zwnj;&#8203;e</a> I should have swung the dupe hammer in 1st place."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1432153803, "post_id": 30359726, "comment_id": 48811239, "body": "<a href=\"http://stackoverflow.com/questions/4421706/operator-overloading\">operator overloading</a>"}], "answers": [{"tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": true, "score": 3, "last_activity_date": 1432153824, "creation_date": 1432153824, "answer_id": 30359794, "question_id": 30359726, "link": "https://stackoverflow.com/questions/30359726/what-is-the-difference-between-overloading-the-assignment-operator-and-any-other/30359794#30359794", "title": "What is the difference between overloading the assignment operator and any other operator?", "body": "<p>Here are two differences:</p>\n\n<ol>\n<li>An overloaded assignment operator must be a member of the class being assigned to; it cannot be declared as a free function.</li>\n<li>Copy and move assignment operators will be implicitly declared for your class if you do not declare them yourself (subject to certain restrictions).</li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 4741740, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/0abab2ced5cc90fbeb5abada235bdeeb?s=128&d=identicon&r=PG&f=1", "display_name": "rocky", "link": "https://stackoverflow.com/users/4741740/rocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 30359794, "answer_count": 1, "score": -7, "last_activity_date": 1432153824, "creation_date": 1432153550, "last_edit_date": 1432153756, "question_id": 30359726, "link": "https://stackoverflow.com/questions/30359726/what-is-the-difference-between-overloading-the-assignment-operator-and-any-other", "title": "What is the difference between overloading the assignment operator and any other operator?", "body": "<p>I want to know if there is any difference between simple binary operator overloading and assignment operator overloading.</p>\n"}, {"tags": ["c++", "macros", "concatenation", "c-preprocessor"], "comments": [{"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1432153181, "post_id": 30359596, "comment_id": 48810865, "body": "<code>#define _LOAD_FLOAT ##_LOAD##_FLOAT</code>"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1432153190, "post_id": 30359596, "comment_id": 48810870, "body": "<code>##</code> should serve you well."}, {"owner": {"reputation": 2717, "user_id": 3670482, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0c8eae23189a5c64f7bf9d1467cfd8a0?s=128&d=identicon&r=PG&f=1", "display_name": "The Vivandiere", "link": "https://stackoverflow.com/users/3670482/the-vivandiere"}, "edited": false, "score": 0, "creation_date": 1432153210, "post_id": 30359596, "comment_id": 48810881, "body": "The guidelines say not to use macros.. Just sayin"}], "answers": [{"comments": [{"owner": {"reputation": 1066, "user_id": 4602856, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d6bdff4f90dbe4527291814aa91598df?s=128&d=identicon&r=PG&f=1", "display_name": "codechimp", "link": "https://stackoverflow.com/users/4602856/codechimp"}, "edited": false, "score": 0, "creation_date": 1432217634, "post_id": 30359625, "comment_id": 48842168, "body": "Thanks.  Nice solution."}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": true, "score": 5, "last_activity_date": 1432153781, "last_edit_date": 1432153781, "creation_date": 1432153204, "answer_id": 30359625, "question_id": 30359596, "link": "https://stackoverflow.com/questions/30359596/c-concatenating-macro-definitions/30359625#30359625", "title": "C++ concatenating macro definitions", "body": "<p>Yes, you can concatenate macro replacements with the <code>##</code> preprocessor directive and some auxiliary quoting macros.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>#define _LOAD _mm256_load\n#define _FLOAT ps\n\n#define CAT(X, Y, Z) X ## Y ## Z\n#define CMB(A, B) CAT(A, _, B)\n\n#define FOO CMB(_LOAD, _FLOAT)\n</code></pre>\n\n<p>Now use <code>FOO</code>, or just <code>CMB(_LOAD, _FLOAT)</code> directly.</p>\n"}], "owner": {"reputation": 1066, "user_id": 4602856, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d6bdff4f90dbe4527291814aa91598df?s=128&d=identicon&r=PG&f=1", "display_name": "codechimp", "link": "https://stackoverflow.com/users/4602856/codechimp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 30359625, "answer_count": 1, "score": 0, "last_activity_date": 1467728218, "creation_date": 1432153112, "last_edit_date": 1467728218, "question_id": 30359596, "link": "https://stackoverflow.com/questions/30359596/c-concatenating-macro-definitions", "title": "C++ concatenating macro definitions", "body": "<p>In C++ (G++ to be specific), can one concatenate two macro definitions, <strong>without spaces</strong>, to create a 3rd definition?  For example, how to I take</p>\n\n<pre><code>#define _LOAD _mm256_load\n#define _FLOAT ps\n</code></pre>\n\n<p>and operate on them thusly</p>\n\n<pre><code>#define _LOAD_FLOAT   ****do something with _FLOAT and _LOAD here *****\n</code></pre>\n\n<p>to create a definition functionally equivalent to the following:</p>\n\n<pre><code>#define _LOAD_FLOAT _mm256_load_ps\n</code></pre>\n"}, {"tags": ["python", "c++", "sentinel"], "comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1432152039, "post_id": 30359255, "comment_id": 48810269, "body": "There does not appear to be any risk."}, {"owner": {"reputation": 1198, "user_id": 581330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72309ce8ef24824ea947eaf58dc5ed24?s=128&d=identicon&r=PG", "display_name": "RomanK", "link": "https://stackoverflow.com/users/581330/romank"}, "edited": false, "score": 0, "creation_date": 1432152891, "post_id": 30359255, "comment_id": 48810722, "body": "According to this post, there is no risk: <a href=\"http://stackoverflow.com/questions/1069621/are-members-of-a-c-struct-initialized-to-0-by-default\" title=\"are members of a c struct initialized to 0 by default\">stackoverflow.com/questions/1069621/&hellip;</a>  Everything gets initialised to zero by default."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 0, "creation_date": 1432153878, "post_id": 30359255, "comment_id": 48811303, "body": "<a href=\"http://stackoverflow.com/users/333698/psmears\">psmears</a> made a very interesting point about there not being a problem even if such code is compiled under C."}], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 2, "last_activity_date": 1432155096, "creation_date": 1432155096, "answer_id": 30360146, "question_id": 30359255, "link": "https://stackoverflow.com/questions/30359255/python-sentinel-in-c-extension/30360146#30360146", "title": "Python sentinel in C++ extension", "body": "<p>A pod class initialized with <code>{}</code> has fields not explicitly set zeroed.</p>\n\n<p>If <code>PyMethodDef</code> is pod (plain old data), as I suspect, <code>{NULL, NULL, 0, NULL}</code> will generate the same data as <code>{}</code>.</p>\n\n<p>This is true in both C and C++.</p>\n\n<p>If the class <code>PyMethodDef</code> was a non-pod class in C++11, <code>{NULL, NULL, 0, NULL}</code> could do something different than <code>{}</code>, but I strongly doubt that is the case here.</p>\n\n<p>The only concern I would have is if the library changed on me to make <code>PyMethodDef</code> a non-pod, and chose to make <code>{}</code> not zero the data at the same time.  I would find that unlikely.</p>\n"}], "owner": {"reputation": 40432, "user_id": 1807667, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/976dc9df3ea3d05a18e90f0cd9c29b7a?s=128&d=identicon&r=PG", "display_name": "Ortomala Lokni", "link": "https://stackoverflow.com/users/1807667/ortomala-lokni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 30360146, "answer_count": 1, "score": 1, "last_activity_date": 1432155096, "creation_date": 1432151902, "question_id": 30359255, "link": "https://stackoverflow.com/questions/30359255/python-sentinel-in-c-extension", "title": "Python sentinel in C++ extension", "body": "<p>I'm working on a Python extension module written in C++.</p>\n\n<p>According to the Python <a href=\"https://docs.python.org/3/extending/extending.html\" rel=\"nofollow\">documentation</a> the module method table should be written like this:</p>\n\n<pre><code>static PyMethodDef SpamMethods[] = {\n    ...\n    {\"system\",  spam_system, METH_VARARGS,\n    \"Execute a shell command.\"},\n    ...\n    {NULL, NULL, 0, NULL}        /* Sentinel */\n};\n</code></pre>\n\n<p>But I see that some developers write the sentinel like this:</p>\n\n<pre><code>static PyMethodDef SpamMethods[] = {\n    ...\n    {\"system\",  spam_system, METH_VARARGS,\n    \"Execute a shell command.\"},\n    ...\n    {}                          /* Sentinel */\n};\n</code></pre>\n\n<p>My question is the following is there a risk to use the shortened version?</p>\n"}, {"tags": ["c++", "string", "readfile"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1432153109, "post_id": 30359209, "comment_id": 48810836, "body": "<code>||</code> does not work the way you think so <code>string gatesearch = &quot;and&quot; || &quot;or&quot; || &quot;nand&quot; || &quot;nor&quot; || &quot;not&quot; || &quot;xor&quot;;</code> and <code>if (netlist == c17 || c432 || c499 || c880 || c1355 || c1908 || c2670 || c3540 || c5315 || c6288 || c75582)</code> are wrong."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1432153824, "post_id": 30359209, "comment_id": 48811255, "body": "<b><i>string INPUT[]; // Im not sure the size</i></b> Use a vector or possibly a list."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1432153876, "post_id": 30359209, "comment_id": 48811302, "body": "<b><i>string gatesearch = &quot;and&quot; || &quot;or&quot; || &quot;nand&quot; || &quot;nor&quot; || &quot;not&quot; || &quot;xor&quot;;</i></b> I would use an enum instead if strings for this."}, {"owner": {"reputation": 27, "user_id": 3880550, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100002059393136/picture?type=large", "display_name": "Leonardo Alves", "link": "https://stackoverflow.com/users/3880550/leonardo-alves"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1432231577, "post_id": 30359209, "comment_id": 48851631, "body": "I&#39;ll try this to. thank you."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 3880550, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100002059393136/picture?type=large", "display_name": "Leonardo Alves", "link": "https://stackoverflow.com/users/3880550/leonardo-alves"}, "edited": false, "score": 0, "creation_date": 1432231555, "post_id": 30360083, "comment_id": 48851613, "body": "I&#39;ll try this. Thank you."}], "tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": true, "score": 0, "last_activity_date": 1432154817, "creation_date": 1432154817, "answer_id": 30360083, "question_id": 30359209, "link": "https://stackoverflow.com/questions/30359209/searching-words-in-a-file-with-c-language/30360083#30360083", "title": "Searching words in a file with C++ language", "body": "<p>At least IMO, you're approaching this the wrong way. I'd start by reading a line of input. Then check how many items there are on that line. Then parse the items in the line appropriately.</p>\n\n<p>Unless you're absolutely set on doing this in pure C++ on your own, something like AWK or yacc will make the job tremendously easier.</p>\n\n<p>If you do insist on doing it without a parser generator or similar, you could at least use regular expressions to help out quite a bit.</p>\n"}], "owner": {"reputation": 27, "user_id": 3880550, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100002059393136/picture?type=large", "display_name": "Leonardo Alves", "link": "https://stackoverflow.com/users/3880550/leonardo-alves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 30360083, "answer_count": 1, "score": -4, "last_activity_date": 1489794861, "creation_date": 1432151735, "last_edit_date": 1489794861, "question_id": 30359209, "link": "https://stackoverflow.com/questions/30359209/searching-words-in-a-file-with-c-language", "title": "Searching words in a file with C++ language", "body": "<p>I'm editing my post with the progress I made so far. Well, what I want to do for now is:</p>\n\n<ol>\n<li>Read the text file from the first line without asterics (*), aka the line beginning with number 1, to the end of the file</li>\n<li>When there is a \"blank space\" instead of \">sa0\" (6th column) put a @ on the variable. And put the next string on the next variable (aka fsa1) </li>\n<li>Print this to the user line by line.</li>\n</ol>\n\n<p>The code I have so far:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n#include &lt;sstream&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\nint main()\n{\n    string line, netlist;\n    int address, fout, fin;\n    string name, type, fsa0, fsa1;\n\n    cout &lt;&lt; \"Wich Netlist you want to use?\" &lt;&lt; endl;\n    cin &gt;&gt; netlist;\n\n    ifstream file(netlist.c_str());\n\n        if (file.is_open())\n        {\n             do{\n\n                getline(file, line);\n\n             } while ( line[0] == '*' );\n\n\n                file &gt;&gt; address &gt;&gt; name &gt;&gt; type &gt;&gt; fout &gt;&gt; fin &gt;&gt; fsa0;\n                if (fsa0 != \"&gt;sa0\") { fsa1 = fsa0; fsa0 = \"@\"; } else { file &gt;&gt; fsa1; }\n                cout &lt;&lt; address &lt;&lt;  \" \" &lt;&lt; name &lt;&lt; \" \" &lt;&lt; type &lt;&lt; \" \" &lt;&lt; fout &lt;&lt; \" \" &lt;&lt; fin &lt;&lt; \" \" &lt;&lt; fsa0 &lt;&lt; \" \" &lt;&lt; fsa1 &lt;&lt; endl;\n\n\n\n        } else { cout &lt;&lt; \"File not found\" &lt;&lt; endl; }\n\n             file.close();\n\n    return 0;\n}\n</code></pre>\n\n<p>Problems Found:</p>\n\n<ol>\n<li>Not showing the first line after the last line with astherisc.</li>\n<li>Not showing all the lines just the second one.</li>\n</ol>\n\n<p>Text File im trying to read:</p>\n\n<pre><code>*c17 iscas example (to test conversion program only)\n*---------------------------------------------------\n*\n*\n*  total number of lines in the netlist ..............    17\n*  simplistically reduced equivalent fault set size =     22\n*        lines from primary input  gates .......     5\n*        lines from primary output gates .......     2\n*        lines from interior gate outputs ......     4\n*        lines from **     3 ** fanout stems ...     6\n*\n*        avg_fanin  =  2.00,     max_fanin  =  2\n*        avg_fanout =  2.00,     max_fanout =  2\n*\n*\n*\n*\n*\n    1     1gat inpt    1   0      &gt;sa1\n    2     2gat inpt    1   0      &gt;sa1\n    3     3gat inpt    2   0 &gt;sa0 &gt;sa1\n    8     8fan from     3gat      &gt;sa1\n    9     9fan from     3gat      &gt;sa1\n    6     6gat inpt    1   0      &gt;sa1\n    7     7gat inpt    1   0      &gt;sa1\n   10    10gat nand    1   2      &gt;sa1\n     1     8\n   11    11gat nand    2   2 &gt;sa0 &gt;sa1\n     9     6\n   14    14fan from    11gat      &gt;sa1\n   15    15fan from    11gat      &gt;sa1\n   16    16gat nand    2   2 &gt;sa0 &gt;sa1\n     2    14\n   20    20fan from    16gat      &gt;sa1\n   21    21fan from    16gat      &gt;sa1\n   19    19gat nand    1   2      &gt;sa1\n    15     7\n   22    22gat nand    0   2 &gt;sa0 &gt;sa1\n    10    20\n   23    23gat nand    0   2 &gt;sa0 &gt;sa1\n    21    19\n</code></pre>\n\n<p>And, another thing, can you guys give me some tips on what to do with these lines only with two integers, like the last one? </p>\n\n<p>Thank you all. I appreciate all the help.</p>\n"}, {"tags": ["c++", "mfc"], "answers": [{"tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": true, "score": 1, "last_activity_date": 1432153016, "creation_date": 1432153016, "answer_id": 30359571, "question_id": 30359184, "link": "https://stackoverflow.com/questions/30359184/mfc-sdi-application-parse-custom-parameter/30359571#30359571", "title": "MFC SDI application parse custom parameter", "body": "<p>You have to derive a class from <code>CCommandLineInfo</code> and override its virtual function <a href=\"https://msdn.microsoft.com/en-us/library/bss6bxss.aspx\" rel=\"nofollow\"><code>ParseParam()</code></a> to define your own processing of the parameters.</p>\n\n<p>Here a <a href=\"http://www.codeproject.com/Questions/317374/how-to-pass-arguments-froma-program-to-a-mfc-based\" rel=\"nofollow\">demo</a> on how to do it.   </p>\n"}], "owner": {"reputation": 1163, "user_id": 3878945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/346dfffc2ad8e4db132d75c277ef3d1f?s=128&d=identicon&r=PG", "display_name": "Bigman", "link": "https://stackoverflow.com/users/3878945/bigman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "accepted_answer_id": 30359571, "answer_count": 1, "score": 1, "last_activity_date": 1432153016, "creation_date": 1432151638, "question_id": 30359184, "link": "https://stackoverflow.com/questions/30359184/mfc-sdi-application-parse-custom-parameter", "title": "MFC SDI application parse custom parameter", "body": "<p>I have a SDI application established in Visual Studio. I understood passing a file name to an application is fine like in the commandline: <code>MyApp.exe \"C:\\a.txt\"</code>. However it will not accept custom arguments or URLs. Say I cannot do <code>MyApp.exe \"SomethingILike\"</code> or <code>MyApp.exe \"www.google.com\"</code></p>\n\n<p>I understand the code to process arguments are in the <code>...App::InitInstance()</code> There are </p>\n\n<pre><code>CCommandLineInfo cmdInfo;\nParseCommandLine(cmdInfo);\n\nif (!ProcessShellCommand(cmdInfo))\n    return FALSE;\nm_pMainWnd-&gt;ShowWindow(SW_SHOW);\nm_pMainWnd-&gt;UpdateWindow();\n</code></pre>\n\n<p>Obviously the <code>ProcessShellCommand</code> rules out the arguments MFC does not think reasonable. How should I process my custom arguments? Say I want to pass \"SomethingILike\", now it tells me file-not-found and shuts off, but at least I want the application to start normally and I will have a chance to get </p>\n\n<pre><code>this-&gt;m_lpCmdLine\n</code></pre>\n\n<p>I cannot comment out the <code>ProcessShellCommand</code> if statement, otherwise it gives me an unhandled exception. Probably <code>ProcessShellCommand</code> does some initialization work too, which sounds not quite reasonable to me.</p>\n"}, {"tags": ["c++", "rotation", "tetris"], "comments": [{"owner": {"reputation": 4403, "user_id": 2201050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54a421b64c0fa2a710f5275f42133d7?s=128&d=identicon&r=PG", "display_name": "folkol", "link": "https://stackoverflow.com/users/2201050/folkol"}, "edited": false, "score": 1, "creation_date": 1432152423, "post_id": 30359180, "comment_id": 48810478, "body": "Check out <a href=\"http://stackoverflow.com/questions/42519/how-do-you-rotate-a-two-dimensional-array\" title=\"how do you rotate a two dimensional array\">stackoverflow.com/questions/42519/&hellip;</a>"}, {"owner": {"reputation": 17, "user_id": 4922037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc02ee5ce28b6926e4ce4fc1645c099d?s=128&d=identicon&r=PG&f=1", "display_name": "ThatCoderBryan", "link": "https://stackoverflow.com/users/4922037/thatcoderbryan"}, "reply_to_user": {"reputation": 4403, "user_id": 2201050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54a421b64c0fa2a710f5275f42133d7?s=128&d=identicon&r=PG", "display_name": "folkol", "link": "https://stackoverflow.com/users/2201050/folkol"}, "edited": false, "score": 0, "creation_date": 1432153090, "post_id": 30359180, "comment_id": 48810825, "body": "@folkol, what would be the best way in my case from your link?"}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "edited": false, "score": 0, "creation_date": 1432153596, "post_id": 30359180, "comment_id": 48811116, "body": "@ThatCoderBryan  what did you try so far ?"}, {"owner": {"reputation": 17, "user_id": 4922037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc02ee5ce28b6926e4ce4fc1645c099d?s=128&d=identicon&r=PG&f=1", "display_name": "ThatCoderBryan", "link": "https://stackoverflow.com/users/4922037/thatcoderbryan"}, "edited": false, "score": 0, "creation_date": 1432153972, "post_id": 30359180, "comment_id": 48811351, "body": "Nope, I got it! If you post that link as an answer and I vote it. Thank you:)"}], "owner": {"reputation": 17, "user_id": 4922037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc02ee5ce28b6926e4ce4fc1645c099d?s=128&d=identicon&r=PG&f=1", "display_name": "ThatCoderBryan", "link": "https://stackoverflow.com/users/4922037/thatcoderbryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "closed_date": 1432379147, "answer_count": 0, "score": 0, "last_activity_date": 1432374715, "creation_date": 1432151626, "last_edit_date": 1432374715, "question_id": 30359180, "link": "https://stackoverflow.com/questions/30359180/c-rotating-tetris-pieces", "closed_reason": "Duplicate", "title": "C++ Rotating Tetris Pieces", "body": "<p>In my program I am making the game Tetris! How could I rotate my char array piece? I know how to get the key syncs and everything. I could make each piece already rotated in the char, but is their an easier way? Here is my char array I'd use.</p>\n\n<pre><code>char block[4][5] = { \n      \"     \",\n      \" x   \",\n      \" xxx \", \n      \"     \", };\n</code></pre>\n"}, {"tags": ["c++", "while-loop", "int", "double"], "answers": [{"comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1432151527, "post_id": 30359147, "comment_id": 48809938, "body": "Unless you get a title loan with 120% interest."}, {"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "reply_to_user": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1432151556, "post_id": 30359147, "comment_id": 48809956, "body": "I suppose if you&#39;re borrowing money from loan sharks or the mafia, then the code might work closer to correct :D"}], "tags": [], "owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "is_accepted": true, "score": 1, "last_activity_date": 1432151491, "creation_date": 1432151491, "answer_id": 30359147, "question_id": 30359118, "link": "https://stackoverflow.com/questions/30359118/calculating-time-for-any-sum-to-double-at-a-given-rate-of-interest-compounded-a/30359147#30359147", "title": "Calculating time for any sum to double, at a given rate of interest compounded annually", "body": "<p><code>interest</code> is an <code>int</code> so this line</p>\n\n<pre><code>interest / 100\n</code></pre>\n\n<p>is doing integer division, and will always be <code>0</code>. The quick fix would be to change the literal so you are doing floating point math</p>\n\n<pre><code>sum += sum*(interest / 100.0);\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4880699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xWdXi.jpg?s=128&g=1", "display_name": "roredd", "link": "https://stackoverflow.com/users/4880699/roredd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 30359147, "answer_count": 1, "score": 1, "last_activity_date": 1432152443, "creation_date": 1432151423, "last_edit_date": 1432152443, "question_id": 30359118, "link": "https://stackoverflow.com/questions/30359118/calculating-time-for-any-sum-to-double-at-a-given-rate-of-interest-compounded-a", "title": "Calculating time for any sum to double, at a given rate of interest compounded annually", "body": "<p>I was trying to write a program that calculates the time it takes for any sum of money to double at a given rate of interest compounded annually.</p>\n\n<p>When I run this program, I have found that</p>\n\n<ul>\n<li>the loop is not exiting</li>\n<li>the counter is incremented endlessly</li>\n<li>with the sum stuck at 100 </li>\n</ul>\n\n<p>What am I doing wrong?</p>\n\n<pre><code>int main(){\n    cout &lt;&lt; \"Please enter the interest rate in % per annum:\";\n    int counter = 0;\n    int sum=100;\n    int interest = 0;\n    cin &gt;&gt; interest;\n    while(sum&lt;200){\n        counter++;\n        sum += sum*(interest / 100);\n        }\n    cout &lt;&lt; \"\\n It would take about \" &lt;&lt; counter &lt;&lt; \" years to double\";\n  }\n</code></pre>\n"}, {"tags": ["c++", "class", "templates"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1432151427, "post_id": 30359046, "comment_id": 48809873, "body": "And what is the exception?  And why are you calling <code>+=</code> from <code>+=</code>?"}, {"owner": {"reputation": 133, "user_id": 4540854, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0023b4fe2a8b6bebe1f3e62eedc00385?s=128&d=identicon&r=PG&f=1", "display_name": "VVG", "link": "https://stackoverflow.com/users/4540854/vvg"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1432151468, "post_id": 30359046, "comment_id": 48809907, "body": "Yes, sorry, I have edited the question"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1432151560, "post_id": 30359046, "comment_id": 48809959, "body": "So where is the actual <code>+=</code> stuff being done?  All you&#39;re doing is recursively calling <code>+=</code> from <code>+=</code>.  In other words, I see no code to do an actual addition."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1432151669, "post_id": 30359046, "comment_id": 48810026, "body": "Shouldn&#39;t it be <code>a += i</code>?  Also <code>a</code> should be <code>one a;</code> not <code>int a</code>"}], "answers": [{"comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1432151687, "post_id": 30359170, "comment_id": 48810039, "body": "Actually, it is better to implement the low-level code in <code>operator +=</code>, not <code>operator +</code>, and let <code>operator +</code> call <code>operator +=</code>."}, {"owner": {"reputation": 3004, "user_id": 1359034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e97eaac4d6ba8f0c3f95900f02b45b42?s=128&d=identicon&r=PG", "display_name": "dwcanillas", "link": "https://stackoverflow.com/users/1359034/dwcanillas"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1432151744, "post_id": 30359170, "comment_id": 48810079, "body": "@PaulMcKenzie cool, good to know.  I&#39;ll edit to be a little more clear about that."}], "tags": [], "owner": {"reputation": 3004, "user_id": 1359034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e97eaac4d6ba8f0c3f95900f02b45b42?s=128&d=identicon&r=PG", "display_name": "dwcanillas", "link": "https://stackoverflow.com/users/1359034/dwcanillas"}, "is_accepted": true, "score": 1, "last_activity_date": 1432152138, "last_edit_date": 1432152138, "creation_date": 1432151575, "answer_id": 30359170, "question_id": 30359046, "link": "https://stackoverflow.com/questions/30359046/unhandled-exception-operator-overloading/30359170#30359170", "title": "Unhandled exception operator overloading", "body": "<p>Your function calls itself recursively with no condition to exit:</p>\n\n<pre><code>template &lt;class one&gt;\ncalc&lt;one&gt;&amp; calc &lt;one&gt; :: operator += (const one&amp; i) {\n    *this += i;\n    //    ^calls the function youre currently in.\n    return *this;\n}\n</code></pre>\n\n<p>You need to adjust your <code>+=</code> operator to use the <code>+</code> operator that you've defined, or as @PaulMcKenzie stated, do the actual addition in <code>+=</code> and have <code>+</code> use <code>+=</code>. For example,</p>\n\n<pre><code>template &lt;class one&gt;\ncalc&lt;one&gt;&amp; calc &lt;one&gt; :: operator += (const one&amp; i) {\n    a += i;\n    return *this;\n}\n</code></pre>\n\n<p>seems to work.</p>\n\n<p>You can see a warning about this if your warning level is high enough:</p>\n\n<blockquote>\n  <p>Warning    1   warning C4717: 'calc::operator+=' : recursive on all control paths, function will cause runtime stack overflow</p>\n</blockquote>\n\n<p>That being said, there are some other problems with your code, like <code>int a</code> should be <code>one a</code> and </p>\n\n<pre><code>friend const calc operator + (const calc&amp; our, const calc&amp; other);\n</code></pre>\n\n<p>should just be a normal <code>+</code> operator instead of a friend.</p>\n"}], "owner": {"reputation": 133, "user_id": 4540854, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0023b4fe2a8b6bebe1f3e62eedc00385?s=128&d=identicon&r=PG&f=1", "display_name": "VVG", "link": "https://stackoverflow.com/users/4540854/vvg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 1, "accepted_answer_id": 30359170, "answer_count": 1, "score": -5, "last_activity_date": 1432152138, "creation_date": 1432151161, "last_edit_date": 1432151452, "question_id": 30359046, "link": "https://stackoverflow.com/questions/30359046/unhandled-exception-operator-overloading", "title": "Unhandled exception operator overloading", "body": "<p>I am practicing with operator overloading and have built a simple calculator. </p>\n\n<pre><code>template &lt;class one&gt; class calc {\n    int a;\npublic:\n    calc() : a(0) {};\n    calc(const calc&amp; other) : a(other.a) {}\n    void print() { cout &lt;&lt; a; }\n    calc&amp; operator += (const calc&amp; other);\n    calc&amp; operator += (const one&amp; i);\n    calc&amp; operator -= (const calc&amp; other);\n    calc&amp; operator -= (const one&amp; i);\n    calc&amp; operator *= (const calc&amp; other);\n    calc&amp; operator *= (const one&amp; i);\n    calc&amp; operator /= (const calc&amp; other);\n    calc&amp; operator /= (const one&amp; i);\n    const calc&amp; operator - () const;\n    friend const calc operator + (const calc&amp; our, const calc&amp; other);\n    friend const calc operator + (const one&amp; i, const calc&amp; other);\n    friend const calc operator + (const calc&amp; our, const one&amp; i);\n }; \n</code></pre>\n\n<p>But unfortunately, when I try to implement the class, it throws the exception:</p>\n\n<blockquote>\n  <p>Unhandled exception at 0x010154C9 in Proctical programming c++\n  overloading 1.exe: 0xC00000FD: Stack overflow (parameters: 0x00000001,\n  0x00192F64).</p>\n</blockquote>\n\n<p>Here is the <code>main</code>:</p>\n\n<pre><code>int main() {\n    calc &lt;int&gt; one;\n    one += 2;\n    one.print();\n    cin.get();\n}\n</code></pre>\n\n<p>And the problem occurs, for example, here but consequently also in other operators:</p>\n\n<pre><code>template &lt;class one&gt;\ncalc&lt;one&gt;&amp; calc &lt;one&gt; :: operator += (const one&amp; i) {\n    *this += i;\n    return *this;\n}\n</code></pre>\n\n<p>Could you, please, hint me at what I am doing wrong?</p>\n"}, {"tags": ["c++", "oop", "friend"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1432151158, "post_id": 30358913, "comment_id": 48809712, "body": "How does the code execute properly with the error &quot;C2::status is inaccessible&quot;?"}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "edited": false, "score": 0, "creation_date": 1432151158, "post_id": 30358913, "comment_id": 48809713, "body": "How can you use C2 in the definition of class C1 ?"}, {"owner": {"reputation": 191, "user_id": 4698374, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5af89c7e278ace61a0e3aa79222b489f?s=128&d=identicon&r=PG&f=1", "display_name": "GandalfDGrey", "link": "https://stackoverflow.com/users/4698374/gandalfdgrey"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1432182063, "post_id": 30358913, "comment_id": 48820157, "body": "@EdHeal Yes, I have no idea! Actually it should  be accessible.  Christophe - Its only being used as a parameter. That is why I had to use forward declaration."}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 4698374, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5af89c7e278ace61a0e3aa79222b489f?s=128&d=identicon&r=PG&f=1", "display_name": "GandalfDGrey", "link": "https://stackoverflow.com/users/4698374/gandalfdgrey"}, "edited": false, "score": 0, "creation_date": 1432198993, "post_id": 30359171, "comment_id": 48828682, "body": "Hi, I wrote the same thing in main. I have not included the whole code in the question :)"}], "tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": false, "score": 6, "last_activity_date": 1432151583, "creation_date": 1432151583, "answer_id": 30359171, "question_id": 30358913, "link": "https://stackoverflow.com/questions/30358913/accessibility-of-a-friend-function/30359171#30359171", "title": "Accessibility of a friend function", "body": "<p>It sounds to me like the compiler (or part of a compiler) used by your IDE has a problem. I added enough to your code to get a complete program:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\n\nclass C2;   //Forward Declaration\n\nclass C1\n{\n    int status;\n\npublic:\n    void set_status(int state);\n    void get_status(C2 y);\n};\n\nclass C2\n{\n    int status;\n\npublic:\n    void set_status(int state);\n    friend void C1::get_status(C2);\n};\n\n//Function Definitions\n\nvoid C1::set_status(int state) {\n    status = state;\n}\n\nvoid C2::set_status(int state) {\n    status = state;\n}\n\nvoid C1::get_status(C2 y)   //Member function of C1\n{\n    if (y.status | status)\n        cout &lt;&lt; \" PRINT \" &lt;&lt; endl;\n}\n\nint main() {\n\n    C1 c;\n    C2 d;\n    d.set_status(1);\n\n    c.get_status(d);\n}\n</code></pre>\n\n<p>This compiled (without errors or warnings, at with default flags) with g++ 4.9 and VC++ 12 (aka VC++ 2013). Both produced: <code>PRINT</code> as output.</p>\n\n<p>It's pretty common for an IDE to parse the source code separately from the actual compiler, and some of them are fairly limited compared to real compilers, so I guess it's not terribly surprising that they get confused about some things.</p>\n"}], "owner": {"reputation": 191, "user_id": 4698374, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5af89c7e278ace61a0e3aa79222b489f?s=128&d=identicon&r=PG&f=1", "display_name": "GandalfDGrey", "link": "https://stackoverflow.com/users/4698374/gandalfdgrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1432152282, "creation_date": 1432150704, "last_edit_date": 1432151725, "question_id": 30358913, "link": "https://stackoverflow.com/questions/30358913/accessibility-of-a-friend-function", "title": "Accessibility of a friend function", "body": "<pre><code>class C2;   //Forward Declaration\n\nclass C1\n{\n    int status;\n\n    public:\n    void set_status(int state);\n    void get_status(C2 y);\n};\n\nclass C2\n{\n    int status;\n\n    public:\n    void set_status(int state);\n    friend void C1::get_status(C2 y);\n};\n\n//Function Definitions\n\nvoid C1::set_status(int state)\n{\n    status = state;\n}\n\nvoid C2::set_status(int state)\n{\n    status = state;\n}\n\nvoid C1::get_status(C2 y)   //Member function of C1\n{\n    if (y.status | status)\n    cout&lt;&lt;\" PRINT \" &lt;&lt;endl;\n}\n</code></pre>\n\n<p><code>y.status</code> in the second last line displays an error:</p>\n\n<blockquote>\n  <p>C2::status is inaccessible</p>\n</blockquote>\n\n<p>The code executes properly, but there is a red line (error) under <code>y.status</code>.</p>\n\n<p>Why is this?</p>\n"}, {"tags": ["c++", "opencv", "tesseract", "opencv3.0"], "comments": [{"owner": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "edited": false, "score": 1, "creation_date": 1432150944, "post_id": 30358879, "comment_id": 48809598, "body": "Post the full error trace."}, {"owner": {"reputation": 4489, "user_id": 1620040, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/LL4tz.jpg?s=128&g=1", "display_name": "Lakshmi Narayanan", "link": "https://stackoverflow.com/users/1620040/lakshmi-narayanan"}, "reply_to_user": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "edited": false, "score": 0, "creation_date": 1432178701, "post_id": 30358879, "comment_id": 48819174, "body": "please check the update @rayryeng"}], "answers": [{"comments": [{"owner": {"reputation": 4489, "user_id": 1620040, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/LL4tz.jpg?s=128&g=1", "display_name": "Lakshmi Narayanan", "link": "https://stackoverflow.com/users/1620040/lakshmi-narayanan"}, "edited": false, "score": 0, "creation_date": 1432179045, "post_id": 30360151, "comment_id": 48819273, "body": "This error is slightly different, cuz it is the linking issues with opencv_contrib. Please correct me if am wrong. I included the extra modules and then I recompiled. However, the header files of the extra modules did not add on to the &quot;/usr/include&quot; or &quot;/usr/local/include&quot;, which I added manually. Please check the opencv_contrib of opencv3.0 for compiling instructions."}, {"owner": {"reputation": 3135, "user_id": 2648754, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/UWGAJ.png?s=128&g=1", "display_name": "a_pradhan", "link": "https://stackoverflow.com/users/2648754/a-pradhan"}, "reply_to_user": {"reputation": 4489, "user_id": 1620040, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/LL4tz.jpg?s=128&g=1", "display_name": "Lakshmi Narayanan", "link": "https://stackoverflow.com/users/1620040/lakshmi-narayanan"}, "edited": false, "score": 0, "creation_date": 1432227063, "post_id": 30360151, "comment_id": 48848884, "body": "After compiling the libraries from source, use <code>sudo ldconfig</code> and then issue the <code>g++</code> command to compile."}], "tags": [], "owner": {"reputation": 3135, "user_id": 2648754, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/UWGAJ.png?s=128&g=1", "display_name": "a_pradhan", "link": "https://stackoverflow.com/users/2648754/a-pradhan"}, "is_accepted": false, "score": 1, "last_activity_date": 1432155122, "last_edit_date": 1495535215, "creation_date": 1432155122, "answer_id": 30360151, "question_id": 30358879, "link": "https://stackoverflow.com/questions/30358879/opencv-tesseract-undefined-reference-error/30360151#30360151", "title": "opencv tesseract undefined reference error", "body": "<p>It is a linker error. Look at an existing answer <a href=\"https://stackoverflow.com/a/26528024/2648754\">here</a></p>\n\n<p>You need to compile it as <code>g++ -o output input.cpp pkg-config opencv --cflags --libs</code> if you are on Linux.</p>\n\n<p>However if you have compiled OpenCV from source on Linux, use <code>ldconfig</code> to avoid linking issues.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 670895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0abcc67c528e601aa7dadef5d4e13ff?s=128&d=identicon&r=PG", "display_name": "Baltazor", "link": "https://stackoverflow.com/users/670895/baltazor"}, "is_accepted": false, "score": 0, "last_activity_date": 1536431324, "creation_date": 1536431324, "answer_id": 52238223, "question_id": 30358879, "link": "https://stackoverflow.com/questions/30358879/opencv-tesseract-undefined-reference-error/52238223#52238223", "title": "opencv tesseract undefined reference error", "body": "<p>You should use library -lopencv_text</p>\n\n<pre><code>LIBS += -lopencv_text\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>g++ -o output input.cpp -lopencv_text\n</code></pre>\n"}], "owner": {"reputation": 4489, "user_id": 1620040, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/LL4tz.jpg?s=128&g=1", "display_name": "Lakshmi Narayanan", "link": "https://stackoverflow.com/users/1620040/lakshmi-narayanan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1080, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1536431324, "creation_date": 1432150582, "last_edit_date": 1432178684, "question_id": 30358879, "link": "https://stackoverflow.com/questions/30358879/opencv-tesseract-undefined-reference-error", "title": "opencv tesseract undefined reference error", "body": "<p>I am trying to test tesseract from opencv 3.0 using the test code from <a href=\"https://github.com/Itseez/opencv_contrib/blob/master/modules/text/samples/end_to_end_recognition.cpp\" rel=\"nofollow\">here</a></p>\n\n<p>However, when I try to compile it, I get the following error</p>\n\n<pre><code>     undefined reference to `cv::text::loadClassifierNM1(std::string const&amp;)'\n</code></pre>\n\n<p>Any idea how I can fix this? Your help is much appreciated.</p>\n\n<p><strong>UPDATE 1</strong></p>\n\n<p>The complete error is</p>\n\n<pre><code>    CMakeFiles/text_recog.dir/text_recog.o: In function `main':\n    text_recog.cpp:(.text+0x37b): undefined reference to `cv::text::loadClassifierNM1(std::string const&amp;)'\n    text_recog.cpp:(.text+0x3bb): undefined reference to `cv::text::createERFilterNM1(cv::Ptr&lt;cv::text::ERFilter::Callback&gt; const&amp;, int, float, float, float, bool, float)'\n    text_recog.cpp:(.text+0x42b): undefined reference to `cv::text::loadClassifierNM2(std::string const&amp;)'\n    text_recog.cpp:(.text+0x44c): undefined reference to `cv::text::createERFilterNM2(cv::Ptr&lt;cv::text::ERFilter::Callback&gt; const&amp;, float)'\n    text_recog.cpp:(.text+0x9c1): undefined reference to `cv::text::erGrouping(cv::_InputArray const&amp;, cv::_InputArray const&amp;, std::vector&lt;std::vector&lt;cv::text::ERStat, std::allocator&lt;cv::text::ERStat&gt; &gt;, std::allocator&lt;std::vector&lt;cv::text::ERStat, std::allocator&lt;cv::text::ERStat&gt; &gt; &gt; &gt;&amp;, std::vector&lt;std::vector&lt;cv::Vec&lt;int, 2&gt;, std::allocator&lt;cv::Vec&lt;int, 2&gt; &gt; &gt;, std::allocator&lt;std::vector&lt;cv::Vec&lt;int, 2&gt;, std::allocator&lt;cv::Vec&lt;int, 2&gt; &gt; &gt; &gt; &gt;&amp;, std::vector&lt;cv::Rect_&lt;int&gt;, std::allocator&lt;cv::Rect_&lt;int&gt; &gt; &gt;&amp;, int, std::string const&amp;, float)'\n    text_recog.cpp:(.text+0xa95): undefined reference to `cv::text::OCRTesseract::create(char const*, char const*, char const*, int, int)'\n    collect2: error: ld returned 1 exit status\n    make[2]: *** [text_recog] Error 1\n    make[1]: *** [CMakeFiles/text_recog.dir/all] Error 2\n    make: *** [all] Error 2\n</code></pre>\n\n<p>Does this help ?</p>\n"}, {"tags": ["c++", "node.js", "v8", "node.js-addon"], "answers": [{"comments": [{"owner": {"reputation": 5251, "user_id": 551436, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9f3ca1db737cdb15bbded04d021da48a?s=128&d=identicon&r=PG", "display_name": "arthurakay", "link": "https://stackoverflow.com/users/551436/arthurakay"}, "edited": false, "score": 0, "creation_date": 1432151678, "post_id": 30359168, "comment_id": 48810032, "body": "Gah, yes I have to get the user&#39;s home directory using <code>getpwuid(getuid())</code> and then parse <code>pw_dir</code> from the structure."}], "tags": [], "owner": {"reputation": 2326, "user_id": 925782, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9c7511f7066d571cc62d19475eda6a18?s=128&d=identicon&r=PG", "display_name": "Mitchell Simoens", "link": "https://stackoverflow.com/users/925782/mitchell-simoens"}, "is_accepted": true, "score": 1, "last_activity_date": 1432151559, "creation_date": 1432151559, "answer_id": 30359168, "question_id": 30358836, "link": "https://stackoverflow.com/questions/30358836/ofstream-not-creating-file-node-js-addon/30359168#30359168", "title": "ofstream not creating file (Node.js addon)", "body": "<p>I think the issue is that you need to find out the user directory in a different way than using <code>~</code>.</p>\n"}], "owner": {"reputation": 5251, "user_id": 551436, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9f3ca1db737cdb15bbded04d021da48a?s=128&d=identicon&r=PG", "display_name": "arthurakay", "link": "https://stackoverflow.com/users/551436/arthurakay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 30359168, "answer_count": 1, "score": 1, "last_activity_date": 1474612685, "creation_date": 1432150458, "last_edit_date": 1474612685, "question_id": 30358836, "link": "https://stackoverflow.com/questions/30358836/ofstream-not-creating-file-node-js-addon", "title": "ofstream not creating file (Node.js addon)", "body": "<p>I am attempting to create an <a href=\"https://nodejs.org/api/addons.html\" rel=\"nofollow\">addon for Node.js</a> that (among other things) writes content to a file inside my C++ class using <code>ofstream</code>.</p>\n\n<pre><code>std::ofstream license_file;\n\nstd::string fileContent(*NanAsciiString(args[0]));\n\nlicense_file.open(PATH);\n\n//file doesn't yet exist, so create it\nif(!license_file) {\n    printf(\"ERROR: %s (%s)\\n\", strerror(errno), PATH);\n}\n\nlicense_file &lt;&lt;  fileContent;\nlicense_file.close();\n</code></pre>\n\n<p>This works fine if <code>PATH</code> is set to the same directory as my Node.js code (e.g. <code>./license.txt</code>).</p>\n\n<p><strong>However, <code>ofstream</code> fails to open/create the file in question if it is located anywhere else. For example, using <code>~/license.txt</code> does not work (note: I'm running OSX).</strong></p>\n\n<p>The error reported is always <code>No such file or directory</code> -- even after I physically create <code>~/license.txt</code>.</p>\n\n<p>Any ideas why this works in one directory but not others? If it were a permissions issue I would expect a different error message.</p>\n\n<p>For the record, I've seen about 20 other SO questions about \"ofstream fails to create file\" but passing additional flags into <code>open()</code> has no effect. I have a feeling this is somehow related to running inside Node/V8.</p>\n"}, {"tags": ["python", "c++", "dll", "code-injection", "cpython"], "answers": [{"tags": [], "owner": {"reputation": 423, "user_id": 1924602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/9OwzG.jpg?s=128&g=1", "display_name": "otc", "link": "https://stackoverflow.com/users/1924602/otc"}, "is_accepted": false, "score": 0, "last_activity_date": 1479315494, "last_edit_date": 1479315494, "creation_date": 1432151720, "answer_id": 30359205, "question_id": 30358740, "link": "https://stackoverflow.com/questions/30358740/release-the-python-import-lock-from-a-thread-you-do-not-control-do-not-have-ac/30359205#30359205", "title": "Release the Python import lock from a thread you do not control &amp; do not have access to", "body": "<p>Fixed. Use</p>\n\n<pre><code>_PyImport_ReInitLock(void)\n</code></pre>\n\n<p>before importing</p>\n"}], "owner": {"reputation": 423, "user_id": 1924602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/9OwzG.jpg?s=128&g=1", "display_name": "otc", "link": "https://stackoverflow.com/users/1924602/otc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479315542, "creation_date": 1432150132, "last_edit_date": 1479315542, "question_id": 30358740, "link": "https://stackoverflow.com/questions/30358740/release-the-python-import-lock-from-a-thread-you-do-not-control-do-not-have-ac", "title": "Release the Python import lock from a thread you do not control &amp; do not have access to", "body": "<p>So, I'm injecting a DLL into a Cython application in order to extend its functionality. I am doing this using the following code:\nNote: using Python 2.7; uses the old ModuleNoBlock scheme</p>\n\n<pre><code>PyGILState_STATE sMain = PyGILState_Ensure();\nPyObject* mHook = PyImport_ImportModuleNoBlock(\"hookmodule\");\nPyGILState_Release(sMain);\n</code></pre>\n\n<p>Now, when I inject the DLL into the application and print errors, I get the following:</p>\n\n<pre><code>ImportError: Failed to import hookmodule because the import lockis held by another thread. \n</code></pre>\n\n<p>I found the source to the imp module <a href=\"http://svn.python.org/projects/python/trunk/Python/import.c\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>However <code>_PyImport_ReleaseLock(void)</code> only releases the lock if you call it from the same thread where the lock was acquired.</p>\n\n<p>Is it possible to do this?</p>\n"}, {"tags": ["c++", "quickfix"], "comments": [{"owner": {"reputation": 2912, "user_id": 1274223, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/uGq26.jpg?s=128&g=1", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/1274223/alejandro"}, "edited": false, "score": 1, "creation_date": 1432150384, "post_id": 30358675, "comment_id": 48809311, "body": "Try adding the <code>-std=c++11</code> or <code>-std=c++14</code> switch. Could be because of the <code>shared_ptr</code>"}, {"owner": {"reputation": 1152, "user_id": 4541974, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152538725216326/picture?type=large", "display_name": "Luis Cruz", "link": "https://stackoverflow.com/users/4541974/luis-cruz"}, "reply_to_user": {"reputation": 2912, "user_id": 1274223, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/uGq26.jpg?s=128&g=1", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/1274223/alejandro"}, "edited": false, "score": 0, "creation_date": 1432150824, "post_id": 30358675, "comment_id": 48809542, "body": "Most of the errors are gone using C++11 :) however, I still get &quot;\u2018MyApplication\u2019 was not declared in this scope&quot;. o.O"}, {"owner": {"reputation": 2912, "user_id": 1274223, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/uGq26.jpg?s=128&g=1", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/1274223/alejandro"}, "edited": false, "score": 0, "creation_date": 1432151142, "post_id": 30358675, "comment_id": 48809698, "body": "I don&#39;t see your definition of <code>MyApplication</code> in the code you provided. Is it in a different file? If so, don&#39;t forget to include the header."}, {"owner": {"reputation": 2912, "user_id": 1274223, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/uGq26.jpg?s=128&g=1", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/1274223/alejandro"}, "edited": false, "score": 0, "creation_date": 1432153602, "post_id": 30358675, "comment_id": 48811121, "body": "based upon the other uses of classes, could it perhaps be <code>FIX::MyApplication</code>?"}, {"owner": {"reputation": 1152, "user_id": 4541974, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152538725216326/picture?type=large", "display_name": "Luis Cruz", "link": "https://stackoverflow.com/users/4541974/luis-cruz"}, "reply_to_user": {"reputation": 2912, "user_id": 1274223, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/uGq26.jpg?s=128&g=1", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/1274223/alejandro"}, "edited": false, "score": 0, "creation_date": 1432153868, "post_id": 30358675, "comment_id": 48811290, "body": "Tried that but it didn&#39;t work. You&#39;re right about Myapplication... Not sure where it&#39;s located. I downloaded the sample code of their documentation so I assumed it would work right away..."}, {"owner": {"reputation": 401, "user_id": 5551849, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/NssaZ.jpg?s=128&g=1", "display_name": "p.luck", "link": "https://stackoverflow.com/users/5551849/p-luck"}, "edited": false, "score": 0, "creation_date": 1595935179, "post_id": 30358675, "comment_id": 111639490, "body": "Did you manage to solve this? I am currently getting the same error"}], "answers": [{"tags": [], "owner": {"reputation": 603, "user_id": 6016071, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYAFA.jpg?s=128&g=1", "display_name": "JimmyNJ", "link": "https://stackoverflow.com/users/6016071/jimmynj"}, "is_accepted": false, "score": 0, "last_activity_date": 1490618207, "creation_date": 1490618207, "answer_id": 43046669, "question_id": 30358675, "link": "https://stackoverflow.com/questions/30358675/compiling-a-quickfix-program/43046669#43046669", "title": "Compiling a quickfix program", "body": "<p>You need to provide an implementation of the <code>MyApplication</code> class and compile with the appropriate C++11 flags.</p>\n\n<p>Your <code>MyApplication</code> object typically needs to derive from the <code>FIX::Application</code> class which is a pure virtual class and will require you to implement a series of methods such as <code>onLogon(...)</code> and <code>toApp(...)</code></p>\n\n<p>If you want to just get your code to compile as a first step you can try using the <code>FIX::NullApplication</code> class (defined in quickfix/Application.h) as your starting application object.</p>\n"}, {"tags": [], "owner": {"reputation": 311, "user_id": 6859187, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eDc2g.gif?s=128&g=1", "display_name": "Lefteris Eleftheriades", "link": "https://stackoverflow.com/users/6859187/lefteris-eleftheriades"}, "is_accepted": false, "score": 0, "last_activity_date": 1568972438, "creation_date": 1568972438, "answer_id": 58025805, "question_id": 30358675, "link": "https://stackoverflow.com/questions/30358675/compiling-a-quickfix-program/58025805#58025805", "title": "Compiling a quickfix program", "body": "<p>The quickfix library must be compiled with this pre-processor directive <code>HAVE_STD_UNIQUE_PTR</code></p>\n\n<p>Your application must provide an implementation for the MyApplication class and that implementation must inherit from FIX::Application</p>\n"}], "owner": {"reputation": 1152, "user_id": 4541974, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152538725216326/picture?type=large", "display_name": "Luis Cruz", "link": "https://stackoverflow.com/users/4541974/luis-cruz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1313, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1568972438, "creation_date": 1432149921, "question_id": 30358675, "link": "https://stackoverflow.com/questions/30358675/compiling-a-quickfix-program", "title": "Compiling a quickfix program", "body": "<p>I am trying to use the quickfix library to connect to a broker using the FIX protocol. I just built the library using the documentation they provide and use their sample code right now </p>\n\n<pre><code>#include \"quickfix/FileStore.h\"\n#include \"quickfix/FileLog.h\"\n#include \"quickfix/SocketAcceptor.h\"\n#include \"quickfix/Session.h\"\n#include \"quickfix/SessionSettings.h\"\n#include \"quickfix/Application.h\"\n\nint main( int argc, char** argv )\n{\n  try\n  {\n    if(argc &lt; 2) return 1;\n    std::string fileName = argv[1];\n\n    FIX::SessionSettings settings(fileName);\n\n    MyApplication application;\n    FIX::FileStoreFactory storeFactory(settings);\n    FIX::FileLogFactory logFactory(settings);\n    FIX::SocketAcceptor acceptor\n      (application, storeFactory, settings, logFactory /*optional*/);\n    acceptor.start();\n    // while( condition == true ) { do something; }\n    acceptor.stop();\n    return 0;\n  }\n  catch(FIX::ConfigError&amp; e)\n  {\n    std::cout &lt;&lt; e.what();\n    return 1;\n  }\n}\n</code></pre>\n\n<p>However, when I try to compile it with:</p>\n\n<pre><code>g++ fix.cpp -fexceptions -finline-functions -lquickfix -lpthread -lxml2\n</code></pre>\n\n<p>I get a bunch of errors:</p>\n\n<pre><code>In file included from /usr/local/include/quickfix/Session.h:34:0,\n                 from fix.cpp:6:\n/usr/local/include/quickfix/DataDictionaryProvider.h:54:72: error: \u2018ptr::shared_ptr\u2019 has not been declared\n   void addTransportDataDictionary(const BeginString&amp; beginString, ptr::shared_ptr&lt;DataDictionary&gt;);\n                                                                        ^\n/usr/local/include/quickfix/DataDictionaryProvider.h:54:82: error: expected \u2018,\u2019 or \u2018...\u2019 before \u2018&lt;\u2019 token\n   void addTransportDataDictionary(const BeginString&amp; beginString, ptr::shared_ptr&lt;DataDictionary&gt;);\n                                                                                  ^\n/usr/local/include/quickfix/DataDictionaryProvider.h:55:70: error: \u2018ptr::shared_ptr\u2019 has not been declared\n   void addApplicationDataDictionary(const ApplVerID&amp; applVerID, ptr::shared_ptr&lt;DataDictionary&gt;);\n                                                                      ^\n/usr/local/include/quickfix/DataDictionaryProvider.h:55:80: error: expected \u2018,\u2019 or \u2018...\u2019 before \u2018&lt;\u2019 token\n   void addApplicationDataDictionary(const ApplVerID&amp; applVerID, ptr::shared_ptr&lt;DataDictionary&gt;);\n                                                                                ^\n/usr/local/include/quickfix/DataDictionaryProvider.h:63:25: error: \u2018shared_ptr\u2019 is not a member of \u2018ptr\u2019\n   std::map&lt;std::string, ptr::shared_ptr&lt;DataDictionary&gt; &gt; m_transportDictionaries;\n                         ^\n/usr/local/include/quickfix/DataDictionaryProvider.h:63:25: error: \u2018shared_ptr\u2019 is not a member of \u2018ptr\u2019\n/usr/local/include/quickfix/DataDictionaryProvider.h:63:55: error: template argument 2 is invalid\n   std::map&lt;std::string, ptr::shared_ptr&lt;DataDictionary&gt; &gt; m_transportDictionaries;\n                                                       ^\n/usr/local/include/quickfix/DataDictionaryProvider.h:63:55: error: template argument 4 is invalid\n/usr/local/include/quickfix/DataDictionaryProvider.h:63:57: error: expected unqualified-id before \u2018&gt;\u2019 token\n   std::map&lt;std::string, ptr::shared_ptr&lt;DataDictionary&gt; &gt; m_transportDictionaries;\n                                                         ^\n/usr/local/include/quickfix/DataDictionaryProvider.h:64:25: error: \u2018shared_ptr\u2019 is not a member of \u2018ptr\u2019\n   std::map&lt;std::string, ptr::shared_ptr&lt;DataDictionary&gt; &gt; m_applicationDictionaries;\n                         ^\n/usr/local/include/quickfix/DataDictionaryProvider.h:64:25: error: \u2018shared_ptr\u2019 is not a member of \u2018ptr\u2019\n/usr/local/include/quickfix/DataDictionaryProvider.h:64:55: error: template argument 2 is invalid\n   std::map&lt;std::string, ptr::shared_ptr&lt;DataDictionary&gt; &gt; m_applicationDictionaries;\n                                                       ^\n/usr/local/include/quickfix/DataDictionaryProvider.h:64:55: error: template argument 4 is invalid\n/usr/local/include/quickfix/DataDictionaryProvider.h:64:57: error: expected unqualified-id before \u2018&gt;\u2019 token\n   std::map&lt;std::string, ptr::shared_ptr&lt;DataDictionary&gt; &gt; m_applicationDictionaries;\n                                                         ^\n/usr/local/include/quickfix/DataDictionaryProvider.h: In member function \u2018void FIX::DataDictionaryProvider::addTransportDataDictionary(const FIX::BeginString&amp;, const string&amp;)\u2019:\n/usr/local/include/quickfix/DataDictionaryProvider.h:58:45: error: \u2018shared_ptr\u2019 is not a member of \u2018ptr\u2019\n   { addTransportDataDictionary(beginString, ptr::shared_ptr&lt;DataDictionary&gt;( new DataDictionary(path) )); }\n                                             ^\n/usr/local/include/quickfix/DataDictionaryProvider.h:58:75: error: expected primary-expression before \u2018&gt;\u2019 token\n   { addTransportDataDictionary(beginString, ptr::shared_ptr&lt;DataDictionary&gt;( new DataDictionary(path) )); }\n                                                                           ^\n/usr/local/include/quickfix/DataDictionaryProvider.h: In member function \u2018void FIX::DataDictionaryProvider::addApplicationDataDictionary(const FIX::ApplVerID&amp;, const string&amp;)\u2019:\n/usr/local/include/quickfix/DataDictionaryProvider.h:60:45: error: \u2018shared_ptr\u2019 is not a member of \u2018ptr\u2019\n   { addApplicationDataDictionary(applVerID, ptr::shared_ptr&lt;DataDictionary&gt;( new DataDictionary(path) )); }\n                                             ^\n/usr/local/include/quickfix/DataDictionaryProvider.h:60:75: error: expected primary-expression before \u2018&gt;\u2019 token\n   { addApplicationDataDictionary(applVerID, ptr::shared_ptr&lt;DataDictionary&gt;( new DataDictionary(path) )); }\n                                                                           ^\nfix.cpp: In function \u2018int main(int, char**)\u2019:\nfix.cpp:19:5: error: \u2018MyApplication\u2019 was not declared in this scope\n     MyApplication application;\n     ^\nfix.cpp:19:19: error: expected \u2018;\u2019 before \u2018application\u2019\n     MyApplication application;\n                   ^\nfix.cpp:23:8: error: \u2018application\u2019 was not declared in this scope\n       (application, storeFactory, settings, logFactory /*optional*/);\n        ^\nroot@luis:/home/luis/tradingbot/bot4#     In file included from /usr/local/include/quickfix/Session.h:34:0,\nIn: command not found\nroot@luis:/home/luis/tradingbot/bot4#                      from fix.cpp:6:\nfrom: can't read /var/mail/fix.cpp:6:\nroot@luis:/home/luis/tradingbot/bot4#     /usr/local/include/quickfix/DataDictionaryProvider.h:54:72: error: \u2018ptr::shared_ptr\u2019 has not been declared\nbash: /usr/local/include/quickfix/DataDictionaryProvider.h:54:72:: No such file or directory\nroot@luis:/home/luis/tradingbot/bot4#        void addTransportDataDictionary(const BeginString&amp; beginString, ptr::shared_ptr&lt;DataDictionary&gt;);\nbash: syntax error near unexpected token `('\nroot@luis:/home/luis/tradingbot/bot4#                                                                             ^\n^: command not found\nroot@luis:/home/luis/tradingbot/bot4#     /usr/local/include/quickfix/DataDictionaryProvider.h:54:82: error: expected \u2018,\u2019 or \u2018...\u2019 before \u2018&lt;\u2019 token\nbash: \u2019: No such file or directory\nroot@luis:/home/luis/tradingbot/bot4#        void addTransportDataDictionary(const BeginString&amp; beginString, ptr::shared_ptr&lt;DataDictionary&gt;);\nbash: syntax error near unexpected token `('\nroot@luis:/home/luis/tradingbot/bot4#                                                                                       ^\n^: command not found\nroot@luis:/home/luis/tradingbot/bot4#     /usr/local/include/quickfix/DataDictionaryProvider.h:55:70: error: \u2018ptr::shared_ptr\u2019 has not been declared\nbash: /usr/local/include/quickfix/DataDictionaryProvider.h:55:70:: No such file or directory\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c++", "parsing", "stringstream"], "comments": [{"owner": {"reputation": 9113, "user_id": 2097780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db5b03704c129196a4e9415e55413ce6?s=128&d=identicon&r=PG", "display_name": "kirbyfan64sos", "link": "https://stackoverflow.com/users/2097780/kirbyfan64sos"}, "edited": false, "score": 0, "creation_date": 1432150180, "post_id": 30358606, "comment_id": 48809194, "body": "Can you show us the rest of your parse function?"}, {"owner": {"reputation": 13, "user_id": 4792687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2585af485ba4a83370ba08f98054463c?s=128&d=identicon&r=PG&f=1", "display_name": "zeta", "link": "https://stackoverflow.com/users/4792687/zeta"}, "reply_to_user": {"reputation": 9113, "user_id": 2097780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db5b03704c129196a4e9415e55413ce6?s=128&d=identicon&r=PG", "display_name": "kirbyfan64sos", "link": "https://stackoverflow.com/users/2097780/kirbyfan64sos"}, "edited": false, "score": 0, "creation_date": 1432150848, "post_id": 30358606, "comment_id": 48809559, "body": "`\tbool first = true;\t\t \tstringstream parse;\t\t \tint n, s;\t\t\t\t \tdouble w;\t\t\t\t \tstring line;\t\t\t  \tifstream graph1(argv[1]);  \tGraph g;`"}, {"owner": {"reputation": 9113, "user_id": 2097780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db5b03704c129196a4e9415e55413ce6?s=128&d=identicon&r=PG", "display_name": "kirbyfan64sos", "link": "https://stackoverflow.com/users/2097780/kirbyfan64sos"}, "edited": false, "score": 0, "creation_date": 1432150888, "post_id": 30358606, "comment_id": 48809569, "body": "Could you edit your question with that code?"}, {"owner": {"reputation": 4944, "user_id": 4877767, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RO6mn.png?s=128&g=1", "display_name": "marom", "link": "https://stackoverflow.com/users/4877767/marom"}, "edited": false, "score": 0, "creation_date": 1432151807, "post_id": 30358606, "comment_id": 48810128, "body": "I find code confusing...it mixes C style lists an STL containers. I would use a std::vector&lt;Vertex&gt; instead of std::vector&lt;Vertex *&gt;, then an edge object is needed, may be just in the form std::pair&lt;int, double&gt;. Each vertex could be given a std::vector&lt;std::pair&lt;int, double&gt;&gt;"}], "answers": [{"tags": [], "owner": {"reputation": 103812, "user_id": 320726, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/02041b18199678d1f02e6d5040dbb907?s=128&d=identicon&r=PG", "display_name": "6502", "link": "https://stackoverflow.com/users/320726/6502"}, "is_accepted": false, "score": 0, "last_activity_date": 1432150554, "creation_date": 1432150554, "answer_id": 30358867, "question_id": 30358606, "link": "https://stackoverflow.com/questions/30358606/parse-graph-file-using-string-stream-c/30358867#30358867", "title": "parse graph file using string stream c++", "body": "<p>you should ignore lines and just read integers and doubles...</p>\n\n<pre><code>int n; f &gt;&gt; n;\nfor (int i=0; i&lt;n; i++) {\n    int v; f &gt;&gt; v;\n    assert(v == i);\n    int other; f &gt;&gt; other;\n    while (other != -1) {\n        double weight; f &gt;&gt; weight;\n        add_edge(v, other, weight);\n        f &gt;&gt; other;\n    }\n}\n</code></pre>\n\n<p>this assumes no error checking at all</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 4792687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2585af485ba4a83370ba08f98054463c?s=128&d=identicon&r=PG&f=1", "display_name": "zeta", "link": "https://stackoverflow.com/users/4792687/zeta"}, "edited": false, "score": 0, "creation_date": 1432152128, "post_id": 30359119, "comment_id": 48810328, "body": "how am i taking in the numbers from the file?"}], "tags": [], "owner": {"reputation": 61, "user_id": 4876942, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UR2xUFh9fiI/AAAAAAAAAAI/AAAAAAAAACE/KeWMySE6AkQ/photo.jpg?sz=128", "display_name": "Carlos Mendoza", "link": "https://stackoverflow.com/users/4876942/carlos-mendoza"}, "is_accepted": true, "score": 0, "last_activity_date": 1432152605, "last_edit_date": 1432152605, "creation_date": 1432151424, "answer_id": 30359119, "question_id": 30358606, "link": "https://stackoverflow.com/questions/30358606/parse-graph-file-using-string-stream-c/30359119#30359119", "title": "parse graph file using string stream c++", "body": "<p>You forgot to advance the temp variable    </p>\n\n<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\nclass Graph {\n    public:\n        explicit Graph(int size=0) : vertices_(size) { };\n\n    void resize(int size){\n        vertices_.resize(size);\n        empty();\n    }\n\n    void insert(int v, int n, double w){\n        end(v)-&gt;next = new Vertex{ n, w, nullptr };\n        cout &lt;&lt; \" inserted! \" &lt;&lt; endl;\n    }\n\n    void empty(){\n        for(int i = 0; i &lt; vertices_.size(); i++)\n            vertices_[i] = new Vertex{ i, 0, nullptr};\n    }\n\n    void print() { \n        for(auto&amp; v : vertices_){\n            Vertex* tmp = v;\n            cout&lt;&lt; \" Node \" &lt;&lt; v-&gt;node &lt;&lt; \" has edges to: \\n\";\n            while(tmp-&gt;next != nullptr) {\n                if(tmp-&gt;node != v-&gt;node)\n                    cout&lt;&lt; \"  Node \" &lt;&lt; tmp-&gt;node &lt;&lt; \" with weight \" &lt;&lt; tmp-&gt;weight&lt;&lt;endl;\n                tmp = tmp-&gt;next; // You forgot this line\n            }\n        cout&lt;&lt;endl;\n        }\n    }\n\n private:   \n    struct Vertex{ // struct for vertices of graph\n        int node;\n        double weight;\n        Vertex* next;\n\n        Vertex (int n, double w, Vertex* v) \n    : node{ n }, weight{ w }, next{ v } { }\n    };\n\n    vector&lt;Vertex*&gt; vertices_;\n\n    Vertex* end(int v){\n        Vertex* tmp = vertices_[v];\n        while(tmp-&gt;next != nullptr)\n            tmp = tmp-&gt;next;\n\n        return tmp;\n    }\n}g;\n\n\nint main()\n{\n    int N,x,y;\n    double w;\n    cin &gt;&gt; N;\n    g.resize(N);\n    for(int i = 0; i &lt; N; i++)\n    {\n        cin &gt;&gt; x;\n        while(cin &gt;&gt; y, y != -1)\n        {\n            cin &gt;&gt; w;\n            cout &lt;&lt; \"Edge from \" &lt;&lt; x &lt;&lt; \" to \" &lt;&lt; y &lt;&lt; \" with cost \" &lt;&lt; w &lt;&lt; endl;\n            g.insert(x,y,w);\n        }\n    }\n\n    g.print();\n}\n</code></pre>\n\n<p>To read from file:</p>\n\n<pre><code>int main()\n{\n    ifstream myfile(\"in.txt\");\n    if(myfile.is_open())\n    {\n        int N,x,y;\n        double w;\n        myfile &gt;&gt; N;\n        for(int i = 0; i &lt; N; i++)\n        {\n            myfile &gt;&gt; x;\n            while(myfile &gt;&gt; y, y != -1)\n            {\n                myfile &gt;&gt; w;\n                cout &lt;&lt; \"Edge from \" &lt;&lt; x &lt;&lt; \" to \" &lt;&lt; y &lt;&lt; \" with cost \" &lt;&lt; w &lt;&lt; endl;\n            }\n        }\n        myfile.close();\n    }\n    else \n        cout &lt;&lt; \"Unable to open file\"; \n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4792687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2585af485ba4a83370ba08f98054463c?s=128&d=identicon&r=PG&f=1", "display_name": "zeta", "link": "https://stackoverflow.com/users/4792687/zeta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 653, "favorite_count": 0, "accepted_answer_id": 30359119, "answer_count": 2, "score": 0, "last_activity_date": 1432152605, "creation_date": 1432149684, "last_edit_date": 1432151115, "question_id": 30358606, "link": "https://stackoverflow.com/questions/30358606/parse-graph-file-using-string-stream-c", "title": "parse graph file using string stream c++", "body": "<p>I need to parse a graph file of this form:</p>\n\n<pre><code>5\n0 1 0.2 3 10.1 4 0.5 -1\n1 0 1.5 -1\n2 1 100.0 3 50.2 -1\n3 -1\n4 1 10.5 2 13.9 -1\n</code></pre>\n\n<p>Where the first line is the number of nodes. from the second line onward,</p>\n\n<pre><code> 0 1 0.2 3 10.1 4 0.5 -1\n</code></pre>\n\n<p>0 is the source node, 1 is the node it travels to, and 0.5 is the weight of the edge. -1 indicates end of line.</p>\n\n<p>I have created a graph class:</p>\n\n<pre><code>#ifndef GRAPH_H\n#define GRAPH_H\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\nclass Graph{\n public:\n    explicit Graph(int size=0) : vertices_(size) { };\n\n    void resize(int size){\n        vertices_.resize(size);\n        empty();\n    }\n\n    void insert(int v, int n, double w){\n        Vertex* tmp = new Vertex{ n, w, nullptr }\n        cout &lt;&lt; \" inserting!\";\n        end(v)-&gt;next = tmp;\n    }\n\n    void empty(){\n        for(int i=0;i&lt;vertices_.size();i++)\n            vertices_[i] = new Vertex{i,0,nullptr}\n    }\n\n    void print() { \n        for(auto&amp; v : vertices_){\n            Vertex* tmp = v;\n            cout&lt;&lt; \" Node \" &lt;&lt; v-&gt;node &lt;&lt; \" has edges to: \\n\"\n            while(tmp-&gt;next != nullptr){\n                cout&lt;&lt; \"  node \" &lt;&lt; tmp-&gt;node &lt;&lt; \" with weight \" &lt;&lt; tmp-&gt;weight&lt;&lt;endl;\n            }\n        cout&lt;&lt;endl;\n        }\n    }\n\n private:   \n    struct Vertex{ // struct for vertices of graph\n        int node;\n        double weight;\n        Vertex* next;\n\n        Vertex (int n, double w, Vertex* v) \n    : node{ n }, weight{ w }, next{ v } { }\n    };\n\n    vector&lt;Vertex*&gt; vertices_;\n\n    Vertex* end(int v){\n        Vertex* tmp = vertices_[v];\n        while(tmp-&gt;next != nullptr)\n            tmp = tmp-&gt;next;\n\n        return tmp;\n    }\n};\n#endif\n</code></pre>\n\n<p>i have this parser thus far: (all of the variables are appropriate types)</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n#include &lt;string&gt;\n#include \"graph.h\"\n\nusing namespace std;\n\nint main(int argc, char** argv) {\n    if(argc&lt;3){\n        cout&lt;&lt;\"Usage: \" &lt;&lt; argv[0] &lt;&lt; \" &lt;graph file&gt; &lt;starting vertex&gt;\\n\";\n        return 0;\n    }   \n    bool first = true;      // true until the first line is read (flow control)\n    stringstream parse;     // stringstream for easy parsing &amp; conversion of strings\n    int n, s;               // holds the nodes for inserting\n    double w;               // holds the weights for edges\n    string line;            \n\n    ifstream graph1(argv[1]);\n\n    Graph g;\n    while(getline(graph1,line)){\n    if(first){\n        n=stoi(line);\n        g.resize(n);\n        first = false;\n    } else {\n        parse &lt;&lt; line;\n        first = true;\n        while(getline(parse,line,' ')&amp;&amp;line != \"-1\"){\n            if(first){\n                parse &gt;&gt; s;\n                g.insert(s,s,0)\n                first = false;\n            } \n            parse &gt;&gt; n &gt;&gt; w;\n            cout &lt;&lt; s &lt;&lt; \" \" &lt;&lt; n &lt;&lt; \" \" &lt;&lt; w &lt;&lt;endl;\n            g.insert(s,n,w);\n        }\n    }\n}\n</code></pre>\n\n<p>but when i <code>print()</code> i get a seg fault. what am i doing wrong?</p>\n"}, {"tags": ["c++", "reference", "parameter-passing", "pass-by-reference"], "comments": [{"owner": {"reputation": 15898, "user_id": 1155000, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8213d9cd920e864ce8ff1fdeefe4db5?s=128&d=identicon&r=PG", "display_name": "Daniel Kamil Kozar", "link": "https://stackoverflow.com/users/1155000/daniel-kamil-kozar"}, "edited": false, "score": 0, "creation_date": 1432149474, "post_id": 30358529, "comment_id": 48808766, "body": "Why would you think that constructing a new object into a reference implies relocating the referenced object?"}, {"owner": {"reputation": 18613, "user_id": 818182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89b420763192c3b763f4cffa789fe39f?s=128&d=identicon&r=PG", "display_name": "Austin Brunkhorst", "link": "https://stackoverflow.com/users/818182/austin-brunkhorst"}, "edited": false, "score": 0, "creation_date": 1432149703, "post_id": 30358529, "comment_id": 48808907, "body": "<code>reassign()</code> is simply constructing a new string in the same memory location that <code>a</code> is referencing. If you wanted to change the address, you would need to pass a either a reference to a pointer, or a pointer to a pointer."}, {"owner": {"reputation": 31984, "user_id": 4125191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TAHVV.jpg?s=128&g=1", "display_name": "RealSkeptic", "link": "https://stackoverflow.com/users/4125191/realskeptic"}, "edited": false, "score": 0, "creation_date": 1432149724, "post_id": 30358529, "comment_id": 48808918, "body": "You are not actually printing where the pointer points. You are just printing the address of a pointer to where x is."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1432149939, "post_id": 30358529, "comment_id": 48809049, "body": "When you pass an object by reference, the function can change the value of the object using that reference. But it can&#39;t &quot;reseat&quot; the reference to make it refer to a different object entirely."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1432151181, "post_id": 30358529, "comment_id": 48809727, "body": "Java&#39;s &quot;references&quot; and C++&#39;s &quot;references&quot; are different things. Imagine a stationary box where you can put things. A Java &quot;reference&quot; would refer to the thing inside the box, while a C++ &quot;reference&quot; would refer to the box itself. Put another way: in Java, a &quot;reference&quot; always refers to the same thing, regardless of which box you put it in; in C++, a &quot;reference&quot; always refers to the same box, regardless of what you put into it."}, {"owner": {"reputation": 39, "user_id": 4921829, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8427e7d342de99752d75f1434b022a89?s=128&d=identicon&r=PG&f=1", "display_name": "ladiesman", "link": "https://stackoverflow.com/users/4921829/ladiesman"}, "edited": false, "score": 0, "creation_date": 1432153909, "post_id": 30358529, "comment_id": 48811320, "body": "so isn&#39;t <code>&quot;string mystr = string(&quot;newstring&quot;)&quot;</code> the same as <code>&quot;string mystr = *(new string(&quot;newstring&quot;))&quot;</code> in terms of dynamically memory allocation?"}], "answers": [{"comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1432150082, "post_id": 30358619, "comment_id": 48809150, "body": "If you delete the object before reassigning, you may reuse the same address, breaking the demo. That&#39;s why I saved <code>a</code> to <code>old</code>, reassigned <code>a</code>, and only then deleted <code>old</code>."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 6, "last_activity_date": 1432149722, "creation_date": 1432149722, "answer_id": 30358619, "question_id": 30358529, "link": "https://stackoverflow.com/questions/30358529/why-cant-a-function-change-its-argument-objects-address-reference-value/30358619#30358619", "title": "Why can&#39;t a function change its argument object&#39;s address/reference value?", "body": "<p>Once an object is allocated, nothing can change its address. You can change its content (that is what your program does) but the address will stay the same for the lifetime of the object.</p>\n\n<p>If you create an object dynamically with <code>new</code>, you would be able to assign a different object to the same pointer. However, the rule would stay the same: the address of the old object would not change, but you would be able to assign a new object to an old pointer.</p>\n\n<pre><code>void reassign(string* &amp; a);\n\nint main() {\n    string *x = new string(\"abcd\");\n    cout &lt;&lt;\"x is \" &lt;&lt; *x &lt;&lt;\" at \" &lt;&lt; x &lt;&lt;endl;    //\"x is abcd at 0x95b7008\"\n    reassign(x);\n    cout &lt;&lt;\"x is \" &lt;&lt; *x &lt;&lt;\" at \" &lt;&lt; x &lt;&lt;endl;    //\"x is efgh at 0x95b7030\"\n    delete x;\n    return 0;\n}\n\nvoid reassign(string* &amp; a) {\n    string *old = a;\n    a = new string(\"efgh\");\n    delete old;\n}\n</code></pre>\n\n<p><a href=\"http://ideone.com/jZ1SNx\" rel=\"noreferrer\">Demo.</a></p>\n"}, {"tags": [], "owner": {"reputation": 109950, "user_id": 86989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd262de5d82a235eeb64f71e4058198?s=128&d=identicon&r=PG", "display_name": "newacct", "link": "https://stackoverflow.com/users/86989/newacct"}, "is_accepted": false, "score": 0, "last_activity_date": 1432594858, "creation_date": 1432594858, "answer_id": 30447061, "question_id": 30358529, "link": "https://stackoverflow.com/questions/30358529/why-cant-a-function-change-its-argument-objects-address-reference-value/30447061#30447061", "title": "Why can&#39;t a function change its argument object&#39;s address/reference value?", "body": "<p>You are confused because your analogy is not right. In Java, there is no such thing as an \"argument object\", because \"objects\" themselves are not values in Java (there are no \"object types\" in Java). The only types in Java are primitive types and reference types, where \"references\" are pointers to objects. So in Java you can only have pointers to objects as the value of a variable or parameter, and you only deal with objects through pointers to objects.</p>\n\n<p>\"you cannot change where that pointer points\" is a consequence of <em>pass-by-value</em>. Java is always pass-by-value, which means assignment to the parameter cannot change the <em>value</em> of a passed variable. Remember that variables can only be of primitive type or reference type. Here you are talking about reference type. So the \"value\" of a variable of reference type is the reference (pointer to object), i.e. the address of the object it points to. Hence, you cannot change the value means you cannot change where the pointer points.</p>\n\n<p>For example, in Java you might have something like this:</p>\n\n<pre><code>public static void reassign(String a) {\n    a = new String(\"efgh\");\n}\n\npublic static void main(String[] args) {\n    String x = \"abcd\";\n    System.out.printf(\"x is %s at %x\\n\", x, System.identityHashCode(x)); // x is abcd at 25154f\n    reassign(x);\n    System.out.printf(\"x is %s at %x\\n\", x, System.identityHashCode(x)); // x is abcd at 25154f\n}\n</code></pre>\n\n<p>Here, <code>x</code> in <code>main</code> is a pointer to an object. <code>a</code> in <code>reassign</code> is also a pointer to an object. Assigning to the pointer parameter <code>a</code> in <code>reassign</code> has no effect on the passed pointer variable <code>x</code> (i.e. it does not affect where the pointer points to) because it's pass-by-value.</p>\n\n<p>The equivalent of the above code in C++ would be like this:</p>\n\n<pre><code>void reassign(string *a) {\n    a = new string(\"efgh\");\n}\n\nint main() {\n    string *x = new string(\"abcd\");\n    cout &lt;&lt; \"x is \" &lt;&lt; *x &lt;&lt;\" at \" &lt;&lt; x &lt;&lt; endl; // x is abcd at 0x82b1008\n    reassign(x);\n    cout &lt;&lt; \"x is \" &lt;&lt; *x &lt;&lt;\" at \" &lt;&lt; x &lt;&lt; endl; // x is abcd at 0x82b1008\n    return 0;\n}\n</code></pre>\n\n<p>In addition to the pass-by-value shown above, C++ also has pass-by-reference, where assignment to a parameter has the same effect as assigning to the passed variable in the calling scope. Here is the exact same thing as above but with pass-by-reference:</p>\n\n<pre><code>void reassign(string *&amp;a) {\n    a = new string(\"efgh\");\n}\n\nint main() {\n    string *x = new string(\"abcd\");\n    cout &lt;&lt; \"x is \" &lt;&lt; *x &lt;&lt;\" at \" &lt;&lt; x &lt;&lt; endl; // x is abcd at 0x8673008\n    reassign(x);\n    cout &lt;&lt; \"x is \" &lt;&lt; *x &lt;&lt;\" at \" &lt;&lt; x &lt;&lt; endl; // x is efgh at 0x8673030\n    return 0;\n}\n</code></pre>\n\n<p>Note that in none of the cases here did we <em>change</em> the object pointed to. We simply created a new object and tried to change the pointer to point to this object. The old object is still unchanged. The ability to change an object is an independent and orthogonal issue from pass-by-value and pass-by-reference, so we do not go into it here.</p>\n"}], "owner": {"reputation": 39, "user_id": 4921829, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8427e7d342de99752d75f1434b022a89?s=128&d=identicon&r=PG&f=1", "display_name": "ladiesman", "link": "https://stackoverflow.com/users/4921829/ladiesman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 961, "favorite_count": 0, "accepted_answer_id": 30358619, "answer_count": 2, "score": 1, "last_activity_date": 1432594858, "creation_date": 1432149407, "last_edit_date": 1495535213, "question_id": 30358529, "link": "https://stackoverflow.com/questions/30358529/why-cant-a-function-change-its-argument-objects-address-reference-value", "title": "Why can&#39;t a function change its argument object&#39;s address/reference value?", "body": "<p>I learned that in Java and C, <a href=\"https://stackoverflow.com/questions/40480/is-java-pass-by-reference-or-pass-by-value?page=1&amp;tab=votes#tab-top\">you can assign a pointer, pass the pointer to a method, follow the pointer in the method and change the data that was pointed to. However, you cannot change where that pointer points.</a></p>\n\n<p>I thought I could see a different behavior in C++ due to its pass-by-reference feature, but my code seems to agree with the above statement...</p>\n\n<pre><code>void reassign(string &amp; a);\nint main()\n{\n    string x = \"abcd\";\n    cout &lt;&lt;\"x is \" &lt;&lt; x &lt;&lt;\" at \" &lt;&lt; &amp;x &lt;&lt;endl;    //\"x is abcd at 0x7bc7ebd5b720\"\n    reassign(x);\n    cout &lt;&lt;\"x is \" &lt;&lt; x &lt;&lt;\" at \" &lt;&lt; &amp;x &lt;&lt;endl;    //\"x is efgh at 0x7bc7ebd5b720\"\n\n}\n\nvoid reassign(string &amp; a)\n{\n    a = string(\"efgh\");\n}\n</code></pre>\n\n<p>Since \"string()\" constructs a new string, why doesn't the \"reassign\" function change the original string's address?</p>\n"}, {"tags": ["c++", "stl"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 7, "creation_date": 1432149417, "post_id": 30358475, "comment_id": 48808728, "body": "<i>Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>.</i> At least show your <code>Child</code> class declaration."}, {"owner": {"reputation": 69802, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "edited": false, "score": 0, "creation_date": 1432149514, "post_id": 30358475, "comment_id": 48808793, "body": "We are at least missing <code>Child</code>&#39;s definition."}, {"owner": {"reputation": 3618, "user_id": 2394945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g5WxC.png?s=128&g=1", "display_name": "Moby Disk", "link": "https://stackoverflow.com/users/2394945/moby-disk"}, "edited": false, "score": 2, "creation_date": 1432149564, "post_id": 30358475, "comment_id": 48808828, "body": "I created a test project, and I do not see the behavior you suggest.  It just creates one, and copies one.  <a href=\"http://coliru.stacked-crooked.com/a/5460f09cdc665fd8\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/5460f09cdc665fd8</a>"}, {"owner": {"reputation": 18565, "user_id": 10593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3eeb7653c4df9b0f1332b9b0ec201ec?s=128&d=identicon&r=PG", "display_name": "Max Lybbert", "link": "https://stackoverflow.com/users/10593/max-lybbert"}, "edited": false, "score": 0, "creation_date": 1432149830, "post_id": 30358475, "comment_id": 48808979, "body": "Compilers and STL implementations are allowed to assume that calling the copy constructor will create a copy and not do anything unnecessary.  I&#39;m not aware of anything in the Standard that puts an upper bound on how many copies can be made in a function call."}, {"owner": {"reputation": 18565, "user_id": 10593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3eeb7653c4df9b0f1332b9b0ec201ec?s=128&d=identicon&r=PG", "display_name": "Max Lybbert", "link": "https://stackoverflow.com/users/10593/max-lybbert"}, "edited": false, "score": 0, "creation_date": 1432149862, "post_id": 30358475, "comment_id": 48808995, "body": "Which compiler?  Which version?  Which optimization level? (if Visual Studio, are you building Debug or Release?)"}, {"owner": {"reputation": 31310, "user_id": 68105, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1bC0L.png?s=128&g=1", "display_name": "MK.", "link": "https://stackoverflow.com/users/68105/mk"}, "reply_to_user": {"reputation": 3618, "user_id": 2394945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g5WxC.png?s=128&g=1", "display_name": "Moby Disk", "link": "https://stackoverflow.com/users/2394945/moby-disk"}, "edited": false, "score": 0, "creation_date": 1432149864, "post_id": 30358475, "comment_id": 48808997, "body": "@MobyDisk if you change it to do it in a loop you will see it as the vector re-allocates internally."}, {"owner": {"reputation": 1608, "user_id": 1814794, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2993e4fda2d82a868159df3456e761a?s=128&d=identicon&r=PG", "display_name": "henryyao", "link": "https://stackoverflow.com/users/1814794/henryyao"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1432149952, "post_id": 30358475, "comment_id": 48809059, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 It is added in the latest edit."}, {"owner": {"reputation": 31310, "user_id": 68105, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1bC0L.png?s=128&g=1", "display_name": "MK.", "link": "https://stackoverflow.com/users/68105/mk"}, "reply_to_user": {"reputation": 18565, "user_id": 10593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3eeb7653c4df9b0f1332b9b0ec201ec?s=128&d=identicon&r=PG", "display_name": "Max Lybbert", "link": "https://stackoverflow.com/users/10593/max-lybbert"}, "edited": false, "score": 0, "creation_date": 1432149958, "post_id": 30358475, "comment_id": 48809063, "body": "@MaxLybbert I&#39;m seeing it with Apple LLVM version 6.0 (clang-600.0.57) (based on LLVM 3.5svn) and it will happen with pretty much any version."}, {"owner": {"reputation": 1608, "user_id": 1814794, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2993e4fda2d82a868159df3456e761a?s=128&d=identicon&r=PG", "display_name": "henryyao", "link": "https://stackoverflow.com/users/1814794/henryyao"}, "reply_to_user": {"reputation": 18565, "user_id": 10593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3eeb7653c4df9b0f1332b9b0ec201ec?s=128&d=identicon&r=PG", "display_name": "Max Lybbert", "link": "https://stackoverflow.com/users/10593/max-lybbert"}, "edited": false, "score": 0, "creation_date": 1432150214, "post_id": 30358475, "comment_id": 48809220, "body": "@MaxLybbert  i was not aware that the Complier would matter in the case.  I&#39;m using VC++2005 debug"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1432150271, "post_id": 30358475, "comment_id": 48809244, "body": "@henryyao <a href=\"http://ideone.com/EfHXtj\" rel=\"nofollow noreferrer\">Cannot reproduce from your sample, sorry.</a>"}, {"owner": {"reputation": 3618, "user_id": 2394945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g5WxC.png?s=128&g=1", "display_name": "Moby Disk", "link": "https://stackoverflow.com/users/2394945/moby-disk"}, "edited": false, "score": 0, "creation_date": 1432150333, "post_id": 30358475, "comment_id": 48809282, "body": "Please upvote this question now that the asker added the relevant information so it can be reopened.  The question now has the MCVE and the compiler information."}, {"owner": {"reputation": 3618, "user_id": 2394945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g5WxC.png?s=128&g=1", "display_name": "Moby Disk", "link": "https://stackoverflow.com/users/2394945/moby-disk"}, "edited": false, "score": 1, "creation_date": 1432150370, "post_id": 30358475, "comment_id": 48809304, "body": "This does not happen with VC++ 2013, even in Debug mode.  It must be the old compiler you are using."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 31310, "user_id": 68105, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1bC0L.png?s=128&g=1", "display_name": "MK.", "link": "https://stackoverflow.com/users/68105/mk"}, "edited": false, "score": 2, "creation_date": 1432150374, "post_id": 30358475, "comment_id": 48809306, "body": "@MK. <i>&quot;... before you made him add all the non-essential crap to it&quot;</i> How is this considered <i>non-essential</i>??"}, {"owner": {"reputation": 31310, "user_id": 68105, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1bC0L.png?s=128&g=1", "display_name": "MK.", "link": "https://stackoverflow.com/users/68105/mk"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1432150502, "post_id": 30358475, "comment_id": 48809371, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 try like this <a href=\"http://ideone.com/N6jW4X\" rel=\"nofollow noreferrer\">ideone.com/N6jW4X</a>"}, {"owner": {"reputation": 18565, "user_id": 10593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3eeb7653c4df9b0f1332b9b0ec201ec?s=128&d=identicon&r=PG", "display_name": "Max Lybbert", "link": "https://stackoverflow.com/users/10593/max-lybbert"}, "edited": false, "score": 0, "creation_date": 1432150530, "post_id": 30358475, "comment_id": 48809383, "body": "The compiler matters in the sense that copy elision is done by the compiler, and copy elision is only valid if the copy constructor creates copies and doesn&#39;t do anything else.  Of course, you&#39;re looking at the other side of the coin, with more copies being made than you expect.  But if  the copy constructor follows the rules, then those &quot;extra&quot; calls can&#39;t affect correctness, only performance."}, {"owner": {"reputation": 31310, "user_id": 68105, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1bC0L.png?s=128&g=1", "display_name": "MK.", "link": "https://stackoverflow.com/users/68105/mk"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1432150543, "post_id": 30358475, "comment_id": 48809388, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 it is non-essential because it was pretty clear what was going on and the correct explanation was posted in comments within seconds."}], "answers": [{"comments": [{"owner": {"reputation": 97503, "user_id": 82320, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0e41f852c5c471370a0d08ba8dc1c032?s=128&d=identicon&r=PG", "display_name": "Billy ONeal", "link": "https://stackoverflow.com/users/82320/billy-oneal"}, "edited": false, "score": 1, "creation_date": 1432153232, "post_id": 30359587, "comment_id": 48810898, "body": "<code>push_back</code> is required to accept <code>const&amp;</code> and <code>&amp;&amp;</code> so there should be no copy there...."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 97503, "user_id": 82320, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0e41f852c5c471370a0d08ba8dc1c032?s=128&d=identicon&r=PG", "display_name": "Billy ONeal", "link": "https://stackoverflow.com/users/82320/billy-oneal"}, "edited": false, "score": 0, "creation_date": 1432153783, "post_id": 30359587, "comment_id": 48811222, "body": "@BillyONeal there is a copy because Item1 is not <code>std::move</code>d."}, {"owner": {"reputation": 97503, "user_id": 82320, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0e41f852c5c471370a0d08ba8dc1c032?s=128&d=identicon&r=PG", "display_name": "Billy ONeal", "link": "https://stackoverflow.com/users/82320/billy-oneal"}, "edited": false, "score": 2, "creation_date": 1432154159, "post_id": 30359587, "comment_id": 48811463, "body": "Passing by <code>const&amp;</code> does not result in a copy."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 97503, "user_id": 82320, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0e41f852c5c471370a0d08ba8dc1c032?s=128&d=identicon&r=PG", "display_name": "Billy ONeal", "link": "https://stackoverflow.com/users/82320/billy-oneal"}, "edited": false, "score": 0, "creation_date": 1432154596, "post_id": 30359587, "comment_id": 48811695, "body": "@BillyONeal of course it does. std::vector&lt;Child&gt; stores a copy of Child not a reference to it."}, {"owner": {"reputation": 97503, "user_id": 82320, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0e41f852c5c471370a0d08ba8dc1c032?s=128&d=identicon&r=PG", "display_name": "Billy ONeal", "link": "https://stackoverflow.com/users/82320/billy-oneal"}, "edited": false, "score": 0, "creation_date": 1432154712, "post_id": 30359587, "comment_id": 48811755, "body": "But there&#39;s no reason for two copies there -- there&#39;s one copy to store the value. Your answer says a copy is made in the parameter passing mechanism, but there is no such copy if the object is passed by <code>const&amp;</code>."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 97503, "user_id": 82320, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0e41f852c5c471370a0d08ba8dc1c032?s=128&d=identicon&r=PG", "display_name": "Billy ONeal", "link": "https://stackoverflow.com/users/82320/billy-oneal"}, "edited": false, "score": 0, "creation_date": 1432154991, "post_id": 30359587, "comment_id": 48811926, "body": "@BillyONeal No I said that a copy is created <i>when</i> passing the parameter (sure it&#39;s created within the code of std::vector::push_back) and I later hint that this cannot be elided because the Child is named and therefore not a temporary. But I accept that more formal wording could be warranted."}, {"owner": {"reputation": 97503, "user_id": 82320, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0e41f852c5c471370a0d08ba8dc1c032?s=128&d=identicon&r=PG", "display_name": "Billy ONeal", "link": "https://stackoverflow.com/users/82320/billy-oneal"}, "edited": false, "score": 0, "creation_date": 1432158987, "post_id": 30359587, "comment_id": 48813833, "body": "There&#39;s no reason for a copy, or copy elision, there. The parameter is passed as a <code>const&amp;</code> into <code>push_back</code>. The vector is resized as appropriate to accept the new element. Then a the value from the <code>const&amp;</code> is constructed in place in the storage owned by the vector. Exactly one copy of the object occurs, placing it into the vector&#39;s storage. There is no copy associated with any parameter passing of any kind."}, {"owner": {"reputation": 1608, "user_id": 1814794, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2993e4fda2d82a868159df3456e761a?s=128&d=identicon&r=PG", "display_name": "henryyao", "link": "https://stackoverflow.com/users/1814794/henryyao"}, "edited": false, "score": 0, "creation_date": 1432160909, "post_id": 30359587, "comment_id": 48814505, "body": "I&#39;ve checked the vector code. the first copy is made at :                     vector.cpp #1126 :_Ty _Tmp = _Val;\t// in case _Val is in sequence.                  The second copy is made at  same file at                                                                   #1144:_Ptr = _Ufill(_Ptr, _Count, _Tmp);\t// add new stuff.                                        I would guess my compiler  did not perform any optimization at all, though i enabled the Optimization Full. I&#39;m curious about some people who cannot reproduce this issue, can someone check the assembly  to see which part is skipped?"}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 1, "last_activity_date": 1432153870, "last_edit_date": 1432153870, "creation_date": 1432153071, "answer_id": 30359587, "question_id": 30358475, "link": "https://stackoverflow.com/questions/30358475/why-the-copy-constructor-is-called-twice-when-doing-a-vector-push-back/30359587#30359587", "title": "why the copy-constructor is called twice when doing a vector.push_back", "body": "<p>Official answer: In the case of your class, std::vector is free to make as many copies as it likes since there is no limit specified in the standard.</p>\n\n<p>What is probably happening: a copy is being made when passing the object as a parameter and again when the vector is resized internally.</p>\n\n<p>Isn't this inefficient? Yes</p>\n\n<p>How do I improve it?</p>\n\n<p>Either remove the custom destructor and copy constructor or define a custom move constructor and copy operator. The former case allows the compiler to create its own move operations, the latter provides them.</p>\n\n<p>Once the compiler can deduce that your class is move-aware, std::vector's operations become a lot more efficient and you will see exactly one copy (because you are forcing the compiler to make one by naming the <code>Child</code> called <code>Item1</code>) </p>\n\n<p>Edit: consider this example</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\nclass Child\n{\npublic:\n    Child();\n    Child(const Child &amp;item);\n    Child(Child&amp;&amp; item);\n    Child&amp; operator=(const Child &amp;item);\n    Child&amp; operator=(Child&amp;&amp; item);\n    ~Child();\n\nprivate:\n    std::string name() const {\n        return std::string { _zombie ? \"zombie\" : \"child\" };\n    }\n    bool _zombie = false;\n};\n\nChild::Child()\n{\n    std::cout &lt;&lt; \"constructing \" &lt;&lt; name() &lt;&lt; \"\\n\";\n}\n\nChild::Child(const Child &amp;item)\n{\n    std::cout &lt;&lt; \"copy-constructing \" &lt;&lt; name() &lt;&lt; \"\\n\";\n}\n\nChild::Child(Child &amp;&amp;item)\n{\n    std::cout &lt;&lt; \"move-constructing \" &lt;&lt; name() &lt;&lt; \"\\n\";\n    item._zombie = true;\n}\n\nChild&amp; Child::operator=(const Child &amp;item)\n{\n    _zombie = false;\n    std::cout &lt;&lt; \"assigning \" &lt;&lt; name() &lt;&lt; \"\\n\";\n    return *this;\n}\n\nChild&amp; Child::operator=(Child &amp;&amp;item)\n{\n    item._zombie = true;\n    _zombie = false;\n    std::cout &lt;&lt; \"move-assigning \" &lt;&lt; name() &lt;&lt; \"\\n\";\n    return *this;\n}\n\nChild::~Child()\n{\n    std::cout &lt;&lt; \"destructing \" &lt;&lt; name() &lt;&lt; \"\\n\";\n}\n\nusing namespace std;\n\nint main(int argc, const char * argv[])\n{\n    {\n        std::vector&lt;Child&gt; v;\n        Child item1;\n        v.push_back(item1);\n    }\n    cout &lt;&lt; endl;\n\n    {\n        std::vector&lt;Child&gt; v;\n        v.push_back(Child{});\n    }\n    cout &lt;&lt; endl;\n\n    {\n        std::vector&lt;Child&gt; v;\n        Child item1;\n        v.push_back(std::move(item1));\n    }\n    cout &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>sample output:</p>\n\n<pre><code>constructing child\ncopy-constructing child\ndestructing child\ndestructing child\n\nconstructing child\nmove-constructing child\ndestructing zombie\ndestructing child\n\nconstructing child\nmove-constructing child\ndestructing zombie\ndestructing child\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3618, "user_id": 2394945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g5WxC.png?s=128&g=1", "display_name": "Moby Disk", "link": "https://stackoverflow.com/users/2394945/moby-disk"}, "is_accepted": false, "score": 1, "last_activity_date": 1432154346, "creation_date": 1432154346, "answer_id": 30359950, "question_id": 30358475, "link": "https://stackoverflow.com/questions/30358475/why-the-copy-constructor-is-called-twice-when-doing-a-vector-push-back/30359950#30359950", "title": "why the copy-constructor is called twice when doing a vector.push_back", "body": "<p>This is happening because you are using an old compiler.  Sorry if that isn't a really exciting conclusion. :-(  No one else can replicate the problem, even on newer Microsoft compilers.  While Richard Hodges is correct when he says that a compiler is free to make copies as it sees fit, modern compilers do their best to avoid them.  In the specific case you list, a decent compiler should not be making a copy, and if you are concerned about performance you should consider upgrading to a newer version.</p>\n"}], "owner": {"reputation": 1608, "user_id": 1814794, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2993e4fda2d82a868159df3456e761a?s=128&d=identicon&r=PG", "display_name": "henryyao", "link": "https://stackoverflow.com/users/1814794/henryyao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1051, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1432154346, "creation_date": 1432149266, "last_edit_date": 1432150119, "question_id": 30358475, "link": "https://stackoverflow.com/questions/30358475/why-the-copy-constructor-is-called-twice-when-doing-a-vector-push-back", "title": "why the copy-constructor is called twice when doing a vector.push_back", "body": "<p>I have a Class Child, and a simple vector push back implementation like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\nclass Child \n{\n    public:\n        Child();\n        Child(const Child &amp;item);\n        ~Child();\n};\n\nChild::Child()\n{\n    std::cout&lt;&lt;\"Constructing Child\\n\";\n}\n\nChild::Child(const Child &amp;item)\n{\n    std::cout&lt;&lt;\"Copy-Constructing Child\\n\";\n}\n\nChild::~Child()\n{\n    std::cout&lt;&lt;\"Destructing Child\\n\";\n}\n\nint main()\n{\n    std::vector&lt;Child&gt; v;\n    Child Item1;\n    v.push_back(Item1);\n}\n</code></pre>\n\n<p>Right after <code>v.push_back( Item1 );</code> is called, i have the following outputs:</p>\n\n<pre><code>Constructing Child\nCopy-Constructing Child\nCopy-Constructing Child\nDestructing Child\n</code></pre>\n\n<p>I was expecting the <code>Copy-Constructing Child</code> only appears once. Why is the copy-constructor called twice?</p>\n"}, {"tags": ["c++", "macos", "launchd"], "owner": {"reputation": 71, "user_id": 4595094, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48a24752e138d2d00683f613b8b388c7?s=128&d=identicon&r=PG&f=1", "display_name": "Ezra Knobloch", "link": "https://stackoverflow.com/users/4595094/ezra-knobloch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 894, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1485820834, "creation_date": 1432148254, "last_edit_date": 1485820834, "question_id": 30358184, "link": "https://stackoverflow.com/questions/30358184/taskgated-no-signature-for-pid", "title": "taskgated no signature for pid", "body": "<p>I'm trying to install a self-made LaunchDaemon in OS X 10.10, however, i run into some strange errors and can't find the solution.. hopefully someone knows the answer, I'm googleing my ass of for this..</p>\n\n<p>basically, i have a simple program (written in C++), installed in /Library/Application Support/myfolder/myprogram. I set permission as follows:</p>\n\n<pre><code>chown root /Application Support/myfolder/myprogram\nchmod 644 /Application Support/myfolder/myprogram\n</code></pre>\n\n<p>I got the .plist for the LaunchDaemons folder installed correctly (I'm sure about this).</p>\n\n<p>Now when I boot up my Computer, I find this in my Logs (looping):</p>\n\n<pre><code>taskgated: no signature for pid=xxx (cannot make code: UNIX[no such process])\ncom.apple.xpc.launchd: (my.launchdaemons.plist) Service exited duo to signal: Killed: 9\ncom.apple.xpc.launchd: (my.launchdaemons.plist) Service ran only for 0 seconds. Pushing respawn out by 10 seconds.\n</code></pre>\n\n<p>Okay, this seems like taskgated daemon thinks that my program is \"insecure\" thus blocking it from execution. Guessing this is based on signature checking, i did not sign my program.. and I don't want to do it.</p>\n\n<p>So I tried to disable that check by modifying the taskgated.plist to add the -p argument when taskgated is started up, but that did not do the trick, still getting the same error.</p>\n\n<p>Then I tried to disable signature checking system wide (I know this is a big security risk, but this was only for testing purpose) by using:</p>\n\n<pre><code>sudo spctl --master-disable\n</code></pre>\n\n<p>But guess what: Still getting the same error (even after a reboot).\nSimply killing taskgated does also not help (your not able to start any program, except using the ones that where open before killing taskgated).</p>\n\n<p>So, is there SOME way to get around this annoying signature check or some other way to actually get my program running?</p>\n\n<p>On the Mac i compiled the program (its not the same computer where I'm trying to install it) it is just running fine. I mean, i can run my program from terminal like:</p>\n\n<pre><code>bash$&gt; ./myprogram\n&lt;output&gt;\nbash$&gt;\n</code></pre>\n\n<p>but on the computer i want to install it on i get this:</p>\n\n<pre><code>bash$&gt; ./myprogram\nKilled: 9\nbash$&gt;\n</code></pre>\n\n<p>Just moved the program via USB Stick from one Computer to the other... I can't get the point... :/</p>\n"}, {"tags": ["c++", "multithreading", "qt", "sockets"], "comments": [{"owner": {"reputation": 11, "user_id": 4921734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da576596036989113aedaf2a12e60ee2?s=128&d=identicon&r=PG&f=1", "display_name": "msk", "link": "https://stackoverflow.com/users/4921734/msk"}, "edited": false, "score": 0, "creation_date": 1432260682, "post_id": 30358182, "comment_id": 48863793, "body": "If someone interested. I drop my attempt to bring it to life and reimplement networking from 0. In new implementation I have QTcpServer in Main Thread who accepts connections, allocates QTcpSocket objects and calls setSocketDescriptor. But I doing all job with these sockets from separated Worker Threads (pass socket object to Decision Making Units, which exicts in one of QThread&#39;s context). Since read/write calls comes from other threads, I assume what all must work fine with any number of CPU Cores... But not absolutely sure atm. When I need to delete socket, I just call deleteLater on it."}, {"owner": {"reputation": 11, "user_id": 4921734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da576596036989113aedaf2a12e60ee2?s=128&d=identicon&r=PG&f=1", "display_name": "msk", "link": "https://stackoverflow.com/users/4921734/msk"}, "edited": false, "score": 0, "creation_date": 1432267415, "post_id": 30358182, "comment_id": 48865244, "body": "The problem of new solution is what all Network Output must be done from Main thread (which allocate Server and Sockets). I can Read from Sockets from Worker Threads, but <i>not</i> Write. Google tells what it is limitation of Qt&#39;s IO design. I dont know how to solve this and can only hope what it will be Ok to do all decision making in W.Threads and Send packets from M.Thread."}, {"owner": {"reputation": 3705, "user_id": 2531178, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93522fe839d5fa749adabca6086303b2?s=128&d=identicon&r=PG", "display_name": "Sebastian Lange", "link": "https://stackoverflow.com/users/2531178/sebastian-lange"}, "edited": false, "score": 0, "creation_date": 1456231548, "post_id": 30358182, "comment_id": 58842285, "body": "May be a bit late, but I try to accomplish something similar. Did you try setting up a worker in a QThread and use <code>QMetaObject::invokeMethod()</code> with a <code>Qt::QueuedConnection</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4921734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da576596036989113aedaf2a12e60ee2?s=128&d=identicon&r=PG&f=1", "display_name": "msk", "link": "https://stackoverflow.com/users/4921734/msk"}, "edited": false, "score": 0, "creation_date": 1432259621, "post_id": 30370824, "comment_id": 48863509, "body": "Thanks for your reply! But as I said before: I found many examples where socketDescriptor successfuly passed to Thread object&#39;s constructor function (so socketDescriptor is &quot;used&quot; immediately after incomingConnection), but I need to create Socket objects later in Thread life-cycle. I dont want to have 1 thread per connection. I need 1 thread per CPU (real processing thread). Currently I reimplement everything to create QTcpSocket objects in main thread and pass it to Worker threads. It works as I already expected in initial post. But I still dont understand whats the problem with my first try."}, {"owner": {"reputation": 1234, "user_id": 4780422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9596b4921462c9b3cde54012e8c15826?s=128&d=identicon&r=PG&f=1", "display_name": "t3ft3l--i", "link": "https://stackoverflow.com/users/4780422/t3ft3l-i"}, "reply_to_user": {"reputation": 11, "user_id": 4921734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da576596036989113aedaf2a12e60ee2?s=128&d=identicon&r=PG&f=1", "display_name": "msk", "link": "https://stackoverflow.com/users/4921734/msk"}, "edited": false, "score": 0, "creation_date": 1432272494, "post_id": 30370824, "comment_id": 48866622, "body": "Oh, ok, sorry. May be you need to look towards QThreadPool? Also, i see it only now at your part of code <code>if (!newsocket.setSocketDescriptor(sd))</code> but you have pointer to QTcpSocket, so use -&gt; operator."}, {"owner": {"reputation": 11, "user_id": 4921734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da576596036989113aedaf2a12e60ee2?s=128&d=identicon&r=PG&f=1", "display_name": "msk", "link": "https://stackoverflow.com/users/4921734/msk"}, "edited": false, "score": 0, "creation_date": 1432276232, "post_id": 30370824, "comment_id": 48868115, "body": "Yeah, I made a typo while trying to made short version of my code as an example. Thanks, fixed now. I dont see how QThreadPool can help me here. It can help to manage a lot of Threads, but I dont think what it is reasonable to create individual Thread for each Connection (I can have more than 10k connections at the same time). Currently I ended up with solution where network IO is made in Main Thread, but Packets En-/Decryption, Parsing and Decision Making (for each single Session) is made in Worker Threads (1 per CPU Core). I added some comments to first post also. Thanks for participation!"}], "tags": [], "owner": {"reputation": 1234, "user_id": 4780422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9596b4921462c9b3cde54012e8c15826?s=128&d=identicon&r=PG&f=1", "display_name": "t3ft3l--i", "link": "https://stackoverflow.com/users/4780422/t3ft3l-i"}, "is_accepted": false, "score": 0, "last_activity_date": 1432203348, "creation_date": 1432203348, "answer_id": 30370824, "question_id": 30358182, "link": "https://stackoverflow.com/questions/30358182/qt-how-to-pass-valid-socketdescriptor-to-thread/30370824#30370824", "title": "Qt how to pass valid socketDescriptor to thread", "body": "<p>I really have no idea what for you need \"pending sessions\" in this case.</p>\n\n<p>This is one of the possible ways to forward socket descriptor through <code>incomingConnection()</code> and <code>QTcpSocket</code>. We create SocketThread object, which inherits QThread</p>\n\n<pre><code>void Server::incomingConnection(qintptr handle)\n{\n    SocketThread *thread = new SocketThread(handle);\n    connect(thread, SIGNAL(finished()), thread, SLOT(deleteLater()));\n\n    thread-&gt;start();\n}\n</code></pre>\n\n<p>In contructro we initialize private member m_socketDescriptor:</p>\n\n<pre><code>SocketThread::SocketThread(qintptr descriptor, QObject *parent)\n    : QThread(parent),\n      m_socketDescriptor(descriptor)\n{\n\n}\n</code></pre>\n\n<p>If we inherit <code>QThread</code> class, so we must override <code>run()</code> method.</p>\n\n<pre><code>void SocketThread::run()\n{\n    m_socket = new QTcpSocket;\n    m_socket-&gt;setSocketDescriptor(m_socketDescriptor);\n\n    connect(m_socket, SIGNAL(readyRead()),    this, SLOT(onReadyRead()),    Qt::DirectConnection);\n    connect(m_socket, SIGNAL(disconnected()), this, SLOT(onDisconnected()), Qt::DirectConnection);\n\n    exec();\n}\n</code></pre>\n\n<p>At run as you can see we init <code>QTcpSocket</code>, set socket descriptor, connect <code>readyRead()</code> and <code>disconected()</code> signals with relevant slots and start event loop.</p>\n\n<p>At <code>readyRead()</code> we read data from socket, then disconect from host:</p>\n\n<pre><code>void SocketThread::onReadyRead()\n{\n    // get data from socket\n    m_socket-&gt;disconnectFromHost();\n}\n</code></pre>\n\n<p>At <code>onDisconnected()</code> just close your socket and leave from event loop:</p>\n\n<pre><code>void SocketThread::onDisconnected()\n{\n    m_socket-&gt;close();\n    quit();\n}\n</code></pre>\n\n<p>Its one of the possible ways.</p>\n\n<p>I hope you will be able to adapt my code to your project. Best regards</p>\n"}], "owner": {"reputation": 11, "user_id": 4921734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da576596036989113aedaf2a12e60ee2?s=128&d=identicon&r=PG&f=1", "display_name": "msk", "link": "https://stackoverflow.com/users/4921734/msk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1960, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1432275183, "creation_date": 1432148248, "last_edit_date": 1432275183, "question_id": 30358182, "link": "https://stackoverflow.com/questions/30358182/qt-how-to-pass-valid-socketdescriptor-to-thread", "title": "Qt how to pass valid socketDescriptor to thread", "body": "<p>I trying to implement threaded server application which runs 1 processing thread per physical CPU Core/Thread.\nThe goal is to spread all incoming connections over threads, threads must close connections if needed.\nMy server implementation is based on <strong>QTcpServer</strong> and reimplements <strong>incomingConnection</strong> funtion, which checks current connection counts of all underlayer Threads and pass <strong>qintptr socketDescriptor</strong> to thread-class function, which is only add this <strong>qintptr</strong> to list of \"pending sessions\".\nIn <strong>thread::run</strong> I have infinite loop, this loop is checking list of \"pending sessions\" and if it is not empty - create new <strong>QTcpSocket</strong> and pass <strong>socketDescriptor</strong> to <strong>setSocketDescriptor</strong> function of newly created Socket object.\nI see in console log what i passing valid <strong>socketDescriptor</strong> (same value as i had in <strong>incomingConnection</strong> function), <em>[wrong information, I just missed \"!\" in my \"if\" statement: but setSocketDescriptor failed with error \"Unknown Error\"]</em> edit: <strong>setSocketDescriptor</strong> function succeed, but Socket dont accept any data and even if connection closed by remote client, <strong>::socketDescriptor()</strong> returns initially passed value (must be -1 after \"connection lost\" type situation).</p>\n\n<p>Question is: what actually happened with socketDescriptor between calls of incomingConnection and next cycle of thread's loop?\nI found many examples where socketDescriptor successfuly passed to Thread object's constructor function (so socketDescriptor is \"used\" immediately after incomingConnection), but I need to create Socket objects later in Thread life-cycle.\nI can setup QTcpSocket right in incomingConnection function and it will work. I will try to do so and pass QTcpSocket to desired thread via moveToThread(), but even if it works, I want to know why my current implementation is failed.</p>\n\n<p>code (Main Thread accept connection):</p>\n\n<pre><code>void Server::incomingConnection(qintptr socketDescriptor)\n\n{\n    qDebug()&lt;&lt;Q_FUNC_INFO&lt;&lt;\"sd:\"&lt;&lt;socketDescriptor;\n\n    ServerThread* t = threads[0];\n\n    // find thread with lowest connection count\n    for (unsigned int i = 1; i &lt; CPU_Count; i++)\n    {\n        if (threads[i]-&gt;getConnectionCount() &lt; t-&gt;getConnectionCount())\n            t = threads[i];\n    }\n\n    t-&gt;newConnection(socketDescriptor);\n}\n</code></pre>\n\n<p>code (pass socketDescriptor to Thread object for further use):</p>\n\n<pre><code>void ServerThread::newConnection(qintptr socketDescriptor)\n{\n// QList&lt;qintptr&gt; sessions_pending;\n    sessions_pending.append(socketDescriptor);\n}\n</code></pre>\n\n<p>code (trying to create QTcpSocket in ServerThread::run):</p>\n\n<pre><code>    if (sessions_pending.count())\n    {\n        foreach (qintptr sd, sessions_pending)\n        {\n            qDebug()&lt;&lt;\"create socket, descriptor : \"&lt;&lt;sd; // show same value as incomingConnection\n\n            QTcpSocket* newSocket = new QTcpSocket(0);\n            if (!newsocket-&gt;setSocketDescriptor(sd))\n                qDebug()&lt;&lt;\"Error during socket creation : \"&lt;&lt;s-&gt;socket-&gt;errorString()&lt;&lt;s-&gt;socket-&gt;error();\n            // output: \"Unknown error\" QAbstractSocket::UnknownSocketError\n\n            // .. here was code which store QTcpSocket and so on ..\n        }\n        sessions_pending.clear();\n    }\n</code></pre>\n"}, {"tags": ["c++", "pointers"], "comments": [{"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 1, "creation_date": 1432148174, "post_id": 30358122, "comment_id": 48808025, "body": "automatic storage duration.  variables go out of scope at the end of their block.  In real life, they come off the stack at the end of the function."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 2, "creation_date": 1432148276, "post_id": 30358122, "comment_id": 48808082, "body": "Obligatory: in modern C++, if you have <code>delete</code> in application code, you are doing it wrong. Use <code>shared_ptr</code> and <code>unique_ptr</code> (or other smart pointers), and let them delete the object when they go out of scope (and if deletion is appropriate). This is called RAII."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1432148324, "post_id": 30358122, "comment_id": 48808110, "body": "Please read any book of any programming language regarding pointers. (or have a video: <a href=\"https://www.youtube.com/watch?v=i49_SNt4yfk\" rel=\"nofollow noreferrer\">youtube.com/watch?v=i49_SNt4yfk</a>)"}, {"owner": {"reputation": 6480, "user_id": 637801, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4d3579c42c83ae8dfa42f97dc57754e0?s=128&d=identicon&r=PG", "display_name": "IronMensan", "link": "https://stackoverflow.com/users/637801/ironmensan"}, "edited": false, "score": 0, "creation_date": 1432148330, "post_id": 30358122, "comment_id": 48808113, "body": "&quot;and the pointer is set to point an nothing&quot;  That doesn&#39;t happen automatically.  You don&#39;t really need it here, but you should add <code>obj = NULL;</code> at the end of the loop after the delete."}, {"owner": {"reputation": 4161, "user_id": 449215, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/02b9a3cc087554f3426b4c83c1c68bff?s=128&d=identicon&r=PG", "display_name": "Dov Grobgeld", "link": "https://stackoverflow.com/users/449215/dov-grobgeld"}, "edited": false, "score": 2, "creation_date": 1432148337, "post_id": 30358122, "comment_id": 48808121, "body": "Your assumptions are a bit off. The <code>delete</code> function does not &quot;set to point to nothing&quot;. The <code>delete</code> call does not touch the value of <code>obj</code> at all. It still points to the same memory location. The difference is though that it points to an /unallocated/ memory location, and trying to access it may lead to unexpected errors. Thus subsequently overriding <code>obj</code> with a new value is perfectly ok."}, {"owner": {"reputation": 13376, "user_id": 873025, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/d8rRW.jpg?s=128&g=1", "display_name": "Snps", "link": "https://stackoverflow.com/users/873025/snps"}, "edited": false, "score": 0, "creation_date": 1432148344, "post_id": 30358122, "comment_id": 48808125, "body": "the function <code>someMethodThatReturnsNewMyObject</code> can&#39;t return an <i>object</i> as that would not compile. It must return a <i>pointer</i> to an object."}, {"owner": {"reputation": 1774, "user_id": 3861449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5cffc01b789b8262766e32eddbcfd7?s=128&d=identicon&r=PG&f=1", "display_name": "zephyr", "link": "https://stackoverflow.com/users/3861449/zephyr"}, "edited": false, "score": 0, "creation_date": 1432148359, "post_id": 30358122, "comment_id": 48808135, "body": "So why does this apply to the pointer, and not the memory pointed at, if that memory was created in the same scope as the pointer? If I remove the <code>delete</code>, I get a memory leak, and going out of scope does not automatically delete all the allocations of new <code>MyObject</code> objects."}, {"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 0, "creation_date": 1432148424, "post_id": 30358122, "comment_id": 48808177, "body": "the memory is allocated dynamically at run time, it&#39;s not allocated in the function&#39;s callstack, it&#39;s elsewhere on the heap."}, {"owner": {"reputation": 13376, "user_id": 873025, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/d8rRW.jpg?s=128&g=1", "display_name": "Snps", "link": "https://stackoverflow.com/users/873025/snps"}, "edited": false, "score": 0, "creation_date": 1432148665, "post_id": 30358122, "comment_id": 48808339, "body": "<a href=\"http://stackoverflow.com/questions/22146094/why-should-i-use-a-pointer-rather-than-the-object-itself?rq=1\" title=\"why should i use a pointer rather than the object itself\">stackoverflow.com/questions/22146094/&hellip;</a>"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1432372723, "post_id": 30358122, "comment_id": 48908670, "body": "@zephyr The purpose of heap is, you can have persistent objects there. Raw pointer does not keep track of other pointers pointing to same object, so a pointer going out of scope doesn&#39;t say anything about the the memory it points to needing to be deleted. You need to (and <i>should</i>) wrap the raw pointer in a smart pointer of right type to achieve automatic, safe deletion."}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 1729900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d90aa09b17254a1a4dbbcd13b268e53?s=128&d=identicon&r=PG", "display_name": "Jim Stitzel", "link": "https://stackoverflow.com/users/1729900/jim-stitzel"}, "is_accepted": false, "score": 1, "last_activity_date": 1432148522, "creation_date": 1432148522, "answer_id": 30358249, "question_id": 30358122, "link": "https://stackoverflow.com/questions/30358122/details-about-deleting-a-variable-in-c/30358249#30358249", "title": "Details about deleting a variable in c++", "body": "<p>The pointer itself gets deleted when the program terminates. You're probably not being required to delete the pointer itself because you're reusing it, and it occupies the same amount of space in memory for the duration of its existence. The memory being pointed to, however, is being recycled with each iteration of your loop in order to keep from filling your memory up. This wouldn't be a problem if your <em>for</em> loop only runs a few times, but if you're looping a lot without de-allocating that space it <em>could</em> potentially fill up your memory and crash your program. </p>\n"}, {"tags": [], "owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "is_accepted": false, "score": 1, "last_activity_date": 1432148568, "creation_date": 1432148568, "answer_id": 30358270, "question_id": 30358122, "link": "https://stackoverflow.com/questions/30358122/details-about-deleting-a-variable-in-c/30358270#30358270", "title": "Details about deleting a variable in c++", "body": "<p>The <code>delete</code> keyword deletes the memory that a pointer points to. It does not delete the pointer itself.</p>\n\n<p>How a pointer is deallocated depends on where it is declared. If your example code is in a method/function, it gets declared on the stack and is released when the method/function returns. If the pointer is a global variable, then it would live the life of your program.</p>\n"}, {"comments": [{"owner": {"reputation": 1774, "user_id": 3861449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5cffc01b789b8262766e32eddbcfd7?s=128&d=identicon&r=PG&f=1", "display_name": "zephyr", "link": "https://stackoverflow.com/users/3861449/zephyr"}, "edited": false, "score": 1, "creation_date": 1432148692, "post_id": 30358276, "comment_id": 48808359, "body": "Thanks, that helps. I was mis-remembering about what delete actually did and thought it also set the pointer to nothing. I think I was remembering the tandem commands <code>delete obj</code> and <code>obj = NULL</code>."}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "reply_to_user": {"reputation": 1774, "user_id": 3861449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5cffc01b789b8262766e32eddbcfd7?s=128&d=identicon&r=PG&f=1", "display_name": "zephyr", "link": "https://stackoverflow.com/users/3861449/zephyr"}, "edited": false, "score": 0, "creation_date": 1432148864, "post_id": 30358276, "comment_id": 48808455, "body": "Yes, that (<code>delete obj; obj = NULL;</code>) was a common idiom in older C++ code though I never liked it.  In modern code, you shouldn&#39;t see it any more due to the pervasive use of smart pointers (which, internally, will do exactly that, of course)."}], "tags": [], "owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "is_accepted": true, "score": 5, "last_activity_date": 1432148602, "creation_date": 1432148602, "answer_id": 30358276, "question_id": 30358122, "link": "https://stackoverflow.com/questions/30358122/details-about-deleting-a-variable-in-c/30358276#30358276", "title": "Details about deleting a variable in c++", "body": "<p>The pointer (the variable <code>obj</code>) has <a href=\"http://en.cppreference.com/w/cpp/language/storage_duration\"><strong>automatic storage duration</strong></a> \u2013 just like the variable <code>i</code>.  The compiler will emit code to automatically allocate memory for such a variable and release it when it goes out of scope; after invoking any destructor.  This memory will come from the stack at run-time, which makes it extremely fast to allocate and free.</p>\n\n<p>By the way, calling <code>delete obj</code> does <em>not</em> \u201cset the pointer to point to nothing\u201d.  At least if you mean by this that the pointer is modified.  It will continue to have whatever value it had before but that value will no longer point to a valid memory location.</p>\n"}, {"tags": [], "owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "is_accepted": false, "score": 1, "last_activity_date": 1432148771, "creation_date": 1432148771, "answer_id": 30358332, "question_id": 30358122, "link": "https://stackoverflow.com/questions/30358122/details-about-deleting-a-variable-in-c/30358332#30358332", "title": "Details about deleting a variable in c++", "body": "<blockquote>\n  <p>the memory space that it is pointing to is expunged, and the pointer is set to <strong>point an nothing</strong>.</p>\n</blockquote>\n\n<p>Forgiving the typo, the pointer is <em>not</em> changed.  It still points to where the object was before <code>delete</code> was called.  After deletion, using the object through the pointer is \"bad\".  It might work and access the previous content.  It might access total garbage (like from memory reuse).  Calling methods through the pointer could well jump into space, hopefully segfalting instead of reformatting your disks.</p>\n\n<p>You do want the pointer variable to remain.  It gets used each iteration.  <code>delete</code> is useful to free the memory (and run any destructors) in the object a pointer points to.</p>\n"}, {"tags": [], "owner": {"reputation": 8730, "user_id": 551514, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/606c8931ba3660ab28aad15d82840dd4?s=128&d=identicon&r=PG", "display_name": "resultsway", "link": "https://stackoverflow.com/users/551514/resultsway"}, "is_accepted": false, "score": 1, "last_activity_date": 1432149223, "last_edit_date": 1432149223, "creation_date": 1432148890, "answer_id": 30358366, "question_id": 30358122, "link": "https://stackoverflow.com/questions/30358122/details-about-deleting-a-variable-in-c/30358366#30358366", "title": "Details about deleting a variable in c++", "body": "<p>when you do : delete obj</p>\n\n<p>Then you are marking the memory location pointed by obj to be deleted and will be returned to the system.\n<code>Its a bit tricky here larger chucks are mmap'd</code> and <code>smaller ones are managed by heap and deleting it will not be reflected in the system unless it is the topmost</code>. If it is not the topmost in the heap, then brk/sbrk will not be moved and that will be reused when you next ask/allocate a size same or smaller than then one that is marked to be deleted. The algorithm is bit more complicated but that is the gist.</p>\n\n<p>In your code, in the second iteration obj can point to a entirely different chunk/block.</p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1432149019, "creation_date": 1432149019, "answer_id": 30358409, "question_id": 30358122, "link": "https://stackoverflow.com/questions/30358122/details-about-deleting-a-variable-in-c/30358409#30358409", "title": "Details about deleting a variable in c++", "body": "<blockquote>\n  <p>Now I know when something is deleted like this, the memory space that it is pointing to is expunged,</p>\n</blockquote>\n\n<p>What the run time environment does with the memory is not specified by the language. The language only specifies that using that memory is undefined behavior.</p>\n\n<blockquote>\n  <p>and the pointer is set to point an nothing.</p>\n</blockquote>\n\n<p>That is not correct. The value of the pointer remains what it was. It points to memory that is not valid any more.</p>\n\n<blockquote>\n  <p>When does the pointer itself, that is, the memory space taken up by the pointer, get deleted</p>\n</blockquote>\n\n<p>It's implementation specific. In common implementations, the memory gets reclaimed by the run time environemnt when the function returns. As per the language, the life of the pointer ends when the scope in which it is defined ends. Using the memory occupied by the pointer after its scope has ended is undefined behavior.</p>\n\n<p>If you had:</p>\n\n<pre><code>MyObject** ptr = NULL:\nfor (int i = 0; i &lt; 100000000; i++){\n\n    // obj is defined in the scope of the for loop.\n    // It's life ends when the for loop ends.\n    MyObject* obj = someMethodThatReturnsNewMyObject();\n\n    obj-&gt;doSomething();\n    delete obj;\n\n    // Make ptr point to the address of obj.\n    ptr = &amp;obj;\n}\n\n*ptr = NULL;  // This is undefined behavior since ptr\n              // points to memory that is not valid any more.\n</code></pre>\n"}], "owner": {"reputation": 1774, "user_id": 3861449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5cffc01b789b8262766e32eddbcfd7?s=128&d=identicon&r=PG&f=1", "display_name": "zephyr", "link": "https://stackoverflow.com/users/3861449/zephyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 30358276, "answer_count": 6, "score": 1, "last_activity_date": 1432149223, "creation_date": 1432148057, "last_edit_date": 1432149143, "question_id": 30358122, "link": "https://stackoverflow.com/questions/30358122/details-about-deleting-a-variable-in-c", "title": "Details about deleting a variable in c++", "body": "<p>I'm trying to understand exactly what happens to deleted variables in c++. Let's say I have something like the following.</p>\n\n<pre><code>MyObject * obj;\n\nfor (int i = 0; i &lt; 100000000; i++){\n    obj = someMethodThatReturnsNewMyObject();\n    obj-&gt;doSomething();\n    delete obj;\n}\n</code></pre>\n\n<p>Now, upon instantiation, <code>obj</code> is a pointer to a <code>MyObject</code> object. It is first initialized by the line <code>obj = someMethodThatReturnsNewMyObject();</code>. Then some method is called just for fun, and <code>obj</code> is deleted. Now I know when something is deleted like this, the memory space that it is pointing to is expunged<strike>, and the pointer is set to point an nothing</strike>.</p>\n\n<p>But, then when the for loop comes back around, I re-initialize the pointer, causing it to allocate a new memory space and <code>obj</code> then points at this new space instead. But, at no point was the pointer itself removed from memory. Throughout the loop it only ever points at whatever I tell it to point to or points at nothing (upon deletion).</p>\n\n<p>My question then, is this: When does the pointer itself, that is, the memory space taken up by the pointer, get deleted and why is it not under my requirements to have to delete that if I am required to delete the memory pointed at?</p>\n"}, {"tags": ["c++", "collision-detection", "collision", "polycode"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1432148273, "post_id": 30358103, "comment_id": 48808079, "body": "<a href=\"http://polycode.org/tutorial/2d_physics\" rel=\"nofollow noreferrer\">polycode.org/tutorial/2d_physics</a> looks promising.  There are a ton of goole hits for polycode collision detection.  Actually, it looks like they are all 2D style.  Hmm."}, {"owner": {"reputation": 127, "user_id": 3450421, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ece0739cf183aa855da9790088ee8fc6?s=128&d=identicon&r=PG&f=1", "display_name": "TreeZ", "link": "https://stackoverflow.com/users/3450421/treez"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1432148790, "post_id": 30358103, "comment_id": 48808412, "body": "Yeah, there literally isn&#39;t any simple and short example."}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 3450421, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ece0739cf183aa855da9790088ee8fc6?s=128&d=identicon&r=PG&f=1", "display_name": "TreeZ", "link": "https://stackoverflow.com/users/3450421/treez"}, "edited": false, "score": 0, "creation_date": 1432233485, "post_id": 30365354, "comment_id": 48852748, "body": "Thanks, this was really helpful."}, {"owner": {"reputation": 339, "user_id": 3452807, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2a2b7723b12bfc170206e14733521f2b?s=128&d=identicon&r=PG", "display_name": "fodinabor", "link": "https://stackoverflow.com/users/3452807/fodinabor"}, "reply_to_user": {"reputation": 127, "user_id": 3450421, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ece0739cf183aa855da9790088ee8fc6?s=128&d=identicon&r=PG&f=1", "display_name": "TreeZ", "link": "https://stackoverflow.com/users/3450421/treez"}, "edited": false, "score": 0, "creation_date": 1432234895, "post_id": 30365354, "comment_id": 48853577, "body": "Cool, if you have any further questions you&#39;ll find me on Polycode&#39;s IRC channel ;-)"}], "tags": [], "owner": {"reputation": 339, "user_id": 3452807, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2a2b7723b12bfc170206e14733521f2b?s=128&d=identicon&r=PG", "display_name": "fodinabor", "link": "https://stackoverflow.com/users/3452807/fodinabor"}, "is_accepted": false, "score": 0, "last_activity_date": 1432186582, "creation_date": 1432186582, "answer_id": 30365354, "question_id": 30358103, "link": "https://stackoverflow.com/questions/30358103/how-to-make-collision-detection-in-polycode-3d/30365354#30365354", "title": "How to make collision detection in Polycode 3D", "body": "<p>Have a look at:</p>\n\n<p><a href=\"https://github.com/ivansafrin/Polycode/blob/master/Examples/C%2B%2B/Contents/3DPhysics_CollisionOnly/HelloPolycodeApp.cpp\" rel=\"nofollow\">https://github.com/ivansafrin/Polycode/blob/master/Examples/C%2B%2B/Contents/3DPhysics_CollisionOnly/HelloPolycodeApp.cpp</a></p>\n\n<p>(There's also a Lua version)</p>\n\n<p>Load your mesh as you would do normally (just don't add it to the scene) and use SHAPE_MESH instead of SHAPE_BOX when adding it to the Scene as Collision Entity.</p>\n"}], "owner": {"reputation": 127, "user_id": 3450421, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ece0739cf183aa855da9790088ee8fc6?s=128&d=identicon&r=PG&f=1", "display_name": "TreeZ", "link": "https://stackoverflow.com/users/3450421/treez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1432186582, "creation_date": 1432148021, "last_edit_date": 1432148219, "question_id": 30358103, "link": "https://stackoverflow.com/questions/30358103/how-to-make-collision-detection-in-polycode-3d", "title": "How to make collision detection in Polycode 3D", "body": "<p>Can someone give me some example or some guidance on how to make collision detection in Polycode (I'm using it in Linux)?</p>\n\n<p>I would like to check collision with \"ScenePrimitive\" and some mesh that I loaded into my game.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 1, "creation_date": 1432148129, "post_id": 30358097, "comment_id": 48807996, "body": "declare <code>int result</code> OUTSIDE of the if, e.g. before you try to use it."}, {"owner": {"reputation": 503, "user_id": 1280961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mtA9d.jpg?s=128&g=1", "display_name": "wonko realtime", "link": "https://stackoverflow.com/users/1280961/wonko-realtime"}, "edited": false, "score": 0, "creation_date": 1432148369, "post_id": 30358097, "comment_id": 48808139, "body": "if you&#39;re fine abusing the language, you could do something like   struct Foo { operator int() { return 42; } }; for (int i = Foo(); i != 0;) { /* do stuff */ break; }"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1432148710, "post_id": 30358097, "comment_id": 48808364, "body": "Well, your logic would apply if you really had &quot;assignment operator&quot; in your code. But you don&#39;t. The <code>=</code> is not an operator at all and <code>int result = Foo()</code> is not an expression. It is a declaration. Declaration are not expressions, which requires special treatment for this situation and imposes restrictions on its usability."}, {"owner": {"reputation": 93509, "user_id": 4086, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e4a1b4bf6865eddd0edfe8cb90361c84?s=128&d=identicon&r=PG", "display_name": "Ferruccio", "link": "https://stackoverflow.com/users/4086/ferruccio"}, "edited": false, "score": 1, "creation_date": 1432148742, "post_id": 30358097, "comment_id": 48808387, "body": "Related question: <a href=\"http://stackoverflow.com/questions/190748/why-cant-i-put-a-variable-declaration-in-the-test-portion-of-a-while-loop\" title=\"why cant i put a variable declaration in the test portion of a while loop\">stackoverflow.com/questions/190748/&hellip;</a>"}, {"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1432148745, "post_id": 30358097, "comment_id": 48808391, "body": "You can&#39;t declare variables in expressions, which is the main reason why it fails."}, {"owner": {"reputation": 363, "user_id": 1655750, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f2c83617fc9e9f23f8e34bd2f8c83bed?s=128&d=identicon&r=PG", "display_name": "Saage", "link": "https://stackoverflow.com/users/1655750/saage"}, "edited": false, "score": 0, "creation_date": 1432148754, "post_id": 30358097, "comment_id": 48808396, "body": "&quot;The = is not an operator at all.&quot; - isn&#39;t it? Care to elaborate?"}, {"owner": {"reputation": 13384, "user_id": 451600, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/qYIUW.jpg?s=128&g=1", "display_name": "Captain Giraffe", "link": "https://stackoverflow.com/users/451600/captain-giraffe"}, "edited": false, "score": 1, "creation_date": 1432148797, "post_id": 30358097, "comment_id": 48808413, "body": "Related: <a href=\"http://stackoverflow.com/questions/11217179/double-as-true-false\">stackoverflow.com/questions/11217179/double-as-true-false</a>"}, {"owner": {"reputation": 538, "user_id": 2950316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7716c1ef06d41777a5dee35a8116c2e5?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/2950316/alexander"}, "edited": false, "score": 1, "creation_date": 1432148859, "post_id": 30358097, "comment_id": 48808451, "body": "similar quesion : <a href=\"http://stackoverflow.com/questions/14620898/how-does-one-declare-a-variable-inside-an-if-statement\" title=\"how does one declare a variable inside an if statement\">stackoverflow.com/questions/14620898/&hellip;</a>"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1432148873, "post_id": 30358097, "comment_id": 48808467, "body": "@Saage: What you have in your code is an <i>initialization</i>, not an assignment. When <code>=</code> is used in initialization, it is not an assignment operator at all, it is just a formal syntactic element of initialization syntax. It has no relation to assignment operator whatsoever. Just like the comma in declaration <code>int a,b;</code> has nothing to do with comma operator, <code>=</code> in initialization syntax has nothing to do with assignment operator."}, {"owner": {"reputation": 363, "user_id": 1655750, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f2c83617fc9e9f23f8e34bd2f8c83bed?s=128&d=identicon&r=PG", "display_name": "Saage", "link": "https://stackoverflow.com/users/1655750/saage"}, "edited": false, "score": 0, "creation_date": 1432149226, "post_id": 30358097, "comment_id": 48808648, "body": "Indeed, I forgot about that! But still, initialization returns the value of the just-assigned variable, does it not? So the only reason my code doesn&#39;t work is because the standard defined <code>if</code> syntax in way that doesn&#39;t allow my trick, right?"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1432149448, "post_id": 30358097, "comment_id": 48808755, "body": "@Saage: No, it doesn&#39;t. In C++ only <i>expressions</i> can &quot;return&quot; something. Declaration is not an expression (regardless of whether it includes an initializer or not). Declarations cannot be used as expressions. They don&#39;t &quot;return&quot; anything."}], "answers": [{"comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 2, "creation_date": 1432148236, "post_id": 30358159, "comment_id": 48808060, "body": "...and add additional scope if you want <code>result</code> to have a specific lifetime tied to the <code>if</code> statement."}, {"owner": {"reputation": 363, "user_id": 1655750, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f2c83617fc9e9f23f8e34bd2f8c83bed?s=128&d=identicon&r=PG", "display_name": "Saage", "link": "https://stackoverflow.com/users/1655750/saage"}, "edited": false, "score": 3, "creation_date": 1432148356, "post_id": 30358159, "comment_id": 48808132, "body": "&quot;declaring a variable within an if statement is not supported&quot; - it is actually. Writing if (int result = Foo()) { /*use result*/ } compiles and works as expected."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 3, "creation_date": 1432148505, "post_id": 30358159, "comment_id": 48808228, "body": "This is incorrect, you can declare a variable within the condition of an if statement, draft standard section <code>6.4p3</code>"}], "tags": [], "owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "is_accepted": false, "score": 7, "last_activity_date": 1432151584, "last_edit_date": 1432151584, "creation_date": 1432148175, "answer_id": 30358159, "question_id": 30358097, "link": "https://stackoverflow.com/questions/30358097/why-is-the-following-code-illegal-in-c/30358159#30358159", "title": "Why is the following code illegal in C++", "body": "<p>The logic is supported, but declaring a variable within an <code>if</code> statement and using it this way is not. The reason is related to the fact that an initializer works differently than a regular assignment, but working around this is easy and trivial.</p>\n\n<p>Just do something like this instead.</p>\n\n<pre><code>int result;\n\nif ((result = Foo()) != 0) {\n    // use result\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 363, "user_id": 1655750, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f2c83617fc9e9f23f8e34bd2f8c83bed?s=128&d=identicon&r=PG", "display_name": "Saage", "link": "https://stackoverflow.com/users/1655750/saage"}, "edited": false, "score": 0, "creation_date": 1432148652, "post_id": 30358224, "comment_id": 48808331, "body": "I just don&#39;t see why it is illegal. The real reason I tried this construct was because I tried to check if a certain key-value pair existed in a map, for example ((map&lt;int, int&gt;::iterator it = mymap.find(1)) != mymap.end() &amp;&amp; it-&gt;second == 1) { /* do stuff*/ }. It is not beautiful, but it kind of makes sense to do that in a single statement."}], "tags": [], "owner": {"reputation": 35319, "user_id": 871910, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f073f5ca74b61813e689bbda8d12ba2b?s=128&d=identicon&r=PG", "display_name": "zmbq", "link": "https://stackoverflow.com/users/871910/zmbq"}, "is_accepted": false, "score": 0, "last_activity_date": 1432148425, "creation_date": 1432148425, "answer_id": 30358224, "question_id": 30358097, "link": "https://stackoverflow.com/questions/30358097/why-is-the-following-code-illegal-in-c/30358224#30358224", "title": "Why is the following code illegal in C++", "body": "<p>It fails because it's illegal. It's also ugly. @Jonathan Wood suggested declaring the variable outside the <code>if</code>. I suggest calling <code>Foo</code> outside, too:</p>\n\n<pre><code>int result = Foo();\nif(result!=0) ...\n</code></pre>\n\n<p>The <code>(x=f())!=y</code> construct, while legal as an <code>if</code> condition, only makes sense in a loop, where</p>\n\n<p>`while((c=getchar())!='\\n)\n        ... do something with c ...</p>\n\n<p>Is the shorter and nicer equivalent of</p>\n\n<pre><code>c = getchar();\nwhile(c!='\\n')\n{\n    ...\n    c = getchar(c);\n}\n</code></pre>\n\n<p>It saves writing the call to getchar() twice. It saves nothing when used in an <code>if</code>, so there's no point in using it. </p>\n"}, {"tags": [], "owner": {"reputation": 13384, "user_id": 451600, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/qYIUW.jpg?s=128&g=1", "display_name": "Captain Giraffe", "link": "https://stackoverflow.com/users/451600/captain-giraffe"}, "is_accepted": false, "score": 2, "last_activity_date": 1432149381, "last_edit_date": 1495535287, "creation_date": 1432149042, "answer_id": 30358413, "question_id": 30358097, "link": "https://stackoverflow.com/questions/30358097/why-is-the-following-code-illegal-in-c/30358413#30358413", "title": "Why is the following code illegal in C++", "body": "<p>Bjarne uses this construct as a scope restrictor in 6.3.2.1 <em>The C++ programming language</em> as a recommendation.</p>\n\n<p>Use:</p>\n\n<pre><code>if (int result = Foo()) {\n    // use non-zero result\n}\n</code></pre>\n\n<p>It is particularly useful with pointers</p>\n\n<pre><code>if (Foo* result = GetFoo()) {\n    // use valid Foo\n}\n</code></pre>\n\n<p>The <code>!=0</code> part is redundant as truthiness is <code>!=0</code>. </p>\n\n<p>The extended construct with the comparison is not allowed. </p>\n\n<p>Further discussion of this construct from <a href=\"https://stackoverflow.com/questions/11217179/double-as-true-false\">here</a></p>\n"}, {"comments": [{"owner": {"reputation": 363, "user_id": 1655750, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f2c83617fc9e9f23f8e34bd2f8c83bed?s=128&d=identicon&r=PG", "display_name": "Saage", "link": "https://stackoverflow.com/users/1655750/saage"}, "edited": false, "score": 0, "creation_date": 1432149411, "post_id": 30358462, "comment_id": 48808724, "body": "Okay, I guess I have no more questions then. Thanks for the reply!"}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 3, "last_activity_date": 1432154088, "last_edit_date": 1432154088, "creation_date": 1432149217, "answer_id": 30358462, "question_id": 30358097, "link": "https://stackoverflow.com/questions/30358097/why-is-the-following-code-illegal-in-c/30358462#30358462", "title": "Why is the following code illegal in C++", "body": "<p>Your reasoning seems to be based on the assumption that <code>=</code> in </p>\n\n<pre><code>if ((int result = Foo()) != 0) \n</code></pre>\n\n<p>is an assignment operator and that <code>int result = Foo()</code> is \"just an expression\" that evaluates to something.</p>\n\n<p>This is not true.</p>\n\n<p>The <code>int result = Foo()</code> part is not an expression in C++. It is a declaration with an initializer. The <code>=</code> in initializer syntax is not an assignment operator at all. It is just a syntactic element that coincidentally uses the same character as assignment operator. The <code>int result = Foo()</code> is not an expression and it does not \"evaluate\" to any result.</p>\n\n<p>Because if the above, support for something like</p>\n\n<pre><code>if (int result = Foo())\n</code></pre>\n\n<p>requires special treatment, which severely limits the flexibility of this syntax. What you tried in your code goes outside the bounds of what's allowed by that special treatment.</p>\n"}, {"comments": [{"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1432154906, "post_id": 30358485, "comment_id": 48811871, "body": "Be careful if evaluating Foo() has side effects."}], "tags": [], "owner": {"reputation": 877, "user_id": 4131276, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/I3fNl.jpg?s=128&g=1", "display_name": "Emiliano Sangoi", "link": "https://stackoverflow.com/users/4131276/emiliano-sangoi"}, "is_accepted": false, "score": 0, "last_activity_date": 1432149285, "creation_date": 1432149285, "answer_id": 30358485, "question_id": 30358097, "link": "https://stackoverflow.com/questions/30358097/why-is-the-following-code-illegal-in-c/30358485#30358485", "title": "Why is the following code illegal in C++", "body": "<p>Try this:</p>\n\n<pre><code>if ( int i = (Foo() != 0) ? Foo() : 0 ){\n        cout &lt;&lt; \"Hello. Number i = \" &lt;&lt; i;\n    }   \n</code></pre>\n"}], "owner": {"reputation": 363, "user_id": 1655750, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f2c83617fc9e9f23f8e34bd2f8c83bed?s=128&d=identicon&r=PG", "display_name": "Saage", "link": "https://stackoverflow.com/users/1655750/saage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 801, "favorite_count": 0, "closed_date": 1432217341, "accepted_answer_id": 30358462, "answer_count": 5, "score": 3, "last_activity_date": 1432154088, "creation_date": 1432147992, "question_id": 30358097, "link": "https://stackoverflow.com/questions/30358097/why-is-the-following-code-illegal-in-c", "closed_reason": "Duplicate", "title": "Why is the following code illegal in C++", "body": "<p>I want to create an <code>if</code> where a variable is declared, assigned and checked. If the variable's value is acceptable, I want to use it inside <code>if</code> body. Here's an example of how I thought I could do that:</p>\n\n<pre><code>if ((int result = Foo()) != 0) {\n    // use result\n}\n</code></pre>\n\n<p>I assumed that <code>Foo()</code> returns some value, which is assigned to <code>result</code>, and returned by assignment operator <code>=</code>, and finally checked against <code>0</code> in <code>!= 0</code>. Unfortunately, it results in a compilation error:</p>\n\n<pre><code>main.cpp:31:10: error: expected primary-expression before \u2018int\u2019\nif ((int i = Foo()) != 0)\n     ^                                          \nmain.cpp:31:10: error: expected \u2018)\u2019 before \u2018int\u2019\n</code></pre>\n\n<p>Why is this error happening? And what ways could there be to fix it?</p>\n"}, {"tags": ["c++", "visual-studio-2013"], "comments": [{"owner": {"reputation": 313, "user_id": 4380490, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/xZ6TW.png?s=128&g=1", "display_name": "Zimad", "link": "https://stackoverflow.com/users/4380490/zimad"}, "edited": false, "score": 0, "creation_date": 1432148372, "post_id": 30358092, "comment_id": 48808145, "body": "This has already been answered at this post:     <a href=\"http://stackoverflow.com/questions/601268/visual-c-include-files-from-other-projects-in-the-same-solution\" title=\"visual c include files from other projects in the same solution\">stackoverflow.com/questions/601268/&hellip;</a>"}, {"owner": {"reputation": 2368, "user_id": 1227353, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c1ea8dbb617e4f4026e5f9bff7947bac?s=128&d=identicon&r=PG", "display_name": "rcplusplus", "link": "https://stackoverflow.com/users/1227353/rcplusplus"}, "reply_to_user": {"reputation": 313, "user_id": 4380490, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/xZ6TW.png?s=128&g=1", "display_name": "Zimad", "link": "https://stackoverflow.com/users/4380490/zimad"}, "edited": false, "score": 0, "creation_date": 1432148526, "post_id": 30358092, "comment_id": 48808245, "body": "@Zimad But both <code>proj1</code> and <code>proj2</code> create <code>.exe</code> files not <code>.lib</code> files"}, {"owner": {"reputation": 6085, "user_id": 425871, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/58MZp.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/425871/steve"}, "edited": false, "score": 0, "creation_date": 1432149237, "post_id": 30358092, "comment_id": 48808651, "body": "There is no need to make a copy of the source file. Just right click somewhere in the second project, go to <code>Add | Existing Item...</code> and browse to the source file in the tree of the other project."}, {"owner": {"reputation": 2368, "user_id": 1227353, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c1ea8dbb617e4f4026e5f9bff7947bac?s=128&d=identicon&r=PG", "display_name": "rcplusplus", "link": "https://stackoverflow.com/users/1227353/rcplusplus"}, "reply_to_user": {"reputation": 6085, "user_id": 425871, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/58MZp.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/425871/steve"}, "edited": false, "score": 0, "creation_date": 1432149491, "post_id": 30358092, "comment_id": 48808780, "body": "@Steve I tried that but I still get the linker errors"}, {"owner": {"reputation": 6085, "user_id": 425871, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/58MZp.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/425871/steve"}, "edited": false, "score": 0, "creation_date": 1432149573, "post_id": 30358092, "comment_id": 48808836, "body": "Did you add the <code>.cpp</code> file to the project, or just the header? Without the implementation, you&#39;ll get unresolved external errors from the linker."}, {"owner": {"reputation": 3618, "user_id": 2394945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g5WxC.png?s=128&g=1", "display_name": "Moby Disk", "link": "https://stackoverflow.com/users/2394945/moby-disk"}, "edited": false, "score": 0, "creation_date": 1432149783, "post_id": 30358092, "comment_id": 48808955, "body": "Post the linker errors.  It sounds like you aren&#39;t linking to the .obj file, but we can&#39;t tell without seeing the errors.  What you did with the .h file is correct."}, {"owner": {"reputation": 2368, "user_id": 1227353, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c1ea8dbb617e4f4026e5f9bff7947bac?s=128&d=identicon&r=PG", "display_name": "rcplusplus", "link": "https://stackoverflow.com/users/1227353/rcplusplus"}, "reply_to_user": {"reputation": 6085, "user_id": 425871, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/58MZp.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/425871/steve"}, "edited": false, "score": 0, "creation_date": 1432218787, "post_id": 30358092, "comment_id": 48843098, "body": "@Steve I added just the <code>.cpp</code> and set the <code>Additional Include Directory</code> to the where the <code>.h</code> files are."}], "owner": {"reputation": 2368, "user_id": 1227353, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c1ea8dbb617e4f4026e5f9bff7947bac?s=128&d=identicon&r=PG", "display_name": "rcplusplus", "link": "https://stackoverflow.com/users/1227353/rcplusplus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 521, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1432147961, "creation_date": 1432147961, "question_id": 30358092, "link": "https://stackoverflow.com/questions/30358092/visual-studio-share-source-files-between-projects-in-a-solution", "title": "Visual Studio - Share source files between projects in a solution", "body": "<p>I have an overall solution with two projects (let's say <code>proj1</code> and <code>proj2</code>) within it. In <code>proj1</code> there's a file called <code>foo.cpp</code> and a corresponding <code>foo.h</code>. In <code>proj2</code>  I use <code>#include \"../proj1/foo.h\"</code> so that's taken care of, but I get linker errors, and I suspect this is because it doesn't have access to <code>foo.obj</code>. </p>\n\n<p>Is there a way to set up the project preferences so that <code>proj2</code> can link to <code>proj1</code> source files without having to copy them over from project to project? I'm not linking to any external libraries if that makes it easier.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 2, "creation_date": 1432147677, "post_id": 30357987, "comment_id": 48807738, "body": "You pasted the .cpp twice instead of the .h and .cpp"}, {"owner": {"reputation": 4161, "user_id": 449215, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/02b9a3cc087554f3426b4c83c1c68bff?s=128&d=identicon&r=PG", "display_name": "Dov Grobgeld", "link": "https://stackoverflow.com/users/449215/dov-grobgeld"}, "edited": false, "score": 1, "creation_date": 1432148092, "post_id": 30357987, "comment_id": 48807975, "body": "Just a stylistic comment. Don&#39;t use char arrays in C++, which your use of <code>strcpy_s</code> indicates, use <code>std::string</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 43775, "user_id": 496223, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jKHnH.jpg?s=128&g=1", "display_name": "dynamic", "link": "https://stackoverflow.com/users/496223/dynamic"}, "is_accepted": false, "score": 3, "last_activity_date": 1432147778, "creation_date": 1432147778, "answer_id": 30358033, "question_id": 30357987, "link": "https://stackoverflow.com/questions/30357987/this-declaration-has-no-storage-class-or-type-specifier-in-c/30358033#30358033", "title": "&quot;This declaration has no storage class or type specifier in C++&quot;", "body": "<p>You can't run code outside <code>main()</code><br>\nYou can only define variables, that's why:</p>\n\n<pre><code>Cow cow4\n</code></pre>\n\n<p>Works</p>\n"}, {"tags": [], "owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": false, "score": 9, "last_activity_date": 1432147783, "creation_date": 1432147783, "answer_id": 30358037, "question_id": 30357987, "link": "https://stackoverflow.com/questions/30357987/this-declaration-has-no-storage-class-or-type-specifier-in-c/30358037#30358037", "title": "&quot;This declaration has no storage class or type specifier in C++&quot;", "body": "<p>In C++, code can only appear inside function bodies or in variable initialisers. This:</p>\n\n<pre><code>cow5 = cow6;\n</code></pre>\n\n<p>is inside neither, so it's an error. You cannot have code \"floating\" outside of a function. Put it inside <code>main</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 4921791, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f22a5e05d8b09106a0b765afac9e0b63?s=128&d=identicon&r=PG&f=1", "display_name": "jakub gros", "link": "https://stackoverflow.com/users/4921791/jakub-gros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15096, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1432198779, "creation_date": 1432147610, "last_edit_date": 1432198779, "question_id": 30357987, "link": "https://stackoverflow.com/questions/30357987/this-declaration-has-no-storage-class-or-type-specifier-in-c", "title": "&quot;This declaration has no storage class or type specifier in C++&quot;", "body": "<p>I have problem with my own class and operator =. When I try to attribute to one object of class Cow another one of the same class outside of some function I get an information \"This declaration has no storage class or type specifier in C++\". What's the problem? I'm sorry for my english.</p>\n\n<pre><code>    #include \"Header.h\"\n\nCow cow5;\nCow cow6;\ncow5 = cow6;\n\nint main()\n{\n\n    Cow cow1;\n    Cow cow2(\"cowa22\", \"hobby\", 8);\n    Cow cow3 = cow2;\n    Cow cow4;\n    cow2.operator=(cow3);\n}\n</code></pre>\n\n<hr>\n\n<pre><code>#include \"Header.h\"\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n\nCow::Cow()\n{\n    strcpy_s(name, sizeof(char)*20, \"unnamed\");\n    hobby = nullptr;\n    weight = 0;\n}\n\nCow::Cow(const char * nm, const char * ho, double wt)\n{\n    strcpy_s(name, sizeof(char) * 20, nm);\n    hobby = new char[strlen(ho) + 1];\n    strcpy_s(hobby, sizeof(char)*(strlen(ho)+1), ho);\n    weight = wt;\n}\n\nCow::Cow(const Cow &amp; c)\n{\n    strcpy_s(name, sizeof(char) * 20, c.name);\n    hobby = new char[strlen(c.hobby) + 1];\n    strcpy_s(hobby, sizeof(char)*(strlen(c.hobby) + 1), c.hobby);\n    weight = c.weight;\n}\n\nCow::~Cow()\n{\n    delete[] hobby;\n}\n\nCow &amp; Cow::operator=(const Cow &amp; c)\n{\n    if (&amp;c == this)\n        return *this;\n    delete[] hobby;\n    strcpy_s(name, sizeof(char) * 20, c.name);\n    hobby = new char[strlen(c.hobby) + 1];\n    strcpy_s(hobby, sizeof(char)*(strlen(c.hobby) + 1), c.hobby);\n    weight = c.weight;\n\n    return *this;\n}\n\nvoid Cow::ShowCow() const\n{\n    std::cout &lt;&lt; \"Name: \" &lt;&lt; name &lt;&lt; std::endl\n        &lt;&lt; \"Hobby: \" &lt;&lt; hobby &lt;&lt; std::endl \n        &lt;&lt; \"Weight: \" &lt;&lt; weight &lt;&lt; std::endl;\n\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1432147422, "post_id": 30357857, "comment_id": 48807591, "body": "It looks like your assignment to <code>listEnv[&quot;test&quot;]</code> is the address of the result of a function call."}, {"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 0, "creation_date": 1432147483, "post_id": 30357857, "comment_id": 48807633, "body": "<code>listEnv[&quot;test&quot;] = &amp;CreateEnvironment&lt;Coin&gt;;</code> assigns a pointer to the function."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2946316"}, "edited": false, "score": 0, "creation_date": 1432147504, "post_id": 30357857, "comment_id": 48807644, "body": "yes exactly. But i simply wants to store the class function pointer, call the function later and get the return value. If i set the return type to void, everything works, but not like this, which looks correct to me. What am I doing wrong?"}, {"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 0, "creation_date": 1432147559, "post_id": 30357857, "comment_id": 48807673, "body": "how are you calling the function later? (the code)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2946316"}, "edited": false, "score": 0, "creation_date": 1432147665, "post_id": 30357857, "comment_id": 48807731, "body": "I haven&#39;t got that far yet. But simply iterate through the map and auto&amp; returnVal = (it.second)(args, args) i guess"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 2, "creation_date": 1432147677, "post_id": 30357857, "comment_id": 48807737, "body": "In terms of what you are doing wrong, the code you have written will call the function, and the address of the result will be assigned to <code>listEnv[&quot;test&quot;]</code>. If you don&#39;t want the function to be called, don&#39;t use the parentheses operator on the function, as that means &quot;call the function&quot;."}, {"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 0, "creation_date": 1432147851, "post_id": 30357857, "comment_id": 48807828, "body": "why are you returning a reference to a <code>unique_ptr</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2946316"}, "edited": false, "score": 0, "creation_date": 1432147939, "post_id": 30357857, "comment_id": 48807873, "body": "well the createenvironment function creates a object and puts it inside a vector which the game iterates through and renders. Returning a reference gives me the option to manipulate the object after creating it, for example I might set it to be controlled by the player etc."}], "answers": [{"tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 2, "last_activity_date": 1432147838, "creation_date": 1432147838, "answer_id": 30358056, "question_id": 30357857, "link": "https://stackoverflow.com/questions/30357857/c-save-class-templated-function-pointer-inside-map/30358056#30358056", "title": "c++ save class templated function pointer inside map", "body": "<p>problems such as these are often much better solved with <code>std::function</code></p>\n\n<pre><code>std::map&lt;std::string, std::function&lt;void()&gt; listEnv;\n\nlistEnv.emplace(\"test\", [] {\n  CreateEnvironment&lt;Coin&gt;(sf::Vector2f(200,200), false);\n});\n</code></pre>\n\n<p>to call:</p>\n\n<pre><code>listEnv.at(\"test\")-&gt;second();\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2946316"}, "edited": false, "score": 0, "creation_date": 1432235853, "post_id": 30374747, "comment_id": 48854154, "body": "Cheers mate. Good answer as well. Next time ill come across this problem, ill know what to do"}], "tags": [], "owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "is_accepted": false, "score": 2, "last_activity_date": 1432214677, "last_edit_date": 1495535205, "creation_date": 1432213790, "answer_id": 30374747, "question_id": 30357857, "link": "https://stackoverflow.com/questions/30357857/c-save-class-templated-function-pointer-inside-map/30374747#30374747", "title": "c++ save class templated function pointer inside map", "body": "<p>Based on your post I am not sure if you are attempting to create the member function pointer and map inside the <code>CreateEnvironment</code> class or outside of it, so I'll solve what I think is the more difficult problem of pointer to a separate object's member function.</p>\n\n<p>I simplified your classes like so:</p>\n\n<h3>Environment</h3>\n\n<pre><code>struct Environment\n{\n    int i = 1;\n};\n</code></pre>\n\n<h3>Coin</h3>\n\n<pre><code>struct Coin\n{\n    int k = 0;\n};\n</code></pre>\n\n<h3>WorldEditor</h3>\n\n<pre><code>struct WorldEditor\n{\n    template &lt;typename T&gt;\n    std::unique_ptr&lt;Environment&gt; CreateEnvironment(int&amp; _j, bool _addToStatic = false)\n    {\n        return std::make_unique&lt;Environment&gt;();\n    }\n};\n</code></pre>\n\n<h3>Solution: Map an object's member fn pointer, and then call it later</h3>\n\n<p>(I will be using C++11/14 syntax in my answer)</p>\n\n<pre><code>//declare a pointer to member function in WorldEditor\nusing CreateEnvironmentPtr = std::unique_ptr&lt;Environment&gt; (WorldEditor::*)(int&amp;, bool);\n\n//declare an object of type WorldEditor, because member function pointers need a \"this\" pointer\nWorldEditor myWorldEditor;\nint myInt = 42;\n\n//map a string to the CreateEnvironment&lt;Coin&gt; function\nstd::map&lt;std::string, CreateEnvironmentPtr&gt; listEnv;\nlistEnv[\"test\"] = &amp;WorldEditor::CreateEnvironment&lt;Coin&gt;;\n\n// call the member function pointer using the instance I created, as well as\n// the mapped function\n(myWorldEditor.*listEnv[\"test\"])(myInt, false);\n\n// (printing member value to cout to show it worked)\nstd::cout &lt;&lt; (myWorldEditor.*listEnv[\"test\"])(myInt, false)-&gt;i &lt;&lt; std::endl; // prints 1\n</code></pre>\n\n<p><a href=\"http://ideone.com/ISsSXY\" rel=\"nofollow noreferrer\">Live Demo</a></p>\n\n<hr>\n\n<h2>Solution 2: use std::bind and std::function</h2>\n\n<p>Perhaps we already know the parameters to the member function call at the time we create the entry for map. Using <code>std::bind</code> with a <code>std::function</code> will help us achieve that (Similar to Richard Hodges' <a href=\"https://stackoverflow.com/a/30358056/27678\">solution</a>):</p>\n\n<pre><code>// now our \"function pointer\" is really just a std::function that takes no arguments\nusing CreateEnvironmentPtr = std::function&lt;std::unique_ptr&lt;Environment&gt;(void)&gt;;\n\n//declare an object of type WorldEditor, because member function pointers need a \"this\" pointer\nWorldEditor myWorldEditor;\nint myInt = 42;\n\n//map a string to that function pointer\n//ensure it gets called with the right args \n// by using std::bind (which will also make the arg list appear the be void at call time)\n// note that std::bind needs an instance of the class immediately after\n// listing the function it should be binding\n// only afterwards will we then pass the int&amp; and bool\nstd::map&lt;std::string, CreateEnvironmentPtr&gt; listEnv;\nlistEnv[\"test\"] = std::bind(&amp;WorldEditor::CreateEnvironment&lt;Coin&gt;, &amp;myWorldEditor, myInt, false);\n\n// the mapped function\nlistEnv[\"test\"]()-&gt;i;\n\n// (printing resulting unique_ptr&lt;Environment&gt;'s member to cout to show it worked)\nstd::cout &lt;&lt; listEnv[\"test\"]()-&gt;i &lt;&lt; std::endl; // prints 1\n</code></pre>\n\n<p><a href=\"http://ideone.com/6Gm0QY\" rel=\"nofollow noreferrer\">Live Demo 2</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2946316"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1432214677, "creation_date": 1432147107, "last_edit_date": 1432147355, "question_id": 30357857, "link": "https://stackoverflow.com/questions/30357857/c-save-class-templated-function-pointer-inside-map", "title": "c++ save class templated function pointer inside map", "body": "<p>I'm having a small problem which I can't wrap my head around.\nI have a function that looks like this:</p>\n\n<pre><code>template &lt;typename T&gt;\nstd::unique_ptr&lt;Environment&gt;&amp; CreateEnvironment(sf::Vector2f&amp; _position, bool _addToStatic = false);\n</code></pre>\n\n<p>This is my function pointer typedef</p>\n\n<pre><code>typedef std::unique_ptr&lt;Environment&gt;&amp; (WorldEditor::*CreateEnvironmentPtr)(sf::Vector2f&amp;, bool);\nstd::map&lt;std::string,CreateEnvironmentPtr&gt; listEnv;\n</code></pre>\n\n<p>And I'm trying to simply do this:</p>\n\n<pre><code>listEnv[\"test\"] = &amp;CreateEnvironment&lt;Coin&gt;(sf::Vector2f(200,200), false);\n</code></pre>\n\n<p>And i get the following error:</p>\n\n<blockquote>\n  <p><code>error C2440: '=' : cannot convert from 'std::unique_ptr&lt;_Ty&gt; *' to\n  'std::unique_ptr&lt;_Ty&gt; &amp;(__thiscall WorldEditor::* )(sf::Vector2f\n  &amp;,bool)'</code></p>\n</blockquote>\n\n<p>I understand what the error is saying, but I don't know how to solve it. Also why does it even care about the return type when I'm pointing to the address of the function?</p>\n\n<p>Best regards\nnilo</p>\n"}, {"tags": ["c++", "xcode", "macos", "terminal"], "comments": [{"owner": {"reputation": 2963, "user_id": 1855442, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61b99c64abe73180373944232b0c734f?s=128&d=identicon&r=PG", "display_name": "Pradheep", "link": "https://stackoverflow.com/users/1855442/pradheep"}, "edited": false, "score": 0, "creation_date": 1432147117, "post_id": 30357817, "comment_id": 48807415, "body": "The most common mistake is that the pacakge might be installed for a particular user or at a particular path. Make sure that you have the library/application in your path list."}, {"owner": {"reputation": 97, "user_id": 2125726, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cdb4520b6b1a500a5df2642eb3149476?s=128&d=identicon&r=PG", "display_name": "user2125726", "link": "https://stackoverflow.com/users/2125726/user2125726"}, "reply_to_user": {"reputation": 2963, "user_id": 1855442, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61b99c64abe73180373944232b0c734f?s=128&d=identicon&r=PG", "display_name": "Pradheep", "link": "https://stackoverflow.com/users/1855442/pradheep"}, "edited": false, "score": 0, "creation_date": 1432147990, "post_id": 30357817, "comment_id": 48807909, "body": "@Pradheep thanks for the quick response. Im pretty sure i have the correct user which is my user, but how do i make sure that i have the library/application in my path list ?"}, {"owner": {"reputation": 2963, "user_id": 1855442, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61b99c64abe73180373944232b0c734f?s=128&d=identicon&r=PG", "display_name": "Pradheep", "link": "https://stackoverflow.com/users/1855442/pradheep"}, "edited": false, "score": 0, "creation_date": 1432148328, "post_id": 30357817, "comment_id": 48808111, "body": "i would suggest first finding where the package is installed and then do echo $PATH in terminal to see if its in your path variable"}, {"owner": {"reputation": 97, "user_id": 2125726, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cdb4520b6b1a500a5df2642eb3149476?s=128&d=identicon&r=PG", "display_name": "user2125726", "link": "https://stackoverflow.com/users/2125726/user2125726"}, "reply_to_user": {"reputation": 2963, "user_id": 1855442, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61b99c64abe73180373944232b0c734f?s=128&d=identicon&r=PG", "display_name": "Pradheep", "link": "https://stackoverflow.com/users/1855442/pradheep"}, "edited": false, "score": 0, "creation_date": 1432148526, "post_id": 30357817, "comment_id": 48808244, "body": "@Pradheep thanks buddy, you saved the day."}, {"owner": {"reputation": 2963, "user_id": 1855442, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61b99c64abe73180373944232b0c734f?s=128&d=identicon&r=PG", "display_name": "Pradheep", "link": "https://stackoverflow.com/users/1855442/pradheep"}, "edited": false, "score": 0, "creation_date": 1432151104, "post_id": 30357817, "comment_id": 48809676, "body": "i am adding it as answer , upvote it and accept it"}], "answers": [{"tags": [], "owner": {"reputation": 2963, "user_id": 1855442, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61b99c64abe73180373944232b0c734f?s=128&d=identicon&r=PG", "display_name": "Pradheep", "link": "https://stackoverflow.com/users/1855442/pradheep"}, "is_accepted": true, "score": 0, "last_activity_date": 1432151140, "creation_date": 1432151140, "answer_id": 30359038, "question_id": 30357817, "link": "https://stackoverflow.com/questions/30357817/calling-a-osx-package-from-xcode-c-program-terminal/30359038#30359038", "title": "Calling a OSX package from xcode c++ program terminal", "body": "<p>The most common mistake is that the pacakge might be installed for a particular user or at a particular path. Make sure that you have the library/application in your path list</p>\n\n<p>To do that ,i would suggest first finding where the package is installed and then do echo $PATH in terminal to see if its in your path variable</p>\n"}], "owner": {"reputation": 97, "user_id": 2125726, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cdb4520b6b1a500a5df2642eb3149476?s=128&d=identicon&r=PG", "display_name": "user2125726", "link": "https://stackoverflow.com/users/2125726/user2125726"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 30359038, "answer_count": 1, "score": 1, "last_activity_date": 1432151140, "creation_date": 1432146981, "question_id": 30357817, "link": "https://stackoverflow.com/questions/30357817/calling-a-osx-package-from-xcode-c-program-terminal", "title": "Calling a OSX package from xcode c++ program terminal", "body": "<p>im planning to build a c++ application based on another c++ package (aria2c) i found over the internet which acts as a ready made wheel for me. I have already installed the package on my machine, but the problem is when i run <code>system(\"aria2c\");</code>  it outputs \"command not found\", whereas if i run <code>system(\"git\");</code> (which i have also installed) it will output the git's man page.</p>\n\n<p>calling \"brew\" also doesnt work whereas git, ls and some other that i tried work.</p>\n\n<p>So can someone explain to me why i cant access that package ? and if there is any solution to it ?</p>\n"}, {"tags": ["c++", "struct", "header-files", "declaration"], "comments": [{"owner": {"reputation": 140, "user_id": 4909719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43fbc2ca18b77df0b1610f4c6263613c?s=128&d=identicon&r=PG&f=1", "display_name": "Abel", "link": "https://stackoverflow.com/users/4909719/abel"}, "edited": false, "score": 0, "creation_date": 1432147163, "post_id": 30357806, "comment_id": 48807431, "body": "i would say to create the B class and include it later in the Class A declaration."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1432147447, "post_id": 30357806, "comment_id": 48807607, "body": "Do you ant people to be able to create instances of <code>B</code> or should it be something only accessible to your <code>A</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 514, "user_id": 2452562, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/262533d22c0be8926d9f00db1f39bdd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ken P", "link": "https://stackoverflow.com/users/2452562/ken-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1432147453, "creation_date": 1432147453, "answer_id": 30357941, "question_id": 30357806, "link": "https://stackoverflow.com/questions/30357806/c-header-file-referencing-a-struct-defined-below/30357941#30357941", "title": "C++ header file referencing a struct defined below", "body": "<p>Just like variables, you can forward-declare classes and structures.  For example, in your case you can do the following:</p>\n\n<pre><code>class A {\npublic:\n    struct B;\nprivate:\n    std::vector&lt;B&gt; derp;\npublic:\n    struct B { ... };\n    void foo( B b );\n};\n</code></pre>\n\n<p>Keep in mind if you forward-declare a class or structure within a class, you need to declare it with the same access level (private/protected/public) as you define it later.</p>\n"}, {"comments": [{"owner": {"reputation": 38119, "user_id": 3959454, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d3d3eb6143879550d0e5bd67a6bf647?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Savin", "link": "https://stackoverflow.com/users/3959454/anton-savin"}, "edited": false, "score": 0, "creation_date": 1432148473, "post_id": 30357984, "comment_id": 48808205, "body": "It&#39;s undefined behavior to create <code>std::vector</code> of incomplete type."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1432147607, "creation_date": 1432147607, "answer_id": 30357984, "question_id": 30357806, "link": "https://stackoverflow.com/questions/30357806/c-header-file-referencing-a-struct-defined-below/30357984#30357984", "title": "C++ header file referencing a struct defined below", "body": "<p>You could use a forward declaration of <code>B</code> before declaring <code>derp</code> if you don't want to move the definition of <code>B</code> before declaring <code>derp</code>.</p>\n\n<pre><code>class A {\n   public:\n      struct B;\n   private:\n      std::vector&lt;B&gt; derp;\n   public:\n      struct B { ... };\n      void foo(B b);\n};\n</code></pre>\n\n<p>However, from a physical layout perspective, the <code>public</code> section of a class shoud be before its <code>private</code> section. You want the <code>public</code> section to be seen by a user first.</p>\n\n<p>Given that, I think it'll be better to use:</p>\n\n<pre><code>class A {\n    public:\n        struct B { ... };\n        void foo(B b);\n    private:\n        std::vector&lt;B&gt; derp;\n};\n</code></pre>\n\n<p>That solves the problem of <code>B</code> not being declared/defined before the declaration of the member variable <code>derp</code>. It also puts the <code>public</code> section ahead of the <code>private</code> section.</p>\n"}], "owner": {"reputation": 485, "user_id": 3186067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6b160516f573107de622932aca17ba1e?s=128&d=identicon&r=PG&f=1", "display_name": "Nezo", "link": "https://stackoverflow.com/users/3186067/nezo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1432147607, "creation_date": 1432146966, "question_id": 30357806, "link": "https://stackoverflow.com/questions/30357806/c-header-file-referencing-a-struct-defined-below", "title": "C++ header file referencing a struct defined below", "body": "<p>What is considered the best practice for handling this situation?</p>\n\n<pre><code>class A {\n    private:\n        std::vector&lt;B&gt; derp;\n    public:\n        struct B { ... };\n        void foo(B b);\n}\n</code></pre>\n\n<p>(The problem is that this code would say \"error: use of undeclared identifier 'B'\"\nI think I could solve the problem by doing something like </p>\n\n<pre><code>class A {\n    public:\n        struct B { ... };\n        void foo(B b);\n    private:\n        std::vector&lt;B&gt; derp;\n}\n</code></pre>\n\n<p>But that seems strange and not like the proper solution.  Also as a side note, if I were to write that should I write it like this?</p>\n\n<pre><code>struct A {\n    struct B { ... };\n    void foo(B b);\n\n    private:\n        std::vector&lt;B&gt; derp;\n}\n</code></pre>\n"}, {"tags": ["c++", "compiler-errors"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 6, "creation_date": 1432146534, "post_id": 30357636, "comment_id": 48807087, "body": "Can you create an <a href=\"http://sscce.org\" rel=\"nofollow noreferrer\">SSCCE</a> that exhibits this behavior?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 5, "creation_date": 1432146561, "post_id": 30357636, "comment_id": 48807108, "body": "This isn&#39;t your real code, because you never even <i>built</i> <code>FrequencyNode.cpp</code>. Or are you including that into a header? Don&#39;t."}, {"owner": {"reputation": 5000, "user_id": 3856907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ub3wd.jpg?s=128&g=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/3856907/erik"}, "edited": false, "score": 2, "creation_date": 1432146640, "post_id": 30357636, "comment_id": 48807157, "body": "It looks like one of your files is #include-ing FrequencyNode.cpp. You definitely don&#39;t want that."}, {"owner": {"reputation": 9, "user_id": 2430576, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b23dc81151a07da1ac3e361690582c11?s=128&d=identicon&r=PG", "display_name": "Sersay", "link": "https://stackoverflow.com/users/2430576/sersay"}, "edited": false, "score": 0, "creation_date": 1432146657, "post_id": 30357636, "comment_id": 48807167, "body": "I didn&#39;t create the makefile, its what my professor is going to use to make the project, i assumed the makefile will create my classes from within encoder and decoder which he outlined"}, {"owner": {"reputation": 9, "user_id": 2430576, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b23dc81151a07da1ac3e361690582c11?s=128&d=identicon&r=PG", "display_name": "Sersay", "link": "https://stackoverflow.com/users/2430576/sersay"}, "edited": false, "score": 0, "creation_date": 1432147029, "post_id": 30357636, "comment_id": 48807349, "body": "NathanOliver, the problem occurred when I included #FrequencyTable into decoder.cpp after i&#39;d finished working on encoder.cpp so this is sort of the smallest example i can give"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1432147043, "post_id": 30357636, "comment_id": 48807357, "body": "@Sersay <i><code>&#47;&#47;#include &quot;FrequencyTable.cpp&quot;</code></i> If that was the offending code, you should extend the makefile instead, to compile and link <code>FrequencyTable.cpp</code>."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1432147234, "post_id": 30357636, "comment_id": 48807477, "body": "The top bit (#includes) of frequencytable.cpp would be handy"}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 2430576, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b23dc81151a07da1ac3e361690582c11?s=128&d=identicon&r=PG", "display_name": "Sersay", "link": "https://stackoverflow.com/users/2430576/sersay"}, "is_accepted": false, "score": 0, "last_activity_date": 1432148747, "creation_date": 1432148747, "answer_id": 30358321, "question_id": 30357636, "link": "https://stackoverflow.com/questions/30357636/header-multiple-redefinition/30358321#30358321", "title": "Header Multiple Redefinition", "body": "<p>I was sensing that it had to do with compilation but thanks to @Lightness Races in Orbit and @\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6 I rewrote my makefile to be</p>\n\n<pre><code>encoder.out : FrequencyNode.o FrequencyTable.o decoder.o encoder.o encoderRunner.o  \n    g++ -ansi -Wall -g -o encoder.out FrequencyTable.o FrequencyNode.o decoder.o encoder.o encoderRunner.o  \n\nFrequencyNode.o : FrequencyNode.cpp FrequencyTable.h\n    g++ -ansi -Wall -g -c FrequencyNode.cpp\n\nFrequencyTable.o : FrequencyTable.cpp FrequencyTable.h FrequencyNode.h\n    g++ -ansi -Wall -g -c FrequencyTable.cpp\n\ndecoder.o : decoder.cpp decoder.h FrequencyTable.h FrequencyNode.h\n    g++ -ansi -Wall -g -c decoder.cpp\n\nencoder.o : encoder.cpp encoder.h FrequencyTable.h FrequencyNode.h\n    g++ -ansi -Wall -g -c encoder.cpp\n\nencoderRunner.o : encoderRunner.cpp CPUTimer.h encoder.h decoder.h FrequencyTable.h FrequencyNode.h\n    g++ -ansi -Wall -g -c encoderRunner.cpp\n\nclean : \nrm -f encoder.out FrequencyTable.o FrequencyNode.o decoder.o encoder.o encoderRunner.o\n</code></pre>\n\n<p>This being said, I know you don't have to specifically compile things like iostream and stdlib.h? is this because they use inline or are templates, can anyone link me to something that can explain this, or explain it themselves?</p>\n"}], "owner": {"reputation": 9, "user_id": 2430576, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b23dc81151a07da1ac3e361690582c11?s=128&d=identicon&r=PG", "display_name": "Sersay", "link": "https://stackoverflow.com/users/2430576/sersay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1432148965, "creation_date": 1432146439, "last_edit_date": 1432148965, "question_id": 30357636, "link": "https://stackoverflow.com/questions/30357636/header-multiple-redefinition", "title": "Header Multiple Redefinition", "body": "<p>I understand that this question has been asked to death, but I've done a decent amount of research and nothing has helped so far. Yes I have lots and lots of header guards No as far as I know nothing needs inline every function is within a class. I have a encoderrunner.cpp that includes encoder.h and decoder.h both encoder.h and decoder.h include FrequencyTable.h and that's where all hell breaks loose, the compiler says that everything within FrequencyTable is a redefinition. this is one of many this just happens to be from the class i separated from FrequencyTable</p>\n\n<pre><code>/home/sersay/Documents/ECS60/p4/FrequencyNode.cpp:10: multiple definition of `FrequencyNode::FrequencyNode(unsigned char, FrequencyNode*, FrequencyNode*)'\ndecoder.o:/home/sersay/Documents/ECS60/p4/FrequencyNode.cpp:10: first defined here\n</code></pre>\n\n<p>etc...</p>\n\n<ul>\n<li>I've had/added header guards including trying #pragma once</li>\n<li>FrequencyTable was originally a nested class so I tried separating it into two classes, still same error</li>\n<li>I do have functions outside classes but they don't exist in my FrequencyTable class or the other class i separated from it</li>\n</ul>\n\n<p>I can provide more code but I don't believe its entirely relevant, perhaps it is how i'm compiling it?</p>\n\n<pre><code>encoder.out : decoder.o encoder.o encoderRunner.o  \ng++ -ansi -Wall -g -o encoder.out decoder.o encoder.o encoderRunner.o  \n\ndecoder.o : decoder.cpp decoder.h \ng++ -ansi -Wall -g -c decoder.cpp\n\nencoder.o : encoder.cpp encoder.h \ng++ -ansi -Wall -g -c encoder.cpp\n\nencoderRunner.o : encoderRunner.cpp CPUTimer.h encoder.h decoder.h \ng++ -ansi -Wall -g -c encoderRunner.cpp\n\nclean : \nrm -f encoder.out decoder.o  encoder.o  encoderRunner.o  \n</code></pre>\n\n<p>Edit1:</p>\n\n<pre><code>    #pragma once\n    #ifndef FrequencyTable_H_\n    #define FrequencyTable_H_\n\n    #include \"FrequencyNode.h\"\n\n    //class FrequencyNode;\n\n    class FrequencyTable\n    {\n    private:\n        FrequencyNode *HighestNode;\n        FrequencyNode *LowestNode;\n    public:\n        FrequencyTable();\n        ~FrequencyTable();\n        FrequencyNode * insert(unsigned char symbol); //USE THIS for new values in hash\n        unsigned char * GetOrder();\n\n    };\n\n\n//#include \"FrequencyTable.cpp\"\n#endif\n</code></pre>\n\n<p>Edit2(Ed's Request):</p>\n\n<pre><code>#include \"FrequencyTable.h\"\n#include \"FrequencyNode.h\"\n#include &lt;iostream&gt;\n#include &lt;stdlib.h&gt;\nusing namespace std;\n</code></pre>\n\n<p>please let me know what other information you need </p>\n"}, {"tags": ["c++", "function", "pure-virtual"], "comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1432145659, "post_id": 30357356, "comment_id": 48806595, "body": "No, but if it&#39;s not pure virtual you need to provide a definition for it."}, {"owner": {"reputation": 3004, "user_id": 1359034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e97eaac4d6ba8f0c3f95900f02b45b42?s=128&d=identicon&r=PG", "display_name": "dwcanillas", "link": "https://stackoverflow.com/users/1359034/dwcanillas"}, "edited": false, "score": 0, "creation_date": 1432145664, "post_id": 30357356, "comment_id": 48806598, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1432145789, "post_id": 30357356, "comment_id": 48806669, "body": "You should read the error and you would recognize: The pure virtual functions are no issue."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 0, "last_activity_date": 1432145674, "creation_date": 1432145674, "answer_id": 30357384, "question_id": 30357356, "link": "https://stackoverflow.com/questions/30357356/c-pure-virtual-function/30357384#30357384", "title": "c++ pure virtual function", "body": "<p>You need to implement the virtual functions unless you mark them as pure virtual.</p>\n\n<p>If a class contains one more more pure virtual functions then it is abstract; it cannot be instantiated.</p>\n"}, {"tags": [], "owner": {"reputation": 1190, "user_id": 3207828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EPkw.jpg?s=128&g=1", "display_name": "Dan Korn", "link": "https://stackoverflow.com/users/3207828/dan-korn"}, "is_accepted": false, "score": 1, "last_activity_date": 1432146184, "creation_date": 1432146184, "answer_id": 30357529, "question_id": 30357356, "link": "https://stackoverflow.com/questions/30357356/c-pure-virtual-function/30357529#30357529", "title": "c++ pure virtual function", "body": "<p>To answer the specific question you asked: No.   Just because you have one pure virtual function, that doesn't mean that any other functions have to be pure virtual as well.  The class can have any number of pure virtual, \"regular\" virtual, non-virtual, and static member functions.</p>\n\n<p>Although, as others have pointed out, the error you're getting has nothing to do with the function being virtual.</p>\n"}], "owner": {"reputation": 391, "user_id": 3590450, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f07850d58f92a393ff86d6f9b69b867b?s=128&d=identicon&r=PG&f=1", "display_name": "user3590450", "link": "https://stackoverflow.com/users/3590450/user3590450"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1432148139, "creation_date": 1432145575, "last_edit_date": 1432148139, "question_id": 30357356, "link": "https://stackoverflow.com/questions/30357356/c-pure-virtual-function", "title": "c++ pure virtual function", "body": "<p>If I have a class with one pure virtual function, must all the functions be pure virtual as well?</p>\n\n<pre><code>#pragma once\n\nclass Shape {\n    private:\n        static int countShape;\n    public:\n        virtual float perimeter() const=0;\n        virtual float area() const=0;\n        virtual void print();\n        virtual void input();\n        void setCountShape();\n        int getCountShape()const{return countShape;};\n        Shape(void);\n        ~Shape(void);\n};\n</code></pre>\n\n<p>I tried to run my program and it writes the messege:</p>\n\n<pre><code>Error   3   error LNK2001: unresolved external symbol \"public: virtual void __thiscall Shape::input(void)\" (?input@Shape@@UAEXXZ)   \nError   1   error LNK2001: unresolved external symbol \"public: virtual void __thiscall Shape::print(void)\" (?print@Shape@@UAEXXZ)\n</code></pre>\n"}, {"tags": ["c++", "makefile", "g++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1432145619, "post_id": 30357310, "comment_id": 48806578, "body": "You may make <code>obj&#47;</code> the working folder, and set <code>$(vpath)</code> to <code>src&#47;</code>. also depending on where your makefile actually resides, simply writing <code>OBJ = obj&#47;factorial.o obj&#47;main.o obj&#47;hello.o</code> and setting <code>vpath</code> may also help."}], "answers": [{"comments": [{"owner": {"reputation": 271, "user_id": 3679054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/R3IpJ.jpg?s=128&g=1", "display_name": "Sfrow", "link": "https://stackoverflow.com/users/3679054/sfrow"}, "edited": false, "score": 0, "creation_date": 1432197791, "post_id": 30358057, "comment_id": 48827845, "body": "I don&#39;t know why, but with your code I got <code>no rule to make target obj&#47;factorial.o</code>..."}], "tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": false, "score": 0, "last_activity_date": 1432148828, "last_edit_date": 1432148828, "creation_date": 1432147838, "answer_id": 30358057, "question_id": 30357310, "link": "https://stackoverflow.com/questions/30357310/makefile-on-different-folders/30358057#30358057", "title": "Makefile on different folders", "body": "<p>You should fix your <code>.o</code> rule as follows</p>\n\n<pre><code>obj/%.o: $(SOURCES_PATH)/%.cpp\n    $(CC) $(CXXFLAGS) $&lt; -o $@\n</code></pre>\n\n<p>Alternatively <a href=\"https://www.gnu.org/software/make/manual/html_node/General-Search.html\" rel=\"nofollow\"><code>$(vpath)</code></a> can be used to resolve where <code>make</code> looks up the source (prerequisite) files for a target:</p>\n\n<pre><code>vpath += $(SOURCES_PATH)\n\nobj/%.o: %.cpp\n    $(CC) $(CXXFLAGS) $&lt; -o $@\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 271, "user_id": 3679054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/R3IpJ.jpg?s=128&g=1", "display_name": "Sfrow", "link": "https://stackoverflow.com/users/3679054/sfrow"}, "is_accepted": true, "score": 0, "last_activity_date": 1432201053, "creation_date": 1432201053, "answer_id": 30369977, "question_id": 30357310, "link": "https://stackoverflow.com/questions/30357310/makefile-on-different-folders/30369977#30369977", "title": "Makefile on different folders", "body": "<p>So it seems I was able to obtain the result by using the following makefile</p>\n\n<pre><code>C++ = g++\nFILENAME = test\nOBJS = obj/factorial.o obj/hello.o obj/main.o\nINC = -Iinclude/\nvpath+= src\n\n$(FILENAME): $(OBJS)\n    $(C++) $(OBJS) -o $@ $(INC)\n\nobj/%.o: %.cpp\n    $(C++) -o $@ -c $&lt; $(INC)\n\nall: $(FILENAME)\n\nclean:\n    rm -rf objs/*.o *~ $(FILENAME).exe\n</code></pre>\n\n<p>Thanks! :)</p>\n"}], "owner": {"reputation": 271, "user_id": 3679054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/R3IpJ.jpg?s=128&g=1", "display_name": "Sfrow", "link": "https://stackoverflow.com/users/3679054/sfrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 30369977, "answer_count": 2, "score": 3, "last_activity_date": 1432201053, "creation_date": 1432145416, "question_id": 30357310, "link": "https://stackoverflow.com/questions/30357310/makefile-on-different-folders", "title": "Makefile on different folders", "body": "<p>I know it has already been discussed a lot, but I'm getting a bit crazy and cannot figured it out by myself. </p>\n\n<p>I'm trying to learn how to create makefiles, and I'm having problems in defining a makefile for files in different folders.</p>\n\n<p>This is what I would like to obtain, after compiling: </p>\n\n<pre><code>/makefile\n/test.exe\n/src/factorials.cpp\n/src/main.cpp\n/src/hello.cpp\n/obj/factorials.o\n/obj/main.o\n/obj/hello.o\n/include/functions.h\n</code></pre>\n\n<p>What is wrong with this makefile?</p>\n\n<pre><code>C++ = g++\nFILENAME = test\nSOURCES_PATH = src/\nSRC = $(SOURCES_PATH)factorial.cpp $(SOURCES_PATH)main.cpp $(SOURCES_PATH)hello.cpp\nOBJ = factorial.o main.o hello.o\n\nall: test.exe\n\ntest.exe: $(OBJ)\n$(C++) $(OBJ) -o $(FILENAME) -Iinclude\n\n%.o: \n$(C++) -c $(SOURCES_PATH)$*.cpp -Iinclude\n\nclean:\nrm -f test.exe\n</code></pre>\n\n<p>Everything goes correctly, but it gives me error trying to compile <code>src/all.cpp</code>. Besides, I don't know how to say to g++ to put .o files into <code>obj/</code> folder. </p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["c++", "qt", "network-programming", "boost-asio"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1432145398, "post_id": 30357191, "comment_id": 48806437, "body": "When choosing <code>Qt</code> you should use <code>Qt</code> features as much as possible, and retain mixing with other libraries (it might work though) IMHO. That&#39;s why I&#39;m rarely using <code>Qt</code> so far. Anyway you still can layer your networking stack functionality by providing your own wrapper classes, for what you actually need."}], "answers": [{"tags": [], "owner": {"reputation": 285, "user_id": 2479950, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7076cdc4e576974a9ac58bfe9ab65295?s=128&d=identicon&r=PG", "display_name": "pabloxrl", "link": "https://stackoverflow.com/users/2479950/pabloxrl"}, "is_accepted": true, "score": 0, "last_activity_date": 1432146174, "creation_date": 1432146174, "answer_id": 30357524, "question_id": 30357191, "link": "https://stackoverflow.com/questions/30357191/getting-started-with-network-programming-in-qt/30357524#30357524", "title": "Getting started with network programming in Qt", "body": "<p>Trying to answer your first question, it depends on which platforms are you targeting (Windows, Linux, OSX...). You could use native OS socket api (bsd sockets or winsock) but Qt provides very good abstractions for these so for the sake of simplicity I would stick with it. I'm unfamiliar with boost.asio but I'm pretty sure that Qt could provide you with all you need disregarding the platform you intent to target.</p>\n\n<p>As for the second question, you have to carefully analyze what kind of information you want to transmit and what will characterize the exchange.\nIf you intend to make it like a video game where players interact in real time, you are bound to use UDP sockets (although some data can go missing, it allows for \"real time\" communication). Control messages can circulate through TCP as the impact of latency won't be so critical and you want them to be reliably sent, so consider having two sockets (TCP and UDP) if that's the case, and use them for their purposes.</p>\n\n<p>Those resources that you link are quite informative but assuming you have knowledge of TCP and UDP and their features, I would suggest you to brush up your multithreading skills. Qt offers you good infrastructure for this, but topics like Asynchronous I/O (how to implement selectable sockets) may help you to create a better design that will remove a lot of overhead from additional threads (specially for reading).</p>\n\n<p>These are my 2 cents.</p>\n\n<p>Good luck for your project, I'm sure it will be a good chance for you to learn and put some theory into practice.</p>\n"}], "owner": {"reputation": 63, "user_id": 4917708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UXJYN.jpg?s=128&g=1", "display_name": "Qui Rogat", "link": "https://stackoverflow.com/users/4917708/qui-rogat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 804, "favorite_count": 0, "closed_date": 1432214027, "accepted_answer_id": 30357524, "answer_count": 1, "score": 0, "last_activity_date": 1432146174, "creation_date": 1432145039, "question_id": 30357191, "link": "https://stackoverflow.com/questions/30357191/getting-started-with-network-programming-in-qt", "closed_reason": "Opinion-based", "title": "Getting started with network programming in Qt", "body": "<p>I just started a summer job at my university doing work in a lab, and I've been given a rather large, vague problem to tackle without much guidance so I was hoping someone could help point me in the right direction.</p>\n\n<p>Essentially it's a 3-d world built in Qt using VTK (Visualization ToolKit) for use in therapy and rehab, and my task is to find a way to network two or more instances of the program so that users can share the same 3-d environment (essentially a networked video game).</p>\n\n<p>The professor wants it to be secure, for latency to be as low as possible, and for the program to record data after a session is complete.</p>\n\n<p>So far I was thinking (without much experience) of doing a client/server model built in Qt, but I'm not sure where to start. </p>\n\n<p><strong>Q1:</strong>\nShould I use Boost.asio, or Qt library for networking? </p>\n\n<p><strong>Q2:</strong>\nAre there any concepts I should be mindful of from the get-go for security, and network programming in general? (I've heard good things about <a href=\"http://beej.us/guide/bgnet/\" rel=\"nofollow\">Beej's</a> Guide, and books by <a href=\"http://www.amazon.ca/UNIX-Network-Programming-Richard-Stevens/dp/0139498761\" rel=\"nofollow\">W. Richard Stevens</a>)</p>\n"}, {"tags": ["c++", "unit-testing"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1432145311, "post_id": 30357190, "comment_id": 48806386, "body": "A  nice example why avoiding inheritance is a good thing."}], "answers": [{"tags": [], "owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1432154401, "creation_date": 1432154401, "answer_id": 30359971, "question_id": 30357190, "link": "https://stackoverflow.com/questions/30357190/conditional-derivation-for-unit-testing/30359971#30359971", "title": "Conditional Derivation for Unit Testing", "body": "<p>I think what you want is a strategy pattern. <code>uio</code> provides a non-virtual interface and a pointer to an implementation. You think have a virtual interface and provide either a normal or test instance of that to the <code>uio</code> object, rather than trying to insert inheritance in the middle. Using the strategy pattern even allows you to plug in additional implementations.</p>\n"}], "owner": {"reputation": 31, "user_id": 4424881, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sKBebpIWaB0/AAAAAAAAAAI/AAAAAAAAIdo/t3JzZOTGVK4/photo.jpg?sz=128", "display_name": "Kris", "link": "https://stackoverflow.com/users/4424881/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1432154401, "creation_date": 1432145028, "question_id": 30357190, "link": "https://stackoverflow.com/questions/30357190/conditional-derivation-for-unit-testing", "title": "Conditional Derivation for Unit Testing", "body": "<p>I'm writing unit tests that encapsulate a hardware driver (user space), the design pattern that I'm using is as follows:</p>\n\n<pre><code>class uio\n{\n    virtual uint32_t readbit(...);\n    virtual bool writebit(...);\n    // other driver related functions\n    // ...\n};\n\nclass uio_test : public uio\n{\n    virtual uint32_t readbit(...) override { /* don't talk to hardware, send back test data */ }\n    virtual bool writebit(...) override { /* don't talk to hardware, write test data */ }\n};\n\nclass spi : public uio\n{\n    // spi related functions\n};\n\nclass i2c : public uio\n{\n    // i2c related functions\n};\n</code></pre>\n\n<p>My questions is how to go about making spi and uio properly inherit from either uio OR uio_test depending on the module (real program vs gtest). I've looked at conditionals for example:</p>\n\n<pre><code>template&lt;bool test&gt;\nclass spi : public std::conditional&lt;test, uio_test, uio&gt;\n</code></pre>\n\n<p>and this would work in world where all objects were derived simply from the main.</p>\n\n<pre><code>/* main.cpp */\nspi&lt;false&gt; s;\ns.init();\ns.writebit();\n\n/* gtest_main.cpp */\nspi&lt;true&gt; s;\nASSERT_TRUE(s.init());\nASSERT_EQ(/* read/write test bits, etc*/);\n</code></pre>\n\n<p>however the uio derived objects are used in other specialized classes throughout the program, and I cannot see a good way of conditional construction, for example:</p>\n\n<pre><code>class temperature_monitor\n{\n    createBuses();\n    spi&lt;???&gt;* spictrl_;\n};\n\n/* perhaps derive test classes, easy since most high level objects are singletons */\ntemperature_monitor::createBuses()\n{\n    if (testmode)\n        spictrl_ = new spi&lt;true&gt;;\n    else\n        spictrl_ = new spi&lt;false&gt;;     \n}\n</code></pre>\n\n<p>Hope that's clear as mud for everyone. I'll answer a few questions before they're asked:</p>\n\n<p>Q. How about pre-processor conditionals?</p>\n\n<p>A. No, if possible, never.</p>\n\n<p>Q. Why are you writing unit tests for low level bit banging drivers like spi?</p>\n\n<p>A. Why not, there's some internal logic going on, and I'd rather catch errors in a unit test than try and debug a stupid missing 0 for a day.</p>\n"}, {"tags": ["python", "c++", "numpy"], "answers": [{"comments": [{"owner": {"reputation": 263, "user_id": 4897442, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d672bfd441175c6343b835fe2e7913b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sajal Jain", "link": "https://stackoverflow.com/users/4897442/sajal-jain"}, "edited": false, "score": 0, "creation_date": 1432147017, "post_id": 30357598, "comment_id": 48807342, "body": "have something like this : float fArray[5] = {0,1,2,3,4}; npy_intp m = 14; PyObject *c ; c = PyArray_SimpleNewFromData(1,&amp;m,NPY_FLOAT,(void *)fArray);  Can you please let me know what is the error in this as I am getting segmentation fault."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 263, "user_id": 4897442, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d672bfd441175c6343b835fe2e7913b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sajal Jain", "link": "https://stackoverflow.com/users/4897442/sajal-jain"}, "edited": false, "score": 0, "creation_date": 1432147512, "post_id": 30357598, "comment_id": 48807648, "body": "Eee, sorry - it looks fine. Are you absolutely sure the segfault is from this? Could you <code>printf</code> immediately before and after this line?"}, {"owner": {"reputation": 263, "user_id": 4897442, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d672bfd441175c6343b835fe2e7913b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sajal Jain", "link": "https://stackoverflow.com/users/4897442/sajal-jain"}, "edited": false, "score": 0, "creation_date": 1432147611, "post_id": 30357598, "comment_id": 48807699, "body": "I am stuck on how x is evaluated here. First 3 arguments are clear to me."}, {"owner": {"reputation": 263, "user_id": 4897442, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d672bfd441175c6343b835fe2e7913b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sajal Jain", "link": "https://stackoverflow.com/users/4897442/sajal-jain"}, "edited": false, "score": 0, "creation_date": 1432147660, "post_id": 30357598, "comment_id": 48807727, "body": "Yes I did and this is the line where seg fault is there."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 263, "user_id": 4897442, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d672bfd441175c6343b835fe2e7913b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sajal Jain", "link": "https://stackoverflow.com/users/4897442/sajal-jain"}, "edited": false, "score": 0, "creation_date": 1432147717, "post_id": 30357598, "comment_id": 48807757, "body": "Bummer. Your use of <code>x</code> seems fine to me. Sorry, I&#39;m out of ideas."}, {"owner": {"reputation": 263, "user_id": 4897442, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d672bfd441175c6343b835fe2e7913b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sajal Jain", "link": "https://stackoverflow.com/users/4897442/sajal-jain"}, "edited": false, "score": 0, "creation_date": 1432147786, "post_id": 30357598, "comment_id": 48807792, "body": "So, I am again stuck on this :("}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 263, "user_id": 4897442, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d672bfd441175c6343b835fe2e7913b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sajal Jain", "link": "https://stackoverflow.com/users/4897442/sajal-jain"}, "edited": false, "score": 0, "creation_date": 1432148016, "post_id": 30357598, "comment_id": 48807929, "body": "Looks so. I suggest you go a different way. The problem, I think, is not with this function, but about dealing with segfaults in numpy. See if you can use valgrind on it. If not, start a new SO question whose focus is on valgrind/numpy, and refers to this as an instance of the problem."}, {"owner": {"reputation": 58707, "user_id": 110026, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/dce2259ff9b547103d54acf1ea622314?s=128&d=identicon&r=PG", "display_name": "Jaime", "link": "https://stackoverflow.com/users/110026/jaime"}, "edited": false, "score": 6, "creation_date": 1432148106, "post_id": 30357598, "comment_id": 48807983, "body": "You have provided a buffer with room for 5 items, <code>fArray</code>, but are telling it that it has room for 14 (<code>m</code>), so that&#39;s a segmentation fault waiting to happen as soon as you try accessing it. That said, your problem is more likely due to not calling <code>import_array()</code> at module initialization, see <a href=\"http://stackoverflow.com/questions/7730717/numpy-c-api-example-gives-a-segfault/7732174#7732174\">this</a>."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 0, "creation_date": 1432148210, "post_id": 30357598, "comment_id": 48808043, "body": "Oh, very nice - I missed that 14. Great job."}, {"owner": {"reputation": 263, "user_id": 4897442, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d672bfd441175c6343b835fe2e7913b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sajal Jain", "link": "https://stackoverflow.com/users/4897442/sajal-jain"}, "edited": false, "score": 0, "creation_date": 1432149652, "post_id": 30357598, "comment_id": 48808880, "body": "Even after changing it to 5 the error is still there. And I have just posted the relevant strings for the function, I am using all the functions like import_array() and initialize."}, {"owner": {"reputation": 263, "user_id": 4897442, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d672bfd441175c6343b835fe2e7913b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sajal Jain", "link": "https://stackoverflow.com/users/4897442/sajal-jain"}, "edited": false, "score": 0, "creation_date": 1432150271, "post_id": 30357598, "comment_id": 48809243, "body": "I just posted my code. Please see if you find any error in this."}, {"owner": {"reputation": 431, "user_id": 9940188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fab55648698bdae0015bce0761121c4d?s=128&d=identicon&r=PG&f=1", "display_name": "musbur", "link": "https://stackoverflow.com/users/9940188/musbur"}, "edited": false, "score": 0, "creation_date": 1548076015, "post_id": 30357598, "comment_id": 95401824, "body": "@Ami, your &quot;dims&quot; argument is of type int* whereas PyArray_SimpleNewFromData expects an int** type (and the compiler complains accordingly). Yet your code works. Why?"}, {"owner": {"reputation": 305, "user_id": 4694229, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d11eec7596d48822093fcf1b152ac8ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4694229/tony"}, "edited": false, "score": 0, "creation_date": 1559631724, "post_id": 30357598, "comment_id": 99471279, "body": "@AmiTavory I am having a problem using this example. When I create the array in python the numbers in numpy array are not the ones set, instead some extremely big numbers are in the array. I am converting doubles to NPY_DOUBLE. Any idea what could be the issue?"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 305, "user_id": 4694229, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d11eec7596d48822093fcf1b152ac8ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4694229/tony"}, "edited": false, "score": 0, "creation_date": 1559632764, "post_id": 30357598, "comment_id": 99471747, "body": "@Tony Are you using <code>NPY_INT64</code>?"}, {"owner": {"reputation": 305, "user_id": 4694229, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d11eec7596d48822093fcf1b152ac8ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4694229/tony"}, "edited": false, "score": 0, "creation_date": 1559632873, "post_id": 30357598, "comment_id": 99471801, "body": "@AmiTavory No, but I am using doubles, the array is double x[2] = {1.2,1.5}."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 305, "user_id": 4694229, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d11eec7596d48822093fcf1b152ac8ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4694229/tony"}, "edited": false, "score": 0, "creation_date": 1559633694, "post_id": 30357598, "comment_id": 99472185, "body": "@Tony I&#39;d need to see the code to understand, and it&#39;s difficult to do via a comments dialog. Could you open a new question, with minimal code showing your problem? Feel free to paste here a link to it, and I&#39;ll have a look."}, {"owner": {"reputation": 305, "user_id": 4694229, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d11eec7596d48822093fcf1b152ac8ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4694229/tony"}, "edited": false, "score": 1, "creation_date": 1559633905, "post_id": 30357598, "comment_id": 99472283, "body": "@AmiTavory I will consider opening a new question. However, I found the problem, the variable is deleted on function return. When using the new command to create the array, it works fine."}], "tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": false, "score": 8, "last_activity_date": 1432146364, "creation_date": 1432146364, "answer_id": 30357598, "question_id": 30357115, "link": "https://stackoverflow.com/questions/30357115/pyarray-simplenewfromdata-example/30357598#30357598", "title": "PyArray_SimpleNewFromData example", "body": "<p>The function <a href=\"http://students.mimuw.edu.pl/~pbechler/numpy_doc/user/c-info.how-to-extend.html\" rel=\"noreferrer\">is</a>:</p>\n\n<pre><code> PyObject *\n    PyArray_SimpleNewFromData(\n        int nd, \n        npy_intp* dims, \n        int typenum, \n         void* data)\n</code></pre>\n\n<ul>\n<li><p>The last argument (<code>data</code>) is a buffer to the data. Let's dispense with that.</p></li>\n<li><p>The second argument (<code>dims</code>) is a buffer, whose each entry is a dimension; so for a 1d array, it could be a length-1 buffer (or even an integer, since each integer is a length-1 buffer)</p></li>\n<li><p>Since the second argument is a buffer, the first argument (<code>nd</code>) tells its length</p></li>\n<li><p>The third argument (<code>typenum</code>) indicates the type.</p></li>\n</ul>\n\n<hr>\n\n<p>For example, say you have 4 64-bit ints at <code>x</code>:</p>\n\n<p>To create an array, use </p>\n\n<pre><code>int dims[1];\ndims[0] = 4;\nPyArray_SimpleNewFromData(1, dims, NPY_INT64, x)\n</code></pre>\n\n<p>To create a 2X2 matrix, use</p>\n\n<pre><code>int dims[2];\ndims[0] = dims[1] = 2;\nPyArray_SimpleNewFromData(2, dims, NPY_INT64, x)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 541, "user_id": 7517511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/326VD.jpg?s=128&g=1", "display_name": "Arnab Sanyal", "link": "https://stackoverflow.com/users/7517511/arnab-sanyal"}, "is_accepted": false, "score": 0, "last_activity_date": 1539214819, "last_edit_date": 1539214819, "creation_date": 1539164270, "answer_id": 52737116, "question_id": 30357115, "link": "https://stackoverflow.com/questions/30357115/pyarray-simplenewfromdata-example/52737116#52737116", "title": "PyArray_SimpleNewFromData example", "body": "<p>Make sure that you plug the memory leak that the above approach entrails. I am guessing in the above <code>x</code> is a pointer of type <code>void *</code>. Check <a href=\"https://stackoverflow.com/a/52737023/7517511\">this</a> out.</p>\n"}], "owner": {"reputation": 263, "user_id": 4897442, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d672bfd441175c6343b835fe2e7913b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sajal Jain", "link": "https://stackoverflow.com/users/4897442/sajal-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11424, "favorite_count": 7, "answer_count": 2, "score": 9, "last_activity_date": 1539214819, "creation_date": 1432144797, "last_edit_date": 1432150235, "question_id": 30357115, "link": "https://stackoverflow.com/questions/30357115/pyarray-simplenewfromdata-example", "title": "PyArray_SimpleNewFromData example", "body": "<p>I know that this thing has been answered a lot of times and I have also read the documentation as well but still I am not able to clearly understand how is this working. As in, I am not able to understand how the values are populated in its arguments. The examples are not very clearly explaining it(or may be I am not able to). Can anyone please help me understand how are the arguments of this function populated? What should be their values? \nI have to pass a vector from C++ to Python without reallocating the memory.\nAny help is much appreciated. I am stuck on this from a lot of days.</p>\n\n<p>My code which I am implementing:</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\nPyObject *pName, *pModule, *pDict, *pFunc, *pValue, *pArgs,*pXVec,*c, *xarr1;\nint i;\nfloat fArray[5] = {0,1,2,3,4};\n//float *p = &amp;fArray[0] ;\nnpy_intp m = 5;\n//void* PyArray_GetPtr(PyArrayObject* aobj, npy_intp* ind)\u00b6\n\n\n// Initialize the Python Interpreter\nPy_Initialize();\nPySys_SetArgv(argc, argv); \n// Build the name object\npName = PyString_FromString(argv[1]);\n\n// Load the module object\npModule = PyImport_Import(pName);\nprintf(\"check0\\n\");\n// pDict is a borrowed reference \npDict = PyModule_GetDict(pModule);\nprintf(\"check1\\n\");\n// pFunc is also a borrowed reference \npFunc = PyDict_GetItemString(pDict, argv[2]);\nprintf(\"check2\\n\");\n//    if (PyCallable_Check(pFunc)) \n//    {\n// Prepare the argument list for the call\n//xarr1 = PyFloat_FromDouble(xarr[1]);\n    printf(\"check3\\n\");\nc = PyArray_SimpleNewFromData(1,&amp;m,NPY_FLOAT,(void *)fArray);\nprintf(\"check3\\n\");\n    pArgs = PyTuple_New(1);\n    PyTuple_SetItem(pArgs,0, c);    \n\n    pValue = PyObject_CallObject(pFunc, pArgs);\n\n    if (pArgs != NULL)\n    {\n        Py_DECREF(pArgs);\n    }\n\n//}\n//   else \n//    {\n//        PyErr_Print();\n//    }\n\n// Clean up\nPy_DECREF(pModule);\nPy_DECREF(pName);\n\n// Finish the Python Interpreter\nPy_Finalize();\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 3, "creation_date": 1432144505, "post_id": 30356959, "comment_id": 48805907, "body": "what do you mean by &quot;nested&quot;? it seem as though you were using this word for something completely different. are you talking about the loop? or\u2026?"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1432144548, "post_id": 30356959, "comment_id": 48805940, "body": "Only the pointer to your angle2 object lives on the stack.  Yes, you could overflow that, but you&#39;d probably run out of heap long before then - and remember that the local pointer only lives in this scope and not beyond so that once you leave this function, that pointer is freed/lost.  Just how many Angels are you making?"}, {"owner": {"reputation": 983, "user_id": 2430299, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IRcak.jpg?s=128&g=1", "display_name": "The Unholy Metal Machine", "link": "https://stackoverflow.com/users/2430299/the-unholy-metal-machine"}, "reply_to_user": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1432144616, "post_id": 30356959, "comment_id": 48805981, "body": "@TheParamagneticCroissant ok maybe a problem of my english skill... I thought nested as a synonim of stored"}, {"owner": {"reputation": 983, "user_id": 2430299, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IRcak.jpg?s=128&g=1", "display_name": "The Unholy Metal Machine", "link": "https://stackoverflow.com/users/2430299/the-unholy-metal-machine"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1432144682, "post_id": 30356959, "comment_id": 48806015, "body": "@MichaelDorgan &quot;Just how many Angels are you making?&quot; actually it&#39;s only an example, but I&#39;m for example working on game engine, where I cannot know at &#39;priori&#39; the number of entities that will be created"}, {"owner": {"reputation": 983, "user_id": 2430299, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IRcak.jpg?s=128&g=1", "display_name": "The Unholy Metal Machine", "link": "https://stackoverflow.com/users/2430299/the-unholy-metal-machine"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1432144849, "post_id": 30356959, "comment_id": 48806106, "body": "@MichaelDorgan the pointer to angel2 isn&#39;t on the heap ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1432144898, "post_id": 30356959, "comment_id": 48806126, "body": "&#39;std::string&#39; is a relative tiny object, and the &#39;std::string&#39; (object) size never grows. In other words <code>Angel* angel2 = new Angel</code> and <code>location = new std::string</code> are pointless"}, {"owner": {"reputation": 983, "user_id": 2430299, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IRcak.jpg?s=128&g=1", "display_name": "The Unholy Metal Machine", "link": "https://stackoverflow.com/users/2430299/the-unholy-metal-machine"}, "edited": false, "score": 0, "creation_date": 1432145177, "post_id": 30356959, "comment_id": 48806299, "body": "@DieterL&#252;cking again it&#39;s only an example, moreover it&#39;s not necessarily &quot;tiny&quot;. it depend of the hardware"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432145990, "post_id": 30356959, "comment_id": 48806783, "body": "@bob-theunholymetalmachine: The thing it points to is, yes."}, {"owner": {"reputation": 983, "user_id": 2430299, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IRcak.jpg?s=128&g=1", "display_name": "The Unholy Metal Machine", "link": "https://stackoverflow.com/users/2430299/the-unholy-metal-machine"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432146191, "post_id": 30356959, "comment_id": 48806894, "body": "@LightnessRacesinOrbit true! the thing is I coding for years now, and never thought about that before..."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432146287, "post_id": 30356959, "comment_id": 48806951, "body": "@bob-theunholymetalmachine: That&#39;s fine; you shouldn&#39;t care about &quot;stack&quot; vs &quot;heap&quot; unless you&#39;re an embedded developer."}, {"owner": {"reputation": 797, "user_id": 4905701, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206378492964245/picture?type=large", "display_name": "Ron Kuper", "link": "https://stackoverflow.com/users/4905701/ron-kuper"}, "edited": false, "score": 0, "creation_date": 1432146347, "post_id": 30356959, "comment_id": 48806975, "body": "The storage that backs std::string will be on the heap, so the amount of stack consumed by angel1 and angel2 is identical."}, {"owner": {"reputation": 983, "user_id": 2430299, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IRcak.jpg?s=128&g=1", "display_name": "The Unholy Metal Machine", "link": "https://stackoverflow.com/users/2430299/the-unholy-metal-machine"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432146455, "post_id": 30356959, "comment_id": 48807033, "body": "@LightnessRacesinOrbit I like to know what happend behind the hood. Also I&#39;m interested by coding for embedded platform to. More over I didn&#39;t learn coding at school, but I guess my question could be a such question a teacher can ask at an exam... so I consider this question as a basic fundamental of coding"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432146621, "post_id": 30356959, "comment_id": 48807142, "body": "@bob-theunholymetalmachine: It may well be. It&#39;s just not a basic fundamental of C++. :)"}, {"owner": {"reputation": 983, "user_id": 2430299, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IRcak.jpg?s=128&g=1", "display_name": "The Unholy Metal Machine", "link": "https://stackoverflow.com/users/2430299/the-unholy-metal-machine"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432146917, "post_id": 30356959, "comment_id": 48807283, "body": "@LightnessRacesinOrbit by coding I don&#39;t necessarily mean C++, in fact in my head I was more thinking about C when I wrote this... (because we were talking about embedded stuff)"}, {"owner": {"reputation": 983, "user_id": 2430299, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IRcak.jpg?s=128&g=1", "display_name": "The Unholy Metal Machine", "link": "https://stackoverflow.com/users/2430299/the-unholy-metal-machine"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432147255, "post_id": 30356959, "comment_id": 48807492, "body": "@LightnessRacesinOrbit (ok I was going out of the question with this comment since my question is c++)"}], "answers": [{"comments": [{"owner": {"reputation": 983, "user_id": 2430299, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IRcak.jpg?s=128&g=1", "display_name": "The Unholy Metal Machine", "link": "https://stackoverflow.com/users/2430299/the-unholy-metal-machine"}, "edited": false, "score": 0, "creation_date": 1432145469, "post_id": 30357234, "comment_id": 48806478, "body": "so with <code>angel2</code> the integer <code>i</code> is on the heap too ? (you just mess angel1 and angel2 in the second part of your answer)"}, {"owner": {"reputation": 3983, "user_id": 620029, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c3c977d6b546bc538aa47413431dba0c?s=128&d=identicon&r=PG", "display_name": "Vladp", "link": "https://stackoverflow.com/users/620029/vladp"}, "edited": false, "score": 0, "creation_date": 1432145584, "post_id": 30357234, "comment_id": 48806559, "body": "<code>i</code> is just a temporary variable on the stack of the constructor, is has nothing to do with angel2, its also gets freed right after the constructor call is finished"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1432145647, "post_id": 30357234, "comment_id": 48806588, "body": "Actually, <code>i</code> is on the stack.  The code that Angel runs still has access to the stack, so its local vars would use the stack.  What goes on the heap is all memory associated with Angel.  I&#39;ll edit my response to show this."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432146024, "post_id": 30357234, "comment_id": 48806799, "body": "Be careful about spreading misconceptions. Prefer to talk about <i>storage duration</i> unless a specific implementation and platform have been asked about. &quot;Stack&quot; and &quot;heap&quot; are very misleading words to use in a pure C++ sense."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1432146668, "post_id": 30357234, "comment_id": 48807175, "body": "This might be a good time to educate me then.  How exactly and &quot;Stack&quot; and &quot;Heap&quot; misleading?  Maybe I&#39;m too old school, but I was under the impression that those terms meant concrete things on any platform and were language agnostic."}, {"owner": {"reputation": 983, "user_id": 2430299, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IRcak.jpg?s=128&g=1", "display_name": "The Unholy Metal Machine", "link": "https://stackoverflow.com/users/2430299/the-unholy-metal-machine"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432146718, "post_id": 30357234, "comment_id": 48807195, "body": "@LightnessRacesinOrbit tell me more, could you point to some web articles/book ?"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432147398, "post_id": 30357234, "comment_id": 48807578, "body": "@LightnessRacesinOrbit Can you name a platform where the terms do not apply (where the memory layout of the program at run time would be surprising), with the default allocators? Also, the standard is full of &quot;stack&quot;, in the context of unwinding. It is an appropriate metaphor for objects which are created and destroyed in (reverse) order, like those with automatic storage duration. I also fail to see how &quot;heap&quot; is &quot;very misleading&quot; since it is basically a synonym for free store. While it is good to be exact when appropriate I feel like being subjected to political correctness guardians."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1432171132, "post_id": 30357234, "comment_id": 48817337, "body": "@PeterSchneider: lol I knew someone would roll out the &quot;can you name an implementation that...&quot; counter-argument. It begs the question, because the entire point of coding to standards rather than implementations is to avoid thinking in terms of non-guaranteed, situation-specific chance occurrences and to instead think in terms of deliberately abstracted concepts that leave you no chance of failure on any compliant system. It&#39;s a fail-safe system. <i>(cont.)</i>"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432171178, "post_id": 30357234, "comment_id": 48817353, "body": "<i>(cont.)</i> It&#39;s a system of programming in which you do not <i>have</i> to ask &quot;are there implementations on which...&quot; because you know that what you are doing is guaranteed safe on all of them. Always. No matter what. Now, tomorrow, forever. Whether I can think of one that doesn&#39;t fit it, on demand, off the top of my head (I can&#39;t; I&#39;m drunk and can&#39;t be arsed!) is entirely by definition besides the point. <i>(cont.)</i>"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432171183, "post_id": 30357234, "comment_id": 48817359, "body": "<i>(cont.)</i> I can&#39;t for the life of me understand why anyone would go out of their way to teach the opposite. I concede that in practice there are circumstances where you <i>must</i> consider specifics, but this question is tagged <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a>, not <a href=\"https://stackoverflow.com/questions/tagged/some-particular-implemenation-and-scenario\">some-particular-implemenation-and-scenario</a>. In short, I think you&#39;re looking at it backwards."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1432171240, "post_id": 30357234, "comment_id": 48817369, "body": "@MichaelDorgan: They&#39;re language agnostic, but platform specific, and that&#39;s entirely the problem. Here we are teaching the language, not the platform. Therefore the terms are out of place."}], "tags": [], "owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "is_accepted": true, "score": 2, "last_activity_date": 1432145713, "last_edit_date": 1432145713, "creation_date": 1432145162, "answer_id": 30357234, "question_id": 30356959, "link": "https://stackoverflow.com/questions/30356959/can-i-overflow-the-stack-by-spawning-object-on-the-heap/30357234#30357234", "title": "can I overflow the stack by spawning object on the heap?", "body": "<p>Let me descibe in better detail what is going on for you - memory wise:</p>\n\n<pre><code>Angel angel1( \"Angel of Death\" , locationB );\nstd::cout &lt;&lt; angel1.name &lt;&lt; \" is in \" &lt;&lt; *angel1.location &lt;&lt; std::endl;\n</code></pre>\n\n<p>In this code, the entire <code>Angel</code> structure is located on the stack.  This does not include code within <code>Angel</code> that may also allocate to the heap (if it included pointers that were allocated and such), but everything declared within <code>Angel</code> is on the stack.  </p>\n\n<pre><code>Angel* angel2 = new Angel( \"Angel of the Apocalypse\", locationA );\nstd::cout &lt;&lt; angel2-&gt;name &lt;&lt; \" is in \" &lt;&lt; *angel2-&gt;location &lt;&lt; std::endl;\n</code></pre>\n\n<p>Here, only a pointer to <code>Angel</code> lives on the stack, but the entire contents of the <code>Angel</code> class/struct live on the heap.  Notice we must use the <code>-&gt;</code> operator to access the structures.  This means that we are using a pointer to get to the data on the heap.  In detail:</p>\n\n<pre><code>std::string name;  \nstd::string* location;\nint nbrOfFeathers;\n</code></pre>\n\n<p>Would be allocated to the heap in Angel2.</p>\n\n<p>I hope this clears things up for you a bit.</p>\n"}, {"comments": [{"owner": {"reputation": 983, "user_id": 2430299, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IRcak.jpg?s=128&g=1", "display_name": "The Unholy Metal Machine", "link": "https://stackoverflow.com/users/2430299/the-unholy-metal-machine"}, "edited": false, "score": 0, "creation_date": 1432148105, "post_id": 30357897, "comment_id": 48807981, "body": "&quot;storing elements in a Standard Library container that managed dynamic memory for you&quot; I do that, for exemple whith <code>glib::refptr</code> . I also though to build a &quot;memory pool&quot; for my game engine, but I will try to use <code>osg::ref_ptr</code> since I choice to use OSG as 3D renderer. &quot;No - as above the assertion was false: when you new an Angel, name is dynamically allocated and you can&#39;t overflow the stack.&quot; ok so to summarize, <code>name</code> is harmless but If I create a lot of angels that use a lot of local variables <code>i</code> (it&#39;s just for understand) I could overflow it, right ?"}, {"owner": {"reputation": 94195, "user_id": 410767, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c1dd4727d07c7dbb6ff8c3a83e400b5?s=128&d=identicon&r=PG", "display_name": "Tony Delroy", "link": "https://stackoverflow.com/users/410767/tony-delroy"}, "reply_to_user": {"reputation": 983, "user_id": 2430299, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IRcak.jpg?s=128&g=1", "display_name": "The Unholy Metal Machine", "link": "https://stackoverflow.com/users/2430299/the-unholy-metal-machine"}, "edited": false, "score": 0, "creation_date": 1432148866, "post_id": 30357897, "comment_id": 48808460, "body": "@bob-theunholymetalmachine &quot;If I create a lot of angels that use a lot of local variables&quot; - ahhh, but the memory for the local variables in functions is transient, only while the functions are running, so however many <code>Angel</code> objects you have, there&#39;ll be at most one <code>i</code> per thread as you&#39;re calling the constructor."}, {"owner": {"reputation": 983, "user_id": 2430299, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IRcak.jpg?s=128&g=1", "display_name": "The Unholy Metal Machine", "link": "https://stackoverflow.com/users/2430299/the-unholy-metal-machine"}, "edited": false, "score": 0, "creation_date": 1432149437, "post_id": 30357897, "comment_id": 48808745, "body": "Ok, I understand with all comments on this page, I should not worry about local variables used in functions. But, (sorry if I look to be annoying, I just want to be sure to understand) if I add a function to <code>Angel</code> with an infinite loop where a single local variable is used, it&#39;s not transient anymore, so I can overflow, right ? (again sorry, because I really feel like pushing... )"}, {"owner": {"reputation": 94195, "user_id": 410767, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c1dd4727d07c7dbb6ff8c3a83e400b5?s=128&d=identicon&r=PG", "display_name": "Tony Delroy", "link": "https://stackoverflow.com/users/410767/tony-delroy"}, "reply_to_user": {"reputation": 983, "user_id": 2430299, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IRcak.jpg?s=128&g=1", "display_name": "The Unholy Metal Machine", "link": "https://stackoverflow.com/users/2430299/the-unholy-metal-machine"}, "edited": false, "score": 0, "creation_date": 1432150053, "post_id": 30357897, "comment_id": 48809136, "body": "@bob-theunholymetalmachine: no need to apologise - every programmer&#39;s had to learn this some time or other. If you&#39;ve got an infinite loop, the <i>same</i> memory will be used for variable inside the loop no matter how many times the code iterates. For example, if you say <code>std::string s; while (getline(cin, s)) { std::string t = s + s; std::cout &lt;&lt; t; }</code>, then <code>getline()</code> reuses the same <code>s</code>. and <code>t</code> is recreated in the same memory each time through the loop. But if you&#39;ve got infinite <i>recursion</i> - where your function calls itself ad infinitum - then and only then will you run out of memory."}], "tags": [], "owner": {"reputation": 94195, "user_id": 410767, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c1dd4727d07c7dbb6ff8c3a83e400b5?s=128&d=identicon&r=PG", "display_name": "Tony Delroy", "link": "https://stackoverflow.com/users/410767/tony-delroy"}, "is_accepted": false, "score": 1, "last_activity_date": 1432147285, "creation_date": 1432147285, "answer_id": 30357897, "question_id": 30356959, "link": "https://stackoverflow.com/questions/30356959/can-i-overflow-the-stack-by-spawning-object-on-the-heap/30357897#30357897", "title": "can I overflow the stack by spawning object on the heap?", "body": "<blockquote>\n  <p>If I read only the header (<code>Angel.hh</code>) I think name would be stored on the stack while location would be stored on the heap.</p>\n</blockquote>\n\n<p>But as you know thinking that would be wrong, so don't think it!  You should instead think that <code>name</code> would be embedded in the <code>Angel</code> object, wherever that's constructed.</p>\n\n<blockquote>\n  <p>Because I have in my mind to use the stack in preference for variables with a short lifetime, like\u00b9 the integer i, and to preferably not using the stack for objects who can grow in numbers during the running time of the application.</p>\n</blockquote>\n\n<p>That's a good rule of thumb.  For PC-oriented Operating Systems and C++ environments, stacks often default to 1 to 8MB in size, so any data getting into the tens of kilobytes, or even smaller data on the stack of recursive functions, would best be dynamically allocated (with <code>new</code>, or by storing elements in a Standard Library container that managed dynamic memory for you).</p>\n\n<blockquote>\n  <p>If my assert is true, can I overflow the stack by spawning angels on the heap (because of name) ? where i is stored ?</p>\n</blockquote>\n\n<p>No - as above the assertion was false:  when you <code>new</code> an <code>Angel</code>, <code>name</code> is dynamically allocated and you can't overflow the stack.  Basically, the stack's only used for automatic, local variables, which are automatically destructored and the memory reclaimed as functions exit, or even more local scopes like <code>for (...) { }</code>, <code>while (...) { }</code>, <code>do { } while (...);</code>, <code>if (...) { }</code> or plain old <code>{ }</code> inside a function.</p>\n"}], "owner": {"reputation": 983, "user_id": 2430299, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IRcak.jpg?s=128&g=1", "display_name": "The Unholy Metal Machine", "link": "https://stackoverflow.com/users/2430299/the-unholy-metal-machine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 30357234, "answer_count": 2, "score": 1, "last_activity_date": 1432147285, "creation_date": 1432144284, "last_edit_date": 1432144896, "question_id": 30356959, "link": "https://stackoverflow.com/questions/30356959/can-i-overflow-the-stack-by-spawning-object-on-the-heap", "title": "can I overflow the stack by spawning object on the heap?", "body": "<p>let's look at this quick example :</p>\n\n<h1>Angel.hh</h1>\n\n<pre><code>#include &lt;string&gt;\n\nclass Angel\n{\n  public :\n\n  Angel( std::string n\n       , std::string l )\n  : name(n)\n  {\n    location = new std::string(l);\n    int i;\n    for(i=0;i&lt;10;i++)\n    {\n      nbrOfFeathers+=i*i;\n    }\n  };\n\n  ~Angel(  )\n  {\n    delete location;\n  };\n\n  std::string name;\n  std::string* location;\n  int nbrOfFeathers;\n};\n</code></pre>\n\n<h1>main.cc</h1>\n\n<pre><code>#include \"Angel.hh\"\n#include &lt;iostream&gt;\n\nint main(  )\n{\n  std::string locationA( \"Pandemonium\" );\n  std::string locationB( \"Purgatory\" );\n\n  Angel angel1( \"Angel of Death\" , locationB );\n  std::cout &lt;&lt; angel1.name &lt;&lt; \" is in \" &lt;&lt; *angel1.location &lt;&lt; std::endl;\n\n  Angel* angel2 = new Angel( \"Angel of the Apocalypse\", locationA );\n  std::cout &lt;&lt; angel2-&gt;name &lt;&lt; \" is in \" &lt;&lt; *angel2-&gt;location &lt;&lt; std::endl;\n\n  delete angel2;\n}\n</code></pre>\n\n<p>as we can see <code>angel1</code>is stored on the stack, while <code>angel2</code>is stored on the heap. If I read only the header (<code>Angel.hh</code>) I think <code>name</code> would be stored on the stack while <code>location</code> would be stored on the heap.</p>\n\n<p>I wonder if what I assert is true. Because I have in my mind to use the stack in preference for variables with a short lifetime, like\u00b9 the integer <code>i</code>, and to preferably not using the stack for objects who can grow in numbers during the running time of the application. If my assert is true, can I overflow the stack by spawning angels on the heap (because of <code>name</code>) ? where <code>i</code> is stored ?</p>\n\n<hr>\n\n<p>\u00b9 in that case is not really important, it's just an example...</p>\n"}, {"tags": ["c++", "linux", "sockets", "ping"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1432143885, "post_id": 30356750, "comment_id": 48805520, "body": "Seems like you&#39;ve already tried the obvious approach and hit a wall due to access limitations. So what other approaches can you think of? This question is too broad if you&#39;re asking us to list the ones <i>we</i> can think of."}, {"owner": {"reputation": 1792, "user_id": 965934, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ca34909148008c2a960071d06e3ff6a8?s=128&d=identicon&r=PG", "display_name": "01d55", "link": "https://stackoverflow.com/users/965934/01d55"}, "edited": false, "score": 1, "creation_date": 1432144129, "post_id": 30356750, "comment_id": 48805667, "body": "Would it be too heavyweight to execute the <code>ping</code> program and parse the output?"}, {"owner": {"reputation": 1910, "user_id": 2142228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac67bc0f4a64f7102fffe2f3bd45211d?s=128&d=identicon&r=PG", "display_name": "msmith81886", "link": "https://stackoverflow.com/users/2142228/msmith81886"}, "edited": false, "score": 0, "creation_date": 1432144165, "post_id": 30356750, "comment_id": 48805683, "body": "Good point.  I can use popen and write it to a string.  Let me take a crack at an example code solution.  That is not as elegant as I was thinking but beggars can&#39;t be choosers."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 3, "creation_date": 1432147463, "post_id": 30356750, "comment_id": 48807618, "body": "Why not just try using the server the way it&#39;s intended to be used and see if it works?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1432152002, "post_id": 30356750, "comment_id": 48810249, "body": "Not sure about Linux, but on some systems, you can use a UDP socket with the ICMP protocol to send/receive ping/echo packets so you don&#39;t need admin/sudo rights (Linux traceroute uses UDP)."}, {"owner": {"reputation": 1910, "user_id": 2142228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac67bc0f4a64f7102fffe2f3bd45211d?s=128&d=identicon&r=PG", "display_name": "msmith81886", "link": "https://stackoverflow.com/users/2142228/msmith81886"}, "edited": false, "score": 0, "creation_date": 1432156741, "post_id": 30356750, "comment_id": 48812861, "body": "That is a good point with using the server&#39;s own methods.  I guess that is what they make operating systems for..."}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1432165971, "post_id": 30356750, "comment_id": 48816020, "body": "Why bother pinging a server?  If you want to ssh to it, just ssh to it.  The result of the ping tells you nothing about the possible success or failure of an ssh attempt.  For example, a failed ping could just mean something along the route is configured to drop ping packets, so the ssh could still work.  Conversely, just because the ping succeeds doesn&#39;t mean the server is accepting ssh connections.  So after the ping fails or succeeds, you still do the ssh, which fails or succeeds on its own.  As David Schwartz already said:  &quot;just [use] the server the way it&#39;s intended&quot;."}, {"owner": {"reputation": 2237, "user_id": 1219722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f308a0947ea106f91b5ba413cd9c04c?s=128&d=identicon&r=PG", "display_name": "Dmitry Rubanovich", "link": "https://stackoverflow.com/users/1219722/dmitry-rubanovich"}, "edited": false, "score": 0, "creation_date": 1444786537, "post_id": 30356750, "comment_id": 54044595, "body": "The answer to 4 is that /bin/ping is owned by root and has set uid turned on."}], "answers": [{"comments": [{"owner": {"reputation": 1986, "user_id": 2843583, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5ed69a2177b073c7600828646620a9b1?s=128&d=identicon&r=PG", "display_name": "bergercookie", "link": "https://stackoverflow.com/users/2843583/bergercookie"}, "edited": false, "score": 0, "creation_date": 1480867773, "post_id": 30357710, "comment_id": 69130383, "body": "Just to clarify, pclose doesn&#39;t return 0 or 1 (from the manpage):  The pclose() function returns -1 if wait4(2) returns an error, or some other error is detected. In the event of an error, these functions set errno to indicate the cause of the error.   All in all though, great answer."}], "tags": [], "owner": {"reputation": 1910, "user_id": 2142228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac67bc0f4a64f7102fffe2f3bd45211d?s=128&d=identicon&r=PG", "display_name": "msmith81886", "link": "https://stackoverflow.com/users/2142228/msmith81886"}, "is_accepted": true, "score": 6, "last_activity_date": 1432146669, "creation_date": 1432146669, "answer_id": 30357710, "question_id": 30356750, "link": "https://stackoverflow.com/questions/30356750/c-ping-like-function-without-superuser-access/30357710#30357710", "title": "C++ ping-like function without superuser access", "body": "<p>Here is an example with <code>popen</code>.  I would love a better solution, so if there is a socket or other method which does not resort to a shell call, I would greatly appreciate it.  This should run with just <code>g++ ping_demo.cpp -o ping_demo</code>.  Let me know if it causes compile errors. </p>\n\n<pre><code>// C++ Libraries\n#include &lt;cstdio&gt;\n#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n#include &lt;string&gt;\n\n\n/**\n * @brief Convert String to Number\n */\ntemplate &lt;typename TP&gt;\nTP str2num( std::string const&amp; value ){\n\n    std::stringstream sin;\n    sin &lt;&lt; value;\n    TP output;\n    sin &gt;&gt; output;\n    return output;\n}\n\n\n/**\n * @brief Convert number to string\n */\ntemplate &lt;typename TP&gt;\nstd::string num2str( TP const&amp; value ){\n    std::stringstream sin;\n    sin &lt;&lt; value;\n    return sin.str();\n}\n\n\n/**\n * @brief Execute Generic Shell Command\n *\n * @param[in]   command Command to execute.\n * @param[out]  output  Shell output.\n * @param[in]   mode read/write access\n *\n * @return 0 for success, 1 otherwise.\n *\n*/\nint Execute_Command( const std::string&amp;  command,\n                     std::string&amp;        output,\n                     const std::string&amp;  mode = \"r\")\n{\n    // Create the stringstream\n    std::stringstream sout;\n\n    // Run Popen\n    FILE *in;\n    char buff[512];\n\n    // Test output\n    if(!(in = popen(command.c_str(), mode.c_str()))){\n        return 1;\n    }\n\n    // Parse output\n    while(fgets(buff, sizeof(buff), in)!=NULL){\n        sout &lt;&lt; buff;\n    }\n\n    // Close\n    int exit_code = pclose(in);\n\n    // set output\n    output = sout.str();\n\n    // Return exit code\n    return exit_code;\n}\n\n\n/**\n * @brief Ping\n *\n * @param[in] address Address to ping.\n * @param[in] max_attempts Number of attempts to try and ping.\n * @param[out] details Details of failure if one occurs.\n *\n * @return True if responsive, false otherwise.\n *\n * @note { I am redirecting stderr to stdout.  I would recommend \n *         capturing this information separately.}\n */\nbool Ping( const std::string&amp; address,\n           const int&amp;         max_attempts,\n           std::string&amp;       details )\n{\n    // Format a command string\n    std::string command = \"ping -c \" + num2str(max_attempts) + \" \" + address + \" 2&gt;&amp;1\";\n    std::string output;\n\n    // Execute the ping command\n    int code = Execute_Command( command, details );\n\n    return (code == 0);\n}\n\n\n/**\n * @brief Main Function\n */\nint main( int argc, char* argv[] )\n{\n    // Parse input\n    if( argc &lt; 2 ){\n        std::cerr &lt;&lt; \"usage: \" &lt;&lt; argv[0] &lt;&lt; \" &lt;address&gt; &lt;max-attempts = 3&gt;\" &lt;&lt; std::endl;\n        return 1;\n    }\n\n    // Get the address\n    std::string host = argv[1];\n\n    // Get the max attempts\n    int max_attempts = 1;\n    if( argc &gt; 2 ){\n        max_attempts = str2num&lt;int&gt;(argv[2]);\n    }\n    if( max_attempts &lt; 1 ){\n        std::cerr &lt;&lt; \"max-attempts must be &gt; 0\" &lt;&lt; std::endl;\n        return 1;\n    }\n\n    // Execute the command\n    std::string details;\n    bool result = Ping( host, max_attempts, details );\n\n    // Print the result\n    std::cout &lt;&lt; host &lt;&lt; \" \";\n    if( result == true ){\n        std::cout &lt;&lt; \" is responding.\" &lt;&lt; std::endl;\n    }\n    else{\n        std::cout &lt;&lt; \" is not responding.  Cause: \" &lt;&lt; details &lt;&lt; std::endl;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Sample outputs</p>\n\n<pre><code>$&gt; g++ ping_demo.cpp -o ping_demo\n\n$&gt; # Valid Example\n$&gt; ./ping_demo localhost\nlocalhost  is responding.\n\n$&gt; # Invalid Example\n$&gt; ./ping_demo localhostt\nlocalhostt  is not responding.  Cause: ping: unknown host localhostt\n\n$&gt; # Valid Example\n$&gt; ./ping_demo 8.8.8.8\n8.8.8.8  is responding.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "edited": false, "score": 0, "creation_date": 1461955402, "post_id": 33115142, "comment_id": 61449368, "body": "could you please explain the what the <code>std::string&amp; details</code> is for? What are we passing in for that field? currently I only pass in a <code>&quot; &quot;</code>"}, {"owner": {"reputation": 1785, "user_id": 4056146, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/yYokT.jpg?s=128&g=1", "display_name": "xinthose", "link": "https://stackoverflow.com/users/4056146/xinthose"}, "reply_to_user": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "edited": false, "score": 1, "creation_date": 1461955909, "post_id": 33115142, "comment_id": 61449600, "body": "@user2883071 Sure.  <code>details</code> is passed by reference and is only printed if there is an error.  It contains the command&#39;s response.  You should leave the function as is, and only call <code>test_connection</code>."}], "tags": [], "owner": {"reputation": 1785, "user_id": 4056146, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/yYokT.jpg?s=128&g=1", "display_name": "xinthose", "link": "https://stackoverflow.com/users/4056146/xinthose"}, "is_accepted": false, "score": 1, "last_activity_date": 1444785855, "creation_date": 1444785855, "answer_id": 33115142, "question_id": 30356750, "link": "https://stackoverflow.com/questions/30356750/c-ping-like-function-without-superuser-access/33115142#33115142", "title": "C++ ping-like function without superuser access", "body": "<p>I created an easy to use ping class with added ethernet port detection capability.  I based the code on msmith81886's answer but wanted to condense for those using it in industry.</p>\n\n<p>ping.hpp</p>\n\n<pre><code>#ifndef __PING_HPP_\n#define __PING_HPP_\n\n#include &lt;cstdio&gt;\n#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n#include &lt;string&gt;\n#include &lt;fstream&gt;\n#include &lt;cerrno&gt;\n#include &lt;cstring&gt;\n\nclass system_ping\n{\n    public:\n        int test_connection (std::string ip_address, int max_attempts, bool check_eth_port = false, int eth_port_number = 0);\n    private:\n        int ping_ip_address(std::string ip_address, int max_attempts, std::string&amp; details);\n};\n\n#endif\n</code></pre>\n\n<p>ping.cpp</p>\n\n<pre><code>#include \"../include/ping.hpp\"\n\nint system_ping::ping_ip_address(std::string ip_address, int max_attempts, std::string&amp; details)\n{\n    std::stringstream ss;\n    std::string command;\n    FILE *in;\n    char buff[512];\n    int exit_code;\n\n    try\n    {\n        command = \"ping -c \" + std::to_string(max_attempts) + \" \" + ip_address + \" 2&gt;&amp;1\";\n\n        if(!(in = popen(command.c_str(), \"r\"))) // open process as read only\n        {\n            std::cerr &lt;&lt; __FILE__ &lt;&lt; \"(\" &lt;&lt; __FUNCTION__ &lt;&lt; \":\" &lt;&lt; __LINE__ &lt;&lt; \") | popen error = \" &lt;&lt; std::strerror(errno) &lt;&lt; std::endl;       \n            return -1;\n        }\n\n        while(fgets(buff, sizeof(buff), in) != NULL)    // put response into stream\n        {\n            ss &lt;&lt; buff;\n        }\n\n        exit_code = pclose(in); // blocks until process is done; returns exit status of command\n\n        details = ss.str();\n    }\n    catch (const std::exception &amp;e)\n    {\n        std::cerr &lt;&lt; __FILE__ &lt;&lt; \"(\" &lt;&lt; __FUNCTION__ &lt;&lt; \":\" &lt;&lt; __LINE__ &lt;&lt; \") | e.what() = \" &lt;&lt; e.what() &lt;&lt; std::endl;      \n        return -2;\n    }\n\n    return (exit_code == 0);\n}\n\nint system_ping::test_connection (std::string ip_address, int max_attempts, bool check_eth_port, int eth_port_number)\n{\n    std::cout &lt;&lt; __FILE__ &lt;&lt; \"(\" &lt;&lt; __FUNCTION__ &lt;&lt; \":\" &lt;&lt; __LINE__ &lt;&lt; \") | started\" &lt;&lt; std::endl;      \n\n    int eth_conn_status_int;\n    std::string details;\n\n    try\n    {\n        if (check_eth_port)\n        {\n            std::ifstream eth_conn_status (\"/sys/class/net/eth\" + std::to_string(eth_port_number) + \"/carrier\");\n\n            eth_conn_status &gt;&gt; eth_conn_status_int; // 0: not connected; 1: connected\n            if (eth_conn_status_int != 1)\n            {\n                std::cerr &lt;&lt; __FILE__ &lt;&lt; \"(\" &lt;&lt; __FUNCTION__ &lt;&lt; \":\" &lt;&lt; __LINE__ &lt;&lt; \") | eth\" &lt;&lt; std::to_string(eth_port_number) &lt;&lt; \" unplugged\";        \n                return -1;\n            }\n        }\n\n        if (ping_ip_address(ip_address, max_attempts, details) != 1)\n        {\n            std::cerr &lt;&lt; __FILE__ &lt;&lt; \"(\" &lt;&lt; __FUNCTION__ &lt;&lt; \":\" &lt;&lt; __LINE__ &lt;&lt; \") | cannot ping \" &lt;&lt; ip_address &lt;&lt; \" | \" &lt;&lt; details &lt;&lt; std::endl;   \n            return -2;\n        }\n    }\n    catch (const std::exception &amp;e)\n    {\n        std::cerr &lt;&lt; __FILE__ &lt;&lt; \"(\" &lt;&lt; __FUNCTION__ &lt;&lt; \":\" &lt;&lt; __LINE__ &lt;&lt; \") | e.what() = \" &lt;&lt; e.what() &lt;&lt; std::endl;      \n        return -3;\n    }\n\n    std::cout &lt;&lt; __FILE__ &lt;&lt; \"(\" &lt;&lt; __FUNCTION__ &lt;&lt; \":\" &lt;&lt; __LINE__ &lt;&lt; \") | ping \" &lt;&lt; ip_address &lt;&lt; \" OK\" &lt;&lt; std::endl;         \n    std::cout &lt;&lt; __FILE__ &lt;&lt; \"(\" &lt;&lt; __FUNCTION__ &lt;&lt; \":\" &lt;&lt; __LINE__ &lt;&lt; \") | ended\" &lt;&lt; std::endl;        \n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1910, "user_id": 2142228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac67bc0f4a64f7102fffe2f3bd45211d?s=128&d=identicon&r=PG", "display_name": "msmith81886", "link": "https://stackoverflow.com/users/2142228/msmith81886"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7403, "favorite_count": 3, "accepted_answer_id": 30357710, "answer_count": 2, "score": 7, "last_activity_date": 1444785855, "creation_date": 1432143691, "last_edit_date": 1495540426, "question_id": 30356750, "link": "https://stackoverflow.com/questions/30356750/c-ping-like-function-without-superuser-access", "title": "C++ ping-like function without superuser access", "body": "<p>I am trying to write a simple C++ ping function to see if a network address is responding.  I don't need ICMP specifically, I just need to see if the server is there and responding to anything.   I have been doing some research and every solution I come up with requires creating a raw socket or something which requires the program to have sudo access.  I won't be able to guarantee that the system I am running this on will be able to modify the network stack, so this is not valid.  </p>\n\n<p>Here are some related questions I have already looked at. </p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/28857941/opening-raw-sockets-in-linux-without-being-superuser\">Opening RAW sockets in linux without being superuser</a></li>\n<li><a href=\"https://stackoverflow.com/questions/8290046/icmp-sockets-linux\">ICMP sockets (linux)</a></li>\n<li><a href=\"https://stackoverflow.com/questions/14307203/how-to-ping-using-sockets-library-c\">How to Ping Using Sockets Library - C</a></li>\n<li><a href=\"https://stackoverflow.com/questions/7687401/why-does-ping-work-without-administrator-privileges\">Why does ping work without administrator privileges?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/11998746/c-boost-asio-ping?rq=1\">C++ Boost.asio Ping</a></li>\n</ol>\n\n<p>It appears that ping requires superuser access for a good reason.  I don't want to purposefully create a security loophole, I just want to see if a server is responding.  Is there a good c++ function or resource that can do this?  I will make sure to post any sample solution I come up with.  I need a Linux (BSD) socket solution.  Since almost every unix-like system runs SSH, I can even just test against port 22.  I am only going to target Linux systems as a constraint.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "macos", "tilde"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 3, "creation_date": 1432143264, "post_id": 30356594, "comment_id": 48805151, "body": "<code>~</code> is a feature of your actual shell, to expand the current <code>$HOME</code> directory. You can&#39;t use it with <code>std::fstream</code> neither on Mac, nor on other OS&#39;s."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 6, "last_activity_date": 1432143325, "creation_date": 1432143325, "answer_id": 30356631, "question_id": 30356594, "link": "https://stackoverflow.com/questions/30356594/tilde-makes-trouble-when-using-fstream-on-mac/30356631#30356631", "title": "Tilde ~ makes trouble when using fstream on Mac", "body": "<p>There is no path <code>~</code>, that's something that's interpreted by your shell. You will need to expand it to whatever the environment variable <code>HOME</code> is set to.</p>\n\n<p>If you're calling your tool via the shell this will be expanded for you in advance. If you're within Xcode, you'll need to specify <code>$HOME</code> explicitly.</p>\n"}], "owner": {"reputation": 6564, "user_id": 2109064, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/05bfc90904db2f3abb20860d6e56e562?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2109064/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 30356631, "answer_count": 1, "score": 2, "last_activity_date": 1432143325, "creation_date": 1432143169, "question_id": 30356594, "link": "https://stackoverflow.com/questions/30356594/tilde-makes-trouble-when-using-fstream-on-mac", "title": "Tilde ~ makes trouble when using fstream on Mac", "body": "<p>I do not exactly know whether I have an IDE/toolchain question, a Mac question or a C++ question:</p>\n\n<p>I want to save a file with <code>ofstream</code>. That works as expected. But when I save to a filepath with a tilde like \"~/Desktop/test.txt\", <code>ofstream::good()</code> reports an error. However, I can successfully use a path like \"/Users/Michael/Desktop/test.txt\".</p>\n\n<p>This holds for the Xcode debugger, for a run with Eclipse, as well as for a direct call of the exectuable from the console.</p>\n\n<p>What is the problem with the tilde \"~\" here?</p>\n"}, {"tags": ["c++", "xcode", "debugging"], "comments": [{"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1432142750, "post_id": 30356410, "comment_id": 48804887, "body": "Are you positive that it should hit your breakpoint? Is it within an <code>if</code> or some other flow control structure that may not be entered? We can only guess without seeing your code and what line you are trying to hit."}, {"owner": {"reputation": 1, "user_id": 4921501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee9ab3c3f718de333208b16c0f0bc95b?s=128&d=identicon&r=PG&f=1", "display_name": "Chandler", "link": "https://stackoverflow.com/users/4921501/chandler"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1432179365, "post_id": 30356410, "comment_id": 48819362, "body": "Yes I am sure with that. Actually I have figured out the solution to hit it as long as I separated my class into head and implementation files. I thought I didnt have to cause the class was so small. || P.S. I can&#39;t upload any images cause I am freshman here without sufficient reputation credits. Sorry about that, and thanks a lot~"}], "owner": {"reputation": 1, "user_id": 4921501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee9ab3c3f718de333208b16c0f0bc95b?s=128&d=identicon&r=PG&f=1", "display_name": "Chandler", "link": "https://stackoverflow.com/users/4921501/chandler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1432142614, "creation_date": 1432142614, "question_id": 30356410, "link": "https://stackoverflow.com/questions/30356410/how-to-get-xcode-breakpoints-jumped-to-directly-c-the-language", "title": "how to get Xcode breakpoints jumped to directly (C++ the language)", "body": "<p>I am new to write C++ with Xcode and was working on some simple problem with two files, main.cpp and one class implementation respectively.</p>\n\n<p>The thing is, when I clicked Run and expected it got paused at a breakpoint I placed in the context of a function member of the solution class, the execution just passed by. </p>\n\n<p>But when I placed another breakpoint in the corresponding calling line in the main function and tried 'step into' from there, I got myself into the member function, yet when I clicked 'continue' after that, jumped right to the end again, rather than to the first breakpoint I placed.</p>\n\n<p>I have been searching for solution here for a while but to no avail. Hope someone can help me. Thanks.</p>\n"}, {"tags": ["c++", "memory-management", "raii"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1432141890, "post_id": 30356110, "comment_id": 48804445, "body": "<i>&quot;but I don&#39;t want that other instances of the same class type can access that function.&quot;</i> Do you mean inherited classes? I don&#39;t get this restriction, as written in the context. Other than that you can simply provide a private function in the class that is used by all of the constructors."}, {"owner": {"reputation": 13479, "user_id": 1830736, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/gwUf7.jpg?s=128&g=1", "display_name": "George Hilliard", "link": "https://stackoverflow.com/users/1830736/george-hilliard"}, "edited": false, "score": 1, "creation_date": 1432141904, "post_id": 30356110, "comment_id": 48804459, "body": "What exactly do you mean by &quot;outsource&quot;? That word doesn&#39;t have a specific meaning in C++."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1432141998, "post_id": 30356110, "comment_id": 48804504, "body": "You could make it a private function.  If you want to use it in the class initializer list you could make it a private static function."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4541498"}, "reply_to_user": {"reputation": 13479, "user_id": 1830736, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/gwUf7.jpg?s=128&g=1", "display_name": "George Hilliard", "link": "https://stackoverflow.com/users/1830736/george-hilliard"}, "edited": false, "score": 0, "creation_date": 1432142034, "post_id": 30356110, "comment_id": 48804525, "body": "@thirtythreeforty I had trouble translating the word into english. What I mean is that I create a new function that does the allocation for me, Then I call that function from my ctor, copy ctor and copy assignment operator."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1432142125, "post_id": 30356110, "comment_id": 48804567, "body": "@Tobi_R <i>&quot;What I mean is that I create a new function that does the allocation for me ...&quot;</i> As mentioned you can do this. Did you meet any problems, when trying so?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4541498"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1432142193, "post_id": 30356110, "comment_id": 48804602, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 That&#39;s exactly what I thought about. But If I do that, other instances of my class &#39;Register&#39; will have access to that function. So they could possibly call that &quot;allocate memory function&quot; on another object."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1432142298, "post_id": 30356110, "comment_id": 48804661, "body": "@Tobi_R <i>&quot;other instances of my class&quot;</i> Again: Please elaborate about this! It makes no sense for me. Every instance of your class needs to call that function (it&#39;s in the constructor)."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1432142392, "post_id": 30356110, "comment_id": 48804701, "body": "@Tobi_R I think you are confused on how class member functions work.  The member function of a class can modify the values of the object that called it and any instance that was passed to the function.  I cant call <code>foo</code> on one instance and have it modify another instance unless I pass that other instance to foo."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4541498"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1432142784, "post_id": 30356110, "comment_id": 48804915, "body": "@NathanOliver Indeed I am confused, but I think the private function mentioned multiple times is the best solution in my case."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4541498"}, "edited": false, "score": 0, "creation_date": 1432142521, "post_id": 30356306, "comment_id": 48804773, "body": "Thanks, I am gonna look into the delegated constructors!"}], "tags": [], "owner": {"reputation": 13479, "user_id": 1830736, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/gwUf7.jpg?s=128&g=1", "display_name": "George Hilliard", "link": "https://stackoverflow.com/users/1830736/george-hilliard"}, "is_accepted": false, "score": 0, "last_activity_date": 1432142282, "last_edit_date": 1495542608, "creation_date": 1432142282, "answer_id": 30356306, "question_id": 30356110, "link": "https://stackoverflow.com/questions/30356110/should-i-outsource-allocation-algorithm-raii/30356306#30356306", "title": "Should I outsource allocation algorithm? (RAII)", "body": "<p>You can do one of two things:</p>\n\n<ol>\n<li>Create a <code>private</code> function, then call it in each constructor.  This still allows other member functions of the class to call the function after construction, but that should be OK (just don't call it!).  <em>Subclasses</em> cannot call a class's private members, so you should be fine.</li>\n<li>Use <a href=\"https://stackoverflow.com/a/13961100/1830736\">delegated constructors</a>.  Perform the allocation in one constructor, then call that constructor from the others.  Obviously, nobody can call a constructor explicitly, so your concern should be taken care of.  Possible caveat: you will need to use a C++11 compliant compiler.</li>\n</ol>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4541498"}, "edited": false, "score": 0, "creation_date": 1432142996, "post_id": 30356422, "comment_id": 48805014, "body": "The copy assignment operator should allocate new memory on the lhs and copy the data of the rhs to the lhs. I am gonna add that check to the assignment operator!"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1432143054, "post_id": 30356422, "comment_id": 48805033, "body": "Why do you need to allocate new memory? Why not re-use the memory owned by the object?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4541498"}, "edited": false, "score": 0, "creation_date": 1432143206, "post_id": 30356422, "comment_id": 48805116, "body": "You are right, I got the purpose of the copy assignment operator wrong. So a simple copy algorithm should probably be enough!"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1432143652, "post_id": 30356422, "comment_id": 48805379, "body": "@Tobi_R Also read this article for the subtleties: <a href=\"http://stackoverflow.com/questions/4172722/what-is-the-rule-of-three\" title=\"what is the rule of three\">stackoverflow.com/questions/4172722/what-is-the-rule-of-thre&zwnj;&#8203;e</a>"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1432142643, "creation_date": 1432142643, "answer_id": 30356422, "question_id": 30356110, "link": "https://stackoverflow.com/questions/30356110/should-i-outsource-allocation-algorithm-raii/30356422#30356422", "title": "Should I outsource allocation algorithm? (RAII)", "body": "<p>You could create a <code>private static</code> function to help with the memory allocation:</p>\n\n<pre><code>static BYTE* allocate()\n{\n    BTYE* ptr = reinterpret_cast&lt;BYTE*&gt;(VirtualAlloc(nullptr, _trampoline_size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE));\n    if (ptr == nullptr)\n    {\n        throw my_exception(\"Could not allocate memory for trampoline function.\");\n    }\n    return ptr;\n}\n</code></pre>\n\n<p>Then, the constructors can be simplified to:</p>\n\n<pre><code>Register() : _trampoline_address(allocate()) { }\n\nRegister(const Register&amp; other) : _trampoline_address(allocate()) { }\n</code></pre>\n\n<p>However, the copy assignment operator needs a little bit more work. First of all, it's not clear from your posted code, what are the semantics of the assignment operator. Are you supposed to copy the data from the RHS to the LHS? If not, what role does the RHS play in the assignment operation? What are you supposed to do with the memory owned by the LHS?</p>\n\n<pre><code>Register&amp; operator= (const Register&amp; other)\n{\n   // Prevent messing with memory when dealing with self-assignment.\n   if ( this != &amp;other )\n   {\n      // Deal with the semantics of the operation.\n   }\n   return *this;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4541498"}, "edited": false, "score": 0, "creation_date": 1432148399, "post_id": 30356794, "comment_id": 48808158, "body": "Thanks for your answer. I was just wondering why should I even make the allocate function static?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1432151797, "post_id": 30356794, "comment_id": 48810118, "body": "@Tobi_R because <code>static</code> states &quot;I don&#39;t consume any state of this object&quot;.  It makes understanding the function easier.  It isn&#39;t &quot;why use static&quot;, but rather &quot;there is no reason not to use static&quot;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4541498"}, "edited": false, "score": 0, "creation_date": 1432157334, "post_id": 30356794, "comment_id": 48813142, "body": "okay I get it! So if my allocate_memory would directly change the _trampoline_address variable it shouldn&#39;t be static? (I don&#39;t want to do this but just for the understanding)"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 0, "last_activity_date": 1432143826, "creation_date": 1432143826, "answer_id": 30356794, "question_id": 30356110, "link": "https://stackoverflow.com/questions/30356110/should-i-outsource-allocation-algorithm-raii/30356794#30356794", "title": "Should I outsource allocation algorithm? (RAII)", "body": "<pre><code>struct Register {\n  Register():\n    _trampoline_address(allocate())\n  {}\n  Register(Register const&amp; o):\n    Register() // forward to default ctor\n  {\n    copy_data_from(o);\n  }\n  ~Register() {\n    if (_trampoline_address)\n      debug(VirtualFree(_trampoline_address, 0, MEM_RELEASE));\n  }\n  Register&amp; operator= (const Register&amp; o) {\n    if (this != std::addressof(o))\n      copy_data_from(o);\n    return *this;\n  }\nprivate:\n  void copy_data_from(Register const&amp; o) {\n    Assert(_tranpoline_address);\n    // ...\n  }\n  static BYTE* allocate() {\n    return reinterpret_cast&lt;BYTE*&gt;(\n      VirtualAlloc(nullptr, _trampoline_size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE)\n    );\n  }\n  BYTE* _trampoline_address;\n  static const/*expr*/ int _trampoline_size = 20;\n};\n</code></pre>\n\n<p>there is only one call to <code>allocate</code>, but I still put it in a <code>static private</code> method because it is messy.</p>\n\n<p>I also wrote <code>copy_data_from</code>, because it will be used twice (once in copy-ctor, once in assignment).</p>\n\n<p>I personally would be tempted to have <code>Register()</code> leave you with an empty buffer, only filled when used.  Read functions would have to check for <code>nullptr</code> and <code>allocate()</code> if it was missing: but they have to check for <code>nullptr</code> anyhow.  The result is a more efficient move-ctor and move-assign, creating empty arrays (and populating later) is far more efficient, etc.</p>\n\n<p>In this case, <code>allocate()</code> turns out to be more useful.  You can even have <code>ensure_allocated()</code>, which initializes <code>_tranpoline_address</code> if <code>nullptr</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4541498"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 30356794, "answer_count": 3, "score": -2, "last_activity_date": 1432143826, "creation_date": 1432141600, "question_id": 30356110, "link": "https://stackoverflow.com/questions/30356110/should-i-outsource-allocation-algorithm-raii", "title": "Should I outsource allocation algorithm? (RAII)", "body": "<p>Right now my class has a <strong>constructor</strong>, <strong>copy constructor</strong> and <strong>copy assignment operator</strong> which <strong>all do the same thing at first</strong> (allocating memory). The destructor is deallocating the memory.</p>\n\n<pre><code>class Register\n{\npublic:\n    Register()\n    {\n        _trampoline_address = reinterpret_cast&lt;BYTE*&gt;(VirtualAlloc(nullptr, _trampoline_size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE));\n        if (_trampoline_address == nullptr)\n        {\n            throw my_exception(\"Could not allocate memory for trampoline function.\");\n        }\n\n        //....\n    }\n    ~Register()\n    {\n        if (_trampoline_address != nullptr)\n        {\n            debug(VirtualFree(_trampoline_address, 0, MEM_RELEASE));\n        }\n    }\n    Register(const Register&amp; other)\n    {\n        _trampoline_address = reinterpret_cast&lt;BYTE*&gt;(VirtualAlloc(nullptr, _trampoline_size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE));\n        if (_trampoline_address == nullptr)\n        {\n            throw my_exception(\"Could not allocate memory for trampoline function.\");\n        }\n\n        //...\n    }\n    Register&amp; operator= (const Register&amp; other)\n    {\n        _trampoline_address = reinterpret_cast&lt;BYTE*&gt;(VirtualAlloc(nullptr, _trampoline_size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE));\n        if (_trampoline_address == nullptr)\n        {\n            throw my_exception(\"Could not allocate memory for trampoline function.\");\n        }\n\n        //....\n    }\n\nprivate:\n    BYTE* _trampoline_address;\n    static const int _trampoline_size = 20;\n};\n</code></pre>\n\n<p>I thought about outsourcing the allocation algorithm <strong>because I use it 3 times</strong>, but I don't want that other instances of the same class type can access that function.</p>\n\n<p>So what would be the proper solution to allocate memory in 3 functions in a RAII class?</p>\n"}, {"tags": ["c++", "intellisense", "extern"], "comments": [{"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 1, "creation_date": 1432140640, "post_id": 30355812, "comment_id": 48803746, "body": "What if <code>__cplusplus</code> wasn&#39;t defined?"}, {"owner": {"reputation": 21, "user_id": 4889857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe28949892b21efd3cf4ca88f90c93a?s=128&d=identicon&r=PG&f=1", "display_name": "shathaway", "link": "https://stackoverflow.com/users/4889857/shathaway"}, "reply_to_user": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1432144981, "post_id": 30355812, "comment_id": 48806182, "body": "#if defined (__cplusplus)       #define BEGIN_C_CODE extern &quot;C&quot; {       #define END_C_CODE }     #else"}, {"owner": {"reputation": 21, "user_id": 4889857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe28949892b21efd3cf4ca88f90c93a?s=128&d=identicon&r=PG&f=1", "display_name": "shathaway", "link": "https://stackoverflow.com/users/4889857/shathaway"}, "reply_to_user": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1432148907, "post_id": 30355812, "comment_id": 48808483, "body": "The not case is actually included in my code. Since C++ always defines (__cplusplus) I chose not to include the &#39;C&#39; compiler case in the example.  The issue involves the C++ compiler and an Intellisense error. The debugger shows that both BEGIN_C_CODE and END_C_CODE appear to be properly defined.  Using BEGIN_C_CODE to start an extern &quot;C&quot; block and then END_C_CODE to finish the code block, the Intellisense issues the error: this declaration has no storage class or type specifier."}, {"owner": {"reputation": 8889, "user_id": 3493731, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0ccfa8c5c786e748c8cf4f1d3bae9694?s=128&d=identicon&r=PG&f=1", "display_name": "MuertoExcobito", "link": "https://stackoverflow.com/users/3493731/muertoexcobito"}, "edited": false, "score": 0, "creation_date": 1432170207, "post_id": 30355812, "comment_id": 48817108, "body": "Just to clarify, are you getting compile errors, or just intellisense &#39;errors&#39;?"}, {"owner": {"reputation": 21, "user_id": 4889857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe28949892b21efd3cf4ca88f90c93a?s=128&d=identicon&r=PG&f=1", "display_name": "shathaway", "link": "https://stackoverflow.com/users/4889857/shathaway"}, "edited": false, "score": 0, "creation_date": 1432771124, "post_id": 30355812, "comment_id": 49067664, "body": "It appears to be an Intellisense error appearing in the build error report.  The program segment appears to compile properly, but I don&#39;t trust the code because of the reported Intellisense error condition.  Is it SAFE to ignore the Intellisense errors?"}], "owner": {"reputation": 21, "user_id": 4889857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe28949892b21efd3cf4ca88f90c93a?s=128&d=identicon&r=PG&f=1", "display_name": "shathaway", "link": "https://stackoverflow.com/users/4889857/shathaway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 964, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1432146415, "creation_date": 1432140558, "last_edit_date": 1432146415, "question_id": 30355812, "link": "https://stackoverflow.com/questions/30355812/error-this-declaration-has-no-storage-class-or-type-specifier-c-c", "title": "Error: this declaration has no storage class or type specifier C/C++", "body": "<p>Is there a way to define BEGIN_C_CODE and END_C_CODE macros to properly expand?</p>\n\n<p>Platform: Visual Studio 2012</p>\n\n<p>HeaderFile.h</p>\n\n<pre><code>#if defined (__cplusplus)\n  #define BEGIN_C_CODE extern \"C\" {\n  #define END_C_CODE }\n#else\n  // Edit: @shathaway mentioned 'The not case is actually included in my code'\n  #define BEGIN_C_CODE\n  #define END_C_CODE\n#endif\n</code></pre>\n\n<p>ProgramFile.cpp</p>\n\n<pre><code>#include \"HeaderFile.h\"\nBEGIN_C_CODE\n// C Source Code\nEND_C_CODE\n</code></pre>\n\n<p>In the ProgramFile.cpp, the END_C_CODE registers an Intellisense error:\n\"this declaration has no storage class or type specifier.\"</p>\n\n<p>When macro expansions are not used, but using the full wrapper, things work!</p>\n\n<pre><code>#if defined (__cplusplus)\n  extern \"C\" {\n#endif\n// C Source Code\n#if defined (__cplusplus)\n}\n#endif\n</code></pre>\n"}, {"tags": ["c++"], "answers": [{"tags": [], "owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "is_accepted": true, "score": 7, "last_activity_date": 1432140438, "last_edit_date": 1432140438, "creation_date": 1432140267, "answer_id": 30355722, "question_id": 30355713, "link": "https://stackoverflow.com/questions/30355713/issue-with-arithmetic-double-int-int/30355722#30355722", "title": "Issue with arithmetic (double = int / int)", "body": "<p>You need one or both of the variables on the right hand side to be <code>double</code>.</p>\n\n<pre><code>double passRate = double(passed) / double(STUDENTNO);\n</code></pre>\n\n<p>Otherwise, as written, the operation will be performed as <code>int</code>, then the result will be implicitly converted to <code>double</code> before the assignment back to <code>passRate</code>. By then it is too late and integer division has already taken place.</p>\n\n<p>Or if your variables were <code>double</code> right off the bat, the division would have worked fine.</p>\n\n<pre><code>double passed = 1.0;\ndouble STUDENTNO = 3.0;\ndouble passRate = passed / STUDENTNO;\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4586273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7c6e1f969021b4ea75994a163aa90b12?s=128&d=identicon&r=PG&f=1", "display_name": "dotonthewall1", "link": "https://stackoverflow.com/users/4586273/dotonthewall1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 30355722, "answer_count": 1, "score": -2, "last_activity_date": 1432140438, "creation_date": 1432140231, "question_id": 30355713, "link": "https://stackoverflow.com/questions/30355713/issue-with-arithmetic-double-int-int", "title": "Issue with arithmetic (double = int / int)", "body": "<pre><code>int passed(1);\nint STUDENTNO(3);\n\ndouble passRate = (passed / STUDENTNO);\n</code></pre>\n\n<p>The value of <code>passRate</code> is shown as <code>0.00</code> in the example above when stepping through. How can I make it show correctly as <code>0.33?</code></p>\n"}, {"tags": ["c++", "c", "sse", "simd", "avx"], "comments": [{"owner": {"reputation": 514, "user_id": 2452562, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/262533d22c0be8926d9f00db1f39bdd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ken P", "link": "https://stackoverflow.com/users/2452562/ken-p"}, "edited": false, "score": 1, "creation_date": 1432140659, "post_id": 30355620, "comment_id": 48803759, "body": "As a general rule, you should probably check for a capability before you use it.  However, the CPUID instructions that determine whether you have SSE3 or AVX will also determine whether you have SSE2 or MMX.  If you just save the outputs of those CPUID instructions to appropriate variables, you can perform a single bit test whenever you want to use a specific instruction."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1432141144, "post_id": 30355620, "comment_id": 48804031, "body": "This has come up before on SO, but I can&#39;t seem to find the duplicate at the moment..."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1432141938, "post_id": 30355620, "comment_id": 48804473, "body": "Intel CPUs are always backward compatible. Therefore if it supports an instruction set then it&#39;ll support all older versions"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 4, "creation_date": 1432144433, "post_id": 30355620, "comment_id": 48805868, "body": "See also: <a href=\"http://stackoverflow.com/a/17749005/253056\">stackoverflow.com/a/17749005/253056</a>"}], "answers": [{"comments": [{"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1432193843, "post_id": 30356591, "comment_id": 48825463, "body": "I don&#39;t think it&#39;s a good idea to make separate executable for different instruction sets.  One executable using a <a href=\"https://stackoverflow.com/questions/23676426/disable-avx2-functions-on-non-haswell-processors/23677889#23677889\">CPU dispatcher</a> is more ideal in my opinion."}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1432222421, "post_id": 30356591, "comment_id": 48845949, "body": "The <code>&#47;arch:AVX</code> switch applies to an entire module, not just a function, but yes in theory you could create distinct cpp files for each function and compile with different build settings."}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1432222495, "post_id": 30356591, "comment_id": 48845998, "body": "he main issue is that using virtual functions (or function pointers) adds overhead so it really depends on how much work you are doing in the &#39;dispatched&#39; functions. This design, was used by the original D3DXMath library. It as easy to optimize for specific CPUs and detect them at runtime, but the result loses a lot of performance for small operations. That is why DirectXMath for Windows uses only SSE and SSE2 so it can be aggressive inlined and has no &#39;guarded paths&#39; or &#39;virtual functions&#39; to use."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1432277861, "post_id": 30356591, "comment_id": 48868891, "body": "I agree you might not want function pointers for functions that you would normally use static inline with. I&#39;m not sure how to use a dispatcher in that case. In my link above someone mentioned using self modifying code with <code>memcpy</code>. That could solve the function pointer problem and still dispatch. I have not done that yet."}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 1, "creation_date": 1432303565, "post_id": 30356591, "comment_id": 48885334, "body": "Any solution involving self-modifying code is problematic since that&#39;s basically indistinguishable from malware. You&#39;d have to create a non-NX memory area and jump to it."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1432307313, "post_id": 30356591, "comment_id": 48887917, "body": "Good point, I have not created self modifying code since 68k assembly days. In my case I use the dispatcher for functions where static inline is not useful. E.g. I put several static inline functions in one module and have only one function in the module which is external which I call with the dispatcher."}, {"owner": {"reputation": 3277, "user_id": 3087952, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/DijUj.png?s=128&g=1", "display_name": "nonsensation", "link": "https://stackoverflow.com/users/3087952/nonsensation"}, "edited": false, "score": 0, "creation_date": 1434407400, "post_id": 30356591, "comment_id": 49755382, "body": "I&#39;ll wait for clang&#39;s ifunc support as in recent gcc: <a href=\"https://gcc.gnu.org/wiki/FunctionMultiVersioning\" rel=\"nofollow noreferrer\">Function Multi Versioning</a>"}], "tags": [], "owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "is_accepted": true, "score": 10, "last_activity_date": 1594696542, "last_edit_date": 1594696542, "creation_date": 1432143161, "answer_id": 30356591, "question_id": 30355620, "link": "https://stackoverflow.com/questions/30355620/are-older-simd-versions-available-when-using-newer-ones/30356591#30356591", "title": "Are older SIMD-versions available when using newer ones?", "body": "<p>In general, these have been additive but keep in mind that there are differences between Intel and AMD support for these over the years.</p>\n<p>If you have AVX, then you can assume SSE, SSE2, SSE3, SSSE3, SSE4.1, and SSE 4.2 as well. Remember that to use AVX you also need to validate the OSXSAVE CPUID bit is set to ensure the OS you are using actually supports saving the AVX registers as well.</p>\n<p>You should still explicitly check for all the CPUID support you use in your code for robustness (say checking for AVX, OSXSAVE, SSE4, SSE3, SSSE3 at the same time to guard your AVX codepaths).</p>\n<pre><code>#include &lt;intrin.h&gt;\n\ninline bool IsAVXSupported()\n{\n#if defined(_M_IX86 ) || defined(_M_X64)\n   int CPUInfo[4] = {-1};\n   __cpuid( CPUInfo, 0 );\n\n   if ( CPUInfo[0] &lt; 1  )\n       return false;\n\n    __cpuid(CPUInfo, 1 );\n\n    int ecx = 0x10000000 // AVX\n              | 0x8000000 // OSXSAVE\n              | 0x100000 // SSE 4.2\n              | 0x80000 // SSE 4.1\n              | 0x200 // SSSE3\n              | 0x1; // SSE3\n\n    if ( ( CPUInfo[2] &amp; ecx ) != ecx )\n        return false;\n\n    return true;\n#else\n    return false;\n#endif\n}\n</code></pre>\n<p>SSE and SSE2 are required for all processors capable of x64 native, so they are good baseline assumptions for all code. Windows 8.0, Windows 8.1, and Windows 10 explicitly require SSE and SSE2 support even for x86 architectures so those instruction sets are pretty ubiquitous. In other words, if you fail a check for SSE or SSE2, just exit the app with a fatal error.</p>\n<pre><code>#include &lt;windows.h&gt;\n\ninline bool IsSSESupported()\n{\n#if defined(_M_IX86 ) || defined(_M_X64)\n   return ( IsProcessorFeaturePresent( PF_XMMI_INSTRUCTIONS_AVAILABLE ) != 0 &amp;&amp; IsProcessorFeaturePresent( PF_XMMI64_INSTRUCTIONS_AVAILABLE ) != 0 );\n#else\n    return false;\n#endif\n}\n</code></pre>\n<p>-or-</p>\n<pre><code>#include &lt;intrin.h&gt;\n\ninline bool IsSSESupported()\n{\n#if defined(_M_IX86 ) || defined(_M_X64)\n   int CPUInfo[4] = {-1};\n   __cpuid( CPUInfo, 0 );\n\n   if ( CPUInfo[0] &lt; 1  )\n       return false;\n\n    __cpuid(CPUInfo, 1 );\n\n    int edx = 0x4000000 // SSE2\n              | 0x2000000; // SSE\n\n    if ( ( CPUInfo[3] &amp; edx ) != edx )\n        return false;\n\n    return true;\n#else\n    return false;\n#endif\n}\n</code></pre>\n<p>Also, keep in mind that MMX, x87 FPU, and <a href=\"http://en.wikipedia.org/wiki/3DNow!\" rel=\"nofollow noreferrer\">AMD 3DNow!</a>* are all deprecated instruction sets for x64 native, so you shouldn't be using them actively anymore in newer code. A  good rule of thumb is to avoid using any intrinsic that returns a <code>__m64</code> or takes a <code>__m64</code> data type.</p>\n<p>You may want to check out this <a href=\"https://walbourn.github.io/directxmath-sse-sse2-and-arm-neon/\" rel=\"nofollow noreferrer\">DirectXMath blog series</a> with notes on many of these instruction sets and the relevant processor support requirements.</p>\n<p><strong>Note</strong> (*) - All the AMD 3DNow! instructions are deprecated except for <code>PREFETCH</code> and <code>PREFETCHW</code> which were carried forward. First generation Intel64 processors lacked support for these instructions, but they were later added as they are considered part of the core X64 instruction set. Windows 8.1 and Windows 10 x64 require <code>PREFETCHW</code> in particular, although the test is a little odd. Most Intel CPUs prior to Broadwell do not in fact report support for <code>PREFETCHW</code> through CPUID, but they treat the opcode as a no-op rather than throw an 'illegal instruction' exception. As such, the test here is (a) is it supported by CPUID, and (b) if not, does <code>PREFETCHW</code> at least not throw an exception.</p>\n<p>Here's some test code for Visual Studio that demonstrates the <code>PREFETCHW</code> test as well as many other CPUID bits for the x86 and x64 platforms.</p>\n<pre><code>#include &lt;intrin.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;excpt.h&gt;\n\nvoid main()\n{\n   unsigned int x = _mm_getcsr();\n   printf(&quot;%08X\\n&quot;, x );\n\n   bool prefetchw = false;\n\n   // See http://msdn.microsoft.com/en-us/library/hskdteyh.aspx\n   int CPUInfo[4] = {-1};\n   __cpuid( CPUInfo, 0 );\n\n   if ( CPUInfo[0] &gt; 0 )\n   {\n       __cpuid(CPUInfo, 1 );\n\n       // EAX\n       {\n           int stepping = (CPUInfo[0] &amp; 0xf);\n           int basemodel = (CPUInfo[0] &gt;&gt; 4) &amp; 0xf;\n           int basefamily = (CPUInfo[0] &gt;&gt; 8) &amp; 0xf;\n           int xmodel = (CPUInfo[0] &gt;&gt; 16) &amp; 0xf;\n           int xfamily = (CPUInfo[0] &gt;&gt; 20) &amp; 0xff;\n\n           int family = basefamily + xfamily;\n           int model = (xmodel &lt;&lt; 4) | basemodel;\n\n           printf(&quot;Family %02X, Model %02X, Stepping %u\\n&quot;, family, model, stepping );\n       }\n\n       // ECX\n       if ( CPUInfo[2] &amp; 0x20000000 ) // bit 29\n          printf(&quot;F16C\\n&quot;);\n\n       if ( CPUInfo[2] &amp; 0x10000000 ) // bit 28\n          printf(&quot;AVX\\n&quot;);\n\n       if ( CPUInfo[2] &amp; 0x8000000 ) // bit 27\n          printf(&quot;OSXSAVE\\n&quot;);\n\n       if ( CPUInfo[2] &amp; 0x400000 ) // bit 22\n          printf(&quot;MOVBE\\n&quot;);\n\n       if ( CPUInfo[2] &amp; 0x100000 ) // bit 20\n          printf(&quot;SSE4.2\\n&quot;);\n\n       if ( CPUInfo[2] &amp; 0x80000 ) // bit 19\n          printf(&quot;SSE4.1\\n&quot;);\n\n       if ( CPUInfo[2] &amp; 0x2000 ) // bit 13\n          printf(&quot;CMPXCHANG16B\\n&quot;);\n\n       if ( CPUInfo[2] &amp; 0x1000 ) // bit 12\n          printf(&quot;FMA3\\n&quot;);\n\n       if ( CPUInfo[2] &amp; 0x200 ) // bit 9\n          printf(&quot;SSSE3\\n&quot;);\n\n       if ( CPUInfo[2] &amp; 0x1 ) // bit 0\n          printf(&quot;SSE3\\n&quot;);\n\n       // EDX\n       if ( CPUInfo[3] &amp; 0x4000000 ) // bit 26\n           printf(&quot;SSE2\\n&quot;);\n\n       if ( CPUInfo[3] &amp; 0x2000000 ) // bit 25\n           printf(&quot;SSE\\n&quot;);\n\n       if ( CPUInfo[3] &amp; 0x800000 ) // bit 23\n           printf(&quot;MMX\\n&quot;);\n   }\n   else\n       printf(&quot;CPU doesn't support Feature Identifiers\\n&quot;);\n\n   if ( CPUInfo[0] &gt;= 7 )\n   {\n       __cpuidex(CPUInfo, 7, 0);\n\n       // EBX\n       if ( CPUInfo[1] &amp; 0x100 ) // bit 8\n         printf(&quot;BMI2\\n&quot;);\n\n       if ( CPUInfo[1] &amp; 0x20 ) // bit 5\n         printf(&quot;AVX2\\n&quot;);\n\n       if ( CPUInfo[1] &amp; 0x8 ) // bit 3\n         printf(&quot;BMI\\n&quot;);\n   }\n   else\n       printf(&quot;CPU doesn't support Structured Extended Feature Flags\\n&quot;);\n\n   // Extended features\n   __cpuid( CPUInfo, 0x80000000 );\n\n   if ( CPUInfo[0] &gt; 0x80000000 )\n   {\n       __cpuid(CPUInfo, 0x80000001 );\n\n       // ECX\n       if ( CPUInfo[2] &amp; 0x10000 ) // bit 16\n           printf(&quot;FMA4\\n&quot;);\n\n       if ( CPUInfo[2] &amp; 0x800 ) // bit 11\n           printf(&quot;XOP\\n&quot;);\n\n       if ( CPUInfo[2] &amp; 0x100 ) // bit 8\n       {\n           printf(&quot;PREFETCHW\\n&quot;);\n           prefetchw = true;\n       }\n\n       if ( CPUInfo[2] &amp; 0x80 ) // bit 7\n           printf(&quot;Misalign SSE\\n&quot;);\n\n       if ( CPUInfo[2] &amp; 0x40 ) // bit 6\n           printf(&quot;SSE4A\\n&quot;);\n\n       if ( CPUInfo[2] &amp; 0x1 ) // bit 0\n           printf(&quot;LAHF/SAHF\\n&quot;);\n\n       // EDX\n       if ( CPUInfo[3] &amp; 0x80000000 ) // bit 31\n           printf(&quot;3DNow!\\n&quot;);\n\n       if ( CPUInfo[3] &amp; 0x40000000 ) // bit 30\n           printf(&quot;3DNowExt!\\n&quot;);\n\n       if ( CPUInfo[3] &amp; 0x20000000 ) // bit 29\n           printf(&quot;x64\\n&quot;);\n\n       if ( CPUInfo[3] &amp; 0x100000 ) // bit 20\n           printf(&quot;NX\\n&quot;);\n   }\n   else\n       printf(&quot;CPU doesn't support Extended Feature Identifiers\\n&quot;);\n\n   if ( !prefetchw )\n   {\n       bool illegal = false;\n\n       __try\n       {\n           static const unsigned int s_data = 0xabcd0123;\n\n           _m_prefetchw(&amp;s_data);\n       }\n       __except (EXCEPTION_EXECUTE_HANDLER)\n       {\n           illegal = true;\n       }\n\n       if (illegal)\n       {\n           printf(&quot;PREFETCHW is an invalid instruction on this processor\\n&quot;);\n       }\n   }\n}\n</code></pre>\n<p><strong>UPDATE:</strong> The fundamental challenge, of course, is how do you handle systems that lack support for AVX? While the instruction set is useful, the biggest benefit of having an AVX-capable processor is the ability to use the <code>/arch:AVX</code> build switch which enables the global use of the <a href=\"http://en.wikipedia.org/wiki/VEX_prefix\" rel=\"nofollow noreferrer\">VEX prefix</a> for better SSE/SSE2 code-gen. The only problem is the resulting code DLL/EXE is not compatible with systems that lack AVX support.</p>\n<p>As such, for Windows, ideally you should build one EXE for non-AVX systems (assuming SSE/SSE2 only so use <code>/arch:SSE2</code> instead for x86 code; this setting is implicit for x64 code), a different EXE that is optimized for AVX (using <code>/arch:AVX</code>), and then use CPU detection to determine which EXE to use for a given system.</p>\n<p>Luckily with Xbox One, we can just always build with <code>/arch::AVX</code> since it's a fixed platform...</p>\n<p><strong>UPDATE 2:</strong> For clang/LLVM, you should use slight dikyfferent intriniscs for <code>CPUID</code>:</p>\n<pre><code>if defined(__clang__) || defined(__GNUC__)\n    __cpuid(1, CPUInfo[0], CPUInfo[1], CPUInfo[2], CPUInfo[3]);\n#else\n    __cpuid(CPUInfo, 1);\n#endif\n</code></pre>\n<pre><code>if defined(__clang__) || defined(__GNUC__)\n    __cpuid_count(7, 0, CPUInfo[0], CPUInfo[1], CPUInfo[2], CPUInfo[3]);\n#else\n    __cpuidex(CPUInfo, 7, 0);\n#endif\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1478178196, "post_id": 30356721, "comment_id": 68054431, "body": "To be fair, this mixing issue only occurs when you mix non-VEX code with VEX using code (i.e., mix AVX or AVX2 with earlier 2 operand SSE instructions). Other than that it&#39;s fine and necessary to mix between generations - necessary because each extension isn&#39;t a complete useful USA by itself but builds on the last one."}, {"owner": {"reputation": 17597, "user_id": 2016408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TVba8.jpg?s=128&g=1", "display_name": "Leeor", "link": "https://stackoverflow.com/users/2016408/leeor"}, "reply_to_user": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1478454614, "post_id": 30356721, "comment_id": 68150373, "body": "@BeeOnRope, It&#39;s ok to mix, but you need to protect yourself from the issue I was talking about. See - <a href=\"http://stackoverflow.com/questions/7839925/using-avx-cpu-instructions-poor-performance-without-archavx\" title=\"using avx cpu instructions poor performance without archavx\">stackoverflow.com/questions/7839925/&hellip;</a>"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1478458043, "post_id": 30356721, "comment_id": 68151671, "body": "Yeah exactly, but even that question is a bit unclear since it doesn&#39;t point out that almost all interesting SSE instructions have a VEX-encoded version - including 128-bit variants. Many people still loosely call those &quot;SSE&quot; instructions. For example, you&#39;ll hear that <code>pshufb</code> is an <code>SSE3</code> instruction. Indeed an invocation like <code>phsufb xmm0, xmm1</code> creates an non-VEX encoding that would cause the performance problem you mention. Simply changing that to the identically behaved <code>pshufb xmm0, xmm0, xmm1</code>, however, changes it to VEX-encoding and avoids the issue."}], "tags": [], "owner": {"reputation": 17597, "user_id": 2016408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TVba8.jpg?s=128&g=1", "display_name": "Leeor", "link": "https://stackoverflow.com/users/2016408/leeor"}, "is_accepted": false, "score": 4, "last_activity_date": 1432143628, "creation_date": 1432143628, "answer_id": 30356721, "question_id": 30355620, "link": "https://stackoverflow.com/questions/30355620/are-older-simd-versions-available-when-using-newer-ones/30356721#30356721", "title": "Are older SIMD-versions available when using newer ones?", "body": "<p>As a general rule - don't mix different generations of SSE / AVX unless you have to. If you do, make sure you use vzeroupper or similar state clearing instructions, otherwise you may drag partial values and unknowingly create false dependencies, since most of the registers are shared between the modes\nEven when clearing, switching between modes may cause penalties, depending on the exact micro architecture.</p>\n\n<p>Further reading - <a href=\"https://software.intel.com/sites/default/files/m/d/4/1/d/8/11MC12_Avoiding_2BAVX-SSE_2BTransition_2BPenalties_2Brh_2Bfinal.pdf\" rel=\"nofollow\">https://software.intel.com/sites/default/files/m/d/4/1/d/8/11MC12_Avoiding_2BAVX-SSE_2BTransition_2BPenalties_2Brh_2Bfinal.pdf</a></p>\n"}, {"tags": [], "owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 3, "last_activity_date": 1478147299, "creation_date": 1478147299, "answer_id": 40393887, "question_id": 30355620, "link": "https://stackoverflow.com/questions/30355620/are-older-simd-versions-available-when-using-newer-ones/40393887#40393887", "title": "Are older SIMD-versions available when using newer ones?", "body": "<p><strong>See Chuck's answer for good advice on what you should do.  See this answer for a literal answer to the question asked, in case you're curious.</strong></p>\n\n<hr>\n\n<p>AVX support absolutely guarantees support for all <em>Intel</em> SSE* instruction sets, since it includes VEX-encoded versions of all of them.  As Chuck points out, you can check for previous ones at the same time with a bitmask, without bloating your code, but don't sweat it.</p>\n\n<p>Note that POPCNT, TZCNT, and stuff like that are not part of SSE-anything.  <a href=\"http://www.felixcloutier.com/x86/POPCNT.html\" rel=\"nofollow noreferrer\">POPCNT</a> has its own feature bit.  <a href=\"http://www.felixcloutier.com/x86/LZCNT.html\" rel=\"nofollow noreferrer\">LZCNT</a> has its own feature bit, too, since AMD introduced it separately from BMI1.  <a href=\"http://www.felixcloutier.com/x86/TZCNT.html\" rel=\"nofollow noreferrer\">TZCNT</a> is just part of BMI1, though.  Since some BMI1 instructions use VEX encodings, even latest-generation Pentium/Celeron CPUs (like Skylake Pentium) don't have BMI1. :(  I think Intel just wanted to omit AVX/AVX2, probably so they could sell CPUs with faulty upper-lanes of execution units as Pentiums, and they do this by disabling VEX support in the decoders.</p>\n\n<hr>\n\n<p>Intel SSE support has been incremental in all CPUs released so far.  SSE4.1 implies SSSE3, SSE3, SSE2, and SSE.  And SSE4.2 implies all of the preceding.  I'm not sure if any official x86 documentation precludes the possibility of a CPU with SSE4.1 support but not SSSE3.  (i.e. leave out PSHUFB, which is possibly expensive-to-implement.)  It's extremely unlikely in practice, though, since this would violate many people's assumptions.  As I said, it might even be officially forbidden, but I didn't check carefully.</p>\n\n<hr>\n\n<p>AVX does not include AMD SSE4a or AMD XOP.  AMD extensions have to be checked-for specially.  Also note that the newest AMD CPUs are dropping XOP support.  (Intel never adopted it, so most people don't write code to take advantage of it, so for AMD those transistors are mostly wasted.  It does have some nice stuff, like a 2-source byte permute, allowing a byte LUT twice as wide as PSHUFB, without the in-lane limitation of AVX2's VPSHUFB ymm).</p>\n\n<hr>\n\n<p><strong>SSE2 is baseline for the x86-64 architecture</strong>.  You do not have to check for SSE or SSE2 support in 64-bit builds.  I forget if MMX is baseline, too.  Almost certainly.</p>\n\n<p>The SSE instruction set includes some instructions that operate on MMX registers.  (e.g. <a href=\"http://www.felixcloutier.com/x86/PMAXSW.html\" rel=\"nofollow noreferrer\"><code>PMAXSW mm1, mm2/m64</code></a> was new with SSE.  The XMM version is part of SSE2.)  Even a 32-bit CPU supporting SSE needs to have MMX registers.  It would be madness to have MMX registers but only support the SSE instructions that use them, not the original MMX instructions (e.g. <a href=\"http://www.felixcloutier.com/x86/MOVD:MOVQ.html\" rel=\"nofollow noreferrer\"><code>movq mm0, [mem]</code></a>).  However, I haven't found anything definitive that rules out the possibility of an x86-based <a href=\"http://www.statemaster.com/encyclopedia/DeathStation-9000\" rel=\"nofollow noreferrer\">Deathstation 9000</a> with SSE but not MMX CPUID feature bits, but I didn't wade into Intel's official x86 manuals.  (See the <a href=\"/questions/tagged/x86\" class=\"post-tag\" title=\"show questions tagged &#39;x86&#39;\" rel=\"tag\">x86</a> tag wiki for links).</p>\n\n<p>Don't use MMX anyway, it's generally slower even if you only have 64 bits at a time to work on, in the low half of an XMM register.  The latest CPUs (like Intel Skylake) have lower throughput for the MMX versions of some instructions than for the XMM version.  In some cases, even worse latency.  For example, according to <a href=\"http://agner.org/optimize/\" rel=\"nofollow noreferrer\">Agner Fog's testing</a>, <code>PACKSSWB mm0, mm1</code> is 3 uops, with 2c latency, on Skylake.  The 128b and 256b XMM / YMM versions are 1 uop, with 1c latency.</p>\n"}], "owner": {"reputation": 3277, "user_id": 3087952, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/DijUj.png?s=128&g=1", "display_name": "nonsensation", "link": "https://stackoverflow.com/users/3087952/nonsensation"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 657, "favorite_count": 3, "accepted_answer_id": 30356591, "answer_count": 3, "score": 13, "last_activity_date": 1594696542, "creation_date": 1432139958, "last_edit_date": 1432144453, "question_id": 30355620, "link": "https://stackoverflow.com/questions/30355620/are-older-simd-versions-available-when-using-newer-ones", "title": "Are older SIMD-versions available when using newer ones?", "body": "<p>When I can use SSE3 or AVX, are then older SSE versions as SSE2 or MMX available -<br>\nor do I still need to check for them separately?</p>\n"}, {"tags": ["c++", "database", "sql-server", "qt"], "answers": [{"comments": [{"owner": {"reputation": 282, "user_id": 2649380, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/71827eeeec4eedfc622faa8b06eaa6f1?s=128&d=identicon&r=PG", "display_name": "APRocha", "link": "https://stackoverflow.com/users/2649380/aprocha"}, "edited": false, "score": 0, "creation_date": 1432141550, "post_id": 30543373, "comment_id": 49159616, "body": "yes, i know, have contemplated the task. I ask because i read other strings and i don&#39;t sure &#191;if the this works in all sql servers?.  Thanks for the tip for security."}], "tags": [], "owner": {"reputation": 199, "user_id": 517856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715dcc679dafbcfaa8e98255181b3783?s=128&d=identicon&r=PG&f=1", "display_name": "Morons", "link": "https://stackoverflow.com/users/517856/morons"}, "is_accepted": true, "score": 0, "last_activity_date": 1432141215, "creation_date": 1432141215, "answer_id": 30543373, "question_id": 30543372, "link": "https://stackoverflow.com/questions/30543372/qt-connection-sql-server-universal-connection-string/30543373#30543373", "title": "Qt connection Sql Server (universal connection string)", "body": "<p>You <strong>need</strong> to Allow for the user to configure the connection string.</p>\n\n<p><strong>FYI:</strong> To get around you password issue use integrated security. </p>\n\n<pre><code>\"Driver={SQLServer};Server=localhost; Database=local; Trusted_Connection=yes;\"\n</code></pre>\n"}], "migrated_from": {"other_site": {"aliases": ["http://programmer.stackexchange.com", "http://programmers.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1292524346, "open_beta_date": 1283972400, "closed_beta_date": 1283367600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/apple-touch-icon@2.png", "twitter_account": "StackSoftEng", "favicon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/apple-touch-icon.png", "audience": "professionals, academics, and students working within the systems development life cycle", "site_url": "https://softwareengineering.stackexchange.com", "api_site_parameter": "softwareengineering", "logo_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/logo.png", "name": "Software Engineering", "site_type": "main_site"}, "on_date": 1432969680, "question_id": 284462}, "owner": {"reputation": 282, "user_id": 2649380, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/71827eeeec4eedfc622faa8b06eaa6f1?s=128&d=identicon&r=PG", "display_name": "APRocha", "link": "https://stackoverflow.com/users/2649380/aprocha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 954, "favorite_count": 0, "closed_date": 1433023893, "accepted_answer_id": 30543373, "answer_count": 1, "score": -1, "last_activity_date": 1432969680, "creation_date": 1432139752, "question_id": 30543372, "link": "https://stackoverflow.com/questions/30543372/qt-connection-sql-server-universal-connection-string", "closed_reason": "Duplicate", "title": "Qt connection Sql Server (universal connection string)", "body": "<p>I am developing a software  to connect to sql server. The problem is, \u00bfi don't know wich sql server is used?, and my question is \u00bfif exist a universal connection String?.</p>\n\n<p>I read many cases and in most, this is the string used:</p>\n\n<pre><code> QString stringConnection=\"DRIVER={SQL Server};SERVER=localhost;DATABASE=local;UID=sad;PWD=soc; WSID=.\";\n</code></pre>\n\n<p>Obviously, the user and password changes, and is possible a Sql Server running as instance, in this case i should add \"\\nameInstance\" to field Server.</p>\n\n<pre><code> QString stringConnection=\"DRIVER={SQL Server};SERVER=localhost\\\\server2008;DATABASE=local;UID=sad;PWD=soc; WSID=.\"\n</code></pre>\n\n<p>\u00bfcan i use this string connection in all versions of Sql Server?</p>\n"}, {"tags": ["c++", "validation", "input", "while-loop", "iostream"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1432139678, "post_id": 30355426, "comment_id": 48803110, "body": "Please make this an <a href=\"http://sscce.org\" rel=\"nofollow noreferrer\">SSCCE</a>"}, {"owner": {"reputation": 63, "user_id": 4921008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tIbAm.jpg?s=128&g=1", "display_name": "whoiskatrin", "link": "https://stackoverflow.com/users/4921008/whoiskatrin"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1432140358, "post_id": 30355426, "comment_id": 48803565, "body": "@RichardCritten I do, I see that I enter choice only one time, but should every time. I can&#39;t understand it. I just need some help, guys.."}, {"owner": {"reputation": 63, "user_id": 4921008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tIbAm.jpg?s=128&g=1", "display_name": "whoiskatrin", "link": "https://stackoverflow.com/users/4921008/whoiskatrin"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1432140485, "post_id": 30355426, "comment_id": 48803651, "body": "@NathanOliver I will, this is my first post ever."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 4921008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tIbAm.jpg?s=128&g=1", "display_name": "whoiskatrin", "link": "https://stackoverflow.com/users/4921008/whoiskatrin"}, "edited": false, "score": 0, "creation_date": 1432140970, "post_id": 30355887, "comment_id": 48803941, "body": "I get it, thanks. Should I use something like cin.clear() or how should I ignore the wrong input?"}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 63, "user_id": 4921008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tIbAm.jpg?s=128&g=1", "display_name": "whoiskatrin", "link": "https://stackoverflow.com/users/4921008/whoiskatrin"}, "edited": false, "score": 0, "creation_date": 1432141203, "post_id": 30355887, "comment_id": 48804058, "body": "Both ! Give me 10 minutes. I&#39;m back home and can use a real keyboard to answer ;-)"}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 63, "user_id": 4921008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tIbAm.jpg?s=128&g=1", "display_name": "whoiskatrin", "link": "https://stackoverflow.com/users/4921008/whoiskatrin"}, "edited": false, "score": 0, "creation_date": 1432142814, "post_id": 30355887, "comment_id": 48804927, "body": "@whoiskatrin edited:  you&#39;ve the linke to the function reference, as well as an example how to do error processing, reasking the user until he either gives something ok or ends the input."}, {"owner": {"reputation": 63, "user_id": 4921008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tIbAm.jpg?s=128&g=1", "display_name": "whoiskatrin", "link": "https://stackoverflow.com/users/4921008/whoiskatrin"}, "edited": false, "score": 0, "creation_date": 1432142928, "post_id": 30355887, "comment_id": 48804977, "body": "oh, thank you. I didn&#39;t know about cin.ignore(). Now I understand, can I ask ? What is &quot;cerr&quot; and cin.eof()?"}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 63, "user_id": 4921008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tIbAm.jpg?s=128&g=1", "display_name": "whoiskatrin", "link": "https://stackoverflow.com/users/4921008/whoiskatrin"}, "edited": false, "score": 0, "creation_date": 1432143196, "post_id": 30355887, "comment_id": 48805109, "body": "<code>cerr</code> is like <code>cout</code>, but it&#39;s used only for displaying errors.  cin.eof() tells if end of file was encountered during the last attempt to read the input."}, {"owner": {"reputation": 63, "user_id": 4921008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tIbAm.jpg?s=128&g=1", "display_name": "whoiskatrin", "link": "https://stackoverflow.com/users/4921008/whoiskatrin"}, "edited": false, "score": 0, "creation_date": 1432145761, "post_id": 30355887, "comment_id": 48806652, "body": "how can I prevent invalid input, when someone enter numeric data with character data. For example &quot;2sfs&quot;, so then program thinks that the &quot;case 2&quot;  was chosen. How can I fix it?"}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 63, "user_id": 4921008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tIbAm.jpg?s=128&g=1", "display_name": "whoiskatrin", "link": "https://stackoverflow.com/users/4921008/whoiskatrin"}, "edited": false, "score": 0, "creation_date": 1432146285, "post_id": 30355887, "comment_id": 48806950, "body": "Then you should <code>&gt;&gt;</code>  a string and convert the string to an int, after having verified that it&#39;s only composed of digits."}, {"owner": {"reputation": 63, "user_id": 4921008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tIbAm.jpg?s=128&g=1", "display_name": "whoiskatrin", "link": "https://stackoverflow.com/users/4921008/whoiskatrin"}, "edited": false, "score": 0, "creation_date": 1432148603, "post_id": 30355887, "comment_id": 48808303, "body": "Please, check my answer, I hope this is that way what you wrote me about."}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 63, "user_id": 4921008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tIbAm.jpg?s=128&g=1", "display_name": "whoiskatrin", "link": "https://stackoverflow.com/users/4921008/whoiskatrin"}, "edited": false, "score": 0, "creation_date": 1432149294, "post_id": 30355887, "comment_id": 48808687, "body": "Seems fine, if the number is not allowed to be negative."}], "tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": true, "score": 1, "last_activity_date": 1432142504, "last_edit_date": 1432142504, "creation_date": 1432140781, "answer_id": 30355887, "question_id": 30355426, "link": "https://stackoverflow.com/questions/30355426/while-loop-uses-the-same-value-each-time/30355887#30355887", "title": "While loop uses the same value each time", "body": "<p><code>choice</code> is an <code>int</code>. When you do <code>cin&gt;&gt;choice</code> and the user enters a non numeric value, the failbit is set for <code>cin</code>. This bit will make all subsequent input fail as well, until you clear the flag with <strong><a href=\"http://www.cplusplus.com/reference/ios/ios/clear/\" rel=\"nofollow\"><code>cin.clear()</code></a></strong> and ignore the wrong input with <strong><a href=\"http://www.cplusplus.com/reference/istream/istream/ignore/\" rel=\"nofollow\"><code>cin.ignore()</code></a></strong>.  </p>\n\n<p>Example:  </p>\n\n<pre><code>while ((cin&gt;&gt;choice).fail() &amp;&amp; !cin.eof()) {  // if failed but not eof\n    cout&lt;&lt;\"Enter numeric data ! Please retry... \";\n    cin.clear();                  // clear error state\n    cin.ignore(INT_MAX,'\\n');     // ignore everything until then end of the line\n}\nif (cin.eof()) {\n    cerr &lt;&lt; \"FATAL ERROR: unexpected end of file\"&lt;&lt;endl; \n    exit(1); \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "edited": false, "score": 0, "creation_date": 1432149708, "post_id": 30358216, "comment_id": 48808909, "body": "If you want a constant iterator use cbegin() and cend().  (I&#39;ve edited)"}], "tags": [], "owner": {"reputation": 63, "user_id": 4921008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tIbAm.jpg?s=128&g=1", "display_name": "whoiskatrin", "link": "https://stackoverflow.com/users/4921008/whoiskatrin"}, "is_accepted": false, "score": 1, "last_activity_date": 1432149652, "last_edit_date": 1432149652, "creation_date": 1432148393, "answer_id": 30358216, "question_id": 30355426, "link": "https://stackoverflow.com/questions/30355426/while-loop-uses-the-same-value-each-time/30358216#30358216", "title": "While loop uses the same value each time", "body": "<p>Maybe it will useful for someone. If you want to check that an input string has only numeric values, you can do it this way:</p>\n\n<pre><code> bool is_number(const string&amp; str)\n {\n      auto it = str.cbegin();\n      while (it != str.cend() &amp;&amp; isdigit(*it)) ++it;\n      return !str.empty() &amp;&amp; it == str.cend();\n }\n\n\n string choice;\n ...\n cin &gt;&gt; choice; \n if (!is_number(choice)) {\n        cout &lt;&lt; \"Enter numeric data ! Please retry.\" &lt;&lt; endl;\n        cin.clear();                   \n }\n else {\n       // process the number \n }\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 4921008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tIbAm.jpg?s=128&g=1", "display_name": "whoiskatrin", "link": "https://stackoverflow.com/users/4921008/whoiskatrin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 30355887, "answer_count": 2, "score": -5, "last_activity_date": 1432149652, "creation_date": 1432139328, "last_edit_date": 1432148853, "question_id": 30355426, "link": "https://stackoverflow.com/questions/30355426/while-loop-uses-the-same-value-each-time", "title": "While loop uses the same value each time", "body": "<p>I have the problem with my code. There is while loop and when a enter not a number and for example character data, so then this loop uses the same value of choice each time.\nIt's a list where user should choose one of variants. Choice it's a user's choice. There should be only integer value and I have trouble with character.</p>\n\n<p>For example:\nchoice = a;\nso then I can't change it ever, because loop doesn't work.\nif choice = 2, it works good and I can change choice while loop is working. </p>\n\n<pre><code>int main()\n{\n\n    setlocale(LC_ALL, \"Russian\");\n    string fname;\n    Data object;\n    do\n    {\n        std::cout &lt;&lt; \"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u0444\u0430\u0439\u043b\u0430: \";\n        out &lt;&lt; \"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u0444\u0430\u0439\u043b\u0430: \";\n        cin &gt;&gt; fname;\n        out &lt;&lt; fname;\n        object.CreateAndRecordToFile(fname);\n    }\n    while (nameisright == false);\n\n\n    std::cout &lt;&lt; \"\u0421\u043e\u0437\u0434\u0430\u043d \u0444\u0430\u0439\u043b \u0434\u043b\u044f \u0437\u0430\u043f\u0438\u0441\u0438 \" &lt;&lt; object.ffullname &lt;&lt; endl;\n    out.open(object.ffullname, ofstream::out);// \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u044e \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b \u0438 \u0433\u043e\u0432\u043e\u0440\u044e, \u0447\u0442\u043e \u0445\u043e\u0447\u0443 \u0432 \u043d\u0435\u0433\u043e \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0442\u044c\n\n\n    int ch1, ch2;\n    bool prov = true;\n    int choice;\n\n    while (prov)\n    {\n\n        std::cout &lt;&lt; \"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043c\u0435\u0442\u043e\u0434 \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0421\u041b\u0410\u0423:\" &lt;&lt; endl;\n        out &lt;&lt; \"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043c\u0435\u0442\u043e\u0434 \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0421\u041b\u0410\u0423:\";\n        std::cout &lt;&lt; \"1. \u041c\u0435\u0442\u043e\u0434 \u0413\u0430\u0443\u0441\u0441\u0430 \\n\";\n        out &lt;&lt; \"1. \u041c\u0435\u0442\u043e\u0434 \u0413\u0430\u0443\u0441\u0441\u0430 \\n\";\n        std::cout &lt;&lt; \"2. \u041c\u0435\u0442\u043e\u0434 LU \u0440\u0430\u0437\u043b\u043e\u0436\u0435\u043d\u0438\u044f\\n\";\n        out &lt;&lt; \"2. \u041c\u0435\u0442\u043e\u0434 LU \u0440\u0430\u0437\u043b\u043e\u0436\u0435\u043d\u0438\u044f\\n\";\n        std::cout &lt;&lt; \"3. \u0412\u044b\u0445\u043e\u0434\\n\";\n        out &lt;&lt; \"3. \u0412\u044b\u0445\u043e\u0434\\n\";\n        std::cout &lt;&lt; \"\u0412\u0430\u0448 \u0432\u044b\u0431\u043e\u0440: \";\n        out &lt;&lt; \"\u0412\u0430\u0448 \u0432\u044b\u0431\u043e\u0440: \";\n        cin &gt;&gt; choice;\n        //char ccc[200];\n        //cin &gt;&gt; ccc;\n        /*while (false){\n            if (strlen(ccc) != 0){\n            for (int i = 0; i &lt; strlen(ccc); i++) {\n            if (!isdigit(ccc[1])){\n            std::cout &lt;&lt; ccc[i] &lt;&lt; \" is not numeric.\\n\";\n            return false;\n            }\n            }\n            }\n            }*/\n\n        //else\n\n        //choice = stoi(ccc);\n\n        //out &lt;&lt; ccc;\n        //check(choice);\n        switch (choice)\n        {\n        case 1:            // \u0413\u0430\u0443\u0441\u0441 \n        {\n\n\n            std::cout &lt;&lt; \"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043c\u0435\u0442\u043e\u0434 \u0432\u0432\u043e\u0434\u0430 \u0434\u0430\u043d\u043d\u044b\u0445:\" &lt;&lt; endl;\n            out &lt;&lt; \"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043c\u0435\u0442\u043e\u0434 \u0432\u0432\u043e\u0434\u0430 \u0434\u0430\u043d\u043d\u044b\u0445: \";\n            std::cout &lt;&lt; \"1. \u0412\u0432\u043e\u0434 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441 \u043a\u043b\u0430\u0432\u0438\u0430\u0442\u0443\u0440\u044b \\n\";\n            out &lt;&lt; \"1. \u0412\u0432\u043e\u0434 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441 \u043a\u043b\u0430\u0432\u0438\u0430\u0442\u0443\u0440\u044b  \\n\";\n            std::cout &lt;&lt; \"2. \u0412\u0432\u043e\u0434 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 \u0444\u0430\u0439\u043b\u0430 \\n\";\n            out &lt;&lt; \"2. \u0412\u0432\u043e\u0434 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 \u0444\u0430\u0439\u043b\u0430\\n\";\n            std::cout &lt;&lt; \"3. \u0412\u044b\u0445\u043e\u0434\\n\";\n            out &lt;&lt; \"3. \u0412\u044b\u0445\u043e\u0434\\n\";\n            std::cout &lt;&lt; \"\u0412\u0430\u0448 \u0432\u044b\u0431\u043e\u0440: \";\n            out &lt;&lt; \"\u0412\u0430\u0448 \u0432\u044b\u0431\u043e\u0440: \";\n            cin &gt;&gt; ch1;\n            out &lt;&lt; ch1;\n            switch (ch1)\n            {\n            case 1:\n                object.Size();\n                object.Init();\n                object.MatrixInPut();\n                object.InitAndInputVector();\n                object.printAll();\n                object.GaussElimination();\n                object.printResultGauss();\n                break;\n            case 2:\n                object.ReadingSize();\n                object.Init();\n                object.ReadingMatrixFromFile();\n                object.ReadingVectorFromFile();\n                object.printAll();\n                object.GaussElimination();\n                object.printResultGauss();\n\n                break;\n            case 3:            // \u041f\u0440\u043e\u0441\u0442\u043e \u043f\u0440\u043e\u0449\u0430\u0439\u0442\u0435\n                std::cout &lt;&lt; endl;\n                out &lt;&lt; endl;\n                std::cout &lt;&lt; \"\u0421\u043f\u0430\u0441\u0438\u0431\u043e, \u0447\u0442\u043e \u0431\u044b\u043b\u0438 \u0441 \u043d\u0430\u043c\u0438!\\n\";\n                out &lt;&lt; \"\u0421\u043f\u0430\u0441\u0438\u0431\u043e, \u0447\u0442\u043e \u0431\u044b\u043b\u0438 \u0441 \u043d\u0430\u043c\u0438!\\n\";\n                prov = false;\n                break;\n            default:            // \u041d\u0430 \u0441\u043b\u0443\u0447\u0430\u0439 \u0444\u0435\u0439\u043b\u043e\u0432\n                std::cout &lt;&lt; endl;\n                out &lt;&lt; endl;\n                std::cout &lt;&lt; \"\u041e\u0448\u0438\u0431\u043a\u0430, \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0432\u0432\u043e\u0434, \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u0432\u0432\u043e\u0434.\\n\";\n                out &lt;&lt; \"\u041e\u0448\u0438\u0431\u043a\u0430, \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0432\u0432\u043e\u0434, \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u0432\u0432\u043e\u0434.\\n\";\n                break;\n            }\n\n            break;\n        case 2:            // \u041b\u0423\n\n        {\n\n\n            std::cout &lt;&lt; \"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043c\u0435\u0442\u043e\u0434 \u0432\u0432\u043e\u0434\u0430 \u0434\u0430\u043d\u043d\u044b\u0445:\" &lt;&lt; endl;\n            out &lt;&lt; \"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043c\u0435\u0442\u043e\u0434 \u0432\u0432\u043e\u0434\u0430 \u0434\u0430\u043d\u043d\u044b\u0445: \";\n            std::cout &lt;&lt; \"1. \u0412\u0432\u043e\u0434 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441 \u043a\u043b\u0430\u0432\u0438\u0430\u0442\u0443\u0440\u044b \\n\";\n            out &lt;&lt; \"1. \u0412\u0432\u043e\u0434 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441 \u043a\u043b\u0430\u0432\u0438\u0430\u0442\u0443\u0440\u044b  \\n\";\n            std::cout &lt;&lt; \"2. \u0412\u0432\u043e\u0434 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 \u0444\u0430\u0439\u043b\u0430 \\n\";\n            out &lt;&lt; \"2. \u0412\u0432\u043e\u0434 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 \u0444\u0430\u0439\u043b\u0430\\n\";\n            std::cout &lt;&lt; \"3. \u0412\u044b\u0445\u043e\u0434\\n\";\n            out &lt;&lt; \"3. \u0412\u044b\u0445\u043e\u0434\\n\";\n            std::cout &lt;&lt; \"\u0412\u0430\u0448 \u0432\u044b\u0431\u043e\u0440: \";\n            out &lt;&lt; \"\u0412\u0430\u0448 \u0432\u044b\u0431\u043e\u0440: \";\n            cin &gt;&gt; ch2;\n            out &lt;&lt; ch2;\n            switch (ch2)\n            {\n            case 1:\n                object.Size();\n                object.Init();\n                object.MatrixInPut();\n                object.printMatrix();\n                object.LUdecomposition();\n                object.printLU();\n                break;\n            case 2:\n                object.ReadingSize();\n                object.Init();\n                object.ReadingMatrixFromFile();\n                object.printMatrix();\n                object.LUdecomposition();\n                object.printLU();\n                break;\n            case 3:            // \u041f\u0440\u043e\u0441\u0442\u043e \u043f\u0440\u043e\u0449\u0430\u0439\u0442\u0435\n                std::cout &lt;&lt; endl;\n                out &lt;&lt; endl;\n                std::cout &lt;&lt; \"\u0421\u043f\u0430\u0441\u0438\u0431\u043e, \u0447\u0442\u043e \u0431\u044b\u043b\u0438 \u0441 \u043d\u0430\u043c\u0438!\\n\";\n                out &lt;&lt; \"\u0421\u043f\u0430\u0441\u0438\u0431\u043e, \u0447\u0442\u043e \u0431\u044b\u043b\u0438 \u0441 \u043d\u0430\u043c\u0438!\\n\";\n                prov = false;\n                break;\n            default:            // \u041d\u0430 \u0441\u043b\u0443\u0447\u0430\u0439 \u0444\u0435\u0439\u043b\u043e\u0432\n                std::cout &lt;&lt; endl;\n                out &lt;&lt; endl;\n                std::cout &lt;&lt; \"\u041e\u0448\u0438\u0431\u043a\u0430, \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0432\u0432\u043e\u0434, \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u0432\u0432\u043e\u0434.\\n\";\n                out &lt;&lt; \"\u041e\u0448\u0438\u0431\u043a\u0430, \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0432\u0432\u043e\u0434, \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u0432\u0432\u043e\u0434.\\n\";\n                break;\n\n\n            }\n            break;\n        case 3:            // \u041f\u0440\u043e\u0441\u0442\u043e \u043f\u0440\u043e\u0449\u0430\u0439\u0442\u0435\n            std::cout &lt;&lt; endl;\n            out &lt;&lt; endl;\n            std::cout &lt;&lt; \"\u0421\u043f\u0430\u0441\u0438\u0431\u043e, \u0447\u0442\u043e \u0431\u044b\u043b\u0438 \u0441 \u043d\u0430\u043c\u0438!\\n\";\n            out &lt;&lt; \"\u0421\u043f\u0430\u0441\u0438\u0431\u043e, \u0447\u0442\u043e \u0431\u044b\u043b\u0438 \u0441 \u043d\u0430\u043c\u0438!\\n\";\n            prov = false;\n            break;\n        default:            // \u041d\u0430 \u0441\u043b\u0443\u0447\u0430\u0439 \u0444\u0435\u0439\u043b\u043e\u0432\n            std::cout &lt;&lt; endl;\n            out &lt;&lt; endl;\n            std::cout &lt;&lt; \"\u041e\u0448\u0438\u0431\u043a\u0430, \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0432\u0432\u043e\u0434, \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u0432\u0432\u043e\u0434.\\n\";\n            out &lt;&lt; \"\u041e\u0448\u0438\u0431\u043a\u0430, \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0432\u0432\u043e\u0434, \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u0432\u0432\u043e\u0434.\\n\";\n            //choice = 0;\n            //prov = false;\n\n\n        }\n        }\n        out.close();// \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u044e \u0444\u0430\u0439\u043b \n        }\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "visual-studio-2013", "visual-studio-2015"], "comments": [{"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 4, "creation_date": 1432139460, "post_id": 30355385, "comment_id": 48802947, "body": "What type is <code>m_o</code>? Your copy constructor of <code>BigObj</code> seems to violate the rule of three..."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1432154497, "post_id": 30355385, "comment_id": 48811647, "body": "Is there a reason you did not write a minimal, complete example?"}], "answers": [{"comments": [{"owner": {"reputation": 1495, "user_id": 1306550, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73a727acd412d38f28acd9643e7453d2?s=128&d=identicon&r=PG", "display_name": "unixsnob", "link": "https://stackoverflow.com/users/1306550/unixsnob"}, "edited": false, "score": 0, "creation_date": 1432139623, "post_id": 30355501, "comment_id": 48803072, "body": "Apologies, could you tell me what I need to change. I am slightly confused. Do I need a copy constructor at all?"}, {"owner": {"reputation": 32089, "user_id": 266198, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7x8PT.jpg?s=128&g=1", "display_name": "Nim", "link": "https://stackoverflow.com/users/266198/nim"}, "reply_to_user": {"reputation": 1495, "user_id": 1306550, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73a727acd412d38f28acd9643e7453d2?s=128&d=identicon&r=PG", "display_name": "unixsnob", "link": "https://stackoverflow.com/users/1306550/unixsnob"}, "edited": false, "score": 0, "creation_date": 1432139726, "post_id": 30355501, "comment_id": 48803152, "body": "Depends on how you want the <code>BigObj</code> to behave, if you want to transfer the ownership of the subobject, then have a move constructor in <code>BigObj</code> and <i>move</i> instance, else in the <i>copy constructor</i> of <code>BigObj</code>, instantiate the subobject by copying the passed in instance&#39;s subobject (i.e. trigger <i>copy constructor</i> of <code>Obj</code>)"}, {"owner": {"reputation": 1495, "user_id": 1306550, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73a727acd412d38f28acd9643e7453d2?s=128&d=identicon&r=PG", "display_name": "unixsnob", "link": "https://stackoverflow.com/users/1306550/unixsnob"}, "edited": false, "score": 0, "creation_date": 1432139993, "post_id": 30355501, "comment_id": 48803327, "body": "The way the real code works is. BigObj has various pointers, it is passed to several functions that make allocations and set the pointers. Then BigObj is made shared so it can be passed along. If the collection of info fails the object is just discarded. I am not making shared till I know that there is data in it."}, {"owner": {"reputation": 32089, "user_id": 266198, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7x8PT.jpg?s=128&g=1", "display_name": "Nim", "link": "https://stackoverflow.com/users/266198/nim"}, "reply_to_user": {"reputation": 1495, "user_id": 1306550, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73a727acd412d38f28acd9643e7453d2?s=128&d=identicon&r=PG", "display_name": "unixsnob", "link": "https://stackoverflow.com/users/1306550/unixsnob"}, "edited": false, "score": 0, "creation_date": 1432140103, "post_id": 30355501, "comment_id": 48803389, "body": "Then you should support move semantics, i.e. your <code>BigObj</code>  should <i>only</i> have a move constructor and <code>delete</code> the copy constructor. In the move, simply take the pointers. I would also hold those subobjects in <code>unique_ptr</code> instances, as this will clarify your intentions quite a bit."}, {"owner": {"reputation": 1495, "user_id": 1306550, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73a727acd412d38f28acd9643e7453d2?s=128&d=identicon&r=PG", "display_name": "unixsnob", "link": "https://stackoverflow.com/users/1306550/unixsnob"}, "edited": false, "score": 0, "creation_date": 1432140175, "post_id": 30355501, "comment_id": 48803437, "body": "would you mind writing the move constructor. I am not quite sure how you declare one."}, {"owner": {"reputation": 32089, "user_id": 266198, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7x8PT.jpg?s=128&g=1", "display_name": "Nim", "link": "https://stackoverflow.com/users/266198/nim"}, "reply_to_user": {"reputation": 1495, "user_id": 1306550, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73a727acd412d38f28acd9643e7453d2?s=128&d=identicon&r=PG", "display_name": "unixsnob", "link": "https://stackoverflow.com/users/1306550/unixsnob"}, "edited": false, "score": 0, "creation_date": 1432140498, "post_id": 30355501, "comment_id": 48803660, "body": "Anyway, all this is <i>moot</i>, from your description, there is no advantage to the approach you are describing, simply instantiate the <code>shared_ptr</code> (instead of the automatic instance), and then pass the instance by de-referencing the shared pointer to the functions that need to initialize it..."}, {"owner": {"reputation": 1495, "user_id": 1306550, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73a727acd412d38f28acd9643e7453d2?s=128&d=identicon&r=PG", "display_name": "unixsnob", "link": "https://stackoverflow.com/users/1306550/unixsnob"}, "edited": false, "score": 0, "creation_date": 1432140755, "post_id": 30355501, "comment_id": 48803814, "body": "Is there not too much overhead from creating shared pointers every time? I mean, there may be no data to fill it up with."}, {"owner": {"reputation": 1495, "user_id": 1306550, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73a727acd412d38f28acd9643e7453d2?s=128&d=identicon&r=PG", "display_name": "unixsnob", "link": "https://stackoverflow.com/users/1306550/unixsnob"}, "edited": false, "score": 0, "creation_date": 1432140835, "post_id": 30355501, "comment_id": 48803867, "body": "Thanks I think I get what you mean."}], "tags": [], "owner": {"reputation": 32089, "user_id": 266198, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7x8PT.jpg?s=128&g=1", "display_name": "Nim", "link": "https://stackoverflow.com/users/266198/nim"}, "is_accepted": true, "score": 4, "last_activity_date": 1432140378, "last_edit_date": 1432140378, "creation_date": 1432139507, "answer_id": 30355501, "question_id": 30355385, "link": "https://stackoverflow.com/questions/30355385/make-shared-calling-destructor-twice-when-giving-it-an-already-created-object/30355501#30355501", "title": "make_shared() calling destructor twice when giving it an already created object", "body": "<p>Erm - you copy constructor (of <code>BigObj</code>) copies  the <em>internal pointer</em> (<code>Obj</code>) and then then there are two deletes on it (once the automatic instance is cleaned up and then the shared pointer) This is not good.. Copy constructor (of <code>BigObj</code>) is not doing the right thing, it should instantiate the subobject (<code>Obj</code>) using it's (of <code>Obj</code>) copy constructor...</p>\n\n<p>EDIT: A clean-ish implementation..</p>\n\n<pre><code>class Obj\n{\n};\n\nclass BigObj\n{\npublic:\n  // Default constructor\n  BigObj() : _obj(new Obj)\n  { }\n  // Move constructor\n  BigObj(BigObj&amp;&amp; other) : _obj(move(other._obj)) // take ownership of the subobject\n  { }\n  // Move assignment\n  BigObj&amp; operator=(BigObj&amp;&amp; other)\n  {\n    _obj = move(other._obj); // take ownership of the subobject\n    return *this;\n  }\nprivate:\n  unique_ptr&lt;Obj&gt; _obj;\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1495, "user_id": 1306550, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73a727acd412d38f28acd9643e7453d2?s=128&d=identicon&r=PG", "display_name": "unixsnob", "link": "https://stackoverflow.com/users/1306550/unixsnob"}, "edited": false, "score": 0, "creation_date": 1432139599, "post_id": 30355503, "comment_id": 48803059, "body": "I added it to test. Do I need it at all? Removing it does not change anything. What should I do then?"}, {"owner": {"reputation": 4160, "user_id": 1843316, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6737b1f109e56682b0d78a07ca51eeb5?s=128&d=identicon&r=PG", "display_name": "Sam Cristall", "link": "https://stackoverflow.com/users/1843316/sam-cristall"}, "reply_to_user": {"reputation": 1495, "user_id": 1306550, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73a727acd412d38f28acd9643e7453d2?s=128&d=identicon&r=PG", "display_name": "unixsnob", "link": "https://stackoverflow.com/users/1306550/unixsnob"}, "edited": false, "score": 0, "creation_date": 1432139944, "post_id": 30355503, "comment_id": 48803299, "body": "@unixsnob Not sure what you&#39;re referring to -- I&#39;ve made some edits to get you working"}, {"owner": {"reputation": 1495, "user_id": 1306550, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73a727acd412d38f28acd9643e7453d2?s=128&d=identicon&r=PG", "display_name": "unixsnob", "link": "https://stackoverflow.com/users/1306550/unixsnob"}, "edited": false, "score": 0, "creation_date": 1432140058, "post_id": 30355503, "comment_id": 48803365, "body": "I made a comment to Nim explaining how I want the object to behave. Does it help? I can add more info."}, {"owner": {"reputation": 4160, "user_id": 1843316, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6737b1f109e56682b0d78a07ca51eeb5?s=128&d=identicon&r=PG", "display_name": "Sam Cristall", "link": "https://stackoverflow.com/users/1843316/sam-cristall"}, "reply_to_user": {"reputation": 1495, "user_id": 1306550, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73a727acd412d38f28acd9643e7453d2?s=128&d=identicon&r=PG", "display_name": "unixsnob", "link": "https://stackoverflow.com/users/1306550/unixsnob"}, "edited": false, "score": 0, "creation_date": 1432140164, "post_id": 30355503, "comment_id": 48803432, "body": "@unixsnob Yes it does.  <code>make_shared</code> does not just create a shared_ptr, it constructs an object of type <code>T</code> then returns a <code>shared_ptr</code> to that object.  If you already have the object, you should not use <code>make_shared</code>."}], "tags": [], "owner": {"reputation": 4160, "user_id": 1843316, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6737b1f109e56682b0d78a07ca51eeb5?s=128&d=identicon&r=PG", "display_name": "Sam Cristall", "link": "https://stackoverflow.com/users/1843316/sam-cristall"}, "is_accepted": false, "score": 3, "last_activity_date": 1432139913, "last_edit_date": 1432139913, "creation_date": 1432139515, "answer_id": 30355503, "question_id": 30355385, "link": "https://stackoverflow.com/questions/30355385/make-shared-calling-destructor-twice-when-giving-it-an-already-created-object/30355503#30355503", "title": "make_shared() calling destructor twice when giving it an already created object", "body": "<p>This:</p>\n\n<pre><code>BigObj oo = BigObj(10);\nshared_ptr&lt;BigObj&gt; shr= make_shared&lt;BigObj&gt;(oo);\n</code></pre>\n\n<p>Isn't doing what you think it is.  You are creating a shared pointer and putting a copy of <code>oo</code> into it.  Your copy constructor is copying <code>m_o</code>.  This now means in your <code>main</code> you have TWO <code>BigObj</code> objects:  <code>oo</code> and the newly made copy held by <code>shr</code></p>\n\n<p>Since both of their <code>m_o</code> members point at the same memory, their destructors will call delete on <code>m_o</code> twice.</p>\n\n<p>You don't need <code>oo</code> first, you may construct the object in place using <code>make_shared</code>:</p>\n\n<pre><code>shared_ptr&lt;BigObj&gt; shr = make_shared&lt;BigObj&gt;(10);\n</code></pre>\n\n<p>This should fix your problem, but you should also look into deep versus shallow copies for why the copy constructor is problematic.</p>\n"}], "owner": {"reputation": 1495, "user_id": 1306550, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73a727acd412d38f28acd9643e7453d2?s=128&d=identicon&r=PG", "display_name": "unixsnob", "link": "https://stackoverflow.com/users/1306550/unixsnob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1448, "favorite_count": 0, "accepted_answer_id": 30355501, "answer_count": 2, "score": 0, "last_activity_date": 1432140378, "creation_date": 1432139239, "question_id": 30355385, "link": "https://stackoverflow.com/questions/30355385/make-shared-calling-destructor-twice-when-giving-it-an-already-created-object", "title": "make_shared() calling destructor twice when giving it an already created object", "body": "<p>Using VS 2015 with v120.</p>\n\n<p>So I am getting memory exceptions because when I call <code>make_shared()</code> on an already constructed object. The already constructed object has a pointer to another object that was allocated with <code>new</code> so when it calls the destructor the first time. The object is destroyed, then when it calls it again, the object is already destroyed. </p>\n\n<p>I thought that in this instance the object will be moved and the destructor is never called. </p>\n\n<p>Code:</p>\n\n<p>Sub-object:</p>\n\n<pre><code>#include \"Obj.h\"\n\nObj::Obj(int i)\n{\n    cout &lt;&lt; \"const Obj \" &lt;&lt; this &lt;&lt; \"\\n\";\n    m_i = i;\n}\nObj::~Obj()\n{\n    cout &lt;&lt; \"-------------------DELETING  o \" &lt;&lt; this &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>Containing Object:</p>\n\n<pre><code>#include \"BigObj.h\"\n\nBigObj::BigObj(int i)\n{\n    cout &lt;&lt; \"const BIgObj \" &lt;&lt; this &lt;&lt; \"\\n\";\n    m_o = new Obj(i);\n}\n\n\nBigObj::BigObj()\n{\n}\n\nBigObj::BigObj(const BigObj&amp; o)\n{\n    cout &lt;&lt; \"called copy const \\n\";\n    m_o = o.m_o;\n}\n\nBigObj::~BigObj()\n{\n    delete m_o;\n    cout &lt;&lt; \"----------------DEL bigobj \" &lt;&lt; this &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>Main:</p>\n\n<pre><code>int main(char argc, char** argv){\n\n    BigObj oo = BigObj(10);\n    shared_ptr&lt;BigObj&gt; shr= make_shared&lt;BigObj&gt;(oo);\n\n    BigObj oo2 = BigObj(100);\n    cout &lt;&lt; \"finished\\n\";\n    system(\"pause\");\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>const BIgObj 000000C61F4FFAD8\nconst Obj 000000C61F658330\ncalled copy const\nconst BIgObj 000000C61F4FFB28\nconst Obj 000000C61F658510\nfinished\nPress any key to continue . . .\n-------------------DELETING  o 000000C61F658510\n----------------DEL bigobj 000000C61F4FFB28\n-------------------DELETING  o 000000C61F658330\n----------------DEL bigobj 000000C61F65AFB0\n-------------------DELETING  o 000000C61F658330\n</code></pre>\n\n<p>This is test code I made to show the problem. In the real project I create objects that need to contain a lot of info and then they are pushed onto a vector that is made shared for various threads to work on the info. This so whatever thread has the object last deletes it. </p>\n"}, {"tags": ["c++", "string", "vector", "iterator", "ostream"], "comments": [{"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 6, "creation_date": 1432139105, "post_id": 30355315, "comment_id": 48802733, "body": "What specifically do you not understand about how it works?"}, {"owner": {"reputation": 375, "user_id": 2964080, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/83a2161c6a5e59846b41a296d1efbd3f?s=128&d=identicon&r=PG&f=1", "display_name": "ronilp", "link": "https://stackoverflow.com/users/2964080/ronilp"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1432139152, "post_id": 30355315, "comment_id": 48802759, "body": "I don&#39;t get what this statement does <code>std::copy(vec.begin(), vec.end()-1, std::ostream_iterator&lt;int&gt;(oss, &quot;,&quot;));</code>"}, {"owner": {"reputation": 375, "user_id": 2964080, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/83a2161c6a5e59846b41a296d1efbd3f?s=128&d=identicon&r=PG&f=1", "display_name": "ronilp", "link": "https://stackoverflow.com/users/2964080/ronilp"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1432139444, "post_id": 30355315, "comment_id": 48802930, "body": "can someone please suggest any other way to do it?"}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1432140984, "post_id": 30355315, "comment_id": 48803948, "body": "@ronilp there&#39;s no need for another way, this one works fine, <code>std::copy</code> is the most readable and idiomatic way to copy things. &quot;I don&#39;t understand it&quot; is not a reason to switch implementations. You&#39;ll need to <b>read the documentation.</b>"}, {"owner": {"reputation": 375, "user_id": 2964080, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/83a2161c6a5e59846b41a296d1efbd3f?s=128&d=identicon&r=PG&f=1", "display_name": "ronilp", "link": "https://stackoverflow.com/users/2964080/ronilp"}, "edited": false, "score": 0, "creation_date": 1432144926, "post_id": 30355315, "comment_id": 48806146, "body": "the way 0x499602D2 suggested is much more easier to understand. I was looking for such a way."}], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 2964080, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/83a2161c6a5e59846b41a296d1efbd3f?s=128&d=identicon&r=PG&f=1", "display_name": "ronilp", "link": "https://stackoverflow.com/users/2964080/ronilp"}, "edited": false, "score": 0, "creation_date": 1432139497, "post_id": 30355470, "comment_id": 48802971, "body": "suppose no comma was required then, <code>str += &quot;&quot;</code> would be the change, right?"}, {"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "reply_to_user": {"reputation": 375, "user_id": 2964080, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/83a2161c6a5e59846b41a296d1efbd3f?s=128&d=identicon&r=PG&f=1", "display_name": "ronilp", "link": "https://stackoverflow.com/users/2964080/ronilp"}, "edited": false, "score": 0, "creation_date": 1432139533, "post_id": 30355470, "comment_id": 48803005, "body": "@ronilp Then you wouldn&#39;t need the <code>if</code> statement at all, just the <code>str += to_string(vec[i])</code> part."}], "tags": [], "owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "is_accepted": true, "score": 2, "last_activity_date": 1432139442, "creation_date": 1432139442, "answer_id": 30355470, "question_id": 30355315, "link": "https://stackoverflow.com/questions/30355315/how-to-convert-a-vectorint-to-string-in-c/30355470#30355470", "title": "How to convert a vector&lt;int&gt; to string in C++", "body": "\n\n<p>That code is only needed if you want to add a delimiter after every inserted integer, but even then it doesn't have to be that complicated. A simple loop and the use of <code>to_string</code> is far more readable:</p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>std::string str;\n\nfor (int i = 0; i &lt; vec.size(); ++i) {\n    str += std::to_string(vec[i]);\n    if (i+1 != vec.size()) { // if the next iteration isn't the last\n        str += \", \"; // add a comma (optional)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 343, "user_id": 3576110, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SHI6S.jpg?s=128&g=1", "display_name": "Achilles Rasquinha", "link": "https://stackoverflow.com/users/3576110/achilles-rasquinha"}, "is_accepted": false, "score": 0, "last_activity_date": 1432140857, "last_edit_date": 1432140857, "creation_date": 1432140709, "answer_id": 30355857, "question_id": 30355315, "link": "https://stackoverflow.com/questions/30355315/how-to-convert-a-vectorint-to-string-in-c/30355857#30355857", "title": "How to convert a vector&lt;int&gt; to string in C++", "body": "<p>Delimiting to numbers,</p>\n\n<pre><code>std::vector&lt;int&gt; v {0, 1, 2, 3, 4};\nstd::string s(\"\");\nfor(auto i : v)\n    s += std::to_string(i);\n</code></pre>\n\n<p>With a comma seperator</p>\n\n<pre><code>std::vector&lt;int&gt; v {0, 1, 2, 3, 4};\nstd::string s(\"\");\nfor(auto i : v)\n    s += std::to_string(i) + \",\";\ns.pop_back();\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 2964080, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/83a2161c6a5e59846b41a296d1efbd3f?s=128&d=identicon&r=PG&f=1", "display_name": "ronilp", "link": "https://stackoverflow.com/users/2964080/ronilp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1188, "favorite_count": 0, "closed_date": 1432181225, "accepted_answer_id": 30355470, "answer_count": 2, "score": -3, "last_activity_date": 1432140857, "creation_date": 1432139045, "question_id": 30355315, "link": "https://stackoverflow.com/questions/30355315/how-to-convert-a-vectorint-to-string-in-c", "closed_reason": "Needs details or clarity", "title": "How to convert a vector&lt;int&gt; to string in C++", "body": "<p>Suppose I have a <code>vector&lt;int&gt;</code> and I want to convert it into string, what should I do?\nWhat I got from searching on the internet is</p>\n\n<pre><code>std::ostringstream oss;\n\nif (!vec.empty())\n{\n  // Convert all but the last element to avoid a trailing \",\"\n std::copy(vec.begin(), vec.end()-1,\n    std::ostream_iterator&lt;int&gt;(oss, \",\"));\n\n// Now add the last element with no delimiter\noss &lt;&lt; vec.back();\n}\n</code></pre>\n\n<p>But I cannot understand what it means or how it works. Is there any other simple to understand way?</p>\n"}, {"tags": ["c++", "arrays", "multidimensional-array"], "comments": [{"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1432138857, "post_id": 30355123, "comment_id": 48802611, "body": "also see <a href=\"https://stackoverflow.com/questions/13554244/how-to-use-pointer-expressions-to-access-elements-of-a-two-dimensional-array-in\">here</a>"}, {"owner": {"reputation": 33, "user_id": 4826173, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OdkuLNXgsI4/AAAAAAAAAAI/AAAAAAAAAAs/p3tn7whLsgs/photo.jpg?sz=128", "display_name": "Mario Mufasa", "link": "https://stackoverflow.com/users/4826173/mario-mufasa"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1432139517, "post_id": 30355123, "comment_id": 48802996, "body": "Thanks for the suggestions!"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4826173, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OdkuLNXgsI4/AAAAAAAAAAI/AAAAAAAAAAs/p3tn7whLsgs/photo.jpg?sz=128", "display_name": "Mario Mufasa", "link": "https://stackoverflow.com/users/4826173/mario-mufasa"}, "edited": false, "score": 0, "creation_date": 1432139477, "post_id": 30355172, "comment_id": 48802958, "body": "Thank you! @Paul R your answer also helped me."}], "tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": false, "score": 4, "last_activity_date": 1432138610, "creation_date": 1432138610, "answer_id": 30355172, "question_id": 30355123, "link": "https://stackoverflow.com/questions/30355123/multidimensional-arrays-structure-in-memory/30355172#30355172", "title": "Multidimensional arrays structure in memory", "body": "<p>As far as memory layout is concerned,</p>\n\n<pre><code>int a[2][3][2] = { { { 0, 1 }, { 2, 3 }, { 4, 5 } },\n                   { { 6, 7 }, { 8, 9 }, { 10, 11 } } };\n</code></pre>\n\n<p>is the same as:</p>\n\n<pre><code>int b[12] = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11 };\n</code></pre>\n\n<p>and <code>a[i][j][k]</code> is equivalent to <code>b[i * 6 + j * 2 + k]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 4826173, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OdkuLNXgsI4/AAAAAAAAAAI/AAAAAAAAAAs/p3tn7whLsgs/photo.jpg?sz=128", "display_name": "Mario Mufasa", "link": "https://stackoverflow.com/users/4826173/mario-mufasa"}, "edited": false, "score": 0, "creation_date": 1432139565, "post_id": 30355311, "comment_id": 48803029, "body": "Thanks pal! Great explanation!"}], "tags": [], "owner": {"reputation": 12139, "user_id": 2412846, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/eBJip.gif?s=128&g=1", "display_name": "davidhigh", "link": "https://stackoverflow.com/users/2412846/davidhigh"}, "is_accepted": false, "score": 2, "last_activity_date": 1432139338, "last_edit_date": 1432139338, "creation_date": 1432139030, "answer_id": 30355311, "question_id": 30355123, "link": "https://stackoverflow.com/questions/30355123/multidimensional-arrays-structure-in-memory/30355311#30355311", "title": "Multidimensional arrays structure in memory", "body": "<p>For your three-dimensional example, you can use an array <code>b</code> of size <code>2*3*2 = 12</code> and access the former element <code>a[i][j][k]</code> via <code>b[k + 2 * ( j + 3* i)]</code>.</p>\n\n<p>Alternatively, any other rearrangement will do as well, for example <code>b[i + 2 * ( j + 3* k)]</code>. The optimal choice depends on how you mainly want to traverse the array.</p>\n\n<hr>\n\n<p>In general, one can translate any array</p>\n\n<pre><code>a[0 ... N_1-1][0 ... N_2-1] ... [0 ... N_k-1]\n</code></pre>\n\n<p>into a linear array <code>b</code> of size <code>N_1 * N_2 * ... * N_k</code>. In practice, the only thing you have to change is the index function: so when you want to access element <code>a[i_1][i_2] ... [i_k]</code> in your original array, you use the following instead</p>\n\n<pre><code>b[i_k + N_k * ( i_{k-1} + N_{k-1} * ( ... N_2 * i_1) ...))]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 4826173, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OdkuLNXgsI4/AAAAAAAAAAI/AAAAAAAAAAs/p3tn7whLsgs/photo.jpg?sz=128", "display_name": "Mario Mufasa", "link": "https://stackoverflow.com/users/4826173/mario-mufasa"}, "edited": false, "score": 0, "creation_date": 1432139424, "post_id": 30355369, "comment_id": 48802915, "body": "Thank you! @cmaster! That&#39;s exactly what is was looking for!"}], "tags": [], "owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "is_accepted": true, "score": 0, "last_activity_date": 1432139652, "last_edit_date": 1432139652, "creation_date": 1432139183, "answer_id": 30355369, "question_id": 30355123, "link": "https://stackoverflow.com/questions/30355123/multidimensional-arrays-structure-in-memory/30355369#30355369", "title": "Multidimensional arrays structure in memory", "body": "<p>An array is a number of elements, stored consecutively in memory.<br>\nA 2D array is an array of arrays.<br>\nAs such, a 2D array is a number of arrays, stored consecutively in memory. It follows that all the elements of the 2D array are stored consecutively in memory.</p>\n\n<p>In your concrete example, the compiler will allocate memory in this structure:</p>\n\n<pre><code> | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 |\n  ------- ------- ------- ------- ------- ---------\n   line 0  line 1  line 2  line 3  line 4  line 5\n  ----------------------- -------------------------\n          block 0                 block 1\n  -------------------------------------------------\n                      3D array\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4826173, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OdkuLNXgsI4/AAAAAAAAAAI/AAAAAAAAAAs/p3tn7whLsgs/photo.jpg?sz=128", "display_name": "Mario Mufasa", "link": "https://stackoverflow.com/users/4826173/mario-mufasa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "closed_date": 1432154262, "accepted_answer_id": 30355369, "answer_count": 3, "score": 0, "last_activity_date": 1432139870, "creation_date": 1432138464, "last_edit_date": 1432139870, "question_id": 30355123, "link": "https://stackoverflow.com/questions/30355123/multidimensional-arrays-structure-in-memory", "closed_reason": "Duplicate", "title": "Multidimensional arrays structure in memory", "body": "<p>I've seen that these types of array are sometimes seen as a matrix.  I had a teacher who said that this was an easy way to look at it, and that the real way it looks is in a linear form. For example: </p>\n\n<pre><code>int a[2][3][2] = {0, 1, 2, 3 , 4, 5, 6, 7 , 8, 9, 10, 11};\n</code></pre>\n\n<p>How would you represent this in a linear way? </p>\n"}, {"tags": ["c++", "performance"], "comments": [{"owner": {"reputation": 1466, "user_id": 2689696, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/303b6001169b9992aee46c054b3c49bc?s=128&d=identicon&r=PG&f=1", "display_name": "tejas", "link": "https://stackoverflow.com/users/2689696/tejas"}, "edited": false, "score": 0, "creation_date": 1432138222, "post_id": 30354954, "comment_id": 48802200, "body": "if you are on linux/cygwin/msys use <code>time anotherprogram</code> to get this on shell and cross verify"}, {"owner": {"reputation": 11, "user_id": 4921294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97dc8869940961be95453c3c9e2aa0de?s=128&d=identicon&r=PG&f=1", "display_name": "toshiba nexus78", "link": "https://stackoverflow.com/users/4921294/toshiba-nexus78"}, "reply_to_user": {"reputation": 1466, "user_id": 2689696, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/303b6001169b9992aee46c054b3c49bc?s=128&d=identicon&r=PG&f=1", "display_name": "tejas", "link": "https://stackoverflow.com/users/2689696/tejas"}, "edited": false, "score": 0, "creation_date": 1432138319, "post_id": 30354954, "comment_id": 48802257, "body": "@tejashs yes I did your suggestion already. Results from time anotherProgram shows 1m123.215s but the output coming from cout prints 0.000267 for example"}, {"owner": {"reputation": 1259, "user_id": 727120, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/1bbab671c238e654ba432c838664ee8d?s=128&d=identicon&r=PG", "display_name": "mmoment", "link": "https://stackoverflow.com/users/727120/mmoment"}, "edited": false, "score": 0, "creation_date": 1432732872, "post_id": 30354954, "comment_id": 49045990, "body": "Generally speaking, it would be nice if you @toshibanexus78 could mark the answer to your question as an answer (accept as answer) so that other users with the same problem don&#39;t have to read through all the replies and links."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4921294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97dc8869940961be95453c3c9e2aa0de?s=128&d=identicon&r=PG&f=1", "display_name": "toshiba nexus78", "link": "https://stackoverflow.com/users/4921294/toshiba-nexus78"}, "edited": false, "score": 0, "creation_date": 1432138378, "post_id": 30355034, "comment_id": 48802306, "body": "@Ulrich_Eckhardt thanks for the information, I get it know, do you have any solution how could I learn running time of a program inside another program."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "reply_to_user": {"reputation": 11, "user_id": 4921294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97dc8869940961be95453c3c9e2aa0de?s=128&d=identicon&r=PG&f=1", "display_name": "toshiba nexus78", "link": "https://stackoverflow.com/users/4921294/toshiba-nexus78"}, "edited": false, "score": 0, "creation_date": 1432138417, "post_id": 30355034, "comment_id": 48802335, "body": "Added according suggestion for locating a solution."}], "tags": [], "owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "is_accepted": false, "score": 1, "last_activity_date": 1432138237, "creation_date": 1432138237, "answer_id": 30355034, "question_id": 30354954, "link": "https://stackoverflow.com/questions/30354954/finding-running-time-of-a-program-in-c/30355034#30355034", "title": "Finding running time of a program in C++", "body": "<p>Carefully read the documentation of <code>clock()</code>, it only reports time for the process calling it. With <code>system()</code> you start a shell though (and in turn another program from there) which runs in a different process.</p>\n\n<p>BTW: Search the web for \"timing C++\" or something like that, it should turn up sufficient amounts of results, e.g. <code>time()</code> or Boost.Chrono.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4921294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97dc8869940961be95453c3c9e2aa0de?s=128&d=identicon&r=PG&f=1", "display_name": "toshiba nexus78", "link": "https://stackoverflow.com/users/4921294/toshiba-nexus78"}, "edited": false, "score": 0, "creation_date": 1432138559, "post_id": 30355101, "comment_id": 48802426, "body": "does thise piece of code gives the elapsed time as seconds?"}, {"owner": {"reputation": 1259, "user_id": 727120, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/1bbab671c238e654ba432c838664ee8d?s=128&d=identicon&r=PG", "display_name": "mmoment", "link": "https://stackoverflow.com/users/727120/mmoment"}, "reply_to_user": {"reputation": 11, "user_id": 4921294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97dc8869940961be95453c3c9e2aa0de?s=128&d=identicon&r=PG&f=1", "display_name": "toshiba nexus78", "link": "https://stackoverflow.com/users/4921294/toshiba-nexus78"}, "edited": false, "score": 0, "creation_date": 1432139785, "post_id": 30355101, "comment_id": 48803199, "body": "yes, the difference between end time and start time is in micro seconds (10^-6 -&gt; 10^6 micro seconds in a second), divide that difference by 1000000  (10^6) and you&#39;ll get the seconds!"}, {"owner": {"reputation": 1259, "user_id": 727120, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/1bbab671c238e654ba432c838664ee8d?s=128&d=identicon&r=PG", "display_name": "mmoment", "link": "https://stackoverflow.com/users/727120/mmoment"}, "reply_to_user": {"reputation": 11, "user_id": 4921294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97dc8869940961be95453c3c9e2aa0de?s=128&d=identicon&r=PG&f=1", "display_name": "toshiba nexus78", "link": "https://stackoverflow.com/users/4921294/toshiba-nexus78"}, "edited": false, "score": 0, "creation_date": 1432141543, "post_id": 30355101, "comment_id": 48804256, "body": "did this answer solve your problem? If so, please consider marking it as an answer."}], "tags": [], "owner": {"reputation": 1259, "user_id": 727120, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/1bbab671c238e654ba432c838664ee8d?s=128&d=identicon&r=PG", "display_name": "mmoment", "link": "https://stackoverflow.com/users/727120/mmoment"}, "is_accepted": false, "score": 1, "last_activity_date": 1432138398, "last_edit_date": 1495542692, "creation_date": 1432138398, "answer_id": 30355101, "question_id": 30354954, "link": "https://stackoverflow.com/questions/30354954/finding-running-time-of-a-program-in-c/30355101#30355101", "title": "Finding running time of a program in C++", "body": "<p>From <a href=\"https://stackoverflow.com/questions/2533774/measuring-execution-time-of-a-call-to-system-in-c\">Measuring execution time of a call to system() in C++</a></p>\n\n<p>Have you considered using gettimeofday?</p>\n\n<pre><code>struct timeval tv;\nstruct timeval start_tv;\n\ngettimeofday(&amp;start_tv, NULL);\n\nsystem(something);\n\ndouble elapsed = 0.0;\n\ngettimeofday(&amp;tv, NULL);\nelapsed = (tv.tv_sec - start_tv.tv_sec) +\n(tv.tv_usec - start_tv.tv_usec) / 1000000.0;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1838, "user_id": 4525052, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0780adfbbb6b445dac0c9e12d3c73f50?s=128&d=identicon&r=PG&f=1", "display_name": "RyanP", "link": "https://stackoverflow.com/users/4525052/ryanp"}, "is_accepted": false, "score": 2, "last_activity_date": 1432149590, "creation_date": 1432149590, "answer_id": 30358572, "question_id": 30354954, "link": "https://stackoverflow.com/questions/30354954/finding-running-time-of-a-program-in-c/30358572#30358572", "title": "Finding running time of a program in C++", "body": "<p>If you have access to C++11....</p>\n\n<p><code>#include &lt;chrono&gt;</code></p>\n\n<p>and</p>\n\n<pre><code>auto start = std::chrono::steady_clock::now();\n\n//DO SOMETHING HERE\n\nauto stop = std::chrono::steady_clock::now();\n\nauto duration = std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(stop-start).count();\n\nstd::cout &lt;&lt; \"Running time was: \" &lt;&lt; ((double)duration / 1000.0) &lt;&lt; \"s\" &lt;&lt; std::endl;\n</code></pre>\n\n<p>You can play around with the units you cast it to and how you want to display it... (aka I did milliseconds and then divided by 1000 to get seconds with some decimal points, duration comes out as an integer so it will be rounded if you just ask for seconds)</p>\n"}], "owner": {"reputation": 11, "user_id": 4921294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97dc8869940961be95453c3c9e2aa0de?s=128&d=identicon&r=PG&f=1", "display_name": "toshiba nexus78", "link": "https://stackoverflow.com/users/4921294/toshiba-nexus78"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1459364420, "creation_date": 1432138060, "last_edit_date": 1459364420, "question_id": 30354954, "link": "https://stackoverflow.com/questions/30354954/finding-running-time-of-a-program-in-c", "title": "Finding running time of a program in C++", "body": "<p>I have the following C++ code (I have simplified it for the sake of simplicity.)</p>\n\n<pre><code>int main()\n{\n     string runCommand=\"./runAnotherCppProgram.out\";\n     for (int i=0; i&lt;5; i++)\n     {\n       system(runCommand.c_str());\n     }\n     return 0;\n}\n</code></pre>\n\n<p>Now I want to know how much time does runAnotherCppProgram.out take at each iteration. To do this I did the following thing:</p>\n\n<pre><code>int main()\n{\n     string runCommand = \"./runAnotherCppProgram.out\";\n     for (int i=0; i&lt;5; i++)\n     {\n       clock_t clockStart = clock();\n       system(runCommand.c_str());\n       double finish = (double)(clock() - clockStart)/CLOCKS_PER_SEC;\n       cout &lt;&lt; finish &lt;&lt; endl;\n     }\n    return 0;\n}\n</code></pre>\n\n<p>However, it gives much less then the real time of executing. What might be the problem?</p>\n"}, {"tags": ["c++", "stl", "member-functions", "stl-algorithm"], "comments": [{"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 1, "creation_date": 1432137582, "post_id": 30354718, "comment_id": 48801750, "body": "<i>&quot;I&#39;ve tried with std::mem_fun, as std::mem_fn is not available to me, but to no avail.&quot;</i> What problems occurred when using <code>std::mem_fun</code>? Have you tried using a lambda?"}, {"owner": {"reputation": 43107, "user_id": 3953764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd168106a67cbd805c107cba3252caa?s=128&d=identicon&r=PG", "display_name": "Piotr Skotnicki", "link": "https://stackoverflow.com/users/3953764/piotr-skotnicki"}, "edited": false, "score": 1, "creation_date": 1432137718, "post_id": 30354718, "comment_id": 48801832, "body": "Unless it&#39;s a static function, you need a parameter object, and bind it to whatever <code>mem_fun</code> returns: <code>std::transform(foo.begin(), foo.end(), std::back_inserter(bar), std::bind1st(std::mem_fun(&amp;XYZ::function), &amp;xyz));</code>, <a href=\"http://coliru.stacked-crooked.com/a/1733c6da8b46abee\" rel=\"nofollow noreferrer\">demo</a>"}, {"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 1, "creation_date": 1432137742, "post_id": 30354718, "comment_id": 48801854, "body": "<code>function</code> should probably be a static member function."}, {"owner": {"reputation": 474, "user_id": 1606654, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/76eadef58edfcd5fc336f7d54ae4f12b?s=128&d=identicon&r=PG", "display_name": "ccoder83", "link": "https://stackoverflow.com/users/1606654/ccoder83"}, "reply_to_user": {"reputation": 43107, "user_id": 3953764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd168106a67cbd805c107cba3252caa?s=128&d=identicon&r=PG", "display_name": "Piotr Skotnicki", "link": "https://stackoverflow.com/users/3953764/piotr-skotnicki"}, "edited": false, "score": 0, "creation_date": 1432138004, "post_id": 30354718, "comment_id": 48802040, "body": "@Piotr thanks a bunch, that worked!"}, {"owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "edited": false, "score": 0, "creation_date": 1432138035, "post_id": 30354718, "comment_id": 48802069, "body": "@ccoder83 VS2010 has <code>mem_fn</code>, try <code>std::tr1::mem_fn</code>"}], "answers": [{"comments": [{"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1432137849, "post_id": 30354874, "comment_id": 48801930, "body": "<code>foo</code> is a <code>vector&lt;float&gt;</code>, not <code>vector&lt;XYZ&gt;</code>."}, {"owner": {"reputation": 4970, "user_id": 2140449, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/97251fac343628ee1aad92cc3da39d99?s=128&d=identicon&r=PG", "display_name": "DarioP", "link": "https://stackoverflow.com/users/2140449/dariop"}, "edited": false, "score": 0, "creation_date": 1432138859, "post_id": 30354874, "comment_id": 48802612, "body": "I like the lambda version much more than std::bind. I actually forgot about std::bind since I learn lambdas and I&#39;m much happier now! I also like the fact that you create the tiny object in place, although it may be better to capture it by reference if its size is relevant."}, {"owner": {"reputation": 1971, "user_id": 2096824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fzfxa.jpg?s=128&g=1", "display_name": "Justin Randall", "link": "https://stackoverflow.com/users/2096824/justin-randall"}, "edited": false, "score": 1, "creation_date": 1512757249, "post_id": 30354874, "comment_id": 82400632, "body": "If the function IS dependent on the state of the XYZ instance, you could use a lambda to bind to the same instance of XYZ you called std::transform from. <code>std::transform(foo.begin(),                foo.end(),                std::back_inserter(bar),                [this](float a){ return this-&gt;function(a); })</code>"}], "tags": [], "owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "is_accepted": false, "score": 1, "last_activity_date": 1432138913, "last_edit_date": 1432138913, "creation_date": 1432137826, "answer_id": 30354874, "question_id": 30354718, "link": "https://stackoverflow.com/questions/30354718/passing-a-c-member-function-pointer-to-an-stl-algorithm/30354874#30354874", "title": "Passing a C++ Member Function Pointer to an STL Algorithm", "body": "<p>Unless the function is <code>static</code>, it needs an instance of the class to call the function off of. Because non-static functions should depend on the internal state of that class. If the function is independent of the class's state, it should probably be static.</p>\n\n<p>If you had to leave your class as written, you could get around this by default constructing an <code>XYZ</code> just for the purposes of having an instance to call the function from.</p>\n\n<pre><code>std::transform(foo.begin(),\n               foo.end(),\n               std::back_inserter(bar),\n               [](float a){ return XYZ{}.function(a); });\n</code></pre>\n\n<p>But this feels hacky, I would prefer that the function be <code>static</code> if it isn't dependent on the state of the <code>XYZ</code> instance, and only depends on the input <code>float</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 43107, "user_id": 3953764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd168106a67cbd805c107cba3252caa?s=128&d=identicon&r=PG", "display_name": "Piotr Skotnicki", "link": "https://stackoverflow.com/users/3953764/piotr-skotnicki"}, "is_accepted": true, "score": 9, "last_activity_date": 1432138302, "creation_date": 1432138302, "answer_id": 30355058, "question_id": 30354718, "link": "https://stackoverflow.com/questions/30354718/passing-a-c-member-function-pointer-to-an-stl-algorithm/30355058#30355058", "title": "Passing a C++ Member Function Pointer to an STL Algorithm", "body": "<p><a href=\"http://en.cppreference.com/w/cpp/utility/functional/mem_fun\" rel=\"noreferrer\"><code>std::mem_fun</code></a> itself only povides a wrapper for a member function, so that one will be invoked in the context of the first argument passed to its <code>operator()</code>. Having said that, you need to <a href=\"http://en.cppreference.com/w/cpp/utility/functional/bind12\" rel=\"noreferrer\">bind</a> the proper instance of <code>XYZ</code> prior to passing the function object to the <a href=\"http://en.cppreference.com/w/cpp/algorithm/transform\" rel=\"noreferrer\"><code>std::transform</code></a> algorithm:</p>\n\n<pre><code>XYZ xyz;\n\nstd::transform(foo.begin(), foo.end(),\n               std::back_inserter(bar),\n               std::bind1st(std::mem_fun(&amp;XYZ::function), &amp;xyz));\n//                  ~~~~~~^      ~~~~~~^                  ~~~^\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/1733c6da8b46abee\" rel=\"noreferrer\"><strong>DEMO</strong></a></p>\n"}, {"tags": [], "owner": {"reputation": 11342, "user_id": 1144157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d05077a347e63679d43bfbdaf5e7b9ab?s=128&d=identicon&r=PG", "display_name": "Steephen", "link": "https://stackoverflow.com/users/1144157/steephen"}, "is_accepted": false, "score": 0, "last_activity_date": 1432138714, "creation_date": 1432138714, "answer_id": 30355202, "question_id": 30354718, "link": "https://stackoverflow.com/questions/30354718/passing-a-c-member-function-pointer-to-an-stl-algorithm/30355202#30355202", "title": "Passing a C++ Member Function Pointer to an STL Algorithm", "body": "<p>lambda version </p>\n\n<pre><code>std::vector&lt;float&gt; foo;\nstd::vector&lt;float&gt; bar;\nfoo.push_back(1.0f);\nfoo.push_back(2.0f);\nXYZ xyz;\nstd::transform(foo.begin(), foo.end(), std::back_inserter(bar), \n        [&amp;xyz](float&amp; a){ return xyz.function(a); });\n for ( auto &amp; x : bar)\n   std::cout&lt;&lt;x&lt;&lt;\"\\n\";\n</code></pre>\n"}], "owner": {"reputation": 474, "user_id": 1606654, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/76eadef58edfcd5fc336f7d54ae4f12b?s=128&d=identicon&r=PG", "display_name": "ccoder83", "link": "https://stackoverflow.com/users/1606654/ccoder83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3460, "favorite_count": 0, "accepted_answer_id": 30355058, "answer_count": 3, "score": 6, "last_activity_date": 1472676140, "creation_date": 1432137401, "last_edit_date": 1495541427, "question_id": 30354718, "link": "https://stackoverflow.com/questions/30354718/passing-a-c-member-function-pointer-to-an-stl-algorithm", "title": "Passing a C++ Member Function Pointer to an STL Algorithm", "body": "<p>I have a member function as follows:</p>\n\n<pre><code>class XYZ{\npublic:\n    float function(float x);\nprivate:\n    float m_DensityMin;\n    float m_DensityMax;\n};\n</code></pre>\n\n<p>Now, I'm trying to transform a <code>std::vector&lt;float&gt; foo</code> using the <code>std::transform</code> STL algorithm by passing the member function <code>function</code>, and storing the resulting values in a vector <code>bar</code>.</p>\n\n<p>If I use the function as a global function, with random data that should denote the member variables of the class, it works fine.</p>\n\n<p>However, as the function requires the use of member variables <code>m_DensityMin</code> and <code>m_DensityMax</code> of the class, I need to use it as a member function. This is what I've tried:</p>\n\n<pre><code>std::transform(foo.begin(), foo.end(), bar.begin(), &amp;XYZ::function);\n</code></pre>\n\n<p>but I end up with the error in VS2010:</p>\n\n<pre><code>error C2065: term does not evaluate to a function taking 1 arguments\n</code></pre>\n\n<p>As far as I can tell I'm passing only 1 argument. Any pointers?\nHere's a similar <a href=\"https://stackoverflow.com/questions/21653165/c-passing-pointer-to-non-static-member-function\">question</a>, I've tried with std::mem_fun, as std::mem_fn is not available to me, but to no avail.</p>\n"}, {"tags": ["c++", "c++11", "netbeans", "googletest", "g++4.8"], "comments": [{"owner": {"reputation": 3, "user_id": 3347464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eda20c5a8ef1dbafe15ad23553dcb902?s=128&d=identicon&r=PG&f=1", "display_name": "jaine", "link": "https://stackoverflow.com/users/3347464/jaine"}, "reply_to_user": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "edited": false, "score": 0, "creation_date": 1432137189, "post_id": 30354509, "comment_id": 48801499, "body": "@Praetorian As I said I am using Ubuntu 14.04, so no MinGW."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1432148830, "post_id": 30354509, "comment_id": 48808428, "body": "If you&#39;re using a new g++ you should be passing std=c++11 instead of c++0x"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3347464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eda20c5a8ef1dbafe15ad23553dcb902?s=128&d=identicon&r=PG&f=1", "display_name": "jaine", "link": "https://stackoverflow.com/users/3347464/jaine"}, "edited": false, "score": 0, "creation_date": 1432139791, "post_id": 30354812, "comment_id": 48803202, "body": "Thanks, didn&#39;t see that!"}], "tags": [], "owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "is_accepted": true, "score": 0, "last_activity_date": 1432137648, "creation_date": 1432137648, "answer_id": 30354812, "question_id": 30354509, "link": "https://stackoverflow.com/questions/30354509/error-to-string-is-not-a-member-of-std-when-compiling-in-command-line-with/30354812#30354812", "title": "Error: \u2018to_string\u2019 is not a member of \u2018std\u2019 when compiling in command line with gcc 4.8.2, works in NetBeans?", "body": "<p>I think your problem is the order in which you're passing command line arguments to gcc</p>\n\n<pre><code>g++ -isystem -std=c++0x ~/gtest-1.7.0/include ...\n    ^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>The <code>-isystem</code> flag should be followed by a path that contains headers which you want gcc to treat as <a href=\"https://gcc.gnu.org/onlinedocs/cpp/System-Headers.html\" rel=\"nofollow\">system headers</a>. So the <code>-std=c++0x</code> flag is being incorrectly consumed by the <code>-isystem</code> flag. You probably want the command line to be</p>\n\n<pre><code>g++ -std=c++0x -isystem ~/gtest-1.7.0/include ...\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3347464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eda20c5a8ef1dbafe15ad23553dcb902?s=128&d=identicon&r=PG&f=1", "display_name": "jaine", "link": "https://stackoverflow.com/users/3347464/jaine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1755, "favorite_count": 1, "accepted_answer_id": 30354812, "answer_count": 1, "score": 0, "last_activity_date": 1432137648, "creation_date": 1432136882, "last_edit_date": 1432137313, "question_id": 30354509, "link": "https://stackoverflow.com/questions/30354509/error-to-string-is-not-a-member-of-std-when-compiling-in-command-line-with", "title": "Error: \u2018to_string\u2019 is not a member of \u2018std\u2019 when compiling in command line with gcc 4.8.2, works in NetBeans?", "body": "<p>I am doing tests for my code with GoogleTest (1.7.0). I must have the tests compiling in both NetBeans (8.0.2) and straight from command line.</p>\n\n<p>NetBeans has GoogleTest integrated as suggested here: <a href=\"https://youtu.be/TS2CTf11k1U\" rel=\"nofollow\">https://youtu.be/TS2CTf11k1U</a>.\nI have also build GoogleTest from the command line (in different place) with the instructions provided with the package. </p>\n\n<p>The problematic line of code is (a and b are doubles):</p>\n\n<pre><code>std::string input = std::to_string(a) + \" \" + std::to_string(b);\n</code></pre>\n\n<p>which gives <code>error: \u2018to_string\u2019 is not a member of \u2018std\u2019</code>, when compiling with </p>\n\n<pre><code>g++ -isystem -std=c++0x ~/gtest-1.7.0/include -pthread ~/Task1/test_source.cpp libgtest.a -o test_module1_1\n</code></pre>\n\n<p>as instructed in GoogleTest documentation.</p>\n\n<p>The strange thing here is that when using the \"Test\" from NetBeans (as seen on video), the tests compile and run correctly.</p>\n\n<p>I am using Ubuntu 14.04 and I have already tried to update g++ (not to a higher version though), and I have also tried specifying the version with <code>-std=c++11</code> instead of <code>-std=c++0x</code>. </p>\n\n<p>In NetBeans there is this warning visible: </p>\n\n<pre><code>Library File /usr/include/c++/4.8/string\nbut there is an unresolved #include &lt;stddef.h&gt;\nin included /usr/include/_G_config.h\n</code></pre>\n\n<p>I found out that this might be because multilib and I have also tried to fix that by checking that it is installed. And this doesn't really cause any warnings during compile so it might be just that the IDE is confused.</p>\n\n<p>But conserning the real problem about compile errors:\nIs there something wrong with the GoogleTest framework, the compiler or my code?</p>\n\n<p>PS. Preferably don't suggest that I just don't use to_string as this system must be usable by students studying C++11 and really it shouldn't be that they can't use all the functionality that should be supported.</p>\n"}, {"tags": ["c++", "placement-new"], "comments": [{"owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "edited": false, "score": 1, "creation_date": 1432137263, "post_id": 30354497, "comment_id": 48801540, "body": "Well, don&#39;t call <code>mAllocator.Free(mBuffer);</code> from within the destructor. You&#39;re not allocating that memory from within the constructor, are you? Then you should do the same for deallocation, call it after the destructor call completes."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1432138026, "post_id": 30354497, "comment_id": 48802060, "body": "This might help: <a href=\"http://en.cppreference.com/w/cpp/memory/new/operator_new\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/memory/new/operator_new</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4921182"}, "edited": false, "score": 0, "creation_date": 1432150014, "post_id": 30355881, "comment_id": 48809109, "body": "Hi Sahu. Thank you for your input. In your second example, <code>~CParent()</code> will still be called after the memory is deallocated. I think however that the lack of symetry in my first example complicates things. If the memory is allocated in <code>CAllocator</code>, it should also be freed in <code>CAllocator</code>. I think your 2nd example could be slightly modified to make it work: the memory can be freed in <code>CAllocator::Free()</code> after the call to <code>object-&gt;~CParent()</code> instead of in <code>~CChild()</code>. I&#39;ll give it a try."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1432154254, "post_id": 30355881, "comment_id": 48811521, "body": "<code>object-&gt;~CParent()</code> will call <code>~CChild()</code>, which will call <code>~CParent()</code> first before executing the lines in the body of <code>~CChild()</code>. Hence, <code>~CParent()</code> will be called <b>before</b> memory is deallocated, <b>not after</b>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4921182"}, "edited": false, "score": 0, "creation_date": 1432185327, "post_id": 30355881, "comment_id": 48821255, "body": "@Sahu: Did you try it? I tried and the body of <code>~CChild()</code> definitely gets executed before <code>~CParent()</code>. This is, I believe, how C++ is meant to work. I also tried the slightly modified version of your 2nd example, and it does work perfectly! Thanks!"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1432185418, "post_id": 30355881, "comment_id": 48821291, "body": "@seeker6, you are right. I was confused for a moment."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 2, "last_activity_date": 1432153795, "last_edit_date": 1432153795, "creation_date": 1432140767, "answer_id": 30355881, "question_id": 30354497, "link": "https://stackoverflow.com/questions/30354497/c-placement-new-inheritance-and-destructor/30355881#30355881", "title": "C++ placement new, inheritance and destructor", "body": "<p>You are mixing the following notions in such a way that it makes me think that you are unclear on what they are supposed to be:</p>\n\n<ol>\n<li>Base classs/derived class destructors.</li>\n<li>Placement <code>new</code> operator.</li>\n<li>Memory allocation and deallcation.</li>\n</ol>\n\n<p>When you use the plain old <code>operator new</code> to allocate objects, two things happen:</p>\n\n<ol>\n<li>Memory is allocated for the object.</li>\n<li>The constructor of the object (for classes that have constructors) is called.</li>\n</ol>\n\n<p>When you call <code>operator delete</code> on pointers that were returned by <code>operator new</code>, two things happen:</p>\n\n<ol>\n<li>The destructor of the object is called.</li>\n<li>Memory is deallocated.</li>\n</ol>\n\n<p>When you use a placement <code>new</code> operator, you have to:</p>\n\n<ol>\n<li>Allocate memory before the call to the placement <code>new</code> operator.</li>\n<li>Use the pre-allocated memory in the call to <code>new</code>. A constructor of the class is called to initialize the object.</li>\n</ol>\n\n<p>For such objects, you have to:</p>\n\n<ol>\n<li>Call the destructor explicitly.</li>\n<li>Deallocate the memory using a method that matches with the way the memory was allocated. If you used <code>operator new char[size];</code> to allocate memory, use <code>delete [] ptr;</code> to deallocate the memory. If you used <code>malloc(size)</code> to allocate memory, use <code>free(ptr)</code> to deallocate the memory.</li>\n</ol>\n\n<p>To keep your code clean, you should separate:</p>\n\n<ol>\n<li>The responsibility for allocation and deallocation of memory.</li>\n<li>The responsibility for calling constructors and destructors.</li>\n</ol>\n\n<p>In your posted code, the class <code>CChild</code> seems to be unclean. It's not clear whether it is meant to be a user facing class or a helper class to help you manage memory.</p>\n\n<p>If you meant it to be a user facing class, I would refactor the code to:</p>\n\n<pre><code>#include &lt;cstdint&gt;\n#include &lt;cstdio&gt;\n#include &lt;new&gt;\n\nclass CParent\n{\n   public :\n      CParent() {\n         printf(\"CParent()\\n\");\n      }\n\n      virtual ~CParent() {\n         printf(\"~CParent()\\n\");\n      }\n};\n\nclass CChild : public CParent\n{\n   public :\n      CChild()\n      {\n         printf(\"CChild()\\n\");\n      }\n\n      ~CChild() {\n         printf(\"~CChild()\\n\");\n      }\n\n   private :\n};\n\nclass CAllocator\n{\n   public :\n      void Free(uint8_t *buffer) {\n         printf(\"CAllocator::Free(%p)\\n\", buffer);\n         delete [] buffer;\n      }\n\n\n      uint8_t *Alloc(size_t size) {\n         uint8_t *buffer = new uint8_t[size];\n         printf(\"CAllocator::Alloc() = %p\\n\", buffer);\n         return buffer;\n      }\n};\n\nint main()\n{\n   CAllocator allocator;\n   uint8_t *buffer = allocator.Alloc(sizeof(CChild));\n\n   CParent* object = new (buffer) CChild;\n\n   object-&gt;~CParent();\n\n   allocator.Free(buffer);\n\n   return 0;\n}\n</code></pre>\n\n<p>If you meant <code>CChild</code> to be used as a helper class for managing memory, the first thing you'll have to do is make sure that <code>CAllocator::Alloc()</code> and <code>CAlloctor::Free()</code> are symmetric. Since <code>Alloc()</code> returns a pointer to a <code>CParent</code>, you'll need to change <code>Free()</code> to accept a pointer to a <code>CParent</code> and does the right thing with it. Here's what I think the code should look like:</p>\n\n<pre><code>#include &lt;cstdint&gt;\n#include &lt;cstdio&gt;\n#include &lt;new&gt;\n\nclass CParent\n{\n   public :\n      CParent() {\n         printf(\"CParent()\\n\");\n      }\n\n      virtual ~CParent() {\n         printf(\"~CParent()\\n\");\n      }\n};\n\nclass CAllocator\n{\n   private :\n\n      class CChild : public CParent\n      {\n         public :\n            CChild(uint8_t *buffer) : mBuffer(buffer)\n            {\n               printf(\"CChild()\\n\");\n            }\n\n            ~CChild() {\n               printf(\"~CChild()\\n\");\n\n               // The object has ownership of the buffer.\n               // It can deallocate it.\n               delete [] mBuffer;\n            }\n\n         private :\n            uint8_t *mBuffer;\n      };\n\n   public :\n\n      // Make Alloc and Free symmetric.\n      // If Alloc() returns a CParent*, make sure Free()\n      // accepts the same value and does the right thing\n      // with it.\n\n      CParent *Alloc() {\n         uint8_t *buffer = new uint8_t[sizeof(CChild)];\n         printf(\"CAllocator::Alloc() = %p\\n\", buffer);\n\n         // Transfer the ownership of buffer to CChild\n         return new (buffer) CChild(buffer);\n      }\n\n      void Free(CParent* object) {\n         printf(\"CAllocator::Free(%p)\\n\", object);\n         object-&gt;~CParent();\n      }\n\n\n};\n\nint main()\n{\n   CAllocator allocator;\n\n   CParent *object = allocator.Alloc();\n   allocator.Free(object);\n\n   return 0;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4921182"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1149, "favorite_count": 0, "accepted_answer_id": 30355881, "answer_count": 1, "score": 3, "last_activity_date": 1432153795, "creation_date": 1432136852, "question_id": 30354497, "link": "https://stackoverflow.com/questions/30354497/c-placement-new-inheritance-and-destructor", "title": "C++ placement new, inheritance and destructor", "body": "<p>Fellows,</p>\n\n<p>When using placement-new on a class hierarchy, the base class must do the de-allocation. Otherwise, the base class destructor will be called on a de-allocated object.\nI want to be able to perform the de-allocation from a derived class. So I am open for ideas and suggestions! (NB: I am not married to placement-new, but I want to have custom memory management instead of new/delete).</p>\n\n<p>Please find below a sample piece of code:</p>\n\n<pre><code>#include &lt;cstdint&gt;\n#include &lt;cstdio&gt;\n#include &lt;new&gt;\n\nclass CParent\n{\npublic :\n    CParent() {\n        printf(\"CParent()\\n\");\n    }\n\n    virtual ~CParent() {\n        printf(\"~CParent()\\n\");\n    }\n};\n\nclass CAllocator\n{\nprivate :\n    void Free(uint8_t *buffer) {\n        printf(\"CAllocator::Free(%p)\\n\", buffer);\n        delete [] buffer;\n    }\n\n    class CChild : public CParent\n    {\n    public :\n        CChild(CAllocator &amp;allocator, uint8_t *buffer)\n            : mAllocator(allocator), mBuffer(buffer)\n        {\n            printf(\"CChild()\\n\");\n        }\n\n        ~CChild() {\n            printf(\"~CChild()\\n\");\n            mAllocator.Free(mBuffer);\n        }\n\n    private :\n        CAllocator &amp;mAllocator;\n        uint8_t *mBuffer;\n    };\n\npublic :\n    CParent *Alloc() {\n        uint8_t *buffer = new uint8_t[sizeof(CChild)];\n        printf(\"CAllocator::Alloc() = %p\\n\", buffer);\n        return new (buffer) CChild(*this, buffer);\n    }\n};\n\nint main()\n{\n    CAllocator allocator;\n    CParent *object = allocator.Alloc();\n\n    // NB: Can't do `delete object` here because of placement-new\n    object-&gt;~CParent();\n    return 0;\n}\n</code></pre>\n\n<p>Which gives the following output:</p>\n\n<pre><code>CAllocator::Alloc() = 0x2001010\nCParent()\nCChild()\n~CChild()\nCAllocator::Free(0x2001010)\n~CParent()\n</code></pre>\n\n<p>So <code>~CParent()</code> is called after the memory is freed...\nThank you so much for your help!</p>\n"}, {"tags": ["c++", "addition"], "answers": [{"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 2, "last_activity_date": 1432137115, "creation_date": 1432137115, "answer_id": 30354607, "question_id": 30354471, "link": "https://stackoverflow.com/questions/30354471/how-to-increment-mac-address/30354607#30354607", "title": "How to increment MAC address?", "body": "<p>If the part is FF, change it to 00 and increment the next part. It's precisely the same way you increment a decimal number when a digit is a 9 -- you make it a 0 and increment the next digit to the left, so 19 becomes 20.</p>\n"}], "owner": {"reputation": 23, "user_id": 3283805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6df5686225b045349e997c0d2577d858?s=128&d=identicon&r=PG&f=1", "display_name": "JVidiri", "link": "https://stackoverflow.com/users/3283805/jvidiri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 772, "favorite_count": 1, "accepted_answer_id": 30354607, "answer_count": 1, "score": -3, "last_activity_date": 1432168349, "creation_date": 1432136809, "last_edit_date": 1432168349, "question_id": 30354471, "link": "https://stackoverflow.com/questions/30354471/how-to-increment-mac-address", "title": "How to increment MAC address?", "body": "<p>I need to get the next valid MAC address from an initial one in C++.\nSo I tried to split the MAC address into separated hex integers, and increment one at a time, but I have no idea how to get the next when one of the split parts reach 0xFF.</p>\n\n<p>How can I make that verification of the increment?</p>\n\n<p>Any other ideas of how to increment a MAC address?</p>\n"}, {"tags": ["c++", "validation", "templates", "input"], "comments": [{"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 0, "creation_date": 1432146456, "post_id": 30354459, "comment_id": 48807035, "body": "<code>X.a</code> has to be <code>Ttype</code> because you declared it to be.  If you really wanted to check you could <code>static_assert(std::is_same&lt;Ttype, decltype(X.a)&gt;::value, &quot;not the same&quot;);</code> but that will never fire."}, {"owner": {"reputation": 503, "user_id": 1280961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mtA9d.jpg?s=128&g=1", "display_name": "wonko realtime", "link": "https://stackoverflow.com/users/1280961/wonko-realtime"}, "edited": false, "score": 0, "creation_date": 1432147389, "post_id": 30354459, "comment_id": 48807569, "body": "you could use boost::spirit, see <a href=\"http://www.boost.org/doc/libs/1_58_0/libs/spirit/doc/html/spirit/abstracts/attributes/primitive_attributes.html\" rel=\"nofollow noreferrer\">here</a> and <a href=\"http://www.boost.org/doc/libs/1_58_0/libs/spirit/doc/html/spirit/qi/reference/numeric.html\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 4245589, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ff144859e42f752e1f37f004ecc22b65?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4245589/andy"}, "edited": false, "score": 0, "creation_date": 1432137728, "post_id": 30354638, "comment_id": 48801843, "body": "And how do i check if the types match?  Do i  use typeinfo on Ttype?"}, {"owner": {"reputation": 1596, "user_id": 3431124, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xaBzf.jpg?s=128&g=1", "display_name": "Robert S.", "link": "https://stackoverflow.com/users/3431124/robert-s"}, "reply_to_user": {"reputation": 165, "user_id": 4245589, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ff144859e42f752e1f37f004ecc22b65?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4245589/andy"}, "edited": false, "score": 0, "creation_date": 1432137913, "post_id": 30354638, "comment_id": 48801982, "body": "Just use a conversion method and check if exceptions occur. You can specialize your template functions for several types and call the right conversion method in each (like <code>atoi</code>/<code>atof</code> or some STL equivalent if there is on)."}, {"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 0, "creation_date": 1432146564, "post_id": 30354638, "comment_id": 48807113, "body": "neither of those functions throw exceptions."}, {"owner": {"reputation": 1596, "user_id": 3431124, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xaBzf.jpg?s=128&g=1", "display_name": "Robert S.", "link": "https://stackoverflow.com/users/3431124/robert-s"}, "edited": false, "score": 0, "creation_date": 1432153230, "post_id": 30354638, "comment_id": 48810897, "body": "True. For C++11 you might use <code>std::stoi</code> and so on. Otherwise if boost is an option <code>boost::lexical_cast</code> may be useful."}], "tags": [], "owner": {"reputation": 1596, "user_id": 3431124, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xaBzf.jpg?s=128&g=1", "display_name": "Robert S.", "link": "https://stackoverflow.com/users/3431124/robert-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1432137187, "creation_date": 1432137187, "answer_id": 30354638, "question_id": 30354459, "link": "https://stackoverflow.com/questions/30354459/check-if-input-is-of-correct-type/30354638#30354638", "title": "Check if input is of correct type", "body": "<p>You can't check the input before you have read it. The only thing I can think of is to read the input into a string (which will always work for text files or stdin) and try to convert it into your expected type. While converting you can look for exceptions.</p>\n"}, {"comments": [{"owner": {"reputation": 1596, "user_id": 3431124, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xaBzf.jpg?s=128&g=1", "display_name": "Robert S.", "link": "https://stackoverflow.com/users/3431124/robert-s"}, "edited": false, "score": 0, "creation_date": 1432153841, "post_id": 30357745, "comment_id": 48811268, "body": "I appreciate this solution. But two additional thoughts.  I&#39;m not exactly sure but wouldn&#39;t this cause trouble for the last read operation (EOF)? Cause EOF will set the failbit as well but it is no real error. I might be wrong here. Maybe an additional check is helpful to determine if it was EOF. Something like checking explicitly <code>fail()</code> and if this is true also check if it wasn&#39;t <code>eof()</code>.  Second thought. Will this fail for e.g. <code>int</code> if the input is something like <code>5.0</code>?"}, {"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "reply_to_user": {"reputation": 1596, "user_id": 3431124, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xaBzf.jpg?s=128&g=1", "display_name": "Robert S.", "link": "https://stackoverflow.com/users/3431124/robert-s"}, "edited": false, "score": 0, "creation_date": 1432160060, "post_id": 30357745, "comment_id": 48814204, "body": "<code>eof</code> is not set until you try to read <i>beyond</i> the end of the stream.  If you entered something like <code>1 2.0 3</code> it would fail as expected, if you did <code>1 2 3.5</code> it would succeed but leave the <code>.5</code> in the stream.  If you want to work around that then you&#39;ll have to consume the input as strings.. how exactly to move from there is not the clearest.  You could make a string stream for each string and check to see if the whole stream is consumed."}], "tags": [], "owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "is_accepted": false, "score": 1, "last_activity_date": 1432146803, "creation_date": 1432146803, "answer_id": 30357745, "question_id": 30354459, "link": "https://stackoverflow.com/questions/30354459/check-if-input-is-of-correct-type/30357745#30357745", "title": "Check if input is of correct type", "body": "<p>It seems all you want is to try to read from the <code>istream</code> and fail if the reading fails.  In that case you can use the implicit bool-likeness of the <code>istream</code> after the extraction operation.</p>\n\n<pre><code>template &lt;class T&gt;\nclass Foo {\n    T a,b,c;\n    friend std::istream&amp; operator&gt;&gt;(std::istream&amp; input, Foo&amp; X ) {\n      if (!(input &gt;&gt; X.a &gt;&gt; X.b &gt;&gt; X.c)) { // examine the istream\n        std::cerr &lt;&lt; \"extraction failed\\n\";\n      }\n      return input;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 4245589, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ff144859e42f752e1f37f004ecc22b65?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4245589/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 868, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1432146803, "creation_date": 1432136775, "last_edit_date": 1432146279, "question_id": 30354459, "link": "https://stackoverflow.com/questions/30354459/check-if-input-is-of-correct-type", "title": "Check if input is of correct type", "body": "<p>I have a template class which can take all kinds of types: int, double etc. I want to check if the user has inputted the correct type. If the object was instantiated with int the user should input an int, if it was with double he should input a double and so on. I want to be able to do this no matter if the input comes from file or keyboard. I have 2 questions.</p>\n\n<ol>\n<li>Should I do the checking in the definition of the \">>\" operator overloading?</li>\n<li>How do I do the checking? Do I create a template function that checks for any kind of type?</li>\n</ol>\n\n<p>I want something like this:</p>\n\n<pre><code>template &lt;class Ttype&gt;\nclass foo \n{\n    Ttype a,b,c; \n    friend istream &amp;operator&gt;&gt; &lt;&gt;( istream &amp;input, foo&lt;Ttype&gt; &amp;X );\n    //methods\n};\n\ntemplate &lt;class Ttype&gt; istream &amp;operator&gt;&gt;( istream &amp;input, foo&lt;Ttype&gt; &amp;X )\n{\n    //check if X.a,X.b,X.c are of Ttype\n    input&gt;&gt;X.a&gt;&gt;X.b&gt;&gt;X.c;\n}\n\nint main()\n{\n    foo&lt;int&gt; a;\n    cin&gt;&gt;a;\n\n    foo&lt;double&gt; b;\n    cin&gt;&gt;b;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "types"], "answers": [{"tags": [], "owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "is_accepted": true, "score": 5, "last_activity_date": 1432137496, "last_edit_date": 1432137496, "creation_date": 1432136912, "answer_id": 30354523, "question_id": 30354455, "link": "https://stackoverflow.com/questions/30354455/deducing-value-type-from-iterator-for-return-type-of-template-function/30354523#30354523", "title": "Deducing value type from iterator for return type of template function", "body": "<p>You can use <a href=\"http://en.cppreference.com/w/cpp/iterator/iterator_traits\" rel=\"nofollow\"><code>std::iterator_traits::value_type</code></a>:</p>\n\n<pre><code>typedef typename std::iterator_traits&lt;Iter&gt;::value_type value_type;\n</code></pre>\n\n<p>As for the function declaration and definition, in old-school C++03 style you could do the following:</p>\n\n<pre><code>template&lt;typename Iter&gt;\nstd::pair&lt;typename std::iterator_traits&lt;Iter&gt;::value_type,\n          typename std::iterator_traits&lt;Iter&gt;::value_type&gt; \nsummean(Iter first1, Iter last1)\n{\n    typedef typename std::iterator_traits&lt;Iter&gt;::value_type value_type;\n    value_type sum = std::accumulate(first1, last1, value_type());\n    value_type mean = sum / (last1-first1);\n\n    return std::make_pair(sum, mean);\n}\n</code></pre>\n\n<p>And since C++11 you can use <code>decltype</code> and trailing return type to make it less verbose:</p>\n\n<pre><code>template&lt;typename Iter&gt;\nauto summean(Iter first1, Iter last1)-&gt;decltype(std::make_tuple(*first1, *first))\n{\n    using value_type = typename std::iterator_traits&lt;Iter&gt;::value_type;\n    value_type sum = std::accumulate(first1, last1, value_type());\n    value_type mean = sum / (last1-first1);\n\n    return make_tuple(sum, mean);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "is_accepted": false, "score": 3, "last_activity_date": 1432136982, "creation_date": 1432136982, "answer_id": 30354555, "question_id": 30354455, "link": "https://stackoverflow.com/questions/30354455/deducing-value-type-from-iterator-for-return-type-of-template-function/30354555#30354555", "title": "Deducing value type from iterator for return type of template function", "body": "<p>You probably want to return a <code>std::pair</code> of <code>double</code> instead of <code>std::tuple</code>. As for your problem you can use the <code>value_type</code> member taken from <code>std::iterator_traits</code>:</p>\n\n<pre><code>template&lt;typename Iter&gt;\nauto\nsummean(Iter first1, Iter last1) -&gt; decltype(std::make_pair(*first1, double{}))\n{\n    using value_type = typename std::iterator_traits&lt;Iter&gt;::value_type;\n    double sum = std::accumulate(first1, last1, value_type{});\n    double mean = sum / (last1-first1);\n\n    return {sum, mean};\n}\n</code></pre>\n"}], "owner": {"reputation": 13848, "user_id": 276193, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3d9b60ead1b0c8420c03b203832e8d5f?s=128&d=identicon&r=PG", "display_name": "learnvst", "link": "https://stackoverflow.com/users/276193/learnvst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 870, "favorite_count": 0, "accepted_answer_id": 30354523, "answer_count": 2, "score": 2, "last_activity_date": 1432137496, "creation_date": 1432136769, "last_edit_date": 1432137317, "question_id": 30354455, "link": "https://stackoverflow.com/questions/30354455/deducing-value-type-from-iterator-for-return-type-of-template-function", "title": "Deducing value type from iterator for return type of template function", "body": "<p>Just experimenting with multiple return values using this simple snippet that calculates sum and mean from a container. </p>\n\n<pre><code>template&lt;typename Iter&gt;\nstd::tuple&lt;double, double&gt; summean(Iter first1, Iter last1)\n{\n    double sum = std::accumulate(first1, last1, 0.0);\n    double mean = sum / (last1-first1);\n\n    return {sum, mean};\n}\n</code></pre>\n\n<p>The demo uses double precision calculation just as a demo. Is there an elegant way to use the precision of the values in the container in the calculations for the return types of the tuple?</p>\n"}, {"tags": ["c++", "segmentation-fault", "arm", "embedded", "gpio"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1432137489, "post_id": 30354405, "comment_id": 48801683, "body": "Are you doing this in kernel space or in a user program ? (If it&#39;s the latter then it&#39;s not going to work.)"}, {"owner": {"reputation": 335, "user_id": 846566, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ae9c4878140493b49f15936991ba8cb5?s=128&d=identicon&r=PG", "display_name": "user846566", "link": "https://stackoverflow.com/users/846566/user846566"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1432137827, "post_id": 30354405, "comment_id": 48801913, "body": "it is a user program.  So what is the workaround?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1432138343, "post_id": 30354405, "comment_id": 48802280, "body": "Unless there is some way to map a physical address into your virtual address space then you will probably need to write a kernel module. Take a look at <code>&#47;proc</code> first though to see if there is an easier way."}, {"owner": {"reputation": 335, "user_id": 846566, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ae9c4878140493b49f15936991ba8cb5?s=128&d=identicon&r=PG", "display_name": "user846566", "link": "https://stackoverflow.com/users/846566/user846566"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1432145370, "post_id": 30354405, "comment_id": 48806419, "body": "there is a /proc/device-tree/soc/aips-bus@02000000/iomuxc@020e0000/humm&zwnj;&#8203;ingboard/hummingboar&zwnj;&#8203;d_spi directory which looks like it could be the right thing; but what do I do with it?"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1432165417, "post_id": 30354405, "comment_id": 48815879, "body": "have you tried mmap?"}], "answers": [{"tags": [], "owner": {"reputation": 6085, "user_id": 425871, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/58MZp.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/425871/steve"}, "is_accepted": false, "score": 2, "last_activity_date": 1432145603, "creation_date": 1432145603, "answer_id": 30357362, "question_id": 30354405, "link": "https://stackoverflow.com/questions/30354405/segmentation-fault-in-embedded-application-writing-to-register/30357362#30357362", "title": "Segmentation fault in embedded application writing to register", "body": "<p>This is possible from user space (although you may need to be root). The key is remapping the memory into the process's address space.</p>\n\n<p>There is a program called <code>devmem2</code> that can do this. Source code is <a href=\"http://free-electrons.com/pub/mirror/devmem2.c\" rel=\"nofollow\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 335, "user_id": 846566, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ae9c4878140493b49f15936991ba8cb5?s=128&d=identicon&r=PG", "display_name": "user846566", "link": "https://stackoverflow.com/users/846566/user846566"}, "is_accepted": false, "score": 1, "last_activity_date": 1432242997, "last_edit_date": 1432242997, "creation_date": 1432237499, "answer_id": 30382989, "question_id": 30354405, "link": "https://stackoverflow.com/questions/30354405/segmentation-fault-in-embedded-application-writing-to-register/30382989#30382989", "title": "Segmentation fault in embedded application writing to register", "body": "<p>Thanks for everyone's help.  In case someone has the same problem I wanted to show my solution.  Much of this code came from the devmem2 from Jan-Derk Bakker.</p>\n\n<p>Here are the two routines I wrote to read and write from memory.</p>\n\n<pre><code>static const u_int32_t MAP_SIZE = 4096;\nstatic const u_int32_t MAP_MASK = (MAP_SIZE - 1);\n\nbool CGpio::writeMem(u_int32_t memAddr, u_int32_t &amp;value)\n{\n    int fd;\n    void *map_base, *virt_addr;\n    off_t target = memAddr;\n\n    // open the mem file\n    if((fd = open(\"/dev/mem\", O_RDWR | O_SYNC)) == -1)\n        return false;\n\n    // map one page\n    map_base = mmap(0, MAP_SIZE, PROT_READ | PROT_WRITE, MAP_SHARED, fd, target &amp; ~MAP_MASK);\n    if (map_base == (void *)-1)\n        return false;\n\n    // map virutial space\n    virt_addr = map_base + (target &amp; MAP_MASK);\n\n    // write the value\n    *((u_int32_t *) virt_addr) = value;\n\n    // clean up\n    bool ret = (munmap(map_base, MAP_SIZE) != -1);\n    close(fd);\n\n    return ret;\n}\n\nbool CGpio::readMem(u_int32_t memAddr, u_int32_t &amp;value)\n{\n    int fd;\n    void *map_base, *virt_addr;\n    off_t target = memAddr;\n\n    // open the mem file\n    if((fd = open(\"/dev/mem\", O_RDWR | O_SYNC)) == -1)\n        return false;\n\n    // map one page\n    map_base = mmap(0, MAP_SIZE, PROT_READ | PROT_WRITE, MAP_SHARED, fd, target &amp; ~MAP_MASK);\n    if (map_base == (void *)-1)\n         return false;\n\n    // map virutial space\n    virt_addr = map_base + (target &amp; MAP_MASK);\n\n    // read the value\n    value = *((u_int32_t *) virt_addr);\n\n    // clean up\n    bool ret = (munmap(map_base, MAP_SIZE) != -1);\n    close(fd);\n\n    return ret;\n}\n</code></pre>\n\n<p>And here are the headers I used.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;string.h&gt;\n#include &lt;iostream&gt;\n#include &lt;sys/types.h&gt;\n</code></pre>\n"}], "owner": {"reputation": 335, "user_id": 846566, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ae9c4878140493b49f15936991ba8cb5?s=128&d=identicon&r=PG", "display_name": "user846566", "link": "https://stackoverflow.com/users/846566/user846566"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1432242997, "creation_date": 1432136631, "question_id": 30354405, "link": "https://stackoverflow.com/questions/30354405/segmentation-fault-in-embedded-application-writing-to-register", "title": "Segmentation fault in embedded application writing to register", "body": "<p>I'm running debian with the 3.14.14 kernel on a Freescale iMX6 arm Processor.  </p>\n\n<p>I have this code in an embedded application that gives a segmentation fault.</p>\n\n<pre><code>volatile unsigned int&amp; GPIO2IO26CTRL = *((volatile unsigned int*)0x20e0104);\nGPIO2IO26CTRL = 0x5;\n</code></pre>\n\n<p>also tried:</p>\n\n<pre><code>volatile unsigned int* GPIO2IO26CTRL = (volatile unsigned int*)0x20e0104;\n*GPIO2IO26CTRL = 0x5;\n</code></pre>\n\n<p>But I really do want to write 0x5 to location 0x20e0104.  This tells the iMX6 chip that an io line is to be GPIO rather than spi;</p>\n\n<p>How do I get around this?</p>\n"}, {"tags": ["c++", "opencv", "assert"], "comments": [{"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 4, "creation_date": 1432136172, "post_id": 30354242, "comment_id": 48800750, "body": "You are trying to compare floating point values for equality. <a href=\"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html</a>"}, {"owner": {"reputation": 107, "user_id": 4768977, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PNi1Q.jpg?s=128&g=1", "display_name": "zarachbaal", "link": "https://stackoverflow.com/users/4768977/zarachbaal"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1432136979, "post_id": 30354242, "comment_id": 48801357, "body": "I forgot about this problem with floating points , thank you ! But why does the display of <code>Tolmin+Tolmax</code> makes it work ?  To avoid this, is it OK to use integers instead of floats, and then divide them when I do the calculation ?"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 4768977, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PNi1Q.jpg?s=128&g=1", "display_name": "zarachbaal", "link": "https://stackoverflow.com/users/4768977/zarachbaal"}, "edited": false, "score": 0, "creation_date": 1432194501, "post_id": 30355180, "comment_id": 48825922, "body": "The problem is that I have to make sure that (Tolmin,Tolmax)&gt;0, (Tolmin,Tolmax)&lt;=1, (Tolmin+Tolmax != 1). I chose to multiply Tolmin and Tolmax by 100 to get integers, then I do the checks with <code>assert</code> and at the calculation I divide Tolmin and Tolmax by 100."}, {"owner": {"reputation": 756, "user_id": 1584435, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/91e08d2198292677f855c45c81e3c5a0?s=128&d=identicon&r=PG", "display_name": "Sinapse", "link": "https://stackoverflow.com/users/1584435/sinapse"}, "reply_to_user": {"reputation": 107, "user_id": 4768977, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PNi1Q.jpg?s=128&g=1", "display_name": "zarachbaal", "link": "https://stackoverflow.com/users/4768977/zarachbaal"}, "edited": false, "score": 1, "creation_date": 1432284498, "post_id": 30355180, "comment_id": 48872571, "body": "Method you used is not different than assuming an arbitrary acceptable interval (you are using 0.01 as an acceptable interval) ;)"}, {"owner": {"reputation": 107, "user_id": 4768977, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PNi1Q.jpg?s=128&g=1", "display_name": "zarachbaal", "link": "https://stackoverflow.com/users/4768977/zarachbaal"}, "edited": false, "score": 0, "creation_date": 1432288295, "post_id": 30355180, "comment_id": 48874941, "body": "You&#39;re right, I read your proposition too fast, your code woks too. There is just one thing I don&#39;t understand (or not completly) : Why does the display of <code>Tolmin+Tolmax</code>  makes <code>assert</code> detect <code>Tolmin+Tolmax = 1.0</code> ?"}, {"owner": {"reputation": 756, "user_id": 1584435, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/91e08d2198292677f855c45c81e3c5a0?s=128&d=identicon&r=PG", "display_name": "Sinapse", "link": "https://stackoverflow.com/users/1584435/sinapse"}, "reply_to_user": {"reputation": 107, "user_id": 4768977, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PNi1Q.jpg?s=128&g=1", "display_name": "zarachbaal", "link": "https://stackoverflow.com/users/4768977/zarachbaal"}, "edited": false, "score": 1, "creation_date": 1432318824, "post_id": 30355180, "comment_id": 48894515, "body": "Displaying it should not effect the assert&#39;s work. Maybe provide us with some sample code on the way you are printing. It may give us some ideas about which is the problem."}, {"owner": {"reputation": 107, "user_id": 4768977, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PNi1Q.jpg?s=128&g=1", "display_name": "zarachbaal", "link": "https://stackoverflow.com/users/4768977/zarachbaal"}, "edited": false, "score": 0, "creation_date": 1432392733, "post_id": 30355180, "comment_id": 48914237, "body": "I provided a sample of my code in my question. In the second sample, I display <code>Tolmin+Tolmax</code> via <code>std::cout &lt;&lt; &quot;Tolmin+Tolmax&quot; &lt;&lt; Tolmin+Tolmax &lt;&lt; endl;</code>, it displays <code>1</code>if Tolmin=0.01 and Tolmax=0.99 and <code>assert</code> stops the program&#39;s execution"}, {"owner": {"reputation": 107, "user_id": 4768977, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PNi1Q.jpg?s=128&g=1", "display_name": "zarachbaal", "link": "https://stackoverflow.com/users/4768977/zarachbaal"}, "edited": false, "score": 0, "creation_date": 1432625432, "post_id": 30355180, "comment_id": 48985361, "body": "I thought the explanation would be something like this, strange that you couldn&#39;t reproduce the behavior though"}], "tags": [], "owner": {"reputation": 756, "user_id": 1584435, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/91e08d2198292677f855c45c81e3c5a0?s=128&d=identicon&r=PG", "display_name": "Sinapse", "link": "https://stackoverflow.com/users/1584435/sinapse"}, "is_accepted": true, "score": 3, "last_activity_date": 1432400079, "last_edit_date": 1432400079, "creation_date": 1432138634, "answer_id": 30355180, "question_id": 30354242, "link": "https://stackoverflow.com/questions/30354242/assert-function-weird-behavior/30355180#30355180", "title": "&#39;assert&#39; function : weird behavior", "body": "<p>My guess is that a value is being used in your code (as Tolmin or Tolmax) which cannot be represented in a machine's number format.\nWhat do I mean? Well there are numbers that you can easily think of which a computer cannot store them exactly as they are. Computers have to store numbers in a finite digit binary formats and as a result some numbers will not be stored exactly as they are. Think about it this way, we can think of the number (2/3) right? but when we have to represent this number in a decimal format with finite digits, we have to round it like this: 0.66666667 hence we cannot exactly write this number as it is. This case can accrue in a machine too for example we cannot have number 0.2 stored in a machine in binary format because its representative digits in binary is infinite, a machine will just round such numbers to the closest it can store.\nIn your case, you are comparing a converted-to-binary number to an absolute value (1.0) and logically they are not the same even if they are very close to each other. So my guess is that the sum of Tolmin and Tolmax will be something very close to 1.0 but not exactly 1.0. So whats the solution? you should check if sum has passed an arbitrary interval to 1.0 or not. Something like this:</p>\n\n<pre><code>assert(abs(sum - 1.0) &gt; 0.0001)\n</code></pre>\n\n<p><strong>UPDATE:</strong>\nI couldn't reproduce your reported behavior while printing it, both with gcc and MSC++ so all I can do is a weak guess. When you build your code, compiler will revise it in an optimization phase. You are ordering to compute <code>Tolmin+Tolmax</code> in two places, first in cout and second in assert, so compiler will deduce that this computation can be done once and then reuse it's result. As cout reforms the number you order to display, and the value is so close to 1, it will be rounded and get the exact value 1 and then the result will be reused in assert. It can be the case or not, I cannot confirm it as I couldn't reproduce the reported behavior.</p>\n"}], "owner": {"reputation": 107, "user_id": 4768977, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PNi1Q.jpg?s=128&g=1", "display_name": "zarachbaal", "link": "https://stackoverflow.com/users/4768977/zarachbaal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 30355180, "answer_count": 1, "score": 2, "last_activity_date": 1432400079, "creation_date": 1432136123, "last_edit_date": 1432393955, "question_id": 30354242, "link": "https://stackoverflow.com/questions/30354242/assert-function-weird-behavior", "title": "&#39;assert&#39; function : weird behavior", "body": "<p>I am developping on Windows 7 in C++ with Qt Creator.\nI also use the library OpenCV</p>\n\n<p>I came up against a strange problem with the function <code>assert</code>.\nI developed a function that makes a linear transformation on an image in order to get a better contrast, with the possibility to specify a zone (x1,x2,y1,y2) of the image we want to work on and also a tolerance (Tolmin and Tolmax) : the percentile of the histogram we want to ignore.</p>\n\n<p>I need to make sure that :</p>\n\n<ul>\n<li>Image is 16bits grayscale (img.type()=CV_16U &amp;&amp; img.channels()=1)</li>\n<li>Zone coordinates are correct (positive, do not exceed image size ...)</li>\n<li>Tolmin,Tolmax positive and Tolmin+Tolmax != 1 (if Tolmin+Tolmax=1 there will be a division by 0)</li>\n</ul>\n\n<p>I used the function <code>assert</code></p>\n\n<p>My code is the following :</p>\n\n<pre><code>void equalizeHist_16U_linear(Mat &amp;img, float Tolmin, float Tolmax, int x1, int x2, int y1, int y2)\n{\n    assert(img.channels() == 1);\n    assert(img.type() == CV_16U);\n    assert(x1&gt;=0 &amp;&amp; y1&gt;=0 &amp;&amp; x2&gt;=x1 &amp;&amp; y2&gt;=y1);\n    assert(y2&lt;img.rows &amp;&amp; x2&lt;img.cols);\n    assert(Tolmin&gt;0 &amp;&amp; Tolmax&gt;0);\n    assert(Tolmin+Tolmax != 1.0);\n\n    ## code ##\n    ...\n\n}\n</code></pre>\n\n<p>The five first <code>assert</code>works fine, but the last one <code>assert(Tolmin+Tolmax != 1.0)</code> does not work. Even when <code>Tolmin+Tolmax=1</code>, assert does not stop the execution so the program crashes (division by 0).\nTo be sure, I printed <code>Tolmin+Tolmax</code> before the <code>assert</code>call.</p>\n\n<pre><code>void equalizeHist_16U_linear(Mat &amp;img, float Tolmin, float Tolmax, int x1, int x2, int y1, int y2)\n{\n    cout &lt;&lt; endl &lt;&lt; \"Tolmin+Tolmax = \" &lt;&lt; Tolmin+Tolmax &lt;&lt; endl;\n\n    assert(img.channels() == 1);\n    assert(img.type() == CV_16U);\n    assert(x1&gt;=0 &amp;&amp; y1&gt;=0 &amp;&amp; x2&gt;=x1 &amp;&amp; y2&gt;=y1);\n    assert(y2&lt;img.rows &amp;&amp; x2&lt;img.cols);\n    assert(Tolmin&gt;0 &amp;&amp; Tolmax&gt;0);\n    assert(Tolmin+Tolmax != 1.0);\n\n    ## code ##\n    ...\n\n}\n</code></pre>\n\n<p>It displays \"Tolmin+Tolmax=1\", and this time, <code>assert</code> stopped the execution of the program !</p>\n\n<p>How is it possible ? Why does the display of <code>Tolmin+Tolmax</code> makes <code>assert</code> work ?</p>\n\n<p>I tried to add the following : </p>\n\n<pre><code>void equalizeHist_16U_linear(Mat &amp;img, float Tolmin, float Tolmax, int x1, int x2, int y1, int y2)\n{\n    float sum = Tolmin+Tolmax;\n\n    assert(img.channels() == 1);\n    assert(img.type() == CV_16U);\n    assert(x1&gt;=0 &amp;&amp; y1&gt;=0 &amp;&amp; x2&gt;=x1 &amp;&amp; y2&gt;=y1);\n    assert(y2&lt;img.rows &amp;&amp; x2&lt;img.cols);\n    assert(Tolmin&gt;0 &amp;&amp; Tolmax&gt;0);*/\n    assert(sum != 1.0);\n\n    ## code ##\n    ...\n\n}\n</code></pre>\n\n<p>But it does not work either.</p>\n"}, {"tags": ["c++", "class", "definition", "member-functions"], "comments": [{"owner": {"reputation": 184, "user_id": 1552766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050525b6d5df7ac28609fd791d1e384d?s=128&d=identicon&r=PG", "display_name": "timato", "link": "https://stackoverflow.com/users/1552766/timato"}, "edited": false, "score": 0, "creation_date": 1432136148, "post_id": 30354130, "comment_id": 48800739, "body": "Consider using structs if Sub1 and Sub2 are just going to be data members of Foo.  Then you could remove the need for Get functions as well."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 1, "creation_date": 1432136175, "post_id": 30354130, "comment_id": 48800752, "body": "If your internal classes become more than <code>struct</code>s, you might consider moving them out of the class and into a private <code>namespace</code>."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1432138046, "post_id": 30354130, "comment_id": 48802079, "body": "If you use the unnamed inner classes, how does the compiler know which <code>GetX</code> function to use?  You can&#39;t refer by class name, since there aren&#39;t any."}, {"owner": {"reputation": 175, "user_id": 4920958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c461d2489bd40b62cb5c090c45bef562?s=128&d=identicon&r=PG&f=1", "display_name": "jvpernis", "link": "https://stackoverflow.com/users/4920958/jvpernis"}, "edited": false, "score": 0, "creation_date": 1432190915, "post_id": 30354130, "comment_id": 48823817, "body": "The actual code was simplified for the purpose of demonstrating my problem, the internal classes are more than &#39;just&#39; data members of Foo."}, {"owner": {"reputation": 175, "user_id": 4920958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c461d2489bd40b62cb5c090c45bef562?s=128&d=identicon&r=PG&f=1", "display_name": "jvpernis", "link": "https://stackoverflow.com/users/4920958/jvpernis"}, "reply_to_user": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 0, "creation_date": 1432191393, "post_id": 30354130, "comment_id": 48824069, "body": "@AmiTavory A private namespace sounds interesting.. Do you have more information about that?"}], "answers": [{"tags": [], "owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "is_accepted": true, "score": 3, "last_activity_date": 1432144013, "creation_date": 1432144013, "answer_id": 30356853, "question_id": 30354130, "link": "https://stackoverflow.com/questions/30354130/defining-unnamed-class-member-functions/30356853#30356853", "title": "Defining unnamed class member functions?", "body": "<p>It is, unfortunately, impossible. \u00a79.3/5:</p>\n\n<blockquote>\n  <p>If the definition of a member function is lexically outside its class\n   definition, <strong>the member function name shall be qualified by its\n   class name using the <code>::</code> operator</strong>.</p>\n</blockquote>\n\n<p>Since no class name exists, no out-of-class definitions for member functions are possible. The fact that GCC allows decltype-specifiers in this context is a bug.</p>\n"}, {"tags": [], "owner": {"reputation": 1003, "user_id": 2528436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e1d4385a3ac2f060b4fea2bba1f6e5a?s=128&d=identicon&r=PG", "display_name": "Kai Petzke", "link": "https://stackoverflow.com/users/2528436/kai-petzke"}, "is_accepted": false, "score": 0, "last_activity_date": 1602323927, "last_edit_date": 1602323927, "creation_date": 1602322369, "answer_id": 64291976, "question_id": 30354130, "link": "https://stackoverflow.com/questions/30354130/defining-unnamed-class-member-functions/64291976#64291976", "title": "Defining unnamed class member functions?", "body": "<p>With <code>gcc</code> at least, you can do the trick using <code>decltype</code>:</p>\n<pre><code>int decltype(Foo::Sub1)::GetX() { return x; }\n</code></pre>\n<p>It is not standards compliant, though, as Columbo has already pointed out. So don't blame me, if a future version of <code>gcc</code> refuses to compile this. But we all now, that <code>gcc</code> has never been dogmatic about standards compliance, and that the <code>gcc</code> team has a strong tendency to keep language extensions, if they are both unambigous (which is clearly the case here) and useful to at least some programmers. Over the time, many of these <code>gcc</code> extensions have eventually become part of the standards.</p>\n<p>Nonetheless, <code>clang</code> and probably most other compilers refuse this construct with the error message:</p>\n<pre><code>'decltype' cannot be used to name a declaration\n</code></pre>\n<p>But even <code>clang</code> can be tricked into accepting the <code>decltype</code> trick. We just need to do a <code>typedef</code>:</p>\n<pre><code>typedef decltype(Foo::Sub1) Sub1type;\nint Sub1type::GetX() { return x; }\n</code></pre>\n<p>Of course, this is not much different to naming the unnamed classes. The advantage of the <code>typedef</code> solution might still be, that you can hide away the type names inside a private namespace.</p>\n"}], "owner": {"reputation": 175, "user_id": 4920958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c461d2489bd40b62cb5c090c45bef562?s=128&d=identicon&r=PG&f=1", "display_name": "jvpernis", "link": "https://stackoverflow.com/users/4920958/jvpernis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "accepted_answer_id": 30356853, "answer_count": 2, "score": 6, "last_activity_date": 1602323927, "creation_date": 1432135859, "question_id": 30354130, "link": "https://stackoverflow.com/questions/30354130/defining-unnamed-class-member-functions", "title": "Defining unnamed class member functions?", "body": "<p>I currently have two unnamed classes defined in my Foo.h:</p>\n\n<pre><code>class Foo {\npublic:\n    Foo();\n\n    class {\n    private:\n        int x;\n        int y;\n    public:\n        int GetX() { return x; }\n        int GetY() { return y; }\n    } Sub1;\n\n    class {\n    private:\n        int x;\n    public:\n        int GetX() { return x; }\n    } Sub2;\n}\n</code></pre>\n\n<p>This code compiles just fine, and it used like this:</p>\n\n<pre><code> Foo temp;\n int Ax, Ay, Bx;\n Ax = temp.Sub1.GetX();\n Ay = temp.Sub1.GetY();\n Bx = temp.Sub2.GetX();\n</code></pre>\n\n<p>However, now I want to move the member function definitions to the source file.The only way I know to split this class into a header file and source file, is to name the classes:</p>\n\n<p>Foo.h:</p>\n\n<pre><code>class Foo {\n\nprivate:    \n    class A {\n    private:\n        int x;\n        int y;\n    public:\n        int GetX();\n        int GetY();\n    };\n\n    class B {\n    private:\n        int x;\n    public:\n        int GetX();\n    };\n\npublic:\n    Foo();\n    A Sub1;\n    B Sub2;\n\n}\n</code></pre>\n\n<p>Foo.cpp:</p>\n\n<pre><code>int Foo::A::GetX() { return x; }\nint Foo::A::GetY() { return y; }\nint Foo::B::GetX() { return x; }\n</code></pre>\n\n<p>This code is not what I want, however, since it is ugly and I didn't want a named class in the first place. </p>\n\n<p>Is it possible to split the class into a header file and source file? Or is this just bad code design?</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 13218, "user_id": 1348273, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/IYjFG.jpg?s=128&g=1", "display_name": "Lingxi", "link": "https://stackoverflow.com/users/1348273/lingxi"}, "reply_to_user": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1432136031, "post_id": 30354113, "comment_id": 48800647, "body": "@dyp Isn&#39;t the second argument deducible using <code>std::iterator_traits</code>?"}, {"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1432136073, "post_id": 30354113, "comment_id": 48800678, "body": "Oops, I misunderstood how raw_storage_iterator works. Sorry."}, {"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1432136253, "post_id": 30354113, "comment_id": 48800819, "body": "Output iterators may have no useful information in <code>iterator_traits</code> but the iterator category. However, <code>T</code> could be deduced from the return type of <code>operator&amp;</code> applied to the return type of <code>operator*</code> I think."}, {"owner": {"reputation": 13218, "user_id": 1348273, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/IYjFG.jpg?s=128&g=1", "display_name": "Lingxi", "link": "https://stackoverflow.com/users/1348273/lingxi"}, "reply_to_user": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1432136698, "post_id": 30354113, "comment_id": 48801147, "body": "@dyp Interesting point. I think it actually answers the question to some degree."}, {"owner": {"reputation": 13218, "user_id": 1348273, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/IYjFG.jpg?s=128&g=1", "display_name": "Lingxi", "link": "https://stackoverflow.com/users/1348273/lingxi"}, "reply_to_user": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 1, "creation_date": 1432136845, "post_id": 30354113, "comment_id": 48801263, "body": "@dyp <code>std::raw_storage_iterator</code> is a pre-C++11 thing. And without the <code>decltype</code> C++11 keyword, there seems no direct way to provide such a make function."}, {"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "reply_to_user": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1432136981, "post_id": 30354113, "comment_id": 48801358, "body": "@dyp Ahh, alright. TIL. :)"}, {"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "reply_to_user": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1432137753, "post_id": 30354113, "comment_id": 48801860, "body": "@dyp I have an answer that stole your suggestion, can I post it?"}], "answers": [{"comments": [{"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "reply_to_user": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1432138265, "post_id": 30354909, "comment_id": 48802226, "body": "@dyp Wait, I just realizedsomething strange (I&#39;m probably just being blind again). Is <code>OutputIterator</code> required to be a class by my quote? Or could that paragraph be referring to builtin <code>operator*</code>?"}, {"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1432138471, "post_id": 30354909, "comment_id": 48802376, "body": "There seem to be several occurrences of <code>operator</code> (in the library part) that can include built-ins."}, {"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "reply_to_user": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1432138504, "post_id": 30354909, "comment_id": 48802394, "body": "@dyp Yeah, apparently <code>operator*</code> is used for both member functions and the builtin ones, in other sections as well."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1432143196, "post_id": 30354909, "comment_id": 48805110, "body": "The requirement that <code>&amp;</code> works looks like a defect. Compare <a href=\"http://cplusplus.github.io/LWG/lwg-active.html#2433\" rel=\"nofollow noreferrer\">LWG 2433</a>."}], "tags": [], "owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "is_accepted": true, "score": 2, "last_activity_date": 1432138183, "last_edit_date": 1432138183, "creation_date": 1432137922, "answer_id": 30354909, "question_id": 30354113, "link": "https://stackoverflow.com/questions/30354113/why-there-is-no-stdmake-raw-storage-iterator/30354909#30354909", "title": "Why there is no std::make_raw_storage_iterator?", "body": "<p>With @dyps suggestions, a sensible implementation is indeed possible:</p>\n\n<pre><code>template &lt;typename OutputIt&gt;\nauto make_raw_storage_iterator( OutputIt out ) {\n    return std::raw_storage_iterator&lt;OutputIt, std::remove_pointer_t&lt;decltype(&amp;*out)&gt;&gt;(out);\n}\n</code></pre>\n\n<p>(<a href=\"http://coliru.stacked-crooked.com/a/09bf337ea68ace62\" rel=\"nofollow\"><strong>Demo</strong></a> with cppreference's example)<br>\nThis is guaranteed to work since \u00a720.7.10/1, which imposes requirements for the template arguments of <code>raw_storage_iterator</code>, mandates that:</p>\n\n<blockquote>\n  <p><code>OutputIterator</code> is required to have its <code>operator*</code> return an object for\n  which <code>operator&amp;</code> is defined and returns a pointer to <code>T</code> [..]</p>\n</blockquote>\n\n<p>Where <code>T</code> is the second argument, the value type of the output range. So, given the underlying output iterator, we have enough information to determine the intended specialization of <code>raw_storage_iterator</code>.</p>\n\n<p>The reason this has not been proposed is assuredly not more than an oversight - consider that <code>make_reverse_iterator</code> or even <code>make_unique</code> have not been provided before C++14, either. Feel free to take the first step.</p>\n"}], "owner": {"reputation": 13218, "user_id": 1348273, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/IYjFG.jpg?s=128&g=1", "display_name": "Lingxi", "link": "https://stackoverflow.com/users/1348273/lingxi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 30354909, "answer_count": 1, "score": 3, "last_activity_date": 1432138183, "creation_date": 1432135810, "question_id": 30354113, "link": "https://stackoverflow.com/questions/30354113/why-there-is-no-stdmake-raw-storage-iterator", "title": "Why there is no std::make_raw_storage_iterator?", "body": "<p>I'm wondering why <code>std::raw_storage_iterator</code> does not have an accompanying <code>std::make_raw_storage_iterator</code> like <code>std::move_iterator</code> and <code>std::make_move_iterator</code>. The <code>std::raw_storage_iterator</code> class template has two template parameters. So I think it is actually more useful to provide a make function for <code>std::raw_storage_iterator</code> than <code>std::move_iterator</code> which only has a single template parameter to specify.</p>\n"}, {"tags": ["c++", "pointers", "function-pointers"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 2, "creation_date": 1432135848, "post_id": 30354108, "comment_id": 48800548, "body": "Why use pointers at all, instead of the things they point to?"}, {"owner": {"reputation": 235784, "user_id": 673730, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d1e4893fe7a566e6e4b90876b642163?s=128&d=identicon&r=PG", "display_name": "Luchian Grigore", "link": "https://stackoverflow.com/users/673730/luchian-grigore"}, "edited": false, "score": 0, "creation_date": 1432136139, "post_id": 30354108, "comment_id": 48800733, "body": "Can you show us the two codes?"}, {"owner": {"reputation": 381, "user_id": 2073037, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/880f43a5943a3edc94b799f4d4a4ce4b?s=128&d=identicon&r=PG", "display_name": "p0llard", "link": "https://stackoverflow.com/users/2073037/p0llard"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1432136260, "post_id": 30354108, "comment_id": 48800824, "body": "@juanchopanza I realise that is probably a rhetorical question, but why indeed? I read somewhere (can&#39;t remember where) that many C++ programmers feel they are over used, and they should only be used when they simply must be (eg. during dynamic memory allocation) - I don&#39;t see how they must be used in this case."}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1432136422, "post_id": 30354108, "comment_id": 48800935, "body": "@jdp407 Take a look for example at <code>quicksort</code> in C (of course in C++ you should use <code>std::sort</code> instead). It is using a function pointer as the comparator what makes it general, since it allows passing your custom comparator. How else would you write it? You cannot hardcode the comparator function into the library <code>quicksort</code>. I guess in C++ you can pass a function as a template."}, {"owner": {"reputation": 381, "user_id": 2073037, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/880f43a5943a3edc94b799f4d4a4ce4b?s=128&d=identicon&r=PG", "display_name": "p0llard", "link": "https://stackoverflow.com/users/2073037/p0llard"}, "reply_to_user": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1432136568, "post_id": 30354108, "comment_id": 48801047, "body": "@vsoftco I see where you are coming from, but say you have defined a function (your comparator), can you not simply pass the function name, as opposed to a pointer to the function? In this case it would not work, as std::sort expects a pointer, but why does it work this way?"}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1432136619, "post_id": 30354108, "comment_id": 48801087, "body": "@jdp407 you pass indeed the function name (which decays to a function pointer), but the function that accepts it must define its parameter as a function pointer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1432136648, "post_id": 30354108, "comment_id": 48801105, "body": "@jdp407 Function names only exist for the compiler and the linker. The processor has no idea what a function name is, only which address the current instruction is. This address is stored in a register that&#39;s often named &quot;the instruction pointer&quot;."}, {"owner": {"reputation": 4991, "user_id": 4340578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75589faf097f9308a448ffe021defd1?s=128&d=identicon&r=PG&f=1", "display_name": "ElderBug", "link": "https://stackoverflow.com/users/4340578/elderbug"}, "edited": false, "score": 4, "creation_date": 1432136901, "post_id": 30354108, "comment_id": 48801303, "body": "To be clear, you can&#39;t pass a function. When you pass <code>my_func</code>, you actually pass the pointer. It&#39;s always a function pointer, everywhere. There are things like lambdas and std::function, but that&#39;s a completely different thing."}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 1, "creation_date": 1432136974, "post_id": 30354108, "comment_id": 48801354, "body": "@jdp407 In the standard (I cannot find right now where exactly) it is specified that function parameters decay to function pointers, same as <code>void f(int arr[256])</code>, which is syntactic sugar for <code>void f(int* arr)</code>"}, {"owner": {"reputation": 381, "user_id": 2073037, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/880f43a5943a3edc94b799f4d4a4ce4b?s=128&d=identicon&r=PG", "display_name": "p0llard", "link": "https://stackoverflow.com/users/2073037/p0llard"}, "reply_to_user": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1432137079, "post_id": 30354108, "comment_id": 48801420, "body": "@vsoftco In that case, why doesn&#39;t the function to which you are passing the pointer have to accept a pointer as an argument? If you look at the code I&#39;ve posted, the function <code>runprint</code> is accepting a function as an argument, not a pointer."}, {"owner": {"reputation": 94195, "user_id": 410767, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c1dd4727d07c7dbb6ff8c3a83e400b5?s=128&d=identicon&r=PG", "display_name": "Tony Delroy", "link": "https://stackoverflow.com/users/410767/tony-delroy"}, "edited": false, "score": 0, "creation_date": 1432137151, "post_id": 30354108, "comment_id": 48801473, "body": "@jdp407: for your code the difference might be subtle - you&#39;re calling <code>runprint</code> and it&#39;s using the passed-in function straight away - but try to <i>store</i> the function in a variable so you can call it <i>at any arbitrary later time</i> and you&#39;ll see what pointers to functions are useful for. That said, as of C++11 there&#39;s a <code>std::function&lt;&gt;</code> type that hides and manages and generally cleans up use of function pointers for you."}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "reply_to_user": {"reputation": 4991, "user_id": 4340578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75589faf097f9308a448ffe021defd1?s=128&d=identicon&r=PG&f=1", "display_name": "ElderBug", "link": "https://stackoverflow.com/users/4340578/elderbug"}, "edited": false, "score": 0, "creation_date": 1432137266, "post_id": 30354108, "comment_id": 48801542, "body": "@ElderBug is it reference to function or pointer to function? I seem to have mixed them up."}, {"owner": {"reputation": 381, "user_id": 2073037, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/880f43a5943a3edc94b799f4d4a4ce4b?s=128&d=identicon&r=PG", "display_name": "p0llard", "link": "https://stackoverflow.com/users/2073037/p0llard"}, "reply_to_user": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1432137277, "post_id": 30354108, "comment_id": 48801548, "body": "@vsoftco So if the &#39;non-pointer&#39; form is translated to a pointer, why use the pointer form at all - is there some advantage?"}, {"owner": {"reputation": 4991, "user_id": 4340578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75589faf097f9308a448ffe021defd1?s=128&d=identicon&r=PG&f=1", "display_name": "ElderBug", "link": "https://stackoverflow.com/users/4340578/elderbug"}, "edited": false, "score": 0, "creation_date": 1432137422, "post_id": 30354108, "comment_id": 48801634, "body": "@jdp407 It&#39;s the same thing for pointers and references, many times you can use reference, sometimes you need pointers (for example, when it can be null). Google a bit about reference vs pointer usage, you might find what you want."}, {"owner": {"reputation": 381, "user_id": 2073037, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/880f43a5943a3edc94b799f4d4a4ce4b?s=128&d=identicon&r=PG", "display_name": "p0llard", "link": "https://stackoverflow.com/users/2073037/p0llard"}, "reply_to_user": {"reputation": 94195, "user_id": 410767, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c1dd4727d07c7dbb6ff8c3a83e400b5?s=128&d=identicon&r=PG", "display_name": "Tony Delroy", "link": "https://stackoverflow.com/users/410767/tony-delroy"}, "edited": false, "score": 0, "creation_date": 1432137573, "post_id": 30354108, "comment_id": 48801744, "body": "@TonyD So if I want to access the function outside the scope of the function it was passed to, I must use a function pointer? Can you give an example of when this might be required? Presumable it would require the function declaring"}, {"owner": {"reputation": 94195, "user_id": 410767, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c1dd4727d07c7dbb6ff8c3a83e400b5?s=128&d=identicon&r=PG", "display_name": "Tony Delroy", "link": "https://stackoverflow.com/users/410767/tony-delroy"}, "edited": false, "score": 0, "creation_date": 1432139844, "post_id": 30354108, "comment_id": 48803234, "body": "@jdp407 Example: <code>struct MyObject { void setLogFn(void (*log_fn)(const char*)) { log_fn_ = log_fn; } void doStuff() { log_fn_(&quot;starting to do stuff...&quot;); } void (*log_fn_)(const char*); };</code> - with this interface and usage, the code creating/using/calling <code>MyObject</code> can specify its own logging function to receive the <code>MyObject</code> logging strings, and discard or render them however it sees fit."}], "answers": [{"comments": [{"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1432410627, "post_id": 30354961, "comment_id": 48919835, "body": "I&#39;d add <code>cout &lt;&lt; typeid(add).name() &lt;&lt; endl;</code> and ``cout &lt;&lt; typeid(&amp;add).name() &lt;&lt; endl;` for comparison, it shows that GCC does make a distinction between a function and a function pointer. The parameter to <code>runprint()</code> is a function pointer though, in spite of the missing pointer syntax."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1432454196, "post_id": 30354961, "comment_id": 48928232, "body": "@UlrichEckhardt Yes, I noticed that, too. I also noticed that there is a difference between &amp;f, &amp;&amp;f etc, different to what I thought (until I thought a little harder). I had a hard time not only to understand the standard (that wouldn&#39;t be too surprising), but even to find relevant wording. (Probably because the mainstream case of just having a function name is not the only way to have something callable.)"}], "tags": [], "owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1432138071, "creation_date": 1432138071, "answer_id": 30354961, "question_id": 30354108, "link": "https://stackoverflow.com/questions/30354108/why-must-function-pointers-be-used/30354961#30354961", "title": "Why must function pointers be used?", "body": "<p><code>function</code> is considered a function pointer by g++:</p>\n\n<pre><code>$ cat fp.cpp\n#include &lt;typeinfo&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nint add(int x) {\n        return ++x; //this is a copy, so it doesn't touch x\n}\n\nvoid runprint(int function(int x), int x) {\n        cout &lt;&lt; typeid(function).name() &lt;&lt; endl;\n        int (*f)(int);  // function pointer compatible with function argument\n        f = function;\n        cout &lt;&lt; typeid(f).name() &lt;&lt; endl;\n        cout &lt;&lt; function(x) &lt;&lt; endl;\n}\n\n\nint main() {\n        runprint(add, 1);\n\n        return 0;\n}\n$ g++ -Wall -std=c++11 -o fp fp.cpp\n$ ./fp\nPFiiE\nPFiiE\n2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 2, "creation_date": 1432138311, "post_id": 30355017, "comment_id": 48802254, "body": "Functions are identical to pointers to functions in a similar way to arrays being identical to pointers. (They&#39;re related, but not identical.)"}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "reply_to_user": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 1, "creation_date": 1432138436, "post_id": 30355017, "comment_id": 48802343, "body": "I don&#39;t remember right now any case in which they would be different. The array/pointer difference matters inside <code>sizeof</code>, but functions don&#39;t have <code>sizeof</code>. I guess the function and pointer to function <i>type</i> would be considered different in a <code>template</code>, but it&#39;s pretty far from the topic here..."}, {"owner": {"reputation": 381, "user_id": 2073037, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/880f43a5943a3edc94b799f4d4a4ce4b?s=128&d=identicon&r=PG", "display_name": "p0llard", "link": "https://stackoverflow.com/users/2073037/p0llard"}, "edited": false, "score": 0, "creation_date": 1432138450, "post_id": 30355017, "comment_id": 48802359, "body": "Thank you very much - what I was missing was that the decay also occurred when defining the parameter, and so the parameter doesn&#39;t have  to be an explicit function pointer."}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1432138492, "post_id": 30355017, "comment_id": 48802390, "body": "@anatolyg how about the &quot;address-of&quot; (<code>&amp;</code>) operator? If you take <code>&amp;some_func</code>, the type of the result will be a pointer-to-function, and <b>not</b> a pointer-to-pointer-to-function (which would be the case if functions and function pointers were identical, which they aren&#39;t.)"}, {"owner": {"reputation": 381, "user_id": 2073037, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/880f43a5943a3edc94b799f4d4a4ce4b?s=128&d=identicon&r=PG", "display_name": "p0llard", "link": "https://stackoverflow.com/users/2073037/p0llard"}, "edited": false, "score": 0, "creation_date": 1432138584, "post_id": 30355017, "comment_id": 48802438, "body": "In that case, if functions decay to function pointers, when would one ever use &#39;just a function pointer&#39;, if the two are syntactically equivalent?"}, {"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1432138591, "post_id": 30355017, "comment_id": 48802445, "body": "1) There can be references to functions. 2) The distinction of function types vs the types of pointers-to-functions are important e.g. in metaprogramming. 3) IIRC, C decays all functions before calling to pointers, whereas C++ implicitly dereferences pointers-to-funtions to get the function they&#39;re pointing to. 4) Member functions are significantly different to pointers to functions. 5) Pointers to functions can be null, functions themselves cannot be null. 6) Function names can refer to overload sets."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1432138705, "post_id": 30355017, "comment_id": 48802519, "body": "Functions and function pointers differ in that you can&#39;t take the <code>sizeof</code> a function but you may well take the size of a function pointer. Calling them equivalent or even equal seems fishy to me. The fact that you can call a function through a pointer without explicitly dereferencing it or that you get the address without explicitly requesting it makes this consistently fishy with the language. Oh well, such is life, let&#39;s move on."}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "reply_to_user": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1432138925, "post_id": 30355017, "comment_id": 48802644, "body": "@UlrichEckhardt the &quot;let&#39;s move on&quot; attitude is <b>entirely inappropriate</b> when educating a beginner about a language feature. Let&#39;s not use <b>lies</b> to introduce programmers to advanced parts of the language, just because &quot;it&#39;s convenient&quot; (or because the author of the answer doesn&#39;t know better)."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "reply_to_user": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1432140016, "post_id": 30355017, "comment_id": 48803340, "body": "@TheParamagneticCroissant (and others) please see <a href=\"http://stackoverflow.com/q/26559758/509868\">this</a>"}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1432140188, "post_id": 30355017, "comment_id": 48803447, "body": "@anatolyg how is that question relevant? it&#39;s about that a seemingly function-type parameter <b>in a function parameter declaration list</b> is treated as an argument of type pointer-to-function. It has nothing to do with a function decaying to a function pointer when passed as a function parameter."}, {"owner": {"reputation": 381, "user_id": 2073037, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/880f43a5943a3edc94b799f4d4a4ce4b?s=128&d=identicon&r=PG", "display_name": "p0llard", "link": "https://stackoverflow.com/users/2073037/p0llard"}, "edited": false, "score": 1, "creation_date": 1432140346, "post_id": 30355017, "comment_id": 48803561, "body": "@anatolyg &quot;why does everyone declare callbacks using a pointer-to-function syntax, when a function syntax would be sufficient?&quot; - that is indeed my question: I didn&#39;t realise that the two things were equivalent, and thought there was some case when one could only use pointer-to-function syntax."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "reply_to_user": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1432140396, "post_id": 30355017, "comment_id": 48803588, "body": "@TheParamagneticCroissant A function-type parameter <b>in a function parameter declaration list</b> is (also) what OP was talking about (IMHO)."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1432141001, "post_id": 30355017, "comment_id": 48803959, "body": "@TheParamagneticCroissant: Re &quot;If you take &amp;some_func, the type of the result will be a pointer-to-function, and not a pointer-to-pointer-to-function (which would be the case if functions and function pointers were identical)&quot; -- regarding the types you are right, but the reason is just the other way round. functions and function pointers are exchangeable to a larger extent than arrays and pointers to their first element: In <code>int arr[10]; int *ip = arr; int (*arrp)[10];</code>, <b><code>ip</code> and <code>arrp</code> have different types, because <code>arr</code> and <code>&amp;arr</code> have <i>different</i> types</b> (but the same value ;-) )."}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1432141127, "post_id": 30355017, "comment_id": 48804015, "body": "@PeterSchneider &quot;functions and function pointers are exchangeable to a larger extent than arrays and pointers&quot; \u2013 that&#39;s possible, but just as irrelevant. They are <b>still not identical,</b> that&#39;s all I&#39;m saying."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1432187448, "post_id": 30355017, "comment_id": 48822050, "body": "You know, @Paramagnetic, telling a <i>beginner</i> to accept and ignore certain things for now is a very pragmatic approach, in particular if the thing in question itself is inconsistent. Further, you seem to have implicitly called me a liar, was that your intention? If so, please say with which statement I did so. That said, the rest of your response shows to me that you didn&#39;t understand what I wanted to express. While you could blame my imprecise wording, I can still blame you for guessing in face of ambiguity."}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "reply_to_user": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1432202209, "post_id": 30355017, "comment_id": 48830933, "body": "@UlrichEckhardt it seems to me you are using the &quot;it&#39;s pragmatic&quot; argument as an excuse for explaining a feature incorrectly. I&#39;m not convinced. &quot;the rest of your response shows to me that you didn&#39;t understand what I wanted to express&quot; \u2013 I did, I simply disagree with you."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "reply_to_user": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1432232602, "post_id": 30355017, "comment_id": 48852206, "body": "I did not excuse exlaining a feature incorrectly, @TheParamagneticCroissant. Question is whether you misrepresented what I said intentionally (then <i>you</i> are actually a liar) or that once more you didn&#39;t understand what I said (then you are just lying to yourself, which would still be a pity)."}], "tags": [], "owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "is_accepted": true, "score": 1, "last_activity_date": 1432139187, "last_edit_date": 1432139187, "creation_date": 1432138188, "answer_id": 30355017, "question_id": 30354108, "link": "https://stackoverflow.com/questions/30354108/why-must-function-pointers-be-used/30355017#30355017", "title": "Why must function pointers be used?", "body": "<h1>TL; DR</h1>\n\n<p>\"Function\" and \"pointer to function\" is the same.</p>\n\n<hr>\n\n<p>There is the concept of a pointer, and the syntax of its usage; it's not clear what you are asking about.</p>\n\n<h1>Concept</h1>\n\n<p>A pointer to a function may be different from the function itself (the difference is not useful in c++ - see below) in that a function may occupy much space - its code can be arbitrarily complex. Manipulating (e.g. copying or searching/modifying) the code of a function is rarely useful, so c/c++ don't support it at all. If you want to modify the code of a function, cast a pointer to <code>char*</code>, applying all the necessary precautions (I have never done it).</p>\n\n<p>So if you are writing C, all you need is pointers to functions.</p>\n\n<p>However...</p>\n\n<h1>Syntax</h1>\n\n<p>If you have a pointer <code>p</code> to a function, how do you want to call the function?</p>\n\n<pre><code>(*p)(18); // call the function with parameter 18\np(18); // the same, but looks better!\n</code></pre>\n\n<p>There is the slightly cleaner syntax not involving the <code>*</code> sign. To support it, the authors of c/c++ invented the concept of \"decay\" - when your code mentions \"a function\", the compiler silently \"corrects\" it to mean \"a pointer to a function\" instead (in almost all circumstances; excuse me for not detailing further). This is very similar to the \"decay\" of an array to a pointer mentioned by vsoftco.</p>\n\n<p>So in your example</p>\n\n<pre><code>void runprint(int function(int x), int x) {\n        cout &lt;&lt; function(x) &lt;&lt; endl;\n}\n</code></pre>\n\n<p>the \"function\" type is actually a \"pointer to function\" type. Indeed, if you try to \"overload\":</p>\n\n<pre><code>void runprint(int (*function)(int x), int x) {\n        cout &lt;&lt; function(x) &lt;&lt; endl;\n}\n</code></pre>\n\n<p>the compiler will complain about two identical functions with identical set of parameters.</p>\n\n<p>Also, when making a variable of a function / pointer-to-function type</p>\n\n<pre><code>runprint(add, 1);\n</code></pre>\n\n<p>it also doesn't matter:</p>\n\n<pre><code>runprint(&amp;add, 1); // does exactly the same\n</code></pre>\n\n<hr>\n\n<p>P.S. When declaring a function that receives a callback, I have mostly seen (and used) the explicitly written pointer. It has only now occurred to me that it's inconsistent to rely on function-to-pointer decay when calling the callback, but not when declaring my code. So if the question is</p>\n\n<blockquote>\n  <p>why does everyone declare callbacks using a pointer-to-function syntax, when a function syntax would be sufficient?</p>\n</blockquote>\n\n<p>I'd answer \"a matter of habit\".</p>\n"}], "owner": {"reputation": 381, "user_id": 2073037, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/880f43a5943a3edc94b799f4d4a4ce4b?s=128&d=identicon&r=PG", "display_name": "p0llard", "link": "https://stackoverflow.com/users/2073037/p0llard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "accepted_answer_id": 30355017, "answer_count": 2, "score": 1, "last_activity_date": 1432139211, "creation_date": 1432135798, "last_edit_date": 1432136893, "question_id": 30354108, "link": "https://stackoverflow.com/questions/30354108/why-must-function-pointers-be-used", "title": "Why must function pointers be used?", "body": "<p>What is the need for function pointers? The standard answer for this seems to be callbacks, but why can't we just pass a function?</p>\n\n<p>The book I was reading on C++ demonstrates passing a function as a parameter, and acknowledges that in actual fact the compiled turns this into a function pointer and passes that instead, because functions are not actual objects. It showed the equivalent code using function pointers, which was slightly more complex - if the code is equivalent, why bother to use a function pointer.</p>\n\n<p>I presume there is a case when is simply isn't possible to pass the function, and one must pass a pointer instead? Can someone give me an example of this case, as it would help me understand why function pointers are useful.</p>\n\n<p>Consider the following code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint add(int x) {\n        return ++x; //this is a copy, so it doesn't touch x\n}\n\nvoid runprint(int function(int x), int x) {\n        cout &lt;&lt; function(x) &lt;&lt; endl;\n}\n\n\nint main() {\n        runprint(add, 1);\n\n        return 0;\n}\n</code></pre>\n\n<p>We are passing a function as a parameter, not a pointer. The function accepting the function (!), is not accepting a pointer.</p>\n"}, {"tags": ["c++", "algorithm", "c++11", "optimization", "bit-shift"], "comments": [{"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 12, "creation_date": 1432135384, "post_id": 30353910, "comment_id": 48800200, "body": "How much of a bottleneck did your benchmarks show these &quot;useless invocations of min&quot; to be?"}, {"owner": {"reputation": 2420, "user_id": 410342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af5f0b031000821a8c179733db0a2f9e?s=128&d=identicon&r=PG", "display_name": "Shotgun Ninja", "link": "https://stackoverflow.com/users/410342/shotgun-ninja"}, "edited": false, "score": 2, "creation_date": 1432135404, "post_id": 30353910, "comment_id": 48800223, "body": "First off, why is this optimization necessary at this point?"}, {"owner": {"reputation": 457352, "user_id": 87234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FkjBe.png?s=128&g=1", "display_name": "GManNickG", "link": "https://stackoverflow.com/users/87234/gmannickg"}, "edited": false, "score": 3, "creation_date": 1432136080, "post_id": 30353910, "comment_id": 48800685, "body": "It&#39;s extraordinarily doubtful you shaved off a useless invocation of min, because your compiler would have inlined it anyway. Do you have any profiling results showing it made a difference? You don&#39;t optimize things by guessing at which operations are taking place and guessing further how long each one takes. You just need to measure it (don&#39;t forget to compile with optimizations on!). Look at the generated assembly to see if you&#39;ve even made a difference."}, {"owner": {"reputation": 351, "user_id": 4905335, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ba66eb8a28b943066353287470184fc8?s=128&d=identicon&r=PG&f=1", "display_name": "user4905335", "link": "https://stackoverflow.com/users/4905335/user4905335"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1432138209, "post_id": 30353910, "comment_id": 48802189, "body": "@Borgleader As far as I know, there is no bottleneck in my program at large"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 1, "creation_date": 1432228110, "post_id": 30353910, "comment_id": 48849533, "body": "One thing to note is that I think you&#39;re looking at execution time in a human-intuitive way, and unfortunately it&#39;s usually not so intuitive. For example, min/max often translate to branchless assembly code just twiddling bits around or, at worst, a conditional move (which doesn&#39;t suffer from the possibility of branch misprediction). It might seem faster to just use if/else here and avoid the redundant logic, but you might be trading much more expensive non-redundant logic for very cheap redundant logic which actually makes things worse."}], "answers": [{"comments": [{"owner": {"reputation": 351, "user_id": 4905335, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ba66eb8a28b943066353287470184fc8?s=128&d=identicon&r=PG&f=1", "display_name": "user4905335", "link": "https://stackoverflow.com/users/4905335/user4905335"}, "edited": false, "score": 0, "creation_date": 1432135959, "post_id": 30354052, "comment_id": 48800606, "body": "Nice! That&#39;s a total of 1 comparison, 1 subtraction and 3 assignments. Better than what I could come up with."}, {"owner": {"reputation": 22202, "user_id": 696391, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VrUwT.jpg?s=128&g=1", "display_name": "samgak", "link": "https://stackoverflow.com/users/696391/samgak"}, "reply_to_user": {"reputation": 351, "user_id": 4905335, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ba66eb8a28b943066353287470184fc8?s=128&d=identicon&r=PG&f=1", "display_name": "user4905335", "link": "https://stackoverflow.com/users/4905335/user4905335"}, "edited": false, "score": 1, "creation_date": 1432137048, "post_id": 30354052, "comment_id": 48801397, "body": "No jumps (compiler and processor willing) and no function calls either. I hope you profile each of these potential solutions, I&#39;m curious to know which is actually faster for you."}], "tags": [], "owner": {"reputation": 22202, "user_id": 696391, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VrUwT.jpg?s=128&g=1", "display_name": "samgak", "link": "https://stackoverflow.com/users/696391/samgak"}, "is_accepted": false, "score": 4, "last_activity_date": 1432135631, "creation_date": 1432135631, "answer_id": 30354052, "question_id": 30353910, "link": "https://stackoverflow.com/questions/30353910/is-it-possible-to-micro-optimize-x-maxa-b-y-mina-b/30354052#30354052", "title": "Is it possible to micro-optimize &quot;x = max(a,b); y = min(a,b);&quot;?", "body": "<p>How about:</p>\n\n<pre><code>int largestIndex = arr[1] &gt; arr[0];\nint largest = arr[largestIndex];\nint secondLargest = arr[1 - largestIndex];\n</code></pre>\n\n<p>The first line relies on an implicit cast of a boolean result to 1 in the case of true and 0 in the case of false.</p>\n"}, {"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 10, "last_activity_date": 1432136913, "last_edit_date": 1432136913, "creation_date": 1432135842, "answer_id": 30354124, "question_id": 30353910, "link": "https://stackoverflow.com/questions/30353910/is-it-possible-to-micro-optimize-x-maxa-b-y-mina-b/30354124#30354124", "title": "Is it possible to micro-optimize &quot;x = max(a,b); y = min(a,b);&quot;?", "body": "<p>In C++, you can use <a href=\"http://en.cppreference.com/w/cpp/algorithm/minmax\"><code>std::minmax</code></a> to produce a <code>std::pair</code> of the minimum and the maximum. This is particularly easy in combination with <a href=\"http://en.cppreference.com/w/cpp/utility/tuple/tie\"><code>std::tie</code></a>:</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;utility&gt;\n\nint largest, secondLargest;\nstd::tie(secondLargest, largest) = std::minmax(arr[0], arr[1]);\n</code></pre>\n\n<p>GCC, at least, is capable of optimizing the call to minmax into a single comparison, identical to the result of the C code below.</p>\n\n<p>In C, you could write the test out yourself:</p>\n\n<pre><code>int largest, secondLargest;\nif (arr[0] &lt; arr[1]) {\n  largest = arr[1];\n  secondLargest = arr[0];\n} else {\n  largest = arr[0];\n  secondLargest = arr[1];\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 0, "creation_date": 1432141045, "post_id": 30354143, "comment_id": 48803978, "body": "<code>std::minmax_element</code> returns a pair of iterators, not values. You need to dereference them if you want to output the results."}, {"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 0, "creation_date": 1432144774, "post_id": 30354143, "comment_id": 48806065, "body": "It&#39;s true that <code>std::minmax</code> returns a pair of <code>const T&amp;</code> (I don&#39;t know why you just said &quot;references to iterators&quot;). The code in your answer uses <code>std::minmax_element</code> which is a completely different function."}, {"owner": {"reputation": 11342, "user_id": 1144157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d05077a347e63679d43bfbdaf5e7b9ab?s=128&d=identicon&r=PG", "display_name": "Steephen", "link": "https://stackoverflow.com/users/1144157/steephen"}, "reply_to_user": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 0, "creation_date": 1432145052, "post_id": 30354143, "comment_id": 48806229, "body": "@Blastfurnace Oh confused, and corrected the answer. Thanks to identify it!!"}], "tags": [], "owner": {"reputation": 11342, "user_id": 1144157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d05077a347e63679d43bfbdaf5e7b9ab?s=128&d=identicon&r=PG", "display_name": "Steephen", "link": "https://stackoverflow.com/users/1144157/steephen"}, "is_accepted": false, "score": 4, "last_activity_date": 1432145018, "last_edit_date": 1432145018, "creation_date": 1432135872, "answer_id": 30354143, "question_id": 30353910, "link": "https://stackoverflow.com/questions/30353910/is-it-possible-to-micro-optimize-x-maxa-b-y-mina-b/30354143#30354143", "title": "Is it possible to micro-optimize &quot;x = max(a,b); y = min(a,b);&quot;?", "body": "<p>If your intention is to reduce the function call to find min mad max you can try <code>std::minmax_element</code>. This is available since C++11.</p>\n\n<pre><code>auto result = std::minmax_element(arr, arr+n);\nstd::cout&lt;&lt; \"min:\"&lt;&lt; *result.first&lt;&lt;\"\\n\";\nstd::cout&lt;&lt; \"max :\" &lt;&lt;*result.second &lt;&lt; \"\\n\";\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8876, "user_id": 1545171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TiAiM.jpg?s=128&g=1", "display_name": "DrKoch", "link": "https://stackoverflow.com/users/1545171/drkoch"}, "is_accepted": false, "score": 3, "last_activity_date": 1432136002, "creation_date": 1432136002, "answer_id": 30354182, "question_id": 30353910, "link": "https://stackoverflow.com/questions/30353910/is-it-possible-to-micro-optimize-x-maxa-b-y-mina-b/30354182#30354182", "title": "Is it possible to micro-optimize &quot;x = max(a,b); y = min(a,b);&quot;?", "body": "<p>If you just want to find the bigger of two values go:</p>\n\n<pre><code>if(a &gt; b)\n{\n    largest = a;\n    second = b;\n}\nelse\n{\n     largest = b;\n     second = a;\n}\n</code></pre>\n\n<p>No function calls, one comparison, two assignments.</p>\n"}, {"tags": [], "owner": {"reputation": 71857, "user_id": 47453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412dc332ab3593c636e5a5202cf98870?s=128&d=identicon&r=PG", "display_name": "Bill Lynch", "link": "https://stackoverflow.com/users/47453/bill-lynch"}, "is_accepted": false, "score": 4, "last_activity_date": 1432136879, "last_edit_date": 1432136879, "creation_date": 1432136044, "answer_id": 30354210, "question_id": 30353910, "link": "https://stackoverflow.com/questions/30353910/is-it-possible-to-micro-optimize-x-maxa-b-y-mina-b/30354210#30354210", "title": "Is it possible to micro-optimize &quot;x = max(a,b); y = min(a,b);&quot;?", "body": "<p>I'm going to assume that you'd rather solve the larger problem... That is, getting the sum of the largest two numbers in an array.</p>\n\n<p>What you are trying to do is a <a href=\"http://en.cppreference.com/w/cpp/algorithm/partial_sort\" rel=\"nofollow\"><code>std::partial_sort()</code></a>.\nLet's implement it.</p>\n\n<pre><code>int sumLargest2(int * arr, size_t n) {\n    int * first  = arr;\n    int * middle = arr + 2;\n    int * last   = arr + n;\n\n    std::partial_sort(first, middle, last, std::greater&lt;int&gt;());\n\n    return arr[0] + arr[1];\n}\n</code></pre>\n\n<p>And if you're unable to modify <code>arr</code>, then I'd recommend looking into <a href=\"http://en.cppreference.com/w/cpp/algorithm/partial_sort_copy\" rel=\"nofollow\"><code>std::partial_sort_copy()</code></a>.</p>\n"}, {"comments": [{"owner": {"reputation": 71857, "user_id": 47453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412dc332ab3593c636e5a5202cf98870?s=128&d=identicon&r=PG", "display_name": "Bill Lynch", "link": "https://stackoverflow.com/users/47453/bill-lynch"}, "edited": false, "score": 0, "creation_date": 1432136392, "post_id": 30354291, "comment_id": 48800912, "body": "There already exists a <a href=\"http://en.cppreference.com/w/cpp/algorithm/minmax\" rel=\"nofollow noreferrer\"><code>std::minmax</code></a> that looks pretty similar to what you&#39;ve written."}, {"owner": {"reputation": 343, "user_id": 3576110, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SHI6S.jpg?s=128&g=1", "display_name": "Achilles Rasquinha", "link": "https://stackoverflow.com/users/3576110/achilles-rasquinha"}, "reply_to_user": {"reputation": 71857, "user_id": 47453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412dc332ab3593c636e5a5202cf98870?s=128&d=identicon&r=PG", "display_name": "Bill Lynch", "link": "https://stackoverflow.com/users/47453/bill-lynch"}, "edited": false, "score": 0, "creation_date": 1432137107, "post_id": 30354291, "comment_id": 48801445, "body": "Yes it is. OP has tagged C++, not C++11."}], "tags": [], "owner": {"reputation": 343, "user_id": 3576110, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SHI6S.jpg?s=128&g=1", "display_name": "Achilles Rasquinha", "link": "https://stackoverflow.com/users/3576110/achilles-rasquinha"}, "is_accepted": false, "score": 2, "last_activity_date": 1432632976, "last_edit_date": 1432632976, "creation_date": 1432136255, "answer_id": 30354291, "question_id": 30353910, "link": "https://stackoverflow.com/questions/30353910/is-it-possible-to-micro-optimize-x-maxa-b-y-mina-b/30354291#30354291", "title": "Is it possible to micro-optimize &quot;x = max(a,b); y = min(a,b);&quot;?", "body": "<p>How about a time-space trade-off?</p>\n\n<pre><code>#include &lt;utility&gt;\n\ntemplate&lt;typename T&gt;\n    std::pair&lt;T, T&gt;\n        minmax(T const&amp; a, T const&amp; b)\n        { return b &lt; a ? std::make_pair(b, a) : std::make_pair(a, b); }\n\n//main\nstd::pair&lt;int, int&gt; values = minmax(a[0], a[1]);\nint largest       = values.second;\nint secondLargest = values.first;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1432166923, "post_id": 30354415, "comment_id": 48816239, "body": "<code>y = a ^ b ^ x</code> avoids overflows."}], "tags": [], "owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "is_accepted": false, "score": 4, "last_activity_date": 1432137016, "last_edit_date": 1432137016, "creation_date": 1432136660, "answer_id": 30354415, "question_id": 30353910, "link": "https://stackoverflow.com/questions/30353910/is-it-possible-to-micro-optimize-x-maxa-b-y-mina-b/30354415#30354415", "title": "Is it possible to micro-optimize &quot;x = max(a,b); y = min(a,b);&quot;?", "body": "<pre><code>x = max(a, b);\ny = a + b - x;\n</code></pre>\n\n<p>It won't necessarily be faster, but it will be different.</p>\n\n<p>Also beware of overflows.</p>\n"}, {"tags": [], "owner": {"reputation": 27592, "user_id": 1031591, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/s3MiH.jpg?s=128&g=1", "display_name": "atlaste", "link": "https://stackoverflow.com/users/1031591/atlaste"}, "is_accepted": false, "score": 2, "last_activity_date": 1432141367, "creation_date": 1432141367, "answer_id": 30356049, "question_id": 30353910, "link": "https://stackoverflow.com/questions/30353910/is-it-possible-to-micro-optimize-x-maxa-b-y-mina-b/30356049#30356049", "title": "Is it possible to micro-optimize &quot;x = max(a,b); y = min(a,b);&quot;?", "body": "<p>I'm assuming C++...</p>\n\n<p><strong>Short answer</strong>, use std::minmax and compile with the right optimizations and the right instruction set parameters.</p>\n\n<p><strong>Long ugly answer</strong>, The compiler cannot make all the assumptions necessary to make it really, really fast. You can. In this case, you can change the algorithm to process all data first and you can force alignment on the data. Doing all this, you can use intrinsics to make it faster.</p>\n\n<p>Although I haven't tested it in this particular case, I've seen enormous performance improvements using these guidelines.        </p>\n\n<p>Since you're not passing 2 integers to the function, I'm assuming your using an array and want to iterate it somehow. You now have a choice to make: make 2 arrays and use min/max or use 1 array with both <code>a</code> and <code>b</code>. This decision alone can already influence the performance.</p>\n\n<p>If you have 2 arrays, these can be allocated on 32-byte boundaries with aligned malloc's and then processed using intrinsics. If you are going for real, raw performance - this is the way to go.</p>\n\n<p>F.ex, let's assume you have AVX2. (NOTE: I'm not sure if you do and you SHOULD check this using CPU id's!). Go to the cheat sheet here: <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/\" rel=\"nofollow\">https://software.intel.com/sites/landingpage/IntrinsicsGuide/</a> and pick your poison. </p>\n\n<p>The intrinsics you're looking for are in this case probably:</p>\n\n<ul>\n<li>_mm256_min_epi32</li>\n<li>_mm256_max_epi32</li>\n<li>_mm256_stream_load_si256</li>\n</ul>\n\n<p>If you have to do this for the entire array, you probably want to keep all the stuff in a single __mm256 register before merging the individual items. E.g.: do a min/max per 256-bit vector, and when the loop is done, extract the 32-bit items and do a min/max on that.</p>\n\n<p><strong>Long nicer answer</strong>: So ... as for the compiler. Compilers do attempt to optimize these kinds of things, but run into problems. </p>\n\n<p>If you have 2 different arrays that you process, the compiler has to know that they are different in order to be able to optimize it. This is the reason why stuff like <a href=\"https://msdn.microsoft.com/en-us/library/8bcxafdh.aspx\" rel=\"nofollow\">restrict</a> exists, which tells the compiler exactly this little thing you probably already knew while writing the code. </p>\n\n<p>Also, the compiler doesn't know your memory is aligned, so it has to check this and branch... for each call. We don't want this; which means we want it to inline its stuff. So, add <code>inline</code>, put it in a header file and that's that. You can also use <code>aligned</code> to give him a hint.</p>\n\n<p>Your compiler also didn't get the hint that the <code>int*</code> won't change over time. If it cannot change, it's a good idea to tell him that using the <code>const</code> keyword.</p>\n\n<p>A compiler uses an instruction set to do the compilation. Normally, they already use SSE, but AVX2 can help a lot (as I've shown with the intrinsics above). If you <em>can</em> compile it with those flags, make sure to use them - they help a lot.</p>\n\n<p>Run in release mode, compile with optimizations on 'fast' and see what happens under the hood. If you do all this, you should see <code>vpmax...</code> instructions appearing in the inner loops, which means that the compiler uses the intrinsics just fine.</p>\n\n<p>I don't know what else you want to do in the loop... if you use all these instructions you should hit the memory speed on big arrays.</p>\n"}], "owner": {"reputation": 351, "user_id": 4905335, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ba66eb8a28b943066353287470184fc8?s=128&d=identicon&r=PG&f=1", "display_name": "user4905335", "link": "https://stackoverflow.com/users/4905335/user4905335"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 764, "favorite_count": 1, "accepted_answer_id": 30354124, "answer_count": 8, "score": 4, "last_activity_date": 1432632976, "creation_date": 1432135275, "last_edit_date": 1432307071, "question_id": 30353910, "link": "https://stackoverflow.com/questions/30353910/is-it-possible-to-micro-optimize-x-maxa-b-y-mina-b", "title": "Is it possible to micro-optimize &quot;x = max(a,b); y = min(a,b);&quot;?", "body": "<p>I had an algorithm that started out like</p>\n\n<pre><code>int sumLargest2 ( int * arr, size_t n )\n{\n    int largest(max(arr[0], arr[1])), secondLargest(min(arr[0],arr[1])); \n    // ... \n</code></pre>\n\n<p>and I realized that the first is probably not optimal because calling <code>max</code> and then <code>min</code> is repetitious when you consider that the information required to know the minimum is already there once you've found the maximum. So I figured out that I could do</p>\n\n<pre><code>   int largest = max(arr[0], arr[1]);\n   int secondLargest = arr[0] == largest ? arr[1] : arr[0];\n</code></pre>\n\n<p>to shave off the useless invocation of <code>min</code>,  but I'm not sure that actually saves any number of operations. Are there any fancy bit-shifting algorithms that can do the equivalent of </p>\n\n<pre><code>int largest(max(arr[0], arr[1])), secondLargest(min(arr[0],arr[1]));\n</code></pre>\n\n<p>?????</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1432135349, "post_id": 30353854, "comment_id": 48800176, "body": "see: <a href=\"http://stackoverflow.com/questions/11107608/whats-wrong-with-c-wchar-t-and-wstrings-what-are-some-alternatives-to-wide\" title=\"whats wrong with c wchar t and wstrings what are some alternatives to wide\">stackoverflow.com/questions/11107608/&hellip;</a>"}, {"owner": {"reputation": 184, "user_id": 1552766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050525b6d5df7ac28609fd791d1e384d?s=128&d=identicon&r=PG", "display_name": "timato", "link": "https://stackoverflow.com/users/1552766/timato"}, "edited": false, "score": 0, "creation_date": 1432135417, "post_id": 30353854, "comment_id": 48800232, "body": "wchar should be sent to wcout.  <a href=\"http://stackoverflow.com/questions/2493785/how-i-can-print-the-wchar-t-values-to-console\" title=\"how i can print the wchar t values to console\">stackoverflow.com/questions/2493785/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 2, "last_activity_date": 1432135435, "creation_date": 1432135435, "answer_id": 30353965, "question_id": 30353854, "link": "https://stackoverflow.com/questions/30353854/wide-character-literal-string-in-c/30353965#30353965", "title": "wide character literal string in C++", "body": "<p>To answer the second part of your question if you want to output wide characters then you need to use <a href=\"http://www.cplusplus.com/reference/iostream/wcout/\" rel=\"nofollow\"><code>std::wcout</code></a></p>\n"}], "owner": {"reputation": 335, "user_id": 4288035, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oysf6.jpg?s=128&g=1", "display_name": "BVBC", "link": "https://stackoverflow.com/users/4288035/bvbc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 1, "accepted_answer_id": 30353965, "answer_count": 1, "score": 1, "last_activity_date": 1432135435, "creation_date": 1432135115, "question_id": 30353854, "link": "https://stackoverflow.com/questions/30353854/wide-character-literal-string-in-c", "title": "wide character literal string in C++", "body": "<p>Can someone explain to me what is wide character string and how to use them with examples. For example:</p>\n\n<pre><code>std::cout&lt;&lt;L\"\\115\";\n</code></pre>\n\n<p>Why do I get 0x100000f90 as output instead of M when I just use </p>\n\n<pre><code>std::cout&lt;&lt;\"\\115\";\n</code></pre>\n"}, {"tags": ["c++", "unit-testing", "namespaces"], "comments": [{"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 2, "creation_date": 1432135358, "post_id": 30353844, "comment_id": 48800178, "body": "did you include the header file for <code>GraphPrinter</code>?"}, {"owner": {"reputation": 33, "user_id": 4920986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b369fe8e683e4c315e1fded9ac3a3ff9?s=128&d=identicon&r=PG&f=1", "display_name": "benhal", "link": "https://stackoverflow.com/users/4920986/benhal"}, "reply_to_user": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1432208014, "post_id": 30353844, "comment_id": 48834904, "body": "I did now and it works I thought the #includes would be managed by netbeans itself, because I did not need to include any headers in my other testfile. Thank you very much!"}], "owner": {"reputation": 33, "user_id": 4920986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b369fe8e683e4c315e1fded9ac3a3ff9?s=128&d=identicon&r=PG&f=1", "display_name": "benhal", "link": "https://stackoverflow.com/users/4920986/benhal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 431, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1432135092, "creation_date": 1432135092, "question_id": 30353844, "link": "https://stackoverflow.com/questions/30353844/cppunit-error-class-does-not-name-a-type-in-test-file", "title": "CPPUNIT error: &#39;Class&#39; does not name a type in test file", "body": "<p>I am starting to write unit tests for a program I edit. I did a lot of refactoring and implemented a class with this headerfile:</p>\n\n<pre><code>#ifndef GRAPHPRINTER_H\n#define GRAPHPRINTER_H\n\n#include \"Graph.h\"\n#include \"global.h\"\n#include \"GraphService.h\"\n\nusing namespace boost;\n\n/*\n * Interface for the GraphPrinter class which provides Graph-related output to\n * the console and to files\n *                           */\nclass GraphPrinter {\n\nprotected:\n        //attributes\n        Graph g; // a graph\n        GraphService service; // a service object to get data from the graph\n\npublic:\n\n    //constructors\n    GraphPrinter();\n    GraphPrinter(const Graph&amp; graph);\n\n    //methods, doing what their name says\n\n    std::string printAdjacent(int i); \n    std::string printAdjacentAll(); \n    void saveGraphStatistics(); // saves the number of vertices and edges and the node-degree-distribution\n    void saveAsMatlabVariable(int&amp; number); // saves the graphs as a matlab file\n    void saveGraphStatisticsAsMatlabVariable(); // saves the output of printGraphInfo to a matlab file\n    void saveInSimpleFormat(); // save the edges of the graph to a file\n\n};\n\n#endif  /* GRAPHPRINTER_H */\n</code></pre>\n\n<p>I want to test the code with unit testing. The  code snippet that worries me is this:</p>\n\n<pre><code>#include \"newtestclass1.h\"\nusing namespace boost;\n\n\nCPPUNIT_TEST_SUITE_REGISTRATION(newtestclass1);\n\nnewtestclass1::newtestclass1() {\n}\n\nnewtestclass1::~newtestclass1() {\n}\n\nvoid newtestclass1::setUp() {\n\n    //defining vertices:\n    vi.id = 0;\n    ui.id = 1;\n    wi.id = 2;\n\n    //defining edges\n    ei.source = 0;\n    ei.target = 1;\n\n    fi.source = 1;\n    fi.target = 2;\n\n    gi.source = 2;\n    gi.target = 0;\n\n    //defining graph\n\n    threeNodesGraph[graph_bundle].id = 42;\n\n    v = add_vertex(vi, threeNodesGraph);\n    u = add_vertex(ui, threeNodesGraph);\n    w = add_vertex(wi, threeNodesGraph);\n\n    add_edge(v,u,ei,threeNodesGraph);\n    add_edge(u,w,fi,threeNodesGraph);\n    add_edge(w,v,gi,threeNodesGraph);\n\n\n    // defining the test string and the printer\n    testStringAdjacent = \"  0:   1  2 \";\n    printer = GraphPrinter(threeNodesGraph);\n\n}\n</code></pre>\n\n<p>When I try to run the tests, the compiler says:</p>\n\n<pre><code>tests/newtestclass1.h:36:5: error: \u2018GraphPrinter\u2019 does not name a type\n     GraphPrinter printer;\n     ^\ntests/newtestclass1.cpp: In member function \u2018virtual void newtestclass1::setUp()\u2019:\ntests/newtestclass1.cpp:52:5: error: \u2018printer\u2019 was not declared in this scope\n     printer = GraphPrinter(threeNodesGraph);\n     ^\ntests/newtestclass1.cpp:52:43: error: \u2018GraphPrinter\u2019 was not declared in this scope\n     printer = GraphPrinter(threeNodesGraph);\n</code></pre>\n\n<p>Normally, that would mean I have to forward declare GraphPrinter by including the headerfile.\nBut in another unit testing class I wrote, everything worked fine without including anything, but the boost namespace. I can call the constructor\nof the class I want to test in setUp and have no issues.</p>\n\n<p>I did some google research, but all I can find are errors which occur, because the constructor is not declared, or 'Class' is used instead of 'class', or the wrong headerfiles are included.</p>\n\n<p>I believe the error is somehow connected to how CppUnit resolves namespaces, but I honestly don't know much about the way they work.</p>\n\n<p>Can anyone help please?</p>\n"}, {"tags": ["c++", "linux", "cmake"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1432136211, "post_id": 30353740, "comment_id": 48800787, "body": "<b><i>So, where is the real problem here?</i></b> I would start by looking at the permissions of the files in <code>&#47;usr&#47;include&#47;linux</code> For me on gentoo all files are  owned by root:root but have read access for owner group and other."}, {"owner": {"reputation": 1197, "user_id": 4190096, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/844c07e64f832e97d2f8bba7e7065833?s=128&d=identicon&r=PG&f=1", "display_name": "degill", "link": "https://stackoverflow.com/users/4190096/degill"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1432194468, "post_id": 30353740, "comment_id": 48825903, "body": "That did the trick. I am farely knew to his specific setup and I just contected the admin. Forgot to set some flags. Thanks :)"}], "answers": [{"tags": [], "owner": {"reputation": 1197, "user_id": 4190096, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/844c07e64f832e97d2f8bba7e7065833?s=128&d=identicon&r=PG&f=1", "display_name": "degill", "link": "https://stackoverflow.com/users/4190096/degill"}, "is_accepted": true, "score": 2, "last_activity_date": 1432194590, "creation_date": 1432194590, "answer_id": 30367679, "question_id": 30353740, "link": "https://stackoverflow.com/questions/30353740/cant-include-usr-include-linux-files/30367679#30367679", "title": "Cant include /usr/include/linux files", "body": "<p>@drescherjm was right, I should have gotten read access to that folder. I knew it was a basic question but my knowledge of linux never got into the areas of <code>/usr/include</code> ;)</p>\n"}], "owner": {"reputation": 1197, "user_id": 4190096, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/844c07e64f832e97d2f8bba7e7065833?s=128&d=identicon&r=PG&f=1", "display_name": "degill", "link": "https://stackoverflow.com/users/4190096/degill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 658, "favorite_count": 0, "accepted_answer_id": 30367679, "answer_count": 1, "score": 1, "last_activity_date": 1432194590, "creation_date": 1432134794, "question_id": 30353740, "link": "https://stackoverflow.com/questions/30353740/cant-include-usr-include-linux-files", "title": "Cant include /usr/include/linux files", "body": "<p>This may come as a newbie question, but I am having a very porous knowledge of C++/CMake and only a slightly better understanding of linux itself.</p>\n\n<p>The situation: I am sitting at an Debian 8 operated machine as a normal user (no root available) and I am trying to compile the code written by someone else (yeah, I know, not the best working scenario). </p>\n\n<p>All libraries are now installed on my machine, but I am now getting this error: </p>\n\n<pre><code>In file included from /usr/include/x86_64-linux-gnu/bits/posix1_lim.h:160:0,\n                 from /usr/include/limits.h:143,\n                 from /usr/lib/gcc/x86_64-linux-gnu/4.9/include-fixed/limits.h:168,\n                 from /usr/lib/gcc/x86_64-linux-gnu/4.9/include-fixed/syslimits.h:7,\n                 from /usr/lib/gcc/x86_64-linux-gnu/4.9/include-fixed/limits.h:34,\n                 from /usr/include/opencv2/core/core.hpp:55,\n                 from /usr/include/opencv2/opencv.hpp:47,\n                 from /home/*.hpp:3,\n                 from /home/*.h:4,\n                 from /home/*.cpp:1:\n/usr/include/x86_64-linux-gnu/bits/local_lim.h:38:26: fatal error: /usr/include/linux/limits.h: Keine Berechtigung\n #include &lt;linux/limits.h&gt;\n</code></pre>\n\n<p>The second last line is german \"Keine Berechtigung\" and means \"No permission\".</p>\n\n<p>As I said, I have little understanding of cpp/cmake but I would have guessed that I am able to read whats inside the /usr/include/linux folder, but it turns out I cant and thus I cant compile/run the code. And I dont think the person who wrote the code had root permissions either.</p>\n\n<p>So, where is the real problem here? Wrong permission handling and I should contact the admin?</p>\n"}, {"tags": ["c++", "qt", "qt-creator", "sfml", "joystick"], "comments": [{"owner": {"reputation": 4347, "user_id": 2467327, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/SolkH.png?s=128&g=1", "display_name": "Paulie", "link": "https://stackoverflow.com/users/2467327/paulie"}, "edited": false, "score": 0, "creation_date": 1460043622, "post_id": 30353673, "comment_id": 60571861, "body": "Did you manage to fix this?, I have it working on Linux Mint, but not on Mac"}], "owner": {"reputation": 11, "user_id": 4920997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccaf533582194f8383441e994d874c02?s=128&d=identicon&r=PG&f=1", "display_name": "Glypwota", "link": "https://stackoverflow.com/users/4920997/glypwota"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1452352873, "creation_date": 1432134599, "question_id": 30353673, "link": "https://stackoverflow.com/questions/30353673/qsfmlcanvas-not-working-on-qt5-4-sfml2-2", "title": "QSFMLCanvas not working on Qt5.4 SFML2.2", "body": "<p>My goal is to be able to use a joystick inside of Qt (to add a piloting task to an existing Qt app)\nNote : Qt 5.4 // SFML 2.2 (running on CentOS7)</p>\n\n<p>In order to do so, I used the tutorial on the sfml website explaining how to insert an sfml window inside of a Qt widget. That tutorial ( <a href=\"http://www.sfml-dev.org/tutorials/1.6/graphics-qt.php\" rel=\"nofollow\">http://www.sfml-dev.org/tutorials/1.6/graphics-qt.php</a> ) being too old, I had to change some things in order to update it for sfml 2.2.</p>\n\n<p>However things do not work as intended and while it does compile, it seems to be unable to create the sfml window from the winid and end up crashing</p>\n\n<p>Here is the part of code corresponding to the window creation :</p>\n\n<pre><code>void QSFMLCanvas::showEvent(QShowEvent*)\n{\n    if (!myInitialized)\n    {\n        std::cout &lt;&lt; \"Bla\" &lt;&lt; std::endl;\n        // Under X11, we need to flush the commands sent to the server to ensure that\n        // SFML will get an updated view of the windows\n        #ifdef Q_WS_X11\n            XFlush(QX11Info::display());\n        #endif\n\n        std::cout &lt;&lt; \"Blabla\" &lt;&lt; std::endl;\n\n        // Create the SFML window with the widget handle\n        sf::WindowHandle HANDLE;\n        HANDLE = static_cast&lt;sf::WindowHandle&gt;(winId());\n        std::cout &lt;&lt; HANDLE &lt;&lt; std::endl;\n        std::cout &lt;&lt; \"Blablabla\" &lt;&lt; std::endl;\n        sf::RenderWindow::create(HANDLE);\n        std::cout &lt;&lt; \"Blablablabla\" &lt;&lt; std::endl;\n\n        // Let the derived class do its specific stuff\n        OnInit();\n\n        // Setup the timer to trigger a refresh at specified framerate\n        connect(&amp;myTimer, SIGNAL(timeout()), this, SLOT(repaint()));\n        myTimer.start();\n        myInitialized = true;\n    }\n}\n</code></pre>\n\n<p>And here is the output</p>\n\n<pre><code>Bla\nBlabla\n35651593\nBlablabla\n</code></pre>\n\n<p>...and crash</p>\n\n<p>As you see it seems to have no trouble obtaining the window handle but can't create the sfml renderwindow from it \nNote that there is a static_cast for the handle that isn't there in the tutorial. Different questions suggested putting a reinterpret_cast but then it gives me this error</p>\n\n<pre><code>QSFMLCanvas.cpp: In member function \u2018virtual void QSFMLCanvas::showEvent(QShowEvent*)\u2019:\nQSFMLCanvas.cpp:48:60: erreur: invalid cast from type \u2018WId {aka long long unsigned int}\u2019 to type \u2018sf::WindowHandle {aka long unsigned int}\u2019\n         HANDLE = reinterpret_cast&lt;sf::WindowHandle&gt;(winId());\n</code></pre>\n\n<p>Is there a way to solve this problem ? Or are just SFML &amp; Qt fated to never work together anymore ?\nThank you for your help</p>\n"}, {"tags": ["c#", "c++", "dll", "deployment", "clickonce"], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 1098359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5693e5a01fd3699c9e5cd0fd62009b5f?s=128&d=identicon&r=PG", "display_name": "hynsey", "link": "https://stackoverflow.com/users/1098359/hynsey"}, "edited": false, "score": 1, "creation_date": 1548930894, "post_id": 30355505, "comment_id": 95725080, "body": "I am trying to do the same thing. The link isn&#39;t working anymore - are there any other ItemGroups in your project configuration that reference your DLLs? I&#39;ve tried the above approach, but it still copies the files to the data directory, not the directory where the .exe resides"}, {"owner": {"reputation": 5594, "user_id": 1645784, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/xZW4T.jpg?s=128&g=1", "display_name": "Aleksei Petrenko", "link": "https://stackoverflow.com/users/1645784/aleksei-petrenko"}, "reply_to_user": {"reputation": 135, "user_id": 1098359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5693e5a01fd3699c9e5cd0fd62009b5f?s=128&d=identicon&r=PG", "display_name": "hynsey", "link": "https://stackoverflow.com/users/1098359/hynsey"}, "edited": false, "score": 0, "creation_date": 1548983931, "post_id": 30355505, "comment_id": 95750836, "body": "It was like 4 years ago, sorry, I have no idea :)"}, {"owner": {"reputation": 135, "user_id": 1098359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5693e5a01fd3699c9e5cd0fd62009b5f?s=128&d=identicon&r=PG", "display_name": "hynsey", "link": "https://stackoverflow.com/users/1098359/hynsey"}, "edited": false, "score": 0, "creation_date": 1549140621, "post_id": 30355505, "comment_id": 95800009, "body": "No worries thought it was a long shot :)"}], "tags": [], "owner": {"reputation": 5594, "user_id": 1645784, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/xZW4T.jpg?s=128&g=1", "display_name": "Aleksei Petrenko", "link": "https://stackoverflow.com/users/1645784/aleksei-petrenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1432139521, "creation_date": 1432139521, "answer_id": 30355505, "question_id": 30353457, "link": "https://stackoverflow.com/questions/30353457/copy-dll-files-to-exe-directory-in-clickonce-deployment/30355505#30355505", "title": "Copy dll files to .exe directory in ClickOnce deployment", "body": "<p>Ok, figured it out. This blog post describes the hidden possibilities of project files which allow to do what I want: <a href=\"http://blogs.msdn.com/b/mwade/archive/2008/06/29/how-to-publish-files-which-are-not-in-the-project.aspx\" rel=\"nofollow\">http://blogs.msdn.com/b/mwade/archive/2008/06/29/how-to-publish-files-which-are-not-in-the-project.aspx</a></p>\n\n<p>Basically you should add an item to you project file for each file you will be deploying if you want a custom path for it:</p>\n\n<pre><code>&lt;ItemGroup&gt;\n&lt;PublishFile Include=\"ExternalDependencies\\DSAPI.dll\"&gt;\n  &lt;Visible&gt;False&lt;/Visible&gt;\n  &lt;Group&gt;\n  &lt;/Group&gt;\n  &lt;TargetPath&gt;DSAPI.dll&lt;/TargetPath&gt;\n  &lt;PublishState&gt;Include&lt;/PublishState&gt;\n  &lt;IncludeHash&gt;True&lt;/IncludeHash&gt;\n  &lt;FileType&gt;File&lt;/FileType&gt;\n&lt;/PublishFile&gt;\n</code></pre>\n\n<p></p>\n\n<p><code>TargetPath</code> property is what I was looking for. It's a shame you cannot change it from VS UI!</p>\n"}], "owner": {"reputation": 5594, "user_id": 1645784, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/xZW4T.jpg?s=128&g=1", "display_name": "Aleksei Petrenko", "link": "https://stackoverflow.com/users/1645784/aleksei-petrenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1630, "favorite_count": 0, "accepted_answer_id": 30355505, "answer_count": 1, "score": 1, "last_activity_date": 1432139521, "creation_date": 1432134027, "question_id": 30353457, "link": "https://stackoverflow.com/questions/30353457/copy-dll-files-to-exe-directory-in-clickonce-deployment", "title": "Copy dll files to .exe directory in ClickOnce deployment", "body": "<p>My .NET project depends on a bunch of native dll libraries that should be copied into the same directory as .exe file. Dll files are added to main project to \"ExternalDependencies\" folder and are copied to output folder upon custom post-build action.</p>\n\n<p>When I publish my app with ClickOnce utility all dlls are placed into ExternalDependencies/ relative path, not in the same directory as exe.</p>\n\n<p>I don't want to put the libraries into root of the project, but I have to find a way to change relative path during installation.\nI found no way of doing this, except for manual manifest generation: <a href=\"https://msdn.microsoft.com/en-us/library/xc3tc5xx.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/xc3tc5xx.aspx</a></p>\n\n<p>Maybe I am missing something? Is there an easier way to do this?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 32089, "user_id": 266198, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7x8PT.jpg?s=128&g=1", "display_name": "Nim", "link": "https://stackoverflow.com/users/266198/nim"}, "edited": false, "score": 2, "creation_date": 1432133627, "post_id": 30353185, "comment_id": 48798815, "body": "I would expose the CPU state via appropriate getters/setters, and have the instructions as non-member, non-friend functions which use the public interface of the CPU.."}, {"owner": {"reputation": 6085, "user_id": 425871, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/58MZp.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/425871/steve"}, "edited": false, "score": 2, "creation_date": 1432133705, "post_id": 30353185, "comment_id": 48798894, "body": "Maybe the <a href=\"http://en.wikipedia.org/wiki/Strategy_pattern\" rel=\"nofollow noreferrer\">Strategy Pattern</a> might be useful here. Each op-code could be a strategy."}], "answers": [{"tags": [], "owner": {"reputation": 184, "user_id": 1552766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050525b6d5df7ac28609fd791d1e384d?s=128&d=identicon&r=PG", "display_name": "timato", "link": "https://stackoverflow.com/users/1552766/timato"}, "is_accepted": true, "score": 3, "last_activity_date": 1432134025, "last_edit_date": 1495540099, "creation_date": 1432134025, "answer_id": 30353456, "question_id": 30353185, "link": "https://stackoverflow.com/questions/30353185/refactoring-large-c-class/30353456#30353456", "title": "Refactoring large c++ class", "body": "<p>Well, if there are not large logical chunks to break off, then perhaps you can find smaller bits to place into their own classes. You mentioned the <strong>JumpTable</strong>, which is a candidate for its own class. It could take an opcode and return an address, perhaps?</p>\n\n<p>Then, there are the <strong>OpCodes</strong> themselves, which could become objects that do some altering of the state of the 6502.  So, to do that, you would probably want to package up related bits of the internal state of the CPU.</p>\n\n<p>Once you begin removing smaller pieces, it may become obvious what other refactorings can take place.</p>\n\n<p>There are also some <a href=\"https://stackoverflow.com/questions/5143246/breaking-up-a-large-cohesive-class\">related</a> <a href=\"https://stackoverflow.com/questions/153863/how-should-i-split-large-and-bloated-classes-into-smaller-ones\">answers</a> on StackOverflow that may help.  Here are <a href=\"http://www.drdobbs.com/architecture-and-design/making-large-classes-small-in-5-not-so-e/230600127\" rel=\"nofollow noreferrer\">some additional thoughts</a> from Dr. Dobb's.</p>\n"}], "owner": {"reputation": 157, "user_id": 2000039, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6fe95ca327a014df2cb7541a2c7b03f4?s=128&d=identicon&r=PG", "display_name": "jonnywalkerr", "link": "https://stackoverflow.com/users/2000039/jonnywalkerr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 680, "favorite_count": 3, "accepted_answer_id": 30353456, "answer_count": 1, "score": 6, "last_activity_date": 1432134025, "creation_date": 1432133413, "question_id": 30353185, "link": "https://stackoverflow.com/questions/30353185/refactoring-large-c-class", "title": "Refactoring large c++ class", "body": "<p>I am writing a nes emulator and wrote a single class representing the 6502 cpu:</p>\n\n<pre><code>class CCpu6502 {\n    public:\n       /*....*/\n       void fetch8();\n       void fetch16();\n\n       void ADC();\n       void AND();\n       /* Around 50+ cpu instruction types */\n    private:\n      /*register state, jump table definition*/\n};\n</code></pre>\n\n<p>Basically, I have a jump table that takes in opcode and executes the appropriate member function - changing the cpu's internal state. There are some other tasks that determine the correct addressing type.</p>\n\n<p>I've realized the class definition is way too large and difficult to parse as well as test. However, splitting up the class into separate classes seems problematic because almost every function will alter the cpu's internal state. </p>\n\n<p>I thought about classifying the instruction types as such:  </p>\n\n<pre><code>class AInstructionHandler {/*...*/};\nclass CArithmeticInstHandler : public AInstructionHandler{/*...*/};\nclass CBranchInstHandler : public AInstructionHandler{/*...*/};\n/*memory accessors, logical, etc. */\n</code></pre>\n\n<p>However,I would then have to give each instruction handler class access to the internal state of the cpu by making each class a friend, which seems like a bad idea. </p>\n\n<p>I wondering if there is a preferred way to refactor a large class where almost all methods affect the state of the object or if my design is flawed to begin with.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "string"], "comments": [{"owner": {"reputation": 2289, "user_id": 2356414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff4a2241e2dcfc50615e4b7c709bd17?s=128&d=identicon&r=PG", "display_name": "KABoissonneault", "link": "https://stackoverflow.com/users/2356414/kaboissonneault"}, "edited": false, "score": 3, "creation_date": 1432133148, "post_id": 30353012, "comment_id": 48798413, "body": "What do you mean by &quot;Isn&#39;t working&quot;? Does it return 0, an unexpected value, half the expected value, MAX_INT, etc?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 3, "creation_date": 1432133162, "post_id": 30353012, "comment_id": 48798427, "body": "<code>ships[i].isDestroyed() == false</code> is more clearly written as <code>! ships[i].isDestroyed()</code>."}, {"owner": {"reputation": 362978, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1432133282, "post_id": 30353012, "comment_id": 48798524, "body": "@KeithThompson Yeah! What about that <code>return</code> in <code>isDestroyed()</code>?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1432133469, "post_id": 30353012, "comment_id": 48798658, "body": "Shouldn&#39;t the <code>return</code> statement in <code>isDestroyed()</code> be <code>return ( lowercase &gt;= (status.length&#47;2) ) ? true : false;</code> ( <code>&gt;=</code>, not <code>&lt;=</code>)?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 2, "creation_date": 1432133576, "post_id": 30353012, "comment_id": 48798764, "body": "@RSahu Almost; it should be <code>return lowercase &gt;= status.length&#47;2;</code> (wink)"}, {"owner": {"reputation": 10555, "user_id": 2812864, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/GVsZM.jpg?s=128&g=1", "display_name": "Mateusz Grzejek", "link": "https://stackoverflow.com/users/2812864/mateusz-grzejek"}, "edited": false, "score": 0, "creation_date": 1432133617, "post_id": 30353012, "comment_id": 48798810, "body": "@DevSolar &#39;Sigh&#39;... Come on, eyes, that&#39;s not funny..."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 362978, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1432133744, "post_id": 30353012, "comment_id": 48798930, "body": "@unwind: Yes, I missed that. <code>return ( lowercase &lt;= (status.length&#47;2) ) ? true : false;</code> is more clearly written as <code>return lowercase &lt;= (status.length&#47;2);</code> (assuming that&#39;s the correct condition)."}, {"owner": {"reputation": 307, "user_id": 4888947, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/1kvko.jpg?s=128&g=1", "display_name": "Perseverance", "link": "https://stackoverflow.com/users/4888947/perseverance"}, "edited": false, "score": 0, "creation_date": 1432134590, "post_id": 30353012, "comment_id": 48799585, "body": "The condition is: if (lowercase &gt;= (status.length())/2) return true; else return false;"}], "answers": [{"tags": [], "owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "is_accepted": false, "score": 10, "last_activity_date": 1432133267, "creation_date": 1432133267, "answer_id": 30353103, "question_id": 30353012, "link": "https://stackoverflow.com/questions/30353012/invalid-overload-of-islower/30353103#30353103", "title": "Invalid overload of &#39;islower&#39;", "body": "<p>Unfortunately, the standard library has more than one overload of <code>islower</code> (a function from the C library, and a function template from the localisation library), so you can't simply name the function unless you're calling it.</p>\n\n<p>You could convert it to the right function type:</p>\n\n<pre><code>static_cast&lt;int (*)(int)&gt;(islower)\n</code></pre>\n\n<p>or hope that your implementation dumps the C library into the global namespace as well as <code>std</code>:</p>\n\n<pre><code>::islower      // not guaranteed to work\n</code></pre>\n\n<p>or wrap it in a lambda</p>\n\n<pre><code>[](int c){return islower(c);}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 307, "user_id": 4888947, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/1kvko.jpg?s=128&g=1", "display_name": "Perseverance", "link": "https://stackoverflow.com/users/4888947/perseverance"}, "edited": false, "score": 1, "creation_date": 1432134471, "post_id": 30353153, "comment_id": 48799504, "body": "It is working. Thank you very much. The gameOver function isn&#39;t working though but I guess I need a new topic for that."}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 307, "user_id": 4888947, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/1kvko.jpg?s=128&g=1", "display_name": "Perseverance", "link": "https://stackoverflow.com/users/4888947/perseverance"}, "edited": false, "score": 1, "creation_date": 1432135789, "post_id": 30353153, "comment_id": 48800505, "body": "@Perseverance Maybe you mean  return status.length / 2 &lt; lowercase; instead of return ( lowercase &gt;= (status.length/2) ) ? true : false; That is that lower case letters is greater than the half of the string."}], "tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 3, "last_activity_date": 1432133357, "creation_date": 1432133357, "answer_id": 30353153, "question_id": 30353012, "link": "https://stackoverflow.com/questions/30353012/invalid-overload-of-islower/30353153#30353153", "title": "Invalid overload of &#39;islower&#39;", "body": "<p>Try to change the algorithm call the following way</p>\n\n<pre><code>int lowercase = count_if (status.begin(), status.end(), ::islower); \n                                                        ^^^\n</code></pre>\n\n<p>The compilers are allowed to place standard C functions in the global namespace.</p>\n\n<p>Otherwise use a lambda expression as for example</p>\n\n<pre><code>int lowercase = count_if (status.begin(), status.end(), \n                          []( char c ) return islower( c ); } ); \n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 4888947, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/1kvko.jpg?s=128&g=1", "display_name": "Perseverance", "link": "https://stackoverflow.com/users/4888947/perseverance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 0, "accepted_answer_id": 30353153, "answer_count": 2, "score": 3, "last_activity_date": 1432133476, "creation_date": 1432133023, "last_edit_date": 1432133476, "question_id": 30353012, "link": "https://stackoverflow.com/questions/30353012/invalid-overload-of-islower", "title": "Invalid overload of &#39;islower&#39;", "body": "<p>I'm trying to develop the BattleShip game in C++ and I'm almost done. For that, I need my <code>gameOver</code> function working. My game is over when all the ships are sunk. Therefore, I'm trying to count how many lowercase chars I have in my string status (from Ship). When half of the chars are lowercase, the \"ship\" is destroyed and I'm ready to use my <code>gameOver</code> function.</p>\n\n<p>But somehow my <code>count_if</code> isn't working and I don't know why.</p>\n\n<p>Here you go:</p>\n\n<pre><code>#include &lt;algorithm&gt;\n\nbool Ship::isDestroyed() const{ \n    //This counts those chars that satisfy islower:\n    int lowercase = count_if (status.begin(), status.end(), islower); \n    return ( lowercase &lt;= (status.length/2) ) ? true : false;\n}\n\nbool Board::gameOver() {\n    bool is_the_game_over = true;\n    for(int i = 0 ; i &lt; ships.size() ; i++){\n        if( ships[i].isDestroyed() == false ) {\n            //There is at least one ship that is not destroyed.\n            is_the_game_over = false ;\n            break;\n        }\n    }\n    return is_the_game_over;\n}\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["python", "c++", "ctypes"], "comments": [{"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 3, "creation_date": 1432133073, "post_id": 30352982, "comment_id": 48798366, "body": "By the way, you are leaking memory. <code>strdup</code> in your constructor allocates memory, and your destructor does not clean it up."}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 9, "creation_date": 1432133217, "post_id": 30352982, "comment_id": 48798471, "body": "Can you use destructors in <code>extern &quot;C&quot;</code>?"}, {"owner": {"reputation": 3242, "user_id": 350810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7f4e18fb2896b82478f4c59ced6f882b?s=128&d=identicon&r=PG", "display_name": "Fanatic23", "link": "https://stackoverflow.com/users/350810/fanatic23"}, "edited": false, "score": 0, "creation_date": 1432134743, "post_id": 30352982, "comment_id": 48799694, "body": "I don&#39;t know if I can use destructors in extern &quot;C&quot; but the compiler did not warn or error out. As for leaking, I know I have to use free but the mere presence of the destructor is cause for crash."}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1432134937, "post_id": 30352982, "comment_id": 48799847, "body": "@Fanatic23 the compiler doesn&#39;t warn, even if you use <code>virtual</code> functions (which are clearly non-portable to C code due to the vtable/vpointer being implementation dependent). My guess is that the destructor is not allowed, although I am not 100% sure."}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "edited": false, "score": 2, "creation_date": 1432136293, "post_id": 30352982, "comment_id": 48800844, "body": "Turn up your compiler warnings.  Mine warns that <code>buf</code> is incompatible with C-linkage."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 1, "creation_date": 1432166546, "post_id": 30352982, "comment_id": 48816159, "body": "Using <code>extern &quot;C&quot;</code> on <code>foo</code> is incorrect because you&#39;re returning a C++ class instance by value, i.e. with the destructor the struct is no longer treated as plain old data. This forces a <code>thiscall</code>, whereas for a struct of this size ctypes expects a POD value to be returned in a combination of <code>rax</code> and <code>rdx</code> (System V AMD64 ABI) and so doesn&#39;t allocate the buffer and pass the pointer in <code>rsi</code>. If you make the structure larger (and modify the <code>ctypes.Structure</code>) it works even with a destructor defined because ctypes passes the (now required) implicit pointer as a hidden initial parameter."}], "owner": {"reputation": 3242, "user_id": 350810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7f4e18fb2896b82478f4c59ced6f882b?s=128&d=identicon&r=PG", "display_name": "Fanatic23", "link": "https://stackoverflow.com/users/350810/fanatic23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1432133033, "creation_date": 1432132971, "last_edit_date": 1432133033, "question_id": 30352982, "link": "https://stackoverflow.com/questions/30352982/why-does-a-destructor-crash-my-program", "title": "Why does a destructor crash my program?", "body": "<p>I am interfacing some C++ code with Python. </p>\n\n<p>Here's the C++: </p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;iostream&gt;\n\nextern \"C\" {\n\nstruct buf {\n  buf(char* p, int len) : p_(strdup(p)), len_(len) { }\n  char *p_;\n  int len_;\n  ~buf() { }\n};\n\nbuf foo(char* h)\n{\n  return buf(h, strlen(h));\n} } \n</code></pre>\n\n<p>And here's the Python: </p>\n\n<pre><code>from ctypes import *\nimport struct\nclass buf(Structure):\n  _fields_ = [(\"buf\", c_char_p), (\"len\", c_int)]\n\nd = cdll.LoadLibrary('./foo.so')\nd.foo.restype = buf\nb = d.foo('hello world')\nprint b.buf\nprint b.len\n</code></pre>\n\n<p>This code causes seg fault. However, if I comment out the destructor in struct buf, there is no crash. Something wrong with Python gc? </p>\n"}, {"tags": ["c++", "regex", "boost"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 4876545, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1d8792c55c8f59326be8cc5da160dde7?s=128&d=identicon&r=PG", "display_name": "KH17", "link": "https://stackoverflow.com/users/4876545/kh17"}, "edited": false, "score": 0, "creation_date": 1432133569, "post_id": 30353144, "comment_id": 48798754, "body": "wow. Thanks. i knew it was something silly. If I want to convert to double/float all I have to do is change the <code>&lt;int&gt;</code> to <code>&lt;double&gt;</code>, <code>&lt;float&gt;</code> right?"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 111, "user_id": 4876545, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1d8792c55c8f59326be8cc5da160dde7?s=128&d=identicon&r=PG", "display_name": "KH17", "link": "https://stackoverflow.com/users/4876545/kh17"}, "edited": false, "score": 0, "creation_date": 1432133648, "post_id": 30353144, "comment_id": 48798835, "body": "Yes, that&#39;ll do it. Any type for which an <code>operator&gt;&gt;(std::ostream&amp;, TYPE&amp;)</code> is defined should work."}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": true, "score": 2, "last_activity_date": 1432133340, "creation_date": 1432133340, "answer_id": 30353144, "question_id": 30352978, "link": "https://stackoverflow.com/questions/30352978/error-trying-to-convert-from-string-to-int-using-boost-regex-match-in-c/30353144#30353144", "title": "Error trying to convert from string to int using boost regex match in c++", "body": "<p>you forgot this line:</p>\n\n<pre><code>#include &lt;boost/lexical_cast.hpp&gt;\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 4876545, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1d8792c55c8f59326be8cc5da160dde7?s=128&d=identicon&r=PG", "display_name": "KH17", "link": "https://stackoverflow.com/users/4876545/kh17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 30353144, "answer_count": 1, "score": 2, "last_activity_date": 1432133340, "creation_date": 1432132959, "last_edit_date": 1495540265, "question_id": 30352978, "link": "https://stackoverflow.com/questions/30352978/error-trying-to-convert-from-string-to-int-using-boost-regex-match-in-c", "title": "Error trying to convert from string to int using boost regex match in c++", "body": "<p>I am trying to convert the matched string into a int using regex/boost.\nI used this <a href=\"https://stackoverflow.com/questions/12640284/c-to-convert-boost-regex-match-result-to-other-format/12699630#12699630\">C++ to convert Boost Regex match result to other format</a> as a reference. However when I tried I got <code>expected primary-expression before \u2018int\u2019</code> and <code>Symbol 'lexical_cast' could not be resolved</code> error. </p>\n\n<p>this is my code: </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;boost/regex.hpp&gt;\n\nusing namespace std;\nusing namespace boost;\n\n\nint main(){\n    string a = \"123\";\n    boost::regex e(\"123\");\n    boost::smatch match;\n\n    if (boost::regex_search(a, match, e))\n        {\n            int number = boost::lexical_cast&lt;int&gt;(match[0]);\n            cout &lt;&lt; number &lt;&lt; endl;\n         }\n    return 0;\n}\n</code></pre>\n\n<p>why am I getting these errors?</p>\n"}, {"tags": ["c++", "macos", "duplicates", "x86-64", "symbols"], "comments": [{"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1432132865, "post_id": 30352884, "comment_id": 48798217, "body": "Are you including <code>.cpp</code> files in other files? Do your <code>.h</code> have header guards? We can&#39;t know just by those errors alone."}, {"owner": {"reputation": 31, "user_id": 4920914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a146d41dbffa14df3224bcdfa85786?s=128&d=identicon&r=PG&f=1", "display_name": "user4920914", "link": "https://stackoverflow.com/users/4920914/user4920914"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1432132898, "post_id": 30352884, "comment_id": 48798238, "body": "No we are not including any .cpp files."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1432132898, "post_id": 30352884, "comment_id": 48798239, "body": "Do you <i>define</i> a function in a header file, instead of only declaring it?"}, {"owner": {"reputation": 31, "user_id": 4920914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a146d41dbffa14df3224bcdfa85786?s=128&d=identicon&r=PG&f=1", "display_name": "user4920914", "link": "https://stackoverflow.com/users/4920914/user4920914"}, "edited": false, "score": 0, "creation_date": 1432133476, "post_id": 30352884, "comment_id": 48798662, "body": "No we just declare them. They are defined in the .cpp files"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4920914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a146d41dbffa14df3224bcdfa85786?s=128&d=identicon&r=PG&f=1", "display_name": "user4920914", "link": "https://stackoverflow.com/users/4920914/user4920914"}, "edited": false, "score": 0, "creation_date": 1432133749, "post_id": 30353216, "comment_id": 48798936, "body": "addnewtile is a class not a function"}, {"owner": {"reputation": 31, "user_id": 4920914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a146d41dbffa14df3224bcdfa85786?s=128&d=identicon&r=PG&f=1", "display_name": "user4920914", "link": "https://stackoverflow.com/users/4920914/user4920914"}, "edited": false, "score": 0, "creation_date": 1432133802, "post_id": 30353216, "comment_id": 48798987, "body": "we don&#39;t use global variables and no function implementation in header files"}], "tags": [], "owner": {"reputation": 6984, "user_id": 703531, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2de8b26df89622f511d45480761237c7?s=128&d=identicon&r=PG", "display_name": "Bruce", "link": "https://stackoverflow.com/users/703531/bruce"}, "is_accepted": false, "score": 0, "last_activity_date": 1564990340, "last_edit_date": 1564990340, "creation_date": 1432133465, "answer_id": 30353216, "question_id": 30352884, "link": "https://stackoverflow.com/questions/30352884/ld-duplicate-symbols-for-architecture-x86-64-when-defining-a-global-var-in-a-he/30353216#30353216", "title": "ld: duplicate symbols for architecture x86_64 when defining a global var in a header", "body": "<p>In your header file (the one included from Write.cpp and GameBoard.cpp), you're likely to have an instantiation instead of a declaration.</p>\n\n<p>Common cases/pitfalls : </p>\n\n<ul>\n<li>missing <code>extern</code> before global variables</li>\n<li>having function implementation (i.e. having <code>void foo(Bar&amp; b) {}</code> instead of <code>void foo(Bar&amp; b);</code></li>\n</ul>\n\n<p>Without more details, hard to help...</p>\n\n<p>Look for where <code>addnewtile</code> function is defined for example...</p>\n\n<p><em>EDIT</em></p>\n\n<p>With more details</p>\n\n<pre><code>class Game\n{\n   (zip)\n}game;\n</code></pre>\n\n<p>This is declaring the class Game and creating a game object each time you include the header file.</p>\n\n<p>Use </p>\n\n<pre><code>class Game\n{\n   (zip)\n};\n</code></pre>\n\n<p>In the header file and <code>Game game;</code> in the cpp</p>\n\n<p>Or use a singleton pattern / static instance.</p>\n"}, {"tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": true, "score": 5, "last_activity_date": 1432133627, "creation_date": 1432133627, "answer_id": 30353284, "question_id": 30352884, "link": "https://stackoverflow.com/questions/30352884/ld-duplicate-symbols-for-architecture-x86-64-when-defining-a-global-var-in-a-he/30353284#30353284", "title": "ld: duplicate symbols for architecture x86_64 when defining a global var in a header", "body": "<p>You have instantiated a <code>Game</code> instance in your header file \"Game.h\", and since this is being included in multiple files you end up with multiple instances of <code>game</code> at link time. Change:</p>\n\n<pre><code>class Game\n{\n  public:\n\n  ...\n\n}game;\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>class Game\n{\n  public:\n\n  ...\n\n};\n\nextern Game game;\n</code></pre>\n\n<p>and then add:</p>\n\n<pre><code>Game game;\n</code></pre>\n\n<p>in <strong>one</strong> of your .cpp files.</p>\n"}], "owner": {"reputation": 31, "user_id": 4920914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a146d41dbffa14df3224bcdfa85786?s=128&d=identicon&r=PG&f=1", "display_name": "user4920914", "link": "https://stackoverflow.com/users/4920914/user4920914"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1484, "favorite_count": 0, "accepted_answer_id": 30353284, "answer_count": 2, "score": 0, "last_activity_date": 1564993417, "creation_date": 1432132732, "last_edit_date": 1564993417, "question_id": 30352884, "link": "https://stackoverflow.com/questions/30352884/ld-duplicate-symbols-for-architecture-x86-64-when-defining-a-global-var-in-a-he", "title": "ld: duplicate symbols for architecture x86_64 when defining a global var in a header", "body": "<p>How to solve this problem?</p>\n\n<p>Just getting following errors:</p>\n\n<p>g++ output:</p>\n\n<pre><code>duplicate symbol _game in:\n    /var/folders/w6/yqp0s0t92hl5g842hg8tztfr0000gn/T/main-62666f.o\n    /var/folders/w6/yqp0s0t92hl5g842hg8tztfr0000gn/T/Game-a5a31d.o\nduplicate symbol _game in:\n    /var/folders/w6/yqp0s0t92hl5g842hg8tztfr0000gn/T/main-62666f.o\n    /var/folders/w6/yqp0s0t92hl5g842hg8tztfr0000gn/T/Write-83f8ee.o\n</code></pre>\n\n<p>It seems like the problem is not in the header files.</p>\n\n<p>EDIT: Header files look like this:</p>\n\n<pre><code>#ifndef GAME_H\n#define GAME_H\n#include \"Color.h\"\n#include \"Tile.h\"\n\nclass Game\n{\n  public:\n\n    Game();\n    ~Game();\n    Color getActivePlayer();\n    void setStarttile(Tile Firststarttile);\n    Color togglePlayer();\n    void setRunning(bool run);\n    char newActiveplayer;\n    void run();\n    void runsecondmethod();\n\n  private:\n    Game(const Game &amp;);\n    Color Activeplayer;\n    Tile *Starttile;\n    bool Running;\n}game;\n\n#endif\n</code></pre>\n"}, {"tags": ["c++", "c", "gcc", "makefile", "g++"], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 2803140, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/56cd341723f5ce202e38bedc94a4aa65?s=128&d=identicon&r=PG&f=1", "display_name": "leykan", "link": "https://stackoverflow.com/users/2803140/leykan"}, "edited": false, "score": 0, "creation_date": 1432133709, "post_id": 30353090, "comment_id": 48798897, "body": "I did it and when I compile I have no reference on the &quot;main&quot;. The main is in the c++ file <code>LIMITOR_TEST_example_32f.cpp</code>"}, {"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "reply_to_user": {"reputation": 379, "user_id": 2803140, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/56cd341723f5ce202e38bedc94a4aa65?s=128&d=identicon&r=PG&f=1", "display_name": "leykan", "link": "https://stackoverflow.com/users/2803140/leykan"}, "edited": false, "score": 0, "creation_date": 1432134362, "post_id": 30353090, "comment_id": 48799419, "body": "Did it compile all the files? Do you see all the .o files? What I wrote there is  obviously not usable since you didn&#39;t define LD, but the principle should be right. Could you give the full code after you&#39;ve added this?"}, {"owner": {"reputation": 379, "user_id": 2803140, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/56cd341723f5ce202e38bedc94a4aa65?s=128&d=identicon&r=PG&f=1", "display_name": "leykan", "link": "https://stackoverflow.com/users/2803140/leykan"}, "edited": false, "score": 0, "creation_date": 1432134875, "post_id": 30353090, "comment_id": 48799807, "body": "No it stop on the first file. But it might be for a different reason I update qustion and show the logs"}, {"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "reply_to_user": {"reputation": 379, "user_id": 2803140, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/56cd341723f5ce202e38bedc94a4aa65?s=128&d=identicon&r=PG&f=1", "display_name": "leykan", "link": "https://stackoverflow.com/users/2803140/leykan"}, "edited": false, "score": 0, "creation_date": 1432135574, "post_id": 30353090, "comment_id": 48800336, "body": "@leykan LD is a common name for the linker program, in this case it is GCC as well. I added a full source that <i>could</i> work, but didn&#39;t run it."}, {"owner": {"reputation": 379, "user_id": 2803140, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/56cd341723f5ce202e38bedc94a4aa65?s=128&d=identicon&r=PG&f=1", "display_name": "leykan", "link": "https://stackoverflow.com/users/2803140/leykan"}, "edited": false, "score": 0, "creation_date": 1432136042, "post_id": 30353090, "comment_id": 48800656, "body": "Thx it works !  the only thing is that I don&#39;t understand this Makefile I&#39;m gona do some research on the gramar thx"}, {"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "reply_to_user": {"reputation": 379, "user_id": 2803140, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/56cd341723f5ce202e38bedc94a4aa65?s=128&d=identicon&r=PG&f=1", "display_name": "leykan", "link": "https://stackoverflow.com/users/2803140/leykan"}, "edited": false, "score": 0, "creation_date": 1432137092, "post_id": 30353090, "comment_id": 48801433, "body": "I&#39;ll add some explanations to it in a few hours, too busy at the moment."}], "tags": [], "owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "is_accepted": true, "score": 1, "last_activity_date": 1432135517, "last_edit_date": 1432135517, "creation_date": 1432133234, "answer_id": 30353090, "question_id": 30352880, "link": "https://stackoverflow.com/questions/30352880/compile-a-project-with-c-and-c-files-separately-using-gcc-and-g/30353090#30353090", "title": "Compile a project with C and C++ files separately using gcc and g++?", "body": "<p>Try adding these rules:</p>\n\n<pre><code>%.o: %.c\n     $(CC) $(CFLAGS) $&lt;\n\n%.o: %.cpp\n     $(CPP) $(CFLAGS) $&lt;\n</code></pre>\n\n<p>And changing your main line to:</p>\n\n<pre><code>$(NAME): $(OBJ) $(OBJCPP)\n     $(LD)  $^ -o $@ $(LDFLAGS)\n</code></pre>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>Here is an attempt to integrate this in your code. I did not run this, though.</p>\n\n<pre><code>TECHAUDIO_ROOT = ../../../../../../..\nTECHAUDIO_GENERIC = $(TECHAUDIO_ROOT)/Generic\nTECHAUDIO_MALLOC_3DSL = $(TECHAUDIO_ROOT)/Tools/Malloc_3DSL\nTECHAUDIO_SIGPROC_COMMON_SRC = ../../../../SignalProcessing/RefFT/Common/src\nTECHAUDIO_SIGPROC_SRC = ../../../../SignalProcessing/RefFT/Float/src\nTECHAUDIO_LIMOTOR_SRC = ../../../RefFT/Float/src\nTECHAUDIO_LIMOTOR_COMMON_SRC = ../../../RefFT/Common/src/API\n\nINCLUDES += -I$(TECHAUDIO_GENERIC)/Common/Include \\\n            -I$(TECHAUDIO_GENERIC)/X86/Include \\\n            -I$(TECHAUDIO_MALLOC_3DSL)/RefFT/Common/Include \\\n            -I$(TECHAUDIO_SIGPROC_COMMON_SRC) \\\n            -I$(TECHAUDIO_SIGPROC_SRC)/Math \\\n            -I$(TECHAUDIO_SIGPROC_SRC)/Transform \\\n            -I$(TECHAUDIO_SIGPROC_SRC)/Filter \\\n            -I$(TECHAUDIO_SIGPROC_SRC)/Vector \\\n            -I$(TECHAUDIO_SIGPROC_SRC)/SSTP \\\n            -I$(TECHAUDIO_LIMOTOR_SRC)/API \\\n            -I$(TECHAUDIO_LIMOTOR_COMMON_SRC) \\\n            -I$(TECHAUDIO_LIMOTOR_SRC)\n\n SRCS =     $(TECHAUDIO_LIMOTOR_SRC)/LIMITOR_main_32f.c \\\n            $(TECHAUDIO_LIMOTOR_SRC)/API/LIMITOR_API_32f.c \\\n            $(TECHAUDIO_LIMOTOR_SRC)/API/LIMITOR_API_coordinate_32f.c\n\nSRCSCPP =   $(TECHAUDIO_LIMOTOR_SRC)/Test/LIMITOR_TEST_example_32f.cpp\n#           $(TECHAUDIO_LIMOTOR_SRC)/VST/LIMITOR_VST_audioEffect_32f.cpp \\                                                                                                      \n#           $(TECHAUDIO_LIMOTOR_SRC)/VST/LIMITOR_VST_main_32f.cpp                                                                                                               \n\nNAME = Bonjour\n\nCC = gcc -c\nCPP = g++ -c\nLD = g++ -o\n\nCFLAGS += $(INCLUDES)\nCFLAGS += -D_X86_GCC_4_1_1_TARGET_\n#CFLAGS +=-D_X86_VC8_TARGET_                                                                                                                                                        \n\nRM = rm -f\n\nOBJ= $(SRCS:.c=.o)\n\nOBJCPP= $(SRCSCPP:.cpp=.o)\n\n%.o: %.c\n    $(CC) $&lt; -o $@ $(CFLAGS)\n\n%.o: %.cpp\n    $(CPP) $&lt; -o $@  $(CFLAGS)\n\nall: $(NAME)\n\n$(NAME): $(OBJ) $(OBJCPP)\n    $(LD) $@  $^ -lm\n\nclean:\n         $(RM) $(OBJ) $(OBJCPP)\n\nfclean: clean\n    $(RM) $(NAME)\n\nre: fclean all\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 2803140, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/56cd341723f5ce202e38bedc94a4aa65?s=128&d=identicon&r=PG&f=1", "display_name": "leykan", "link": "https://stackoverflow.com/users/2803140/leykan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 30353090, "answer_count": 1, "score": 1, "last_activity_date": 1432199322, "creation_date": 1432132724, "last_edit_date": 1432199322, "question_id": 30352880, "link": "https://stackoverflow.com/questions/30352880/compile-a-project-with-c-and-c-files-separately-using-gcc-and-g", "title": "Compile a project with C and C++ files separately using gcc and g++?", "body": "<p>I have a project that contains C and C++ files and I created a Makefile to compile this project.</p>\n\n<p>Is it possible to have a Makefile that will \"separate\" the C and C++ files, the C files will be compile with gcc and the C++ files with g++ and create one binary ?</p>\n\n<p>This is the Makefile I created:</p>\n\n<pre><code>TECHAUDIO_ROOT = ../../../../../../..\nTECHAUDIO_GENERIC = $(TECHAUDIO_ROOT)/Generic\nTECHAUDIO_MALLOC_3DSL = $(TECHAUDIO_ROOT)/Tools/Malloc_3DSL\nTECHAUDIO_SIGPROC_COMMON_SRC = ../../../../SignalProcessing/RefFT/Common/src\nTECHAUDIO_SIGPROC_SRC = ../../../../SignalProcessing/RefFT/Float/src\nTECHAUDIO_LIMOTOR_SRC = ../../../RefFT/Float/src\nTECHAUDIO_LIMOTOR_COMMON_SRC = ../../../RefFT/Common/src/API\n\nINCLUDES += -I$(TECHAUDIO_GENERIC)/Common/Include \\\n            -I$(TECHAUDIO_GENERIC)/X86/Include \\\n            -I$(TECHAUDIO_MALLOC_3DSL)/RefFT/Common/Include \\\n            -I$(TECHAUDIO_SIGPROC_COMMON_SRC) \\\n            -I$(TECHAUDIO_SIGPROC_SRC)/Math \\\n            -I$(TECHAUDIO_SIGPROC_SRC)/Transform \\\n            -I$(TECHAUDIO_SIGPROC_SRC)/Filter \\\n            -I$(TECHAUDIO_SIGPROC_SRC)/Vector \\\n            -I$(TECHAUDIO_SIGPROC_SRC)/SSTP \\\n            -I$(TECHAUDIO_LIMOTOR_SRC)/API \\\n            -I$(TECHAUDIO_LIMOTOR_COMMON_SRC) \\\n            -I$(TECHAUDIO_LIMOTOR_SRC)\n\nSRCS =      $(TECHAUDIO_LIMOTOR_SRC)/LIMITOR_main_32f.c \\\n            $(TECHAUDIO_LIMOTOR_SRC)/API/LIMITOR_API_32f.c \\\n            $(TECHAUDIO_LIMOTOR_SRC)/API/LIMITOR_API_coordinate_32f.c\n\nSRCSCPP =   $(TECHAUDIO_LIMOTOR_SRC)/Test/LIMITOR_TEST_example_32f.cpp\n#           $(TECHAUDIO_LIMOTOR_SRC)/VST/LIMITOR_VST_audioEffect_32f.cpp \\                                                                                                      \n#           $(TECHAUDIO_LIMOTOR_SRC)/VST/LIMITOR_VST_main_32f.cpp                                                                                                               \n\nNAME = Bonjour\n\nCC = gcc\n\nCPP = g++\n\nCFLAGS += $(INCLUDES)\nCFLAGS += -D_X86_GCC_4_1_1_TARGET_\n#CFLAGS +=-D_X86_VC8_TARGET_                                                                                                                                                        \nRM = rm -f\n\nOBJ= $(SRCS:.c=.o)\n\nOBJCPP= $(SRCSCPP:.cpp=.o)\n\nall: $(NAME)\n\n$(NAME): $(OBJ)\n        $(CC) $(CFLAGS) $(OBJ) -o $(NAME) -lm\n         $(OBJCPP)\n        $(CPP) $(CFLAGS) $(OBJCPP) -o $(NAME) -lm\n\nclean:\n        $(RM) $(OBJ) $(OBJCPP)\n\nfclean: clean\n        $(RM) $(NAME)\nre: fclean all\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Below is an updated version of the Makefile:</p>\n\n<pre><code>TECHAUDIO_ROOT = ../../../../../../..\nTECHAUDIO_GENERIC = $(TECHAUDIO_ROOT)/Generic\nTECHAUDIO_MALLOC_3DSL = $(TECHAUDIO_ROOT)/Tools/Malloc_3DSL\nTECHAUDIO_SIGPROC_COMMON_SRC = ../../../../SignalProcessing/RefFT/Common/src\nTECHAUDIO_SIGPROC_SRC = ../../../../SignalProcessing/RefFT/Float/src\nTECHAUDIO_LIMOTOR_SRC = ../../../RefFT/Float/src\nTECHAUDIO_LIMOTOR_COMMON_SRC = ../../../RefFT/Common/src/API\n\nINCLUDES += -I$(TECHAUDIO_GENERIC)/Common/Include \\\n            -I$(TECHAUDIO_GENERIC)/X86/Include \\\n            -I$(TECHAUDIO_MALLOC_3DSL)/RefFT/Common/Include \\\n            -I$(TECHAUDIO_SIGPROC_COMMON_SRC) \\\n            -I$(TECHAUDIO_SIGPROC_SRC)/Math \\\n            -I$(TECHAUDIO_SIGPROC_SRC)/Transform \\\n            -I$(TECHAUDIO_SIGPROC_SRC)/Filter \\\n            -I$(TECHAUDIO_SIGPROC_SRC)/Vector \\\n            -I$(TECHAUDIO_SIGPROC_SRC)/SSTP \\\n            -I$(TECHAUDIO_LIMOTOR_SRC)/API \\\n            -I$(TECHAUDIO_LIMOTOR_COMMON_SRC) \\\n            -I$(TECHAUDIO_LIMOTOR_SRC)\n\n SRCS =     $(TECHAUDIO_LIMOTOR_SRC)/LIMITOR_main_32f.c \\\n            $(TECHAUDIO_LIMOTOR_SRC)/API/LIMITOR_API_32f.c \\\n            $(TECHAUDIO_LIMOTOR_SRC)/API/LIMITOR_API_coordinate_32f.c\n\nSRCSCPP =   $(TECHAUDIO_LIMOTOR_SRC)/Test/LIMITOR_TEST_example_32f.cpp\n#           $(TECHAUDIO_LIMOTOR_SRC)/VST/LIMITOR_VST_audioEffect_32f.cpp \\                                                                                                      \n#           $(TECHAUDIO_LIMOTOR_SRC)/VST/LIMITOR_VST_main_32f.cpp                                                                                                               \n\nNAME = Bonjour\n\nCC = gcc\n\nCPP = g++\n\nCFLAGS += $(INCLUDES)\nCFLAGS += -D_X86_GCC_4_1_1_TARGET_\n#CFLAGS +=-D_X86_VC8_TARGET_                                                                                                                                                        \n\nRM = rm -f\n\nOBJ= $(SRCS:.c=.o)\n\nOBJCPP= $(SRCSCPP:.cpp=.o)\n\n%.o: %.c\n        $(CC) $(CFLAGS) $&lt;\n\n%.o: %.cpp\n        $(CPP) $(CFLAGS) $&lt;\n\nall: $(NAME)\n\n$(NAME): $(OBJ) $(OBJCPP)\n           $(LD)  $^ -o $@ $(LDFLAGS)\n\nclean:\n         $(RM) $(OBJ) $(OBJCPP)\n\nfclean: clean\n        $(RM) $(NAME)\nre: fclean all\n</code></pre>\n\n<p>These are the errors I receive when I execute <code>make</code>:</p>\n\n<pre><code>/usr/bin/ld: /usr/lib/debug/usr/lib/i386-linux-gnu/crt1.o(.debug_info): r\u00e9adressage 20 a un index de symbole 13 invalide\n/usr/bin/ld: /usr/lib/debug/usr/lib/i386-linux-gnu/crt1.o(.debug_info): r\u00e9adressage 21 a un index de symbole 22 invalide\n/usr/bin/ld: /usr/lib/debug/usr/lib/i386-linux-gnu/crt1.o(.debug_line): r\u00e9adressage 0 a un index de symbole 2 invalide\n/usr/lib/gcc/i686-linux-gnu/4.8/../../../i386-linux-gnu/crt1.o: dans la fonction \u00ab _start \u00bb:\n(.text+0x18): r\u00e9f\u00e9rence ind\u00e9finie vers \u00ab main \u00bb\n/tmp/ccvLa3z6.o: dans la fonction \u00ab LIMITOR_3DSL_getStatusSize_32f \u00bb:\nLIMITOR_main_32f.c:(.text+0x1e): r\u00e9f\u00e9rence ind\u00e9finie vers \u00ab MALLOC_3DSL_compute_memory_size_align_heap \u00bb\n</code></pre>\n"}, {"tags": ["c++", "ifstream", "getline"], "comments": [{"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 4, "creation_date": 1432132711, "post_id": 30352819, "comment_id": 48798089, "body": "<a href=\"http://coliru.stacked-crooked.com/a/cb1b4f73f5810061\" rel=\"nofollow noreferrer\">Works for me</a>."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1432132764, "post_id": 30352819, "comment_id": 48798135, "body": "I would use regular expressions."}, {"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1432132959, "post_id": 30352819, "comment_id": 48798279, "body": "If you cannot provide offending example and expected output, don&#39;t expect much help. It is considerably harder to find possible errors than actual ones."}, {"owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "edited": false, "score": 0, "creation_date": 1432133195, "post_id": 30352819, "comment_id": 48798452, "body": "Take a look at line 22. Your problem might be there."}], "answers": [{"comments": [{"owner": {"reputation": 525, "user_id": 4728337, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/GlmSQ.jpg?s=128&g=1", "display_name": "Dinosaur", "link": "https://stackoverflow.com/users/4728337/dinosaur"}, "edited": false, "score": 0, "creation_date": 1432133559, "post_id": 30353158, "comment_id": 48798738, "body": "Thanks, what I wanted to do was to use temp[5] to hold the five elements in each line. I didn&#39;t expect the integer i to go beyond 4."}, {"owner": {"reputation": 1596, "user_id": 3431124, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xaBzf.jpg?s=128&g=1", "display_name": "Robert S.", "link": "https://stackoverflow.com/users/3431124/robert-s"}, "reply_to_user": {"reputation": 525, "user_id": 4728337, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/GlmSQ.jpg?s=128&g=1", "display_name": "Dinosaur", "link": "https://stackoverflow.com/users/4728337/dinosaur"}, "edited": false, "score": 0, "creation_date": 1432133629, "post_id": 30353158, "comment_id": 48798818, "body": "If your csv file contains a line with more commas this will happen."}, {"owner": {"reputation": 525, "user_id": 4728337, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/GlmSQ.jpg?s=128&g=1", "display_name": "Dinosaur", "link": "https://stackoverflow.com/users/4728337/dinosaur"}, "edited": false, "score": 0, "creation_date": 1432133678, "post_id": 30353158, "comment_id": 48798864, "body": "The lines in my CSV file look like this: 2009-12-31 21:00:00,GRID_A,1.84296,350.947,60.72"}, {"owner": {"reputation": 1596, "user_id": 3431124, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xaBzf.jpg?s=128&g=1", "display_name": "Robert S.", "link": "https://stackoverflow.com/users/3431124/robert-s"}, "reply_to_user": {"reputation": 525, "user_id": 4728337, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/GlmSQ.jpg?s=128&g=1", "display_name": "Dinosaur", "link": "https://stackoverflow.com/users/4728337/dinosaur"}, "edited": false, "score": 0, "creation_date": 1432133912, "post_id": 30353158, "comment_id": 48799065, "body": "Maybe your <code>std::getline(read, line)</code> extracts one single line? Can you test this by outputting <code>line</code> before <code>int i ...</code>? Maybe your line endings of your CSV file are not compatible to the default line delimiter of <code>std::getline</code>."}, {"owner": {"reputation": 525, "user_id": 4728337, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/GlmSQ.jpg?s=128&g=1", "display_name": "Dinosaur", "link": "https://stackoverflow.com/users/4728337/dinosaur"}, "edited": false, "score": 0, "creation_date": 1432133970, "post_id": 30353158, "comment_id": 48799114, "body": "Thanks! However, if I remove the [i], I would be reading the whole line into temp, which isn&#39;t what I wanted. I need to have each attribute put into temp[i] for i=0,1,2,...,4 for practical reasons. Can you tell me how I can achieve that?"}, {"owner": {"reputation": 1596, "user_id": 3431124, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xaBzf.jpg?s=128&g=1", "display_name": "Robert S.", "link": "https://stackoverflow.com/users/3431124/robert-s"}, "reply_to_user": {"reputation": 525, "user_id": 4728337, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/GlmSQ.jpg?s=128&g=1", "display_name": "Dinosaur", "link": "https://stackoverflow.com/users/4728337/dinosaur"}, "edited": false, "score": 0, "creation_date": 1432134017, "post_id": 30353158, "comment_id": 48799152, "body": "First try out my last comment. I guess the first <code>std::getline</code> is your problem, considering your output. It seems your variable <code>line</code> contains the whole file content instead of a single line."}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "reply_to_user": {"reputation": 525, "user_id": 4728337, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/GlmSQ.jpg?s=128&g=1", "display_name": "Dinosaur", "link": "https://stackoverflow.com/users/4728337/dinosaur"}, "edited": false, "score": 0, "creation_date": 1432134094, "post_id": 30353158, "comment_id": 48799220, "body": "@Dinosaur Are you <b>sure</b> the lines are separated by newline? It looks like you&#39;re reading   just a looooong line. Did you use a Windows file into a Unix environment or the other way around? The code itself is perfectly fine otherwise."}, {"owner": {"reputation": 525, "user_id": 4728337, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/GlmSQ.jpg?s=128&g=1", "display_name": "Dinosaur", "link": "https://stackoverflow.com/users/4728337/dinosaur"}, "reply_to_user": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1432134241, "post_id": 30353158, "comment_id": 48799326, "body": "@vsoftco. I&#39;m on a mac. The file I&#39;m reading is just an ordinary CSV file. If I take the more tedious route like read &gt;&gt; temp[0] &gt;&gt; read.get() &gt;&gt; temp[1].... then the program has no problem going from one line to another."}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "reply_to_user": {"reputation": 525, "user_id": 4728337, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/GlmSQ.jpg?s=128&g=1", "display_name": "Dinosaur", "link": "https://stackoverflow.com/users/4728337/dinosaur"}, "edited": false, "score": 0, "creation_date": 1432134340, "post_id": 30353158, "comment_id": 48799406, "body": "@Dinosaur try opening your file in a text editor. The lines should be separated. If not, then you have a problem, since you read only one long line as the whole file, and you should change the code accordingly. AFAIK, CSV uses a line separator for each record. If you read only one line, and you know your records contain 5 fields, then you can simply do <code>temp[i % 5]</code> so <code>i</code> stays in the range <code>[0..5)</code>"}, {"owner": {"reputation": 525, "user_id": 4728337, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/GlmSQ.jpg?s=128&g=1", "display_name": "Dinosaur", "link": "https://stackoverflow.com/users/4728337/dinosaur"}, "reply_to_user": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1432134419, "post_id": 30353158, "comment_id": 48799463, "body": "@vsoftco. I opened it using TexEdit (plain text editor) and the file wasn&#39;t a long line. Any thoughts?"}, {"owner": {"reputation": 1596, "user_id": 3431124, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xaBzf.jpg?s=128&g=1", "display_name": "Robert S.", "link": "https://stackoverflow.com/users/3431124/robert-s"}, "edited": false, "score": 0, "creation_date": 1432134451, "post_id": 30353158, "comment_id": 48799486, "body": "This might help you: <a href=\"http://stackoverflow.com/questions/6089231/getting-std-ifstream-to-handle-lf-cr-and-crlf\" title=\"getting std ifstream to handle lf cr and crlf\">stackoverflow.com/questions/6089231/&hellip;</a> See accepted answer there. I guess your problem are the line endings. <code>std::getline</code> uses the delimiter that matches your OS default line ending. But if you exchange files from OS to another (e.g. from Windows to Mac) this might be a problem."}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "reply_to_user": {"reputation": 525, "user_id": 4728337, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/GlmSQ.jpg?s=128&g=1", "display_name": "Dinosaur", "link": "https://stackoverflow.com/users/4728337/dinosaur"}, "edited": false, "score": 0, "creation_date": 1432134572, "post_id": 30353158, "comment_id": 48799571, "body": "@Dinosaur as Robert said, your file was probably written by Windows. Convert it to UNIX format, <a href=\"http://stackoverflow.com/questions/6373888/converting-newline-formatting-from-mac-to-windows\" title=\"converting newline formatting from mac to windows\">stackoverflow.com/questions/6373888/&hellip;</a>"}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "reply_to_user": {"reputation": 525, "user_id": 4728337, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/GlmSQ.jpg?s=128&g=1", "display_name": "Dinosaur", "link": "https://stackoverflow.com/users/4728337/dinosaur"}, "edited": false, "score": 0, "creation_date": 1432135761, "post_id": 30353158, "comment_id": 48800476, "body": "@Dinosaur also try <code>wc -l data.csv</code> in a terminal to see exactly how many lines you have. My guess is that your text editor wrap the lines around and you falsely believe there are multiple lines."}, {"owner": {"reputation": 525, "user_id": 4728337, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/GlmSQ.jpg?s=128&g=1", "display_name": "Dinosaur", "link": "https://stackoverflow.com/users/4728337/dinosaur"}, "reply_to_user": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1432173350, "post_id": 30353158, "comment_id": 48817946, "body": "@vsoftco. Wow, you got it! Upon adding some *&#39;s to show the end of line I realized the line in the file was horrendously long. Many thanks for providing the solution."}], "tags": [], "owner": {"reputation": 1596, "user_id": 3431124, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xaBzf.jpg?s=128&g=1", "display_name": "Robert S.", "link": "https://stackoverflow.com/users/3431124/robert-s"}, "is_accepted": false, "score": 2, "last_activity_date": 1432133583, "last_edit_date": 1432133583, "creation_date": 1432133362, "answer_id": 30353158, "question_id": 30352819, "link": "https://stackoverflow.com/questions/30352819/using-getline-and-istringstream-to-read-data-from-csv-file/30353158#30353158", "title": "Using getline and istringstream to read data from CSV file", "body": "<p>Your code works if there are only 5 columns in each line. If <code>i</code> is greaten than 4 you will get problems. As you said your <code>i</code> is 21! Your array can't take this much elements. You should leave the loop at the end if <code>i</code> is outside your array range.</p>\n\n<p>You try to access <code>temp[21]</code> which is somewhere beyond the rainbow. No wonder you get BAD ACCESS.</p>\n\n<p>Just use <code>temp</code> as a single string. No need for an array if you only want to output the value. Just use <code>string temp;</code> and remove <code>[i]</code> down there.</p>\n"}], "owner": {"reputation": 525, "user_id": 4728337, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/GlmSQ.jpg?s=128&g=1", "display_name": "Dinosaur", "link": "https://stackoverflow.com/users/4728337/dinosaur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9006, "favorite_count": 3, "answer_count": 1, "score": 1, "last_activity_date": 1432173471, "creation_date": 1432132548, "last_edit_date": 1432173471, "question_id": 30352819, "link": "https://stackoverflow.com/questions/30352819/using-getline-and-istringstream-to-read-data-from-csv-file", "title": "Using getline and istringstream to read data from CSV file", "body": "<p>I'm trying to read a CSV file with entries like this:</p>\n\n<pre><code>//2009-12-31 21:00:00, COUNTRY ,1.84296,350.947,60.72\n</code></pre>\n\n<p>This is what I did</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n\nint main()\n{\n    using namespace std;\n    ifstream read(\"data.csv\");\n\n    string line;\n\n    //I want to use this to hold the data temporarily\n    string temp[5];\n\n    while (std::getline(read, line))\n    {\n        int i=0;\n        std::istringstream iss(line); // string stream\n        while(std::getline(iss, temp[i], ','))\n        {\n            cout &lt;&lt; i &lt;&lt; \": \" &lt;&lt; temp[i] &lt;&lt; endl;\n            ++i;\n        };\n    }\n}\n</code></pre>\n\n<p>But it didn't do what I wanted the code to do. In particular, the code stopped after the integer i hit 21. Here's the output</p>\n\n<blockquote>\n<pre><code>0: 2009-12-31 21:00:00\n1: GRID_A\n2: 1.84296\n3: 350.947\n4: 60.72\n2010-01-01 00:00:00\n5: GRID_A\n6: 1.93569\n7: 348.98\n8: 60.64\n2010-01-01 03:00:00\n9: GRID_A\n10: 2.30688\n11: 339.444\n12: 247.6\n2010-01-01 06:00:00\n13: GRID_A\n14: 1.74453\n15: 326.219\n16: 587.92\n2010-01-01 09:00:00\n17: GRID_A\n18: 2.16002\n19: 289.19\n20: 180.72\n2010-01-01 12:00:00\n21: GRID_A\n</code></pre>\n</blockquote>\n\n<p>Then I got an error like this</p>\n\n<blockquote>\n<pre><code>_LIBCPP_INLINE_VISIBILITY\n    static void assign(char_type&amp; __c1, const char_type&amp; __c2) _NOEXCEPT\n        {__c1 = __c2;}\nThread 1: EXC_BAD_ACCESS...\n</code></pre>\n</blockquote>\n\n<p>Can you please tell me what's wrong? Many thanks!</p>\n\n<p>PS: It turns out that the problem had to do with the CSV file that I saved using Excel on my Mac. The newline character was missing.</p>\n"}, {"tags": ["c++", "c++11", "c++14"], "comments": [{"owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "edited": false, "score": 1, "creation_date": 1432131612, "post_id": 30352384, "comment_id": 48797149, "body": "Where is <code>c</code> initialized?"}, {"owner": {"reputation": 1942, "user_id": 969365, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/1EnZd.png?s=128&g=1", "display_name": "simon", "link": "https://stackoverflow.com/users/969365/simon"}, "edited": false, "score": 0, "creation_date": 1432131643, "post_id": 30352384, "comment_id": 48797180, "body": "Why have <code>c</code> when you have <code>this</code>? Anyway, both operators should just set <code>c</code> to point to the new object."}, {"owner": {"reputation": 19628, "user_id": 1873944, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MaDna.jpg?s=128&g=1", "display_name": "peppe", "link": "https://stackoverflow.com/users/1873944/peppe"}, "edited": false, "score": 0, "creation_date": 1432131653, "post_id": 30352384, "comment_id": 48797192, "body": "How are you initializing <code>c</code>? (=&gt; why a recursive loop? Are you supposing that you can have a cyclic path of C instances?)"}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 8, "creation_date": 1432131723, "post_id": 30352384, "comment_id": 48797259, "body": "Voted to close as unclear. I could answer for e.g. a singly linked list, which this <i>could</i> be, but there are zillions other things it <i>could</i> be."}, {"owner": {"reputation": 2985, "user_id": 3062311, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ac3f86b95cab3ef4d33850cbeb9db3e2?s=128&d=identicon&r=PG&f=1", "display_name": "sop", "link": "https://stackoverflow.com/users/3062311/sop"}, "edited": false, "score": 0, "creation_date": 1432131848, "post_id": 30352384, "comment_id": 48797370, "body": "Have you tried std::move for move constructor?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1432131890, "post_id": 30352384, "comment_id": 48797413, "body": "If you are going to deal with raw pointers and memory management I wouod suggest you use the <a href=\"http://stackoverflow.com/questions/3279543/what-is-the-copy-and-swap-idiom\">copy and swap idiom</a>"}, {"owner": {"reputation": 8326, "user_id": 53089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525dac0c4812e8e8753935590b40ddb6?s=128&d=identicon&r=PG", "display_name": "Rob K", "link": "https://stackoverflow.com/users/53089/rob-k"}, "edited": false, "score": 1, "creation_date": 1432134399, "post_id": 30352384, "comment_id": 48799450, "body": "It depends on what instance of C the new instance of C should point to. You need to tell us more about the problem you&#39;re trying to solve with this structure."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1432135640, "post_id": 30352384, "comment_id": 48800384, "body": "To make the question clear: Does <code>C* c</code> point to <code>this</code>?  Could it point to something that could (through a chain of <code>c</code>s) eventually point back to <code>this</code>?  When you copy a <code>C</code>, do you intend to copy the entire chain of pointed to by <code>C* c;</code>s, or do you want to copy the pointer (but not the pointed to data)?  These are design question that can only be guessed at."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1432143974, "post_id": 30352384, "comment_id": 48805578, "body": "-1: OP came back, saw comments asking for clarification, and accepted an answer without improving the question.  This means that the question will be less useful for future readers of the website.  If the question is improved, please notify me with an @Yakk and I&#39;ll rescind."}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1432192380, "post_id": 30352384, "comment_id": 48824616, "body": "You are correct, @Yakk, I haven&#39;t provided any clarification, and I&#39;m sorry for this, it wasn&#39;t a problem I actually had, just a thought of a scenario I wanted to have some input to. My original problem was easily solved by just checking for <code>NULL</code> pointers and not copying / moving them if they&#39;re <code>NULL</code>."}], "answers": [{"comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 3, "creation_date": 1432131761, "post_id": 30352471, "comment_id": 48797289, "body": "Smart pointers are pretty ungood for linked lists, which this <i>could</i> be (and appears to most likely be). Especially when the list could be circular. I&#39;m downvoting this as bad advice."}, {"owner": {"reputation": 6685, "user_id": 472610, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/40f01113212b1d726ff23bc5807b5c5b?s=128&d=identicon&r=PG", "display_name": "Jonathan H", "link": "https://stackoverflow.com/users/472610/jonathan-h"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1432132210, "post_id": 30352471, "comment_id": 48797706, "body": "You are right, which I why I wrote my PS. The OP doesn&#39;t say anything about the application, so without further information this is a perfectly valid solution. I&#39;m not sure how I feel about voting because of how it <i>could be</i> used. Knives can be used to kill, they&#39;re still a perfectly good choice for cutting things, like paper, even though scissors might be better then."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1432132560, "post_id": 30352471, "comment_id": 48797957, "body": "For a blanket unqualified recommendation it&#39;s important that it would fail or add unreasonable overhead in the most likely cases. When I wrote &quot;bad&quot; advice I meant &quot;most likely directly harmful&quot; advice, not that it&#39;s imperfect."}, {"owner": {"reputation": 6685, "user_id": 472610, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/40f01113212b1d726ff23bc5807b5c5b?s=128&d=identicon&r=PG", "display_name": "Jonathan H", "link": "https://stackoverflow.com/users/472610/jonathan-h"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1432132646, "post_id": 30352471, "comment_id": 48798029, "body": "@Cheersandhth.-Alf No worries, in any case you&#39;re right in saying that the OP is unclear :)"}], "tags": [], "owner": {"reputation": 6685, "user_id": 472610, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/40f01113212b1d726ff23bc5807b5c5b?s=128&d=identicon&r=PG", "display_name": "Jonathan H", "link": "https://stackoverflow.com/users/472610/jonathan-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1432131799, "last_edit_date": 1432131799, "creation_date": 1432131717, "answer_id": 30352471, "question_id": 30352384, "link": "https://stackoverflow.com/questions/30352384/copy-constructor-with-pointers-to-own-class/30352471#30352471", "title": "Copy constructor with pointers to own class", "body": "<p>This is one of the reasons why smart pointers were invented. They are self managed, so the only thing you need to do is set them when you want, and they take care of releasing the memory when it is no longer used. </p>\n\n<pre><code>#include &lt;memory&gt;\n\nclass C\n{\npublic:\n  C() {}\n\nprotected:\n  int a;\n  float b;\n  std::shared_ptr&lt;C&gt; c;\n}\n</code></pre>\n\n<p>PS: I didn't ask, but cases in which you need a pointer to self are not that common; are you sure there is no workaround in your case?</p>\n"}, {"comments": [{"owner": {"reputation": 6685, "user_id": 472610, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/40f01113212b1d726ff23bc5807b5c5b?s=128&d=identicon&r=PG", "display_name": "Jonathan H", "link": "https://stackoverflow.com/users/472610/jonathan-h"}, "edited": false, "score": 1, "creation_date": 1432133198, "post_id": 30352923, "comment_id": 48798453, "body": "There was a comment about this, but if you go with this solution <i>please do</i> initialize <code>c</code> to <code>nullptr</code> in all non-copying constructors!"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 6685, "user_id": 472610, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/40f01113212b1d726ff23bc5807b5c5b?s=128&d=identicon&r=PG", "display_name": "Jonathan H", "link": "https://stackoverflow.com/users/472610/jonathan-h"}, "edited": false, "score": 1, "creation_date": 1432133253, "post_id": 30352923, "comment_id": 48798502, "body": "@Sh3ljohn good point. I assumed that the initialization was there but left out of example code for simplicity."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 1, "last_activity_date": 1432134077, "last_edit_date": 1432134077, "creation_date": 1432132823, "answer_id": 30352923, "question_id": 30352384, "link": "https://stackoverflow.com/questions/30352384/copy-constructor-with-pointers-to-own-class/30352923#30352923", "title": "Copy constructor with pointers to own class", "body": "<blockquote>\n  <p>Normally you would just invoke the copy constructor of the object that needs to be copied, but since it's the very same class, how would you handle this properly?</p>\n</blockquote>\n\n<p>In the same recursive manner as you call the destructor of the same class. Since your destructor assumes the ownership of the pointed object, you must do a deep copy.</p>\n\n<p>Moving is simple, just clear the pointer so it doesn't get deleted when the moved from object is destroyed. Just like any other owned raw pointer.</p>\n\n<pre><code>C(const C&amp; other): a(other.a), b(other.b), c(other.c) {\n    if(other.c)\n        this-&gt;c = new C(*other.c);\n}\nC(C&amp;&amp; other): a(other.a), b(other.b), c(other.c) {\n    other.c = nullptr;\n}\n</code></pre>\n\n<p>Remember that the stack size will  limit the recursion of your data structure. If you would leave memory management outside the class, then you could iterate the linked objects with a loop instead of recursion.</p>\n"}, {"tags": [], "owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "is_accepted": true, "score": 3, "last_activity_date": 1432132965, "creation_date": 1432132965, "answer_id": 30352979, "question_id": 30352384, "link": "https://stackoverflow.com/questions/30352384/copy-constructor-with-pointers-to-own-class/30352979#30352979", "title": "Copy constructor with pointers to own class", "body": "<blockquote>\n  <p>How would you properly implement the copy and move constructors?</p>\n</blockquote>\n\n<p>Moving is easy: copy the victim's pointer to the target, then null the victim's to indicate that it no longer owns anything. And, of course, copy the other values.</p>\n\n<p>For copying, you need to choose the semantics you want: unique ownership (in which case don't allow copying), shared ownership (in which case increment a reference count, and change the destructor to decrease it), deep copying (in which case allocate a new object, copying the old one), or something else.</p>\n\n<blockquote>\n  <p>Normally you would just invoke the copy constructor of the object that needs to be copied, but since it's the very same class, how would you handle this properly?</p>\n</blockquote>\n\n<p>That's not necessarily a problem. If the chain of pointers ends somewhere, you'll just end up recursively copying everything on that chain; although it might be better to write a loop to avoid indefinite recursion. If it doesn't end, then it must be cyclic, so you'd need to check whether you get back to the object you started with.</p>\n"}, {"comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1432155676, "post_id": 30353029, "comment_id": 48812283, "body": "Uhm, what happens in the case of a circular list, here? That&#39;s also a dimension of lack of clarity in the question. ;-)"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1432156233, "post_id": 30353029, "comment_id": 48812604, "body": "@Cheersandhth.-Alf one of many such dimensions :)"}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 1, "last_activity_date": 1432136325, "last_edit_date": 1432136325, "creation_date": 1432133077, "answer_id": 30353029, "question_id": 30352384, "link": "https://stackoverflow.com/questions/30352384/copy-constructor-with-pointers-to-own-class/30353029#30353029", "title": "Copy constructor with pointers to own class", "body": "<p>OK, the purpose of the question is unclear, and the way you'd write the copy and move operators would depend on the behaviour you wanted: </p>\n\n<ul>\n<li><p>do you want ownership of the subordinate C moved to the new class on move? </p></li>\n<li><p>do you want the subordinate C copied in the case of a copy? (deep copy)</p></li>\n<li><p>on copy, should the destination C share the subordinate C with the source C?</p></li>\n</ul>\n\n<p>We could take a guess and assume that the answers are: yes, yes, no:</p>\n\n<pre><code>class C\n{\npublic:\n\n    // custom destructor == rule of 5\n\n    C() {}\n\n    C(C&amp;&amp; r) noexcept\n    : _child { r._child }\n    {\n        r._child = nullptr;\n    }\n\n    C&amp; operator=(C&amp;&amp; r) noexcept {\n        swap(r);\n        return *this;\n    }\n\n    C(const C&amp; r)\n    : _child { r._child ? r._child-&gt;clone() : nullptr }\n    {\n    }\n\n    C&amp; operator=(const C&amp; r) {\n        C tmp { r };\n        swap(tmp);\n        return *this;\n    }\n\n    // test for null is not necessary\n    virtual ~C() noexcept { delete _child; }\n\npublic:\n    void swap(C&amp; r) noexcept {\n        using std::swap;\n        swap(_child, r._child);\n    }\n\n    // in case C is a polymorphic base class\n    virtual C* clone() const {\n        return new C { *this };\n    }\n\nprivate:\n    C* _child = nullptr;\n};\n</code></pre>\n"}], "owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 1, "closed_date": 1432135399, "accepted_answer_id": 30352979, "answer_count": 4, "score": -3, "last_activity_date": 1432136325, "creation_date": 1432131487, "last_edit_date": 1432131979, "question_id": 30352384, "link": "https://stackoverflow.com/questions/30352384/copy-constructor-with-pointers-to-own-class", "closed_reason": "Needs details or clarity", "title": "Copy constructor with pointers to own class", "body": "<p>Assume we have a class like this:</p>\n\n<pre><code>class C\n{\npublic:\n  C() {}\n  virtual ~C() noexcept { if (c) { delete c; } }\n\nprotected:\n  int a;\n  float b;\n  C* c;\n}\n</code></pre>\n\n<p>How would you properly implement the copy and move constructors? Normally you would just invoke the copy constructor of the object that needs to be copied, but since it's the very same class, how would you handle this properly?</p>\n"}]