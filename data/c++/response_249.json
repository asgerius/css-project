[{"tags": ["c++", "c", ".so", "gcovr"], "comments": [{"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1571302719, "post_id": 58422985, "comment_id": 103198352, "body": "Please don&#39;t use screenshots if you have text. Then I&#39;d like to ask you for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. You don&#39;t want us to waste time writing all these files by hand, do you? Did you check if the generated gcda files include those for your library units, just in the &quot;wrong&quot; directory?"}, {"owner": {"reputation": 54872, "user_id": 1521179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/MH7pk.png?s=128&g=1", "display_name": "amon", "link": "https://stackoverflow.com/users/1521179/amon"}, "edited": false, "score": 0, "creation_date": 1571324719, "post_id": 58422985, "comment_id": 103211500, "body": "If no .gcda for the ProjectA files were created, that would mean that none of libprojecta&#39;s code was executed. This can happen e.g. with header-only libraries. If that&#39;s not the case, most likely you oversimplified the scenario and accidentally omitted some relevant details."}], "owner": {"reputation": 87, "user_id": 11649397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0301291ad644a2d9a8bfbb37e5e9b11a?s=128&d=identicon&r=PG&f=1", "display_name": "takanoha", "link": "https://stackoverflow.com/users/11649397/takanoha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571269111, "creation_date": 1571269111, "question_id": 58422985, "link": "https://stackoverflow.com/questions/58422985/gcovr-missing-gcda-files-after-executing-binary-that-is-linked-with-a-dynamical", "title": "gcovr missing .gcda files after executing binary that is linked with a dynamically linked shard object libraries (.so)", "body": "<p>I am trying to use <strong>gcovr</strong> on my linux project and have no luck getting .gcda files for the dynamic library after executing binary. </p>\n\n<p>I have a project called <strong>projectA</strong> which creates a library called <strong>libprojectA.so</strong> and the unit test project links <strong>libprojectA.so</strong>. The main goal here is that I want to see the code coverage of projectA functions invoked from the unit test binary <strong>UnitTestExecutable</strong>.</p>\n\n<p>I have such a directory structure:\n<a href=\"https://i.stack.imgur.com/SbHSR.png\" rel=\"nofollow noreferrer\">Project Structure</a></p>\n\n<p>This is the steps I followed to call <strong>gcovr</strong>.</p>\n\n<ol>\n<li><p>Build projectA with its Makefile</p>\n\n<ul>\n<li>Makefile has \"-fprofile-arcs -ftest-coverage -fPIC\"</li>\n<li>creates .o and .gcno inside .build directory</li>\n<li>creates dynamic library libprojectA.so</li>\n</ul></li>\n<li><p>Build unittest</p>\n\n<ul>\n<li>Makefile links libprojectA.so</li>\n<li>Makefile has \"-fprofile-arcs -ftest-coverage -fPIC\"</li>\n<li>creates .o and .gcno </li>\n<li>creates binary UnitTestExecutable</li>\n</ul></li>\n<li><p>Execute UnitTestExecutable</p>\n\n<ul>\n<li>creates .gcda files inside /unittest/*.gcda</li>\n<li>it doesn't create *.gcda inside /porjectA/ folder &lt;== this is the problem</li>\n</ul></li>\n<li><p>Call gcovr\ngcovr -v -r /projectA/ --html --html-details -o test-html-details.html --object-directory=/projectA/.build/</p>\n\n<p>Here it complains that it can't find *.gcda inside /projectA/.build/</p></li>\n</ol>\n\n<p>Could someone please help ?</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["python", "c++"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 2, "creation_date": 1571268251, "post_id": 58422804, "comment_id": 103187944, "body": "When you compile a C++ source file, the output is a binary.  <code>g++</code> by default will write that to <code>a.out</code> unless you specify a different target with <code>-o</code> option.  You certainly do not execute the C++ source file itself."}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1571268535, "post_id": 58422804, "comment_id": 103188018, "body": "Can you suggueste to me an exemple please !"}, {"owner": {"reputation": 92215, "user_id": 1832058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/relWs.jpg?s=128&g=1", "display_name": "furas", "link": "https://stackoverflow.com/users/1832058/furas"}, "edited": false, "score": 1, "creation_date": 1571268558, "post_id": 58422804, "comment_id": 103188027, "body": "example: <code>subprocess.call(&quot;a.out&quot;, shell=True)</code>"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 3, "creation_date": 1571268882, "post_id": 58422804, "comment_id": 103188105, "body": "You should also check the return code from <code>g++</code> to make sure it succeeded.  If there are errors, the output won&#39;t exist or if it does it&#39;ll be from a previous successful compilation."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 2, "creation_date": 1571269468, "post_id": 58422804, "comment_id": 103188209, "body": "Python will never directly execute C++ code (well, there are library bindings I suppose...) so you are talking about writing a script in Python to automate the C++ compile/run cycle? What is it, in context, that you are actually trying to accomplish?"}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 0, "creation_date": 1571271533, "post_id": 58422804, "comment_id": 103188614, "body": "I want to create a python script that can run c++ code"}, {"owner": {"reputation": 92215, "user_id": 1832058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/relWs.jpg?s=128&g=1", "display_name": "furas", "link": "https://stackoverflow.com/users/1832058/furas"}, "edited": false, "score": 1, "creation_date": 1571274736, "post_id": 58422804, "comment_id": 103189235, "body": "Python can&#39;t run directly C++, you would have to create parser and interpreter for C++. It can execute C++ compiled to machine code (.exe file) - and you already did it. You compiled C++ to machine code using <code>g++ main.cpp</code> and you should get machine code in file <code>a.out</code> and now you can execute it <code>subprocess.call(&quot;a.out&quot;, shell=True)</code>."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1571316567, "post_id": 58422804, "comment_id": 103206575, "body": "@ITWorld That&#39;s just repeating the question&#39;s opener. I&#39;m asking for more detail, more context, more explanation of what you&#39;re trying to do and why. What is your goal? &quot;Run C++ code&quot; in what way? What sort of C++ code? Why should Python do this? In what manner? To accomplish what? We cannot adequately answer your question without the proper context."}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1571317139, "post_id": 58422804, "comment_id": 103206933, "body": "@LightnessRacesinOrbit So what I am trying to is to run c++ functions or files code using a python script. Why or for what? It&#39;s something that I don&#39;t know either because my boss who know the reason. He&#39;s the one who need it and ask me to search how to do it He did not specify why or for what so I can&#39;t answer that question"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1571319224, "post_id": 58422804, "comment_id": 103208266, "body": "Then it sounds like you need to get a more detailed requirements specification from your boss, because at present you do not have sufficient information to properly complete your task. <i>&quot;run c++ functions or files code using a python script&quot;</i> is extremely vague."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1571268222, "post_id": 58422861, "comment_id": 103187926, "body": "Also worth testing the the ages of the cpp file and the executable. If the executable is newer than the cpp file, there&#39;s not much point to recompiling the cpp file. On second thought, this assumes stable monotonic time."}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 0, "creation_date": 1571268677, "post_id": 58422861, "comment_id": 103188056, "body": "Can you suggueste to me an example  please ! Or if you know where i can find a simple tutorial please !"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 1, "creation_date": 1571278976, "post_id": 58422861, "comment_id": 103190069, "body": "@ITWorld this specific case isn&#39;t the sort of thing where you are likely to find a tutorial. You should be able to find a general tutorial for running external processes, and you&#39;ll have to adapt from there."}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 0, "creation_date": 1571307333, "post_id": 58422861, "comment_id": 103201090, "body": "@bem22 I want to run c++ code using python script and not call a command that run the .exe file"}, {"owner": {"reputation": 117, "user_id": 7056603, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZmOm.png?s=128&g=1", "display_name": "bem22", "link": "https://stackoverflow.com/users/7056603/bem22"}, "edited": false, "score": 1, "creation_date": 1571321918, "post_id": 58422861, "comment_id": 103209902, "body": "When you said run C++ code I assumed you want to run C++ compiled code. My answer describes how you can compile and run the code. This requires the GNU g++ compiler and a unix environment. What I suggested was a solution that only runs in Unix or bash supporting systems. Basically ./ means &quot;run this script&quot;. You can run different scripts: For example ./hello where ./hello is the output from g++ of hello.cpp (you compile it by using the following command: g++ -o hello hello.cpp)"}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 0, "creation_date": 1571322258, "post_id": 58422861, "comment_id": 103210122, "body": "@bem22 yes but it&#39;s not answering the whole question. Is there a way to convert a c++ to python or run a c++ using python without using commands"}, {"owner": {"reputation": 117, "user_id": 7056603, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZmOm.png?s=128&g=1", "display_name": "bem22", "link": "https://stackoverflow.com/users/7056603/bem22"}, "edited": false, "score": 1, "creation_date": 1571322824, "post_id": 58422861, "comment_id": 103210449, "body": "It is virtually impossible. C has many features that Python does not, such as pointers, access to direct syscalls and file descriptors etc."}], "tags": [], "owner": {"reputation": 117, "user_id": 7056603, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZmOm.png?s=128&g=1", "display_name": "bem22", "link": "https://stackoverflow.com/users/7056603/bem22"}, "is_accepted": false, "score": 0, "last_activity_date": 1571268031, "creation_date": 1571268031, "answer_id": 58422861, "question_id": 58422804, "link": "https://stackoverflow.com/questions/58422804/how-can-i-run-a-hello-world-c-code-using-python/58422861#58422861", "title": "How can I run a Hello world c++ code using python", "body": "<p>You can use the .os module of python to run os commands.</p>\n\n<pre><code>import os\nmyCmd1 = 'ls -la'\nos.system(myCmd)\n</code></pre>\n\n<p>Your command can be 'g++ main.cpp second.cpp -o run', then you can use the same mechanism to call the <code>./run</code> shell. </p>\n\n<p>Make sure you have the right permissions </p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 2, "creation_date": 1571269422, "post_id": 58422966, "comment_id": 103188202, "body": "Why do you compile on the commandline if your script does it too?"}, {"owner": {"reputation": 884, "user_id": 9238288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbf252a32c63647e64ea7b1a534be4a?s=128&d=identicon&r=PG&f=1", "display_name": "jackw11111", "link": "https://stackoverflow.com/users/9238288/jackw11111"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1571269796, "post_id": 58422966, "comment_id": 103188291, "body": "Yes true, only one is necessary"}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 0, "creation_date": 1571307411, "post_id": 58422966, "comment_id": 103201139, "body": "I want to run c++ code using python script and not call a command that run the .exe file"}, {"owner": {"reputation": 884, "user_id": 9238288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbf252a32c63647e64ea7b1a534be4a?s=128&d=identicon&r=PG&f=1", "display_name": "jackw11111", "link": "https://stackoverflow.com/users/9238288/jackw11111"}, "edited": false, "score": 0, "creation_date": 1571310457, "post_id": 58422966, "comment_id": 103202918, "body": "Do you mean that you want a c++ function eg. foo in a class bar that you can use in python like , import bar; bar.foo() ?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1571316539, "post_id": 58422966, "comment_id": 103206557, "body": "Will you update the answer then to remove the excess compilation?"}, {"owner": {"reputation": 884, "user_id": 9238288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbf252a32c63647e64ea7b1a534be4a?s=128&d=identicon&r=PG&f=1", "display_name": "jackw11111", "link": "https://stackoverflow.com/users/9238288/jackw11111"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1571342532, "post_id": 58422966, "comment_id": 103219573, "body": "@LightnessRacesinOrbit Sure thing"}, {"owner": {"reputation": 884, "user_id": 9238288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbf252a32c63647e64ea7b1a534be4a?s=128&d=identicon&r=PG&f=1", "display_name": "jackw11111", "link": "https://stackoverflow.com/users/9238288/jackw11111"}, "reply_to_user": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 1, "creation_date": 1571349387, "post_id": 58422966, "comment_id": 103222059, "body": "@ITWorld I have added an example with boost python, take a look"}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 1, "creation_date": 1571390452, "post_id": 58422966, "comment_id": 103233585, "body": "@jackw11111 Thank you for your example, but the boost folder has to be in my project folder or where ? Because I did put it in &quot;C:\\Python36\\Lib\\site-packages\\boost&quot; but I have an error pointing on #include &lt;boost/python.hpp&gt; that says it didn&#39;t find the file"}, {"owner": {"reputation": 884, "user_id": 9238288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbf252a32c63647e64ea7b1a534be4a?s=128&d=identicon&r=PG&f=1", "display_name": "jackw11111", "link": "https://stackoverflow.com/users/9238288/jackw11111"}, "reply_to_user": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 1, "creation_date": 1571394082, "post_id": 58422966, "comment_id": 103235527, "body": "@ITWorld You might need to link to the folder where the header files when you compile something like <code>g++ -I C:\\Python36\\Lib\\site-packages</code> etc ..."}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 0, "creation_date": 1571399441, "post_id": 58422966, "comment_id": 103238222, "body": "@jackw11111 I had the error &quot;ValueError: Unknown MS Compiler version 1900&quot;"}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 0, "creation_date": 1571866369, "post_id": 58422966, "comment_id": 103386312, "body": "Thank you for your answer, I did use ctypes instead"}], "tags": [], "owner": {"reputation": 884, "user_id": 9238288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbf252a32c63647e64ea7b1a534be4a?s=128&d=identicon&r=PG&f=1", "display_name": "jackw11111", "link": "https://stackoverflow.com/users/9238288/jackw11111"}, "is_accepted": false, "score": 3, "last_activity_date": 1595468667, "last_edit_date": 1595468667, "creation_date": 1571268977, "answer_id": 58422966, "question_id": 58422804, "link": "https://stackoverflow.com/questions/58422804/how-can-i-run-a-hello-world-c-code-using-python/58422966#58422966", "title": "How can I run a Hello world c++ code using python", "body": "<p>A simple example would be to create a <code>.cpp</code> file:</p>\n<pre><code>// cpy.cpp\n#include &lt;iostream&gt;\n\nint main()\n{\n    std::cout &lt;&lt; &quot;Hello World! from C++&quot; &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n<p>And a Python script:</p>\n<pre><code>// cpy.py\nimport subprocess\ncmd = &quot;cpy.cpp&quot;\nsubprocess.call([&quot;g++&quot;, cmd])\nsubprocess.call(&quot;./a.out&quot;)\n</code></pre>\n<p>Then in the terminal, run the Python script:</p>\n<pre><code>~ python cpy.py\n~ Hello World! from C++\n</code></pre>\n<p><strong>EDIT:</strong></p>\n<p>If you want control of calling C++ functions from Python, you will need to create bindings to extend Python with C++. This can be done a number of ways, the Python docs has a thorough raw implementation of how it can be done for simple cases, but also there are libraries such as pybind and boost.Python that can do this for you.</p>\n<p>An example with boost.Python:</p>\n<pre><code>// boost-example.cpp\n#include &lt;iostream&gt;\n#include &lt;boost/python.hpp&gt;\n\nusing namespace boost::python;\n\nint printHello()\n{\n    std::cout &lt;&lt; &quot;Hello, World! from C++&quot; &lt;&lt; std::endl;\n}\n\nBOOST_PYTHON_MODULE(hello)\n{\n        def(&quot;print_hello&quot;, printHello);\n}\n</code></pre>\n<p>You will need to create a shared object file (.so) and make sure to link the appropriate Python headers and libraries. An example might look like:</p>\n<pre><code>g++ printHello.cpp -fPIC -shared -L/usr/lib/python2.7/config-3.7m-x86_64-linux-gnu/ -I/usr/include/python2.7 -lpython2.7 -lboost_python -o hello.so\n</code></pre>\n<p>And in the same directory that you created the <code>hello.so</code> file:</p>\n<pre><code>python\n&gt;&gt;&gt; import hello\n&gt;&gt;&gt; hello.print_hello()\nHello, World! from C++\n</code></pre>\n<p>Boost.Python can be used to do some pretty magic things, including exposing classes, wrapping overloaded functions, exposing global and class variables for reading and writing, hybrid Python/C++ inheritance heirarchies, all with the utility of dramatic performance gains.\nI recommend going through <a href=\"https://www.boost.org/doc/libs/1_68_0/libs/python/doc/html/tutorial/index.html\" rel=\"nofollow noreferrer\">these</a> docs and getting to know the API if you are looking to go down this route.</p>\n"}, {"tags": [], "owner": {"reputation": 2343, "user_id": 9448377, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Wim Lavrijsen", "link": "https://stackoverflow.com/users/9448377/wim-lavrijsen"}, "is_accepted": false, "score": 2, "last_activity_date": 1571763286, "creation_date": 1571763286, "answer_id": 58509029, "question_id": 58422804, "link": "https://stackoverflow.com/questions/58422804/how-can-i-run-a-hello-world-c-code-using-python/58509029#58509029", "title": "How can I run a Hello world c++ code using python", "body": "<p>As an alternative to compiling the C++ code into a separate program and executing that, you can also use cppyy (<a href=\"http://cppyy.org\" rel=\"nofollow noreferrer\">http://cppyy.org</a>) to run the C++ code directly, through a JIT, within the same program.</p>\n\n<p>Example:</p>\n\n<pre><code>import cppyy\ncppyy.cppdef('''\nvoid hello() {\n    std::cout &lt;&lt; \"Hello, World!\" &lt;&lt; std::endl;\n}''')\ncppyy.gbl.hello()   # calls the C++ function 'hello' defined above\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1285, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1595468667, "creation_date": 1571267460, "last_edit_date": 1571267795, "question_id": 58422804, "link": "https://stackoverflow.com/questions/58422804/how-can-i-run-a-hello-world-c-code-using-python", "title": "How can I run a Hello world c++ code using python", "body": "<p>I want to know how can I create a python script that run c++ code.</p>\n\n<p>I did find some talks about subprocess module but it's used to run commands \nI did find some talks about Boost and Swig but I didn't understand as a beginner how to use them</p>\n\n<p>Testing subprocess:</p>\n\n<pre><code>import subprocess\nsubprocess.call([\"g++\", \"main.cpp\"],shell = True)\ntmp=subprocess.call(\"main.cpp\",shell = True)\nprint(\"printing result\")\nprint(tmp)\n</code></pre>\n\n<p>Can any one help me please!</p>\n"}, {"tags": ["c++", "overriding", "abstract-class"], "comments": [{"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 3, "creation_date": 1571267632, "post_id": 58422790, "comment_id": 103187794, "body": "<code>IComparable</code> is an abstract class. You cannot create objects of its type in <code>new IComparable[ARRAY_SIZE]</code>. <code>IComparable</code> seems to be used as interface class. Why would you want to create objects of its type? Did you mean to write <code>new Time[ARRAY_SIZE]</code> instead?"}, {"owner": {"reputation": 19, "user_id": 9515245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T0Tu5.jpg?s=128&g=1", "display_name": "Antrophy", "link": "https://stackoverflow.com/users/9515245/antrophy"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1571267866, "post_id": 58422790, "comment_id": 103187840, "body": "@uneven_mark oh you are right, I completely missed that part, thank you!"}], "owner": {"reputation": 19, "user_id": 9515245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T0Tu5.jpg?s=128&g=1", "display_name": "Antrophy", "link": "https://stackoverflow.com/users/9515245/antrophy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1571267356, "creation_date": 1571267356, "question_id": 58422790, "link": "https://stackoverflow.com/questions/58422790/overriding-a-method-generates-an-error-stating-its-not-overriden-even-though-th", "title": "Overriding a method generates an error stating it&#39;s not overriden even though the signature is the same along with parameters", "body": "<p>I have issues with an error message saying: <strong><em>pure virtual function :IObject::toString has no overrider</em></strong></p>\n\n<p>I've seen multiple threads on it and the problem was that people didn't have the same signatures with parameters and thus never really \"overriden\" it but rather they did overloading. But in this example, I have the same signature and parameters (none) yet it still says the same error.</p>\n\n<p>Here is abstract class <strong>IObject.h</strong></p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#pragma once\n#ifndef I_OBJECT_H\n\n#define I_OBJECT_H\n#include&lt;string&gt;\n\nclass IObject\n{\npublic:\n    virtual std::string toString() const = 0;\n};\n\n#endif // !I_OBJECT_H\n</code></pre>\n\n<p><code>toString()</code> method is pure virtual and needs to be overriden.</p>\n\n<p>This is <strong>IComparable</strong> that is descendant of <strong>IObject.h</strong></p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#pragma once\n#ifndef I_COMPARABLE_H\n#define I_COMPARABLE_H\n\n#include \"IObject.h\"\nclass IComparable :\n    public IObject\n{\npublic:\n    virtual int compareTo(IComparable* obj) const = 0;\n};\n\n\n#endif // !I_COMPARABLE_H\n</code></pre>\n\n<p>And here I have the <strong>Time.h</strong> that overrides both functions <code>compareTo(IComparable* obj)</code> from <strong>IComparable.h</strong> and <code>toString()</code> from <strong>IObject.h</strong></p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#pragma once\n#ifndef TIME_H\n#define TIME_H\n\n#include \"IComparable.h\"\n\nstruct Time : public IComparable {\npublic:\n    Time(int aHours, int aMinutes, int aSeconds);\n    virtual int compareTo(IComparable* obj) const override;\n    virtual std::string toString() const override; // &lt;-- overriden\nprivate:\n    int _hours;\n    int _minutes;\n    int _seconds;\n\n    // custom operators for comparing\n    bool operator==(const Time&amp; obj) const;\n    bool operator&lt;(const Time&amp; obj) const;\n    bool operator&gt;(const Time&amp; obj) const;\n};\n\n\n#endif // !TIME_H\n</code></pre>\n\n<p>The error shows up in the main here (commented in the code)</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include&lt;iostream&gt;\n#include&lt;time.h&gt;\n#include \"Time.h\"\n#define ARRAY_SIZE 10\n\nint main() {\n    srand(time(NULL));\n\n    IComparable* array = new IComparable[ARRAY_SIZE]; // right before the first brace\n// rest of the code...\n</code></pre>\n\n<p>Any idea why do I get this error even though i DID override it?</p>\n"}, {"tags": ["c++", "cmake"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1571268183, "post_id": 58422567, "comment_id": 103187913, "body": "&quot;... I get a ton of compile-time errors. &quot; is not an error description with which we can help you. Please, provide the <b>exact error messages</b>. At least the very first one."}, {"owner": {"reputation": 189, "user_id": 11342925, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OhfoTlzRIqE/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBK5JrK8tagNaecsQ9INaeaEhhKvQ/mo/photo.jpg?sz=128", "display_name": "fresh", "link": "https://stackoverflow.com/users/11342925/fresh"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1571268517, "post_id": 58422567, "comment_id": 103188014, "body": "I get so many I can&#39;t even reach the first one. The last ones sound like &quot;this conflicts with previous declaration&quot;"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1571268603, "post_id": 58422567, "comment_id": 103188038, "body": "Redirect build process&#39;s output into the file, and then copy paste the first message from that file into the question post."}, {"owner": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 1, "creation_date": 1571273269, "post_id": 58422567, "comment_id": 103188963, "body": "When you &quot;<i>include ROOT functions and macros</i>&quot;, I think the command you want to use is <code>include(${ROOT_USE_FILE})</code>, not the <code>include_directories()</code> command. Your <code>include_directories()</code> command may be necessary, but you want to point to folder containing headers, so maybe just <code>${CMAKE_CURRENT_SOURCE_DIR}&#47;include</code> instead of what is there now. Here&#39;s an <a href=\"https://root.cern.ch/how/integrate-root-my-project-cmake\" rel=\"nofollow noreferrer\">example</a>."}, {"owner": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 0, "creation_date": 1571345702, "post_id": 58422567, "comment_id": 103220883, "body": "How does <code>find_package()</code> populate the <code>ROOT_</code> variables? For example, if you add <code>message(ROOT_INCLUDE_DIRS: ${ROOT_INCLUDE_DIRS})</code> to your CMake, what gets printed?"}, {"owner": {"reputation": 189, "user_id": 11342925, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OhfoTlzRIqE/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBK5JrK8tagNaecsQ9INaeaEhhKvQ/mo/photo.jpg?sz=128", "display_name": "fresh", "link": "https://stackoverflow.com/users/11342925/fresh"}, "reply_to_user": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 0, "creation_date": 1571353275, "post_id": 58422567, "comment_id": 103222976, "body": "@squareskittles I get this:``` ROOT_INCLUDE_DIRS:/home/Me/root/include```"}, {"owner": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 0, "creation_date": 1571356591, "post_id": 58422567, "comment_id": 103223639, "body": "Do you know what <b>version</b> of ROOT you are using? And how did you install ROOT? Did you follow a tutorial? Or did you clone from their Github <a href=\"https://github.com/root-project/root\" rel=\"nofollow noreferrer\">here</a> and build it from source?"}, {"owner": {"reputation": 189, "user_id": 11342925, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OhfoTlzRIqE/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBK5JrK8tagNaecsQ9INaeaEhhKvQ/mo/photo.jpg?sz=128", "display_name": "fresh", "link": "https://stackoverflow.com/users/11342925/fresh"}, "reply_to_user": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 0, "creation_date": 1571357422, "post_id": 58422567, "comment_id": 103223838, "body": "@squareskittles I am using ROOT 6.16. I built it from source using Cmake as described on ROOT&#39;s website. The directory ``` ROOT_INCLUDE_DIRS:/home/Me/root/include``` is inside the ROOT build directory I created when I built it."}, {"owner": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 0, "creation_date": 1571358395, "post_id": 58422567, "comment_id": 103224040, "body": "Ok, for version 6.16 and higher, there is some guidance <a href=\"https://cliutils.gitlab.io/modern-cmake/chapters/packages/ROOT.html\" rel=\"nofollow noreferrer\">here</a> which says that linking only imported targets (<code>ROOT::Core</code>, <code>ROOT::Hist</code>, etc) will provide the include directories also."}, {"owner": {"reputation": 189, "user_id": 11342925, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OhfoTlzRIqE/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBK5JrK8tagNaecsQ9INaeaEhhKvQ/mo/photo.jpg?sz=128", "display_name": "fresh", "link": "https://stackoverflow.com/users/11342925/fresh"}, "reply_to_user": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 0, "creation_date": 1571398498, "post_id": 58422567, "comment_id": 103237755, "body": "@squareskittles I had already read that guide. I even tried copying the simple project it describes as an example (the one where where he uses the target system without dictionaries) but I get the error <code>&#47;home&#47;Me&#47;simple_root_project&#47;SimpleExample.cxx:1:10: fatal error: TLorentzVector.h: No such file or directory  #include &lt;TLorentzVector.h&gt;           ^~~~~~~~~~~~~~~~~~ compilation terminated.</code>"}, {"owner": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 0, "creation_date": 1571399886, "post_id": 58422567, "comment_id": 103238451, "body": "It sounds like something may not have built/installed successfully when you compiled and install the ROOT from source? Did you notice any errors?"}, {"owner": {"reputation": 189, "user_id": 11342925, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OhfoTlzRIqE/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBK5JrK8tagNaecsQ9INaeaEhhKvQ/mo/photo.jpg?sz=128", "display_name": "fresh", "link": "https://stackoverflow.com/users/11342925/fresh"}, "reply_to_user": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 0, "creation_date": 1571400055, "post_id": 58422567, "comment_id": 103238539, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/201093/discussion-between-fresh-and-squareskittles\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 189, "user_id": 11342925, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OhfoTlzRIqE/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBK5JrK8tagNaecsQ9INaeaEhhKvQ/mo/photo.jpg?sz=128", "display_name": "fresh", "link": "https://stackoverflow.com/users/11342925/fresh"}, "is_accepted": true, "score": 0, "last_activity_date": 1571353362, "last_edit_date": 1571353362, "creation_date": 1571340578, "answer_id": 58439549, "question_id": 58422567, "link": "https://stackoverflow.com/questions/58422567/integrating-root-with-cmake/58439549#58439549", "title": "Integrating ROOT with CMake", "body": "<p>I modified my CmakeLists.txt file. It looks like this:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.10)\n\nproject(FirstProject)\n\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\nset(CMAKE_CXX_EXTENSIONS OFF)\n\nfile(GLOB src \"src/*.cpp\")\n\n# locating the ROOT package\nfind_package(ROOT 6.16 CONFIG REQUIRED)\n\ninclude_directories(${CMAKE_CURRENT_SOURCE_DIR}/include)\n\nadd_executable(main ${src})\nset_target_properties(main PROPERTIES LINKER_LANGUAGE CXX)\ntarget_compile_options(main PUBLIC -Wall)\ntarget_compile_options(main PUBLIC -Wextra)\ntarget_compile_options(main PUBLIC --std=c++17)\n\ntarget_link_libraries(main PUBLIC ROOT::Hist)\n</code></pre>\n\n<p>The error I get now is </p>\n\n<pre><code>In file included from /home/Me/Desktop/MyDirectory/Code/FirstProject/src/header.cpp:1:0:\n/home/Me/Desktop/MyDirectoory/Code/FirstProject/include/header.h:7:10: fatal error: TH1F.h: No such file or directory\n #include &lt;TH1F.h&gt;\n          ^~~~~~~~\ncompilation terminated.\n\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 11342925, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OhfoTlzRIqE/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBK5JrK8tagNaecsQ9INaeaEhhKvQ/mo/photo.jpg?sz=128", "display_name": "fresh", "link": "https://stackoverflow.com/users/11342925/fresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 58439549, "answer_count": 1, "score": 0, "last_activity_date": 1571353362, "creation_date": 1571265533, "question_id": 58422567, "link": "https://stackoverflow.com/questions/58422567/integrating-root-with-cmake", "title": "Integrating ROOT with CMake", "body": "<p>I am trying to use ROOT in my C++ project by I cannot get CMake to properly link the ROOT libraries. As of now, the project is only made up of a main.cpp file. Here's my CMakeLists.txt file:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.10)\n\nproject(FirstProject)\n\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\nset(CMAKE_CXX_EXTENSIONS OFF)\n\nfile(GLOB src \"src/*.cpp\")\n\n# telling CMake where to find the ROOT installation\nlist(APPEND CMAKE_PREFIX_PATH $ENV{ROOTSYS})\n\n# locating the ROOT package\nfind_package(ROOT REQUIRED COMPONENTS RIO Net Hist)\n\n# include ROOT functions and macros\ninclude_directories(${CMAKE_SOURCE_DIR} ${ROOT_INCLUDE_DIRS})\nadd_definitions(${ROOT_CXX_FLAGS})\n\nadd_executable(main ${src})\n# set_target_properties(main PROPERTIES LINKER_LANGUAGE CXX)\ntarget_compile_options(main PUBLIC -Wall)\ntarget_compile_options(main PUBLIC -Wextra)\ntarget_compile_options(main PUBLIC --std=c++17)\ntarget_compile_options(main PUBLIC -Iinclude)\n\ntarget_link_libraries(main ${ROOT_LIBRARIES})\n</code></pre>\n\n<p>When I try to include the \"TH1F.h\" header in my main.cpp file, I get a ton of compile-time errors. Can anyone help me? Do I need to generate a dictionary?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 394, "user_id": 2023321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1iHEw.jpg?s=128&g=1", "display_name": "Eduardo Fernandes", "link": "https://stackoverflow.com/users/2023321/eduardo-fernandes"}, "edited": false, "score": 1, "creation_date": 1571265437, "post_id": 58422540, "comment_id": 103187275, "body": "You need to place the file with the executable of your application. Probably in you project folder in a Debug/bin folder."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1571265512, "post_id": 58422540, "comment_id": 103187294, "body": "Try using the full path for the file."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1571265533, "post_id": 58422540, "comment_id": 103187299, "body": "You&#39;ve likely run afoul of the <a href=\"https://en.wikipedia.org/wiki/Working_directory\" rel=\"nofollow noreferrer\">Working Directory</a>"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1571265543, "post_id": 58422540, "comment_id": 103187305, "body": "Write a temporary file from your &quot;main&quot;.  This will tell you where to place your data file."}, {"owner": {"reputation": 1056, "user_id": 585566, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/28d065c01caf33a7e23fdbf7f7ca352e?s=128&d=identicon&r=PG", "display_name": "SleepingSpider", "link": "https://stackoverflow.com/users/585566/sleepingspider"}, "edited": false, "score": 0, "creation_date": 1571266107, "post_id": 58422540, "comment_id": 103187451, "body": "Your executable should be in the same directory as <code>TextFile.txt</code> otherwise, you&#39;ll need to provide the full path."}, {"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 0, "creation_date": 1571267914, "post_id": 58422540, "comment_id": 103187854, "body": "If you hardcode the path like <code>C:\\User\\TextFile.txt</code> you need to escape the backslashes in the string literal. Replace each single backslash with two."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1571269747, "post_id": 58422540, "comment_id": 103188281, "body": "Yes, the IDE matters, the commenters don&#39;t use it. Project &gt; Properties &gt; Debugging, &quot;Working directory&quot; setting. The odds that you like $(ProjectDir) are not great in code like this. Although it is a very effective way to make the test data part of the project. Not what you want to do it seems (do consider it), so change it to get ahead"}], "owner": {"reputation": 17, "user_id": 8588638, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q39LgkhQNjU/AAAAAAAAAAI/AAAAAAAAADY/PdG0oSYaGvw/photo.jpg?sz=128", "display_name": "Israel Goldblatt", "link": "https://stackoverflow.com/users/8588638/israel-goldblatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 449, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571350597, "creation_date": 1571265321, "last_edit_date": 1571350597, "question_id": 58422540, "link": "https://stackoverflow.com/questions/58422540/reading-txt-file-in-visual-studio-2019-c", "title": "Reading txt file in Visual studio 2019 C++", "body": "<p>I am trying to open a file for this program. I have tried pathing it directly using examples like C:\\User... but for some reason it still says it can't find the file. I have looked on the internet as well as youtube to open files using C++ and its pretty straight forward. However I still can't get this .txt file to be read. Maybe it has to do with Visual Studio? </p>\n\n<pre><code>FILE* in_fp, * fopen();\n\n\nint main() {\n    if  ((in_fp = fopen(\"TextFile.txt\", \"r\")) == NULL)\n        printf(\"ERROR - cannot open front.in \\n\");\n    else\n{\n    getChar();\n    do {\n        lex();\n    } while (nextToken != EOF);\n}\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["java", "c++", "redirect", "cmd", "pipe"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 2, "creation_date": 1571265328, "post_id": 58422474, "comment_id": 103187244, "body": "What code have you tried? Can you <a href=\"https://stackoverflow.com/posts/58422474/edit\">edit your question</a> and show your best attempt?"}, {"owner": {"reputation": 27978, "user_id": 981744, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qJi4S.png?s=128&g=1", "display_name": "Erwin Bolwidt", "link": "https://stackoverflow.com/users/981744/erwin-bolwidt"}, "edited": false, "score": 2, "creation_date": 1571266206, "post_id": 58422474, "comment_id": 103187483, "body": "Show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of your current code. Hint: when you do <code>java -version</code>, Java responds on stderr (file descriptor 2), not on stdout (file descriptor 1). (which you can verify on the command line with a <code>&gt;</code> redirect for stdout and a <code>2&gt;</code> redirect for stderr)"}], "answers": [{"comments": [{"owner": {"reputation": 1049, "user_id": 882756, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5a3f7f896bb39fffe05701ded73d0df8?s=128&d=identicon&r=PG", "display_name": "Christian Wolf", "link": "https://stackoverflow.com/users/882756/christian-wolf"}, "edited": false, "score": 1, "creation_date": 1571317517, "post_id": 58433351, "comment_id": 103207183, "body": "You coud use of course also the <code>&amp;&gt;</code> symbol to get both stdout and stderr."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10699646"}, "is_accepted": false, "score": 1, "last_activity_date": 1571317720, "last_edit_date": 1571317720, "creation_date": 1571317389, "answer_id": 58433351, "question_id": 58422474, "link": "https://stackoverflow.com/questions/58422474/get-result-of-command-java-version-in-c/58433351#58433351", "title": "Get result of command java -version in c++", "body": "<p>The problem is that \"java -version\" responds on stderr, which must be redirected using 2> not >.</p>\n\n<p><strong>In conclusion</strong></p>\n\n<p>Write output to file using '2> filename.txt'</p>\n\n<pre><code>system(\"java -version &amp;&gt; temp.txt\");\n\nstd::ifstream fin(\"temp.txt\");\n\nstd::string Result = \"\";\nstd::string Line;\n\nwhile(getline(fin, Line))\n    Result+=Line;\n\nfin.close();\n</code></pre>\n\n<p>(Thanks to Erwin Bolwidt)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10699646"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1571319094, "creation_date": 1571264939, "last_edit_date": 1571319094, "question_id": 58422474, "link": "https://stackoverflow.com/questions/58422474/get-result-of-command-java-version-in-c", "title": "Get result of command java -version in c++", "body": "<p>I am trying to see whether or not the installed java version is good to run from c++. </p>\n\n<p>I looked everywhere, yet neither <a href=\"https://stackoverflow.com/questions/478898/how-do-i-execute-a-command-and-get-the-output-of-the-command-within-c-using-po\">pipes</a> nor redirecting the system() call using \"cmd + > txtfile.txt\" seem to work with the output of \"java -version\".</p>\n\n<p>I have no idea why, maybe the output stream can't be redirected? </p>\n\n<p>All help is very much appreciated!</p>\n"}, {"tags": ["c++"], "owner": {"reputation": 53, "user_id": 12035756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a1239708bb9eb9a0e7f5e3d2f349bdc?s=128&d=identicon&r=PG&f=1", "display_name": "CaptainDucko", "link": "https://stackoverflow.com/users/12035756/captainducko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 16, "favorite_count": 0, "closed_date": 1571264450, "answer_count": 0, "score": 1, "last_activity_date": 1571264382, "creation_date": 1571264382, "question_id": 58422389, "link": "https://stackoverflow.com/questions/58422389/create-a-static-class-function-that-takes-an-infinite-number-of-arguments", "closed_reason": "Duplicate", "title": "Create a static class function that takes an infinite number of arguments", "body": "<p>I am trying to create a function that takes an arbitary number of strings and then outputs them all on a single line. I want this function to be a static member function of my Utils class.</p>\n\n<pre><code>Utils::output(\"I\",\"am\",\"a\",\"sentence\"); // --console-output--&gt; I am a sentence\n</code></pre>\n\n<p>Here's what I've attempted:</p>\n\n<p><strong><em>Utils.h:</em></strong></p>\n\n<pre><code>class Utils{\npublic:\n    template&lt;typename First, typename ... Strings&gt;\n    static void output(First arg, const Strings&amp;... rest);\n};\n</code></pre>\n\n<p><strong><em>Utils.cpp:</em></strong></p>\n\n<pre><code>void Utils::output() {\n    std::cout&lt;&lt;std::endl;\n}\n\ntemplate&lt;typename First, typename ... Strings&gt;\nvoid Utils::output(First arg, const Strings&amp;... rest){\n    std::cout&lt;&lt;arg&lt;&lt;\" \";\n    outputs(rest...);\n}\n</code></pre>\n\n<p><strong><em>main.cpp:</em></strong></p>\n\n<pre><code>int main() {\n    Utils::output(\"I\",\"am\",\"a\",\"sentence\");\n    return 0;\n}\n</code></pre>\n\n<p>My project is currently not even compiling! I am getting this error:</p>\n\n<pre><code>error LNK2019: unresolved external symbol \"public: static void __cdecl Utils::output&lt;char const *,char [3],char [2],char [9]&gt;( referenced in function _main First.exe : fatal error LNK1120: 1 unresolved externals\n</code></pre>\n"}, {"tags": ["c++", "visual-studio"], "comments": [{"owner": {"reputation": 9494, "user_id": 5517378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/VWdPz.png?s=128&g=1", "display_name": "NutCracker", "link": "https://stackoverflow.com/users/5517378/nutcracker"}, "edited": false, "score": 1, "creation_date": 1571263500, "post_id": 58422256, "comment_id": 103186762, "body": "Have you added <code>#pragma once</code> (include guard) on top of the header file?"}, {"owner": {"reputation": 935, "user_id": 1459979, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/K2fhI.png?s=128&g=1", "display_name": "voxoid", "link": "https://stackoverflow.com/users/1459979/voxoid"}, "reply_to_user": {"reputation": 9494, "user_id": 5517378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/VWdPz.png?s=128&g=1", "display_name": "NutCracker", "link": "https://stackoverflow.com/users/5517378/nutcracker"}, "edited": false, "score": 0, "creation_date": 1571263560, "post_id": 58422256, "comment_id": 103186774, "body": "Yes, thanks, I should have mentioned that before; edited."}, {"owner": {"reputation": 9494, "user_id": 5517378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/VWdPz.png?s=128&g=1", "display_name": "NutCracker", "link": "https://stackoverflow.com/users/5517378/nutcracker"}, "edited": false, "score": 0, "creation_date": 1571263590, "post_id": 58422256, "comment_id": 103186785, "body": "Have you tried <a href=\"https://stackoverflow.com/a/32588641/5517378\">this</a>."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1571263614, "post_id": 58422256, "comment_id": 103186792, "body": "I recommend backing up and then playing a few rounds of divide and conquer on the file that&#39;s giving you grief. If hacking the file down to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> doesn&#39;t show you what the problem is, post the resulting code."}, {"owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1571263901, "post_id": 58422256, "comment_id": 103186877, "body": "The precompiled header file name can be configured for each source file. The default used to be <code>stdafx.h</code>."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 1, "creation_date": 1571263985, "post_id": 58422256, "comment_id": 103186897, "body": "Do you have a .cpp file (just one) in the project that <i>creates</i> the precompiled header, rather than <i>using</i> it?"}, {"owner": {"reputation": 935, "user_id": 1459979, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/K2fhI.png?s=128&g=1", "display_name": "voxoid", "link": "https://stackoverflow.com/users/1459979/voxoid"}, "reply_to_user": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1571265328, "post_id": 58422256, "comment_id": 103187243, "body": "@Adrian yes, pch.cpp is there."}, {"owner": {"reputation": 935, "user_id": 1459979, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/K2fhI.png?s=128&g=1", "display_name": "voxoid", "link": "https://stackoverflow.com/users/1459979/voxoid"}, "reply_to_user": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1571265339, "post_id": 58422256, "comment_id": 103187245, "body": "@Mark Ransom the default in the project template I used was pch.h; maybe this is an update."}, {"owner": {"reputation": 935, "user_id": 1459979, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/K2fhI.png?s=128&g=1", "display_name": "voxoid", "link": "https://stackoverflow.com/users/1459979/voxoid"}, "reply_to_user": {"reputation": 9494, "user_id": 5517378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/VWdPz.png?s=128&g=1", "display_name": "NutCracker", "link": "https://stackoverflow.com/users/5517378/nutcracker"}, "edited": false, "score": 0, "creation_date": 1571265345, "post_id": 58422256, "comment_id": 103187247, "body": "@NutCracker I do prefer pre-compiled headers though, rather than disabling them."}], "answers": [{"tags": [], "owner": {"reputation": 935, "user_id": 1459979, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/K2fhI.png?s=128&g=1", "display_name": "voxoid", "link": "https://stackoverflow.com/users/1459979/voxoid"}, "is_accepted": false, "score": 0, "last_activity_date": 1571265162, "creation_date": 1571265162, "answer_id": 58422512, "question_id": 58422256, "link": "https://stackoverflow.com/questions/58422256/visual-studio-c-compiler-error-unexpected-end-of-file-while-looking-for-preco/58422512#58422512", "title": "Visual Studio C++ compiler error &quot;Unexpected end of file while looking for precompiled header&quot;, even when including &quot;pch.h&quot;", "body": "<p>In my case, I had a corrupt cpp source file (a different one from where the error was occurring), caused by an earlier sudden power failure. It seems that once I recreated the corrupt file, the project was back into a valid state and the error went away the next time I built. ...It was a bit of a corner case, but you might clean/rebuild and check that nothing is corrupt.</p>\n"}], "owner": {"reputation": 935, "user_id": 1459979, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/K2fhI.png?s=128&g=1", "display_name": "voxoid", "link": "https://stackoverflow.com/users/1459979/voxoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571265416, "creation_date": 1571263412, "last_edit_date": 1571265416, "question_id": 58422256, "link": "https://stackoverflow.com/questions/58422256/visual-studio-c-compiler-error-unexpected-end-of-file-while-looking-for-preco", "title": "Visual Studio C++ compiler error &quot;Unexpected end of file while looking for precompiled header&quot;, even when including &quot;pch.h&quot;", "body": "<p>I'm using precompiled headers in my Visual Studio (2019) C++ project, and am including \"pch.h\" at the top of my source files, have <code>#pragma once</code> at the top of each header file, and a pch.cpp file (generated by the project template). Yet for one of the source files I get compiler error C1010: \"Unexpected end of file while looking for precompiled header. Did you forget to add '#include \"pch.h\"' to your source?\" What other causes are there for this error?</p>\n"}, {"tags": ["c++", "gcc", "embedded", "atmel", "linker-scripts"], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1571297626, "post_id": 58422649, "comment_id": 103195673, "body": "It rather sounds as if you have a stack overflow or runaway code, then managed to hide away that bug by changing memory locations."}, {"owner": {"reputation": 133, "user_id": 9206933, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z0GXhX8sxog/AAAAAAAAAAI/AAAAAAAAAA8/CAy5EME2IaA/photo.jpg?sz=128", "display_name": "June", "link": "https://stackoverflow.com/users/9206933/june"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1571305944, "post_id": 58422649, "comment_id": 103200279, "body": "@Lundin I don&#39;t think so, the only code I&#39;m running really is my own code (It&#39;s a bare metal application) and I can&#39;t imagine where that might be happening. however it could be, I recently ran into another strange issue where the LNL memory section completely stopped working forcing me to give up and place LNL into it&#39;s own section in rom0 which isn&#39;t a big deal but it&#39;s another strange quirk that happened for no reason. The project is all open source <a href=\"https://github.com/junebug12851/MetroM4_SamD51Basis\" rel=\"nofollow noreferrer\">github.com/junebug12851/MetroM4_SamD51Basis</a> but right now I&#39;ve only encountered 2 quirks and have quickly worked around them."}], "tags": [], "owner": {"reputation": 133, "user_id": 9206933, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z0GXhX8sxog/AAAAAAAAAAI/AAAAAAAAAA8/CAy5EME2IaA/photo.jpg?sz=128", "display_name": "June", "link": "https://stackoverflow.com/users/9206933/june"}, "is_accepted": false, "score": 0, "last_activity_date": 1571266272, "creation_date": 1571266272, "answer_id": 58422649, "question_id": 58422178, "link": "https://stackoverflow.com/questions/58422178/first-time-gcc-linker-script-for-microcontroller-compiles-but-doesnt-run/58422649#58422649", "title": "First time gcc linker script for microcontroller compiles but doesn&#39;t run", "body": "<p>It turns out after much experimentation, trial, and error that the ram section have to seemingly be \"relocate\" then \"bss\" then \"stack\" in that order.</p>\n\n<p>What I was trying to do was place \"bss\" above \"relocate\" and that caused everything to not work. So that's the answer but can anybody explain why \"bss\" has to be above \"relocate\". I did that because I was wanting static members to be placed at the top and I understand relocate is for non-static members.</p>\n"}], "owner": {"reputation": 133, "user_id": 9206933, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z0GXhX8sxog/AAAAAAAAAAI/AAAAAAAAAA8/CAy5EME2IaA/photo.jpg?sz=128", "display_name": "June", "link": "https://stackoverflow.com/users/9206933/june"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1571266272, "creation_date": 1571262947, "question_id": 58422178, "link": "https://stackoverflow.com/questions/58422178/first-time-gcc-linker-script-for-microcontroller-compiles-but-doesnt-run", "title": "First time gcc linker script for microcontroller compiles but doesn&#39;t run", "body": "<p>I created my first gcc linker script for a SAMD51J19 microcontroller through atmel studio and it compiles great without issues but when loaded into the device weird quirky errors happen. </p>\n\n<p>Sometimes it hard-faults, sometimes it doesn't, sometimes interrupts aren't sent to the handler, sometimes they are. Sometimes functions are run with nothing happening like it should and sometimes not. The debugger was all over the place, I didn't have any of these problems with the old stock linker code and I have no idea why it's happening.</p>\n\n<p>Most all of it was just re-used from the original file. Mainly what I did was add some spacing or better alignment between areas and moved some sections around that weren't mandatory placed there. For example Read-Only data at the end of rom bank 0 rather than the middle. so I really don't get why this is happening</p>\n\n<p>below is my linker script</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>OUTPUT_FORMAT(\"elf32-littlearm\", \"elf32-littlearm\", \"elf32-littlearm\")\nOUTPUT_ARCH(arm)\nSEARCH_DIR(.)\n\n/*\n * NVM = 2 Banks (512KB) (352KB usable) (160KB reserved for SEEPROM)\n * 1 Bank = 32 blocks (256K) and 16 Regions\n *    Bank 1 (Main) = 32 blocks (256K) and 16 Regions\n *    Bank 2 (Aux)  = 12 Blocks (96KB) and 6 Regions\n * 1 Region = 2 Blocks (16KB) (Protection Alignment)\n * 1 Block = 16 Pages (8KB) (Division Alignment)\n * 1 Page = 32 QWords (512B) (Section Alignment)\n * 1 QWord = 16 Bytes (Sub-Section Alignment)\n * 1 DWord = 8 Bytes\n * 1 Word  = 4 Bytes (Default Alignment)\n *\n * Alignments:\n * 4      Bytes: New piece\n * 16     Bytes: New Subsection\n * 512    Bytes: New Section\n * 8,192  Bytes: New division\n * 16,384 Bytes: New protection region\n*/\n\n/* Memory Spaces Definitions */\nMEMORY\n{\n  rom0     (rx)  : ORIGIN = 0x00000000, LENGTH = 0x0003F800 /*Rom Bank 0: Main Bank (For Code)*/\n    lnl      (rx)  : ORIGIN = 0x0003F800, LENGTH = 0x00000800 /*Load-N-Lock 0-Wait State Speed: 2KB*/\n\n  rom1     (rx)  : ORIGIN = 0x00040000, LENGTH = 0x00018000 /*Rom Bank 1: Aux Bank (For Data)*/\n  qspi     (rx)  : ORIGIN = 0x04000000, LENGTH = 0x01000000 /*External NVM: (Additional Aux Data on seperate chip)*/\n  ram      (rwx) : ORIGIN = 0x20000000, LENGTH = 0x00030000 /*Ram (Default RAM)*/\n  seeprom  (rx)  : ORIGIN = 0x44000000, LENGTH = 0x00010000 /*SEEPROM: Runtime Permanent Data*/\n  bkupram  (rwx) : ORIGIN = 0x47000000, LENGTH = 0x00002000 /*Backup Ram: Program Data*/\n}\n\n/* The stack size used by the application*/\nSTACK_SIZE = 0xC000;\n\n/* Section Definitions */\nSECTIONS\n{\n  /*\n    Program Code\n\n    Gameplan for .text output section\n\n    No support for exceptions or unwinding tables\n\n    Vectors go at start\n    Program Code is placed on the next QWord\n    Thumb/Arm Glue code is placed on the next QWord\n    Read-Only Data is placed in it's own page\n    Relocate Data is placed in it's own page\n  */\n  .text :\n  {\n    /*Start at top*/\n    . = 0x00000000;\n    _stext = .;\n    _sfixed = .;\n\n    /*Vector Table*/\n    /*Place Vectors at start of rom0 as required*/\n    KEEP(*(.vectors .vectors.*))\n\n    /*Program Code*/\n    . = ALIGN(16); /*New Subsection*/\n    *(.text .text.* .gnu.linkonce.t.*)\n\n    /*C &amp; C++ Special Generated Code, part of main program code*/\n\n    /*C++ Setup Code*/\n    . = ALIGN(4); /*New piece*/\n    KEEP(*(.init))\n\n    . = ALIGN(4); /*New piece*/\n    __preinit_array_start = .;\n    KEEP (*(.preinit_array))\n    __preinit_array_end = .;\n\n    . = ALIGN(4); /*New piece*/\n    __init_array_start = .;\n    KEEP (*(SORT(.init_array.*)))\n    KEEP (*(.init_array))\n    __init_array_end = .;\n\n    /*C++ Constructor Code*/\n    . = ALIGN(4); /*New piece*/\n    KEEP (*crtbegin.o(.ctors))\n    KEEP (*(EXCLUDE_FILE (*crtend.o) .ctors))\n    KEEP (*(SORT(.ctors.*)))\n    KEEP (*crtend.o(.ctors))\n\n    /*C++ Teardown Code*/\n    . = ALIGN(4); /*New piece*/\n    KEEP(*(.fini))\n\n    . = ALIGN(4); /*New piece*/\n    __fini_array_start = .;\n    KEEP (*(.fini_array))\n    KEEP (*(SORT(.fini_array.*)))\n    __fini_array_end = .;\n\n    /*C++ Deconstructor Code*/\n    . = ALIGN(4); /*New piece*/\n    KEEP (*crtbegin.o(.dtors))\n    KEEP (*(EXCLUDE_FILE (*crtend.o) .dtors))\n    KEEP (*(SORT(.dtors.*)))\n    KEEP (*crtend.o(.dtors))\n\n    /*Thumb &lt;==&gt; ARM Code Translation Glue*/\n    . = ALIGN(16); /*New Subsection*/\n    *(.glue_7t) *(.glue_7)\n\n    /*Read-Only/Constant Data, placing in a new page*/\n    . = ALIGN(512); /*New Page*/\n    *(.rodata .rodata* .gnu.linkonce.r.*)\n\n    /*This is for relocating data, place it in it's own page*/\n    . = ALIGN(512); /*New Page*/\n    _placeRelocate = .;\n\n    _efixed = .;\n    _etext = .;\n  } &gt; rom0 /*These of course go in the main rom bank*/\n\n  /*\n    Rom 0 Custom Code\n\n    Gameplan for .rom0 output section\n\n    This is sort of a workarea for program-specific usage unrelated to generated\n    code. It needs to go into it's own block.\n  */\n  .rom0 (NOLOAD):\n  {\n    . = ALIGN(8192); /*New block*/\n    _srom0 = .;\n    *(.rom0*)\n    _erom0 = .;\n  } &gt; rom0\n\n  /*\n    Load-N-Lock 0-Wait State Speed\n\n    Gameplan for .lnl output section\n\n    LNL is placed in it's own reserved memory area of a specific size in rom0. Space is\n    immensely cramped and every byte counts. No alignment will be done.\n  */\n  .lnl (NOLOAD):\n  {\n    _slnl = .;\n    *(.lnl*)\n    _elnl = .;\n  } &gt; lnl /*Goes into it's own specific area*/\n\n  /*\n    Rom 1 Custom Code\n\n    Gameplan for .rom1 output section\n\n    Rom Bank 1 is more relaxed given the entire bank is for program usage.\n    This needs to be placed after the first page. The first page is reserved\n    for program-specific header data and work area.\n  */\n  .rom1 (NOLOAD):\n  {\n    . = 512; /*2nd page from start*/\n    _srom1 = .;\n    *(.rom1*)\n    _erom1 = .;\n  } &gt; rom1 /*Goes into rom bank 1*/\n\n  /*\n    QSPI Custom Code\n\n    Gameplan for .qspi output section\n\n    QSPI is similar to ROM1 in that it's just an area that can be used\n    for custom usage or work area.\n  */\n  .qspi (NOLOAD):\n  {\n    . = ALIGN(4); /*New piece*/\n    _sqspi = .;\n    *(.qspi*)\n    _eqspi = .;\n  } &gt; qspi /*Goes into QSPI*/\n\n  /*\n    Uninitialized Data\n\n    Gameplan for .bss output section\n\n    Uninitialized data goes into main RAM at the start\n  */\n  .bss (NOLOAD) :\n  {\n    . = ALIGN(4); /*New piece*/\n    _sbss = . ;\n    _szero = .;\n    *(.bss .bss.*) /*Place BSS Data at start of RAM*/\n\n    . = ALIGN(4); /*New piece*/\n    *(COMMON) /*Place common data after*/\n    _ebss = . ;\n    _ezero = .;\n\n    /*Relocate data comes after bss*/\n    . = ALIGN(4); /*New piece*/\n    _relocateStart = .;\n  } &gt; ram\n\n  /*\n    Relocate data\n\n    Gameplan for .relocate output section\n\n    This needs to be placed at rom0 in it's own defined section. It will\n    be copied to the end of bss.\n  */\n  .relocate : AT (_placeRelocate)\n  {\n    . = ALIGN(4); /*New piece*/\n    _srelocate = .;\n    *(.data .data.*);\n\n    . = ALIGN(4); /*New Piece*/\n    *(.ramfunc .ramfunc.*);\n    _erelocate = .;\n  } &gt; ram /*Place in RAM*/\n\n  /*\n    Stack data\n\n    Gameplan for .stack output section\n\n    Placed at end of RAM an empty area large enough for the stack\n  */\n  .stack (NOLOAD):\n  {\n    . = ALIGN(8); /*New larger piece*/\n    _sstack = .; /*Begin Stack*/\n\n    . = . + STACK_SIZE; /*Insert large blank area for stack*/\n\n    . = ALIGN(8); /*New larger piece*/\n    _estack = .; /*End stack placement*/\n  } &gt; ram\n\n  /*\n    SEEPROM Data\n\n    Gameplan for .seeprom output section\n\n    The SEEPROM section is like rom1 just byte-writable rather than\n    block/page eraseable/writable. Unlike ROM1 however SEEPROM can start\n    at the beginning.\n  */\n  .seeprom (NOLOAD):\n  {\n    . = ALIGN(4); /*New piece*/\n    _seeprom = .;\n    *(.seeprom*)\n    _eseeprom = .;\n  } &gt; seeprom /*Goes into seeprom area*/\n\n  /*\n    Custom Backup RAM\n\n    Gameplan for .bkupram output section\n\n    Like ROM1 and SEEPROM, this is another potential usage area.\n  */\n  .bkupram (NOLOAD):\n  {\n    . = ALIGN(4); /*New piece*/\n    _sbkupram = .;\n    *(.bkupram*)\n    _ebkupram = .;\n  } &gt; bkupram /*Goes into bkupram area*/\n\n  . = ALIGN(4); /*New piece*/\n  _end = . ; /*End of everything*/\n}\n</code></pre>\n\n<p>And the original file here that came with the ide</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>OUTPUT_FORMAT(\"elf32-littlearm\", \"elf32-littlearm\", \"elf32-littlearm\")\nOUTPUT_ARCH(arm)\nSEARCH_DIR(.)\n\n/* Memory Spaces Definitions */\nMEMORY\n{\n  rom0     (rx)  : ORIGIN = 0x00000000, LENGTH = 0x0003F800\n  lnl      (rx)  : ORIGIN = 0x0003F800, LENGTH = 0x00000800 /*Load-N-Lock 0-Wait State Caching: 2KB*/\n  rom1     (rx)  : ORIGIN = 0x00040000, LENGTH = 0x00018000\n  qspi     (rx)  : ORIGIN = 0x04000000, LENGTH = 0x01000000\n  ram      (rwx) : ORIGIN = 0x20000000, LENGTH = 0x00030000\n  seeprom  (rx)  : ORIGIN = 0x44000000, LENGTH = 0x00010000\n  bkupram  (rwx) : ORIGIN = 0x47000000, LENGTH = 0x00002000\n}\n\n/* The stack size used by the application. NOTE: you need to adjust according to your application. */\nSTACK_SIZE = DEFINED(STACK_SIZE) ? STACK_SIZE : DEFINED(__stack_size__) ? __stack_size__ : 0xC000;\n\n/* Section Definitions */\nSECTIONS\n{\n    .text :\n    {\n        . = ALIGN(4);\n        _sfixed = .;\n        KEEP(*(.vectors .vectors.*))\n        *(.text .text.* .gnu.linkonce.t.*)\n        *(.glue_7t) *(.glue_7)\n        *(.rodata .rodata* .gnu.linkonce.r.*)\n        *(.ARM.extab* .gnu.linkonce.armextab.*)\n\n        /* Support C constructors, and C destructors in both user code\n           and the C library. This also provides support for C++ code. */\n        . = ALIGN(4);\n        KEEP(*(.init))\n        . = ALIGN(4);\n        __preinit_array_start = .;\n        KEEP (*(.preinit_array))\n        __preinit_array_end = .;\n\n        . = ALIGN(4);\n        __init_array_start = .;\n        KEEP (*(SORT(.init_array.*)))\n        KEEP (*(.init_array))\n        __init_array_end = .;\n\n        . = ALIGN(4);\n        KEEP (*crtbegin.o(.ctors))\n        KEEP (*(EXCLUDE_FILE (*crtend.o) .ctors))\n        KEEP (*(SORT(.ctors.*)))\n        KEEP (*crtend.o(.ctors))\n\n        . = ALIGN(4);\n        KEEP(*(.fini))\n\n        . = ALIGN(4);\n        __fini_array_start = .;\n        KEEP (*(.fini_array))\n        KEEP (*(SORT(.fini_array.*)))\n        __fini_array_end = .;\n\n        KEEP (*crtbegin.o(.dtors))\n        KEEP (*(EXCLUDE_FILE (*crtend.o) .dtors))\n        KEEP (*(SORT(.dtors.*)))\n        KEEP (*crtend.o(.dtors))\n\n        . = ALIGN(4);\n        _efixed = .;            /* End of text section */\n    } &gt; rom0\n\n    /* .ARM.exidx is sorted, so has to go in its own output section.  */\n    PROVIDE_HIDDEN (__exidx_start = .);\n    .ARM.exidx :\n    {\n      *(.ARM.exidx* .gnu.linkonce.armexidx.*)\n    } &gt; rom0\n    PROVIDE_HIDDEN (__exidx_end = .);\n\n    . = ALIGN(4);\n    _etext = .;\n\n    .lnl :\n    {\n      /*. = ALIGN(4);*/\n        __lnl_start__ = .;\n        *(.lnl*)\n        __lnl_end__ = .;\n    } &gt; lnl\n\n    .rom1 (NOLOAD):\n    {\n        . = ALIGN(8);\n        _rom1 = .;\n        *(.rom1 .rom1.*);\n        . = ALIGN(8);\n        _rom1 = .;\n    } &gt; rom1\n\n    .seeprom (NOLOAD):\n    {\n        . = ALIGN(8);\n        _seeprom = .;\n        *(.seeprom .seeprom.*);\n        . = ALIGN(8);\n        _eseeprom = .;\n    } &gt; seeprom\n\n    .relocate : AT (_etext)\n    {\n        . = ALIGN(4);\n        _srelocate = .;\n        *(.ramfunc .ramfunc.*);\n        *(.data .data.*);\n        . = ALIGN(4);\n        _erelocate = .;\n    } &gt; ram\n\n    .bkupram (NOLOAD):\n    {\n        . = ALIGN(8);\n        _sbkupram = .;\n        *(.bkupram .bkupram.*);\n        . = ALIGN(8);\n        _ebkupram = .;\n    } &gt; bkupram\n\n    .qspi (NOLOAD):\n    {\n        . = ALIGN(8);\n        _sqspi = .;\n        *(.qspi .qspi.*);\n        . = ALIGN(8);\n        _eqspi = .;\n    } &gt; qspi\n\n    /* .bss section which is used for uninitialized data */\n    .bss (NOLOAD) :\n    {\n        . = ALIGN(4);\n        _sbss = . ;\n        _szero = .;\n        *(.bss .bss.*)\n        *(COMMON)\n        . = ALIGN(4);\n        _ebss = . ;\n        _ezero = .;\n    } &gt; ram\n\n    /* stack section */\n    .stack (NOLOAD):\n    {\n        . = ALIGN(8);\n        _sstack = .;\n        . = . + STACK_SIZE;\n        . = ALIGN(8);\n        _estack = .;\n    } &gt; ram\n\n    . = ALIGN(4);\n    _end = . ;\n}\n</code></pre>\n"}, {"tags": ["c++", "file-io", "char"], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 3, "last_activity_date": 1571262558, "last_edit_date": 1571262558, "creation_date": 1571262194, "answer_id": 58422056, "question_id": 58422011, "link": "https://stackoverflow.com/questions/58422011/how-to-read-one-character-at-a-time-from-text-file/58422056#58422056", "title": "How to read one character at a time from text file", "body": "<pre><code>inFile &gt;&gt; newLine;\n</code></pre>\n\n<p>This reads everything until a whitespace character. If your file contains all the characters in one line and contains no white spaces, it makes sense that the above line reads the contents of the entire file.</p>\n\n<p>To read one character at a time, use</p>\n\n<pre><code>char c = inFile.get();\n</code></pre>\n\n<p>Your inner loop would be:</p>\n\n<pre><code>for (cols = 1; cols &lt;= colvalue; cols++)\n{\n    char c = inFile.get();\n    cout &lt;&lt; c;\n}\n</code></pre>\n\n<p>See the documentation for <a href=\"https://en.cppreference.com/w/cpp/io/basic_istream/get\" rel=\"nofollow noreferrer\"><code>istream::get()</code></a> for additional info.</p>\n"}], "owner": {"reputation": 41, "user_id": 11312996, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o_2C0ybTK6U/AAAAAAAAAAI/AAAAAAAAAZ0/bnJH5SgSiO8/photo.jpg?sz=128", "display_name": "Jake M", "link": "https://stackoverflow.com/users/11312996/jake-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571262558, "creation_date": 1571261839, "last_edit_date": 1571262430, "question_id": 58422011, "link": "https://stackoverflow.com/questions/58422011/how-to-read-one-character-at-a-time-from-text-file", "title": "How to read one character at a time from text file", "body": "<p>Here is my function that has the following code in it. Note: It's already declared in the main and runs perfectly fine.</p>\n\n<pre><code>void displaySeatingChart(char seats[][colvalue], float prices[rowvalue])\n{\n    string filename = \"seatingChart.dat\";\n    ifstream inFile(filename);\n\n    for (rows = 1; rows &lt;= rowvalue; rows++)\n    {\n        string newLine;\n        cout &lt;&lt; \"Row #\" &lt;&lt; rows &lt;&lt; \"\\t\";\n        for (cols = 1; cols &lt;= colvalue; cols++)\n        {\n            inFile &gt;&gt; newLine;\n            cout &lt;&lt; newLine;\n        }\n        cout &lt;&lt; endl;\n    }\n}\n</code></pre>\n\n<p><code>rows</code> is 15 and <code>cols</code> is 30. My problem is that the <code>cout &lt;&lt; newline</code> prints literally the entire file (which is basically all #). How can I print just 15 characters and not like 1500?</p>\n"}, {"tags": ["c++", "xcode", "doubly-linked-list"], "comments": [{"owner": {"reputation": 9494, "user_id": 5517378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/VWdPz.png?s=128&g=1", "display_name": "NutCracker", "link": "https://stackoverflow.com/users/5517378/nutcracker"}, "edited": false, "score": 1, "creation_date": 1571261808, "post_id": 58421967, "comment_id": 103186208, "body": "Have you tried <a href=\"https://stackoverflow.com/a/43801476/5517378\">this</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 3, "creation_date": 1571263338, "post_id": 58421967, "comment_id": 103186710, "body": "There is almost always more error message than what&#39;s been provided. Find it and it might even tell you what you need to do. If not, add it to the question."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1571264005, "post_id": 58421967, "comment_id": 103186903, "body": "Please edit your post with the <i>complete</i> declaration of the <code>Node</code> class.  The source file says it is a template class, but your snippet may show otherwise."}, {"owner": {"reputation": 1, "user_id": 12229105, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6zM-gWbomzQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdzoSxplmU2R3Od1kL3Hn2peWuSNg/photo.jpg?sz=128", "display_name": "Dan Dharta", "link": "https://stackoverflow.com/users/12229105/dan-dharta"}, "reply_to_user": {"reputation": 9494, "user_id": 5517378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/VWdPz.png?s=128&g=1", "display_name": "NutCracker", "link": "https://stackoverflow.com/users/5517378/nutcracker"}, "edited": false, "score": 0, "creation_date": 1571411724, "post_id": 58421967, "comment_id": 103244891, "body": "@NutCracker not yet, i&#39;ll get to it asap."}, {"owner": {"reputation": 1, "user_id": 12229105, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6zM-gWbomzQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdzoSxplmU2R3Od1kL3Hn2peWuSNg/photo.jpg?sz=128", "display_name": "Dan Dharta", "link": "https://stackoverflow.com/users/12229105/dan-dharta"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1571437956, "post_id": 58421967, "comment_id": 103254578, "body": "@ThomasMatthews I am very sorry as I am fairly new to coding. What do you mean by snippet? I have figured that the problem is that I am unable to use a template class in my main program. So I am now looking for a way to allow me to use template in the main. Thank you though!!"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1571441894, "post_id": 58421967, "comment_id": 103255278, "body": "@DanDharta:  &quot;Snippet&quot; -- small portion of larger code."}], "owner": {"reputation": 1, "user_id": 12229105, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6zM-gWbomzQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdzoSxplmU2R3Od1kL3Hn2peWuSNg/photo.jpg?sz=128", "display_name": "Dan Dharta", "link": "https://stackoverflow.com/users/12229105/dan-dharta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571433670, "creation_date": 1571261491, "last_edit_date": 1571433670, "question_id": 58421967, "link": "https://stackoverflow.com/questions/58421967/linker-command-failed-with-exit-code-1-use-v-to-see-invocation-from-my-code", "title": "Linker command failed with exit code 1 (use -v to see invocation) from my code", "body": "<p><a href=\"https://i.stack.imgur.com/0AGAx.png\" rel=\"nofollow noreferrer\">enter image description here</a>My code that I recently build have this message :</p>\n\n<blockquote>\n  <p>clang: error: linker command failed with exit code 1 (use -v to see invocation)</p>\n</blockquote>\n\n<p>after I build the whole project.</p>\n\n<p>I have tried:</p>\n\n<ul>\n<li>clean the build and build</li>\n<li>I have saved my project file as workspace file and ran the file</li>\n<li>In build settings there is no metaDataLevel so I can't flag it to None</li>\n</ul>\n\n<p>Node.h</p>\n\n<pre><code>template&lt;class dataType&gt;\nclass Node {\nprivate:\n    dataType data;\n    Node* next;\n    Node* prev;\npublic:\n    Node();\n    Node(dataType);\n\n    bool setNext(Node*);\n    bool setPrev(Node*);\n    Node* getNext() const;\n    Node* getPrev() const;\n    void setData(const dataType&amp;);\n    dataType getData() const;\n    bool add(const dataType);\n    bool remove(const dataType);\n\n    ~Node();\n};\n\ntemplate&lt;class dataType&gt;\nNode&lt;dataType&gt;::Node()\n{\n    next = nullptr;\n    prev = nullptr;\n}\n</code></pre>\n\n<p>I am not sure if this will help or not but i'll place the implementation below:</p>\n\n<pre><code>template&lt;class dataType&gt;\nNode&lt;dataType&gt;::Node(dataType d)\n{\n    data = d;\n    next = nullptr;\n    prev = nullptr;\n}\n\ntemplate&lt;class dataType&gt;\nbool Node&lt;dataType&gt;::setNext(Node* head)\n{\n    this-&gt;next = head;\n    return true;\n}\n\ntemplate&lt;class dataType&gt;\nbool Node&lt;dataType&gt;::setPrev(Node* head)\n{\n    this-&gt;prev = head;\n    return true;\n}    \n\ntemplate&lt;class dataType&gt;\nNode&lt;dataType&gt;* Node&lt;dataType&gt;::getNext() const\n{\n    return next;\n}\n\ntemplate&lt;class dataType&gt;\nNode&lt;dataType&gt;* Node&lt;dataType&gt;::getPrev() const\n{\n    return prev;\n}\n\ntemplate&lt;class dataType&gt;\nvoid Node&lt;dataType&gt;::setData(const dataType&amp; d){\n    this-&gt;data = d;\n}\n\ntemplate&lt;class dataType&gt;\ndataType Node&lt;dataType&gt;::getData() const\n{\n    return data;\n}\n\ntemplate&lt;class dataType&gt;\nbool Node&lt;dataType&gt;::add(const dataType d){\n    Node* dummy = new Node(d);\n    dummy-&gt;setNext(this);\n    this-&gt;setPrev(dummy);\n    dummy-&gt;setPrev(nullptr);\n    this = dummy;\n    return true;\n}\n\ntemplate&lt;class dataType&gt;\nbool Node&lt;dataType&gt;::remove(const dataType d){\n    Node* pointer = this;\n    while(pointer != nullptr)\n    {\n        if(pointer-&gt;getData() == d)\n        {\n            if(pointer-&gt;getPrev() == nullptr)\n            {\n                this = pointer-&gt;getNext();\n                pointer = pointer-&gt;getNext();\n                delete pointer-&gt;getPrev();\n                pointer-&gt;setPrev(nullptr);\n            }\n            else if(pointer-&gt;getNext() == nullptr)\n            {\n                pointer-&gt;getPrev()-&gt;setNext(nullptr);\n                delete pointer;\n                pointer = nullptr;\n            }\n            else\n            {\n                pointer-&gt;getPrev()-&gt;setNext(pointer-&gt;getNext());\n                pointer-&gt;getNext()-&gt;setPrev(pointer-&gt;getPrev());\n                Node* dummy = pointer;\n                pointer = pointer-&gt;getNext();\n                delete dummy;\n            }\n        }\n    }\n    return true;\n}\n\ntemplate&lt;class dataType&gt;\nNode&lt;dataType&gt;::~Node(){\n    Node* pointer = this;\n    Node* holder = this-&gt;getNext();\n    while (holder != nullptr)\n    {\n        delete pointer;\n        pointer = holder;\n        holder = holder-&gt;getNext();\n    }\n    delete pointer;\n    delete holder;\n}\n</code></pre>\n\n<p>here is the testing code i used:</p>\n\n<pre><code>int main(){\n    int v = 10;\n    string d = \"X\";\n    Node&lt;int&gt;* headInt = new Node&lt;int&gt;(v);\n    Node&lt;string&gt;* headString = new Node&lt;string&gt;();\n    headString-&gt;setData(d);\n    cout &lt;&lt; \"headInt contain\" &lt;&lt; headInt-&gt;getData() &lt;&lt; \", \";\n    cout &lt;&lt; \"headString contain\" &lt;&lt; headString-&gt;getData() &lt;&lt; endl &lt;&lt;     endl;\n\n    headInt-&gt;add(22);\n    headString-&gt;add(\"XXII\");\n    cout &lt;&lt; \"headInt contain\" &lt;&lt; headInt-&gt;getData() &lt;&lt; \", \";\n    cout &lt;&lt; \"headString contain\" &lt;&lt; headString-&gt;getData() &lt;&lt; endl &lt;&lt; endl;\n\n    headInt-&gt;remove(22);\n    headString-&gt;remove(\"XXII\");\n    cout &lt;&lt; \"headInt contain\" &lt;&lt; headInt-&gt;getData() &lt;&lt; \", \";\n    cout &lt;&lt; \"headString contain\" &lt;&lt; headString-&gt;getData() &lt;&lt; endl &lt;&lt; endl;\n}\n</code></pre>\n\n<p>I am expecting to have this as my result :</p>\n\n<pre><code>headInt contain 10,\nheadString contain X\n\nheadInt contain 22,\nheadString contain XXII\n\nheadInt contain 10,\nheadString contain X\n</code></pre>\n"}, {"tags": ["c++", "metaprogramming", "variadic-templates"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1571260896, "post_id": 58421826, "comment_id": 103185919, "body": "Does <code>OptionalFunctionTwo&lt;std::string&gt;(true, std::make_tuple(Message), TestLambda); </code> work? Sometimes template deduction is just too complex and you have to specify the arguments explictly."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1571261015, "post_id": 58421826, "comment_id": 103185959, "body": "@RemyLebeau It can&#39;t work.  A lambda is not a <code>std::function</code> so deduction will always fail."}, {"owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "edited": false, "score": 1, "creation_date": 1571261140, "post_id": 58421826, "comment_id": 103186004, "body": "Also <code>MyFunction(Arguments)</code> needs to be <code>std::apply(MyFunction, Arguments)</code> (C++17 or make your own or use parameter pack directly without the tuple)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1571261465, "post_id": 58421826, "comment_id": 103186130, "body": "Does <a href=\"https://stackoverflow.com/a/53326317/10957435\">this</a> help?"}], "owner": {"reputation": 1101, "user_id": 221801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb1e98402fc251dcd74dd7488f0615c1?s=128&d=identicon&r=PG", "display_name": "Lockyer", "link": "https://stackoverflow.com/users/221801/lockyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1571260810, "answer_count": 0, "score": 0, "last_activity_date": 1571260836, "creation_date": 1571260568, "question_id": 58421826, "link": "https://stackoverflow.com/questions/58421826/is-it-possible-to-have-a-variadic-template-where-one-argument-is-a-paramater-pac", "closed_reason": "Duplicate", "title": "Is it possible to have a variadic template where one argument is a paramater pack, and the next is an std::function of the same parameter pack?", "body": "<p>Here's what I'm attempting to do, it seems to compile, but I'm unable to get my calling code to compile <code>OptionalFunctionTwo</code> :</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;tuple&gt;\n\nvoid OptionalFunction(bool Enabled,\n    std::function&lt;void()&gt; MyFunction) {\n  if (Enabled) {\n    MyFunction();\n  }\n}\n\ntemplate&lt;typename ...Args&gt;\nvoid OptionalFunctionTwo(bool Enabled, std::tuple&lt;Args...&gt; Arguments, std::function&lt;void(Args...)&gt; MyFunction) {\n  if (Enabled) {\n    MyFunction(Arguments);\n  }\n}\n\nint main(int argc, char** argv) {\n  auto TestLambda = [](std::string Message) { std::cout &lt;&lt; Message &lt;&lt; std::endl; };\n\n  std::string Message = \"Hello World\";\n  OptionalFunction(true, std::bind(TestLambda, Message));\n\n  OptionalFunctionTwo(true, std::make_tuple(Message), TestLambda);\n\n  return 0;\n}\n</code></pre>\n\n<p>The bind version works, but I'm wondering if there's a cleaner way to achieve the same effect without the bind, or the tuple. I can't even get the tuple to work for the clalling code so even knowing what's going on there would be interesting.</p>\n\n<p>Here are the errors I'm seeing:</p>\n\n<pre><code>error C2672:  'OptionalFunctionTwo': no matching overloaded function found\nerror C2784:  'void OptionalFunctionTwo(bool,std::tuple&lt;_Types...&gt;,std::function&lt;void(Args...)&gt;)': could not deduce template argument for 'std::function&lt;void(Args...)&gt;' from 'main::&lt;lambda_58265157e572a7c9669a130a4f982446&gt;'\nmessage :  see declaration of 'OptionalFunctionTwo'\n</code></pre>\n"}, {"tags": ["c++", "while-loop", "binary-search-tree", "ifstream"], "comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1571260099, "post_id": 58421528, "comment_id": 103185626, "body": "Read a line at a time. For lines with text that represents numbers, construct an <code>std::ostringstream</code> from the line, and extract numeric values from that."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 12228957, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KnwlLUUDzfE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rewHo-fFulDVhgoZyGYjY6tdH3W7A/photo.jpg?sz=128", "display_name": "displayname", "link": "https://stackoverflow.com/users/12228957/displayname"}, "edited": false, "score": 0, "creation_date": 1571260094, "post_id": 58421695, "comment_id": 103185624, "body": "Thank you! That worked. Could you possibly explain what you mean by  the error state of the input stream?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 15, "user_id": 12228957, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KnwlLUUDzfE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rewHo-fFulDVhgoZyGYjY6tdH3W7A/photo.jpg?sz=128", "display_name": "displayname", "link": "https://stackoverflow.com/users/12228957/displayname"}, "edited": false, "score": 0, "creation_date": 1571260303, "post_id": 58421695, "comment_id": 103185691, "body": "@displayname, when you execute <code>inFile &gt;&gt; num</code> after the number are read and the <code>$</code> character is next in the input stream, <code>inFile</code> is in a state of error -- it was not able to successfully extract the number from the input stream."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 1, "last_activity_date": 1571259887, "creation_date": 1571259887, "answer_id": 58421695, "question_id": 58421528, "link": "https://stackoverflow.com/questions/58421528/how-do-you-read-separate-lines-of-integers-from-file-by-ignoring-separate-lines/58421695#58421695", "title": "How do you read separate lines of integers from file by ignoring separate lines with a single character?", "body": "<p>When you are done with the loops that read the numbers, add a line to clear the error state of the input stream. Without that, no subsequent reading operations are performed.</p>\n\n<pre><code>while(inFile &gt;&gt; num)\n{\n   b.insert(num);\n   cout &lt;&lt; num &lt;&lt; endl; //output testing - the first line was successfully output so I think this part is fine\n}\n\ninFile.clear();           // ADD THIS LINE\ninFile.ignore(500, '$');\n\nwhile(inFile &gt;&gt; num) //this while loop is never entered\n{\n    b.search(num);\n}\n\ninFile.clear();           // ADD THIS LINE\ninFile.ignore(500, '\\n');\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 12228957, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KnwlLUUDzfE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rewHo-fFulDVhgoZyGYjY6tdH3W7A/photo.jpg?sz=128", "display_name": "displayname", "link": "https://stackoverflow.com/users/12228957/displayname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 58421695, "answer_count": 1, "score": -1, "last_activity_date": 1571259887, "creation_date": 1571259039, "last_edit_date": 1571259266, "question_id": 58421528, "link": "https://stackoverflow.com/questions/58421528/how-do-you-read-separate-lines-of-integers-from-file-by-ignoring-separate-lines", "title": "How do you read separate lines of integers from file by ignoring separate lines with a single character?", "body": "<p>I am working on a program dealing with binary search trees. I have a simple text file that looks like this:</p>\n\n<pre><code>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15\n$\n5 4 3 5 7 13\n$\n11 6 7 2 12 6\n</code></pre>\n\n<p>The first line contains integers to be inserted into the tree, the third line is integers to be searched, and the fifth line is integers to be removed. The second and fourth lines are meant to mark the separation of the other lines. They contain a single character '$'. \nI am struggling with how to ignore the second and fourth lines. I have three while loops separated with two ignore statements. Upon testing, it seems that the second and third while loops are never entered. I'd appreciate any help - my code is below.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\n#include &lt;string&gt;\n#include &lt;fstream&gt;\n#include \"main.h\"\n\n\nint main(int argc, char *argv[])\n{    \n    string filename = \"\";\n    ifstream inFile;\n\n    filename = argv[1];\n    inFile.open(filename.c_str());\n\n    BST b;\n    int num;\n\n    while(inFile &gt;&gt; num)\n    {\n       b.insert(num);\n       cout &lt;&lt; num &lt;&lt; endl; //output testing - the first line was successfully output so I think this part is fine\n    }\n\n    inFile.ignore(500, '$');\n\n    while(inFile &gt;&gt; num) //this while loop is never entered\n    {\n        b.search(num);\n    }\n    inFile.ignore(500, '\\n');\n\n    while(inFile &gt;&gt; num) //this while loop is never entered\n    {\n        b.remove(num);\n    }\n\n    inFile.close();  \n}\n</code></pre>\n"}, {"tags": ["c++", "global-variables"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1571259441, "post_id": 58421524, "comment_id": 103185394, "body": "<i>&quot;...All non-local variables with static storage duration are initialized as part of program startup, before the execution of the main function begins (unless deferred, see below)....&quot;</i>   see <a href=\"https://en.cppreference.com/w/cpp/language/initialization#Non-local_variables\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1617, "user_id": 6864265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01bd0f9716eca1ad35cf30c47ae8f6f?s=128&d=identicon&r=PG&f=1", "display_name": "Itachi Uchiwa", "link": "https://stackoverflow.com/users/6864265/itachi-uchiwa"}, "edited": false, "score": 0, "creation_date": 1571259741, "post_id": 58421624, "comment_id": 103185514, "body": "Yea it is on global scope. So you mean even if <code>Perim</code> is still blocking then <code>y</code> is initialized to 0?"}], "tags": [], "owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "is_accepted": true, "score": 2, "last_activity_date": 1571259517, "creation_date": 1571259517, "answer_id": 58421624, "question_id": 58421524, "link": "https://stackoverflow.com/questions/58421524/c-primer-5-ed-global-objects/58421624#58421624", "title": "C++ primer 5 Ed Global objects", "body": "<p>If your posted code is in the global <code>namespace</code> then <code>y</code> will be allocated and set to <code>0</code> before <code>main</code> is run.  It can only be used, however, after the line it is declared and defined on.</p>\n"}], "owner": {"reputation": 1617, "user_id": 6864265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01bd0f9716eca1ad35cf30c47ae8f6f?s=128&d=identicon&r=PG&f=1", "display_name": "Itachi Uchiwa", "link": "https://stackoverflow.com/users/6864265/itachi-uchiwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 58421624, "answer_count": 1, "score": 0, "last_activity_date": 1571259517, "creation_date": 1571259033, "question_id": 58421524, "link": "https://stackoverflow.com/questions/58421524/c-primer-5-ed-global-objects", "title": "C++ primer 5 Ed Global objects", "body": "<p>In C++ primer 5 Ed Chapter 12 The: Dynamic memory. It is said: \"static objects are allocated before they\nare used, and they are destroyed when the program ends.\"</p>\n\n<p>Does this mean the global objects are defined and initialized before control passes by their declaration.</p>\n\n<p>I have this example:</p>\n\n<pre><code>constexpr double PI = 3.14;\n\ndouble Perim(double rad) {\n    std::cin.get(); // I want to block here waiting for user interaction\n    return rad * 2 * PI;\n}\n\nconstexpr double radius = 4.16;\ndouble perim = Perim(radius); // Perim will blcok until user presses a key\nint y;\n</code></pre>\n\n<p>So above is <code>y</code> created and initialized before user presses a key or it waits until control passes by its definition?</p>\n"}, {"tags": ["c++", "multithreading", "sockets"], "comments": [{"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1571259159, "post_id": 58421487, "comment_id": 103185272, "body": "I&#39;m still quite new to the Standard Library and the <code>thread</code> class - but it looks to me like you are trying to re-create the same <code>thread</code> object 25 times."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1571259326, "post_id": 58421487, "comment_id": 103185343, "body": "@Adrian &quot;<i>but it looks to me like you are trying to re-create the same thread object 25 times.</i>&quot; What do you mean by &quot;re-create&quot;? It tries to create 25 threads, each going out of scope, at each iteration, of the loop."}, {"owner": {"reputation": 748, "user_id": 8815160, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6a3a80f07f1a3b8cd2b75e2c9a540ef9?s=128&d=identicon&r=PG&f=1", "display_name": "J. Adam", "link": "https://stackoverflow.com/users/8815160/j-adam"}, "reply_to_user": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1571259417, "post_id": 58421487, "comment_id": 103185383, "body": "@Adrian Well Isn&#39;t it creating new instance at every loop?"}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1571259571, "post_id": 58421487, "comment_id": 103185444, "body": "@AlgirdasPreid\u017eius Like I said, I&#39;m new to this sort of stuff!"}], "owner": {"reputation": 748, "user_id": 8815160, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6a3a80f07f1a3b8cd2b75e2c9a540ef9?s=128&d=identicon&r=PG&f=1", "display_name": "J. Adam", "link": "https://stackoverflow.com/users/8815160/j-adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "closed_date": 1571259375, "answer_count": 0, "score": 0, "last_activity_date": 1571258871, "creation_date": 1571258871, "question_id": 58421487, "link": "https://stackoverflow.com/questions/58421487/using-thread-goes-wrong-and-calls-abort-method-and-stops-my-application", "closed_reason": "Duplicate", "title": "Using thread goes wrong and calls abort() method and stops my application", "body": "<p>After i added the for loop which creates multiple threads in the main method the application broke. Any idea what the issue here is?</p>\n\n<p>It's an simple application that opens a socket. I want to do this multple times to test my server.</p>\n\n<pre><code>    #include \"pch.h\"\n#include &lt;iostream&gt;\n#include &lt;winsock2.h&gt;\n#include &lt;WS2tcpip.h&gt;\n#include &lt;string&gt;\n#include &lt;thread&gt; \n#pragma comment(lib,\"ws2_32.lib\")\n\nusing namespace std;\nvoid myFunc() {\n    while (true) {\n\n        string ipAddress = \"127.0.0.1\";         // IP Address of the server\n        int port = 11111;                       // Listening port # on the server\n\n        WSADATA WsaDat;\n        if (WSAStartup(MAKEWORD(2, 2), &amp;WsaDat) != 0)\n        {\n            std::cout &lt;&lt; \"Winsock error - Winsock initialization failed\\r\\n\";\n            WSACleanup();\n            system(\"PAUSE\");\n            return;\n        }\n\n        // Create our socket\n        SOCKET Socket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\n        if (Socket == INVALID_SOCKET)\n        {\n            std::cout &lt;&lt; \"Winsock error - Socket creation Failed!\\r\\n\";\n            WSACleanup();\n            system(\"PAUSE\");\n            return;\n        }\n\n        sockaddr_in hint;\n        hint.sin_family = AF_INET;\n        hint.sin_port = htons(port);\n        inet_pton(AF_INET, ipAddress.c_str(), &amp;hint.sin_addr);\n\n        // Connect to server\n        int connResult = connect(Socket, (sockaddr*)&amp;hint, sizeof(hint));\n        if (connResult == SOCKET_ERROR)\n        {\n            cerr &lt;&lt; \"Can't connect to server, Err #\" &lt;&lt; WSAGetLastError() &lt;&lt; endl;\n            closesocket(Socket);\n            WSACleanup();\n            return;\n        }\n    }\n}\n\n\nint main()\n{\n    std:cout &lt;&lt; \"Application started!\\n\";\n    for (int i = 0; i &lt; 25; i++) {\n        thread _newThread(myFunc);\n    }\n}\n</code></pre>\n\n<p>Cpp isn't my programming language. I wrote a similair application in c# and it worked fine. Any idea what i'm doing wrong here?</p>\n\n<p>What am i trying to accomplish?</p>\n\n<ul>\n<li>Opening Socket connection multiple times</li>\n<li>Using threads to speed up the process</li>\n<li>No need to send/receive data</li>\n<li>Sockets should stay connected</li>\n</ul>\n"}, {"tags": ["c++", "pointers", "memory"], "comments": [{"owner": {"reputation": 394, "user_id": 2023321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1iHEw.jpg?s=128&g=1", "display_name": "Eduardo Fernandes", "link": "https://stackoverflow.com/users/2023321/eduardo-fernandes"}, "edited": false, "score": 2, "creation_date": 1571259171, "post_id": 58421480, "comment_id": 103185276, "body": "Will you return the pointer to outside of the function?"}, {"owner": {"reputation": 10088, "user_id": 21028, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/996a5828870fa84ad3a597f7935a9a5e?s=128&d=identicon&r=PG", "display_name": "csl", "link": "https://stackoverflow.com/users/21028/csl"}, "edited": false, "score": 1, "creation_date": 1571259173, "post_id": 58421480, "comment_id": 103185277, "body": "As it is right now, you risk using an uninitialized <code>VecPointer</code> in case you get no hits. That will crash the program. You could wrap it in some kind of smart pointer probably. Also, unless you&#39;re very careful that what it points to exists in the same scope you use the result, you could end up with other crashes."}, {"owner": {"reputation": 1680, "user_id": 5282154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a468ae12f72b587ad0c4e89ffde11839?s=128&d=identicon&r=PG", "display_name": "doug", "link": "https://stackoverflow.com/users/5282154/doug"}, "edited": false, "score": 0, "creation_date": 1571264776, "post_id": 58421480, "comment_id": 103187115, "body": "Almost always, a pointer to a vector is a code smell. It isn&#39;t necessarily wrong, but it is rarely used or needed and should be generally avoided. This is because the <code>vector</code> itself, takes little room, typically 3 pointers because it creates it&#39;s objects on the heap and just points to them. So a pointer to pointers to the heap (where the objects are) is not efficient. Also harder to read."}], "answers": [{"tags": [], "owner": {"reputation": 9793, "user_id": 2391169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47b9c6b03a46672d5698ec565319c072?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/2391169/david"}, "is_accepted": true, "score": 1, "last_activity_date": 1571260713, "last_edit_date": 1571260713, "creation_date": 1571259445, "answer_id": 58421610, "question_id": 58421480, "link": "https://stackoverflow.com/questions/58421480/c-pointer-to-local-variable-within-the-function/58421610#58421610", "title": "C++ - Pointer to local variable within the function", "body": "<p>You need to make sure your compairson also looks for an existing value within the <code>VecPointer</code>, since your original second loop only cares about the first value it comes across. </p>\n\n<pre><code>else if(VecPointer &amp;&amp; input == \"SomethingElse\")\n</code></pre>\n\n<p>Don't look for <code>-&gt;empty()</code>, as that's accessing the pointer and asking whether the pointed to vector is empty. If there's nothing to point to in the first place, you're going to have a bad time at the <code>-&gt;</code> stage of the statement. Instead, if against it, since it's a pointer.</p>\n\n<pre><code>if(VecPointer)\n</code></pre>\n\n<p>Finally, you're using a Vector to save that one value from m_vec, which from other code I'm assuming is not a <code>vector&lt;vector&lt;string&gt;&gt;</code> but a <code>vector&lt;string&gt;</code> - in the latter case, your <code>VecPointer</code> should be <code>std::string*</code></p>\n\n<pre><code>std::string* VecPointer = nullptr;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "is_accepted": false, "score": 1, "last_activity_date": 1571293607, "last_edit_date": 1571293607, "creation_date": 1571261419, "answer_id": 58421956, "question_id": 58421480, "link": "https://stackoverflow.com/questions/58421480/c-pointer-to-local-variable-within-the-function/58421956#58421956", "title": "C++ - Pointer to local variable within the function", "body": "<blockquote>\n  <p>I'm trying to optimize a part of it.<br>\n  ...<br>\n  Is this okay? </p>\n</blockquote>\n\n<p>Maybe not! This may already be a poor use of your time. Are you sure that this is what's hurting your performance? Or that there's a performance problem at all?</p>\n\n<p>Remember Don Knuth's old adage: <a href=\"http://wiki.c2.com/?PrematureOptimization\" rel=\"nofollow noreferrer\">Premature optimization is the root of all evil</a>...</p>\n\n<blockquote>\n  <p>Do you see a better way to do it?</p>\n</blockquote>\n\n<p>Consider <a href=\"https://stackoverflow.com/q/375913/1593077\">profiling your program</a> to see which parts actually take up the most time.</p>\n\n<hr>\n\n<p>On an unrelated note, you could use standard library algorithms to simplify your (unoptimized) code. For example:</p>\n\n<pre><code>if (std::ranges::find(std::begin(object.m_vec) std::end(object.m_vec), \"SomethingElse\"s ) \n    != std::end(object.m_vec)) \n{\n    xml &lt;&lt; \"&lt;OtherNode&gt;\" &lt;&lt; whatever &lt;&lt; \"&lt;/OtherNode&gt;\";\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 10307096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e945a639087aa0f28e3b05832fb14009?s=128&d=identicon&r=PG&f=1", "display_name": "loyd.f", "link": "https://stackoverflow.com/users/10307096/loyd-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 58421610, "answer_count": 2, "score": 2, "last_activity_date": 1571293607, "creation_date": 1571258840, "last_edit_date": 1571261003, "question_id": 58421480, "link": "https://stackoverflow.com/questions/58421480/c-pointer-to-local-variable-within-the-function", "title": "C++ - Pointer to local variable within the function", "body": "<p>I know this can look like a rookie question already asked a thousand time. But I searched for the exact answer and I haven't found one...</p>\n\n<p>I'm working on a code that, to sum up, fill an XML with different data.</p>\n\n<p>I'm trying to optimize a part of it. The \"na\u00efve\" code is the following:</p>\n\n<pre><code>xml &lt;&lt; \"&lt;Node&gt;\";\nfor(auto&amp; input : object.m_vec)\n{\n    if(input == \"Something\")\n    {\n        xml &lt;&lt; input;\n    }\n}\nxml &lt;&lt; \"&lt;/Node&gt;\";\nfor(auto&amp; input : object.m_vec)\n{\n    if(input == \"SomethingElse\")\n    {\n        xml &lt;&lt; \"&lt;OtherNode&gt;\";\n        xml &lt;&lt; input;\n        xml &lt;&lt; \"&lt;/OtherNode&gt;\";\n        break;\n    }\n}\n</code></pre>\n\n<p>The important thing is, while more than one input fit in <code>&lt;Node&gt;&lt;/Node&gt;</code>, only one fit in <code>&lt;OtherNode&gt;&lt;/OtherNode&gt;</code> (explaining the <code>break;</code>) and it may not exist either (explaining the <code>xml &lt;&lt;</code> in-between the <code>if</code> statement).</p>\n\n<p>I think I could optimize it such like:</p>\n\n<pre><code>std::vector&lt;std::string&gt;* VecPointer;\n\nxml &lt;&lt; \"&lt;Node&gt;\";\nfor(auto&amp; input : object.m_vec)\n{\n    if(input == \"Something\")\n    {\n        xml &lt;&lt; input;\n    }\n    else if(input == \"SomethingElse\")\n    {\n        VecPointer = &amp;input;\n    }\n}\nxml &lt;&lt; \"&lt;/Node&gt;\";\n\nif(!VecPointer-&gt;empty())\n{\n    xml &lt;&lt; \"&lt;OtherNode&gt;\"\n        &lt;&lt; *VecPointer\n        &lt;&lt; \"&lt;/OtherNode&gt;\";\n}\n</code></pre>\n\n<p>The point for me here is that there is no extra memory needed and no extra loop. But the pointer to the local variable bothers me. With my beginner's eyes I can't see a case where it can lead to something wrong.</p>\n\n<p>Is this okay? Why? Do you see a better way to do it?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "edited": false, "score": 1, "creation_date": 1571260770, "post_id": 58421328, "comment_id": 103185859, "body": "Please also post compiler and version. Variable-length arrays <code>int S[n][n]</code> and <code>&lt;bits&#47;stdc++.h&gt;</code> are implentation defined. Behavior depends on compiler and version."}], "answers": [{"tags": [], "owner": {"reputation": 155, "user_id": 5546839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f904a67e514333d1d8b594b083e5e9?s=128&d=identicon&r=PG&f=1", "display_name": "WilliamClements", "link": "https://stackoverflow.com/users/5546839/williamclements"}, "is_accepted": false, "score": 0, "last_activity_date": 1571259930, "last_edit_date": 1571259930, "creation_date": 1571259342, "answer_id": 58421584, "question_id": 58421328, "link": "https://stackoverflow.com/questions/58421328/why-is-my-largest-sub-square-matrix-sum-program-not-working-with-negative-number/58421584#58421584", "title": "Why is my largest sub-square-matrix sum program not working with negative numbers?", "body": "<p>You declared M as bool and so that defeats what you want when execute cin>>M[i][j]. Oh I see you wrote #define bool int ... that's not kosher\nSee <a href=\"https://en.cppreference.com/w/cpp/keyword\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/keyword</a></p>\n"}], "owner": {"reputation": 15, "user_id": 11301096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/709d41b542207aab13cf4886f0bb709a?s=128&d=identicon&r=PG&f=1", "display_name": "user11301096", "link": "https://stackoverflow.com/users/11301096/user11301096"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571259930, "creation_date": 1571258190, "question_id": 58421328, "link": "https://stackoverflow.com/questions/58421328/why-is-my-largest-sub-square-matrix-sum-program-not-working-with-negative-number", "title": "Why is my largest sub-square-matrix sum program not working with negative numbers?", "body": "<p>This program is meant to take in a square matrix of integers and outputs the largest sub-square-matrix sum.</p>\n\n<p>The first line of input is an integer which indicates the dimension of the square matrix, followed by the actual matrix row-by-row.\nMy program only seems to work when using 1's for some reason and when I try to include a negative, the program gives a complete wrong answer.</p>\n\n<p>Example Input1:<br>\n 3</p>\n\n<p>1 2 3</p>\n\n<p>4 5 6</p>\n\n<p>7 8 9</p>\n\n<p>Output: 45</p>\n\n<p>Example Input2:<br>\n3</p>\n\n<p>1 2 3</p>\n\n<p>4 5 6</p>\n\n<p>-7 -8 -9</p>\n\n<p>Output: 16</p>\n\n<p>NB: Since the largest square matrix is [2 3; 5 6] which sums to 16</p>\n\n<p>My code:</p>\n\n<pre><code>#include &lt;bits/stdc++.h&gt;\n\n#define bool int\n\nusing namespace std;\n\nvoid printMaxSubSquare(bool M[10][10], int n)\n\n{\nint i,j;\nint S[n][n];\nint max_of_s, max_i, max_j;\n\n// Set first column of S[][]\nfor(i = 0; i &lt; n; i++)\n    S[i][0] = M[i][0];\n\n// Set first row of S[][]\nfor(j = 0; j &lt; n; j++)\n    S[0][j] = M[0][j];\n\n// Construct other entries of S[][]\nfor(i = 1; i &lt; n; i++)\n{\n    for(j = 1; j &lt; n; j++)\n    {\n        if(M[i][j] &gt; -1 ){\n            S[i][j] = min(S[i][j-1],min( S[i-1][j],\n                            S[i-1][j-1])) + 1;\n        }\n\n        else\n            S[i][j] = 0;\n    }\n}\n\n// Find the maximum entry, and indexes of maximum entry in S[][]\nmax_of_s = S[0][0];\nmax_i = 0;\nmax_j = 0;\n\nfor(i = 0; i &lt; n; i++)\n{\n    for(j = 0; j &lt; n; j++)\n    {\n\n\n        if(max_of_s &lt; S[i][j])\n        {\n            max_of_s = S[i][j];\n            max_i = i;\n            max_j = j;\n        }\n\n        if(S[i][j]&lt;0){\n            S[i][j] = 0;\n            max_i = 0;\n            max_j = 0;\n        }\n\n\n    }\n}\n\nint sum = 0;\n\nfor(i = max_i; i &gt; max_i - max_of_s; i--)\n{\n    for(j = max_j; j &gt; max_j - max_of_s; j--)\n    {\n        sum = sum + M[i][j];\n        cout &lt;&lt; M[i][j] &lt;&lt; \" \";\n    }\n    cout &lt;&lt; \"\\n\";\n}\n\ncout&lt;&lt;sum;\n}\n\n\n\nint main()\n\n{\nint n = 0;\n\ncin&gt;&gt;n;\n\nbool M[10][10];\n\nfor(int i = 0; i &lt; n; i++)\n{\n    for(int j = 0; j &lt; n; j++)\n    {\n        cin&gt;&gt;M[i][j];\n    }\n}\n\ncout&lt;&lt;endl;\n\nprintMaxSubSquare(M,n);\n}\n</code></pre>\n"}, {"tags": ["c++", "delphi", "dll"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1571258030, "post_id": 58421225, "comment_id": 103184789, "body": "Search for the error code. There are thousands of hits that tell you what the problem is."}, {"owner": {"reputation": 13, "user_id": 12192903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aadce7d352b71c79fb1dc8212100bba?s=128&d=identicon&r=PG&f=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/12192903/hamed"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1571258817, "post_id": 58421225, "comment_id": 103185125, "body": "Hi David, Thanks for your note. I edited my post."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1571261148, "post_id": 58421225, "comment_id": 103186008, "body": "You changed the question completely! This one is a duplicate too. Learn about tools like dumpbin to inspect the contents of PE modules."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12192903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aadce7d352b71c79fb1dc8212100bba?s=128&d=identicon&r=PG&f=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/12192903/hamed"}, "edited": false, "score": 0, "creation_date": 1571258240, "post_id": 58421278, "comment_id": 103184878, "body": "Hi Remy , thank you for response. but I was wrong in error report, my error is :&quot;the procedure entry point math_add could not be located in the dynamic link library math_dll.dll&quot;"}, {"owner": {"reputation": 13, "user_id": 12192903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aadce7d352b71c79fb1dc8212100bba?s=128&d=identicon&r=PG&f=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/12192903/hamed"}, "edited": false, "score": 0, "creation_date": 1571260258, "post_id": 58421278, "comment_id": 103185675, "body": "It is true. Thank you."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1571260644, "last_edit_date": 1571260644, "creation_date": 1571257936, "answer_id": 58421278, "question_id": 58421225, "link": "https://stackoverflow.com/questions/58421225/standard-method-for-creating-dll-in-c-and-calling-in-delphi/58421278#58421278", "title": "Standard method for creating dll in c++ and calling in delphi", "body": "<p>The default name mangling for the <code>__stdcall</code> calling convention is <code>_&lt;name&gt;@&lt;bytes_in_arguments&gt;</code>.  So your DLL function is most likely being exported as <code>'_math_add@8'</code> instead of as <code>'math_add'</code> like you are expecting.  Use a tool like PEDUMP to verify that.</p>\n\n<p>You can use a <a href=\"https://docs.microsoft.com/en-us/cpp/build/exporting-from-a-dll-using-def-files?view=vs-2019\" rel=\"nofollow noreferrer\"><code>.DEF</code> file</a> when compiling the DLL to change the exported name, or you can update your Delphi <code>function</code> declaration to use the correct exported name for the <code>name</code> attribute.</p>\n"}], "owner": {"reputation": 13, "user_id": 12192903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aadce7d352b71c79fb1dc8212100bba?s=128&d=identicon&r=PG&f=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/12192903/hamed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 58421278, "answer_count": 1, "score": -1, "last_activity_date": 1571260644, "creation_date": 1571257636, "last_edit_date": 1571257993, "question_id": 58421225, "link": "https://stackoverflow.com/questions/58421225/standard-method-for-creating-dll-in-c-and-calling-in-delphi", "title": "Standard method for creating dll in c++ and calling in delphi", "body": "<p>I am looking for the correct method to create a DLL in C++ and call it in Delphi. I use CodeBlocks for the DLL and Delphi RAD Studio 10.2.</p>\n\n<p>My C++ header and source code for building the DLL as described in <a href=\"https://stackoverflow.com/questions/8366590/how-to-create-dll-in-c-for-using-in-c-sharp/8366615#8366615\">How to create dll in C++ for using in C#</a> is as follows:</p>\n\n<p>Main.h:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#ifndef MATH_HPP\n#define MATH_HPP\n\nextern \"C\"\n{\n    __declspec(dllexport) int __stdcall math_add(int a, int b);\n}\n\n#endif \n</code></pre>\n\n<p>Main.Cpp :</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"main.h\"\n\nint __declspec(dllexport) __stdcall math_add(int a, int b)\n{\n    return a + b;\n}\n</code></pre>\n\n<p>This code in CodeBlocks builds <code>math_dll.dll</code> without any error.</p>\n\n<p>Calling the DLL in Delphi:</p>\n\n<pre class=\"lang-pascal prettyprint-override\"><code>function math_add(X, Y: Integer): Integer; stdcall; external 'math_dll.dll' name 'math_add';\n</code></pre>\n\n<p>But when I run Delphi and call this function, I have the following error:</p>\n\n<blockquote>\n  <p>\"the procedure entry point math_add could not be located in the dynamic link library math_dll.dll\"</p>\n</blockquote>\n\n<p>Which part of my code is wrong?</p>\n"}, {"tags": ["c++", "extension-methods"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1571257673, "post_id": 58421039, "comment_id": 103184644, "body": "What happens if you decide to use a <code>std::deque</code> instead of vector?  Or <code>std::list</code>?  Or any sequence container, even a plain old array?  Copy the same code <code>x</code> times, with the only change being the container type?  C++ has the concept of iterators and sequences.  For example, look how <code>std::sort</code> works."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1571257921, "post_id": 58421039, "comment_id": 103184750, "body": "<a href=\"https://www.boost.org/doc/libs/1_71_0/libs/endian/doc/html/endian.html\" rel=\"nofollow noreferrer\">Look at boost endian</a>.  The point is that you should strive to not lock yourself into using a specific container."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1571258491, "post_id": 58421039, "comment_id": 103184981, "body": "Instead of trying to add a custom extension function, in C++ just create a free-standing function or free-standing template function.  If you want to see a janky workaround for custom extension functions (but don&#39;t do it in C++!) for curiosity&#39;s sake, q.v. <a href=\"https://stackoverflow.com/questions/57080495/is-it-possible-add-member-function-to-data-type-in-c\" title=\"is it possible add member function to data type in c\">stackoverflow.com/questions/57080495/&hellip;</a>"}, {"owner": {"reputation": 1700, "user_id": 3025534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iI4D8.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/3025534/alan"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1571324573, "post_id": 58421039, "comment_id": 103211414, "body": "@PaulMcKenzie I am looking at deque, it looks like for my particular use case it may end up with a performance hit since it uses 2 pointers for each reference, but I will give it a try once things are working. I did try a basic array, I don&#39;t remember at the moment why I had to switch to a vector, but maybe I can explore it again."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1571325119, "post_id": 58421039, "comment_id": 103211754, "body": "@Alan -- Well my point is that you shouldn&#39;t care what container is ultimately chosen.  The <code>ToLittleEndianInt</code> code should just work without <i>any</i> changes and without code duplication.  Other languages do not have this ability, while C++ does.  It&#39;s called &quot;generic programming&quot;.  Again look at <code>std::sort</code> or even <code>std::reverse</code> -- you don&#39;t see a separate function for vector, deque, etc."}], "answers": [{"comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1571257545, "post_id": 58421188, "comment_id": 103184581, "body": "<i>This is why inheritance was invented.</i> -- Not for <code>std::vector</code>.  Inheriting from <code>std::vector</code> should be avoided."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1571257890, "post_id": 58421188, "comment_id": 103184739, "body": "<a href=\"https://stackoverflow.com/questions/4353203/thou-shalt-not-inherit-from-stdvector\">Thou shalt not inherit from std::vector</a>"}, {"owner": {"reputation": 1700, "user_id": 3025534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iI4D8.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/3025534/alan"}, "edited": false, "score": 0, "creation_date": 1571324717, "post_id": 58421188, "comment_id": 103211499, "body": "@bloody I updated my question with a custom class, still having some trouble I can&#39;t explain."}], "tags": [], "owner": {"reputation": 877, "user_id": 4241078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1298bd3c96afd9316d50eea60587efd?s=128&d=identicon&r=PG&f=1", "display_name": "bloody", "link": "https://stackoverflow.com/users/4241078/bloody"}, "is_accepted": true, "score": 0, "last_activity_date": 1571384178, "last_edit_date": 1571384178, "creation_date": 1571257486, "answer_id": 58421188, "question_id": 58421039, "link": "https://stackoverflow.com/questions/58421039/create-custom-extention-from-function-for-stdvector/58421188#58421188", "title": "Create Custom Extention from Function for std::vector", "body": "<p>The <code>unresolved external symbol \"public: __thiscall Byte::Byte(void)...</code> error means that the linker program couldn't find a definition (a body) of the constructor of your class <code>Byte</code>. In order to fix this you can add empty braces to your constructor and destructor declarations (this time without semicolons) like below:</p>\n\n<pre><code>class Byte\n{\n    public:\n        Byte() {}\n        ~Byte() {}\n        ...\n</code></pre>\n\n<p>or just remove their declarations at all since currently they're idle anyway:</p>\n\n<pre><code>class Byte\n{\n    public:\n        //Byte();  - can be removed entirely\n        //~Byte(); - can be removed entirely\n        ...\n</code></pre>\n\n<p>When you don't provide a constructor the compiler implicitly generates the default constructor so you neither have to worry about its declaration nor definition (body). However when you declare one you need to provide its definition yourself (at least empty braces).</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "is_accepted": false, "score": 0, "last_activity_date": 1571259547, "creation_date": 1571259547, "answer_id": 58421632, "question_id": 58421039, "link": "https://stackoverflow.com/questions/58421039/create-custom-extention-from-function-for-stdvector/58421632#58421632", "title": "Create Custom Extention from Function for std::vector", "body": "<blockquote>\n<pre><code>// how can we do this?\nint results = CurrentBytes.ToLittleEndianInt();\n//or\nint results = CurrentBytes-&gt;ToLittleEndianInt();\n</code></pre>\n</blockquote>\n\n<p>You can't. C++ doesn't work that way.</p>\n\n<p>What you can do is this instead:</p>\n\n<pre><code>// assuming DataParser is a namespace\nusing namespace DataParser;\nint results = ToLittleEndianInt(CurrentBytes);\n// or...\nint results = DataParser::ToLittleEndianInt(CurrentBytes); \n</code></pre>\n\n<p>That's the C++ way to handle it.</p>\n\n<p>If you want a more elegant solution, you could inherit from <code>std::vector</code>, though <a href=\"https://stackoverflow.com/questions/4353203/thou-shalt-not-inherit-from-stdvector\">this is not recommended</a>.</p>\n\n<p>A much better approach would be to create your own class:</p>\n\n<pre><code>class myContainer {\n    private:\n        std::vector data;\n    public:\n        //...\n        int ToLittleEndianInt() {\n            // Process data...\n            return result;\n        }\n};\n</code></pre>\n\n<p>Then your code would become:</p>\n\n<pre><code>myContainer CurrentBytez;\n//...\nint results = CurrentBytes.ToLittleEndianInt();\n</code></pre>\n\n<p>Of course, creating your own class will take some research, particularly on how classes differ in C++ from C#, but it might be worth it. You might want to learn it anyway, so it's not really a big deal.</p>\n"}], "owner": {"reputation": 1700, "user_id": 3025534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iI4D8.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/3025534/alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 58421188, "answer_count": 2, "score": 0, "last_activity_date": 1571384178, "creation_date": 1571256787, "last_edit_date": 1592644375, "question_id": 58421039, "link": "https://stackoverflow.com/questions/58421039/create-custom-extention-from-function-for-stdvector", "title": "Create Custom Extention from Function for std::vector", "body": "<p>I am trying to learn some C++ coming from C#. One of the things I liked in C# was the extensions like  <code>CustomItem.ToString()</code> and was curious how I could implement something like that in C++. I am using  <code>std::vector&lt;unsigned char&gt;</code> to store a buffer and then processing it byte by byte.</p>\n<p>I have the following function:</p>\n<pre><code>int DataParser::ToLittleEndianInt(std::vector&lt;unsigned char&gt; ba) //Little Endian\n{\n    long int Int = 0;\n    int arraySize = ba.size();\n    if (arraySize ==4)\n    {\n        Int = ba[0] | ((int)ba[1] &lt;&lt; 8) | ((int)ba[2] &lt;&lt; 16) | ((int)ba[3] &lt;&lt; 24);\n    }\n    else if (arraySize == 2)\n    {\n        Int = ba[0] | ((int)ba[1] &lt;&lt; 8);\n    }\n    else if (arraySize == 1)\n    {\n        Int = ba[0];\n    }\n    return Int;\n}\n</code></pre>\n<p>Here I can send it a vector from one to 4 bytes and it will convert to integer for me. Is there a way for me to use it in a way like this:</p>\n<pre><code>std::vector&lt;unsigned char&gt; CurrentBytes(4);\nfor (int i = 0; i &lt; 4; i++)\n    CurrentBytes[i]=1;\n\n// how can we do this?\nint results = CurrentBytes.ToLittleEndianInt();\n//or\nint results = CurrentBytes-&gt;ToLittleEndianInt();\n</code></pre>\n<p>I just feel it is quite readable and want to have extensions for strings, dates, int, dollars and so on.</p>\n<h2>UPDATE:</h2>\n<p>I tried doing the custom class as suggested, but I am getting compile time errors. I put this in my .h file:</p>\n<pre><code>class Byte\n{\n    public:\n        Byte();\n        ~Byte();\n        std::string  DataType;\n        int  ColumnWidth;\n        std::vector&lt;unsigned char&gt; data;\n        int ToLEInt() {\n            long int Int = 0;\n            int arraySize = this-&gt;ColumnWidth;\n            if (arraySize == 2)\n            {\n                Int = this-&gt;data[0] | ((int)this-&gt;data[1] &lt;&lt; 8);\n            }\n            else if (arraySize == 1)\n            {\n                Int = this-&gt;data[0];\n            }\n            return Int;\n        };\n};\n</code></pre>\n<p>That throws the error:</p>\n<pre><code>Error   LNK2019 unresolved external symbol &quot;public: __thiscall Byte::Byte(void)&quot; (??0Byte@@QAE@XZ) referenced in function &quot;public: static void __cdecl DataParser::Parse(class nlohmann::basic_json&lt;class std::map,class std::vector,class std::basic_string&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt;,bool,__int64,unsigned __int64,double,class std::allocator,struct nlohmann::adl_serializer&gt;)&quot; (?ParseToDataTable@Parse@@SAXV?$basic_json@Vmap@std@@Vvector@2@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@2@_N_J_KNVallocator@2@Uadl_serializer@nlohmann@@@nlohmann@@@Z)    \n</code></pre>\n<p>I also tried declaring it as:</p>\n<pre><code>const Byte&amp; ToLEInt(const Byte&amp; s)const {}\n</code></pre>\n<p>That was the way I saw done in Stephen Prata's C++ Primer, but then I still get errors, and I would have to use it like this in my cpp:</p>\n<pre><code>std::vector&lt;unsigned char&gt; test(3);\nfor (int i = 0; i &lt; 2; i++)\n        test[i] = i;\n    Byte CurrentBytes;\n    CurrentBytes.data = test;\n    CurrentBytes.ColumnWidth=2;\n    int results = CurrentBytes.ToLEInt(CurrentBytes);\n    //instead of\n    int results = CurrentBytes.ToLEInt();\n</code></pre>\n<p>I then tried putting the declaration outside of the class block, but then I got an error that LEInt wasn't defined,</p>\n<pre><code>int Byte::ToLEInt(){}\n</code></pre>\n<p>When I tried adding <code>int ToLEInt();</code> to the class block, then it complained that it was already defined.</p>\n"}, {"tags": ["c++", "language-lawyer", "std", "stdset", "invariants"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1571256787, "post_id": 58420992, "comment_id": 103184224, "body": "It all boils down to what the standard means by <i>modify</i> in <a href=\"https://timsong-cpp.github.io/cppwp/dcl.type.cv#4\" rel=\"nofollow noreferrer\">&#91;dcl.type.cv&#93;/4</a> <i>Any attempt to modify ([expr.ass], [expr.post.incr], [expr.pre.incr]) a const object ([basic.type.qualifier]) during its lifetime ([basic.life]) results in undefined behavior.</i>.  To me, this says it&#39;s legal.  Ideally though, I would like it to not be."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1571256837, "post_id": 58420992, "comment_id": 103184247, "body": "@NathanOliver Which <code>const</code> object is being modified? Edit : But I agree that the definition seems weak to me."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 1, "creation_date": 1571256988, "post_id": 58420992, "comment_id": 103184315, "body": "@HTNW Note that the container is not <code>const</code>, my title was referring to <code>const</code> elements of a container. But now I see that it&#39;s not clear."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1571257072, "post_id": 58420992, "comment_id": 103184358, "body": "@Fran&#231;oisAndrieux None, which is the problem.  The thing you point to is not considered as part of the state of the pointer."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1571257119, "post_id": 58420992, "comment_id": 103184383, "body": "Looks like this isn&#39;t a great example as Brian&#39;s answer points out the associative containers explicitly cover this scenario."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1571257197, "post_id": 58420992, "comment_id": 103184418, "body": "@NathanOliver Well, I was hoping that the answer to this question would help answer that other question from earlier, but I guess not. Still, I was specially interested in this specific case because it seems like something that could accidentally happen and doesn&#39;t seem obvious to notice. Its similar to the previous question but without any obvious <code>const_cast</code> and might be more generally useful. I&#39;ve changed the question title to be more specific."}], "answers": [{"tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": true, "score": 5, "last_activity_date": 1571256897, "creation_date": 1571256897, "answer_id": 58421062, "question_id": 58420992, "link": "https://stackoverflow.com/questions/58420992/which-part-of-the-language-forbids-changing-elements-of-an-stdset/58421062#58421062", "title": "Which part of the language forbids changing elements of an std::set", "body": "<p>In C++17, there is [associative.reqmts]/3:</p>\n\n<blockquote>\n  <p>... For any two keys <code>k1</code> and <code>k2</code> in the same container, calling <code>comp(k1, k2)</code> shall always return the same value.</p>\n</blockquote>\n\n<p>Thus, your code has UB because it violates this requirement.</p>\n"}, {"tags": [], "owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "is_accepted": false, "score": -1, "last_activity_date": 1571259912, "creation_date": 1571259912, "answer_id": 58421697, "question_id": 58420992, "link": "https://stackoverflow.com/questions/58420992/which-part-of-the-language-forbids-changing-elements-of-an-stdset/58421697#58421697", "title": "Which part of the language forbids changing elements of an std::set", "body": "<p>[Not very politically correct remark: Many things are unwritten in the standard, and even written things are sometimes incorrect. You have to make up for the missing parts, it's more reliable than parsing exact words.]</p>\n\n<p>All associative containers (sorted or not sorted) are based on axiomatic requirements.</p>\n\n<p>The <em>implicit</em> basis is that all the predicates/functors on which there are axioms are mathematical relations/functions, or the axioms wouldn't possibly mean anything. <strong>So obviously these functions, like comparators, must be well defined; it means that elements <em>currently</em> in a container are ordered</strong>. </p>\n\n<p>But it doesn't matter if your container is empty and you change its ordering function. You can also have a polar ordering where you order elements according to the angle, with an arbitrary cutoff (minimal angle by definition), and rotate that minimum angle line, if the rotation doesn't pass over elements in the container.</p>\n"}], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 1, "accepted_answer_id": 58421062, "answer_count": 2, "score": 1, "last_activity_date": 1571259912, "creation_date": 1571256583, "last_edit_date": 1571257940, "question_id": 58420992, "link": "https://stackoverflow.com/questions/58420992/which-part-of-the-language-forbids-changing-elements-of-an-stdset", "title": "Which part of the language forbids changing elements of an std::set", "body": "<p>An <code>std::set</code> is a sorted associative container that offers fast lookup of it's elements. Keys are inserted in a sorted fashion and keys can't be modified once inserted to preserve that order.</p>\n\n<p>Consider the following demonstration that constructs an <code>std::set</code> of <code>int*</code> and then tries to break it's elements' sorting : </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;set&gt;\n\nint values[] = { 50, 40, 30, 20, 10 };\n\n// Comparator that sorts by pointed value\nstruct comparator {\n    bool operator()(const int* left, const int* right) const {\n        return *left &lt; *right;\n    }\n};\n\nusing my_set_t = std::set&lt;int*, comparator&gt;;\n\n// Checks if each of the elements of `values` are in the set\nvoid output(const my_set_t &amp; foo)\n{\n    for (auto &amp; x : values) {\n        std::cout &lt;&lt; x &lt;&lt; ' ' &lt;&lt; foo.count(&amp;x) &lt;&lt; '\\n';\n    }\n    std::cout &lt;&lt; std::endl;\n}\n\nint main()\n{\n    // Insert the address of each element of `values` into the set\n    my_set_t foo;\n    for (auto &amp; x : values) {\n        foo.emplace(&amp;x);\n    }\n\n    output(foo);\n    // Changing `values[1]` to zero should break the sorting of the set\n    values[1] = 0;\n    output(foo);\n}\n</code></pre>\n\n<p>The output I got was : </p>\n\n<pre><code>50 1\n40 1\n30 1\n20 1\n10 1\n\n50 1\n0 0\n30 0\n20 0\n10 0\n</code></pre>\n\n<p>The expression <code>values[1] = 0;</code> effectively alters one of the <code>set</code>'s keys indirectly. This breaks the ordering and consequently seems to also break <code>count</code>. I assume this would also break most of the <code>set</code>'s other functionalities.</p>\n\n<p>There is obviously something wrong with the code. As far as I can tell it follows all language rules and I doesn't seem to violate any requirement that I could find for the compare function or <code>set</code>. But the guaranties provided by <code>set</code> are nonetheless broken, meaning I must have missed something.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1571256255, "post_id": 58420926, "comment_id": 103184003, "body": "First define &quot;numbers&quot;. Is <code>-0.3</code> a number? How about <code>3.9e4</code>?"}, {"owner": {"reputation": 3149, "user_id": 1889762, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/77c9378bf28336a823c5bf47b6376d3c?s=128&d=identicon&r=PG", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/1889762/hal9000"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1571256355, "post_id": 58420926, "comment_id": 103184052, "body": "@tadman &quot;number&quot; doesn&#39;t need to be defined in a question. It&#39;s common knowledge"}, {"owner": {"reputation": 583, "user_id": 2720343, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cvJ2G.jpg?s=128&g=1", "display_name": "Dortimer", "link": "https://stackoverflow.com/users/2720343/dortimer"}, "edited": false, "score": 0, "creation_date": 1571256697, "post_id": 58420926, "comment_id": 103184186, "body": "This might have something useful. <a href=\"https://stackoverflow.com/questions/23958008/having-to-input-value-twice-to-work-c/\" title=\"having to input value twice to work c\">stackoverflow.com/questions/23958008/&hellip;</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 3149, "user_id": 1889762, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/77c9378bf28336a823c5bf47b6376d3c?s=128&d=identicon&r=PG", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/1889762/hal9000"}, "edited": false, "score": 1, "creation_date": 1571258236, "post_id": 58420926, "comment_id": 103184876, "body": "@HAL9000 Some people are surprised by what C++ thinks is a number if left to its own devices."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1571258410, "post_id": 58420926, "comment_id": 103184951, "body": "Rather than a <code>go_back_to_main()</code> function, consider using the <code>return</code> statement."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1571258511, "post_id": 58420926, "comment_id": 103184990, "body": "BTW, when <code>std::cin &gt;&gt; EUR_GBP</code> processes something that is not a floating point number, the stream will be in an error state.  You should check the return value or the stream state."}], "owner": {"reputation": 23, "user_id": 12228811, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156712644376662/picture?type=large", "display_name": "Ethan Quesne", "link": "https://stackoverflow.com/users/12228811/ethan-quesne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "closed_date": 1571258085, "answer_count": 0, "score": 1, "last_activity_date": 1571256689, "creation_date": 1571256217, "last_edit_date": 1571256501, "question_id": 58420926, "link": "https://stackoverflow.com/questions/58420926/how-do-i-reject-inputs-that-are-not-numbers", "closed_reason": "Duplicate", "title": "How do I reject inputs that are not numbers?", "body": "<p>My program is a currency converter. Currently, my code works to convert currency but if the user were to type in characters rather than a number, it enters an infinite loop. This is the part of my code that I need to add something to verify the data.</p>\n\n<pre><code>void menu_item_4() {\n  std::cout &lt;&lt; \"\\n&gt;&gt; EUR to GBP\\n\";\n  std::cout &lt;&lt; \"\\nEnter a value to convert from EUR to GBP\\n\";\n  float EUR_GBP;\n  std::cin &gt;&gt; EUR_GBP;\n  float eur_gbp = EUR_GBP * 0.86;\n  std::cout &lt;&lt; EUR_GBP &lt;&lt; \" EUR is equal to \" &lt;&lt; eur_gbp &lt;&lt; \" GBP.\";\n  go_back_to_main();\n}\n</code></pre>\n\n<p>Let me know what I can do.</p>\n"}, {"tags": ["c++", "c", "arrays", "random"], "comments": [{"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 2, "creation_date": 1571256060, "post_id": 58420853, "comment_id": 103183905, "body": "Yes, you could do that in either language. However, please start with the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1571256079, "post_id": 58420853, "comment_id": 103183917, "body": "First of all you need to realize that it is <i>not</i> random. And then you need to decide where you are &quot;sacrificing&quot; your randomness. For example you can generate n/2 random elements and then generate another n/2 elements while each one is the negation of the corresponding item from the random array."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 1, "creation_date": 1571256177, "post_id": 58420853, "comment_id": 103183964, "body": "Generate a random vector, and subtract the average value from each element."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1571256229, "post_id": 58420853, "comment_id": 103183990, "body": "@ja72 That could break the range requirement."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11937721"}, "edited": false, "score": 5, "creation_date": 1571256370, "post_id": 58420853, "comment_id": 103184060, "body": "Normalization along multiple instances. If you want a sum-to-zero set of random numbers between -1 and 1, then you sum the negative numbers and normalize them to be equal to -1 total, then you sum the positive numbers and normalize them to +1. it sacrifices true randomness but they still maintain a pseudo-random nature, and the then-total of the vector would be zero. From you code, you would need to ensure that there is at least 1 negative and 1 positive number - otherwise it would throw a div0 error."}, {"owner": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "edited": false, "score": 1, "creation_date": 1571256553, "post_id": 58420853, "comment_id": 103184132, "body": "Why don&#39;t you simply generate n-1 elements, calculate their sum and get the n-th element by changing the sign of the sum?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "edited": false, "score": 3, "creation_date": 1571256608, "post_id": 58420853, "comment_id": 103184152, "body": "@Cubo78 Can be out of range"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1571256652, "post_id": 58420853, "comment_id": 103184168, "body": "...or even in range but absurd compared with the others."}, {"owner": {"reputation": 81, "user_id": 10509291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/98xB7.jpg?s=128&g=1", "display_name": "Thales Carl", "link": "https://stackoverflow.com/users/10509291/thales-carl"}, "edited": false, "score": 0, "creation_date": 1571256726, "post_id": 58420853, "comment_id": 103184196, "body": "@Cryostasys it makes sense  and probably it will fit to my needs. Thanks for the idea."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1571256727, "post_id": 58420853, "comment_id": 103184197, "body": "@WeatherVane Why absurd? In any array satisfying the requirement any element equals <code>0-&lt;rest of elements&gt;</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1571256798, "post_id": 58420853, "comment_id": 103184231, "body": "@EugeneSh. at first I though you meant out of range of <code>float</code>."}, {"owner": {"reputation": 81, "user_id": 10509291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/98xB7.jpg?s=128&g=1", "display_name": "Thales Carl", "link": "https://stackoverflow.com/users/10509291/thales-carl"}, "reply_to_user": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "edited": false, "score": 0, "creation_date": 1571256829, "post_id": 58420853, "comment_id": 103184245, "body": "@Cubo78 I was thinking about doing something like that. However this could make the last number far different from the others inside the array."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1571256855, "post_id": 58420853, "comment_id": 103184254, "body": "@ThalesCarl that is what I meant."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1571257226, "post_id": 58420853, "comment_id": 103184433, "body": "Do you want the sum to be <i>exactly</i> zero, or within some tolerance?"}, {"owner": {"reputation": 81, "user_id": 10509291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/98xB7.jpg?s=128&g=1", "display_name": "Thales Carl", "link": "https://stackoverflow.com/users/10509291/thales-carl"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1571257601, "post_id": 58420853, "comment_id": 103184613, "body": "@ja72 The ideal scenario would be the sum is exactly zero since I am adding a random term in one equation that must get canceled in the end. However, I believe I can survive if the sum is around this value. Why?"}, {"owner": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "edited": false, "score": 0, "creation_date": 1571257743, "post_id": 58420853, "comment_id": 103184672, "body": "Sorry, I actually forgot the range requirement. But I don&#39;t understand how a non uniform distribution would be against the requirements.. Anyway I have in mind some sort of algorithmic solution that imho would work, but I&#39;m afk, and writing it on my phone would be a pain.."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 3, "creation_date": 1571266193, "post_id": 58420853, "comment_id": 103187479, "body": "The space of possible answers when <code>n=3</code> is essentially the regular hexagon you get when slicing the cube with vertex coordinates at plus or minus one with the plane <code>x+y+z=0</code>. So how would you want the distribution on that hexagon to be? Proportional to area? Proportional to the volume of the original cube projected onto an area?"}, {"owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1571270467, "post_id": 58420853, "comment_id": 103188413, "body": "@EugeneSh.: It is random. It is not uniformly distributed."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1571272243, "post_id": 58420853, "comment_id": 103188753, "body": "@EricPostpischil It is not only non-uniform, it is quite special. How would you call the distribution where each element is linearly depending on the others?"}, {"owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1571273119, "post_id": 58420853, "comment_id": 103188939, "body": "You need to clarify the question, particularly the probability distribution desired. aschelpler\u2019s comment above is a good start. If you do not know what distribution you want, then explain why you want this."}, {"owner": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "edited": false, "score": 0, "creation_date": 1571290063, "post_id": 58420853, "comment_id": 103192531, "body": "If the question doesn&#39;t mention a particular desired distribution ,  it means that&#39;s not any desired distribution. Random is random, and it is only limited by the capabiloty of generating a TRUE random number and by the requirements of the given range and the given sum. Stop."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1571313934, "post_id": 58420853, "comment_id": 103204926, "body": "This would make an awesome <a href=\"https://math.stackexchange.com\">Mathematics</a> question. Can you generate a flat random distribution with finite elements with sum zero and bounded?"}], "answers": [{"comments": [{"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1571265945, "post_id": 58422276, "comment_id": 103187406, "body": "Note the distribution of <code>outArr[i]</code> is different from the distribution of <code>outArr[j]</code>."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 1, "creation_date": 1571266456, "post_id": 58422276, "comment_id": 103187533, "body": "It doesn&#39;t even cover the space. With <code>n==4</code>, you can&#39;t get results near <code>0.8, 0.8, -0.8, -0.8</code>."}, {"owner": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1571266504, "post_id": 58422276, "comment_id": 103187547, "body": "I&#39;m aware of it. But I think it is mainly due to the seed, which in my tests made me keet obtaining a value not far from the negative limit (and this caused the unnatural negative-positive alternance). Improving the seed initialization would improve for sure outArr[i] vs outArr[j] distribution too. But.. hey! It meets the requirements! :)"}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 1, "creation_date": 1571267843, "post_id": 58422276, "comment_id": 103187832, "body": "I am not a math nerd; but I feel uneasy because your adjustment of min,max is based on history, thus you have added <i>memory</i> into the random number sequence.  Random is closed over linear operations, but is a memory-based operation actually linear?"}], "tags": [], "owner": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "is_accepted": false, "score": 2, "last_activity_date": 1571266856, "last_edit_date": 1571266856, "creation_date": 1571263562, "answer_id": 58422276, "question_id": 58420853, "link": "https://stackoverflow.com/questions/58420853/how-to-generate-a-n-sized-random-float-array-that-sums-up-to-0-0/58422276#58422276", "title": "How to generate a n-sized random float array that sums up to 0.0?", "body": "<p>I figured out a solution to your problem. This is not perfect since its <em>randomness</em> is limited by the range requirement.</p>\n\n<p>The strategy is:</p>\n\n<ol>\n<li>Define a function able to generate a random float in a customizable range. No need to reinvent the wheel: I borrowed it from <a href=\"https://stackoverflow.com/a/44105089/11336762\">https://stackoverflow.com/a/44105089/11336762</a></li>\n<li>Malloc array (I omit pointer check in my example) and initialize the seed. In my example I just used current time but it can be improved</li>\n<li>For every element to be generated, pre-calculate random range. Given the i-th sum, make sure that the next sum is NEVER out of range: if the sum is positive, the range needs to be (-1,1-sum); if it is negative it the range needs to be (-1-sum,1)</li>\n<li>Do this until (n-1)th element. Last element must be directly assigned as the sum with the sign changed.</li>\n</ol>\n\n<pre><code>    #include&lt;stdio.h&gt;\n    #include&lt;stdlib.h&gt;\n    #include&lt;time.h&gt;\n\n    float float_rand( float min, float max )\n    {\n        float scale = rand() / (float) RAND_MAX; /* [0, 1.0] */\n        return min + scale * ( max - min );      /* [min, max] */\n    }\n\n    void main( int argc, char *argv[] )\n    {\n        if( argc == 2 )\n        {\n            int i, n = atoi ( argv[1] );\n            float *outArr = malloc( n * sizeof( float ) );\n            float sum = 0;\n\n            printf( \"Input value: %d\\n\\n\", n );\n\n            /* Initialize seed */\n            srand ( time( NULL ) );\n\n            for( i=0; i&lt;n-1; i++ )\n            {\n                /* Limit random generation range in order to make sure the next sum is  *\n                 * not outside (-1,1) range.                                            */\n                float min = (sum&lt;0? -1-sum : -1);\n                float max = (sum&gt;0? 1-sum : 1);\n\n                outArr[i] = float_rand( min, max );\n                sum += outArr[i];\n            }\n\n            /* Set last array element */\n            outArr[n-1] = -sum;\n\n            /* Print results */\n            sum=0;\n            for( i=0; i&lt;n; i++ )\n            {\n                sum += outArr[i];\n                printf( \"  outArr[%d]=%f \\t(sum=%f)\\n\", i, outArr[i], sum );\n            }\n\n            free( outArr );\n        }  \n        else\n        {\n          printf( \"Only a parameter allowed (integer N)\\n\" );\n        }\n    }\n</code></pre>\n\n<p>I tried it, and it works also when n=1. In case of n=0 a sanity check should be added to my example.</p>\n\n<p>Some output examples:</p>\n\n<p><strong>N=1:</strong></p>\n\n<pre><code>Input value: 1\n\n  outArr[0]=-0.000000   (sum=-0.000000)\n</code></pre>\n\n<p><strong>N=4</strong></p>\n\n<pre><code>Input value: 4\n\n  outArr[0]=-0.804071   (sum=-0.804071)\n  outArr[1]=0.810685    (sum=0.006614)\n  outArr[2]=-0.353444   (sum=-0.346830)\n  outArr[3]=0.346830    (sum=0.000000)\n</code></pre>\n\n<p><strong>N=8:</strong></p>\n\n<pre><code>Input value: 8\n\n  outArr[0]=-0.791314   (sum=-0.791314)\n  outArr[1]=0.800182    (sum=0.008867)\n  outArr[2]=-0.571293   (sum=-0.562426)\n  outArr[3]=0.293300    (sum=-0.269126)\n  outArr[4]=-0.082886   (sum=-0.352012)\n  outArr[5]=0.818639    (sum=0.466628)\n  outArr[6]=-0.301473   (sum=0.165155)\n  outArr[7]=-0.165155   (sum=0.000000)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": false, "score": -1, "last_activity_date": 1571269137, "creation_date": 1571269137, "answer_id": 58422987, "question_id": 58420853, "link": "https://stackoverflow.com/questions/58420853/how-to-generate-a-n-sized-random-float-array-that-sums-up-to-0-0/58422987#58422987", "title": "How to generate a n-sized random float array that sums up to 0.0?", "body": "<p>One option is to generate some samples and then scale their values around the average. In C++ it would be something like the following</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n#include &lt;random&gt;\n#include &lt;algorithm&gt;\n#include &lt;cmath&gt;\n\nint main()\n{\n    std::random_device rd;\n    std::seed_seq ss{rd(), rd(), rd(), rd()};\n    std::mt19937 gen{ss};\n\n    const int samples = 9;\n\n    // Generates the samples in [0, 2]\n    std::uniform_real_distribution dist(0.0, std::nextafter(2.0, 3.0));\n    std::vector&lt;double&gt; nums(samples);\n    double sum = 0.0;\n    for ( auto &amp; i : nums )\n    {\n        i = dist(gen);\n        sum += i;\n    }\n    double average = sum / samples;\n    double k = 1.0 / std::max(average, 2.0 - average);\n\n    // Transform the values (apart from the last) to meet the requirements\n    sum = 0.0;\n    for ( size_t i = 0; i &lt; nums.size() - 1; ++i )\n    {\n        nums[i] = (nums[i] - average) * k;\n        sum += nums[i];\n    };\n    // This trick (to ensure the needed precision) only works if the sum\n    // is always evaluated in the same order\n    nums.back() = 0.0 - sum;\n\n    sum = 0.0;\n    for ( size_t i = 0; i &lt; nums.size(); ++i )\n    {\n        sum += nums[i];\n        std::cout &lt;&lt; std::setw(10) &lt;&lt; std::fixed &lt;&lt; nums[i] &lt;&lt; '\\n';\n    }\n    if (sum != 0.0)\n        std::cout &lt;&lt; \"Failed.\\n\";\n}\n</code></pre>\n\n<p>Testable <a href=\"https://wandbox.org/permlink/tpXlmy6DHLKjzDZs\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "edited": false, "score": 0, "creation_date": 1571731165, "post_id": 58494458, "comment_id": 103327964, "body": "It seems that your solution generates values in a compressed range (near to 0). It&#39;s actually the opposite compared to my solution in which, I think due to random generator that always picks a first value near to the lower limit, oscillates near both limits."}], "tags": [], "owner": {"reputation": 81, "user_id": 10509291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/98xB7.jpg?s=128&g=1", "display_name": "Thales Carl", "link": "https://stackoverflow.com/users/10509291/thales-carl"}, "is_accepted": false, "score": 2, "last_activity_date": 1571693860, "creation_date": 1571693860, "answer_id": 58494458, "question_id": 58420853, "link": "https://stackoverflow.com/questions/58420853/how-to-generate-a-n-sized-random-float-array-that-sums-up-to-0-0/58494458#58494458", "title": "How to generate a n-sized random float array that sums up to 0.0?", "body": "<p>Thank you guys again for the help.</p>\n\n<p>So, based on the idea of <a href=\"https://stackoverflow.com/users/11937721/cryostasys\">Cryostasys</a> I developed the following C code to solve my problem:</p>\n\n<pre><code>#include &lt;stdio.h&gt;      /* printf, scanf, puts, NULL */\n#include &lt;stdlib.h&gt;     /* srand, rand */\n#include &lt;time.h&gt;       /* time */\n#include &lt;math.h&gt;\n\nint main()\n{\n    int arraySize = 10; //input value \n    double createdArray[arraySize]; //output value\n\n    double randomPositiveVector[arraySize];\n    double randomNegativeVector[arraySize];\n    double positiveSum = 0.;\n    double negativeSum = 0.;\n\n    srand(time(NULL)); //seed for random generation\n\n    for(int i = 0; i &lt; arraySize; ++i)\n    {\n        double randomNumber = -1.+2.*rand()/((double) RAND_MAX); //random in [-1.0,1.0]\n        printf(\"%f\\n\",randomNumber);\n        if(randomNumber &gt;=0)\n        {\n            randomPositiveVector[i] = randomNumber;\n            positiveSum += randomNumber;\n        }\n        else\n        {\n            randomNegativeVector[i] = randomNumber;\n            negativeSum += randomNumber;\n        }\n    }\n    if(positiveSum == 0. || negativeSum == 0.) printf(\"ERROR\\n\");\n\n    double positiveCoefficient =  1.0/positiveSum;\n    double negativeCoefficient = -1.0/negativeSum;\n    for(int i = 0; i &lt; arraySize; ++i)\n    {\n        randomPositiveVector[i] = positiveCoefficient * randomPositiveVector[i];\n        randomNegativeVector[i] = negativeCoefficient * randomNegativeVector[i];\n        if(fabs(randomPositiveVector[i]) &gt; 1e-6) //near to zero \n        {\n            createdArray[i] = randomPositiveVector[i];\n        }\n        else\n        {\n            createdArray[i] = randomNegativeVector[i];\n        }\n    }\n\n    for(int i = 0; i &lt; arraySize; ++i)\n    {\n        printf(\"createdArray[%d] = %9f\\n\",i,createdArray[i]);\n\n    }\n\n    return(0);\n}\n</code></pre>\n\n<p>Please note that the <em>randomness</em> of the values generated is decreased, as mentioned in the comments of the question. Also, the kind of random distribution is determined by the function that you use to generate the randomNumber above. In this case, I've used <code>rand()</code> from <code>stdlib.h</code> which is based on giving a seed to the function and it is going to generate a pseudo-random number. You could use a different option, for instance, <code>drand48()</code> from <code>stdlib.h</code> as well. </p>\n\n<p>Nevertheless, it is required that at least one positive and one negative value is generated in order to this code work. One verification step was added to the code, and if it reaches this condition one should run again the code or do something about. </p>\n\n<p>Output example (arraySize = 10):</p>\n\n<pre><code>createdArray[0] = -0.013824\ncreatedArray[1] =  0.359639\ncreatedArray[2] = -0.005851\ncreatedArray[3] =  0.126829\ncreatedArray[4] = -0.334745\ncreatedArray[5] = -0.473096\ncreatedArray[6] = -0.172484\ncreatedArray[7] =  0.249523\ncreatedArray[8] =  0.262370\ncreatedArray[9] =  0.001640\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 10509291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/98xB7.jpg?s=128&g=1", "display_name": "Thales Carl", "link": "https://stackoverflow.com/users/10509291/thales-carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 749, "favorite_count": 1, "answer_count": 3, "score": 6, "last_activity_date": 1571693860, "creation_date": 1571255886, "last_edit_date": 1571267071, "question_id": 58420853, "link": "https://stackoverflow.com/questions/58420853/how-to-generate-a-n-sized-random-float-array-that-sums-up-to-0-0", "title": "How to generate a n-sized random float array that sums up to 0.0?", "body": "<p>Consider that I need a n-sized vector where each element is defined between [-1,1]. The element a[i] is a float generated by -1 + 2*rand(). I need a elegant way to ensure that the sum of the  elements of my array is equal to zero.</p>\n\n<p>I've found two possible solutions: </p>\n\n<p>The first one is this matlab function <a href=\"https://www.mathworks.com/matlabcentral/fileexchange/9700-random-vectors-with-fixed-sum\" rel=\"nofollow noreferrer\">https://www.mathworks.com/matlabcentral/fileexchange/9700-random-vectors-with-fixed-sum</a>. It has also a implementation in R, however it is too much work to implement it on C, since this function is used for a 2d array.</p>\n\n<p>The second one is provided in this thread here: <a href=\"https://stackoverflow.com/questions/24043060/generate-random-values-with-fixed-sum-in-c/24043223#24043223\">Generate random values with fixed sum in C++</a>. Essentially, the idea is to generate n numbers with a normal distribution then normalize them to with my sum. (I have implemented it using python bellow) for a vector with sum up to 1.0. It works for every sum value except for zero.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import random as rd\n\nmySum = 1;\nrandomVector = []\nrandomSum = 0\n\nfor i in range(7):\n    randomNumber = -1 + 2*rd.random()\n    randomVector.append(randomNumber)\n    randomSum  += randomNumber\n\ncoef = mySum/randomSum\nmyNewList = [j * coef for j in randomVector]\nnewsum = sum(myNewList)\n</code></pre>\n\n<p>So, is there a way to do that using C or C++? If you know a already implemented function it would be awesome. Thanks.</p>\n"}, {"tags": ["c++", "templates", "crtp"], "comments": [{"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 1, "creation_date": 1571255905, "post_id": 58420793, "comment_id": 103183832, "body": "That looks like it could work, what exactly is the problem?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 3, "creation_date": 1571255927, "post_id": 58420793, "comment_id": 103183842, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> including a text copy of the error message that you don&#39;t understand how to solve."}, {"owner": {"reputation": 2191, "user_id": 7070965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qEhQf.png?s=128&g=1", "display_name": "dtell", "link": "https://stackoverflow.com/users/7070965/dtell"}, "edited": false, "score": 0, "creation_date": 1571255966, "post_id": 58420793, "comment_id": 103183863, "body": "That could is perfectly working, cannot reproduce (whatever you error might be...)"}, {"owner": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "edited": false, "score": 0, "creation_date": 1571256115, "post_id": 58420793, "comment_id": 103183931, "body": "I updated it with the derived class. The error message is <code>incomplete type not allowed</code>."}, {"owner": {"reputation": 8075, "user_id": 2169853, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/68b89009f4066d3e1adbe72d4329c8d3?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/2169853/jens"}, "edited": false, "score": 0, "creation_date": 1571261511, "post_id": 58420793, "comment_id": 103186147, "body": "Your code does not compile because the header for enable_if is missing. Please always post a full, complete example that reproduces the issue. Additionally, the code seems to work: <a href=\"https://wandbox.org/permlink/wsUB8HxWihbC70fD\" rel=\"nofollow noreferrer\">wandbox.org/permlink/wsUB8HxWihbC70fD</a>."}, {"owner": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "reply_to_user": {"reputation": 8075, "user_id": 2169853, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/68b89009f4066d3e1adbe72d4329c8d3?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/2169853/jens"}, "edited": false, "score": 0, "creation_date": 1571261728, "post_id": 58420793, "comment_id": 103186194, "body": "@Jens I believe that the REQUIRES part is key to getting the error. I do have &lt;type_traits&gt; included. I believe the issue is that the compiler tries to initialize the base size() function before the derived one, because it is in the REQUIRES statement."}], "answers": [{"comments": [{"owner": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "edited": false, "score": 0, "creation_date": 1571262958, "post_id": 58422125, "comment_id": 103186591, "body": "What&#39;s the purpose of the size non-type template argument here? Because if I use a template like this, then all of the other details are unnecessary I believe, since I can just use enable_if_t on the non-type size argument."}, {"owner": {"reputation": 3839, "user_id": 9171697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/475b59ee1312dc014fbe1eebcd91d307?s=128&d=identicon&r=PG&f=1", "display_name": "Meowmere", "link": "https://stackoverflow.com/users/9171697/meowmere"}, "reply_to_user": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "edited": false, "score": 1, "creation_date": 1571263337, "post_id": 58422125, "comment_id": 103186708, "body": "@lightxbulb It has...absolutely no use! Added during testing, forgot to delete :) Have edited the answer."}, {"owner": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "edited": false, "score": 0, "creation_date": 1571265207, "post_id": 58422125, "comment_id": 103187207, "body": "Much appreciated. I&#39;ll try it on the morrow."}, {"owner": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "edited": false, "score": 0, "creation_date": 1571311150, "post_id": 58422125, "comment_id": 103203318, "body": "Isn&#39;t the <code>typename = ...</code> an issue. I am specifically referring to:  &quot;A common mistake is to declare two function templates that differ only in their default template arguments. This does not work because the declarations are treated as redeclarations of the same function template (default template arguments are not accounted for in function template equivalence).&quot;  From <a href=\"https://en.cppreference.com/w/cpp/types/enable_if\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/types/enable_if</a>  This is the main reason why I am using: <code>std::enable_if_t&lt;(__VA_ARGS__), bool&gt; = true</code>."}, {"owner": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "edited": false, "score": 0, "creation_date": 1571312291, "post_id": 58422125, "comment_id": 103203989, "body": "After more experiments, it turns out this works not because of the lazy evaluation, but rather because you coupled the condition with <code>T</code>. So this does not get instantiated until the cast is called. For instance this works: <code>template&lt;typename T, typename = std::enable_if_t&lt;(Derived::size() == 1), T&gt; &gt;</code>, but the problem is the one pointed out in my previous comment."}, {"owner": {"reputation": 3839, "user_id": 9171697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/475b59ee1312dc014fbe1eebcd91d307?s=128&d=identicon&r=PG&f=1", "display_name": "Meowmere", "link": "https://stackoverflow.com/users/9171697/meowmere"}, "reply_to_user": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "edited": false, "score": 0, "creation_date": 1571335523, "post_id": 58422125, "comment_id": 103216671, "body": "@lightxbulb (1) Using <code>typename = ...</code> is not an issue if you don&#39;t declare two function templates that differ only in their default template arguments. (2) Using <code>typename = ...</code> alone does not resolve the issue, you have to use <code>lazy_enable_if</code> too. (Although it compiles in MSVC, it does not compile in both gcc and clang)"}, {"owner": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "edited": false, "score": 0, "creation_date": 1571337024, "post_id": 58422125, "comment_id": 103217274, "body": "Yeah, that&#39;s why I used the <code>enable_if_t&lt;...,true&gt; = bool</code>, so I can have multiple overloads. I wasn&#39;t aware about the fact that this works only on msvc (intellisense actually thinks it is wrong). Thank you for clarifying this. Is there a way I can extend this to work with multiple overloads?"}, {"owner": {"reputation": 3839, "user_id": 9171697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/475b59ee1312dc014fbe1eebcd91d307?s=128&d=identicon&r=PG&f=1", "display_name": "Meowmere", "link": "https://stackoverflow.com/users/9171697/meowmere"}, "reply_to_user": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "edited": false, "score": 1, "creation_date": 1571339597, "post_id": 58422125, "comment_id": 103218380, "body": "@lightxbulb Give it dummy template parameters to differ the deifinitions: <a href=\"https://wandbox.org/permlink/Q0BQ3EPj58ZhYEmU\" rel=\"nofollow noreferrer\">live demo</a>"}, {"owner": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "edited": false, "score": 0, "creation_date": 1571339715, "post_id": 58422125, "comment_id": 103218417, "body": "I am trying to avoid such things. Will concepts and constraints solve this issue?"}], "tags": [], "owner": {"reputation": 3839, "user_id": 9171697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/475b59ee1312dc014fbe1eebcd91d307?s=128&d=identicon&r=PG&f=1", "display_name": "Meowmere", "link": "https://stackoverflow.com/users/9171697/meowmere"}, "is_accepted": true, "score": 3, "last_activity_date": 1571280167, "last_edit_date": 1571280167, "creation_date": 1571262610, "answer_id": 58422125, "question_id": 58420793, "link": "https://stackoverflow.com/questions/58420793/accessing-functions-of-a-derived-crtp-class-from-the-base-calls/58422125#58422125", "title": "Accessing functions of a derived crtp class from the base calls", "body": "<p>Deriving from <code>ExpressionBase&lt;Derived&gt;</code> involves the instantiation of <code>ExpressionBase&lt;Derived&gt;</code>, therefore involves the declaration of the entity </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename T, REQUIRES(size() == 1)&gt;\noperator T() const;\n</code></pre>\n\n<p>Here, <code>std::enable_if_t</code> got a template argument that is ill-formed (because <code>Derived</code> isn't complete yet). The <a href=\"https://en.cppreference.com/w/cpp/language/sfinae\" rel=\"nofollow noreferrer\">SFINAE</a> rule does not apply here, because the ill-formed expression is not in direct context of template argument type, thus it is treated as a hard error.</p>\n\n<p>In order to make the ill-formation happen at an immediate context, use the following code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;type_traits&gt;\n\ntemplate &lt;bool B, class T&gt;\nstruct lazy_enable_if_c {\n    typedef typename T::type type;\n};\n\ntemplate &lt;class T&gt;\nstruct lazy_enable_if_c&lt;false, T&gt; {};\n\ntemplate &lt;class Cond, class T&gt; \nstruct lazy_enable_if : public lazy_enable_if_c&lt;Cond::value, T&gt; {};\n\ntemplate &lt;class T&gt;\nstruct type_wrapper {\n    using type = T;\n};\n\n#define REQUIRES(...) std::enable_if_t&lt;(__VA_ARGS__), bool&gt; = true\ntemplate&lt;typename Derived&gt;\nstruct ExpressionBase {\n    Derived&amp; derived() { return static_cast&lt;Derived&amp;&gt;(*this); }\n    const Derived&amp; derived() const { return static_cast&lt;const Derived&amp;&gt;(*this); }\n\n    struct MyCond {\n        static constexpr bool value = Derived::size() == 1;\n    };\n\n    template&lt;typename T, typename = typename lazy_enable_if&lt;MyCond, type_wrapper&lt;T&gt;&gt;::type&gt;\n    operator T () const {\n        return T{};\n    }\n};\n\nstruct Derived : public ExpressionBase&lt;Derived&gt;\n{\n    constexpr static int size() {\n        return 1;\n    }\n};\n\nint main() {\n    Derived d;\n    int i = d;\n    return 0;\n}\n</code></pre>\n\n<p>It is actually adapted from <code>boost</code>, which you can find more details <a href=\"https://www.boost.org/doc/libs/1_55_0/libs/utility/enable_if.html#sec:enable_if_lazy\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 1152, "user_id": 2448032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c08546fc4340f0be3109019ef869ac9e?s=128&d=identicon&r=PG", "display_name": "lightxbulb", "link": "https://stackoverflow.com/users/2448032/lightxbulb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 2, "accepted_answer_id": 58422125, "answer_count": 1, "score": 2, "last_activity_date": 1571280167, "creation_date": 1571255616, "last_edit_date": 1571256433, "question_id": 58420793, "link": "https://stackoverflow.com/questions/58420793/accessing-functions-of-a-derived-crtp-class-from-the-base-calls", "title": "Accessing functions of a derived crtp class from the base calls", "body": "<p>I need to be able to access a static method of the derived class, from within a base CRTP class. Is there a way in which I can achieve this?</p>\n\n<p>Here is example code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#define REQUIRES(...) std::enable_if_t&lt;(__VA_ARGS__), bool&gt; = true\ntemplate&lt;typename Derived&gt;\nstruct ExpressionBase {\n    Derived&amp; derived() { return static_cast&lt;Derived&amp;&gt;(*this); }\n    const Derived&amp; derived() const { return static_cast&lt;const Derived&amp;&gt;(*this); }\n\n    constexpr static int size()\n    {\n        return Derived::size();\n    }\n\n    template&lt;typename T, REQUIRES(size() == 1)&gt;\n    operator T() const;\n};\n\nstruct Derived : public ExpressionBase&lt;Derived&gt;\n{\n    constexpr static int size()\n    {\n        return 1;\n    }\n};\n\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "console"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 3, "creation_date": 1571255131, "post_id": 58420654, "comment_id": 103183524, "body": "Seems to be working largely as expected, except that the window is so tiny that your program&#39;s output is scrolled away...? Have you tried resizing the window?"}, {"owner": {"reputation": 11, "user_id": 12228558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zb83M.png?s=128&g=1", "display_name": "daemoncel", "link": "https://stackoverflow.com/users/12228558/daemoncel"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1571255249, "post_id": 58420654, "comment_id": 103183566, "body": "thank you for responding and yes, I tried resizing it. and it says &quot;ted with code 0. Press any key to close this window . . .&quot;"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1571255323, "post_id": 58420654, "comment_id": 103183584, "body": "I think you might have to find a way to stop it opening so small in the first place. But it&#39;s also hard to rule out other factors without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (or any detail shown)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1571255412, "post_id": 58420654, "comment_id": 103183616, "body": "Put a break point on the last line in main and then run it with debugging.  What do you get then?"}, {"owner": {"reputation": 11, "user_id": 12228558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zb83M.png?s=128&g=1", "display_name": "daemoncel", "link": "https://stackoverflow.com/users/12228558/daemoncel"}, "edited": false, "score": 0, "creation_date": 1571256143, "post_id": 58420654, "comment_id": 103183944, "body": "I put a breakpoint in the last line in Main and ran it with debugging and it worked! Here&#39;s my question, but why? Why did the default console app need a breakpoint to work? Shouldn&#39;t a hello world template work by default?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1571258425, "post_id": 58420654, "comment_id": 103184955, "body": "As I said, it does work. The breakpoint &quot;froze&quot; the program at the point before the &quot;closing window&quot; text came along. You froze time. Now, using Kate&#39;s instructions, you can make it so that the appearance of the &quot;closing window&quot; text doesn&#39;t hide your program&#39;s output later on."}], "answers": [{"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1571256411, "post_id": 58420917, "comment_id": 103184075, "body": "Ah, right - &#39;twas the &quot;resolution&quot; setting I was missing. Cheers, cmd.exe!"}, {"owner": {"reputation": 11, "user_id": 12228558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zb83M.png?s=128&g=1", "display_name": "daemoncel", "link": "https://stackoverflow.com/users/12228558/daemoncel"}, "edited": false, "score": 0, "creation_date": 1571264888, "post_id": 58420917, "comment_id": 103187138, "body": "While I appreciate your help on figuring out the sizing of the window. This is not at all my issue. The hello world blinks for split second before it disappears and shows that last window. ATM, I i&#39;m not concerned with the size of the window. I&#39;ve made a video to demonstrate my issue. <a href=\"https://www.youtube.com/watch?v=e8dd5Zbn-\" rel=\"nofollow noreferrer\">youtube.com/watch?v=e8dd5Zbn-</a>"}, {"owner": {"reputation": 18517, "user_id": 203458, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1b9f56786ceba3c57d0d2fe56182a4d3?s=128&d=identicon&r=PG", "display_name": "Kate Gregory", "link": "https://stackoverflow.com/users/203458/kate-gregory"}, "edited": false, "score": 0, "creation_date": 1571265071, "post_id": 58420917, "comment_id": 103187175, "body": "you have TWO console windows? one that goes away and this one? And you&#39;re just using the default code that was generated for you? Your video link doesn&#39;t work, and I find this really hard to imagine."}, {"owner": {"reputation": 11, "user_id": 12228558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zb83M.png?s=128&g=1", "display_name": "daemoncel", "link": "https://stackoverflow.com/users/12228558/daemoncel"}, "edited": false, "score": 0, "creation_date": 1571265419, "post_id": 58420917, "comment_id": 103187271, "body": "whoops, I copied the link incorrectly <a href=\"https://www.youtube.com/watch?v=e8dd5Zbn-Jw\" rel=\"nofollow noreferrer\">youtube.com/watch?v=e8dd5Zbn-Jw</a> and yes I have two windows."}, {"owner": {"reputation": 18517, "user_id": 203458, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1b9f56786ceba3c57d0d2fe56182a4d3?s=128&d=identicon&r=PG", "display_name": "Kate Gregory", "link": "https://stackoverflow.com/users/203458/kate-gregory"}, "edited": false, "score": 0, "creation_date": 1571265565, "post_id": 58420917, "comment_id": 103187314, "body": "can you make the (second) window bigger anyway? that will make it obvious when the little one goes away and the big one appears, or if what&#39;s happening is the text in the single tiny window is changing."}, {"owner": {"reputation": 11, "user_id": 12228558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zb83M.png?s=128&g=1", "display_name": "daemoncel", "link": "https://stackoverflow.com/users/12228558/daemoncel"}, "edited": false, "score": 0, "creation_date": 1571266075, "post_id": 58420917, "comment_id": 103187440, "body": "I can but it&#39;s not as important as trying to figure out why the window disappears instantly despite a &quot;system(&quot;pause&quot;);&quot; Also yes it is two windows."}, {"owner": {"reputation": 1233, "user_id": 11872808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29d7b759b09573f7750c178d99015eca?s=128&d=identicon&r=PG&f=1", "display_name": "Jeaninez - MSFT", "link": "https://stackoverflow.com/users/11872808/jeaninez-msft"}, "edited": false, "score": 0, "creation_date": 1571278172, "post_id": 58420917, "comment_id": 103189915, "body": "I couldn&#39;t reproduce your issue on Windows system with vs2019.Can you provide detailed steps to reproduce the issue? &quot;system(&quot;pause&quot;);&quot; is part of Windows API and so it won&#39;t work in other operation systems.You should try to use just objects from C++ standard library. I suggest you could try to use &quot;cin.get(); return 0;&quot;"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1571328651, "post_id": 58420917, "comment_id": 103213674, "body": "Remove the pause call and use F5 to run, not Ctrl-F5. Also <i>please</i> make your console bigger (in console properties)."}, {"owner": {"reputation": 11, "user_id": 12228558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zb83M.png?s=128&g=1", "display_name": "daemoncel", "link": "https://stackoverflow.com/users/12228558/daemoncel"}, "edited": false, "score": 0, "creation_date": 1571677394, "post_id": 58420917, "comment_id": 103312075, "body": "The correct answer was provided to me by Jeaninez! Thank you that did it. To everyone else who keeps thinking it was my window size... that was incorrect. Regarding my window size is another matter that no matter what I do, it stays that size. I&#39;ve even gone into my registry to try to fix it to no avail. Thank you Jeaninez! Can someone please mark Jeaninez&#39;s answer as the correct one?"}, {"owner": {"reputation": 18517, "user_id": 203458, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1b9f56786ceba3c57d0d2fe56182a4d3?s=128&d=identicon&r=PG", "display_name": "Kate Gregory", "link": "https://stackoverflow.com/users/203458/kate-gregory"}, "edited": false, "score": 0, "creation_date": 1571678651, "post_id": 58420917, "comment_id": 103312631, "body": "comments can&#39;t be marked as correct answers. Also, there should be no need for <code>cin.get()</code> -- Visual Studio now holds the window open. I believe if you could make your window bigger you would see what was happening, but if you&#39;re happy with your current situation that&#39;s great, that&#39;s what we&#39;re here for."}, {"owner": {"reputation": 11, "user_id": 12228558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zb83M.png?s=128&g=1", "display_name": "daemoncel", "link": "https://stackoverflow.com/users/12228558/daemoncel"}, "edited": false, "score": 0, "creation_date": 1571681770, "post_id": 58420917, "comment_id": 103313980, "body": "Kate Gregory, once again, I appreciate your advice but the window size literally has nothing to do with my current issue. here&#39;s a new video I just made to show you: <a href=\"https://www.youtube.com/watch?v=LVUsHp9K8Tw\" rel=\"nofollow noreferrer\">youtube.com/watch?v=LVUsHp9K8Tw</a>"}], "tags": [], "owner": {"reputation": 18517, "user_id": 203458, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1b9f56786ceba3c57d0d2fe56182a4d3?s=128&d=identicon&r=PG", "display_name": "Kate Gregory", "link": "https://stackoverflow.com/users/203458/kate-gregory"}, "is_accepted": false, "score": 2, "last_activity_date": 1571256175, "creation_date": 1571256175, "answer_id": 58420917, "question_id": 58420654, "link": "https://stackoverflow.com/questions/58420654/visual-studio-community-2019-c-console-app-template-closes-instantly/58420917#58420917", "title": "Visual Studio Community 2019 C++ Console App template closes instantly", "body": "<p>It's not closing. You know that - you took a picture of it.</p>\n\n<p>It is, however, really small. And in addition VS 2019 (unlike earlier versions) adds this text about \"press any key\" to close the window. So you're not seeing your own output at all.</p>\n\n<p>Here's what to do. Click the little icon in the title bar:\n<a href=\"https://i.stack.imgur.com/9DzrW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9DzrW.png\" alt=\"enter image description here\"></a></p>\n\n<p>You will get a menu, choose Properties. This gets you a tabbed dialog: choose Layout. Change to a larger height and width and you'll be able to see what is going on.</p>\n\n<p>When you like it, after you have finished running the app and closed the console window, close Visual Studio and re-open it. Now you'll consistently get that window size.</p>\n"}, {"tags": [], "owner": {"reputation": 1233, "user_id": 11872808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29d7b759b09573f7750c178d99015eca?s=128&d=identicon&r=PG&f=1", "display_name": "Jeaninez - MSFT", "link": "https://stackoverflow.com/users/11872808/jeaninez-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1571810220, "creation_date": 1571810220, "answer_id": 58516313, "question_id": 58420654, "link": "https://stackoverflow.com/questions/58420654/visual-studio-community-2019-c-console-app-template-closes-instantly/58516313#58516313", "title": "Visual Studio Community 2019 C++ Console App template closes instantly", "body": "<p>\"system(\"pause\");\" is part of Windows API and so it won't work in other operation systems.You should try to use just objects from C++ standard library. I suggest you could try to use :</p>\n\n<pre><code>    std::cin.get(); \n    return 0;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12228558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zb83M.png?s=128&g=1", "display_name": "daemoncel", "link": "https://stackoverflow.com/users/12228558/daemoncel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571810220, "creation_date": 1571255041, "last_edit_date": 1571768067, "question_id": 58420654, "link": "https://stackoverflow.com/questions/58420654/visual-studio-community-2019-c-console-app-template-closes-instantly", "title": "Visual Studio Community 2019 C++ Console App template closes instantly", "body": "<p><strong>Edit:1</strong> There have been a lot of good suggestions to help me out. The answer by Jeaninez has helped my Hello World stay on the screen instead of blinking for a microsecond. </p>\n\n<p>But my initial question stands, why does Visual Studio 2019 default Hello World Console App not hold the Hello World open and instead open two windows. Here is a video with the fixed version and the one with the default template: <a href=\"https://www.youtube.com/watch?v=LVUsHp9K8Tw\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=LVUsHp9K8Tw</a></p>\n\n<p><em>Original Question</em>\nI'm sure this question has been asked a million times, but my issue seems to be quite different. I am using the \n<a href=\"https://i.stack.imgur.com/5JL4z.jpg\" rel=\"nofollow noreferrer\">Console App Template</a> which is by default a hello world, but when I Ctrl+F5 it to see how it works it blinks on the screen then shows this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5onZJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5onZJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried putting in a <code>return 0;</code> and made sure my project was set to Console. The only thing that I've found that helps a tiny bit is `system(\"pause\");</p>\n"}, {"tags": ["c++", "lambda", "c++17", "stdbind"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571254703, "post_id": 58420559, "comment_id": 103183370, "body": "parameter <code>t</code> should be <code>func</code> in the last snippet?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1571255113, "post_id": 58420559, "comment_id": 103183514, "body": "You need to pass <code>this</code> to <code>bind_event_fn</code> so the lambda can capture it.  Unlike macros functions run in their own scope."}, {"owner": {"reputation": 103, "user_id": 6067014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/903a80cee9058530213da12cf617b5d6?s=128&d=identicon&r=PG", "display_name": "Garzet", "link": "https://stackoverflow.com/users/6067014/garzet"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571255181, "post_id": 58420559, "comment_id": 103183541, "body": "@formerlyknownas_463035818 yes, fixed"}], "answers": [{"tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": true, "score": 5, "last_activity_date": 1571257317, "creation_date": 1571257317, "answer_id": 58421148, "question_id": 58420559, "link": "https://stackoverflow.com/questions/58420559/how-to-bind-this-using-templates-instead-of-macros/58421148#58421148", "title": "How to bind &#39;this&#39; using templates instead of macros?", "body": "<blockquote>\n  <p>I am trying to replace all macros in my code with templates.</p>\n</blockquote>\n\n<p>You can't. While there is a lot that templates can do, there is a lot of stuff that can only be handled by macros.</p>\n\n<p>Templates are patterns that generate types, functions, or variables. As such, they must live within the rules of C++ types, functions, or variables. A (non-lambda) function definition cannot reach into the scope where it was declared and just pull stuff out. Like <code>this</code> for example. A function's scope is isolated; it cannot access things outside of its scope (outside of globals and members of classes).</p>\n\n<p>Therefore, a template function cannot do that either. Two-phase lookup does allow templates to in some way be affected by the accessible names based on where they are instantiated, but this is extremely limited and doesn't help you at all in this case.</p>\n\n<p>You can't make a template instantiation import <code>this</code> automatically from where the template was instantiated. You can pass <code>this</code> as a parameter to a function, and it can use that value in the bind expression, but the template can't reach out and find <code>this</code> on its own.</p>\n"}, {"tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": false, "score": 2, "last_activity_date": 1571338600, "last_edit_date": 1571338600, "creation_date": 1571263253, "answer_id": 58422228, "question_id": 58420559, "link": "https://stackoverflow.com/questions/58420559/how-to-bind-this-using-templates-instead-of-macros/58422228#58422228", "title": "How to bind &#39;this&#39; using templates instead of macros?", "body": "<p>A Curiously Recurring Template Pattern (<a href=\"https://en.wikipedia.org/wiki/Curiously_recurring_template_pattern\" rel=\"nofollow noreferrer\">CRTP</a>) class template could help. Create a class template where you translate the macros that should work with <code>this</code> into member functions. You must then inherit it in the classes that should have access to any of the functions. </p>\n\n<p>Your code with that in place:</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\ntemplate&lt;typename T&gt;  // T = the child class\nstruct bind_helper {\n    // put \"class macros\" in here, translated into functions\n\n    template&lt;class F&gt;\n    inline auto lambda_bind_fn(F func) {\n        return // a lambda that will cast \"this\" to a \"T*\" (the class that inherited\n               // bind_helper) then dereference \"func\" and call it\n            [this, func](const int&amp; e) { return (static_cast&lt;T*&gt;(this)-&gt;*func)(e); };\n    }\n};\n\nvoid run_in_static_context(std::function&lt;void(const int&amp;)&gt; fn) {\n    fn(42);\n}\n\nclass A : public bind_helper&lt;A&gt; { // inherit with the class itself as template parameter\npublic:\n    A() { \n        run_in_static_context(lambda_bind_fn(&amp;A::member_fn)); \n    }\n\nprivate:\n    void member_fn(const int&amp; event) {\n        std::cout &lt;&lt; \"Event: \" &lt;&lt; event &lt;&lt; std::endl;\n    }\n};\n\nint main() {\n    A x;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Event: 42\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 6067014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/903a80cee9058530213da12cf617b5d6?s=128&d=identicon&r=PG", "display_name": "Garzet", "link": "https://stackoverflow.com/users/6067014/garzet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 1, "accepted_answer_id": 58421148, "answer_count": 2, "score": 2, "last_activity_date": 1571338600, "creation_date": 1571254585, "last_edit_date": 1571256656, "question_id": 58420559, "link": "https://stackoverflow.com/questions/58420559/how-to-bind-this-using-templates-instead-of-macros", "title": "How to bind &#39;this&#39; using templates instead of macros?", "body": "<p>I am trying to replace all macros in my code with templates. I have a macro that binds <code>this</code> as the first argument to a function so that a member function can be used in a static context. How can I achieve that with templates?</p>\n\n<p>I would like this functionality:</p>\n\n<pre><code>#define BIND_EVENT_FN(func) std::bind(&amp;func, this, std::placeholders::_1)\n</code></pre>\n\n<p>Or with lambdas:</p>\n\n<pre><code>#define BIND_EVENT_FN(func) [this](Event&amp; e){ return func(e); }\n</code></pre>\n\n<p>Something along the lines of this, but obviously not quite like this because this does not compile:</p>\n\n<pre><code>template&lt;class T&gt;\nauto bind_event_fn(T&amp; func)\n{\n    return [this](Event&amp;&amp; e){ return func(e); };\n}\n</code></pre>\n\n<p>Minimal working example below, is it possible to replace the macro?</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\n#define LAMBDA_BIND_FN(fn) [this](const int&amp; event) { return fn(event); }\n#define BASIC_BIND_FN(func) std::bind(&amp;func, this, std::placeholders::_1)\n\nvoid run_in_static_context(std::function&lt;void(const int&amp;)&gt; fn)\n{\n    fn(42);\n}\n\nclass A {\n  public:\n    A()\n    {\n        run_in_static_context(LAMBDA_BIND_FN(A::member_fn));\n    }\n  private:\n    void member_fn(const int&amp; event)\n    { \n        std::cout &lt;&lt; \"Event: \" &lt;&lt; event &lt;&lt; std::endl;\n    }\n};\n\nint main()\n{\n    A();\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 889, "user_id": 1521241, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/01090d621800a51df9188fc8cdb28178?s=128&d=identicon&r=PG", "display_name": "macroland", "link": "https://stackoverflow.com/users/1521241/macroland"}, "edited": false, "score": 1, "creation_date": 1571255635, "post_id": 58420553, "comment_id": 103183710, "body": "Not sure but I am assuming your semaphores have a race condition. Should not you be using threads via <code>pthread_t</code> and synchronize them using a semaphore?"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 1, "creation_date": 1571255930, "post_id": 58420553, "comment_id": 103183845, "body": "Why not use <code>std::mutex</code> and <code>std::condition_variable</code> instead? You&#39;re using <code>std::thread</code> already so apparently you have a C++11-compliant compiler."}], "answers": [{"tags": [], "owner": {"reputation": 1733, "user_id": 1460102, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e70df89ccf5e5509e4aae9ef4ed5b865?s=128&d=identicon&r=PG", "display_name": "xxks-kkk", "link": "https://stackoverflow.com/users/1460102/xxks-kkk"}, "is_accepted": true, "score": 0, "last_activity_date": 1571335990, "creation_date": 1571335990, "answer_id": 58438531, "question_id": 58420553, "link": "https://stackoverflow.com/questions/58420553/potential-race-condition-for-a-simple-multiple-threading-program/58438531#58438531", "title": "Potential race condition for a simple multiple threading program", "body": "<p>I take a further look at code and realize that there is a subtle bug in my test code: I pass <code>Foo</code> object (e.g., <code>foo</code>) by copy when create each new thread. However, I really want to have multiple threads sharing the same <code>Foo</code> object across multiple threads. Thus, I add <code>std::ref</code> to the <code>foo</code>:</p>\n\n<pre><code>threads.emplace_back(m[i + 1].first, ref(foo), m[i + 1].second);\n</code></pre>\n\n<p>In addition, I print <code>firstJobDone</code> and <code>secondJobDone</code> semaphore values using <code>sem_getvalue()</code> as following:</p>\n\n<pre><code>  Foo()\n  {\n    sem_init(&amp;firstJobDone, 0, 0);\n    sem_init(&amp;secondJobDone, 0, 0);\n    int value;\n    sem_getvalue(&amp;firstJobDone, &amp;value);\n    printf(\"The initial value of the firstJobDone is %d\\n\", value);\n    sem_getvalue(&amp;secondJobDone, &amp;value);\n    printf(\"The initial value of the secondJobDone is %d\\n\", value);\n  }\n</code></pre>\n\n<p>And quite shocking, I have:</p>\n\n<pre><code>The initial value of the firstJobDone is 32766\nThe initial value of the secondJobDone is 32766\ninput: [1,2,3] = third\nAssertion failed: (false), function test, file /home/foo/printInOrder.cc, line 101.\nAbort trap: 6\n</code></pre>\n\n<p>Both semaphores are not properly initialized to <code>0</code> with LLVM on the Mac that I'm using. However, my implementation invariant insists that both semaphores have to be initilized to <code>0</code>. I don't understand why but I'm assuming since <code>sem_init</code> is marked as deprecated by LLVM, the behavior is not guaranteed to be correct. Thus, per the comments to my question, I change my implementation using conditional variable and mutex, and everything works fine.</p>\n"}], "owner": {"reputation": 1733, "user_id": 1460102, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e70df89ccf5e5509e4aae9ef4ed5b865?s=128&d=identicon&r=PG", "display_name": "xxks-kkk", "link": "https://stackoverflow.com/users/1460102/xxks-kkk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 58438531, "answer_count": 1, "score": 0, "last_activity_date": 1571335990, "creation_date": 1571254546, "question_id": 58420553, "link": "https://stackoverflow.com/questions/58420553/potential-race-condition-for-a-simple-multiple-threading-program", "title": "Potential race condition for a simple multiple threading program", "body": "<p>I'm writing a simple program that consists of three threads. Each thread is passed in an object <code>Foo</code> and no matter which thread calls which function, the output for the program will always be <code>\"firstsecondthird\"</code>. I use semaphore and I'm writing the test code for my implementation. Sometimes, my test case passed but sometimes the test case failed:</p>\n\n<pre><code>input: [1,2,3] = firstsecond\nAssertion failed: (false), function test, file /home/foo/printInOrder.cc, line 100.\nAbort trap: 6\n</code></pre>\n\n<p>My program looks like below:</p>\n\n<pre><code>#include \"cpputility.h\"\n#include &lt;functional&gt;\n#include &lt;iostream&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;sstream&gt;\n#include &lt;string&gt;\n#include &lt;thread&gt;\n#include &lt;unordered_map&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\nvoid printFirst()\n{\n  cout &lt;&lt; \"first\" &lt;&lt; std::flush;\n}\n\nvoid printSecond()\n{\n  cout &lt;&lt; \"second\" &lt;&lt; std::flush;\n}\n\nvoid printThird()\n{\n  cout &lt;&lt; \"third\" &lt;&lt; std::flush;\n}\n\nclass Foo\n{\nprotected:\n  sem_t firstJobDone;\n  sem_t secondJobDone;\n\npublic:\n  Foo()\n  {\n    sem_init(&amp;firstJobDone, 0, 0);\n    sem_init(&amp;secondJobDone, 0, 0);\n  }\n\n  void first(function&lt;void()&gt; printFirst)\n  {\n    printFirst();\n    sem_post(&amp;firstJobDone);\n  }\n\n  void second(function&lt;void()&gt; printSecond)\n  {\n    sem_wait(&amp;firstJobDone);\n    printSecond();\n    sem_post(&amp;secondJobDone);\n  }\n\n  void third(function&lt;void()&gt; printThird)\n  {\n    sem_wait(&amp;secondJobDone);\n    printThird();\n  }\n};\n\nvoid test()\n{\n  unordered_map&lt;int, pair&lt;void (Foo::*)(function&lt;void()&gt;), function&lt;void()&gt;&gt;&gt; m({\n      {1, {&amp;Foo::first, printFirst}},\n      {2, {&amp;Foo::second, printSecond}},\n      {3, {&amp;Foo::third, printThird}},\n  });\n  struct testCase\n  {\n    vector&lt;int&gt; input;\n    string expected;\n  };\n  vector&lt;testCase&gt; test_cases = {\n      {{1, 2, 3}, \"firstsecondthird\"},\n      {{1, 3, 2}, \"firstsecondthird\"},\n  };\n  for (auto &amp;&amp;test_case : test_cases)\n  {\n    std::stringstream buffer;\n    std::streambuf *old = std::cout.rdbuf(buffer.rdbuf());\n    Foo foo;\n    vector&lt;thread&gt; threads;\n    for (int i = 0; i &lt; 3; ++i)\n    {\n      threads.emplace_back(m[i+1].first, foo, m[i+1].second);\n    }\n    for (auto &amp;&amp;th : threads)\n    {\n      th.join();\n    }\n    auto got = buffer.str();\n    if (got != test_case.expected)\n    {\n      printf(\"input: %s = %s\\n\",\n             CPPUtility::oneDVectorStr&lt;int&gt;(test_case.input).c_str(),\n             got.c_str());\n      assert(false);\n    }\n    std::cout.rdbuf(old);\n  }\n}\n\nint main()\n{\n  for(int i = 0; i &lt; 10; ++i) {\n    // Test repeatedly to detect any potential race condition\n    test();    \n  }\n}\n</code></pre>\n\n<p>The <code>oneDVectorStr</code> is some helper function I write inside a file called <code>cpputility.h</code> to help print out the 1D vector, here is the implementation to compile the code above</p>\n\n<pre><code>  template &lt;typename T&gt;\n  std::string oneDVectorStr(const std::vector&lt;T&gt;&amp; vec) {\n    std::string cand = \"[\";\n    for(int i = 0; i &lt; vec.size(); ++i) {\n      cand += std::to_string(vec[i]);\n      i != vec.size() - 1 ? cand += \",\" : cand += \"\";\n    }\n    cand += \"]\";\n    return cand;\n  }\n</code></pre>\n\n<p>I've stared at this code for quite a while but couldn't locate any race condition. Any suggestion is welcome. Thanks in advance. </p>\n"}, {"tags": ["c++", "winapi"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 3, "creation_date": 1571257663, "post_id": 58420480, "comment_id": 103184641, "body": "&quot;<i>it works perfectly</i>&quot; - <a href=\"https://devblogs.microsoft.com/oldnewthing/20050530-11/?p=35513\" rel=\"nofollow noreferrer\">no, it doesn&#39;t</a>."}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "edited": false, "score": 0, "creation_date": 1571267753, "post_id": 58420480, "comment_id": 103187815, "body": "Even if posting a message was correct, you are only posting the key down message, you forgot the up message."}, {"owner": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "edited": false, "score": 0, "creation_date": 1571275705, "post_id": 58420480, "comment_id": 103189408, "body": "What&#39;s kind of your target window? And how do you determine it works or ignored?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1571293384, "post_id": 58420480, "comment_id": 103193702, "body": "Why would a minimised window process those messages? It&#39;s minimised. It can&#39;t have input focus. It would be worth read some of the multitude of articles explaining that you can&#39;t fake input in this manner."}], "owner": {"reputation": 11, "user_id": 11798511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f691d2da6938d31ff2969f15f47527c8?s=128&d=identicon&r=PG&f=1", "display_name": "StrangeHuman", "link": "https://stackoverflow.com/users/11798511/strangehuman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571255354, "creation_date": 1571254228, "last_edit_date": 1571255354, "question_id": 58420480, "link": "https://stackoverflow.com/questions/58420480/sending-key-presses-to-minimized-window", "title": "sending key presses to minimized window", "body": "<p>I'm trying to send key press to window by it's hwnd.</p>\n\n<p><code>PostMessageA(FindWindow(NULL, WindowName);, WM_KEYDOWN, 0x0D, 0)</code></p>\n\n<p>If window is not minimized - it's works perfectly. But if windows is minimized - window ingores that.</p>\n\n<p>I'm also tried SendMessage, but SendMessage not works in any state.</p>\n\n<p>Please, help</p>\n"}, {"tags": ["c++", "qt", "opengl"], "comments": [{"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 1, "creation_date": 1571254506, "post_id": 58420414, "comment_id": 103183281, "body": "Of course you can use Qt for OpenGL drawing <a href=\"https://doc.qt.io/qt-5/qtgui-index.html\" rel=\"nofollow noreferrer\">docs</a>. It&#39;s just Qt had some classes that now are deprecated. Perhaps a more &quot;pure&quot; approach of using OpenGL stuff is using <code>glfw</code> or <code>sfml</code> or <code>wxWidgets</code> instead of Qt."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1571255059, "post_id": 58420414, "comment_id": 103183496, "body": "In SO you just have to have only one question per post, if not, your question would be too broad by asking it off-topic for SO."}, {"owner": {"reputation": 1363, "user_id": 10146757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db954baf58d875edacdd6e20256ee698?s=128&d=identicon&r=PG&f=1", "display_name": "BeastCoder", "link": "https://stackoverflow.com/users/10146757/beastcoder"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1571268905, "post_id": 58420414, "comment_id": 103188108, "body": "@Ripi2 I am using GLFW. Does that handle GUIs?"}, {"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "edited": false, "score": 2, "creation_date": 1571319942, "post_id": 58420414, "comment_id": 103208705, "body": "@BeastCoder: GLFW does handle windows, input events, and other things, that Qt does as well. In general you can not mix GLFW with Qt."}, {"owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "edited": false, "score": 0, "creation_date": 1571325817, "post_id": 58420414, "comment_id": 103212147, "body": "I still remember Qt being way ahead of anything else in the late 90s. When you use Qt now, your design decisions and application deployment are effectively dominated by Qt. You don&#39;t simple <i>use</i> the Qt libraries - you are very much developing a Qt application. That&#39;s not a bad thing in UI driven apps - but if you&#39;re creating games, I suggest GLFW, which allows for direct control of the event loop."}], "answers": [{"comments": [{"owner": {"reputation": 1363, "user_id": 10146757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db954baf58d875edacdd6e20256ee698?s=128&d=identicon&r=PG&f=1", "display_name": "BeastCoder", "link": "https://stackoverflow.com/users/10146757/beastcoder"}, "edited": false, "score": 0, "creation_date": 1571268699, "post_id": 58420620, "comment_id": 103188065, "body": "Thanks so much! I just had one question. You said I cannot use OpenGL in QT, then said I \u201cshould not use the QGLX classes that belong to the QOpenGLX package but must use the QOpenGLX classes of Qt Gui module\u201d so I can or cannot use OpenGL? Could you please clarify? Thanks for the great answer!"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 1363, "user_id": 10146757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db954baf58d875edacdd6e20256ee698?s=128&d=identicon&r=PG&f=1", "display_name": "BeastCoder", "link": "https://stackoverflow.com/users/10146757/beastcoder"}, "edited": false, "score": 0, "creation_date": 1571269260, "post_id": 58420620, "comment_id": 103188169, "body": "@BeastCoder In simple: Qt moved the classes from Qt OpenGL to Qt Gui and renamed them, in doing so it is unnecessary to keep Qt OpenGL so that Qt deleted them. So you can use opengl in Qt as shown in the examples provided in the link."}, {"owner": {"reputation": 1363, "user_id": 10146757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db954baf58d875edacdd6e20256ee698?s=128&d=identicon&r=PG&f=1", "display_name": "BeastCoder", "link": "https://stackoverflow.com/users/10146757/beastcoder"}, "edited": false, "score": 0, "creation_date": 1571273218, "post_id": 58420620, "comment_id": 103188954, "body": "Thanks so much! I\u2019ll have to learn how this all differs from GLFW. Is it a big change or more of an easy transition?"}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": false, "score": 5, "last_activity_date": 1571257744, "last_edit_date": 1571257744, "creation_date": 1571254847, "answer_id": 58420620, "question_id": 58420414, "link": "https://stackoverflow.com/questions/58420414/don-t-use-qt-opengl-anymore/58420620#58420620", "title": "Don\u2019t use QT OpenGL anymore?", "body": "<p>As the <a href=\"https://wiki.qt.io/New_Features_in_Qt_5.4\" rel=\"nofollow noreferrer\">new features of Qt 5.4</a> point out, the Qt Opengl module has been declared deprecated.</p>\n\n<blockquote>\n  <h2>Deprecated features</h2>\n  \n  <ul>\n  <li><p>Qt OpenGL:</p>\n  \n  <ul>\n  <li>The Qt OpenGL module (which contain classes that start with \"QGL\") is now deprecated in favor of the Qt GUI module (which contain\n  classes that start with \"QOpenGL\"). QGLWidget can now be replaced by\n  QOpenGLWidget.</li>\n  </ul></li>\n  </ul>\n</blockquote>\n\n<p>That does not imply that:</p>\n\n<ul>\n<li><p>the module has been removed but at any time Qt could remove it without notice.</p></li>\n<li><p>You cannot use opengl in Qt, only you should not use the QGLX classes that belong to the Qt OpenGL package but you must use the QOpenGLX classes of the Qt Gui module, for example replace <a href=\"https://doc.qt.io/qt-5/qglwidget.html\" rel=\"nofollow noreferrer\">QGLWidget</a> with <a href=\"https://doc.qt.io/qt-5/qopenglwidget.html\" rel=\"nofollow noreferrer\">QOpenGLWidget</a>.</p></li>\n</ul>\n\n<p>You can also find several examples <a href=\"https://code.qt.io/cgit/qt/qtbase.git/tree/examples/opengl?h=5.13\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "is_accepted": true, "score": 1, "last_activity_date": 1571320024, "creation_date": 1571320024, "answer_id": 58434209, "question_id": 58420414, "link": "https://stackoverflow.com/questions/58420414/don-t-use-qt-opengl-anymore/58434209#58434209", "title": "Don\u2019t use QT OpenGL anymore?", "body": "<p>Qt is probably not the right tool for you. For one you want to use GLFW, which would cross into the turf of Qt and vice versa. A much better choice for game UI stuff is <a href=\"https://github.com/ocornut/imgui\" rel=\"nofollow noreferrer\">Dear ImGUI</a> which is far better suited for the needs of game development.</p>\n"}], "owner": {"reputation": 1363, "user_id": 10146757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db954baf58d875edacdd6e20256ee698?s=128&d=identicon&r=PG&f=1", "display_name": "BeastCoder", "link": "https://stackoverflow.com/users/10146757/beastcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 868, "favorite_count": 0, "accepted_answer_id": 58434209, "answer_count": 2, "score": 1, "last_activity_date": 1571320024, "creation_date": 1571253926, "last_edit_date": 1571255006, "question_id": 58420414, "link": "https://stackoverflow.com/questions/58420414/don-t-use-qt-opengl-anymore", "title": "Don\u2019t use QT OpenGL anymore?", "body": "<p>I am new to C++, OpenGL, and QT. In fact, I\u2019ve never even touched QT. The reason for this is the following; I\u2019ve made games in a few other languages in the past (mostly C# with Unity). Now I want to get into games with c++. However, I want to use pure C++, not even Unreal (maybe one day ), for games. To do this I know that for graphics I should almost definitely be using OpenGL (which I\u2019m currently learning). I also am going to need to make GUIs. When I looked up what to use, it looked like the best option would probably be QT. This means I need QT to work with OpenGL. So again I looked it up. I found QT OpenGL on this post: <a href=\"https://stackoverflow.com/q/5807886/11689653\">How to work with OpenGL and QT?</a>. When I looked up Qt OpenGL (<a href=\"https://doc.qt.io/qt-5/qtopengl-index.html\" rel=\"nofollow noreferrer\">https://doc.qt.io/qt-5/qtopengl-index.html</a>) it said:</p>\n\n<blockquote>\n  <p><strong>Warning: This module should not be used anymore for new code. Please use the corresponding OpenGL classes in Qt GUI.</strong></p>\n</blockquote>\n\n<p>So what is QT GUI?\nAnd, how easy it to use QT with OpenGL?</p>\n"}, {"tags": ["c++", "list", "dictionary", "vector", "iterator"], "answers": [{"comments": [{"owner": {"reputation": 869, "user_id": 8977557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9435a87062e0ef32514b0aafcfae5d20?s=128&d=identicon&r=PG&f=1", "display_name": "Agrudge Amicus", "link": "https://stackoverflow.com/users/8977557/agrudge-amicus"}, "edited": false, "score": 0, "creation_date": 1571254109, "post_id": 58420420, "comment_id": 103183079, "body": "So basically iterators are holding the address hence they can&#39;t be compared as the memory in <code>list</code> is not continuous?"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 869, "user_id": 8977557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9435a87062e0ef32514b0aafcfae5d20?s=128&d=identicon&r=PG&f=1", "display_name": "Agrudge Amicus", "link": "https://stackoverflow.com/users/8977557/agrudge-amicus"}, "edited": false, "score": 1, "creation_date": 1571254219, "post_id": 58420420, "comment_id": 103183125, "body": "@AgrudgeAmicus In general the operator &lt; is not defined for bidirectional iterators and as you correctly mentioned addresses of list nodes can not be compared."}, {"owner": {"reputation": 869, "user_id": 8977557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9435a87062e0ef32514b0aafcfae5d20?s=128&d=identicon&r=PG&f=1", "display_name": "Agrudge Amicus", "link": "https://stackoverflow.com/users/8977557/agrudge-amicus"}, "edited": false, "score": 0, "creation_date": 1571254358, "post_id": 58420420, "comment_id": 103183195, "body": "can you please provide me some link to read more about this ordering requirement and what mechanics is used to create the order?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 869, "user_id": 8977557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9435a87062e0ef32514b0aafcfae5d20?s=128&d=identicon&r=PG&f=1", "display_name": "Agrudge Amicus", "link": "https://stackoverflow.com/users/8977557/agrudge-amicus"}, "edited": false, "score": 1, "creation_date": 1571254390, "post_id": 58420420, "comment_id": 103183211, "body": "@AgrudgeAmicus Iterators in a <code>list</code> are only aware of their current, previous and next elements. So if two iterators refer to elements that are more than 1 element apart, they can&#39;t tell which comes first. The address of elements can&#39;t be used for this. There&#39;s no way to know if a higher address means an element that comes earlier or later in the sequence. <code>list</code> elements can be all over the place in memory. So since comparison can only theoretically work for a limited set of iterator pairs, it&#39;s not possible to implement a general case comparison operator for them."}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 869, "user_id": 8977557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9435a87062e0ef32514b0aafcfae5d20?s=128&d=identicon&r=PG&f=1", "display_name": "Agrudge Amicus", "link": "https://stackoverflow.com/users/8977557/agrudge-amicus"}, "edited": false, "score": 1, "creation_date": 1571254562, "post_id": 58420420, "comment_id": 103183304, "body": "@AgrudgeAmicus See my updated post which I appended with the class template declaration of std::map."}, {"owner": {"reputation": 869, "user_id": 8977557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9435a87062e0ef32514b0aafcfae5d20?s=128&d=identicon&r=PG&f=1", "display_name": "Agrudge Amicus", "link": "https://stackoverflow.com/users/8977557/agrudge-amicus"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1571254573, "post_id": 58420420, "comment_id": 103183308, "body": "@Fran&#231;oisAndrieux IMHO I think despite being aware about the next and the previous element the current element can&#39;t determine whose address is having a higher value (the next one or the previous one) reason being the discontinuous nature of <code>list</code> due to which this comparison fails. Please correct me if I am wrong"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 869, "user_id": 8977557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9435a87062e0ef32514b0aafcfae5d20?s=128&d=identicon&r=PG&f=1", "display_name": "Agrudge Amicus", "link": "https://stackoverflow.com/users/8977557/agrudge-amicus"}, "edited": false, "score": 1, "creation_date": 1571254684, "post_id": 58420420, "comment_id": 103183362, "body": "@AgrudgeAmicus The address does not matter. Elements in a <code>list</code> can go back and forth in memory. There is no requirement that the order in memory matches the order in the container."}], "tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 4, "last_activity_date": 1571254518, "last_edit_date": 1571254518, "creation_date": 1571253942, "answer_id": 58420420, "question_id": 58420375, "link": "https://stackoverflow.com/questions/58420375/creating-map-with-vector-list-iterator-as-key/58420420#58420420", "title": "creating map with vector/list iterator as key", "body": "<p>The standard class <code>std:: list</code> has bidirectional iterators that do not  have the <code>operator &lt;</code> while <code>std::vector</code> has direct access iterators for which the <code>operator &lt;</code> is defined.</p>\n\n<p>This <code>operator &lt;</code> is used for ordering data in <code>std::map</code> because by default it uses the function object <code>std::less</code>.</p>\n\n<p>Here is a declaration of the class template std::map</p>\n\n<pre><code>template&lt;class Key, class T, class Compare = less&lt;Key&gt;,\nclass Allocator = allocator&lt;pair&lt;const Key, T&gt;&gt;&gt;\nclass map;\n</code></pre>\n"}], "owner": {"reputation": 869, "user_id": 8977557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9435a87062e0ef32514b0aafcfae5d20?s=128&d=identicon&r=PG&f=1", "display_name": "Agrudge Amicus", "link": "https://stackoverflow.com/users/8977557/agrudge-amicus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 58420420, "answer_count": 1, "score": 1, "last_activity_date": 1571254518, "creation_date": 1571253754, "last_edit_date": 1571254143, "question_id": 58420375, "link": "https://stackoverflow.com/questions/58420375/creating-map-with-vector-list-iterator-as-key", "title": "creating map with vector/list iterator as key", "body": "<p>I am confused over the cause of this humongous error in <code>g++</code> in this code:</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;map&gt;\n#include&lt;utility&gt;\n#include&lt;vector&gt;\n#include&lt;list&gt;\n\nusing namespace std;\n\nint main()\n{\n    list&lt;int&gt; p={1,2,3,4};\n\n    map&lt;list&lt;int&gt;::iterator, int&gt; q;\n\n    q[p.begin()]=9991;\n\n    cout&lt;&lt;q[p.begin()]&lt;&lt;endl;\n    return 0;\n}\n</code></pre>\n\n<p>There is error when <code>list</code> is used but not when <code>vector</code> is used - why? I understand how a <code>list</code><strong>\\</strong><code>vector</code> behaves (theoretically) but still I can't find a reason for this.</p>\n\n<p><strong>ERROR:</strong></p>\n\n<blockquote>\n  <p>error: no match for \u2018operator&lt;\u2019 (operand types are \u2018const std::_List_iterator\u2019 and \u2018const std::_List_iterator\u2019)\n         { return __x &lt; __y; }</p>\n</blockquote>\n"}, {"tags": ["c++", "visual-studio", "glfw", "lnk2019"], "comments": [{"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1571253778, "post_id": 58420341, "comment_id": 103182922, "body": "Welcome to SO! Did you add <code>opengl32</code> library (appart from the headers) to your project?"}, {"owner": {"reputation": 877, "user_id": 4241078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1298bd3c96afd9316d50eea60587efd?s=128&d=identicon&r=PG&f=1", "display_name": "bloody", "link": "https://stackoverflow.com/users/4241078/bloody"}, "edited": false, "score": 0, "creation_date": 1571256237, "post_id": 58420341, "comment_id": 103183997, "body": "Did you set all the settings for  &#39;All configurations&#39; and not for a single (Debug/Release) mode?"}, {"owner": {"reputation": 18517, "user_id": 203458, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1b9f56786ceba3c57d0d2fe56182a4d3?s=128&d=identicon&r=PG", "display_name": "Kate Gregory", "link": "https://stackoverflow.com/users/203458/kate-gregory"}, "edited": false, "score": 0, "creation_date": 1571256488, "post_id": 58420341, "comment_id": 103184111, "body": "These are linker errors. Nothing about include directories will fix them. Did it work when you ran a release build? If so, check the debug properties which are independent of the release properties."}, {"owner": {"reputation": 1, "user_id": 12228595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff4beaf91874951f2b79b1226458fdb?s=128&d=identicon&r=PG&f=1", "display_name": "vivek", "link": "https://stackoverflow.com/users/12228595/vivek"}, "edited": false, "score": 0, "creation_date": 1571290750, "post_id": 58420341, "comment_id": 103192734, "body": "ripi2 your suggestion worked i got the result."}], "owner": {"reputation": 1, "user_id": 12228595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff4beaf91874951f2b79b1226458fdb?s=128&d=identicon&r=PG&f=1", "display_name": "vivek", "link": "https://stackoverflow.com/users/12228595/vivek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 333, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1571256443, "creation_date": 1571253618, "last_edit_date": 1571256443, "question_id": 58420341, "link": "https://stackoverflow.com/questions/58420341/linker-errors-with-opengl", "title": "Linker errors with opengl", "body": "<p>I am writing code in opengl using C++ in Visual Studio. I have done all the include directories correctly (including glfw include and glfw libraries in the properties), and lib directories correctly but I am getting this error</p>\n\n<blockquote>\n  <p>1.Severity    Code    Description Project File    Line    Suppression State Error LNK2019 unresolved external symbol __imp__glViewport@16\n  referenced in function\n  _main timeinput2  C:\\Users\\user\\source\\repos\\timeinput2\\Source.obj    1<br>\n  2.Severity    Code    Description Project File    Line    Suppression State Error LNK2019 unresolved external symbol __imp__glOrtho@48 referenced\n  in function\n  _main timeinput2  C:\\Users\\user\\source\\repos\\timeinput2\\Source.obj    1<br>\n  3.Severity    Code    Description Project File    Line    Suppression State Error LNK2019 unresolved external symbol __imp__glMatrixMode@4\n  referenced in function\n  _main timeinput2  C:\\Users\\user\\source\\repos\\timeinput2\\Source.obj    1<br>\n  4.Severity    Code    Description Project File    Line    Suppression State Error LNK2019 unresolved external symbol __imp__glLoadIdentity@0\n  referenced in function\n  _main timeinput2  C:\\Users\\user\\source\\repos\\timeinput2\\Source.obj    1<br>\n  5.Severity    Code    Description Project File    Line    Suppression State Error LNK2019 unresolved external symbol __imp__glClear@4 referenced\n  in function\n  _main timeinput2  C:\\Users\\user\\source\\repos\\timeinput2\\Source.obj    1</p>\n</blockquote>\n\n<p>Why?</p>\n"}, {"tags": ["c++", "debugging", "cuda", "iostream", "stringstream"], "answers": [{"comments": [{"owner": {"reputation": 27952, "user_id": 3747990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qE6kU.png?s=128&g=1", "display_name": "Niall", "link": "https://stackoverflow.com/users/3747990/niall"}, "edited": false, "score": 0, "creation_date": 1571255368, "post_id": 58420340, "comment_id": 103183602, "body": "By the sounds of it, all you really need to do is pick up <code>basic_stringbuf</code> as a base and override the <code>sync()</code> function to do the internal <code>printf</code>"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 27952, "user_id": 3747990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qE6kU.png?s=128&g=1", "display_name": "Niall", "link": "https://stackoverflow.com/users/3747990/niall"}, "edited": false, "score": 0, "creation_date": 1571256253, "post_id": 58420340, "comment_id": 103184002, "body": "@Niall: Do you mean properly inherit from it, or copy-paste the code for <code>basic_stringbuf</code>? Remember that to run anything as CUDA device-side code, it needs to either be constexpr or decorated with <code>__device__</code>."}, {"owner": {"reputation": 27952, "user_id": 3747990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qE6kU.png?s=128&g=1", "display_name": "Niall", "link": "https://stackoverflow.com/users/3747990/niall"}, "edited": false, "score": 0, "creation_date": 1571256589, "post_id": 58420340, "comment_id": 103184141, "body": "I see the complication, can\u2019t remember what all is constexpr if anything there, may not be worth the headache then. A stripped out string stream may be easier."}], "tags": [], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "is_accepted": false, "score": 2, "last_activity_date": 1587032092, "last_edit_date": 1587032092, "creation_date": 1571253609, "answer_id": 58420340, "question_id": 58420339, "link": "https://stackoverflow.com/questions/58420339/least-onerous-way-to-implement-generic-formatted-stream-output-in-cuda/58420340#58420340", "title": "Least onerous way to implement generic formatted stream output in CUDA?", "body": "<p>Currently, the way I'm thinking of implementing this is:</p>\n\n<ul>\n<li>Implement an <code>std::ostringstream</code>-like class which can take its initial storage from elsewhere (on construction).</li>\n<li>With such an object, you can then <code>printf(\"%s\\n\", my_gpu_sstream.str())</code> .</li>\n<li>Allow the GPU-ostringstream to be constructed with a fixed-sized buffer.</li>\n<li>Allow the GPU-ostringstream to allocate variable-size buffers using CUDA's device-side <code>malloc()</code>.</li>\n</ul>\n\n<p>and Bob's your uncle. </p>\n\n<p>However, I would really rather avoid implementing a full-blown stringstream myself. Seems like a whole lot of redundant work and code.</p>\n\n<p><strong>Edit:</strong> Done! I now havea working implementation in my <a href=\"https://github.com/eyalroz/cuda-kat/\" rel=\"nofollow noreferrer\">cuda-kat library</a>. I've used robhz786's <a href=\"https://github.com/robhz786/strf\" rel=\"nofollow noreferrer\"><code>strf</code> library</a>, which is (header-only-if-you-like) string formatting library not based on standard streams. On its basis I've implemented an on-device stringstream, <a href=\"https://github.com/eyalroz/cuda-kat/blob/master/src/kat/on_device/streams/stringstream.cuh\" rel=\"nofollow noreferrer\"><code>kat::stringstream</code></a>, and on the basis of that, a <a href=\"https://github.com/eyalroz/cuda-kat/blob/master/src/kat/on_device/streams/printfing_ostream.cuh\" rel=\"nofollow noreferrer\">\"printf'ing ostream\" class</a>. </p>\n\n<p>It's far from perfect: <code>strf</code> doesn't use standard library manipulators and has it's own idioms for filling, setting precision etc. Also, compilation time is quite high. But it is quite usable. Even has the option to prepend each printed line with a prefix (e.g. the block &amp; thread indices) if you configure it to do so. Output uses CUDA's intrinsic <code>printf()</code> mechanism - when reaching the end of a line.</p>\n"}], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1587032092, "creation_date": 1571253609, "last_edit_date": 1571255356, "question_id": 58420339, "link": "https://stackoverflow.com/questions/58420339/least-onerous-way-to-implement-generic-formatted-stream-output-in-cuda", "title": "Least onerous way to implement generic formatted stream output in CUDA?", "body": "<p>I want to be able to write something close to:</p>\n\n<pre><code>std::cout &lt;&lt; \"Hello\" &lt;&lt; my_world_string &lt;&lt; \", \" &lt;&lt; std::setprecision(5) &lt;&lt; my_double &lt;&lt; '\\n';\n</code></pre>\n\n<p>in CUDA device-side code, for debugging templated functions - and for this kind of line of code to result in a single, unbroken, output line (i.e. the equivalent of a single CUDA <code>printf()</code> call - which typically doesn't get mangled with output from other threads).</p>\n\n<p>Of course, that's not possible since there are no files or file descriptors in device-side code, nor is any of the <code>std::ostream</code> code usable in device-side code. Essentially what we have to work with is CUDA's hardware+software hack enabling <code>printf()</code>s. But it is obviously possible to get something like:</p>\n\n<pre><code>stream  &lt;&lt; \"Hello\" &lt;&lt; my_world_string &lt;&lt; \", \" &lt;&lt; foo::setprecision(5) &lt;&lt; my_double &lt;&lt; '\\n'; \nstream.flush();\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>stream  &lt;&lt; \"Hello\" &lt;&lt; my_world_string &lt;&lt; \", \" &lt;&lt; foo::setprecision(5) &lt;&lt; my_double &lt;&lt; '\\n'; \nprintf(\"%s\", stream.str());\n</code></pre>\n\n<p>My question is: What should I implement which would allow me to write code as close to the above as possible, minimizing effort / amount of code to write?</p>\n\n<p>Notes:</p>\n\n<ul>\n<li>I used the identifier <code>stream</code> but it doesn't have to be a stream. Nor does the code need to look just like I laid it out. The point is for me to be able to have printing code in a templated device function.</li>\n<li>All code will be written in C++11.</li>\n<li>Code may assume compilation is performed either with C++11 or a later version of the standard.</li>\n<li>I can use existing FOSS code, but only if its license is permissive, e.g. 3-BSD, CC-BY-SA, MIT - but not GPL.</li>\n</ul>\n"}, {"tags": ["c++", "angular", "websocket", "esp8266wifi"], "answers": [{"tags": [], "owner": {"reputation": 26053, "user_id": 982341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07129b74cbf0de1a592c7a98224f9e16?s=128&d=identicon&r=PG", "display_name": "GreyBeardedGeek", "link": "https://stackoverflow.com/users/982341/greybeardedgeek"}, "is_accepted": false, "score": 0, "last_activity_date": 1571255929, "creation_date": 1571255929, "answer_id": 58420867, "question_id": 58420301, "link": "https://stackoverflow.com/questions/58420301/esp8266-websocket-server-and-sodcket-io-client-in-angular-7/58420867#58420867", "title": "esp8266 websocket server and sodcket.io client in angular 7", "body": "<p>It's a lot to ask for someone to actually try to debug this (to do so, I'd have to create an Angular project using your Angular code, and also set up an ESP8266 sketch using your Arduino code), so I'm not going to try, but here's a couple of suggestions:</p>\n\n<ol>\n<li><p>Try setting up a WebSocket server in Node, using the example code in the socket.io-client documentation. If that works, then you've narrowed the problem down to the ESP8266 code. If it fails in the same way, then you have a problem in your Angular client.</p></li>\n<li><p>If the problem is in your Angular code, I'd suggest using the rsjx WebSocketSubject class. It gives you a fully configured WebSocket client, works really well, and would eliminate your low-level websocket client code.</p></li>\n</ol>\n\n<p>Here's an example of connecting to the WebSocket, subscribing to inbound messages, and sending an outbound message:</p>\n\n<pre><code>connect() {\n    this.webSocket = webSocket(environment.chatUrl);\n\n    this.subscription = this.webSocket.subscribe(msg =&gt; {\n      console.log('got message: ' + msg);\n    },\n    err =&gt; {\n        this.setDisconnected();\n        console.log('err!', err);\n    },\n      () =&gt; {\n        console.log('websocket closed'));\n        this.setDisconnected();\n      }\n    );\n\n    this.webSocket.next({\n      name: this.name\n    });\n  }\n</code></pre>\n\n<p>and here's sending a message:</p>\n\n<pre><code>\n  sendMessage(msg: string) {\n    if (this.connected) {\n      this.webSocket.next(msg);\n    }\n  }\n</code></pre>\n\n<p>and here's disconnecting:</p>\n\n<pre><code>  private disconnect() {\n    if (this.subscription) {\n      this.webSocket.complete();\n      this.subscription.unsubscribe();\n      this.subscription = undefined;\n      this.setDisconnected();\n    }\n  }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11368824, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyNsvqIpAMU/AAAAAAAAAAI/AAAAAAAAAHk/BgtpSrWHMa8/photo.jpg?sz=128", "display_name": "Omkar Yadav", "link": "https://stackoverflow.com/users/11368824/omkar-yadav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571255929, "creation_date": 1571253430, "question_id": 58420301, "link": "https://stackoverflow.com/questions/58420301/esp8266-websocket-server-and-sodcket-io-client-in-angular-7", "title": "esp8266 websocket server and sodcket.io client in angular 7", "body": "<p>I am using esp8266 to run my websocket server and angular 7 to run socket.io to run websocket client. When I run the angular application. The logs in Arduino shows Disconnected!. I am not sure what is causing this.</p>\n\n<p>following is the angular side code for client.</p>\n\n<pre><code>import * as io from 'socket.io-client';\nimport { Observable } from 'rxjs/Observable';\nimport * as Rx from 'rxjs/Rx';\nimport { environment } from 'src/environments/environment';\n\n@Injectable()\nexport class SocketServiceService {\n  private socket;\n\n  constructor() { }\n\n  connect(): Rx.Subject&lt;MessageEvent&gt; {\n\n    this.socket = io('ws://192.168.43.155:81');\n    console.log(\"created server\")\n    let observable = new Observable(observer =&gt; {\n        this.socket.on('message', (data) =&gt; {\n          console.log(\"Received message from Websocket Server\")\n          observer.next(data);\n        })\n        return () =&gt; {\n          this.socket.disconnect();\n        }\n    });\n    let observer = {\n        next: (data: Object) =&gt; {\n            this.socket.emit('message', JSON.stringify(data));\n            console.log(\"msg emited\"+ data);\n        },\n    };\n    return Rx.Subject.create(observer, observable);\n  }\n\n} \n</code></pre>\n\n<p>this is esp8266 code</p>\n\n<pre><code>#include &lt;Arduino.h&gt;\n\n#include &lt;ESP8266WiFi.h&gt;\n#include &lt;ESP8266WiFiMulti.h&gt;\n#include &lt;WebSocketsServer.h&gt;\n#include &lt;Hash.h&gt;\n\nESP8266WiFiMulti WiFiMulti;\n\nWebSocketsServer webSocket = WebSocketsServer(81);\n\n#define USE_SERIAL Serial1\n\nvoid webSocketEvent(uint8_t num, WStype_t type, uint8_t * payload, size_t length) {\n\n    switch(type) {\n        case WStype_DISCONNECTED:\n            USE_SERIAL.printf(\"[%u] Disconnected!\\n\", num);\n            break;\n        case WStype_CONNECTED:\n            {\n                IPAddress ip = webSocket.remoteIP(num);\n                USE_SERIAL.printf(\"[%u] Connected from %d.%d.%d.%d url: %s\\n\", num, ip[0], ip[1], ip[2], ip[3], payload);\n\n                webSocket.sendTXT(num, \"Connected\");\n            }\n            break;\n        case WStype_TEXT:\n            USE_SERIAL.printf(\"[%u] get Text: %s\\n\", num, payload);\n\n            break;\n        case WStype_BIN:\n            USE_SERIAL.printf(\"[%u] get binary length: %u\\n\", num, length);\n            hexdump(payload, length);\n            break;\n    }\n\n}\n\nvoid setup() {\n    USE_SERIAL.begin(115200);\n\n    USE_SERIAL.setDebugOutput(true);\n\n    USE_SERIAL.println();\n    USE_SERIAL.println();\n    USE_SERIAL.println();\n\n    for(uint8_t t = 4; t &gt; 0; t--) {\n        USE_SERIAL.printf(\"[SETUP] BOOT WAIT %d...\\n\", t);\n        USE_SERIAL.flush();\n        delay(1000);\n    }\n\n    WiFiMulti.addAP(\"SSID\", \"passpasspass\");\n\n    while(WiFiMulti.run() != WL_CONNECTED) {\n        delay(100);\n    }\n\n    webSocket.begin();\n    webSocket.onEvent(webSocketEvent);\n}\n\nvoid loop() {\n    webSocket.loop();\n}\n</code></pre>\n\n<p>please Suggest what might be going wrong, Any pointers will be helpful. </p>\n"}, {"tags": ["c++", "lambda", "function-pointers", "member-function-pointers"], "comments": [{"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1571253383, "post_id": 58420213, "comment_id": 103182769, "body": "<a href=\"https://stackoverflow.com/q/58345417/3871028\">Simliar issue</a>."}], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 10595546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BZ3zj.jpg?s=128&g=1", "display_name": "Earl of Lemongrab", "link": "https://stackoverflow.com/users/10595546/earl-of-lemongrab"}, "edited": false, "score": 0, "creation_date": 1571253921, "post_id": 58420387, "comment_id": 103182990, "body": "Oh ok thanks. How would the solution with std::function roughly look like?"}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "reply_to_user": {"reputation": 311, "user_id": 10595546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BZ3zj.jpg?s=128&g=1", "display_name": "Earl of Lemongrab", "link": "https://stackoverflow.com/users/10595546/earl-of-lemongrab"}, "edited": false, "score": 0, "creation_date": 1571254242, "post_id": 58420387, "comment_id": 103183140, "body": "Just change your typedef to <code>typedef std::function&lt;void(sf::Event const&amp;)&gt; Callback;</code>, <code>std::function</code> pretty much behaves like a normal function pointer except you can assign any kind of functor (including lambdas) to them"}, {"owner": {"reputation": 311, "user_id": 10595546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BZ3zj.jpg?s=128&g=1", "display_name": "Earl of Lemongrab", "link": "https://stackoverflow.com/users/10595546/earl-of-lemongrab"}, "edited": false, "score": 0, "creation_date": 1571255717, "post_id": 58420387, "comment_id": 103183743, "body": "Thanks Alan; about &quot;You then need to store your state in an object&quot;: Do you mean e.g. <code>this</code> as a state? So <code>void* data</code> is the argument for the object on which the lambda is called?"}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "reply_to_user": {"reputation": 311, "user_id": 10595546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BZ3zj.jpg?s=128&g=1", "display_name": "Earl of Lemongrab", "link": "https://stackoverflow.com/users/10595546/earl-of-lemongrab"}, "edited": false, "score": 0, "creation_date": 1571260118, "post_id": 58420387, "comment_id": 103185629, "body": "you&#39;d make it whatever you need to use in your function. Just stick to <code>std::function</code> unless you really have to do something different"}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "reply_to_user": {"reputation": 311, "user_id": 10595546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BZ3zj.jpg?s=128&g=1", "display_name": "Earl of Lemongrab", "link": "https://stackoverflow.com/users/10595546/earl-of-lemongrab"}, "edited": false, "score": 0, "creation_date": 1571392109, "post_id": 58420387, "comment_id": 103234499, "body": "You should ask a new question (and link back to this one if you like) rather than editing a new question into your existing one"}], "tags": [], "owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "is_accepted": true, "score": 2, "last_activity_date": 1571253789, "creation_date": 1571253789, "answer_id": 58420387, "question_id": 58420213, "link": "https://stackoverflow.com/questions/58420213/how-to-create-a-vector-filled-with-c-style-function-pointers-and-lambdaswith-an/58420387#58420387", "title": "How to create a vector filled with C-Style function pointers and lambdas(with and without captures)", "body": "<p>Lambdas with captures aren't convertible to function pointers. A plain function pointer hasn't got anywhere to store the state for the lambda's captures.</p>\n\n<p><code>std::function</code> is an object so can store a lambda with or without captures.</p>\n\n<p>If you must use raw function pointers then you need to store a function pointer and a state then pass the state to the function when you call it. e.g.</p>\n\n<pre><code>typedef void(*Callback)(sf::Event const&amp;, void* data);\nstd::unordered_map&lt; sf::Event::EventType , std::vector&lt; std::pair&lt; Callback, void* &gt; &gt; &gt; eventMap;\n</code></pre>\n\n<p>You then need to store your state in an object, store the object somewhere so that it stays alive. Inside your object you need to cast from <code>void*</code> back to your state object pointer. If you aren't using a c library that requires plain function pointers then it really is much simpler to just use <code>std::function</code> which does all this for you.</p>\n"}], "owner": {"reputation": 311, "user_id": 10595546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BZ3zj.jpg?s=128&g=1", "display_name": "Earl of Lemongrab", "link": "https://stackoverflow.com/users/10595546/earl-of-lemongrab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 58420387, "answer_count": 1, "score": 1, "last_activity_date": 1571389208, "creation_date": 1571253087, "last_edit_date": 1571389208, "question_id": 58420213, "link": "https://stackoverflow.com/questions/58420213/how-to-create-a-vector-filled-with-c-style-function-pointers-and-lambdaswith-an", "title": "How to create a vector filled with C-Style function pointers and lambdas(with and without captures)", "body": "<p>Ive been learning about lambdas and function pointers lately and wanted to use them in a simple callback system. \nThe map that stores an event and all callbacks that should be called when it gets triggered looks like this:<br>\n <code>std::unordered_map&lt; sf::Event::EventType , std::vector&lt; Callback &gt; &gt; eventMap;</code>.</p>\n\n<p>I defined Callback this way \n<code>typedef void(*Callback)(sf::Event const&amp;);</code>. My <code>registerEvent()</code> function takes an event and a Callback as arguments.<br>\n<code>registerEvent()</code>can then be called this way:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>inputHandler.registerEvent(/*Any event type*/, [](sf::Event const&amp;)\n{\n    //do something\n});\n</code></pre>\n\n<p>That works fine but when I want to capture an object I get an compile error saying \n<code>error: no matching function for call to \u2018InputHandler::registerEvent(sf::Event::EventType, Button::Button(ID, Callback, InputHandler&amp;)::&lt;lambda(const sf::Event&amp;)&gt;)\u2019</code> The code that produces that error is the following:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class Button\n{\n//\npublic:\n    Button(ID id, Callback callback, InputHandler&amp; inputhandler)\n    {\n        inputhandler.registerEvent(sf::Event::MouseButtonPressed, [this](sf::Event const&amp;)\n        {\n            {\n              getTextureRect();  \n            }\n        });\n    }\n};\n</code></pre>\n\n<p>It seems as if the <code>this</code> capture is changing the type of the lambda, which makes it incompatible with the <code>registerEvent()</code> function. But since lots of different classes should be able to create such lambdas and also lambdas without any capture should be contained in the vector, I don't know how to tell what type the vector should be. I heard of <code>std::function</code> but (this may sound silly) I would like to use the C-Style way in order to get a better understanding. I think <a href=\"https://stackoverflow.com/a/52190093/10595546\">this</a> post says something about that but I don't quite understand it that well. I thought about creating two maps, one for all capture-less lambdas and one for the others. Then I could let every class inherit from a base class and make the capture type in the vector a pointer to the base class, though this is pretty complex and adds unnecessary overhead and I don't even know if this would work.\nWhat is the general solution for a situation like this one?</p>\n\n<p>Thanks for all replies and best regards,</p>\n\n<p>Daniel Schreiber Mendes :)</p>\n\n<p><strong><em>Edit:</em></strong><br>\nCallback now looks like this:\n<code>typedef std::function&lt; void(sf::Event const&amp;) &gt; Callback;</code>\nAnd when I want to use it:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>//inside the Button Constructor\ninputhandler.registerEvent(sf::Event::MouseButtonPressed, Callback([this](sf::Event const&amp; event)\n        {\n            //memberFunc();\n        }));\n</code></pre>\n\n<p>This did not give me an error but behaved in a wrong way. It did execute the lambda, but it didn't change the class in which it was defined. So I added a line in the constructor which just prints the address of the just created object. I am creating only one Button, so there should be only one adress printed. But there were two different. That means when inserting the lambda wrapped in a std::function into a vector, a new Button object gets created. How can that be? An implicit Object creation?</p>\n\n<p>Thanks for your answers :)</p>\n"}, {"tags": ["c++", "winapi", "rsa", "cng"], "comments": [{"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1571254160, "post_id": 58419870, "comment_id": 103183101, "body": "Why do you think Bcrypt has anything to do with RSA? It doesn&#39;t. Perhaps you can take a step back before Bcrypt and RSA and tell us what problem you&#39;re trying to solve."}, {"owner": {"reputation": 53, "user_id": 11467293, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-10XrgxNM9i4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reIxr5lSzuUU1TC0csTCKlhZOiXFQ/mo/photo.jpg?sz=128", "display_name": "roberto carlos", "link": "https://stackoverflow.com/users/11467293/roberto-carlos"}, "reply_to_user": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1571254543, "post_id": 58419870, "comment_id": 103183294, "body": "According to CNG docs, I can use BCrypt to do asymmetric encryption using RSA algorithm.  I&#39;m trying to a make simple example to learn. I&#39;m not able to progress because I can&#39;t find any example for asymmetric encryption using CNG with the key pair in plain-text."}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1571254980, "post_id": 58419870, "comment_id": 103183473, "body": "Ah, my apologies roberto, I see now that microsoft&#39;s Bcrypt is not the same Bcrypt I was expecting. Nevermind"}, {"owner": {"reputation": 53, "user_id": 11467293, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-10XrgxNM9i4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reIxr5lSzuUU1TC0csTCKlhZOiXFQ/mo/photo.jpg?sz=128", "display_name": "roberto carlos", "link": "https://stackoverflow.com/users/11467293/roberto-carlos"}, "reply_to_user": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1571255597, "post_id": 58419870, "comment_id": 103183695, "body": "No problem! Thanks anyway."}], "answers": [{"tags": [], "owner": {"reputation": 6168, "user_id": 10611792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r727s.jpg?s=128&g=1", "display_name": "Drake Wu", "link": "https://stackoverflow.com/users/10611792/drake-wu"}, "is_accepted": true, "score": 2, "last_activity_date": 1571293755, "creation_date": 1571293755, "answer_id": 58426210, "question_id": 58419870, "link": "https://stackoverflow.com/questions/58419870/how-to-use-bcrypt-for-rsa-asymmetric-encryption/58426210#58426210", "title": "How to use BCrypt for RSA (asymmetric encryption)", "body": "<p>There is an sample here: <a href=\"https://social.msdn.microsoft.com/Forums/windowsdesktop/en-US/007a0e26-7fc0-4079-9b63-2ad23f866836/bug-in-rsa-encryptiondecryption-using-cng?forum=windowssdk\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/windowsdesktop/en-US/007a0e26-7fc0-4079-9b63-2ad23f866836/bug-in-rsa-encryptiondecryption-using-cng?forum=windowssdk</a></p>\n\n<p>Please note that the first byte of encrypted data should not exceed 0xb6. And there is a detailed explanation in the post.</p>\n\n<p>Take encryption as an example,\nFirst, use <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/bcrypt/nf-bcrypt-bcryptopenalgorithmprovider\" rel=\"nofollow noreferrer\"><code>BCryptOpenAlgorithmProvider</code></a> to load and initialize a CNG provider that specify RSA.</p>\n\n<pre><code>#define NT_SUCCESS(Status)          (((NTSTATUS)(Status)) &gt;= 0)\nstatus = BCryptOpenAlgorithmProvider(&amp;hAlgorithm,\n    BCRYPT_RSA_ALGORITHM,\n    NULL,\n    0);\nif (!NT_SUCCESS(status)) {\n    printf(\"Failed to get algorithm provider..status : %08x\\n\", status);\n    goto cleanup;\n}\n</code></pre>\n\n<p>Then, <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/bcrypt/nf-bcrypt-bcryptimportkeypair\" rel=\"nofollow noreferrer\"><code>BCryptImportKeyPair</code></a></p>\n\n<pre><code>status = BCryptImportKeyPair(hAlgorithm,\n    NULL,\n    BCRYPT_RSAPUBLIC_BLOB,\n    &amp;hKey,\n    PublicKey,\n    PublicKeySize,\n    BCRYPT_NO_KEY_VALIDATION);\nif (!NT_SUCCESS(status)) {\n    printf(\"Failed to import Private key..status : %08x\\n\", status);\n    goto cleanup;\n}\n</code></pre>\n\n<p>To get Encrypted Buffer Size:</p>\n\n<pre><code>status = BCryptEncrypt(hKey,\n    InputData,\n    InputDataSize,\n    NULL,\n    NULL,\n    0,\n    NULL,\n    0,\n    &amp;EncryptedBufferSize,\n    0\n);\nif (!NT_SUCCESS(status)) {\n    printf(\"Failed to get required size of buffer..status : %08x\\n\", status);\n    goto cleanup;\n}\n\nencryptedBuffer = (PUCHAR)HeapAlloc(GetProcessHeap(), 0, encryptedBufferSize);\nif (encryptedBuffer == NULL) {\n    printf(\"failed to allocate memory for blindedFEKBuffer\\n\");\n    goto cleanup;\n}\n</code></pre>\n\n<p>Encrypte Data:</p>\n\n<pre><code>status = BCryptEncrypt(hKey,\n    InputData,\n    InputDataSize,\n    NULL,\n    NULL,\n    0,\n    encryptedBuffer,\n    encryptedBufferSize,\n    &amp;encryptedBufferSize,\n    0\n);\n\nif (!NT_SUCCESS(status)) {\n    printf(\"Failed encrypt data..status : %08x\\n\", status);\n    goto cleanup;\n}\ncleanup:\nif (hKey)\n    BCryptDestroyKey(hKey);\nif (hAlgorithm)\n    BCryptCloseAlgorithmProvider(hAlgorithm, 0);\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 11467293, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-10XrgxNM9i4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reIxr5lSzuUU1TC0csTCKlhZOiXFQ/mo/photo.jpg?sz=128", "display_name": "roberto carlos", "link": "https://stackoverflow.com/users/11467293/roberto-carlos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1592, "favorite_count": 0, "accepted_answer_id": 58426210, "answer_count": 1, "score": 0, "last_activity_date": 1571293755, "creation_date": 1571251626, "last_edit_date": 1571252041, "question_id": 58419870, "link": "https://stackoverflow.com/questions/58419870/how-to-use-bcrypt-for-rsa-asymmetric-encryption", "title": "How to use BCrypt for RSA (asymmetric encryption)", "body": "<p>I'm trying to make simple working example of encryption and decryption with BCrypt but I'm can't get it to work because I don't understand exactly how.\nFrom <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/bcrypt/nf-bcrypt-bcryptencrypt\" rel=\"nofollow noreferrer\">BCryptEncrypt Function, Microsoft Docs</a>:</p>\n\n<pre><code>NTSTATUS BCryptEncrypt(\n  BCRYPT_KEY_HANDLE hKey,\n  PUCHAR            pbInput,\n  ULONG             cbInput,\n  VOID              *pPaddingInfo,\n  PUCHAR            pbIV,\n  ULONG             cbIV,\n  PUCHAR            pbOutput,\n  ULONG             cbOutput,\n  ULONG             *pcbResult,\n  ULONG             dwFlags\n);\n</code></pre>\n\n<p>I generated a simple 512bit key pair on <a href=\"https://8gwifi.org/RSAFunctionality?keysize=512\" rel=\"nofollow noreferrer\">8gwifi.org</a>:</p>\n\n<pre><code>string Public_Key = \"MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAJSNbUhCkU9RuY99L8kC2WRJ8TBES3WX1u9wYlANvUFU/h7lU8VNOWI8dNGCQ6UbK2ypHFom+Zm4BaG1zokwcUkCAwEAAQ==\";\nstring Private_Key = \"MIIBOgIBAAJBAJSNbUhCkU9RuY99L8kC2WRJ8TBES3WX1u9wYlANvUFU/h7lU8VNOWI8dNGCQ6UbK2ypHFom+Zm4BaG1zokwcUkCAwEAAQJAZ9bwZAl8L5jt//o/E+C0+2Cggt/Ka5nG+bpyTok8GNTyaG+Prmz/QCYdI3VuYdONdfAPm3jLwtbK9wTt1E8HAQIhAM8jg1nwjN9+nhPyFo0F+2o8y47mq1kHnCn+gqAdW8MhAiEAt5gQcCqX2Y5KbmMoqtQ+4RIEHQ8HD+fyGqxWUhVpESkCIEtylQJqgvVZCj0bnakqN6Q/lqlrTZg1FGWbZXrqlqThAiEAilt5v94Jc7Ws2AW4Rw0OmfVGzlNd4hnNNVa88r0Z4gkCIGfFy2H8pGxHxg1GKE2mSZAfpRMyjqeq119S3t/bhqY2\";\nstring Encrypt_Me = \"Hello World\";\n</code></pre>\n\n<p>To be honest I don't understand exactly how to use this function for this situation, I tried searching a simple example but couldn't find any.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "sorting", "vector", "constants"], "comments": [{"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 1, "creation_date": 1571315194, "post_id": 58419749, "comment_id": 103205677, "body": "Depending on compiler and OS, <code>const std::vector&lt;int&gt; v = {5,1,3,2,4};</code> could end up in a segment of memory configured as read-only, in which case it can&#39;t modified."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1571673749, "post_id": 58419749, "comment_id": 103310380, "body": "@rcgldr That is true, but the <i>data pointed to</i> is syntactically not part of the vector and has the type given in its declaration, in this case <code>int</code> (not <code>const int</code>). Objects of type <code>int</code> are generally writable though ;-)."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1571680460, "post_id": 58419749, "comment_id": 103313445, "body": "@PeterA.Schneider - The example is using a literal, which is normally an array of constant elements. In the case of Visual Studio 2015, looking at the produced assembly, the array of data ends up in the const segment"}], "answers": [{"comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1571266669, "post_id": 58419750, "comment_id": 103187593, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/200983/discussion-on-answer-by-tanmoy-datta-how-to-sort-a-constant-vector-without-using\">moved to chat</a>."}, {"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1571691807, "post_id": 58419750, "comment_id": 103318038, "body": "If it&#39;s important, please edit the info into the question or answers."}], "tags": [], "owner": {"reputation": 982, "user_id": 3893587, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/xKyiF.jpg?s=128&g=1", "display_name": "Tanmoy Datta", "link": "https://stackoverflow.com/users/3893587/tanmoy-datta"}, "is_accepted": false, "score": -1, "last_activity_date": 1571258371, "last_edit_date": 1571258371, "creation_date": 1571251162, "answer_id": 58419750, "question_id": 58419749, "link": "https://stackoverflow.com/questions/58419749/can-i-legally-write-to-the-data-pointed-to-by-a-constant-vector-e-g-sort-it/58419750#58419750", "title": "Can I legally write to the data pointed to by a constant vector, e.g. sort it?", "body": "<p><strong>I have tested using c++11. In my job, it's working fine for me</strong></p>\n\n<p>You can sort any constant container in c++ using a pointer.</p>\n\n<p>In your case, if you want to sort this vector using <code>sort(v.begin(),v.end())</code> then it will result in some runtime error due to violation of <code>const</code>.</p>\n\n<p>But you can sort your container in following way-</p>\n\n<pre><code>vector&lt;int&gt;*temp=(vector&lt;int&gt;*)&amp;v;\nsort(temp-&gt;begin(),temp-&gt;end());\n</code></pre>\n\n<p>After this, your <strong>constant vector v</strong> will be like this - </p>\n\n<pre><code>const vector&lt;int&gt; v = {1,2,3,4,5}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/v8BpH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/v8BpH.png\" alt=\"View of my working code and output\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 982, "user_id": 3893587, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/xKyiF.jpg?s=128&g=1", "display_name": "Tanmoy Datta", "link": "https://stackoverflow.com/users/3893587/tanmoy-datta"}, "edited": false, "score": 0, "creation_date": 1571257785, "post_id": 58419924, "comment_id": 103184692, "body": "But I have done it using these two lines of code<code>vector&lt;int&gt;*temp=(vector&lt;int&gt;*)&amp;v;</code> <code>sort(temp-&gt;begin(),temp-&gt;end())</code> . Then can you please explain me how is it possible ? I have done it in c++11. Thanks in advance."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "reply_to_user": {"reputation": 982, "user_id": 3893587, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/xKyiF.jpg?s=128&g=1", "display_name": "Tanmoy Datta", "link": "https://stackoverflow.com/users/3893587/tanmoy-datta"}, "edited": false, "score": 0, "creation_date": 1571258208, "post_id": 58419924, "comment_id": 103184867, "body": "@TanmoyDatta Either NathanOliver&#39;s answer is correct or this one is correct and you have Undefined Behaviour (and UB can do everything, starting from seemingly working correct through crashing the application to <a href=\"http://catb.org/jargon/html/N/nasal-demons.html\" rel=\"nofollow noreferrer\">demons flying out of your nose</a>). Even if it is valid, I&#39;d suggest treating it as invalid, to avoid discussions like occurred here when someone will come across your code."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1571258593, "post_id": 58419924, "comment_id": 103185027, "body": "@Yksisarvinen <a href=\"https://stackoverflow.com/questions/58419749/how-to-sort-a-constant-vector-without-using-any-extra-memory/58419750?noredirect=1#comment103182443_58419750\" title=\"how to sort a constant vector without using any extra memory\">stackoverflow.com/questions/58419749/&hellip;</a> (basically I&#39;m cheating but on this topic I&#39;m kinda fine with it)"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 982, "user_id": 3893587, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/xKyiF.jpg?s=128&g=1", "display_name": "Tanmoy Datta", "link": "https://stackoverflow.com/users/3893587/tanmoy-datta"}, "edited": false, "score": 1, "creation_date": 1571258668, "post_id": 58419924, "comment_id": 103185062, "body": "@TanmoyDatta What is possible and appears to work, and what is legal/valid and will always work, are two different things. &quot;It works for me&quot; is <i>never</i> enough proof in C++. However, do see my comment above because I&#39;m cheating a bit here. (If this causes much more confusion I&#39;ll probably delete but let&#39;s see how it goes)"}, {"owner": {"reputation": 982, "user_id": 3893587, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/xKyiF.jpg?s=128&g=1", "display_name": "Tanmoy Datta", "link": "https://stackoverflow.com/users/3893587/tanmoy-datta"}, "edited": false, "score": 0, "creation_date": 1571259057, "post_id": 58419924, "comment_id": 103185227, "body": "I was solving an interview problem in the interviewbit site. For solving that problem I need some way to do this. Then I use this idea and I solved that problem successfully so that I share this idea here. So now may I delete my answer or this question ??"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 982, "user_id": 3893587, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/xKyiF.jpg?s=128&g=1", "display_name": "Tanmoy Datta", "link": "https://stackoverflow.com/users/3893587/tanmoy-datta"}, "edited": false, "score": 0, "creation_date": 1571259096, "post_id": 58419924, "comment_id": 103185246, "body": "@Tanmoy: Why would you delete anything? Don&#39;t delete things."}, {"owner": {"reputation": 982, "user_id": 3893587, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/xKyiF.jpg?s=128&g=1", "display_name": "Tanmoy Datta", "link": "https://stackoverflow.com/users/3893587/tanmoy-datta"}, "edited": false, "score": 0, "creation_date": 1571259282, "post_id": 58419924, "comment_id": 103185325, "body": "@LightnessRacesinOrbit: After seeing those downvotes I thought that I am an idiot, it&#39;s better to delete it. Now I will not delete anything. Thank you for your opinion."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1571660906, "post_id": 58419924, "comment_id": 103303338, "body": "Which of vector&#39;s members -- which, as you correctly state, are declared const -- is changed by sorting its data?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1571668374, "post_id": 58419924, "comment_id": 103307458, "body": "@PeterA.Schneider None of the vector&#39;s direct members is physically changed. Feel free to read all the conversation on this page; we covered the topic well last week."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1571672407, "post_id": 58419924, "comment_id": 103309693, "body": "I had read this page pretty much in its entirety but not the part which moved to chat; I wish you would include the relevant parts of the discussion, including in chat, in this answer in order to give it context (and probably qualify or change its conclusion). The way your answer is standing now everybody (including you) appears to agree that it is technically wrong."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 5, "last_activity_date": 1571251905, "creation_date": 1571251905, "answer_id": 58419924, "question_id": 58419749, "link": "https://stackoverflow.com/questions/58419749/can-i-legally-write-to-the-data-pointed-to-by-a-constant-vector-e-g-sort-it/58419924#58419924", "title": "Can I legally write to the data pointed to by a constant vector, e.g. sort it?", "body": "<p>You can't.</p>\n\n<p>Your vector is immutable. It cannot be changed. There is no [legal] way to re-order its contents.</p>\n\n<p>By extension, if you want a sorted version of its contents, you will need a new vector, which needs more memory.</p>\n"}, {"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571253833, "post_id": 58420228, "comment_id": 103182952, "body": "one bit that keeps me puzzling: is it possible to implement a contrived but conforming <code>std::vector&lt;int&gt;</code> that uses <code>const int*</code> as <code>data</code> and only falls back to <code>int*</code> once you modify elements or the vector itself? If thats the case...hope you get what I am aiming for. Or am I just missing that it is specified to have <code>int*</code> as data?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571253936, "post_id": 58420228, "comment_id": 103182998, "body": "@Fran&#231;oisAndrieux thats why the fallback to <code>int*</code> is need when you modify it. The vector does not know if it is <code>const</code> but it knows when it is modified"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1571253946, "post_id": 58420228, "comment_id": 103183002, "body": "@formerlyknownas_463035818 The data type of <code>cv-qualifer std::vector&lt;T&gt;</code> is <code>T*</code>  The <i>cv-qualification</i> of the vector does not play into the type of the elements inside it."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571254052, "post_id": 58420228, "comment_id": 103183047, "body": "@NathaonOliver in case it is non-const it can still pretend to have <code>T*</code> as value_type when it actually stores <code>const T*</code>, once you modify it could switch back to storing <code>T*</code>. From outside you wouldnt notice other than this hack being ub, unless I miss something"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571254086, "post_id": 58420228, "comment_id": 103183068, "body": "@formerlyknownas_463035818 It sounds like you might be thinking of &quot;copy on write&quot; where an initialized but unmodified vector just has a pointer to some static version of the data. If this is what you mean, time complexity and iterator invalidation rules would likely forbid such a strategy. Edit : In practice, I don&#39;t think it&#39;s possible to use anything but a non-const pointer, though it still sounds like an implementation detail and in theory is up to the implementer (even if only 1 solution is possible)."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571254133, "post_id": 58420228, "comment_id": 103183088, "body": "well anyhow, I think this is going too discussy-in-comments. I&#39;ll have to do some reading to convince myself. Thanks for the references"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571254293, "post_id": 58420228, "comment_id": 103183166, "body": "@formerlyknownas_463035818 I don&#39;t think that would be legal, but you&#39;d have to detail what you are thinking in some code for me to give you a better answer."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571254376, "post_id": 58420228, "comment_id": 103183201, "body": "its getting late here, but I will definitely come back to this at some point. Maybe I can manage to write up a question to clear up my doubts"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571254494, "post_id": 58420228, "comment_id": 103183272, "body": "@formerlyknownas_463035818 Sure.  Just give me a ping.  Some more food for thought: <a href=\"https://timsong-cpp.github.io/cppwp/container.requirements#general-8\" rel=\"nofollow noreferrer\">timsong-cpp.github.io/cppwp/container.requirements#general-8</a>  Basically the storage type is the pointer type returned by the allocator and in this case (since it uses the default allocator) that is <code>T*</code>.  You&#39;d have to check the allocator requirements to see if <code>const T*</code> is allowed."}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1571254552, "post_id": 58420228, "comment_id": 103183300, "body": "I think this is basically the same question, though the answer may be a bit short: <a href=\"https://stackoverflow.com/questions/55977942/modifying-element-of-const-stdvectort-via-const-cast\" title=\"modifying element of const stdvectort via const cast\">stackoverflow.com/questions/55977942/&hellip;</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1571254673, "post_id": 58420228, "comment_id": 103183356, "body": "@uneven_mark It does.  I&#39;m really hesitant to close as a dupe though."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1571259135, "post_id": 58420228, "comment_id": 103185262, "body": "TBH I&#39;d be okay with it."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1571259243, "post_id": 58420228, "comment_id": 103185308, "body": "@LightnessRacesinOrbit If you&#39;re comfortable with it go ahead.  It is two sides of the same coin, it&#39;s just coming from opposite directions so it makes me hesitate."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1571660723, "post_id": 58420228, "comment_id": 103303253, "body": "If you don&#39;t feel comfortable casting away const from the vector you can simply sort <code>temp.data()</code>, right? It should return <code>T*</code>, in this case <code>int*</code> (non-const)."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1571660868, "post_id": 58420228, "comment_id": 103303320, "body": "@PeterA.Schneider <a href=\"https://en.cppreference.com/w/cpp/container/vector/data\" rel=\"nofollow noreferrer\"><code>data()</code></a> is const qualified so <code>v.data()</code> yeilds <code>const T*</code> so you would still need to cast."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1571662104, "post_id": 58420228, "comment_id": 103303953, "body": "@NathanOliver Ah, I see. I didn&#39;t expect that the data pointed to would be declared const but failed to check beforehand."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1571673302, "post_id": 58420228, "comment_id": 103310140, "body": "With respect to the &quot;syntactic&quot; vs. &quot;semantic&quot; constness: There is a limit to what the standard can do for you. If you cast away a &quot;semantic&quot; const (e.g. the result of <code>data()</code> or <code>operator[]()</code>) but expect that logical invariants still hold you just discovered one of the many ways to shoot yourself in the foot. A cast is a sign that you think you know what you are doing ;-)."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 3, "last_activity_date": 1571253170, "creation_date": 1571253170, "answer_id": 58420228, "question_id": 58419749, "link": "https://stackoverflow.com/questions/58419749/can-i-legally-write-to-the-data-pointed-to-by-a-constant-vector-e-g-sort-it/58420228#58420228", "title": "Can I legally write to the data pointed to by a constant vector, e.g. sort it?", "body": "<p>As you have shown in your answer the solution is to cast away const from the vector, ie:</p>\n\n<pre><code>vector&lt;int&gt;&amp;temp = const_cast&lt;vector&lt;int&gt;&amp;&gt;(v);\nsort(temp.begin(), temp.end());\n</code></pre>\n\n<p>This works because you are not changing the state of the vector.  The only thing standard says about undefined behavior and casting away const is in <a href=\"https://timsong-cpp.github.io/cppwp/dcl.type.cv#4\" rel=\"nofollow noreferrer\">[dcl.type.cv]/4</a></p>\n\n<blockquote>\n  <p>Any attempt to modify (<a href=\"https://timsong-cpp.github.io/cppwp/expr.ass\" rel=\"nofollow noreferrer\">[expr.ass]</a>, <a href=\"https://timsong-cpp.github.io/cppwp/expr.post.incr\" rel=\"nofollow noreferrer\">[expr.post.incr]</a>, <a href=\"https://timsong-cpp.github.io/cppwp/expr.pre.incr\" rel=\"nofollow noreferrer\">[expr.pre.incr]</a>) a const object (<a href=\"https://timsong-cpp.github.io/cppwp/basic.type.qualifier\" rel=\"nofollow noreferrer\">[basic.type.qualifier]</a>) during its lifetime (<a href=\"https://timsong-cpp.github.io/cppwp/basic.life\" rel=\"nofollow noreferrer\">[basic.life]</a>) results in undefined behavior. [...]</p>\n</blockquote>\n\n<p>Any nothing in [expr.ass], [expr.post.incr], and [expr.pre.incr] applies to this example so you are not considered to be modifying the object.</p>\n\n<hr>\n\n<p>I do feel this is a defect though.  The order of the elements matter for comparison operators so this <em>modification</em> should apply.</p>\n"}], "owner": {"reputation": 982, "user_id": 3893587, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/xKyiF.jpg?s=128&g=1", "display_name": "Tanmoy Datta", "link": "https://stackoverflow.com/users/3893587/tanmoy-datta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 2, "answer_count": 3, "score": 2, "last_activity_date": 1571673534, "creation_date": 1571251162, "last_edit_date": 1571673534, "question_id": 58419749, "link": "https://stackoverflow.com/questions/58419749/can-i-legally-write-to-the-data-pointed-to-by-a-constant-vector-e-g-sort-it", "title": "Can I legally write to the data pointed to by a constant vector, e.g. sort it?", "body": "<p>I have a constant integer vector <code>const vector&lt;int&gt; v = {5,1,3,2,4}</code> . How can I sort it without using any extra memory like vector, array etc.</p>\n"}, {"tags": ["c++", "opengl", "egl", "nvidia-jetson", "nvidia-jetson-nano"], "comments": [{"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1571251411, "post_id": 58419695, "comment_id": 103181920, "body": "What problem is being solved relative to doing things the normal way?"}, {"owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1571251957, "post_id": 58419695, "comment_id": 103182162, "body": "@NicolBolas What&#39;s the normal way?  The problem I&#39;m solving is updating only N vertices per frame rather than 4*N vertices per frame."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 1, "creation_date": 1571253983, "post_id": 58419695, "comment_id": 103183017, "body": "Yes, the normal way is updating 4*N vertices per frame. And I don&#39;t mean your &quot;x,y, w, h&quot; stuff; I mean standard &quot;position + color&quot; for each vertex. My question was why you feel that this is wrong; what problem are you trying to solve by doing it this way rather than the expected way?"}, {"owner": {"reputation": 2296, "user_id": 8623159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u98OE.jpg?s=128&g=1", "display_name": "Kai Burjack", "link": "https://stackoverflow.com/users/8623159/kai-burjack"}, "edited": false, "score": 0, "creation_date": 1571254552, "post_id": 58419695, "comment_id": 103183299, "body": "Sounds like you are using or want to use instancing. In this case, your first vertex buffer with just the four zero-or-one-vertices is used for a non-instanced vertex attribute and your second vertex buffer is used for instanced vertex attributes (via glVertexAttribDivisor), advancing per instance. For this to work you would need a vertex shader which does <code>gl_Position = pos * widthAndHeight + xAndY</code> where <code>pos</code> is your non-instanced attribute fed by the first vertex buffer and <code>xAndY</code> as well as <code>widthAndHeight</code> are instanced attributes fed by the second vertex buffer."}, {"owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1571256179, "post_id": 58419695, "comment_id": 103183967, "body": "@NicolBolas If I wanted to do dodecahedra instead of rectangles, would it be more relevant?  ...if there were 100+ vertices in the shape that I were drawing in place of the quad?  Would this technique make sense then?  It is just because a quad is so simple that you&#39;re having trouble accepting my motivation for doing this?  It seems obvious to me that it&#39;s better to upload only N vertices per frame rather than N*M vertices per frame.  I just need to know the technique:  how to tell OpenGL how the buffers are set up."}, {"owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "reply_to_user": {"reputation": 2296, "user_id": 8623159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u98OE.jpg?s=128&g=1", "display_name": "Kai Burjack", "link": "https://stackoverflow.com/users/8623159/kai-burjack"}, "edited": false, "score": 0, "creation_date": 1571256325, "post_id": 58419695, "comment_id": 103184032, "body": "@httpdigest that sounds useful.  Do instances actually come from a second buffer?  I was under the impression that instance data gets passed in as an array via a uniform, essentially."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1571256333, "post_id": 58419695, "comment_id": 103184038, "body": "@Wyck: &quot;<i>If I wanted to do dodecahedra instead of rectangles, would it be more relevant? ...if there were 100+ vertices in the shape that I were drawing in place of the quad?</i>&quot; Yes, those would be more relevant because you&#39;d be looking at a performance issue: how to draw a (presumably) large number of mid-side meshes. But even then, it would be contingent on <i>being a performance issue</i>. That is, the answer to the question I&#39;m asking would be &quot;because I&#39;ve profiled the normal code and found it to be slow&quot;."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1571256401, "post_id": 58419695, "comment_id": 103184071, "body": "@Wyck: Because if you don&#39;t know that it&#39;s an actual performance problem, then the solution you employ may well make your code <i>slower</i>."}, {"owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1571256590, "post_id": 58419695, "comment_id": 103184142, "body": "@NicolBolas My problem is that I want to compare technique 1 and technique 2 and I don&#39;t know how to create an implementation of technique 2 to even test against my technique 1 implementation."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1571256696, "post_id": 58419695, "comment_id": 103184185, "body": "@Wyck: The problem is that your &quot;technique 1&quot;, if it&#39;s what you described, is the <i>wrong technique</i>. Comparing your hypothetical &quot;technique 2&quot; to it would be wrong, because you&#39;re not starting from the best version of your current mechanism. That is, technique 2 would only be faster because technique 1 is bad, not because technique 2 is good."}, {"owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1571256902, "post_id": 58419695, "comment_id": 103184276, "body": "@NicolBolas what&#39;s the right technique?"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1571257017, "post_id": 58419695, "comment_id": 103184332, "body": "@Wyck: Exactly what I said: &quot;I don&#39;t mean your &quot;x,y, w, h&quot; stuff; I mean standard &quot;position + color&quot; for each vertex.&quot; Stop trying to send per-instance data as a separate channel; just provide the position and color for the 4 quad vertices."}, {"owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "edited": false, "score": 0, "creation_date": 1571257042, "post_id": 58419695, "comment_id": 103184346, "body": "Why would I ask the CPU to compute per instance data when the GPU can do all that math for me?"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "edited": false, "score": 0, "creation_date": 1571257126, "post_id": 58419695, "comment_id": 103184386, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/200976/discussion-between-nicol-bolas-and-wyck\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": false, "score": 1, "last_activity_date": 1571260970, "creation_date": 1571260970, "answer_id": 58421882, "question_id": 58419695, "link": "https://stackoverflow.com/questions/58419695/how-to-reuse-vertices-across-primitives-in-opengl/58421882#58421882", "title": "How to reuse vertices across primitives in OpenGL", "body": "<p>Generally speaking, the most efficient way to render a series of quads is to... render a series of quads. You don't send width/height or other per-instance information; you compute the actual positions of the 4 vertices on the CPU and you write them to GPU memory using appropriate <a href=\"https://www.khronos.org/opengl/wiki/Buffer_Object_Streaming\" rel=\"nofollow noreferrer\">buffer object streaming techniques</a>. Specifically, avoid trying to change only a few quads; if your data isn't static, it's probably going to be better to re-upload all of it (to a different/invalidated buffer) rather than modify only a few bytes in-situ.</p>\n\n<p>Your hypothetical alternative would only perform better in two scenarios: if the bandwidth of writing data to the GPU is your current bottleneck (whether due to quads or some other transfers you're doing) or if the bandwidth of reading data for rendering is the current bottleneck.</p>\n\n<p>You can mitigate this issue by reducing the size of the vertex data. Since we're talking 2D quads, you could very well use shorts for the XY position of each vertex. Or 16-bit floats. Either way, this means that each vertex (position + color) only takes up 8 bytes, which means a quad is just 32-bytes of data. Obviously 12 bytes is less than 32 (12 being the per-instance cost if you use similar compression), but it's still a 33% reduction over the 48 bytes that full <code>float</code> positions would use.</p>\n\n<hr>\n\n<p>If you have done your profiling homework and have determined that 32-bytes-per-quad is too much, vertex instancing is still a bad idea. It is well known that, on some hardware, <a href=\"https://community.khronos.org/t/gpu-vertex-dispatch-for-multidrawindirect-and-or-instanced-draw-calls/77308\" rel=\"nofollow noreferrer\">extremely small instances can kill your VS performance</a>. Therefore, it should be avoided.</p>\n\n<p>In this case, it may be best to forgo all vertex attribute usage (your VAO should have all arrays disable and your VS should have no <code>in</code> values defined). Instead, you should fetch instance data <a href=\"https://www.khronos.org/opengl/wiki/Shader_Storage_Buffer_Object\" rel=\"nofollow noreferrer\">directly from SSBOs</a>.</p>\n\n<p>The <code>gl_VertexID</code> input value tells you what vertex index is being rendered. Given that you're rendering quads, the current instance would be <code>gl_VertexID / 4</code>. And the current vertex within the quad is <code>gl_VertexID % 4</code>. So your VS would look something like this:</p>\n\n<pre><code>struct instance\n{\n  vec2 position;\n  vec2 size;\n  uint color; //Packed as 4 bytes; unpack with unpackUnorm4x8\n  uint padding; //Padding needed due to alignment/stride of 8 bytes.\n};\n\nlayout(binding = 0, std430) buffer instance_data\n{\n  instance instances[];\n};\n\nvec2[4] vertex_table =\n{\n  vec2{0, 0},\n  vec2{1, 0},\n  vec2{0, 1},\n  vec2{1, 1},\n};\n\nvoid main()\n{\n    instance curr_instance = instances[gl_VertexID / 4];\n    vec2 vertex = vertex_table[gl_VertexID % 4];\n\n    vertex = curr_instance.position + (curr_instance.size * vertex);\n    gl_Position = vec4(vertex.xy, 0.0, 1.0);\n}\n\n</code></pre>\n\n<p>How fast this sort of thing will be depends entirely on how well your GPU handles these kinds of global memory reads. Note that it is at least hypothetically possible to reduce the size of the per-instance data back to 12. You can pack the position and size into two 16-bit shorts or half-floats, using <code>unpackUnorm2x16</code> or <code>unpackHalf2x16</code> to unpack these values, respectively. If you do this, then your <code>instance</code> struct is just 3 <code>uint</code> values, and there is no need for padding.</p>\n"}], "owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1571260970, "creation_date": 1571250924, "question_id": 58419695, "link": "https://stackoverflow.com/questions/58419695/how-to-reuse-vertices-across-primitives-in-opengl", "title": "How to reuse vertices across primitives in OpenGL", "body": "<p>I am using OpenGL in C++ (technically EGL, on a Jetson Nano.)</p>\n\n<p>Let's say I want to draw N Quads.  Imagine just a list of colored rectangles.  There may be a few thousand such rectangles in the frame.</p>\n\n<p>I want to use two vertex buffers:</p>\n\n<ol>\n<li>One that defines the geometry of each quad.</li>\n<li>One that defines the properties common to each quad.</li>\n</ol>\n\n<p>The first vertex buffer should define the geometry of each quad.  It should have only 4 vertices in it and its data would be just the corners of a quad.  Something like:</p>\n\n<pre><code>0, 0, // top left\n1, 0, // top right\n0, 1, // bottom left\n1, 1, // bottom right\n</code></pre>\n\n<p>Then the second vertex buffer should have just the x,y,width,height of all the rectangles.</p>\n\n<pre><code>x1, y1, width1, height1, color1,\nx2, y2, width2, height2, color2,\nx3, y3, width3, height3, color3,\nx4, y4, width4, height4, color4,\nx5, y5, width5, height5, color5,\nx6, y6, width6, height6, color6,\n... etc.\n</code></pre>\n\n<p>The thing is that each one of the items in my rectangle buffer should apply to 4 vertices in the vertex buffer.</p>\n\n<p>Is there a way to set this up so that it keeps reusing the same 4 quad vertices over and over for each rectangle and applies the same rectangle properties to 4 vertices at a time?</p>\n\n<p>I'm imagining there's something I can do so that I say that the first vertex buffer should use one element per vertex and wraps around, but the second vertex buffer uses one element per every four vertices or something like that.</p>\n\n<p>How do I set this up?</p>\n\n<h3>What I do now:</h3>\n\n<p>Right now I need one vertex buffer that just has the quad vertices repeated over and over as many times as I have instances.</p>\n\n<pre><code>0, 0, // (1) top left\n1, 0, // \n0, 1, // \n1, 1  // \n0, 0, // (2) top left\n1, 0, // \n0, 1, // \n1, 1, // \n0, 0, // (3) top left\n1, 0, // \n0, 1, // \n1, 1, // \n... etc\n</code></pre>\n\n<p>And my second buffer duplicates its data for each vertex:</p>\n\n<pre><code>x1, y1, width1, height1, color1,\nx1, y1, width1, height1, color1,\nx1, y1, width1, height1, color1,\nx1, y1, width1, height1, color1,\nx2, y2, width2, height2, color2,\nx2, y2, width2, height2, color2,\nx2, y2, width2, height2, color2,\nx2, y2, width2, height2, color2,\nx3, y3, width3, height3, color3,\nx3, y3, width3, height3, color3,\nx3, y3, width3, height3, color3,\nx3, y3, width3, height3, color3,\nx4, y4, width4, height4, color4,\nx4, y4, width4, height4, color4,\nx4, y4, width4, height4, color4,\nx4, y4, width4, height4, color4,\nx5, y5, width5, height5, color5,\nx5, y5, width5, height5, color5,\nx5, y5, width5, height5, color5,\nx5, y5, width5, height5, color5,\nx6, y6, width6, height6, color6,\nx6, y6, width6, height6, color6,\nx6, y6, width6, height6, color6,\nx6, y6, width6, height6, color6,\n... etc.\n</code></pre>\n\n<p>This seems <em>really</em> inefficient and I just want to specify the first 4 vertices once and have it keep reusing them somehow rather than duplicating these 4 vertices N times to have a total of 4*N vertices in my first buffer.  And I only want to specify the x,y,width,height,color attributes once for each quad for a total of N vertices, and <strong>not</strong> once for each overall vertex for a total of 4*N vertices.</p>\n\n<p>What do I do?</p>\n"}, {"tags": ["c++", "string"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571249463, "post_id": 58419320, "comment_id": 103181037, "body": "are you asking for the type of <code>s</code> or the type of <code>&quot;Hello&quot;</code> ?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1571250278, "post_id": 58419320, "comment_id": 103181385, "body": "To be clear, string literals and <code>std::string</code> are completely different concepts, except that <code>std::string</code> was designed to work with string literals. String literals are not defined by <code>std::string</code> or it&#39;s header."}], "answers": [{"tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": true, "score": 5, "last_activity_date": 1571249679, "creation_date": 1571249679, "answer_id": 58419389, "question_id": 58419320, "link": "https://stackoverflow.com/questions/58419320/are-string-literals-defined-by-c-string-class-are-of-type-const-char/58419389#58419389", "title": "Are string literals defined by c++ string class are of type const char[]", "body": "<p>In</p>\n\n<pre><code>std::string s = \"Hello\";\n</code></pre>\n\n<p>the type of the right-hand side is <code>const char[6]</code>. The five characters (not including the terminating null character) are copied elsewhere by the <code>std::string</code> object's constructor. That is why you are able to modify <code>s</code> later.</p>\n"}, {"tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": false, "score": 1, "last_activity_date": 1571249807, "creation_date": 1571249807, "answer_id": 58419419, "question_id": 58419320, "link": "https://stackoverflow.com/questions/58419320/are-string-literals-defined-by-c-string-class-are-of-type-const-char/58419419#58419419", "title": "Are string literals defined by c++ string class are of type const char[]", "body": "<p>The type of a string literal is <code>const char [N]</code>.</p>\n\n<p>But when you write <code>string s = \"Hello\";</code>, <code>s</code> is not a literal. It's simply an object of type <code>std::string</code>.</p>\n\n<p>The only literal here is <code>\"Hello\"</code>, thus you can't do <code>\"Hello\"[1] = 'a';</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 11154311, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_0nJwYS-qOw/AAAAAAAAAAI/AAAAAAAAEGI/sdcV0wsZvcw/photo.jpg?sz=128", "display_name": "Om Prakash", "link": "https://stackoverflow.com/users/11154311/om-prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 58419389, "answer_count": 2, "score": 0, "last_activity_date": 1571249807, "creation_date": 1571249384, "last_edit_date": 1571249506, "question_id": 58419320, "link": "https://stackoverflow.com/questions/58419320/are-string-literals-defined-by-c-string-class-are-of-type-const-char", "title": "Are string literals defined by c++ string class are of type const char[]", "body": "<p>Are strings defined as\n         <strong>string s=\"Hello\";</strong>\nis of type <strong>const char[]</strong> of size 6?</p>\n\n<p>If it is of type <strong>const char[]</strong> then how am I able to do such thing like\n         <strong>s[0]='i';</strong> ??</p>\n"}, {"tags": ["c++", "timer", "synchronization", "rdtsc", "taskset"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1571249852, "post_id": 58419242, "comment_id": 103181197, "body": "<code>timer_create</code> just gets you a timer. To set it you want <code>timer_settime</code>. <code>timer_settime</code> takes <code>itimerspec</code> structures that specify both the initial start time, what interests you, and the period."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1571249965, "post_id": 58419242, "comment_id": 103181240, "body": "Note: microsecond timing is hard to get outside of a real-time system with a really good clock."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10942507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a9d66d0bd3296d11430b8c34163af7?s=128&d=identicon&r=PG&f=1", "display_name": "delfunc", "link": "https://stackoverflow.com/users/10942507/delfunc"}, "is_accepted": false, "score": 0, "last_activity_date": 1571249885, "creation_date": 1571249885, "answer_id": 58419439, "question_id": 58419242, "link": "https://stackoverflow.com/questions/58419242/making-a-timer-go-off-at-a-specific-time-in-a-c-process-for-purposes-of-synchr/58419439#58419439", "title": "Making a timer go off at a specific time in a C++ process for purposes of synchronizing two processes", "body": "<p>best ways are going to be very system and os dependent. \nThe best somewhat generic way I can think of is to block both tasks on a counting semaphore, and use a third task to wait on a timer and trigger the semaphore at the desired rate.  the degree of precision you want will be difficult if not using a rtos.</p>\n"}], "owner": {"reputation": 707, "user_id": 7868376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4d92cc168903249d34560da543ef621f?s=128&d=identicon&r=PG&f=1", "display_name": "picotard", "link": "https://stackoverflow.com/users/7868376/picotard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571249885, "creation_date": 1571249104, "question_id": 58419242, "link": "https://stackoverflow.com/questions/58419242/making-a-timer-go-off-at-a-specific-time-in-a-c-process-for-purposes-of-synchr", "title": "Making a timer go off at a specific time in a C++ process for purposes of synchronizing two processes", "body": "<p>I have two processes in C++ (these are not parent and child processes). Each has been pinned to a specific core using <code>taskset</code>. So, for instance, process 1 is pinned to core 0 and process 2 is pinned to core 1. I want to start running them at the same exact time (with microsecond accuracy). </p>\n\n<p><code>timer_create</code> allows some code to execute with a specified frequency. However, it doesn't provide a mechanism for it to start at a specific time. What would be the best way to configure a start time such that a section of code in both processes starts off at that particular time, and then repeats with a certain frequency?</p>\n"}, {"tags": ["c++"], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571250970, "post_id": 58419202, "comment_id": 103181713, "body": "i dont understand how you arrive to the &quot;you cant&quot; conclusion, but that aside, &quot; the same inputs cannot have two different outputs&quot; is only true for pure functions (maybe not the right term, I am not too familiar with functional stuff), but in general a function can return different result for the same input without any problem. Consider <code>int foo(int y) { static int x = 0; return x+=y; }</code>. There is no such rule"}, {"owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571251077, "post_id": 58419202, "comment_id": 103181773, "body": "<code>x</code> and <code>y</code> can both be considered inputs in that case."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571251140, "post_id": 58419202, "comment_id": 103181806, "body": "no they cant. <code>x</code> is not visible from outside. Anyhow using a <code>static</code> variable is only one way to demonstrate it. How about <code>rand()</code> ? There are many more examples"}, {"owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571251450, "post_id": 58419202, "comment_id": 103181946, "body": "rand() uses a mathematical function to generate a sequence of numbers, and will generate the same numbers in sequence when given the same seed. Just because your two examples don&#39;t have explicit argument inputs doesn&#39;t mean they &quot;break&quot; this rule."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571251869, "post_id": 58419202, "comment_id": 103182125, "body": "I dont understand what you are arguing for. There is no such rule in general unless you refer to how a pure function is supposed to work. If I am wrong I would like to see a reference, so I can rectify my wrong understanding"}, {"owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571252403, "post_id": 58419202, "comment_id": 103182327, "body": "I&#39;m not arguing; I&#39;m telling you that all computer systems today are <a href=\"https://en.wikipedia.org/wiki/Deterministic_system\" rel=\"nofollow noreferrer\">deterministic</a>, it&#39;s literally a fundamental property of computers. If you provide any computer program with the same environment and exact set of inputs, you will receive a consistent output each and every time. Hopefully this will help you rectify your understanding"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571254275, "post_id": 58419202, "comment_id": 103183155, "body": "possibly you are not aware of this: <a href=\"https://en.wikipedia.org/wiki/Hardware_random_number_generator\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Hardware_random_number_generator</a>"}, {"owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571254555, "post_id": 58419202, "comment_id": 103183302, "body": "I am absolutely aware of that. Those rely on natural stochastic processes and have nothing to do with computers being deterministic models. Now who&#39;s being argumentative? Is OP using a hardware RNG to choose his outputs or are you just trying to feel correct at this point?"}], "tags": [], "owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "is_accepted": false, "score": 0, "last_activity_date": 1571248926, "creation_date": 1571248926, "answer_id": 58419202, "question_id": 58419087, "link": "https://stackoverflow.com/questions/58419087/how-to-simplify-the-code-and-combine-switch-into-one-function/58419202#58419202", "title": "How to simplify the code and combine switch into one function?", "body": "<p>Simply put, you can't.</p>\n\n<p>Imagine all your outputs are <code>a, b, c, d, e, f</code>. Each of your outputs requires a unique combination of inputs to result in one of the outputs. For example</p>\n\n<pre><code>0,0: a\n0,1: b\n1,0: c\n1,1: d\n2,0: e\n2,1: f\n</code></pre>\n\n<p>Because all of your outputs are unique, the paths taken to them must also be unique. A fundamental thing with function logic is that the same inputs cannot have two different outputs. Here, you cannot have any reduction in combinations of inputs, because each of your outputs are unique, and thus having a shorter list of inputs would violate that rule.</p>\n\n<p>This isn't barring something like a key-value map to reduce your code, but you won't be able to reduce the number of combinations needed to retrieve those values.</p>\n"}, {"tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 3, "last_activity_date": 1571249058, "creation_date": 1571249058, "answer_id": 58419231, "question_id": 58419087, "link": "https://stackoverflow.com/questions/58419087/how-to-simplify-the-code-and-combine-switch-into-one-function/58419231#58419231", "title": "How to simplify the code and combine switch into one function?", "body": "<p>There are many ways to simplify this. My goto solution often is <code>std::map</code>. It often isn't the most efficient container to choose, but it is extremely useful and performance is for later, when I know that I need to do something about it. </p>\n\n<p>I dont fully understand what your code is supposed to do (also because some important details are missing), but I think you can use something like:</p>\n\n<pre><code>#include &lt;map&gt;\n#include &lt;utility&gt;\n#include &lt;iostream&gt;\n\nvoid foo(std::pair&lt;int,int&gt; x) {\n    static std::map&lt;std::pair&lt;int,int&gt;,int&gt; lookup_table{ \n        { { 1,1 }, 1},\n        { { 2,3 }, 42}\n    };\n    std::cout &lt;&lt; lookup_table[x] &lt;&lt; '\\n';\n    // or \n    auto it = lookup_table.find(x);\n    if (it != lookup_table.end()) {\n        std::cout &lt;&lt; it-&gt;second &lt;&lt; '\\n';\n    }\n}\n\n\nint main(){\n    foo( {1,1} );\n}\n</code></pre>\n\n<p>The first variant, using <code>operator[]</code> will create an element in the map when the key cannot be found. I don't think this is what you want, so I included the variant using <code>find</code> that lets you check if an element for the given key exists in the map (and would also allow you to declare the <code>lookup_table</code> as <code>const</code>).</p>\n\n<p>Last but not least, note that the above is far from being optimal. In the next step I would maybe consider to use an array and try to avoid the function local <code>static</code>. Nevertheless thats what would be my first approach.</p>\n"}, {"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": true, "score": 6, "last_activity_date": 1571249110, "creation_date": 1571249110, "answer_id": 58419243, "question_id": 58419087, "link": "https://stackoverflow.com/questions/58419087/how-to-simplify-the-code-and-combine-switch-into-one-function/58419243#58419243", "title": "How to simplify the code and combine switch into one function?", "body": "<p>Encode the function as a table. </p>\n\n<pre><code>const int table[3][2] = {{13,15}, {3,1}, {156,67}};\nint y = table[first_number][second_number];\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11209230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e06896f2c6f02172498b0bc786d5e313?s=128&d=identicon&r=PG&f=1", "display_name": "chip", "link": "https://stackoverflow.com/users/11209230/chip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 58419243, "answer_count": 3, "score": 1, "last_activity_date": 1571249110, "creation_date": 1571248415, "question_id": 58419087, "link": "https://stackoverflow.com/questions/58419087/how-to-simplify-the-code-and-combine-switch-into-one-function", "title": "How to simplify the code and combine switch into one function?", "body": "<p>I have the task of getting the number of the variable <code>y</code> depending on which number worked in <code>first_number</code> and <code>second_number</code></p>\n\n<p>My version is working, but I have to constantly repeat the <code>switch</code>, in the end I have a lot of code, I'm very uncomfortable.</p>\n\n<p>The problem is that the variable is different everywhere and I don\u2019t know how to create a function where I can specify a number for each <code>case</code> block</p>\n\n<pre><code>switch (first_number)\n{\n    case 0:\n    {\n        switch (second_number)\n        {\n            case 0:\n            {\n                y = 13;\n                cout &lt;&lt; y &lt;&lt; endl;\n            }\n            break;\n\n            case 1:\n            {\n                y = 15;\n                cout &lt;&lt; y &lt;&lt; endl;\n            }\n            break;\n        }\n    }\n    break;\n\n    case 1:\n    {\n        switch (second_number)\n        {\n            case 0:\n            {\n                y = 3;\n                cout &lt;&lt; y &lt;&lt; endl;\n            }\n            break;\n\n            case 1:\n            {\n                y = 1;\n                cout &lt;&lt; y &lt;&lt; endl;\n            }\n            break;\n        }\n    }\n    break;\n\n    case 2:\n    {\n        switch (second_number)\n        {\n            case 0:\n            {\n                y = 156;\n                cout &lt;&lt; y &lt;&lt; endl;\n            }\n            break;\n\n            case 1:\n            {\n                y = 67;\n                cout &lt;&lt; y &lt;&lt; endl;\n            }\n            break;\n        }\n    }\n    break;\n}\n</code></pre>\n"}, {"tags": ["c++", "console-application"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1571247490, "post_id": 58418865, "comment_id": 103180195, "body": "This whitespace is not generated by your code. This is a property of your console."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1571247756, "post_id": 58418865, "comment_id": 103180302, "body": "Note: if you are using Visual Studio, you can run the program with CTRL+F5. Then you won&#39;t need <code>system(&quot;pause&quot;);</code>"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1571248509, "post_id": 58418865, "comment_id": 103180634, "body": "Don&#39;t know if this will help, but try changing <code>endl</code> to <code>&#39;\\n&#39;</code>. You don&#39;t need to flush the output."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7363057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ac5bb255862fa774d3e907606a645b?s=128&d=identicon&r=PG&f=1", "display_name": "Open Source", "link": "https://stackoverflow.com/users/7363057/open-source"}, "edited": false, "score": 1, "creation_date": 1571261413, "post_id": 58418933, "comment_id": 103186117, "body": "Got that working with the .bat file now, thanks again Nick!"}], "tags": [], "owner": {"reputation": 4859, "user_id": 7431860, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/P6Jko.jpg?s=128&g=1", "display_name": "Nick Reed", "link": "https://stackoverflow.com/users/7431860/nick-reed"}, "is_accepted": true, "score": 4, "last_activity_date": 1571258777, "last_edit_date": 1571258777, "creation_date": 1571247742, "answer_id": 58418933, "question_id": 58418865, "link": "https://stackoverflow.com/questions/58418865/remove-default-console-white-spaces/58418933#58418933", "title": "Remove default console white spaces", "body": "<h3>No, this can't be removed.</h3>\n\n<p>This isn't your code's doing - it's how the Windows console works. Those empty lines are rows of the screen buffer that havent'e been filled with text yet. Running this on <code>bash</code> or other consoles like this won't show the whitespace - same thing if you pipe the output to a file.</p>\n\n<h3>However:</h3>\n\n<p>You can reduce the amount of whitespace if you want - it's a setting in the console properties. <a href=\"https://superuser.com/a/1008648/1093046\">This answer</a> explains how to do so, and <a href=\"https://superuser.com/a/1008823/1093046\">this one</a> lets you do it through the prompt or a batch file.</p>\n"}], "owner": {"reputation": 15, "user_id": 7363057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ac5bb255862fa774d3e907606a645b?s=128&d=identicon&r=PG&f=1", "display_name": "Open Source", "link": "https://stackoverflow.com/users/7363057/open-source"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 58418933, "answer_count": 1, "score": 1, "last_activity_date": 1571258777, "creation_date": 1571247453, "last_edit_date": 1571254217, "question_id": 58418865, "link": "https://stackoverflow.com/questions/58418865/remove-default-console-white-spaces", "title": "Remove default console white spaces", "body": "<p>I'm working on a small console based application with Visual Studio, and I want to ask if it's possible to get rid of the thousands of white spaces that the console produces on execution by default.</p>\n\n<p>If I run the below code: </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main() {\n    cout &lt;&lt; \"Hello World!\" &lt;&lt; endl;\n    system(\"pause\");\n}\n</code></pre>\n\n<p>The console produces a load of white spaces underneath <code>\"Hello World\"</code>, so much that you can scroll down through it all. I want to be able to clear all of it so the scroll down option isn't even available. </p>\n\n<p>I've added some images in case you're unsure of what I mean. </p>\n\n<p><a href=\"https://i.stack.imgur.com/VnpoP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VnpoP.png\" alt=\"Example 1\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/vBS3C.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vBS3C.png\" alt=\"Example 2\"></a></p>\n\n<p>Is there a way around this?</p>\n"}, {"tags": ["c++", "visual-studio", "c++11", "visual-studio-2019", "precompiled-headers"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 3, "creation_date": 1571247297, "post_id": 58418775, "comment_id": 103180106, "body": "I just put third party libraries and system headers there and avoid my own code unless I know its a header that I will not likely have to edit in the future."}, {"owner": {"reputation": 973, "user_id": 6540193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592f74822b1858f77a3c2fb5c4955b7c?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra K", "link": "https://stackoverflow.com/users/6540193/sandra-k"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1571247671, "post_id": 58418775, "comment_id": 103180272, "body": "@drescherjm So what is the problem with adding the headers that get changed often?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1571247736, "post_id": 58418775, "comment_id": 103180296, "body": "You end up making your builds take longer instead of shorter because the precompiled header needs to be regenerated after the change. It also forces more files to rebuild."}, {"owner": {"reputation": 973, "user_id": 6540193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592f74822b1858f77a3c2fb5c4955b7c?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra K", "link": "https://stackoverflow.com/users/6540193/sandra-k"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1571248026, "post_id": 58418775, "comment_id": 103180415, "body": "@drescherjm So I am doing it wrong by counting most included files..."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1571248203, "post_id": 58418775, "comment_id": 103180493, "body": "You want the headers that are not going to change (or are going to change the least).  Any changes to the headers included in the pre-compiled header file will cause  all the .cpp files that include the pre-compiled header file to be recompiled.  So system headers; external libraries; your stable libraries are all good candidates."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1571248232, "post_id": 58418775, "comment_id": 103180508, "body": "My project sped up its compile time by 10% by getting rid of precompiled headers.  Make sure you carefully measure."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1571248618, "post_id": 58418775, "comment_id": 103180686, "body": "Trust no one. If it&#39;s important, profile."}, {"owner": {"reputation": 973, "user_id": 6540193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592f74822b1858f77a3c2fb5c4955b7c?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra K", "link": "https://stackoverflow.com/users/6540193/sandra-k"}, "edited": false, "score": 0, "creation_date": 1571249516, "post_id": 58418775, "comment_id": 103181053, "body": "I see. Ok thank you!"}], "owner": {"reputation": 973, "user_id": 6540193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592f74822b1858f77a3c2fb5c4955b7c?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra K", "link": "https://stackoverflow.com/users/6540193/sandra-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571249870, "creation_date": 1571247066, "last_edit_date": 1571249870, "question_id": 58418775, "link": "https://stackoverflow.com/questions/58418775/how-to-know-the-files-that-are-the-most-included-in-a-project", "title": "How to know the files that are the most included in a project?", "body": "<p>I am trying to fasten the build by using precompiled headers. I wonder what is the easiest/fastest way to know which files I should include in my \"stdafx.h\" so that they only build once? </p>\n\n<p>Right now, I iterate over every file, and collect the #include section into one container for all files. Then, I manually count which file is included and how many times, finally I pick the relatively highest counted files and put them in \"stdafx.h\". </p>\n\n<p>It works, but this is time consuming and I have many projects. Please and thank you.</p>\n"}, {"tags": ["c++", "char"], "comments": [{"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 2, "creation_date": 1571245380, "post_id": 58418300, "comment_id": 103179242, "body": "<code>name1</code> has not been allocated.  The <code>cin&gt;&gt;name1</code> is sending data to the giggleweeds."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 1, "creation_date": 1571245621, "post_id": 58418300, "comment_id": 103179361, "body": "Side issue: Your class declaration usually shouldn&#39;t be inside a function definition. I don&#39;t know of a reason off the top of my head why C++ wouldn&#39;t allow this, but even if it did, it&#39;s at the very least not a good practice."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1571247486, "post_id": 58418300, "comment_id": 103180192, "body": "I&#39;m with @Chipster . I can think of a few cases where defining a class in a function is a good idea, but this is not one of them. Hibou, this class is now only visible inside <code>main</code>. This makes it harder to construct the program with simple function building blocks as all functionality that requires <code>student</code> is now forced to be implemented in <code>main</code>. This will lead to problems debugging (and with maintenance in production code)."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "reply_to_user": {"reputation": 159, "user_id": 12189862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saRhp.png?s=128&g=1", "display_name": "Hibou", "link": "https://stackoverflow.com/users/12189862/hibou"}, "edited": false, "score": 0, "creation_date": 1571259817, "post_id": 58418384, "comment_id": 103185542, "body": "@Hibou You&#39;re welcome. If this solved your problem, you can accept this answer by clicking the check mark next to it. Or, you can accept another answer if it was better."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "is_accepted": true, "score": 7, "last_activity_date": 1571259685, "last_edit_date": 1571259685, "creation_date": 1571245477, "answer_id": 58418384, "question_id": 58418300, "link": "https://stackoverflow.com/questions/58418300/the-execution-of-the-program-ends-after-the-input-of-the-char-variable-in-c/58418384#58418384", "title": "The execution of the program ends after the input of the char variable in C++", "body": "<p>You need to allocate <code>name</code> (or <code>name1</code> as it may be).</p>\n\n<p>There are a lot of ways to do this, but the best way is either a) use an <code>std::string</code>:</p>\n\n<pre><code>\nstd::string name;\n</code></pre>\n\n<p>or b) turn name into an array:</p>\n\n<pre><code>char name[BUFFER_SIZE]; // BUFFER_SIZE is some constant\n</code></pre>\n\n<p><strong>Note</strong>: b) might require some special logic to make sure you don't go past <code>BUFFER_SIZE</code>, but I'll leave that up to you to figure out.</p>\n"}, {"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1571247050, "post_id": 58418433, "comment_id": 103180001, "body": "There is no need for unmanaged dynamic allocation here. A <code>std::string</code> or an automatically allocated array  should be used."}, {"owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1571247195, "post_id": 58418433, "comment_id": 103180065, "body": "It&#39;s more beneficial in this case for the asker to see why their solution doesn&#39;t work than to be given an easy solution. I&#39;ll add a note to use std::string for best practice."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1571247324, "post_id": 58418433, "comment_id": 103180120, "body": "This goes a bit beyond ease. You&#39;re making this needlessly hard by dumping an unnecessary memory management burden on the asker."}, {"owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1571247423, "post_id": 58418433, "comment_id": 103180166, "body": "Memory management is a fundamental c++ concept/practice. I&#39;m not disagreeing that <code>std::string</code> should be used, just that there&#39;s nothing to be learned by telling them to use a <code>string</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1571247713, "post_id": 58418433, "comment_id": 103180284, "body": "The art of memory management includes knowing when and where to dynamically allocate. The problem solved by your example can be resolved with a simple automatically allocated array since the size is known at compile time. There is no need for <code>new</code>."}, {"owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1571247804, "post_id": 58418433, "comment_id": 103180317, "body": "Again, not disagreeing."}, {"owner": {"reputation": 159, "user_id": 12189862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saRhp.png?s=128&g=1", "display_name": "Hibou", "link": "https://stackoverflow.com/users/12189862/hibou"}, "edited": false, "score": 1, "creation_date": 1571256078, "post_id": 58418433, "comment_id": 103183915, "body": "Thank you, it was very helpful :)"}], "tags": [], "owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "is_accepted": false, "score": 1, "last_activity_date": 1571247321, "last_edit_date": 1571247321, "creation_date": 1571245667, "answer_id": 58418433, "question_id": 58418300, "link": "https://stackoverflow.com/questions/58418300/the-execution-of-the-program-ends-after-the-input-of-the-char-variable-in-c/58418433#58418433", "title": "The execution of the program ends after the input of the char variable in C++", "body": "<p>In this part of your code:</p>\n\n<pre><code>char *name1;\nstd::cout&lt;&lt;\"Enter the student's name &gt; \";\nstd::cin&gt;&gt;name1;\n</code></pre>\n\n<p><code>name1</code> is simply a variable that can store an address to a <code>char</code> type. If you want to give data to this variable, try allocating some memory to <code>name1</code> with this:</p>\n\n<pre><code>char *name1 = new char[50];\n</code></pre>\n\n<p>Now, <code>name1</code> has a chunk of continuous memory where you can put up to 50 <code>char</code> values. <code>new</code> will allocate that space, and then give <code>name1</code> the address to where that space exists.</p>\n\n<p>Your program is crashing because of undefined behavior when you try to assign data to an undefined address.</p>\n\n<p>EDIT: As someone else noted, <code>std::string</code> should be used with <code>std::cin</code>, in place of the C-string <code>char*</code>, since it does not require memory allocation and is a much safer method. The memory in a <code>string</code> is automatically allocated and managed for you, freeing you of the responsibility to create and delete space for a <code>char</code> array.</p>\n"}], "owner": {"reputation": 159, "user_id": 12189862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saRhp.png?s=128&g=1", "display_name": "Hibou", "link": "https://stackoverflow.com/users/12189862/hibou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 58418384, "answer_count": 2, "score": 1, "last_activity_date": 1571259685, "creation_date": 1571245173, "question_id": 58418300, "link": "https://stackoverflow.com/questions/58418300/the-execution-of-the-program-ends-after-the-input-of-the-char-variable-in-c", "title": "The execution of the program ends after the input of the char variable in C++", "body": "<p>I wrote a program that requests the name of a student and his marks. Everything compiles smoothly but after the execution, the program asks just for the name and than it stops. </p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main(){\n    class student{\n        public :\n        char *name;\n        int marks1; int marks2;\n\n        student(char* n, int n1, int n2){\n            name=n, marks1=n1, marks2=n2;\n        }\n\n        int calc_med(){return (marks1+marks2)/2;}\n\n        void display(){\n            std::cout&lt;&lt;name&lt;&lt;\"\\n The mediane is &gt;&gt; \"&lt;&lt;calc_med()&lt;&lt;\"\\n\";\n        }\n    };\n\n    char *name1;\n    std::cout&lt;&lt;\"Enter the student's name &gt; \";\n    std::cin&gt;&gt;name1;\n    int m1;\n    std::cout&lt;&lt;\"Enter the first mark &gt; \";\n    std::cin&gt;&gt;m1;   \n    int m2;\n    std::cout&lt;&lt;\"Enter the second mark &gt; \";\n    std::cin&gt;&gt;m2;\n\n\n    student student1(name1,m1,m2);\n    student1.display();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "numpy", "xtensor"], "answers": [{"tags": [], "owner": {"reputation": 4097, "user_id": 2646505, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/XGEyF.jpg?s=128&g=1", "display_name": "Tom de Geus", "link": "https://stackoverflow.com/users/2646505/tom-de-geus"}, "is_accepted": true, "score": 2, "last_activity_date": 1571642532, "creation_date": 1571642532, "answer_id": 58481532, "question_id": 58418220, "link": "https://stackoverflow.com/questions/58418220/having-trouble-using-xtwhere-in-xtensor/58481532#58481532", "title": "Having trouble using xt::where in xtensor", "body": "<p>You'll have to use <code>xt::equal(a, b)</code> instead of <code>a == b</code>. Indeed this is different from for example <code>a &gt; b</code> which is completely the same as <code>xt::greater(a, b)</code>.</p>\n\n<p>Note also that the list of indices can be converted to a matrix using <code>xt::from_indices(...)</code>, see <a href=\"https://xtensor.readthedocs.io/en/latest/indices.html\" rel=\"nofollow noreferrer\">documentation</a>. Consider the following example:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;xtensor/xtensor.hpp&gt;\n#include &lt;xtensor/xio.hpp&gt;\n\nint main()\n{\n    xt::xtensor&lt;size_t,2&gt; a = xt::arange(5 * 5).reshape({5, 5});\n    size_t i = 4;\n    xt::xtensor&lt;size_t,2&gt; idx = xt::from_indices(xt::where(xt::equal(a, i)));\n    std::cout &lt;&lt; idx &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 6363528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NKawE.jpg?s=128&g=1", "display_name": "roshoka", "link": "https://stackoverflow.com/users/6363528/roshoka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 58481532, "answer_count": 1, "score": 2, "last_activity_date": 1571642532, "creation_date": 1571244837, "last_edit_date": 1571247024, "question_id": 58418220, "link": "https://stackoverflow.com/questions/58418220/having-trouble-using-xtwhere-in-xtensor", "title": "Having trouble using xt::where in xtensor", "body": "<p>I am trying to find an index value of certain array values in an xarray. I have an xarray called <code>lattice</code> filled that contains numbers 1 through n and what I would like is something like</p>\n\n<pre><code>auto x2 = xt::where(lattice == i)\n</code></pre>\n\n<p>to get the index values of element <code>i</code> in <code>lattice</code> that will be used for a distance function, but I get the message that <code>==</code> doesn't match the operands. The problem doesn't happen when I use <code>&gt;</code> so I'm just wondering what the difference is. </p>\n\n<p>I've used <code>np.where(lattice==i)</code> in python and I'm trying to translate it over. </p>\n"}, {"tags": ["c++", "arrays", "pointers", "visual-c++"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 1, "creation_date": 1571244909, "post_id": 58418203, "comment_id": 103179033, "body": "You define the function as returning <code>void</code>. Change that to the correct type and it will return it"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1571245773, "post_id": 58418203, "comment_id": 103179425, "body": "You could place the array inside a <code>struct</code> and return the <code>struct</code>.  This may be easier than figuring out the return type syntax for a 2d array.  (Or maybe better, use <code>std::vector</code> or <code>std::array</code>)."}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 2, "creation_date": 1571245861, "post_id": 58418203, "comment_id": 103179472, "body": "<code>tilesMap</code> is a global var, you don&#39;t need to return it from the function."}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1571246002, "post_id": 58418203, "comment_id": 103179533, "body": "To return an array of strings say it so in the definition of the function. Something like <code>std::string array[15][15] mapTiles()....</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1571246813, "post_id": 58418203, "comment_id": 103179888, "body": "Side note: Returning arrays is... hard. Arrays are always pass by reference (see <a href=\"https://stackoverflow.com/questions/1461432/what-is-array-decaying\">What is array decaying?</a>) and when the function returns the array goes out of scope making that reference useless. What it referred to is gone. Instead use a <a href=\"https://en.cppreference.com/w/cpp/container\" rel=\"nofollow noreferrer\">Standard Library Container</a> as they allow value semantics. In this case you know the exact size of the array, so <code>std::array</code> looks like a good candidate."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1571246906, "post_id": 58418203, "comment_id": 103179933, "body": "<a href=\"https://stackoverflow.com/questions/27410943/returning-arrays-from-a-function-in-c/27411483#27411483\">Usage of returning an array wrapped by a struct</a>."}, {"owner": {"reputation": 394, "user_id": 2023321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1iHEw.jpg?s=128&g=1", "display_name": "Eduardo Fernandes", "link": "https://stackoverflow.com/users/2023321/eduardo-fernandes"}, "edited": false, "score": 0, "creation_date": 1571249985, "post_id": 58418203, "comment_id": 103181251, "body": "I recommend you to use a vector of vector of string instead of array. Something like this: <code>std::vector&lt;std::vector&lt;std::string&gt;&gt; test() {         std::vector&lt;std::vector&lt;std::string&gt;&gt; myString;          myString.push_back(std::vector&lt;std::string&gt;());         myString[0].push_back(std::string(&quot;Works&quot;));          return myString; }</code>"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1571257126, "post_id": 58418203, "comment_id": 103184387, "body": "If the OP just needs a 15 x 15 string array and needs to pass it around, can&#39;t use <code>std::array</code> or any STL containers, and pointers are a nightmare to him/her, the next best thing is to wrap it in a struct, IMO."}], "owner": {"reputation": 11, "user_id": 12227884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20aa1e9b1b366c11b2356b3da321af9a?s=128&d=identicon&r=PG&f=1", "display_name": "Drix", "link": "https://stackoverflow.com/users/12227884/drix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "closed_date": 1571247916, "answer_count": 0, "score": 1, "last_activity_date": 1571358058, "creation_date": 1571244761, "last_edit_date": 1571358058, "question_id": 58418203, "link": "https://stackoverflow.com/questions/58418203/how-can-i-return-my-2d-array-and-use-it-in-other-functions", "closed_reason": "Duplicate", "title": "How can I return my 2D array and use it in other functions?", "body": "<p>I'm trying to create a game of scrabble and I need to create a board. I created the class Board which has mapTiles() as one of it's functions, it's responsible for creating the base of the board, inserting in the correct tiles the word / letter multipliers. I want this function to return the 2d array so that I'm able to use it in other functions.\nFor ex. on another function I want to do:  </p>\n\n<pre><code>Board myBoard;\nstd::string array[15][15];\narray = myBoard.array;\n</code></pre>\n\n<p>I tried using maps, pointers, vectors and 2d arrays, is there another more efficient way of doing this? </p>\n\n<pre><code>std::string tilesMap[15][15];\n\nstd::string mapTiles() {\n    for (int cY = 0; cY &lt; 15; cY++) {\n        for (int cX = 0; cX &lt; 15; cX++) {\n            int cXY = cX + cY;\n            double res = pow(cX, 2) + pow(cY, 2);\n            tilesMap[cX][cY] = blank;\n\n            if (cX == cY || cXY == 14) { // Sets the diagonals of the board with bonuses\n                if (cX == 0 || cX == 14) { // 3 x Word\n                    tilesMap[cX][cY] = x3W;\n                }\n\n                else if (cX == 5 || cX == 9) { // 3 x Letter\n                    tilesMap[cX][cY] = x3L;\n                }\n\n                else if (cX == 6 || cX == 8) { // 2 x Letter\n                    tilesMap[cX][cY] = x2L;\n                }\n\n                else {\n                    tilesMap[cX][cY] = x2W; // 2 x Word\n                }\n            }\n\n            else if (cXY % 7 == 0) {    // 3 x Word\n                if (cY == 0 || cY == 7 || cY == 14) {\n                    tilesMap[cX][cY] = x3W;\n                }\n            }\n\n            else if (res == 26 || res == 82 || res == 194 || res == 250) { // 3 x Letter\n                if (cY == 1 || cY == 5 || cY == 9 || cY == 13) {\n                    tilesMap[cX][cY] = x3L;\n                }\n            }\n\n            else if (res == 9 || res == 121 || res == 205 || res == 317) { // 2 x Letter outer ring\n                if (cY == 0 || cY == 3 || cY == 11 || cY == 14) {\n                    tilesMap[cX][cY] = x2L;\n                }\n            }\n\n            else if (res == 40 || res == 68 || res == 180 || res == 208) { // 2 x Letter 2nd ring\n\n                if (cY == 2 || cY == 6 || cY == 8 || cY == 12) {\n                    tilesMap[cX][cY] = x2L;\n                }\n\n            }\n\n            else if (res == 58 || res == 170) { // 2 x Letter 3rd ring\n                if ((cY == 3) || (cY == 7) | (cY == 11)) {\n                    tilesMap[cX][cY] = x2L;\n                }\n            }\n        }\n    }\n    return tilesMap;\n}\n</code></pre>\n\n<p>The error I'm getting is the following:\nError (active)  E0415   no suitable constructor exists to convert from \"std::string [15][15]\" to \"std::basic_string, std::allocator></p>\n"}, {"tags": ["c++", "events", "keyboard", "sfml", "shapes"], "comments": [{"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 1, "creation_date": 1571245052, "post_id": 58418179, "comment_id": 103179090, "body": "Most of that code should be moved to the <code>while (window.pollEvent(event))</code> loop, so it&#39;s executed only when the window receives an event."}, {"owner": {"reputation": 75, "user_id": 11947589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8pfNl.jpg?s=128&g=1", "display_name": "Gian Marco Cialdi", "link": "https://stackoverflow.com/users/11947589/gian-marco-cialdi"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1571245573, "post_id": 58418179, "comment_id": 103179338, "body": "Doesn&#39;t work either"}, {"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 1, "creation_date": 1571246690, "post_id": 58418179, "comment_id": 103179824, "body": "intialize <code>ang</code> to 0. Move <code>transform.rotate(ang, WIDTH &#47; 2, HEIGHT &#47; 2);</code> to just after <code>ang += 1;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1835, "user_id": 3195314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiMED.png?s=128&g=1", "display_name": "alseether", "link": "https://stackoverflow.com/users/3195314/alseether"}, "edited": false, "score": 2, "creation_date": 1571647910, "post_id": 58418691, "comment_id": 103297008, "body": "Just to clarify a bit, <a href=\"https://www.sfml-dev.org/documentation/2.5.1/classsf_1_1Transformable.php#af8a5ffddc0d93f238fee3bf8efe1ebda\" rel=\"nofollow noreferrer\"><code>sf::Transformable::rotate()</code></a> adds the angle to the current rotation of the object. If the idea is to rotate the shape a certain angle each time a keyboard key is pressed, you shouldn&#39;t increase <code>ang</code>. If you do so, the angle will increase more and more each time the key is pressed, wich cause the shape to rotate faster and faster."}, {"owner": {"reputation": 1835, "user_id": 3195314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiMED.png?s=128&g=1", "display_name": "alseether", "link": "https://stackoverflow.com/users/3195314/alseether"}, "edited": false, "score": 2, "creation_date": 1571648299, "post_id": 58418691, "comment_id": 103297185, "body": "I mean, <a href=\"https://www.sfml-dev.org/documentation/2.5.1/classsf_1_1Transform.php#af0b7cc3fed36d0fa22d5d331a779eee2\" rel=\"nofollow noreferrer\"><code>sf::Transform::rotate</code></a>, but it&#39;s the same idea."}], "tags": [], "owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "is_accepted": true, "score": 4, "last_activity_date": 1586452121, "last_edit_date": 1586452121, "creation_date": 1571246712, "answer_id": 58418691, "question_id": 58418179, "link": "https://stackoverflow.com/questions/58418179/sfml-shape-rotates-infinitely/58418691#58418691", "title": "SFML shape rotates infinitely", "body": "<p>Right now, this line</p>\n\n<pre><code>transform.rotate(ang, WIDTH / 2, HEIGHT / 2);\n</code></pre>\n\n<p>Is called on every frame of your program because it's in the main loop, that runs <em>constantly</em>. If you want it to happen only while your game detects some input, put it inside your event polling, like so:</p>\n\n<pre><code>while (window.pollEvent(event))\n{\n    // Do your event handling in here, input, etc.\n\n    if (event.type == Event::Closed)\n        window.close();\n\n    // This event case should also be inside here.\n    if (event.type == Event::KeyPressed)\n    {\n        switch (event.key.code)\n        {\n            case Keyboard::Right:\n                transform.rotate(ang, WIDTH / 2, HEIGHT / 2); \n                break;\n        }\n    }\n}\n</code></pre>\n\n<p>Otherwise your arm will continue to rotate indefinitely.</p>\n\n<p>EDIT: Thanks @alseether for pointing out that the <code>Transform::rotate</code> function adds the angle to the shape's current rotation. So incrementing <code>ang</code> each time will gradually make the shape rotate faster and faster... If you don't want this to happen just set <code>ang</code> to a constant value and it will rotate the cube at a constant rate.</p>\n"}], "owner": {"reputation": 75, "user_id": 11947589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8pfNl.jpg?s=128&g=1", "display_name": "Gian Marco Cialdi", "link": "https://stackoverflow.com/users/11947589/gian-marco-cialdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 58418691, "answer_count": 1, "score": 3, "last_activity_date": 1586452121, "creation_date": 1571244678, "last_edit_date": 1571247485, "question_id": 58418179, "link": "https://stackoverflow.com/questions/58418179/sfml-shape-rotates-infinitely", "title": "SFML shape rotates infinitely", "body": "<p>I'm making a robot arm which moves around a graph but when I try to rotate a shape with my keyboard it rotates infinetly: I want it to rotate just one time when I press the right arrow. How can I solve this?</p>\n\n<pre><code>Transform transform;    \nwhile (window.isOpen())\n{\n    Event event;\n    while (window.pollEvent(event))\n    {\n        if (event.type == Event::Closed)\n            window.close();\n\n    }\n    if (event.type == Event::KeyPressed)\n    {\n        switch (event.key.code)\n        {\n        case Keyboard::Right:\n            ang += 1;\n        }\n    }\n\n    window.clear(Color::White);\n    window.draw(braccio, transform);\n    transform.rotate(ang, WIDTH / 2, HEIGHT / 2);\n    window.draw(assi);\n    window.display();\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1571244494, "post_id": 58418111, "comment_id": 103178849, "body": "Think about <code>auto inc_count(int x){     return [&amp;x](){         return x++;     }; };</code>.  What do you capture by reference?  When you return from the function, is that thing still alive?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 2, "creation_date": 1571244702, "post_id": 58418111, "comment_id": 103178941, "body": "To fix it you can change <code>inc_count()</code> parameter type to <code>int &amp;</code> but will have to pass lvalue to it, not int constant"}], "answers": [{"comments": [{"owner": {"reputation": 54, "user_id": 12045916, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCgMzthMjf8wj62L0B_5Xg0RnEvvkPcBFAwgcvW=k-s128", "display_name": "Subhash Jha", "link": "https://stackoverflow.com/users/12045916/subhash-jha"}, "edited": false, "score": 0, "creation_date": 1571244917, "post_id": 58418139, "comment_id": 103179036, "body": "Thanks for pointing out the mistake. Missed it completely. I just have one more doubt. In case of capture by value, how the value is getting updated across the calls to inc(). Is this similar to closure in JS?"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "reply_to_user": {"reputation": 54, "user_id": 12045916, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCgMzthMjf8wj62L0B_5Xg0RnEvvkPcBFAwgcvW=k-s128", "display_name": "Subhash Jha", "link": "https://stackoverflow.com/users/12045916/subhash-jha"}, "edited": false, "score": 3, "creation_date": 1571245092, "post_id": 58418139, "comment_id": 103179105, "body": "@SubhashJha \u2022 capture by value means the lambda object has its own local member variable, and that is what is being updated.  A lambda is just a large amount of syntactic sugar, which makes a functor object.  Writing them without the sugar is a lot of boilerplate code, which was a barrier for people making them."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 54, "user_id": 12045916, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCgMzthMjf8wj62L0B_5Xg0RnEvvkPcBFAwgcvW=k-s128", "display_name": "Subhash Jha", "link": "https://stackoverflow.com/users/12045916/subhash-jha"}, "edited": false, "score": 1, "creation_date": 1571245133, "post_id": 58418139, "comment_id": 103179128, "body": "@SubhashJha, I am not familiar with JS enough to compare. In this case, the lambda has its own copy of the variable, which is incremented when it gets called."}, {"owner": {"reputation": 3839, "user_id": 9171697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/475b59ee1312dc014fbe1eebcd91d307?s=128&d=identicon&r=PG&f=1", "display_name": "Meowmere", "link": "https://stackoverflow.com/users/9171697/meowmere"}, "reply_to_user": {"reputation": 54, "user_id": 12045916, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCgMzthMjf8wj62L0B_5Xg0RnEvvkPcBFAwgcvW=k-s128", "display_name": "Subhash Jha", "link": "https://stackoverflow.com/users/12045916/subhash-jha"}, "edited": false, "score": 0, "creation_date": 1571248340, "post_id": 58418139, "comment_id": 103180564, "body": "@SubhashJha JavaScript automatically extends the lifetime of the captured variable, c++ does not. C++ standards says: <code>the validity of such captures is determined by the lifetime of the object to which thereference refers, not by the lifetime of the reference itself.</code>"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 5, "last_activity_date": 1571244529, "creation_date": 1571244529, "answer_id": 58418139, "question_id": 58418111, "link": "https://stackoverflow.com/questions/58418111/changing-the-values-of-captured-variables-inside-the-c-lambda/58418139#58418139", "title": "Changing the values of captured variables inside the c++ lambda", "body": "<p>In the first version, you are capturing a reference to a variable that is not alive after the function returns. You have a dangling reference after the function returns and your code has undefined behavior.</p>\n\n<p>You can use the following to capture by reference.</p>\n\n<pre><code>auto inc_count(int&amp; x){\n    return [&amp;x](){\n        return x++;\n    };\n};\n</code></pre>\n\n<p>But then, you can't use <code>int_count(4)</code> in <code>main</code>. You'll have to use a variable whose reference can be used in <code>int_count</code>.</p>\n\n<pre><code>int main()\n{\n    int number = 4;\n    auto inc = inc_count(number);\n\n    ...\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "is_accepted": false, "score": 0, "last_activity_date": 1571245060, "creation_date": 1571245060, "answer_id": 58418270, "question_id": 58418111, "link": "https://stackoverflow.com/questions/58418111/changing-the-values-of-captured-variables-inside-the-c-lambda/58418270#58418270", "title": "Changing the values of captured variables inside the c++ lambda", "body": "<p>In this function, you receive <code>x</code> as a copy of some argument.</p>\n\n<pre><code>auto inc_count(int x){\n    return [&amp;x](){\n        return x++;\n    };\n};\n</code></pre>\n\n<p>When you return from <code>inc_count</code>, the <code>x</code> being referenced by your returned value, <code>&amp;x</code>, is destroyed. This is why your value is close to the maximum <code>short</code> value, 32,767. The memory at the address you are attempting to access has been freed and no longer contains any data structure.</p>\n\n<p>Your pass by value works because the memory is not being freed. You are passing a copy of your data at each point; the program is not freeing this data and you end up with a coherent value.</p>\n"}], "owner": {"reputation": 54, "user_id": 12045916, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCgMzthMjf8wj62L0B_5Xg0RnEvvkPcBFAwgcvW=k-s128", "display_name": "Subhash Jha", "link": "https://stackoverflow.com/users/12045916/subhash-jha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571245060, "creation_date": 1571244403, "last_edit_date": 1571245048, "question_id": 58418111, "link": "https://stackoverflow.com/questions/58418111/changing-the-values-of-captured-variables-inside-the-c-lambda", "title": "Changing the values of captured variables inside the c++ lambda", "body": "<p>I am trying to increment a captured variable to a lambda function by reference but unable to do so.</p>\n\n<p>By capturing the variable by value and then making the lambda mutable, I am able to increment the value. But by passing the reference, the increment is not getting applied. </p>\n\n<p>Also,\nIn case of capture by value, how the value is getting updated across the calls to inc(). Is this similar to closure in JS? </p>\n\n<pre><code>**Capture By reference**\n\nauto inc_count(int x){\n    return [&amp;x](){\n        return x++;\n    };\n};\n\nint main()\n{\n    auto inc = inc_count(4);\n    cout&lt;&lt;inc()&lt;&lt;endl;    //32765\n    cout&lt;&lt;inc()&lt;&lt;endl;    //32765\n    cout&lt;&lt;inc()&lt;&lt;endl;    //32765\n    cout&lt;&lt;inc()&lt;&lt;endl;    //32765\n\n    return 0;\n}\n\n\n**Capture by value**\n\nauto inc_count(int x){\n    return [x]()mutable{\n        return x++;\n    };\n};\n\nint main()\n{\n    auto inc = inc_count(4);\n    cout&lt;&lt;inc()&lt;&lt;endl;     //4\n    cout&lt;&lt;inc()&lt;&lt;endl;     //5\n    cout&lt;&lt;inc()&lt;&lt;endl;     //6\n    cout&lt;&lt;inc()&lt;&lt;endl;     //7\n\n    return 0;\n}\n</code></pre>\n\n<p>Actual Output :<br>\n<code>32765</code><br>\n<code>32765</code><br>\n<code>32765</code><br>\n<code>32765</code> </p>\n\n<p>Expected Output :<br>\n<code>4</code><br>\n<code>5</code><br>\n<code>6</code><br>\n<code>7</code></p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1571244137, "post_id": 58418004, "comment_id": 103178702, "body": "related/dupe: <a href=\"https://stackoverflow.com/questions/25765053/c-stdmem-fn-with-overloaded-member-function\" title=\"c stdmem fn with overloaded member function\">stackoverflow.com/questions/25765053/&hellip;</a>"}, {"owner": {"reputation": 21, "user_id": 10736206, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KE7cNdYViJw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jQOkQmXwEqTim3xATimnknsnAj6g/mo/photo.jpg?sz=128", "display_name": "Rolan", "link": "https://stackoverflow.com/users/10736206/rolan"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1571244714, "post_id": 58418004, "comment_id": 103178947, "body": "Yes. I have tried two variants. Both fails: 1.    function&lt;double(Object::*)()&gt; foo = static_cast&lt;double(Object::*)()&gt;(&amp;Object::getter); 2.    function&lt;double(Object::*)()const&gt; foo = static_cast&lt;double(Object::*)()const&gt;(&amp;Object::getter);"}], "answers": [{"tags": [], "owner": {"reputation": 885, "user_id": 1611568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afbc551becb4b8ec17ba1794f9adb339?s=128&d=identicon&r=PG", "display_name": "Chris B", "link": "https://stackoverflow.com/users/1611568/chris-b"}, "is_accepted": false, "score": 2, "last_activity_date": 1571246281, "creation_date": 1571246281, "answer_id": 58418601, "question_id": 58418004, "link": "https://stackoverflow.com/questions/58418004/get-reference-to-member-function-overloaded-by-const-specification/58418601#58418601", "title": "Get reference to member function overloaded by const specification", "body": "<p>By casting to the specific function pointer type:</p>\n\n<pre><code>std::function&lt;double(const Object&amp;)&gt; foo = static_cast&lt;double(Object::*)() const&gt;(&amp;Object::getter);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16677, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "is_accepted": false, "score": 0, "last_activity_date": 1571246867, "last_edit_date": 1571246867, "creation_date": 1571246561, "answer_id": 58418663, "question_id": 58418004, "link": "https://stackoverflow.com/questions/58418004/get-reference-to-member-function-overloaded-by-const-specification/58418663#58418663", "title": "Get reference to member function overloaded by const specification", "body": "<p>You can use a typedef to disambiguate the function you want:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;functional&gt;\n\nclass Object {\npublic:\n    Object (double someVal) : val(someVal) { }\n    double getter () const { return val; }\n    double&amp; getter () { return val; }\nprivate:\n    double val;\n};\n\ntypedef double (Object::*funtype)() const;\n\nint main()\n{\n    const Object instance(42);\n    std::function&lt;double(const Object&amp;)&gt; foo = static_cast&lt;funtype&gt;(&amp;Object::getter);\n    std::cout &lt;&lt; foo(instance) &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p><a href=\"http://cpp.sh/3whtt\" rel=\"nofollow noreferrer\">run on cpp.sh</a></p>\n\n<p>Or, without casting:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;functional&gt;\n\nclass Object {\npublic:\n    Object (double someVal) : val(someVal) { }\n    double getter () const { return val; }\n    double&amp; getter () { return val; }\nprivate:\n    double val;\n};\n\ntypedef double (Object::*funtype)() const;\n\nint main()\n{\n    const Object instance(42);\n    funtype temp = &amp;Object::getter;\n    std::function&lt;double(const Object&amp;)&gt; foo = temp;\n    std::cout &lt;&lt; foo(instance) &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p><a href=\"http://cpp.sh/5dwci\" rel=\"nofollow noreferrer\">run on cpp.sh</a></p>\n"}, {"comments": [{"owner": {"reputation": 16677, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "edited": false, "score": 0, "creation_date": 1571246819, "post_id": 58418692, "comment_id": 103179895, "body": "Oh, that&#39;s clever. Where would <code>mutable</code> go if you were interested in using the non-const version?"}, {"owner": {"reputation": 12139, "user_id": 2412846, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/eBJip.gif?s=128&g=1", "display_name": "davidhigh", "link": "https://stackoverflow.com/users/2412846/davidhigh"}, "reply_to_user": {"reputation": 16677, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "edited": false, "score": 1, "creation_date": 1571247090, "post_id": 58418692, "comment_id": 103180022, "body": "@Ruzhim: thanks. The <code>mutable</code> comes behind the parameters, i.e. <code>std::function&lt;double()&gt; f = [o]() mutable { return o.getter(); };</code> calls the non-const version of <code>getter()</code>."}], "tags": [], "owner": {"reputation": 12139, "user_id": 2412846, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/eBJip.gif?s=128&g=1", "display_name": "davidhigh", "link": "https://stackoverflow.com/users/2412846/davidhigh"}, "is_accepted": false, "score": 2, "last_activity_date": 1571246712, "creation_date": 1571246712, "answer_id": 58418692, "question_id": 58418004, "link": "https://stackoverflow.com/questions/58418004/get-reference-to-member-function-overloaded-by-const-specification/58418692#58418692", "title": "Get reference to member function overloaded by const specification", "body": "<p>Just use a lambda closure:</p>\n\n<pre><code>Object o{0.0};\nstd::function&lt;double()&gt; f = [o](){ return o.getter(); };\n</code></pre>\n\n<p>The lambda calls the const version of <code>getter()</code>, as captured variables are <code>const</code> by default (otherwise you'd have to use <code>mutable</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 3839, "user_id": 9171697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/475b59ee1312dc014fbe1eebcd91d307?s=128&d=identicon&r=PG&f=1", "display_name": "Meowmere", "link": "https://stackoverflow.com/users/9171697/meowmere"}, "is_accepted": false, "score": 2, "last_activity_date": 1571247824, "last_edit_date": 1571247824, "creation_date": 1571246966, "answer_id": 58418753, "question_id": 58418004, "link": "https://stackoverflow.com/questions/58418004/get-reference-to-member-function-overloaded-by-const-specification/58418753#58418753", "title": "Get reference to member function overloaded by const specification", "body": "<p><a href=\"https://en.cppreference.com/w/cpp/language/overloaded_address\" rel=\"nofollow noreferrer\">Address of Overload functions</a> defined 7 contexts where the correct overload can be deduced. Yet <code>std::function&lt;...&gt;</code> is not one of them. Thus, the overload function to get address of is ambiguous.</p>\n\n<p>There are a few ways to select the overload you want:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>const Object instance(42);\n// Use static_cast to select overload\nstd::function&lt;double(const Object&amp;)&gt; foo = static_cast&lt;double(Object::*)() const&gt;(&amp;Object::getter);\n// Use lambda to select overload\n// std::function type parameters can be omitted since c++ 17\n// Guaranteed copy elision since c++ 17\nstd::function bar = [](const Object&amp; instance) { return instance.getter(); };\n// Use std::mem_fn\nstd::function&lt;double(const Object&amp;)&gt; mfn = std::mem_fn&lt;double() const&gt;(&amp;Object::getter);\n</code></pre>\n\n<hr>\n\n<p>However, an idiomatic way to declare methods with similar functionality but differed by constness is actually to declare two different functions: <code>foo()</code> and <code>cfoo()</code>. Think about <code>begin()</code> and <code>cbegin()</code>. The latter returns a const iterator.</p>\n"}, {"tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1571259052, "last_edit_date": 1571259052, "creation_date": 1571247377, "answer_id": 58418851, "question_id": 58418004, "link": "https://stackoverflow.com/questions/58418004/get-reference-to-member-function-overloaded-by-const-specification/58418851#58418851", "title": "Get reference to member function overloaded by const specification", "body": "<p>Yet another example, going through some options.</p>\n\n<pre><code>// auto mem_fn = static_cast&lt;double (Object::*)() const&gt;(&amp;Object::getter);\n// or shorter:\ndouble (Object::*mem_fn)() const = &amp;Object::getter;\n\n// store member function (without instance)\nstd::function&lt;double(const Object&amp;)&gt; foo = mem_fn;\nstd::cout &lt;&lt; foo(instance) &lt;&lt; \"\\n\";\n\n// bind with instance\nauto bound = std::bind(mem_fn, &amp;instance);\nstd::cout &lt;&lt; bound() &lt;&lt; \"\\n\";\n\n// store member function (with instance)\nstd::function&lt;double()&gt; bar = bound;\nstd::cout &lt;&lt; bar() &lt;&lt; \"\\n\";\n\n// store member function (with instance), without the intermediate steps\nstd::function&lt;double()&gt; baz =\n    std::bind(\n        static_cast&lt;double (Object::*)() const&gt;(&amp;Object::getter),\n        instance\n    );\nstd::cout &lt;&lt; baz() &lt;&lt; \"\\n\";\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10736206, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KE7cNdYViJw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jQOkQmXwEqTim3xATimnknsnAj6g/mo/photo.jpg?sz=128", "display_name": "Rolan", "link": "https://stackoverflow.com/users/10736206/rolan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 5, "score": 2, "last_activity_date": 1571259052, "creation_date": 1571243931, "question_id": 58418004, "link": "https://stackoverflow.com/questions/58418004/get-reference-to-member-function-overloaded-by-const-specification", "title": "Get reference to member function overloaded by const specification", "body": "<p>Here is some class with two overloaded methods foo:</p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>class Object {\npublic:\n    Object (double someVal) : val(someVal) { }\n    double getter () const { return val; }\n    double&amp; getter () { return val; }\nprivate:\n    double val;\n};\n</code></pre>\n\n<p>So now the <code>double Object::getter() const</code> function will be called on const instances </p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>const Object instance(42);\ncout &lt;&lt; instance.getter() &lt;&lt; endl; // called: `double getter() const`\n</code></pre>\n\n<p>Now, I am trying to get reference to <code>double getter() const</code> function and assign it to <code>std::function</code> type </p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>const Object instance(42);\nfunction&lt;double(const Object&amp;)&gt; foo = &amp;Object::getter;\ncout &lt;&lt; foo(instance) &lt;&lt; endl;\n</code></pre>\n\n<p>The code works fine if function <code>double&amp; getter()</code> is removed, but with it I got the following error on the second line:</p>\n\n<pre><code>test.cpp:18:34: error: no viable conversion from '&lt;overloaded function type&gt;' to\n      'function&lt;double (const Object &amp;)&gt;'\n        function&lt;double(const Object&amp;)&gt; foo = &amp;Object::getter;\n                                        ^     ~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>It seems that error happens, because system tries to call <code>double&amp; getter()</code>.\nThe question is how to force calling of <code>double getter() const</code>?\nThe full listing is attached <a href=\"https://drive.google.com/file/d/13WL4OGWZVx2vT8PxSnFmsOZdufBCKT2l/view\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": ["c++", "visual-studio", "visual-c++", "visual-studio-2017", "windows-xp"], "answers": [{"comments": [{"owner": {"reputation": 68, "user_id": 6274785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5sx29.jpg?s=128&g=1", "display_name": "0xVikas", "link": "https://stackoverflow.com/users/6274785/0xvikas"}, "edited": false, "score": 0, "creation_date": 1571245140, "post_id": 58418119, "comment_id": 103179131, "body": "Thank you for answering !"}, {"owner": {"reputation": 68, "user_id": 6274785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5sx29.jpg?s=128&g=1", "display_name": "0xVikas", "link": "https://stackoverflow.com/users/6274785/0xvikas"}, "edited": false, "score": 0, "creation_date": 1571246971, "post_id": 58418119, "comment_id": 103179969, "body": "But now I am facing another problem, After successful compilation, when I run the program on windows xp, Its showing me that some DLL files are missing. Can you plz help me fix this ?"}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 68, "user_id": 6274785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5sx29.jpg?s=128&g=1", "display_name": "0xVikas", "link": "https://stackoverflow.com/users/6274785/0xvikas"}, "edited": false, "score": 0, "creation_date": 1571247157, "post_id": 58418119, "comment_id": 103180046, "body": "@0xVikas You&#39;ll almost certainly need to install the relevant &quot;VC Redistributable&quot; package on the target machine(s). There&#39;s a recent discussion of this here: <a href=\"https://stackoverflow.com/questions/58336827/how-to-run-a-c-program-i-wrote-on-another-computer/58336900#58336900\" title=\"how to run a c program i wrote on another computer\">stackoverflow.com/questions/58336827/&hellip;</a>"}, {"owner": {"reputation": 68, "user_id": 6274785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5sx29.jpg?s=128&g=1", "display_name": "0xVikas", "link": "https://stackoverflow.com/users/6274785/0xvikas"}, "edited": false, "score": 1, "creation_date": 1571247527, "post_id": 58418119, "comment_id": 103180214, "body": "Thanks ! I fixed it by changing &quot;code generation -&gt; Runtime library&quot; to Multi Threaded Debug to statically include all the DLLs."}], "tags": [], "owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "is_accepted": true, "score": 5, "last_activity_date": 1571244420, "creation_date": 1571244420, "answer_id": 58418119, "question_id": 58417992, "link": "https://stackoverflow.com/questions/58417992/how-to-compile-code-for-windows-xp-in-visual-studio-2017/58418119#58418119", "title": "How to compile code for Windows XP in Visual Studio 2017", "body": "<p>What you have encountered here are issues in the header files for the XP-Compatible SDK. The problem is actually quite arcane but, fortunately, relatively easy to deal with: you simply need to 'relax' the strictness of conformity checks the compiler uses...</p>\n\n<p>To do this, right-click on your project in the <strong>Solution Explorer</strong> and select \"Properties.\" On the invoked property-page, select the \"C/C++\" tab, and then the \"Language\" sub-tab. In the page then displayed, make sure you select \"Conformance Mode\" to \"<strong>No</strong>\". That should fix the issues.</p>\n\n<p>Feel free to ask for further clarification and/or explanation.</p>\n"}, {"comments": [{"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 1, "creation_date": 1571244565, "post_id": 58418130, "comment_id": 103178883, "body": "Simultaneous answers, I guess: I feel duty-bound to give you an UV! (Otherwise, I&#39;m denigrating my own answer.?)"}, {"owner": {"reputation": 68, "user_id": 6274785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5sx29.jpg?s=128&g=1", "display_name": "0xVikas", "link": "https://stackoverflow.com/users/6274785/0xvikas"}, "edited": false, "score": 0, "creation_date": 1571245118, "post_id": 58418130, "comment_id": 103179120, "body": "Thank you so much answering !"}], "tags": [], "owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "is_accepted": false, "score": 2, "last_activity_date": 1571244493, "creation_date": 1571244493, "answer_id": 58418130, "question_id": 58417992, "link": "https://stackoverflow.com/questions/58417992/how-to-compile-code-for-windows-xp-in-visual-studio-2017/58418130#58418130", "title": "How to compile code for Windows XP in Visual Studio 2017", "body": "<p>You didn't say what template you started with, but I suspect that you have Conformance Mode (<code>/permissive-</code>) enabled. Go to Project -> Properties -> C/C++ -> Language and set Conformance Mode to \"No\".</p>\n\n<p>The old Windows 7.1a SDK used to support Windows XP was never updated to be conformant with <code>/permissive-</code>.</p>\n"}], "owner": {"reputation": 68, "user_id": 6274785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5sx29.jpg?s=128&g=1", "display_name": "0xVikas", "link": "https://stackoverflow.com/users/6274785/0xvikas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1314, "favorite_count": 1, "accepted_answer_id": 58418119, "answer_count": 2, "score": 2, "last_activity_date": 1571244833, "creation_date": 1571243899, "last_edit_date": 1571244833, "question_id": 58417992, "link": "https://stackoverflow.com/questions/58417992/how-to-compile-code-for-windows-xp-in-visual-studio-2017", "title": "How to compile code for Windows XP in Visual Studio 2017", "body": "<p>I was trying to compile a basic hello world program for Windows XP in Visual Studio 2017 on Windows 10. But it was giving some errors as showing in the image. </p>\n\n<p>I already tried the steps mentioned in other Stack Overflow posts on this question, and changed the Platform tools \"Visual Studio 2017 - Windows XP (v141_xp)\" .</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\nint main() {\n    cout &lt;&lt; \"Hello world\\n\";\n}\n</code></pre>\n\n<pre><code>1&gt;------ Build started: Project: WindowsProject1, Configuration: Debug Win32 ------\n1&gt;C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\Common7\\IDE\\VC\\VCTargets\\Platforms\\Win32\\PlatformToolsets\\v141_xp\\Toolset.targets(39,5): warning MSB8051: Support for targeting Windows XP is deprecated and will not be present in future releases of Visual Studio. Please see https://go.microsoft.com/fwlink/?linkid=2023588 for more information.\n1&gt;stdafx.cpp\n1&gt;c:\\program files (x86)\\microsoft sdks\\windows\\v7.1a\\include\\objbase.h(239): error C2760: syntax error: unexpected token 'identifier', expected 'type specifier'\n1&gt;c:\\program files (x86)\\microsoft sdks\\windows\\v7.1a\\include\\gdiplusheaders.h(891): error C4596: 'EmfToWmfBits': illegal qualified name in member declaration\n1&gt;c:\\program files (x86)\\microsoft sdks\\windows\\v7.1a\\include\\gdiplusstringformat.h(220): error C4596: 'GetTrimming': illegal qualified name in member declaration\n1&gt;Done building project \"WindowsProject1.vcxproj\" -- FAILED.\n========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ==========\n\n</code></pre>\n"}, {"tags": ["c++", "matlab", "compilation", "mex"], "comments": [{"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1571243797, "post_id": 58417922, "comment_id": 103178527, "body": "Did you try <code>mex -setup</code> as described in the documentation? It should allow you to select a compiler. Also, which version of MATLAB do you use? Each version recognizes only a limited set of MSVC versions. See here: <a href=\"https://www.mathworks.com/help/matlab/matlab_external/choose-c-or-c-compilers.html\" rel=\"nofollow noreferrer\">mathworks.com/help/matlab/matlab_external/&hellip;</a>"}, {"owner": {"reputation": 435, "user_id": 11140344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d6a5e9b218a0f273982bb9336e07cdd?s=128&d=identicon&r=PG&f=1", "display_name": "dtr43", "link": "https://stackoverflow.com/users/11140344/dtr43"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1571244774, "post_id": 58417922, "comment_id": 103178973, "body": "Using the mex -setup command the following error will be raised   &#39;&#39; Error using mex No supported compiler or SDK was found. You can install the freely available MinGW-w64 C/C++ compiler; see Install MinGW-w64 Compiler. For more options, visit <a href=\"http://www.mathworks.com/support/compilers/R2017a/\" rel=\"nofollow noreferrer\">mathworks.com/support/compilers/R2017a</a>.&#39;&#39; However, using the setenv() for MingW everything is OK. The problem is how to do so for VC++."}, {"owner": {"reputation": 35987, "user_id": 2732801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YEZ8S.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/2732801/daniel"}, "edited": false, "score": 0, "creation_date": 1571261598, "post_id": 58417922, "comment_id": 103186167, "body": "Did you install the compiler? Last time I installed, the default installation set of Visual Studio did not contain the C / C++ compiler."}, {"owner": {"reputation": 32458, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "reply_to_user": {"reputation": 35987, "user_id": 2732801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YEZ8S.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/2732801/daniel"}, "edited": false, "score": 0, "creation_date": 1571306916, "post_id": 58417922, "comment_id": 103200850, "body": "Make sure you check what @Daniel mentioned. MVS does not install C++ compiler by default! So unless you explicitly selected it during installation, you may not have MVS installed. And no, compilers are not resident in <code>mexopts</code> directory, that is purely <code>xml</code> files with compiler options"}, {"owner": {"reputation": 435, "user_id": 11140344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d6a5e9b218a0f273982bb9336e07cdd?s=128&d=identicon&r=PG&f=1", "display_name": "dtr43", "link": "https://stackoverflow.com/users/11140344/dtr43"}, "reply_to_user": {"reputation": 35987, "user_id": 2732801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YEZ8S.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/2732801/daniel"}, "edited": false, "score": 0, "creation_date": 1571324245, "post_id": 58417922, "comment_id": 103211255, "body": "@Daniel, I installed the compiler but it doesn&#39;t work."}], "answers": [{"comments": [{"owner": {"reputation": 435, "user_id": 11140344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d6a5e9b218a0f273982bb9336e07cdd?s=128&d=identicon&r=PG&f=1", "display_name": "dtr43", "link": "https://stackoverflow.com/users/11140344/dtr43"}, "edited": false, "score": 0, "creation_date": 1571250854, "post_id": 58418499, "comment_id": 103181655, "body": "The renaming trick worked but I still get the previous error: &#39;&quot;No supported compiler or SDK was found.&quot; Further, mex - setup command does not work anymore and it produces the aforementioned error."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "reply_to_user": {"reputation": 435, "user_id": 11140344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d6a5e9b218a0f273982bb9336e07cdd?s=128&d=identicon&r=PG&f=1", "display_name": "dtr43", "link": "https://stackoverflow.com/users/11140344/dtr43"}, "edited": false, "score": 1, "creation_date": 1571325507, "post_id": 58418499, "comment_id": 103211957, "body": "@dtr43: Ah, that explains it. Could you post that as an answer? It might help someone else running into the same issue."}, {"owner": {"reputation": 435, "user_id": 11140344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d6a5e9b218a0f273982bb9336e07cdd?s=128&d=identicon&r=PG&f=1", "display_name": "dtr43", "link": "https://stackoverflow.com/users/11140344/dtr43"}, "edited": false, "score": 0, "creation_date": 1571326549, "post_id": 58418499, "comment_id": 103212559, "body": "Thanks for your priceless help and advice. Sure, I&#39;ll post it!"}], "tags": [], "owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "is_accepted": false, "score": 3, "last_activity_date": 1571245910, "creation_date": 1571245910, "answer_id": 58418499, "question_id": 58417922, "link": "https://stackoverflow.com/questions/58417922/recognizing-vc-compiler-in-matlab/58418499#58418499", "title": "Recognizing VC++ compiler in MATLAB", "body": "<p>The <a href=\"https://www.mathworks.com/help/matlab/matlab_external/choose-c-or-c-compilers.html\" rel=\"nofollow noreferrer\">documented way</a> of selecting a C++ compiler is to use <code>mex -setup c++</code>. However, if this does not work for some reason (as appears to be the case for OP), then one can configure the compiler manually:</p>\n\n<p>In the output of <code>mex.getCompilerConfigurations('C++','Selected')</code>, there is a <code>MexOpt</code> value. This points to the file that contains the information about the selected compiler that <code>mex</code> will use.</p>\n\n<p>You can take any of the XML files in the <code>mexopts</code> directory (which can be found here: <code>$MATLABROOT/bin/&lt;arch&gt;/mexopts</code>) and copy and rename it to match the value of <code>mex.getCompilerConfigurations('C++').MexOpt</code>.</p>\n\n<p>Depending on your platform (I have not seen what this looks like under Windows) you might have to edit in some paths to your compiler and related directories.</p>\n\n<p>It is recommended to have your configured C and C++ compilers match.</p>\n"}, {"tags": [], "owner": {"reputation": 435, "user_id": 11140344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d6a5e9b218a0f273982bb9336e07cdd?s=128&d=identicon&r=PG&f=1", "display_name": "dtr43", "link": "https://stackoverflow.com/users/11140344/dtr43"}, "is_accepted": false, "score": 1, "last_activity_date": 1571326829, "creation_date": 1571326829, "answer_id": 58436281, "question_id": 58417922, "link": "https://stackoverflow.com/questions/58417922/recognizing-vc-compiler-in-matlab/58436281#58436281", "title": "Recognizing VC++ compiler in MATLAB", "body": "<p>Unfortunately, none of the methods provided as answers and comments didn't work. I just found this is a bug in MATLAB R2016b and R2017a.\nThe workaround for this problem can be found at the following link.</p>\n\n<p><a href=\"http://mathworks.com/support/bugreports/1487958\" rel=\"nofollow noreferrer\">mathworks.com/support/bugreports/1487958</a></p>\n"}], "owner": {"reputation": 435, "user_id": 11140344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d6a5e9b218a0f273982bb9336e07cdd?s=128&d=identicon&r=PG&f=1", "display_name": "dtr43", "link": "https://stackoverflow.com/users/11140344/dtr43"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1571326829, "creation_date": 1571243531, "question_id": 58417922, "link": "https://stackoverflow.com/questions/58417922/recognizing-vc-compiler-in-matlab", "title": "Recognizing VC++ compiler in MATLAB", "body": "<p>In order to install MatConvNet, it is needed to use a C++ compiler. Since MingW-w64 C++ does not work, Visual C++ complier should be used. However, I faced some problems with that. \nAlthough both of them are installed, I could not use them. \nUsing Mingw compiler, the installation process will be failed and VC++ could not be recognized. I installed Visual Studio 2017, but when the following command issued, it seems that it is not recognizable.</p>\n\n<pre><code>&gt;&gt; mex.getCompilerConfigurations('C++','Selected')\n</code></pre>\n\n<p><strong>Output</strong>:</p>\n\n<pre><code>ans = \n\n         CompilerConfiguration with properties:\n\n         Name: 'MinGW64 Compiler (C++)'\n Manufacturer: 'GNU'\n     Language: 'C++'\n      Version: '4.x'\n     Location: '$MINGWROOT'\n    ShortName: 'mingw64-g++'\n     Priority: 'E'\n      Details: [1\u00d71 mex.CompilerConfigurationDetails]\n   LinkerName: '$MINGWROOT\\bin\\g++'\nLinkerVersion: ''\n       MexOpt: some path\n</code></pre>\n\n<p>So, the question is how to make the MATLAB to recognize VC++ as the primary compiler?</p>\n\n<p>P.s. Both compilers are resided in MATLAB's mexopts directory.</p>\n\n<p><a href=\"https://i.stack.imgur.com/OgYX9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OgYX9.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1571243601, "post_id": 58417876, "comment_id": 103178429, "body": "Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a> and compile (using <a href=\"http://gcc.gnu.org\" rel=\"nofollow noreferrer\">GCC</a>...) with <code>g++ -Wall -g</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1571246490, "post_id": 58417908, "comment_id": 103179719, "body": "Of course, since the OP is using division, it may be useful to use a <code>double</code> or <code>float</code> instead to store the result. But that would obviously be up to the OP."}], "tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 4, "last_activity_date": 1571243475, "creation_date": 1571243475, "answer_id": 58417908, "question_id": 58417876, "link": "https://stackoverflow.com/questions/58417876/i-am-not-getting-a-number-as-output-but-instead-a-emoji/58417908#58417908", "title": "I am not getting a number as output but instead a emoji", "body": "<p>Declare the variable result as having the type int</p>\n\n<pre><code>int result = 0;\n</code></pre>\n\n<p>Or maybe it is even better to declare it as</p>\n\n<pre><code>long long int result = 0;\n</code></pre>\n\n<p>and use it like</p>\n\n<pre><code>result = static_cast&lt;long long int&gt;( num1 ) * num2;\n</code></pre>\n\n<p>In your program it has the type <code>std::string</code></p>\n\n<pre><code>string result;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12177931, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDt1Z1SDQuXe3UE7sAEKrGwlm7Yed7Q82g8S3okdg=k-s128", "display_name": "Dharmendhar", "link": "https://stackoverflow.com/users/12177931/dharmendhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1571243508, "creation_date": 1571243347, "last_edit_date": 1571243422, "question_id": 58417876, "link": "https://stackoverflow.com/questions/58417876/i-am-not-getting-a-number-as-output-but-instead-a-emoji", "title": "I am not getting a number as output but instead a emoji", "body": "<p><a href=\"https://i.stack.imgur.com/ptazI.png\" rel=\"nofollow noreferrer\">enter image description here</a>I wrote C++ program which asks the user for two numbers and operator and gives the output based on the input.I think everything is correct but the output is not the desired output.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main()\n{\n    int num1;\n    string op;\n    int num2;\n    string result;\n\n    cout &lt;&lt; \"Enter a number: \";\n    cin &gt;&gt; num1;\n    cout &lt;&lt; \"Enter a operator: \";\n    cin &gt;&gt; op;\n    cout &lt;&lt; \"Enter another number: \";\n    cin &gt;&gt; num2;\n\n    if (op == \"+\"){  //if user types '+' the result is num1 + num2\n        result = num1 + num2;\n        //cout &lt;&lt; result;\n    }else if (op == \"-\"){ //if user types '-' the result is num1 - num2\n        result = num1 - num2;\n       // cout &lt;&lt; result;\n    }else if (op == \"*\"){ //if user types '*' the result is num1 * num2\n        result = num1 * num2;\n        //cout &lt;&lt; result;\n    }else if (op == \"/\"){ //if user types '/' the result is num1 / num2\n        result = num1 / num2;\n        //cout &lt;&lt; result;\n    }else{\n        cout &lt;&lt; \"Invalid operator...\";\n    }\n    cout &lt;&lt; result;\n\n\n\n    return 0;\n}\n</code></pre>\n\n<p>The output should be integer.But the output is just a diamond.</p>\n"}, {"tags": ["c++", "memory-management", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1571243316, "post_id": 58417793, "comment_id": 103178282, "body": "Vectors have been with the language for quite some time, and is often a good replacement for <code>new[]</code> and <code>delete[]</code>. And many parts of the standard library is implemented in header files only, meaning they are part of your program once you build it and doesn&#39;t rely on external libraries."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1571243341, "post_id": 58417793, "comment_id": 103178297, "body": "Unfortunelty if you are living in a C++03 world you&#39;re still going to have <code>new</code> and <code>delete</code>.  You can minimize them though.  If you need a collection of thing, use a vector instead of newing up an array.  You can also write your own RAII smart pointers, or find a library that has already done so.  The big issue with <code>new</code> is that you have to manually verify that the memory is deallocated in every control path.  That is a pain and is error prone.  Hiding the resource allocation and release in a RAII manner makes you code a lot less likely to have these bugs."}, {"owner": {"reputation": 90101, "user_id": 2509, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79ed928ca8b1ab9a637720bf0fb20732?s=128&d=identicon&r=PG&f=1", "display_name": "dmckee --- ex-moderator kitten", "link": "https://stackoverflow.com/users/2509/dmckee-ex-moderator-kitten"}, "edited": false, "score": 1, "creation_date": 1571243891, "post_id": 58417793, "comment_id": 103178571, "body": "Not an answer to the question, but an alterantive solution to your issue. Sometimes, if it is worth the trouble, you can build a development chain for your older platfroms to support newer langauge standards. For instance, we are maintaining a fully c++11 compliant build environment for a older linux target (mandaated by the customer) whose native development environment is only partially c++11 compliant."}, {"owner": {"reputation": 497, "user_id": 1716472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c9bcb26c7a10c77ed39a7ffcfa91bcf?s=128&d=identicon&r=PG", "display_name": "Jef Grailet", "link": "https://stackoverflow.com/users/1716472/jef-grailet"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1571303552, "post_id": 58417793, "comment_id": 103198862, "body": "@NathanOliver Just to make sure (maybe I should have mentioned <code>vector</code> in my statement; maybe I&#39;ll edit later): let&#39;s say I have an array which is several Mo worth (it&#39;s the case in practice). I replace it with a vector, without using dynamic allocation (so, in my case, without using <code>new</code>), which is a member element of another class. If I dynamically allocate an instance of such class then fill my vector to be equivalent in practice to my former array (again, not using dynamic allocation for the elements), will everything be stored in the heap as if I manually managed the array ?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1571314939, "post_id": 58417793, "comment_id": 103205549, "body": "@je Yes.  Here is a very nice &quot;picture&quot; about it: <a href=\"https://stackoverflow.com/questions/55478523/how-does-stdvector-support-contiguous-memory-for-custom-objects-of-unknown-siz/55478808#55478808\" title=\"how does stdvector support contiguous memory for custom objects of unknown siz\">stackoverflow.com/questions/55478523/&hellip;</a>"}, {"owner": {"reputation": 497, "user_id": 1716472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c9bcb26c7a10c77ed39a7ffcfa91bcf?s=128&d=identicon&r=PG", "display_name": "Jef Grailet", "link": "https://stackoverflow.com/users/1716472/jef-grailet"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1571316460, "post_id": 58417793, "comment_id": 103206500, "body": "@NathanOliver Many thanks for that. I think I&#39;m getting some idea of how I should handle my memory allocations to minimize <code>new</code> now. Maybe I&#39;ll update this question later."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1571316607, "post_id": 58417793, "comment_id": 103206602, "body": "@JefGrailet You&#39;re welcome.  If you wind up coming up with a new question post a new question instead of modifying this one.  You don&#39;t want to invalidate the answers you already have by changing the question."}], "answers": [{"tags": [], "owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "is_accepted": false, "score": 0, "last_activity_date": 1571244372, "last_edit_date": 1571244372, "creation_date": 1571243407, "answer_id": 58417888, "question_id": 58417793, "link": "https://stackoverflow.com/questions/58417793/dynamic-allocation-and-large-data-structures-in-c/58417888#58417888", "title": "Dynamic allocation and large data structures in C++", "body": "<blockquote>\n  <p>Is dynamic allocation of the object with <code>new</code> still a bad practice in this particular context?</p>\n</blockquote>\n\n<p>Yes, it's bad to have a <code>new</code> in your code mainly because of memory leaks if <code>delete</code> or <code>delete[]</code> isn't called, especially in the face of exceptions.</p>\n\n<blockquote>\n  <p>What are the better alternatives?</p>\n</blockquote>\n\n<p>Write smart pointers and have them either call <code>new</code> themselves or be called with a <code>new</code> expression:</p>\n\n<pre><code>myUniquePtr&lt;myObj&gt; obj_ptr(new myObj);\n</code></pre>\n\n<p>and then use RAII to have their destructors call <code>delete</code> or <code>delete[]</code>.</p>\n\n<p>Make your smart pointer behave as naked pointer in every other way (overload <code>operator-&gt;</code> <em>etc</em>). Then it'll work in your code with the same syntax as your raw pointers did without having to worry about whether a heap object is deleted at the end of a it's life-cycle no matter what paths the code can take.</p>\n"}, {"comments": [{"owner": {"reputation": 497, "user_id": 1716472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c9bcb26c7a10c77ed39a7ffcfa91bcf?s=128&d=identicon&r=PG", "display_name": "Jef Grailet", "link": "https://stackoverflow.com/users/1716472/jef-grailet"}, "edited": false, "score": 0, "creation_date": 1571303196, "post_id": 58420374, "comment_id": 103198635, "body": "This looks like a nice alternative for my situation. I can&#39;t guarantee I will put it as main answer, depending on what other people might provide, but it&#39;s still a good answer to me."}], "tags": [], "owner": {"reputation": 1703, "user_id": 3845293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/08Ik2.jpg?s=128&g=1", "display_name": "dohashi", "link": "https://stackoverflow.com/users/3845293/dohashi"}, "is_accepted": false, "score": 1, "last_activity_date": 1571253750, "creation_date": 1571253750, "answer_id": 58420374, "question_id": 58417793, "link": "https://stackoverflow.com/questions/58417793/dynamic-allocation-and-large-data-structures-in-c/58420374#58420374", "title": "Dynamic allocation and large data structures in C++", "body": "<p>You could try using boost smart pointers.</p>\n\n<p><a href=\"https://www.boost.org/doc/libs/1_71_0/libs/smart_ptr/doc/html/smart_ptr.html\" rel=\"nofollow noreferrer\">https://www.boost.org/doc/libs/1_71_0/libs/smart_ptr/doc/html/smart_ptr.html</a></p>\n\n<p>They are very similar to the C++ 11 smart pointers, but available as a library which should work in pre C++ 11 environments.  If you decide to go this way, you may also want to look at this</p>\n\n<p><a href=\"https://stackoverflow.com/questions/2512823/how-to-include-only-boost-smart-pointer-codes-into-a-project\">How to include only BOOST smart pointer codes into a project?</a></p>\n\n<p>Now, I'm wondering if you are confusing the new/delete functions with dynamic allocation in general.  Smart Pointers are still dynamic allocation, however they are able to clean themselves up so that you don't have to remember too.  That's why they are preferred over using new/delete (malloc/free, etc), they are much less likely to lead to memory leaks.</p>\n\n<p>Automatic allocation is fine when the object lifespan allows it, but if you need the object to persist outside of the function it was declared in, you'll need dynamically allocated memory.</p>\n"}], "owner": {"reputation": 497, "user_id": 1716472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c9bcb26c7a10c77ed39a7ffcfa91bcf?s=128&d=identicon&r=PG", "display_name": "Jef Grailet", "link": "https://stackoverflow.com/users/1716472/jef-grailet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1571253750, "creation_date": 1571242995, "question_id": 58417793, "link": "https://stackoverflow.com/questions/58417793/dynamic-allocation-and-large-data-structures-in-c", "title": "Dynamic allocation and large data structures in C++", "body": "<p>Lately, I learned there is a consensus among C++ programmers that the <code>new</code>, <code>delete</code> and <code>delete[]</code> operators should be avoided as often as possible, as already discussed <a href=\"https://stackoverflow.com/questions/6500313/why-should-c-programmers-minimize-use-of-new\">here</a>, <a href=\"https://stackoverflow.com/questions/7620385/why-is-it-a-bad-idea-to-use-new\">here</a> or <a href=\"https://stackoverflow.com/questions/22146094/why-should-i-use-a-pointer-rather-than-the-object-itself\">here</a>. While searching, I even stumbled upon an <a href=\"https://www.fluentcpp.com/2018/04/01/cpp-will-no-longer-have-pointers/\" rel=\"nofollow noreferrer\">April Fools' joke</a> stating that these operators would become deprecated in C++20.</p>\n\n<p>I happen to write and maintain a C/C++ program, written in such language in order to carry on useful libraries and classes written by other programmers. As it must run in quite limited environments (i.e., old Linux distributions with the bare minimum in terms of programs), I can't rely on features brought C++11 and later versions (such as <a href=\"https://stackoverflow.com/questions/106508/what-is-a-smart-pointer-and-when-should-i-use-one\">smart pointers</a>), and I sticked so far to a mix of C and Java programming habits while expanding my program. Among others, I used quite often dynamic allocation with <code>new</code> and <code>delete</code> - which sounds, of course, to be a problem.</p>\n\n<p>To ease the maintenance of my code by future programmer(s), I would like to minimize dynamic allocation with said keywords in my code. The problem is that my program has to manage some quite large data structures used for (almost) the entire execution. As a consequence, I struggle to figure out why I should avoid dynamic allocation in these situations.</p>\n\n<p>To simplify, consider I have a data structure (modeled as an object) worth 10 Megaoctets which is used for the entire execution of the program and which the size in memory can increase over time. My questions are the following:</p>\n\n<ul>\n<li><p>Is dynamic allocation of the object with <code>new</code> still a bad practice in this particular context ? What are the better alternatives ?</p></li>\n<li><p>Suppose now I instantiate somewhere in my program a new object without using <code>new</code>, do some operations on it which could slightly change its size, then use a method to insert it in my data structure. How does it work, memory-wise, if automatic allocation (as mentioned <a href=\"https://stackoverflow.com/questions/6500313/why-should-c-programmers-minimize-use-of-new\">here</a>) is used ?</p></li>\n</ul>\n\n<p>Many thanks in advance.</p>\n"}, {"tags": ["c++", "fork", "ownership-semantics"], "comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 1, "creation_date": 1571242998, "post_id": 58417618, "comment_id": 103178129, "body": "What kind of resource do <code>Foo</code>s own? Specifically, is the resource duplicated upon forking?"}, {"owner": {"reputation": 1578, "user_id": 9516968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15afa6fdf1897c5ba92cea3946a5635?s=128&d=identicon&r=PG&f=1", "display_name": "Romen", "link": "https://stackoverflow.com/users/9516968/romen"}, "edited": false, "score": 2, "creation_date": 1571243453, "post_id": 58417618, "comment_id": 103178362, "body": "Forking a process effectively create a copy of the process memory. After forking, both processes own a separate copy of <code>bar</code> and modifications or destruction should not affect the other&#39;s copy. (I&#39;m not sure if this is how every OS handles memory for forked processes though.) If <code>Foo</code> owns a resource not in the process memory (i.e. a file) then how that resource should be handled would depend on what it is."}, {"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "reply_to_user": {"reputation": 1578, "user_id": 9516968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15afa6fdf1897c5ba92cea3946a5635?s=128&d=identicon&r=PG&f=1", "display_name": "Romen", "link": "https://stackoverflow.com/users/9516968/romen"}, "edited": false, "score": 0, "creation_date": 1571244584, "post_id": 58417618, "comment_id": 103178891, "body": "@Romen, this could be a great answer, with just minimal extra work :-)"}, {"owner": {"reputation": 51831, "user_id": 684229, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/EOwM4.png?s=128&g=1", "display_name": "Innate Imunity is The Way", "link": "https://stackoverflow.com/users/684229/innate-imunity-is-the-way"}, "edited": false, "score": 0, "creation_date": 1571245884, "post_id": 58417618, "comment_id": 103179480, "body": "The title definitely transcends the scope of this question.... ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 1578, "user_id": 9516968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15afa6fdf1897c5ba92cea3946a5635?s=128&d=identicon&r=PG&f=1", "display_name": "Romen", "link": "https://stackoverflow.com/users/9516968/romen"}, "is_accepted": true, "score": 1, "last_activity_date": 1571245176, "creation_date": 1571245176, "answer_id": 58418301, "question_id": 58417618, "link": "https://stackoverflow.com/questions/58417618/ownership-of-global-resources-after-fork/58418301#58418301", "title": "Ownership of global resources after fork", "body": "<blockquote>\n  <p>What is the proper way of dealing with object lifetime together with a <code>fork</code>?</p>\n</blockquote>\n\n<p>The proper way to handle shared resources when forking depends on what those objects or resources are.</p>\n\n<p>For any object or variable in the process memory, you <a href=\"https://en.wikipedia.org/wiki/Fork_(system_call)\" rel=\"nofollow noreferrer\">automatically get a copy</a> of it upon forking. Each process will then be able to modify or destroy <em>any</em> variable without affecting the other process. This also means that each process is responsible for cleaning up its unique copy of the resource.</p>\n\n<hr>\n\n<p>For other resources that exist <em>outside</em> the process, like a file, web socket, or shared memory; The best way to handle them will depend on what that resource is. Normally those best practices will be outlined by the library / API you are using to create those resources initially.</p>\n"}, {"tags": [], "owner": {"reputation": 9793, "user_id": 2391169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47b9c6b03a46672d5698ec565319c072?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/2391169/david"}, "is_accepted": false, "score": 0, "last_activity_date": 1571245794, "creation_date": 1571245794, "answer_id": 58418471, "question_id": 58417618, "link": "https://stackoverflow.com/questions/58417618/ownership-of-global-resources-after-fork/58418471#58418471", "title": "Ownership of global resources after fork", "body": "<p>Once you've <code>fork</code>ed, your variables exhibit <a href=\"https://en.wikipedia.org/wiki/Copy-on-write\" rel=\"nofollow noreferrer\">copy-on-write</a> semantics, so any changes by the child process result in unique variables for the child not shared with the parent. Similarly, changes in the parent process will result in the child having new copies and do not propagate, so the parent can go as far as to <code>exit</code> without interrupting the child. I've done this to implement a self-updating program.</p>\n\n<p>Note that as stated in other answers, \"global resources\" should be treated on a case by case basis, but variables are not global resources.</p>\n"}], "owner": {"reputation": 5309, "user_id": 877329, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0b5c9fa7b8fa8139c1330b5fbbd5f934?s=128&d=identicon&r=PG", "display_name": "user877329", "link": "https://stackoverflow.com/users/877329/user877329"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 58418301, "answer_count": 2, "score": 2, "last_activity_date": 1571245794, "creation_date": 1571242364, "question_id": 58417618, "link": "https://stackoverflow.com/questions/58417618/ownership-of-global-resources-after-fork", "title": "Ownership of global resources after fork", "body": "<p>Consider a <code>Foo</code> that holds some resource</p>\n\n<pre><code>struct Foo\n    {\n    ~Foo();\n    };\n</code></pre>\n\n<p>and a global <code>std::vector&lt;Foo&gt;</code>. Perhaps stupid example, but it illustrates the problem well.</p>\n\n<p><code>std::vector&lt;Foo&gt; bar;</code></p>\n\n<p>Now, the processes <code>fork</code>s.</p>\n\n<p>If <code>bar</code> is then only modified by the child process, then a call to <code>exit</code> should be the proper thing to do within the child process. If calling <code>_exit</code>, any <code>Foo</code>:s in bar would leak. If the parent added some stuff to <code>bar</code> before the fork, these object may be destroyed twice. Or maybe this is not a problem, because they should be considered as different objects.</p>\n\n<p>What is the proper way of dealing with object lifetime together with a <code>fork</code>. Is the only sane way of dealing with this problems to let the child <code>exec</code> and start over?</p>\n\n<p>I should notice that at this point in the program, there is guaranteed to be only one thread.</p>\n"}, {"tags": ["c++", "string", "algorithm", "boost"], "comments": [{"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 1, "creation_date": 1571243388, "post_id": 58417404, "comment_id": 103178328, "body": "Allow for spaces before and after the interesting pattern, <code>regex expression_two(R&quot;aw(^ *([+-]?(?:[0-9]*\\.[0-9]+|[0-9]+\\.[0-9]*|[0-9]+)[Ee][+-]?[0-9&zwnj;&#8203;]+|[+-]?(?:[0-9]*\\.[&zwnj;&#8203;0-9]+|[0-9]+\\.[0-9]*&zwnj;&#8203;|[0-9]+)|[+-]?[0-9]+&zwnj;&#8203;) *$)aw&quot;);</code>"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 1, "creation_date": 1571243882, "post_id": 58417404, "comment_id": 103178567, "body": "You&#39;re welcome.  Nathan&#39;s answer for trimming is spot on, as is the cross-reference to the other question.  I use Boost, but some people find Boost to be a bit too big (or daunting?) to want it in their projects."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "edited": false, "score": 1, "creation_date": 1571243497, "post_id": 58417682, "comment_id": 103178385, "body": "@Emma Just change your for loop to the first one that I have in the answer, and copy the trim functions over from <a href=\"https://stackoverflow.com/questions/216823/whats-the-best-way-to-trim-stdstring\">here</a>.  You can see it running <a href=\"http://coliru.stacked-crooked.com/a/39ed0e0403501865\" rel=\"nofollow noreferrer\">here</a>"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 1, "last_activity_date": 1571242573, "creation_date": 1571242573, "answer_id": 58417682, "question_id": 58417404, "link": "https://stackoverflow.com/questions/58417404/leetcode-65-valid-number-c/58417682#58417682", "title": "LeetCode 65: Valid Number (C++)", "body": "<p>The biggest issue is that <a href=\"https://en.cppreference.com/w/cpp/regex/regex_match\" rel=\"nofollow noreferrer\"><code>std::regex_match</code></a> needs a persitant string object for the results to refer to.  If you don't have that then after inspecting the results would be accessing a string that doesn't exist which is undefined behavior.  That means you need to modify the loop to use <code>trim_copy</code> from <a href=\"https://stackoverflow.com/questions/216823/whats-the-best-way-to-trim-stdstring\">What&#39;s the best way to trim std::string?</a> like</p>\n\n<pre><code>for (const auto &amp;input_string: string_vector) {\n    auto trimmed = trim_copy(input_string);\n    if (std::regex_match(trimmed, expression_two))\n        cout &lt;&lt; \"[0-9] Char Class: '\" &lt;&lt; input_string &lt;&lt; \"' is a valid number.\" &lt;&lt; endl;\n}\n</code></pre>\n\n<p>This is going to cost you a copy, but it is the only way to do this without modifying the source data.  If you can modify the source data then you can use</p>\n\n<pre><code>for (auto &amp;input_string: string_vector) {\n    if (std::regex_match(trim(input_string), expression_two))\n        cout &lt;&lt; \"[0-9] Char Class: '\" &lt;&lt; input_string &lt;&lt; \"' is a valid number.\" &lt;&lt; endl;\n}\n</code></pre>\n\n<p>instead.</p>\n"}], "owner": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 58417682, "answer_count": 1, "score": -1, "last_activity_date": 1594081975, "creation_date": 1571241587, "last_edit_date": 1594081975, "question_id": 58417404, "link": "https://stackoverflow.com/questions/58417404/leetcode-65-valid-number-c", "title": "LeetCode 65: Valid Number (C++)", "body": "<p>I'd like to trim left/right the <code>input_string</code> before passing it to <code>regex_match</code> in the <code>if</code> statement and I've unsuccessfully tried the <a href=\"https://stackoverflow.com/a/216883/6553328\">boost <code>trim_right</code> and <code>trim_left</code></a>, not sure how to solve it though.</p>\n\n<p>How do I simply trim the inputs so that the first two inputs <code>\"  0  \"</code> and <code>\"  0.1  \"</code> would become valid numbers?</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;boost/algorithm/string.hpp&gt;\n\n#include &lt;iostream&gt;\n#include &lt;regex&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\nint main() {\n    vector&lt;string&gt; string_vector = {\"   0  \",\"   0.1   \",\"abc\",\"1 a\",\"2e10\",\"-90e3\",\"1e\",\"e3\",\"6e-1\",\"99e2.5\",\"53.5e93\",\"--6\",\"-+3\",\"95a54e53\"};\n\n    regex expression_two(\"^[+-]?(?:[0-9]*\\\\.[0-9]+|[0-9]+\\\\.[0-9]*|[0-9]+)[Ee][+-]?[0-9]+$|^[+-]?(?:[0-9]*\\\\.[0-9]+|[0-9]+\\\\.[0-9]*|[0-9]+)$|^[+-]?[0-9]+$\");\n\n    for (const auto &amp;input_string: string_vector) {\n        if (std::regex_match(input_string, expression_two))\n            cout &lt;&lt; \"[0-9] Char Class: '\" &lt;&lt; input_string &lt;&lt; \"' is a valid number.\" &lt;&lt; endl;\n    }\n    return 0;\n}\n</code></pre>\n\n<h3>Current Output</h3>\n\n<pre><code>[0-9] Char Class: '2e10' is a valid number.\n[0-9] Char Class: '-90e3' is a valid number.\n[0-9] Char Class: '6e-1' is a valid number.\n[0-9] Char Class: '53.5e93' is a valid number.\n</code></pre>\n\n<h3>Desired Output</h3>\n\n<pre><code>[0-9] Char Class: '  0  ' is a valid number.\n[0-9] Char Class: '  0.1  ' is a valid number.\n[0-9] Char Class: '2e10' is a valid number.\n[0-9] Char Class: '-90e3' is a valid number.\n[0-9] Char Class: '6e-1' is a valid number.\n[0-9] Char Class: '53.5e93' is a valid number.\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 2, "creation_date": 1571241709, "post_id": 58417396, "comment_id": 103177557, "body": "The behaviour is undefined, so you can epect <a href=\"http://catb.org/jargon/html/N/nasal-demons.html\" rel=\"nofollow noreferrer\">nasal demons</a> if you do that."}, {"owner": {"reputation": 2533, "user_id": 2925287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/821554321/picture?type=large", "display_name": "Pierre Emmanuel Lallemant", "link": "https://stackoverflow.com/users/2925287/pierre-emmanuel-lallemant"}, "edited": false, "score": 3, "creation_date": 1571241963, "post_id": 58417396, "comment_id": 103177669, "body": "If you run a program inside an OS, you cannot access memory which wasn&#39;t assigned by your kernel to your program. If you write a kernel module, you should be able to access anywhere in memory, from that kernel module. Etc... It only depends where you program is supposed to be running."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1571243038, "post_id": 58417396, "comment_id": 103178148, "body": "<code>char* c = &quot;my name jeff&quot;;</code> is invalid, it should be <code>const char* c = &quot;my name jeff&quot;;</code>."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1571243597, "post_id": 58417396, "comment_id": 103178426, "body": "The C++ standard imagines an abstract machine, to which the rules of C++ apply.  Compiler makers convert the C++ source to an executable format suitable for your platform.  The parts of the C++ language that explicitly or implicitly declare as undefined behavior means the compiler makers are at liberty to assume those things don&#39;t happen (usually for optimization purposes).  So if your code doesn&#39;t follow the rules, ANYTHING could happen.  Including destroying the planet.  Which is bad."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1571243788, "post_id": 58417396, "comment_id": 103178515, "body": "Code like this is a big reason why protected-mode operating systems work they way they do.  Preventing you from accessing &quot;all memory&quot;.  You tend to get bored looking at the wildly scrolling output before the OS decides to terminate the program because it is trying to read from a non-mapped address."}], "answers": [{"comments": [{"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1571262867, "post_id": 58417796, "comment_id": 103186565, "body": "Even though it should be noted, with the fact that C/C++ are system programming languages, that it is totally not undefined behavior if you set a pointer to an arbitrary address, for example if you want to access registers located there in an embedded system. So, the compiler makers are not really at liberty to prevent such things as it would defeat the purpose."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1571243012, "creation_date": 1571243012, "answer_id": 58417796, "question_id": 58417396, "link": "https://stackoverflow.com/questions/58417396/can-pointers-be-used-for-accessing-any-arbitrary-area-in-memory/58417796#58417796", "title": "Can pointers be used for accessing any arbitrary area in memory?", "body": "<p>From <a href=\"https://eel.is/c++draft/expr#add-4\" rel=\"nofollow noreferrer\">https://eel.is/c++draft/expr#add-4</a></p>\n\n<blockquote>\n  <p>When an expression J that has integral type is added to or subtracted from an expression P of pointer type, the result has the type of P.</p>\n  \n  <p>(4.1) If P evaluates to a null pointer value and J evaluates to 0, the result is a null pointer value.</p>\n  \n  <p>(4.2)\n  Otherwise, if P points to an array element i of an array object x with n elements ([dcl.array]),77 the expressions P + J and J + P (where J has the value j) point to the (possibly-hypothetical) array element \n  i\n  +\n  j\n   of x if \n  0\n  \u2264\n  i\n  +\n  j\n  \u2264\n  n\n   and the expression P - J points to the (possibly-hypothetical) array element \n  i\n  \u2212\n  j\n   of x if \n  0\n  \u2264\n  i\n  \u2212\n  j\n  \u2264\n  n\n  .</p>\n  \n  <p>(4.3)\n  Otherwise, the behavior is undefined.</p>\n</blockquote>\n\n<p>So, with <code>\"my name jeff\"</code> (which is of type <code>const char[13]</code> (with the extra <code>'\\0'</code>)), once you do <code>c[14]</code> you have UB.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10901148, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OmlYkephA2s/AAAAAAAAAAI/AAAAAAAAAE8/15isEPhTzG4/photo.jpg?sz=128", "display_name": "Bino Manjesh", "link": "https://stackoverflow.com/users/10901148/bino-manjesh"}, "edited": false, "score": 0, "creation_date": 1571305163, "post_id": 58417966, "comment_id": 103199796, "body": "Oh I just realised that const char* is basically a string. Thanks"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "reply_to_user": {"reputation": 23, "user_id": 10901148, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OmlYkephA2s/AAAAAAAAAAI/AAAAAAAAAE8/15isEPhTzG4/photo.jpg?sz=128", "display_name": "Bino Manjesh", "link": "https://stackoverflow.com/users/10901148/bino-manjesh"}, "edited": false, "score": 0, "creation_date": 1571331982, "post_id": 58417966, "comment_id": 103215111, "body": "Sort of. There is such a thing as an <a href=\"https://en.cppreference.com/w/cpp/string/basic_string\" rel=\"nofollow noreferrer\"><code>std::string</code></a>, which is what C++ usually thinks of as a string. But a <code>const char *</code> is close. You can read about it more in <a href=\"https://stackoverflow.com/q/1287306/10957435\">this question</a>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "is_accepted": true, "score": 0, "last_activity_date": 1571244311, "last_edit_date": 1571244311, "creation_date": 1571243783, "answer_id": 58417966, "question_id": 58417396, "link": "https://stackoverflow.com/questions/58417396/can-pointers-be-used-for-accessing-any-arbitrary-area-in-memory/58417966#58417966", "title": "Can pointers be used for accessing any arbitrary area in memory?", "body": "<p>First, a note about this line right here:</p>\n\n<pre><code>char* c = \"my name jeff\";\n</code></pre>\n\n<p>In modern C++, <a href=\"https://stackoverflow.com/a/46919323/10957435\">this should be a <code>const</code></a> instead:</p>\n\n<pre><code>const char* c = \"my name jeff\";\n</code></pre>\n\n<hr>\n\n<p>With that out of the way, the answer to your question is yes and no.</p>\n\n<p>Yes in the sense that if you have some sort of pointer, C++ doesn't care what you put in it.</p>\n\n<pre><code>char * pointer = nullptr;\nchar a, b, c;\n\npointer = &amp;a;\npointer = &amp;b;\npointer = &amp;c;\n</code></pre>\n\n<p>The pointer doesn't care what address is stored in it. It is arbitrary in that sense. As long as it is the same type, you're fine.</p>\n\n<p>You can even do pointer arithmetic like this:</p>\n\n<pre><code>*(pointer + 1) = 1;\n*(pointer + 2) = 2;\n*(pointer + i) = i;\n</code></pre>\n\n<p>In most cases, this will usually at least compile and probably run. In <strong>theory</strong>, you could use this type of arithmetic to access any given address and see what data is stored there.</p>\n\n<p><strong>However</strong>, in practice, the answer is a big no. That is because <a href=\"https://stackoverflow.com/a/27881098/10957435\">accessing unallocated memory is undefined behavior in C++</a>. If you're unaware, <a href=\"https://stackoverflow.com/q/32132574/10957435\">undefined behavior allows anything to happen</a>, including crashing or printing weird characters.</p>\n\n<p>So, if you have some array like this:</p>\n\n<pre><code>int arr[4] = {1,2,3,4};\nint * pointer = arr;\n\nstd::cout &lt;&lt; *(pointer + 7);\n</code></pre>\n\n<p>This is undefined behavior because only <code>pointer + 3</code> is guaranteed to have allocated memory in it.</p>\n\n<p>So, in short: Yes, you can theoretically reach any address you want with pointer arithmetic, but you can only access memory that has been allocated safely. So in practice, not really.</p>\n"}], "owner": {"reputation": 23, "user_id": 10901148, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OmlYkephA2s/AAAAAAAAAAI/AAAAAAAAAE8/15isEPhTzG4/photo.jpg?sz=128", "display_name": "Bino Manjesh", "link": "https://stackoverflow.com/users/10901148/bino-manjesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 58417966, "answer_count": 2, "score": 1, "last_activity_date": 1571244311, "creation_date": 1571241564, "last_edit_date": 1571241696, "question_id": 58417396, "link": "https://stackoverflow.com/questions/58417396/can-pointers-be-used-for-accessing-any-arbitrary-area-in-memory", "title": "Can pointers be used for accessing any arbitrary area in memory?", "body": "<p>I am extremely new to C++ and pointers.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main() {\n    char* c = \"my name jeff\";\n    int i = 0;\n    while (true) {\n        cout &lt;&lt; *(c + i++);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The output is \"my name jeff\" followed by a lot of random characters, occasionally making sense. Am I actually accessing memory in my computer ? Why can initialize a pointer from a string ?</p>\n"}, {"tags": ["c++", "c", "linux"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1571241466, "post_id": 58417324, "comment_id": 103177450, "body": "Compiling without errors most certainly does not mean that they&#39;re compatible... but yes, most headers that <i>can</i> be made compatible <i>are so</i> and those that aren&#39;t probably wouldn&#39;t become any better by wrapping them in <code>extern &quot;C&quot; {}</code>"}, {"owner": {"reputation": 1395, "user_id": 3808426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6388b9d4ea9d6e02525fa212aa9d817d?s=128&d=identicon&r=PG&f=1", "display_name": "Demosthenes", "link": "https://stackoverflow.com/users/3808426/demosthenes"}, "edited": false, "score": 2, "creation_date": 1571241758, "post_id": 58417324, "comment_id": 103177576, "body": "It&#39;s not a strict duplicate, but this is similar to <a href=\"https://stackoverflow.com/questions/8087438/do-i-need-an-extern-c-block-to-include-standard-c-headers\" title=\"do i need an extern c block to include standard c headers\">stackoverflow.com/questions/8087438/&hellip;</a>, which might give some insight."}, {"owner": {"reputation": 4425, "user_id": 5983841, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/GHJxG.jpg?s=128&g=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/5983841/rick"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1571242002, "post_id": 58417324, "comment_id": 103177688, "body": "@AnttiHaapala Then what&#39;s the <b>best practice</b> I should have? Like I said, check those marcos first and then decide?"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1571242037, "post_id": 58417324, "comment_id": 103177710, "body": "All the POSIX headers will be fine. And for <code>GNU&#47;Linux</code> all system headers will be <code>C++</code> friendly. Third party libraries you will need to check. (eg <code>libffmpeg</code>)"}, {"owner": {"reputation": 4425, "user_id": 5983841, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/GHJxG.jpg?s=128&g=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/5983841/rick"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1571242235, "post_id": 58417324, "comment_id": 103177805, "body": "@Galik Ok thanks. But to be curious, where did you know that &quot;for GNU/Linux all system headers will be C++ friendly.&quot;? I mean.. I was told by someone.. And I should have known that from the Internet. I&#39;ve almost finished reading <i>APUE</i> and it doesn&#39;t mention it at all!"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1571242335, "post_id": 58417324, "comment_id": 103177855, "body": "@Rick I am currently looking for documentation. But the <code>GNU</code> project that wrote the <code>GNU</code> operating system that runs on most Linux (desktop) implementations also wrote the <code>GNU C&#47;C++</code> compiler and their headers are naturally <code>C++</code> friendly."}, {"owner": {"reputation": 4425, "user_id": 5983841, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/GHJxG.jpg?s=128&g=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/5983841/rick"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1571242704, "post_id": 58417324, "comment_id": 103178013, "body": "@Galik That deduction would be pretty hard for a newbie... I can&#39;t just persuade myself on everything by guessing. ;D (I know you are looking for documenation, thank you )"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1571243283, "post_id": 58417324, "comment_id": 103178265, "body": "@Rick Yes I see that. I am also pretty sure POSIX specifies that their headers should be C++ friendly (GNU OS is a POSIX implementation) but I&#39;m having trouble proving it :)"}, {"owner": {"reputation": 4425, "user_id": 5983841, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/GHJxG.jpg?s=128&g=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/5983841/rick"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1571243475, "post_id": 58417324, "comment_id": 103178376, "body": "@Galik Ok got it. :) Told by 2 experts then a newbie can only take it as a yes. :). But is that true: &quot;You can actually break things doing that as some have C++ only exports&quot;, if I add extra <code>extern &quot;C&quot;</code> block? I saw opposite opinion here.. <a href=\"https://stackoverflow.com/a/8087530/5983841\">stackoverflow.com/a/8087530/5983841</a>"}, {"owner": {"reputation": 4425, "user_id": 5983841, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/GHJxG.jpg?s=128&g=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/5983841/rick"}, "reply_to_user": {"reputation": 1395, "user_id": 3808426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6388b9d4ea9d6e02525fa212aa9d817d?s=128&d=identicon&r=PG&f=1", "display_name": "Demosthenes", "link": "https://stackoverflow.com/users/3808426/demosthenes"}, "edited": false, "score": 0, "creation_date": 1571243708, "post_id": 58417324, "comment_id": 103178482, "body": "@Demosthenes Thank you that&#39;s helpful."}], "owner": {"reputation": 4425, "user_id": 5983841, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/GHJxG.jpg?s=128&g=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/5983841/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1571244222, "creation_date": 1571241278, "last_edit_date": 1571244222, "question_id": 58417324, "link": "https://stackoverflow.com/questions/58417324/are-most-linux-system-headers-c-compatiable", "title": "Are most linux system headers C++ compatiable?", "body": "<p>Are most linux system headers/API C++ compatiable?</p>\n\n<p>Today I was trying to do something like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nextern \"C\" {\n#include &lt;sys/socket.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netdb.h&gt;\n}\n\n\nint main() {\n  //socket exercise\n}\n</code></pre>\n\n<p>Then I was told by a friend:</p>\n\n<blockquote>\n  <p>shouldn't even need to do that (<strong>the extra extern \"C\" {}</strong>) in most cases as they are system headers.<br>\n  try it first and then worry about it.<br>\n  don't assume system headers aren't compatible.<br>\n  You can actually break things doing that as some have C++ only exports</p>\n</blockquote>\n\n<p>Bu then I asked: </p>\n\n<blockquote>\n  <p>If I include a C library function and compile without error. Does it ensure that the library I included is C++ compatiable and then I can safely use it?</p>\n</blockquote>\n\n<p>The answer is: </p>\n\n<blockquote>\n  <p>No, there's no checking.</p>\n</blockquote>\n\n<hr>\n\n<p>So try it first --> no error --> doesn't ensure that it's C++ compatiable.</p>\n\n<p>Then what should I do for example with Linux system headers? Because I can't simply wrap the system headers with an extra <code>extern \"C\" {}</code> statement (\"I might actually break things doing that as some have C++ only exports\").</p>\n\n<p>So I need to check if there are <code>__BEGIN_DECLS</code> and <code>__END_DECLS</code> MARCOS defined in the system header file for each header file I use? If not, then I need to wrap it with <code>extern \"C\" {}</code>? Otherwise I just include it directly?</p>\n\n<p>FYI, <code>__BEGIN_DECLS</code> and <code>__END_DECLS</code> are defined as: </p>\n\n<pre><code># define __BEGIN_DECLS  extern \"C\" {\n# define __END_DECLS    }\n</code></pre>\n"}, {"tags": ["c++", "arrays", "element", "digits"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 4, "creation_date": 1571241013, "post_id": 58417184, "comment_id": 103177225, "body": "<a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>.  Honestly, a program like yours requires you to learn how to use a debugger.  Also, if <code>6 - 5</code> is giving the problem, then you should hard-code <code>6</code> and <code>5</code> into the program and skip the <code>argc</code> and <code>argv</code> stuff and hard-code the <code>op</code> to be subtraction."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1571241129, "post_id": 58417184, "comment_id": 103177279, "body": "<b><i>im very stumped to why this is.</i></b> Use a debugger to step through your algorithm 1 line at a time. Look at the variables at each step."}], "answers": [{"tags": [], "owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "is_accepted": false, "score": 0, "last_activity_date": 1571247211, "creation_date": 1571247211, "answer_id": 58418815, "question_id": 58417184, "link": "https://stackoverflow.com/questions/58417184/bigint-mutliplication-and-subtraction-error/58418815#58418815", "title": "BigInt mutliplication and subtraction error", "body": "<p>It seems I found your problem - you are not cleaning after yourself. That is, each time you enter a new number it also uses some of the old number.</p>\n\n<p>There are several possible solutions to this problem. The simplest one (with some code fix-ups) is as follows:</p>\n\n<p>Create a method <code>clear</code> somewhere in your class:</p>\n\n<pre><code>void Bigint::clear()\n{\n    for (int i = DIGITS-1; i &gt;= 0; --i)\n        digits_[i] = 0;\n}\n</code></pre>\n\n<p>Erase the default constructor (this is optional but he's redundant), and change the other one to this:</p>\n\n<pre><code>Bigint::Bigint(int radix = 10) : radix{radix}\n{\n    clear();\n}\n</code></pre>\n\n<p>And add the following at the start of your input operator:</p>\n\n<pre><code>istream&amp; operator&gt;&gt; (istream&amp; in, Bigint&amp; n)\n{\n    clear(); //This is the important one!!!!\n\n    string s;\n    if (in &gt;&gt; s) {\n    ...\n    ...\n}\n</code></pre>\n\n<p>There are other possible solutions as well:</p>\n\n<ul>\n<li><p>You could add a member <code>int length;</code> to your class. You already have this length in your input operator, you just need to keep it and use it in all your calculations.</p></li>\n<li><p>Even better, change your <code>digits_</code> to <code>std::vector&lt;int&gt; digits_;</code>. This will allow you to get rid of the <code>clear</code> function thus leaving your constructor empty (only with the member initialization). You would just have to call <code>digits_.clear();</code> at the start of your input operator. And use <code>digits_.push_back(...);</code> instead of fiddling with indexes.</p></li>\n</ul>\n\n<p>But the most correct solution (though changing to <code>std::vector&lt;int&gt;</code> should be done anyhow) is to just erase your input operator and change your <code>Bigint::Bigint</code> to accept a string. That is:</p>\n\n<pre><code>Bigint::Bigint(std::string s, int radix = 10) : radix{radix}\n{\n    const int length = s.length();\n    for (int i = 0; (i &lt; DIGITS) &amp;&amp; (i &lt; length); ++i)\n        n.digits_[i] = int(s[length()-1 - i] - '0');\n}\n</code></pre>\n\n<p>After that, in your main, you just do this:</p>\n\n<pre><code>void main(...)\n{\n    ....\n\n    char op;\n    std::string s1, s2;\n\n    while (cin &gt;&gt; s1 &gt;&gt; op &gt;&gt; s2)\n    {\n        Bigint n1 {s1, radix};\n        Bigint n2 {s2, radix};\n\n        switch (op) {\n        .....\n        }\n    }\n}\n</code></pre>\n\n<p>This has the following benefits:</p>\n\n<ul>\n<li>The strings are always cleared before input. See here: <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/operator_ltltgtgt\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/string/basic_string/operator_ltltgtgt</a></li>\n<li>The <code>Bigint</code> is always created fresh.</li>\n<li>You can create <code>Bigint</code>s from any string, not just <code>std::cin</code>.</li>\n</ul>\n\n<p>I would strongly consider replacing your <code>digits_</code> with <code>std::vector&lt;int&gt;</code>. This will have the benefit of accepting number of <strong>any</strong> size, since the vector can grow as large as you need it. This would also make your string-to-int conversion code much simpler. And make you <em>multiply</em> simpler since you can easily append zeroes at the end and beginning of the vector with a simple operation. And would avoid a lot of other mistakes. Just change it to <code>std::vector&lt;int&gt;</code>! ;-)</p>\n\n<p>Also, please note that <code>using namespace std;</code> is bad practice: <a href=\"https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-bad-practice\">Why is &quot;using namespace std;&quot; considered bad practice?</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11290372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5a06ad0d20ba52f774c3bef54949d8f?s=128&d=identicon&r=PG&f=1", "display_name": "J.K", "link": "https://stackoverflow.com/users/11290372/j-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1571247211, "creation_date": 1571240787, "question_id": 58417184, "link": "https://stackoverflow.com/questions/58417184/bigint-mutliplication-and-subtraction-error", "title": "BigInt mutliplication and subtraction error", "body": "<p>I'm assignment I have to create a calculator that works with big integers up to 256 characters in length. Im getting error being unable to multiple as well as weird problems how some subtraction numbers work such as 23456 - 13141= 10315 however any other subtraction such as 6 - 5 doesn't work. im very stumped to why this is.</p>\n\n<p>Full code below</p>\n\n<pre><code>#include &lt;iostream&gt;   \n#include &lt;string&gt; \n#include \"Bigint.h\" \n\nusing namespace std; \n\nBigint::Bigint() \n{\n    for (int i = DIGITS-1; i &gt;= 0; --i) {\n        digits_[i] = 0;\n    }\n    radix = 10;\n}\n\nBigint::Bigint(int r)  \n{\n    for (int i = DIGITS-1; i &gt;= 0; --i) {\n        digits_[i] = 0;\n    }\n    radix = r;\n}\n\nostream&amp; operator&lt;&lt; (ostream&amp; out, const Bigint&amp; n) \n{\n    string s = \"\";\n    int leadingZeros = 0;\n\n    for (int i = DIGITS-1; i &gt;= 0 ; --i) { \n\n        if(n.digits_[i] != 0){      \n            leadingZeros = 1;\n        }\n\n        if(leadingZeros == 1){\n            s += char(n.digits_[i] + '0'); \n        }\n    }\n    return out &lt;&lt; s;\n}\n\nistream&amp; operator&gt;&gt; (istream&amp; in, Bigint&amp; n)\n{\n\n    string s;\n    if (in &gt;&gt; s) {\n\n        int length = s.length(); \n        int i;\n        for (i = 0; i &lt; DIGITS &amp;&amp; i &lt; length; ++i) {\n            n.digits_[i] = int(s[length-1 - i] - '0'); \n        }\n    }\n    return in;\n}\n\nBigint operator+ (const Bigint&amp; n1, const Bigint&amp; n2)\n{\n    Bigint add;\n    int carry = 0, sum = 0;\n\n    for(int i=0; i &lt; DIGITS; ++i){ \n        sum = n1.digits_[i] + n2.digits_[i] + carry; \n        add.digits_[i] = sum % 10;\n        carry = sum / 10;\n    }\n    return add;\n}\n\nBigint operator- (const Bigint&amp; n1, const Bigint&amp; n2) \n{\n    Bigint sub;\n    int carry = 0; \n    for (int i=0; i&lt; DIGITS; i++) \n    { \n\n        int val = n1.digits_[i] - n2.digits_[i] -carry;  \n\n        if (val &lt; 0) \n        { \n            val += 10; \n            carry = 1; \n        } \n        else\n            carry = 0; \n\n        sub.digits_[i] = val;\n    } \n    return sub;\n}\n\nBigint Bigint :: multiplyBigint(const Bigint&amp; num, const int n, int count){ \n\n    Bigint result;\n    int carry =0;\n\n    for(int i=0; i&lt; DIGITS; ++i){\n        int val = (num.digits_[i] * n) + carry;\n        result.digits_[i+count] = val % 10;\n        carry = val / 10; \n    }\n\n    return result;\n}\n\nBigint operator* (const Bigint&amp; n1, const Bigint&amp; n2)\n{\n    Bigint multiply;\n    Bigint temp;\n\n    int count =0;\n\n    for(int i=0; i&lt; DIGITS; ++i){\n        temp = Bigint :: multiplyBigint(n1, n2.digits_[i], count);\n        count++;\n        multiply = multiply + temp;\n    }\n\n    return multiply;\n}\n\nBigint operator/ (const Bigint&amp; n1, const Bigint&amp; n2)\n{\n    Bigint divide;\n    Bigint temp = n1;\n\n    while(temp &gt; n2){\n        divide = divide + 1;\n        temp = temp - n2;\n    }\n\n    return divide; \n}\n\nBigint operator+ (const Bigint&amp; n1, int n2)\n{\n    Bigint add;\n    int carry = 0, sum = 0;\n\n    for(int i=0; i &lt; DIGITS; ++i){\n        sum = n1.digits_[i] + (n2 % 10) + carry;\n        n2 = n2 / 10;\n        add.digits_[i] = sum % 10;\n        carry = sum / 10;\n    }\n    return add;\n}\n\nbool operator&gt; (const Bigint&amp; n1, const Bigint&amp; n2){\n\n    for(int i= DIGITS - 1; i &gt;= 0; --i){\n        if(n1.digits_[i] &gt; n2.digits_[i])\n            return true;\n    }\n    return false;\n}\n</code></pre>\n\n<p>Header file</p>\n\n<pre><code>#ifndef BIGINT_H_ //This checks to whether the given token has been defined somewhere else in the file.\n#define BIGINT_H_\n\n#define DIGITS 256 //increases the array size to 256 digits.\n\nclass Bigint\n{\n  public: // this makes the members of the public accessible from anywhere in the project.\n\n    /**\n     * Creates a Bigint initialised to 0.\n     */\n    Bigint(); \n    Bigint(int r);\n\n    /**\n     * Inserts n into stream or extracts n from stream.\n     */\n    friend std::ostream&amp; operator&lt;&lt; (std::ostream &amp;out, const Bigint&amp; n);\n    friend std::istream&amp; operator&gt;&gt; (std::istream &amp;in, Bigint&amp; n);\n\n    /**\n     * Returns the sum, difference, product, or quotient of n1 and n2 and compares them.\n     */\n    friend Bigint operator+ (const Bigint&amp; n1, const Bigint&amp; n2);\n    friend Bigint operator- (const Bigint&amp; n1, const Bigint&amp; n2);\n    friend Bigint operator* (const Bigint&amp; n1, const Bigint&amp; n2);\n    friend Bigint operator/ (const Bigint&amp; n1, const Bigint&amp; n2);\n\n    friend Bigint operator+ (const Bigint&amp; n1, int n2);\n    friend bool operator&gt; (const Bigint&amp; n1, const Bigint&amp; n2);\n\n  private: //making this only accessible within other members of this same class.\n    int digits_[DIGITS];\n    int radix;\n    static Bigint multiplyBigint(const Bigint&amp; num, const int n, int count);\n};\n\n#endif // BIGINT_H_\n</code></pre>\n\n<p>Main.cpp</p>\n\n<pre><code>#include &lt;iostream&gt; //provides basic input and output services such as char.\n#include \"Bigint.h\" //provides access and link to header file.\n\nusing namespace std;\n\nint findRadix(string value){ //uses the Radix sort alogrithm to sort each value.\n\n    if(value.length() == 3){\n        if(value[0] == '-' &amp;&amp; value[1] == 'r'){\n            if(value[2] &gt;= '2' &amp;&amp; value[2] &lt;= '9')\n                return value[2] - '0';\n            else if(value[2] &gt;= 'A' &amp;&amp; value[2] &lt;= 'Z')\n                return (value[2] - 'A') + 10;\n        }\n    }\n\n    return 10;\n}\n\nint main(int argc, char *argv[]) \n{\n    int radix;\n\n    if(argc ==2){\n        radix = findRadix(argv[1]);\n    }\n\n\n    Bigint n1(radix), n2(radix); //This compares n1 and n2 to each other to give a result.\n    char op;\n\n    while (cin &gt;&gt; n1 &gt;&gt; op &gt;&gt; n2) {\n        switch (op) {\n        case '+' :\n            cout &lt;&lt; n1 + n2 &lt;&lt; endl;\n            break;\n        case '-' :\n            cout &lt;&lt; n1 - n2 &lt;&lt; endl;\n            break;\n        case '*' :\n            cout &lt;&lt; n1 * n2 &lt;&lt; endl;\n            break;\n        case '/' :\n            cout &lt;&lt; n1 / n2 &lt;&lt; endl;\n            break;\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "memory-management", "stl", "language-lawyer"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1571240877, "post_id": 58417141, "comment_id": 103177155, "body": "The advantage of this is your buffer is already null terminated.  This lets you skip steps as long as you always maintain the empty part of the string is zero&#39;d."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 2, "creation_date": 1571240879, "post_id": 58417141, "comment_id": 103177157, "body": "If you&#39;re only concerned of the memset, then you can use <code>new (data+i) char;</code> instead."}, {"owner": {"reputation": 1127, "user_id": 1796858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1b4f442048641cf0656ab4cdc4b6ec?s=128&d=identicon&r=PG", "display_name": "Owl", "link": "https://stackoverflow.com/users/1796858/owl"}, "edited": false, "score": 0, "creation_date": 1571241075, "post_id": 58417141, "comment_id": 103177255, "body": "Please note that &quot;copy_array&quot; can be replaced entirely by the library function strdup()"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 1127, "user_id": 1796858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1b4f442048641cf0656ab4cdc4b6ec?s=128&d=identicon&r=PG", "display_name": "Owl", "link": "https://stackoverflow.com/users/1796858/owl"}, "edited": false, "score": 1, "creation_date": 1571241132, "post_id": 58417141, "comment_id": 103177282, "body": "@Owl Except <code>strdup</code> does not support the use of an allocator."}, {"owner": {"reputation": 4715, "user_id": 92560, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a8a3293b1f1cedb899cb8c13f6c356f4?s=128&d=identicon&r=PG", "display_name": "Benno", "link": "https://stackoverflow.com/users/92560/benno"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1571241192, "post_id": 58417141, "comment_id": 103177316, "body": "@eerorika I&#39;m mainly concerned about the legality, the optimization part was just an interesting observation (also TIL, thanks for the comment!)"}, {"owner": {"reputation": 730, "user_id": 5096416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cc4dbd84e88180775789317cf72125f?s=128&d=identicon&r=PG&f=1", "display_name": "Lawrence", "link": "https://stackoverflow.com/users/5096416/lawrence"}, "edited": false, "score": 0, "creation_date": 1571249749, "post_id": 58417141, "comment_id": 103181156, "body": "<a href=\"https://stackoverflow.com/questions/42294487/managing-trivial-types\" title=\"managing trivial types\">stackoverflow.com/questions/42294487/managing-trivial-types</a>"}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1571267428, "post_id": 58417141, "comment_id": 103187749, "body": "In the first place, who told you you got an array from <code>alloc.allocate(n)</code>?"}, {"owner": {"reputation": 4715, "user_id": 92560, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a8a3293b1f1cedb899cb8c13f6c356f4?s=128&d=identicon&r=PG", "display_name": "Benno", "link": "https://stackoverflow.com/users/92560/benno"}, "reply_to_user": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1571316583, "post_id": 58417141, "comment_id": 103206586, "body": "@LanguageLawyer I&#39;m not sure I understand your question? The function <code>std::allocator&lt;T&gt;::allocate()</code> is defined to return a pointer to the initial element of an array of storage of size <code>n*sizeof(T)</code>, suitably aligned."}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1571344979, "post_id": 58417141, "comment_id": 103220584, "body": "@Benno OK. But do you know what is &quot;array of storage&quot;? I know only about arrays of <i>objects</i>."}, {"owner": {"reputation": 4715, "user_id": 92560, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a8a3293b1f1cedb899cb8c13f6c356f4?s=128&d=identicon&r=PG", "display_name": "Benno", "link": "https://stackoverflow.com/users/92560/benno"}, "reply_to_user": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1571401401, "post_id": 58417141, "comment_id": 103239277, "body": "@LanguageLawyer Feel free to file a defect report to the standards committee if you think the &quot;array of storage&quot; wording is incorrect. But I don&#39;t really see a problem, if you can have &quot;storage&quot; why shouldnt you be able to have an &quot;array of storage&quot;."}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1571509338, "post_id": 58417141, "comment_id": 103267973, "body": "<i>But I don&#39;t really see a problem</i> OK."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 2, "last_activity_date": 1571242074, "last_edit_date": 1592644375, "creation_date": 1571242074, "answer_id": 58417534, "question_id": 58417141, "link": "https://stackoverflow.com/questions/58417141/is-it-required-to-explicitly-construct-each-member-of-a-char-array/58417534#58417534", "title": "Is it required to explicitly construct each member of a char array?", "body": "<blockquote>\n<p>Is the placement-new initialization marked by (1) necessary to prevent the program from having undefined behaviour.</p>\n</blockquote>\n<p>Technically yes, as far as I can tell.</p>\n<blockquote>\n<p>[basic.life]</p>\n<p>The lifetime of an object of type T begins when:</p>\n<ul>\n<li>storage with the proper alignment and size for type T is obtained, and</li>\n<li>its <strong>initialization (if any) is complete (including vacuous initialization)</strong> ([dcl.init]),</li>\n</ul>\n<p>... before the lifetime of an object has started but after the storage which the object will occupy has been allocated or, after the lifetime of an object has ended and before the storage which the object occupied is reused or released, any glvalue that refers to the original object may be used but only in limited ways. ... The program has <strong>undefined behavior</strong> if:</p>\n<ul>\n<li>the <strong>glvalue is used to access the object</strong>, or</li>\n<li>...</li>\n</ul>\n</blockquote>\n<hr />\n<blockquote>\n<p>Note that this is not being optimized away</p>\n</blockquote>\n<p>Instead of value initialising the chars, you could default initialise. Then their value would be left indeterminate until the assignment, and thus there should be no need for memset. Also, there is a standard function for this, so there is no need to write the loop:</p>\n<pre><code>std::uninitialized_default_construct(data, data + n);\n</code></pre>\n"}], "owner": {"reputation": 4715, "user_id": 92560, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a8a3293b1f1cedb899cb8c13f6c356f4?s=128&d=identicon&r=PG", "display_name": "Benno", "link": "https://stackoverflow.com/users/92560/benno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 58417534, "answer_count": 1, "score": 3, "last_activity_date": 1571243976, "creation_date": 1571240635, "last_edit_date": 1571243976, "question_id": 58417141, "link": "https://stackoverflow.com/questions/58417141/is-it-required-to-explicitly-construct-each-member-of-a-char-array", "title": "Is it required to explicitly construct each member of a char array?", "body": "<p>Consider the following code:</p>\n\n<pre><code>#include &lt;memory&gt;\n\ntemplate&lt;typename Allocator&gt;\nchar* allocate_array(Allocator alloc, size_t n)\n{\n    static_assert(std::is_same&lt;typename Allocator::value_type, char&gt;::value);\n    char* data = alloc.allocate(n);\n\n    // (1)\n    for (size_t i=0; i&lt;n; ++i) {\n        new (data+i) char();\n    }\n\n    return data;\n}\n\nchar* copy_array(size_t n, const char* original)\n{\n    char* copy = allocate_array(std::allocator&lt;char&gt;(), n);\n    // (2)\n    for (size_t i=0; i&lt;n; ++i) {\n        copy[i] = original[i];\n    }\n    return copy;\n}\n</code></pre>\n\n<p>Is the placement-new initialization marked by <code>(1)</code> necessary to prevent the program from having undefined behaviour, even if every char is guaranteed to be written to in <code>(2)</code> before it can be read? Or can it be safely removed?</p>\n\n<p>Note that this is not being optimized away, even at <code>-O3</code> I see both gcc and clang generating subsequent calls to both <code>memset()</code> and <code>memcpy()</code>.</p>\n"}, {"tags": ["c++", "bash", "signals"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 2, "creation_date": 1571239835, "post_id": 58416798, "comment_id": 103176597, "body": "You&#39;re not sending a signal to the bash script.  <code>raise</code> sends the signal to the calling thread."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1571239907, "post_id": 58416798, "comment_id": 103176628, "body": "In other words, <code>signalTest</code> is sending a signal to itself and terminating."}], "answers": [{"comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 33, "user_id": 12227531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89d4d72a149422fc21aec06a45802709?s=128&d=identicon&r=PG&f=1", "display_name": "nicholishiell", "link": "https://stackoverflow.com/users/12227531/nicholishiell"}, "edited": false, "score": 1, "creation_date": 1571240140, "post_id": 58416937, "comment_id": 103176759, "body": "@nicholishiell Read up <a href=\"http://man7.org/linux/man-pages/man7/signal.7.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man7/signal.7.html</a>"}, {"owner": {"reputation": 33, "user_id": 12227531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89d4d72a149422fc21aec06a45802709?s=128&d=identicon&r=PG&f=1", "display_name": "nicholishiell", "link": "https://stackoverflow.com/users/12227531/nicholishiell"}, "edited": false, "score": 0, "creation_date": 1571241156, "post_id": 58416937, "comment_id": 103177297, "body": "Okay so raise only signals the calling thread NOT the process? So my c++ code was signalling nothing. Where are kill(getppid(), SIGUSR1) sends the signal to the parent process (in this case the bash script). Am I understanding this correctly?"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 33, "user_id": 12227531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89d4d72a149422fc21aec06a45802709?s=128&d=identicon&r=PG&f=1", "display_name": "nicholishiell", "link": "https://stackoverflow.com/users/12227531/nicholishiell"}, "edited": false, "score": 0, "creation_date": 1571241472, "post_id": 58416937, "comment_id": 103177454, "body": "@nicholishiell You are right. <code>raise</code> sends the signal to the calling thread/process. On Linux, the process id is the id of its first thread."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1571240168, "last_edit_date": 1571240168, "creation_date": 1571239966, "answer_id": 58416937, "question_id": 58416798, "link": "https://stackoverflow.com/questions/58416798/handling-signals-from-child-process-in-bash-scripts/58416937#58416937", "title": "Handling signals from child process in Bash Scripts", "body": "<p><a href=\"http://man7.org/linux/man-pages/man3/raise.3.html\" rel=\"nofollow noreferrer\"><code>raise</code></a> sends the signal to the calling thread.</p>\n\n<p><a href=\"http://man7.org/linux/man-pages/man2/kill.2.html\" rel=\"nofollow noreferrer\"><code>kill</code></a> sends a signal to the specified process or thread. </p>\n\n<p>To send the signal to the parent process, instead of </p>\n\n<pre><code>raise(SIGUSR1);\n</code></pre>\n\n<p>do</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n// ...\nkill(getppid(), SIGUSR1);\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12227531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89d4d72a149422fc21aec06a45802709?s=128&d=identicon&r=PG&f=1", "display_name": "nicholishiell", "link": "https://stackoverflow.com/users/12227531/nicholishiell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 1, "accepted_answer_id": 58416937, "answer_count": 1, "score": 3, "last_activity_date": 1571240168, "creation_date": 1571239499, "question_id": 58416798, "link": "https://stackoverflow.com/questions/58416798/handling-signals-from-child-process-in-bash-scripts", "title": "Handling signals from child process in Bash Scripts", "body": "<p>I am trying to trap a signal raised by a child process. However, my trap callback function is never called. I have the following test code</p>\n\n<pre><code>#include &lt;csignal&gt;\n#include &lt;iostream&gt;\n#include &lt;thread&gt;\n#include &lt;chrono&gt;\n\nint main()\n{\n    std::this_thread::sleep_for (std::chrono::seconds(5));\n\n    std::cout &lt;&lt; \"&gt;&gt;&gt; Signal Sent!\" &lt;&lt; std::endl;\n    raise(SIGUSR1);\n\n    return 0;\n}\n</code></pre>\n\n<p>And this bash script</p>\n\n<pre><code>set -bm\nset -e \n\nKEEP_GOING=true\n\nsigusr1()\n{\n    echo \"SIGUSR1 Recieved\"\n    KEEP_GOING=false\n}\n\ntrap sigusr1 SIGUSR1\n\n./signalTest  &amp;\n\nwhile $KEEP_GOING ; do\n    sleep 1s\n    echo \"Waiting for signal\"\ndone\n</code></pre>\n\n<p>When I run it I get the following </p>\n\n<pre><code>Waiting for signal\nWaiting for signal\nWaiting for signal\nWaiting for signal\n&gt;&gt;&gt; Signal Sent!\n[1]+  User defined signal 1   ./signalTest\nWaiting for signal\nWaiting for signal\nWaiting for signal\nWaiting for signal\nWaiting for signal\n^C\n</code></pre>\n\n<p>From the output I see that the signal is in fact sent, and in some capacity received. However the callback function in my trap is not executed. </p>\n\n<p>Any thoughts?</p>\n"}, {"tags": ["c++", "encryption"], "comments": [{"owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "edited": false, "score": 0, "creation_date": 1571239765, "post_id": 58416543, "comment_id": 103176566, "body": "In <code>EVP_CipherFinal_ex(ctx, &amp;encrypted[actual_size], &amp;final_size);         actual_size += final_size;</code> Does <code>actual_size</code> get updated to be larger than 0? If so, you&#39;re passing your output buffer at a position that is far from the beginning of the data. I&#39;m only assuming that <code>actual_size</code> gets changed in <code>EVP_CipherUpdate</code> to have the &quot;actual size&quot; of the data; I&#39;m not not sure how the cipher functions you&#39;re using work."}, {"owner": {"reputation": 31747, "user_id": 499448, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/957083d526c5fd7c54c5b89aece0b76a?s=128&d=identicon&r=PG", "display_name": "Boardy", "link": "https://stackoverflow.com/users/499448/boardy"}, "reply_to_user": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "edited": false, "score": 0, "creation_date": 1571240265, "post_id": 58416543, "comment_id": 103176833, "body": "<code>actual_size</code> is initially 0 and then when <code>EVP_CipherUpdate</code> receives actual_size as a pointer it becomes 752, then after <code>EVP_CipherFinal_ex</code> is called <code>actual_size</code> becomes 768. Not sure what you mean though as <code>actual_size</code> is only used to resize the vector, its not used again as part of the output?"}, {"owner": {"reputation": 2065, "user_id": 85696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9d5b650b104a98538d5aab145ea192d?s=128&d=identicon&r=PG", "display_name": "danadam", "link": "https://stackoverflow.com/users/85696/danadam"}, "edited": false, "score": 1, "creation_date": 1571250129, "post_id": 58416543, "comment_id": 103181326, "body": "You are creating <code>encryptedString</code> from <code>char*</code> containing encrypted data. Is it possible that by chance the encrypted data has <code>\\0</code> byte at position 17 and you get truncated string as a result?"}, {"owner": {"reputation": 31747, "user_id": 499448, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/957083d526c5fd7c54c5b89aece0b76a?s=128&d=identicon&r=PG", "display_name": "Boardy", "link": "https://stackoverflow.com/users/499448/boardy"}, "edited": false, "score": 0, "creation_date": 1571251440, "post_id": 58416543, "comment_id": 103181937, "body": "It doesn&#39;t look like it from looking at the contents when debugging"}, {"owner": {"reputation": 31747, "user_id": 499448, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/957083d526c5fd7c54c5b89aece0b76a?s=128&d=identicon&r=PG", "display_name": "Boardy", "link": "https://stackoverflow.com/users/499448/boardy"}, "edited": false, "score": 0, "creation_date": 1571251672, "post_id": 58416543, "comment_id": 103182033, "body": "I think I&#39;ve found a way around it so have added an answer. Thanks for the suggestions, not sure why my work around works though"}], "answers": [{"comments": [{"owner": {"reputation": 2065, "user_id": 85696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9d5b650b104a98538d5aab145ea192d?s=128&d=identicon&r=PG", "display_name": "danadam", "link": "https://stackoverflow.com/users/85696/danadam"}, "edited": false, "score": 1, "creation_date": 1571252775, "post_id": 58419876, "comment_id": 103182496, "body": "How about <code>string encryptedString(buff_str, index);</code>? Or directly from <code>encrypted</code> if you don&#39;t mind casting: <code>string encryptedString(reinterpret_cast&lt;const char*&gt;(&amp;encrypted[0]), encrypted.size());</code>"}], "tags": [], "owner": {"reputation": 31747, "user_id": 499448, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/957083d526c5fd7c54c5b89aece0b76a?s=128&d=identicon&r=PG", "display_name": "Boardy", "link": "https://stackoverflow.com/users/499448/boardy"}, "is_accepted": true, "score": 0, "last_activity_date": 1571251652, "creation_date": 1571251652, "answer_id": 58419876, "question_id": 58416543, "link": "https://stackoverflow.com/questions/58416543/c-aes-encryption-getting-truncated-to-16-characters/58419876#58419876", "title": "C++ AES Encryption getting truncated to 16 characters", "body": "<p>I think I've figured the problem, although not 100% sure why this works and the original way doesn't. </p>\n\n<p>I don't believe its a null byte from looking at the content of buffer when debugging but I've changed it to the following which seems to resolve it. </p>\n\n<p>Instead of </p>\n\n<pre><code>string encryptedString = buff_str;\n</code></pre>\n\n<p>I have changed it to the following</p>\n\n<pre><code>int i = 0;\nstringstream encryptedStringStream;\n\nfor (i = 0; i &lt; index; i++)\n{\n    encryptedStringStream &lt;&lt; buff_str[i];\n}\nstring encryptedString = encryptedStringStream.str();\n</code></pre>\n"}], "owner": {"reputation": 31747, "user_id": 499448, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/957083d526c5fd7c54c5b89aece0b76a?s=128&d=identicon&r=PG", "display_name": "Boardy", "link": "https://stackoverflow.com/users/499448/boardy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 58419876, "answer_count": 1, "score": 1, "last_activity_date": 1571251652, "creation_date": 1571238680, "question_id": 58416543, "link": "https://stackoverflow.com/questions/58416543/c-aes-encryption-getting-truncated-to-16-characters", "title": "C++ AES Encryption getting truncated to 16 characters", "body": "<p>I've got a function that I worked on a while ago in C++ that does AES 256 encryption using CBC. </p>\n\n<p>I wrote the method a while ago so I unfortunately can't remember where I got the code from, but I've since found that I have a problem where if the string being encrypted is over 16 characters, its only the first 16 characters of the string that get encrypted. </p>\n\n<p>The code is below:</p>\n\n<pre><code>string Encryption::encryptOrDecrypt(string stringToEncrypt, Mode mode)\n{\n    HelperMethods helperMethods;\n    try\n    {\n        EVP_CIPHER_CTX *ctx = EVP_CIPHER_CTX_new();\n        EVP_CIPHER_CTX_init(ctx);\n\n        unsigned char key[33] = \"my_key\";\n        unsigned char iv[17] = \"my_iv\";\n\n        if (mode == Decrypt)\n        {\n            stringToEncrypt = helperMethods.base64Decode(stringToEncrypt);\n        }\n        vector&lt;unsigned char&gt; encrypted;\n        size_t max_output_len = stringToEncrypt.length() + 16 - (stringToEncrypt.length() % 16);\n        //size_t max_output_len = 16 - (stringToEncrypt.length() % 16);\n        encrypted.resize(max_output_len);\n\n        EVP_CipherInit_ex(ctx, EVP_aes_256_cbc(), NULL, key, iv, mode);\n\n        // EVP_CipherUpdate can encrypt all your data at once, or you can do\n            // small chunks at a time.\n        int actual_size = 0;\n        EVP_CipherUpdate(ctx,\n            &amp;encrypted[0], &amp;actual_size,\n            reinterpret_cast&lt;unsigned char *&gt;(&amp;stringToEncrypt[0]), stringToEncrypt.size());\n\n        // EVP_CipherFinal_ex is what applies the padding.  If your data is\n        // a multiple of the block size, you'll get an extra AES block filled\n        // with nothing but padding.\n        int final_size = 0;\n        EVP_CipherFinal_ex(ctx, &amp;encrypted[actual_size], &amp;final_size);\n        actual_size += final_size;\n\n        encrypted.resize(actual_size);\n\n        char * buff_str = (char*)malloc(encrypted.size() * 2 + 1);\n        memset(buff_str, 0, (encrypted.size() * 2 + 1));\n        char * buff_ptr = buff_str;\n\n        size_t index = 0;\n        for (index = 0; index &lt; encrypted.size(); ++index)\n        {\n            buff_ptr += sprintf(buff_ptr, \"%c\", encrypted[index]);\n\n        }\n        EVP_CIPHER_CTX_cleanup(ctx);\n        EVP_CIPHER_CTX_free(ctx);\n        if (mode == Encrypt)\n        {\n            string encryptedString = buff_str;\n            free(buff_str);\n            return helperMethods.base64Encode(encryptedString.c_str(), encryptedString.length());\n        }\n        else\n        {\n            string decryptedString = buff_str;\n            free(buff_str);\n            return decryptedString;\n        }\n    }\n    catch (exception ex)\n    {\n        return stringToEncrypt;\n    }\n\n}\n</code></pre>\n\n<p>I've stepped through the code to see where the problem might be and I can't see any reason why, its probably something stupidly simple. </p>\n\n<p>The <code>size_t max_output_len</code> is 768 (the actual string is 752) so this is +16 for padding I believe, but I'm not sure if this should 768 as well but as the method is setting this itself not sure. </p>\n\n<p>The pointer <code>int final_size</code> that gets passed into <code>EVP_CipherFinal_ex</code> becomes 16 when that method completes and the <code>actual_size</code> is also 768 so not sure where the problem is. </p>\n"}, {"tags": ["c++", "json", "nlohmann-json"], "comments": [{"owner": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 2, "creation_date": 1571238768, "post_id": 58416497, "comment_id": 103175974, "body": "What have you tried so far to do that? Please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of what you tried, and explain what problem you had with that."}, {"owner": {"reputation": 1400, "user_id": 3287591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec170ce77ff19649edf457377421bb8?s=128&d=identicon&r=PG", "display_name": "Giovanni Cerretani", "link": "https://stackoverflow.com/users/3287591/giovanni-cerretani"}, "edited": false, "score": 0, "creation_date": 1571242172, "post_id": 58416497, "comment_id": 103177775, "body": "Have a look at the official documentation <a href=\"https://nlohmann.github.io/json/index.html\" rel=\"nofollow noreferrer\">nlohmann.github.io/json/index.html</a>, looking for the <code>erase()</code> methods"}], "answers": [{"tags": [], "owner": {"reputation": 6190, "user_id": 1486486, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/nDPIw.jpg?s=128&g=1", "display_name": "Shlomi Hassid", "link": "https://stackoverflow.com/users/1486486/shlomi-hassid"}, "is_accepted": true, "score": 0, "last_activity_date": 1571489315, "creation_date": 1571489315, "answer_id": 58463847, "question_id": 58416497, "link": "https://stackoverflow.com/questions/58416497/how-to-delete-nested-json-data-using-nlohmann-c/58463847#58463847", "title": "How to delete nested json data using nlohmann c++", "body": "<p>I suggest iterating through the <code>json::array</code> stored in Tags and saving the Key of the matched elements. This way you can later validate the deletion and safely delete the elements.</p>\n\n<p>Note that deleting is exactly like erasing with a STL vector - I prefer to delete from the end of the vector to avoid changing the keys while deleting multiple elements.</p>\n\n<p><a href=\"https://repl.it/@ShlomoHassid/UpbeatRunnyPort-1\" rel=\"nofollow noreferrer\">Here is a quick and dirty demo</a></p>\n\n<p><strong>And here is the code:</strong>   </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include \"json3.6.1.hpp\"\n\nunsigned removeDefaultROIID(nlohmann::json&amp; jsonObject, const std::string&amp; value) {\n    std::vector&lt;int&gt; toremove;\n    //Loop through the `tags` json::array and create a vector of indexes to delete:\n    for (auto &amp;it : jsonObject[\"Tags\"].items()) {\n    //`.get&lt;std::string&gt;()` is the best way to make sure we are getting the value as std::string\n        if (it.value().at(\"ROIId\").get&lt;std::string&gt;() == value) \n            toremove.push_back(stoi(it.key()));\n    }\n    //sort it before erase - we want to delete first biggest index:\n    std::sort(toremove.rbegin(), toremove.rend());\n    //delete using `.erase()` method:\n    for (int &amp;it : toremove)\n        jsonObject[\"Tags\"].erase(jsonObject[\"Tags\"].begin() + it);\n    return toremove.size();\n}\n\nint main()\n{\n    //Create the JSON object:\n    nlohmann::json jsonObject = R\"({\"CompanyName\":\"XYZ Tech\",\"Created\":\"2019-10-16T20:14:29Z\",\"TxnId\":\"4509237\",\"Tags\":[{\"ROIId\": \"Default\",\"Time\": 71,\"Tracker\": \"emp10\"},{\"ROIId\":\"MC16\",\"Time\": 21,\"TrackerId\": \"emp10\"},{\"ROIId\":\"Default\",\"Time\":11,\"TrackerId\":\"emp11\"},{\"ROIId\":\"MC18\",\"Time\": 10,\"TrackerId\":\"emp11\"}],\"Type\":\"TxnData\"})\"_json;\n\n    std::cout &lt;&lt; \"JSON nested object value conditional erase:\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"JSON object TAGS count - BEFORE deletion:\" &lt;&lt; jsonObject[\"Tags\"].size() &lt;&lt; std::endl;\n    //Call the method -&gt; jlson is passed by ref\n    unsigned removed = removeDefaultROIID(jsonObject, \"Default\");\n\n    std::cout &lt;&lt; \"JSON object TAGS count - AFTER deletion:\" &lt;&lt; jsonObject[\"Tags\"].size() &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 4466, "user_id": 6243129, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1d0567e46408b2f3ceeb207a940737f4?s=128&d=identicon&r=PG&f=1", "display_name": "S Andrew", "link": "https://stackoverflow.com/users/6243129/s-andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1205, "favorite_count": 0, "accepted_answer_id": 58463847, "answer_count": 1, "score": -1, "last_activity_date": 1571489315, "creation_date": 1571238507, "question_id": 58416497, "link": "https://stackoverflow.com/questions/58416497/how-to-delete-nested-json-data-using-nlohmann-c", "title": "How to delete nested json data using nlohmann c++", "body": "<p>I have a below json data. I am using <a href=\"https://github.com/nlohmann/json\" rel=\"nofollow noreferrer\">nlohmann json</a> in <code>C++</code>.</p>\n\n<pre><code>{\n    \"CompanyName\": \"XYZ Tech\",\n    \"Created\": \"2019-10-16T20:14:29Z\",\n    \"TxnId\": \"4509237\",\n    \"Tags\": [\n        {\n            \"ROIId\": \"Default\",\n            \"Time\": 71,\n            \"Tracker\": \"emp10\"\n        },\n        {\n            \"ROIId\": \"MC16\",\n            \"Time\": 21,\n            \"TrackerId\": \"emp10\"\n        },\n        {\n            \"ROIId\": \"Default\",\n            \"Time\": 11,\n            \"TrackerId\": \"emp11\"\n        },\n        {\n            \"ROIId\": \"MC18\",\n            \"Time\": 10,\n            \"TrackerId\": \"emp11\"\n        }\n    ],\n    \"Type\": \"TxnData\"\n}\n</code></pre>\n\n<p>In above json data, inside <code>Tags</code>, we have data where the <code>ROIId</code> is <code>Default</code>. I want to delete it so that the data becomes:</p>\n\n<pre><code>{\n    \"CompanyName\": \"XYZ Tech\",\n    \"Created\": \"2019-10-16T20:14:29Z\",\n    \"TxnId\": \"4509237\",\n    \"Tags\": [\n        {\n            \"ROIId\": \"MC16\",\n            \"Time\": 21,\n            \"TrackerId\": \"emp10\"\n        },\n        {\n            \"ROIId\": \"MC18\",\n            \"Time\": 10,\n            \"TrackerId\": \"emp11\"\n        }\n    ],\n    \"Type\": \"TxnData\"\n}\n</code></pre>\n\n<p>How can I do it in c++. Thanks</p>\n"}, {"tags": ["c++", "c++11", "cgal"], "comments": [{"owner": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "edited": false, "score": 1, "creation_date": 1571239791, "post_id": 58416468, "comment_id": 103176575, "body": "Pleaae add your code"}], "answers": [{"tags": [], "owner": {"reputation": 5172, "user_id": 863521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gGh24.jpg?s=128&g=1", "display_name": "sloriot", "link": "https://stackoverflow.com/users/863521/sloriot"}, "is_accepted": false, "score": 0, "last_activity_date": 1571262578, "creation_date": 1571262578, "answer_id": 58422115, "question_id": 58416468, "link": "https://stackoverflow.com/questions/58416468/create-face-with-k-vertices-cgal-c/58422115#58422115", "title": "Create face with k vertices CGAL c++", "body": "<p>You can do that with the incremental builder. In this <a href=\"https://doc.cgal.org/latest/Polyhedron/Polyhedron_2polyhedron_prog_incr_builder_8cpp-example.html\" rel=\"nofollow noreferrer\">example</a>, if you call more than three times <code>B.add_vertex_to_facet(k)</code> then your face will contain more that 3 vertices.</p>\n\n<p>Alternatively, the function <a href=\"https://doc.cgal.org/latest/BGL/group__PkgBGLEulerOperations.html#gaa386d0cdef3b5d6ef43d6b503392dbcd\" rel=\"nofollow noreferrer\"><code>CGAL::Euler::add_face()</code></a> is also available and has a simpler API. Note that the range provided to the function must be the range of vertices of the face (added using <code>CGAL::add_vertex()</code> for example).</p>\n"}], "owner": {"reputation": 1, "user_id": 12227353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcab5cd2b4feb30b65f5541848ddc0d6?s=128&d=identicon&r=PG&f=1", "display_name": "Kojesma", "link": "https://stackoverflow.com/users/12227353/kojesma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571262578, "creation_date": 1571238381, "question_id": 58416468, "link": "https://stackoverflow.com/questions/58416468/create-face-with-k-vertices-cgal-c", "title": "Create face with k vertices CGAL c++", "body": "<p>I'm working on a project to display and interact with object loaded. I load .obj files, but in some of them i have faces with like 10 vertices, i've searched but i didn't find how to create face like that with CGAL. I tried to use this : <a href=\"https://doc.cgal.org/latest/Polyhedron/classCGAL_1_1Polyhedron__incremental__builder__3.html#a4d6b47abdda805ccc6142ecbe78002c7\" rel=\"nofollow noreferrer\">https://doc.cgal.org/latest/Polyhedron/classCGAL_1_1Polyhedron__incremental__builder__3.html#a4d6b47abdda805ccc6142ecbe78002c7</a> but without success, can someone help me pls ?</p>\n"}, {"tags": ["c++", "segmentation-fault"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1571238565, "post_id": 58416446, "comment_id": 103175848, "body": "Aside: won&#39;t that multiply cause overflow in the unsigned char target?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1571238680, "post_id": 58416446, "comment_id": 103175929, "body": "Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">how to debug small programs</a> and use a recent <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a>, probably as <code>g++ -Wall -g</code>"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1571238743, "post_id": 58416446, "comment_id": 103175964, "body": "Please add the definition of <code>image</code>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1571238764, "post_id": 58416446, "comment_id": 103175973, "body": "<code>push_back</code> won&#39;t segfault. If <code>reserve</code> succeeded and if your vector is a <code>std::vector&lt;unsigned char&gt;</code> then I don&#39;t think it&#39;s even possible for it to fail (at least on a conforming platform). The problem is likely <code>pmappedMemory[i]</code>."}, {"owner": {"reputation": 5541, "user_id": 9967571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EwjwT.png?s=128&g=1", "display_name": "jignatius", "link": "https://stackoverflow.com/users/9967571/jignatius"}, "edited": false, "score": 1, "creation_date": 1571238807, "post_id": 58416446, "comment_id": 103176000, "body": "Check the size of pmappedMemory. You might be trying to index into that which is out of bounds."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1571238809, "post_id": 58416446, "comment_id": 103176003, "body": "<code>try</code> and <code>catch</code> won&#39;t catch undefined behaviour, since you cannot recover or even end the program when you&#39;re in UB land. Once you&#39;re in UB there is nothing that can be done."}], "answers": [{"tags": [], "owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "is_accepted": false, "score": 3, "last_activity_date": 1571242902, "last_edit_date": 1571242902, "creation_date": 1571238547, "answer_id": 58416506, "question_id": 58416446, "link": "https://stackoverflow.com/questions/58416446/reseved-vector-segfault/58416506#58416506", "title": "Reseved vector segfault", "body": "<p>It stops at almost exactly one quarter of the way. The memory allocated for <code>pmappedMemory</code> is simply too small. You probably allocated a number of pixels instead of the right number of elements (four times the pixels)</p>\n\n<p>Another option is that the pmappedbuffer actually contains bytes, and you are mistakenly assuming it is a float buffer. How did you get this mapped area, and what is it pointing to?</p>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 7672661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ce39b12ee76fc09e7660a524198a10?s=128&d=identicon&r=PG&f=1", "display_name": "ibvfteh", "link": "https://stackoverflow.com/users/7672661/ibvfteh"}, "is_accepted": false, "score": 0, "last_activity_date": 1571266195, "creation_date": 1571266195, "answer_id": 58422641, "question_id": 58416446, "link": "https://stackoverflow.com/questions/58416446/reseved-vector-segfault/58422641#58422641", "title": "Reseved vector segfault", "body": "<p>Ok apparantly its an Intel Graphics Vulkan support problem<br>\nCure - map memory by rows </p>\n"}], "owner": {"reputation": 75, "user_id": 7672661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ce39b12ee76fc09e7660a524198a10?s=128&d=identicon&r=PG&f=1", "display_name": "ibvfteh", "link": "https://stackoverflow.com/users/7672661/ibvfteh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1571266195, "creation_date": 1571238313, "question_id": 58416446, "link": "https://stackoverflow.com/questions/58416446/reseved-vector-segfault", "title": "Reseved vector segfault", "body": "<p>Im trying to reserve memory and copy from Vulkan memory </p>\n\n<pre><code>try { \n    image.reserve(a_width * a_height * 4);\n  }\n  catch (...) {\n    std::cerr &lt;&lt; \"ERROR: \" &lt;&lt; std::endl;\n  }\n  std::cout &lt;&lt; \"p     ... \" &lt;&lt; (a_width * a_height) &lt;&lt; std::endl;\n  for (int i = 0; i &lt; (a_width * a_height); i += 1)\n  {\n  std::cout &lt;&lt; \"q     ... \" &lt;&lt; i &lt;&lt; std::endl;\n    image.push_back((unsigned char)(255.0f * (pmappedMemory[i].r)));\n    image.push_back((unsigned char)(255.0f * (pmappedMemory[i].g)));\n    image.push_back((unsigned char)(255.0f * (pmappedMemory[i].b)));\n    image.push_back((unsigned char)(255.0f * (pmappedMemory[i].a)));\n  }\n</code></pre>\n\n<p>total size is 7680000<br>\nbut it stops at 1952768 with Segmentation fault (core dumped)</p>\n\n<p>catch didn't catch anything</p>\n"}, {"tags": ["c++", "unity3d", "gpu", "cpu", "gstreamer"], "comments": [{"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 1, "creation_date": 1571237996, "post_id": 58416279, "comment_id": 103175494, "body": "I think you mean <code>YUV</code>?"}, {"owner": {"reputation": 102, "user_id": 6386206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa6d9d3c7c5e49b464b116066912561?s=128&d=identicon&r=PG&f=1", "display_name": "AzeExMachina", "link": "https://stackoverflow.com/users/6386206/azeexmachina"}, "reply_to_user": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1571238067, "post_id": 58416279, "comment_id": 103175544, "body": "Yes, sorry, it was a typo, edited, thank you."}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1571238153, "post_id": 58416279, "comment_id": 103175594, "body": "And yes, this can be done in shader pretty simple. (if all you want is render it) But have you check if the convert part really the bottleneck?"}, {"owner": {"reputation": 102, "user_id": 6386206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa6d9d3c7c5e49b464b116066912561?s=128&d=identicon&r=PG&f=1", "display_name": "AzeExMachina", "link": "https://stackoverflow.com/users/6386206/azeexmachina"}, "reply_to_user": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1571238357, "post_id": 58416279, "comment_id": 103175716, "body": "Yes, I only need to render the video, I don&#39;t need to edit it or do fancy stuff. How can I do this? I&#39;ve tried to use a shader like this <a href=\"https://stackoverflow.com/questions/54299351/yuv-shader-for-unity\" title=\"yuv shader for unity\">stackoverflow.com/questions/54299351/yuv-shader-for-unity</a> but I&#39;m not seeing the texture. And also, that shader is not implementing UI masking, which I need."}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1571239214, "post_id": 58416279, "comment_id": 103176254, "body": "IIRC, you needs to use that shader on a quad, not UI image. Also you can try about RenderTexture and bind it to UI image. (im not sure since I don&#39;t touch Unity for a while)"}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1571240072, "post_id": 58416279, "comment_id": 103176710, "body": "just to add the reason, I don&#39;t know if UI image has proper UV coord. Maybe you can also try change the renderer on UI element."}], "owner": {"reputation": 102, "user_id": 6386206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa6d9d3c7c5e49b464b116066912561?s=128&d=identicon&r=PG&f=1", "display_name": "AzeExMachina", "link": "https://stackoverflow.com/users/6386206/azeexmachina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 335, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1571238036, "creation_date": 1571237818, "last_edit_date": 1571238036, "question_id": 58416279, "link": "https://stackoverflow.com/questions/58416279/better-way-to-convert-yuv-to-rgb-in-unity3d-with-native-plugins", "title": "Better way to convert YUV to RGB in Unity3D with native plugins", "body": "<p>I have a Unity3D application that plays videos on the UI.\nI find myself in need to find a better way to convert a YUV video buffer to a RGB buffer.\nMy situation is this:</p>\n\n<ul>\n<li><strong>Unity3D</strong> with a UI image that renders a video</li>\n<li>Gstreamer external process which actually plays the video</li>\n<li>A native plugin, called from Unity3D to convert the video YUV buffer to a RGBA one</li>\n</ul>\n\n<p>My C++/Native plugin portion of code related to the YUV->RGBA conversion:</p>\n\n<pre><code>unsigned char * rgba = (unsigned char*) obj-&gt;g_RgbaBuff;\nunsigned char * yuv =  (unsigned char*) obj-&gt;g_Buffer;\n\nwhile ( ta &lt; obj-&gt;g_BufferLength) \n{\n    int ty = (int)yuv[i];\n    int tu = (int)yuv[i + 1];\n    int tY2 = (int)yuv[i + 2];\n    int tv = (int)yuv[i + 3];\n\n    int tp1 = (int)(1.164f * (ty - 16));\n    int tr = Clamp((int)tp1 + 1.596f * (tv - 128));\n    int tg = Clamp((int)tp1 - 0.813f * (tv - 128) - 0.391f * (tu - 128));\n    int tb = Clamp((int)tp1 + 2.018f * (tu - 128));\n\n    rgba[ta] = tb;\n    rgba[ta + 1] = tg;\n    rgba[ta + 2] = tr;\n    ta += 4;\n\n\n\n    int tp2 = (int)(1.164f * (tY2 - 16));\n    int tr2 = Clamp((int)tp2 + 1.596f * (tv - 128));\n    int tg2 = Clamp((int)tp2 - 0.813f * (tv - 128) - 0.391f * (tu - 128));\n    int tb2 = Clamp((int)tp2 + 2.018f * (tu - 128));\n\n    rgba[ta] = tb2;\n    rgba[ta + 1] = tg2;\n    rgba[ta + 2] = tr2;\n    ta += 4;\n}\n</code></pre>\n\n<p>This code gets called by Unity3D in a while loop to continuously update the output of my image, which is correctly showing the video.\nThing is, it's really slow. When I'm opening more than one video, my FPSs drop from 60 to way below 30 with just three 720p videos.\nIs there a way to do this on the GPU? Or a smarter way to do it. Should I approach it in a different way?</p>\n\n<p>To render the buffer to a texture I'm using this code in my native code, there's the rendering being done every frame by using Unity GL.IssuePluginEvent()</p>\n\n<pre><code>static void ModifyTexturePixels(void* textureHandle, int w, int h,  void* rgbaBuff)\n{   \n    int textureRowPitch;\n\n    glBindTexture(GL_TEXTURE_2D, (GLuint)(size_t)textureHandle);\n    glTexSubImage2D(GL_TEXTURE_2D, 0, 0, 0, w, h, GL_BGRA, GL_UNSIGNED_INT_8_8_8_8_REV, rgbaBuff);\n}\n</code></pre>\n"}, {"tags": ["c++", "dev-c++", "cppunit"], "comments": [{"owner": {"reputation": 999, "user_id": 7859598, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-B2rVv02QIdo/AAAAAAAAAAI/AAAAAAAACew/FUFwHEbNSVo/photo.jpg?sz=128", "display_name": "Rietty", "link": "https://stackoverflow.com/users/7859598/rietty"}, "edited": false, "score": 1, "creation_date": 1571236793, "post_id": 58415883, "comment_id": 103174685, "body": "If the compiler is complaining about that, then you are probably not compiling properly/indicating files properly. Could you post how you try to compile your code?"}, {"owner": {"reputation": 898, "user_id": 1606410, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EOAKA.png?s=128&g=1", "display_name": "Devon Cornwall", "link": "https://stackoverflow.com/users/1606410/devon-cornwall"}, "edited": false, "score": 2, "creation_date": 1571236794, "post_id": 58415883, "comment_id": 103174686, "body": "Besides the other problems the line <code>guts() {gutsVar = 0};</code> should be <code>guts() {gutsVar = 0;}</code>. The semicolon has to be after the statement in the function body. There does not need to be a semicolon after a function definition inside of class."}, {"owner": {"reputation": 13842, "user_id": 759253, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0136e90dfd678a82c1dbba77dcbfc28e?s=128&d=identicon&r=PG", "display_name": "Igor R.", "link": "https://stackoverflow.com/users/759253/igor-r"}, "edited": false, "score": 4, "creation_date": 1571236799, "post_id": 58415883, "comment_id": 103174690, "body": "The problem is not in the program, but in the way you invoke the compiler."}, {"owner": {"reputation": 1638, "user_id": 366956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dac48f00b4d8020a21400d54f8a5ff88?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/366956/steve"}, "edited": false, "score": 0, "creation_date": 1571236854, "post_id": 58415883, "comment_id": 103174728, "body": "Looks like you not compiling the file at all. Stop looking at the program and investigate how you&#39;re invoking the compiler."}, {"owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "edited": false, "score": 0, "creation_date": 1571236859, "post_id": 58415883, "comment_id": 103174731, "body": "See <a href=\"https://askubuntu.com/questions/125927/compiling-c-code-raising-no-input-files-fatal-error\">this</a> for more on your issue. Remember to try googling first before creating questions on here!"}, {"owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "reply_to_user": {"reputation": 898, "user_id": 1606410, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EOAKA.png?s=128&g=1", "display_name": "Devon Cornwall", "link": "https://stackoverflow.com/users/1606410/devon-cornwall"}, "edited": false, "score": 0, "creation_date": 1571236908, "post_id": 58415883, "comment_id": 103174766, "body": "I can&#39;t reproduce the problem. Your code is ok after you fix the problem with the semicolon mentioned by @DevonCornwall <a href=\"https://wandbox.org/permlink/jDdllYggr08jDJrA\" rel=\"nofollow noreferrer\">wandbox.org/permlink/jDdllYggr08jDJrA</a>"}, {"owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "edited": false, "score": 0, "creation_date": 1571236982, "post_id": 58415883, "comment_id": 103174816, "body": "It&#39;s not his code, his compiler can&#39;t find the source .cpp file."}, {"owner": {"reputation": 15, "user_id": 12005322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d192ee52889a176e221fb2cd2caa4f5?s=128&d=identicon&r=PG&f=1", "display_name": "Dondurma", "link": "https://stackoverflow.com/users/12005322/dondurma"}, "reply_to_user": {"reputation": 898, "user_id": 1606410, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EOAKA.png?s=128&g=1", "display_name": "Devon Cornwall", "link": "https://stackoverflow.com/users/1606410/devon-cornwall"}, "edited": false, "score": 0, "creation_date": 1571237404, "post_id": 58415883, "comment_id": 103175097, "body": "I fixed the problem @DevonCornwall mentioned, I try to compile (execute/compile on devc++) and it gives me the same error. \u0131 wrote the code myself, did not copy paste or anything. It also automatically opens a file called Makefile.win, which has all sorts of stuff I don&#39;t understand. What do I do? Sorry if this is a stupid question, I just started learning this thing two days ago."}, {"owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "edited": false, "score": 0, "creation_date": 1571237420, "post_id": 58415883, "comment_id": 103175105, "body": "Can you show us the command you use to build your program? What are you typing in your console?"}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 12005322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d192ee52889a176e221fb2cd2caa4f5?s=128&d=identicon&r=PG&f=1", "display_name": "Dondurma", "link": "https://stackoverflow.com/users/12005322/dondurma"}, "is_accepted": false, "score": 0, "last_activity_date": 1571237681, "creation_date": 1571237681, "answer_id": 58416237, "question_id": 58415883, "link": "https://stackoverflow.com/questions/58415883/created-a-friend-in-class-gives-no-input-files-error/58416237#58416237", "title": "Created a friend in class, gives &#39;no input files&#39; error", "body": "<p>Apparently, it was because I was working on an old project. I closed the project, closed the compiler and opened it again, started a new source file. I copy-pasted the whole thing and it worked. Thanks everyone! Sorry for being silly.</p>\n"}], "owner": {"reputation": 15, "user_id": 12005322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d192ee52889a176e221fb2cd2caa4f5?s=128&d=identicon&r=PG&f=1", "display_name": "Dondurma", "link": "https://stackoverflow.com/users/12005322/dondurma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571237681, "creation_date": 1571236605, "last_edit_date": 1571237010, "question_id": 58415883, "link": "https://stackoverflow.com/questions/58415883/created-a-friend-in-class-gives-no-input-files-error", "title": "Created a friend in class, gives &#39;no input files&#39; error", "body": "<p>I am an absolute beginner in C++ and trying to learn how to create a friend inside a class. I did everything exactly as the teacher did, but the compiler gives me two errors:</p>\n\n<pre><code>[Error] hj\u00b2k.cpp: No such file or directory\n[Error] no input files\n</code></pre>\n\n<p>Where did I make a mistake? Could you please explain like I'm five?</p>\n\n<pre><code>class guts {\n    public:\n        guts() {gutsVar = 0};\n    private:\n        int gutsVar;\n    friend void gutsfriend (guts &amp;gutsObj);\n    };\n\nvoid gutsfriend (guts &amp;gutsObj) {\n        gutsObj.gutsVar = 99;\n        cout &lt;&lt; gutsObj.gutsVar &lt;&lt; endl;\n    }\nint main () {\n    guts obj2;\n    gutsfriend (obj2);\n}\n</code></pre>\n\n<p>I expect the output to be 99, but it doesn't even give me the blackboard. It says compilation terminated.</p>\n"}, {"tags": ["c++", "segmentation-fault", "sfml"], "comments": [{"owner": {"reputation": 1180, "user_id": 1763382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/gCf2f.png?s=128&g=1", "display_name": "auburg", "link": "https://stackoverflow.com/users/1763382/auburg"}, "edited": false, "score": 0, "creation_date": 1571237117, "post_id": 58415860, "comment_id": 103174909, "body": "Where does it crash ? What&#39;s the error you&#39;re seeing ?"}, {"owner": {"reputation": 21, "user_id": 12227092, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD3wWV33KXeYjivxI-PuTPSt-wYWbQJmQfp9kLPfw=k-s128", "display_name": "Davide307", "link": "https://stackoverflow.com/users/12227092/davide307"}, "reply_to_user": {"reputation": 1180, "user_id": 1763382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/gCf2f.png?s=128&g=1", "display_name": "auburg", "link": "https://stackoverflow.com/users/1763382/auburg"}, "edited": false, "score": 0, "creation_date": 1571237826, "post_id": 58415860, "comment_id": 103175398, "body": "the error is double free or corruption (out),i&#39;m not sure when it crashes.. i think when he tries to delete the text or the font, more specifically i get the signal SIGABRT in the file : new_allocator.h located in the c++ directory"}, {"owner": {"reputation": 1180, "user_id": 1763382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/gCf2f.png?s=128&g=1", "display_name": "auburg", "link": "https://stackoverflow.com/users/1763382/auburg"}, "edited": false, "score": 0, "creation_date": 1571238886, "post_id": 58415860, "comment_id": 103176053, "body": "what if you try a different font ?"}, {"owner": {"reputation": 21, "user_id": 12227092, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD3wWV33KXeYjivxI-PuTPSt-wYWbQJmQfp9kLPfw=k-s128", "display_name": "Davide307", "link": "https://stackoverflow.com/users/12227092/davide307"}, "reply_to_user": {"reputation": 1180, "user_id": 1763382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/gCf2f.png?s=128&g=1", "display_name": "auburg", "link": "https://stackoverflow.com/users/1763382/auburg"}, "edited": false, "score": 0, "creation_date": 1571239427, "post_id": 58415860, "comment_id": 103176387, "body": "i tried to use an open sans font, the error is till there"}, {"owner": {"reputation": 156, "user_id": 11097544, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B6ghjh5RY2A/AAAAAAAAAAI/AAAAAAAAADE/GSKwPFC-BrU/photo.jpg?sz=128", "display_name": "Guillaume Magniadas", "link": "https://stackoverflow.com/users/11097544/guillaume-magniadas"}, "edited": false, "score": 0, "creation_date": 1571240182, "post_id": 58415860, "comment_id": 103176786, "body": "Put printf after every line to check where it crash then tell us."}, {"owner": {"reputation": 21, "user_id": 12227092, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD3wWV33KXeYjivxI-PuTPSt-wYWbQJmQfp9kLPfw=k-s128", "display_name": "Davide307", "link": "https://stackoverflow.com/users/12227092/davide307"}, "edited": false, "score": 0, "creation_date": 1571242155, "post_id": 58415860, "comment_id": 103177769, "body": "ok it seems the error occurs when text is created, and when the window opens, at the start of the <b>window.isOpen</b> loop, the whole program crashes"}, {"owner": {"reputation": 43404, "user_id": 61, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/af29baa43e6e6f77180e631cea686847?s=128&d=identicon&r=PG", "display_name": "Bernard", "link": "https://stackoverflow.com/users/61/bernard"}, "edited": false, "score": 0, "creation_date": 1571262593, "post_id": 58415860, "comment_id": 103186465, "body": "There&#39;s nothing wrong (at first glance, I&#39;m not super familiar with SFML) with the code posted. If there&#39;s no more code (there&#39;s presumably header files missing, at least) then I would assume it&#39;s a build configuration issue -- that is to say, is the SFML library you&#39;re compiling the same as the header files? Is the library built with the same compiler version and settings as the rest of your program, etc."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12227092, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD3wWV33KXeYjivxI-PuTPSt-wYWbQJmQfp9kLPfw=k-s128", "display_name": "Davide307", "link": "https://stackoverflow.com/users/12227092/davide307"}, "edited": false, "score": 0, "creation_date": 1571771797, "post_id": 58483085, "comment_id": 103349432, "body": "yes i know, i deleted the parts of the code that were not necessary for the draw function, i checked and the loop event doesn&#39;t influence <i>sf::Text</i>"}], "tags": [], "owner": {"reputation": 1835, "user_id": 3195314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiMED.png?s=128&g=1", "display_name": "alseether", "link": "https://stackoverflow.com/users/3195314/alseether"}, "is_accepted": false, "score": 0, "last_activity_date": 1571648909, "creation_date": 1571648909, "answer_id": 58483085, "question_id": 58415860, "link": "https://stackoverflow.com/questions/58415860/segmentation-fault-in-sfml-when-i-try-to-draw-an-sftext-object/58483085#58483085", "title": "Segmentation fault in SFML when i try to draw an sf::Text object", "body": "<h2>Event loop</h2>\n\n<p>You should add the event processing loop in order for the window to behave properly. </p>\n\n<p>According to <a href=\"https://www.sfml-dev.org/tutorials/2.5/window-window.php#bringing-the-window-to-life\" rel=\"nofollow noreferrer\">SFML tutorials</a>: </p>\n\n<blockquote>\n  <p>A mistake that people often make is to forget the event loop, simply\n  because they don't yet care about handling events (they use real-time\n  inputs instead). Without an event loop, the window will become\n  unresponsive. It is important to note that the event loop has two\n  roles: in addition to providing events to the user, it gives the\n  window a chance to process its internal events too, which is required\n  so that it can react to move or resize user actions.</p>\n</blockquote>\n\n<p>So your code should look as follows:</p>\n\n<pre><code>#include &lt;SFML/Window.hpp&gt;\n\nint main()\n{\n    sf::RenderWindow window(sf::VideoMode(500, 320), \" Text \");\n    sf::Font font;\n    font.loadFromFile(\"../arial_narrow_7.ttf\");\n    sf::Text text(\"hello\", font);\n    text.setCharacterSize(30);\n    text.setStyle(sf::Text::Bold);\n    text.setFillColor(sf::Color::Red);\n    text.setFont(font);\n    // run the program as long as the window is open\n    while (window.isOpen())\n    {\n        // check all the window's events that were triggered since the last iteration of the loop\n        sf::Event event;\n        while (window.pollEvent(event))\n        {\n            // \"close requested\" event: we close the window\n            if (event.type == sf::Event::Closed)\n                window.close();\n        }\n        window.clear();\n        window.draw(text);\n        window.display();\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>You even had a unused <code>sf::Event</code> declared at the beginning of your code.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 12227092, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD3wWV33KXeYjivxI-PuTPSt-wYWbQJmQfp9kLPfw=k-s128", "display_name": "Davide307", "link": "https://stackoverflow.com/users/12227092/davide307"}, "is_accepted": true, "score": 2, "last_activity_date": 1571772467, "creation_date": 1571772467, "answer_id": 58511079, "question_id": 58415860, "link": "https://stackoverflow.com/questions/58415860/segmentation-fault-in-sfml-when-i-try-to-draw-an-sftext-object/58511079#58511079", "title": "Segmentation fault in SFML when i try to draw an sf::Text object", "body": "<p>OK, as Bernard suggested, the problem was a external to the code itself, my version of SFML was too old, 2.3 i think, i didn't notice it because i tried to update it with the command <em>sudo upgrade/ sudo update</em> and it said that everything was up to date, so when i noticed the version in the SFML/Config.hpp file was older, I reinstalled SFML manually whit the newest files form the SFML website. Thanks everyone for your time and your helpful tips :)</p>\n"}], "owner": {"reputation": 21, "user_id": 12227092, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD3wWV33KXeYjivxI-PuTPSt-wYWbQJmQfp9kLPfw=k-s128", "display_name": "Davide307", "link": "https://stackoverflow.com/users/12227092/davide307"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 58511079, "answer_count": 2, "score": 0, "last_activity_date": 1571772467, "creation_date": 1571236548, "last_edit_date": 1571237088, "question_id": 58415860, "link": "https://stackoverflow.com/questions/58415860/segmentation-fault-in-sfml-when-i-try-to-draw-an-sftext-object", "title": "Segmentation fault in SFML when i try to draw an sf::Text object", "body": "<p>I'm using SFML for a school project, and I'm having this problem when I try to run this code I get the error: double free or corruption (out) and the program crashes. My operating system is ubuntu.</p>\n\n<p>I tried creating \"text\" with a <code>malloc</code>. In that case, there aren't any errors but it crashes anyway (I still get the segmentation fault). I even tried sending this code to a friend, it works for him so I think there is something wrong with my configuration or something?</p>\n\n<pre><code>int main(){\n    sf::RenderWindow window(sf::VideoMode(500, 320), \" Text \");\n    sf::Event event;\n    sf::Font font;\n    font.loadFromFile(\"../arial_narrow_7.ttf\");\n    sf::Text text(\"hello\", font);\n    text.setCharacterSize(30);\n    text.setStyle(sf::Text::Bold);\n    text.setFillColor(sf::Color::Red);\n    text.setFont(font);\n\n    while(window.isOpen()) {\n        window.draw(text);\n        window.display();\n        window.clear();\n    }\n}\n</code></pre>\n\n<p>It should draw the text \"hello\" in red color, but as I said the program  crashes.</p>\n"}, {"tags": ["python", "c++", "boost", "swig"], "answers": [{"tags": [], "owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "is_accepted": false, "score": 1, "last_activity_date": 1571783631, "creation_date": 1571783631, "answer_id": 58513139, "question_id": 58415839, "link": "https://stackoverflow.com/questions/58415839/swig-and-boostvariant/58513139#58513139", "title": "SWIG and Boost::variant", "body": "<p>You can do this. I thought for quite a while about what the neatest Python interface to <code>boost::variant</code> actually is. My conclusion was that 99% of the time a Python user shouldn't even realise there's a variant type being use - unions and variants are basically just somewhat constrained duck-typing for C++.</p>\n\n<p>So my goals were this: </p>\n\n<ul>\n<li>wherever possible benefit from existing typemaps - we don't want to have to write our own <code>std::string</code>, <code>int</code>, typemaps from scratch.</li>\n<li>anywhere a C++ function takes a <code>boost::variant</code> we should transparently accept any of the types the variant can hold for that function argument.</li>\n<li>anywhere a C++ function returns a <code>boost::variant</code> we should transparently return it as the type the variant was holding when we got it back into Python.</li>\n<li>allow Python users to explicitly create a variant object, e.g. an empty one, but don't expect that to ever actually happen. (Maybe that would be useful for reference output arguments, but I've not gone that far in this currently).</li>\n<li>I didn't do this, but it would be fairly simple to add visitors from where this interface currently stands using the directors feature of SWIG.</li>\n</ul>\n\n<p>It's pretty fiddly to do all that without adding some machinery into things. I wrapped everything up in a reusable file, this is the final working version of my boost_variant.i:</p>\n\n<pre><code>%{\n#include &lt;boost/variant.hpp&gt;\n\nstatic PyObject *this_module = NULL;\n%}\n\n%init %{\n  // We need to \"borrow\" a reference to this for our typemaps to be able to look up the right functions\n  this_module = m; // borrow should be fine since we can only get called when our module is loaded right?\n  // Wouldn't it be nice if $module worked *anywhere*\n%}\n\n#define FE_0(...)\n#define FE_1(action,a1) action(0,a1)\n#define FE_2(action,a1,a2) action(0,a1); action(1,a2)\n#define FE_3(action,a1,a2,a3) action(0,a1); action(1,a2); action(2,a3)\n#define FE_4(action,a1,a2,a3,a4) action(0,a1); action(1,a2); action(2,a3); action(3,a4)\n#define FE_5(action,a1,a2,a3,a4,a5) action(0,a1); action(1,a2); action(2,a3); action(3,a4); action(4,a5)\n\n#define GET_MACRO(_1,_2,_3,_4,_5,NAME,...) NAME\n%define FOR_EACH(action,...)\n  GET_MACRO(__VA_ARGS__, FE_5, FE_4, FE_3, FE_2, FE_1, FE_0)(action,__VA_ARGS__)\n%enddef\n\n#define in_helper(num,type) const type &amp; convert_type ## num () { return boost::get&lt;type&gt;(*$self); }\n#define constructor_helper(num,type) variant(const type&amp;)\n\n%define %boost_variant(Name, ...)\n\n%rename(Name) boost::variant&lt;__VA_ARGS__&gt;;\n\nnamespace boost {\n  struct variant&lt;__VA_ARGS__&gt; {\n    variant();\n    variant(const boost::variant&lt;__VA_ARGS__&gt;&amp;);\n    FOR_EACH(constructor_helper, __VA_ARGS__);\n    int which();\n    bool empty();\n\n    %extend {\n      FOR_EACH(in_helper, __VA_ARGS__);\n    }\n  };\n}\n\n%typemap(out) boost::variant&lt;__VA_ARGS__&gt; {\n  // Make our function output into a PyObject\n  PyObject *tmp = SWIG_NewPointerObj(&amp;$1, $&amp;1_descriptor, 0); // Python does not own this object...\n\n  // Pass that temporary PyObject into the helper function and get another PyObject back in exchange\n  const std::string func_name = \"convert_type\" + std::to_string($1.which());\n  $result = PyObject_CallMethod(tmp, func_name.c_str(),  \"\");\n  Py_DECREF(tmp);\n}\n\n%typemap(in) const boost::variant&lt;__VA_ARGS__&gt;&amp; (PyObject *tmp=NULL) {\n  // I don't much like having to \"guess\" the name of the make_variant we want to use here like this...\n  // But it's hard to support both -builtin and regular modes and generically find the right code.\n  PyObject *helper_func = PyObject_GetAttrString(this_module, \"new_\" #Name );\n  assert(helper_func);\n  // TODO: is O right, or should it be N?\n  tmp = PyObject_CallFunction(helper_func, \"O\", $input);\n  Py_DECREF(helper_func);\n  if (!tmp) SWIG_fail; // An exception is already pending\n\n  // TODO: if we cared, we chould short-circuit things a lot for the case where our input really was a variant object\n  const int res = SWIG_ConvertPtr(tmp, (void**)&amp;$1, $1_descriptor, 0);\n  if (!SWIG_IsOK(res)) {\n    SWIG_exception_fail(SWIG_ArgError(res), \"Variant typemap failed, not sure if this can actually happen\"); \n  }\n}\n\n%typemap(freearg) const boost::variant&lt;__VA_ARGS__&gt;&amp; %{\n  Py_DECREF(tmp$argnum);\n%}\n\n%enddef\n</code></pre>\n\n<p>This gives us a macro we can use in SWIG, <code>%boost_variant</code>. You can then use this in your interface file something like this:</p>\n\n<pre><code>%module test\n\n%include \"boost_variant.i\"\n\n%inline %{\n  struct A {};\n  struct B {};\n%}\n\n%include &lt;std_string.i&gt;\n%boost_variant(TestVariant, A, B, std::string);\n\n%inline %{\n  void idea(const boost::variant&lt;A, B, std::string&gt;&amp;) {\n  }\n\n  boost::variant&lt;A,B,std::string&gt; make_me_a_thing() {\n    struct A a;\n    return a;\n  }\n\n  boost::variant&lt;A,B,std::string&gt; make_me_a_string() {\n    return \"HELLO\";\n  }\n\n%}\n</code></pre>\n\n<p>Where the <code>%boost_variant</code> macro takes the first argument as a name for the type (much like <code>%template</code> would) and the remaining arguments as a list of all the types in the variant.</p>\n\n<p>This is sufficient to allow us to run the following Python:</p>\n\n<pre><code>import test\n\na = test.A();\nb = test.B();\n\ntest.idea(a)\ntest.idea(b)\n\nprint(test.make_me_a_thing())\nprint(test.make_me_a_string())\n</code></pre>\n\n<hr>\n\n<p>So how does that actually work?</p>\n\n<ul>\n<li>We essentially duplicate SWIG's <code>%template</code> support here. (It's <a href=\"http://www.swig.org/Doc4.0/SWIGPlus.html#SWIGPlus_template_directive\" rel=\"nofollow noreferrer\">documented here as an option</a>)</li>\n<li>Most of the heavy lifting in my file is done using a <code>FOR_EACH</code> variadic macro. Largely that's the same as my <a href=\"https://stackoverflow.com/a/32668302/168175\">previous answer on <code>std::function</code></a>, which was itself derived from several older Stack Overflow answers and adapted to work with SWIG's preprocessor. </li>\n<li>Using the <code>FOR_EACH</code> macro we tell SWIG to wrap one constructor per type the variant can hold. This lets us explicitly construct variants from Python code, with two extra constructors added</li>\n<li>By using constructors like this we can lean heavily on SWIG's overload resolution support. So given a Python object we can simply rely on SWIG to determine how to construct a variant from it. Which saves us a bunch of extra work, and uses the existing typemaps for each type within the variant.</li>\n<li>The <code>in</code> typemap basically just delegates to the constructor, via a slightly convoluted route because it's surprisingly hard to find other functions in the same module programatically. Once that delegation has happened we use the normal conversion of a function argument to just pass the tempoary variant into the function as though it were what we were given.</li>\n<li>We also synthesise a set of extra member functions, <code>convert_typeN</code> which internally just call <code>boost::get&lt;TYPE&gt;(*this)</code>, where N and TYPE are the position of each type in the list of variant types.</li>\n<li>Within the out typemap this then allows us to lookup a Python function, using <code>which()</code> to determine what the variant currently holds. We've then got largely SWIG generated code, using existing typemaps to make a given variant into a Python object of the underlying type. Again that saves us a lot of effort and makes everything plug and play.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1572130360, "post_id": 58548290, "comment_id": 103466667, "body": "That&#39;s pretty neat"}], "tags": [], "owner": {"reputation": 2343, "user_id": 9448377, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Wim Lavrijsen", "link": "https://stackoverflow.com/users/9448377/wim-lavrijsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1571946755, "creation_date": 1571946755, "answer_id": 58548290, "question_id": 58415839, "link": "https://stackoverflow.com/questions/58415839/swig-and-boostvariant/58548290#58548290", "title": "SWIG and Boost::variant", "body": "<p>If you're decided on SWIG (which wasn't clear to me from your post as you said to be fairly new to SWIG, so I'm under the assumption that this is a new project), then stop reading and ignore this answer.</p>\n\n<p>But in case the bindings technology to use isn't fixed yet and you only need to bind Python, no other languages, an alternative is to use cppyy (<a href=\"http://cppyy.org\" rel=\"nofollow noreferrer\">http://cppyy.org</a>, and full disclaimer: I'm main author). With that, the boost::variant type is directly available in Python and then you can make it look/behave more Pythonistic by writing Python code rather than SWIG .i code.</p>\n\n<p>Example (note that cppyy has wheels for Windows on PyPI but built with MSVC2017, not MSVC2013, so I'll keep that caveat as to whether MSVC2013 is modern enough to build the code as I haven't tried):</p>\n\n<pre><code>import cppyy\n\ncppyy.include(\"boost/variant/variant.hpp\")\ncppyy.include(\"boost/variant/get.hpp\")\n\ncpp   = cppyy.gbl\nstd   = cpp.std\nboost = cpp.boost\n\ncppyy.cppdef(\"\"\"\nclass A\n{\n//constructors and such.\n};\n\nclass B\n{\n//constructors and such.\n};\n\nclass C\n{\n//constructors and such.\n};\n\"\"\")\n\nVariantType = boost.variant['A, B, C']\nVariantTypeList = std.vector[VariantType]\n\nv = VariantTypeList()\nv.push_back(VariantType(cpp.A()))\nprint(v.back().which())\nv.push_back(VariantType(cpp.B()))\nprint(v.back().which())\nv.push_back(VariantType(cpp.C()))\nprint(v.back().which())\n\nprint(boost.get['A'](v[0]))\ntry:\n    print(boost.get['B'](v[0]))\nexcept Exception as e:\n    print(e)   # b/c of type-index mismatch above\nprint(boost.get['B'](v[1]))  # now corrected\nprint(boost.get['C'](v[2]))\n</code></pre>\n\n<p>which produces the expect output of:</p>\n\n<pre><code>$ python variant.py\n0\n1\n2\n&lt;cppyy.gbl.A object at 0x5053704&gt;\nCould not instantiate get&lt;B&gt;:\n  B&amp; boost::get(boost::variant&lt;A,B,C&gt;&amp; operand) =&gt;\n    Exception: boost::bad_get: failed value get using boost::get (C++ exception)\n&lt;cppyy.gbl.B object at 0x505370c&gt;\n&lt;cppyy.gbl.C object at 0x5053714&gt;\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 12227158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf763fb3771e46fb76719d465cd763e8?s=128&d=identicon&r=PG&f=1", "display_name": "SwigAndThings", "link": "https://stackoverflow.com/users/12227158/swigandthings"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1571946755, "creation_date": 1571236486, "question_id": 58415839, "link": "https://stackoverflow.com/questions/58415839/swig-and-boostvariant", "title": "SWIG and Boost::variant", "body": "<p>I'm in the middle of trying to wrap a c++ project into a python api using SWIG and I'm running into an issue with code that has the following format. </p>\n\n<pre><code>class A\n{\n//constructors and such.\n};\n\nclass B\n{\n//constructors and such.\n};\n\nclass C\n{\n//constructors and such.\n};\n\ntypedef boost::variant&lt;A,B,C&gt; VariantType;\ntypedef std::vector&lt;boost::variant&lt;A,B,C&gt;&gt; VariantTypeList;\n</code></pre>\n\n<p>Classes A,B &amp; C all come out in the python wrapper without a problem and seem to be usable. However when I try to add the following lines to the interface file</p>\n\n<pre><code>%template(VariantType) boost::variant&lt;A,B,C&gt;;\n%template(VariantTypeList) std::vector&lt;boost::variant&lt;A,B,C&gt;&gt;;\n</code></pre>\n\n<p>I get an error that says</p>\n\n<blockquote>\n  <p>Boost\\x64\\include\\boost\\variant\\variant.hpp(148): error : Syntax error in input(3).</p>\n</blockquote>\n\n<p>So I go and look at the error and its a line that has a macro that is defined inside another header file specifically \"boost/mpl/aux_/value_wknd.hpp\" so I add that to the interface file with %include and now it appears that SWIG.exe crashes with an error helpfully stating</p>\n\n<blockquote>\n  <p>Access Violation</p>\n</blockquote>\n\n<p>So long story short is there a way to wrap a boost::variant template type? Unfortunately this template definition is baked into the core of our library and I can't change it now. Also if it matters I'm on the MSVC 2013 compiler. </p>\n\n<p>If it isn't possible to wrap the template type directly is it possible to work around this? I'm reading through the SWIG documentation to see if there is some typemap magic that can be applied but I'm fairly new to SWIG in general. </p>\n"}, {"tags": ["c++", "undefined-behavior", "clang++", "sanitizer"], "comments": [{"owner": {"reputation": 999, "user_id": 7859598, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-B2rVv02QIdo/AAAAAAAAAAI/AAAAAAAACew/FUFwHEbNSVo/photo.jpg?sz=128", "display_name": "Rietty", "link": "https://stackoverflow.com/users/7859598/rietty"}, "edited": false, "score": 3, "creation_date": 1571236446, "post_id": 58415759, "comment_id": 103174439, "body": "Well <code>0x7f8bcc403771 % 4 != 0</code>. So that&#39;s why it&#39;s complaining."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1571236479, "post_id": 58415759, "comment_id": 103174464, "body": "Showing a code sample that doesn&#39;t behave poorly does not show that there isn&#39;t undefined behavior. You cannot disprove undefined behavior by counter example no matter how thorough the counter example it. One of the permissible behaviors of UB is that it can act exactly how you would expect the code whatever that expectation might be (because <i>any</i> behavior is permissible). So whatever you expect well behaved code to do, UB may have the same behavior every time you check and still be UB."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1571236551, "post_id": 58415759, "comment_id": 103174519, "body": "<code>int *ptr = reinterpret_cast&lt;int*&gt;(&amp;data[1]);     *ptr = 0x11223344;</code> is UB.  There is no <code>int</code> at <code>ptr</code> so you can&#39;t write one to it.  This may change in the future (there is a proposal asking for it) but until that gets standardized it&#39;s UB."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1571236798, "post_id": 58415759, "comment_id": 103174689, "body": "In principal this should work, but you have no guarantee from the standard on the behavior of the program."}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1571237181, "post_id": 58415759, "comment_id": 103174948, "body": "@NathanOliver do you happen to have a link to that proposal by any chance?"}, {"owner": {"reputation": 2339, "user_id": 1102805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2de42f74b5509b8af4bd0f255d05fd94?s=128&d=identicon&r=PG", "display_name": "darcamo", "link": "https://stackoverflow.com/users/1102805/darcamo"}, "edited": false, "score": 0, "creation_date": 1571237646, "post_id": 58415759, "comment_id": 103175274, "body": "Note that <code>reinterpret_cast</code> is only defined if you cast some type <code>A</code> to <code>B</code> (but don&#39;t use it as <code>B</code>) and then back to <code>A</code>. Other uses are undefined behavior. For instance, It is useful when you need to pass data to a callback function that requires you to cast your data to <code>void *</code>. Then, inside the callback you cast it back to your original type."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1571237986, "post_id": 58415759, "comment_id": 103175487, "body": "@rustyx Found it: <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p0593r3.html\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg21/docs/papers/2019/p0593r3.html</a>"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1571238018, "post_id": 58415759, "comment_id": 103175511, "body": "Knowledge of undefined behavior is simply, either you know it or you don&#39;t know it.  You cannot disprove it by a code example that behaves &quot;correctly&quot;.  For example, I could probably take forever trying to get <code>char *p = new char [10]; delete p;</code> to fail, but I know that <code>delete p;</code> is undefined behavior.  Why do I know this?  Because the standard document told us it is."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1571244894, "post_id": 58415759, "comment_id": 103179024, "body": "I believe you can avoid the UB by doing: <code>int int_data = 0x11223344; memcpy(&amp;data[1], &amp;int_data, sizeof int_data);</code>.  Note there is platform specific behavior regarding endianness, and int size; I presume those things don&#39;t matter for your use case."}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1571254157, "post_id": 58415759, "comment_id": 103183099, "body": "What happens if you use struct packing (<code>__attribute__((packed))</code>) instead of <code>reinterpret_cast</code>, does that also trigger UBsan?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12227811, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c2a3e41c439fcd45a9dd510cfe3da5c7?s=128&d=identicon&r=PG", "display_name": "TeaRex", "link": "https://stackoverflow.com/users/12227811/tearex"}, "is_accepted": false, "score": 1, "last_activity_date": 1571242475, "creation_date": 1571242475, "answer_id": 58417646, "question_id": 58415759, "link": "https://stackoverflow.com/questions/58415759/undefined-behaviour-or-false-positive/58417646#58417646", "title": "Undefined behaviour or false positive", "body": "<p><code>malloc()</code> will always return a pointer that is suitably aligned for any possible data type. <code>&amp;data[1]</code> is a pointer to the <em>second</em> byte of that, which is obviously <em>not</em> aligned correctly for any data type that has an alignment requirement <code>&gt; 1</code>. Use <code>&amp;data[0]</code> or <code>&amp;data</code> if you want to have a pointer in the first four bytes of the malloc'ed memory. </p>\n"}], "owner": {"reputation": 43, "user_id": 1439487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c3ce3db5e856134d0d0a39a9ea26bcd?s=128&d=identicon&r=PG", "display_name": "vcarreira", "link": "https://stackoverflow.com/users/1439487/vcarreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571242475, "creation_date": 1571236222, "question_id": 58415759, "link": "https://stackoverflow.com/questions/58415759/undefined-behaviour-or-false-positive", "title": "Undefined behaviour or false positive", "body": "<p>I have some pieces of C++ code that when run on Xcode with Undefined Behaviour Sanitizer turned on reports: \"<code>runtime error: store to misaligned address 0x7f8bcc403771 for type 'int', which requires 4 byte alignment</code>\". </p>\n\n<p>So I created a small Catch2 test case to reproduce the code I have to check the runtime behaviour on both windows/x64 (MSVC) and Mac(Xcode 11/clang) but everything runs as expected even when compiled with the different types of optimisations (-O2, -O3, -Ofast, etc).</p>\n\n<p>The code in question is (Catch2 test case):</p>\n\n<pre><code>TEST_CASE(\"misaligned_write\", \"[demo]\") {\n    unsigned char *data = (unsigned char*)malloc(20);\n    memset(data, 0, 20);\n\n    int *ptr = reinterpret_cast&lt;int*&gt;(&amp;data[1]);\n    *ptr = 0x11223344; // undefined behaviour triggered\n    CHECK(static_cast&lt;uint8_t&gt;(data[1]) == 0x44);\n    CHECK(static_cast&lt;uint8_t&gt;(data[2]) == 0x33);\n    CHECK(static_cast&lt;uint8_t&gt;(data[3]) == 0x22);\n    CHECK(static_cast&lt;uint8_t&gt;(data[4]) == 0x11);\n}\n</code></pre>\n\n<p>So my question is: is this a undefined behaviour false positive or there's something in the code that could break in the future due to some changes on default compiler flags?</p>\n"}, {"tags": ["c++", "eigen"], "answers": [{"tags": [], "owner": {"reputation": 898, "user_id": 1606410, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EOAKA.png?s=128&g=1", "display_name": "Devon Cornwall", "link": "https://stackoverflow.com/users/1606410/devon-cornwall"}, "is_accepted": true, "score": 1, "last_activity_date": 1571236497, "creation_date": 1571236497, "answer_id": 58415846, "question_id": 58415685, "link": "https://stackoverflow.com/questions/58415685/eigen-error-invalid-matrix-product-multiplying-vector-and-matrix/58415846#58415846", "title": "Eigen error : INVALID_MATRIX_PRODUCT multiplying vector and matrix", "body": "<p><code>box_pos</code> is a column vector. If you write <code>box_pos *= RotY(5.0f)</code> you multiply the matrix from the right side and the inner dimensions (1 and 3) do not match.</p>\n\n<p>You either have to transpose <code>box_pos</code> and work with a row vector or rewrite the multiplication as</p>\n\n<pre><code>box_pos = RotY(5.0f) * box_pos;\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11914971, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vWYFZIzshrs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfbry8XQf9Kf0v7i_L-ODycEqBwsw/photo.jpg?sz=128", "display_name": "frannoo_", "link": "https://stackoverflow.com/users/11914971/frannoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 58415846, "answer_count": 1, "score": 0, "last_activity_date": 1571236497, "creation_date": 1571235994, "question_id": 58415685, "link": "https://stackoverflow.com/questions/58415685/eigen-error-invalid-matrix-product-multiplying-vector-and-matrix", "title": "Eigen error : INVALID_MATRIX_PRODUCT multiplying vector and matrix", "body": "<p>im working with c++ and eigen. I try to implement matrix rotation but i get this error <code>Eigen\\src/Core/GeneralProduct.h(410,3): error C2338:  INVALID_MATRIX_PRODUCT</code></p>\n\n<pre><code>    Eigen::Vector3f box_pos = Eigen::Vector3f(-2.0f, 2.5f, -2.0f);\n    box_pos *= RotY(5.0f);\n</code></pre>\n\n<p>RotY function : </p>\n\n<pre><code>   Eigen::Matrix3f RotY(float angle) {\n    float s = sin(angle);\n    float c = cos(angle);\n    Eigen::Matrix3f matrix;\n    matrix &lt;&lt; c, 0., s, 0., 1., 0., -s, 0., c;\n    return matrix;\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "dll", "crash", "exe"], "comments": [{"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 3, "creation_date": 1571236213, "post_id": 58415590, "comment_id": 103174286, "body": "Have you tried running your program from <code>cmd.exe</code> to see what output it produces? If it actually crashes, <a href=\"https://docs.microsoft.com/en-us/windows/win32/wer/collecting-user-mode-dumps\" rel=\"nofollow noreferrer\">force enable crashdumps</a> for your executable to see if that produces more information. You can also use something like Procmon to inspect any system calls that your process makes. Also keep in mind that running from visual studio  sets a <i>different working directory</i> than clicking the exe."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 2, "creation_date": 1571236379, "post_id": 58415590, "comment_id": 103174394, "body": "A first guess would be different environment settings/command line arguments between VS debugging and running the program manually. In fact, I wouldn&#39;t be surprised if you needed to pass some flags to it (which are set in the project options in VS but not present when running the executable by hand). Start it within <code>cmd.exe</code> as suggested above and see what happens."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1571236471, "post_id": 58415590, "comment_id": 103174458, "body": "&quot;<i>Firstly, this is my first ever question on here (I am used to reddit), so please be kind.</i>&quot; Did you try taking the <a href=\"https://stackoverflow.com/tour\">tour</a>, and reading through <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, and <a href=\"https://stackoverflow.com/help\">help center</a>? For instance, we don&#39;t require TLDRs here, as this is not a forum. If you don&#39;t read the question: you can&#39;t answer it."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1571236603, "post_id": 58415590, "comment_id": 103174560, "body": "Your issue is a common side-effect of uninitialized variables.  Debuggers often initialize all the variables before starting.  There are no guarantees when running with the executable."}, {"owner": {"reputation": 1, "user_id": 12221395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80f5086abacc93729f80eea8281b6954?s=128&d=identicon&r=PG&f=1", "display_name": "arbourdaze", "link": "https://stackoverflow.com/users/12221395/arbourdaze"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1571236931, "post_id": 58415590, "comment_id": 103174781, "body": "@Botje I did run it in cmd.exe sorry for not clarifying. It has the same issues as if running the .exe from the directory. I also made sure that the depended upon files were in the proper directory. Also, I did take the tour, but yah..."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1571237877, "post_id": 58415590, "comment_id": 103175426, "body": "<i>&quot;I cannot actually debug since...&quot;</i> - If it successfully runs from the VSIDE debugger, then you already <i>are</i> debugging it. Just running the program via F10  (step-over)  should take you to your first line in <code>main</code> or <code>WinMain</code>. (I&#39;m curious whether a <i>release</i> build (not a debug build) also runs successfully from the VS IDE. Finally, note that running from the IDE normally defaults to using the <i>project</i> folder as the working directory, whereas running via cmd uses whatever folder your shell is in at the time, or via explorer which uses whatever folder the exe lives in . That&#39;s important."}, {"owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "edited": false, "score": 0, "creation_date": 1571238327, "post_id": 58415590, "comment_id": 103175695, "body": "Just as a side-note, the windows dependency walker (depends.exe) is incredibly broken (in Windows 10) and will return many false positives, so don&#39;t rely on it if that&#39;s what you were using."}, {"owner": {"reputation": 1, "user_id": 12221395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80f5086abacc93729f80eea8281b6954?s=128&d=identicon&r=PG&f=1", "display_name": "arbourdaze", "link": "https://stackoverflow.com/users/12221395/arbourdaze"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1571241453, "post_id": 58415590, "comment_id": 103177442, "body": "@WhozCraig I was actually referring to when i run the executable. I am using dependency by lucas."}], "owner": {"reputation": 1, "user_id": 12221395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80f5086abacc93729f80eea8281b6954?s=128&d=identicon&r=PG&f=1", "display_name": "arbourdaze", "link": "https://stackoverflow.com/users/12221395/arbourdaze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571237018, "creation_date": 1571235712, "last_edit_date": 1571237018, "question_id": 58415590, "link": "https://stackoverflow.com/questions/58415590/program-runs-in-visual-studio-debugger-executable-doesnt-function-properly", "title": "Program runs in Visual Studio debugger. Executable doesn&#39;t function properly", "body": "<p>Firstly, this is my first ever question on here (I am used to reddit), so please be kind. Secondly, I have been recently hired to a company and was handed this task (one of my firsts) by my project manager. Thirdly, this solution/program was developed entirely by a different person who no longer is with the company, and I cannot contact.</p>\n\n<p>A part of our larger product and base implementation has been running into issues. This GUI based application was originally built in Windows 7 under an older SDK (around win7 time) and has been developed using Visual C++. The most recent, stable release was said to have built properly using Windows 10 SDK, and was built for x86 processors. It produced a working executable file for our customers to use. When I was handed this task, I was told that the development environment (Visual Studio) on other team members' machines was causing an issue where the solution would not build. They had tried using different windows SDKs, running in debug, running in release, using breakpoints. All of those solutions seemed to cause different and confusing errors.</p>\n\n<p>I can usually figure out most issues if they are code related; however I am just not sure if the code is the issue here. When I brought down the solution from our repository and built it (release mode, x86), it built perfectly fine. It has built fine since. It builds properly in debug mode and the program will run properly in the debugger for both the debug and release modes. It doesn't build for x64, but I was told it wasn't supposed to. Basically, I can run the program in Visual Studio and it works flawlessly. When I try to launch the executable it seems to abort right away, or stops with only briefly running (I never see a window).</p>\n\n<p>I first tried building it with multiple different SDKs and none of them resulted in a functioning executable. I then checked to make sure that the antivirus was not blocking the executable (I checked in the .exe's properties). Everything checked out OK. Both the machine and network are monitored by the company, but again I have been told that this shouldn't be stopping the .exe from running. It then seemed to be very possible that the .exe was having issues with dlls. I would like to say that I tried to do research on dlls but it was confusing and I am still not comfortable at all with the topic. That being said, I used a dependency program to figure out which dlls the program was needing/using. A few showed up as missing/failing: \"api-ms-win-core-wow65-l1-1-0.dll\", \"ext-ms-win-core-winrt-remote-l1-1-1.dll\", \"ext-ms-win-com-suspendresiliency-l1-1-0.dll\". I have NO clue whether or not this is actually true and/or is causing an issue with my program, nor would I know how to fix it. The best news here is that there is no logging being done. I cannot actually debug since it opens and shuts down right away after a proper build. I tried running in cmd.exe, but it failed identical to running in directory.</p>\n\n<p>I am running Windows 10. Using VS 2017. I will be bald by the end of the week. If you have questions on specifying certain things, please let me know. I am humble enough to admit when I have no idea about certain things so feel free.</p>\n"}, {"tags": ["c++", "casting", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1571234900, "post_id": 58415323, "comment_id": 103173416, "body": "the question is unclear. What is the problem when you try to print the value of a <code>void*</code>? Can you post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 994, "user_id": 2044454, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EsRrT.jpg?s=128&g=1", "display_name": "Victor Eijkhout", "link": "https://stackoverflow.com/users/2044454/victor-eijkhout"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1571236359, "post_id": 58415323, "comment_id": 103174379, "body": "You&#39;re right. Printing as such works; the trouble came from computing with it."}], "answers": [{"comments": [{"owner": {"reputation": 934, "user_id": 8474738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NdPIm.jpg?s=128&g=1", "display_name": "Nathanael Demacon", "link": "https://stackoverflow.com/users/8474738/nathanael-demacon"}, "edited": false, "score": 0, "creation_date": 1571237284, "post_id": 58415440, "comment_id": 103175010, "body": "What is undefined behaviour? The solution I gave works pretty well."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 1, "creation_date": 1571237499, "post_id": 58415440, "comment_id": 103175160, "body": "I overlooked both the question and your answer (hence the downvote, now reversed). This made me check <code>reinterpret_cast</code>-related rules. So there it is: <a href=\"http://eel.is/c++draft/expr.reinterpret.cast#4.sentence-1\" rel=\"nofollow noreferrer\"><code>[expr.reinterpret.cast]&#47;4</code></a> <i>&quot;A pointer can be explicitly converted to any integral type large enough to hold all values of its type.&quot;</i>"}], "tags": [], "owner": {"reputation": 934, "user_id": 8474738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NdPIm.jpg?s=128&g=1", "display_name": "Nathanael Demacon", "link": "https://stackoverflow.com/users/8474738/nathanael-demacon"}, "is_accepted": false, "score": 9, "last_activity_date": 1571237544, "last_edit_date": 1571237544, "creation_date": 1571235196, "answer_id": 58415440, "question_id": 58415323, "link": "https://stackoverflow.com/questions/58415323/what-is-the-proper-cast-from-void-to-long/58415440#58415440", "title": "What is the proper cast from void* to long?", "body": "<p>You can't <code>static_cast</code> a pointer to a non-pointer type. You may have to use <code>reinterpret_cast</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>reinterpret_cast&lt;long&gt;(ptr);\n</code></pre>\n\n<p>Also since you want to get a pointer address as an integer, it's better to use <code>intptr_t</code> present in <code>stdint.h</code> (which is made for this purpose):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>reinterpret_cast&lt;intptr_t&gt;(ptr);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10942507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a9d66d0bd3296d11430b8c34163af7?s=128&d=identicon&r=PG&f=1", "display_name": "delfunc", "link": "https://stackoverflow.com/users/10942507/delfunc"}, "is_accepted": false, "score": 0, "last_activity_date": 1571249247, "creation_date": 1571249247, "answer_id": 58419289, "question_id": 58415323, "link": "https://stackoverflow.com/questions/58415323/what-is-the-proper-cast-from-void-to-long/58419289#58419289", "title": "What is the proper cast from void* to long?", "body": "<p>to just print the address</p>\n\n<p>std::cout &lt;&lt; \"Pointer address = 0x\" &lt;&lt; void_pointer_var &lt;&lt; std::endl;</p>\n\n<p>presuming void_pointer_var is of type void*, this will print its value in hex.</p>\n\n<p>if its relevant for it to be in decimal then use a reinterpret cast</p>\n"}], "owner": {"reputation": 994, "user_id": 2044454, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EsRrT.jpg?s=128&g=1", "display_name": "Victor Eijkhout", "link": "https://stackoverflow.com/users/2044454/victor-eijkhout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1571249247, "creation_date": 1571234826, "last_edit_date": 1571236301, "question_id": 58415323, "link": "https://stackoverflow.com/questions/58415323/what-is-the-proper-cast-from-void-to-long", "title": "What is the proper cast from void* to long?", "body": "<p>I'm using <code>posix_memalign</code> (had trouble with <code>align_alloc</code>) to allocate (inside my own <code>new</code>) so I have a <code>void*</code>. I need it as int for instance to compute alignment:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing std::cout;\nusing std::cin;\nusing std::endl;\n\nint main() {\n\n  void *ptr;\n  auto align{4096}, size{10000};\n  posix_memalign( &amp;ptr,align,size );\n  cout &lt;&lt; ptr &lt;&lt; endl; // works\n  cout &lt;&lt; ptr % align &lt;&lt; endl; // not\n\n  return 0;\n}\n</code></pre>\n\n<p>I thought in modern C++ <code>static_cast&lt;long&gt;</code> would be the right way , but that gives an error that that's not allowed on a <code>void*</code>. So what is the proper way? I can of course use old-style C casts, but I'm trying to avoid those.</p>\n"}, {"tags": ["c++", "memory", "c++17", "enet"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 9, "creation_date": 1571234803, "post_id": 58415262, "comment_id": 103173352, "body": "<i>I need to find a way to intentionally leak the internal pointer of a std::vector so that its lifetime surpasses the one of the original container and so that it can be later deleted manually.</i> -- Sounds like the ultimate <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY Problem</a>."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1571235033, "post_id": 58415262, "comment_id": 103173502, "body": "Unless ENet is bugged, you should just use <code>new[]</code> and <code>delete[]</code> in this case."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 4, "creation_date": 1571235042, "post_id": 58415262, "comment_id": 103173509, "body": "I would consider extending the vector\u2019s lifetime instead."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 4, "creation_date": 1571235102, "post_id": 58415262, "comment_id": 103173548, "body": "What exactly stops you from keeping the underlying <code>std::vector</code> around while its <code>data()</code> pointer is in use by <code>enet_packet_create</code>?"}, {"owner": {"reputation": 655, "user_id": 7484210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ghd9L.jpg?s=128&g=1", "display_name": "0x400921FB54442D18", "link": "https://stackoverflow.com/users/7484210/0x400921fb54442d18"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1571235117, "post_id": 58415262, "comment_id": 103173557, "body": "@PaulMcKenzie 3/4 of my question explains X."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 2, "creation_date": 1571235261, "post_id": 58415262, "comment_id": 103173645, "body": "And we are telling you that based on your description of <code>X</code>, the <code>Y</code> you&#39;re gunning for is the wrong approach. If you&#39;re hellbent on using the footgun you&#39;ve thought of, your question is answered here: <a href=\"https://stackoverflow.com/questions/56127946/can-i-force-stdvector-to-leave-a-memory-leak?rq=1\" title=\"can i force stdvector to leave a memory leak\">stackoverflow.com/questions/56127946/&hellip;</a>. But I would advise you to reconsider."}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 2, "creation_date": 1571235533, "post_id": 58415262, "comment_id": 103173840, "body": "According to documentation, <code>ENetPacket</code> has a <code>void* userData</code> member that may be freely used by the application. Can&#39;t you simply store a pointer to the <code>std::vector</code> in there and delete it in the callback?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1571235665, "post_id": 58415262, "comment_id": 103173932, "body": "Yes, but you started off with the &#39;Y&#39; -- even the title of your post is &#39;Y&#39; oriented and raises eyebrows by anyone browsing the C++ question list."}, {"owner": {"reputation": 655, "user_id": 7484210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ghd9L.jpg?s=128&g=1", "display_name": "0x400921FB54442D18", "link": "https://stackoverflow.com/users/7484210/0x400921fb54442d18"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1571235673, "post_id": 58415262, "comment_id": 103173936, "body": "@uneven_mark great point, but that forces me to wastefully dynamically allocate the vector too."}, {"owner": {"reputation": 655, "user_id": 7484210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ghd9L.jpg?s=128&g=1", "display_name": "0x400921FB54442D18", "link": "https://stackoverflow.com/users/7484210/0x400921fb54442d18"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1571235732, "post_id": 58415262, "comment_id": 103173964, "body": "@MaxLanghof Sure, I could write it on my own with <code>new</code> and <code>delete</code>, but why reinvent the wheel when this problem has been already efficiently solved in the std library?"}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1571235857, "post_id": 58415262, "comment_id": 103174047, "body": "@0x400921FB54442D18 Then I don&#39;t see any way other than using raw dynamic allocated arrays. <code>std::vector</code> does not allow you to transfer ownership of the underlying allocation freely."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1571235864, "post_id": 58415262, "comment_id": 103174049, "body": "@0x400921FB54442D18 I see that you have considered the available alternatives. Avoiding dynamic allocation of the vector is (plausibly) a valid reason/constraint, and I think if you mentioned that in the question then there would be less raised eyebrows ;) Writing your own dynamic array that you can steal/release the allocated array from may be the next best alternative then. As stated, <code>std::vector</code> provides no such interface."}, {"owner": {"reputation": 655, "user_id": 7484210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ghd9L.jpg?s=128&g=1", "display_name": "0x400921FB54442D18", "link": "https://stackoverflow.com/users/7484210/0x400921fb54442d18"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1571235876, "post_id": 58415262, "comment_id": 103174058, "body": "@PaulMcKenzie Rust&#39;s Vec and Box have a way to leak the memory in this fashion, so I thought C++ could have something similar. I guess not."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1571236111, "post_id": 58415262, "comment_id": 103174207, "body": "If the overhead of dynamically allocating vectors is a problem you can resort to the typical solution of a vector pool containing persistent vectors which are allocated once (possibly statically, if you have an upper limit) and are never freed. &quot;Freeing&quot; here would be returning them to the pool for further use, without actually de-allocating any memory."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1571236288, "post_id": 58415262, "comment_id": 103174339, "body": "@0x400921FB54442D18 -- Vector&#39;s memory is controlled entirely by vector and whatever allocator was used.  There is no &quot;give me ownership of your memory&quot; or &quot;here, own this memory I created temporarily&quot; concept for vector.  Your best bet is to keep a vector alive and just reuse it when you need to.  Probably your code would have a slight speed improvement by holding onto a single vector and just issuing <code>resize()</code> calls instead going through the gauntlet of creating a vector from scratch each time."}], "answers": [{"comments": [{"owner": {"reputation": 655, "user_id": 7484210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ghd9L.jpg?s=128&g=1", "display_name": "0x400921FB54442D18", "link": "https://stackoverflow.com/users/7484210/0x400921fb54442d18"}, "edited": false, "score": 1, "creation_date": 1571234913, "post_id": 58415344, "comment_id": 103173423, "body": "This creates a memory leak of <code>sizeof(std::vector&lt;T&gt;)</code>."}, {"owner": {"reputation": 655, "user_id": 7484210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ghd9L.jpg?s=128&g=1", "display_name": "0x400921FB54442D18", "link": "https://stackoverflow.com/users/7484210/0x400921fb54442d18"}, "edited": false, "score": 0, "creation_date": 1571234953, "post_id": 58415344, "comment_id": 103173449, "body": "I did not literally mean to create a memory leak, the memory needs to be freed. Perhaps saying that I want to take ownership of the containers memory would be better."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 655, "user_id": 7484210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ghd9L.jpg?s=128&g=1", "display_name": "0x400921FB54442D18", "link": "https://stackoverflow.com/users/7484210/0x400921fb54442d18"}, "edited": false, "score": 0, "creation_date": 1571235301, "post_id": 58415344, "comment_id": 103173681, "body": "@0x400921FB54442D18: In order to take ownership of that memory, you&#39;d need to keep something around that would allow you to free it, right? Like a pointer to the memory? So why can&#39;t you just keep the <i>vector itself</i> around instead of a pointer?"}, {"owner": {"reputation": 655, "user_id": 7484210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ghd9L.jpg?s=128&g=1", "display_name": "0x400921FB54442D18", "link": "https://stackoverflow.com/users/7484210/0x400921fb54442d18"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1571235429, "post_id": 58415344, "comment_id": 103173763, "body": "@NicolBolas Where do I store the vector so that it can be freed? ENetPacket needs <code>unsigned char* data</code> and <code>size_t dataLength</code> (which is the raw data to be sent to the other side) alongside a callback that frees <code>data</code>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 655, "user_id": 7484210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ghd9L.jpg?s=128&g=1", "display_name": "0x400921FB54442D18", "link": "https://stackoverflow.com/users/7484210/0x400921fb54442d18"}, "edited": false, "score": 0, "creation_date": 1571235510, "post_id": 58415344, "comment_id": 103173817, "body": "@0x400921FB54442D18 <code>std::vector</code> just isn&#39;t designed to that it."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 655, "user_id": 7484210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ghd9L.jpg?s=128&g=1", "display_name": "0x400921FB54442D18", "link": "https://stackoverflow.com/users/7484210/0x400921fb54442d18"}, "edited": false, "score": 0, "creation_date": 1571235536, "post_id": 58415344, "comment_id": 103173841, "body": "@0x400921FB54442D18 A more or less straightforward solution would be a map from <code>unsigned char*</code> to <code>std::vector</code>, with the vector value being moved in (so no copy/reallocation happens during construction of the map entries). But that&#39;s certainly not the only way."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1571235572, "post_id": 58415344, "comment_id": 103173867, "body": "Maybe you could keep the <code>std::vector</code> in a <code>std::map&lt;unsigned char*, std::vector&lt;T&gt;&gt;</code>. Then the freeing callback could look up the vector in the map and erase it."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 655, "user_id": 7484210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ghd9L.jpg?s=128&g=1", "display_name": "0x400921FB54442D18", "link": "https://stackoverflow.com/users/7484210/0x400921fb54442d18"}, "edited": false, "score": 1, "creation_date": 1571236017, "post_id": 58415344, "comment_id": 103174136, "body": "@0x400921FB54442D18: &quot;<i>@NicolBolas Where do I store the vector so that it can be freed?</i>&quot; That&#39;s between you, your networking library, and the architecture of your system."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 1, "last_activity_date": 1571237283, "last_edit_date": 1571237283, "creation_date": 1571234884, "answer_id": 58415344, "question_id": 58415262, "link": "https://stackoverflow.com/questions/58415262/intentionally-leak-the-memory-of-a-stdvector/58415344#58415344", "title": "Intentionally leak the memory of a std::vector", "body": "<blockquote>\n  <p>I need to find a way to intentionally leak the internal pointer of a <code>std::vector</code></p>\n</blockquote>\n\n<p>Only way to leak the internal buffer of <code>std::vector</code> is to leak the vector itself. Example:</p>\n\n<pre><code>std::vector&lt;T&gt;* ptr = new std::vector&lt;T&gt;;\nptr = nullptr; // memory leaked succesfully\n</code></pre>\n\n<p>But leaking memory is not a good idea in general.</p>\n\n<blockquote>\n  <p>I did not literally mean to create a memory leak, the memory needs to be freed.</p>\n</blockquote>\n\n<p>In this case, the only solution is to make sure that the lifetime of the <code>std::vector</code> is longer than the usage of the buffer. A vector always releases the buffer it owns on destruction, and there is no way to extract ownership from it except into another vector.</p>\n\n<p>One way to achieve that is this:</p>\n\n<pre><code>// stored somewhere with guaranteed longer lifetime than any packet\nstd::unordered_map&lt;unsigned char*, std::vector&lt;unsigned char&gt;&gt; storage;\n\nvoid foo()\n{\n    std::vector&lt;unsigned char&gt; vec;\n    // fill vec here\n    unsigned char* ptr = vec.data();\n    storage[ptr] = std::move(vec);\n    auto destroy_callback = [](unsigned char* ptr) {\n        storage.erase(ptr);\n    }\n    // pass ptr and destroy_callback into some async API\n}\n</code></pre>\n\n<p>You could use a pool allocator to avoid redundant allocations for each packet.</p>\n\n<p>Example adapted form <a href=\"https://stackoverflow.com/questions/36643645/deny-stdvector-from-deleting-its-data/36644003#36644003\">this answer</a> (now that this question has shifted from leaking to transferring ownership, this is close to a duplicate). There's also an alternative suggestion in another answer to that same question which uses a custom allocator that \"steals\" the ownership</p>\n"}, {"tags": [], "owner": {"reputation": 2275, "user_id": 3742943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ijesw.jpg?s=128&g=1", "display_name": "LoPiTaL", "link": "https://stackoverflow.com/users/3742943/lopital"}, "is_accepted": false, "score": 2, "last_activity_date": 1571295701, "last_edit_date": 1571295701, "creation_date": 1571236797, "answer_id": 58415951, "question_id": 58415262, "link": "https://stackoverflow.com/questions/58415262/intentionally-leak-the-memory-of-a-stdvector/58415951#58415951", "title": "Intentionally leak the memory of a std::vector", "body": "<p>You don't need to leak anything. Just use the <code>userData</code> field of the <code>ENetPacket</code> structure to store the to-be-deleted <code>std::vector</code>, and just delete it in the callback:</p>\n\n<pre><code>void myCallback(ENetPacket *pkt) {\n    std::vector&lt;uint8_t&gt; *data=(std::vector&lt;uint8_t&gt; *)pkt-&gt;userData;\n    delete data;\n}\n\nvoid sendData() {\n    //Create the vector in heap, so it is not destroyed after returning from this function, effectively extending its life until the callback is called.\n    std::vector&lt;uint8_t&gt; *data=new std::vector&lt;uint8_t&gt;;\n    //Fill data here\n    ENetPacket *pkt=enet_packet_create(data.data(), data.size(), ENET_PACKET_FLAG_NO_ALLOCATE);\n    pkt-&gt;userData=(void*)data;\n    pkt-&gt;freeCallback=myCallback;\n</code></pre>\n\n<p>}</p>\n\n<p>The <code>userData</code> void pointer is a usual strategy to hold opaque user data and use it in callbacks, so the user of the library can retrieve the context in which the callback has been called.</p>\n\n<p>It can be anything (<code>void*</code>), from a state holder structure in order to do complex logic after the callback, or just a data pointer which needs to be freed like your case.</p>\n\n<hr>\n\n<p>From your comments, you say that you don't want to dynamically allocate the <code>vector</code>.</p>\n\n<p>Just remember that any data inside the vector has been dynamically allocated (unless a custom allocator has been used) and the <code>ENetPacket</code> structure has also been dynamically allocated (the passed flag just indicates not to allocate the <code>data</code>, not the structure)</p>\n\n<hr>\n\n<p>Finally, if you know (or can precompute) the size of the data, a different approach would be to create the packet passing a NULL data pointer. </p>\n\n<p>The function <code>enet_packet_create</code> will create the data buffer, and you can just fill the data directly in the packet buffer, without needing a different buffer and then copying it to the packet.</p>\n"}, {"tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": false, "score": 2, "last_activity_date": 1571237223, "creation_date": 1571237223, "answer_id": 58416090, "question_id": 58415262, "link": "https://stackoverflow.com/questions/58415262/intentionally-leak-the-memory-of-a-stdvector/58416090#58416090", "title": "Intentionally leak the memory of a std::vector", "body": "<p>This approach is not possible, even if <code>vector&lt;T&gt;</code> provided an interface to let you abscond with its memory. Let's get into why.</p>\n\n<p>Your problem exists because the site where you're going to free the memory is not given arbitrary data. It is only given a pointer to the memory to be freed. If this were not the case, then you'd just pass a pointer to the <code>vector&lt;T&gt;</code> itself to this location, or otherwise smuggle in a <code>vector&lt;T&gt;</code> object itself.</p>\n\n<p>In order to abscond with a <code>vector&lt;T&gt;</code>'s memory and successfully free it, you would have to play by <code>vector&lt;T&gt;</code>'s rules. Which means:</p>\n\n<ol>\n<li><p>You have to respect the size/capacity distinction. Not all of the memory allocated for a <code>vector&lt;T&gt;</code> actually contains live <code>T</code>s. So you have to know how many live <code>T</code>s there are in that memory, so that you can call their destructors properly (we'll get to an issue with that later).</p>\n\n<p>Now sure, for the <em>very specific</em> case of <code>unsigned char</code>, calling destructors is irrelevant, since they're trivial. But <code>vector&lt;T&gt;</code>'s interface needs to be uniform; if you can abscond with a <code>vector&lt;unsigned char&gt;</code>'s memory, then you must be able to abscond with any <code>vector&lt;T&gt;</code> in the same way. So any absconding interface must provide not just a pointer to the data, but also the size and capacity so that you can properly destroy the members of the container.</p></li>\n<li><p>You have to respect the <code>Allocator</code>. Remember: the template is <code>vector&lt;T, Allocator&gt;</code>, where <code>Allocator</code> is the type that does the memory allocation/deallocation, as well as creating/destroying the actual <code>T</code>s in the <code>vector</code>. And since you're allowed to provide specific objects of a particular <code>Allocator</code> instance, any absconding interface must store that specific <code>Allocator</code> object (or copy/move thereof) so that the allocation can be freed.</p>\n\n<p>Again, the specific case of <code>vector&lt;unsigned char&gt;</code> doesn't care, because the default allocator <code>std::allocator</code> just uses <code>::operator new/delete</code> to allocate/deallocate memory, and direct placement-new/destructor calls to create/destroy the <code>T</code>s. But again, a general absconding interface <em>must work</em> with any <code>T</code> and any <code>Allocator</code>. So it must account for all of that.</p></li>\n</ol>\n\n<p>Which means that, at the end of the day, when you abscond with a <code>vector</code>'s memory, that interface must provide an object that stores a pointer to the allocation, the number of live elements in that allocation, the size of that allocation (since the <code>Allocator</code> interface requires that), and the <code>Allocator</code> instance (or copy/move thereof) to use to destroy/deallocate the object.</p>\n\n<p>In short, absconding with a <code>vector&lt;T, Allocator&gt;</code>'s memory means <em>creating a <code>vector&lt;T, Allocator&gt;</code></em>.</p>\n\n<p>Which you can't do, as stated above. You have arrived at an inherently contradictory situation.</p>\n\n<p>There are two solutions:</p>\n\n<ol>\n<li><p>Change your code so that you can smuggle in a <code>vector&lt;T&gt;</code> to the location that . This could be done via some global/class-scoped/etc map from pointer-to-data to a <code>vector&lt;unsigned char&gt;*</code>. Or some other mechanism. You'll have to figure it out, because it depends on specific aspects of the system that you have not presented (this is the definition of the <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY Problem</a>).</p></li>\n<li><p>Stop using <code>vector&lt;unsigned char&gt;</code>. Instead, just heap-allocate an array of <code>unsigned char</code>, which you can destroy just fine.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 17223, "user_id": 1137388, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cRrYs.jpg?s=128&g=1", "display_name": "Cassio Neri", "link": "https://stackoverflow.com/users/1137388/cassio-neri"}, "is_accepted": false, "score": 0, "last_activity_date": 1571245165, "creation_date": 1571245165, "answer_id": 58418299, "question_id": 58415262, "link": "https://stackoverflow.com/questions/58415262/intentionally-leak-the-memory-of-a-stdvector/58418299#58418299", "title": "Intentionally leak the memory of a std::vector", "body": "<p>The following is not an answer! It's yet another attempt to convince you to rethink your approach but it's too long for a comment. (Having said that, I must say that I love this type of hacks when it's just for fun but I hate them even more strongly when they go to production code.)</p>\n\n<p>From the OP, the motivation to use the <em>\"no alloc\"</em> option is to avoid memory allocation and copying bytes inside <code>enet_packet_create</code>. This brings me the question why using a <code>vector</code>?</p>\n\n<p>If you create a <code>vector</code> but do not fix its its capacity (with <code>reserve</code> or <code>resize</code>) from the beginning and, instead, let it to increase as you add elements, then each time capacity is increased <code>vector</code> will allocate memory and copy bytes which is exactly what you want to avoid.</p>\n\n<p>Perhaps you know from the beginning what the final size of the <code>vector</code> will be. In this case, you can avoid all copies and memory allocations (but one) by reserving that size from the beginning. In this case why not simply using a <code>new[]</code> and <code>delete[]</code> as Quentin has suggested? You wouldn't have to steal memory since it would be yours. Even better, you can create an <code>unique_ptr&lt;unsigned char[]&gt;</code> (consider <code>make_unique&lt;unsigned char[]&gt;</code>), use its <code>release</code> method just before calling <code>enet_packet_create</code> to \"steal\" the memory and later call <code>delete[]</code> to free the memory.</p>\n"}], "owner": {"reputation": 655, "user_id": 7484210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ghd9L.jpg?s=128&g=1", "display_name": "0x400921FB54442D18", "link": "https://stackoverflow.com/users/7484210/0x400921fb54442d18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 1, "answer_count": 4, "score": 1, "last_activity_date": 1571295701, "creation_date": 1571234663, "last_edit_date": 1571235183, "question_id": 58415262, "link": "https://stackoverflow.com/questions/58415262/intentionally-leak-the-memory-of-a-stdvector", "title": "Intentionally leak the memory of a std::vector", "body": "<p>I need to find a way to intentionally leak (take ownership of) the internal pointer of a <code>std::vector</code> so that its lifetime surpasses the one of the original container and so that it can be later deleted manually.</p>\n\n<p>Why? I'm working on a networked application using the C ENet library that needs to send large amounts of packets in a short amount of time.</p>\n\n<p>I create network messages by writing the data to a <code>std::vector&lt;unsigned char&gt;</code>.</p>\n\n<p>Then in order to create a \"packet,\" I use the <code>enet_packet_create</code> function, which takes a pointer to a byte array to be sent and its size. In normal mode of operation, the function simply dynamically duplicates the given array on the heap, but there is also a \"no allocate\" option which only takes the pointer and size, leaving deleting to the creator using a callback function, and that's exactly what I'm trying to achieve -- the data is already there in the vector ready to be used, so there is no need to copy it again, as it could be costly.</p>\n"}, {"tags": ["c++", "parsing", "binaryfiles"], "answers": [{"tags": [], "owner": {"reputation": 1700, "user_id": 3025534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iI4D8.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/3025534/alan"}, "is_accepted": true, "score": 0, "last_activity_date": 1571241010, "creation_date": 1571241010, "answer_id": 58417245, "question_id": 58415251, "link": "https://stackoverflow.com/questions/58415251/reading-ifstream-to-char-for-both-int-and-string-conversion/58417245#58417245", "title": "Reading ifstream to char* for both int and string conversion", "body": "<p>Ok, so the problem is that you need to read the file into an <code>unsigned char vector</code> / array. Also don't use <code>fgetwc</code> or you will only get every other byte, AND it detects when there are multiple null bytes in a row and combines them which can throw off your count. <code>Ifstream</code> didn't seem to have a simple way to read only part of the file into an <code>unsigned char vector</code></p>\n\n<pre><code>int LineLength = 300;\nint counter = 0;\nstd::vector&lt;unsigned char&gt; line(LineLength);\nwhile ((c = fgetw(\"BinaryFile.bin\")) != WEOF) {\n    line[counter] = static_cast&lt;unsigned char&gt;(c);\n    counter++;\n    if (counter &gt; LineLength - 1) {\n        break;\n    }\n}\n</code></pre>\n\n<p>Then once you have it in the vector, you can handle the data separately</p>\n\n<pre><code>for (string Name : DataType) { // here just looping over the columns that were defined in the JSON file - excluding some things that aren't relevant\n{\n    char* locale = setlocale(LC_ALL, \"UTF-8\");\n    std::vector&lt;unsigned char&gt; CurrentColumnBytes(ColumnWidth);     \n    for (int C = StartingPosition; C &lt; ColumnWidth + StartingPosition; ++C)\n    {\n        int Index = C - StartingPosition;       \n        CurrentColumnBytes[Index] = BufferedLine[C];\n    }\n    if (DataType == \"int\") {    \n        cout &lt;&lt; DataParser::LEByte(CurrentColumnBytes); //custom function that tests length, converts to Little Endian int from the individual bytes.\n    }\n    if (DataType == \"string\") {\n        for (int i = 0; i &lt; ColumnWidth; i++)\n            cout&lt;&lt;CurrentColumnBytes[i];\n    }\n    cout&lt;&lt;\" | \";    \n}\n</code></pre>\n"}], "owner": {"reputation": 1700, "user_id": 3025534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iI4D8.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/3025534/alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 58417245, "answer_count": 1, "score": 0, "last_activity_date": 1571241010, "creation_date": 1571234633, "last_edit_date": 1571235644, "question_id": 58415251, "link": "https://stackoverflow.com/questions/58415251/reading-ifstream-to-char-for-both-int-and-string-conversion", "title": "Reading ifstream to char* for both int and string conversion", "body": "<p>I am having some trouble parsing a binary data file with the following which reads the first line</p>\n\n<pre><code>int LineLength = 300;\nint Offset= 4586;\nifstream ifn(\"BinaryFile.bin\");\nchar* line = new char[LineLength];\nifn.seekg(Offset);\nwhile (ifn.good())\n{\n    ifn.read(line, LineLength);\n}   \nfor (int i = 0; i &lt; LineLength; i++)\n    printf(\"%02X \", line[i]);\n</code></pre>\n\n<p>This is printing out:</p>\n\n<pre><code>00 FFFFFFDD 01 00 00 22 FFFFFFB0 01 00 03 4F 50 2D 31 01 31 32 33 \n</code></pre>\n\n<p>When I use a hex editor to see the original data, it looks like this:</p>\n\n<pre><code>00 55 24 00 00 F4 BC 01 00 03 4F 50 2D 31 01 31 32 33\n</code></pre>\n\n<p>I really don't want it to alter the data, I am needing to convert some bytes to integers, and some to strings, and some will end up as dates as well, but I am having some real challenges.</p>\n\n<pre><code>string* DataType= new string[3]{ \"int\",\"int\",\"string\" };\nint*  StartingPosition =new int[3] { 1,10,11 };\nint*  ColumnWidth =new int[3] { 4,1,25 };       \nchar* locale = setlocale(LC_ALL, \"UTF-8\");\n\nfor (string Name : DataType) {\n    std::vector&lt;char&gt; CurrentColumnBytes(ColumnWidth);\n    for (int C = StartingPosition; C &lt; ColumnWidth + StartingPosition; ++C)\n    {\n        int Index = C - StartingPosition;       \n        CurrentColumnBytes[Index] = line[C];\n    }\n    if (DataType == \"int\") {\n        // still working out how to get a little endian result from 2-4 bytes if I use char\n        // since it is combining bytes as shown above\n    }\n    if (DataType == \"string\") {\n        for (std::vector&lt;char&gt;::const_iterator i = CurrentColumnBytes.begin(); i != CurrentColumnBytes.end(); ++i)\n            std::cout &lt;&lt; *i;\n    }\n}\n</code></pre>\n\n<p>I tried using <code>wchar_t</code> and <code>wint_t</code> instead of <code>char</code> as the type. With <code>wint_t</code> I was able to convert multiple bytes to a little endian int, but then I can't seem to get a string out of it. </p>\n\n<p>For what it is worth, I also tried using the following where I was able to get the integers, but not the strings.       </p>\n\n<pre><code>int LineLength = 300;\nint counter = 0;\nwchar_t* line = new wchar_t[LineLength];\nwhile ((c = fgetwc(\"BinaryFile.bin\")) != WEOF) {\n    line[counter] = c;\n    counter++;\n    if (counter &gt; LineLength - 1) {\n        break;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "initialization", "aggregate", "constexpr", "default-constructor"], "comments": [{"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1571301873, "post_id": 58415211, "comment_id": 103197861, "body": "What&#39;s wrong with <code>int a{}, b{}, c = 3;</code>?"}, {"owner": {"reputation": 922, "user_id": 12124759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16e152dcd0efc448c3f32260f3bfd7a9?s=128&d=identicon&r=PG&f=1", "display_name": "Baptistou", "link": "https://stackoverflow.com/users/12124759/baptistou"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1571305593, "post_id": 58415211, "comment_id": 103200084, "body": "@L.F. it makes <i>a</i> and <i>b</i> optional, only <i>c</i> should be."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1571305676, "post_id": 58415211, "comment_id": 103200135, "body": "Then why should <code>test()</code> compile?"}, {"owner": {"reputation": 922, "user_id": 12124759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16e152dcd0efc448c3f32260f3bfd7a9?s=128&d=identicon&r=PG&f=1", "display_name": "Baptistou", "link": "https://stackoverflow.com/users/12124759/baptistou"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1571322659, "post_id": 58415211, "comment_id": 103210358, "body": "Because every types should be default constructible, even enums are for example."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1571361074, "post_id": 58415211, "comment_id": 103224566, "body": "No, not every type has to be default constructible.  In this case, you don\u2019t want the a and b to be omitted, so it doesn\u2019t make much sense to make test default constructible.  Enums are just an example of default constructible type; A satisfies P doesn\u2019t mean everything should satisfy P."}, {"owner": {"reputation": 922, "user_id": 12124759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16e152dcd0efc448c3f32260f3bfd7a9?s=128&d=identicon&r=PG&f=1", "display_name": "Baptistou", "link": "https://stackoverflow.com/users/12124759/baptistou"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1571387221, "post_id": 58415211, "comment_id": 103231823, "body": "But in this example, <code>test</code> must be and is default constructible without constant expression context, but I need also to default initialize it in constexpr. The problem is the inconsistency of behavior with this aggregate."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1571387385, "post_id": 58415211, "comment_id": 103231903, "body": "Hmm ...  If you want test to be default constructible, then you are allowing a and b to be omitted."}], "owner": {"reputation": 922, "user_id": 12124759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16e152dcd0efc448c3f32260f3bfd7a9?s=128&d=identicon&r=PG&f=1", "display_name": "Baptistou", "link": "https://stackoverflow.com/users/12124759/baptistou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571387830, "creation_date": 1571234519, "last_edit_date": 1571387830, "question_id": 58415211, "link": "https://stackoverflow.com/questions/58415211/aggregate-constexpr-default-contructor-error-with-partial-nsdmi", "title": "Aggregate constexpr default contructor error with partial NSDMI", "body": "<p>I have a simple structure below which is used in constant expressions with <a href=\"https://en.cppreference.com/w/cpp/language/aggregate_initialization\" rel=\"nofollow noreferrer\">aggregate initialization</a> syntax. Now, I would like to make <code>test::c</code> optional thanks to <a href=\"https://en.cppreference.com/w/cpp/language/data_members#Member_initialization\" rel=\"nofollow noreferrer\">NSDMI</a> but this triggers an error for the default constructor in constant expression context with gcc and clang.</p>\n\n<p>I don't understand why implicit default constructor default-initializes all members in first case but not with NSDMI.\nThere is no error if I set default value to all members but this is not what I want.\nMoreover, I cannot declare a default constructor because the structure will no longer be an aggregate.</p>\n\n<ol>\n<li>How the default contructor is implicitly generated in both case ? Is there a standard rule ?</li>\n<li>Is there a way to fix the error and conserve the warning <em>[-Wmissing-field-initializers]</em> ?</li>\n</ol>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"debug.h\"\n\nstruct test {\n    //OK\n    /* int a, b, c; */\n    /* int a=0, b=0, c=3; */\n    //ERROR\n    int a, b, c=3;\n};\n\nint main(){\n    const test val1 = test();     //{0,0,3}\n    constexpr test val2 = test(); //error: call to non-'constexpr' function 'test::test()'\n    constexpr test val3 = {};     //{0,0,3}\n    constexpr test val4 = {1};    //warning: missing initializer for member 'test::b'\n    constexpr test val5 = {1,2};  //{1,2,3}\n}\n</code></pre>\n\n<p>Output :</p>\n\n<pre><code>test.cpp: In function 'int main()':\ntest.cpp:13:32: error: call to non-'constexpr' function 'test::test()'\n     constexpr test val2 = test();\n                                ^\ntest.cpp:3:8: note: 'test::test()' is not usable as a 'constexpr' function because:\n struct test {\n        ^~~~\ntest.cpp:8:9: note: defaulted default constructor does not initialize 'int test::a'\n     int a, b, c=3;\n         ^\ntest.cpp:8:12: note: defaulted default constructor does not initialize 'int test::b'\n     int a, b, c=3;\n            ^\ntest.cpp:15:29: warning: missing initializer for member 'test::b' [-Wmissing-field-initializers]\n     constexpr test val4 = {1};\n                             ^\n</code></pre>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["c++", "multithreading", "atomic", "compare-and-swap", "stdatomic"], "comments": [{"owner": {"reputation": 1241, "user_id": 8424429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9002f7998cce992a047bee84a5129c37?s=128&d=identicon&r=PG&f=1", "display_name": "curiousguy12", "link": "https://stackoverflow.com/users/8424429/curiousguy12"}, "edited": false, "score": 1, "creation_date": 1571247494, "post_id": 58415118, "comment_id": 103180197, "body": "At <code>T4</code>, if <code>pushlist.load != old</code>, the first argument (<code>old</code>, an lvalue reference) will be updated to the current value of <code>pushlist</code> and it should work the second attempt."}, {"owner": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "reply_to_user": {"reputation": 1241, "user_id": 8424429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9002f7998cce992a047bee84a5129c37?s=128&d=identicon&r=PG&f=1", "display_name": "curiousguy12", "link": "https://stackoverflow.com/users/8424429/curiousguy12"}, "edited": false, "score": 0, "creation_date": 1571251250, "post_id": 58415118, "comment_id": 103181857, "body": "Agree. I missed reading that part in cpp reference."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1572749318, "post_id": 58415118, "comment_id": 103654909, "body": "<i>Unless you want an answer about a specific C++ version that is not the most recent one, and only that one, you don&#39;t need a C++ version tag like <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b11\">c++11</a>.</i> I have replaced it with the <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a> as ppl are more likely to watch that general tag."}], "owner": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1572749196, "creation_date": 1571234259, "last_edit_date": 1572749196, "question_id": 58415118, "link": "https://stackoverflow.com/questions/58415118/a-lock-free-queues-push-operation-using-compare-exchange-weak", "title": "A lock-free queue&#39;s push operation using compare_exchange_weak", "body": "<p>I've come across a lock-free queue that supports multi-producer and a consumer, the push operation of the queue goes like this </p>\n\n<pre><code>inline void push(LT* item)\n{\n\n    LT *old = pushlist.load(std::memory_order_relaxed);\n    do {\n        item-&gt;next = old;\n    } while (!pushlist.compare_exchange_weak(old, item, \n                                             std::memory_order_release));\n}\n</code></pre>\n\n<p><code>pushlist</code> is an atomic pointer-variable and I am thinking about a scenario where two threads are on this code </p>\n\n<p>Thread1 :</p>\n\n<ul>\n<li>T1# Loads the pointer (won't LOCK# anything) </li>\n<li><strong>T2#</strong> Goes to loop and hook the head (<code>old</code>) into new item</li>\n<li>T3# Now in the cmpxchg(LOCK#); it expects head (<code>old</code>) to be * this-- which is true, so swap will be successful</li>\n</ul>\n\n<p>Thread2: </p>\n\n<ul>\n<li><strong>T2#</strong> Loads the pointer (won't LOCK# anything) </li>\n<li>T3# Goes to loop and hook the head (<code>old</code>) into its new item</li>\n<li>T4# Now cmpxchg will expect head (<code>old</code>) to be * this-- which is not I guess, because Thread1 already changed it, so <code>old</code> isn't the head anymore, operation will be unsuccessful......now, will it not going to spin?</li>\n</ul>\n\n<p>I tested it, works fine, yet I am not clear how it does.</p>\n\n<pre><code>auto work = [&amp;p](auto name){\n    int i{0};\n    linked_item&lt;int&gt; dummy{};\n    for(; i &lt; 100 ; ++i){\n        p.push(&amp;dummy);\n    }\n    std::cout&lt;&lt;name&lt;&lt;\" finished\"&lt;&lt; i &lt;&lt; \"\\n\";\n};\nstd::thread t1{work, \"t1\"}, t2{work, \"t2\"};\nt1.join(); t2.join();\n</code></pre>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1571234166, "post_id": 58414966, "comment_id": 103172899, "body": "The requirements (const member and any form of assignment that changes the state of said member) seem contradictory. In the end, you&#39;re writing to a const thing, which should be undefined behaviour."}, {"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1571234299, "post_id": 58414966, "comment_id": 103172995, "body": "@juanchopanza This is just a small example. In the actual class there are many other members that are not const. And, since this is a <b>move</b>, no logical state actually changes since the other (non-const) member of the moved-from class are modified to mark it as invalid."}, {"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1571234350, "post_id": 58414966, "comment_id": 103173034, "body": "@juanchopanza And &quot;writing to a const thing&quot; is not undefined in this case, since the move constructor not only happily assignes to it, but it is <b>required</b> to do so, same as in the normal constructor, since there is no other way (short of using a const_cast) to initialize const members."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1571234476, "post_id": 58414966, "comment_id": 103173116, "body": "It <i>is</i> indefined behaviour. Assigment is not initialization. You&#39;re writing to it in an assignment operator."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1571234512, "post_id": 58414966, "comment_id": 103173145, "body": "The move constructor <i>initialized</i> the const member - it didn&#39;t <i>assign</i> - there&#39;s an important difference. Also, for the move assignment, there <i>is</i> a logical state change in the moved-to object."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1571234672, "post_id": 58414966, "comment_id": 103173239, "body": "For example : what happens if the compiler relies on the <code>const</code>-ness of the member to optimize accesses to it, and a move assignment is allowed to change the member&#39;s value anyway ?"}, {"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1571234948, "post_id": 58414966, "comment_id": 103173446, "body": "@juanchopanza In that case, why is the move constructor allowed to write to it? What is the different between writing to newly allocated memory and memory where some object, of the same type, lived before?"}, {"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1571235039, "post_id": 58414966, "comment_id": 103173505, "body": "@SanderDeDycker This is exactly why I invoke the move <b>constructor</b> from the assignment. And the member is <b>const</b> exactly for the reason so the compiler could optimize access to it. But how is it any different from move constructing?"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1571235596, "post_id": 58414966, "comment_id": 103173880, "body": "@Equilibrius It is allowed to write to it because the compiler isn&#39;t smart enough to figure out you&#39;re invoking UB."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 1, "creation_date": 1571235623, "post_id": 58414966, "comment_id": 103173901, "body": "Invoking the move constructor isn&#39;t a magic bullet that allows you to modify a <code>const</code>. Think about it (<code>C obj{42};</code>) : if the compiler assumes that the value of <code>obj.i</code> won&#39;t change - ie. will always be <code>42</code> (it can assume that - it&#39;s <code>const</code> after all), and then you do <code>C obj2{666}; obj = std::move(obj2);</code>, suddenly <code>obj.i</code> will <i>actually</i> be <code>666</code>, which means the compiler&#39;s assumption is violated."}, {"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1571235815, "post_id": 58414966, "comment_id": 103174013, "body": "@SanderDeDycker The thing is, your code is perfectly valid. In fact, this <b>is</b> how the move assignment should be used. Given: <code>C o{C{666}};</code> The sate of <code>o</code> after this is valid and contains 666, no matter what (undefined) value <code>i</code> had at the initial construction of <code>o</code>."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1571236183, "post_id": 58414966, "comment_id": 103174265, "body": "You have 3 people here telling you the same thing in different ways, and none of them seem to sink in. May I suggest you take a few minutes to think the example from my previous comment through ? Specifically, think about how the compiler would be able to optimize access to a <code>const</code> if (according to what you assert) its value can be legally changed by invoking the move constructor. Such optimization would be impossible, and <code>const</code> wouldn&#39;t mean anything. For that reason, modifying a <code>const</code> is not allowed (in any way)."}, {"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1571236308, "post_id": 58414966, "comment_id": 103174349, "body": "@SanderDeDycker This code is <b>valid</b>: <code>struct C { \tconst int i; \tC(int i) : i{i} {} \tC(C &amp;&amp; other) : i{other.i + 1} {} };</code> Note that <code>i</code> is <b>modified</b> in the move constructor. So modifying a <code>const</code> is allowed. Otherwise how could you <i>initialise</i> it?"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1571236407, "post_id": 58414966, "comment_id": 103174413, "body": "Sure, move construction is valid (as said before, there&#39;s no <code>const</code> being modified during construction - it&#39;s being <i>initialized</i>). But we&#39;re talking about move <i>assignment</i>."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1571236645, "post_id": 58414966, "comment_id": 103174595, "body": "I suspect the confusion lies in what <i>initialize</i> means : it means to set the initial value - ie. there was no value before it (it was uninitialized before it), hence no value is being modified."}, {"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1571236672, "post_id": 58414966, "comment_id": 103174615, "body": "@SanderDeDycker When it is <i>initialized</i> the memory contents where it is placed is <i>modified</i>, or, in other words, <i>assigned</i> to. I try to understand the difference."}, {"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1571236789, "post_id": 58414966, "comment_id": 103174678, "body": "@SanderDeDycker To emphasize, to my understanding <i>initialisation</i> is just an assignment to a previously undefined value. But, non the less, it <b>is</b> assignment to some value. And, please note, my <code>i</code> is <b>always</b> trivially cosntructible. It&#39;s never an object."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1571237753, "post_id": 58414966, "comment_id": 103175348, "body": "You&#39;re conflating different abstraction layers. The <code>const</code> refers to the object. An object can be stored in memory, but just because the object is <code>const</code> doesn&#39;t mean that memory is immutable. Whatever happens to be in that memory location before the object is initialized is irrelevant - the object didn&#39;t exist yet, and hence the <code>const</code> didn&#39;t apply. As soon as the object is initialized though, the <code>const</code> has to be honored. Or iow : while the memory contents are modified during the constructor call, the object isn&#39;t (because it didn&#39;t exist yet)."}, {"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1571239085, "post_id": 58414966, "comment_id": 103176171, "body": "@SanderDeDycker From <a href=\"https://timsong-cpp.github.io/cppwp/basic.life\" rel=\"nofollow noreferrer\">timsong-cpp.github.io/cppwp/basic.life</a> I read that when the destructor executes the object is no longer alive. Given that in my code I do execute the destructor <i>before</i> invoking the move constructor, would it not means that I&#39;m moving into a, basically, <i>uninitialized</i> object? So this makes invoking the move constructor valid, no?"}], "answers": [{"comments": [{"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "edited": false, "score": 0, "creation_date": 1571234770, "post_id": 58415092, "comment_id": 103173322, "body": "I&#39;m not sure this applies the my case. The normal move (or any) constructor initializes the const member. This is perfectly normal and, in fact, required. The question is about the implementation of the move <b>assignment</b>. And my <code>i</code> is <code>const</code> not to restrict access (it&#39;s not used outside the object and is private in my actual implementation) but to notify the compiler that it&#39;s value will never change. Thus allowing it to catch programming error and better optimize the code."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "edited": false, "score": 1, "creation_date": 1571235116, "post_id": 58415092, "comment_id": 103173556, "body": "@Equilibrius This does apply because when you do <code>new(this) C {std::move(other)};</code> you emplace over a const member so you can no longer refer to that object.  You&#39;d have to do something like <code>auto ptr = new(this) C {std::move(other)}; return *ptr;</code> but even then you still can&#39;t use the object in your calling code."}, {"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "edited": false, "score": 0, "creation_date": 1571235464, "post_id": 58415092, "comment_id": 103173784, "body": "I&#39;m still finding it difficult to understand why this is invalid. I think it is safe to assume that when the compiler actually invokes a move <b>constructor</b> it also uses the same emplace mechanism, since the destination memory is already allocated. And, in that case, there is no problem using the moved-to object after that."}, {"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "edited": false, "score": 0, "creation_date": 1571235469, "post_id": 58415092, "comment_id": 103173787, "body": "I can not really understand how my case is different. The moved-to object does not moves in memory. It only changes some internal state. From &quot;<a href=\"https://en.cppreference.com/w/cpp/language/new\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/new</a>&quot;:  Such allocation functions are known as &quot;placement new&quot;, ... void* operator new(std::size_t, void*), which simply returns its second argument unchanged."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "edited": false, "score": 0, "creation_date": 1571235622, "post_id": 58415092, "comment_id": 103173899, "body": "@Equilibrius Think about <i>The moved-to object does not moves in memory. It only changes some internal state</i>.  You are putting a new value in memory that should not change.  How should the machine handle that?  C++ says it doesn&#39;t and you can only get this new value by access through a pointer or reference to the <code>new</code> object you create."}, {"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "edited": false, "score": 0, "creation_date": 1571236576, "post_id": 58415092, "comment_id": 103174535, "body": "I&#39;ll quote the code from my comment in the question thread: <code>struct C { const int i; C(int i) : i{i} {} C(C &amp;&amp; other) : i{other.i + 1} {} };</code> How is this handled? Given that when the move constructor starts execution there is already some, undefined, value at the memory location of <code>i</code>. And the constructor changes that value. This is <code>const</code>, not <code>constexpr</code>. So there is actually memory allocated."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "edited": false, "score": 0, "creation_date": 1571236750, "post_id": 58415092, "comment_id": 103174659, "body": "@Equilibrius I&#39;m not sure what more I can say here.  The standard explicitly states this is not allowed. The construction is allowed because until you reach <code>i{other.i + 1} </code> there is no actual <code>i</code> object.  That line creates and initializes it in one go."}, {"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "edited": false, "score": 0, "creation_date": 1571236996, "post_id": 58415092, "comment_id": 103174825, "body": "I&#39;m sorry. I&#39;m just really confused about this. I can understand why this is not allowed if <code>i</code> is not trivially constructible. And I understand why this actually works in my case. Your quote sais that &quot;and, if a class type, does not contain any non-static data member&quot;. But my <code>i</code> is <b>not</b> a class type. It&#39;s always int."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "edited": false, "score": 0, "creation_date": 1571237064, "post_id": 58415092, "comment_id": 103174872, "body": "@Equilibrius <code>i</code> is not a class type but <code>C</code> is.  You can no longer refer to the <code>C</code> object and that is transitive to <code>i</code> since <code>i</code> is a member of the <code>C</code> object you just invalidated."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 5, "last_activity_date": 1571234179, "last_edit_date": 1592644375, "creation_date": 1571234179, "answer_id": 58415092, "question_id": 58414966, "link": "https://stackoverflow.com/questions/58414966/move-construction-and-assignment-of-class-with-constant-member/58415092#58415092", "title": "Move construction and assignment of class with constant member", "body": "<p>Unfortunately this is undefined behavior.  You cannot overwrite a const object like this and refer to it by the same name afterwards.  This is covered by <a href=\"https://timsong-cpp.github.io/cppwp/basic.life#8\" rel=\"nofollow noreferrer\">[basic.life]/8</a></p>\n<blockquote>\n<p>If, after the lifetime of an object has ended and before the storage which the object occupied is reused or released, a new object is created at the storage location which the original object occupied, a pointer that pointed to the original object, a reference that referred to the original object, or the name of the original object will automatically refer to the new object and, once the lifetime of the new object has started, can be used to manipulate the new object, if: [...]</p>\n<ul>\n<li>the type of the original object is not const-qualified, and, if a class type, does not contain any non-static data member whose type is const-qualified or a reference type, [...]</li>\n</ul>\n</blockquote>\n<p>The simple fix is to make <code>i</code> non const and private and just use a getter to stop any modification from happening.</p>\n"}, {"comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1571295870, "post_id": 58418036, "comment_id": 103194790, "body": "Good summary. Glad you made it through the maze that is the C++ standard :)"}, {"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1571299918, "post_id": 58418036, "comment_id": 103196831, "body": "Me too. I like standards. :-) At the end of the day the class that had this move assignment really did not need it at all. The only place I used it was in a test that checked this move assignment works. Catch 22. How ethical will it be to accept my own answer in this case instead of the one by @NathanOlver ?"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1571304776, "post_id": 58418036, "comment_id": 103199570, "body": "Accepting your own answer is <a href=\"https://stackoverflow.blog/2009/01/06/accept-your-own-answers/\">allowed with special rules</a>. Additionally, you as the asker are typically best positioned to determine which answer best answered the question (if any). In a case like this where another correct answer exists, I&#39;d personally ask if they are ok with you accepting your own instead - just to avoid ruffling feathers. But that&#39;s a personal preference - there&#39;s no official guidance afaik."}, {"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1571305534, "post_id": 58418036, "comment_id": 103200043, "body": "I accepted @NathanOliver&#39;s answer. I guess I agree with you on the &quot;another correct answer&quot;. Thanks for all the help!"}], "tags": [], "owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "is_accepted": false, "score": 1, "last_activity_date": 1571244100, "creation_date": 1571244100, "answer_id": 58418036, "question_id": 58414966, "link": "https://stackoverflow.com/questions/58414966/move-construction-and-assignment-of-class-with-constant-member/58418036#58418036", "title": "Move construction and assignment of class with constant member", "body": "<p>After some research I came to the following.</p>\n\n<p>There are related questions:</p>\n\n<ul>\n<li><p><a href=\"https://stackoverflow.com/questions/46115831/move-assignment-to-object-with-const-value\">move assignment to object with const value</a></p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/47473621/placement-new-and-assignment-of-class-with-const-member\">Placement new and assignment of class with const member</a></p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/11601998/assignment-of-class-with-const-member\">assignment of class with const member</a></p></li>\n</ul>\n\n<p>The relevant information was found in:</p>\n\n<ul>\n<li><p><a href=\"https://timsong-cpp.github.io/cppwp/basic.life\" rel=\"nofollow noreferrer\">https://timsong-cpp.github.io/cppwp/basic.life</a></p></li>\n<li><p><a href=\"https://timsong-cpp.github.io/cppwp/class.copy.assign\" rel=\"nofollow noreferrer\">https://timsong-cpp.github.io/cppwp/class.copy.assign</a></p></li>\n<li><p><a href=\"https://en.cppreference.com/w/cpp/language/lifetime#Storage_reuse\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/lifetime#Storage_reuse</a></p></li>\n<li><p><a href=\"https://en.cppreference.com/w/cpp/utility/launder\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/utility/launder</a></p></li>\n</ul>\n\n<p>What clarified this for me was the example in <a href=\"https://en.cppreference.com/w/cpp/utility/launder\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/utility/launder</a></p>\n\n<pre><code>struct X {const int i; };\nX * p = new X{0};\nX * np = new (p) X{1};\n</code></pre>\n\n<p>This will result in undefined behavior:</p>\n\n<pre><code>const int i = p-&gt;i\n</code></pre>\n\n<p>But the following is valid:</p>\n\n<pre><code>const int i = np-&gt;i;\n</code></pre>\n\n<p>Per my original question, a modified version of the move assignment would be needed:</p>\n\n<pre><code>struct C\n{\n    const int i;\n    C() : i{} {}\n    C(C &amp;&amp; other) noexcept: i{other.i} {}\n\n    C &amp; operator=(C &amp;&amp; other) noexcept\n    {\n        if (this == &amp;other) return *this;\n        this-&gt;~C(); //Ok only if ~C is trivial\n        return *(new(this) C {std::move(other)});\n    }\n}\n\nC a;\nC b;\nb = std::move(a);\n\n//Undefined behavior!\nconst int i = b.i; \n</code></pre>\n\n<p>This would work as expected but would result in <strong>undefined behavior</strong> for the following reasons.</p>\n\n<p>When the destructor is invoked the objects' lifetime ends. Following that it is safe to call the move constructor. But at any point the compiler is free to assume that the content of <code>b</code> <strong>never</strong> changes. Thus, by using our move assignment we have a contradiction that results in undefined behavior.</p>\n\n<p>On the other hand, although the return value from the placement new is the same as <code>this</code>, when the compiler performs access through that, returned, pointer/reference it must not assume anything about that object.</p>\n\n<p>Given that <code>C&amp; C::operator=(C&amp;&amp;)</code> <em>returns</em> the result of the placement new, the following <em>should</em> be valid (but not really useful).</p>\n\n<pre><code>const int i = (b = std::move(a)).i;\n</code></pre>\n\n<p>Thank to @NathanOliver, whos' answer was the correct one all along and, also, to him and @SanderDeDycker for playing brain ping-pong with me.</p>\n"}], "owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 58415092, "answer_count": 2, "score": 2, "last_activity_date": 1571244100, "creation_date": 1571233861, "question_id": 58414966, "link": "https://stackoverflow.com/questions/58414966/move-construction-and-assignment-of-class-with-constant-member", "title": "Move construction and assignment of class with constant member", "body": "<p>I have a class with a const member that needs both a move constructor and assignment.</p>\n\n<p>I implemented it the following way:</p>\n\n<pre><code>struct C\n{\n    const int i;\n    C(int i) : i{i} {}\n    C(C &amp;&amp; other) noexcept: i{other.i} {}\n\n    C &amp; operator=(C &amp;&amp; other) noexcept\n    {\n        //Do not move from ourselves or all hell will break loose\n        if (this == &amp;other)\n            return *this;\n\n        //Call our own destructor to clean-up before moving\n        this-&gt;~C();\n\n        //Use our own move constructor to do the actual work\n        new(this) C {std::move(other)};\n\n        return *this;\n    }\n\n    //Other stuff here (including the destructor)....\n}\n</code></pre>\n\n<p>This compiles and works as expected.</p>\n\n<p>The question is whether this is the normal way to implement such a move assignment or there is a less contrived way to do it?</p>\n"}, {"tags": ["c++", "c++11", "c++14", "c++17"], "comments": [{"owner": {"reputation": 2756, "user_id": 5114342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725caa4188def46b8c6cf9b09eff7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Aziuth", "link": "https://stackoverflow.com/users/5114342/aziuth"}, "edited": false, "score": 2, "creation_date": 1571234306, "post_id": 58414965, "comment_id": 103173004, "body": "I mean, you could make sure that the object <code>container</code> is const within some context, or use a const reference to it, like <code>const IntContainer&amp; const_container = container; x = const_container[i];</code>. This would force the const operator to be used. Also, you can of course use named setters and getters. Depending on why you need this, there is always the option of not returning the actual variable (reference to int in your case) but a viewer to that variable which makes sure to call something when an assignment is made. Best might be if you give us your actual context."}, {"owner": {"reputation": 194, "user_id": 2160656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41c45daf20e668e6dbb36be511785809?s=128&d=identicon&r=PG", "display_name": "Denisof", "link": "https://stackoverflow.com/users/2160656/denisof"}, "reply_to_user": {"reputation": 2756, "user_id": 5114342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725caa4188def46b8c6cf9b09eff7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Aziuth", "link": "https://stackoverflow.com/users/5114342/aziuth"}, "edited": false, "score": 0, "creation_date": 1571234513, "post_id": 58414965, "comment_id": 103173146, "body": "@Aziuth Container is another class\u2019 member, in some methods of containing class it can be modified in others it can\u2019t. Moreover, if I capture it in lambda, then it can\u2019t be captured as const reference, isn\u2019t it."}, {"owner": {"reputation": 24924, "user_id": 319799, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/41dd012046381b203e09a7605ef49c89?s=128&d=identicon&r=PG", "display_name": "doublep", "link": "https://stackoverflow.com/users/319799/doublep"}, "edited": false, "score": 1, "creation_date": 1571234551, "post_id": 58414965, "comment_id": 103173168, "body": "I don&#39;t think what you want is robustly possible at all. A user of your container could do <code>int* r = &amp;container[i]; &#47;* whatever *&#47; *r = 3;</code> and there is no way container can detect the last assignment."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1571234576, "post_id": 58414965, "comment_id": 103173179, "body": "You cannot universally keep track of when modifications happen to your container. At least not while keeping with plain <code>int&amp;</code> as return type. How do you want to guard against <code>int* hah = &amp;yourContainer[0]; &#47;* a long time later *&#47; *hah = 10;</code>? Edit: Damn, ninja&#39;d."}, {"owner": {"reputation": 194, "user_id": 2160656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41c45daf20e668e6dbb36be511785809?s=128&d=identicon&r=PG", "display_name": "Denisof", "link": "https://stackoverflow.com/users/2160656/denisof"}, "edited": false, "score": 0, "creation_date": 1571234663, "post_id": 58414965, "comment_id": 103173231, "body": "So what would be the best solution from the design perspective?"}, {"owner": {"reputation": 9804, "user_id": 1332041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871cd231304bb5650f381016cac34d8f?s=128&d=identicon&r=PG", "display_name": "acraig5075", "link": "https://stackoverflow.com/users/1332041/acraig5075"}, "edited": false, "score": 0, "creation_date": 1571234713, "post_id": 58414965, "comment_id": 103173273, "body": "Alternative: Introduce a Setter function. Comment out the non-const operator. Build. See what breaks. Replace them with Setter function. Make the Setter function track your changes. Done!"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1571234804, "post_id": 58414965, "comment_id": 103173353, "body": "The easy route is telling people how to use your container correctly and say &quot;it&#39;s undefined behavior if you make a mistake&quot;. The hard way involves some ugliness that would make your container incompatible with existing standard library algorithms and/or lead to awkward syntax (essentially explicit get/set functions, possibly behind a proxy object). But there is a lot of design space in between, and you have almost no constraints in your question, so we can&#39;t really tell what would be a good design, not to mention &quot;the best&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 194, "user_id": 2160656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41c45daf20e668e6dbb36be511785809?s=128&d=identicon&r=PG", "display_name": "Denisof", "link": "https://stackoverflow.com/users/2160656/denisof"}, "edited": false, "score": 0, "creation_date": 1571236129, "post_id": 58415299, "comment_id": 103174224, "body": "@Denisof A decent optimizer should optimize most/all of it away.  Depending on what you are doing there might be a slight performance penalty but you&#39;d need to profile/benchmark to really know."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 8, "last_activity_date": 1571234756, "creation_date": 1571234756, "answer_id": 58415299, "question_id": 58414965, "link": "https://stackoverflow.com/questions/58414965/constness-in-brackets-operator-in-custom-container/58415299#58415299", "title": "Constness in brackets operator in custom container", "body": "<p>One trick is to create a proxy object.  This lets you overload the assignment operator and put your tracking logic into there and then you can guarantee that any writes are captured. If you have</p>\n\n<pre><code>class Proxy\n{\n    int&amp; val;\n    Proxy(int&amp; val) : val(val) {}\n    Proxy&amp; operator=(int new_val)\n    {\n        // do tracking stuff\n        val = new_val;\n    }\n    operator int() { return val; }\n};\n</code></pre>\n\n<p>then you can adjust <code>IntContainer</code> to</p>\n\n<pre><code>class IntContainer {\npublic:\n    int operator[] (size_t i) const;\n    Proxy operator[] (size_t i);\n};\n</code></pre>\n\n<p>and now you'll call the tracking code when the user actually tries to assign into the reference.</p>\n"}], "owner": {"reputation": 194, "user_id": 2160656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41c45daf20e668e6dbb36be511785809?s=128&d=identicon&r=PG", "display_name": "Denisof", "link": "https://stackoverflow.com/users/2160656/denisof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1571235057, "creation_date": 1571233854, "question_id": 58414965, "link": "https://stackoverflow.com/questions/58414965/constness-in-brackets-operator-in-custom-container", "title": "Constness in brackets operator in custom container", "body": "<p>I have a custom class with two overloaded brackets operators -- setter and getter. As you know they look somewhat like this</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class IntContainer {\npublic:\n    int const &amp; operator[] (size_t i) const;\n    int &amp; operator[] (size_t i);\n}\n</code></pre>\n\n<p>The problem I'm facing now, is that I have to check when the value was set or when it was just accessed, that is I need to track all the changes in my container. It's hard since always only non <code>const</code> operator is called, for example</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>container[i] = 3;  // Non const operator[] called\nx = container[i];  // Again, non const operator[] called\n</code></pre>\n\n<p>In two cases above I need to differ inner behavior in container. So is there any way to explicitly call different operators in cases like above. I don't want to use <code>const</code> instance of container and to define another functions like <code>set</code> and <code>get</code>, though I'm looking for smoe right design pattern.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "data-structures"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 3, "creation_date": 1571233957, "post_id": 58414934, "comment_id": 103172738, "body": "<code>while (i &lt; n1 &amp;&amp; j &lt; n2)</code> -- that condition can never be true (and neither can the two following ones) since the <code>for</code> loops have modified <code>i</code> and <code>j</code>. You should learn to use a debugger to step through your code and check that it does what you expect."}, {"owner": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1571234018, "post_id": 58414934, "comment_id": 103172792, "body": "<code>k</code> is not initialized to <code>0</code> and YES as pointed by @Quentin its should be a <code>||</code>"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "edited": false, "score": 0, "creation_date": 1571234174, "post_id": 58414934, "comment_id": 103172908, "body": "@roottraveller that&#39;s not what I&#39;m saying though: the issue is that both indices are out-of-range from the start."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "reply_to_user": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "edited": false, "score": 0, "creation_date": 1571235420, "post_id": 58414934, "comment_id": 103173762, "body": "@roottraveller Whereas it&#39;s true that <code>k</code> must be initialized, the <code>&amp;&amp;</code> condition is correct. The OP&#39;s algorithm merges as long as there are items in both arrays. The code following the first loop copies the remainder of whichever array still has items."}], "answers": [{"tags": [], "owner": {"reputation": 597, "user_id": 11148084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59f16a139d34736c120469815c3e9f35?s=128&d=identicon&r=PG&f=1", "display_name": "asds_asds", "link": "https://stackoverflow.com/users/11148084/asds-asds"}, "is_accepted": false, "score": 1, "last_activity_date": 1571271941, "creation_date": 1571271941, "answer_id": 58423270, "question_id": 58414934, "link": "https://stackoverflow.com/questions/58414934/program-to-merge-arrays-prints-0s-instead-of-the-actual-merged-array/58423270#58423270", "title": "Program to merge arrays prints 0s instead of the actual merged array", "body": "<pre><code>for (i=0;i&lt;n1;i++)\n{\n    cin &gt;&gt; a[i];\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>for (j=0;j&lt;n2;j++)\n{\n    cin &gt;&gt; b[j];\n}\n</code></pre>\n\n<p>end with <code>i</code> and <code>j</code> set to <code>n1</code> and <code>n2</code>.</p>\n\n<p>You may want to reinitialize them to <code>0</code> and then proceed.</p>\n\n<p>Adding <code>i=0;j=0;k=0;</code> before the while loop will help.</p>\n\n<h2>Why do you need to initialize variables?</h2>\n\n<p>If not initialized, k will contain junk values which may not be equal to <code>0</code>.</p>\n\n<p>For any value other than <code>0</code> your code will not behave the way you expect.</p>\n"}], "owner": {"reputation": 1, "user_id": 10717935, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ksy3OSjffWA/AAAAAAAAAAI/AAAAAAAANaE/x6PW7kOxyN8/photo.jpg?sz=128", "display_name": "infinite8", "link": "https://stackoverflow.com/users/10717935/infinite8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571271941, "creation_date": 1571233746, "question_id": 58414934, "link": "https://stackoverflow.com/questions/58414934/program-to-merge-arrays-prints-0s-instead-of-the-actual-merged-array", "title": "Program to merge arrays prints 0s instead of the actual merged array", "body": "<p>Program to merge two arrays into a separate third array doesn't actually do anything, despite me going through the code a couple times. Tried changing loop counters, variables, nothing seems to work. So, after I input the array sizes and elements, the merged array is just a string of zeroes for some reason.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>#include \"iostream\"\n#define MAX 100\nusing namespace std;\nint main()\n{\n    int a[MAX],n1,i;\n    int b[MAX],n2,j;\n    int r[MAX],k;\n    cout &lt;&lt; \"Array 1: \";\n    cout &lt;&lt; \"\\nEnter number of elements in the array: \";\n    cin &gt;&gt; n1;\n    cout &lt;&lt; \"Enter the elements of the array: \";\n    for (i=0;i&lt;n1;i++)\n    {\n        cin &gt;&gt; a[i];\n    }\n        cout &lt;&lt; \"\\nArray 2: \";\n    cout &lt;&lt; \"\\nEnter the number of elements in the array: \";\n    cin &gt;&gt; n2;\n    cout &lt;&lt; \"Enter the elements of the array: \";\n    for (j=0;j&lt;n2;j++)\n    {\n        cin &gt;&gt; b[j];\n    }\n    //Merging the arrays\n    while (i &lt; n1 &amp;&amp; j &lt; n2)\n    {\n        if (a[i] &lt; b[j])\n        {\n            r[k] = a[i];\n            i++;\n            k++;\n        }\n        else\n        {\n            r[k] = b[j];\n            j++;\n            k++;\n        }\n    }\n    while (i &lt; n1)\n    {\n        r[k] = a[i];\n        i++;\n        k++;\n    }\n    while (j &lt; n2)\n    {\n        r[k] = b[j];\n        j++;\n        k++;\n    }\n    cout &lt;&lt; \"\\nMerged Array: \\n\";\n    for (k=0;k&lt;n1+n2;k++)\n    {\n        cout &lt;&lt; r[k] &lt;&lt; \" \";\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "polymorphism", "overriding", "virtual-functions", "c++03"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1571234518, "post_id": 58414928, "comment_id": 103173152, "body": "<a href=\"https://stackoverflow.com/q/36954009/3233393\">Related</a>"}], "answers": [{"comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1571234283, "post_id": 58415088, "comment_id": 103172986, "body": "This will also match data members and static members though"}, {"owner": {"reputation": 8871, "user_id": 1132871, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/IO6V2.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1132871/alex"}, "edited": false, "score": 0, "creation_date": 1571234333, "post_id": 58415088, "comment_id": 103173023, "body": "Nice one. I didn&#39;t think about it. But still it is not 100% match."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1571234336, "post_id": 58415088, "comment_id": 103173025, "body": "@Quentin: Indeed it has its drawbacks: you point out another. You might be able to do something funky with templates, but I&#39;d be concerned about code bloat in C++03."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1571234779, "post_id": 58415088, "comment_id": 103173332, "body": "@Bathsheba Well, with any optimization such a NOP will be eliminated, so (binary) code bloat should not be a concern. Oh, you are talking about the template idea. Yes, there it may be. The resulting instantiations may be eliminated together with the call but that&#39;s less clear or sure. And compile time will increase needlessly because of the ubiquitous template headers."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1571239707, "post_id": 58415088, "comment_id": 103176534, "body": "I think most issues with wrong override is extra/missing parameter (<code>void Base::f(int)</code> vs <code>void Derived::f(char)</code>) and not missing function..."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 3, "last_activity_date": 1571234709, "last_edit_date": 1571234709, "creation_date": 1571234175, "answer_id": 58415088, "question_id": 58414928, "link": "https://stackoverflow.com/questions/58414928/is-it-possible-to-implement-override-like-functionality-in-c03/58415088#58415088", "title": "Is it possible to implement &#39;override&#39;-like functionality in C++03", "body": "<p>To check if a function <code>foo</code> exists in a base class <code>Foo</code> say, write</p>\n\n<pre><code>sizeof(&amp;Foo::foo);\n</code></pre>\n\n<p>in the child class version of <code>foo</code>. The idea is that compilation will fail if the base class <code>Foo::foo</code> is not present, and has a benign effect if it is.</p>\n\n<p>Of course, this has drawbacks - you can't descriminate by overloads for example. Also, <code>static</code> functions and member variables with a similar name will also match.</p>\n"}], "owner": {"reputation": 8871, "user_id": 1132871, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/IO6V2.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1132871/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1571234709, "creation_date": 1571233717, "last_edit_date": 1571234031, "question_id": 58414928, "link": "https://stackoverflow.com/questions/58414928/is-it-possible-to-implement-override-like-functionality-in-c03", "title": "Is it possible to implement &#39;override&#39;-like functionality in C++03", "body": "<p>In <code>C++11</code> we have <code>override</code> specifier that allows to validate in compile time that virtual function actually overrides behavior of interface in the base class.</p>\n\n<p>Is there anyway to get the same behavior in <code>C++03</code>?</p>\n"}, {"tags": ["c++", "c", "gdb", "shared-libraries", "gnu"], "comments": [{"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1571233890, "post_id": 58414921, "comment_id": 103172701, "body": "What is the output of <code>(gdb) ptype mylibraryEntryPoint</code> and does it match the way you declared it in your source?"}, {"owner": {"reputation": 23, "user_id": 3857958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81a3f6115c5f535cf90cf925ff97694?s=128&d=identicon&r=PG&f=1", "display_name": "sacket", "link": "https://stackoverflow.com/users/3857958/sacket"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1571234506, "post_id": 58414921, "comment_id": 103173141, "body": "yes it returns int value.   (gdb) ptype mylibraryEntryPoint() type = int"}, {"owner": {"reputation": 2286, "user_id": 3228495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0163d41bd310e00b055618846734b0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/3228495/andrew"}, "edited": false, "score": 1, "creation_date": 1571234928, "post_id": 58414921, "comment_id": 103173430, "body": "The return type for your function is <code>int</code>, which can be negative.  You might want to extend your question to explain what you are expecting the output to be and why.  The value you&#39;re seeing is whatever value your function returned, not something generated by GDB, as such the meaning is defined by your function."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1571235201, "post_id": 58414921, "comment_id": 103173604, "body": "It seems to be your library. What value do you return? What value did you expect to see?"}, {"owner": {"reputation": 23, "user_id": 3857958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81a3f6115c5f535cf90cf925ff97694?s=128&d=identicon&r=PG&f=1", "display_name": "sacket", "link": "https://stackoverflow.com/users/3857958/sacket"}, "edited": false, "score": 0, "creation_date": 1571235691, "post_id": 58414921, "comment_id": 103173945, "body": "I am execting the function to be executed. (It prints some lines as well). Since it is returning negative value it is not really returned by my function, it is an error code of gdb. it tells gdb was unable to run the function."}, {"owner": {"reputation": 2286, "user_id": 3228495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0163d41bd310e00b055618846734b0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/3228495/andrew"}, "edited": false, "score": 0, "creation_date": 1571239231, "post_id": 58414921, "comment_id": 103176269, "body": "That&#39;s not how it works.  The value you see is what GDB thinks your function returned after it was called.  I guess depending on architecture GDB could be failing to extract the correct return value (probably unlikely for an int), or maybe there&#39;s something weird with the shared library not being loaded correctly, so it&#39;s not running the code you thought it was...  I&#39;d try <code>break mylibraryEntryPoint</code> then <code>call mylibraryEntryPoint ()</code>.  GDB should stop inside your function and you can step through.  If that doesn&#39;t work then I&#39;d double check the library has loaded correctly."}], "owner": {"reputation": 23, "user_id": 3857958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81a3f6115c5f535cf90cf925ff97694?s=128&d=identicon&r=PG&f=1", "display_name": "sacket", "link": "https://stackoverflow.com/users/3857958/sacket"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571235795, "creation_date": 1571233692, "last_edit_date": 1571235795, "question_id": 58414921, "link": "https://stackoverflow.com/questions/58414921/gdb-call-returns-negative-value", "title": "gdb &#39;call&#39; returns negative value", "body": "<p>I am trying to load a shared library in gdb and invoke entry function call from gdb. \nFor example mylib.so has mylibraryEntryPoint() function. \nHowever, I am getting a negative output. I am curious what does this error code mean. </p>\n\n<pre><code>    (gdb) sharedlibrary /usr/home/mylib.so\n    Symbols already loaded for /usr/home/mylib.so\n    (gdb) call mylibraryEntryPoint()\n    $9 = -2048550400    // Here is the problem. \n\n</code></pre>\n\n<p>The strange part is this function call works on another Linux VM with same gdb version. \nI am expecting the function to be 'executed' on this machine. (It prints some lines as well). Since it is returning the negative value which is not really returned by my function, it is an error code of gdb. It tells gdb was unable to run the function.</p>\n"}, {"tags": ["c++", "operator-overloading", "visual-studio-2019", "overload-resolution", "ambiguity"], "comments": [{"owner": {"reputation": 3059, "user_id": 202367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca76b7b553fb6ccdf4982024c82200f3?s=128&d=identicon&r=PG", "display_name": "pascal", "link": "https://stackoverflow.com/users/202367/pascal"}, "edited": false, "score": 0, "creation_date": 1571233608, "post_id": 58414863, "comment_id": 103172515, "body": "It took me a while to strip down our actual code, and get this failing code excerpt. Which in itself gave me some insights on what was actually not working..."}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1571233789, "post_id": 58414863, "comment_id": 103172637, "body": "remove the c style cast, its unnecessary and seems to be the cause of the issue"}, {"owner": {"reputation": 3059, "user_id": 202367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca76b7b553fb6ccdf4982024c82200f3?s=128&d=identicon&r=PG", "display_name": "pascal", "link": "https://stackoverflow.com/users/202367/pascal"}, "reply_to_user": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1571233969, "post_id": 58414863, "comment_id": 103172748, "body": "I tried several ways of writing it, in the actual sources: the given <code>A a = (A)b</code>, or &#39;A a = b<code>, or &#39;A a = A(b)</code>... which all gave error messages, although different ones... They all relate to the excessive possible conversions..."}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1571234056, "post_id": 58414863, "comment_id": 103172820, "body": "removing the cast fixes the issue: <a href=\"https://godbolt.org/z/QLJnPv\" rel=\"nofollow noreferrer\">godbolt.org/z/QLJnPv</a>"}, {"owner": {"reputation": 3059, "user_id": 202367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca76b7b553fb6ccdf4982024c82200f3?s=128&d=identicon&r=PG", "display_name": "pascal", "link": "https://stackoverflow.com/users/202367/pascal"}, "reply_to_user": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1571234065, "post_id": 58414863, "comment_id": 103172832, "body": "I just made the effort to ask this self-answering question, because I could not find (around C2440) a similar question on the Internet... But i still do not really understand why the compiler did not prefer the conversion operator..."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 1, "creation_date": 1571235379, "post_id": 58414863, "comment_id": 103173736, "body": "@pascal Because it&#39;s a C style cast. They don&#39;t follow the normal C++ casting rules, <code>static_cast&lt;A&gt;(B)</code> should work fine."}, {"owner": {"reputation": 3059, "user_id": 202367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca76b7b553fb6ccdf4982024c82200f3?s=128&d=identicon&r=PG", "display_name": "pascal", "link": "https://stackoverflow.com/users/202367/pascal"}, "edited": false, "score": 0, "creation_date": 1571236580, "post_id": 58414863, "comment_id": 103174538, "body": "I&#39;ve just tried <code>static_cast&lt;A&gt;(b)</code>. It did not fix the compilation..."}], "answers": [{"tags": [], "owner": {"reputation": 3059, "user_id": 202367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca76b7b553fb6ccdf4982024c82200f3?s=128&d=identicon&r=PG", "display_name": "pascal", "link": "https://stackoverflow.com/users/202367/pascal"}, "is_accepted": false, "score": 2, "last_activity_date": 1571234146, "last_edit_date": 1571234146, "creation_date": 1571233827, "answer_id": 58414960, "question_id": 58414863, "link": "https://stackoverflow.com/questions/58414863/c-compilation-error-cannot-convert-from-b-to-a-no-constructor-or-constructo/58414960#58414960", "title": "C++ compilation error: cannot convert from B to A, no constructor, or constructor overload ambiguity", "body": "<p>From what I understand, the compiler tries several paths to interpret <code>a = (A)b</code>.</p>\n\n<ul>\n<li>it finds the <code>operator A</code></li>\n<li>but it also finds the <code>operator int</code> on B, and the <code>A(int)</code> constructor which gives it a second path <code>B =&gt; int =&gt; A</code>...</li>\n</ul>\n\n<p>And it does not know which to pick.</p>\n\n<p>To fix the compilation, I can:</p>\n\n<ul>\n<li>remove the <code>operator int</code> from B</li>\n<li>rewrite the error line as <code>A a = b.operator A();</code>...</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 3059, "user_id": 202367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca76b7b553fb6ccdf4982024c82200f3?s=128&d=identicon&r=PG", "display_name": "pascal", "link": "https://stackoverflow.com/users/202367/pascal"}, "edited": false, "score": 0, "creation_date": 1571238158, "post_id": 58414962, "comment_id": 103175596, "body": "It seems interesting, although it exceeds my knowledge of C++... but it works. I cannot seem to find a reference docs which shows the &quot;&amp;&quot;, &quot;&amp;&amp;&quot; in the conversion function definition.. (granted, the ones I found at Microsoft, IBM, do not seem to allow for &quot;const&quot; either...)"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 3059, "user_id": 202367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca76b7b553fb6ccdf4982024c82200f3?s=128&d=identicon&r=PG", "display_name": "pascal", "link": "https://stackoverflow.com/users/202367/pascal"}, "edited": false, "score": 1, "creation_date": 1571238495, "post_id": 58414962, "comment_id": 103175799, "body": "@pascal A member function can be declared like D1 ( parameter-declaration-clause ) cv-qualifier-seqopt ref-qualifieropt noexcept-specifieropt attribute-specifier-seqopt trailing-return-type"}], "tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 2, "last_activity_date": 1571235160, "last_edit_date": 1571235160, "creation_date": 1571233836, "answer_id": 58414962, "question_id": 58414863, "link": "https://stackoverflow.com/questions/58414863/c-compilation-error-cannot-convert-from-b-to-a-no-constructor-or-constructo/58414962#58414962", "title": "C++ compilation error: cannot convert from B to A, no constructor, or constructor overload ambiguity", "body": "<p>The error message means that these two operators</p>\n\n<pre><code>operator A(void) const { return A(_m); }\noperator int(void) const { return _m; }\n</code></pre>\n\n<p>can be used in the expression</p>\n\n<pre><code>(A)b;\n</code></pre>\n\n<p>As a result using these conversion operators there can be used either the constructor <code>A( int )</code> or the default copy constructor <code>A( const A &amp; )</code>.</p>\n\n<p>To make it more clear rewrite the corresponding declaration like</p>\n\n<pre><code>A a = A( b );\n</code></pre>\n\n<p>So whether the object b is converted to an object of the type A using the first conversion operator or to an object of the type int using the second conversion operator.</p>\n\n<p>You could avoid the ambiguity declaring the operators for example like</p>\n\n<pre><code>operator A(void) const &amp; { return A(_m); }\noperator int(void) const &amp;&amp; { return _m; }\n</code></pre>\n\n<p>that is for lvalues the first operator will be used and for rvalues the second operator will be used.</p>\n\n<p>Here is your program with the modified operators.</p>\n\n<pre><code>#include &lt;iostream&gt;\nclass A\n{\npublic:\n    A(void) :_m(0) { }\n    A(int val) : _m(val) {}\nprivate:\n    int _m;\n};\nclass B\n{\npublic:\n    B(void) : _m(0) {}\n    B(int val) : _m(val) {}\n    B(const A&amp;);\n    // there is a direct conversion operator here\n    operator A(void) const &amp; { return A(_m); }\n    operator int(void) const &amp;&amp; { return _m; }\nprivate:\n    int _m;\n};\n\nint main()\n{\n    B b;\n    A a = b; \n    A a1 = B();\n}\n</code></pre>\n"}], "owner": {"reputation": 3059, "user_id": 202367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca76b7b553fb6ccdf4982024c82200f3?s=128&d=identicon&r=PG", "display_name": "pascal", "link": "https://stackoverflow.com/users/202367/pascal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 58414962, "answer_count": 2, "score": 7, "last_activity_date": 1571238541, "creation_date": 1571233508, "last_edit_date": 1571238541, "question_id": 58414863, "link": "https://stackoverflow.com/questions/58414863/c-compilation-error-cannot-convert-from-b-to-a-no-constructor-or-constructo", "title": "C++ compilation error: cannot convert from B to A, no constructor, or constructor overload ambiguity", "body": "<p>I have some code which implies a type conversion, which does not compile although there is a conversion method...</p>\n\n<pre><code>class A\n{\npublic:\n    A(void) :_m(0) { }\n    A(int val) : _m(val) {}\nprivate:\n    int _m;\n};\nclass B\n{\npublic:\n    B(void) : _m(0) {}\n    B(int val) : _m(val) {}\n    B(const A&amp;);\n    // there is a direct conversion operator here\n    operator A(void) const { return A(_m); }\n    operator int(void) const { return _m; }\nprivate:\n    int _m;\n};\nint main()\n{\n    B b;\n    A a = (A)b; // error C2440 here\n}\n</code></pre>\n\n<p>Here is the error message:</p>\n\n<pre><code>error C2440: 'type cast': cannot convert from 'B' to 'A'\nmessage : No constructor could take the source type, or constructor overload resolution was ambiguous\n</code></pre>\n"}, {"tags": ["c++", "ios", "objective-c", "video", "frame-rate"], "answers": [{"tags": [], "owner": {"reputation": 19152, "user_id": 334402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/476b932160cd12fa0e4515a313427679?s=128&d=identicon&r=PG", "display_name": "Mick", "link": "https://stackoverflow.com/users/334402/mick"}, "is_accepted": false, "score": 1, "last_activity_date": 1571736254, "creation_date": 1571736254, "answer_id": 58501053, "question_id": 58414631, "link": "https://stackoverflow.com/questions/58414631/is-there-an-api-that-will-run-on-ios-in-order-to-change-the-frame-per-second-of/58501053#58501053", "title": "Is there an API that will run on iOS in order to change the Frame Per Second of an existing video?", "body": "<p>The type of conversion you are doing will be time and power consuming on a mobile device, but I am guessing you are already aware of that.</p>\n\n<p>Given your end goal is to reduce size, while presumably maintaining a reasonable quality, you may find you want to experiment with different settings etc in the encodings.</p>\n\n<p>For this type of video manipulation, ffmpeg is a good choice as you probably saw from your command line usage. To use ffmpeg from an application, a common approach is to use a well supported 'ffmpeg wrapper' - this effectively runs the Ffmpeg command line commands from wihtin your application.</p>\n\n<p>The advantage is that all the usual syntax should work and you can leverage the vast amount of info on ffmpeg command line syntax on the web. The downsides are that ffmpeg was not not designed to be wrapped like this so you may see some issues, although with a well supported wrapper you should find either help or that others have already worked around the issues.</p>\n\n<p>Some examples of popular iOS ffmpeg wrappers:</p>\n\n<ul>\n<li><a href=\"https://github.com/tanersener/mobile-ffmpeg\" rel=\"nofollow noreferrer\">https://github.com/tanersener/mobile-ffmpeg</a></li>\n<li><a href=\"https://github.com/sunlubo/SwiftFFmpeg\" rel=\"nofollow noreferrer\">https://github.com/sunlubo/SwiftFFmpeg</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 737, "user_id": 1466453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1873ca77535135b6db9e0bb55f93269?s=128&d=identicon&r=PG&f=1", "display_name": "Shakir Zareen", "link": "https://stackoverflow.com/users/1466453/shakir-zareen"}, "is_accepted": false, "score": 0, "last_activity_date": 1576252132, "creation_date": 1576252132, "answer_id": 59325823, "question_id": 58414631, "link": "https://stackoverflow.com/questions/58414631/is-there-an-api-that-will-run-on-ios-in-order-to-change-the-frame-per-second-of/59325823#59325823", "title": "Is there an API that will run on iOS in order to change the Frame Per Second of an existing video?", "body": "<p>Get MobileFFMpeg up and running:\n<a href=\"https://stackoverflow.com/a/59325680/1466453\">https://stackoverflow.com/a/59325680/1466453</a></p>\n\n<p>Once you can make MobileFFMpeg calls in your IOS code then changing frame rate is pretty straightforward with this code:</p>\n\n<p>[MobileFFmpeg execute: @\"-i  -filter:v fps=fps=30 \"];</p>\n"}], "owner": {"reputation": 1, "user_id": 12226757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-F5lsKmUn2RI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3renXkXLkeCf0arHEzrNshD4--4i3w/photo.jpg?sz=128", "display_name": "Yoav Y", "link": "https://stackoverflow.com/users/12226757/yoav-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576252132, "creation_date": 1571232788, "question_id": 58414631, "link": "https://stackoverflow.com/questions/58414631/is-there-an-api-that-will-run-on-ios-in-order-to-change-the-frame-per-second-of", "title": "Is there an API that will run on iOS in order to change the Frame Per Second of an existing video?", "body": "<p><strong>I am looking for a way to receive as an input any video (that is supported on iOS) and save on the device a new video with a new Frame Per Second rate. The motivation is to decrease the video size, and as well make it as lite weighted as possible.</strong></p>\n\n<ul>\n<li>Tried using ffmpeg library from command line (need it to run directly from application)</li>\n<li>Tried working with SDAVAssetExportSessionDelegate, but managed only to change the bit per second (each frame quality is lower)</li>\n<li><p>Though to work with OpenCV - but preferring something lighter and build in if possible </p>\n\n<p>Objective C:\n'''</p>\n\n<pre><code>compressionEncoder.videoSettings = @\n{\n    AVVideoCodecKey: AVVideoCodecTypeH264,\n    AVVideoWidthKey: [NSNumber numberWithInt:width],   //Set your resolution width here\n    AVVideoHeightKey: [NSNumber numberWithInt:height],  //set your resolution height here\n    AVVideoCompressionPropertiesKey: @\n    {\n        AVVideoAverageBitRateKey: [NSNumber numberWithInt:bitRateKey], // Give bitrate for lower size low values\n        AVVideoProfileLevelKey: AVVideoProfileLevelH264High40,\n        // Does not change - quality setting and not reletaed to playback framerate!\n        //AVVideoMaxKeyFrameIntervalKey: @800,\n    },\n};\ncompressionEncoder.audioSettings = @\n{\n    AVFormatIDKey: @(kAudioFormatMPEG4AAC),\n    AVNumberOfChannelsKey: @2,\n    AVSampleRateKey: @44100,\n    AVEncoderBitRateKey: @128000,\n};\n</code></pre>\n\n<p>'''</p></li>\n</ul>\n\n<p>Expected a video with less Frame Per Second, each frame is in the same quality. Similar to a brief thumbnail summary of the video</p>\n"}, {"tags": ["c++", "boost"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 2986034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zWFL3.jpg?s=128&g=1", "display_name": "YetAnotherOldBoy", "link": "https://stackoverflow.com/users/2986034/yetanotheroldboy"}, "edited": false, "score": 0, "creation_date": 1571747046, "post_id": 58436868, "comment_id": 103336842, "body": "seeing somewhere\uff0cthere are symmetric and asymmetric coroutines. I want to implement  a server frame  with epoll and use boost::callcc to switch on block io. so the callcc can only implement asymmetric scheduler?"}], "tags": [], "owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "is_accepted": true, "score": 1, "last_activity_date": 1571339091, "last_edit_date": 1571339091, "creation_date": 1571328888, "answer_id": 58436868, "question_id": 58414501, "link": "https://stackoverflow.com/questions/58414501/boost-continuation-resume-assert-failed/58436868#58436868", "title": "boost continuation resume Assert failed", "body": "<p>When <code>resume</code> is called, <code>continuation</code> object is invalidated.</p>\n\n<p><a href=\"https://www.boost.org/doc/libs/1_71_0/libs/context/doc/html/context/cc.html\" rel=\"nofollow noreferrer\">Reference</a> says:</p>\n\n<blockquote>\n  <p>continuation is a one-shot continuation - it can be used only once,\n  after calling continuation::resume() or continuation::resume_with() it\n  is invalidated.</p>\n</blockquote>\n\n<p>The following pseudocode shows how <code>resume</code> function works:</p>\n\n<pre><code> foo(continutation&amp;&amp; mainContext) {\n            mainContext = mainContext.resume(); \n     //                 | \n     //                 |   [2] resume is called;\n     //                 |   [2] resume invalidates mainContext; \n     //                 |   [2] no return value is assigned to mainContext!\n     //                 |   [2] we go back to main\n     // [4]             |\n     // make assignment |\n     // now mainContext | \n     // is valid        |\n }\n\nint main(){\n    fooContext = callcc( foo );          // [1] we enter into foo function;\n    fooContext = fooContext.resume();    // [3] we go back to foo \n}\n</code></pre>\n\n<hr>\n\n<p>Below is simplified version of your code, lets analyze it:</p>\n\n<pre><code>ctx::continuation foo1(ctx::continuation&amp;&amp; main) {\n    main = main.resume(); // [2]\n    fc2 = fc2.resume(); // [6]\n    fc2 = fc2.resume();\n    return std::move(c);\n}\n\nctx::continuation foo2(ctx::continuation&amp;&amp; main) {\n    main = main.resume(); // [4]\n    fc1 = fc1.resume(); // [7]\n    fc1 = fc1.resume();\n    return std::move(c);\n}\n\n\nint main() {\n    fc1 = ctx::callcc(foo1); // [1]\n    fc2 = ctx::callcc(foo2); // [3]\n\n    for (;;) {\n        while(fc1 = fc1.resume()) LOG_DBUG(\"main c1\"); // [5]\n        while(fc2 = fc2.resume()) LOG_DBUG(\"main c2\");\n        break;\n    }\n</code></pre>\n\n<ol>\n<li><code>foo1</code> starts.</li>\n<li>Execution returns to <code>main</code>.</li>\n<li><code>foo2</code> starts.</li>\n<li>Execution returns to <code>main</code>.</li>\n<li><code>resume</code> is called on <code>fc1</code>. <code>fc1</code> is invalidated. Control execution returns to [6].</li>\n<li>In this line execution in <code>foo2</code> is resumed, we jump to [7].</li>\n<li><code>resume</code> is called on <strong>invalidated</strong> <code>fc1</code>, program is aborted.</li>\n</ol>\n"}], "owner": {"reputation": 47, "user_id": 2986034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zWFL3.jpg?s=128&g=1", "display_name": "YetAnotherOldBoy", "link": "https://stackoverflow.com/users/2986034/yetanotheroldboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 58436868, "answer_count": 1, "score": 0, "last_activity_date": 1571339091, "creation_date": 1571232380, "question_id": 58414501, "link": "https://stackoverflow.com/questions/58414501/boost-continuation-resume-assert-failed", "title": "boost continuation resume Assert failed", "body": "<p>i try to test continuation, my code is below</p>\n\n<pre><code>ctx::continuation fc1; \nctx::continuation fc2;\n\nctx::continuation foo1(ctx::continuation&amp;&amp; c) {\n    LOG_DBUG(\"enter\");\n    c = c.resume();\n    LOG_DBUG(\"done 1\");\n    fc2 = fc2.resume();\n    LOG_DBUG(\"done 2\");\n    fc2 = fc2.resume();\n    return std::move(c);\n}\n\nctx::continuation foo2(ctx::continuation&amp;&amp; c) {\n    LOG_DBUG(\"enter\");\n    c = c.resume();\n    LOG_DBUG(\"done 1\");\n    fc1 = fc1.resume();\n    LOG_DBUG(\"done 2\");\n    fc1 = fc1.resume();\n    return std::move(c);\n}\n\n\nint main() {\n    fc1 = ctx::callcc(foo1);\n    fc2 = ctx::callcc(foo2);\n\n    LOG_INFO(\"after callcc\");\n\n    for (;;) {\n        while(fc1 = fc1.resume()) LOG_DBUG(\"main c1\");\n        while(fc2 = fc2.resume()) LOG_DBUG(\"main c2\");\n        break;\n    }\n    std::cout &lt;&lt; \"main: done\" &lt;&lt; std::endl;\n    return 0;\n}\n\n</code></pre>\n\n<p>stdout got</p>\n\n<p>DBUG [coepoll.cpp:36] [foo1]enter</p>\n\n<p>DBUG [coepoll.cpp:46] [foo2]enter</p>\n\n<p>INFO [coepoll.cpp:61] [main]after callcc</p>\n\n<p>DBUG [coepoll.cpp:38] [foo1]done 1</p>\n\n<p>DBUG [coepoll.cpp:48] [foo2]done 1</p>\n\n<p>./myboost/include/boost/context/continuation_fcontext.hpp:263: boost::context::continuation boost::context::continuation::resume() &amp;&amp;: Assertion `nullptr != fctx_' failed.</p>\n\n<p>Seems to at  function <code>foo2</code> call <code>fc1 = fc1.resume()</code> cause assert failed.\nIs there some error in my code?</p>\n"}, {"tags": ["c++", "visual-studio", "github", "pdb-files", "sourcelink"], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 5819324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e22b538f1fbf1af778dd415e70e1749?s=128&d=identicon&r=PG&f=1", "display_name": "e-master", "link": "https://stackoverflow.com/users/5819324/e-master"}, "is_accepted": true, "score": 0, "last_activity_date": 1580607258, "last_edit_date": 1580607258, "creation_date": 1580593551, "answer_id": 60021348, "question_id": 58414394, "link": "https://stackoverflow.com/questions/58414394/sourcelink-pdb-file-name-casing-does-not-match-repository-breaking-sourcelink/60021348#60021348", "title": "SourceLink: PDB File Name Casing Does Not Match Repository, Breaking SourceLink", "body": "<p>I had the exact same issue. It turns out it's a known bug, and was fixed in VS2019. Unfortunately you need to upgrade to the latest tool chain (v142). </p>\n"}], "owner": {"reputation": 13, "user_id": 12226725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3eeb99d9c697548209ee07c1b3ca078?s=128&d=identicon&r=PG&f=1", "display_name": "JamesCo", "link": "https://stackoverflow.com/users/12226725/jamesco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 60021348, "answer_count": 1, "score": 1, "last_activity_date": 1580607258, "creation_date": 1571232090, "question_id": 58414394, "link": "https://stackoverflow.com/questions/58414394/sourcelink-pdb-file-name-casing-does-not-match-repository-breaking-sourcelink", "title": "SourceLink: PDB File Name Casing Does Not Match Repository, Breaking SourceLink", "body": "<p><em>Is there any way of configuring the linker in Visual Studio so that file names (and paths) embedded in the .pdb file maintain their casing?</em></p>\n\n<p>We have a Visual Studio C++/Cli DLL that we'd like to package with NuGet. We want to use SourceLink so that our developers can step into the code, which is hosted on a (private) GitHub repository. </p>\n\n<p>However, when trying to step into the source, Visual Studio (2019 16.2.2) reports an error: </p>\n\n<h3>Source Link Error</h3>\n\n<blockquote>\n  <p>git-credential-manager.exe: Could not obtain credentials. Process failed with exit code -1.\n  ERROR: The request failed with code 404 : \"Not Found\". Treating 404 as authentication failure. Some services return 404 instead of 401 for authentication failures.</p>\n  \n  <p>Source Link URL: <a href=\"https://raw.githubusercontent.com/OurCompany/OurRepository/aca51f6e381401234e95b63949d150be04a0ea4a/ourproject/oursubfolder/thefile.cpp\" rel=\"nofollow noreferrer\">https://raw.githubusercontent.com/OurCompany/OurRepository/aca51f6e381401234e95b63949d150be04a0ea4a/ourproject/oursubfolder/thefile.cpp</a></p>\n</blockquote>\n\n<p>Note that on the file-system and repository the file path uses camel-casing: <code>Ourproject/OurSubFolder/TheFile.cpp</code>.</p>\n\n<p>When I replicate the request in Postman using Basic authorisation, it does indeed fail with 404. However, the problem seems to be that the URL constructed by Visual Studio uses lower-case characters for the filename and location; correcting the case makes the request work in Postman. GitHub URLs are of course case-sensitive and that's not configurable. </p>\n\n<p>Opening the .pdb file in Notepad++ shows the filenames are indeed lower-case. </p>\n\n<p>For what it's worth, changing <code>ignorecase = false</code> in the git .config file makes no difference.</p>\n"}, {"tags": ["c++", "loops", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 436, "user_id": 4070489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DqUop.jpg?s=128&g=1", "display_name": "GeckoGeorge", "link": "https://stackoverflow.com/users/4070489/geckogeorge"}, "edited": false, "score": 0, "creation_date": 1571233516, "post_id": 58414346, "comment_id": 103172440, "body": "It would&#39;ve been easier to help if you&#39;d have supplied a minimal working example. That said, have you tried to just check? Even a 3x3 matrix gives a pretty clear answer in my minimal example."}, {"owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "edited": false, "score": 1, "creation_date": 1571233835, "post_id": 58414346, "comment_id": 103172674, "body": "Why do you parallelize the inner loop? It would much simpler to parallelize the outer one. As every iteration (thread) processes different rows, there is no race, no need for reduction and the code will be more efficient. The only constraint is that you cannot replace push_back() as the processing order is undefined and must replace it by an explicit write at minRows[i]."}, {"owner": {"reputation": 436, "user_id": 4070489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DqUop.jpg?s=128&g=1", "display_name": "GeckoGeorge", "link": "https://stackoverflow.com/users/4070489/geckogeorge"}, "reply_to_user": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "edited": false, "score": 0, "creation_date": 1571234174, "post_id": 58414346, "comment_id": 103172909, "body": "@AlainMerigot The inner loop is guarded from race conditions by the <code>reduction(min: minValue)</code> expression, if I understand it correctly - openMP seems to take care of creating local copies for each task. So while I agree insofar as either the matrix has to be huge, or the elements of the matrix be expensive to compare, it&#39;s not a data race there. The <code>push_back</code> is spot on, though."}, {"owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "reply_to_user": {"reputation": 436, "user_id": 4070489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DqUop.jpg?s=128&g=1", "display_name": "GeckoGeorge", "link": "https://stackoverflow.com/users/4070489/geckogeorge"}, "edited": false, "score": 1, "creation_date": 1571234609, "post_id": 58414346, "comment_id": 103173207, "body": "@GeckoGeorge I did no say there is a race, and the reduction insures a proper behavior. What I mean is that if the parallelization is done on the outer loop no kind of race can happen, this kind of construct is not required, every thread works on its own data, the number of synchronizations is reduced and the parallelization and performances will be better."}, {"owner": {"reputation": 167, "user_id": 6155022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b77db3ce10992915206f0d9dbe8810c?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Edison", "link": "https://stackoverflow.com/users/6155022/thomas-edison"}, "reply_to_user": {"reputation": 436, "user_id": 4070489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DqUop.jpg?s=128&g=1", "display_name": "GeckoGeorge", "link": "https://stackoverflow.com/users/4070489/geckogeorge"}, "edited": false, "score": 0, "creation_date": 1571235796, "post_id": 58414346, "comment_id": 103174003, "body": "@GeckoGeorge I already checked the instance of size 3.000 and it works fine. I have to use &#39;push_back&#39; for a reason."}, {"owner": {"reputation": 436, "user_id": 4070489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DqUop.jpg?s=128&g=1", "display_name": "GeckoGeorge", "link": "https://stackoverflow.com/users/4070489/geckogeorge"}, "edited": false, "score": 0, "creation_date": 1571240305, "post_id": 58414346, "comment_id": 103176863, "body": "@ThomasEdison I saw a data race with 3x3 matrices - roughly every 1 in 4 times one of the lines was missing in <code>minRows</code>, because <code>push_back</code> is not thread safe. Not even as in &quot;the order is undefined&quot; (which is also true), but as in &quot;data is missing&quot;. If you desperately need it, you&#39;ll have to guard it by mutex or something similar."}, {"owner": {"reputation": 167, "user_id": 6155022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b77db3ce10992915206f0d9dbe8810c?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Edison", "link": "https://stackoverflow.com/users/6155022/thomas-edison"}, "reply_to_user": {"reputation": 436, "user_id": 4070489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DqUop.jpg?s=128&g=1", "display_name": "GeckoGeorge", "link": "https://stackoverflow.com/users/4070489/geckogeorge"}, "edited": false, "score": 0, "creation_date": 1571242194, "post_id": 58414346, "comment_id": 103177787, "body": "@GeckoGeorge Thanks alot. Can I avoid it using minRows[i] instead of push_back? The order does not matter for me because later I need to compute the top kth largest numbers from minRows."}, {"owner": {"reputation": 436, "user_id": 4070489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DqUop.jpg?s=128&g=1", "display_name": "GeckoGeorge", "link": "https://stackoverflow.com/users/4070489/geckogeorge"}, "edited": false, "score": 0, "creation_date": 1571249493, "post_id": 58414346, "comment_id": 103181044, "body": "Yes, Alain&#39;s suggestion makes sure that each element is accessed by it&#39;s own thread, so it&#39;s safe."}], "answers": [{"tags": [], "owner": {"reputation": 436, "user_id": 4070489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DqUop.jpg?s=128&g=1", "display_name": "GeckoGeorge", "link": "https://stackoverflow.com/users/4070489/geckogeorge"}, "is_accepted": true, "score": 1, "last_activity_date": 1571250705, "creation_date": 1571250705, "answer_id": 58419649, "question_id": 58414346, "link": "https://stackoverflow.com/questions/58414346/compute-the-minimum-value-of-every-row-in-a-matrix-using-loops-parallel-with-ope/58419649#58419649", "title": "Compute the minimum value of every row in a matrix using loops parallel with openmp C++", "body": "<p>What we talked about in the comments as an answer: Since I had to write some boilerplate anyway, I used ints as the type and avoided thinking about float problems at all:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main(){\n    constexpr size_t n = 3;\n    // dummy Distf (int) declared in lieu of matrix Distf \n    int Distf[n][n] = {{1,2,3},{6,5,4},{7,8,8}};\n\n    //could be an array&lt;int,n&gt; instead\n    vector&lt;int&gt; minRows(n);\n#pragma omp parallel for\n    for (size_t i = 0; i &lt; n; ++i){\n        int minValue = Distf[i][0];\n// Alain Merigot argues this is a performance drag\n//#pragma omp parallel for reduction(min : minValue)\n        for (size_t j = 1; j &lt; n; ++j){\n            if (Distf[i][j] &lt; minValue){\n                minValue = Distf[i][j];\n            }\n        }\n        //minRows.push_back(minValue) is a race condition!\n        minRows[i] = minValue;\n    }\n\n    int k = 0;\n    for(auto el: minRows){\n        cout &lt;&lt; \"row \" &lt;&lt; k++ &lt;&lt; \": \" &lt;&lt; el &lt;&lt; '\\n';\n    }\n    cout &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>The inner loop normally doesn't need to be parallelized. I don't know how many cores you can use, but unless you're on a massively parallel system, think GPU-level of parallelism, the outer loop should either utilize all available cores already, or the problem just isn't big enough to matter. Starting more threads in either situation is a pessimization.</p>\n"}], "owner": {"reputation": 167, "user_id": 6155022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b77db3ce10992915206f0d9dbe8810c?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Edison", "link": "https://stackoverflow.com/users/6155022/thomas-edison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 58419649, "answer_count": 1, "score": 0, "last_activity_date": 1571250705, "creation_date": 1571231953, "question_id": 58414346, "link": "https://stackoverflow.com/questions/58414346/compute-the-minimum-value-of-every-row-in-a-matrix-using-loops-parallel-with-ope", "title": "Compute the minimum value of every row in a matrix using loops parallel with openmp C++", "body": "<p>I want to compute the minimum value of every row in a matrix in parallel using openmp c++ as follows:</p>\n\n<pre><code>// matrix Distf (float) of size n by n is declared before. \nvector&lt;float&gt; minRows;\n#pragma omp parallel for\nfor (i=0; i &lt; n; ++i){\n     float minValue = Distf[i][0];\n     #pragma omp parallel for reduction(min : minValue)\n     for (j=1; j &lt; n; ++j){\n          if (Distf[i][j] &lt; minValue){\n                    minValue = Distf[i][j];\n           }\n     }\n     minRows.push_back(minValue);\n }\n</code></pre>\n\n<p>So far the compiler does not raise any error but I wonder if this would give the correct answer as expect? Thanks</p>\n"}, {"tags": ["c++", "pointers", "dynamic-memory-allocation", "lifetime", "object-lifetime"], "comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1571232019, "post_id": 58414316, "comment_id": 103171513, "body": "&quot;<i>assume it returns the same memory</i>&quot; -  You could add: &quot;<i>3)</i> <code>if(p==q)</code> <i>Both pointers are valid again and can be dereferenced, right?</i>&quot;"}, {"owner": {"reputation": 3874, "user_id": 1930508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4f709ca5b37805423d076b4e3f103f67?s=128&d=identicon&r=PG", "display_name": "Flamefire", "link": "https://stackoverflow.com/users/1930508/flamefire"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1571232260, "post_id": 58414316, "comment_id": 103171658, "body": "The assumption in the video example was, that the same pointer value is returned aka the same memory so the <code>if</code> succeeds. Can easily happen for allocators that simply look if they can serve a request with recently freed memory chunks. On <code>if(p==q)</code>: The point is: Can I do this? The object pointed to by <code>p</code> was deleted, so <code>p</code> is a &quot;zombie pointer&quot;. I really recommend (at least) the first part of the video. Quite entertaining :)"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 2, "creation_date": 1571232896, "post_id": 58414316, "comment_id": 103172073, "body": "(3) is wrong. It makes <code>q</code> dereferencable, but not <code>p</code>."}, {"owner": {"reputation": 3874, "user_id": 1930508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4f709ca5b37805423d076b4e3f103f67?s=128&d=identicon&r=PG", "display_name": "Flamefire", "link": "https://stackoverflow.com/users/1930508/flamefire"}, "edited": false, "score": 0, "creation_date": 1571233184, "post_id": 58414316, "comment_id": 103172239, "body": "Why? A &quot;new object is created at [that] address[...] so all pointers [...] of the original object will automatically refer to the new object&quot;, see link and quote above."}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 1, "creation_date": 1571233306, "post_id": 58414316, "comment_id": 103172320, "body": "@Flamefire Because <code>new</code> returns the address of the newly created object, which is not guaranteed to be the same as the previous deleted one. So after your second <code>new</code>, <code>p</code> and <code>q</code> cannot be considered to point at the same location in memory. See my answer for more explanation."}, {"owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1571234548, "post_id": 58414316, "comment_id": 103173165, "body": "@HolyBlackCat, I believe that your claim that &quot;3 is wrong&quot; is not true because Flamefire asked us to imagine that, <b>by fluke</b>, the allocation that is assigned to <code>q</code> happens by chance to return the <b>same virtual address</b> that is already stored in <code>p</code>.  This can certainly happen.  If it does, the address stored in <code>p</code> will therefore become a valid virtual memory address again (will point to that newly allocated object) which holds the value 42, and so will <code>q</code>."}, {"owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "edited": false, "score": 0, "creation_date": 1571235036, "post_id": 58414316, "comment_id": 103173504, "body": "When you say <i>cannot be dereferenced</i>, it means that you might get old value (if nothing has happened to that memory yet, or you might get an unexpected value if the memory has been reallocated for another purpose, or you might cause an access violation if the paging mechanism has unmapped the physical memory associated with that virtual address. You can certainly dereference the pointer though <b>at great peril</b> - one of the three outcomes I described will occur.  Writing to this memory is very dangerous and will likely corrupt the data that resides there and cause unexpected behaviour."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "edited": false, "score": 0, "creation_date": 1571235565, "post_id": 58414316, "comment_id": 103173863, "body": "@Wyck I admit I didn&#39;t notice the <i>&quot;assume it returns the same memory&quot;</i> part when posting that, but I think my claim still holds (not necessary in practice, but at least formally). When memory is deallocated, values of all pointers pointing to it become invalid ( <a href=\"https://stackoverflow.com/questions/5002055/is-the-pointer-guaranteed-to-preserve-its-value-after-delete-in-c\" title=\"is the pointer guaranteed to preserve its value after delete in c\">stackoverflow.com/questions/5002055/&hellip;</a> ). I doubt they can ever become valid again, unless you assign new values to them."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1571238556, "post_id": 58414316, "comment_id": 103175843, "body": "So, <code>if(std::memcmp(&amp;p, &amp;q, sizeof(void*)) == 0)</code> would be a safe version of <code>if(p==q)</code>? Still unclear if <code>p</code> is valid if that condition is true."}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1571249091, "post_id": 58414316, "comment_id": 103180885, "body": "@TedLyngmo as asked, I&#39;ve undeleted my answer."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 0, "creation_date": 1571250053, "post_id": 58414316, "comment_id": 103181285, "body": "@Fareanor Aha, ok... In the first comment I suggested that OP should make it clearer. I had a feeling it could be misinterpreted."}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1613099319, "post_id": 58414316, "comment_id": 116978272, "body": "<i>// assume it returns the same memory</i> How are you gonna define what does &#171;returns the same memory&#187; mean? How are you gonna check it?"}, {"owner": {"reputation": 3874, "user_id": 1930508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4f709ca5b37805423d076b4e3f103f67?s=128&d=identicon&r=PG", "display_name": "Flamefire", "link": "https://stackoverflow.com/users/1930508/flamefire"}, "edited": false, "score": 0, "creation_date": 1613129613, "post_id": 58414316, "comment_id": 116987192, "body": "By running a debugger and inspecting the return value / value of the pointer which is a defined value at this point. Or by interpreting the code as &quot;portable assembly&quot;. Or by using a custom allocation function which literally returns the same memory (e.g. by reusing the last deleted memory chunk). I didn&#39;t want to discuss how or why, hence I used &quot;assume&quot; and I think to most it was clear what that meant."}], "answers": [{"comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1571233251, "post_id": 58414739, "comment_id": 103172281, "body": "It&#39;s not clarified in the question, but in the comments it was made clear that the assumption is that <code>new</code> returns the same pointer in both cases."}, {"owner": {"reputation": 3874, "user_id": 1930508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4f709ca5b37805423d076b4e3f103f67?s=128&d=identicon&r=PG", "display_name": "Flamefire", "link": "https://stackoverflow.com/users/1930508/flamefire"}, "edited": false, "score": 0, "creation_date": 1571233254, "post_id": 58414739, "comment_id": 103172284, "body": "<code>it is not guaranteed that the same memory block will be reused</code>, right. It is an example which assumes that <i>in this situation</i> the same memory block is used, as is in the video. I&#39;ll update the question to make this clear."}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1571233381, "post_id": 58414739, "comment_id": 103172362, "body": "@MaxLanghof Ah ok, my bad then, I indeed did not understand."}], "tags": [], "owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "is_accepted": false, "score": 1, "last_activity_date": 1571233124, "creation_date": 1571233124, "answer_id": 58414739, "question_id": 58414316, "link": "https://stackoverflow.com/questions/58414316/understand-c-pointer-lifetime-zombie-pointers/58414739#58414739", "title": "Understand C++ pointer lifetime / zombie pointers", "body": "<p>I would disagree with this:</p>\n\n<blockquote>\n  <p><code>// 3) Both pointers are valid again and can be dereferenced</code></p>\n</blockquote>\n\n<p>In fact, you got fooled because at the second <code>new</code>, the program usually reallocate the same memory block at it just became available, but one cannot rely on this (it is not guaranteed that the same memory block will be reused).</p>\n\n<p>For example, if you use the good practice at setting deleted pointers to <code>nullptr</code>, the following program:</p>\n\n<pre><code>int main()\n{\n    int * p = new int(1);\n    int * q = p;\n\n    std::cout &lt;&lt; (p == q) &lt;&lt; std::endl;\n\n    delete q;\n    q = nullptr;\n    p = nullptr;\n\n    q = new int(42);\n\n    std::cout &lt;&lt; (p == q) &lt;&lt; std::endl;\n\n    delete q;\n\n    return 0;\n}\n</code></pre>\n\n<p>would result in:</p>\n\n<blockquote>\n  <p>1<br/>\n  0</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "edited": false, "score": 2, "creation_date": 1571235946, "post_id": 58415595, "comment_id": 103174094, "body": "I think you assume to much that they are &quot;relying&quot; on any feature.  The question is merely &quot;what if it happens to returns the same virtual address&quot;.  This was articulated as &quot;assume it returns the same memory&quot; - meaning &quot;for the purposes of this discussion, please consider what happens in this case&quot;.  The poster recognizes explicitly that this doesn&#39;t mean we can generally assume that the same virtual address will be returned.    It&#39;s like saying &quot;flip a coin and assume it&#39;s heads&quot;.  We&#39;re asked to explore the <i>heads</i> case, not to assume that the coin will always turn up heads."}, {"owner": {"reputation": 10419, "user_id": 1151724, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/q6fMI.jpg?s=128&g=1", "display_name": "CodeClown42", "link": "https://stackoverflow.com/users/1151724/codeclown42"}, "reply_to_user": {"reputation": 5746, "user_id": 1563833, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3d7ae271e46eb178e7dd4f2ef760e6f?s=128&d=identicon&r=PG", "display_name": "Wyck", "link": "https://stackoverflow.com/users/1563833/wyck"}, "edited": false, "score": 0, "creation_date": 1571236107, "post_id": 58415595, "comment_id": 103174202, "body": "Right, that (the heads case) is the second half of the answer here, which asserts it doesn&#39;t matter how two such pointers came to be because they are identical to something very normative."}, {"owner": {"reputation": 3874, "user_id": 1930508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4f709ca5b37805423d076b4e3f103f67?s=128&d=identicon&r=PG", "display_name": "Flamefire", "link": "https://stackoverflow.com/users/1930508/flamefire"}, "edited": false, "score": 0, "creation_date": 1571294542, "post_id": 58415595, "comment_id": 103194192, "body": "&gt; It&#39;s not, so what ever has lead you to that conclusion is a misunderstanding or misinformation.  This stems from the linked video, e.g. first part. Allocation happens to return the same pointer so a copy of the pointer that was gotten before will still be used and is called a &quot;zombie pointer&quot; because its pointee was deleted. I think this IS in fact UB for the case of constant members of the pointee: The compiler may &quot;cache&quot; the value of the const member, but a newly allocated instance might have another value there. I&#39;ll put that into the question"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1571885075, "post_id": 58415595, "comment_id": 103390089, "body": "Your first snippet does not make sense as <code>p</code> is not defined. Also you talk about <code>p2</code> but do not define that anywhere."}, {"owner": {"reputation": 10419, "user_id": 1151724, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/q6fMI.jpg?s=128&g=1", "display_name": "CodeClown42", "link": "https://stackoverflow.com/users/1151724/codeclown42"}, "edited": false, "score": 0, "creation_date": 1571920810, "post_id": 58415595, "comment_id": 103404798, "body": "<i>&quot;Starting with a contrivance...&quot;</i> and <code>p</code> and <code>q</code> are from the question as originally (and currently) written.  The contrivance from the question is that &quot;the compiler did it&quot;. It doesn&#39;t matter whether they got that way according to clear laws of the language (as in the second case above) or through happenstance as asserted in the question.  They are two pointers of the same type that point to the same memory location.  I suppose then referring to them as <code>p</code> and <code>p2</code> is a bit confusing, I&#39;ll change that (thanks)."}], "tags": [], "owner": {"reputation": 10419, "user_id": 1151724, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/q6fMI.jpg?s=128&g=1", "display_name": "CodeClown42", "link": "https://stackoverflow.com/users/1151724/codeclown42"}, "is_accepted": false, "score": 1, "last_activity_date": 1571921060, "last_edit_date": 1571921060, "creation_date": 1571235720, "answer_id": 58415595, "question_id": 58414316, "link": "https://stackoverflow.com/questions/58414316/understand-c-pointer-lifetime-zombie-pointers/58415595#58415595", "title": "Understand C++ pointer lifetime / zombie pointers", "body": "<p>Starting with the contrivance described in the question, an already allocated <code>int* p</code> and:</p>\n\n<pre><code>int* q = p;\nq = new int(42); // assume it returns the same memory\n</code></pre>\n\n<p>We now have a scenario that's identical to this:</p>\n\n<pre><code>int* p = new int(42);\nint* q = p;\n</code></pre>\n\n<p>Because it meets the preconditions that we can assume <code>p</code> and <code>q</code> point to the same memory location; that being the case the fact that this location was allocated something then deleted then allocated again doesn't matter.  Nothing that happened before this point matters because we are assuming the two pointers are in a state identical to the one just described.  </p>\n\n<p>With regard to \"the value of both is unspecified\" in step #2, I would say the value of <code>q</code> is unspecified at that point because it was passed to <code>delete</code>, but the value of <code>p</code> is unchanged.</p>\n\n<p>The behavior of <code>delete</code> here is actually not undefined under C++14, it's <strong><a href=\"https://en.wikipedia.org/wiki/Unspecified_behavior#Implementation-defined_behavior\" rel=\"nofollow noreferrer\">implementation defined</a></strong>; a bit from some documentation of <code>delete</code>: </p>\n\n<blockquote>\n  <p>Any use of a pointer that became invalid in this manner, even copying the pointer value into another variable, is undefined behavior. <em>(until C++14)</em></p>\n  \n  <p>Indirection through a pointer that became invalid in this manner and passing it to a deallocation function (double-delete) is undefined behavior. Any other use is implementation-defined. <em>(since C++14)</em></p>\n</blockquote>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/memory/new/operator_delete\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/memory/new/operator_delete</a></p>\n\n<p>So, to answer what I think is your question, in that circumstance, then no, neither on is a zombie pointer.</p>\n\n<blockquote>\n  <p>So why is this a zombie pointer and supposedly UB?</p>\n</blockquote>\n\n<p>It's not, so what ever has lead you to that conclusion is a misunderstanding or misinformation.</p>\n"}, {"comments": [{"owner": {"reputation": 3874, "user_id": 1930508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4f709ca5b37805423d076b4e3f103f67?s=128&d=identicon&r=PG", "display_name": "Flamefire", "link": "https://stackoverflow.com/users/1930508/flamefire"}, "edited": false, "score": 0, "creation_date": 1571916771, "post_id": 58533378, "comment_id": 103402697, "body": "Ok so the correct wording is &quot;invalid pointer value&quot; not &quot;unspecified value&quot;. However as any use is either UB or implementation-defined this difference does not really matter. (Or is there anywhere specified which value an &quot;invalid pointer value&quot; is?) <code>There is no way to determine whether a new allocation is at the &quot;same location&quot;</code> Ouch, this is insane. Now an operation on a <b>copy</b> of an object (a pointer) has side-effects on another copy of the object/value possibly making it unusable. Try to explain this to a beginner/intermediate programmer. This is like `a = b; b -= c; //a may be invalid"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 3874, "user_id": 1930508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4f709ca5b37805423d076b4e3f103f67?s=128&d=identicon&r=PG", "display_name": "Flamefire", "link": "https://stackoverflow.com/users/1930508/flamefire"}, "edited": false, "score": 0, "creation_date": 1571919243, "post_id": 58533378, "comment_id": 103403964, "body": "@Flamefire &quot;invalid pointer value&quot; is the &quot;which value&quot;.  The difference between UB and implementation-defined behaviour is significant.  The mysteries of C++ can be deep although perhaps not in this case;  if I copy a file handle and close it, is it mysterious that the original handle is no longer useful?  E.g. that original handle might match a new handle we get from opening a different file."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 3874, "user_id": 1930508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4f709ca5b37805423d076b4e3f103f67?s=128&d=identicon&r=PG", "display_name": "Flamefire", "link": "https://stackoverflow.com/users/1930508/flamefire"}, "edited": false, "score": 0, "creation_date": 1571919335, "post_id": 58533378, "comment_id": 103404019, "body": "Imagine a system where the hardware automatically checks any pointer register against the MMU&#39;s list of active allocations"}, {"owner": {"reputation": 3874, "user_id": 1930508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4f709ca5b37805423d076b4e3f103f67?s=128&d=identicon&r=PG", "display_name": "Flamefire", "link": "https://stackoverflow.com/users/1930508/flamefire"}, "edited": false, "score": 0, "creation_date": 1571919905, "post_id": 58533378, "comment_id": 103404337, "body": "It is easy to understand that an invalid handle/pointer cannot be dereferenced, but that its value cannot be used anymore is hard. The file handle analogy is great though. I cannot come up with a use case where you&#39;d want to hold on to a file handle that might be closed by someone else even though it could be reopened and point to (another or the same) file. <code>any pointer register against the MMU&#39;s list of active allocations</code> well the allocation might be active again. It just contains something else."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1571885242, "last_edit_date": 1571885242, "creation_date": 1571884781, "answer_id": 58533378, "question_id": 58414316, "link": "https://stackoverflow.com/questions/58414316/understand-c-pointer-lifetime-zombie-pointers/58533378#58533378", "title": "Understand C++ pointer lifetime / zombie pointers", "body": "<p>A deleted pointer value has an <em>invalid pointer value</em>, not an unspecified value.</p>\n\n<p>As of C++17 the behaviour of invalid pointer values is defined in [basic.stc]/4:</p>\n\n<blockquote>\n  <p>Indirection through an invalid pointer value and passing an invalid pointer value to a deallocation function have undefined behavior. Any other use of an invalid pointer value has implementation-defined behavior.</p>\n</blockquote>\n\n<p>So, trying to compare two invalid pointers has implementation-defined behaviour. There is a footnote clarifying that this behaviour could include a runtime fault.</p>\n\n<p>In your first snippet <code>p</code> has an invalid pointer value after the delete; anything you might do to <code>q</code> has no bearing on this.  Invalid pointer values cannot magically become valid again. There is no way (within the confines of Standard C++) to determine whether a new allocation is at the \"same location\" as a previous allocation.</p>\n\n<p><code>std::launder</code> is no help; again you use an invalid pointer value and therefore trigger implementaiton-defined behaviour.</p>\n\n<p>Perhaps you could consult the documentation for your implementation and see what it defines this behaviour as.</p>\n\n<p>In your question you mention C DR 260, however that is irrelevant. C is a different language to C++. In C++, deleted pointers have <em>invalid pointer value</em>, not <em>indeterminate value</em>.</p>\n"}], "owner": {"reputation": 3874, "user_id": 1930508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4f709ca5b37805423d076b4e3f103f67?s=128&d=identicon&r=PG", "display_name": "Flamefire", "link": "https://stackoverflow.com/users/1930508/flamefire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1571921060, "creation_date": 1571231858, "last_edit_date": 1571883621, "question_id": 58414316, "link": "https://stackoverflow.com/questions/58414316/understand-c-pointer-lifetime-zombie-pointers", "title": "Understand C++ pointer lifetime / zombie pointers", "body": "<p>After watching CppCons <a href=\"https://www.youtube.com/watch?v=7bZQeOGhK84\" rel=\"nofollow noreferrer\">Will Your Code Survive the Attack of the Zombie Pointers?</a> I'm a bit confused about pointer lifetime and need some clarification.</p>\n\n<p>First some basic understanding. Please correct me if any comments are wrong:</p>\n\n<pre><code>int* p = new int(1);\nint* q = p;\n// 1) p and q are valid and one can do *p, *q\ndelete q;\n// 2) both are invalid and cannot be dereferenced. Also the value of both is unspecified\nq = new int(42); // assume it returns the same memory\n// 3) Both pointers are valid again and can be dereferenced\n</code></pre>\n\n<p>I'm puzzled by 2). Obviously they cannot be dereferenced, but why can't their values be used (e.g. to compare one against another, even unrelated and valid pointer?) This is stated in around <a href=\"https://youtu.be/7bZQeOGhK84?t=1538\" rel=\"nofollow noreferrer\">25:38</a>. I can't find anything about this on <a href=\"https://en.cppreference.com/w/cpp/language/lifetime\" rel=\"nofollow noreferrer\">cppreference</a>, which is where I got 3) from.</p>\n\n<p>Note: The assumption, that the same memory is returned, cannot be generalized as it may or may not happen. For this example it should be taken as granted that it \"randomly\" returned the same memory as is the case in the video example and (maybe?) required for the below code to break.</p>\n\n<p>The multi-threaded example code from the LIFO list can be put simulated in a single thread as:</p>\n\n<pre><code>Node* top = ... //NodeA allocated before;\nNode* newnodeC = new Node(v); \nnewnodeC-&gt;next = top;\ndelete top; top = nullptr;\n// newnodeC-&gt;next is a zombie pointer\nNode* newnodeD = new Node(u); // assume same memory as NodeA is returned\ntop = newnodeD;\nif(top == newnodeC-&gt;next) // true\n  top = newnodeC;\n// Now top-&gt;next is (still) a zombie pointer\n</code></pre>\n\n<p>This should be valid, unless <code>Node</code> contains nonstatic const members or references according to the rules under </p>\n\n<blockquote>\n  <p>If a new object is created at the address that was occupied by another object, then all pointers, references, and the name of the original object will automatically refer to the new object and, once the lifetime of the new object begins, can be used to manipulate the new object, but only if the following conditions are satisfied [which they are]</p>\n</blockquote>\n\n<p>So why is this a zombie pointer and supposedly UB?</p>\n\n<p>Could the (single-threaded) condensed code above be fixed (in case there are const-members) by a <code>newnodeC-&gt;next = std::launder(newnodeC-&gt;next)</code> as of </p>\n\n<blockquote>\n  <p>If the conditions listed above are not met, a valid pointer to the new object may still be obtained by applying the pointer optimization barrier std::launder</p>\n</blockquote>\n\n<p>I'd expect this to fix the \"zombie pointer\" and compilers to not emit instructions for the assignment but simply treat it as an optimization barrier (e.g. when the function is inlined and a const-member is accessed again)</p>\n\n<p>So in summary: I haven't heard of \"zombie pointers\" before. Am I correct that any pointer to a destroyed/deleted object cannot be used (for reading [the pointers value] and dereferencing [read of the pointee]) unless the pointer is reassigned or the memory reallocated with the same object type recreated there (and without const/reference members)? Can't this be fixed by C++17 <code>std::launder</code> already? (baring multi-threaded issues)</p>\n\n<p>Also: At <code>3)</code> in the first code would <code>if(p==q)</code> even be generally valid? Because from  my understanding of the (second part of the) video it is not valid to read <code>p</code>.</p>\n\n<p>Edit: As an explanation where I'm pretty sure UB happens: Again assume that by pure chance the same memory is returned with the <code>new</code>:</p>\n\n<pre><code>// Global\nstruct Node{\n  const int value;\n};\nNode* globalPtr = nullptr;\n// In some func\nNode* ptr = new Node{42};\nglobalPtr = ptr;\nconst int value = ptr-&gt;value;\nfoo(value);\n// Possibly on another thread (if multi-threaded assume proper synchronisation so that this scenario happens)\ndelete globalPtr;\nglobalPtr = new Node{1337}; // Assume same memory returned\n// First thread again (and maybe on serial code too)\nif(ptr == globalPtr)\n  foo(ptr-&gt;value);\nelse\n  foo(globalPtr-&gt;value);\n</code></pre>\n\n<p>According to the video, after <code>delete globalPtr</code> also the <code>ptr</code> is a \"zombie pointer\" and cannot be used (aka \"would be UB\"). A sufficiently optimizing compiler can make use of this and assume the pointee was never freed (especially when the delete/new happens on another functon/thread/...) and optimize <code>foo(ptr-&gt;value)</code> to <code>foo(42)</code></p>\n\n<p>Note also the mentioned <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/dr_260.htm\" rel=\"nofollow noreferrer\">Defect Report 260</a>:</p>\n\n<blockquote>\n  <p>Where a pointer value becomes indeterminate because the object pointed to has reached the end of its lifetime, all objects whose effective type is a pointer and that point to the same object acquire an indeterminate value. Thus p at point X, and p, q, and r at point Z, can all change their value.</p>\n</blockquote>\n\n<p>I think this is the definitive explanation: After <code>delete globalPtr</code> the value of <code>ptr</code> is also indeterminate. But how can this align with </p>\n\n<blockquote>\n  <p>If a new object is created at the address that was occupied by another object, then all pointers [...] of the original object will automatically refer to the new object and[...] can be used to manipulate the new object</p>\n</blockquote>\n"}, {"tags": ["c++", "linker"], "comments": [{"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1571231693, "post_id": 58414191, "comment_id": 103171294, "body": "Do you use any of the SubDependency functions in your application?"}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1571231972, "post_id": 58414191, "comment_id": 103171487, "body": "&quot;These dependencies are not exposed by the library&quot; this is not correct, just because <code>mySubDependencyClass</code> is private doesn&#39;t mean it is not part of your libraries interface. There needs to be no instances of library a&#39;s classes in library b&#39;s public headers"}, {"owner": {"reputation": 113, "user_id": 5384098, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206042895686251/picture?type=large", "display_name": "Claude Hasler", "link": "https://stackoverflow.com/users/5384098/claude-hasler"}, "reply_to_user": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1571232822, "post_id": 58414191, "comment_id": 103172015, "body": "@vahancho no i do not, or if i do, then they are wrapped"}, {"owner": {"reputation": 113, "user_id": 5384098, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206042895686251/picture?type=large", "display_name": "Claude Hasler", "link": "https://stackoverflow.com/users/5384098/claude-hasler"}, "reply_to_user": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1571232878, "post_id": 58414191, "comment_id": 103172059, "body": "@AlanBirtles How would i wrap the subdependency correctly to get around this?"}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1571233082, "post_id": 58414191, "comment_id": 103172177, "body": "either hide it completely using the pimpl pattern or you might be able to get away with forward declaring <code>MySubDependencyClass</code> in <code>MyLibraryClass</code> and making <code>mySubDependencyClass</code> a pointer (preferrably a smart one)"}, {"owner": {"reputation": 113, "user_id": 5384098, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206042895686251/picture?type=large", "display_name": "Claude Hasler", "link": "https://stackoverflow.com/users/5384098/claude-hasler"}, "reply_to_user": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1571233326, "post_id": 58414191, "comment_id": 103172332, "body": "@AlanBirtles thanks, the forward declaration worked, ill check out the pimpl pattern"}], "owner": {"reputation": 113, "user_id": 5384098, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206042895686251/picture?type=large", "display_name": "Claude Hasler", "link": "https://stackoverflow.com/users/5384098/claude-hasler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571233276, "creation_date": 1571231543, "last_edit_date": 1571233276, "question_id": 58414191, "link": "https://stackoverflow.com/questions/58414191/do-i-have-to-link-to-dependencies-of-my-dependencies", "title": "Do I have to link to dependencies of my dependencies?", "body": "<p>Im building a shared library which itself has a dependency on another shared library.\nThese dependencies are not exposed by the library, for example</p>\n\n<p><strong>In Library A:</strong></p>\n\n<pre><code>\nclass MySubDependencyClass{\n\n}\n</code></pre>\n\n<p><strong>In Library B:</strong></p>\n\n<pre><code>class MyLibraryClass{\npublic:\n   void foo(){\n      mySubDependencyClass.foo()\n   }\nprivate:\nMySubDependencyClass mySubDependencyClass;\n}\n</code></pre>\n\n<p><strong>In my Application:</strong></p>\n\n<pre><code>class MyAppClass{\n  MyLibraryClass myLibrary class\n}\n</code></pre>\n\n<p>The dependency chain looks like this MyApp -> MyLibrary ->MySubDependency</p>\n\n<p>When building MyApp at the moment I have to link the subdependencies as well as the direct dependency. Is there any way to get around this? It seems very unelegant.</p>\n\n<p>I found this link:\n<a href=\"https://stackoverflow.com/questions/11055569/linking-with-dynamic-library-with-dependencies\">Linking with dynamic library with dependencies</a> \nbut couldn't understand if the issue was resolved or not</p>\n\n<p>My IDE is qtcreator.</p>\n\n<p>EDIT:</p>\n\n<p>I have now forward declared the subdependency</p>\n\n<p><strong>In Library B:</strong></p>\n\n<pre><code>class MySubDependencyClass;\n\nclass MyLibraryClass{\npublic:\n   void foo(){\n      mySubDependencyClass.foo()\n   }\nprivate:\nMySubDependencyClass mySubDependencyClass;\n}\n</code></pre>\n\n<p>and this works, is this the way to go? What is the \"standard\" way of dealing with this?</p>\n"}, {"tags": ["c++", "printf"], "comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 2, "creation_date": 1571231473, "post_id": 58414125, "comment_id": 103171150, "body": "<code>printf(&quot;%d\\n&quot;, i);</code> - and remove <code>return 0;</code>"}, {"owner": {"reputation": 109, "user_id": 4605692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yJeMQ.jpg?s=128&g=1", "display_name": "dorKKnight", "link": "https://stackoverflow.com/users/4605692/dorkknight"}, "edited": false, "score": 3, "creation_date": 1571231573, "post_id": 58414125, "comment_id": 103171218, "body": "<b>sidenote</b> :: question is tagged with C++ and <code>stdio.h</code> is not a C++ header. Please, use the c++ header files and functions."}, {"owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "edited": false, "score": 0, "creation_date": 1571231596, "post_id": 58414125, "comment_id": 103171233, "body": "Ted is correct, however you should check out the <a href=\"http://www.cplusplus.com/reference/cstdio/printf/\" rel=\"nofollow noreferrer\">reference sheet</a> for more on how printf works, so that you can understand how to do more than just decimals!"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "edited": false, "score": 1, "creation_date": 1571231650, "post_id": 58414125, "comment_id": 103171263, "body": "@alteredinstance Prefer this site: <a href=\"https://en.cppreference.com/w/cpp/io/c/fprintf\" rel=\"nofollow noreferrer\">ref sheet @ cppreference</a>"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "reply_to_user": {"reputation": 109, "user_id": 4605692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yJeMQ.jpg?s=128&g=1", "display_name": "dorKKnight", "link": "https://stackoverflow.com/users/4605692/dorkknight"}, "edited": false, "score": 0, "creation_date": 1571232567, "post_id": 58414125, "comment_id": 103171859, "body": "@dorKKnight - You interpretation is over-simplistic.  All C++ standards explicitly support a set of C headers as part of the C++ standard library, including <code>&lt;stdio.h&gt;</code>, for reasons of backward compatibility although their usage is deprecated."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1571233051, "post_id": 58414125, "comment_id": 103172163, "body": "Please note that once execution hits a return the function is done executing."}], "answers": [{"comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 1, "creation_date": 1571231580, "post_id": 58414184, "comment_id": 103171224, "body": "@TedLyngmo Wow, I completely oversaw that. Thanks!"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 1, "creation_date": 1571231727, "post_id": 58414184, "comment_id": 103171310, "body": "The <code>return 0</code> is optional for <code>int main</code> for newer versions, if I&#39;m not mistaken."}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 2, "last_activity_date": 1571231823, "last_edit_date": 1571231823, "creation_date": 1571231528, "answer_id": 58414184, "question_id": 58414125, "link": "https://stackoverflow.com/questions/58414125/cant-printf-an-integer-in-visual-studio-2019/58414184#58414184", "title": "Can&#39;t printf an integer in Visual Studio 2019", "body": "<p><code>printf</code> can't print <code>int</code> (or <code>size_t</code>) like that. Instead, give it the correct specifier (<code>%d</code> for <code>int</code> and <code>%zu</code> for <code>size_t</code>):</p>\n\n<pre><code>int main()\n{\n    for (size_t i = 0; i &lt; 3; i++)\n    {\n        printf(\"%zu\", i);\n    }\n    return 0; // not needed for main - default is 0\n}\n</code></pre>\n\n<p>If you're interested in what <code>printf</code> can print and how to do that, you can find a documentation <a href=\"http://www.cplusplus.com/reference/cstdio/printf/\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 2, "creation_date": 1571232099, "post_id": 58414319, "comment_id": 103171558, "body": "<code>std::endl</code> is rarely required, just use <code>&#39;\\n&#39;</code>"}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1571232156, "post_id": 58414319, "comment_id": 103171598, "body": "@AlanBirtles I agree - but it&#39;s a matter of choice/preference/compatibility."}, {"owner": {"reputation": 4915, "user_id": 10686048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bffd06d00a80b9b69e83f561ee5a392?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisMM", "link": "https://stackoverflow.com/users/10686048/chrismm"}, "edited": false, "score": 2, "creation_date": 1571232386, "post_id": 58414319, "comment_id": 103171730, "body": "Choosing <code>endl</code> is a bad choice, as it also flushes the buffer, which is really unneeded."}], "tags": [], "owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "is_accepted": false, "score": 1, "last_activity_date": 1571231871, "creation_date": 1571231871, "answer_id": 58414319, "question_id": 58414125, "link": "https://stackoverflow.com/questions/58414125/cant-printf-an-integer-in-visual-studio-2019/58414319#58414319", "title": "Can&#39;t printf an integer in Visual Studio 2019", "body": "<p>You've tagged and stated that you're using <code>C++</code> (not <code>C</code>), so try using the far nicer/easier output functions provided by streams:</p>\n\n<pre><code>#include &lt;iostream&gt;\nint main()\n{\n    for (size_t i = 0; i &lt; 3; i++)\n    {\n        std::cout &lt;&lt; i &lt;&lt; std::endl;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>But the other answer and comments are perfectly fine, if you insist on using <code>printf</code>!</p>\n"}], "owner": {"reputation": 13, "user_id": 5492561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53c1f5b64e64fea12c5be5adb49e5dde?s=128&d=identicon&r=PG&f=1", "display_name": "uri2563", "link": "https://stackoverflow.com/users/5492561/uri2563"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 853, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1571232014, "creation_date": 1571231366, "last_edit_date": 1571232014, "question_id": 58414125, "link": "https://stackoverflow.com/questions/58414125/cant-printf-an-integer-in-visual-studio-2019", "title": "Can&#39;t printf an integer in Visual Studio 2019", "body": "<p>I'm really new to c++. I opened a new project and I was trying to start and print using printf.\nWhen I'm printing strings it works great but, when I try to print integers, it causes an error.\nI'm using Visual Studio 2019 and using a Windows 10 computer.\n<a href=\"https://i.stack.imgur.com/4v7Lp.png\" rel=\"nofollow noreferrer\">error and code</a></p>\n\n<p>This is the simple code i'm trying to run:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    for (size_t i = 0; i &lt; 3; i++)\n    {\n        printf(i);\n        return 0;\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c++", "stl", "c++14"], "comments": [{"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1571231206, "post_id": 58414013, "comment_id": 103170986, "body": "Why can&#39;t you implement that operator in your iterator class?"}, {"owner": {"reputation": 7363, "user_id": 1678770, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9afe9e6d4e0264da3d228c79162377f8?s=128&d=identicon&r=PG", "display_name": "Human-Compiler", "link": "https://stackoverflow.com/users/1678770/human-compiler"}, "edited": false, "score": 1, "creation_date": 1571231419, "post_id": 58414013, "comment_id": 103171106, "body": "Does your iterator define the required <code>iterator_category</code> member type to be <code>std::forward_iterator_tag</code>? The error contains the template typename <code>_RanIt</code> in the error message, which sounds like <code>std::copy</code> is treating your iterator like a random-access iterator -- which could be due to bad iterator deduction."}, {"owner": {"reputation": 21755, "user_id": 149818, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2a2cc0bea23b5e604a252f0f3f0456aa?s=128&d=identicon&r=PG", "display_name": "Dewfy", "link": "https://stackoverflow.com/users/149818/dewfy"}, "reply_to_user": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1571235660, "post_id": 58414013, "comment_id": 103173926, "body": "@vahancho - because it is neither semantically nor physically defined. For example you have hash-table with buckets, 2 iterators points onto separate buckets, what the meaning of subtraction between them?"}, {"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1571294360, "post_id": 58414013, "comment_id": 103194111, "body": "@Dewfy, maybe the distance between two buckets? In other words, it will define how many steps you need to move from one bucket to another."}, {"owner": {"reputation": 21755, "user_id": 149818, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2a2cc0bea23b5e604a252f0f3f0456aa?s=128&d=identicon&r=PG", "display_name": "Dewfy", "link": "https://stackoverflow.com/users/149818/dewfy"}, "reply_to_user": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1571302611, "post_id": 58414013, "comment_id": 103198289, "body": "@vahancho fictive distance for senseless operation that expects extra development effort. No thank you."}], "answers": [{"comments": [{"owner": {"reputation": 7363, "user_id": 1678770, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9afe9e6d4e0264da3d228c79162377f8?s=128&d=identicon&r=PG", "display_name": "Human-Compiler", "link": "https://stackoverflow.com/users/1678770/human-compiler"}, "edited": false, "score": 1, "creation_date": 1571231553, "post_id": 58414183, "comment_id": 103171208, "body": "There should be no need to specialize <code>iterator_traits</code>. Custom iterators in C++17 just need to have the appropriate member types defined."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1571232301, "last_edit_date": 1571232301, "creation_date": 1571231518, "answer_id": 58414183, "question_id": 58414013, "link": "https://stackoverflow.com/questions/58414013/msvc-17-stdcopy-expects-operator-for-custom-iterator/58414183#58414183", "title": "MSVC++ 17 std::copy expects &quot;operator -&quot; for custom iterator", "body": "<p>You'll need to define <code>NodeTableIterator::iterator_category</code>. More specifically, it must not be  <code>std::random_access_iterator_tag</code> or else <code>operator-</code> will be required by the algorithm.</p>\n\n<p>You also need to define</p>\n\n<pre><code>NodeTableIterator::difference_type\nNodeTableIterator::value_type\nNodeTableIterator::pointer\nNodeTableIterator::reference\n</code></pre>\n\n<p>Or else <code>std::iterator_traits</code> won't have any of those definitions. Or you can spesialise <code>std::iterator_traits</code> explicitly. Note that if you don't do either of these things, then <code>NodeTableIterator</code> is not an <code>Iterator</code> at all.</p>\n"}, {"tags": [], "owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "is_accepted": true, "score": 6, "last_activity_date": 1571232304, "last_edit_date": 1571232304, "creation_date": 1571231641, "answer_id": 58414225, "question_id": 58414013, "link": "https://stackoverflow.com/questions/58414013/msvc-17-stdcopy-expects-operator-for-custom-iterator/58414225#58414225", "title": "MSVC++ 17 std::copy expects &quot;operator -&quot; for custom iterator", "body": "<p>You need to provide the five types, either within the class itself:</p>\n\n<pre><code>template &lt;class Container&gt;\nstruct NodeTableIterator {\n    using iterator_category = /* ... */;\n    using value_type = /* ... */;\n    using difference_type = /* ... */;\n    using pointer = /* ... */;\n    using reference = /* ... */;\n    // ...\n};\n</code></pre>\n\n<p>or within a custom specialization of <code>std::iterator_traits</code>.  Otherwise, the tag dispatch on the iterator category in the standard algorithms won't work.</p>\n\n<hr>\n\n<p>Reference: <a href=\"https://timsong-cpp.github.io/cppwp/n4659/iterator.traits#1\" rel=\"nofollow noreferrer\">[iterator.traits]/1</a> (the types in <code>std::iterator_traits</code> are required to be present)</p>\n\n<blockquote>\n  <p>To implement algorithms only in terms of iterators, it is often\n  necessary to determine the value and difference types that correspond\n  to a particular iterator type. Accordingly, it is required that if\n  <code>Iterator</code> is the type of an iterator, the types</p>\n\n<pre><code>iterator_traits&lt;Iterator&gt;::difference_type\niterator_traits&lt;Iterator&gt;::value_type\niterator_traits&lt;Iterator&gt;::iterator_category\n</code></pre>\n  \n  <p>be defined as the iterator's difference type, value type and iterator\n  category, respectively. In addition, the types</p>\n\n<pre><code>iterator_traits&lt;Iterator&gt;::reference\niterator_traits&lt;Iterator&gt;::pointer\n</code></pre>\n  \n  <p>shall be defined as the iterator's reference and pointer types, that\n  is, for an iterator object <code>a</code>, the same type as the type of <code>*a</code> and\n  <code>a-&gt;</code>, respectively. In the case of an output iterator, the types</p>\n\n<pre><code>iterator_traits&lt;Iterator&gt;::difference_type\niterator_traits&lt;Iterator&gt;::value_type\niterator_traits&lt;Iterator&gt;::reference\niterator_traits&lt;Iterator&gt;::pointer\n</code></pre>\n  \n  <p>may be defined as <code>void</code>.</p>\n</blockquote>\n\n<p><a href=\"https://timsong-cpp.github.io/cppwp/n4659/iterator.traits#2\" rel=\"nofollow noreferrer\">[iterator.traits]/2</a> (the types in <code>std::iterator_traits</code> can be generated from the member types)</p>\n\n<blockquote>\n  <p>If <code>Iterator</code> has valid ([temp.deduct]) member types\n  <code>difference_\u00adtype</code>, <code>value_\u00adtype</code>, <code>pointer</code>, <code>reference</code>, and\n  <code>iterator_\u00adcategory</code>, <code>iterator_\u00adtraits&lt;Iterator&gt;</code> shall have the\n  following as publicly accessible members:</p>\n\n<pre><code>using difference_type   = typename Iterator::difference_type;\nusing value_type        = typename Iterator::value_type;\nusing pointer           = typename Iterator::pointer;\nusing reference         = typename Iterator::reference;\nusing iterator_category = typename Iterator::iterator_category;\n</code></pre>\n  \n  <p>Otherwise, <code>iterator_\u00adtraits&lt;Iterator&gt;</code> shall have no members by any\n  of the above names.</p>\n</blockquote>\n"}], "owner": {"reputation": 21755, "user_id": 149818, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2a2cc0bea23b5e604a252f0f3f0456aa?s=128&d=identicon&r=PG", "display_name": "Dewfy", "link": "https://stackoverflow.com/users/149818/dewfy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 58414225, "answer_count": 2, "score": 3, "last_activity_date": 1571232304, "creation_date": 1571231009, "question_id": 58414013, "link": "https://stackoverflow.com/questions/58414013/msvc-17-stdcopy-expects-operator-for-custom-iterator", "title": "MSVC++ 17 std::copy expects &quot;operator -&quot; for custom iterator", "body": "<p>I migrate my project from VC++ 2015 to VC++ 2017.\nI have my own implementation of iterator. It has forward-only operations set:</p>\n\n<pre><code>template &lt;class Container&gt;\nstruct NodeTableIterator\n{\n    typedef NodeTableIterator&lt;Container&gt; this_t;\n    this_t&amp; operator ++();\n    this_t operator ++(int);\n};\n</code></pre>\n\n<p>Somewhere in code I use it for <code>std::copy</code></p>\n\n<pre><code>std::copy(tbl.begin(), tbl.end(),\n        std::ostream_iterator&lt;int&gt;(std::cout, \", \"));    \n</code></pre>\n\n<p>This line perfectly worked in VC++2015 but fails in 2017 just because:</p>\n\n<blockquote>\n  <p>error C2784: 'unknown-type std::operator -(const std::move_iterator&lt;_RanIt> &amp;,const std::move_iterator&lt;_RanIt2> &amp;)': could not deduce template argument for 'const std::move_iterator&lt;_RanIt> &amp;' from 'const NodeTableIterator...'</p>\n</blockquote>\n\n<p>Simple inspection inside <code>std::copy</code> shows this source of error:</p>\n\n<pre><code>    const auto _UDest = _Unchecked_n(_Dest, _Idl_distance&lt;_InIt&gt;(_UFirst, _ULast));\n</code></pre>\n\n<p>Where _Idl_distance really expects that my iterator should support <code>operator -</code>. \nHave you any idea how to overcome this strange requirement?</p>\n"}, {"tags": ["c++", "arrays"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11539335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf096465ff865de600e83a486e997cd4?s=128&d=identicon&r=PG&f=1", "display_name": "ziinaa", "link": "https://stackoverflow.com/users/11539335/ziinaa"}, "edited": false, "score": 0, "creation_date": 1571231175, "post_id": 58414028, "comment_id": 103170969, "body": "omg! thank you so much:) i spent a lot of time for that TT thank you so much"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1571237888, "post_id": 58414028, "comment_id": 103175430, "body": "Second problem (which the first masked): the outer loop runs off the end of the array. <code>i &lt;=size</code> should be <code>i &lt; size</code>."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1571295235, "post_id": 58414028, "comment_id": 103194491, "body": "@PeteBecker you&#39;re right, I changed the suggestion to use <code>std::adjacent_find</code> instead."}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 1, "last_activity_date": 1571295091, "last_edit_date": 1571295091, "creation_date": 1571231081, "answer_id": 58414028, "question_id": 58413957, "link": "https://stackoverflow.com/questions/58413957/c-how-to-find-duplicate-by-using-for-loops/58414028#58414028", "title": "c++ how to find Duplicate by using for loops", "body": "<p>The issue is here:</p>\n\n<pre><code>for (int i = 0; i &lt;= size; i++) {\n        for (int j = i+1; j &lt;= size; j++) {\n\n            if (ar[i] == ar[j]) {\n                return true;\n            }\n\n            else\n                return false;\n        }\n    }\n</code></pre>\n\n<p>This compares the first element with the second element, and if they are equal it returns <code>true</code>, otherwise it returns <code>false</code>. But you don't want that. What you want is to loop through the whole array and only return <code>false</code> if it never found a match.</p>\n\n<p>Remove the <code>else return false;</code> in the loop and instead put a <code>return false;</code> at the end of the function (after the loops).</p>\n\n<hr>\n\n<p>On a side note, you can find those duplicates more efficiently by sorting the array:</p>\n\n<pre><code>bool duplication(int* ar, int size) {\n    return (std::adjacent_find(ar, ar + size) != ar + size);\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11539335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf096465ff865de600e83a486e997cd4?s=128&d=identicon&r=PG&f=1", "display_name": "ziinaa", "link": "https://stackoverflow.com/users/11539335/ziinaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1571295091, "creation_date": 1571230825, "question_id": 58413957, "link": "https://stackoverflow.com/questions/58413957/c-how-to-find-duplicate-by-using-for-loops", "title": "c++ how to find Duplicate by using for loops", "body": "<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\n\nint* randnum(int* arr, int n) {\n    int *ar = new int[n / 2];\n\n    for (int i = 0; i &lt; n/2; i++) {\n        ar[i] = rand() % n + 1;\n    }\n\n    return ar;\n}\n\nbool duplication(int* ar, int size) {\n\n    if (size &lt;= 1) {\n        return false;\n    }\n\n    for (int i = 0; i &lt;= size; i++) {\n        for (int j = i+1; j &lt;= size; j++) {\n\n            if (ar[i] == ar[j]) {\n                return true;\n            }\n\n            else\n                return false;\n        }\n    }\n\n}\n\nint main() {\n    int n;\n    while (true) {\n        cout &lt;&lt; \"Please enter a number : \";\n        cin &gt;&gt; n;\n\n        int size = n / 2;\n\n        if (n &lt;= 2) {\n            cout &lt;&lt; \"Wrong number!!!\" &lt;&lt; endl;\n            break;\n        }\n\n        cout &lt;&lt; \"Size of random array : \" &lt;&lt; size &lt;&lt; endl;\n\n        int* arr = new int[size];\n\n        cout &lt;&lt; endl;\n        cout &lt;&lt; \"[ Array ]\" &lt;&lt; endl;\n\n        arr = randnum(arr, n);\n\n        cout &lt;&lt; endl;\n\n        for (int i = 0; i &lt; size; i++) {\n            cout &lt;&lt; arr[i] &lt;&lt; \"\\t\";\n        }\n        cout &lt;&lt; endl;\n\n        cout &lt;&lt; endl;\n\n        if (duplication(arr,size) == true)\n            cout &lt;&lt; \"Duplicates found.\" &lt;&lt; endl;\n\n        if (duplication(arr, size) == false)\n            cout &lt;&lt; \"Duplication not found.\" &lt;&lt; endl;\n\n        cout &lt;&lt; endl;\n        cout &lt;&lt; \"-----------------------------------------------------------\";\n        cout &lt;&lt; endl;\n    }\n\n\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p>i want to find duplicates in array.\nbut when the array is like [4, 5, 6, 7, 8, 8], it says \"Duplication not found.\"\ni think the for loops are wrong, but i don't know what is worng...</p>\n\n<p>-> code explanation</p>\n\n<p>int* randum : make random elements for array\nbool duplication : if two or more elements are same, return true / if there's no duplicate return false</p>\n"}, {"tags": ["c++", "clang", "libtooling"], "answers": [{"tags": [], "owner": {"reputation": 1259, "user_id": 11582326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TmrDj.jpg?s=128&g=1", "display_name": "Valeriy Savchenko", "link": "https://stackoverflow.com/users/11582326/valeriy-savchenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1572699926, "creation_date": 1572699926, "answer_id": 58671399, "question_id": 58413952, "link": "https://stackoverflow.com/questions/58413952/how-to-get-all-the-function-names-where-the-global-variables-are-used/58671399#58671399", "title": "How to get all the function names where the global variables are used?", "body": "<p>It is possible to do with <code>libTooling</code>. If you already found <code>DeclRefExpr</code> nodes that refer to global variables, you can walk up the AST to their <code>FunctionDecl</code> parents.</p>\n\n<p>On the other hand, walking up the AST requires Clang to construct a mapping from nodes to their parent nodes (which might be pretty expensive for big translation units). Here I've put together a short solution that just finds function referring to global variables and prints their names:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class GlobalVariableFinder final\n    : public RecursiveASTVisitor&lt;GlobalVariableFinder&gt; {\npublic:\n  static bool find(FunctionDecl *CandidateFunction) {\n    GlobalVariableFinder ActualFinder;\n    ActualFinder.TraverseDecl(CandidateFunction);\n    return ActualFinder.Found;\n  }\n\n  bool VisitDeclRefExpr(DeclRefExpr *SymbolUse) {\n    // we are interested only in variables\n    if (auto *Declaration = dyn_cast&lt;VarDecl&gt;(SymbolUse-&gt;getDecl())) {\n      Found = Declaration-&gt;hasGlobalStorage();\n      // if we found one global variable use, there is no need in traversing\n      // this function any further\n      if (Found) return false;\n    }\n    return true;\n  }\nprivate:\n  bool Found = false;\n};\n\nclass VisitingASTConsumer final\n    : public ASTConsumer,\n      public RecursiveASTVisitor&lt;VisitingASTConsumer&gt; {\npublic:\n  void HandleTranslationUnit(ASTContext &amp;C) {\n    this-&gt;TraverseTranslationUnitDecl(Context-&gt;getTranslationUnitDecl());\n  }\n\n  bool VisitFunctionDecl(FunctionDecl *CandidateFunction) {\n    if (GlobalVariableFinder::find(CandidateFunction)) {\n      llvm::errs() &lt;&lt; CandidateFunction-&gt;getQualifiedNameAsString() &lt;&lt; \"\\n\";\n    }\n    return true;\n  }\n};\n</code></pre>\n\n<p>If you want to store global variable references, you might want to modify the <code>GlobalVariableFinder</code> class to include additional logic.</p>\n\n<p>Following solution produces the following output on this snippet of code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>int Var;\n\nint display()\n{\n  Var = 10;\n  return Var;\n}\n\nint foo() {\n  return Var;\n}\n\nint bar() {\n  return foo();\n}\n\nint main()\n{\n  display();\n  return 0;\n}\n</code></pre>\n\n<pre><code>display\nfoo\n\n</code></pre>\n\n<p>You can notice that it includes only functions that syntactically use global variables. If you want the algorithm to find <code>bar</code> as well, you'll need to build a call graph of the target program and propagate the information about global variables by the reversed edges of the graph (i.e. from <code>foo</code> to <code>bar</code> in our example).</p>\n\n<p>I hope this information is helpful. Happy hacking with Clang!</p>\n"}], "owner": {"reputation": 11, "user_id": 12226614, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDRNaV2OUFjyaREBX8eoI5rvQu5OTx0CZd-7WvRWjU=k-s128", "display_name": "Jaya Bharathi", "link": "https://stackoverflow.com/users/12226614/jaya-bharathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 429, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1572699926, "creation_date": 1571230812, "question_id": 58413952, "link": "https://stackoverflow.com/questions/58413952/how-to-get-all-the-function-names-where-the-global-variables-are-used", "title": "How to get all the function names where the global variables are used?", "body": "<p>I am working on libtooling with clang. I have developed a tools to find the global variables and where those global variables are referred.</p>\n\n<p>Now, i want to get the function name which uses those Global variables.</p>\n\n<p>Here is the Sample Code</p>\n\n<pre><code>int Var;\n\nint display()\n{\n  Var = 10;\nreturn Var;\n}\n\nint main()\n{\n  display();\nreturn 0;\n}\n</code></pre>\n\n<p>Here, i want to get that global variable <code>Var</code> is referred in Function <code>display</code>.</p>\n\n<p>How can i get this Output using LibTooling clang? Please Let me know if there is any solution.</p>\n"}, {"tags": ["c++", "stl", "lower-bound"], "comments": [{"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1571230819, "post_id": 58413890, "comment_id": 103170761, "body": "It is unclear what is the range?"}, {"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 1, "creation_date": 1571230941, "post_id": 58413890, "comment_id": 103170835, "body": "The problem is that <code>m.begin()</code> is an iterator that points to a pair. You cannot compare a pair for an integer value."}], "answers": [{"tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": false, "score": 2, "last_activity_date": 1571232197, "last_edit_date": 1571232197, "creation_date": 1571231175, "answer_id": 58414059, "question_id": 58413890, "link": "https://stackoverflow.com/questions/58413890/how-to-get-lower-bound-for-map-in-a-specific-range/58414059#58414059", "title": "How to get lower_bound for map in a specific range?", "body": "<p>The <code>value_type</code> of a map is <code>std::pair&lt;const Key,Value&gt;</code>, so you'll need to supply such a pair as argument.</p>\n\n<p>Given that you are interested only in the key part, it's better to use the overload of <code>std::lower_bound()</code> that accepts a function object:</p>\n\n<pre><code>auto const it = std::lower_bound(m.begin(), m.end(), std::make_pair(10, 0),\n                                 [](auto const&amp; a, auto const&amp; b){ return a.first &lt; b.first; });\n</code></pre>\n\n<p>I believe, from reading the docs, but haven't confirmed, that we can use the map's comparer:</p>\n\n<pre><code>auto const it = std::lower_bound(m.begin(), m.end(), std::make_pair(10, 0),\n                                 m.value_comp());\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1571231779, "creation_date": 1571231779, "answer_id": 58414286, "question_id": 58413890, "link": "https://stackoverflow.com/questions/58413890/how-to-get-lower-bound-for-map-in-a-specific-range/58414286#58414286", "title": "How to get lower_bound for map in a specific range?", "body": "<p>It seems you mean the following</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;map&gt;\n#include &lt;iterator&gt;\n#include &lt;algorithm&gt;\n\nint main() \n{\n    std::map&lt;int, int&gt; m =\n    {\n        { 2, 1 }, { 4, 2 }, { 6, 3 }, { 8, 4 }, { 10, -1 }, { 10, 0 }, { 12, 2 } \n    };\n\n    int key = 10;\n\n    auto it = m.lower_bound( key );\n\n    std::cout &lt;&lt; \"{ \" &lt;&lt; it-&gt;first &lt;&lt; \", \" &lt;&lt; it-&gt;second &lt;&lt; \" }\\n\";\n\n    it = std::lower_bound( std::begin( m ), std::end( m ), key,\n                           [&amp;]( const auto &amp;p, const auto &amp;value ) { return p.first &lt; value; } );\n\n    std::cout &lt;&lt; \"{ \" &lt;&lt; it-&gt;first &lt;&lt; \", \" &lt;&lt; it-&gt;second &lt;&lt; \" }\\n\";\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>{ 10, -1 }\n{ 10, -1 }\n</code></pre>\n\n<p>That is in the standard algorithm <code>std::lower_bound</code> you can use a lambda expression.</p>\n"}], "owner": {"reputation": 53, "user_id": 9543752, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alfred", "link": "https://stackoverflow.com/users/9543752/alfred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571232197, "creation_date": 1571230642, "question_id": 58413890, "link": "https://stackoverflow.com/questions/58413890/how-to-get-lower-bound-for-map-in-a-specific-range", "title": "How to get lower_bound for map in a specific range?", "body": "<p>I want to find the lower_bound for my target in a map(in a range).</p>\n\n<p>I have known another solution:</p>\n\n<pre><code>int main() {\n  map&lt;int,int&gt; m;\n  auto it=m.lower_bound(10);\n  cout&lt;&lt;it-&gt;first&lt;&lt;\" \"&lt;&lt;it-&gt;second&lt;&lt;endl;\n  return 0;\n}\n</code></pre>\n\n<p>BUT, I want to how to use <code>std::lower_bound(m.begin(),m.end(),***)</code>.</p>\n\n<pre><code>int main() {\n  map&lt;int,int&gt; m;\n  auto it=std::lower_bound(m.begin(),m.end(),10);\n  cout&lt;&lt;it-&gt;first&lt;&lt;\" \"&lt;&lt;it-&gt;second&lt;&lt;endl;\n  return 0;\n}\n</code></pre>\n\n<p>main.cpp:29:43:   required from here\n/usr/local/Cellar/gcc/7.3.0_1/include/c++/7.3.0/bits/predefined_ops.h:65:22: error: no match for 'operator&lt;' (operand types are 'std::pair' and 'const int')\n       { return *__it &lt; __val; }</p>\n"}, {"tags": ["c++", "c++17"], "answers": [{"tags": [], "owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "is_accepted": false, "score": 0, "last_activity_date": 1571231106, "last_edit_date": 1571231106, "creation_date": 1571230341, "answer_id": 58413782, "question_id": 58413581, "link": "https://stackoverflow.com/questions/58413581/how-to-initialize-a-vector-using-sregex-token-iterator-objects/58413782#58413782", "title": "How to initialize a vector using sregex_token_iterator objects", "body": "<p>Value type of <code>std::sregex_token_iterator</code> is <code>std::sub_match</code>. This cannot be implicitly converted to <code>int</code>, since there is no corresponding cast operator.</p>\n\n<p>However, <code>std::sub_match</code> has a <a href=\"https://en.cppreference.com/w/cpp/regex/sub_match/str\" rel=\"nofollow noreferrer\">string-cast operator</a>. You can, therefore, construct a <code>std::vector&lt;std::string&gt;</code> this way:</p>\n\n<pre><code>std::vector&lt;std::string&gt; v(beg, end);\n</code></pre>\n\n<p>If you need integers, you can then convert to a vector of <code>int</code>s manually, or, write a custom <em>iterator adaptor</em> that would convert strings to integers on-the-fly. </p>\n"}], "owner": {"reputation": 1799, "user_id": 12212606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a29c783388625364a698e06ecb90a2?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Malmsteen", "link": "https://stackoverflow.com/users/12212606/lars-malmsteen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 644, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571231106, "creation_date": 1571229678, "question_id": 58413581, "link": "https://stackoverflow.com/questions/58413581/how-to-initialize-a-vector-using-sregex-token-iterator-objects", "title": "How to initialize a vector using sregex_token_iterator objects", "body": "<p>In this code I convert a comma separated sting into <code>sregex_token_iterator</code> objects.</p>\n\n<p>But when I try to initialize a vector using the <code>sregex_token_iterator</code> objects, I get <strong>static assertion failed: result type must be constructible from value type of input range</strong> error. </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;regex&gt;\nusing namespace std;\n\nint main() {\n  string uinput = \"1,2, 3\";\n  const regex regex(R\"(\\s*,\\s*)\");\n  sregex_token_iterator beg(uinput.begin(), uinput.end(), regex, -1), end;\n  for_each(beg, end, [](auto&amp; token) { cout &lt;&lt; token &lt;&lt; '\\n'; }); // just for checks\n  vector&lt;int&gt; v(beg, end); // Gives this error:\n  // static assertion failed: result type must be constructible from value type of input range\n}\n</code></pre>\n\n<p>How to  initialize a vector properly using <code>sregex_token_iterator</code> objects? \nThanks.</p>\n"}, {"tags": ["c++", "language-lawyer", "undefined-behavior", "strict-aliasing"], "comments": [{"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1571229986, "post_id": 58413515, "comment_id": 103170236, "body": "My guess (and I daren&#39;t post this as an answer) is that there is no UB <b><i>provided that</i></b> the definition of <code>int32_t</code> is valid. That is, so long as this is a 4-byte (i.e. 4 char) <b>contiguous</b> chunk of memory, there&#39;s no problem."}, {"owner": {"reputation": 308, "user_id": 11508939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24809e3da83ad87419a7362eaf5bf5f?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas M&#252;ller", "link": "https://stackoverflow.com/users/11508939/jonas-m%c3%bcller"}, "reply_to_user": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 1, "creation_date": 1571230152, "post_id": 58413515, "comment_id": 103170360, "body": "which is why I used <code>int32_t</code> and not just <code>int</code> (because that might open up questions about cases in which <code>sizeof(int) != 4</code>, like on DOS etc.)"}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 1, "creation_date": 1571230315, "post_id": 58413515, "comment_id": 103170446, "body": "@Adrian <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.20.1.1\" rel=\"nofollow noreferrer\"><b>7.20.1.1 Exact-width integer types</b> from the C standard</a> is relevant:  &quot;The typedef name <code>intN_t</code> designates a signed integer type with width <code>N</code>, no padding bits, and a two&#39;s complement representation.&quot;  If <code>int32_t</code> exists, it seems it would have to be contiguous.  A &quot;byte&quot; could still be 8, 16, or 32 bits in this case, though."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1571230407, "post_id": 58413515, "comment_id": 103170511, "body": "@JonasM&#252;ller but sizeof(int32_t) is not necessarily 4 either because char is not necessarily 8 bits. Besides, sizeof(int32_t) is not a magic number unlike 4, so it&#39;s better to use that."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1571230497, "post_id": 58413515, "comment_id": 103170570, "body": "@AndrewHenle Indeed! Maybe I should not have used the term <code>byte</code>! But, will <code>char</code> always be 8 bits? Or, will <code>char</code> always be the same size as &quot;byte?&quot;"}, {"owner": {"reputation": 308, "user_id": 11508939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24809e3da83ad87419a7362eaf5bf5f?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas M&#252;ller", "link": "https://stackoverflow.com/users/11508939/jonas-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1571230561, "post_id": 58413515, "comment_id": 103170606, "body": "Ok, amended the code example to enforce 8-bits-in-a-<code>unsigned char</code>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1571230685, "post_id": 58413515, "comment_id": 103170679, "body": "@Adrian <code>CHAR_BIT</code> is required to be greater than or equal to <code>8</code> so no, it doesn&#39;t always have to be <code>8</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1571230713, "post_id": 58413515, "comment_id": 103170698, "body": "<code>sizeof(char)</code> though is guaranteed to always be <code>1</code>."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1571230774, "post_id": 58413515, "comment_id": 103170737, "body": "@NathanOliver So does that mean <code>sizeof(int32_t)</code> (if such a type exists) will always be 4?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1571230862, "post_id": 58413515, "comment_id": 103170788, "body": "@Adrian No.  <code>int32_t</code> is gauranteed to be 32 bits wide, but it&#39;s size will be <code>32 &#47; CHAR_BIT</code> so it could be it&#39;s size will be in the range <code>[4, 1]</code>"}, {"owner": {"reputation": 308, "user_id": 11508939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24809e3da83ad87419a7362eaf5bf5f?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas M&#252;ller", "link": "https://stackoverflow.com/users/11508939/jonas-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1571230883, "post_id": 58413515, "comment_id": 103170800, "body": "Not in this example, because the <code>static_assert</code> checks that."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1571230930, "post_id": 58413515, "comment_id": 103170829, "body": "Yes, in this example it is fine, but generically the size will be in the range <code>[4, 1]</code>"}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1571231120, "post_id": 58413515, "comment_id": 103170940, "body": "@JonasM&#252;ller From the discussion, I can see why you have the &quot;Language Liar&quot; tag!"}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1571231365, "post_id": 58413515, "comment_id": 103171073, "body": "Maybe this is a better assertion: <code>static_assert(sizeof(int32_t) == 4, &quot;Wrong size for 32-bit integer!&quot;);</code>?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1571231777, "post_id": 58413515, "comment_id": 103171347, "body": "@JonasM&#252;ller: <i>&quot;From the language rules it is clear that <code>func1</code> is fine&quot;</i>. In fact, not completely, <code>j[0]</code> would be fine, <code>j + 1</code> is fine. but <code>j[1]</code> and <code>j[2]</code> are pedantically UB as <code>j</code> doesn&#39;t point on an <b>array</b> (contrary to <code>func2</code> :-) )."}, {"owner": {"reputation": 9396, "user_id": 2261538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4e60dd44745bd1518ee933e081119de?s=128&d=identicon&r=PG", "display_name": "darune", "link": "https://stackoverflow.com/users/2261538/darune"}, "edited": false, "score": 0, "creation_date": 1571235445, "post_id": 58413515, "comment_id": 103173773, "body": "@JonasM&#252;ller I guess one possible explaination I can think of why you get no warnings is that it might be compiler extensions that makes this OK."}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1571236821, "post_id": 58413515, "comment_id": 103174711, "body": "@Jarod42 <i>&quot;<code>j[0]</code> would be fine, <code>j + 1</code> is fine&quot;</i> Nothing of this is fine."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1571237557, "post_id": 58413515, "comment_id": 103175207, "body": "@LanguageLawyer: Could you clarify?"}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1571237575, "post_id": 58413515, "comment_id": 103175218, "body": "@Jarod42 [expr.add]/6"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1571237940, "post_id": 58413515, "comment_id": 103175462, "body": "@LanguageLawyer: My point was <i>&quot;An object that is not an array element is considered to belong to a single-element array for this purpose&quot;</i> (but indeed, there are no char object neither, the exception for <code>char</code> in strict aliasing rule seems really useless)."}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1571239552, "post_id": 58413515, "comment_id": 103176451, "body": "@Jarod42 Even if there were a <code>char</code> object, <code>reinterpret_cast</code> doesn&#39;t give you a pointer to it. So you violate [expr.add]/6 anyway."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1571240160, "post_id": 58413515, "comment_id": 103176769, "body": "@LanguageLawyer: With a char object, it seems equivalent to <code>char c; char* p= &amp;c; p[0] = &#39;*&#39;; auto end_c = p + 1;</code> which is valid..."}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1571240591, "post_id": 58413515, "comment_id": 103177005, "body": "@Jarod42 <code>reinterpret_cast</code> can&#39;t make a pointer to <code>char</code> from a pointer to <code>int</code>. I mean pointer value, not type."}], "answers": [{"comments": [{"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1571237522, "post_id": 58414123, "comment_id": 103175178, "body": "<i>&quot;Therefore any further use of the result of the cast is undefined.&quot;</i> Not any. You can apply the address-of operator to the result of the cast or cast back to the original type. So there are at least 2 further  uses."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 5, "last_activity_date": 1571237622, "last_edit_date": 1571237622, "creation_date": 1571231363, "answer_id": 58414123, "question_id": 58413515, "link": "https://stackoverflow.com/questions/58413515/strict-aliasing-and-references-to-compile-time-c-arrays/58414123#58414123", "title": "Strict aliasing and references to compile-time C arrays", "body": "<p>It's undefined behavior.</p>\n\n<p>On the meaning of <code>reinterpret_cast</code> here we have <strong>[expr.reinterpret.cast]</strong></p>\n\n<blockquote>\n  <p><a href=\"https://timsong-cpp.github.io/cppwp/n4659/expr.reinterpret.cast#11\" rel=\"nofollow noreferrer\">11</a> A glvalue expression of type T1 can be cast to the type\n  \u201creference to T2\u201d if an expression of type \u201cpointer to T1\u201d can be\n  explicitly converted to the type \u201cpointer to T2\u201d using a\n  reinterpret_\u00adcast. The result refers to the same object as the source\n  glvalue, but with the specified type. [\u2009Note: That is, for lvalues, a\n  reference cast reinterpret_\u00adcast(x) has the same effect as the\n  conversion *reinterpret_\u00adcast(&amp;x) with the built-in &amp; and *\n  operators (and similarly for reinterpret_\u00adcast(x)). \u2009\u2014\u2009end note\u2009]\n  No temporary is created, no copy is made, and constructors or\n  conversion functions are not called.</p>\n</blockquote>\n\n<p>This tells us that the cast int <code>func2</code> is valid so long as <code>reinterpret_cast&lt;const unsigned char (*)[4]&gt;(&amp;i)</code> is valid. No shock here. But the crux of the matter is that you may not get anything meaningful out of that pointer conversion. On that subject we have this over at <strong>[basic.compound]</strong>:</p>\n\n<blockquote>\n  <p><a href=\"https://timsong-cpp.github.io/cppwp/n4659/expr.reinterpret.cast#11\" rel=\"nofollow noreferrer\">4</a> Two objects a and b are pointer-interconvertible if:</p>\n  \n  <ul>\n  <li>they are the same object, or</li>\n  <li>one is a standard-layout union object and the other is a non-static data member of that object ([class.union]), or</li>\n  <li>one is a standard-layout class object and the other is the first non-static data member of that object, or, if the object has no\n  non-static data members, the first base class subobject of that object\n  ([class.mem]), or</li>\n  <li>there exists an object c such that a and c are pointer-interconvertible, and c and b are pointer-interconvertible.</li>\n  </ul>\n  \n  <p>If two objects are pointer-interconvertible, then they have the same\n  address, and it is possible to obtain a pointer to one from a pointer\n  to the other via a <code>reinterpret_\u00adcast</code>. [\u2009Note: An array object and its\n  first element are not pointer-interconvertible, even though they have\n  the same address. \u2009\u2014\u2009end note\u2009]</p>\n</blockquote>\n\n<p>That's an exhaustive list of meaningful pointer conversions. So we are not permitted to obtain an array address like that, and as such it is not a valid array glvalue. Therefore the further use you make of the result of the cast is undefined.</p>\n"}], "owner": {"reputation": 308, "user_id": 11508939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24809e3da83ad87419a7362eaf5bf5f?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas M&#252;ller", "link": "https://stackoverflow.com/users/11508939/jonas-m%c3%bcller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 58414123, "answer_count": 1, "score": 7, "last_activity_date": 1571237622, "creation_date": 1571229498, "last_edit_date": 1571230539, "question_id": 58413515, "link": "https://stackoverflow.com/questions/58413515/strict-aliasing-and-references-to-compile-time-c-arrays", "title": "Strict aliasing and references to compile-time C arrays", "body": "<p>Given the following code</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;cassert&gt;\n#include &lt;climits&gt;\n#include &lt;cstdint&gt;\n#include &lt;iostream&gt;\n\nstatic_assert(CHAR_BIT == 8, \"A byte does not consist of 8 bits\");\n\nvoid func1(const int32_t&amp; i)\n{\n    const unsigned char* j = reinterpret_cast&lt;const unsigned char*&gt;(&amp;i);\n    for(int k = 0; k &lt; 4; ++k)\n        std::cout &lt;&lt; static_cast&lt;int&gt;(j[k]) &lt;&lt; ' ';\n    std::cout &lt;&lt; '\\n';\n}\n\nvoid func2(const int32_t&amp; i)\n{\n    const unsigned char (&amp;j)[4] = reinterpret_cast&lt;const unsigned char (&amp;)[4]&gt;(i);\n    for(int k = 0; k &lt; 4; ++k)\n        std::cout &lt;&lt; static_cast&lt;int&gt;(j[k]) &lt;&lt; ' ';\n    std::cout &lt;&lt; '\\n';\n}\n\nint main() {\n    func1(-1);\n    func2(-1);\n}\n\n</code></pre>\n\n<p>From the language rules it is clear that <code>func1</code> is fine, as pointers to <code>unsigned char</code> can alias any other type. My question is: does this extend to C++ references to C-arrays with known length? Intuitively I would say yes. Is <code>func2</code> well-defined or does it trigger undefined behavior?</p>\n\n<p>I have tried compiling the above code using Clang and GCC with every possible combination of <code>-Wextra -Wall -Wpedantic</code> and UBSAN, and have gotten no warnings and always the same output. That obviously doesn't state that there's no UB, but I couldn't trigger any of the usual strict-aliasing type optimization bugs.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 2, "creation_date": 1571229546, "post_id": 58413469, "comment_id": 103169949, "body": "When you find the exact line in your program that writes <code>std::endl</code> at the end of each line, you should be able to figure out your own bug."}, {"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 3, "creation_date": 1571229644, "post_id": 58413469, "comment_id": 103170012, "body": "<code>for(int j = 0; j &lt;= 40; i++)</code>? Did you notice which counter you increment in this loop?"}, {"owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "edited": false, "score": 2, "creation_date": 1571230748, "post_id": 58413469, "comment_id": 103170718, "body": "It&#39;s unrelated but is there a reason you use an array of pointer and dynamic memory allocation? <code>Circle arrCircle[SIZE] = {Circle(&#39;C&#39;, 1001, 20), Circle(&#39;S&#39;, 1002, 25, 30), Circle(&#39;S&#39;, 1003, 40, 80)};</code> would also work, your objects are on the stack and don&#39;t need to delete them."}], "owner": {"reputation": 91, "user_id": 11548052, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qytgC7JEVRE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reDgX-PLPjfKjm5-R2R0DKccVCVjQ/mo/photo.jpg?sz=128", "display_name": "Orion98", "link": "https://stackoverflow.com/users/11548052/orion98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 906, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1571229309, "creation_date": 1571229309, "question_id": 58413469, "link": "https://stackoverflow.com/questions/58413469/drawing-a-circle-with-class-in-c", "title": "Drawing a Circle with Class in C++", "body": "<p>I'm currently writing a program where I have to draw three circle shapes from a class(data structure) that will output in the console. </p>\n\n<p>The problem I'm having with my program is that my code compiles, however, the output goes crazy and doesn't draw the circles. </p>\n\n<p>I'm still new to C++ and if anyone can help me out on how to fix this, I would appreciate it. </p>\n\n<p>My Current Code:</p>\n\n<pre><code>////// Circle.h\n#include &lt;iostream&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sstream&gt;\n#include &lt;time.h&gt;\n#include &lt;cmath&gt;\n\nusing namespace std;\n\nclass Circle\n{\nprivate:\n    char type;\n    int serialNumber = 0;\n    double radius = 0.0;\n    double density = 0.0;\n\npublic:\n    Circle(char, int, double);\n    Circle(char, int, double, double);\n    ~Circle();\n\n    void setType(char);\n    void setSerialNumber(int);\n    void setRadius(double);\n    void setDensity(double);\n\n    char getType() const;\n    int getSerialNumber() const;\n    double getRadius() const;\n    double getDensity() const;\n};\n\n////// Circle.cpp\n// #include \"Circle.h\"\n\n    Circle::Circle(char c, int s, double r)\n    {\n        type = c;\n        serialNumber = s;\n        radius = r;\n    }\n\n    Circle::Circle(char c, int s, double r, double d)\n    {\n        type = c;\n        serialNumber = s;\n        radius = r;\n        density = d;\n    }\n\n    Circle::~Circle()\n    {\n        cout &lt;&lt; \"Shapes deleted!\" &lt;&lt; endl;\n    }\n\n    void Circle::setType(char c)\n    {\n        if(c == 'S' || c == 'C')\n            type = c;\n    }\n\n    void Circle::setSerialNumber(int s)\n    {\n        if(s &gt; 0)\n            serialNumber = s;\n    }\n\n    void Circle::setRadius(double r)\n    {\n        if(r &gt; 0)\n            radius = r;\n    }\n\n    void Circle::setDensity(double d)\n    {\n        if(d &gt; 0)\n            density = d;\n    }\n\n    char Circle::getType() const\n    {\n        return type;\n    }\n\n    int Circle::getSerialNumber() const\n    {\n        return serialNumber;\n    }\n\n    double Circle::getRadius() const\n    {\n        return radius;\n    }\n\n    double Circle::getDensity() const\n    {\n        return density;\n    }\n\n////// main.cpp\n// #include \"Circle.h\"\n\nvoid drawAll(Circle *[], int);\nvoid drawType(Circle *);\nvoid drawCircle(Circle *);\nvoid drawSpray(Circle *);\nvoid deleteAll(Circle *[], int);\n\n/// For 'C' type the system should display a circle.\n/// For 'S' type the system displays a spray pattern just like those used in Microsoft Paint.\n\nint main(int argc, char** argv)\n{\n    const int SIZE = 3;\n    Circle * arrCircle[SIZE] = {nullptr};\n\n    arrCircle[0] = new Circle('C', 1001, 20);\n\n    /// Create a Circle whose serial number is 1001 and the radius is 20.\n\n    /// Type 'C' indicates Circle type.\n\n    arrCircle[1] = new Circle('S', 1002, 25, 30);\n\n    /// Create a Spray whose serial number is 1002, the radius is 25, and the density is 30%.\n\n    /// Type 'S' indicates Spray type.\n\n    arrCircle[2] = new Circle('S', 1003, 40, 80);\n\n    /// Create a Spray whose serial number is 1003, the radius is 40, and the density is 80%.\n\n    drawAll(arrCircle, SIZE);\n\n    /// Draw all shapes. The function uses a for loop to display the circles and sprays in arrCircle.\n\n    deleteAll(arrCircle, SIZE);\n\n    /// Delete all shapes.\n\n    return 0;\n}\n\nvoid drawAll(Circle *arr[], int SIZE)\n{\n    for(int i = 0; i &lt; SIZE; i++)\n        if(arr[i] != nullptr)\n        {\n            cout &lt;&lt; \"Circle #\" &lt;&lt; arr[i]-&gt;getSerialNumber() &lt;&lt; endl;\n            drawType(arr[i]);\n        }\n}\n\nvoid drawType(Circle *p)\n{\n    if(p-&gt;getType() == 'C')\n        drawCircle(p);\n\n    else if(p-&gt;getType() == 'S')\n        drawSpray(p);\n}\n\nvoid drawCircle(Circle *p)\n{\n    double r = p-&gt;getRadius();\n    int x = 0;\n    int y = 0;\n    int rto = 2;\n\n    for(int i = 0; i &lt;= 40; i++)\n    {\n        for(int j = 0; j &lt;= 40; i++)\n        {\n            x = abs(i - 20);\n            y = abs(j - 20);\n            r = pow(pow(x, rto) + pow(y, rto), 0.5);\n\n            if(19.5 &lt; r &amp;&amp; r &lt; 20.5)\n                cout &lt;&lt; \"* \";\n            else\n                cout &lt;&lt; \"  \";\n        }\n\n        cout &lt;&lt; endl;\n    }\n\n}\n\nvoid drawSpray(Circle *p)\n{\n    double d = p-&gt;getDensity();\n    int x = 0;\n    int y = 0;\n    int rto = 2;\n\n    for(int i = 0; i &lt;= 80; i++)\n    {\n        for(int j = 0; j &lt;= 80; i++)\n        {\n            x = abs(i - 30);\n            y = abs(j - 30);\n            d = pow(pow(x, rto) + pow(y, rto), 0.5);\n\n            if(19.5 &lt; d &amp;&amp; d &lt; 20.5)\n                cout &lt;&lt; \"* \";\n            else\n                cout &lt;&lt; \"  \";\n        }\n\n        cout &lt;&lt; endl;\n    }\n}\n\nvoid deleteAll(Circle *arr[], int SIZE)\n{\n    for(int i = 0; i &lt; SIZE; i++)\n    {\n        if(arr[i] != nullptr)\n            delete arr[i];\n    }\n}\n\n</code></pre>\n\n<p>My Current Output:</p>\n\n<pre><code>Circle #1001\n\n                       * * * * * * * * *\n</code></pre>\n\n<p>Expected Output: (example)</p>\n\n<pre><code>Circle #1001\n\n                        *************\n                    **                 **\n                 **                       **\n               *                             *\n             **                               **\n            *                                   *\n           *                                     *\n          *                                       *\n          *                                       *\n          *                                       *\n          *                                       *\n          *                                       *\n          *                                       *\n          *                                       *\n           *                                     *\n            *                                   *\n             **                               **\n               *                             *\n                 **                       **\n                    **                 **\n                        *************\n\nCircle #1002\n\n                              ***************\n                         ***                   ***\n                      **                           **\n                    *                                 *\n                  *                                     *\n                **                                       **\n               *                                           *\n              *                                             *\n             *                                               *\n            **                                               **\n            *                                                 *\n            *                                                 *\n            *                                                 *\n            *                                                 *\n            *                                                 *\n            *                                                 *\n            **                                               **\n             *                                               *\n              *                                             *\n               *                                           *\n                **                                       **\n                  *                                     *\n                    *                                 *\n                      **                           **\n                         ***                   ***\n                              ***************\n\nCircle #1003\n\n                                                    *****************                                                   \n                                             ***                         ***                                            \n                                         **                                   **                                        \n                                      *                                           *                                     \n                                   **                                               **                                  \n                                 *                                                     *                                \n                               *                                                         *                              \n                             *                                                             *                            \n                           **                                                               **                          \n                          *                                                                   *                         \n                         *                                                                     *                        \n                        *                                                                       *                       \n                       *                                                                         *                      \n                      *                                                                           *                     \n                     *                                                                             *                    \n                     *                                                                             *                    \n                    *                                                                               *                   \n                    *                                                                               *                   \n                    *                                                                               *                   \n                    *                                                                               *                   \n                    *                                                                               *                   \n                    *                                                                               *                   \n                    *                                                                               *                   \n                    *                                                                               *                   \n                    *                                                                               *                   \n                     *                                                                             *                    \n                     *                                                                             *                    \n                      *                                                                           *                     \n                       *                                                                         *                      \n                        *                                                                       *                       \n                         *                                                                     *                        \n                          *                                                                   *                         \n                           **                                                               **                          \n                             *                                                             *                            \n                               *                                                         *                              \n                                 *                                                     *                                \n                                   **                                               **                                  \n                                      *                                           *                                     \n                                         **                                   **                                        \n                                             ***                         ***                                            \n                                                    ***************** \n</code></pre>\n"}, {"tags": ["c++", "templates", "stdthread"], "comments": [{"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 1, "creation_date": 1571229536, "post_id": 58413346, "comment_id": 103169940, "body": "Does <code>std::thread t2(programManager&lt;EZXOrderEventHandler&gt;,bac,dataMarket);</code> work?"}, {"owner": {"reputation": 932, "user_id": 6345323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6dbbb0c750be6073b0d251899c74a47?s=128&d=identicon&r=PG&f=1", "display_name": "yaodav", "link": "https://stackoverflow.com/users/6345323/yaodav"}, "reply_to_user": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1571229696, "post_id": 58413346, "comment_id": 103170046, "body": "fix the problem thanks"}], "answers": [{"tags": [], "owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "is_accepted": true, "score": 1, "last_activity_date": 1571229788, "creation_date": 1571229788, "answer_id": 58413614, "question_id": 58413346, "link": "https://stackoverflow.com/questions/58413346/thread-failed-to-dedact-callback-function/58413614#58413614", "title": "thread failed to dedact callback function", "body": "<p><code>std::thread::thread</code> requires, as its first argument, a <em>callable object</em>. <code>programManager</code> itself is not a callable object, it's a function <strong>template</strong>, which is basically just a generic prescription how its instances should be generated.</p>\n\n<p>In your case, you need to pass a corresponding <strong>instance</strong> of <code>programManager</code> as an argument, which seems to be <code>programManager&lt;EZXOrderEventHandler&gt;</code>.</p>\n"}], "owner": {"reputation": 932, "user_id": 6345323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6dbbb0c750be6073b0d251899c74a47?s=128&d=identicon&r=PG&f=1", "display_name": "yaodav", "link": "https://stackoverflow.com/users/6345323/yaodav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 58413614, "answer_count": 1, "score": 0, "last_activity_date": 1571229788, "creation_date": 1571228893, "question_id": 58413346, "link": "https://stackoverflow.com/questions/58413346/thread-failed-to-dedact-callback-function", "title": "thread failed to dedact callback function", "body": "<p>I have the following function:</p>\n\n<pre><code>    template &lt;class T&gt;\n    void programManager(std::shared_ptr&lt;BaseStrategy&lt;T&gt;&gt; st,std::shared_ptr&lt;SMDSSubscriber&lt;T&gt;&gt; md){some code}\n</code></pre>\n\n<p>and it the callable function for std::thread</p>\n\n<p>bac declare as:  </p>\n\n<pre><code>std::shared_ptr&lt;BaseStrategy&lt;EZXOrderEventHandler&gt;&gt; bac = make_shared&lt;BacStrategy&lt;EZXOrderEventHandler&gt;&gt;\n</code></pre>\n\n<p>and md declare as:</p>\n\n<pre><code>std::shared_ptr&lt;SMDSSubscriber&lt;EZXOrderEventHandler&gt;&gt; dataMarket = make_shared&lt;SMDSSubscriber&lt;EZXOrderEventHandler&gt;&gt;();\n   std::thread t2(&amp;programManager,bac,dataMarket);\n</code></pre>\n\n<p>and I'm getting the error:</p>\n\n<blockquote>\n  <p>error: no matching function for call to \u2018std::thread::thread(, std::shared_ptr >&amp;, std::shared_ptr >&amp;)\u2019\n           std::thread t2(&amp;programManager,bac,dataMarket);</p>\n  \n  <p>note: candidate: template std::thread::thread(_Callable&amp;&amp;, _Args&amp;&amp; ...)\n         thread(_Callable&amp;&amp; __f, _Args&amp;&amp;... __args)</p>\n  \n  <p>template argument deduction/substitution failed:</p>\n  \n  <p>/home/yaodav/Desktop/git_repo/test/main.cpp:347:54: note:   couldn't deduce template parameter \u2018_Callable\u2019</p>\n</blockquote>\n\n<pre><code>     std::thread t2(&amp;programManager,bac,dataMarket);\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 889, "user_id": 1521241, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/01090d621800a51df9188fc8cdb28178?s=128&d=identicon&r=PG", "display_name": "macroland", "link": "https://stackoverflow.com/users/1521241/macroland"}, "edited": false, "score": 7, "creation_date": 1571228464, "post_id": 58413138, "comment_id": 103169343, "body": "Any code you have written?"}, {"owner": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 0, "creation_date": 1571229184, "post_id": 58413138, "comment_id": 103169730, "body": "Store each line of that output in a <code>string</code>, then loop through these <code>string</code>s in a for-loop. Technically, it meets your requirement of using for-loops."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1571229444, "post_id": 58413138, "comment_id": 103169874, "body": "The third pattern looks strange..."}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 11706994, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--Ds5YJlDewA/AAAAAAAAAAI/AAAAAAAAAAw/83OlLqJSwL0/photo.jpg?sz=128", "display_name": "Rafiul Islam Rafi", "link": "https://stackoverflow.com/users/11706994/rafiul-islam-rafi"}, "is_accepted": false, "score": 0, "last_activity_date": 1571230797, "creation_date": 1571230797, "answer_id": 58413947, "question_id": 58413138, "link": "https://stackoverflow.com/questions/58413138/display-patterns-using-for-loops-c/58413947#58413947", "title": "Display patterns using for loops c++", "body": "<p><strong>For first pattern, I generated a code:</strong></p>\n\n<pre><code>void firstpattern(int width)\n{\n    int i;\n    for(i=0;i&lt;width;i++)\n        printf(\"+-------\");\n    printf(\"+\\n\");\n    for(i=0;i&lt;width;i++)\n        printf(\"|\\t\");\n    printf(\"|\\n\");\n    for(i=0;i&lt;width;i++)\n        printf(\"|\\t\");\n    printf(\"|\\n\");\n    for(i=0;i&lt;width;i++)\n        printf(\"+-------\");\n    printf(\"+\\n\");\n}\n</code></pre>\n\n<p>From main function, I am calling this method\n    <em><code>firstpattern(width);</code></em>\nThen think yourself from this code and and generate the next two pattern with your thinking.</p>\n"}], "owner": {"reputation": 1, "user_id": 12225682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c644a0b93f7ed3d9087156b8d183231?s=128&d=identicon&r=PG&f=1", "display_name": "Saffron1233", "link": "https://stackoverflow.com/users/12225682/saffron1233"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1571230797, "creation_date": 1571228229, "last_edit_date": 1571228721, "question_id": 58413138, "link": "https://stackoverflow.com/questions/58413138/display-patterns-using-for-loops-c", "title": "Display patterns using for loops c++", "body": "<p>Hi guys I'm learning C++ language. \nhow to display this patterns using for loops?\nwhere the given numbers are from the user input.</p>\n\n<p><img src=\"https://i.stack.imgur.com/d8iwe.png\" alt=\"example\"></p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1571227990, "post_id": 58413021, "comment_id": 103169060, "body": "Is the caller of <code>f3()</code> in the same .cpp file, or somewhere else?"}, {"owner": {"reputation": 139, "user_id": 10767802, "user_type": "registered", "profile_image": "https://graph.facebook.com/2104682939554659/picture?type=large", "display_name": "Konstantinos Kyriakos", "link": "https://stackoverflow.com/users/10767802/konstantinos-kyriakos"}, "reply_to_user": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1571228310, "post_id": 58413021, "comment_id": 103169244, "body": "@JohnZwinck the caller is in the main()"}, {"owner": {"reputation": 889, "user_id": 1521241, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/01090d621800a51df9188fc8cdb28178?s=128&d=identicon&r=PG", "display_name": "macroland", "link": "https://stackoverflow.com/users/1521241/macroland"}, "edited": false, "score": 0, "creation_date": 1571228616, "post_id": 58413021, "comment_id": 103169440, "body": "You will need to include both .cpp and .h files, if you separate it."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1571231235, "post_id": 58413021, "comment_id": 103171000, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/495021/why-can-templates-only-be-implemented-in-the-header-file\">Why can templates only be implemented in the header file?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 10767802, "user_type": "registered", "profile_image": "https://graph.facebook.com/2104682939554659/picture?type=large", "display_name": "Konstantinos Kyriakos", "link": "https://stackoverflow.com/users/10767802/konstantinos-kyriakos"}, "edited": false, "score": 0, "creation_date": 1571228572, "post_id": 58413068, "comment_id": 103169412, "body": "I tried it but when I call the f3() in the main I am getting this error &quot;declared using unnamed type, is used but never defined&quot;"}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1571228052, "creation_date": 1571228052, "answer_id": 58413068, "question_id": 58413021, "link": "https://stackoverflow.com/questions/58413021/how-to-implement-template-function-that-belongs-to-non-template-class-in-cpp/58413068#58413068", "title": "How to implement template function that belongs to non template class in .cpp", "body": "<p>Simply:</p>\n\n<pre><code>// function.cpp\n\ntemplate&lt;typename T&gt;\nvoid f::f3(std::vector&lt;T&gt; &amp;){  \n //Implementation\n}\n</code></pre>\n\n<p>But see <a href=\"https://stackoverflow.com/questions/495021/why-can-templates-only-be-implemented-in-the-header-file\">Why can templates only be implemented in the header file?</a></p>\n"}, {"tags": [], "owner": {"reputation": 523, "user_id": 3672674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c06217af378f9bb4204af3b6490a3fde?s=128&d=identicon&r=PG&f=1", "display_name": "NotAProgrammer", "link": "https://stackoverflow.com/users/3672674/notaprogrammer"}, "is_accepted": false, "score": 3, "last_activity_date": 1571230048, "creation_date": 1571230048, "answer_id": 58413691, "question_id": 58413021, "link": "https://stackoverflow.com/questions/58413021/how-to-implement-template-function-that-belongs-to-non-template-class-in-cpp/58413691#58413691", "title": "How to implement template function that belongs to non template class in .cpp", "body": "<p>The following should work. I fixed the syntax and removed the f3 definition from the header file. Also, by default a <code>class</code> access specifier is <code>private</code> so accessing <code>f3(std::vector&lt;T&gt;&amp;)</code> from main would be illegal.\nSee also Jarod42's answer about implementing templates in the header.</p>\n\n<pre><code>//function.h\n#include &lt;vector&gt;\n\nclass F {\npublic:\n  void f1();\n\n  template&lt;typename T&gt;\n  void f3(std::vector&lt;T&gt; &amp;);\n};\n\n#include \"function.tpp\"\n\n//function.tpp\ntemplate&lt;typename T&gt;\nvoid F::f3(std::vector&lt;T&gt; &amp;){  \n //Implementation\n}\n\n//main.cc\nint main() {\n  std::vector&lt;int&gt; v;\n  F f;\n  f.f3(v);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "is_accepted": false, "score": 2, "last_activity_date": 1571230851, "last_edit_date": 1571230851, "creation_date": 1571230494, "answer_id": 58413839, "question_id": 58413021, "link": "https://stackoverflow.com/questions/58413021/how-to-implement-template-function-that-belongs-to-non-template-class-in-cpp/58413839#58413839", "title": "How to implement template function that belongs to non template class in .cpp", "body": "<p>If you have template method its definition must be visible in place where template is instantiated. This means that in 99% of cases template definition must be in header file.</p>\n\n<p>There is a way to workaround it in special cases. You can force instantiation of template for specific type, by listing this types in cpp file. In such case you will be limited to only this specific types.</p>\n\n<p>foo.h</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;vector&gt;\n\nclass f{\npublic:\n    void f1();\n    template&lt;typename T&gt;\n    void f3(std::vector&lt;T&gt; &amp;);\n};\n</code></pre>\n\n<p>foo.cpp</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"foo.h\"\n#include &lt;iostream&gt;\n\n#define LOG std::cout &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; '\\n'\n\nvoid f::f1()\n{\n    LOG;\n}\n\ntemplate&lt;typename T&gt;\nvoid f::f3(std::vector&lt;T&gt; &amp;)\n{  \n    LOG;\n}\n\ntemplate void f::f3&lt;int&gt;(std::vector&lt;int&gt; &amp;);\ntemplate void f::f3&lt;double&gt;(std::vector&lt;double&gt; &amp;);\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"foo.h\"\n#include &lt;iostream&gt;\n\nint main()\n{\n    std::vector&lt;int&gt; bar{ 1, 3, 5, 6 };\n\n    f foo;\n    foo.f1();\n    foo.f3(bar);\n\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/CUWH2rJIYWr1qEBp\" rel=\"nofollow noreferrer\">Live demo</a></p>\n\n<p>Note new C++ feature is coming. In <a href=\"https://www.modernescpp.com/index.php/c-20-modules\" rel=\"nofollow noreferrer\">C++20 modules are introduced</a>. Simply no more header files.</p>\n"}], "owner": {"reputation": 139, "user_id": 10767802, "user_type": "registered", "profile_image": "https://graph.facebook.com/2104682939554659/picture?type=large", "display_name": "Konstantinos Kyriakos", "link": "https://stackoverflow.com/users/10767802/konstantinos-kyriakos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1571230851, "creation_date": 1571227911, "question_id": 58413021, "link": "https://stackoverflow.com/questions/58413021/how-to-implement-template-function-that-belongs-to-non-template-class-in-cpp", "title": "How to implement template function that belongs to non template class in .cpp", "body": "<p>How can I implement the template function in the .cpp file ? </p>\n\n<p>function.h</p>\n\n<pre><code>class f{\n\n    void f1();\n\n    template&lt;typename T&gt;\n    void f3(std::vector&lt;T&gt; &amp;){  \n     //Implementation\n    }\n}\n</code></pre>\n\n<p>function.cpp</p>\n\n<pre><code>void f::f1(){ \n//code\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "constructor", "smart-pointers"], "comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1571228223, "post_id": 58412966, "comment_id": 103169198, "body": "At a first glance, I would assume that just packing the smart pointer into your own class and forward your constructor parameters to <code>std::make_shared</code> should do the trick already. Default copy/move constructor/assignment should already be fine for the rest."}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1571232056, "post_id": 58412966, "comment_id": 103171528, "body": "Sometimes syntactic hiding of &quot;details&quot; is practical (e.g. having to modify a large code base) but often, it is dangerous. There are situations, where smart pointers are not a &quot;safe and sound&quot; thing to use. <code>template &lt;class T&gt; struct List { std::shared_pointer&lt;List&lt;T&gt; &gt; next; T value; &#47;&#47;... };</code> is such an example for dangerous. Why? Because - if your list is long enough and you start to dstroy a node at the front, its destructor will destruct the next value, which in turn destructs the next next until... Stack Overflow! Yay!"}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 3334630, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004379803323/picture?type=large", "display_name": "Natulux", "link": "https://stackoverflow.com/users/3334630/natulux"}, "edited": false, "score": 0, "creation_date": 1571231947, "post_id": 58413996, "comment_id": 103171469, "body": "Thank you for the effort. I am not sure if I want another class as wrapper just for style purposes. The reason I am looking for an easy looking approach is just, that I need to give this code to some people who were stuck with VS2008 and C style programming until recently. I didn&#39;t want to poor all that C++ syntax over them, if I could prepare my class with some c style like typedefs and usings. ;-)"}, {"owner": {"reputation": 898, "user_id": 1606410, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EOAKA.png?s=128&g=1", "display_name": "Devon Cornwall", "link": "https://stackoverflow.com/users/1606410/devon-cornwall"}, "reply_to_user": {"reputation": 185, "user_id": 3334630, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004379803323/picture?type=large", "display_name": "Natulux", "link": "https://stackoverflow.com/users/3334630/natulux"}, "edited": false, "score": 0, "creation_date": 1571232839, "post_id": 58413996, "comment_id": 103172029, "body": "Especially then I would recommend to be explicit in your use of the &quot;new&quot; features and follow the official guidelines. This means if something goes wrong it is easier to look up and to find a solution than when you use some obscure or non-standard measures to make things look like something they are not."}], "tags": [], "owner": {"reputation": 898, "user_id": 1606410, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EOAKA.png?s=128&g=1", "display_name": "Devon Cornwall", "link": "https://stackoverflow.com/users/1606410/devon-cornwall"}, "is_accepted": true, "score": 0, "last_activity_date": 1571230945, "creation_date": 1571230945, "answer_id": 58413996, "question_id": 58412966, "link": "https://stackoverflow.com/questions/58412966/return-templated-smart-pointer-from-constructor-like-calls/58413996#58413996", "title": "Return templated smart pointer from constructor-like calls", "body": "<p>You could try something along these lines:</p>\n\n<pre><code>template&lt;typename T&gt;\nclass SharedWrapper\n{\npublic:\n    template&lt;typename... Args&gt;\n    SharedWrapper(Args... args) : \n        m_p{std::make_shared&lt;T&gt;(std::forward&lt;Args&gt;(args)...)}\n    { }\n\n    T&amp; operator*() const noexcept { return *m_p; }\n    T* operator-&gt;() const noexcept { return m_p.operator-&gt;(); }\n    explicit operator bool() const noexcept { return static_cast&lt;bool&gt;(m_p); }\n\nprivate:\n    std::shared_ptr&lt;T&gt; m_p;\n};\n</code></pre>\n\n<p>This just forwards the arguments of the constructor to the <code>make_shared</code> functions and then mirrors the interface of the smart pointer. (Here you might have to add additional forwarding methods as needed.)</p>\n\n<p>With:</p>\n\n<pre><code>using Smart_MyClass = SharedWrapper&lt;MyClass&gt;;\n</code></pre>\n\n<p>you should get the desired behavior and can also use this for different classes.</p>\n\n<p>However I don't see any possibility to have <code>Smart_MyClass</code> actually be a <code>std::shared_ptr&lt;MyClass&gt;</code>. Inheriting from <code>shared_ptr</code> is discouraged since it does not have a virtual destructor. This might also limit the usability of this approach.</p>\n\n<p>Is there any reason besides style that makes you want to use this notation? </p>\n"}], "owner": {"reputation": 185, "user_id": 3334630, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004379803323/picture?type=large", "display_name": "Natulux", "link": "https://stackoverflow.com/users/3334630/natulux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 58413996, "answer_count": 1, "score": 0, "last_activity_date": 1571230945, "creation_date": 1571227724, "question_id": 58412966, "link": "https://stackoverflow.com/questions/58412966/return-templated-smart-pointer-from-constructor-like-calls", "title": "Return templated smart pointer from constructor-like calls", "body": "<p>I want to write some easy-to-call object initializiation and I would like those objects to be shared_ptr of MyClass.</p>\n\n<p>Just for visualisiation purposes, imagine this class:</p>\n\n<pre><code>class MyClass\n{\npublic:\n  MyClass(int number);\n  MyClass(wxString path);\n}\n\nint main()\n{\n  //For now, objects are created in c style like this:\n  MyClass obj1(\"C:\\\\test\");\n  MyClass * obj2 = new MyClass(5);\n}\n</code></pre>\n\n<p>Now I would like to change this with easy to use smart pointer initialization.\nMy goal is something looking like a constructor call, so that very little has to be changed to update the old call to the new one:</p>\n\n<pre><code>Smart_MyClass obj1(\"C:\\\\test\");\nSmart_MyClass obj2(5);\n//where Smart_MyClass is std::shared_ptr&lt;MyClass&gt; \n</code></pre>\n\n<p>I could solve this with a function:</p>\n\n<pre><code>template&lt;typename T&gt;\ninline Smart_MyClass Smart_MyClass_Fct(T t)\n{\n    return std::make_shared&lt;MyClass&gt;(t);\n};\n\nSmart_MyClass obj = Smart_MyClass_Fct(7);\n</code></pre>\n\n<p>How can I translate that into the form I need? I could think of using the operator(), that would require a struct/class and maybe inheritence of my actual class? And maybe casting it back to parent class?\nPretty sure there is something more elegant. ;-) </p>\n"}, {"tags": ["c++", "arrays", "reference", "structure"], "comments": [{"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1571227540, "post_id": 58412893, "comment_id": 103168771, "body": "Need a language tag"}, {"owner": {"reputation": 1617, "user_id": 6864265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01bd0f9716eca1ad35cf30c47ae8f6f?s=128&d=identicon&r=PG&f=1", "display_name": "Itachi Uchiwa", "link": "https://stackoverflow.com/users/6864265/itachi-uchiwa"}, "edited": false, "score": 0, "creation_date": 1571231360, "post_id": 58412893, "comment_id": 103171068, "body": "Pass it as any array by reference: <code>void sort_process( process (&amp;)[len])</code>. <code>len</code> must be <code>cnostexpr</code>."}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 0, "creation_date": 1571232176, "post_id": 58412893, "comment_id": 103171611, "body": "By the way, <code>process p[n];</code> is not standard C++. You have to either provide a constant size or better: use a <code>std::vector</code> if you need dynamic size array instead."}], "answers": [{"tags": [], "owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "is_accepted": false, "score": 0, "last_activity_date": 1571231074, "last_edit_date": 1571231074, "creation_date": 1571230023, "answer_id": 58413680, "question_id": 58412893, "link": "https://stackoverflow.com/questions/58412893/how-to-pass-an-array-of-structure-by-reference-for-sorting/58413680#58413680", "title": "How to pass an array of structure by reference for sorting?", "body": "<p>You can simply use <a href=\"https://en.cppreference.com/w/cpp/algorithm/sort\" rel=\"nofollow noreferrer\"><code>std::sort</code></a> in the header <code>&lt;algorithm&gt;</code>:</p>\n\n<pre><code>std::sort(p, p+n, [](const process &amp; p1, const process &amp; p2){return p1 &lt; p2}); // Will sort p in ascending order\n</code></pre>\n\n<hr>\n\n<p>But if you really want to do it manually and pass the array to a function, you can create the function as:</p>\n\n<pre><code>void sort_process(process * x, std::size_t len) // copy the pointer\n{\n    std::sort(x, x+len, [](const process &amp; p1, const process &amp; p2){return p1 &lt; p2;});\n}\n</code></pre>\n\n<p>But passing <code>process x[]</code> as you did is equivalent.</p>\n\n<p><strong>Note:</strong> As we refer to an array by the pointer to its first element, what your are passing here is a pointer to the first element too (and not the array).</p>\n\n<hr>\n\n<p>If you really want to pass it by reference, you can do it as follows:</p>\n\n<pre><code>void sort_process(process * const &amp; x, std::size_t len)\n{\n    std::sort(x, x+len, [](const process &amp; p1, const process &amp; p2){return p1 &lt; p2;});\n}\n</code></pre>\n\n<p>I added a <code>const</code> qualifier to forbid the modification of the pointer as it is not a copy but a reference to the original one</p>\n\n<p>But you don't really gain anything by passing a reference here in my opinion.</p>\n"}, {"tags": [], "owner": {"reputation": 143, "user_id": 11452004, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1Fotd3_dxfc/AAAAAAAAAAI/AAAAAAAAADU/F2PW0ORcVc0/photo.jpg?sz=128", "display_name": "Perotto", "link": "https://stackoverflow.com/users/11452004/perotto"}, "is_accepted": false, "score": 0, "last_activity_date": 1571235339, "creation_date": 1571235339, "answer_id": 58415481, "question_id": 58412893, "link": "https://stackoverflow.com/questions/58412893/how-to-pass-an-array-of-structure-by-reference-for-sorting/58415481#58415481", "title": "How to pass an array of structure by reference for sorting?", "body": "<p>Seems like you are afraid of dynamic arrays and pointers. Try this:</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n\nstruct process\n{\n    int p_id, arr_time, burst_time, comp_time;\n\n    void initialize()\n    {\n        p_id = arr_time = burst_time = comp_time = 0;\n    }\n\n    process()\n    {\n        p_id = arr_time = burst_time = comp_time = 0;\n    }\n\n    ~process() {}\n};\n\nvoid sort_process(process*&amp; x, int len)\n{\n    int i, j;\n    process temp;\n    for (i = 0; i &lt; len; i++)\n    {\n        for (j = 0; j &lt; len - 1; j++)\n        {\n            if (x[j].arr_time &gt; x[j + 1].arr_time)\n            {\n                temp = x[j];\n                x[j] = x[j + 1];\n                x[j + 1] = temp;\n            }\n        }\n    }\n}\n\nint main()\n{\n    int n, i = 0, j = 0, k = 0, t = 0, flag;\n\n    cout &lt;&lt; \"\\n Enter number of processes : \";\n    cin &gt;&gt; n;\n\n    process* p = new process[n];\n\n    for (i = 0; i &lt; n; i++)\n        p[i].initialize();\n\n    sort_process(p, n);\n\n    for (i = 0; i &lt; n; i++)\n        p[i].~process();\n    delete[] p; p = 0;\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12226274, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCPm4TpOnJP9BV-9B3l4CCF8Wc9ZofNrKCrvySI2cQ=k-s128", "display_name": "Ritik Singh", "link": "https://stackoverflow.com/users/12226274/ritik-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571235339, "creation_date": 1571227492, "last_edit_date": 1571227909, "question_id": 58412893, "link": "https://stackoverflow.com/questions/58412893/how-to-pass-an-array-of-structure-by-reference-for-sorting", "title": "How to pass an array of structure by reference for sorting?", "body": "<p>In this code , I am creating an array of structure and trying to sort the structure array based on \"arr_time\" field. I  am having problem on how  to pass the structure array by reference in function <strong>sort_process()</strong> .</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n\nstruct process {\n    public:\n    int p_id,arr_time,burst_time,comp_time;\n};\n\nvoid sort_process( process x[],int len)\n{\n    int i,j;\n    process temp;\n    for(i=0;i&lt;len;i++)\n    {\n        for(j=0;j&lt;len-1;j++)\n        {\n            if(x[j].arr_time &gt; x[j+1].arr_time)\n            {\n                temp = x[j];\n                x[j] = x[j+1];\n                x[j+1] = temp;\n            }\n            }\n        }\n}\n\n\nint main()\n{\n    int n,i=0,j=0,k=0,t=0,flag;\n    cout&lt;&lt;\"\\n Enter number of processes : \";\n    cin&gt;&gt;n;\n    process p[n];\n\n    for(i=0;i&lt;n;i++)\n        initialize(p[i]);   \n    sort_process(p,n);  \n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1571227535, "post_id": 58412862, "comment_id": 103168766, "body": "Do you mean <code>std::vector::reserve</code>?"}, {"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "edited": false, "score": 0, "creation_date": 1571227753, "post_id": 58412862, "comment_id": 103168935, "body": "<code>reserve</code>. Fixed."}], "answers": [{"comments": [{"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "edited": false, "score": 0, "creation_date": 1571227859, "post_id": 58412945, "comment_id": 103168993, "body": "What about the <code>pop(int)</code>? Or <code>for(...) pop()</code> is the only way?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "edited": false, "score": 0, "creation_date": 1571227989, "post_id": 58412945, "comment_id": 103169059, "body": "@Equilibrius The <code>std::stack</code> interface doesn&#39;t have such a pop function, you have to use a loop (and be sure to check <code>empty</code> too)."}, {"owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "edited": false, "score": 0, "creation_date": 1571228061, "post_id": 58412945, "comment_id": 103169094, "body": "Haven&#39;t thought about <code>empty</code>. Thanks for that."}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1571227646, "creation_date": 1571227646, "answer_id": 58412945, "question_id": 58412862, "link": "https://stackoverflow.com/questions/58412862/fast-run-time-vector-based-stdstack-pre-allocation-and-multiple-pop/58412945#58412945", "title": "Fast run-time vector based std::stack. Pre-allocation and multiple pop", "body": "<p><a href=\"https://en.cppreference.com/w/cpp/container/stack\" rel=\"nofollow noreferrer\"><code>std::stack</code></a> can be used with any <a href=\"https://en.cppreference.com/w/cpp/named_req/SequenceContainer\" rel=\"nofollow noreferrer\"><em>sequence container</em></a>, and <a href=\"https://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\"><code>std::vector</code></a> is such a container.</p>\n\n<p>Then you can pass a reference to an existing container (like a pre-allocated vector) to the <a href=\"https://en.cppreference.com/w/cpp/container/stack/stack\" rel=\"nofollow noreferrer\"><code>std::stack</code> constructor</a>.</p>\n"}], "owner": {"reputation": 198, "user_id": 2335283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bc806fa481ead444151929b93ddb7?s=128&d=identicon&r=PG", "display_name": "Equilibrius", "link": "https://stackoverflow.com/users/2335283/equilibrius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 58412945, "answer_count": 1, "score": -1, "last_activity_date": 1571227726, "creation_date": 1571227409, "last_edit_date": 1571227726, "question_id": 58412862, "link": "https://stackoverflow.com/questions/58412862/fast-run-time-vector-based-stdstack-pre-allocation-and-multiple-pop", "title": "Fast run-time vector based std::stack. Pre-allocation and multiple pop", "body": "<p>Is there any <strong>standard</strong> way to have the equivalent of <code>std::vector:reserve</code> in a <code>std::stack&lt;T, std::vector&lt;T&gt;&gt;</code>?</p>\n\n<p>Also, is there there a <strong>standard</strong> way to implement something like <code>pop(int count)</code> and have it destruct elements in the correct order?</p>\n\n<p>If there is no such way, short of writing a custom stack implementation, that would also answer my question.</p>\n"}]