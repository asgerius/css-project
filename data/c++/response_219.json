[{"tags": ["c++", "windows", "icc"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 2, "creation_date": 1553125701, "post_id": 55271730, "comment_id": 97274746, "body": "<code>&lt;bits&#47;unique_ptr.h&gt;</code> is not the correct name for smart pointers. IIRC it&#39;s <code>&lt;memory&gt;</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1553129136, "post_id": 55271730, "comment_id": 97275541, "body": "In general don&#39;t use anything in the <code>bits</code> directory. It&#39;s GCC implementation specific and not guaranteed by the Standard. It won&#39;t port to other compilers and may even vanish or behave differently in the next GCC compiler version."}], "answers": [{"tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": true, "score": 3, "last_activity_date": 1553125980, "creation_date": 1553125980, "answer_id": 55271822, "question_id": 55271730, "link": "https://stackoverflow.com/questions/55271730/intel-c-compiler-on-windows-catastrophic-error-cannot-open-source-file-bits/55271822#55271822", "title": "Intel C++ compiler on Windows catastrophic error: cannot open source file &quot;bits/unique_ptr.h&quot;", "body": "<p>The correct header file for <code>std::unique_ptr</code> is</p>\n\n<pre><code>#include &lt;memory&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "is_accepted": false, "score": 6, "last_activity_date": 1553156515, "last_edit_date": 1553156515, "creation_date": 1553125991, "answer_id": 55271826, "question_id": 55271730, "link": "https://stackoverflow.com/questions/55271730/intel-c-compiler-on-windows-catastrophic-error-cannot-open-source-file-bits/55271826#55271826", "title": "Intel C++ compiler on Windows catastrophic error: cannot open source file &quot;bits/unique_ptr.h&quot;", "body": "<p>The header <code>&lt;bits/unique_ptr.h&gt;</code> is an internal implementation detail of GCC's standard library. It's one of the headers that makes up the implementation of <code>&lt;memory&gt;</code>.</p>\n\n<p>So it looks like your code is trying to include a header from the GCC standard library, which works fine if you compile with GCC's standard library, but not when using a different standard library. And that should be obvious. You can't include a header that doesn't exist in a different implementation.</p>\n\n<p>User code should <strong>never</strong> try to include <code>&lt;bits/unique_ptr.h&gt;</code> directly, because it doesn't even exist in other implementations of the C++ standard library. The correct header to include is <a href=\"https://en.cppreference.com/w/cpp/memory\" rel=\"nofollow noreferrer\"><code>&lt;memory&gt;</code></a>. The code needs to be fixed to stop trying to include internal implementation details of a specific implementation.</p>\n\n<p>There's even a comment saying this in <code>&lt;bits/unique_ptr.h&gt;</code>:</p>\n\n<pre><code>/** @file bits/unique_ptr.h\n *  This is an internal header file, included by other library headers.\n *  Do not attempt to use it directly. @headername{memory}\n */\n</code></pre>\n"}], "owner": {"reputation": 326, "user_id": 8268098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05e3985b245ee7362bc16b2a608fac2c?s=128&d=identicon&r=PG&f=1", "display_name": "Bernardo Trindade", "link": "https://stackoverflow.com/users/8268098/bernardo-trindade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 0, "accepted_answer_id": 55271822, "answer_count": 2, "score": 0, "last_activity_date": 1553156515, "creation_date": 1553125376, "last_edit_date": 1553134542, "question_id": 55271730, "link": "https://stackoverflow.com/questions/55271730/intel-c-compiler-on-windows-catastrophic-error-cannot-open-source-file-bits", "title": "Intel C++ compiler on Windows catastrophic error: cannot open source file &quot;bits/unique_ptr.h&quot;", "body": "<p>I am trying to use the Intel C++ compiler 19.0 to compile my code on Windows. I am using the following call:</p>\n\n<p><code>icl /Qstd=c++11 c:\\Users\\Bernardo\\Downloads\\HW1_6200\\ProjectAmina\\WaterPaths\\src\\SystemComponents\\Utility\\Utility.cpp</code></p>\n\n<p>Even though this code compiles on Linux systems, when I try to compile it on Windows I get the following error:</p>\n\n<pre><code>c:\\Users\\Bernardo\\Downloads\\HW1_6200\\ProjectAmina\\WaterPaths&gt;icl /Qstd=c++11 c:\\Users\\Bernardo\\Downloads\\HW1_6200\\ProjectAmina\\WaterPaths\\src\\SystemComponents\\Utility\\Utility.cpp\nIntel(R) C++ Intel(R) 64 Compiler for applications running on Intel(R) 64, Version 19.0.3.203 Build 20190206\nCopyright (C) 1985-2019 Intel Corporation.  All rights reserved.\n\nUtility.cpp\nc:\\Users\\Bernardo\\Downloads\\HW1_6200\\ProjectAmina\\WaterPaths\\src\\SystemComponents\\Utility\\Utility.h(10): catastrophic error: cannot open source file \"bits/unique_ptr.h\"\n  #include &lt;bits/unique_ptr.h&gt;\n                              ^\n\ncompilation aborted for c:\\Users\\Bernardo\\Downloads\\HW1_6200\\ProjectAmina\\WaterPaths\\src\\SystemComponents\\Utility\\Utility.cpp (code 4)\n</code></pre>\n\n<p>For some reason, my standard library doesn't seem to have smart pointers. What am I missing?</p>\n"}, {"tags": ["c++", "arrays", "pointers", "dynamic"], "comments": [{"owner": {"reputation": 400, "user_id": 6105802, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/581adbbbee38dee312da6e7c6f12e56a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Marques", "link": "https://stackoverflow.com/users/6105802/daniel-marques"}, "edited": false, "score": 1, "creation_date": 1553125501, "post_id": 55271698, "comment_id": 97274698, "body": "You are initializing the 2d array before allocating all its memory."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1553128833, "post_id": 55271698, "comment_id": 97275476, "body": "<a href=\"https://isocpp.org/wiki/faq/operator-overloading#matrix-subscript-op\" rel=\"nofollow noreferrer\">An alternative.</a> This makes a 2D array out of a 1D array. Much easier to wrangle and often much faster due to improved spatial locality."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10500850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/feaec958c08a9957e8bef3af09b7e3cc?s=128&d=identicon&r=PG&f=1", "display_name": "csstudent", "link": "https://stackoverflow.com/users/10500850/csstudent"}, "edited": false, "score": 0, "creation_date": 1553125900, "post_id": 55271773, "comment_id": 97274806, "body": "Thank you so much! For the deallocation for the 2d array, I&#39;m still getting an error message, on this line       delete y[i][j];     that says you can&#39;t delete expression of type &#39;int&#39;"}, {"owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "reply_to_user": {"reputation": 5, "user_id": 10500850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/feaec958c08a9957e8bef3af09b7e3cc?s=128&d=identicon&r=PG&f=1", "display_name": "csstudent", "link": "https://stackoverflow.com/users/10500850/csstudent"}, "edited": false, "score": 0, "creation_date": 1553125936, "post_id": 55271773, "comment_id": 97274818, "body": "check the edited you can&#39;t deallocate y[i][j] its like saying int a; then try to deallocate but you didn&#39;t even allocate it..on the other hand y[i] is allocated &amp; y is allocated so you gotta deallocate them"}, {"owner": {"reputation": 5, "user_id": 10500850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/feaec958c08a9957e8bef3af09b7e3cc?s=128&d=identicon&r=PG&f=1", "display_name": "csstudent", "link": "https://stackoverflow.com/users/10500850/csstudent"}, "edited": false, "score": 0, "creation_date": 1553126175, "post_id": 55271773, "comment_id": 97274876, "body": "I see, I allocated y[i] here: y[i] = new int[5]; and allocated y here: int <i>*y = new int</i> [length2]; ?? Is that correct?"}, {"owner": {"reputation": 5, "user_id": 10500850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/feaec958c08a9957e8bef3af09b7e3cc?s=128&d=identicon&r=PG&f=1", "display_name": "csstudent", "link": "https://stackoverflow.com/users/10500850/csstudent"}, "edited": false, "score": 0, "creation_date": 1553126438, "post_id": 55271773, "comment_id": 97274952, "body": "That makes sense. I did the correct deallocation for both. Thank you very much!!  I&#39;m kinda confused how to check to see if the results are right. Do you know how I could check to see if they are correct (for the 2D array 3,5?)"}, {"owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "reply_to_user": {"reputation": 5, "user_id": 10500850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/feaec958c08a9957e8bef3af09b7e3cc?s=128&d=identicon&r=PG&f=1", "display_name": "csstudent", "link": "https://stackoverflow.com/users/10500850/csstudent"}, "edited": false, "score": 0, "creation_date": 1553127030, "post_id": 55271773, "comment_id": 97275097, "body": "yes i think it s all good just here for (int i = 0; i &lt; 6; i++) \t\tfor (int j = 0; j &lt; 7; j++) you should actually go to the number of rows &amp; columns in your 2D array not to 6 &amp; 7 because with the example 3,5 you&#39;ll be having out of bound exception"}], "tags": [], "owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "is_accepted": true, "score": 1, "last_activity_date": 1553125632, "creation_date": 1553125632, "answer_id": 55271773, "question_id": 55271698, "link": "https://stackoverflow.com/questions/55271698/dynamic-1d-and-2d-array-c-crash/55271773#55271773", "title": "Dynamic 1D and 2D array c++ crash", "body": "<p>first you allocate memory for the 2d array before you initialize it not the other way around</p>\n\n<p>Second </p>\n\n<p>the correct way to deallocate that memory for a 2D array is </p>\n\n<pre><code>for(int i=0; i &lt; length; i++)\n //first you deallocate every row y[i]\n delete [] y[i];\n\ndelete [] y;\n</code></pre>\n\n<p>and for the 1D array</p>\n\n<pre><code>delete[] x;\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10500850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/feaec958c08a9957e8bef3af09b7e3cc?s=128&d=identicon&r=PG&f=1", "display_name": "csstudent", "link": "https://stackoverflow.com/users/10500850/csstudent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 55271773, "answer_count": 1, "score": -1, "last_activity_date": 1553135221, "creation_date": 1553125194, "last_edit_date": 1553135221, "question_id": 55271698, "link": "https://stackoverflow.com/questions/55271698/dynamic-1d-and-2d-array-c-crash", "title": "Dynamic 1D and 2D array c++ crash", "body": "<p>I have already dynamically allocated the 1D array, int *x, and the 2D array, int **y. I am trying to display the sum of the dynamic 1D and 2D arrays determined by the lengths the user inputs. I have to run the program twice for the length 5 and 10 for the 1D array, and lengths 3,5 and 6,7 for the 2D array.  It is crashing and not displaying any sums on the console. Please help! </p>\n\n<p><code>#include &lt;iostream&gt;</code></p>\n\n<pre><code>using namespace std;\n\nint main()\n{\n    float sum = 0.0;\n    float sum2 =0.0;\n    float sum3 = 0.0; //1d array length 10\n    //1d array dynamic allocation\n    //2d array dynamic allocation\n    int length; //user length for 2d array, 5\n    int length2 = 3; //length for 2d array, 3\n    float oneArray; //length for 1d array\n    float oneArray2; // 1D array\n    int length1;\n    float sum4=0.0;\n\n    cout &lt;&lt; \"Enter dimensions \" &lt;&lt; endl;\n    cin &gt;&gt; length &gt;&gt; oneArray2;\n\n    cout &lt;&lt; \"Enter dimensions for 2d array \" &lt;&lt; endl;\n    cin &gt;&gt; length2 &gt;&gt; oneArray;\n\n\n    int *x = new int[oneArray2]; //single\n\n    int **y = new int* [length2]; //creates array\n\n\n    for(int i= 0; i &lt; length; i++) //initializing 2d array\n        for(int j =0; j &lt; length2; j++)\n        {\n            y[i][j] = i*j;\n        }\n\n\n    //initialize for 1d array\n    for(int l=0; l &lt; oneArray2; l++)\n    {\n        x[l] = l;\n    }\n\n\n    for(int i= 0; i &lt; length; i++) // allocating for 2d array\n        {\n            y[i] = new int[5];\n\n        }\n\n    for(int i=0; i&lt; oneArray2; i++)\n    {\n        sum = sum + x[i];\n        cout &lt;&lt; sum;\n\n    }\n\n    for(int k=0; k &lt; length1; k++){\n\n        sum3 = sum3 + x[k];\n        cout &lt;&lt; sum3;\n    }\n\n\n\n    for(int i= 0; i &lt; length; i++) //initializing\n        for(int j =0; j &lt; length2; j++)\n        {\n            sum2 = sum2 + y[i][j];\n            cout &lt;&lt; sum2;\n\n        }\n\n    for(int i=0; i &lt; 6; i++)\n        for(int j=0; j &lt; 7; j++)\n        {\n\n            sum4 = sum4 + y[i][j];\n            cout &lt;&lt; sum4;\n        }\n\n\n    for(int i=0; i &lt; length; i++)\n        for(int j=0; j &lt; length2; j++)\n        {\n        delete[] y[i][j]; //error message here too\n\n        }\n\n\n    for (int i=0; i &lt; oneArray2; i++)\n         delete[] y[i];\n\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "unicode"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 2, "creation_date": 1553125695, "post_id": 55271662, "comment_id": 97274744, "body": "Unicode defines code points. You need an encoding to somehow store the code point. What encoding do you want to use? The question seems slightly unclear to me. If you&#39;re defining literals, just define them with <code>&#39;\\u&#39;</code>. If you&#39;re reading the desired characters from a file, just store them. If you&#39;re reading the sequence of hex values and you want to encode them to represent an actual code point, you need to parse them. What is your desire?"}, {"owner": {"reputation": 1414, "user_id": 276625, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/65ed6275db2ec3063b97bdea5d25a380?s=128&d=identicon&r=PG", "display_name": "galactica", "link": "https://stackoverflow.com/users/276625/galactica"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1553126306, "post_id": 55271662, "comment_id": 97274911, "body": "Yes, I should&#39;ve clarified better. It&#39;s indeed the last case, where I only get the string from somewhere else. updated question too."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1553126782, "post_id": 55271662, "comment_id": 97275037, "body": "If nobody answers until tomorrow, I will provide an algorithm and some suggestions. Although, it&#39;d be great if you showed us what you had tried."}], "answers": [{"comments": [{"owner": {"reputation": 1414, "user_id": 276625, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/65ed6275db2ec3063b97bdea5d25a380?s=128&d=identicon&r=PG", "display_name": "galactica", "link": "https://stackoverflow.com/users/276625/galactica"}, "edited": false, "score": 0, "creation_date": 1553207450, "post_id": 55288267, "comment_id": 97309613, "body": "thanks for your elaborated examples and explanations! This really helps! What I missed is the unicode rendering piece, so the code snippet and external links are really helpful! One minor thing is that I needed to remove &#39;s&#39; from &quot;u1234&quot;s&#39; to make it compile."}, {"owner": {"reputation": 1414, "user_id": 276625, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/65ed6275db2ec3063b97bdea5d25a380?s=128&d=identicon&r=PG", "display_name": "galactica", "link": "https://stackoverflow.com/users/276625/galactica"}, "edited": false, "score": 0, "creation_date": 1553207602, "post_id": 55288267, "comment_id": 97309662, "body": "do you know if there would be better unicode string support in C++17 and onwards, especially when std::wstring_convert is going to be deprecated then? I meant native support in C++ standard and STL."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "reply_to_user": {"reputation": 1414, "user_id": 276625, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/65ed6275db2ec3063b97bdea5d25a380?s=128&d=identicon&r=PG", "display_name": "galactica", "link": "https://stackoverflow.com/users/276625/galactica"}, "edited": false, "score": 0, "creation_date": 1553210531, "post_id": 55288267, "comment_id": 97310553, "body": "@galactica, glad my solution has helped you! If it solved your issue, consider accepting it by clicking the green tick below the score so the future visitors will know that this indeed solved the original problem. Regarding the <code>&quot;&quot;s</code> - it&#39;s a <i>string literal operator</i>, available from <code>C++14</code>. You can read more about it <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/operator%22%22s\" rel=\"nofollow noreferrer\">here</a> (recommended). As for the native support for various encodings, I think we&#39;re out of luck for some time. <code>C++20</code>&#39;s feature list is completed and covers nothing related to our problem, unfortunately."}, {"owner": {"reputation": 1414, "user_id": 276625, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/65ed6275db2ec3063b97bdea5d25a380?s=128&d=identicon&r=PG", "display_name": "galactica", "link": "https://stackoverflow.com/users/276625/galactica"}, "edited": false, "score": 0, "creation_date": 1553230360, "post_id": 55288267, "comment_id": 97314789, "body": "Thanks for the further details! Too bad we&#39;re still not in the stage of having this fully solved in STL. As for that &quot;&quot;s format, it&#39;s probably worthy mentioning in the comments that that&#39;s available in C++14 and onwards."}], "tags": [], "owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "is_accepted": true, "score": 2, "last_activity_date": 1553210667, "last_edit_date": 1553210667, "creation_date": 1553197803, "answer_id": 55288267, "question_id": 55271662, "link": "https://stackoverflow.com/questions/55271662/c11-how-to-convert-a-hex-string-into-unicode-string/55288267#55288267", "title": "c++11 how to convert a hex string into unicode string", "body": "<p><code>std::regex_replace</code> will not work, since it works withing the actual data stored. The <code>\"\\\\u\"</code> character alters how the text will be stored in data. Simply replacing it won't work - it's too late.</p>\n\n<p>You <em>could</em> play a little bit with encoding. Pretty sure there must be a library for that (I wrote a <a href=\"https://github.com/Fureeish/EncodingParser/blob/master/main.cpp\" rel=\"nofollow noreferrer\">parser</a> which takes a raw UTF-8 file and outputs the code points of multibyte characters, but it's <em>really</em> limited as of right now, <em>plus it's not properly tested</em>), but we can try to implement our own, limited version, to understand what's going on inside.</p>\n\n<p>First of all, why UTF-8? There is really no good reason not to. It depends on your <a href=\"https://stackoverflow.com/questions/9739070/char-encoding\">local encoding</a>, but you can adjust it to your needs.</p>\n\n<p>Example of a code written in UTF-8 editor:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;bitset&gt;\n\nint main() {\n    std::string str = \"\\u1234\";\n    for(char c : str) {\n        std::cout &lt;&lt; std::bitset&lt;8&gt;(static_cast&lt;uint8_t&gt;(c)) &lt;&lt; ' ';\n    }\n}\n</code></pre>\n\n<p>will produce <code>11100001 10001000 10110100</code>. </p>\n\n<p>You can read about <code>std::bitset</code> <a href=\"https://en.cppreference.com/w/cpp/utility/bitset\" rel=\"nofollow noreferrer\">here</a>. If you're surprised by the result (you're not familiar with how UTF-8 works), I encourage you to <a href=\"https://www.youtube.com/watch?v=MijmeoH9LT4&amp;t=0s\" rel=\"nofollow noreferrer\">watch</a> a great video on that.</p>\n\n<hr>\n\n<p>Back to the topic. The goal is to compute the <strong>hex</strong> value, convert it to a sequence of UTF-8 bytes (<em>characters</em>) and store it into <code>std::string</code>.</p>\n\n<p>Pseudocode:</p>\n\n<pre><code>string := input;\nhex := convertToHex(string);\nsequence := hexToUTF8(hex);\noutput := seqToString(sequence); \n</code></pre>\n\n<p>We assume that <code>input</code> will be provided as hex string. To convert a hex string to a decimal value, we can use <code>std::stringstream</code>:</p>\n\n<pre><code>std::string input = \"0x1234\";\nstd::stringstream stream{};\nstream &lt;&lt; std::hex &lt;&lt; input;\nint val;\nstream &gt;&gt; val;\n</code></pre>\n\n<p><code>val</code> will be equal to <code>4660</code>. </p>\n\n<p>Now, we need to construct a sequence of UTF-8 bytes given this value. We can use an existing library, <code>std::wstring_convert</code>, but <strong>beware</strong>, it is considerd <strong>deprecated</strong> as of <code>C++17</code>. You are better of using a <a href=\"https://stackoverflow.com/a/20419914/7151494\">different library</a>, but we'll stick to this one just to demonstrate the example:</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;locale&gt;\n#include &lt;codecvt&gt;\n\nint main()\n{\n    int val = 4660; // 0x1234\n    std::wstring_convert&lt;std::codecvt_utf8&lt;char32_t&gt;, char32_t&gt; converter;\n    std::string u8str = converter.to_bytes(val);\n}\n</code></pre>\n\n<p><code>u8str</code> is now equal to <code>\"\\u1234\"</code>.</p>\n\n<hr>\n\n<p>Full example:</p>\n\n<pre><code>#include &lt;cassert&gt;\n#include &lt;codecvt&gt;\n#include &lt;iostream&gt;\n#include &lt;locale&gt;\n#include &lt;sstream&gt;\n#include &lt;string&gt;\n\nint hex_value(const std::string_view str) {\n    std::stringstream stream{};\n    stream &lt;&lt; std::hex &lt;&lt; str;\n    int parsed;\n    stream &gt;&gt; parsed;\n    return parsed;\n}\n\nstd::string map_to_utf8(const int val) {\n    std::wstring_convert&lt;std::codecvt_utf8&lt;char32_t&gt;, char32_t&gt; converter;\n    return converter.to_bytes(static_cast&lt;char32_t&gt;(val));\n}\n\nint main() {\n    std::string input = \"0x1234\"; // read from file, let's assume...\n\n    const auto value = hex_value(input);\n    const auto str   = map_to_utf8(value);\n\n    using namespace std::literals;\n    assert(str == \"\\u1234\"s &amp;&amp; \"\\u1234\"s == \"\u1234\"s); // passes\n}\n</code></pre>\n"}], "owner": {"reputation": 1414, "user_id": 276625, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/65ed6275db2ec3063b97bdea5d25a380?s=128&d=identicon&r=PG", "display_name": "galactica", "link": "https://stackoverflow.com/users/276625/galactica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 55288267, "answer_count": 1, "score": 1, "last_activity_date": 1553211096, "creation_date": 1553124856, "last_edit_date": 1553211096, "question_id": 55271662, "link": "https://stackoverflow.com/questions/55271662/c11-how-to-convert-a-hex-string-into-unicode-string", "title": "c++11 how to convert a hex string into unicode string", "body": "<p>Seems that even with C++11 this is not straightforward to do, e.g., </p>\n\n<pre><code>string instring = \"0x1234\";  // hex string\nstring outstring = \"\u1234\"       // equivalent to \"\\u1234\"\n</code></pre>\n\n<p>Assuming I only have this hexadecimal number as an input string passed down from some other place, which means I don't know the hex number beforehand.  What's the best way to achieve this? </p>\n\n<p>Looks like this '\\u' prefix only works when immediately followed by the hex number. </p>\n\n<p>Ideas I tried and didn't work:</p>\n\n<pre><code>1. std::regex_replace(instring, \"0x\", \"\\\\u\");\n2. sprintf();\n</code></pre>\n"}, {"tags": ["c++", "installation", "ode-library"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 2, "creation_date": 1553126303, "post_id": 55271511, "comment_id": 97274910, "body": "Try putting <code>-lm</code> last. <code>-lode -lGL -lGLU -lm</code>. Order matters."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 2, "creation_date": 1553126386, "post_id": 55271511, "comment_id": 97274937, "body": "Also use g++ not gcc for C++ code."}, {"owner": {"reputation": 4625, "user_id": 1861521, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dda04c7abdfe8b05f4a258b7a01900a6?s=128&d=identicon&r=PG", "display_name": "jcarpenter2", "link": "https://stackoverflow.com/users/1861521/jcarpenter2"}, "edited": false, "score": 0, "creation_date": 1553131924, "post_id": 55271511, "comment_id": 97276131, "body": "FYI it&#39;s pretty typical to install custom libs of yours into the <code>&#47;usr&#47;local</code> prefix (run <code>configure</code> with <code>--prefix=&#47;usr&#47;local</code>) so that your installs are cleanly overlaid on top of anything that your OS installed (and can be cleanly destroyed in the event that you want to delete everything you manually installed without adversely affecting your OS)"}], "owner": {"reputation": 19, "user_id": 10456033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c402ae306e3ac08df614d8e2731fa42?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Medeiros Centa", "link": "https://stackoverflow.com/users/10456033/matheus-medeiros-centa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553123839, "creation_date": 1553123839, "question_id": 55271511, "link": "https://stackoverflow.com/questions/55271511/undefined-reference-to-error-while-compiling-file-that-uses-the-open-dynamic", "title": "&quot;undefined reference to *&quot; Error while compiling file that uses the Open Dynamics Engine v0.13.1", "body": "<p>I am a beginner to organizing C++ projects and I have been trying to start an Open Dynamics Engine project for a week now but I keep getting several errors. First, what I have done:</p>\n\n<ul>\n<li>Installed ode-0.13.1 with automake as directed in the <a href=\"http://ode.org/wiki/index.php?title=Manual\" rel=\"nofollow noreferrer\">manual</a>.</li>\n<li>Created a file <code>test.cpp</code> with the code from the <a href=\"http://ode.org/wiki/index.php?title=Simple_Bouncing_Sphere\" rel=\"nofollow noreferrer\">bouncing ball HOWTO</a>.</li>\n<li>Wrote a makefile to compile.</li>\n</ul>\n\n<p>But when I run my makefile, I get the following errors:</p>\n\n<blockquote>\n  <p>gcc -Wall -g -DdDOUBLE -o test test.o -L/home/username/ode-0.13.1/ode/src/libode.la -L/home/username/ode-0.13.1/drawstuff/src/libdrawstuff.la -L/usr/X11R6/lib -L/usr/lib -L/usr/local/lib -I. -I/home/username/ode-0.13.1/include/ -I/usr/X11R6/include -I/usr/include -lm -lode -lGL -lGLU\n  /usr/local/lib/libode.a(collision_trimesh_box.o): In function <code>dCalcVectorLength3':\n  /home/username/ode-0.13.1/ode/src/../../include/ode/odemath.h:148: undefined reference to</code>sqrt'\n  /home/username/ode-0.13.1/ode/src/../../include/ode/odemath.h:148: undefined reference to <code>sqrt'\n  /home/username/ode-0.13.1/ode/src/../../include/ode/odemath.h:148: undefined reference to</code>sqrt'\n  /usr/local/lib/libode.a(util.o): In function <code>dxStepBody(dxBody*, double)':\n  /home/username/ode-0.13.1/ode/src/util.cpp:618: undefined reference to</code>sincos'\n  /home/username/ode-0.13.1/ode/src/util.cpp:630: undefined reference to <code>sincos'\n  /home/username/ode-0.13.1/ode/src/util.cpp:628: undefined reference to</code>sqrt'\n  /home/username/ode-0.13.1/ode/src/util.cpp:590: undefined reference to `sqrt'</p>\n</blockquote>\n\n<p>... (and this keeps going for pages)</p>\n\n<blockquote>\n  <p>/usr/local/lib/libode.a(OPC_AABBTree.o): In function <code>Opcode::AABBTree::Build(Opcode::AABBTreeBuilder*)':\n  /home/username/ode-0.13.1/OPCODE/OPC_AABBTree.cpp:413: undefined reference to</code>operator new[](unsigned long)'\n  /home/username/ode-0.13.1/OPCODE/OPC_AABBTree.cpp:427: undefined reference to <code>operator new[](unsigned long)'\n  /usr/local/lib/libode.a(OPC_AABBTree.o): In function</code>Opcode::AABBTreeNode::~AABBTreeNode()':\n  /home/username/ode-0.13.1/OPCODE/OPC_AABBTree.cpp:83: undefined reference to <code>operator delete[](void*, unsigned long)'\n  /usr/local/lib/libode.a(OPC_Collider.o): In function</code>Opcode::Collider::~Collider()':\n  /home/username/ode-0.13.1/OPCODE/OPC_Collider.cpp:54: undefined reference to <code>operator delete(void*, unsigned long)'\n  /usr/local/lib/libode.a(OPC_Collider.o):(.data.rel.ro._ZTIN6Opcode8ColliderE[_ZTIN6Opcode8ColliderE]+0x0): undefined reference to</code>vtable for __cxxabiv1::__class_type_info'\n  /usr/local/lib/libode.a(OPC_Collider.o):(.data.rel.ro._ZTVN6Opcode8ColliderE[_ZTVN6Opcode8ColliderE]+0x20): undefined reference to `__cxa_pure_virtual'\n  collect2: error: ld returned 1 exit status\n  makefile:14: recipe for target 'test' failed\n  make: *** [test] Error 1</p>\n</blockquote>\n\n<p>These errors seem like the library has not been set up correctly, but I'm pretty sure I've properly installed and my -L's are set to the correct paths.</p>\n\n<p>Note 1: the demos included with the ode library work.</p>\n\n<p>Note 2: I've tried (and failed) to install other versions of ode previously. I  did my best with <code>make uninstall</code> and <code>make clean</code> to clean these failed installs, but I think they may be affecting new installs because when I run <code>sudo make install</code> for the first time there is an awful lot of <code>Nothing to do here...</code> messages. </p>\n"}, {"tags": ["c++", "linked-list", "priority-queue"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1553124657, "post_id": 55271464, "comment_id": 97274457, "body": "A <code>PriorityQueue&amp;</code> is not a <code>PQCell*&amp;</code>. That clearly explains all error messaging. That call should be passing <code>q.cells</code> as the first argument, from what i see."}, {"owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 0, "creation_date": 1553124785, "post_id": 55271464, "comment_id": 97274493, "body": "Instead of passing a reference to a pointer to <code>insertCell()</code>, why don&#39;t you just return the pointer to the new <code>PQCell</code>?   I find the mix of references and pointers confusing, is there a reason why you don&#39;t use pointer-to-pointer?  Don&#39;t we teach pointer-to-pointers any more?"}, {"owner": {"reputation": 19, "user_id": 11059417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d36214581ee7aaef6ee793f9f88fea7?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/11059417/luke"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1553125119, "post_id": 55271464, "comment_id": 97274593, "body": "I changed the code to what you suggest and it fixed the errors @WhozCraig, Thanks."}, {"owner": {"reputation": 19, "user_id": 11059417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d36214581ee7aaef6ee793f9f88fea7?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/11059417/luke"}, "reply_to_user": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 0, "creation_date": 1553125168, "post_id": 55271464, "comment_id": 97274608, "body": "@Kingsley we were giving specific instructions to use those two function headings how they are, which unfortunately means if I change it to make it easier for me, it will lower the grade received."}, {"owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 1, "creation_date": 1553125280, "post_id": 55271464, "comment_id": 97274643, "body": "Fair enough - but <code>Param *&amp;</code> would never pass a code review at any company I&#39;ve ever worked at."}, {"owner": {"reputation": 19, "user_id": 11059417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d36214581ee7aaef6ee793f9f88fea7?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/11059417/luke"}, "reply_to_user": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 0, "creation_date": 1553125330, "post_id": 55271464, "comment_id": 97274659, "body": "Which is why I contemplate not taking this professor again. @Kingsley"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 1, "creation_date": 1553126561, "post_id": 55271464, "comment_id": 97274976, "body": "@Kingsley Are you saying that <code>Param**</code> would pass code review? Seems even worse to me."}, {"owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1553126942, "post_id": 55271464, "comment_id": 97275071, "body": "@John, as long as it was an appropriate use, sure.  Every <code>argv</code> is a <code>**</code> !"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 0, "creation_date": 1553128298, "post_id": 55271464, "comment_id": 97275372, "body": "@Kingsley I&#39;m curious; what specifically would cause every company you ever worked for to reject a check-in with that construct, and in particular, what are te related reasons <i>other</i> than the reviewers pure opinion of style. Don&#39;t misunderstand; I prefer passing my in/out pointer parameters by address (pointer to pointer; a holdover from my many years in C before coming home to C++ 25 years ago, as it reserve my option to return success/error state as the result), but I&#39;d love to have a generally-accepted industry guideline to fallback on when telling juniors to just don&#39;t do that?"}, {"owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1553133845, "post_id": 55271464, "comment_id": 97276536, "body": "@WhozCraig - I don&#39;t know of any &quot;generally-accepted industry guideline&quot;.  When I was a junior, I was told in a code review: &quot;C++ references should be used <i>only</i> for operator overloading&quot; (i.e.: returning an object reference to support assignment).  I personally have no issue with using references for a &quot;var parameter&quot; (although pointers are my preference too), but not <i>mixing</i> references and pointers.  Maybe I&#39;ve turned into a coding curmudgeon over the years.  Seems nowdays if you use <code>**</code> in C/C++ you obviously hate  kittens too.  Seems so on SO at least."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11059417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d36214581ee7aaef6ee793f9f88fea7?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/11059417/luke"}, "edited": false, "score": 0, "creation_date": 1553125293, "post_id": 55271653, "comment_id": 97274649, "body": "Thank you for pointing out the mistake in isEmpty. And Yes q.cells was what the correct way to do it was."}], "tags": [], "owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "is_accepted": true, "score": 1, "last_activity_date": 1553124799, "creation_date": 1553124799, "answer_id": 55271653, "question_id": 55271464, "link": "https://stackoverflow.com/questions/55271464/c-linked-lists-for-priority-queues/55271653#55271653", "title": "C++, Linked Lists for Priority Queues", "body": "<p>The main problem (the one that's causing the <code>invalid initialization</code> error) is that you're passing a <code>PriorityQueue&amp;</code> into a function that's expecting a <code>PQCell*&amp;</code>:</p>\n\n<pre><code>//Function insert inserts item x with priority p into a priority queue 'q'.\nvoid insert(PriorityQueue&amp; q, ItemType x, PriorityType p)\n{\n   // Wrong.\n   //insertCell(q, x, p);\n\n   // You probably meant to do this:\n   insertCell(q.cells, x, p);\n}\n</code></pre>\n\n<p>I also noticed that your <code>isEmpty</code> logic seems to be backwards:</p>\n\n<pre><code>//Function isEmpty returns true if the queue is empty and false if it is not.\nbool isEmpty(const PriorityQueue&amp; q)\n{\n   if(q.cells == NULL)\n   {\n       return false;\n   }\n\n   return true;\n}     \n</code></pre>\n\n<p>You're returning <code>false</code> if <code>q.cells == NULL</code>, when you probably meant to be returning <code>true</code> in that case, and <code>false</code> otherwise.</p>\n"}], "owner": {"reputation": 19, "user_id": 11059417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d36214581ee7aaef6ee793f9f88fea7?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/11059417/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 55271653, "answer_count": 1, "score": 0, "last_activity_date": 1553124799, "creation_date": 1553123532, "last_edit_date": 1553124252, "question_id": 55271464, "link": "https://stackoverflow.com/questions/55271464/c-linked-lists-for-priority-queues", "title": "C++, Linked Lists for Priority Queues", "body": "<p>I'm working on an assignment and the goal is to make a module that will assist in representing a priority queue displaying each 'item' and it's appropriate 'priority value'. I'm not asking anybody to do my \"homework\" for me as stated in my previous post, I'm simply asking for help understanding where I am going wrong with my <code>insert</code> and <code>insertCell</code> functions that gives me errors. Any advice/tips would be very helpful in solving my problem.</p>\n\n<pre><code>//Beginning of Code\n//File: pqueue.cpp\n\n\n//Module pqueue.cpp provides priority queues that include items and their \n//priority types. It tests for empty queues, can insert priority queues that\n//include a new item with a new priority, can remove priority queues and/or\n//items with their priorities, and can print each item along with its priority\n//to the standard output.\n//\n//\n\n#include &lt;cstdio&gt;\n#include \"pqueue.h\"\n#include &lt;cstdlib&gt;\n\nusing namespace std;\n\n//An object of type PQCell represents a cell in a linked list.\n//\n//PQCell has three field.\n//\n//item- the particular item that is entered\n//priority- the priority that an item has\n//nextList- a pointer to the next cell in the list\nstruct PQCell\n{ \n    ItemType item;\n    PriorityType priority;\n    PQCell *nextItem;\n\n    PQCell(ItemType a, PriorityType b, PQCell* nextCell)\n    {\n        item = a;\n        priority = b;\n        nextItem = nextCell;\n    }   \n};\n\n//Function isEmpty returns true if the queue is empty and false if it is not.\nbool isEmpty(const PriorityQueue&amp; q)\n{\n    if(q.cells == NULL)\n    {\n            return false;\n    }\n\n    return true;\n}   \n\n//Function insertCell inserts item x with priority p into a linked list 'L'.\nvoid insertCell(PQCell*&amp; L, ItemType x, PriorityType p)\n{\n    if(L==NULL || L -&gt; priority &gt; p)\n    {\n        L = new PQCell(x, p, L);\n    }\n\n    else\n    {\n        insertCell(L -&gt; nextItem, x,p);\n    }\n}\n\n//Function insert inserts item x with priority p into a priority queue 'q'.\nvoid insert(PriorityQueue&amp; q, ItemType x, PriorityType p)\n{\n    insertCell(q, x, p);\n}\n\n//Function printPriorityQueue prints a representation of the priority queue \n//including each value, x, and it's priority type, y, respectively.\nvoid printPriorityQueue(const PriorityQueue&amp; q, ItemPrinter printItem, \n        PriorityPrinter printPriority)\n{\n    PQCell* pointer = q.cells;\n    while(pointer != NULL)\n    {\n        printf(\"Item = \");\n        (printItem)(pointer-&gt;item);\n\n        printf(\"     Priority = \");\n        (printPriority)(pointer-&gt;priority);\n\n        printf(\"\\n\");\n\n        pointer = pointer -&gt; nextItem;\n    }\n}\n\n//Function remove removes the item with the smallest priority. It also stores\n//the item and it's priority into x and p, respectively.\nvoid remove(PriorityQueue&amp; q, ItemType&amp; x, PriorityType&amp; p)\n{\n    if(q.cells != NULL)\n    {\n        PQCell *pointer = q.cells;\n        q.cells = q.cells -&gt; nextItem;\n        x = pointer -&gt; item;\n        p = pointer -&gt; priority;\n        delete [] pointer;\n    }\n\n    else\n    {\n        printf(\"Q is empty\");\n        exit(1);\n    }\n}\n</code></pre>\n\n<hr>\n\n<pre><code>//File: pqueue.h\n\n\n\ntypedef const char* ItemType;\ntypedef double      PriorityType;\nstruct PQCell;\ntypedef void (*ItemPrinter)(ItemType);\ntypedef void (*PriorityPrinter)(PriorityType);\n\n\n\nstruct PriorityQueue\n{\n    PQCell* cells;\n\n    PriorityQueue()\n    {\n        cells = NULL;\n    }\n};\n\nbool isEmpty(const PriorityQueue&amp; q);\n\nvoid insert(PriorityQueue&amp; q, ItemType x, PriorityType p);\n\nvoid printPriorityQueue(const PriorityQueue&amp; q, ItemPrinter printItem, \n        PriorityPrinter printPriority);\n\nvoid remove(PriorityQueue&amp; q, ItemType&amp; x, PriorityType&amp; p);\n</code></pre>\n\n<p>The main problem I'm having is like I said, the <code>insert</code> and <code>insertCell</code> functions. I keep receiving the errors:</p>\n\n<pre><code>pqueue.cpp: In function void insert(PriorityQueue*&amp;, ItemType, PriorityType):\n\npqueue.cpp:70:20: error: invalid initialization of reference of type PQCell*&amp; from expression of type PriorityQueue*\n  insertCell(q, x, p);\n\npqueue.cpp:54:6: error: in passing argument 1 of void insertCell(PQCell*&amp;, ItemType, PriorityType)\n void insertCell(PQCell*&amp; L, ItemType x, PriorityType p)\n</code></pre>\n\n<p>Again, any help would be great, thanks.</p>\n"}, {"tags": ["c++", "c", "multithreading", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1553126373, "post_id": 55271457, "comment_id": 97274930, "body": "Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. In particular, <i>how</i> did you initialize the array?"}, {"owner": {"reputation": 387, "user_id": 4238247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAQwx.png?s=128&g=1", "display_name": "edhu", "link": "https://stackoverflow.com/users/4238247/edhu"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1553136343, "post_id": 55271457, "comment_id": 97277074, "body": "@EOF I added the example. But I didn&#39;t see how exactly the way the array is initialized affects the execution results"}], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1553194857, "post_id": 55275403, "comment_id": 97304668, "body": "The signed integer overflow is undefined behavior, so the compiler can remove the code entirely."}, {"owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1553455165, "post_id": 55275403, "comment_id": 97381117, "body": "@EOF good point. I added a note mentioning it (although I&#39;m still quite confident things are like I described them)"}, {"owner": {"reputation": 387, "user_id": 4238247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAQwx.png?s=128&g=1", "display_name": "edhu", "link": "https://stackoverflow.com/users/4238247/edhu"}, "edited": false, "score": 0, "creation_date": 1556735218, "post_id": 55275403, "comment_id": 98534994, "body": "It appears compiler optimization is the reason why the problem occurs. For some reason the compiler decided to change the reduction operation into atomic add. That makes all the difference."}], "tags": [], "owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "is_accepted": true, "score": 4, "last_activity_date": 1553455050, "last_edit_date": 1553455050, "creation_date": 1553152539, "answer_id": 55275403, "question_id": 55271457, "link": "https://stackoverflow.com/questions/55271457/openmp-first-kernel-much-slower-than-the-second-kernel/55275403#55275403", "title": "OpenMP first kernel much slower than the second kernel", "body": "<p>Since you don't provide any <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete and Verifiable Example</a>, I'll have to make some wild guesses here, but I'm pretty confident I have the gist of the issue.</p>\n\n<p>First, you have to notice that 98,306 x 98,306 is 9,664,069,636 which is way larger than the maximum value a signed 32 bit integer can store (which is 2,147,483,647). Therefore, the upper limit of your <code>for</code> initialization loop, after overflowing, could become 1,074,135,044 (as on my machines, although it is undefined behavior so strictly speaking, anything could happen), which is roughly 9 times smaller than what you expected.</p>\n\n<p>So now, after the initialization loop, only 11% of the memory you thought you allocated has actually been allocated and touched by the operating system. However, your first reduction loop does a good job in going over the various elements of the array, and since for about 89% of it, it's for the fist time, the OS does the actual memory allocation there and then, which takes some significant amount of time.</p>\n\n<p>And now, for your second reduction loop, all memory has been properly allocated and touched, which makes it much faster.</p>\n\n<p>So that's what I believe happened. That said, many other parameters can enter into play here, such as:</p>\n\n<ul>\n<li><strong>Swapping</strong>: the array you try to allocate represents about 36GB of memory. If your machine doesn't have that much memory available, then your code might swap, which will potentially make a big mess of whatever performance measurement you can come up with</li>\n<li><strong>NUMA effect</strong>: if your machine has multiple NUMA nodes, then thread pinning and memory affinity, when not managed properly, can have a large impact on performance between loop occurrences</li>\n<li><strong>Compiler optimization</strong>: you didn't mention which compiler you used and which level of optimization you requested. Depending on that, you'd be amazed on how shortened your code could become. For example, the compiler could totally remove the second loop as it does the same thing as the first and becomes useless as the result will be the same... And many other interesting and unexpected things which render your benchmark meaningless</li>\n</ul>\n"}], "owner": {"reputation": 387, "user_id": 4238247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAQwx.png?s=128&g=1", "display_name": "edhu", "link": "https://stackoverflow.com/users/4238247/edhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "accepted_answer_id": 55275403, "answer_count": 1, "score": -2, "last_activity_date": 1553455050, "creation_date": 1553123469, "last_edit_date": 1553136263, "question_id": 55271457, "link": "https://stackoverflow.com/questions/55271457/openmp-first-kernel-much-slower-than-the-second-kernel", "title": "OpenMP first kernel much slower than the second kernel", "body": "<p>I have a huge 98306 by 98306 2D array initialized. I created a kernel function that counts the total number of elements below a certain threshold.</p>\n\n<pre><code>#pragma omp parallel for reduction(+:num_below_threshold)\nfor(row)\n    for(col)\n        index = get_corresponding_index(row, col);\n        if (array[index] &lt; threshold)\n            num_below_threshold++;\n</code></pre>\n\n<p>For benchmark purpose I measured the execution time of the kernel executing when the number of thread is set to 1. I noticed that the first time the kernel executes it took around 11 seconds. The next call to the kernel executing on the same array with one thread only took around 3 seconds. I thought it might be a problem related to cache but it doesn't seem to be related. What is the possible reasons that caused this?</p>\n\n<p>This array is initialized as:</p>\n\n<pre><code>float *array = malloc(sizeof(float) * 98306 * 98306);\nfor (int i = 0; i &lt; 98306 * 98306; i++) {\n    array[i] = rand() % 10;\n}\n</code></pre>\n\n<p>This same kernel is applied to this array twice and the second execution time is much faster than the first kernel. I though of lazy allocation on Linux but that shouldn't be a problem because of the initialization function. Any explanations will be helpful. Thanks!</p>\n"}, {"tags": ["c++", "class", "subclass"], "answers": [{"tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": true, "score": 0, "last_activity_date": 1553179588, "last_edit_date": 1553179588, "creation_date": 1553127334, "answer_id": 55271976, "question_id": 55271391, "link": "https://stackoverflow.com/questions/55271391/how-do-i-tell-a-class-to-create-unique-sub-classes/55271976#55271976", "title": "How do I tell a class to create unique sub-classes", "body": "<p>I think you are getting mixed up between classes and objects.  Just have class <code>Instrument</code> own an object of class <code>Screen</code>.  The rest then follows naturally.</p>\n\n<p>So you might have (expanding on your ideas a little bit):</p>\n\n<pre><code>class Screen\n{\npublic:\n    void IncValue ();\nprivate:\n    int volume;\n};\n\nclass Instrument\n{\npublic:\n    Screen screen;\n    ...\n};\n\nclass Piano : public Instrument\n{\n    ...\n};\n</code></pre>\n\n<p>And then you can do (for example):</p>\n\n<pre><code>Piano MyPiano;\nMyPiano.screen.IncValue ();\n...\n</code></pre>\n\n<p>for any Instrument or subclass of Instrument.</p>\n"}], "owner": {"reputation": 189, "user_id": 10829471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34770f92d5a756d0ca7b88c0631f2e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Bryant", "link": "https://stackoverflow.com/users/10829471/mike-bryant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 55271976, "answer_count": 1, "score": 0, "last_activity_date": 1553179588, "creation_date": 1553122939, "question_id": 55271391, "link": "https://stackoverflow.com/questions/55271391/how-do-i-tell-a-class-to-create-unique-sub-classes", "title": "How do I tell a class to create unique sub-classes", "body": "<p>I have defined a class called <code>Instrument</code> which I initialise by calling a function in the class to it the name of the Instrument to put up on the display.</p>\n\n<p>I now create two Instruments:</p>\n\n<pre><code>Instrument Organ\nInstrument Piano\n</code></pre>\n\n<p>I also have another class called <code>Screen</code> which handles changing values such as volume and putting those values on the display.  For example it has a function called <code>IncValue()</code> which does what it says.</p>\n\n<p>I want to create subclasses that can be repeated for all Instruments such as :</p>\n\n<pre><code>Screen Volume\n</code></pre>\n\n<p>This would declare <code>int16_t volume</code> and <code>IncValue()</code> would increment the volume, <code>DecValue()</code> reduce it.</p>\n\n<p>But how do I create those <code>Screens</code> from the <code>Instrument Class</code> such that I can do things like</p>\n\n<pre><code>Organ.Volume.IncValue()\n</code></pre>\n\n<p>(or -> maybe, I've got totally lost on this level of complexity)\nand</p>\n\n<pre><code>Piano.Volume.IncValue()\n</code></pre>\n\n<p>and they only work on the relevant Instrument.</p>\n\n<p>Eventually there will be 100s of Instruments declared so I really don't want to declare unique Classes such as <code>Screen PianoVolume</code> and <code>Screen OrganVolume</code>.</p>\n\n<p>Hope this isn't too long-winded a question.</p>\n"}, {"tags": ["c++", "class", "linked-list"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1553123411, "post_id": 55271225, "comment_id": 97274095, "body": "I&#39;m having a hard job understanding the task given, the names of the methods are confusing. But bruno is right, however these methods are supposed to work, you must at some point create some nodes. You aren&#39;t doing that at present."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11234682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f52056cfcc4cf914f8a7a4e94c0c6f?s=128&d=identicon&r=PG&f=1", "display_name": "kenz", "link": "https://stackoverflow.com/users/11234682/kenz"}, "edited": false, "score": 0, "creation_date": 1553123640, "post_id": 55271356, "comment_id": 97274159, "body": "So what would be the best way to fix it then?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 3, "user_id": 11234682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f52056cfcc4cf914f8a7a4e94c0c6f?s=128&d=identicon&r=PG&f=1", "display_name": "kenz", "link": "https://stackoverflow.com/users/11234682/kenz"}, "edited": false, "score": 0, "creation_date": 1553124652, "post_id": 55271356, "comment_id": 97274453, "body": "@kenz but are you written the classes and method profiles by yourself or they come with the exercise ? I do not understand &quot;main class&quot;"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 3, "user_id": 11234682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f52056cfcc4cf914f8a7a4e94c0c6f?s=128&d=identicon&r=PG&f=1", "display_name": "kenz", "link": "https://stackoverflow.com/users/11234682/kenz"}, "edited": false, "score": 0, "creation_date": 1553124893, "post_id": 55271356, "comment_id": 97274528, "body": "@kenz perhaps you just have to create a first instance to be able to call the AppendXXX on it to add the next instances ? The first instance use <i>Store</i> to update its attributes after a new just creating it (even the best way is to set the attributes is in a dedicated constructor of course)"}, {"owner": {"reputation": 3, "user_id": 11234682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f52056cfcc4cf914f8a7a4e94c0c6f?s=128&d=identicon&r=PG&f=1", "display_name": "kenz", "link": "https://stackoverflow.com/users/11234682/kenz"}, "edited": false, "score": 0, "creation_date": 1553125707, "post_id": 55271356, "comment_id": 97274748, "body": "The main class is the main.cpp"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 3, "user_id": 11234682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f52056cfcc4cf914f8a7a4e94c0c6f?s=128&d=identicon&r=PG&f=1", "display_name": "kenz", "link": "https://stackoverflow.com/users/11234682/kenz"}, "edited": false, "score": 0, "creation_date": 1553126486, "post_id": 55271356, "comment_id": 97274960, "body": "a file/function is not a class ;-) I Encourage you to edit your question clarify in it what is from you and what is coming from the problem you have to solve, because there are stange/inconsistent things in it. (and for me it is 1am so time to sleep ^^)"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 0, "last_activity_date": 1553123016, "last_edit_date": 1553123016, "creation_date": 1553122711, "answer_id": 55271356, "question_id": 55271225, "link": "https://stackoverflow.com/questions/55271225/c-node-class-linked-list-lifo-fifo/55271356#55271356", "title": "C++ Node class, linked list, LIFO, FIFO", "body": "<blockquote>\n  <p>It is throwing this error:Exception thrown: read access violation. this was nullptr.</p>\n</blockquote>\n\n<p>Your programs begin by doing </p>\n\n<blockquote>\n<pre><code>int main()\n{\n    Node *LIFO = nullptr;\n    ...\n    LIFO-&gt;AppendLIFO(10, \"postMalone\", \"Asdkc34D\", \"Austin\", \"Post\");\n</code></pre>\n</blockquote>\n\n<p>and in <em>Node::AppendLIFO</em> you do </p>\n\n<blockquote>\n<pre><code>curNode = head;\n</code></pre>\n</blockquote>\n\n<p>so you try to access to <em>head</em> while <em>this</em> is <em>nullptr</em>, then later you use the undefined result to do </p>\n\n<blockquote>\n<pre><code>curNode = curNode-&gt;next;\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>Currently your program never create an instance of <em>Node</em>, it cannot works like that</p>\n"}], "owner": {"reputation": 3, "user_id": 11234682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f52056cfcc4cf914f8a7a4e94c0c6f?s=128&d=identicon&r=PG&f=1", "display_name": "kenz", "link": "https://stackoverflow.com/users/11234682/kenz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 55271356, "answer_count": 1, "score": -1, "last_activity_date": 1553123185, "creation_date": 1553121780, "last_edit_date": 1553123185, "question_id": 55271225, "link": "https://stackoverflow.com/questions/55271225/c-node-class-linked-list-lifo-fifo", "title": "C++ Node class, linked list, LIFO, FIFO", "body": "<p>I have to write a \u201cprogrammer friendly\u201d linked list. I have two classes, your main class and your node class. My node class will is my data structure and must contain the information listed below. All of the node information will be housed in the node class. My main class should only be a driver to call the node function.</p>\n\n<p>Main class should contain:</p>\n\n<ul>\n<li>Code to call node class to append into your structure, LIFO</li>\n<li>Code to call node class to append into your structure, FIFO</li>\n<li>Code to call node class to display your structure</li>\n</ul>\n\n<p>Your Node class should perform the following operations:</p>\n\n<ul>\n<li>Store: user ID, username, password, first name, last name, head, and next.</li>\n<li>AppendFIFO function:    Will take 1 integer and 4 strings</li>\n<li>AppendLIFO function:    Will take 1 integer and 4 strings</li>\n<li>Display function :  Will take no arguments</li>\n</ul>\n\n<p>NOTES:</p>\n\n<ul>\n<li>I have 2 classes Node and your main class</li>\n<li>I have two Node objects in your main class, one for FIFO and one for LIFO</li>\n<li>My node class is where you will keep track of where the next node goes and where the head is, do not do this inside of your main class.</li>\n<li>Do not change the order in which you insert into your Nodes to get a LIFO structure and a FIFO structure.  (E.g. My first append function call for both FIFO and LIFO are given information for Zackary Moore)</li>\n<li>Do not change the order in which you display into your Nodes to get a LIFO structure and a FIFO structure. You should only have one display function.</li>\n<li>You must insert at least 10 users information inside of your main class.</li>\n</ul>\n\n<p>My Node.cpp code looks like this: It is throwing this error:Exception thrown: read access violation.\nthis was nullptr.</p>\n\n<pre><code>#include \"stdafx.h\"\n#include \"Node.h\"\n#include \"iomanip\"\n\n\nNode::Node()\n{\n}\n\n\nNode::~Node()\n{\n}\nvoid Node::AppendFIFO(int id, string userName, string password, string fName, string lName)\n{\n\n}\nvoid Node::AppendLIFO(int id, string userName, string password, string fName, string lName)\n{\n    //cout &lt;&lt; \"Yo\" &lt;&lt; endl;\n    Node *curNode;\n    curNode = head;\n    cout &lt;&lt; \"user name:\" &lt;&lt; userName.length();\n    cout &lt;&lt; \"Password:\" &lt;&lt; password.length();\n    cout &lt;&lt; \"f name:\" &lt;&lt; fName.length();\n    cout &lt;&lt; \"l name:\" &lt;&lt; lName.length();\n    while (curNode != nullptr)\n    {\n\n        curNode = curNode-&gt;next;\n    }\n}\nvoid Node:: display()\n{\n\n}\n</code></pre>\n\n<p>My Node.h file looks like this </p>\n\n<pre><code>#pragma once\n#include \"iostream\"\n#include \"string\"\n#include \"iomanip\"\n\nusing namespace std;\n\nclass Node\n{\n    public:\n        Node();\n        ~Node();\n        void AppendFIFO(int, string, string, string, string);\n        void AppendLIFO(int, string, string, string, string);\n        void display();\n\n    private:\n        int ID;\n        string userName;\n        string password;\n        string firstName;\n        string lastName;\n        Node *next;\n        Node *head;\n\n};\n</code></pre>\n\n<p>My code for the main.cpp file looks like this </p>\n\n<pre><code>#include \"stdafx.h\"\n#include \"iostream\"\n#include \"string\"\n#include \"Node.h\"\n#include \"iomanip\"\n\nusing namespace std;\n\n\nint main()\n{\n    Node *LIFO = nullptr;\n    Node *FIFO = nullptr;\n\n    //The 10 users information for LIFO\n    LIFO-&gt;AppendLIFO(10, \"postMalone\", \"Asdkc34D\", \"Austin\", \"Post\");\n    LIFO-&gt;AppendLIFO(9, \"h20\", \"akdjW78v\", \"Benny\", \"Washington\");\n    LIFO-&gt;AppendLIFO(8, \"testing\", \"aklc5kaS\", \"Timmy\", \"Trump\");\n    LIFO-&gt;AppendLIFO(7, \"Rob-by\", \"robby3939\", \"Robert\", \"Malone\");\n    LIFO-&gt;AppendLIFO(6, \"TracyLMoore\", \"Moore098\", \"Tracy\", \"Moore\");\n    LIFO-&gt;AppendLIFO(5, \"Billybill\", \"Bb234\", \"Bill\", \"Prescott\");\n    LIFO-&gt;AppendLIFO(4, \"beth-09\", \"09ASDN\", \"Beth\", \"Richards\");\n    LIFO-&gt;AppendLIFO(3, \"Gabe123\", \"123ilkkSW\", \"Gabriel\", \"Smith\");\n    LIFO-&gt;AppendLIFO(2, \"sthomas\", \"sthom56712\", \"Shannon\", \"Thomas\");\n    LIFO-&gt;AppendLIFO(1, \"bob\", \"LKJG840\", \"Bobby\", \"Steve\");\n    LIFO-&gt;AppendLIFO(0, \"zmoore00\", \"00SDJ\", \"Zackary\", \"Moore\");\n\n    //The 10 users information for FIFO\n    FIFO-&gt;AppendFIFO(10, \"postMalone\", \"Asdkc34D\", \"Austin\", \"Post\");\n    FIFO-&gt;AppendFIFO(9, \"h20\", \"akdjW78v\", \"Benny\", \"Washington\");\n    FIFO-&gt;AppendFIFO(8, \"testing\", \"aklc5kaS\", \"Timmy\", \"Trump\");\n    FIFO-&gt;AppendFIFO(7, \"Rob-by\", \"robby3939\", \"Robert\", \"Malone\");\n    FIFO-&gt;AppendFIFO(6, \"TracyLMoore\", \"Moore098\", \"Tracy\", \"Moore\");\n    FIFO-&gt;AppendFIFO(5, \"Billybill\", \"Bb234\", \"Bill\", \"Prescott\");\n    FIFO-&gt;AppendFIFO(4, \"beth-09\", \"09ASDN\", \"Beth\", \"Richards\");\n    FIFO-&gt;AppendFIFO(3, \"Gabe123\", \"123ilkkSW\", \"Gabriel\", \"Smith\");\n    FIFO-&gt;AppendFIFO(2, \"sthomas\", \"sthom56712\", \"Shannon\", \"Thomas\");\n    FIFO-&gt;AppendFIFO(1, \"bob\", \"LKJG840\", \"Bobby\", \"Steve\");\n    FIFO-&gt;AppendFIFO(0, \"zmoore00\", \"00SDJ\", \"Zackary\", \"Moore\");\n\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p>I can't figure out what is wrong with the error. I also cannot figure out how to determine the length of the longest string in the group of strings and then store it to be able to use for setw for a proper display.Help Please.</p>\n"}, {"tags": ["c++", "qt", "qml"], "comments": [{"owner": {"reputation": 367, "user_id": 8092363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CXJ0u.jpg?s=128&g=1", "display_name": "peco", "link": "https://stackoverflow.com/users/8092363/peco"}, "edited": false, "score": 0, "creation_date": 1553123320, "post_id": 55271179, "comment_id": 97274067, "body": "i added my qml files  and type List is class with QString and two integers. I use them in FirstPage.qml file like name, completed, uncompleted"}], "answers": [{"comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 367, "user_id": 8092363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CXJ0u.jpg?s=128&g=1", "display_name": "peco", "link": "https://stackoverflow.com/users/8092363/peco"}, "edited": false, "score": 0, "creation_date": 1553126500, "post_id": 55271532, "comment_id": 97274963, "body": "@Peco do not share your files separately, upload it to github to easily help you"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 367, "user_id": 8092363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CXJ0u.jpg?s=128&g=1", "display_name": "peco", "link": "https://stackoverflow.com/users/8092363/peco"}, "edited": false, "score": 0, "creation_date": 1553126677, "post_id": 55271532, "comment_id": 97275003, "body": "@Peco Checking the links I see that they are repeated files, that is, 2 different links point to the same file"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 367, "user_id": 8092363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CXJ0u.jpg?s=128&g=1", "display_name": "peco", "link": "https://stackoverflow.com/users/8092363/peco"}, "edited": false, "score": 0, "creation_date": 1553131813, "post_id": 55271532, "comment_id": 97276105, "body": "@Peco I have made a PR to your repo."}, {"owner": {"reputation": 367, "user_id": 8092363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CXJ0u.jpg?s=128&g=1", "display_name": "peco", "link": "https://stackoverflow.com/users/8092363/peco"}, "edited": false, "score": 0, "creation_date": 1553156080, "post_id": 55271532, "comment_id": 97282376, "body": "now its working.. thank you very much.. I changed my FirstPage.qml and i put everywhere before name, completed and uncompleted modelData and it is working. Tanks again"}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 0, "last_activity_date": 1553123979, "creation_date": 1553123979, "answer_id": 55271532, "question_id": 55271179, "link": "https://stackoverflow.com/questions/55271179/model-created-in-c-can-not-be-modified-from-qml/55271532#55271532", "title": "Model created in C++ can not be modified from QML", "body": "<p>The lists are a dummy model because by itself it does not notify the view if there is any change such as the number of elements, so a solution for your case is to make it a mod_controller's Q_PROPERTY, then when you add an item, the sign listChanged that will notify the view that something has changed and therefore needs to be repainted. It is not necessary to export the list separately from the controller since the Q_PROPERTY are accessible in QML, so the solution is:</p>\n\n<p><strong>modcontroller.h</strong></p>\n\n<pre><code>#ifndef MODCONTROLLER_H\n#define MODCONTROLLER_H\n\n#include &lt;QObject&gt;\n\nclass modcontroller : public QObject\n{\n    Q_OBJECT\n    Q_PROPERTY(QList&lt;QObject *&gt; lists READ getList NOTIFY listsChanged) // &lt;---\npublic:\n    explicit modcontroller(QObject *parent = nullptr);\n    QList&lt;QObject *&gt; getList() const;\n    Q_INVOKABLE void addList(const QString &amp;nam);\n    Q_SIGNAL void listsChanged();\nprivate:\n    QList&lt;QObject*&gt; m_dataList;\n};\n\n#endif // MODCONTROLLER_H\n</code></pre>\n\n<p><strong>modcontroller.cpp</strong></p>\n\n<pre><code>#include \"modcontroller.h\"\n#include \"list.h\"\n\n#include &lt;QDebug&gt;\n\nmodcontroller::modcontroller(QObject *parent) : QObject(parent)\n{\n    m_dataList.append(new List(\"Test\"));\n}\n\nQList&lt;QObject *&gt; modcontroller::getList() const\n{\n    return m_dataList;\n}\n\nvoid modcontroller::addList(const QString &amp; nam)\n{\n    m_dataList.append(new List(nam));\n    qDebug() &lt;&lt; \"Function addList called\";\n    qDebug() &lt;&lt; m_dataList;\n    Q_EMIT listsChanged(); // &lt;---\n}\n</code></pre>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include \"modcontroller.h\"\n\n#include &lt;QGuiApplication&gt;\n#include &lt;QQmlApplicationEngine&gt;\n#include &lt;QQmlContext&gt;\n\nint main(int argc, char *argv[])\n{\n    QCoreApplication::setAttribute(Qt::AA_EnableHighDpiScaling);\n\n    QGuiApplication app(argc, argv);\n\n    QQmlApplicationEngine engine;\n    modcontroller controller;\n    engine.rootContext()-&gt;setContextProperty(\"controller\",&amp;controller);\n    engine.load(QUrl(QStringLiteral(\"qrc:/main.qml\")));\n    if (engine.rootObjects().isEmpty())\n        return -1;\n\n    return app.exec();\n}\n</code></pre>\n\n<p>In the case of QML, the binding is done with the Q_PROPERTY list of controller:</p>\n\n<pre><code>ListView{\n    // ...\n    model: controller.lists // &lt;---\n    // ...\n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 8092363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CXJ0u.jpg?s=128&g=1", "display_name": "peco", "link": "https://stackoverflow.com/users/8092363/peco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 55271532, "answer_count": 1, "score": 2, "last_activity_date": 1553156476, "creation_date": 1553121382, "last_edit_date": 1553156476, "question_id": 55271179, "link": "https://stackoverflow.com/questions/55271179/model-created-in-c-can-not-be-modified-from-qml", "title": "Model created in C++ can not be modified from QML", "body": "<p>SOLVED: I did everything like eyllanesc answer and in my FirstPage.qml inside \ndelegate where i access model data i put modelData before names. \nPreviously  inside FirstPage.qml delegate i used: name, completed and \nuncompleted and now i use modelData.name, modelData.completed and \nmodelData.uncompleted. It is all fine now.</p>\n\n<p>I'm completely new in the QT/QML and I tried  but  could not find an answer for  my problem.</p>\n\n<p>I use model (created in c++) in QML. When app starts everything is fine but when i try to add new element to model it is not displayed in QML. Model is the same like from the start.</p>\n\n<p>I have class modcontroller and inside it i create list.</p>\n\n<p>modcontroller.h</p>\n\n<pre><code>#ifndef MODCONTROLLER_H\n#define MODCONTROLLER_H\n\n#include &lt;QObject&gt;\n#include &lt;list.h&gt;\n\nclass modcontroller : public QObject\n{\n    Q_OBJECT\n\npublic:\n    explicit modcontroller(QObject *parent = nullptr);\n\n    QList&lt;QObject*&gt; getList();\n\n    Q_INVOKABLE void addList(QString nam);\n\nsignals:\n    void listChanged();\n\npublic slots:\n\nprivate:\n    QList&lt;QObject*&gt; m_dataList;\n};\n\n#endif // MODCONTROLLER_H\n</code></pre>\n\n<p>modcontroller.cpp</p>\n\n<pre><code>#include \"modcontroller.h\"\n#include &lt;QDebug&gt;\n\nmodcontroller::modcontroller(QObject *parent) : QObject(parent)\n{\n    m_dataList.append(new List(\"Test\"));\n}\n\nQList&lt;QObject *&gt; modcontroller::getList()\n{\n    return m_dataList;\n}\n\nvoid modcontroller::addList(QString nam)\n{\n    m_dataList.append(new List(nam));\n    qDebug() &lt;&lt; \"Function addList called\";\n\n    qDebug() &lt;&lt; m_dataList;\n}\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include &lt;QGuiApplication&gt;\n#include &lt;QQmlApplicationEngine&gt;\n#include &lt;QQmlContext&gt;\n\n#include \"list.h\"\n#include \"modcontroller.h\"\n\nint main(int argc, char *argv[])\n{\n    QCoreApplication::setAttribute(Qt::AA_EnableHighDpiScaling);\n\n    QGuiApplication app(argc, argv);\n\n\n    QQmlApplicationEngine engine;\n\n\n    modcontroller controller;\n    engine.rootContext()-&gt;setContextProperty(\"myModel\", QVariant::fromValue(controller.getList()));\n    engine.rootContext()-&gt;setContextProperty(\"controller\",&amp;controller);\n\n    engine.load(QUrl(QStringLiteral(\"qrc:/main.qml\")));\n    if (engine.rootObjects().isEmpty())\n        return -1;\n\n\n\n    return app.exec();\n}\n</code></pre>\n\n<p>In QML file  i have ListView with <code>model: myModel</code>, and button with </p>\n\n<pre><code>onClicked: {\n                controller.addList(textInput.text)\n                myStackView.push(firstPage)\n            }\n</code></pre>\n\n<p>When i click create i see only the first item \"Test\" that is created in the start but in the console i get this:</p>\n\n<pre><code>Function addList called\n(List(0x2b7e60bc2c0), List(0x2b82d5891b0))\n</code></pre>\n\n<p>Thanks in advance.</p>\n\n<p>main.qml</p>\n\n<pre><code>    ApplicationWindow {\n        visible: true\n        width: 580\n        height: 360\n        title: qsTr(\"Hello World\")\n\n        StackView{\n            id: myStackView\n            initialItem: firstPage\n            anchors.fill: parent\n        }\n\n        Component{\n            id: firstPage\n            FirstPage{}\n        }\n\n        Component{\n            id: createNewListPage\n            CreateNewListPage{}\n        }\n\n    }\n</code></pre>\n\n<p>FirstPage.qml</p>\n\n<pre><code>Item {    \n    ListView{\n                id: lists\n                width: 150\n                height: childrenRect.height\n                x: 15\n                y: 70\n\n                model: myModel\n\n                delegate: Row{\n                    width: 150\n                    height: 25\n                    spacing: 5\n\n                    Rectangle{\n                        width: {\n                            if(uncompleted &lt; 3){return 3;}\n                            else if(uncompleted &lt; 6){return 6;}\n                            else {return 10;}\n                        }\n                        height: {\n                            if(uncompleted &lt; 3){return 3;}\n                            else if(uncompleted &lt; 6){return 6;}\n                            else {return 10;}\n                        }\n                        radius: 10\n                        color: \"#494949\"\n                        anchors.verticalCenter: parent.verticalCenter\n                    }\n                    Button {\n                        id:button1\n                        height: 23\n\n                        contentItem: Text {\n                            id: textTask\n                            text: name\n                            font.underline: true\n                            color: \"blue\"\n                            font.bold: true\n                            font.pointSize: 10\n                            height: 20\n                            anchors.verticalCenter: parent.verticalCenter\n                            anchors.left: parent.left\n                        }\n\n                        background: Rectangle {\n                            id: rectangle\n                            color: \"transparent\"\n                        }\n                        states:[\n                            State {\n                                name: \"Hovering\"\n                                PropertyChanges {\n                                    target: textTask\n                                    color: \"white\"\n                                    font.bold: true\n                                    font.underline: false\n                                }\n                                PropertyChanges {\n                                    target: rectangle\n                                    color: \"blue\"\n                                }\n                            }]\n\n                        MouseArea{\n                            hoverEnabled: true\n                            anchors.fill: button1\n                            onEntered: { button1.state='Hovering'}\n                            onExited: { button1.state=''}\n                        }\n                    }\n                    Text{\n                        font.pointSize: 8\n                        text: {\n                            if(uncompleted == 0)return \"\";\n                            return \"- \" + uncompleted + \" left\";\n                        }\n                        color: \"#494949\"\n                        anchors.verticalCenter: parent.verticalCenter\n                    }\n                }\n            }\n}\n</code></pre>\n\n<p>CreateNewListPage.qml</p>\n\n<pre><code>Item {\n   Rectangle{\n       width: 580\n       height: 360\n\n       Rectangle{\n        width: 350\n        height: 30\n        y: 100\n        x: 30\n        border.color: \"#7b9cd3\"\n        border.width: 1\n\n        TextInput {\n            id: textInput\n            anchors.topMargin: 3\n            cursorVisible: true\n            anchors.fill: parent\n            font.bold: true\n            font.pointSize: 14\n        }\n\n    }\n\n\n\n       Button{\n                height: 20\n                text: \"Create this list\"\n                onClicked: {\n                    controller.addList(textInput.text)\n                    myStackView.push(firstPage)\n                }\n\n                background: Rectangle{\n                    id: rect1\n                    anchors.fill: parent\n                    radius: 20\n                    border.color: \"#88b6cf\"\n                    gradient: Gradient {\n                            GradientStop { position: 0.0; color: \"#fcfefe\" }\n                            GradientStop { position: 1.0; color: \"#d5e8f3\" }\n                    }\n                }\n\n            }\n\n     }\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "overloading"], "comments": [{"owner": {"reputation": 73, "user_id": 3880248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f58c6804637d73c2c6b6c67bff635ad?s=128&d=identicon&r=PG&f=1", "display_name": "user3880248", "link": "https://stackoverflow.com/users/3880248/user3880248"}, "edited": false, "score": 0, "creation_date": 1553123183, "post_id": 55271110, "comment_id": 97274024, "body": "Sorry I had to make a change:Method 1 is const"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 3880248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f58c6804637d73c2c6b6c67bff635ad?s=128&d=identicon&r=PG&f=1", "display_name": "user3880248", "link": "https://stackoverflow.com/users/3880248/user3880248"}, "edited": false, "score": 0, "creation_date": 1553123332, "post_id": 55271274, "comment_id": 97274073, "body": "(please see edits) Thanks, but thats not the behavour  i see. Method 2 gets invoked in my case"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 73, "user_id": 3880248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f58c6804637d73c2c6b6c67bff635ad?s=128&d=identicon&r=PG&f=1", "display_name": "user3880248", "link": "https://stackoverflow.com/users/3880248/user3880248"}, "edited": false, "score": 0, "creation_date": 1553131231, "post_id": 55271274, "comment_id": 97275974, "body": "@user3880248 - I see... yes: if method 1 is <code>const</code>, it&#39;s different: the template method become a better match. In this case, you can follows the Jarod42&#39;s suggestions (static cast or SFINAE) or also the Wanderer way (make <code>const</code> also the template method) or simply call <code>GetVal()</code>, in <code>main()</code> using <code>static_const</code>: <code>std::cout &lt;&lt; static_cast&lt;A const&gt;(obj).GetVal(false) &lt;&lt; std::endl;</code>"}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 3, "last_activity_date": 1553165372, "last_edit_date": 1553165372, "creation_date": 1553122109, "answer_id": 55271274, "question_id": 55271110, "link": "https://stackoverflow.com/questions/55271110/invoking-and-overloaded-template-function/55271274#55271274", "title": "Invoking and overloaded template function", "body": "<blockquote>\n  <p>In the main() function, I want to invoke method1 and not method2. How can I achieve this? Thanks for reading</p>\n</blockquote>\n\n<p>And it's exactly what you get calling</p>\n\n<pre><code>obj.GetVal(false)\n</code></pre>\n\n<p>because <code>false</code> is a <code>bool</code> so it's an exact match for the not-template method. And when a call matches with a template method and a not template method, the not-template method (in case of <strong>exact</strong> match) is preferred.</p>\n\n<p>The real problem is: how to invoke the method2 calling it with the type (<code>bool</code>) of the not template method (method 1) ?</p>\n\n<p>The answer (a possible answer) is: add a <code>template</code> calling it</p>\n\n<pre><code>obj.template GetVal(false)\n</code></pre>\n\n<p>The following is a full working example</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct A\n {\n   //Lets call this method 1\n   int GetVal (bool)\n    { return 1; }\n\n   //Lets call this method 2\n   template &lt;typename T&gt;\n   int GetVal (T)\n    { return 2; }\n };\n\nint main ()\n {\n   A obj;\n\n   std::cout &lt;&lt; obj.GetVal(false) &lt;&lt; std::endl;           // print 1\n   std::cout &lt;&lt; obj.template GetVal(false) &lt;&lt; std::endl;  // print 2\n }\n</code></pre>\n\n<p><strong>-- EDIT --</strong></p>\n\n<p>Given that the OP precise that method 1 is <code>const</code> (and method 2 isn't), method 2 become the better match.</p>\n\n<p>The problem can be solved modifying <code>A</code> as in Jarod42's answer (adding a not-const not-template method that call the const method or SFINAE disabling the template method 2 when <code>T</code> is <code>bool</code>) or as in Wanderer's answer (making <code>const</code> also method 2).</p>\n\n<p>But if you don't wont (or if you can't) modify the class <code>A</code>, you can simply use <code>static_assert()</code> directly in <code>main()</code></p>\n\n<pre><code>std::cout &lt;&lt; static_cast&lt;A const &amp;&gt;(obj).GetVal(false) &lt;&lt; std::endl;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 1, "last_activity_date": 1553124135, "creation_date": 1553124135, "answer_id": 55271557, "question_id": 55271110, "link": "https://stackoverflow.com/questions/55271110/invoking-and-overloaded-template-function/55271557#55271557", "title": "Invoking and overloaded template function", "body": "<p>You might add extra overload:</p>\n\n<pre><code>class A{\npublic:\n    // Lets call this method 1\n    int GetVal(bool isCondition) const { /* do something and return val */ }\n    int GetVal(bool b) { return static_cast&lt;const A&amp;&gt;(*this).GetVal(); }\n\n    // Lets call this method 2\n    template&lt;typename T&gt;\n    int GetVal(T expression) { /* do something using expression and return val */ }}\n};\n</code></pre>\n\n<p>Or use SFINAE for method2 to discard <code>bool</code> parameter:</p>\n\n<pre><code>class A{\npublic:\n    // Lets call this method 1\n    int GetVal(bool isCondition) const { /* do something and return val */ }\n\n    // Lets call this method 2\n    template &lt;typename T, std::enable_if_t&lt;!std::is_same&lt;bool, T&gt;::value&gt;, int&gt; = 0&gt;\n    int GetVal(T expression) { /* do something using expression and return val */ }}\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127, "user_id": 8402172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60302726b8bad4556ba90d52fe8ee68a?s=128&d=identicon&r=PG&f=1", "display_name": "Wanderer", "link": "https://stackoverflow.com/users/8402172/wanderer"}, "is_accepted": false, "score": 1, "last_activity_date": 1553129030, "last_edit_date": 1553129030, "creation_date": 1553128352, "answer_id": 55272083, "question_id": 55271110, "link": "https://stackoverflow.com/questions/55271110/invoking-and-overloaded-template-function/55272083#55272083", "title": "Invoking and overloaded template function", "body": "<p>I know only 2 choices</p>\n\n<ol>\n<li><p>Use all overloads as const</p>\n\n<pre><code>//Lets call this method 1\nint GetVal(bool isCondition) const\n{ /*do something and return val*/ }\n\n//Lets call this method 2\ntemplate&lt;typename T&gt;\nint GetVal(T expression) const\n{ /*do something using expression and return val*/ }\n</code></pre></li>\n<li><p>or as non const</p>\n\n<pre><code>//Lets call this method 1\nint GetVal(bool isCondition)\n{ /*do something and return val*/ }\n\n//Lets call this method 2\ntemplate&lt;typename T&gt;\nint GetVal(T expression)\n{ /*do something using expression and return val*/ }\n</code></pre></li>\n</ol>\n\n<p>Then Method 1 will be invoked</p>\n\n<pre><code>   std::cout &lt;&lt; obj.GetVal(false) &lt;&lt; std::endl;\n</code></pre>\n\n<p>If you need Method 1 const use Jarod42 second example. It is wokring</p>\n\n<pre><code>template &lt;typename T, std::enable_if_t&lt;!std::is_same&lt;bool, T&gt;::value&gt; = 0 &gt;\nint GetVal(T expression)\n{ /*do something using expression and return val*/ }\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 3880248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f58c6804637d73c2c6b6c67bff635ad?s=128&d=identicon&r=PG&f=1", "display_name": "user3880248", "link": "https://stackoverflow.com/users/3880248/user3880248"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "answer_count": 3, "score": 3, "last_activity_date": 1553165372, "creation_date": 1553120981, "last_edit_date": 1553123120, "question_id": 55271110, "link": "https://stackoverflow.com/questions/55271110/invoking-and-overloaded-template-function", "title": "Invoking and overloaded template function", "body": "<p>Assuming I have 2 overloaded methods in a class shown below\nPlease ignore the need for such a weird overloading of methods it is something I came across recently</p>\n\n<pre><code>    class A{\n      public:\n\n        //Lets call this method 1\n        int GetVal(bool isCondition) const\n        {\n             //do something and return val\n        }\n\n        //Lets call this method 2\n        template&lt;typename T&gt;\n        int GetVal(T expression)\n        {\n            //do something using expression\n            //and return val\n        }\n\n    };\n\nint main()\n{\n    A obj;\n    int val = obj.GetVal(false) &lt;&lt; std::endl; //I want to invoke method 1\n}\n</code></pre>\n\n<p>In the <code>main()</code> function, I want to invoke method1 and not method2.\nHow can I achieve this?\nThanks for reading</p>\n"}, {"tags": ["c++", "observer-pattern", "nios"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553120390, "post_id": 55270910, "comment_id": 97273204, "body": "You may want to add a forward reference for <code>Observer</code> above <code>class Subject</code> definition."}, {"owner": {"reputation": 157, "user_id": 8926626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c5215b8b5579063c1d050ea1181fe17?s=128&d=identicon&r=PG&f=1", "display_name": "hippoman", "link": "https://stackoverflow.com/users/8926626/hippoman"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553120592, "post_id": 55270910, "comment_id": 97273264, "body": "what does that mean? sorry im relatively new to this"}, {"owner": {"reputation": 157, "user_id": 8926626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c5215b8b5579063c1d050ea1181fe17?s=128&d=identicon&r=PG&f=1", "display_name": "hippoman", "link": "https://stackoverflow.com/users/8926626/hippoman"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553120733, "post_id": 55270910, "comment_id": 97273312, "body": "if i switch them around then I just get the same thing in Observer with Subject. Is there anyway around this?"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553121716, "post_id": 55270910, "comment_id": 97273600, "body": "a forward declaration is simply the line <code>class Observer;</code> placed above the <code>class Subject { ... </code> definition.  This essentially tells the compiler to treat <code>Observer</code> as a class type ... the compiler won&#39;t know the size of the type or be able to access members of it yet (until it sees the definition of the class), but it will know the size of a pointer to the Observer class.  So you can define a vector that holds <code>Observer *</code> without the full Observer class definition."}], "answers": [{"tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1553120611, "creation_date": 1553120611, "answer_id": 55271047, "question_id": 55270910, "link": "https://stackoverflow.com/questions/55270910/im-getting-an-error-type-observer-could-not-be-resolved-when-observer-is-a-class/55271047#55271047", "title": "im getting an error type observer could not be resolved when observer is a class", "body": "<p>The problem is the order in which you declared your classes. Class <code>Subject</code> uses class <code>Observer</code> but <code>Observer</code> was declared afterwards, so when the compiler tries to compile <code>Subject</code> is doesn't know what <code>Observer</code> is. However since <code>Subject</code> also uses <code>Observer</code> you can't just switch the order of declaration around.</p>\n\n<p>The answer to this puzzle is to <em>forward declare</em> class <code>Observer</code> so at least the compiler knows that <code>Observer</code> is a class, even if it doesn't know much about it. Add <code>class Observer;</code> before your <code>class Subject</code> definition.\nYou can also remove the word <code>class</code> from your vector declaration.</p>\n\n<pre><code>class Observer;\n\nclass Subject {\n    // 1. \"independent\" functionality\n    vector &lt; Observer * &gt; views; // 3. Coupled only to \"interface\"\n    ...\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 8926626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c5215b8b5579063c1d050ea1181fe17?s=128&d=identicon&r=PG&f=1", "display_name": "hippoman", "link": "https://stackoverflow.com/users/8926626/hippoman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553120611, "creation_date": 1553119866, "question_id": 55270910, "link": "https://stackoverflow.com/questions/55270910/im-getting-an-error-type-observer-could-not-be-resolved-when-observer-is-a-class", "title": "im getting an error type observer could not be resolved when observer is a class", "body": "<p>I am having an issue using pre-written obvserver design pattern code for C++. In the attach method, it is saying type Observer cannot be resolved when I have it declared as a class. Can anyone please help me trouble shoot this? I am also having another issue with views.push_back in this method. It is throwing an error \"Invalid arguments, candidates are void push_back(Observer * const &amp;)\". I am new to C++ and don't quite understand these errors.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\nclass Subject {\n    // 1. \"independent\" functionality\n    vector &lt; class Observer * &gt; views; // 3. Coupled only to \"interface\"\n    int value;\n  public:\n    void attach(Observer *obs) {\n        views.push_back(obs);\n    }\n    void setVal(int val) {\n        value = val;\n        notify();\n    }\n    int getVal() {\n        return value;\n    }\n    void notify();\n};\n\nclass Observer {\n    // 2. \"dependent\" functionality\n    Subject *model;\n    int denom;\n  public:\n    Observer(Subject *mod, int div) {\n        model = mod;\n        denom = div;\n        // 4. Observers register themselves with the Subject\n        model-&gt;attach(this);\n    }\n    virtual void update() = 0;\n  protected:\n    Subject *getSubject() {\n        return model;\n    }\n    int getDivisor() {\n        return denom;\n    }\n};\n\nvoid Subject::notify() {\n  // 5. Publisher broadcasts\n  for (int i = 0; i &lt; views.size(); i++)\n    views[i]-&gt;update();\n}\n\nclass DivObserver: public Observer {\n  public:\n    DivObserver(Subject *mod, int div): Observer(mod, div){}\n    void update() {\n        // 6. \"Pull\" information of interest\n        int v = getSubject()-&gt;getVal(), d = getDivisor();\n        cout &lt;&lt; v &lt;&lt; \" div \" &lt;&lt; d &lt;&lt; \" is \" &lt;&lt; v / d &lt;&lt; '\\n';\n    }\n};\n\nclass ModObserver: public Observer {\n  public:\n    ModObserver(Subject *mod, int div): Observer(mod, div){}\n    void update() {\n        int v = getSubject()-&gt;getVal(), d = getDivisor();\n        cout &lt;&lt; v &lt;&lt; \" mod \" &lt;&lt; d &lt;&lt; \" is \" &lt;&lt; v % d &lt;&lt; '\\n';\n    }\n};\n</code></pre>\n"}, {"tags": ["c++", "winapi"], "comments": [{"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1553126744, "post_id": 55270820, "comment_id": 97275026, "body": "You&#39;re running in an infinite busy loop, I&#39;m not surprised the console misbehaves."}, {"owner": {"reputation": 9, "user_id": 11234524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9a2aadc039934d290623a81455a1cae?s=128&d=identicon&r=PG&f=1", "display_name": "jmicjm", "link": "https://stackoverflow.com/users/11234524/jmicjm"}, "reply_to_user": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1553147679, "post_id": 55270820, "comment_id": 97279453, "body": "It misbehaves even if these functions are called once a second."}, {"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 1, "creation_date": 1553170015, "post_id": 55270820, "comment_id": 97289830, "body": "Modifying the scrollbars probably cancels the modal resizing loop. What you&#39;re doing is not supported. The console window isn&#39;t &quot;yours&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 6168, "user_id": 10611792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r727s.jpg?s=128&g=1", "display_name": "Drake Wu", "link": "https://stackoverflow.com/users/10611792/drake-wu"}, "is_accepted": false, "score": 0, "last_activity_date": 1553654550, "creation_date": 1553654550, "answer_id": 55369004, "question_id": 55270820, "link": "https://stackoverflow.com/questions/55270820/hide-scrollbars-in-old-windows-consolepre-windows-10-one/55369004#55369004", "title": "Hide scrollbars in old windows console(pre windows 10 one)", "body": "<p>Generally the hWnd of a console window is not guaranteed to be suitable for all window handle operations as, for example, documented <a href=\"https://support.microsoft.com/en-us/help/124103/how-to-obtain-a-console-window-handle-hwnd\" rel=\"nofollow noreferrer\">here</a>. \nIt is not a \"real window\", So you can't expect its behavior.</p>\n"}], "owner": {"reputation": 9, "user_id": 11234524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9a2aadc039934d290623a81455a1cae?s=128&d=identicon&r=PG&f=1", "display_name": "jmicjm", "link": "https://stackoverflow.com/users/11234524/jmicjm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553654550, "creation_date": 1553119314, "last_edit_date": 1553160095, "question_id": 55270820, "link": "https://stackoverflow.com/questions/55270820/hide-scrollbars-in-old-windows-consolepre-windows-10-one", "title": "Hide scrollbars in old windows console(pre windows 10 one)", "body": "<p>I have a problem with hiding scrollbars in an old Windows console while simultaneously allowing the console to being resized.  My code works on a new console, but on an old console:</p>\n\n<ol>\n<li><p>it works, but prevents the console window from being resized to a larger size(attempt a).</p></li>\n<li><p>scrollbars start behaving incorrectly after window resizing. They sometimes are hidden, sometimes only one is hidden, and sometimes one is cut in half(attempt b).</p></li>\n</ol>\n\n<p>Here is my code:</p>\n\n<pre><code>#include \"windows.h\"\n\nint main()\n{\n    HANDLE console_handle = GetStdHandle(STD_OUTPUT_HANDLE);\n\n    for (;;)\n    {\n\n        // attempt a)\n        /*CONSOLE_SCREEN_BUFFER_INFO buffer_info;\n        GetConsoleScreenBufferInfo(console_handle, &amp;buffer_info);\n\n        SetConsoleScreenBufferSize(\n            console_handle,\n            { buffer_info.srWindow.Right - buffer_info.srWindow.Left + 1, buffer_info.srWindow.Bottom - buffer_info.srWindow.Top + 1 }\n        );*/\n\n\n        //attempt b)\n        HWND w = GetConsoleWindow();\n        ShowScrollBar(w, SB_BOTH, FALSE);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "std", "atomic", "std-pair", "stdatomic"], "comments": [{"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 1, "creation_date": 1553119347, "post_id": 55270735, "comment_id": 97272835, "body": "Are you compiling in C++17 mode, or something earlier?"}, {"owner": {"reputation": 43107, "user_id": 3953764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd168106a67cbd805c107cba3252caa?s=128&d=identicon&r=PG", "display_name": "Piotr Skotnicki", "link": "https://stackoverflow.com/users/3953764/piotr-skotnicki"}, "edited": false, "score": 1, "creation_date": 1553119759, "post_id": 55270735, "comment_id": 97272987, "body": "<code>{std::piecewise_construct, std::make_tuple(true), std::make_tuple(1)}</code> for a copy-initialization context"}, {"owner": {"reputation": 173, "user_id": 11234589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050006e2ec4960ebd4b5a96d3fce6eea?s=128&d=identicon&r=PG&f=1", "display_name": "Rick D", "link": "https://stackoverflow.com/users/11234589/rick-d"}, "edited": false, "score": 0, "creation_date": 1553181582, "post_id": 55270735, "comment_id": 97297344, "body": "I&#39;m compiling with c++14"}, {"owner": {"reputation": 173, "user_id": 11234589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050006e2ec4960ebd4b5a96d3fce6eea?s=128&d=identicon&r=PG&f=1", "display_name": "Rick D", "link": "https://stackoverflow.com/users/11234589/rick-d"}, "reply_to_user": {"reputation": 43107, "user_id": 3953764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd168106a67cbd805c107cba3252caa?s=128&d=identicon&r=PG", "display_name": "Piotr Skotnicki", "link": "https://stackoverflow.com/users/3953764/piotr-skotnicki"}, "edited": false, "score": 0, "creation_date": 1553202761, "post_id": 55270735, "comment_id": 97307993, "body": "@PiotrSkotnicki Do you know how that would work with a std::vector? E.g. I have a vector of atomics, and I want to emplace one back. I can&#39;t do this because of a compiler bug:  std::vector&lt;std::atomic&lt;bool&gt;&gt; atomics; atomics.emplace_back(true);"}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 11234589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050006e2ec4960ebd4b5a96d3fce6eea?s=128&d=identicon&r=PG&f=1", "display_name": "Rick D", "link": "https://stackoverflow.com/users/11234589/rick-d"}, "edited": false, "score": 0, "creation_date": 1553186803, "post_id": 55270817, "comment_id": 97300585, "body": "I don&#39;t have access to C++17, so I haven&#39;t tried the second option, but the first option doesn&#39;t work for me unfortunately. I get  /usr/include/c++/5.5.0/bits/stl_pair.h:139:45: error: use of deleted function &#39;std::atomic&lt;bool&gt;::atomic(const std::atomic&lt;bool&gt;&amp;)&#39;                                                                                                             : first(__x), second(std::forward&lt;_U2&gt;(__y)) { }"}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "reply_to_user": {"reputation": 173, "user_id": 11234589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050006e2ec4960ebd4b5a96d3fce6eea?s=128&d=identicon&r=PG&f=1", "display_name": "Rick D", "link": "https://stackoverflow.com/users/11234589/rick-d"}, "edited": false, "score": 1, "creation_date": 1553187309, "post_id": 55270817, "comment_id": 97300869, "body": "@RickD That seems like a bug to me. I don&#39;t know what your version of <code>stl_pair.h</code> looks like, but I would guess that the wrong constructor is being selected. To work around this, you could try the <code>piecewise_construct</code> technique mentioned in the comments."}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "reply_to_user": {"reputation": 173, "user_id": 11234589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050006e2ec4960ebd4b5a96d3fce6eea?s=128&d=identicon&r=PG&f=1", "display_name": "Rick D", "link": "https://stackoverflow.com/users/11234589/rick-d"}, "edited": false, "score": 1, "creation_date": 1553189087, "post_id": 55270817, "comment_id": 97301896, "body": "@RickD It looks like the bug was introduced <a href=\"https://github.com/gcc-mirror/gcc/commit/fe03d4d8ecf57e389d915b5b652d2e8d4ad884eb\" rel=\"nofollow noreferrer\">here</a> and fixed <a href=\"https://github.com/gcc-mirror/gcc/commit/d3c64041b32b6962ad6b2d879231537a477631fb\" rel=\"nofollow noreferrer\">here</a>; unfortunately I guess it didn&#39;t make it into the 5.5.0 release."}, {"owner": {"reputation": 173, "user_id": 11234589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050006e2ec4960ebd4b5a96d3fce6eea?s=128&d=identicon&r=PG&f=1", "display_name": "Rick D", "link": "https://stackoverflow.com/users/11234589/rick-d"}, "edited": false, "score": 0, "creation_date": 1553194845, "post_id": 55270817, "comment_id": 97304665, "body": "Ah that&#39;s unfortunate. I knew this had to be possible, thanks for following up on this. I guess I&#39;ll mark this one solved."}], "tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": true, "score": 8, "last_activity_date": 1553119289, "creation_date": 1553119289, "answer_id": 55270817, "question_id": 55270735, "link": "https://stackoverflow.com/questions/55270735/how-do-you-create-a-stdpair-containing-a-stdatomic/55270817#55270817", "title": "How do you create a std::pair containing a std::atomic?", "body": "<p>You can do:</p>\n\n<pre><code>std::pair&lt;std::atomic&lt;bool&gt;, int&gt; p(true, 1);\n</code></pre>\n\n<p>This uses <code>true</code> to initialize the atomic first member, without any extraneous copies or moves. In C++17, guaranteed copy elision also allows you to write:</p>\n\n<pre><code>auto p = std::pair&lt;std::atomic&lt;bool&gt;, int&gt;(true, 1);\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 11234589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050006e2ec4960ebd4b5a96d3fce6eea?s=128&d=identicon&r=PG&f=1", "display_name": "Rick D", "link": "https://stackoverflow.com/users/11234589/rick-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 771, "favorite_count": 0, "accepted_answer_id": 55270817, "answer_count": 1, "score": 7, "last_activity_date": 1553119289, "creation_date": 1553118749, "question_id": 55270735, "link": "https://stackoverflow.com/questions/55270735/how-do-you-create-a-stdpair-containing-a-stdatomic", "title": "How do you create a std::pair containing a std::atomic?", "body": "<p>I cannot figure out how to create the following:</p>\n\n<pre><code>std::pair&lt;std::atomic&lt;bool&gt;, int&gt;\n</code></pre>\n\n<p>I always invariably get</p>\n\n<blockquote>\n  <p>/usr/include/c++/5.5.0/bits/stl_pair.h:139:45: error: use of deleted function 'std::atomic::atomic(const std::atomic&amp;)'<br>\n    : first(__x), second(std::forward&lt;_U2>(__y)) { }</p>\n</blockquote>\n\n<p>I've tried</p>\n\n<pre><code>std::pair&lt;std::atomic&lt;bool&gt;, int&gt; pair = std::make_pair(true, 1); //doesn't work\nstd::pair&lt;std::atomic&lt;bool&gt;, int&gt; pair = std::make_pair({true}, 1); //doesn't work\nstd::pair&lt;std::atomic&lt;bool&gt;, int&gt; pair = std::make_pair(std::atomic&lt;bool&gt;(true), 1); //doesn't work\nstd::pair&lt;std::atomic&lt;bool&gt;, int&gt; pair = std::make_pair(std::move(std::atomic&lt;bool&gt;(true)), 1); //doesn't work\n</code></pre>\n\n<p>I know std::atomic is non-copyable, so how are you supposed to create it in a pair? Is it just not possible?</p>\n"}, {"tags": ["c++", "mfc", "mdi", "mdichild"], "comments": [{"owner": {"reputation": 1727, "user_id": 3166476, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/tU6SH.jpg?s=128&g=1", "display_name": "lakeweb", "link": "https://stackoverflow.com/users/3166476/lakeweb"}, "edited": false, "score": 0, "creation_date": 1553117948, "post_id": 55270480, "comment_id": 97272370, "body": "You would want to use the &#39;Open Document&#39; method, even if you don&#39;t have a file for input. Then the doc manager will handle creating the Frame and View."}, {"owner": {"reputation": 1, "user_id": 11214428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a41bf4c6d6a01f4a99fbabca5225b12?s=128&d=identicon&r=PG&f=1", "display_name": "daP", "link": "https://stackoverflow.com/users/11214428/dap"}, "reply_to_user": {"reputation": 1727, "user_id": 3166476, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/tU6SH.jpg?s=128&g=1", "display_name": "lakeweb", "link": "https://stackoverflow.com/users/3166476/lakeweb"}, "edited": false, "score": 0, "creation_date": 1553118799, "post_id": 55270480, "comment_id": 97272657, "body": "@lakeweb what is the most correct way?, I have different types of data to display then graphs... or MFC List Control(goods)"}, {"owner": {"reputation": 1727, "user_id": 3166476, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/tU6SH.jpg?s=128&g=1", "display_name": "lakeweb", "link": "https://stackoverflow.com/users/3166476/lakeweb"}, "edited": false, "score": 0, "creation_date": 1553119146, "post_id": 55270480, "comment_id": 97272766, "body": "I always typically let the doc manager create the frame and view. Then it is just a few lines of code and you don&#39;t have to do extra work. How ever you derive your doc and view for a job, let the doc manager create them for you."}], "owner": {"reputation": 1, "user_id": 11214428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a41bf4c6d6a01f4a99fbabca5225b12?s=128&d=identicon&r=PG&f=1", "display_name": "daP", "link": "https://stackoverflow.com/users/11214428/dap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553117348, "creation_date": 1553117348, "question_id": 55270480, "link": "https://stackoverflow.com/questions/55270480/how-to-create-c-mdi-mfc-child-windows-using-code", "title": "How to create C++ MDI mfc child windows using code?", "body": "<p>Using MFC Wizard i have create one MDI code, how i can create a child windows using code?</p>\n\n<p>I think it's something like:</p>\n\n<pre><code>CMyAppDoc* pDoc = GetDocument();\u200b \nASSERT(pDoc);\u200b\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["c++"], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 0, "last_activity_date": 1553121091, "last_edit_date": 1553121091, "creation_date": 1553118655, "answer_id": 55270718, "question_id": 55270400, "link": "https://stackoverflow.com/questions/55270400/insert-function-is-doesnt-add-a-new-elements/55270718#55270718", "title": "insert function is doesn&#39;t add a new elements", "body": "<p>in <em>insertt</em> :</p>\n\n<blockquote>\n<pre><code>void insertt(listPtr *itemList, string nm, float cst)\n{\n\n   listPtr previousPt;\n   listPtr currentPt;\n   listPtr newPtr;\n\n   if(newPtr != NULL){\n     newPtr-&gt;name = nm;\n     newPtr-&gt;price = cst;\n     newPtr-&gt;next = *itemList;\n   }\n</code></pre>\n</blockquote>\n\n<p><em>newPtr</em> is not initialized but you compare its value to NULL then may be modify an unknown block of memory, this is an undefined behavior</p>\n\n<p>replace <code>listPtr newPtr;</code> by <code>listPtr newPtr = new listt;</code></p>\n\n<p>That comes because of <code>typedef listt* listPtr;</code> hidding the pointer, do not define <em>typedef</em> hiding pointer, this is always a source of problem </p>\n\n<p>Your way to insert the new cell is wrong, for instance if the second insert cell as a lower price than the first you have an illegal memory access. A working solution is :</p>\n\n<pre><code>void insertt(listt ** itemList, string nm, float cst)\n{\n    listt * newCell = new listt;\n\n    newCell-&gt;name = nm;\n    newCell-&gt;price = cst;\n    newCell-&gt;next = nullptr;\n\n    if (*itemList == nullptr)\n      *itemList = newCell;\n    else {\n      for (;;) {\n        if (cst &lt; (*itemList)-&gt;price) {\n          newCell-&gt;next = *itemList;\n          *itemList = newCell;\n          return;\n        }\n        if ((*itemList)-&gt;next == nullptr) {\n          (*itemList)-&gt;next = newCell;\n          return;\n        }\n        itemList = &amp;(*itemList)-&gt;next;\n      }\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>Note <em>printList</em> is erroned because the last element is never print, replace</p>\n\n<blockquote>\n<pre><code>  while(hh-&gt;next != NULL)\n</code></pre>\n</blockquote>\n\n<p>by</p>\n\n<pre><code>while(hh != NULL)\n</code></pre>\n\n<p>or better</p>\n\n<pre><code>while(hh != nullptr)\n</code></pre>\n\n<hr>\n\n<p>Your <code>struct listt</code> is defined like in C</p>\n\n<p>You need also to check your input are valid, your <code>cin &gt;&gt; x;</code> must be <code>if (! (cin &gt;&gt; x)) { ..error management .. }</code></p>\n"}], "owner": {"reputation": 19, "user_id": 10721955, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vNktb4JFUCc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hrYogHakxmY4klYr0jG0nDx6yKPA/mo/photo.jpg?sz=128", "display_name": "Aimin", "link": "https://stackoverflow.com/users/10721955/aimin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "closed_date": 1553213537, "accepted_answer_id": 55270718, "answer_count": 1, "score": -2, "last_activity_date": 1553121091, "creation_date": 1553116944, "question_id": 55270400, "link": "https://stackoverflow.com/questions/55270400/insert-function-is-doesnt-add-a-new-elements", "closed_reason": "Not suitable for this site", "title": "insert function is doesn&#39;t add a new elements", "body": "<p>I wrote a program which should to insert elements in the list compare with their costs, but it doesn't work. I enter one element and then program doesn't work. And I can't understand what's wrong.</p>\n\n<p>here is an exactly the exercise:</p>\n\n<h2>Modify the list, so elements on the list are ordered by price. New items added to the list should be inserted into the right place</h2>\n\n<pre><code>   #include &lt;iostream&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\ntypedef struct listt\n{\n    string name;\n    float price;\n    struct listt *next;\n}listt;\n\ntypedef listt* listPtr;\n\nvoid insertt(listPtr *, string, float);\nvoid printList(listPtr);\nvoid instruct();\n\nint main()\n{\n    unsigned int choice;\n    float costs;\n    string itemName;\n\n    listPtr head = NULL;\n\n    instruct();\n    cin &gt;&gt; choice;\n\n    while(choice != 3)\n    {\n        switch(choice)\n        {\n        case 1:\n            cout &lt;&lt; \"Please enter the name of the item:\" &lt;&lt; endl;\n            cin &gt;&gt; itemName;\n            cout &lt;&lt; \"Please enter the cost of item: \" &lt;&lt;endl;\n            cin &gt;&gt; costs;\n            insertt(&amp;head, itemName, costs);\n            break;\n        case 2:\n            printList(head);\n            break;\n        }\n        cout&lt;&lt;\"Choose the operation\\n\";\n        cin &gt;&gt; choice;\n    }\n\n    cout&lt;&lt;\"end of operation\";\n    return 0;\n}\n\nvoid instruct(void)\n{\n    cout&lt;&lt;\"Choose the operation\\n\" &lt;&lt; \"1.Fill the list\\n\" &lt;&lt; \"2.Print the list\\n\" &lt;&lt; \"3.End operation\\n\";\n}\n\nvoid insertt(listPtr *itemList, string nm, float cst)\n{\n\n    listPtr previousPt;\n    listPtr currentPt;\n    listPtr newPtr;\n\nif(newPtr != NULL){\n    newPtr-&gt;name = nm;\n    newPtr-&gt;price = cst;\n    newPtr-&gt;next = *itemList;\n}\n\n    previousPt = NULL;\n    currentPt = *itemList;\n\n    while(currentPt != NULL &amp;&amp; cst &gt; currentPt-&gt;price )\n    {\n        previousPt = currentPt;\n        currentPt = currentPt-&gt;next;\n    }\n\n    if(currentPt == NULL)\n    {\n        newPtr-&gt;next = *itemList;\n        *itemList = newPtr;\n    } else{\n    previousPt-&gt;next = newPtr;\n    newPtr-&gt;next = currentPt;\n    }\n}\n\nvoid printList(listPtr hh)\n{\n    while(hh-&gt;next != NULL)\n    {\n        cout &lt;&lt; hh-&gt;name &lt;&lt;\" \" &lt;&lt; hh-&gt;price&lt;&lt; endl;\n        hh = hh-&gt;next;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1553117145, "post_id": 55270376, "comment_id": 97272034, "body": "Place <code>ignore</code>s AFTER an operation that leaves unwanted stuff in the stream. If you <code>ignore</code> BEFORE an operation, you often find yourself losing data you wanted because there was nothing to <code>ignore</code>."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1553117452, "post_id": 55270376, "comment_id": 97272159, "body": "Don\u2019t mix extractors with <code>getline</code>. They fight. Instead of <code>cin &gt;&gt; userAmountSelection;</code> read the input into a string with <code>getline</code> and convert the text in the string to an <code>int</code>."}, {"owner": {"reputation": 11, "user_id": 11178511, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--tnU2BETMoY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWe5bRAfWxElrRfTRCZcsQLynaBw/mo/photo.jpg?sz=128", "display_name": "Caedus", "link": "https://stackoverflow.com/users/11178511/caedus"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1553118151, "post_id": 55270376, "comment_id": 97272447, "body": "@pete becker --- i see what youre saying and i just tried implementing that, if im doing it correctly, it gives me errors with using userAmountSelection variable. Im not longer able to use it in the UserInfo userOne [userAmountSelection]; declaration."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1553118995, "post_id": 55270376, "comment_id": 97272721, "body": "Using <code>userAmountSelection</code> for the size of an array isn\u2019t legal. Some compilers provide it as an extension."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11178511, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--tnU2BETMoY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWe5bRAfWxElrRfTRCZcsQLynaBw/mo/photo.jpg?sz=128", "display_name": "Caedus", "link": "https://stackoverflow.com/users/11178511/caedus"}, "edited": false, "score": 0, "creation_date": 1553118582, "post_id": 55270632, "comment_id": 97272600, "body": "#include &lt;limits&gt; and #include &lt;sstream&gt; are very new to me, i&#39;ll get to work learning about those tonight. thank you very much for going into such depth to not only answer the question but to explain it so well. Your time means a lot to me."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 11, "user_id": 11178511, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--tnU2BETMoY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWe5bRAfWxElrRfTRCZcsQLynaBw/mo/photo.jpg?sz=128", "display_name": "Caedus", "link": "https://stackoverflow.com/users/11178511/caedus"}, "edited": false, "score": 0, "creation_date": 1553121011, "post_id": 55270632, "comment_id": 97273388, "body": "@Caedus sstream is the header for <code>stringstream</code>, basically <code>cin</code> and <code>cout</code> that read from or write to a <code>string</code> instead of the console."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553122010, "post_id": 55270632, "comment_id": 97273689, "body": "Good point. I proceeded from the users&#39;s code and left it out. Might as well add it back in for completeness."}], "tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": false, "score": 2, "last_activity_date": 1553122111, "last_edit_date": 1592644375, "creation_date": 1553118195, "answer_id": 55270632, "question_id": 55270376, "link": "https://stackoverflow.com/questions/55270376/c-getline-and-cin-ignore-deleting-first-characters-in-strings-on-outp/55270632#55270632", "title": "C++ --- getline, and cin ignore () .deleting first characters in strings on output", "body": "<h1>The Problem</h1>\n<p>The problem is with the placement of <code>ignore</code>s to prevent the bug outlined in <a href=\"https://stackoverflow.com/questions/21567291/why-does-stdgetline-skip-input-after-a-formatted-extraction\">Why does std::getline() skip input after a formatted extraction?</a> The <code>ignore</code>s have been placed before the <code>getline</code>s, and while this solves the <code>getline</code> skipping problem, it causes the problem the Asker has encountered. There isn't always something that needs to be ignored.</p>\n<p>For example</p>\n<pre><code>cin &gt;&gt; userAmountSelection;\n</code></pre>\n<p>will leave a line ending in the stream if the user typed in the amount and then hit enter.</p>\n<pre><code>cout &lt;&lt; &quot;Please enter your first and last name: &quot;;\ncin.ignore(); // possible problem in code \ngetline (cin, userOne[i].userName, '\\n');\n</code></pre>\n<p>inside the <code>for</code> loop Would trip over this line ending if not for the <code>ignore</code>. But <code>getline </code> does not leave a newline in the stream , so the second and subsequent iterations of the loop have no newline to ignore. Part of the requiured data is <code>ignored</code> instead.</p>\n<p>After</p>\n<pre><code>cin &gt;&gt; userAmountSelection;\n</code></pre>\n<p>rather than before</p>\n<pre><code>getline (cin, userOne[i].userName, '\\n');\n</code></pre>\n<p>would be a good place to place an <code>ignore</code> so the newline is removed from the stream only after it has been left in the stream, but...</p>\n<h1>The Solution</h1>\n<p>The best way to handle this is to always read entire lines with <code>getline</code> and then parse those lines (<a href=\"https://stackoverflow.com/a/7868998/4581301\">see option 2 of this answer</a>) into the pieces you want.</p>\n<pre><code>std::string line;\nstd::getline(std::cin, line);\nstd::istringstream(line) &gt;&gt; userAmountSelection;\n</code></pre>\n<p>This always works (Note: Requires <code>#include &lt;sstream&gt;</code>) and now you only have one type of reading going on, not a game of mix-n-match where you may forget you need an <code>ignore</code>.</p>\n<p>Feel free to stop reading now.</p>\n<p>The <code>ignore</code> approach requires some extra smarts. It's not as simple as it looks, in addition to fallibility of the human memory. You should place <code>ignore</code>s AFTER an operation that leaves unwanted stuff in the stream. If you <code>ignore</code> BEFORE an operation, you often find yourself losing data you wanted because there was nothing to <code>ignore</code>.</p>\n<pre><code>std::cin &gt;&gt; userAmountSelection; // read a number\nstd::cin.ignore(); // discard the next character\n</code></pre>\n<p>Works a lot of the time, but what if the user typed in the amount and then a space and then hit enter or typed in all of the input they needed to type because they new darn well what the next prompt was? You gotta get a bit craftier.</p>\n<pre><code>std::cin &gt;&gt; userAmountSelection;\nstd::cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), '\\n');\n</code></pre>\n<p>This <code>ignore</code> annihilates everything until it hits the end of the line or runs out of space in the stream. (Note: Requires <code>#include &lt;limits&gt;</code>)</p>\n"}, {"tags": [], "owner": {"reputation": 206, "user_id": 3975468, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/P8BY2.jpg?s=128&g=1", "display_name": "impulse", "link": "https://stackoverflow.com/users/3975468/impulse"}, "is_accepted": false, "score": 0, "last_activity_date": 1604691526, "last_edit_date": 1604691526, "creation_date": 1604691158, "answer_id": 64720600, "question_id": 55270376, "link": "https://stackoverflow.com/questions/55270376/c-getline-and-cin-ignore-deleting-first-characters-in-strings-on-outp/64720600#64720600", "title": "C++ --- getline, and cin ignore () .deleting first characters in strings on output", "body": "<blockquote>\n<p>The problem i run into appears to be from cin.ignore () code. it ignores the first characters of the input strings on output.</p>\n</blockquote>\n<p>Looking at the <code>istream::ignore</code> <a href=\"http://www.cplusplus.com/reference/istream/istream/ignore/\" rel=\"nofollow noreferrer\">declaration</a></p>\n<pre><code>istream&amp; ignore (streamsize n = 1, int delim = EOF);\n</code></pre>\n<p>It will discard the first character by default.</p>\n<hr />\n<blockquote>\n<p>I have tried removing the cin.ignore (), however when i do that, the\noutput skips over the parts where the user needs to enter data and\nleaves areas blank.</p>\n</blockquote>\n<p>That's because of the <code>std::cin</code> performed which left a residual newline which was then consumed by the <code>getline</code>. You'll only need <code>ignore</code> between the <code>std::cin</code> and <code>getline</code> calls:</p>\n<pre><code>std::cin &gt;&gt; userAmountSelection;\nstd::cin.ignore(); //---\n...\nfor (int i = 0; i &lt; userAmountSelection; i++) {\n    ...\n    getline (...);\n    ...\n    getline (...)\n}\n</code></pre>\n<hr />\n<p>Also, there may be instances where you don't know if an <code>std::cin</code> will precede the <code>getline</code>. In that case, you may check if the input stream contains new line before doing <code>ignore</code>:</p>\n<pre><code>    ...\n\n    // some I/O operations happening here\n\n    ...\n\n    // ignore if there's white space\n    if (std::iswspace(std::cin.peek())) std::cin.ignore();\n\n    std::getline(std::cin, somestring);\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11178511, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--tnU2BETMoY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWe5bRAfWxElrRfTRCZcsQLynaBw/mo/photo.jpg?sz=128", "display_name": "Caedus", "link": "https://stackoverflow.com/users/11178511/caedus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1882, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1604691526, "creation_date": 1553116841, "last_edit_date": 1553132388, "question_id": 55270376, "link": "https://stackoverflow.com/questions/55270376/c-getline-and-cin-ignore-deleting-first-characters-in-strings-on-outp", "title": "C++ --- getline, and cin ignore () .deleting first characters in strings on output", "body": "<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\n\nstruct UserInfo{\n\n    string userPhoneNumber;\n    string userName ;\n    string userAddress ;\n\n};\n\n\nint main ()\n{\n    cout &lt;&lt; \"How many Entries do you want to enter?\";\n    int userAmountSelection;\n    cin &gt;&gt; userAmountSelection;\n\n    UserInfo userOne [userAmountSelection];\n\n    for (int i = 0; i &lt; userAmountSelection; i++){\n        cout &lt;&lt; \"Please enter your first and last name: \";\n        cin.ignore(); // possible problem in code \n        getline (cin, userOne[i].userName, '\\n');\n        cout &lt;&lt; \"Please Enter your address, \" &lt;&lt; userOne[i].userName &lt;&lt; \":\";\n        cin.ignore(); // possible problem in code \n        getline (cin, userOne[i].userAddress, '\\n');\n        cout &lt;&lt; \"Please enter your phone#: \";\n        cin.ignore (); // possible problem in code \n        getline (cin, userOne[i].userPhoneNumber);\n    }\n    for (int i = 0; i &lt; userAmountSelection; i++){\n        cout &lt;&lt; userOne[i].userName &lt;&lt; \"        \" &lt;&lt; \n                userOne[i].userAddress &lt;&lt; \"         \" &lt;&lt; \n                userOne[i].userPhoneNumber &lt;&lt; endl;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>As you can see its a simple code for learning structs and experimenting. The problem i run into appears to be from cin.ignore () code. it ignores the first characters of the input strings on output.   The code does compile, however input and output are skewed. </p>\n\n<p><strong><em>For example when i enter a name of Terry, it will output erry.</em></strong></p>\n\n<p>I have tried removing the <code>cin.ignore ()</code>, however when i do that, the output skips over the parts where the user needs to enter data and leaves areas blank.\nI have scoured the forums and found suggestions such as adding an argument to the <code>cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), '\\n');</code>. for example, however this does not solve the problem and only adds to the list of errors I'm experiencing. </p>\n"}, {"tags": ["c++", "polymorphism"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553117031, "post_id": 55270365, "comment_id": 97271992, "body": "My advice would be to not do this. Instead look into virtual functions and cast as a nearly-last resort."}], "answers": [{"tags": [], "owner": {"reputation": 9086, "user_id": 51292, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/dzOzG.jpg?s=128&g=1", "display_name": "Ray Tayek", "link": "https://stackoverflow.com/users/51292/ray-tayek"}, "is_accepted": false, "score": 0, "last_activity_date": 1553120162, "creation_date": 1553120162, "answer_id": 55270961, "question_id": 55270365, "link": "https://stackoverflow.com/questions/55270365/c-objected-building-function-returning-base-class-type/55270961#55270961", "title": "C++ Objected building function returning Base class type", "body": "<p>This is pretty standard, see: <a href=\"https://en.wikipedia.org/wiki/Covariant_return_type\" rel=\"nofollow noreferrer\">covariant return type</a>.</p>\n"}], "owner": {"reputation": 19, "user_id": 11064348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33fd7db1efd24d0789cb073a49f05cdf?s=128&d=identicon&r=PG&f=1", "display_name": "dogstar25", "link": "https://stackoverflow.com/users/11064348/dogstar25"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "closed_date": 1553121376, "answer_count": 1, "score": 1, "last_activity_date": 1553120162, "creation_date": 1553116786, "last_edit_date": 1553116988, "question_id": 55270365, "link": "https://stackoverflow.com/questions/55270365/c-objected-building-function-returning-base-class-type", "closed_reason": "Duplicate", "title": "C++ Objected building function returning Base class type", "body": "<p>I have been away from c++ for a long time and so am rusty, but should I be able to do this? I want to build the object and then cast it into the more specialized derived class.</p>\n\n<pre><code>#pragma once\n\nclass GameObject\n{\npublic:\n\n    GameObject();\n    virtual ~GameObject();\n\n    int x, y;\n\n}\n\nclass PlayerObject : Public GameObject\n{\n\n    PlayerObject();\n    virtual ~PlayerObject();\n\n    int x, y;\n    string name;\n\n};\n\n\nclass Game\n{\n\n    unique_ptr&lt;GameObject&gt; randomObject;\n    unique_ptr&lt;PlayerObject&gt; player;\n\n\n}\n\n#########################\n\n\n\nunique_ptr&lt;GameObject&gt; GameObjectManager::buildGameObject(string gameObjectId)\n{\n\n    unique_ptr&lt;GameObject&gt; gameObject;\n    gameObject = make_unique&lt; GameObject&gt;();\n\n    return gameObject;\n\n}\n\n\n##################################\nint main(int argc, char *args[])\n\n{\n\n\n    unique_ptr&lt;GameObject&gt; rock = gameObjectManager.buildGameObject(\"ROCK\"));\n    unique_ptr&lt;PlayerObject&gt; playerObject = dynamic_cast&lt;unique_ptr&lt;PlayerObject&gt;&gt;(Game::gameObjectManager.buildGameObject(\"PLAYER\"));\n\n\n\n}\n</code></pre>\n\n<p>Is it say to do a dynamic cast liek this. What would be the better way to go for a situation like this? Thanks</p>\n"}, {"tags": ["c++", "queue"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553116672, "post_id": 55270297, "comment_id": 97271834, "body": "Any reason you aren&#39;t using <code>std::string</code>&#39;s?"}, {"owner": {"reputation": 77, "user_id": 9476832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dffc632a55fc2e78fd49bbb40184c6e6?s=128&d=identicon&r=PG&f=1", "display_name": "CatalinC", "link": "https://stackoverflow.com/users/9476832/catalinc"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553116978, "post_id": 55270297, "comment_id": 97271973, "body": "Not really, I just used std::queue as a test in C++, since I have to do the assignment in pure C, and I wanted to test if was having the same problem with std::queue, so I didn&#39;t really change to std::string."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1553117101, "post_id": 55270297, "comment_id": 97272022, "body": "@CatalinC you need to duplicate <code>dd-&gt;d_name</code> whatever the way, see my answer"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 9476832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dffc632a55fc2e78fd49bbb40184c6e6?s=128&d=identicon&r=PG&f=1", "display_name": "CatalinC", "link": "https://stackoverflow.com/users/9476832/catalinc"}, "edited": false, "score": 0, "creation_date": 1553117228, "post_id": 55270352, "comment_id": 97272066, "body": "Thank you, using strdup worked. Oh, sorry about using char* there, I was just using std::queue to test if it was also causing me the same trouble as in C (using a queue implemented by me). If I was doing this in C++, I would have used std::string from the get go :)"}, {"owner": {"reputation": 77, "user_id": 9476832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dffc632a55fc2e78fd49bbb40184c6e6?s=128&d=identicon&r=PG&f=1", "display_name": "CatalinC", "link": "https://stackoverflow.com/users/9476832/catalinc"}, "edited": false, "score": 0, "creation_date": 1553118182, "post_id": 55270352, "comment_id": 97272455, "body": "Don&#39;t worry, I did."}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 2, "last_activity_date": 1553116982, "last_edit_date": 1592644375, "creation_date": 1553116681, "answer_id": 55270352, "question_id": 55270297, "link": "https://stackoverflow.com/questions/55270297/queue-doesnt-return-correct-values/55270352#55270352", "title": "Queue doesn&#39;t return correct values", "body": "<p>In</p>\n<blockquote>\n<pre><code>while ((dd = readdir(dirOpen)) != NULL)\n{\n   if (strcmp(dd-&gt;d_name, &quot;.&quot;) != 0 &amp;&amp; strcmp(dd-&gt;d_name, &quot;..&quot;) != 0) {\n\n     //printf(&quot;%s\\n&quot;, dd-&gt;d_name);\n     queue-&gt;push(dd-&gt;d_name);        \n</code></pre>\n</blockquote>\n<p><code>dd-&gt;d_name</code> is an array inside the returned value, typically :</p>\n<blockquote>\n<pre><code>     struct dirent {\n          ino_t          d_ino;       /* Inode number */\n          off_t          d_off;       /* Not an offset; see below */\n          unsigned short d_reclen;    /* Length of this record */\n          unsigned char  d_type;      /* Type of file; not supported\n                                         by all filesystem types */\n          char           d_name[256]; /* Null-terminated filename */\n      };\n</code></pre>\n</blockquote>\n<p>you need to duplicate it (e.g. <em>strdup</em> or use a std::string etc) because the data returned by <code>readdir()</code> may be overwritten by subsequent calls to <code>readdir()</code> for the same directory stream, and it will be freed by <em>closedir</em></p>\n<p>You are in C++ replace <code>std::queue&lt;char*&gt;* queue</code> by <code>std::queue&lt;std::string&gt;* queue</code> (or <code>std::queue&lt;std::string&gt; &amp; queue</code>) or replace <code>queue-&gt;push(dd-&gt;d_name);</code> by <code>queue-&gt;push(strdup(dd-&gt;d_name));</code></p>\n"}], "owner": {"reputation": 77, "user_id": 9476832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dffc632a55fc2e78fd49bbb40184c6e6?s=128&d=identicon&r=PG&f=1", "display_name": "CatalinC", "link": "https://stackoverflow.com/users/9476832/catalinc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 55270352, "answer_count": 1, "score": 0, "last_activity_date": 1553116982, "creation_date": 1553116455, "last_edit_date": 1553116514, "question_id": 55270297, "link": "https://stackoverflow.com/questions/55270297/queue-doesnt-return-correct-values", "title": "Queue doesn&#39;t return correct values", "body": "<p>So, basically I'm having an assignment, but that isn't the actual problem. The assignment requires me to use a list, which is fine so far. </p>\n\n<p>So the idea is the following: I'm having a function which prints the contents of a directory recursively, which works fine, but now I'm trying to get each entry saved in a queue, which I'm later gonna use for something else. The nasty part is that I push each entry (the <code>d_name</code> from the <code>dirent</code> structure) into the queue in that function, and if I print the contents of the queue directly at the end of the function, it returns fine, but if I print the results in <code>main</code>, I get also garbage.</p>\n\n<p>So my test directories look like this: </p>\n\n<pre><code>-DummyDir\n    -DummyDir2\n         -DummyDir6\n         -DummyDir7\n    -DummyDir3\n         -DummyDir8\n    -DummyDir4\n         -DummyDir9\n         -DummyDir10\n    -DummyDir5\n         -DummyDir11\n         -DummyDir12\n</code></pre>\n\n<p>My function looks like this: </p>\n\n<pre><code>void dirwrap(char* dir, std::queue&lt;char*&gt;* queue)\n{\n   DIR* dirOpen;\n\n   if(!(dirOpen = opendir(dir))){\n     printf(\"Couldn't open directory: %s\\n\", dir);\n     exit(-1);\n   }\n\n   struct dirent* dd;\n   char path[2000];\n\n   while ((dd = readdir(dirOpen)) != NULL)\n   {\n      if (strcmp(dd-&gt;d_name, \".\") != 0 &amp;&amp; strcmp(dd-&gt;d_name, \"..\") != 0) {\n\n        //printf(\"%s\\n\", dd-&gt;d_name);\n        queue-&gt;push(dd-&gt;d_name);        \n\n        sprintf(path, dir, \"%s\", sizeof(dir));\n        strcat(path, \"/\");\n        strcat(path, dd-&gt;d_name);\n        dirwrap(path, queue);\n      }\n  }\n  closedir(dirOpen);\n}\n</code></pre>\n\n<p>And if I print the contents of <code>queue</code> right after <code>closedir</code> I get a good result, like this: </p>\n\n<pre><code>DummyDir2\nDummyDir6\nDummyDir7\nDummyDir5\nDummyDir12\nDummyDir11\nDummyDir3 \nDummyDir8\nDummyDir4\nDummyDir9\nDummyDir10\n</code></pre>\n\n<p>But if I print the contents of my queue in <code>main</code>, I get this: </p>\n\n<pre><code>DummyDir2\nDummyDir9\nDummyDir10\nDummyDir5\n8\ufffd)\ufffdW\u2592\n.\nDummyDir3\n~n\ufffd\ufffdw\u2592\nDummyDir4\nDummyDir9\nDummyDir10\n</code></pre>\n\n<p>I really can't seem to understand why is actually doing this, so I would really appreciate it if you would help me. </p>\n"}, {"tags": ["c++", "mfc", "visual-c++-2010"], "comments": [{"owner": {"reputation": 1727, "user_id": 3166476, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/tU6SH.jpg?s=128&g=1", "display_name": "lakeweb", "link": "https://stackoverflow.com/users/3166476/lakeweb"}, "edited": false, "score": 1, "creation_date": 1553117491, "post_id": 55270214, "comment_id": 97272170, "body": "If you create then modaless dialog as a member and child of the CView class, everything is pretty much automatic. It will come and go with the view. Are you creating it in the frame or something? Otherwise, are you sure your crash is because of the dialog? What does the stack look like?"}, {"owner": {"reputation": 145, "user_id": 8390201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af51319263ed43525aac990b55e309a1?s=128&d=identicon&r=PG&f=1", "display_name": "Evan.zz", "link": "https://stackoverflow.com/users/8390201/evan-zz"}, "reply_to_user": {"reputation": 1727, "user_id": 3166476, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/tU6SH.jpg?s=128&g=1", "display_name": "lakeweb", "link": "https://stackoverflow.com/users/3166476/lakeweb"}, "edited": false, "score": 0, "creation_date": 1553174607, "post_id": 55270214, "comment_id": 97292632, "body": "@lakeweb I&#39;m new to this. How do i create the dialog as a member and child of the view? All i did is having CMyDialog*(extends CDialog) in the view class and call new CMyDialog(), Create() functions when i need it. Do i need to specify its parent view when i create the dialog?"}], "answers": [{"tags": [], "owner": {"reputation": 1727, "user_id": 3166476, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/tU6SH.jpg?s=128&g=1", "display_name": "lakeweb", "link": "https://stackoverflow.com/users/3166476/lakeweb"}, "is_accepted": false, "score": 0, "last_activity_date": 1553213232, "creation_date": 1553213232, "answer_id": 55290987, "question_id": 55270214, "link": "https://stackoverflow.com/questions/55270214/mfc-how-to-close-a-modeless-dialog-when-switching-views/55290987#55290987", "title": "MFC How to close a modeless dialog when switching views", "body": "<p>And, it may make more sense to do it in the frame of the view. So...</p>\n\n<p>In the .h:</p>\n\n<pre><code>class MyFrm: public CFrameWnd\n{\n    MyDialog dlg;\n};\n</code></pre>\n\n<p>in the .cpp:</p>\n\n<pre><code>MyFrm::MyFrm( )\n    :dlg( this )\n}\n\nvoid MyFrm::OnInitialUpdate()\n{\n    tagDlg.Create( this );\n    tagDlg.ShowWindow( SW_NORMAL );\n}\n</code></pre>\n\n<p>And if you would want to toggle the dialog, say with a menu item as a switch. Instead of creating it in <code>OnInitialUpdate</code>, you could:</p>\n\n<pre><code>void MyFrm::OnToggleDlg( )\n{\n    if( ! dlg.GetSafeHwnd( ) )\n    {\n        dlg.Create( this );\n        dlg.ShowWindow( SW_NORMAL );\n    }\n    else\n        dlg.DestroyWindow( );\n}\n</code></pre>\n\n<p>I hope that makes sense.</p>\n"}], "owner": {"reputation": 145, "user_id": 8390201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af51319263ed43525aac990b55e309a1?s=128&d=identicon&r=PG&f=1", "display_name": "Evan.zz", "link": "https://stackoverflow.com/users/8390201/evan-zz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553213232, "creation_date": 1553116053, "question_id": 55270214, "link": "https://stackoverflow.com/questions/55270214/mfc-how-to-close-a-modeless-dialog-when-switching-views", "title": "MFC How to close a modeless dialog when switching views", "body": "<p>I have a view that contains a modeless dialog. </p>\n\n<p>Everything works fine except interacting with the dialog sends a message to modify objects on current active view. It causes crush when i switching to a new view or another view, because the object does not exist in that new view.</p>\n\n<p>I want to ask how to close out the modeless dialog whenever the view is switched?</p>\n\n<p>Should it be handled in the view class or document class?</p>\n\n<p>The message route is Dialog ->send user defined message -> mainframe -> get current active view -> pass on the message -> view message handle receive the msg</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "cmake"], "comments": [{"owner": {"reputation": 13900, "user_id": 2020827, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e6c7105ef9148e931ad05a6692155046?s=128&d=identicon&r=PG&f=1", "display_name": "sergej", "link": "https://stackoverflow.com/users/2020827/sergej"}, "edited": false, "score": 2, "creation_date": 1553115754, "post_id": 55270056, "comment_id": 97271405, "body": "Not sure what you mean. the executable is not running at compile time."}, {"owner": {"reputation": 2938, "user_id": 1936366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f0298a41112c6940b378ca0e88c4183?s=128&d=identicon&r=PG", "display_name": "Onur A.", "link": "https://stackoverflow.com/users/1936366/onur-a"}, "reply_to_user": {"reputation": 13900, "user_id": 2020827, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e6c7105ef9148e931ad05a6692155046?s=128&d=identicon&r=PG&f=1", "display_name": "sergej", "link": "https://stackoverflow.com/users/2020827/sergej"}, "edited": false, "score": 0, "creation_date": 1553115815, "post_id": 55270056, "comment_id": 97271435, "body": "I meant the name of executable"}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1553115843, "post_id": 55270056, "comment_id": 97271451, "body": "That does not clarify sergejs doubt."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1553115844, "post_id": 55270056, "comment_id": 97271452, "body": "If I correctly understand the question, intention is to have a macro or macro-line expression, which can be used in the code and which is evaluated to the name of the executable, into which given code is compiled. Am I right?"}, {"owner": {"reputation": 2938, "user_id": 1936366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f0298a41112c6940b378ca0e88c4183?s=128&d=identicon&r=PG", "display_name": "Onur A.", "link": "https://stackoverflow.com/users/1936366/onur-a"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1553115892, "post_id": 55270056, "comment_id": 97271479, "body": "@Tsyvarev that&#39;s correct"}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1553115917, "post_id": 55270056, "comment_id": 97271490, "body": "I cannot align &quot;currently running&quot; and &quot;at compile time&quot; either. They do not go into one and the same point of time."}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1553115992, "post_id": 55270056, "comment_id": 97271532, "body": "Please provide an example of code which uses the desired construct, just to demonstrate the background/goal of the question."}, {"owner": {"reputation": 2938, "user_id": 1936366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f0298a41112c6940b378ca0e88c4183?s=128&d=identicon&r=PG", "display_name": "Onur A.", "link": "https://stackoverflow.com/users/1936366/onur-a"}, "reply_to_user": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1553116020, "post_id": 55270056, "comment_id": 97271544, "body": "@Yunnosch I want to be able to get the name(either ProjectFoo or ProjectFoo_UnitTests) in C++. Clear?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 3, "creation_date": 1553116025, "post_id": 55270056, "comment_id": 97271545, "body": "@OnurA.: Then you probably need to reformulate the question post, so it can be easily understood. Combination of &quot;executable currently running&quot; and &quot;compile time&quot; is very confusing."}, {"owner": {"reputation": 2938, "user_id": 1936366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f0298a41112c6940b378ca0e88c4183?s=128&d=identicon&r=PG", "display_name": "Onur A.", "link": "https://stackoverflow.com/users/1936366/onur-a"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1553116392, "post_id": 55270056, "comment_id": 97271693, "body": "@Tsyvarev my bad. updated the question, hope it clarifies now."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1553116566, "post_id": 55270056, "comment_id": 97271774, "body": "Yes, the question becomes much better now."}, {"owner": {"reputation": 13900, "user_id": 2020827, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e6c7105ef9148e931ad05a6692155046?s=128&d=identicon&r=PG&f=1", "display_name": "sergej", "link": "https://stackoverflow.com/users/2020827/sergej"}, "edited": false, "score": 0, "creation_date": 1553116857, "post_id": 55270056, "comment_id": 97271918, "body": "The example code, is it C++ or Preprocessor directives?"}, {"owner": {"reputation": 2938, "user_id": 1936366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f0298a41112c6940b378ca0e88c4183?s=128&d=identicon&r=PG", "display_name": "Onur A.", "link": "https://stackoverflow.com/users/1936366/onur-a"}, "reply_to_user": {"reputation": 13900, "user_id": 2020827, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e6c7105ef9148e931ad05a6692155046?s=128&d=identicon&r=PG&f=1", "display_name": "sergej", "link": "https://stackoverflow.com/users/2020827/sergej"}, "edited": false, "score": 1, "creation_date": 1553116935, "post_id": 55270056, "comment_id": 97271949, "body": "@sergej Preprocessor directive but I am fine with both options"}, {"owner": {"reputation": 13900, "user_id": 2020827, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e6c7105ef9148e931ad05a6692155046?s=128&d=identicon&r=PG&f=1", "display_name": "sergej", "link": "https://stackoverflow.com/users/2020827/sergej"}, "edited": false, "score": 0, "creation_date": 1553117840, "post_id": 55270056, "comment_id": 97272334, "body": "Why do you need the name?"}, {"owner": {"reputation": 2938, "user_id": 1936366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f0298a41112c6940b378ca0e88c4183?s=128&d=identicon&r=PG", "display_name": "Onur A.", "link": "https://stackoverflow.com/users/1936366/onur-a"}, "edited": false, "score": 1, "creation_date": 1553117994, "post_id": 55270056, "comment_id": 97272389, "body": "I have some mock headers for testing purposes, so if test configuration is being run, I want to include those mock headers"}, {"owner": {"reputation": 13900, "user_id": 2020827, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e6c7105ef9148e931ad05a6692155046?s=128&d=identicon&r=PG&f=1", "display_name": "sergej", "link": "https://stackoverflow.com/users/2020827/sergej"}, "edited": false, "score": 0, "creation_date": 1553119093, "post_id": 55270056, "comment_id": 97272749, "body": "If you need to decide whether to include headers or not then the check has to at compile time not run time."}, {"owner": {"reputation": 2938, "user_id": 1936366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f0298a41112c6940b378ca0e88c4183?s=128&d=identicon&r=PG", "display_name": "Onur A.", "link": "https://stackoverflow.com/users/1936366/onur-a"}, "edited": false, "score": 0, "creation_date": 1553119444, "post_id": 55270056, "comment_id": 97272870, "body": "Yes, then preprocessor check would be better. Thanks!"}, {"owner": {"reputation": 13900, "user_id": 2020827, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e6c7105ef9148e931ad05a6692155046?s=128&d=identicon&r=PG&f=1", "display_name": "sergej", "link": "https://stackoverflow.com/users/2020827/sergej"}, "edited": false, "score": 1, "creation_date": 1553119784, "post_id": 55270056, "comment_id": 97272996, "body": "Btw: the preprocessor &#39;==&#39; operator doesn&#39;t work with strings."}], "answers": [{"tags": [], "owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "is_accepted": false, "score": 2, "last_activity_date": 1553116473, "creation_date": 1553116473, "answer_id": 55270301, "question_id": 55270056, "link": "https://stackoverflow.com/questions/55270056/how-to-get-cmake-executable-name-in-c-preprocessor-definition/55270301#55270301", "title": "How to get CMake executable name in C++ preprocessor definition", "body": "<p>You may \"ship\" every your executable with its own macro definition. In that macro you may store the name of the executable:</p>\n\n<pre><code>target_compile_definitions(ProjectFoo executable_name=ProjectFoo)\ntarget_compile_definitions(ProjectFoo_UnitTests executable_name=ProjectFoo_UnitTests)\n</code></pre>\n\n<p>Inside the code <code>executable_name</code> may be used for extract executable's name:</p>\n\n<pre><code>#if executable_name==ProjectFoo\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13900, "user_id": 2020827, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e6c7105ef9148e931ad05a6692155046?s=128&d=identicon&r=PG&f=1", "display_name": "sergej", "link": "https://stackoverflow.com/users/2020827/sergej"}, "is_accepted": true, "score": 3, "last_activity_date": 1553119186, "last_edit_date": 1553119186, "creation_date": 1553117536, "answer_id": 55270515, "question_id": 55270056, "link": "https://stackoverflow.com/questions/55270056/how-to-get-cmake-executable-name-in-c-preprocessor-definition/55270515#55270515", "title": "How to get CMake executable name in C++ preprocessor definition", "body": "<p>If you just want to know at run time if the running executable is a unit test configuration, pass a dedicated preprocessor definition to your unit test executable:</p>\n\n<pre><code>target_compile_definitions(ProjectFoo_UnitTests IS_UNIT_TEST)\n</code></pre>\n\n<p>And check this definition in you C++ code:</p>\n\n<pre><code>#if defined (IS_UNIT_TEST)\n# include \"some_mock.hpp\"\n#endif\n</code></pre>\n"}], "owner": {"reputation": 2938, "user_id": 1936366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f0298a41112c6940b378ca0e88c4183?s=128&d=identicon&r=PG", "display_name": "Onur A.", "link": "https://stackoverflow.com/users/1936366/onur-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 55270515, "answer_count": 2, "score": 1, "last_activity_date": 1553718409, "creation_date": 1553115428, "last_edit_date": 1553718409, "question_id": 55270056, "link": "https://stackoverflow.com/questions/55270056/how-to-get-cmake-executable-name-in-c-preprocessor-definition", "title": "How to get CMake executable name in C++ preprocessor definition", "body": "<p>I have two executable definitions in my CMake file </p>\n\n<pre><code>add_executable(ProjectFoo ...)\nadd_executable(ProjectFoo_UnitTests ...)\n</code></pre>\n\n<p>Is there any way to get name of the executable(either ProjectFoo or ProjectFoo_UnitTests) in C++ code like below? Syntax might not be correct but I hope it clarifies the intention.</p>\n\n<pre><code>#if executable_name == ProjectFoo\n...\n</code></pre>\n"}, {"tags": ["c++", "sentinel"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1553114709, "post_id": 55269867, "comment_id": 97270905, "body": "You always overwrite <code>big</code> and <code>low</code> near the top of your loop."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553114761, "post_id": 55269867, "comment_id": 97270928, "body": "It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a> and <a href=\"http://idownvotedbecau.se/nodebugging/\" rel=\"nofollow noreferrer\">Debugging Guide</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1553114762, "post_id": 55269867, "comment_id": 97270929, "body": "You always set big and low at the top of your loop. Move them outside and it should work."}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1553115369, "post_id": 55269916, "comment_id": 97271224, "body": "The first problem you propose doesn&#39;t apply since <code>big</code> and <code>low</code> are intended to be set to the first value. Moving the <code>big = num;</code> and <code>low = num;</code> to just before the loop fixes the first two problems."}, {"owner": {"reputation": 1026, "user_id": 8469676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d870a9cbdcef704cebecb991662019?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertM", "link": "https://stackoverflow.com/users/8469676/albertm"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1553116382, "post_id": 55269916, "comment_id": 97271688, "body": "Depends on how you solve the problem, I chose to not set big/low to the first number at all and instead init them to min-/max-int. Updated my answer to clarify. If you choose to init them with the first <code>num</code>you are right of course."}, {"owner": {"reputation": 11435, "user_id": 6328256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PyZe2.png?s=128&g=1", "display_name": "Sash Sinha", "link": "https://stackoverflow.com/users/6328256/sash-sinha"}, "edited": false, "score": 0, "creation_date": 1553116573, "post_id": 55269916, "comment_id": 97271776, "body": "If the user enters <code>0</code> straight away won&#39;t your answer output <code>&quot;biggest number: 2147483647&quot;</code> and similarly <code>&quot;lowest number: -2147483648&quot;</code>? Also if the user enters in only positive numbers the lowest number will always be <code>0</code>."}, {"owner": {"reputation": 1026, "user_id": 8469676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d870a9cbdcef704cebecb991662019?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertM", "link": "https://stackoverflow.com/users/8469676/albertm"}, "edited": false, "score": 1, "creation_date": 1553116756, "post_id": 55269916, "comment_id": 97271879, "body": "Totally right, but the person asking the question didn&#39;t clarify what should happen in this case. Initializing big/low with num would output big and low as 0, which I would consider equally incorrect since 0 is only used to exit the program. I don&#39;t want to overcomplicate my answer with a case that isn&#39;t handled in the origial code."}], "tags": [], "owner": {"reputation": 1026, "user_id": 8469676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d870a9cbdcef704cebecb991662019?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertM", "link": "https://stackoverflow.com/users/8469676/albertm"}, "is_accepted": false, "score": 1, "last_activity_date": 1553116231, "last_edit_date": 1553116231, "creation_date": 1553114848, "answer_id": 55269916, "question_id": 55269867, "link": "https://stackoverflow.com/questions/55269867/c-sentinel-loop-store-lowest-and-biggest-number/55269916#55269916", "title": "c++ Sentinel loop, store lowest and biggest number", "body": "<p>You are always overwriting big and low in your loop with the current num..</p>\n\n<p>This can be fixed by initializing <code>big</code> and <code>low</code> once (ontside of the loop) like this:</p>\n\n<pre><code>#include &lt;limits&gt;\nint big = std::numeric_limits&lt;int&gt;::min();\nint low = std::numeric_limits&lt;int&gt;::max();\n</code></pre>\n\n<p>and by changing your loop to</p>\n\n<pre><code>while(num != 0) {\n    numtotal += num;\n    numcount++;\n\n    cout &lt;&lt; \"enter number or 0 to exit\" &lt;&lt; endl;\n    cin &gt;&gt; num;\n\n    if(num &lt; low)\n        low = num;\n    // note that this isn't in the else branch anymore\n    // to also work if num is the biggest and lowest number\n    if(num &gt; big)\n        big = num;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "is_accepted": false, "score": 1, "last_activity_date": 1553114898, "creation_date": 1553114898, "answer_id": 55269930, "question_id": 55269867, "link": "https://stackoverflow.com/questions/55269867/c-sentinel-loop-store-lowest-and-biggest-number/55269930#55269930", "title": "c++ Sentinel loop, store lowest and biggest number", "body": "<p>You are always setting them at the top of your loop. Try putting them outside the loop like this:</p>\n\n<pre><code>    cout&lt;&lt;\"enter number or 0 to exit\"&lt;&lt;endl;\n    cin&gt;&gt;num;\n\n    // move them here\n    big = num;\n    low = num;\n\n\n    while(num != 0){\n        numtotal = numtotal + num;\n        numcount++;\n\n        cout&lt;&lt;\"enter number or 0 to extit\"&lt;&lt;endl;\n        cin&gt;&gt;num;\n\n        if(num &lt; low){\n            low = num;\n        } else if(num &gt; big){\n            big = num;\n        }\n    }\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11435, "user_id": 6328256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PyZe2.png?s=128&g=1", "display_name": "Sash Sinha", "link": "https://stackoverflow.com/users/6328256/sash-sinha"}, "is_accepted": true, "score": 1, "last_activity_date": 1553116829, "last_edit_date": 1553116829, "creation_date": 1553116050, "answer_id": 55270213, "question_id": 55269867, "link": "https://stackoverflow.com/questions/55269867/c-sentinel-loop-store-lowest-and-biggest-number/55270213#55270213", "title": "c++ Sentinel loop, store lowest and biggest number", "body": "<p>You need to not set <code>big</code> and <code>low</code> to <code>num</code> if the user enters <code>0</code> inside the while loop to achieve your desired result.</p>\n\n<p>Otherwise, if you don't do this, your output lowest number will always be <code>0</code> in the case the user enters only positive numbers, which I do not think you want:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main() {\n    int num;\n    int total = 0;\n    int count = 0;\n\n    cout &lt;&lt; \"Enter number or 0 to exit\" &lt;&lt; endl;\n    cin &gt;&gt; num;\n\n    int biggest = num;\n    int lowest = num;\n\n    while (num != 0) {\n        total += num;\n        count++;\n        cout &lt;&lt; \"Enter number or 0 to exit\" &lt;&lt; endl;\n        cin &gt;&gt; num;\n        if (num != 0) {\n            if (num &lt; lowest) {\n                lowest = num;\n            } else if (num &gt; biggest) {\n                biggest = num;\n            }\n        }\n    }\n\n    cout &lt;&lt; \"Total of numbers: \" &lt;&lt; total &lt;&lt; endl;\n    cout &lt;&lt; \"Amount of numbers entered: \" &lt;&lt; count &lt;&lt; endl;\n    cout &lt;&lt; \"Biggest number: \" &lt;&lt; biggest &lt;&lt; endl;\n    cout &lt;&lt; \"Lowest number: \" &lt;&lt; lowest &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Usage:</strong></p>\n\n<pre><code>Enter number or 0 to exit\n5\nEnter number or 0 to exit\n4\nEnter number or 0 to exit\n3\nEnter number or 0 to exit\n2\nEnter number or 0 to exit\n0\nTotal of numbers: 14\nAmount of numbers entered: 4\nBiggest number: 5\nLowest number: 2\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10568815, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rzJL25Xjhpo/AAAAAAAAAAI/AAAAAAAAAz0/dUw34U_BNs0/photo.jpg?sz=128", "display_name": "Sirius 26", "link": "https://stackoverflow.com/users/10568815/sirius-26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "accepted_answer_id": 55270213, "answer_count": 3, "score": 1, "last_activity_date": 1553116829, "creation_date": 1553114647, "last_edit_date": 1553116574, "question_id": 55269867, "link": "https://stackoverflow.com/questions/55269867/c-sentinel-loop-store-lowest-and-biggest-number", "title": "c++ Sentinel loop, store lowest and biggest number", "body": "<p>here is my program:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main(){\n    int num;\n    int numtotal = 0;\n    int numcount = 0;\n    int big = 0;\n    int low = 0;\n\n    cout&lt;&lt;\"enter number or 0 to exit\"&lt;&lt;endl;\n    cin&gt;&gt;num;\n    while(num != 0){\n        numtotal = numtotal + num;\n        numcount++;\n        big = num;\n        low = num;\n\n        cout&lt;&lt;\"enter number or 0 to extit\"&lt;&lt;endl;\n        cin&gt;&gt;num;\n\n        if(num &lt; low){\n            low = num;\n        }\n        else if(num &gt; big){\n            big = num;\n        }\n    }\n\n    cout&lt;&lt;\"total of numbers: \"&lt;&lt;numtotal&lt;&lt;endl;\n    cout&lt;&lt;\"totoal of numbers entered: \"&lt;&lt;numcount&lt;&lt;endl;\n    cout&lt;&lt;\"biggest number: \"&lt;&lt;big&lt;&lt;endl;\n    cout&lt;&lt;\"lowest number: \"&lt;&lt;low&lt;&lt;endl;\n}\n</code></pre>\n\n<p>the \"low\" and \"big\" outputs are always the last 2 numbers the user inputs, for example:</p>\n\n<p><code>( 5, 4, 3, 2)</code></p>\n\n<p><code>biggest number: 2</code></p>\n\n<p><code>lowest number: 0</code></p>\n\n<p>what am I doing wrong here? thank you</p>\n"}, {"tags": ["c++", "cout"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 3, "creation_date": 1553114120, "post_id": 55269658, "comment_id": 97270573, "body": "Unrelated: <code>#include &lt;bits&#47;stdc++.h&gt; using namespace std;</code> leads me to suggest you watch different videos. That combination of bad ideas can lead to astoundingly strange errors. Read <a href=\"https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-bad-practice\">Why is \u201cusing namespace std\u201d considered bad practice?</a> and <a href=\"https://stackoverflow.com/questions/31816095/why-should-i-not-include-bits-stdc-h\">Why should I not #include &lt;bits/stdc++.h&gt;?</a> for more information on why you don&#39;t want to use either statement alone."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1553114136, "post_id": 55269658, "comment_id": 97270588, "body": "It looks okay. You say it&#39;s not printing anything at all?"}, {"owner": {"reputation": 2289, "user_id": 2356414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff4a2241e2dcfc50615e4b7c709bd17?s=128&d=identicon&r=PG", "display_name": "KABoissonneault", "link": "https://stackoverflow.com/users/2356414/kaboissonneault"}, "edited": false, "score": 0, "creation_date": 1553114265, "post_id": 55269658, "comment_id": 97270666, "body": "Are you sure your program isn&#39;t just taking very long? You&#39;re not flushing on every write, so it will only flush when the program exits"}, {"owner": {"reputation": 11, "user_id": 11234253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1219704041530225/picture?type=large", "display_name": "Salim Hertelli", "link": "https://stackoverflow.com/users/11234253/salim-hertelli"}, "edited": false, "score": 0, "creation_date": 1553114274, "post_id": 55269658, "comment_id": 97270671, "body": "YUP I did try it also on many platforms but as always no output"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1553114291, "post_id": 55269658, "comment_id": 97270679, "body": "Sorry to link my own answer as a duplicate (there are many more to find), that was just by chance findinf it via google."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553114293, "post_id": 55269658, "comment_id": 97270683, "body": "I suspect it never gets to the <code>cout</code> statement. Good odds the recursion runs off the end of the stack."}, {"owner": {"reputation": 11, "user_id": 11234253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1219704041530225/picture?type=large", "display_name": "Salim Hertelli", "link": "https://stackoverflow.com/users/11234253/salim-hertelli"}, "edited": false, "score": 0, "creation_date": 1553114337, "post_id": 55269658, "comment_id": 97270700, "body": "I know that the program should take so long to exectue( and i mean sooo long)"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 2, "creation_date": 1553114341, "post_id": 55269658, "comment_id": 97270704, "body": "ack(4,2) exceeds the limits of an int."}, {"owner": {"reputation": 2289, "user_id": 2356414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff4a2241e2dcfc50615e4b7c709bd17?s=128&d=identicon&r=PG", "display_name": "KABoissonneault", "link": "https://stackoverflow.com/users/2356414/kaboissonneault"}, "edited": false, "score": 0, "creation_date": 1553114430, "post_id": 55269658, "comment_id": 97270744, "body": "If the program is taking a while to complete, you should probably flush the stream on every print. <code>std::cout &lt;&lt; i &lt;&lt; &quot; &quot; &lt;&lt; j &lt;&lt; &quot;\\n&quot; &lt;&lt; std::flush;</code> or <code>std::cout &lt;&lt; i &lt;&lt; &quot; &quot; &lt;&lt; j &lt;&lt; std::endl;</code>"}, {"owner": {"reputation": 11, "user_id": 11234253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1219704041530225/picture?type=large", "display_name": "Salim Hertelli", "link": "https://stackoverflow.com/users/11234253/salim-hertelli"}, "edited": false, "score": 0, "creation_date": 1553114444, "post_id": 55269658, "comment_id": 97270753, "body": "here is the video for those intrested : <a href=\"https://www.youtube.com/watch?v=i7sm9dzFtEI\" rel=\"nofollow noreferrer\">youtube.com/watch?v=i7sm9dzFtEI</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553115119, "post_id": 55269658, "comment_id": 97271090, "body": "OK. Looks like the video wasn&#39;t the source of the bad advice about <code>bits</code>  and <code>using namespace std;</code>. That was all C code, but wherever you got that opener from, be careful with it. If you find yourself with a multi-page crawl of inscrutable error messages, it should be the first thing to go."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553115326, "post_id": 55269658, "comment_id": 97271196, "body": "And the program&#39;s crashing, on my PC at least, but I do get some data printed out first. That&#39;s Undefined Behaviour for you. On Alice&#39;s PC it works. On Bob&#39;s it doesn&#39;t. Except on Tuesday."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1553113926, "post_id": 55269690, "comment_id": 97270472, "body": "FWIW, <code>endl</code> doesn&#39;t just print a newline.  It also flushes the buffer."}, {"owner": {"reputation": 11, "user_id": 11234253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1219704041530225/picture?type=large", "display_name": "Salim Hertelli", "link": "https://stackoverflow.com/users/11234253/salim-hertelli"}, "edited": false, "score": 0, "creation_date": 1553114058, "post_id": 55269690, "comment_id": 97270549, "body": "It is working now . But why it is so ? because i never saw it before"}, {"owner": {"reputation": 1026, "user_id": 8469676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d870a9cbdcef704cebecb991662019?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertM", "link": "https://stackoverflow.com/users/8469676/albertm"}, "edited": false, "score": 1, "creation_date": 1553114499, "post_id": 55269690, "comment_id": 97270793, "body": "See: <a href=\"https://stackoverflow.com/questions/15042849/what-does-flushing-the-buffer-mean\">What does flushing the buffer mean</a>"}, {"owner": {"reputation": 47115, "user_id": 235354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=128&d=identicon&r=PG", "display_name": "jspcal", "link": "https://stackoverflow.com/users/235354/jspcal"}, "edited": false, "score": 0, "creation_date": 1553114614, "post_id": 55269690, "comment_id": 97270856, "body": "The output is buffered by default and won&#39;t be sent until the buffer is full or explicitly flushed. It&#39;s more efficient to write data in chunks."}], "tags": [], "owner": {"reputation": 47115, "user_id": 235354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=128&d=identicon&r=PG", "display_name": "jspcal", "link": "https://stackoverflow.com/users/235354/jspcal"}, "is_accepted": true, "score": 0, "last_activity_date": 1553113891, "creation_date": 1553113891, "answer_id": 55269690, "question_id": 55269658, "link": "https://stackoverflow.com/questions/55269658/problems-with-cout-c/55269690#55269690", "title": "Problems with cout c++", "body": "<p>You may need to explicitly flush the output stream or print a newline which may flush the buffer on some streams:</p>\n\n<pre><code>std::cout &lt;&lt; std::flush;\n\nstd::cout &lt;&lt; std::endl;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11234253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1219704041530225/picture?type=large", "display_name": "Salim Hertelli", "link": "https://stackoverflow.com/users/11234253/salim-hertelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 0, "closed_date": 1553114176, "accepted_answer_id": 55269690, "answer_count": 1, "score": -1, "last_activity_date": 1553114215, "creation_date": 1553113749, "last_edit_date": 1553114055, "question_id": 55269658, "link": "https://stackoverflow.com/questions/55269658/problems-with-cout-c", "closed_reason": "Duplicate", "title": "Problems with cout c++", "body": "<p>I was just watching a video on youtube about an akm function and i tried to implement it.<br>\nI actually wrote a  code and forgot to make spaces between the variables(for an easy reading), but the program didn't print anything but it kept on calculating.</p>\n\n<p>I thought that a similar syntax would work just fine. Is there something I am doing wrong ?<br>\nHere is the code :</p>\n\n<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\nint akm(int m,int n) {\n    if(m==0) return n+1;\n    else if(n==0) return akm(m-1,1);\n    else return akm(m-1 , akm(m,n-1));\n}\n\nint main() {\n  for(int i=0;i&lt;6;i++)\n      for(int j=0;j&lt;6;j++) {\n          cout&lt;&lt;i&lt;&lt;\" \"&lt;&lt;j ;\n          cout&lt;&lt;akm(i,j);\n      }\n }\n</code></pre>\n"}, {"tags": ["c++", "googletest"], "comments": [{"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 2, "creation_date": 1553113268, "post_id": 55269402, "comment_id": 97270152, "body": "Have a look at <a href=\"https://github.com/google/googletest/blob/master/googletest/docs/advanced.md#value-parameterized-tests\" rel=\"nofollow noreferrer\">value-parameterized tests</a>"}, {"owner": {"reputation": 839, "user_id": 1135979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59464968f70aff62c07a7da3a0f6ba80?s=128&d=identicon&r=PG", "display_name": "yachoor", "link": "https://stackoverflow.com/users/1135979/yachoor"}, "edited": false, "score": 0, "creation_date": 1553117883, "post_id": 55269402, "comment_id": 97272351, "body": "Recently function <a href=\"https://github.com/google/googletest/blob/master/googletest/include/gtest/gtest.h#L2434\" rel=\"nofollow noreferrer\">RegisterTest</a> was added in gtest.h header, which might be what you&#39;re looking for"}], "owner": {"reputation": 234, "user_id": 1434144, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7fbf244845f7b28d3af1509251502e5d?s=128&d=identicon&r=PG", "display_name": "Tyson Jacobs", "link": "https://stackoverflow.com/users/1434144/tyson-jacobs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1553115734, "creation_date": 1553112612, "last_edit_date": 1553115734, "question_id": 55269402, "link": "https://stackoverflow.com/questions/55269402/procedural-tests-in-googletest", "title": "Procedural tests in googletest?", "body": "<p>Instead of using the <code>TEST_F</code> macro, I would like to procedurally add a test. </p>\n\n<p>The use case is to implement data driven integrating testing; I want a folder of test files, and to launch a separate test for each file, with test's name being the file name. </p>\n\n<p>Can this be accomplished?</p>\n"}, {"tags": ["c++", "unique-ptr", "move-constructor"], "answers": [{"comments": [{"owner": {"reputation": 63648, "user_id": 97248, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d891ba8bd448f11617333f8642870262?s=128&d=identicon&r=PG", "display_name": "pts", "link": "https://stackoverflow.com/users/97248/pts"}, "edited": false, "score": 0, "creation_date": 1553113389, "post_id": 55269513, "comment_id": 97270204, "body": "@user4581301: Removing the <code>const</code>, but not adding <code>std::move</code> didn&#39;t make it compile for me."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1553113588, "post_id": 55269513, "comment_id": 97270312, "body": "Yeah, you need the <code>std::move</code>. An rvalue reference is itself an lvalue expression."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553113601, "post_id": 55269513, "comment_id": 97270317, "body": "Semi-brainfart on my part. it&#39;s the change from <code>emplace_back</code> to <code>push_back</code> I was interested in."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553113642, "post_id": 55269513, "comment_id": 97270345, "body": "@user4581301 They are equivalent in this case. <a href=\"https://en.cppreference.com/w/cpp/container/vector/push_back\" rel=\"nofollow noreferrer\"><code>std::vector::push_back</code></a> has a <code>T&amp;&amp;</code> overload and both will construct an instance in place using the move constructor."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553113808, "post_id": 55269513, "comment_id": 97270418, "body": "I know. I&#39;d hacked the Asker&#39;s code to add in the <code>std:: move</code> already and forgotten I&#39;d done it.  All I needed to make it work at that point was to remove the <code>const</code>. When I looked back at the asker&#39;s code I spotted what I&#39;d done."}, {"owner": {"reputation": 11, "user_id": 10167488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/73eXr.png?s=128&g=1", "display_name": "Wesley Richmond", "link": "https://stackoverflow.com/users/10167488/wesley-richmond"}, "edited": false, "score": 0, "creation_date": 1553217071, "post_id": 55269513, "comment_id": 97311961, "body": "Thanks guys. I used std::forward instead of std::move and it works fine. is there a reason to prefer move over forward in this case?"}], "tags": [], "owner": {"reputation": 63648, "user_id": 97248, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d891ba8bd448f11617333f8642870262?s=128&d=identicon&r=PG", "display_name": "pts", "link": "https://stackoverflow.com/users/97248/pts"}, "is_accepted": false, "score": 2, "last_activity_date": 1553113997, "last_edit_date": 1553113997, "creation_date": 1553113093, "answer_id": 55269513, "question_id": 55269356, "link": "https://stackoverflow.com/questions/55269356/cant-push-back-an-object-with-a-unique-ptr-to-a-stdvector/55269513#55269513", "title": "Can&#39;t push_back an object with a unique_ptr to a std::vector", "body": "<p>Drop the <code>const</code>:</p>\n\n<pre><code>void add_child(Entity &amp;&amp; entity)\n</code></pre>\n\n<p>, and use:</p>\n\n<pre><code>mChildren.push_back(std::move(entity));\n</code></pre>\n\n<p>Applying these 2 changes above made it compile for me.</p>\n\n<p>Explanation: You want to call <code>void push_back( T&amp;&amp; value );</code> (or similarly with <code>emplace_back</code>) in <code>vector&lt;T&gt;</code>, where <code>T</code> is <code>Entity</code>. The other overload is <code>void push_back( const T&amp; value );</code>, which doesn't compile, because its implementation (method body) attempts to call the copy constructor of <code>T</code>, and <code>Entity</code> doesn't have a copy constructor. The implementation <code>void push_back( T&amp;&amp; value );</code> calls the move constructor of <code>T</code>, and <code>Entity</code> has a move constructor, so it compiles.</p>\n\n<p>To make sure that <code>void push_back( T&amp;&amp; value );</code> is called, you want to pass an <code>Entity&amp;&amp;</code> to <code>push_back</code>. For that you need both changes above. Without either, <code>entity</code> can't be converted to <code>Entity&amp;&amp;</code>.</p>\n\n<p>See also <a href=\"https://en.cppreference.com/w/cpp/container/vector/push_back\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/container/vector/push_back</a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 10167488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/73eXr.png?s=128&g=1", "display_name": "Wesley Richmond", "link": "https://stackoverflow.com/users/10167488/wesley-richmond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553116300, "creation_date": 1553112433, "last_edit_date": 1553116300, "question_id": 55269356, "link": "https://stackoverflow.com/questions/55269356/cant-push-back-an-object-with-a-unique-ptr-to-a-stdvector", "title": "Can&#39;t push_back an object with a unique_ptr to a std::vector", "body": "<p>I am trying to create an Entity which can hold a pointer to its parent and a vector to its children. </p>\n\n<p>The problem is when I try to emplace_back or push_back to the vector of children, I get  </p>\n\n<p><code>Error C2280 'Entity::Entity(const Entity &amp;)': attempting to reference a deleted function</code></p>\n\n<p>Due to the fact I have a unique_ptr in the Entity.</p>\n\n<p>I thought that adding a move-constructor would solve this problem but it has not.</p>\n\n<p>I have included a minimal verifiable runnable example here below. </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;memory&gt;\n\nusing namespace std;\n\nstruct Entity\n{\n   //////// data\n   unique_ptr&lt;Entity&gt; mParent;\n   std::vector&lt;Entity&gt; mChildren;\n\n   //////// ctors\n   // default\n   Entity() = default;\n   // move\n   Entity(Entity &amp;&amp; entity): mParent{std::move(entity.mParent)}{}\n\n   //////// functions\n   void add_child(Entity const &amp;&amp; entity)\n   {\n       mChildren.emplace_back(entity); // COMMENT OUT THIS LINE FOR FUNCTIONAL CODE\n       //Error  C2280 'Entity::Entity(const Entity &amp;)': attempting to reference a deleted function in... include\\xmemory0 881\n   };\n};\n\nint main()\n{\n   Entity entity;\n   entity.add_child(Entity());\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "concurrency", "atomic"], "comments": [{"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 1, "creation_date": 1553112371, "post_id": 55269288, "comment_id": 97269700, "body": "Not synchronizing with respect to <i>other</i> operations. The (result of the) operation itself is always observed by other threads."}, {"owner": {"reputation": 768, "user_id": 6530474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qeyoz.png?s=128&g=1", "display_name": "Hrisip", "link": "https://stackoverflow.com/users/6530474/hrisip"}, "reply_to_user": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1553113605, "post_id": 55269288, "comment_id": 97270320, "body": "@LWimsey so synchronization is achieved with memory barriers(but it&#39;s called ordering...)? It&#39;s not clear what you mean by synchronization with <i>other</i> operations."}], "answers": [{"comments": [{"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1553369427, "post_id": 55269467, "comment_id": 97362034, "body": "On X86, compared to non-atomic operations, there is extra cost for (relaxed) atomic operations because a compiler cannot apply the same level of optimization. For example, an atomic store is always committed to L1-cache (for visibility reasons) while it could stay inside a CPU register if non-atomic."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1553524666, "post_id": 55269467, "comment_id": 97405536, "body": "@LWimsey not true."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 0, "last_activity_date": 1553112913, "creation_date": 1553112913, "answer_id": 55269467, "question_id": 55269288, "link": "https://stackoverflow.com/questions/55269288/how-can-an-atomic-operation-be-not-a-synchronization-operation/55269467#55269467", "title": "How can an atomic operation be not a synchronization operation?", "body": "<p>Yes, standard is correct. Relaxed atomics are not synchronization operation, as only atomicity of operation is guaranteed.</p>\n\n<p>For example, </p>\n\n<pre><code>int k = 5;\nvoid foo() {\n    k = 10;\n}\n\nint baz() {\n    return k;\n}\n</code></pre>\n\n<p>In presence of multiple threads, the behavior is undefined as it exposes race condition. In practice on some architectures it could happen that a caller of <code>baz</code> would see nor 10, no 5, but some other, indeterminate value. It is often called <em>torn</em> or <em>dirty</em> read.</p>\n\n<p>If a relaxed atomic load and store was used instead <code>baz</code> would be guaranteed to return either 5 or 10, as there would be no data race.</p>\n\n<p>It is worth noting that for practical purposes, Intel chips and their very strong memory model make relaxed atomic a noop (meaning there is no extra cost for it being atomic) on this common architecture, as loads and stores are atomic on hardware level.</p>\n"}, {"comments": [{"owner": {"reputation": 768, "user_id": 6530474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qeyoz.png?s=128&g=1", "display_name": "Hrisip", "link": "https://stackoverflow.com/users/6530474/hrisip"}, "edited": false, "score": 0, "creation_date": 1553114456, "post_id": 55269623, "comment_id": 97270761, "body": "you say in the second example if both <code>bar()</code>  and <code>foo()</code> access the same non-atomic, no data race will occur. Well, if they happen to change this non-atomic variable in the same time(which is possible?), then there&#39;s a race condition by definition"}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "reply_to_user": {"reputation": 768, "user_id": 6530474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qeyoz.png?s=128&g=1", "display_name": "Hrisip", "link": "https://stackoverflow.com/users/6530474/hrisip"}, "edited": false, "score": 0, "creation_date": 1553119767, "post_id": 55269623, "comment_id": 97272990, "body": "@DanA. I said that &quot;everything that&#39;s sequenced before the store in thread 1 happens before everything that&#39;s sequenced after the load in thread 2&quot; --- therefore things that happen in <code>foo()</code> are not potentially concurrent with things that happen in <code>bar()</code>."}], "tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": false, "score": 0, "last_activity_date": 1553113629, "creation_date": 1553113629, "answer_id": 55269623, "question_id": 55269288, "link": "https://stackoverflow.com/questions/55269288/how-can-an-atomic-operation-be-not-a-synchronization-operation/55269623#55269623", "title": "How can an atomic operation be not a synchronization operation?", "body": "<p>Suppose we have</p>\n\n<pre><code>std::atomic&lt;int&gt; x = 0;\n\n// thread 1\nfoo();\nx.store(1, std::memory_order_relaxed);\n\n// thread 2\nassert(x.load(std::memory_order_relaxed) == 1);\nbar();\n</code></pre>\n\n<p>There is, first of all, no guarantee that thread 2 will observe the value 1 (that is, the assert may fire). But even if thread 2 does observe the value 1, while thread 2 is executing <code>bar()</code>, it might not observe side effects generated by <code>foo()</code> in thread 1. And if <code>foo()</code> and <code>bar()</code> access the same non-atomic variables, a data race may occur.</p>\n\n<p>Now suppose we change the example to:</p>\n\n<pre><code>std::atomic&lt;int&gt; x = 0;\n\n// thread 1\nfoo();\nx.store(1, std::memory_order_release);\n\n// thread 2\nassert(x.load(std::memory_order_acquire) == 1);\nbar();\n</code></pre>\n\n<p>There is still no guarantee that thread 2 observes the value 1; after all, it could happen that the load occurs before the store. However, in this case, <em>if</em> thread 2 observes the value 1, then the store in thread 1 synchronizes with the load in thread 2. What this means is that everything that's sequenced before the store in thread 1 happens before everything that's sequenced after the load in thread 2. Therefore, <code>bar()</code> will see all the side effects produced by <code>foo()</code> and if they both access the same non-atomic variables, no data race will occur.</p>\n\n<p>So, as you can see, the synchronization properties of operations on <code>x</code> tell you nothing about what happens to <code>x</code>. Instead, synchronization imposes ordering on <em>surrounding</em> operations in the two threads. (Therefore, in the linked example, the result is always 5, and does not depend on the memory ordering; the synchronization properties of the fetch-add operations don't affect the effect of the fetch-add operations themselves.)</p>\n"}, {"tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": true, "score": 2, "last_activity_date": 1553115936, "last_edit_date": 1553115936, "creation_date": 1553115203, "answer_id": 55270004, "question_id": 55269288, "link": "https://stackoverflow.com/questions/55269288/how-can-an-atomic-operation-be-not-a-synchronization-operation/55270004#55270004", "title": "How can an atomic operation be not a synchronization operation?", "body": "<p>The compiler and the CPU are allowed to reorder memory accesses. It's the <a href=\"https://stackoverflow.com/questions/15718262/what-exactly-is-the-as-if-rule\">as-if rule</a> and it assumes a single-threaded process.</p>\n\n<p>In multithreaded programs, the memory order parameter specifies how memory accesses are to be ordered <em>around</em> an atomic operation. This is the synchronization aspect (the \"acquire-release semantics\") of an atomic operation that is separate from the atomicity aspect itself:</p>\n\n<pre><code>int x = 1;\nstd::atomic&lt;int&gt; y = 1;\n\n    // Thread 1\n    x++;\n    y.fetch_add(1, std::memory_order_release);\n\n    // Thread 2\n    while ((y.load(std::memory_order_acquire) == 1)\n    { /* wait */ }\n    std::cout &lt;&lt; x &lt;&lt; std::endl;  // x is 2 now\n</code></pre>\n\n<p>Whereas with a relaxed memory order we only get atomicity, but not ordering:</p>\n\n<pre><code>int x = 1;\nstd::atomic&lt;int&gt; y = 1;\n\n    // Thread 1\n    x++;\n    y.fetch_add(1, std::memory_order_relaxed);\n\n    // Thread 2\n    while ((y.load(std::memory_order_relaxed) == 1)\n    { /* wait */ }\n    std::cout &lt;&lt; x &lt;&lt; std::endl;  // x can be 1 or 2, we don't know\n</code></pre>\n\n<p>Indeed as Herb Sutter explains in his excellent <a href=\"https://channel9.msdn.com/Shows/Going+Deep/Cpp-and-Beyond-2012-Herb-Sutter-atomic-Weapons-1-of-2\" rel=\"nofollow noreferrer\">Atomic Weapons</a> talk, <code>memory_order_relaxed</code> makes a multithreaded program very difficult to reason about and should be used in very specific cases only, when there is no dependency between the atomic operation and <em>any other operation</em> before or after it in any thread (very rarely the case).</p>\n"}], "owner": {"reputation": 768, "user_id": 6530474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qeyoz.png?s=128&g=1", "display_name": "Hrisip", "link": "https://stackoverflow.com/users/6530474/hrisip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 55270004, "answer_count": 3, "score": 1, "last_activity_date": 1553115936, "creation_date": 1553112140, "question_id": 55269288, "link": "https://stackoverflow.com/questions/55269288/how-can-an-atomic-operation-be-not-a-synchronization-operation", "title": "How can an atomic operation be not a synchronization operation?", "body": "<p>The standard says that a relaxed atomic operation is not a synchronization operation. But what's atomic about an operation result of which is not seen by other threads.</p>\n\n<p>The example <a href=\"https://en.cppreference.com/w/cpp/atomic/atomic/fetch_add\" rel=\"nofollow noreferrer\">here</a> wouldn't give the expected result then, right?</p>\n\n<p>What I understand by synchronization is that the result of an operation with such trait would be visible by all threads.</p>\n\n<p>Maybe I don't understand what synchronization means.\nWhere's the hole in my logic?</p>\n"}, {"tags": ["c++", "input", "gets", "standards-compliance"], "comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1553139753, "post_id": 55269252, "comment_id": 97277801, "body": "Note that <code>stdin</code> in the standard library is a <code>FILE*</code>, and a pointer to any type converts to <code>char*</code>, which is the type of the argument of <code>gets()</code>.  However, you should never, ever, ever write that kind of code outside an obfuscated C contest.  If your compiler even accepts it, add more warning flags, and if you\u2019re trying to fix a codebase that has that construct in it, turn warnings into errors."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 1, "creation_date": 1553163270, "post_id": 55269252, "comment_id": 97286053, "body": "@Davislor no it doesn&#39;t &quot;candidate function not viable: no known conversion from &#39;struct _IO_FILE *&#39; to &#39;char *&#39; for 1st argument&quot;"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 3, "creation_date": 1553172572, "post_id": 55269252, "comment_id": 97291315, "body": "@Davislor huh, that might be true for ancient C, but definitely not for C++."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1553178922, "post_id": 55269252, "comment_id": 97295502, "body": "@Quentin Yeah. That shouldn\u2019t compile. The intended challenge might\u2019ve been, \u201cTake this broken code, read my mind about what it\u2019s supposed to do, and fix it,\u201d but in that case there should be a real specification. With test cases."}, {"owner": {"reputation": 2365, "user_id": 21055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cd7a11b6aa86a60a4cdd40755e41e4b?s=128&d=identicon&r=PG", "display_name": "Roman Odaisky", "link": "https://stackoverflow.com/users/21055/roman-odaisky"}, "edited": false, "score": 6, "creation_date": 1553180335, "post_id": 55269252, "comment_id": 97296487, "body": "I\u2019m surprised no-one tried this, but <code>gets(stdin )</code> (with an extra space) produces the expected C++ error."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 2365, "user_id": 21055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cd7a11b6aa86a60a4cdd40755e41e4b?s=128&d=identicon&r=PG", "display_name": "Roman Odaisky", "link": "https://stackoverflow.com/users/21055/roman-odaisky"}, "edited": false, "score": 0, "creation_date": 1553188911, "post_id": 55269252, "comment_id": 97301794, "body": "@RomanOdaisky we&#39;ve already established that is a textual find and replace so no surprises there"}], "answers": [{"comments": [{"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 27, "creation_date": 1553112446, "post_id": 55269253, "comment_id": 97269731, "body": "I&#39;m genuinely amazed. Maybe this Q/A can be a canonical post on why not to learn from coding challenge sites."}, {"owner": {"reputation": 39804, "user_id": 43452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5843f8e823d0272f51a7d3585669f11e?s=128&d=identicon&r=PG", "display_name": "Stobor", "link": "https://stackoverflow.com/users/43452/stobor"}, "edited": false, "score": 1, "creation_date": 1553112542, "post_id": 55269253, "comment_id": 97269776, "body": "The &quot;8&quot; comes from the left box at the bottom of the screen. Try typing a text string in there (I tried &quot;maplemaple&quot;) and see the result..."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 39804, "user_id": 43452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5843f8e823d0272f51a7d3585669f11e?s=128&d=identicon&r=PG", "display_name": "Stobor", "link": "https://stackoverflow.com/users/43452/stobor"}, "edited": false, "score": 0, "creation_date": 1553112597, "post_id": 55269253, "comment_id": 97269796, "body": "@Stobor yes, that is the &quot;input&quot;"}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 28, "creation_date": 1553112810, "post_id": 55269253, "comment_id": 97269903, "body": "Something really evil is happening, and I think it&#39;s at the level of text replacement in the source code outside of the compiler. Try this: <code>std::cout &lt;&lt; &quot;gets(stdin)&quot;;</code> and the output is <code>8</code> (or whatever you type into the &#39;input&#39; field. This is a disgraceful abuse of the language."}, {"owner": {"reputation": 39804, "user_id": 43452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5843f8e823d0272f51a7d3585669f11e?s=128&d=identicon&r=PG", "display_name": "Stobor", "link": "https://stackoverflow.com/users/43452/stobor"}, "reply_to_user": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1553112873, "post_id": 55269253, "comment_id": 97269944, "body": "@alterigel Yes it is - as I said, try putting text into the box, and you&#39;ll see it&#39;s directly substituted into the code, triggering an error in the original code..."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553112902, "post_id": 55269253, "comment_id": 97269972, "body": "fwiw you can <code>#define gets(X) X</code>, use it in <code>main</code> eg as <code>gets(foo)</code>, get the expected error, and still the <code>gets(stdin)</code> works as not expected"}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "reply_to_user": {"reputation": 39804, "user_id": 43452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5843f8e823d0272f51a7d3585669f11e?s=128&d=identicon&r=PG", "display_name": "Stobor", "link": "https://stackoverflow.com/users/43452/stobor"}, "edited": false, "score": 14, "creation_date": 1553112926, "post_id": 55269253, "comment_id": 97269985, "body": "@Stobor note the quotes around <code>&quot;gets(stdin)&quot;</code>. That&#39;s a string literal that even the preprocessor wouldn&#39;t touch"}, {"owner": {"reputation": 39804, "user_id": 43452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5843f8e823d0272f51a7d3585669f11e?s=128&d=identicon&r=PG", "display_name": "Stobor", "link": "https://stackoverflow.com/users/43452/stobor"}, "reply_to_user": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1553113059, "post_id": 55269253, "comment_id": 97270048, "body": "@alterigel - I think we&#39;re agreeing with each other. :)"}, {"owner": {"reputation": 12923, "user_id": 1530508, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fG8z0.png?s=128&g=1", "display_name": "ApproachingDarknessFish", "link": "https://stackoverflow.com/users/1530508/approachingdarknessfish"}, "edited": false, "score": 2, "creation_date": 1553197779, "post_id": 55269253, "comment_id": 97305957, "body": "To quote James Kirk: &quot;This is damn peculiar.&quot;"}, {"owner": {"reputation": 18697, "user_id": 923847, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/d36f174888868d824d06274fb5c42a2a?s=128&d=identicon&r=PG", "display_name": "Matsemann", "link": "https://stackoverflow.com/users/923847/matsemann"}, "reply_to_user": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 2, "creation_date": 1553247524, "post_id": 55269253, "comment_id": 97321673, "body": "@alterigel get off your high horse. This is no statement to whether learning from coding challenge sites is useful or not. Who are you to decide how people practice stuff?"}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "reply_to_user": {"reputation": 18697, "user_id": 923847, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/d36f174888868d824d06274fb5c42a2a?s=128&d=identicon&r=PG", "display_name": "Matsemann", "link": "https://stackoverflow.com/users/923847/matsemann"}, "edited": false, "score": 0, "creation_date": 1553267529, "post_id": 55269253, "comment_id": 97333717, "body": "@Matsemann my comment was intended specifically at C++, and perhaps I should have made that clearer. I understand that coding challenge sites are very practical and extremely helpful for other languages like JavaScript or Python, but C++ is a highly nuanced, complex, and evolving language that is clouded with bad and misleading advice on the web. We have a <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">canonical post</a> about it."}], "tags": [], "owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": true, "score": 112, "last_activity_date": 1553118044, "last_edit_date": 1592644375, "creation_date": 1553112020, "answer_id": 55269253, "question_id": 55269252, "link": "https://stackoverflow.com/questions/55269252/what-is-going-on-with-getsstdin-on-the-site-coderbyte/55269253#55269253", "title": "What is going on with &#39;gets(stdin)&#39; on the site coderbyte?", "body": "<p>I am intrigued. So, time to put the investigation goggles on and since I don't have access to the compiler or compilation flags I need to get inventive. Also because nothing about this code makes sense it's not a bad idea question every assumption.</p>\n<p>First let's check the actual type of <code>gets</code>. I have a little trick for that:</p>\n<pre><code>template &lt;class&gt; struct Name;\n\nint main() { \n    \n    Name&lt;decltype(gets)&gt; n;\n  \n  // keep this function call here\n  cout &lt;&lt; FirstFactorial(gets(stdin));\n  return 0;\n    \n}\n</code></pre>\n<p>And that looks ... normal:</p>\n<blockquote>\n<pre><code>/tmp/613814454/Main.cpp:16:19: warning: 'gets' is deprecated [-Wdeprecated-declarations]\n    Name&lt;decltype(gets)&gt; n;\n                  ^\n/usr/include/stdio.h:638:37: note: 'gets' has been explicitly marked deprecated here\nextern char *gets (char *__s) __wur __attribute_deprecated__;\n                                    ^\n/usr/include/x86_64-linux-gnu/sys/cdefs.h:254:51: note: expanded from macro '__attribute_deprecated__'\n# define __attribute_deprecated__ __attribute__ ((__deprecated__))\n                                                  ^\n/tmp/613814454/Main.cpp:16:26: error: implicit instantiation of undefined template 'Name&lt;char *(char *)&gt;'\n    Name&lt;decltype(gets)&gt; n;\n                         ^\n/tmp/613814454/Main.cpp:12:25: note: template is declared here\ntemplate &lt;class&gt; struct Name;\n                        ^\n1 warning and 1 error generated.\n</code></pre>\n</blockquote>\n<p><code>gets</code> is marked as deprecated and has the signature <code>char *(char *)</code>. But then how is <code>FirstFactorial(gets(stdin));</code> compiling?</p>\n<p>Let's try something else:</p>\n<pre><code>int main() { \n  Name&lt;decltype(gets(stdin))&gt; n;\n  \n  // keep this function call here\n  cout &lt;&lt; FirstFactorial(gets(stdin));\n  return 0;\n    \n} \n</code></pre>\n<p>Which gives us:</p>\n<blockquote>\n<pre><code>/tmp/286775780/Main.cpp:15:21: error: implicit instantiation of undefined template 'Name&lt;int&gt;'\n  Name&lt;decltype(8)&gt; n;\n                    ^\n</code></pre>\n</blockquote>\n<p>Finally we are getting something: <code>decltype(8)</code>. So the entire <code>gets(stdin)</code> was textually replaced with the input (<code>8</code>).</p>\n<p>And the things get weirder. The compiler error continues:</p>\n<blockquote>\n<pre><code>/tmp/596773533/Main.cpp:18:26: error: no matching function for call to 'gets'\n  cout &lt;&lt; FirstFactorial(gets(stdin));\n                         ^~~~\n/usr/include/stdio.h:638:14: note: candidate function not viable: no known conversion from 'struct _IO_FILE *' to 'char *' for 1st argument\nextern char *gets (char *__s) __wur __attribute_deprecated__;\n</code></pre>\n</blockquote>\n<p>So now we get the expected error for <code>cout &lt;&lt; FirstFactorial(gets(stdin));</code></p>\n<p>I checked for a macro and since <code>#undef gets</code> seems to do nothing it looks like it isn't a macro.</p>\n<p>But</p>\n<pre><code>std::integral_constant&lt;int, gets(stdin)&gt; n;\n</code></pre>\n<p>It compiles.</p>\n<p>But</p>\n<pre><code>std::integral_constant&lt;int, gets(stdin)&gt; n;    // OK\nstd::integral_constant&lt;int, gets(stdin)&gt; n2;   // ERROR                                          wtf??\n</code></pre>\n<p>Doesn't with the expected error at the <code>n2</code> line.</p>\n<p>And again, almost any modification to <code>main</code> makes the line <code>cout &lt;&lt; FirstFactorial(gets(stdin));</code> spit out the expected error.</p>\n<p>Moreover the <code>stdin</code> actually seems to be empty.</p>\n<p>So I can only conclude and speculate they have a little program that parses the source and tries (poorly) to replace <code>gets(stdin)</code> with the test case input value before actually feeding it into the compiler. If anybody has a better theory or actually knows what they are doing please share!</p>\n<p>This is obviously a very bad practice. While researching this I found there is at least a question here (<a href=\"https://stackoverflow.com/questions/49871653/c-programming-return-of-getsstdin-why-is-it-integer\">example</a>) about this and because people have no idea that there is a site out there who does this their answer is &quot;don't use <code>gets</code> use ... instead&quot; which is indeed a good advice but only confuses the OP more since any attempt at a valid read from stdin will fail on this site.</p>\n<hr />\n<h1>TLDR</h1>\n<p><code>gets(stdin)</code> is invalid C++. It's a gimmick this particular site uses (for what reasons I cannot figure out). If you want to continue to submit on the site (I am neither endorsing it neither not endorsing it) you have to use this construct that otherwise would not make sense, but be aware that it is brittle. Almost any modifications to <code>main</code> will spit out an error. Outside of this site use normal input reading methods.</p>\n"}, {"comments": [{"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1553113907, "post_id": 55269670, "comment_id": 97270461, "body": "and it&#39;s not even a blind &quot;find and replace&quot; because sometimes it replaces it sometimes it does not."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "reply_to_user": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 4, "creation_date": 1553114387, "post_id": 55269670, "comment_id": 97270729, "body": "@bolov could it be just the first occurrence of <code>gets(stdin)</code> that is replaced? I meant &#39;blind&#39; in the sense that it appears to be unaware of the language&#39;s syntax or grammar."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1553115292, "post_id": 55269670, "comment_id": 97271175, "body": "yes, you are right. It replaces the first occurence. I tried putting one before main and that&#39;s what I got indeed."}, {"owner": {"reputation": 39804, "user_id": 43452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5843f8e823d0272f51a7d3585669f11e?s=128&d=identicon&r=PG", "display_name": "Stobor", "link": "https://stackoverflow.com/users/43452/stobor"}, "edited": false, "score": 1, "creation_date": 1553125141, "post_id": 55269670, "comment_id": 97274597, "body": "Further research suggests that that site does it for all languages, not just C++ - python/ruby it uses the function call (&quot;raw_input()&quot; or &quot;STDIN.gets&quot;) which would typically return a string from stdin, but ends up doing a string substitution of that string instead. I guess finding a regex match for the getline function was too hard, so they went with gets(stdin) for C/C++."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "reply_to_user": {"reputation": 39804, "user_id": 43452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5843f8e823d0272f51a7d3585669f11e?s=128&d=identicon&r=PG", "display_name": "Stobor", "link": "https://stackoverflow.com/users/43452/stobor"}, "edited": false, "score": 4, "creation_date": 1553125318, "post_id": 55269670, "comment_id": 97274656, "body": "@Stobor dang, you&#39;re right. I can confirm this happens for Java too, the line <code>System.out.print(FirstFactorial(s.nextLine()9));</code> prints <code>89</code> even when <code>s</code> is undefined."}], "tags": [], "owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "is_accepted": false, "score": 66, "last_activity_date": 1553262871, "last_edit_date": 1553262871, "creation_date": 1553113803, "answer_id": 55269670, "question_id": 55269252, "link": "https://stackoverflow.com/questions/55269252/what-is-going-on-with-getsstdin-on-the-site-coderbyte/55269670#55269670", "title": "What is going on with &#39;gets(stdin)&#39; on the site coderbyte?", "body": "<p>I tried the following addition to <code>main</code> in the Coderbyte editor:</p>\n\n<pre><code>std::cout &lt;&lt; \"gets(stdin)\";\n</code></pre>\n\n<p>Where the mysterious and enigmatic snippet <code>gets(stdin)</code> appears inside a string literal. This shouldn't possibly be transformed by anything, not even the preprocessor, and <em>any</em> C++ programmer should expect this code to print the exact string <code>gets(stdin)</code> to the standard output. And yet we see the following output, when compiled and run on coderbyte:</p>\n\n<pre><code>8\n</code></pre>\n\n<p>Where the value <code>8</code> is taken straight from the convenient 'input' field under the editor.</p>\n\n<p><a href=\"https://i.stack.imgur.com/OL0mB.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/OL0mB.png\" alt=\"Magic code\"></a></p>\n\n<p>From this, it's clear that this online editor is performing blind find-and-replace operations on the source code, substitution appearances of <code>gets(stdin)</code> with the user's 'input'. I would personally call this a misuse of the language that's worse than careless preprocessor macros.</p>\n\n<p>In the context of an online coding challenge website, I'm worried by this because it teaches unconventional, non-standard, meaningless, and at least <em>unsafe</em> practices like <code>gets(stdin)</code>, and in a manner that can't be repeated on other platforms.</p>\n\n<p>I'm sure it can't be <em>this</em> hard to just use <code>std::cin</code> and just stream input to a program.</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 9840030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98a3142f838ddd2828d9d1a8a9b9da03?s=128&d=identicon&r=PG", "display_name": "Ruther Rendommeleigh", "link": "https://stackoverflow.com/users/9840030/ruther-rendommeleigh"}, "edited": false, "score": 20, "creation_date": 1553158139, "post_id": 55273543, "comment_id": 97283394, "body": "&quot;[B]ut the idea was for new programmers to not worry about reading input at all and just focus on writing the algorithm to solve the problem&quot; - and it didn&#39;t occur to you to, instead of writing something that resembles &quot;real&quot; code, just put a made up function name or an obvious placeholder in that spot? Genuinely curious."}, {"owner": {"reputation": 2799, "user_id": 1485311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sNWZV.jpg?s=128&g=1", "display_name": "ChatterOne", "link": "https://stackoverflow.com/users/1485311/chatterone"}, "edited": false, "score": 0, "creation_date": 1553162386, "post_id": 55273543, "comment_id": 97285556, "body": "Suppose that the input is a string instead of a number, let&#39;s say &quot;hello&quot;. You replace <code>gets(stdin)</code> with &quot;hello&quot; and use that as input to the function to see if the test passes. If my code is wrong and it only passes with the string &quot;world&quot; as input, I can just put a <code>#define gets(string) &quot;world&quot;</code> and every test will pass. Right?"}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 25, "creation_date": 1553163853, "post_id": 55273543, "comment_id": 97286379, "body": "I genuinely didn&#39;t expect I was going to choose an answer other than my own when I posted this. Thank you for proving me wrong in such a great way. It&#39;s really a pleasure to see your answer."}, {"owner": {"reputation": 2751, "user_id": 3233017, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2568656c29f0bc7e84480eb0227a304b?s=128&d=identicon&r=PG", "display_name": "Draconis", "link": "https://stackoverflow.com/users/3233017/draconis"}, "edited": false, "score": 4, "creation_date": 1553207061, "post_id": 55273543, "comment_id": 97309473, "body": "Very interesting! I would recommend, if you want to keep this hack, that you replace the function call with something like <code>TAKE_INPUT</code>, then use your find-replace to insert <code>#define TAKE_INPUT whatever_here</code> at the top."}, {"owner": {"reputation": 600, "user_id": 5725780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FKaUq.png?s=128&g=1", "display_name": "pipe", "link": "https://stackoverflow.com/users/5725780/pipe"}, "edited": false, "score": 18, "creation_date": 1553243805, "post_id": 55273543, "comment_id": 97319630, "body": "We need more answers starting with <i>&quot;I&#39;m the founder of x and also the guy who created this&quot;</i>."}, {"owner": {"reputation": 2943, "user_id": 2250588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a67a4afaa3e67ed31d90400f2eb9a22a?s=128&d=identicon&r=PG", "display_name": "iheanyi", "link": "https://stackoverflow.com/users/2250588/iheanyi"}, "reply_to_user": {"reputation": 101, "user_id": 9840030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98a3142f838ddd2828d9d1a8a9b9da03?s=128&d=identicon&r=PG", "display_name": "Ruther Rendommeleigh", "link": "https://stackoverflow.com/users/9840030/ruther-rendommeleigh"}, "edited": false, "score": 0, "creation_date": 1553263827, "post_id": 55273543, "comment_id": 97331396, "body": "@RutherRendommeleigh what&#39;s an obvious placeholder? Hint, not all users of such sites are experienced programmers, so you&#39;d need something that would be obvious to a noob so they know not to spend time rewriting it or thinking its wrong. Also, you need to come up with this for every single language you support. I&#39;ll check back on you in 7 years - it&#39;s only fair."}, {"owner": {"reputation": 685, "user_id": 9058464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/851f865aed95456302e9b9ad1dcb1d09?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Svietlichnyy", "link": "https://stackoverflow.com/users/9058464/andrew-svietlichnyy"}, "reply_to_user": {"reputation": 2943, "user_id": 2250588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a67a4afaa3e67ed31d90400f2eb9a22a?s=128&d=identicon&r=PG", "display_name": "iheanyi", "link": "https://stackoverflow.com/users/2250588/iheanyi"}, "edited": false, "score": 1, "creation_date": 1553279727, "post_id": 55273543, "comment_id": 97340110, "body": "@iheanyi Something like <code>INPUT</code> or <code>__INPUT__</code> can work in many languages. And since there is some code in the first place it&#39;s possible to write a comment about such placeholder."}, {"owner": {"reputation": 2943, "user_id": 2250588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a67a4afaa3e67ed31d90400f2eb9a22a?s=128&d=identicon&r=PG", "display_name": "iheanyi", "link": "https://stackoverflow.com/users/2250588/iheanyi"}, "reply_to_user": {"reputation": 685, "user_id": 9058464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/851f865aed95456302e9b9ad1dcb1d09?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Svietlichnyy", "link": "https://stackoverflow.com/users/9058464/andrew-svietlichnyy"}, "edited": false, "score": 0, "creation_date": 1553367821, "post_id": 55273543, "comment_id": 97361600, "body": "@AndrewSvietlichnyy you&#39;re solving the problem with today&#39;s browsers and webservers, not the original problem the site faced."}, {"owner": {"reputation": 101, "user_id": 9840030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98a3142f838ddd2828d9d1a8a9b9da03?s=128&d=identicon&r=PG", "display_name": "Ruther Rendommeleigh", "link": "https://stackoverflow.com/users/9840030/ruther-rendommeleigh"}, "reply_to_user": {"reputation": 2943, "user_id": 2250588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a67a4afaa3e67ed31d90400f2eb9a22a?s=128&d=identicon&r=PG", "display_name": "iheanyi", "link": "https://stackoverflow.com/users/2250588/iheanyi"}, "edited": false, "score": 2, "creation_date": 1553502244, "post_id": 55273543, "comment_id": 97392564, "body": "@iheanyi No one asked for it to be perfect. In fact, I&#39;m convinced that almost <i>any</i> placeholder would have been better than something that <i>looks</i> like valid code to any newbie but doesn&#39;t actually compile."}, {"owner": {"reputation": 2943, "user_id": 2250588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a67a4afaa3e67ed31d90400f2eb9a22a?s=128&d=identicon&r=PG", "display_name": "iheanyi", "link": "https://stackoverflow.com/users/2250588/iheanyi"}, "reply_to_user": {"reputation": 101, "user_id": 9840030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98a3142f838ddd2828d9d1a8a9b9da03?s=128&d=identicon&r=PG", "display_name": "Ruther Rendommeleigh", "link": "https://stackoverflow.com/users/9840030/ruther-rendommeleigh"}, "edited": false, "score": 0, "creation_date": 1553610463, "post_id": 55273543, "comment_id": 97442964, "body": "@RutherRendommeleigh I disagree. Newbies would be confused by placeholders.  They wont understand it&#39;s a placeholder. They&#39;re not confused by code that looks correct because they wont care. That&#39;s like a newbie being confused if there was a superfluous #include in C++ code - they&#39;d simply not notice."}, {"owner": {"reputation": 244, "user_id": 5347283, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uHWX26Md2lU/AAAAAAAAAAI/AAAAAAAAAEw/U8_A4Jaedlc/photo.jpg?sz=128", "display_name": "Will Crawford", "link": "https://stackoverflow.com/users/5347283/will-crawford"}, "edited": false, "score": 0, "creation_date": 1575017194, "post_id": 55273543, "comment_id": 104435187, "body": "Even in 2012 you could take the input and create a script tag surrounding the &quot;input&quot; with &quot;var INPUT = &#39;&quot; ... &quot;&#39;;&quot;"}], "tags": [], "owner": {"reputation": 945, "user_id": 11235491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55fac856229de37ff1088f78f9566a5d?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Borowski", "link": "https://stackoverflow.com/users/11235491/daniel-borowski"}, "is_accepted": false, "score": 173, "last_activity_date": 1553723861, "last_edit_date": 1553723861, "creation_date": 1553140589, "answer_id": 55273543, "question_id": 55269252, "link": "https://stackoverflow.com/questions/55269252/what-is-going-on-with-getsstdin-on-the-site-coderbyte/55273543#55273543", "title": "What is going on with &#39;gets(stdin)&#39; on the site coderbyte?", "body": "<p>I'm the founder of Coderbyte and also the guy who created this <code>gets(stdin)</code> hack.</p>\n\n<p>The comments on this post are correct that it is a form of find-and-replace, so let me explain why I did this really quickly.</p>\n\n<p>Back in the day when I first created the site (around 2012), it only supported JavaScript. There was no way to \"read in input\" in JavaScript running in the browser, and so there would be a function <code>foo(input)</code> and I used the <code>readline()</code> function from Node.js to call it like <code>foo(readline())</code>. Except I was a kid and didn't know better, so I literally just replaced <code>readline()</code> with the input at run-time. So <code>foo(readline())</code> became <code>foo(2)</code> or <code>foo(\"hello\")</code> which worked fine for JavaScript.</p>\n\n<p>Around 2013/2014 I added more languages and used third-party service to evaluate code online, but it was very difficult to do stdin/stdout with the services I was using, so I stuck with the same silly find-and-replace for languages like Python, Ruby, and eventually C++, C#, etc.</p>\n\n<p>Fast forward to today, I run the code in my own containers, but never updated the way stdin/stdout works because people have gotten used to the weird hack (some people have even posted in forums explaining how to get around it).</p>\n\n<p>I know it is not best practice and it isn't helpful for someone learning a new language to see hacks like this, but the idea was for new programmers to not worry about reading input at all and just focus on writing the algorithm to solve the problem. One common complaint about coding challenge sites years ago was that new programmers would spend a lot of time just figuring out how to read from <code>stdin</code> or read lines from a file, so I wanted new coders to avoid this problem on Coderbyte.</p>\n\n<p>I'll be updating the entire editor page soon along with the default code and <code>stdin</code> reading for languages. Hopefully then C++ programmers will enjoy using Coderbyte more :)</p>\n"}], "owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8119, "favorite_count": 16, "accepted_answer_id": 55269253, "answer_count": 3, "score": 144, "last_activity_date": 1553723861, "creation_date": 1553112020, "last_edit_date": 1553262673, "question_id": 55269252, "link": "https://stackoverflow.com/questions/55269252/what-is-going-on-with-getsstdin-on-the-site-coderbyte", "title": "What is going on with &#39;gets(stdin)&#39; on the site coderbyte?", "body": "<p>Coderbyte is an online coding challenge site (I found it just 2 minutes ago).</p>\n\n<p><a href=\"https://www.coderbyte.com/editor/guest:First%20Factorial:Cpp\" rel=\"noreferrer\">The first C++ challenge</a> you are greeted with has a C++ skeleton you need to modify:</p>\n\n<blockquote>\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nint FirstFactorial(int num) {\n\n  // Code goes here\n  return num;\n\n}\n\nint main() {\n\n  // Keep this function call here\n  cout &lt;&lt; FirstFactorial(gets(stdin));\n  return 0;\n\n}\n</code></pre>\n</blockquote>\n\n<p>If you are little familiar with C++ the first thing<sup>*</sup> that pops in your eyes is:</p>\n\n<pre><code>int FirstFactorial(int num);\ncout &lt;&lt; FirstFactorial(gets(stdin));\n</code></pre>\n\n<p>So, ok, the code calls <code>gets</code> which is deprecated since C++11 and removed since C++14 which is bad in itself. </p>\n\n<p>But then I realize: <code>gets</code> is of type <code>char*(char*)</code>. So it shouldn't accept a <code>FILE*</code> parameter and the result shouldn't be usable in the place of an <code>int</code> parameter, but ... not only it compiles without any warnings or errors, but it runs and actually passes the correct input value to <code>FirstFactorial</code>.</p>\n\n<p>Outside of this particular site, the code doesn't compile (as expected), so what is going on here?</p>\n\n<hr>\n\n<p><sup>*Actually the first one is <code>using namespace std</code> but that is irrelevant to my issue here.</sup></p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1553111612, "post_id": 55269129, "comment_id": 97269321, "body": "You are inputting a <code>,</code>. Your <code>scanf</code> does not checks for any <code>,</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1553111662, "post_id": 55269129, "comment_id": 97269341, "body": "You should not mix C and C++ IO."}, {"owner": {"reputation": 3, "user_id": 11193049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8b1a276589d54a43c471a80a81d1764?s=128&d=identicon&r=PG&f=1", "display_name": "rodaguirre5", "link": "https://stackoverflow.com/users/11193049/rodaguirre5"}, "edited": false, "score": 0, "creation_date": 1553111767, "post_id": 55269129, "comment_id": 97269392, "body": "Is there sometime else I should be using to input then? My program requires the input to be entered on the same line separated by commas."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553112405, "post_id": 55269129, "comment_id": 97269715, "body": "<code>scanf</code> returns the number of values it successfully read. Checking this can save much debugging."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553112464, "post_id": 55269129, "comment_id": 97269737, "body": "Rather than looping 8 <code>scanf</code>s you could make one big <code>scanf</code> that reads 8 numbers."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553112516, "post_id": 55269129, "comment_id": 97269767, "body": "There are a number of ways.  You can see a bunch of example using the google search: <a href=\"https://www.google.com/search?q=read+numbers+separated+by+comma+c%2B%2B+site:stackoverflow.com&amp;rlz=1C1SQJL_enUS782US782&amp;sa=X&amp;ved=2ahUKEwiU7KqzwpHhAhUNeKwKHYx9C2kQrQIoBDAAegQIBBAM&amp;biw=1920&amp;bih=937\" rel=\"nofollow noreferrer\">google.com/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 11234238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbc2cf511cb54d0ec9bf5e495214a64a?s=128&d=identicon&r=PG&f=1", "display_name": "th3hunter", "link": "https://stackoverflow.com/users/11234238/th3hunter"}, "is_accepted": true, "score": 2, "last_activity_date": 1553113330, "creation_date": 1553113330, "answer_id": 55269567, "question_id": 55269129, "link": "https://stackoverflow.com/questions/55269129/scanf-only-taking-first-integer-for-array/55269567#55269567", "title": "scanf() only taking first integer for array", "body": "<p>The input syntax you should use is like that : <code>2 5 7 2 1 4 6 8</code>.\nor you can change the <code>scanf(\"%d\", &amp;nums[k]);</code> to <code>scanf(\"%d,\", &amp;nums[k]);</code> and now you can enter <code>2,5,7,2,1,4,6,8</code></p>\n"}], "owner": {"reputation": 3, "user_id": 11193049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8b1a276589d54a43c471a80a81d1764?s=128&d=identicon&r=PG&f=1", "display_name": "rodaguirre5", "link": "https://stackoverflow.com/users/11193049/rodaguirre5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 55269567, "answer_count": 1, "score": -1, "last_activity_date": 1553113330, "creation_date": 1553111573, "question_id": 55269129, "link": "https://stackoverflow.com/questions/55269129/scanf-only-taking-first-integer-for-array", "title": "scanf() only taking first integer for array", "body": "<p>I am writing a program to sort a user entered array. The following code takes 8 single digit integers to be entered and then put into an array.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\n\nusing namespace std;\n\nvoid printArray(int ary[], int n) {\n    cout &lt;&lt; \"The sequence you entered is as follows:\" &lt;&lt; endl;\n    for (int i=0; i&lt;n; i++) {\n        cout &lt;&lt; ary[i] &lt;&lt; \" \";\n    }\n    cout &lt;&lt; \"\\n\";\n}\n\nint main() {\n    using namespace std;\n\n    int nums[8];\n\n    cout &lt;&lt; \"Please enter 8 single digits between 1 and 9\" &lt;&lt; endl;\n    for(int k=0; k&lt;8; k++) {\n        scanf(\"%d\", &amp;nums[k]);\n    }\n\n    printArray(nums, 8);\n\n    cout &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>But when I input digits, only the first integer is pushed into the array with the rest being 0s.\nFor example, when the input is:\n<code>2,5,7,2,1,4,6,8</code>. The output is: <code>2 0 0 0 0 0 0 0</code> </p>\n"}, {"tags": ["c++", "cmake", "ide", "header-files"], "answers": [{"tags": [], "owner": {"reputation": 133, "user_id": 3171290, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bb45c9aafaed4ade44dd81ad31d2754?s=128&d=identicon&r=PG", "display_name": "HunterZ", "link": "https://stackoverflow.com/users/3171290/hunterz"}, "is_accepted": true, "score": 2, "last_activity_date": 1553531431, "creation_date": 1553531431, "answer_id": 55342402, "question_id": 55269098, "link": "https://stackoverflow.com/questions/55269098/cmake-adding-ide-visibility-for-common-headers-in-a-multi-library-binary-c-pr/55342402#55342402", "title": "CMake: Adding IDE visibility for common headers in a multi-library/binary C++ project", "body": "<p>It looks like this is basically a duplicate of <a href=\"https://stackoverflow.com/questions/28384935/qtcreator-cmake-project-how-to-show-all-project-files\">QtCreator CMake project - how to show all project files</a></p>\n\n<p>Following the <a href=\"https://stackoverflow.com/a/33630604/3171290\">accepted solution</a> there, I created a subdirectory in the source tree with only a CMakeLists.txt, which contains something like the following:</p>\n\n<pre><code>set(HEADERS\n   ${MY_INCLUDE_DIR}/common/common1.hpp\n   ${MY_INCLUDE_DIR}/common/common2.hpp\n   ...\n)\n\nadd_custom_target(common SOURCES ${HEADERS})\n</code></pre>\n\n<p>The keyword <code>SOURCES</code> in the <code>add_custom_target()</code> command tells CMake that these are code files that are not directly built but need to be added to the project for IDE visibility.</p>\n\n<p>Documentation: <a href=\"https://cmake.org/cmake/help/latest/command/add_custom_target.html\" rel=\"nofollow noreferrer\">https://cmake.org/cmake/help/latest/command/add_custom_target.html</a></p>\n"}], "owner": {"reputation": 133, "user_id": 3171290, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bb45c9aafaed4ade44dd81ad31d2754?s=128&d=identicon&r=PG", "display_name": "HunterZ", "link": "https://stackoverflow.com/users/3171290/hunterz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 55342402, "answer_count": 1, "score": 1, "last_activity_date": 1553531431, "creation_date": 1553111393, "question_id": 55269098, "link": "https://stackoverflow.com/questions/55269098/cmake-adding-ide-visibility-for-common-headers-in-a-multi-library-binary-c-pr", "title": "CMake: Adding IDE visibility for common headers in a multi-library/binary C++ project", "body": "<p>NOTE: This question regards getting headers to show up in IDEs, <em>not</em> just getting them to be included in the build. The latter is not a concern here.</p>\n\n<p>I have a project that looks basically like this, and I'm trying to convert its build system to CMake:</p>\n\n<pre><code>project/\n  include/\n     common/\n        common1.hpp\n        common2.hpp\n        ...\n     lib1/\n        file1_1.hpp\n        file1_2.hpp\n        ...\n     lib2/\n        file2_1.hpp\n        file2_2.hpp\n        ...\n     ...\n     bin1/\n        ...\n  src/\n     CMakeLists.txt (project)\n     lib1/\n        file1_1.cpp\n        file1_2.cpp\n        ...\n        CMakeLists.txt (add_library)\n     lib2/\n        file2_1.cpp\n        file2_2.cpp\n        ...\n        CMakeLists.txt (add_library)\n     ...\n     bin1/\n        main.cpp\n        ...\n        CMakeLists.txt (add_executable)\n</code></pre>\n\n<p>In each leaf directory's <code>CMakeLists.txt</code>, I'm including the corresponding header files in the <code>add_library()</code> or <code>add_executable()</code> command, for maximum IDE compatibility.</p>\n\n<p>My question is: How do I wrangle CMake to get the non-library-specific headers under <code>common/</code> to show up in IDEs as well?</p>\n\n<p>My current plan is to just assign each of them to the library/binary that makes the most use of them, but this is unsatisfying. I'm also not sure what this will end up doing to the project structure presentation in various IDEs; it would be best if it mirrored the physical layout of the files somewhat.</p>\n\n<p>Note that I'm currently stuck using CMake 2.8.12.2, so many 3.x-only features will not be an option for me.</p>\n"}, {"tags": ["c++", "bison", "flex-lexer"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1554013012, "post_id": 55268968, "comment_id": 97593693, "body": "You write the same code as in the C example."}], "answers": [{"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 0, "last_activity_date": 1553118188, "creation_date": 1553118188, "answer_id": 55270630, "question_id": 55268968, "link": "https://stackoverflow.com/questions/55268968/flex-bison-returning-a-character-token-from-the-scanner-in-c/55270630#55270630", "title": "flex/bison returning a character token from the scanner in C++", "body": "<p>If you use \"complete symbols\" (that is, <code>%define api.token.constructor</code>), you should be able to use the appropriate <code>parser::symbol_type</code> constructor, as shown in the <a href=\"https://www.gnu.org/software/bison/manual/bison.html#Complete-Symbols\" rel=\"nofollow noreferrer\">bison manual section on \"complete symbols\"</a>:</p>\n\n<pre><code>\":\"      return yy::parser::symbol_type (':', loc);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11283659, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/46d79e28349d8a1792428976da8740ea?s=128&d=identicon&r=PG", "display_name": "user11283659", "link": "https://stackoverflow.com/users/11283659/user11283659"}, "is_accepted": false, "score": 1, "last_activity_date": 1554005486, "creation_date": 1554005486, "answer_id": 55437796, "question_id": 55268968, "link": "https://stackoverflow.com/questions/55268968/flex-bison-returning-a-character-token-from-the-scanner-in-c/55437796#55437796", "title": "flex/bison returning a character token from the scanner in C++", "body": "<p>Do not define it at all. It will return as the literal and you will be able to use it in parser as '+'</p>\n"}], "owner": {"reputation": 616, "user_id": 54018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c27595a95f32ce8bc43a54189ad205ee?s=128&d=identicon&r=PG", "display_name": "Dushara", "link": "https://stackoverflow.com/users/54018/dushara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1554005486, "creation_date": 1553110834, "question_id": 55268968, "link": "https://stackoverflow.com/questions/55268968/flex-bison-returning-a-character-token-from-the-scanner-in-c", "title": "flex/bison returning a character token from the scanner in C++", "body": "<p>I'm using the calc++ example found in the bison documentation as a starting point to a more complex grammar. One thing I haven't been able to figure out is how to return a character (literal) token from flex to bison.</p>\n\n<p>In pure C examples, I've seen flex simply returning the token as:</p>\n\n<pre><code>\"+\"         { count(); return('+'); }\n</code></pre>\n\n<p>The calc++ example simply uses token symbols:</p>\n\n<pre><code>\"+\"        return yy::parser::make_PLUS   (loc);\n</code></pre>\n\n<p>But this forces me to use PLUS instead of '+' in the grammar file.</p>\n\n<p>How can I get flex to return a literal value as in the C example when generating C++ code?</p>\n"}, {"tags": ["c++", "c++11", "templates", "traits"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553110920, "post_id": 55268943, "comment_id": 97268971, "body": "either I am completly misunderstanding something or your trait is basically only &quot;implementation details&quot;, so whats wrong about exposing them? There is nothing to hide, or do I miss something?"}, {"owner": {"reputation": 121, "user_id": 3934189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f65f803fed248e2884d90732fdd0fdd?s=128&d=identicon&r=PG&f=1", "display_name": "nvevg", "link": "https://stackoverflow.com/users/3934189/nvevg"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553111191, "post_id": 55268943, "comment_id": 97269111, "body": "@user463035818, that&#39;s what definitely bothers me in terms of &quot;good code&quot; - exposing StandardTraits and NonStandardTraits as a direct public inheritors of TraitsImpl. Shouldn&#39;t I hide this fact?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1553111503, "post_id": 55268943, "comment_id": 97269257, "body": "who cares if one inherits form the other? Just as an example, i&#39;d maybe even write <code>NonStandardInfo&lt;2&gt;</code> as <code>template &lt;&gt; struct StandardInfo&lt;2&gt; : std::integral_constant&lt;std::uint32_t, 19&gt; {};</code> instead of using <code>using</code>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1553111549, "post_id": 55268943, "comment_id": 97269282, "body": "I think you are overthinking something where there is no actual problem"}], "owner": {"reputation": 121, "user_id": 3934189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f65f803fed248e2884d90732fdd0fdd?s=128&d=identicon&r=PG&f=1", "display_name": "nvevg", "link": "https://stackoverflow.com/users/3934189/nvevg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553110739, "creation_date": 1553110739, "question_id": 55268943, "link": "https://stackoverflow.com/questions/55268943/carrying-out-traits-implementation-details", "title": "Carrying out traits implementation details", "body": "<p>Initially, I have a set of some traits StandardInfo and an auxiliary wrapper template StandardTraits full of static methods doing something with StandardInfo:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n#include &lt;cstdint&gt;\n\ntemplate &lt;std::uint32_t Id&gt;\nstruct StandardInfo\n{ };\n\ntemplate &lt;&gt;\nstruct StandardInfo&lt;1&gt;\n{\n    using Field1 = std::integral_constant&lt;std::uint32_t, 42&gt;;\n};\n\ntemplate &lt;&gt;\nstruct StandardInfo&lt;2&gt;\n{\n    using Field1 = std::integral_constant&lt;std::uint32_t, 19&gt;;\n};\n\n// and more StandardInfo specifications...\n\n\n\ntemplate &lt;std::uint32_t Id&gt;\nstruct StandardTraits\n{  \n    using Info = StandardInfo&lt;Id&gt;;\n    static void DoFoo() { std::cout &lt;&lt; Info::Field1::value; }\n};\n\n\n\nint main()\n{\n    StandardTraits&lt;1&gt;::DoFoo();\n    return 0;\n}\n</code></pre>\n\n<p>Suppose I need to introduce another non-standard type trait. All of the StandardInfo specializations are automatically generated and I am not supposed to change that order of things. So I have to introduce NonStandartInfo trait. Therefore, I need NonStandardTraits wrapper containing same methods as in StandardTraits. It turns out that StandardTraits and NonStandardTraits differs only in Info type alias. Copy-pasting the implementation seems dubious, so it seems I need to carry out the wrapper implementation into kind of TraitsImpl and not to change existing code that already uses StandardTraits. \n</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n#include &lt;cstdint&gt;\n\ntemplate &lt;std::uint32_t Id&gt;\nstruct StandardInfo\n{ };\n\ntemplate &lt;&gt;\nstruct StandardInfo&lt;1&gt;\n{\n    using Field1 = std::integral_constant&lt;std::uint32_t, 42&gt;;\n};\n\ntemplate &lt;&gt;\nstruct StandardInfo&lt;2&gt;\n{\n    using Field1 = std::integral_constant&lt;std::uint32_t, 19&gt;;\n};\n\n// and more StandardInfo specifications...\n\ntemplate &lt;std::uint32_t Id&gt;\nstruct NonStandardInfo\n{ };\n\ntemplate &lt;&gt;\nstruct NonStandardInfo&lt;1&gt;\n{\n    using Field1 = std::integral_constant&lt;int, -1&gt;;\n};\n\ntemplate &lt;&gt;\nstruct NonStandardInfo&lt;2&gt;\n{\n    using Field1 = std::integral_constant&lt;int, -2&gt;;\n};\n\ntemplate &lt;typename Info&gt;\nstruct TraitsImpl\n{\n    static void DoFoo() { std::cout &lt;&lt; Info::Field1::value; }\n};\n\ntemplate &lt;std::uint32_t Id&gt;\nstruct StandardTraits: TraitsImpl&lt;StandardInfo&lt;Id&gt; &gt;\n{  \n\n};\n\ntemplate &lt;std::uint32_t Id&gt;\nstruct NonStandardTraits: TraitsImpl&lt;NonStandardInfo&lt;Id&gt; &gt;\n{    \n};\n\n\nint main()\n{\n    StandardTraits&lt;1&gt;::DoFoo();\n    NonStandardTraits&lt;1&gt;::DoFoo();\n    return 0;\n}\n</code></pre>\n\n<p>But doesn't it expose implementation details (via the public inheritance)? Inheriting private and proxying calls looks silly too. Is there any more elegant approach?</p>\n"}, {"tags": ["c++", "opengl", "box2d"], "answers": [{"tags": [], "owner": {"reputation": 251, "user_id": 6359070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vyVqW.png?s=128&g=1", "display_name": "Aether", "link": "https://stackoverflow.com/users/6359070/aether"}, "is_accepted": false, "score": 0, "last_activity_date": 1553127080, "creation_date": 1553127080, "answer_id": 55271953, "question_id": 55268921, "link": "https://stackoverflow.com/questions/55268921/changing-origin-point-of-an-object-makes-it-move-in-a-different-axis/55271953#55271953", "title": "Changing origin point of an object makes it move in a different axis", "body": "<p>Solved the main problem, after printing the matrix on the console I realized that the fourth column was been replaced from x y 0 1 to 0 x 0 y. </p>\n\n<p>Changed the code from this:</p>\n\n<pre><code>model = math::translate(model, iVec3(0.5f * size.x, 0.5f * size.y, 0.0f));\nmodel = math::rotate(model, rotation, iVec3(0.0f, 0.0f, 1.0f));\nmodel = math::translate(model, iVec3(-0.5f * size.x, -0.5f * size.y, 0.0f));\n</code></pre>\n\n<p>to this and it's done!</p>\n\n<pre><code>iMat4x4 tempModel;\niMat4x4 tempModel2;\n\n\ntempModel = math::translate(tempModel, iVec3(0.5f * size.x, 0.5f * size.y, 0.0f));\nmodel[3].z = model[3].w = 0;\nmodel[3] = model[3] + tempModel[3];\n\nmodel = math::rotate(model, rotation, iVec3(0.0f, 0.0f, 1.0f));\n\ntempModel2 = math::translate(tempModel2, iVec3(-0.5f * size.x, -0.5f * size.y, 0.0f));\nmodel[3].z = model[3].w = 0;\nmodel[3] = model[3] + tempModel2[3];\n</code></pre>\n\n<p>Still didn't get the rotation I wanted, but at least other functions work.</p>\n"}], "owner": {"reputation": 251, "user_id": 6359070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vyVqW.png?s=128&g=1", "display_name": "Aether", "link": "https://stackoverflow.com/users/6359070/aether"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553127080, "creation_date": 1553110654, "question_id": 55268921, "link": "https://stackoverflow.com/questions/55268921/changing-origin-point-of-an-object-makes-it-move-in-a-different-axis", "title": "Changing origin point of an object makes it move in a different axis", "body": "<p>I've been working with this GameObject(which utilizes Box2D) and Renderer2D class for some time now, and I haven't had any problems. That was till I decided to add the option to rotate an object. All works fine (or that seems to be) with box 2D, but the object when seen on screen moves in the wrong axis, it becomes smaller when moving Up and bigger when moving down (or closer and further away from the camera).</p>\n\n<p>The only three lines I have added to the Renderer2D script are this:</p>\n\n<pre><code>    model = math::translate(model, iVec3(0.5f * size.x, 0.5f * size.y, 0.0f));\n    model = math::rotate(model, rotation, iVec3(0.0f, 0.0f, 1.0f));\n    model = math::translate(model, iVec3(-0.5f * size.x, -0.5f * size.y, 0.0f));\n</code></pre>\n\n<p>If I just remove those lines everything works fine, but I want the object to rotate so I can't remove them.</p>\n\n<p>This is the whole Rendering Function:</p>\n\n<pre><code>void Renderer2D::Render(Texture &amp; texture, iVec2 position, iVec2 size, float rotation, Color color, iVec2 tiling) {\n    this-&gt;shader.Use();\n    iMat4x4 model;\n\n    model = math::translate(model, iVec3(position, 0.0f));\n\n    model = math::translate(model, iVec3(0.5f * size.x, 0.5f * size.y, 0.0f));\n    model = math::rotate(model, rotation, iVec3(0.0f, 0.0f, 1.0f));\n    model = math::translate(model, iVec3(-0.5f * size.x, -0.5f * size.y, 0.0f));\n\n    model = math::scale(model, iVec3(size, 1.0f));\n\n    this-&gt;shader.SetMatrix4(\"model2D\", model);\n    this-&gt;shader.SetVector3f(\"spriteColor\", iVec3(color.r, color.g, color.b));\n    this-&gt;shader.SetVector2f(\"tiling\", tiling);\n\n    glActiveTexture(GL_TEXTURE0);\n    texture.Bind();\n\n    glBindVertexArray(this-&gt;QuadVAO);\n    glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, nullptr);\n    glBindVertexArray(0);\n}\n</code></pre>\n\n<p>I move the GameObject with the Velocity variable of Box2D, like this:</p>\n\n<pre><code>float horizontal, vertical;\n        if (Input::GetKeyDown(Input::Key.A) || Input::GetKeyDown(Input::Key.D)) {\n            if (Input::GetKeyDown(Input::Key.A))\n                horizontal = -1;\n            else if (Input::GetKeyDown(Input::Key.D))\n                horizontal = +1;\n        }\n        else horizontal = 0;\n\n        if (Input::GetKeyDown(Input::Key.W) || Input::GetKeyDown(Input::Key.S)) {\n            if (Input::GetKeyDown(Input::Key.W))\n                vertical = -1;\n            else if (Input::GetKeyDown(Input::Key.S))\n                vertical = +1;\n        }\n        else vertical = 0;\n\n        Rigidbody2D-&gt;Velocity = iVec2(horizontal, vertical) * speed;\n</code></pre>\n\n<p>I really have tried everything and still don't know if it's a Camera problem or a Renderer or a Box2D. Tried altering the far and near values of the view matrix, still the same result.</p>\n"}, {"tags": ["c++", "ros", "robotics", "robot"], "answers": [{"comments": [{"owner": {"reputation": 90, "user_id": 10666991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a8ed2aa590dc61c12f19caaa731db61?s=128&d=identicon&r=PG&f=1", "display_name": "Ofir", "link": "https://stackoverflow.com/users/10666991/ofir"}, "edited": false, "score": 0, "creation_date": 1553134241, "post_id": 55270358, "comment_id": 97276630, "body": "Thank you, I tried to use &quot;remap&quot;, as you suggested but it still doesn&#39;t work. I still have no publisher to &quot;my_robot_name/scan&quot; but only to &quot;/scan&quot;. Subscriber I have in both cases. Here is my updated launch file and my definitions: <a href=\"https://pastebin.com/JQzGVAAs\" rel=\"nofollow noreferrer\">pastebin.com/JQzGVAAs</a> . Do you know what the problem is? Thank you @maetulj"}, {"owner": {"reputation": 1002, "user_id": 2912912, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vHAKG.png?s=128&g=1", "display_name": "maetulj", "link": "https://stackoverflow.com/users/2912912/maetulj"}, "reply_to_user": {"reputation": 90, "user_id": 10666991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a8ed2aa590dc61c12f19caaa731db61?s=128&d=identicon&r=PG&f=1", "display_name": "Ofir", "link": "https://stackoverflow.com/users/10666991/ofir"}, "edited": false, "score": 0, "creation_date": 1553164210, "post_id": 55270358, "comment_id": 97286593, "body": "@Ofir I think I made a mistake there. Try to swap <code>from</code> and <code>to</code> topics. I always forget which one is which :)"}], "tags": [], "owner": {"reputation": 1002, "user_id": 2912912, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vHAKG.png?s=128&g=1", "display_name": "maetulj", "link": "https://stackoverflow.com/users/2912912/maetulj"}, "is_accepted": false, "score": 0, "last_activity_date": 1553116716, "creation_date": 1553116716, "answer_id": 55270358, "question_id": 55268866, "link": "https://stackoverflow.com/questions/55268866/doesnt-get-robots-scan-events-ros/55270358#55270358", "title": "Doesn&#39;t get robots /scan events [ROS]", "body": "<p>Based on you saying than no one publishes to the topic, it is no wonder that you don't get any messages. If you want to get the messages you need firstly to publish the message.</p>\n\n<p>The problem you are having is that <code>/scan</code> is a topic in the <strong>global namespace</strong> (prefix <code>/</code>). To publish it to the desired namespace you can change it in the publisher:</p>\n\n<ul>\n<li><p>publish to the desired namespace <code>ros::Publisher publisher = n.advertise&lt;topic&gt;(\"my_robot_name/scan\", 1);</code></p></li>\n<li><p>use a <a href=\"http://wiki.ros.org/roslaunch/XML/group\" rel=\"nofollow noreferrer\">group</a> in the launch file</p></li>\n</ul>\n\n<p>If you don't have any influence on the publisher you can use <a href=\"http://wiki.ros.org/roslaunch/XML/remap\" rel=\"nofollow noreferrer\">remap</a> and remap it to the desired topic:</p>\n\n<pre><code>&lt;node ...start your node...&gt;\n    &lt;remap from=\"/scan\" to=\"my_robot_name/scan\" /&gt;\n&lt;/node&gt;\n</code></pre>\n\n<p>this way <code>my_robot_name/scan</code> topic will be available for your callback in the node.</p>\n"}], "owner": {"reputation": 90, "user_id": 10666991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a8ed2aa590dc61c12f19caaa731db61?s=128&d=identicon&r=PG&f=1", "display_name": "Ofir", "link": "https://stackoverflow.com/users/10666991/ofir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553116716, "creation_date": 1553110412, "last_edit_date": 1553111539, "question_id": 55268866, "link": "https://stackoverflow.com/questions/55268866/doesnt-get-robots-scan-events-ros", "title": "Doesn&#39;t get robots /scan events [ROS]", "body": "<p>I'm trying to get robot /scan events notification. \nIt works for me: </p>\n\n<pre><code>// Subscribe to the simulated robot's laser scan topic\nlaserSub = nh.subscribe(\"/scan\", 1, &amp;MyObject::scanCallback, this);\n</code></pre>\n\n<p>But when I change the topic to my_robot_name/scan, it doesn't work: I don't get any robot scan notification to my callback.</p>\n\n<pre><code>// Subscribe to the simulated robot's laser scan topic\nlaserSub = nh.subscribe(my_robot_name + \"/scan\", 1, &amp;MyObject::scanCallback, this);\n</code></pre>\n\n<p>I run \"rostopic info my_robot_name/scan\", and it looks that no publisher to my_robot_name/scan at all. </p>\n\n<p>How can I solve this? \nThanks in advance. </p>\n"}, {"tags": ["c++", "xcode", "istream"], "comments": [{"owner": {"reputation": 3797, "user_id": 2874856, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kWxOm.jpg?s=128&g=1", "display_name": "Raindrop7", "link": "https://stackoverflow.com/users/2874856/raindrop7"}, "edited": false, "score": 0, "creation_date": 1553109380, "post_id": 55268460, "comment_id": 97268214, "body": "Does this happen under normal conditions and before EOF ? <code>while (!(ins &gt;&gt; val)) {</code>? Your program waits en error or <code>EOF</code> to execute the body of while loop. Make it simpler: <code>while(ins &gt;&gt; val){}</code>"}, {"owner": {"reputation": 6583, "user_id": 10426037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6723e3123b9a13d6360d1ee755f8728?s=128&d=identicon&r=PG&f=1", "display_name": "Valentino", "link": "https://stackoverflow.com/users/10426037/valentino"}, "edited": false, "score": 1, "creation_date": 1553109510, "post_id": 55268460, "comment_id": 97268299, "body": "Hello! When asking for help with your code, please provide a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553109532, "post_id": 55268460, "comment_id": 97268313, "body": "what do you think <code>while (!(ins &gt;&gt; val))</code> is doing?"}, {"owner": {"reputation": 59, "user_id": 11233089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xRaOY.jpg?s=128&g=1", "display_name": "tanto_", "link": "https://stackoverflow.com/users/11233089/tanto"}, "edited": false, "score": 0, "creation_date": 1553109970, "post_id": 55268460, "comment_id": 97268520, "body": "Sorry guys, new to StackOverflow. The file never goes into eof. Not entirely sure what you mean by &quot;normal conditions&quot; but I run &#39;input_file.good()&#39; before the loop. If it weren&#39;t in a &quot;good&quot; state the program would inform me, meaning that when it gets to the loop everything is fine.                                                           while (!(ins &gt;&gt; val)) should only run if the input is NOT an int. I only want an int out of the istream. &quot;discard&quot; is my attempt to get rid of anything that isn&#39;t an int."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553110227, "post_id": 55268460, "comment_id": 97268648, "body": "Please read about <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and show an example input, the output and expected output"}], "answers": [{"tags": [], "owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "is_accepted": true, "score": 0, "last_activity_date": 1553123788, "creation_date": 1553123788, "answer_id": 55271502, "question_id": 55268460, "link": "https://stackoverflow.com/questions/55268460/istream-opening-txt-file-but-not-actually-gathering-the-text-within-the-file/55271502#55271502", "title": "istream opening .txt file but not actually gathering the text within the file", "body": "<p>Here's a short example that shows:</p>\n\n<ul>\n<li>How to read lines in a file</li>\n<li>How to check for the end of the file</li>\n<li>How to write to a file </li>\n<li>How to append to a file that already exists</li>\n</ul>\n\n<p>I hope it clarifies things. The question was a bit difficult to answer directly, because you never explain what <code>ins</code> is. </p>\n\n<pre><code>#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n\nusing std::string; \nusing std::ifstream; \nusing std::ofstream; \nusing std::vector; \n\nvoid append_to_file(string const&amp; filename, string const&amp; text) \n{\n    // Open the file in append mode\n    ofstream file(filename, std::ios_base::app);\n    // Write the text to the file\n    file &lt;&lt; text; \n}\nvoid write_to_file(string const&amp; filename, string const&amp; text) \n{\n    // Clear the file and open it\n    ofstream file(filename); \n    file &lt;&lt; text; \n}\n\n// Read all the lines in the file\nvector&lt;string&gt; read_all_lines(string const&amp; filename)\n{\n    ifstream file(filename); \n\n    vector&lt;string&gt; lines;\n    while(not file.eof() &amp;&amp; not file.fail()) {\n        // Get the line\n        std::string line;\n        std::getline(file, line);\n        // Add the line into the vector\n        lines.push_back(std::move(line)); \n    }\n    return lines; \n}\nint main() \n{\n    string filename = \"test-file.txt\"; \n\n    // Clear the file and write \n    write_to_file(filename, \"This is a sentence.\\n\"); \n\n    // Append some additional text to the file: \n    append_to_file(filename, \"This is some additional text\"); \n\n    // Read all the lines in the file we wrote: \n    vector&lt;string&gt; lines = read_all_lines(filename); \n\n    // Print the lines we read: \n    for(auto&amp; line : lines) {\n        std::cout &lt;&lt; line &lt;&lt; '\\n'; \n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 11233089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xRaOY.jpg?s=128&g=1", "display_name": "tanto_", "link": "https://stackoverflow.com/users/11233089/tanto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 55271502, "answer_count": 1, "score": -1, "last_activity_date": 1564726557, "creation_date": 1553108892, "last_edit_date": 1564726557, "question_id": 55268460, "link": "https://stackoverflow.com/questions/55268460/istream-opening-txt-file-but-not-actually-gathering-the-text-within-the-file", "title": "istream opening .txt file but not actually gathering the text within the file", "body": "<p>edit: RESOLVED. Moved <code>ins &gt;&gt; val</code> to precede the loop then put <code>ins.fail()</code> as the condition. I'm not entirely sure why this helped but it did and I will gladly be moving forward.</p>\n\n<p>Original post:</p>\n\n<p>I'm having an issue with the code below. For some reason, it reads in <code>file.txt</code> and comes back as good but it the istream is reading input as if the file is blank. For reference, I'm working in Xcode. I've tried playing around with the scheme but nothing seems to work. I just don't understand how it's successfully reading in the file (I run a check in  some of the <code>...</code> code and it says the file was opened successfully) but yet isn't pulling in any of the input.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\nusing namespace std;\n\nint main() {  \n    ifstream inFile;\n    inFile.open(\"file.txt\");\n\n    // There exists a class called Position that isn't important for\n    // this but just clarifying\n    Position pos;\n    pos.read(inFile);\n\n    return 0;\n}\n\nvoid Position::read(istream&amp; ins) {\n    int val;\n    char discard;\n    while (!(ins &gt;&gt; val)) {\n        ins.clear();\n        ins &gt;&gt; discard;\n    }\n}\n</code></pre>\n\n<p>I'm relatively new to this, only been coding for about 6 months now. I would greatly appreciate any explanations. Thanks folks!</p>\n\n<p>edit: the intention of this code is to pull in input from the file in the form of ints. If the input is anything other than an <code>int</code>, the loop will reset to good state and pull in the non-int as a <code>char</code>. I don't care as much about the fact that the actual text of the file is seemingly disappearing. The code was provided primarily for a bit of context.</p>\n\n<p>Apologies for my lack of familiarity with Stack!</p>\n\n<p>edit2: If i run the loop like this:</p>\n\n<pre><code>while (!(ins &gt;&gt; val)) {\n    ins.clear();\n    ins &gt;&gt; discard;\n    cout &lt;&lt; discard;\n}\n</code></pre>\n\n<p>It goes into an infinite loop because there is no input from the file.\nNot exactly sure how I would show I/O for this since the problem is that there isn't any input and therefore no output. When I test, it just runs and runs and runs until I stop it. The actual .txt file is NOT empty but it is somehow being treated as if it is.</p>\n\n<p>edit3: Adding a few more lines as an attempt at clarification of what exactly is happening.</p>\n\n<p>Thanks again!</p>\n"}, {"tags": ["c++", "multithreading", "asynchronous"], "comments": [{"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 1, "creation_date": 1553109750, "post_id": 55268324, "comment_id": 97268406, "body": "Note: <code>packaged_task</code> is thread-agnostic. It&#39;s just a wrapper for a function that returns a result, and a <code>future</code> that can await and accesses the result. It doesn&#39;t automatically call the function. The client has to explicitly do that by invoking the task&#39;s <code>operator()</code>, and whatever thread invokes <code>operator()</code>, that&#39;s the thread that the function runs in."}], "owner": {"reputation": 1604, "user_id": 6085595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fa066abb138dd22f51932878d3364cb0?s=128&d=identicon&r=PG&f=1", "display_name": "DiveIntoML", "link": "https://stackoverflow.com/users/6085595/diveintoml"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 1, "closed_date": 1553108509, "answer_count": 0, "score": 1, "last_activity_date": 1553108385, "creation_date": 1553108385, "question_id": 55268324, "link": "https://stackoverflow.com/questions/55268324/with-c-stdasync-why-do-we-need-packaged-task-and-promise", "closed_reason": "Duplicate", "title": "With C++ std::async, why do we need packaged_task and promise?", "body": "<p>I'm learning about C++ thread library, and I feel the async, packaged_task and promise are doing things that are pretty similar: they all run a function asynchronously in a separate thread, and return a future object that stores the function's return value. So I do not quite understand why we need all three of them, instead of always using async. </p>\n\n<p>Below is an example code from <a href=\"https://en.cppreference.com/w/cpp/thread/future\" rel=\"nofollow noreferrer\">std::future documentation</a>:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;future&gt;\n#include &lt;thread&gt;\n\nint main()\n{\n    // future from a packaged_task\n    std::packaged_task&lt;int()&gt; task([]{ return 7; }); // wrap the function\n    std::future&lt;int&gt; f1 = task.get_future();  // get a future\n    std::thread t(std::move(task)); // launch on a thread\n\n    // future from an async()\n    std::future&lt;int&gt; f2 = std::async(std::launch::async, []{ return 8; });\n\n    // future from a promise\n    std::promise&lt;int&gt; p;\n    std::future&lt;int&gt; f3 = p.get_future();\n    std::thread( [&amp;p]{ p.set_value_at_thread_exit(9); }).detach();\n\n    std::cout &lt;&lt; \"Waiting...\" &lt;&lt; std::flush;\n    f1.wait();\n    f2.wait();\n    f3.wait();\n    std::cout &lt;&lt; \"Done!\\nResults are: \"\n          &lt;&lt; f1.get() &lt;&lt; ' ' &lt;&lt; f2.get() &lt;&lt; ' ' &lt;&lt; f3.get() &lt;&lt; '\\n';\n    t.join();\n}  \n</code></pre>\n\n<p>and this example at least shows under certain circumstances, std::async can replace the other two. Can someone give an example that I have to use promise or packaged_task where the std::async is not enough to do the job?</p>\n"}, {"tags": ["c++", "c++11", "templates", "eigen", "copy-elision"], "comments": [{"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 1, "creation_date": 1553123107, "post_id": 55268189, "comment_id": 97273994, "body": "How is <code>matrix</code> a local temporary in the code you provide? Perhaps add a snippet of how you call <code>value</code>. Can <code>SomeContainer</code> be something other than <code>Eigen::Matrix</code> (and is that part of this question)?"}, {"owner": {"reputation": 79, "user_id": 5547881, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uFih4pGqHYQ/AAAAAAAAAAI/AAAAAAAAByU/50BOHHiuP58/photo.jpg?sz=128", "display_name": "Bernard GODARD", "link": "https://stackoverflow.com/users/5547881/bernard-godard"}, "reply_to_user": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 0, "creation_date": 1553253573, "post_id": 55268189, "comment_id": 97325295, "body": "@chtz see my edit. Also I am using other Type&lt;T&gt; (not necessarily containers) for which I define value(Type&lt;T&gt;) returning Type&lt;double&gt;, but it is not a part of this question."}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 0, "creation_date": 1553267853, "post_id": 55268189, "comment_id": 97333888, "body": "It is always a question you need to consider, if you want to have copies or references/views. I posted an answer which would create views in both cases."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 5547881, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uFih4pGqHYQ/AAAAAAAAAAI/AAAAAAAAByU/50BOHHiuP58/photo.jpg?sz=128", "display_name": "Bernard GODARD", "link": "https://stackoverflow.com/users/5547881/bernard-godard"}, "edited": false, "score": 0, "creation_date": 1553276026, "post_id": 55302475, "comment_id": 97338464, "body": "Thank you for this. I like the unaryExpr and I would use it for all cases (no need for std::enable_if). In the benchmark I have with Matrix&lt;double,3,3&gt; comparing norm(value) and norm() there is no overhead. However I have to support C++11 standard my compiler gives a warning about auto keyword. I tried using decltype, but it does not support lambdas. Also Eigen documentation specifies return type as const CwiseUnaryOp&lt;CustomUnaryOp, const Derived&gt; but I don&#39;t think I can specify CustomUnaryOp."}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "reply_to_user": {"reputation": 79, "user_id": 5547881, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uFih4pGqHYQ/AAAAAAAAAAI/AAAAAAAAByU/50BOHHiuP58/photo.jpg?sz=128", "display_name": "Bernard GODARD", "link": "https://stackoverflow.com/users/5547881/bernard-godard"}, "edited": false, "score": 0, "creation_date": 1553299225, "post_id": 55302475, "comment_id": 97346561, "body": "You can replace the lambda expression by a free function outside the <code>value</code> function. I think then <code>-&gt;decltype(...)</code> should work."}], "tags": [], "owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "is_accepted": true, "score": 1, "last_activity_date": 1553267734, "last_edit_date": 1553267734, "creation_date": 1553266896, "answer_id": 55302475, "question_id": 55268189, "link": "https://stackoverflow.com/questions/55268189/c-function-template-that-return-its-unique-argument-without-copying-it-for-c/55302475#55302475", "title": "C++ (function) template that return its unique argument without copying it for certain types", "body": "<p>You need to return <code>matrix.derived()</code> if you want to have a reference to the encapsulated type:</p>\n\n<pre><code>template &lt; typename Derived,\n    typename std::enable_if&lt; std::is_floating_point&lt; typename Derived::Scalar &gt;::value, int &gt;::type = 0 &gt;\nconst Derived&amp; value( const Eigen::MatrixBase&lt; Derived &gt;&amp; matrix )\n{\n    return matrix.derived();\n}\n</code></pre>\n\n<p>Regarding <code>value(Matrix&lt;MyType&gt; const&amp;)</code>, you can implement that in a way that it returns just a view, essentially like this (requires C++14, or some more implementation work):</p>\n\n<pre><code>template &lt; typename Derived,\n    typename std::enable_if&lt; std::is_same&lt; typename Derived::Scalar, MyType &gt;::value, int &gt;::type = 0 &gt;\nauto value( const Eigen::MatrixBase&lt; Derived &gt;&amp; matrix )\n{\n    // If `x.value()` returns by value, better use `unaryExpr` instead of `unaryViewExpr`:\n    return matrix.unaryViewExpr([](const MyType&amp; x){ return x.value();} );\n}\n</code></pre>\n\n<p>Godbolt-Link: <a href=\"https://godbolt.org/z/qcYKnw\" rel=\"nofollow noreferrer\">https://godbolt.org/z/qcYKnw</a>\nNo warnings are generated and both <code>foo1</code> and <code>foo2</code> just tail-call the <code>norm</code> function. <code>foo3</code> has some small overhead, which likely would get optimized away if <code>norm</code> was inlined.</p>\n"}], "owner": {"reputation": 79, "user_id": 5547881, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uFih4pGqHYQ/AAAAAAAAAAI/AAAAAAAAByU/50BOHHiuP58/photo.jpg?sz=128", "display_name": "Bernard GODARD", "link": "https://stackoverflow.com/users/5547881/bernard-godard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 55302475, "answer_count": 1, "score": 0, "last_activity_date": 1553267734, "creation_date": 1553107938, "last_edit_date": 1553253466, "question_id": 55268189, "link": "https://stackoverflow.com/questions/55268189/c-function-template-that-return-its-unique-argument-without-copying-it-for-c", "title": "C++ (function) template that return its unique argument without copying it for certain types", "body": "<p>I have a function value(x) which is overloaded for many types such that:</p>\n\n<pre><code>double value(double x) { return x; }\ndouble value(MyType x) { return x.value(); }\nSomeContainer&lt;double&gt; value(SomeContainer&lt;double&gt; x) { return x; }\nSomeContainer&lt;double&gt; value(SomeContainer&lt;MyType&gt; x) { ... }\n</code></pre>\n\n<p>where MyType is actually a number with a gradient vector with respect to a set of parameters.</p>\n\n<p>for use in generic (template) programs.</p>\n\n<p>I want to define:</p>\n\n<pre><code>Matrix&lt;double&gt; value(Matrix&lt;double&gt;)\nMatrix&lt;double&gt; value(Matrix&lt;MyType&gt;)\n</code></pre>\n\n<p>I am using Eigen matrices and this is my current implementation of the first function:</p>\n\n<pre><code>template &lt; typename Derived,\n    typename std::enable_if&lt; std::is_floating_point&lt; typename Derived::Scalar &gt;::value, int &gt;::type = 0 &gt;\nDerived value( const Eigen::MatrixBase&lt; Derived &gt;&amp; matrix )\n{\n    return matrix;\n}\n</code></pre>\n\n<p>The problem is that this seems inefficient unless in possible cases where the compiler can figure out that the result/argument are not being modified and elude the copy. I also cannot return a reference to the argument since it is a local/temporary.</p>\n\n<p>Basically what I would like is for value(x) to be compiled as the argument expression itself if the argument is a Matrix of double/float. I don't see how I can achieve this with a function template and a macro would not allow for specialization. </p>\n\n<p>What could be done to avoid the copy?</p>\n\n<h2>EDIT March 22, 2019:</h2>\n\n<p>If I replace the return type by</p>\n\n<pre><code>const Derived &amp;\n</code></pre>\n\n<p>I get the following GCC warning:</p>\n\n<pre><code>warning: returning reference to temporary [-Wreturn-local-addr]\n</code></pre>\n\n<p>in the following code:</p>\n\n<pre><code>Matrix33 m;\nm &lt;&lt; 1, 2, 3,\n     4, 5, 6,\n     7, 8, 9;\nstd::cout &lt;&lt; m &lt;&lt; std::endl;\nstd::cout &lt;&lt; value(m) &lt;&lt; std::endl;\n</code></pre>\n\n<p>and the value(m) printout is garbage.</p>\n\n<p>Also I am now thinking more and more this would be a bad idea to \"return the object itself\" because it is going to be used in generic code:</p>\n\n<pre><code> auto m = value(Mx)\n</code></pre>\n\n<p>where Mx is a Matrix of X (template parameter) and m is a double matrix.</p>\n\n<p>Having different semantics (stealing the object in case X is double and creating a separate object in other cases) could lead to many programming mistakes. </p>\n\n<p>Another possibility would be to return proxy objects. </p>\n\n<p>The best however would be for the compiler to see when a copy is not needed because nothing is being changed. However this does not seem to be the case: my benchmark to compare</p>\n\n<pre><code>  Matrix&lt;double,3,3&gt; M = ...\n  norm(M)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>  Matrix&lt;double,3,3&gt; M = ...\n  norm(value(M))\n</code></pre>\n\n<p>shows that the second is a bit slower in a release (optimised) build.</p>\n"}, {"tags": ["c++", "openssl"], "answers": [{"comments": [{"owner": {"reputation": 995, "user_id": 2412663, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/82f065b7a2fad5c56a867ede3ec376ec?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/2412663/albert"}, "edited": false, "score": 0, "creation_date": 1553163963, "post_id": 55268285, "comment_id": 97286445, "body": "You are right. All headers from ssl are in <code>&#47;usr&#47;include&#47;openssl</code>, except <code>opensslconf.h</code> that was in <code>&#47;usr&#47;include&#47;x86_64-linux-gnu&#47;openssl</code>.  It&#39;s like developers are making fun of me. I could solve it just adding <code>-isystem &#47;usr&#47;include&#47;x86_64-linux-gnu</code>  Thanks a lot."}], "tags": [], "owner": {"reputation": 839, "user_id": 1135979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59464968f70aff62c07a7da3a0f6ba80?s=128&d=identicon&r=PG", "display_name": "yachoor", "link": "https://stackoverflow.com/users/1135979/yachoor"}, "is_accepted": true, "score": 1, "last_activity_date": 1553108235, "creation_date": 1553108235, "answer_id": 55268285, "question_id": 55267901, "link": "https://stackoverflow.com/questions/55267901/compilation-fails-after-install-library-into-a-path-not-included-in-compilation/55268285#55268285", "title": "Compilation fails after install library into a path not included in compilation", "body": "<p><code>/usr/local/include</code> is in default search paths for your compiler</p>\n\n<p>You can check those by calling <code>echo | g++ -E -v -</code></p>\n\n<p>You should get output similar to this:</p>\n\n<pre><code>...\n#include &lt;...&gt; search starts here:\n /usr/lib/gcc/x86_64-linux-gnu/8/include\n /usr/local/include\n /usr/lib/gcc/x86_64-linux-gnu/8/include-fixed\n /usr/include/x86_64-linux-gnu\n /usr/include\nEnd of search list.\n...\n</code></pre>\n\n<p>By passing <code>-isystem /usr/include</code> you move <code>/usr/include</code> to the top of the search list and headers from openssl 1.0.1 are found first. But <code>&lt;openssl/opensslconf.h&gt;</code> is located elsewhere (for me it's <code>/usr/include/x86_64-linux-gnu/openssl/opensslconf.h</code>) which is searched after <code>/usr/local/include</code>, so the version from openssl 1.1.1 is found first.</p>\n\n<p>You can fix that by locating the directory containing correct opensslconf.h and modifying your build to pass it with <code>-isystem</code> flag</p>\n"}], "owner": {"reputation": 995, "user_id": 2412663, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/82f065b7a2fad5c56a867ede3ec376ec?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/2412663/albert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 0, "accepted_answer_id": 55268285, "answer_count": 1, "score": 0, "last_activity_date": 1553108235, "creation_date": 1553106823, "question_id": 55267901, "link": "https://stackoverflow.com/questions/55267901/compilation-fails-after-install-library-into-a-path-not-included-in-compilation", "title": "Compilation fails after install library into a path not included in compilation", "body": "<h3>Scenario:</h3>\n\n<p>On a Debian 8, I have installed openssl library (both runtime &amp; dev), version 1.0.1t. Those were installed using <code>apt-get</code>. So, default location: <code>/usr/include/</code> and <code>/usr/lib</code>. </p>\n\n<p>I compile a file that uses openssl library: (generated from <code>qmake</code>) </p>\n\n<pre><code>g++ -c -pipe -O2 -fPIC -std=gnu++11 -Wall -W -DHAVE_OPENSSL -D_REENTRANT -DENABLE_IPV6 -DTIXML_USE_STL -DBOOST_FILESYSTEM_DEPRECATED -DQT_NO_DEBUG -I. -I. -Isrc -Isrc/engine -Isrc/gui -Isrc/gui/qt -Isrc/gui/qt/qttools -Isrc/net -Isrc/engine/local_engine -Isrc/engine/network_engine -Isrc/config -Isrc/core -Isrc/third_party/websocketpp -isystem /usr/include -isystem /usr/include/mysql -isystem /usr/include/mysql++ -I/opt/gsasl/include -I~/Qt/5.9.0_static/mkspecs/linux-g++ -o obj/crypthelper.o src/core/common/crypthelper.cpp\n</code></pre>\n\n<p>It works perfect. Please, note that there is no <code>/usr/local/</code> headers included. </p>\n\n<h3>Target:</h3>\n\n<p>Do the same using openssl 1.1.1b (to reproduce a bug) </p>\n\n<p>I install openssl 1.1.1b from source (without removing 1.0.1t), which installs into <code>/usr/local</code>.<br>\nFirst, to make sure nothing has changed, I run same command (which has no reference to <code>/usr/local</code>), and it complains: </p>\n\n<pre><code>In file included from /usr/include/openssl/evp.h:66:0,\n                 from /usr/include/openssl/x509.h:73,\n                 from /usr/include/openssl/ssl.h:156,\n                 from src/core/openssl_wrapper.h:75,\n                 from src/core/common/crypthelper.cpp:34:\n/usr/local/include/openssl/opensslconf.h:20:3: error: #error OPENSSL_ALGORITHM_DEFINES no longer supported    &lt;---- WHY???\n # error OPENSSL_ALGORITHM_DEFINES no longer supported\n</code></pre>\n\n<p>Why does it complain from a file located in <code>/usr/local</code>? Why does it include?<br>\nThere is no reference to this directory! I don't understand. </p>\n\n<p>PD: Sorry for title, nothing better came to me. Feel free to correct it. </p>\n"}, {"tags": ["c++", "multithreading", "optimization"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1553106846, "post_id": 55267878, "comment_id": 97266920, "body": "Beware that locking or unlocking mutex objects directly is looking for trouble. <a href=\"https://en.cppreference.com/w/cpp/thread/unique_lock\" rel=\"nofollow noreferrer\"><code>std::unique_lock</code></a> is an RAII wrapper for managing locks safely."}, {"owner": {"reputation": 2062, "user_id": 736987, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0009b73d4342f7aa929dce6c6cbb274b?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/736987/evan"}, "edited": false, "score": 1, "creation_date": 1553107113, "post_id": 55267878, "comment_id": 97267061, "body": "If the drive is a spinning disk versus an SSD, you may find asking for multiple reads of different files concurrently is actually slower not faster."}, {"owner": {"reputation": 181, "user_id": 10842789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DBXOW.png?s=128&g=1", "display_name": "Scamtex", "link": "https://stackoverflow.com/users/10842789/scamtex"}, "reply_to_user": {"reputation": 2062, "user_id": 736987, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0009b73d4342f7aa929dce6c6cbb274b?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/736987/evan"}, "edited": false, "score": 0, "creation_date": 1553108007, "post_id": 55267878, "comment_id": 97267551, "body": "@Evan thanks I considered this, for now I will assume the use of SSD"}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "edited": false, "score": 0, "creation_date": 1553273498, "post_id": 55267878, "comment_id": 97337205, "body": "Yes, condition variables are what you want when you would otherwise be busy-waiting on a mutex."}], "owner": {"reputation": 181, "user_id": 10842789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DBXOW.png?s=128&g=1", "display_name": "Scamtex", "link": "https://stackoverflow.com/users/10842789/scamtex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553107895, "creation_date": 1553106733, "last_edit_date": 1553107895, "question_id": 55267878, "link": "https://stackoverflow.com/questions/55267878/multithreaded-filesystem-scan-optimization", "title": "Multithreaded filesystem scan optimization", "body": "<p>What this program does is it scans the harddrive for all files. While the main thread is filling a queue with all the file paths, multiple worker threads start further inspection on the files. Right now I have this code:</p>\n\n<p><strong>Scanner.cpp</strong></p>\n\n<pre><code>#include \"Scanner.h\"\n\nScanner::Scanner() : fsscan_done(false)\n{\n    num_threads = thread::hardware_concurrency() - 1;\n}\n\nvoid Scanner::ScanFile(fs::path path)\n{\n    ifstream file(path.c_str());\n    if (file.is_open())\n    {\n        // further inspection\n    }\n}\n\nvoid Scanner::ThreadScan()\n{\n    while (!fsscan_done || !files.empty()) {\n        unique_lock&lt;mutex&gt; lock(mtx);\n        if (files.empty()) {\n            lock.unlock();\n            continue;\n        }\n        fs::path path = files.front();\n        files.pop();\n        lock.unlock();\n        ScanFile(path);\n    }\n}\n\nvoid Scanner::Scan()\n{    \n    vector&lt;thread&gt; thread_pool;\n    for (int i = 0; i &lt; num_threads; i++)\n        thread_pool.push_back(thread(&amp;Scanner::ThreadScan, this));\n\n    ScanDirectory(\"C:\\\\\");\n    fsscan_done = true;\n\n    for (int i = 0; i &lt; num_threads; i++)\n        thread_pool[i].join();\n}\n\nvoid Scanner::ScanDirectory(fs::path directory)\n{\n    for (const auto &amp; entry : fs::directory_iterator(directory)) {\n        if (fs::is_directory(entry.path()))\n            ScanDirectory(entry.path());\n        else {\n            if (!fs::is_regular_file(entry.path())) continue;\n            unique_lock&lt;mutex&gt; lock(mtx);\n            files.push(entry.path());\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Scanner.h</strong></p>\n\n<pre><code>#pragma once\n#include &lt;iostream&gt;\n#include &lt;filesystem&gt;\n#include &lt;fstream&gt;\n#include &lt;mutex&gt;\n#include &lt;string&gt;\n#include &lt;thread&gt;\n#include &lt;queue&gt;\n\nusing namespace std;\nnamespace fs = std::experimental::filesystem;\n\nclass Scanner\n{\nprivate:\n    unsigned num_threads;\n    mutex mtx;\n    queue&lt;fs::path&gt; files;\n    bool fsscan_done;\n    void ThreadScan();\n    void ScanFile(fs::path file);\npublic:\n    Scanner();\n    void Scan();\n    void ScanDirectory(fs::path directory);\n};\n</code></pre>\n\n<p>I have the feeling this code can be optimized further, I especially don't fancy this part:</p>\n\n<pre><code>while (!fsscan_done || !files.empty()) {\n    unique_lock&lt;mutex&gt; lock(mtx);\n    if (files.empty()) {\n        lock.unlock();\n        continue;\n    }\n</code></pre>\n\n<p>because I'm checking for <em>files</em> to be empty twice. I think there should be a better way to do this, at least I assume. I'm quite new to multithreading principles, so I have already looked around on SO and other sites, maybe condition variables can help me out here but I'm not so sure how to implement them in this case. </p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>changed the directly locking and unlocking of the mutex to use a unique_lock, thanks <a href=\"https://stackoverflow.com/questions/55267878/c-multithreaded-filesystem-scan-optimization#comment97266920_55267878\">Fran\u00e7ois Andrieux</a></p>\n"}, {"tags": ["c++", "opengl"], "answers": [{"tags": [], "owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "is_accepted": true, "score": 9, "last_activity_date": 1553113592, "last_edit_date": 1553113592, "creation_date": 1553107294, "answer_id": 55268023, "question_id": 55267854, "link": "https://stackoverflow.com/questions/55267854/why-use-glad-library-for-opengl-initialization/55268023#55268023", "title": "Why use &#39;glad&#39; library for opengl initialization?", "body": "<blockquote>\n  <p>Authors suggest there to use GLAD library, because this library provides creation of GL context (which does not fit me) </p>\n</blockquote>\n\n<p>No, GLAD does not create or manage GL contexts in any way, and the website <a href=\"https://learnopengl.com/Getting-started/Creating-a-window\" rel=\"noreferrer\">https://learnopengl.com/Getting-started/Creating-a-window</a> never claims otherwise. They use GLFW for context and window management.</p>\n\n<blockquote>\n  <p>Does compiler really cannot get addresses of Opengl functions from GL-related .obj files which I specify in Linker Settings of Visual Studio?</p>\n</blockquote>\n\n<p><strong>No.</strong> </p>\n\n<p>First of all, you do not specify OpenGL-related <code>.obj</code> files for the linker, but on Windows, you might use <code>opengl32.lib</code>, which is the import library file for <code>opengl32.dll</code> which comes with every windows version since Windows 95. </p>\n\n<p>However, this DLL does not contain the OpenGL implementation you are typically using, but it contains Microsoft's OpenGL 1.1 GDI software rasterizer. The actual OpenGL implementation on windows is provided by an <em>Installable Client Driver</em> (ICD) which comes with your graphics driver. For OpenGL 1.0 and 1.1 functions, <code>opengl32.dll</code> will act as a <a href=\"https://en.wikipedia.org/wiki/Trampoline_(computing)\" rel=\"noreferrer\">trampoline</a> and will forward the calls to the actual ICD DLL.</p>\n\n<p><strong>If you want to call any OpenGL function beyond OpenGL 1.1</strong> (and that one is from 1997), you have to use the OpenGL extension mechanism in every case, as <strong><code>opengl32.dll</code> does not provide these entry points at all</strong>, and the compiler/linker will of course not find them. </p>\n"}], "owner": {"reputation": 556, "user_id": 5128696, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EiqOr_dergs/AAAAAAAAAAI/AAAAAAAAAXc/8WxucMqA-n0/photo.jpg?sz=128", "display_name": "Ivan P.", "link": "https://stackoverflow.com/users/5128696/ivan-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6305, "favorite_count": 2, "closed_date": 1553111090, "accepted_answer_id": 55268023, "answer_count": 1, "score": 2, "last_activity_date": 1553113592, "creation_date": 1553106639, "question_id": 55267854, "link": "https://stackoverflow.com/questions/55267854/why-use-glad-library-for-opengl-initialization", "closed_reason": "Duplicate", "title": "Why use &#39;glad&#39; library for opengl initialization?", "body": "<p>I am learning now OpenGL and writing some geometrical abstractions over it for personal usage. I want my code to be maximally portable and I want to have GL context initialized in caller code (by means of FLTK, wxWidgets, WinAPI or any else supported platform). </p>\n\n<p>I am reading now this popular article: <a href=\"https://learnopengl.com/Getting-started/Creating-a-window\" rel=\"nofollow noreferrer\">https://learnopengl.com/Getting-started/Creating-a-window</a></p>\n\n<p>Authors suggest there to use GLAD library, because this library provides creation of GL context (which does not fit me) and also it is used for 'retrieving addresses of functions' (quote: \"Since there are many different versions of OpenGL drivers, the location of most of its functions is not known at compile-time and needs to be queried at run-time.\"). </p>\n\n<p>My question is the following:</p>\n\n<p>Does compiler really cannot get addresses of Opengl functions from GL-related .obj files which I specify in Linker Settings of Visual Studio? Do I really need to use <code>wglGetProcAddress</code> routine to refer to OpenGL functions? Is it possible to use OpenGL functions like any other functions from linked headers and .obj files?</p>\n"}, {"tags": ["c++", "operator-overloading"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1553106763, "post_id": 55267849, "comment_id": 97266875, "body": "<i>But I really want to pass these structs by value</i>, Why?"}, {"owner": {"reputation": 22498, "user_id": 8482, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/248a3c4ba8f2972427222d46954f9c1c?s=128&d=identicon&r=PG", "display_name": "interstar", "link": "https://stackoverflow.com/users/8482/interstar"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553106920, "post_id": 55267849, "comment_id": 97266951, "body": "Because I&#39;m doing it everywhere else in the program, and I wanted to be consistent, rather than having to think about when I&#39;m passing by reference and when I&#39;m passing by value. The == operator doesn&#39;t change the struct, so there&#39;s no need for it to be passed by reference."}, {"owner": {"reputation": 1727, "user_id": 3166476, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/tU6SH.jpg?s=128&g=1", "display_name": "lakeweb", "link": "https://stackoverflow.com/users/3166476/lakeweb"}, "edited": false, "score": 1, "creation_date": 1553107313, "post_id": 55267849, "comment_id": 97267195, "body": "Invoking copy constructors for a comparison would be a waste of resources. Your operator won&#39;t look any different at use. Maybe you should rethink your strategy?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553107529, "post_id": 55267849, "comment_id": 97267307, "body": "related/dupe: <a href=\"https://stackoverflow.com/questions/270408/is-it-better-in-c-to-pass-by-value-or-pass-by-constant-reference\" title=\"is it better in c to pass by value or pass by constant reference\">stackoverflow.com/questions/270408/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 24558, "user_id": 457237, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/34f7425ea0a472d1493230c28204010a?s=128&d=identicon&r=PG&f=1", "display_name": "Pavan Manjunath", "link": "https://stackoverflow.com/users/457237/pavan-manjunath"}, "is_accepted": false, "score": 1, "last_activity_date": 1553107534, "creation_date": 1553107534, "answer_id": 55268085, "question_id": 55267849, "link": "https://stackoverflow.com/questions/55267849/c-overloading-the-equality-operator-should-i-write-my-function-to-accept-argu/55268085#55268085", "title": "C++ overloading the equality operator. Should I write my function to accept argument passed by reference or value?", "body": "<p>It should really not matter expect that you pay the penalty of a copy when you pass by value. This applies if the struct is really heavy. In the simple example you quote, there may not be a big difference.</p>\n\n<p>That being said, passing by <code>const reference</code> makes more sense since it expresses the intent of the overloaded function <code>==</code> clearly. <code>const</code> makes sure that the overloaded function accidentally doesn't modify the object and passing by reference saves you from making a copy. For <code>==</code> operator, there is no need to pass a copy just for comparison purposes.</p>\n\n<p>If you are concerned about consistency, it's better to switch the other pass by value instances to pass by const ref.</p>\n"}, {"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 1, "last_activity_date": 1553108115, "creation_date": 1553108115, "answer_id": 55268235, "question_id": 55267849, "link": "https://stackoverflow.com/questions/55267849/c-overloading-the-equality-operator-should-i-write-my-function-to-accept-argu/55268235#55268235", "title": "C++ overloading the equality operator. Should I write my function to accept argument passed by reference or value?", "body": "<p>While being consistent is laudable goal, one shouldn't overdo it. A program containing only 'A' characters would be very consistent, but hardly useful. Argument passing mechanism is not something you do out of consistency, it is a technical decision based on certain technical aspects.</p>\n\n<p>For example, in your case, passing by value <strong>could</strong> potentially lead to better performance, since the struct is small enough and on AMD64 ABI (the one which is used on any 64bit Intel/AMD chip) it will be passed in a register, thus saving time normally associated with dereferencing.</p>\n\n<p>On the hand, in your case, it is reasonable to assume that the function will be inlined, and passing scheme will not matter at all (since it won't be passed). This is proven by codegen here (no call to <code>operator==</code> exist in generated assembly): <a href=\"https://gcc.godbolt.org/z/G7oEgE\" rel=\"nofollow noreferrer\">https://gcc.godbolt.org/z/G7oEgE</a></p>\n"}], "owner": {"reputation": 22498, "user_id": 8482, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/248a3c4ba8f2972427222d46954f9c1c?s=128&d=identicon&r=PG", "display_name": "interstar", "link": "https://stackoverflow.com/users/8482/interstar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1553108115, "creation_date": 1553106627, "question_id": 55267849, "link": "https://stackoverflow.com/questions/55267849/c-overloading-the-equality-operator-should-i-write-my-function-to-accept-argu", "title": "C++ overloading the equality operator. Should I write my function to accept argument passed by reference or value?", "body": "<p>I want to overload the == operator for a simple struct </p>\n\n<pre><code>struct MyStruct {\npublic:\n   int a;\n   float b;\n   bool operator==( ) {  }\n}\n</code></pre>\n\n<p>All the examples I'm seeing seem to pass the value by reference using a &amp;.</p>\n\n<p>But I really want to pass these structs by value.</p>\n\n<p>Is there anything wrong with me writing this as </p>\n\n<pre><code>bool operator== (MyStruct another) { return ( (a==another.a) &amp;&amp; (b==another.b) ); } \n</code></pre>\n"}, {"tags": ["c++", "c++17", "std-variant"], "comments": [{"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 3, "creation_date": 1553107002, "post_id": 55267620, "comment_id": 97266989, "body": "I think c++20 just added it to the draft with the <a href=\"https://brevzin.github.io/cpp_proposals/118x_spaceship/p1614r0.html#was-ill-formed-now-well-formed\" rel=\"nofollow noreferrer\">mothership proposal</a>"}, {"owner": {"reputation": 2581, "user_id": 5141304, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dH8FwSGAMts/AAAAAAAAAAI/AAAAAAAAABY/L6D_xatTkV4/photo.jpg?sz=128", "display_name": "Cruz Jean", "link": "https://stackoverflow.com/users/5141304/cruz-jean"}, "reply_to_user": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 1, "creation_date": 1553107395, "post_id": 55267620, "comment_id": 97267248, "body": "@GuillaumeRacicot In that same link, I believe it&#39;s saying the int would be implicitly cast to <code>std::variant&lt;int, std::string&gt;</code> to satisfy the comparison function signature. For an int, that&#39;s probably trivial. But for a string, that could mean a copy."}, {"owner": {"reputation": 463, "user_id": 2657179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/516fe6fe86e7f822cbcd6f670a6b06da?s=128&d=identicon&r=PG", "display_name": "Kilian", "link": "https://stackoverflow.com/users/2657179/kilian"}, "edited": false, "score": 0, "creation_date": 1553207053, "post_id": 55267620, "comment_id": 97309471, "body": "Shouldn&#39;t the compare also work in C++17? the operator== is a freestanding function. And variant has a non-explicit conversion-constructor, so variant&lt;T1, T2&gt;() == T1() should convert T1 to variant&lt;T1, T2&gt; and it shuould find the freestanding operator==. Actually after a check I found out that it does not work. Why is that so?"}, {"owner": {"reputation": 463, "user_id": 2657179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/516fe6fe86e7f822cbcd6f670a6b06da?s=128&d=identicon&r=PG", "display_name": "Kilian", "link": "https://stackoverflow.com/users/2657179/kilian"}, "edited": false, "score": 0, "creation_date": 1553207130, "post_id": 55267620, "comment_id": 97309501, "body": "Actually following code works: struct X {     template&lt;class T&gt;     X(T&amp;&amp;) {} }; bool operator==(X const&amp;, X const&amp;); X x(10); bool b = x==10;  So it seemes to be related to operator== being a template."}], "answers": [{"comments": [{"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1553106691, "post_id": 55267779, "comment_id": 97266833, "body": "This is not an answer to the question, it&#39;s just a statement of the situation. You did not say <i>why</i> &quot;a given instance of std::variant compares equal to another if and only if etc. etc.&quot;"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 1, "creation_date": 1553106779, "post_id": 55267779, "comment_id": 97266881, "body": "When comparing an <code>int</code> with <code>std::variant&lt;int, int&gt;</code> it could compare the <i>active</i> member with that <code>int</code>."}, {"owner": {"reputation": 2581, "user_id": 5141304, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dH8FwSGAMts/AAAAAAAAAAI/AAAAAAAAABY/L6D_xatTkV4/photo.jpg?sz=128", "display_name": "Cruz Jean", "link": "https://stackoverflow.com/users/5141304/cruz-jean"}, "reply_to_user": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1553106898, "post_id": 55267779, "comment_id": 97266940, "body": "@einpoklum The standard just decided it should be that way. I&#39;m explaining the reason (in terms of how the comparison operators work in the standard) for why a generic comparison to <code>T</code> is not in the standard."}, {"owner": {"reputation": 2581, "user_id": 5141304, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dH8FwSGAMts/AAAAAAAAAAI/AAAAAAAAABY/L6D_xatTkV4/photo.jpg?sz=128", "display_name": "Cruz Jean", "link": "https://stackoverflow.com/users/5141304/cruz-jean"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1553106919, "post_id": 55267779, "comment_id": 97266949, "body": "@MaximEgorushkin You may want it to be like that, but that&#39;s not what the standard decided."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1553113465, "post_id": 55267779, "comment_id": 97270243, "body": "@CruzJean Well, in variant visitor you cannot distinguish between the two now - the comparison can be just as oblivious. I am not sure what use case the standard had in mind, however, one can wrap an integer into a unique class and get more mileage out of that."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1553113761, "post_id": 55267779, "comment_id": 97270400, "body": "A bit off-topic, but the standard libraries get outdated by the time they are integrated into the standard and then just code rot in there because standard library updates are almost non-existent. IMO, the standard commitee had better focus on modules, build and packaging system, so that people can pick and match libraries as they please."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1553113962, "post_id": 55267779, "comment_id": 97270487, "body": "<code>boost::variant</code> has been available for decades, excluding <i>i can&#39;t use boost</i> people. Integrating <code>boost::variant</code> into <code>std</code> wouldn&#39;t be necessary if C++ had a package repository and a build system. Brain dump completed."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1553115780, "post_id": 55267779, "comment_id": 97271415, "body": "@MaximEgorushkin <code>boost::variant</code> also does not support equality-comparison with one of the alternative types."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1553116195, "post_id": 55267779, "comment_id": 97271613, "body": "@Barry True, i am not claiming otherwise. May be you could shed some light why variant supports duplicate types. Because if it didn&#39;t one could just do <code>myvariant == static_cast&lt;decltype(myvariant)&gt;(myint)</code> to compare. What was the more useful use case to allow duplicate types?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1553116523, "post_id": 55267779, "comment_id": 97271751, "body": "@MaximEgorushkin Because it&#39;s useful to model two different states that nevertheless have the same type."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1553116813, "post_id": 55267779, "comment_id": 97271900, "body": "@Barry One can always make 2 unique types from 1 type with a wrapper. IMO, that reason is not good enough."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1553127007, "post_id": 55267779, "comment_id": 97275091, "body": "@MaximEgorushkin Because <code>variant&lt;a,b,c&gt;</code> <i>always has</i> alternative 1 being <code>b</code>, and if alternative of var1 is not alternative of var2 they are never equal.  If you go down the path of &quot;well, I&#39;m sure they meant <code>variant&lt;int, double&gt;</code> when they said <code>variant&lt;int, int, double&gt;</code>&quot;, you end up with javascript <code>&quot;1&quot;==1</code> insanity.  If you want to go further, look up &quot;sum types&quot; in type theory."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1553162275, "post_id": 55267779, "comment_id": 97285495, "body": "@Yakk-AdamNevraumont Could not understand your logic, sorry."}, {"owner": {"reputation": 463, "user_id": 2657179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/516fe6fe86e7f822cbcd6f670a6b06da?s=128&d=identicon&r=PG", "display_name": "Kilian", "link": "https://stackoverflow.com/users/2657179/kilian"}, "edited": false, "score": 0, "creation_date": 1553207785, "post_id": 55267779, "comment_id": 97309732, "body": "What about an operator== between variant and T which only participates in overload resolution if T is one of the alternative types and the alternative types in the variant are unique?"}, {"owner": {"reputation": 2581, "user_id": 5141304, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dH8FwSGAMts/AAAAAAAAAAI/AAAAAAAAABY/L6D_xatTkV4/photo.jpg?sz=128", "display_name": "Cruz Jean", "link": "https://stackoverflow.com/users/5141304/cruz-jean"}, "reply_to_user": {"reputation": 463, "user_id": 2657179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/516fe6fe86e7f822cbcd6f670a6b06da?s=128&d=identicon&r=PG", "display_name": "Kilian", "link": "https://stackoverflow.com/users/2657179/kilian"}, "edited": false, "score": 0, "creation_date": 1553302014, "post_id": 55267779, "comment_id": 97347014, "body": "@Kilian I like that, and that&#39;s personally how I&#39;d have done it - nice and easy impl too. Just needs an <code>index()</code> check plus a template visitor. The <code>index()</code> check just being to make sure <code>std::variant&lt;A, B&gt;</code> holding <code>A</code> which is comparable to <code>B</code> still fails (so as not to fly in the face of the default comparison of two variants)."}], "tags": [], "owner": {"reputation": 2581, "user_id": 5141304, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dH8FwSGAMts/AAAAAAAAAAI/AAAAAAAAABY/L6D_xatTkV4/photo.jpg?sz=128", "display_name": "Cruz Jean", "link": "https://stackoverflow.com/users/5141304/cruz-jean"}, "is_accepted": false, "score": 10, "last_activity_date": 1553106343, "creation_date": 1553106343, "answer_id": 55267779, "question_id": 55267620, "link": "https://stackoverflow.com/questions/55267620/why-isnt-stdvariant-allowed-to-equal-compare-with-one-of-its-alternative-type/55267779#55267779", "title": "Why isn&#39;t std::variant allowed to equal compare with one of its alternative types?", "body": "<p>A variant may have multiple duplicates of the same type. E.g. <code>std::variant&lt;int, int&gt;</code>.</p>\n\n<p>A given instance of <code>std::variant</code> compares equal to another if and only if they hold the same variant alternative and said alternatives' values compare equal.</p>\n\n<p>Thus, a <code>std::variant&lt;int, int&gt;</code> with <code>index()</code> 0 compares not equal to a <code>std::variant&lt;int, int&gt;</code> with <code>index()</code> 1, despite the active variant alternatives being of the same type and same value.</p>\n\n<p>Because of this, a generic \"compare to <code>T</code>\" was not implemented by the standard. However, you are free to design your own overload of the comparison operators using the other helper utilities in the <code>&lt;variant&gt;</code> header (e.g. <code>std::holds_alternative</code> and <code>std::get&lt;T&gt;</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "is_accepted": true, "score": 2, "last_activity_date": 1553107525, "creation_date": 1553107525, "answer_id": 55268083, "question_id": 55267620, "link": "https://stackoverflow.com/questions/55267620/why-isnt-stdvariant-allowed-to-equal-compare-with-one-of-its-alternative-type/55268083#55268083", "title": "Why isn&#39;t std::variant allowed to equal compare with one of its alternative types?", "body": "<p>It is an arbitrary decision by the standards committee.</p>\n\n<p>Ok, not <em>quite</em> arbitrary. The point is you have a scale<sup>*</sup> of strictness of comparison, with points such as:</p>\n\n<ul>\n<li>Most-strict: Only variants can equal each other, and they need to match both in the sequence-of-alternatives (i.e. the type), the actual alternative (the index, really, since you can have multiple identical-type alternatives) and in value.</li>\n<li>Less-Strict: Equality of both the variant alternative, as a type and the value, but not of the sequence-of-alternatives, nor the index within that sequence (so the same value within two distinct alternatives of the same type would be equal).</li>\n<li>Most-relaxed: Equality of the value in the active alternative, with implicit conversion of one of the elements if relevant.</li>\n</ul>\n\n<p>These are all valid choices. the C++ committee made the decision based on all sorts of extrinsic criteria. Try looking up the <code>std::variant</code> proposal, as perhaps it says what these criteria are.</p>\n\n<p><sub>(*) - A lattice actually.</sub></p>\n"}, {"tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": false, "score": 4, "last_activity_date": 1553122693, "last_edit_date": 1553122693, "creation_date": 1553121495, "answer_id": 55271195, "question_id": 55267620, "link": "https://stackoverflow.com/questions/55267620/why-isnt-stdvariant-allowed-to-equal-compare-with-one-of-its-alternative-type/55271195#55271195", "title": "Why isn&#39;t std::variant allowed to equal compare with one of its alternative types?", "body": "<p>I can't answer the <em>why</em> part of the question but since you think it would be useful to be able to compare a <code>std::variant&lt;T1, T2&gt;</code> with a <code>T1</code> or <code>T2</code>, perhaps this can help:</p>\n\n<pre><code>template&lt;typename T, class... Types&gt;\ninline bool operator==(const T&amp; t, const std::variant&lt;Types...&gt;&amp; v) {\n    const T* c = std::get_if&lt;T&gt;(&amp;v);\n    if(c)\n        return *c == t;\n    else\n        return false;\n}\n\ntemplate&lt;typename T, class... Types&gt;\ninline bool operator==(const std::variant&lt;Types...&gt;&amp; v, const T&amp; t) {\n    return t == v;\n}\n</code></pre>\n"}], "owner": {"reputation": 681, "user_id": 5247961, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/788ce8003aaf31a8860b4f24dcdcc8fe?s=128&d=identicon&r=PG&f=1", "display_name": "Han", "link": "https://stackoverflow.com/users/5247961/han"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1979, "favorite_count": 1, "accepted_answer_id": 55268083, "answer_count": 3, "score": 12, "last_activity_date": 1553122693, "creation_date": 1553105724, "last_edit_date": 1553105805, "question_id": 55267620, "link": "https://stackoverflow.com/questions/55267620/why-isnt-stdvariant-allowed-to-equal-compare-with-one-of-its-alternative-type", "title": "Why isn&#39;t std::variant allowed to equal compare with one of its alternative types?", "body": "<p>For example, it should be very helpful to equal compare a <code>std::variant&lt;T1, T2&gt;</code> with a <code>T1</code> or <code>T2</code>. So far we can only compare with the same variant type.</p>\n"}, {"tags": ["c++", "pointers"], "comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1553105471, "post_id": 55267502, "comment_id": 97266276, "body": "Begin by introducing typedefs to make it clearer what is going on. The code as written is nasty."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1553105484, "post_id": 55267502, "comment_id": 97266280, "body": "Use a <code>std::vector&lt;std::vector&lt;std::array&lt;float, 4&gt;&gt;&gt;</code> instead."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1553105487, "post_id": 55267502, "comment_id": 97266284, "body": "Just use a <code>std::vector</code> already. Or, if you <i>must</i> dynamically allocate, at least use a smart pointer. Look up <code>std::make_unique</code> for starters."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1553105671, "post_id": 55267502, "comment_id": 97266368, "body": "See <a href=\"https://stackoverflow.com/questions/7719905/allocation-of-a-pointers-to-fixed-size-arrays\" title=\"allocation of a pointers to fixed size arrays\">stackoverflow.com/questions/7719905/&hellip;</a>"}, {"owner": {"reputation": 137, "user_id": 9983541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af356b561824ba0811f28571863b1ea3?s=128&d=identicon&r=PG&f=1", "display_name": "sid", "link": "https://stackoverflow.com/users/9983541/sid"}, "edited": false, "score": 0, "creation_date": 1553117388, "post_id": 55267502, "comment_id": 97272125, "body": "I&#39;m interested in the answer to the question as asked. I understand that one should &amp; would never use this code."}, {"owner": {"reputation": 137, "user_id": 9983541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af356b561824ba0811f28571863b1ea3?s=128&d=identicon&r=PG&f=1", "display_name": "sid", "link": "https://stackoverflow.com/users/9983541/sid"}, "edited": false, "score": 0, "creation_date": 1553162160, "post_id": 55267502, "comment_id": 97285435, "body": "Is this not possible to do exactly?"}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 4, "creation_date": 1553105930, "post_id": 55267666, "comment_id": 97266488, "body": "The goal is to use <code>new</code> instead of <code>malloc</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1553106237, "post_id": 55267666, "comment_id": 97266626, "body": "When posting an answer you should be sure about it.  If you are not, you should consider leaving a comment with a link to the code example you think might be what they want."}, {"owner": {"reputation": 1, "user_id": 9860618, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-G2B7np0Gm6U/AAAAAAAAAAI/AAAAAAAAAyY/I59XhGMhJYE/photo.jpg?sz=128", "display_name": "Raf Bianco", "link": "https://stackoverflow.com/users/9860618/raf-bianco"}, "edited": false, "score": 0, "creation_date": 1553106273, "post_id": 55267666, "comment_id": 97266642, "body": "float <i>*f[4]; \tfor(int i = 0; i &lt; 4; i++){ \t\tf[i] = new float</i>; \t} \tprintf(&quot;%ld&quot;, f);"}], "tags": [], "owner": {"reputation": 1, "user_id": 9860618, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-G2B7np0Gm6U/AAAAAAAAAAI/AAAAAAAAAyY/I59XhGMhJYE/photo.jpg?sz=128", "display_name": "Raf Bianco", "link": "https://stackoverflow.com/users/9860618/raf-bianco"}, "is_accepted": false, "score": -4, "last_activity_date": 1553105917, "creation_date": 1553105917, "answer_id": 55267666, "question_id": 55267502, "link": "https://stackoverflow.com/questions/55267502/allocating-mem-using-new-instead-of-malloc/55267666#55267666", "title": "Allocating mem using new instead of malloc", "body": "<p>I'm not sure...\nBut try this:</p>\n\n<pre><code>float **f[4];\n    for(int i = 0; i &lt; 4; i++){\n        f[i] = (float**)malloc(sizeof(float**));\n    }\n    printf(\"%ld\", sizeof(f));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1553163644, "post_id": 55267884, "comment_id": 97286254, "body": "Except for syntaxic sugar, the first code should be avoided since it would allow any invalid declaration to be accepted (simply write whatever you want in front of NewAny() and the compiler will happily create that for you). For example, in your case, the compiler will allocate an array of 2x <code>array of 4 float **</code>, which is not exactly what you want, if I understand the initial question correctly."}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1553163894, "post_id": 55267884, "comment_id": 97286403, "body": "The last example is much more clean but it&#39;s not dynamic for the multi dimension array size (which is probably good anyway)"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1553179606, "post_id": 55267884, "comment_id": 97295971, "body": "@xryl669 <code>NewAny</code> is just as safe as <code>new</code>. If LHS is <code>T *</code>, RHS is <code>new T</code>."}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1553184549, "post_id": 55267884, "comment_id": 97299262, "body": "Just remove one star like <code>float (*f)[4] = NewAny&lt;2&gt;()</code> and the code will still compile. Unlike <code>float * t = new float*[2]</code> where the compiler will choke. That&#39;s a subtle bug to spot."}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1553185394, "post_id": 55267884, "comment_id": 97299795, "body": "I agree. It&#39;s not criticism, it&#39;s perfectly fine. My remark was just to make it clear for an outside observer that using a template based conversion operator removes the <i>double check</i> of similar type on both side of the assignment that&#39;s usually done with plain old new. It&#39;s a neat powerful trick but the downside should be said too."}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 1, "last_activity_date": 1553134341, "last_edit_date": 1553134341, "creation_date": 1553106764, "answer_id": 55267884, "question_id": 55267502, "link": "https://stackoverflow.com/questions/55267502/allocating-mem-using-new-instead-of-malloc/55267884#55267884", "title": "Allocating mem using new instead of malloc", "body": "<p>You can create a helper class that can <code>new</code> the right thing for you auto-magically via the conversion.</p>\n\n<pre><code>template &lt;unsigned N = 0&gt; struct NewAny;\n\ntemplate &lt;unsigned N&gt; struct NewAny {\n    template &lt;typename T&gt;\n    operator T * () const { return new T[N]; }\n};\n\ntemplate &lt;&gt; struct NewAny&lt;0&gt; {\n    template &lt;typename T&gt;\n    operator T * () const { return new T; }\n};\n\nint main () {\n    float (**x)[4] = NewAny&lt;2&gt;();\n    delete[] x;\n    x = NewAny&lt;&gt;();\n    delete x;\n}\n</code></pre>\n\n<p>In your example:</p>\n\n<pre><code>float (**f)[4] = NewAny&lt;2&gt;();\nfor (int p = 0; p &lt; 2; p++) {\n    f[p] = NewAny&lt;3&gt;();\n}\n</code></pre>\n\n<p>Modern C++ teaches to avoid the error prone nature of manual management of dynamically allocated memory by using containers and smart pointers. You could do something like the below to create a <code>D</code>-dimensional <code>vector</code>:</p>\n\n<pre><code>template &lt;typename T, unsigned D&gt; struct Vectorate;\n\ntemplate &lt;unsigned N, typename T, unsigned D&gt;\nstruct Vectorate&lt;T[N], D&gt; {\n    typedef\n    typename Vectorate&lt;std::array&lt;T, N&gt;, D&gt;::type type;\n};\n\ntemplate &lt;typename T, unsigned D&gt;\nstruct Vectorate {\n    typedef\n    typename Vectorate&lt;std::vector&lt;T&gt;, D-1&gt;::type type;\n};\n\ntemplate &lt;typename T&gt;\nstruct Vectorate&lt;T, 0&gt; {\n    typedef T type;\n};\n</code></pre>\n\n<p>In your example:</p>\n\n<pre><code>Vectorate&lt;float[4], 2&gt;::type f;\nf.resize(2);\nfor(auto &amp;ff : f) ff.resize(3);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 9983541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af356b561824ba0811f28571863b1ea3?s=128&d=identicon&r=PG&f=1", "display_name": "sid", "link": "https://stackoverflow.com/users/9983541/sid"}, "edited": false, "score": 0, "creation_date": 1553119270, "post_id": 55268027, "comment_id": 97272811, "body": "Many thanks. But is it possible to do precisely <code>float (**f)[4] = new ...</code>? The syntax interests me."}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "reply_to_user": {"reputation": 137, "user_id": 9983541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af356b561824ba0811f28571863b1ea3?s=128&d=identicon&r=PG&f=1", "display_name": "sid", "link": "https://stackoverflow.com/users/9983541/sid"}, "edited": false, "score": 0, "creation_date": 1553164034, "post_id": 55268027, "comment_id": 97286484, "body": "No, I&#39;m afraid it&#39;s not possible to do so like you&#39;ve written. The part on the left declare an array of size 4 of pointer to pointer of float <b>on the stack</b>. Just like when you write <code>char buf[3]</code>, you shouldn&#39;t assign a heap allocated pointer to this (<code>buf = new char[3]</code> is undefined behavior)"}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "reply_to_user": {"reputation": 137, "user_id": 9983541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af356b561824ba0811f28571863b1ea3?s=128&d=identicon&r=PG&f=1", "display_name": "sid", "link": "https://stackoverflow.com/users/9983541/sid"}, "edited": false, "score": 0, "creation_date": 1553164129, "post_id": 55268027, "comment_id": 97286545, "body": "The closer you could get is <code>float (**f)[4] = { new float *[3], new float *[3], new float *[3], new float *[3]}</code>. Yet you&#39;ll still need to iterate the array to allocate the inner pointers in the array."}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "reply_to_user": {"reputation": 137, "user_id": 9983541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af356b561824ba0811f28571863b1ea3?s=128&d=identicon&r=PG&f=1", "display_name": "sid", "link": "https://stackoverflow.com/users/9983541/sid"}, "edited": false, "score": 0, "creation_date": 1553164188, "post_id": 55268027, "comment_id": 97286581, "body": "It&#39;s obvious but if the dimension are fixed, you can do <code>float f[2][3][4]</code>"}, {"owner": {"reputation": 137, "user_id": 9983541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af356b561824ba0811f28571863b1ea3?s=128&d=identicon&r=PG&f=1", "display_name": "sid", "link": "https://stackoverflow.com/users/9983541/sid"}, "edited": false, "score": 0, "creation_date": 1553174541, "post_id": 55268027, "comment_id": 97292577, "body": "Ah, I see that I misunderstood what float (**f)[4] actually does. I thought it was  pointer to pointer to array of 4 floats, but it&#39;s actually array of 4 pointers to pointer to float. Am I correct in saying this?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 137, "user_id": 9983541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af356b561824ba0811f28571863b1ea3?s=128&d=identicon&r=PG&f=1", "display_name": "sid", "link": "https://stackoverflow.com/users/9983541/sid"}, "edited": false, "score": 0, "creation_date": 1553179338, "post_id": 55268027, "comment_id": 97295788, "body": "@sid Your understanding was correct. <code>f</code> is a pointer to pointer of array of 4 <code>float</code>"}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1553184357, "post_id": 55268027, "comment_id": 97299145, "body": "<code>float **f[4]</code> is a (stack allocated) array of 4 pointer to pointer of float. <code>float (**f)[4]</code> is a pointer to pointer to 4 floats array. This is very confusing for any reader, so please follow the advice above to use a typedef."}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1553184695, "post_id": 55268027, "comment_id": 97299348, "body": "Sorry, I made a mistake in my previous comment. The correct code is <code>float **f[4] = { new float *[3], new float *[3], new float *[3], new float *[3]}</code>."}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1553185138, "post_id": 55268027, "comment_id": 97299641, "body": "If you need to the pointer to pointer to array version, this is how it should be done: <code>typedef float VFloat[4]; float (**f)[4] = new VFloat *[3];</code>"}], "tags": [], "owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "is_accepted": true, "score": 1, "last_activity_date": 1553107310, "creation_date": 1553107310, "answer_id": 55268027, "question_id": 55267502, "link": "https://stackoverflow.com/questions/55267502/allocating-mem-using-new-instead-of-malloc/55268027#55268027", "title": "Allocating mem using new instead of malloc", "body": "<p>Plain old declaration (don't do this):</p>\n\n<pre><code>try\n{\n    float *** f = new float ** [2];\n    for (size_t i = 0; i &lt; 2; i++)\n    {\n       f[i] = new float * [3];\n       for (size_t j = 0; j &lt; 3; j++)\n           f[i][j] = new float[4];\n    }\n} catch(const std::exception &amp; e) { /* This is a pain to deal with to avoid any leak */ }\n\n// Now you can access via f[0][1][2]\n// delete[] in reverse order.\n</code></pre>\n\n<p>A bit better (avoid using many allocations):</p>\n\n<pre><code>try \n{\n    typedef float BigArray[3][4];\n    BigArray * f = new BigArray[2];\n} catch(const std::exception &amp; e) { /* here it's simple */ }\n// delete with delete[] f\n</code></pre>\n\n<p>A bit cumbersome, but you don't care about memory leak anymore:</p>\n\n<pre><code>std::vector&lt;std::vector&lt;std::vector&lt;float&gt;&gt;&gt; f(2, std::vector&lt;std::vector&lt;float&gt;&gt;(3, std::vector&lt;float&gt;(4)));\n// Use with f[0][1][2]\n</code></pre>\n\n<p>Also, as most would say, instead of pointer to pointer to pointer of float, you should store your array in pointer to float instead, it'll be a lot more efficient since you don't need to dereference in 3 steps to access an element, that is, like:</p>\n\n<pre><code>int vectorElems = 4, columns = 3, rows = 2;\nint rowStride = vectorElems * columns;  \nfloat * f = new float[rows*columns*vectorElems];\n// Access with stride:\nf[0 * rowStride + 1 * vectorElems + 2] = 3.14f;\n\n// Delete with delete[] f\n</code></pre>\n\n<p>There are also template matrix classes (for exemple in opencv) that's doing this properly by providing an overloaded () operator so you can access the object like <code>f(0, 1, 2)</code></p>\n"}], "owner": {"reputation": 137, "user_id": 9983541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af356b561824ba0811f28571863b1ea3?s=128&d=identicon&r=PG&f=1", "display_name": "sid", "link": "https://stackoverflow.com/users/9983541/sid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "accepted_answer_id": 55268027, "answer_count": 3, "score": -4, "last_activity_date": 1553134341, "creation_date": 1553105238, "last_edit_date": 1553129912, "question_id": 55267502, "link": "https://stackoverflow.com/questions/55267502/allocating-mem-using-new-instead-of-malloc", "title": "Allocating mem using new instead of malloc", "body": "<p>I am trying to work out the precise equivalent of this code using <code>new</code> instead of <code>malloc</code>. Pointer to pointer to float array[4]: </p>\n\n<pre><code>float (**f)[4] = (float(**)[4])malloc(2 * sizeof(float(*)[4]));\nfor (int p = 0; p &lt; 2; p++) {\n    f[p] = (float(*)[4])malloc(3 * sizeof(float[4]));\n}\n</code></pre>\n\n<p>I have tried a bunch of combinations, but cannot find the correct syntax.</p>\n\n<pre><code>float (**f)[4] = new ...\n</code></pre>\n"}, {"tags": ["c++", "pdf", "unicode"], "comments": [{"owner": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 0, "creation_date": 1553115892, "post_id": 55267416, "comment_id": 97271480, "body": "The <a href=\"http://www.jagpdf.org/doc/jagpdf/reference/langspec.htm\" rel=\"nofollow noreferrer\">JagPDF spec</a> says you can add the encoding to the parameter for <code>doc.font_load</code>, so that would be <code>doc.font_load(&quot;standard; enc=utf-8; name=Times-Roman; size=12&quot;);</code>"}, {"owner": {"reputation": 839, "user_id": 2832872, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/709868624/picture?type=large", "display_name": "Diego Fernando Pava", "link": "https://stackoverflow.com/users/2832872/diego-fernando-pava"}, "reply_to_user": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 0, "creation_date": 1553116760, "post_id": 55267416, "comment_id": 97271881, "body": "Thank you for your answer, I understood as much, what I don&#39;t get is once I set the encoder how do I call that specific symbol? they have as an example unicode_text = u&#39;\\u017elu\\u0165ou\\u010dk\\u00fd k\\u016f\\u0148 \\u00fap\\u011bl&#39; but when I try to set a variable this way it gives me an error."}, {"owner": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 0, "creation_date": 1553155473, "post_id": 55267416, "comment_id": 97282133, "body": "I&#39;m not familiar with JagPDF, but the example you have there is not the right syntax for C++. Use double quotes."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1553308483, "post_id": 55267416, "comment_id": 97347822, "body": "@DiegoFernandoPava that doesn&#39;t work because <code>&#39;&#39;</code> is used for characters. The compiler will immediately warn you the issue. For example gcc will output something like &quot;error: too many characters in character constant&quot;. You must use <code>u&quot;\\u017elu\\u0165ou\\u010dk\\u00fd k\\u016f\\u0148 \\u00fap\\u011bl&quot;</code> instead. And <b>always read compiler warnings</b>, they&#39;re very helpful"}], "answers": [{"comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1553442150, "post_id": 55309005, "comment_id": 97377028, "body": "<code>\\U+2664</code> is wrong. <code>\\U</code> escape doesn&#39;t go with <code>+</code>"}], "tags": [], "owner": {"reputation": 46, "user_id": 6402060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aCmPKteCQ9w/AAAAAAAAAAI/AAAAAAAAAHo/IACHW0m1M5U/photo.jpg?sz=128", "display_name": "Isaac", "link": "https://stackoverflow.com/users/6402060/isaac"}, "is_accepted": false, "score": 0, "last_activity_date": 1553298530, "last_edit_date": 1553298530, "creation_date": 1553296885, "answer_id": 55309005, "question_id": 55267416, "link": "https://stackoverflow.com/questions/55267416/printing-the-%e2%89%a4-symbol-on-a-pdf-file-using-jagpdf-libraries/55309005#55309005", "title": "Printing the \u2264 symbol on a PDF file using JagPDF libraries", "body": "<p>Try out:</p>\n\n<pre><code>doc.page().canvas().text(100, 300, \"PEP \\U+2264 90\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "is_accepted": true, "score": 0, "last_activity_date": 1553307019, "last_edit_date": 1592644375, "creation_date": 1553307019, "answer_id": 55309964, "question_id": 55267416, "link": "https://stackoverflow.com/questions/55267416/printing-the-%e2%89%a4-symbol-on-a-pdf-file-using-jagpdf-libraries/55309964#55309964", "title": "Printing the \u2264 symbol on a PDF file using JagPDF libraries", "body": "<p>I'm not familiar with JagPDF but <code>&quot;PEP \u2264 90&quot;</code> should work fine, provided that you saved the source code as UTF-8 and the library also expects an UTF-8 string. You can also use <code>&quot;PEP \\u2264 90&quot;</code> with <code>\\uXXXX</code> is the escape sequence for the code point U+XXXX, but that's obviously less readable</p>\n<p>According to the documentation you can set the encoding and output the text with the below snippet</p>\n<blockquote>\n<pre><code>font = doc.font_load(&quot;file=DejaVuSans.ttf; size=14; enc=utf-8&quot;)\ncanvas.text_font(font)\ntext = unicode_text.encode('utf8')\ncanvas.text(50, 780, text)\n</code></pre>\n<p><a href=\"http://www.jagpdf.org/doc/jagpdf/usersguide/text.htm\" rel=\"nofollow noreferrer\">http://www.jagpdf.org/doc/jagpdf/usersguide/text.htm</a></p>\n</blockquote>\n<p>You also need to use a TrueType or OpenType font because there's a note under Type 1 font in the same page</p>\n<blockquote>\n<p>Even though JagPDF allows to change the font built-in encoding to UTF-8, we are in practice limited to the Latin alphabet, because of the character set used by the standard fonts.</p>\n</blockquote>\n<p>If you use C++11 and up (which you should) then you can force the encoding as UTF-8 with either of the below</p>\n<pre><code>u8&quot;PEP \u2264 90&quot;\nu8&quot;PEP \\U00002264 90&quot;\nu8&quot;PEP \\u2264 90&quot;\n</code></pre>\n"}], "owner": {"reputation": 839, "user_id": 2832872, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/709868624/picture?type=large", "display_name": "Diego Fernando Pava", "link": "https://stackoverflow.com/users/2832872/diego-fernando-pava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 55309964, "answer_count": 2, "score": 0, "last_activity_date": 1553337707, "creation_date": 1553104931, "last_edit_date": 1553337707, "question_id": 55267416, "link": "https://stackoverflow.com/questions/55267416/printing-the-%e2%89%a4-symbol-on-a-pdf-file-using-jagpdf-libraries", "title": "Printing the \u2264 symbol on a PDF file using JagPDF libraries", "body": "<p>I am creating a PDF file using JagPDF and I am trying to print the \u2264 symbol like this:</p>\n\n<pre><code>pdf::Document doc(pdf::create_file(\"report.pdf\"));\ndoc.page_start(792,612);   \npdf::Font font = doc.font_load(\"standard; name=Times-Roman; size=12\");\ndoc.page().canvas().text_font(font);\ndoc.page().canvas().color(\"f\", 0);\ndoc.page().canvas().text_rendering_mode(\"f\");\ndoc.page().canvas().text(100, 300, \"PEP \u2264 90\");\ndoc.page_end();\ndoc.finalize();\n</code></pre>\n\n<p>that prints out</p>\n\n<pre><code>PEP ? 90\n</code></pre>\n\n<p>I tried reading the documentation and they say something about Unicode but couldn't understand how they work, it must be easy and just something I am missing. Can anybody help me?</p>\n"}, {"tags": ["c++", "c++17"], "comments": [{"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 2, "creation_date": 1553108292, "post_id": 55267254, "comment_id": 97267671, "body": "&quot;<i>std::shared_ptr (the constructor should accept it by &amp; and copy it)?</i>&quot; Why should the constructor copy it? Why not take it by <code>&amp;&amp;</code> and have the caller perform the copy?"}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1553108710, "post_id": 55267254, "comment_id": 97267864, "body": "@NicolBolas this adds one extra line of code, but probably it is better than having two separate classes like UniqueDataProcessor and SharedDataProcessor with different constructors taking &amp;&amp; and &amp;."}, {"owner": {"reputation": 4403, "user_id": 6868543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ced262f63c87506f6e61ef2d1e692d4?s=128&d=identicon&r=PG&f=1", "display_name": "j6t", "link": "https://stackoverflow.com/users/6868543/j6t"}, "edited": false, "score": 0, "creation_date": 1553108866, "post_id": 55267254, "comment_id": 97267939, "body": "It is impossible to take ownership of an object owned by a <code>shared_ptr</code>. So, unless <code>DataPointer</code> is actually also a <code>shared_ptr</code>, you have a lost case."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 1, "creation_date": 1553109683, "post_id": 55267254, "comment_id": 97268381, "body": "@AlexeyStarinsky: &quot;<i>this adds one extra line of code</i>&quot; Nonsense: <code>DataProcessor&lt;shared_ptr&lt;T&gt;&gt; dp(shared_ptr{sp});</code> Where <code>sp</code> is an appropriate shared_ptr (and using CTAD to avoid repeating the <code>T</code>). No extra line of code needed."}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1553110221, "post_id": 55267254, "comment_id": 97268645, "body": "@NicolBolas at least I did not find a better solution."}], "answers": [{"comments": [{"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "edited": false, "score": 0, "creation_date": 1553175358, "post_id": 55268925, "comment_id": 97293103, "body": "IMHO 3 looks better than 1 and 2"}], "tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": true, "score": 2, "last_activity_date": 1553110678, "creation_date": 1553110678, "answer_id": 55268925, "question_id": 55267254, "link": "https://stackoverflow.com/questions/55267254/a-uniform-copy-and-move-constructor-of-a-template-class/55268925#55268925", "title": "A uniform copy and move constructor of a template class", "body": "<p>Your choices are essentially these:</p>\n\n<ol>\n<li><p>Take the parameter by value:</p>\n\n<pre><code>DataProcessor(DataPointer p) : pData(std::move(p)) {}\n</code></pre>\n\n<p>If <code>DataPointer</code> is move-only, then the user will have to call it through <code>std::move</code>, which will move-construct <code>p</code>, which is then used to move-construct <code>pData</code>. If it is copyable, then <code>p</code> will be copy/move constructed based on how the user passes the value. From there, it will move construct <code>pData</code>.</p>\n\n<p>Note that this version adds an additional move operation.</p></li>\n<li><p>Take the parameter by rvalue reference, always:</p>\n\n<pre><code>DataProcessor(DataPointer &amp;&amp;p) : pData(std::move(p)) {}\n</code></pre>\n\n<p>In this case, if <code>DataPointer</code> is not move-only, and the user wants to pass an lvalue, the user must explicitly copy the value into a temporary used to initialize <code>p</code>. That would look something like this:</p>\n\n<pre><code>DataProcessor&lt;shared_ptr&lt;T&gt;&gt; dp(shared_ptr{sp});\n</code></pre>\n\n<p>Where <code>sp</code> is an existing <code>shared_ptr</code> that you want to copy from. This does only one move when given an object to move from, but does a copy+move when copying.</p></li>\n<li><p>Write two functions, employing SFINAE to remove the copying version if <code>DataPointer</code> is non-copyable. This version has the advantage of doing no additional moves:</p></li>\n</ol>\n\n<pre><code>DataProcessor(DataPointer &amp;&amp;p) : pData(std::move(p)) {}\ntemplate&lt;typename T = DataPointer&gt;\nDataProcessor(std::enable_if_t&lt;std::is_copy_constructible_v&lt;T&gt;, const T&amp;&gt; p)\n        : pData(p) {}\n</code></pre>\n"}], "owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 55268925, "answer_count": 1, "score": 0, "last_activity_date": 1553110678, "creation_date": 1553104372, "last_edit_date": 1553108315, "question_id": 55267254, "link": "https://stackoverflow.com/questions/55267254/a-uniform-copy-and-move-constructor-of-a-template-class", "title": "A uniform copy and move constructor of a template class", "body": "<p>Let assume I have a DataProcessor template class that holds a smart pointer to the processed data that has operator * and operator ->:</p>\n\n<pre><code>template &lt;class DataPointer&gt;\nclass DataProcessor\n{\n    public:\n\n        //it is not clear how to implement the constructor\n        //DataProcessor(DataPointer p) : pData(p) {};\n\n        void Process() { /* do something with *pData */ };\n\n    private:\n\n        DataPointer pData;\n}\n</code></pre>\n\n<p>How to implement the constructor to make DataProcessor work with both std::unique_ptr (the constructor should accept it by &amp;&amp; and move it) and std::shared_ptr (the constructor should accept it by &amp; and copy it)? Is it possible to have some kind of a uniform constructor?</p>\n\n<p>Actually I have a class that holds a smart Win32 handle UniqueHandle and SharedHandle that have the similar semantics like std::unique_ptr and std::shared_ptr. So it is a general question on how to implement a scenario like this.</p>\n"}, {"tags": ["c++", "struct", "binaryfiles"], "comments": [{"owner": {"reputation": 973, "user_id": 6540193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592f74822b1858f77a3c2fb5c4955b7c?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra K", "link": "https://stackoverflow.com/users/6540193/sandra-k"}, "edited": false, "score": 0, "creation_date": 1553104390, "post_id": 55267221, "comment_id": 97265731, "body": "I do not know why the down and the close vote, I showed my work in a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and I am expecting results from the .dat file to not be junk ..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1553104441, "post_id": 55267221, "comment_id": 97265757, "body": "Why are you not using std::vector? What is <code>TheSize</code>? And it&#39;s not complete -  it won&#39;t compile."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1553104466, "post_id": 55267221, "comment_id": 97265766, "body": "Well, I think that&#39;s a typo <code>&amp;MyArray</code> . Shouldn&#39;t that be just <code>MyArray</code> for writing and reading? Also I highly recommend your <code>reinterpret_cast&lt;char *&gt;</code> should rather be <code>reinterpret_cast&lt;uint8_t*&gt;</code> to save you from unexpected behaviors."}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1553104506, "post_id": 55267221, "comment_id": 97265782, "body": "If you have an MCVE please show it, I cannot see one in your current question. Maybe read the link again and double check that the shown code matches all the attributes described there. Providing input data is considered part of an MCVE."}, {"owner": {"reputation": 973, "user_id": 6540193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592f74822b1858f77a3c2fb5c4955b7c?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra K", "link": "https://stackoverflow.com/users/6540193/sandra-k"}, "edited": false, "score": 0, "creation_date": 1553104537, "post_id": 55267221, "comment_id": 97265798, "body": "@NeilButterworth I am not allowed to use std::vector. And TheSize can be any number, say it is a 5.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1553104633, "post_id": 55267221, "comment_id": 97265858, "body": "Post some compilable code."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1553104933, "post_id": 55267221, "comment_id": 97266006, "body": "I find myself wondering why dynamic allocation here: <code>Employee* MyArray = new Employee[TheSize];</code>, but not here: <code>Employee NewArray[TheSize];</code>. If <code>TheSize</code> is constant, both should be Automatic variables to keep the memory management as simple as possible unless <code>TheSize</code> is too large to fit the array in Automatic storage, which sentences case 2 to an ill doom. If <code>TheSize</code> is not constant, case 2 requires a non--Standard compiler extension and will not compile on many compilers."}, {"owner": {"reputation": 973, "user_id": 6540193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592f74822b1858f77a3c2fb5c4955b7c?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra K", "link": "https://stackoverflow.com/users/6540193/sandra-k"}, "edited": false, "score": 0, "creation_date": 1553105160, "post_id": 55267221, "comment_id": 97266125, "body": "I am sorry I forgot to mention <code>TheSize</code> is = 5 constant, so I did not notice while testing/posting. I edited my Q"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 2, "creation_date": 1553105263, "post_id": 55267221, "comment_id": 97266170, "body": "This doesn&#39;t address the question, but get in the habit of initializing objects with meaningful values rather than creating them with default values and immediately changing them. That is, change <code>fstream OutFileBin; OutFileBin.open(&quot;Employee.dat&quot;, ios::binary | ios::out);</code> to <code>fstream OutFileBin(&quot;Employee.dat&quot;, ios::binary | ios::out);</code>. Also, you don&#39;t need to call <code>OutFileBin.close();</code>. The destructor will do that."}, {"owner": {"reputation": 973, "user_id": 6540193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592f74822b1858f77a3c2fb5c4955b7c?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra K", "link": "https://stackoverflow.com/users/6540193/sandra-k"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1553105430, "post_id": 55267221, "comment_id": 97266249, "body": "@PeteBecker Now this is a helpful comment.. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 973, "user_id": 6540193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592f74822b1858f77a3c2fb5c4955b7c?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra K", "link": "https://stackoverflow.com/users/6540193/sandra-k"}, "edited": false, "score": 0, "creation_date": 1553104683, "post_id": 55267303, "comment_id": 97265883, "body": "Your solution fixed it! But it is is not what this gentleman did!, why? <a href=\"https://stackoverflow.com/a/5506657/6540193\">stackoverflow.com/a/5506657/6540193</a>"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1553104698, "post_id": 55267303, "comment_id": 97265898, "body": "See the additions regarding  <code>uint8_t</code> in <a href=\"https://stackoverflow.com/questions/55267221/why-saving-to-a-file-is-not-working-as-expected#comment97265766_55267221\">my comment</a> please."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 973, "user_id": 6540193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592f74822b1858f77a3c2fb5c4955b7c?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra K", "link": "https://stackoverflow.com/users/6540193/sandra-k"}, "edited": false, "score": 1, "creation_date": 1553104916, "post_id": 55267303, "comment_id": 97265999, "body": "@SandraK, The numerical value of <code>&amp;array</code> is the same as <code>array</code>  iff <code>array</code> is a statically defined array. That&#39;s why the answer in the linked post works. Notice how they are able to use <code>sizeof(apprentice)</code>. That wont work for dynamic arrays either."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 973, "user_id": 6540193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592f74822b1858f77a3c2fb5c4955b7c?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra K", "link": "https://stackoverflow.com/users/6540193/sandra-k"}, "edited": false, "score": 0, "creation_date": 1553104987, "post_id": 55267303, "comment_id": 97266030, "body": "@SandraK You might also want to know about <a href=\"https://stackoverflow.com/questions/1461432/what-is-array-decaying\">What is array decaying</a>."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1553105043, "post_id": 55267303, "comment_id": 97266062, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6, you&#39;ll have to educate me on why use of <code>reinterpret_cast&lt;char*&gt;</code> is not as safe as <code>reinterpret_cast&lt;uint8_t*&gt;</code>. The standard library expects a <code>char const*</code> for <code>ostream::write</code> and a <code>char*</code> for <code>istream::read</code>."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1553105218, "post_id": 55267303, "comment_id": 97266153, "body": "@RSahu My point is that <code>uint8_t</code> represents simple bytes, rather implicit (implementation dependent) of <code>signed char</code> or <code>unsigned char</code>. It could make at least a difference if the binary file is shared among different machine architectures or compilers used. Correct me if I am wrong about this regarding the standard definitions please."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 3, "last_activity_date": 1553104732, "last_edit_date": 1553104732, "creation_date": 1553104533, "answer_id": 55267303, "question_id": 55267221, "link": "https://stackoverflow.com/questions/55267221/why-saving-to-a-file-is-not-working-as-expected/55267303#55267303", "title": "Why saving to a file is not working as expected?", "body": "<p>The line</p>\n\n<pre><code>OutFileBin.write(reinterpret_cast&lt;char *&gt;(&amp;MyArray), TheSize * sizeof(Employee));\n</code></pre>\n\n<p>is not good. You don't want to treat <code>&amp;MyArray</code> as though it stores objects of type <code>Employee</code>. It needs to be just <code>MyArray</code>.</p>\n\n<pre><code>OutFileBin.write(reinterpret_cast&lt;char*&gt;(MyArray), TheSize * sizeof(Employee));\n</code></pre>\n\n<p>Also,</p>\n\n<pre><code>Employee NewArray[TheSize];\n</code></pre>\n\n<p>is not standard C++ unless <code>TheSize</code> is a compile time constant. Change it to </p>\n\n<pre><code>Employee* NewArray = new Employee[TheSize];\n</code></pre>\n\n<p>and the following line to</p>\n\n<pre><code>InFilebin.read(reinterpret_cast&lt;char *&gt;(NewArray), TheSize * sizeof(Employee));\n</code></pre>\n"}], "owner": {"reputation": 973, "user_id": 6540193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592f74822b1858f77a3c2fb5c4955b7c?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra K", "link": "https://stackoverflow.com/users/6540193/sandra-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 55267303, "answer_count": 1, "score": -3, "last_activity_date": 1553105127, "creation_date": 1553104263, "last_edit_date": 1553105127, "question_id": 55267221, "link": "https://stackoverflow.com/questions/55267221/why-saving-to-a-file-is-not-working-as-expected", "title": "Why saving to a file is not working as expected?", "body": "<p>I have this struct:</p>\n\n<pre><code>struct Employee\n{\n   char VarOne[50];        \n   unsigned int VarTwo;      \n   double VarThree[4];           \n}\n</code></pre>\n\n<p>Then, I populate a dynamic array of this struct:</p>\n\n<pre><code> Employee* MyArray = new Employee[TheSize]; // Sorry I forgot to mention TheSize is = 5 constant\n</code></pre>\n\n<p>Then, I try and write the array in binary mode to a file:</p>\n\n<pre><code>   // write as binary\n   fstream OutFileBin;\n   OutFileBin.open(\"Employee.dat\", ios::binary | ios::out);\n   OutFileBin.write(reinterpret_cast&lt;char *&gt;(&amp;MyArray), TheSize * sizeof(Employee));\n   OutFileBin.close();\n</code></pre>\n\n<p>But when I read the file in binary mode, it fails and data are junk:</p>\n\n<pre><code>   // read as binary\n   fstream InFilebin;\n   InFilebin.open(\"Employee.dat\", ios::binary | ios::in);\n   Employee NewArray[TheSize]; // sorry I forgot to mention TheSize is = 5 constant\n   InFilebin.read(reinterpret_cast&lt;char *&gt;(&amp;NewArray), TheSize * sizeof(Employee));\n</code></pre>\n\n<p>What is that I am doing wrong?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1553103941, "post_id": 55267110, "comment_id": 97265493, "body": "It&#39;s all the same here. But for other types you can get caught using the wrong constructor. <code>std::vector&lt;int&gt; x(10, 10);</code> (10 values 10) vs <code>std::vector&lt;int&gt;{10, 10};</code> (2 values of 10) is a common gotcha."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1553103992, "post_id": 55267110, "comment_id": 97265532, "body": "All those are semantically the same."}, {"owner": {"reputation": 5911, "user_id": 1688785, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07b2da937aa23792045dff6ff19556eb?s=128&d=identicon&r=PG", "display_name": "Caramiriel", "link": "https://stackoverflow.com/users/1688785/caramiriel"}, "edited": false, "score": 0, "creation_date": 1553104142, "post_id": 55267110, "comment_id": 97265596, "body": "<a href=\"https://stackoverflow.com/questions/24953658/what-are-the-differences-between-c-like-constructor-and-uniform-initialization\" title=\"what are the differences between c like constructor and uniform initialization\">stackoverflow.com/questions/24953658/&hellip;</a> for more info"}], "owner": {"reputation": 19, "user_id": 11233551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc318414acfbe1d57e7c604ca75d48f?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed", "link": "https://stackoverflow.com/users/11233551/mohamed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 1, "closed_date": 1553103979, "answer_count": 0, "score": 0, "last_activity_date": 1553104196, "creation_date": 1553103794, "last_edit_date": 1553103902, "question_id": 55267110, "link": "https://stackoverflow.com/questions/55267110/what-are-the-differences-in-how-these-3-strings-are-created", "closed_reason": "Duplicate", "title": "What are the differences in how these 3 strings are created?", "body": "<p>What's going on under the hood when it comes to creating these 3 strings?\nI apologize if this question was asked before, I couldn't find a good explanation.</p>\n\n<pre><code>string str1 = \"First string\";\nstring str2 (\"Second string\");\nstring str3 {\"Third string\"};\n</code></pre>\n\n<p>Besides syntax what are the differences? How are they created?</p>\n"}, {"tags": ["c++", "random", "eigen"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1553103231, "post_id": 55266724, "comment_id": 97265119, "body": "Make the <code>dis</code> a (mutable, or remove <code>const</code> from <code>operator()</code>) member of <code>RandomRange</code>?"}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553122291, "post_id": 55266724, "comment_id": 97273765, "body": "@MaxLanghof <code>operator()</code> needs to be <code>const</code> for Eigen. But making <code>dis</code> mutable is one possible solution."}], "answers": [{"tags": [], "owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "is_accepted": true, "score": 2, "last_activity_date": 1553122513, "last_edit_date": 1553122513, "creation_date": 1553122204, "answer_id": 55271286, "question_id": 55266724, "link": "https://stackoverflow.com/questions/55266724/efficient-way-to-initialize-eigen-matrix-or-vector-with-random-numbers-from-a-sp/55271286#55271286", "title": "Efficient way to initialize Eigen Matrix or Vector with random numbers from a specific range?", "body": "<p>First of all, initializing (seeding) a <code>default_random_engine</code> with one number of a Mersenne-twister does not really make sense. If the simple random engine is good enough, directly seed it with <code>time(0)</code> or whatever you prefer. If you need longer sequences of truly independent pseudo-random numbers, directly pass the <code>mt19937</code> object to your distribution.</p>\n\n<p>Also, you are not using the <code>high</code> argument of your <code>operator()</code>, so you should actually use a <code>NullaryExpr</code>. Also, you can make <code>dis</code> a member variable, and probably better store a reference to the generator instead of making it a global variable:</p>\n\n<pre><code>template&lt;typename Scalar&gt;\nstruct RandomRange {\n    RandomRange(const Scalar&amp; low, const Scalar&amp; high, \n                std::default_random_engine &amp;gen) : dis(low, high), gen(gen) {}\n    const Scalar operator()() const { return dis(gen); }\n    mutable std::uniform_int_distribution&lt;&gt; dis;\n    std::default_random_engine &amp;gen;\n};\n</code></pre>\n\n<p>And call it like:</p>\n\n<pre><code>std::default_random_engine gen(time(0));\nEigen::VectorXi testVec = Eigen::VectorXi::NullaryExpr(10,RandomRange&lt;int&gt;(5,100, gen));\n</code></pre>\n\n<p>or</p>\n\n<pre><code>std::default_random_engine gen(time(0));\nRandomRange&lt;int&gt; uniform(5,100, gen)\nEigen::VectorXi testVec = Eigen::VectorXi::NullaryExpr(10, uniform);\n</code></pre>\n\n<p>With C++11 you can also just define your distribution locally and call it using a lambda expression:</p>\n\n<pre><code>std::default_random_engine gen(time(0));\nstd::uniform_int_distribution&lt;&gt; dis(5,100);\nEigen::VectorXi testVec = Eigen::VectorXi::NullaryExpr(10,[&amp;](){ return dis(gen); });\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>std::default_random_engine gen(time(0));\nstd::uniform_int_distribution&lt;&gt; dis(5,100);\nauto uni = [&amp;](){ return dis(gen); };\nEigen::VectorXi testVec = Eigen::VectorXi::NullaryExpr(10,uni);\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>std::default_random_engine gen(time(0));\nEigen::VectorXi testVec = Eigen::VectorXi::NullaryExpr(10,[&amp;gen](){\n    std::uniform_int_distribution&lt;&gt; dis(5,100);\n    return dis(gen);\n});\n</code></pre>\n\n<p>Some godbolt compilation examples: <a href=\"https://godbolt.org/z/uG0j__\" rel=\"nofollow noreferrer\">https://godbolt.org/z/uG0j__</a></p>\n\n<p>Unless you find that this is a bottle-neck, I would not care too early about what variant is most performant (with proper optimization they should all be equivalent), but use whatever variant is most easy to read and maintain inside your code base.</p>\n"}], "owner": {"reputation": 331, "user_id": 4567066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecf1fb592154e510dbbf226bbd2caf7e?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Lachmann", "link": "https://stackoverflow.com/users/4567066/jon-lachmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 752, "favorite_count": 0, "accepted_answer_id": 55271286, "answer_count": 1, "score": 1, "last_activity_date": 1553122513, "creation_date": 1553102446, "question_id": 55266724, "link": "https://stackoverflow.com/questions/55266724/efficient-way-to-initialize-eigen-matrix-or-vector-with-random-numbers-from-a-sp", "title": "Efficient way to initialize Eigen Matrix or Vector with random numbers from a specific range?", "body": "<p>I am trying to initialise an Eigen vector of integers with random numbers from a specific range. My approach so far has been to create a functor and calling it, it is however problematic in the sense that I need to initialise the random generation in a way that it wont be re-initialised each time.</p>\n\n<p>What would be \"the best\" way of doing this? Speed-wise.</p>\n\n<p>My code for the functor so far is:</p>\n\n<pre><code>std::mt19937 rd(time(0));\nstd::default_random_engine gen(rd());\n\ntemplate&lt;typename Scalar&gt;\nstruct RandomRange {\n    RandomRange(const Scalar&amp; low, const Scalar&amp; high) : m_low(low), m_high(high) {}\n    const Scalar operator()(const Scalar&amp; high) const {\n        std::uniform_int_distribution&lt;&gt; dis(m_low, m_high);\n        return dis(gen); }\n    Scalar m_low, m_high;\n};\n</code></pre>\n\n<p>And i call it using:</p>\n\n<pre><code>VectorXi testVec = VectorXi(10).unaryExpr(RandomRange&lt;int&gt;(5,100));\n</code></pre>\n\n<p>A side question is where it would be proper to put such a definition? I am rather new to c++ in general, but I imagine it should be in a header file, but am unsure how it would work with the initialisation of the random number generator.</p>\n\n<p>Best regards!</p>\n"}, {"tags": ["c++", "performance", "c++11"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1553101672, "post_id": 55266468, "comment_id": 97264220, "body": "Have you identified this as a performance bottleneck?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 3, "creation_date": 1553101720, "post_id": 55266468, "comment_id": 97264246, "body": "Reset as you iterate?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1553101756, "post_id": 55266468, "comment_id": 97264262, "body": "Provided your type is <a href=\"https://en.cppreference.com/w/cpp/named_req/TriviallyCopyable\" rel=\"nofollow noreferrer\">trivial</a> you can <a href=\"https://en.cppreference.com/w/cpp/string/byte/memset\" rel=\"nofollow noreferrer\"><code>memset</code></a> the whole thing."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 6, "creation_date": 1553101909, "post_id": 55266468, "comment_id": 97264362, "body": "Just call <code>clear()</code> and change it later if profiling shows an actual issue. You don&#39;t need to change the values in memory, you just need to know they&#39;re all invalid. No de- or re-allocation is required."}, {"owner": {"reputation": 3997, "user_id": 173286, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e11c16ba7ee56069c29b44d4fd903d4f?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/173286/ben"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1553102037, "post_id": 55266468, "comment_id": 97264445, "body": "@Fran&#231;ois Andrieux It might be a performance bottleneck. I want to test, if it&#39;s faster without reallocation, as this happens more than 60 times / second."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1553102136, "post_id": 55266468, "comment_id": 97264512, "body": "@Ben You should use profiling tools to identify which parts of your code are actually taking up a lot of time instead of trying things to see if it helps. Optimizing by intuition is almost always a waste of time, the bottleneck is generally not where you expect it."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553102153, "post_id": 55266468, "comment_id": 97264527, "body": "Note that <code>clear()</code> does not deallocate memory."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1553102341, "post_id": 55266468, "comment_id": 97264645, "body": "The point I believe Fran&#231;ois is trying to get across is, &quot;Compared to all of the other stuff going on in the program is the cost of emptying the <code>vector</code> even noticeable?&quot; Not much point pumping effort into a 50% improvement to 1% of the program when you could improve the sucker that is consuming 80% of the time. That said, @Useless &#39;s comment about <code>clear</code> is quick and easy. Worth doing out of general principles. And now he&#39;s posted it as an answer."}, {"owner": {"reputation": 16695, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1553102354, "post_id": 55266468, "comment_id": 97264652, "body": "@Fran&#231;oisAndrieux which tools would you suggest?"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1553102356, "post_id": 55266468, "comment_id": 97264658, "body": "@Fran&#231;oisAndrieux No you can&#39;t. If you memset the memory to all-bits-zero, you might find that the float was a signalling nan, and that any pointers caused access-violations (I have used machines where the natural implementation would have led to latter being true.)"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1553102364, "post_id": 55266468, "comment_id": 97264660, "body": "@Ben <i>&quot;I want to test, if it&#39;s faster without reallocation&quot;</i> Do you know how big your vector will grow in advance (at least approximately)? Then <code>clear()</code> and <a href=\"https://en.cppreference.com/w/cpp/container/vector/reserve\" rel=\"nofollow noreferrer\"><code>reserve()</code></a> are your friends."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1553102539, "post_id": 55266468, "comment_id": 97264742, "body": "Profiling tools are going to be platform specific (and tool requests are off-topic anyway), but examples include gbench or other micro-benchmarks, perf, gprof, vtune, maybe the valgrind callgrind/cachegrind tools ..."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 16695, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 0, "creation_date": 1553102622, "post_id": 55266468, "comment_id": 97264792, "body": "@Ayxan It depends on your platform."}, {"owner": {"reputation": 3997, "user_id": 173286, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e11c16ba7ee56069c29b44d4fd903d4f?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/173286/ben"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1553102694, "post_id": 55266468, "comment_id": 97264830, "body": "@Fran&#231;ois Andrieux let&#39;s just assume it&#39;s not a performance bottleneck and I&#39;m just curious and want to learn about different ways to do it?"}, {"owner": {"reputation": 16695, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1553102895, "post_id": 55266468, "comment_id": 97264930, "body": "@Fran&#231;oisAndrieux I am interested in such tools for Windows with 64 bit Intel CPU. Would you suggest any particular one?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 16695, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 1, "creation_date": 1553103008, "post_id": 55266468, "comment_id": 97264992, "body": "@Ayxan Visual Studio comes with a profiler built-in. In 2015 it&#39;s in Debug-&gt;Performance Profiler... or Alt+F2."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1553103124, "post_id": 55266468, "comment_id": 97265058, "body": "@MartinBonner I can&#39;t quite follow your comment. You had a platform where overwriting a signaling NaN would cause a trap?"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553103242, "post_id": 55266468, "comment_id": 97265126, "body": "@MaxLanghof I had a platform where <code>void* p; memset(&amp;p, 0, sizeof(p)); if (p) ...</code> would cause a segfault."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 1, "creation_date": 1553103392, "post_id": 55266468, "comment_id": 97265207, "body": "@MartinBonner Was <code>nullptr</code> zero on that platform? It&#39;s not required to be, so you may not have initialized your pointer to <code>nullptr</code>, just zero."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1553103958, "post_id": 55266468, "comment_id": 97265507, "body": "@Fran&#231;oisAndrieux Shouldn&#39;t it still allow conversion to bool though? I mean, maybe the code inside the <code>if</code> caused the segfault, but I don&#39;t think <code>if (p)</code> is allowed to segfault for &quot;invalid&quot; p values..."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553104074, "post_id": 55266468, "comment_id": 97265565, "body": "@MaxLanghof I&#39;m expecting that it&#39;s the branch being incorrectly taken that would cause the problem. The use of &quot;<code>...</code>&quot; implies there is more to it than what&#39;s shown, I&#39;m assuming it isn&#39;t just <code>if(p);</code>. I&#39;m not sure if pointers are allowed trap values. It would surprise me, but I&#39;m just not certain. But then you have a platform with non-zero <code>nullptr</code> and with trapping pointers. Sounds like a pathological platform designed to stress-test the language."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1553104747, "post_id": 55266468, "comment_id": 97265921, "body": "@MaxLanghof C says (C17:6.2.6.1.5) character types are the only types required to not have a trap representation and C++17 makes no further mention of trap representations so I guess it&#39;s possible."}, {"owner": {"reputation": 3997, "user_id": 173286, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e11c16ba7ee56069c29b44d4fd903d4f?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/173286/ben"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1553193433, "post_id": 55266468, "comment_id": 97304014, "body": "@Fran&#231;oisAndrieux: you&#39;re right: I should profile first. But in this case my intuition was right and the performance increased by almost 100%, because I resetted the vector (with memset) instead of creating a new one. I had 50% kernel CPU time before. Now the CPU is at 100% with no kernel time."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1553193603, "post_id": 55266468, "comment_id": 97304090, "body": "@Ben I&#39;m not sure what you did that would cause a reallocation. Just <code>clear</code> and repopulating should not cause any memory manipulation. If <code>memset</code> works it implies that you keep hold of the original vector instance so unless you do something to explicitly reduce it&#39;s capacity. I&#39;m curious to see what would have caused the original problem."}, {"owner": {"reputation": 3997, "user_id": 173286, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e11c16ba7ee56069c29b44d4fd903d4f?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/173286/ben"}, "edited": false, "score": 0, "creation_date": 1553194017, "post_id": 55266468, "comment_id": 97304278, "body": "I have a thread pool and every thread created a new vector every time it ran a task. Now the thread uses an external vector and reinitializes it. I did it with memset, but I guess clear()/resize() might do the job, too. I haven&#39;t checked, if there is a difference in performance yet. My original question was to find out, which different options I have to reinitialize a vector. The accepted answer is exactly what I was looking for."}], "answers": [{"comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553102579, "post_id": 55266666, "comment_id": 97264772, "body": "That does mean that the vector needs to be treated differently depending on whether it was just created (it is full of initialized elements) or retained from the previous frame (empty)."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553102645, "post_id": 55266666, "comment_id": 97264805, "body": "Maybe - if you use <code>reserve</code> in the first place, each usage begins with it empty and the cached allocation is a transparent optimization."}, {"owner": {"reputation": 3997, "user_id": 173286, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e11c16ba7ee56069c29b44d4fd903d4f?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/173286/ben"}, "edited": false, "score": 0, "creation_date": 1553103137, "post_id": 55266666, "comment_id": 97265069, "body": "I&#39;m not pushing back elements. I want 10M entries to be 0 after every reset."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1553103281, "post_id": 55266666, "comment_id": 97265148, "body": "Why? What&#39;s the difference between a zero element and one that doesn&#39;t exist?"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1553103379, "post_id": 55266666, "comment_id": 97265199, "body": "@Useless That you can write to it at any time? On a certain level this is the same question as <a href=\"https://www.reddit.com/r/geek/comments/6128y3/amusing_example_between_0_and_null_0_on_the_left/\" rel=\"nofollow noreferrer\">&quot;what&#39;s the difference between null and zero&quot;</a>..."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1553103535, "post_id": 55266666, "comment_id": 97265278, "body": "You mean, if you&#39;re keeping pointers or iterators into the vector, or you need random access by a meaningful index? I guess it must be the last one, because the first two conflict with the original &quot;new vector&quot; suggestion."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553103760, "post_id": 55266666, "comment_id": 97265390, "body": "Think of zeroing out a mathematical vector (so you can perform vector math on it). This requires the elements to be there - you don&#39;t want to include a &quot;if the element I want to operate on isn&#39;t there, insert it&quot; check (or a &quot;if the vector is empty, resize it to match my operation&quot; check) in every arithmetic operation implementation."}, {"owner": {"reputation": 3997, "user_id": 173286, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e11c16ba7ee56069c29b44d4fd903d4f?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/173286/ben"}, "edited": false, "score": 0, "creation_date": 1553103787, "post_id": 55266666, "comment_id": 97265404, "body": "The score for an ID might be updated many times in one loop. That&#39;s why I want constant access time. The number of elements receiving a score is fixed though."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1553103893, "post_id": 55266666, "comment_id": 97265457, "body": "Right, so you need random access based on an external index. That information could perhaps be added to the question."}], "tags": [], "owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "is_accepted": false, "score": 6, "last_activity_date": 1553103845, "last_edit_date": 1553103845, "creation_date": 1553102245, "answer_id": 55266666, "question_id": 55266468, "link": "https://stackoverflow.com/questions/55266468/whats-the-fastest-way-to-reinitialize-a-vector/55266666#55266666", "title": "What&#39;s the fastest way to reinitialize a vector?", "body": "<blockquote>\n  <p>What's the fastest way to reinitialize a vector?</p>\n</blockquote>\n\n<p>Don't.</p>\n\n<p>Just record the fact that the vector has no valid entries by calling <a href=\"https://en.cppreference.com/w/cpp/container/vector/clear\" rel=\"nofollow noreferrer\"><code>clear()</code></a>.  This has the advantage of being both (probably) optimal, and guaranteed correct, and also being perfectly expressive. IMO none of the suggested alternatives should be considered unless profiling shows an actual need.</p>\n\n<p>Your element type is trivial, so the linear upper-bound on complexity should in reality be constant for a decent quality implementation - there's no need to destroy each element in turn.</p>\n\n<p>No memory is deallocated, or needs to be re-allocated later.</p>\n\n<p>You'll just need to <code>push_back</code> or <code>emplace_back</code> when you're writing into the vector after <code>clear()</code>ing, instead of using <code>operator[]</code>.</p>\n\n<p>To make this consistent with the first use, don't initialize your vector with 10000000 value-constructed elements, but use <code>reserve(10000000)</code> to pre-allocate without initialization.</p>\n\n<p>eg.</p>\n\n<pre><code>int main() {\n  vector&lt;foo&gt; v;\n  v.reserve(10000000);\n\n  while(keep_running) {\n    use(v);\n    v.clear();\n  }\n}\n\n// precondition: v is empty, so\n// don't access v[i] until you've done\n//   v.push_back({id,score})\n// at least i+1 times\nvoid use(vector&lt;foo&gt; &amp;v) {\n}\n</code></pre>\n\n<hr>\n\n<p>Since you need to zero your elements in-place, the second fastest general-purpose solution is probably to alter the loop above to</p>\n\n<pre><code>  while(keep_running) {\n    v.resize(10000000);\n    use(v);\n    v.clear();\n  }\n</code></pre>\n\n<p>or alternatively to remove the <code>clear()</code> and use <code>fill()</code> to overwrite all elements in-place.</p>\n\n<p>If non-zero elements are sparse, as may be the case if you're updating them based on some meaningful index, it might be faster to zero them on the fly as your main loop iterates over the vector.</p>\n\n<p>Again, you really need to <em>profile</em> to find out which is better for your use case.</p>\n"}, {"comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 3, "creation_date": 1553102838, "post_id": 55266737, "comment_id": 97264901, "body": "If the element type is trivial, one would hope that <code>std::fill</code> is implemented as <code>memset</code> (but without the potential of messing it up). In fact, that&#39;s what <a href=\"https://godbolt.org/z/gbYf7S\" rel=\"nofollow noreferrer\">clang does</a>, but (without further architectural knowledge) I doubt gcc&#39;s loop is any worse."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553103139, "post_id": 55266737, "comment_id": 97265072, "body": "@MaxLanghof I would hope. <a href=\"https://stackoverflow.com/q/5074208/2079303\">Apparently</a> it doesn&#39;t always happen. OP of that question never told if they enabled optimisations though. But sometimes you want your debug builds to be fast too."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1553104222, "last_edit_date": 1553104222, "creation_date": 1553102473, "answer_id": 55266737, "question_id": 55266468, "link": "https://stackoverflow.com/questions/55266468/whats-the-fastest-way-to-reinitialize-a-vector/55266737#55266737", "title": "What&#39;s the fastest way to reinitialize a vector?", "body": "<blockquote>\n  <p>What is the fastest way to reset all values for a large vector to its default values?</p>\n</blockquote>\n\n<p>Depends on what vector in its \"default values\" means.</p>\n\n<p>If you want to remove all elements, most efficient is <code>std::vector::clear</code>.</p>\n\n<p>If you want to keep all elements in the vector but set their state, then you can use <code>std::fill</code>:</p>\n\n<pre><code>std::fill(large_vector.begin(), large_vector.end(), default_value);\n</code></pre>\n\n<hr>\n\n<p>If the element type is trivial, and the \"default value\" is zero<sup>\u2020</sup>, then <code>std::memset</code> may be optimal:</p>\n\n<pre><code>static_assert(std::is_trivially_copyable_v&lt;decltype(large_vector[0])&gt;);\nstd::memset(large_vector.data(), 0, large_vector.size() * sizeof(large_vector[0]));\n</code></pre>\n\n<p>To verify that <code>std::memset</code> is worth the trouble, you should measure (or inspect assembly). The optimiser may do the work for you.</p>\n\n<p><sup>\u2020</sup> Zero in the sense that all bits are unset. C++ does not guarantee that this is a representation for a zero float. It also doesn't guarantee it to be a null pointer, in case your non-minimal use case uses pointers.</p>\n"}, {"comments": [{"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 4, "creation_date": 1553104564, "post_id": 55266856, "comment_id": 97265813, "body": "Your enumeration is missing <code>std::fill</code>, which I expect to be at least as efficient as <code>std::memset</code> (in all likelihood it\u2019s doing the same thing in this scenario) but it\u2019s type safe and more readable in C++ than <code>std::memset</code>. There\u2019s an impulse to go to unsafe C functions for maximum performance but this impulse isn\u2019t justified: Since <code>std::fill</code> has more information than <code>std::memset</code> it can always perform at least as well."}], "tags": [], "owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "is_accepted": true, "score": 3, "last_activity_date": 1553107000, "last_edit_date": 1553107000, "creation_date": 1553102872, "answer_id": 55266856, "question_id": 55266468, "link": "https://stackoverflow.com/questions/55266468/whats-the-fastest-way-to-reinitialize-a-vector/55266856#55266856", "title": "What&#39;s the fastest way to reinitialize a vector?", "body": "<p>In order to determine the fastest way you will need to run some benchmarks.</p>\n\n<p>There are a number of different ways to \"reinitialise\" a vector:</p>\n\n<ol>\n<li>Call <a href=\"https://en.cppreference.com/w/cpp/container/vector/capacity\" rel=\"nofollow noreferrer\"><code>clear()</code></a>, for trivial types this should be roughly equivalent to just doing <code>vector.size = 0</code>. The capacity of the vector doesn't change and no elements are deallocated. Destructors will be called on elements if they exist. As you <code>push_back</code>, <code>emplace_back</code> or <code>resize</code> the vector the old values will be overwritten.</li>\n<li>Call <a href=\"https://en.cppreference.com/w/cpp/container/vector/assign\" rel=\"nofollow noreferrer\"><code>assign()</code></a>, e.g. <code>large_vector.assign( large_vector.size(), Foo() );</code>. This will iterate through the whole vector resetting every element to its default value. Hopefully the compiler will manage to optimise this to a memset or similar.</li>\n<li>As your type is trivial, if you want to just reset every element to <code>0</code> you should be able to do a <code>memset</code>, e.g.: <code>memset( large_vector.data(), 0, sizeof(Foo)*large_vector.size() );</code>.</li>\n<li>Call <a href=\"https://en.cppreference.com/w/cpp/algorithm/fill\" rel=\"nofollow noreferrer\"><code>std::fill</code></a> e.g. <code>std::fill( large_vector.begin(), large_vector.end(), Foo() );</code>, this should be similar to <code>assign</code> or <code>memset</code>.</li>\n</ol>\n"}], "owner": {"reputation": 3997, "user_id": 173286, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e11c16ba7ee56069c29b44d4fd903d4f?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/173286/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7024, "favorite_count": 0, "accepted_answer_id": 55266856, "answer_count": 3, "score": 2, "last_activity_date": 1553107000, "creation_date": 1553101625, "last_edit_date": 1553103351, "question_id": 55266468, "link": "https://stackoverflow.com/questions/55266468/whats-the-fastest-way-to-reinitialize-a-vector", "title": "What&#39;s the fastest way to reinitialize a vector?", "body": "<p>What is the fastest way to reset all values for a large vector to its default values?</p>\n\n<pre><code>struct foo\n{\n  int id;\n  float score;\n};\n\nstd::vector&lt;foo&gt; large_vector(10000000);\n</code></pre>\n\n<p>The simplest way would be to create a new vector, but I guess it takes more time to reallocate memory than to reinitialize an existing one?</p>\n\n<p>I have to iterate over the vector to collect non-zero scores (could be thousands or millions) before resetting it. Should I reset the structs one by one in this loop?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>The vector size is fixed and 'default value' means 0 for every struct member (all floats and ints).</p>\n"}, {"tags": ["c++", "windows", "optimization", "c++-cli", "x86-64"], "comments": [{"owner": {"reputation": 696, "user_id": 6060561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1lugp.jpg?s=128&g=1", "display_name": "SBS", "link": "https://stackoverflow.com/users/6060561/sbs"}, "edited": false, "score": 0, "creation_date": 1553168739, "post_id": 55266411, "comment_id": 97289180, "body": "In the meantime, I&#39;ve tried several combinations of compiler/linker options that change the optimization used and the handling of intrinsics - to no avail. I&#39;ve also confirmed that it&#39;s really unimportant which intrinsic is used in order to confirm the last observation. For instance, I&#39;ve inserted __nop() at the beginning of my test function (without using _umul128), and got the same pattern as in the last benchmark above, i.e. ASM code 5 times faster, and C++ code 7 times slower. The latter slowdown is bigger than the effect of turning off optimizations."}], "answers": [{"comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1585192088, "post_id": 55283426, "comment_id": 107678572, "body": "call/ret and store/reload overhead is probably most of the cost of your <code>AsmMul1</code>.  On modern x86 CPUs (AMD Zen, and Intel since Nehalem or so), <code>mul r64</code> has 1/clock throughput and latency of 3 or 4 cycles.  See <a href=\"https://uops.info/\" rel=\"nofollow noreferrer\">uops.info</a> and <a href=\"https://agner.org/optimize/\" rel=\"nofollow noreferrer\">agner.org/optimize</a>.  So yeah, it sounds like CLI is a massive obstacle.  Better write a whole loop in asm and call it once, so you only pay the overhead once.  For example, <a href=\"https://gmplib.org/\" rel=\"nofollow noreferrer\">gmplib.org</a> has hand-optimized asm for extended-precision math.  e.g. <a href=\"https://gmplib.org/repo/gmp/file/tip/mpn/x86_64/mul_1.asm\" rel=\"nofollow noreferrer\">gmplib.org/repo/gmp/file/tip/mpn/x86_64/mul_1.asm</a>"}], "tags": [], "owner": {"reputation": 696, "user_id": 6060561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1lugp.jpg?s=128&g=1", "display_name": "SBS", "link": "https://stackoverflow.com/users/6060561/sbs"}, "is_accepted": true, "score": 2, "last_activity_date": 1553180508, "creation_date": 1553180508, "answer_id": 55283426, "question_id": 55266411, "link": "https://stackoverflow.com/questions/55266411/calling-masm-proc-from-c-cli-in-x64-mode-yields-unexpected-performance-problem/55283426#55283426", "title": "Calling MASM PROC from C++/CLI in x64 mode yields unexpected performance problems", "body": "<p>After a lot of trial-and-error, and additional extensive research on the Internet, it seems I've found the reason for this strange performance behavior. The magic word is <strong>thunking</strong>   of function entry points. But let me start from the beginning.</p>\n\n<p>One observation I made is that it doesn't really matter which compiler intrinsic is used in order to turn my benchmark results upside down. Actually, it suffices to put a <code>__nop()</code> (CPU NOP opcode) anywhere inside a function to trigger this effect. It works even if it's placed right before the <code>return</code>. More tests have shown that the effect is restricted to the function that contains the intrinsic. The <code>__nop()</code> does nothing with respect to the code flow, but obviously it changes the properties of the containing function.</p>\n\n<p>I've found a question on stackoverflow that seems to tackle a similar problem: <a href=\"https://stackoverflow.com/questions/18964076/how-to-best-avoid-double-thunking-in-c-cli-native-types\">How to best avoid double thunking in C++/CLI native types</a> In the comments, the following additional information is found:</p>\n\n<blockquote>\n  <p>One of my own classes in our base library - which uses MFC - is called\n  about a million times.\n  We are seeing massive sporadic performance issues, and firing up the\n  profiler I can see a thunk right at the bottom of this chain. That\n  thunk takes longer than the method call.</p>\n</blockquote>\n\n<p>That's exactly what I'm observing as well - \"something\" on the way of the function call is taking about four times longer than my code. Function thunks are explained to some extend in the documentation of the <a href=\"https://docs.microsoft.com/en-us/cpp/cpp/clrcall?view=vs-2017\" rel=\"nofollow noreferrer\">__clrcall modifier</a> and in an article about <a href=\"https://docs.microsoft.com/en-us/cpp/dotnet/double-thunking-cpp?view=vs-2017\" rel=\"nofollow noreferrer\">Double Thunking</a>. In the former, there's a hint to a side effect of using intrinsics:</p>\n\n<blockquote>\n  <p>You can directly call __clrcall functions from existing C++ code that\n  was compiled by using /clr as long as that function has an MSIL\n  implementation. __clrcall functions cannot be called directly from\n  functions that have inline asm and call CPU-specific intrinisics, for\n  example, even if those functions are compiled with /clr.</p>\n</blockquote>\n\n<p>So, as far as I understand it, a function that contains intrinsics loses its <code>__clrcall</code> modifier which is added automatically when the /clr compiler switch is specified - which is usually the case if the C++ functions should be compiled to native code.</p>\n\n<p>I don't get all of the details of this thunking and double thunking stuff, but obviously it is required to make unmanaged functions callable from managed functions. However, it is possible to switch it off per function by embedding it into a <code>#pragma managed(push, off)</code> / <code>#pragma managed(pop)</code> pair. Unfortunately, this #pragma doesn't work inside namespace blocks, so some editing might be required to place it everywhere where it is supposed to occur.</p>\n\n<p>I've tried this trick, placing all of my native multi-precision code inside this #pragma, and got the following benchmark results:</p>\n\n<pre><code>AsmMul1: 78 msec (64-to-128-bit CPU MUL)\nAsmMul2: 94 msec (hand-optimized ASM, 4 x IMUL)\nAsmMul3: 125 msec (compiler-generated ASM, 4 x IMUL)\nC++ function: 109 msec\n</code></pre>\n\n<p>Now this looks reasonable, finally! Now all versions have about the same execution times, which is what I would expect from an optimized C++ program. Alas, there's still no happy end... Placing the winner <code>AsmMul1</code> into my multi-precision multiplier yielded twice the execution time of the version with the C++ function without #pragma. The explanation is, in my opinion, that this code makes calls to unmanaged functions in other classes, which are outside the #pragma and hence have a <code>__clrcall</code> modifier. This seems to create significant overhead again.</p>\n\n<p>Frankly, I'm tired of investigating further into this issue. Although the ASM PROC with the single MUL instruction seems to beat all other attempts, the gain is not as big as expected, and getting the thunking out of the way leads to so many changes in my code that I don't think it's worth the hassle. So I'll go on with the C++ function I've written in the very beginning, originally destined to be just a placeholder for something better...</p>\n\n<p>It seems to me that ASM interfacing in C++/CLI is not well supported, or maybe I'm still missing something basic here. Maybe there's a way to get this function thunking out of the way for just the ASM functions, but so far I haven't found a solution. Not even remotely.</p>\n\n<p>Feel free to add your own thoughts and observations here - even if they are just speculative. I think it's still a highly interesting topic that needs much more investigation.</p>\n"}], "owner": {"reputation": 696, "user_id": 6060561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1lugp.jpg?s=128&g=1", "display_name": "SBS", "link": "https://stackoverflow.com/users/6060561/sbs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 55283426, "answer_count": 1, "score": 1, "last_activity_date": 1585191474, "creation_date": 1553101415, "last_edit_date": 1585191474, "question_id": 55266411, "link": "https://stackoverflow.com/questions/55266411/calling-masm-proc-from-c-cli-in-x64-mode-yields-unexpected-performance-problem", "title": "Calling MASM PROC from C++/CLI in x64 mode yields unexpected performance problems", "body": "<p>I'm writing an arbitrary precision integer class to be used in C# (64-bit). Currently I'm working on the multiplication routine, using a recursive divide-and-conquer algorithm to break down the multi-bit multiplication into a series of primitive 64-to-128-bit multiplications, the results of which are recombined then by simple addition. In order to get a significant performance boost, I'm writing the code in native x64 C++, embedded in a C++/CLI wrapper to make it callable from C# code.</p>\n\n<p>It all works great so far, regarding the algorithms. However, my problem is the optimization for speed. Since the 64-to-128-bit multiplication is the real bottleneck here, I tried to optimize my code right there. My first simple approach was a C++ function that implements this multiplication by performing four 32-to-64-bit multiplications and recombining the results with a couple of shifts and adds. This is the source code:</p>\n\n<pre><code>// 64-bit to 128-bit multiplication, using the following decomposition:\n// (a*2^32 + i) (b*2^32 + i) = ab*2^64 + (aj + bi)*2^32 + ij\n\npublic: static void Mul (UINT64  u8Factor1,\n                         UINT64  u8Factor2,\n                         UINT64&amp; u8ProductL,\n                         UINT64&amp; u8ProductH)\n    {\n    UINT64 u8Result1, u8Result2;\n    UINT64 u8Factor1L = u8Factor1 &amp; 0xFFFFFFFFULL;\n    UINT64 u8Factor2L = u8Factor2 &amp; 0xFFFFFFFFULL;\n    UINT64 u8Factor1H = u8Factor1 &gt;&gt; 32;\n    UINT64 u8Factor2H = u8Factor2 &gt;&gt; 32;\n\n    u8ProductL = u8Factor1L * u8Factor2L;\n    u8ProductH = u8Factor1H * u8Factor2H;\n    u8Result1  = u8Factor1L * u8Factor2H;\n    u8Result2  = u8Factor1H * u8Factor2L;\n\n    if (u8Result1 &gt; MAX_UINT64 - u8Result2)\n        {\n        u8Result1 +=  u8Result2;\n        u8Result2  = (u8Result1 &gt;&gt; 32) | 0x100000000ULL; // add carry\n        }\n    else\n        {\n        u8Result1 +=  u8Result2;\n        u8Result2  = (u8Result1 &gt;&gt; 32);\n        }\n    if (u8ProductL &gt; MAX_UINT64 - (u8Result1 &lt;&lt;= 32))\n        {\n        u8Result2++;\n        }\n    u8ProductL += u8Result1;\n    u8ProductH += u8Result2;\n    return;\n    }\n</code></pre>\n\n<p>This function expects two 64-bit values and returns a 128-bit result as two 64-bit quantities passed as reference. This works fine. In the next step, I tried to replace the call to this function by ASM code that calls the CPU's MUL instruction. Since there's no inline ASM in x64 mode anymore, the code must be put into a separate .asm file. This is the implementation:</p>\n\n<pre><code>_TEXT segment\n\n; =============================================================================\n; multiplication\n; -----------------------------------------------------------------------------\n; 64-bit to 128-bit multiplication, using the x64 MUL instruction\n\nAsmMul1 proc ; ?AsmMul1@@$$FYAX_K0AEA_K1@Z\n\n; ecx  : Factor1\n; edx  : Factor2\n; [r8] : ProductL\n; [r9] : ProductH\n\nmov  rax, rcx            ; rax = Factor1\nmul  rdx                 ; rdx:rax = Factor1 * Factor2\nmov  qword ptr [r8], rax ; [r8] = ProductL\nmov  qword ptr [r9], rdx ; [r9] = ProductH\nret\n\nAsmMul1 endp\n\n; =============================================================================\n\n_TEXT ends\nend\n</code></pre>\n\n<p>That's utmost simple and straightforward. The function is referenced from C++ code using an <code>extern \"C\"</code> forward definition:</p>\n\n<pre><code>extern \"C\"\n    {\n    void AsmMul1 (UINT64, UINT64, UINT64&amp;, UINT64&amp;);\n    }\n</code></pre>\n\n<p>To my surprise, it turned out to be significantly slower than the C++ function. To properly benchmark the performance, I've written a C++ function that computes 10,000,000 pairs of pseudo-random unsigned 64-bit values and performs multiplications in a tight loop, using those implementations one after another, with exactly the same values. The code is compiled in Release mode with optimizations turned on. The time spent in the loop is 515 msec for the ASM version, compared to 125 msec (!) for the C++ version.</p>\n\n<p>That's quite strange. So I opened the disassembly window in the debugger and copied the ASM code generated by the compiler. This is what I found there, slightly edited for readability and for use with MASM:</p>\n\n<pre><code>AsmMul3 proc ; ?AsmMul3@@$$FYAX_K0AEA_K1@Z\n\n; ecx  : Factor1\n; edx  : Factor2\n; [r8] : ProductL\n; [r9] : ProductH\n\nmov  eax,  0FFFFFFFFh\nand  rax,  rcx\n\n; UINT64 u8Factor2L = u8Factor2 &amp; 0xFFFFFFFFULL;\nmov  r10d, 0FFFFFFFFh\nand  r10,  rdx\n\n; UINT64 u8Factor1H = u8Factor1 &gt;&gt; 32;\nshr  rcx,  20h\n\n; UINT64 u8Factor2H = u8Factor2 &gt;&gt; 32;\nshr  rdx,  20h\n\n; u8ProductL = u8Factor1L * u8Factor2L;\nmov  r11,  r10\nimul r11,  rax\nmov  qword ptr [r8], r11\n\n; u8ProductH = u8Factor1H * u8Factor2H;\nmov  r11,  rdx\nimul r11,  rcx\nmov  qword ptr [r9], r11\n\n; u8Result1 = u8Factor1L * u8Factor2H;\nimul rax,  rdx\n\n; u8Result2 = u8Factor1H * u8Factor2L;\nmov  rdx,  rcx\nimul rdx,  r10\n\n; if (u8Result1 &gt; MAX_UINT64 - u8Result2)\nmov  rcx,  rdx\nneg  rcx\ndec  rcx\ncmp  rcx,  rax\njae  label1\n\n; u8Result1 += u8Result2;\nadd  rax,  rdx\n\n; u8Result2 = (u8Result1 &gt;&gt; 32) | 0x100000000ULL; // add carry\nmov  rdx,  rax\nshr  rdx,  20h\nmov  rcx,  100000000h\nor   rcx,  rdx\njmp  label2\n\n; u8Result1 += u8Result2;\nlabel1:\nadd  rax,  rdx\n\n; u8Result2 = (u8Result1 &gt;&gt; 32);\nmov  rcx,  rax\nshr  rcx,  20h\n\n; if (u8ProductL &gt; MAX_UINT64 - (u8Result1 &lt;&lt;= 32))\nlabel2:\nshl  rax,  20h\nmov  rdx,  qword ptr [r8]\nmov  r10,  rax\nneg  r10\ndec  r10\ncmp  r10,  rdx\njae  label3\n\n; u8Result2++;\ninc  rcx\n\n; u8ProductL += u8Result1;\nlabel3:\nadd  rdx,  rax\nmov  qword ptr [r8], rdx\n\n; u8ProductH += u8Result2;\nadd  qword ptr [r9], rcx\nret\n\nAsmMul3 endp\n</code></pre>\n\n<p>Copying this code into my MASM source file and calling it from my benchmark routine resulted in 547 msec spent in the loop. That's slightly slower than the ASM function, and considerably slower than the C++ function. That's even stranger, since the latter are supposed to execute exactly the same machine code.</p>\n\n<p>So I tried another variant, this time using hand-optimized ASM code that does exactly the same four 32-to-64-bit multiplications, but in a more straightforward way. The code should avoid jumps and immediate values, make use of the CPU FLAGS for carry evaluation, and use interleaving of instructions in order to avoid register stalls. This is what I came up with:</p>\n\n<pre><code>; 64-bit to 128-bit multiplication, using the following decomposition:\n; (a*2^32 + i) (b*2^32 + j) = ab*2^64 + (aj + bi)*2^32 + ij\n\nAsmMul2 proc ; ?AsmMul2@@$$FYAX_K0AEA_K1@Z\n\n; ecx  : Factor1\n; edx  : Factor2\n; [r8] : ProductL\n; [r9] : ProductH\n\nmov  rax,  rcx           ; rax = Factor1\nmov  r11,  rdx           ; r11 = Factor2\nshr  rax,  32            ; rax = Factor1H\nshr  r11,  32            ; r11 = Factor2H\nand  ecx,  ecx           ; rcx = Factor1L\nmov  r10d, eax           ; r10 = Factor1H\nand  edx,  edx           ; rdx = Factor2L\n\nimul rax,  r11           ; rax = ab = Factor1H * Factor2H\nimul r10,  rdx           ; r10 = aj = Factor1H * Factor2L\nimul r11,  rcx           ; r11 = bi = Factor1L * Factor2H\nimul rdx,  rcx           ; rdx = ij = Factor1L * Factor2L\n\nxor  ecx,  ecx           ; rcx = 0\nadd  r10,  r11           ; r10 = aj + bi\nadc  ecx,  ecx           ; rcx = carry (aj + bi)\nmov  r11,  r10           ; r11 = aj + bi\nshl  rcx,  32            ; rcx = carry (aj + bi) &lt;&lt; 32\nshl  r10,  32            ; r10 = lower (aj + bi) &lt;&lt; 32\nshr  r11,  32            ; r11 = upper (aj + bi) &gt;&gt; 32\n\nadd  rdx,  r10           ; rdx = ij + (lower (aj + bi) &lt;&lt; 32)\nadc  rax,  r11           ; rax = ab + (upper (aj + bi) &gt;&gt; 32)\nmov  qword ptr [r8], rdx ; save ProductL\nadd  rax,  rcx           ; add carry (aj + bi) &lt;&lt; 32\nmov  qword ptr [r9], rax ; save ProductH\nret\n\nAsmMul2 endp\n</code></pre>\n\n<p>The benchmark yielded 500 msec, so this seems to be the fastest version of those three ASM implementations. However, the performance differences of them are quite marginal - but all of them are about four times slower than the naive C++ approach!</p>\n\n<p>So what's going on here? It seems to me that there's some general performance penalty for calling ASM code from C++, but I can't find anything on the internet that might explain it. The way I'm interfacing ASM is exactly how Microsoft recommends it.</p>\n\n<p>But now, watch out for another still stranger thing! Well, there are compiler intrinsics, anren't they? The <code>_umul128</code> intrinsic supposedly should do exactly what my AsmMul1 function does, i.e. call the 64-bit CPU MUL instruction. So I replaced the AsmMul1 call by a corresponding call to <code>_umul128</code>. Now see what performance values I've got in return (again, I'm running all four benchmarks sequentially in a single function):</p>\n\n<pre><code>_umul128: 109 msec\nAsmMul2: 94 msec (hand-optimized ASM)\nAsmMul3: 125 msec (compiler-generated ASM)\nC++ function: 828 msec\n</code></pre>\n\n<p>Now the ASM versions are blazingly fast, with about the same relative differences as before. However, the C++ function is terribly lazy now! Somehow the use of an intrinsic turns the entire performance values upside down. Scary...</p>\n\n<p>I haven't got any explanation for this strange behavior, and would be thankful at least for any hints about what's going on here. It would be even better if someone could explain how to get these performance issues under control. Currently I'm quite worried, because obviously a small change in the code can have huge performance impacts. I would like to understand the mechanisms underlying here, and how to get reliable results.</p>\n\n<p>And another thing: Why is the 64-to-128-bit MUL slower than four 64-to-64-bit IMULs?!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 4, "creation_date": 1553101325, "post_id": 55266319, "comment_id": 97264010, "body": "I don&#39;t know of anyone who has catalogged the differences (well cppreference lists signatures with annotations such as &quot;until c++11&quot; but theyre spread all of the site, not in one neat list). May I ask why you want/need such a list?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553101415, "post_id": 55266319, "comment_id": 97264071, "body": "why do you want it? What would that list be good for?"}, {"owner": {"reputation": 35, "user_id": 3059890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c28dde8237e2a99afc341209bace3c0?s=128&d=identicon&r=PG&f=1", "display_name": "goodfellas95", "link": "https://stackoverflow.com/users/3059890/goodfellas95"}, "edited": false, "score": 0, "creation_date": 1553101605, "post_id": 55266319, "comment_id": 97264178, "body": "I am working on a project where I used a bunch of C++ functions which were in accordance to C++ 14 standard, but now our scope changed and we can only use functions present in C++ 11 standard. I do not want to look at each of the function signatures I utilized and compare it with the standard. Therefore, I was looking for a list that would guide me on what function signatures I can use and what function signatures I have to remove from my project. Hope this reply helps."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 8, "creation_date": 1553101641, "post_id": 55266319, "comment_id": 97264203, "body": "Couldnt you just compile against C++11 and fix the compilation errors you get?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1553101711, "post_id": 55266319, "comment_id": 97264243, "body": "@goodfellas95 compile your C++14 code as C++11 and the compiler will point out where it doesn&#39;t work. Then fix all compiler errors. Done."}, {"owner": {"reputation": 35, "user_id": 3059890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c28dde8237e2a99afc341209bace3c0?s=128&d=identicon&r=PG&f=1", "display_name": "goodfellas95", "link": "https://stackoverflow.com/users/3059890/goodfellas95"}, "edited": false, "score": 0, "creation_date": 1553101737, "post_id": 55266319, "comment_id": 97264255, "body": "That was my initial thought. But, I was asked to prepare a list for my team so I can set up some ground rules."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 4, "creation_date": 1553101947, "post_id": 55266319, "comment_id": 97264382, "body": "@goodfellas95 once you set your build system to build as C++11 I&#39;d say that establishes the ground rules. If it doesn&#39;t compile it&#39;s not C++11. For further info, point people at <a href=\"http://cppreference.com\" rel=\"nofollow noreferrer\">cppreference.com</a> ."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1553102712, "post_id": 55266319, "comment_id": 97264841, "body": "Extending on @JesperJuhl &#39;s comment, here is an example: <a href=\"https://en.cppreference.com/w/cpp/container/vector/vector\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/vector/vector</a> . All of the standard differences, for <code>std::vector</code>&#39;s constructor anyway, are clearly marked. Breaking it down by function is probably the best way to do it; a global list of everything would be an unholy nightmare to search."}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 3059890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c28dde8237e2a99afc341209bace3c0?s=128&d=identicon&r=PG&f=1", "display_name": "goodfellas95", "link": "https://stackoverflow.com/users/3059890/goodfellas95"}, "is_accepted": true, "score": 0, "last_activity_date": 1553108343, "creation_date": 1553108343, "answer_id": 55268312, "question_id": 55266319, "link": "https://stackoverflow.com/questions/55266319/difference-in-function-signatures-between-c11-and-c14/55268312#55268312", "title": "DIfference in function signatures between C++11 and C++14", "body": "<p>Thanks everyone for the help.\n<p> I have stumbled upon a link that clearly highights the difference between the two versions and is proving to be very informative to me.\n<p> I am posting it here so that if anyone has the same question as mine, they can refer here.\n<p> <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p1319r0.html\" rel=\"nofollow noreferrer\">http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p1319r0.html</a></p>\n"}], "owner": {"reputation": 35, "user_id": 3059890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c28dde8237e2a99afc341209bace3c0?s=128&d=identicon&r=PG&f=1", "display_name": "goodfellas95", "link": "https://stackoverflow.com/users/3059890/goodfellas95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "closed_date": 1553116820, "accepted_answer_id": 55268312, "answer_count": 1, "score": -6, "last_activity_date": 1553108343, "creation_date": 1553101164, "last_edit_date": 1553102502, "question_id": 55266319, "link": "https://stackoverflow.com/questions/55266319/difference-in-function-signatures-between-c11-and-c14", "closed_reason": "Needs details or clarity", "title": "DIfference in function signatures between C++11 and C++14", "body": "<p>I want access to a complete list of function signatures that were present in C++11 but removed in C++14 and also list of function signatures that were added in C++14.</p>\n\n<p><p>I do not want to scrape the standard to look for the difference. \n<p> Is there a faster way to do it?</p>\n"}, {"tags": ["c++", "inheritance", "abstract-class", "multiple-inheritance", "virtual-functions"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1553100896, "post_id": 55266178, "comment_id": 97263754, "body": "Please <b><a href=\"https://stackoverflow.com/posts/55266178/edit\">edit</a></b> your question with an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> or <a href=\"http://sscce.org\" rel=\"nofollow noreferrer\">SSCCE (Short, Self Contained, Correct Example)</a>"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1553101025, "post_id": 55266178, "comment_id": 97263830, "body": "Also where is the virtual destructor?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1553101067, "post_id": 55266178, "comment_id": 97263856, "body": "Class <code>E</code> has multiple instances of <code>A</code> in it, and not all <code>A</code> methods are overridden by all instances.  For this kind of situation, you need to use <code>virtual</code> inheritance instead of <code>public</code> inheritance. Or else break up <code>A</code> into smaller pieces."}, {"owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "edited": false, "score": 2, "creation_date": 1553101073, "post_id": 55266178, "comment_id": 97263859, "body": "The only purpose all those <code>...</code> serve is to prevent people from copy-pasting and compiling your code. <code>E</code> has 3 distinct copies of <code>A</code>, none of which implement all the pure virtual functions. You want to use <code>virtual</code> inheritance instead."}, {"owner": {"reputation": 99, "user_id": 1166789, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d6b6badd0b4eabf33dcc43f2084480cc?s=128&d=identicon&r=PG", "display_name": "Javier", "link": "https://stackoverflow.com/users/1166789/javier"}, "edited": false, "score": 0, "creation_date": 1553101123, "post_id": 55266178, "comment_id": 97263896, "body": "All sub-classes have the virtual destructor. I&#39;ve tried to simplify a lot the code, only writing the inheritance scheme and the declaration of the virtual methods"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 1, "creation_date": 1553101189, "post_id": 55266178, "comment_id": 97263938, "body": "It&#39;s not the subclasses that need to have the virtual destructor, it&#39;s the original parent class <code>A</code>."}, {"owner": {"reputation": 99, "user_id": 1166789, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d6b6badd0b4eabf33dcc43f2084480cc?s=128&d=identicon&r=PG", "display_name": "Javier", "link": "https://stackoverflow.com/users/1166789/javier"}, "edited": false, "score": 0, "creation_date": 1553101486, "post_id": 55266178, "comment_id": 97264117, "body": "You are gods guys! Thank you very much. The <code>...</code> are because the class is huge and I cannot paste all the code..."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553101489, "post_id": 55266178, "comment_id": 97264118, "body": "please include the error message in the question. C2259 only has a meaning for the specific compiler you are using, in principle it could even be that two compilers use the same number for two different errors"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 2, "creation_date": 1553101633, "post_id": 55266178, "comment_id": 97264196, "body": "The request isn&#39;t to paste <i>all</i> the code, it&#39;s to paste <i>compilable</i> code sufficient to reproduce the problem. Making people edit your code before they can test something is just increasing the effort required to help.0"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 1166789, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d6b6badd0b4eabf33dcc43f2084480cc?s=128&d=identicon&r=PG", "display_name": "Javier", "link": "https://stackoverflow.com/users/1166789/javier"}, "edited": false, "score": 0, "creation_date": 1553101507, "post_id": 55266314, "comment_id": 97264126, "body": "You are a god! Thank you very much!!"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "reply_to_user": {"reputation": 99, "user_id": 1166789, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d6b6badd0b4eabf33dcc43f2084480cc?s=128&d=identicon&r=PG", "display_name": "Javier", "link": "https://stackoverflow.com/users/1166789/javier"}, "edited": false, "score": 0, "creation_date": 1553101627, "post_id": 55266314, "comment_id": 97264193, "body": "I wouldn&#39;t go that far :p"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 1, "creation_date": 1553101765, "post_id": 55266314, "comment_id": 97264276, "body": "FWIW, this is the canonical example of virtual inheritance - and is also often thought to suggest a bad initial design. It&#39;s certainly a code smell. If you <i>need</i> this design though, this is the way to do it."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553102861, "post_id": 55266314, "comment_id": 97264912, "body": "Matthieu, one thing I learned from living through the 80s was <a href=\"https://www.youtube.com/watch?v=I6LD6ITN2dk\" rel=\"nofollow noreferrer\">when someone asks if you are a god, you say yes.</a> I think this case is a close duplicate."}], "tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": false, "score": 5, "last_activity_date": 1553106093, "last_edit_date": 1553106093, "creation_date": 1553101158, "answer_id": 55266314, "question_id": 55266178, "link": "https://stackoverflow.com/questions/55266178/cannot-instantiate-abstract-class-with-multiple-inheritance-c/55266314#55266314", "title": "Cannot instantiate abstract class with multiple inheritance c++", "body": "<p>You have 3 different <code>A</code> objects inside <code>E</code>, you forgot to tag the inheritance as virtual so that the same <code>A</code> object is used:</p>\n\n<pre><code>class A\n{\npublic:\n    enum Animal { CAT, DOG };\n    enum Color { RED, GREEN };\n    enum Food { MEAT, FISH };\n\n    virtual ~A(){}\n\nprotected:\n    virtual Animal animal() const = 0;\n    virtual Color color() const = 0;\n    virtual Food food() const = 0;\n};\n\nclass B: public virtual A\n{\nAnimal animal() const override { return CAT; }\n};\n\nclass C: public virtual A\n{\nColor color() const override { return GREEN; }\n};\n\nclass D: public virtual A\n{\nFood food() const override { return FISH; }\n};\n\nclass E : public B, public C, public D\n{\n};\n\nint main()\n{\n    E e;\n}\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 1166789, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d6b6badd0b4eabf33dcc43f2084480cc?s=128&d=identicon&r=PG", "display_name": "Javier", "link": "https://stackoverflow.com/users/1166789/javier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553106093, "creation_date": 1553100781, "last_edit_date": 1553102000, "question_id": 55266178, "link": "https://stackoverflow.com/questions/55266178/cannot-instantiate-abstract-class-with-multiple-inheritance-c", "title": "Cannot instantiate abstract class with multiple inheritance c++", "body": "<p>I am getting the compiler error <code>C2259</code> when instantiating a class that inherits from other classes, which having abstract methods.</p>\n\n<p>The inheritance scheme is a little bit weird and opaque but I need to do it in this way due to some restrictions of the problem.</p>\n\n<p>The inheritance scheme is as follow:</p>\n\n<pre><code>class A\n{\npublic:\n    enum Animal { CAT, DOG };\n    enum Color { RED, GREEN };\n    enum Food { MEAT, FISH };\n\nprotected:\n    virtual Animal animal() const = 0;\n    virtual Color color() const = 0;\n    virtual Food food() const = 0;\n};\n\nclass B: public A\n{\nAnimal animal() const { return CAT; }\n};\n\nclass C: public A\n{\nColor color() const { return GREEN; }\n};\n\nclass D: public A\n{\nFood food() const { return FISH; }\n};\n</code></pre>\n\n<p>And then I declare a class with multiple inheritance like this:</p>\n\n<pre><code>class E : public B, public C, public D\n{\n};\n</code></pre>\n\n<p>Here, when I try to instantiate the class <code>E</code> I am getting the compiler error <code>C2259</code>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>error C2259: 'E': cannot instantiate abstract class\nnote: due to following members:\nnote: 'A::Color A::color(void) const': is abstract\nnote: see declaration of 'A::color'\nnote: 'A::Food A::food(void) const': is abstract\nnote: see declaration of 'A::food'\nnote: 'A::Animal A::animal(void) const': is abstract\nnote: see declaration of 'A::animal'\n</code></pre>\n\n<p>What I am doing wrong?</p>\n\n<p>Thank you very much</p>\n\n<p>Javier</p>\n"}, {"tags": ["c++", "c++11", "linkage", "one-definition-rule"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1553100953, "post_id": 55266022, "comment_id": 97263783, "body": "Your intuition is right. Finding the details from the standard will only reinforce it. If you are into language lawyering, that&#39;s a good goal."}], "answers": [{"tags": [], "owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": true, "score": 3, "last_activity_date": 1553101362, "creation_date": 1553101362, "answer_id": 55266396, "question_id": 55266022, "link": "https://stackoverflow.com/questions/55266022/odr-and-internal-linkage/55266396#55266396", "title": "ODR and internal linkage", "body": "<p>n4713</p>\n\n<blockquote>\n  <p>\u00a76.5 Program and linkage [basic.link]</p>\n  \n  <p>A name is said to have linkage when it might denote the same object,\n  reference, function, type, template, namespace or value as a name\n  introduced by a declaration in another scope:</p>\n  \n  <p>(2.1) \u2014 When a name has external linkage, the entity it denotes can be\n  referred to by names from scopes of other translation units or from\n  other scopes of the same translation unit.</p>\n  \n  <p>(2.2) \u2014 When a name has internal linkage, <strong>the entity it denotes can\n  be referred to by names from other scopes in the same translation\n  unit.</strong></p>\n  \n  <p>\u2014 When a name has no linkage, the entity it denotes cannot be referred\n  to by names from other scopes.</p>\n</blockquote>\n\n<p>This basically says that (in the case of unnamed namespaces) the name <code>foo</code> from <code>a.cpp</code> and  the name <code>foo</code> from <code>b.cpp</code> each refer to different entities. So you don't have two definitions of the same object, so ODR is not violated.</p>\n"}], "owner": {"reputation": 5551, "user_id": 1683161, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d54009af893277619337f3bfc8a589cf?s=128&d=identicon&r=PG", "display_name": "rainer", "link": "https://stackoverflow.com/users/1683161/rainer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 1, "accepted_answer_id": 55266396, "answer_count": 1, "score": 4, "last_activity_date": 1553101829, "creation_date": 1553100257, "last_edit_date": 1553101829, "question_id": 55266022, "link": "https://stackoverflow.com/questions/55266022/odr-and-internal-linkage", "title": "ODR and internal linkage", "body": "<p>Assume that I have two compilation units in a single program, each of which declares a non-inline function with identical signatures, but differing in implementation, such as</p>\n\n<pre><code>// a.cpp\nnamespace internal {\n    int foo(int a) {\n        return a+1;\n    }\n}\n\nint main() {\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>// b.cpp\nnamespace internal {\n    int foo(int b) {\n        return b+2;\n    }\n}\n</code></pre>\n\n<p>Compiling/linking this (g++ 4.8.3 with <code>-std=c++11</code>), I get an error</p>\n\n<pre><code>b.cpp:(.text+0x0): multiple definition of `internal::foo(int)'\n</code></pre>\n\n<p>which is rather expected, since, as far as I understand, this is simply a violation of the <a href=\"https://en.cppreference.com/w/cpp/language/definition\" rel=\"nofollow noreferrer\">one definition rule</a>:</p>\n\n<blockquote>\n  <p>One and only one definition of every non-inline function or variable\n  that is odr-used (see below) is required to appear in the entire\n  program (including any standard and user-defined libraries).</p>\n</blockquote>\n\n<p>Now, changing the <code>namespace internal</code> into an unnamed namespace, the error goes away. Intuitively, this make sense to me, since I'm changing the function from <a href=\"https://en.cppreference.com/w/cpp/language/storage_duration\" rel=\"nofollow noreferrer\">external to internal linkage</a>:</p>\n\n<blockquote>\n  <p>Any of the following names declared at namespace scope have external\n  linkage unless the namespace is unnamed or is contained within an\n  unnamed namespace (since C++11): variables and functions not listed\n  above (that is, functions not declared static [...]) ...</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>[A]ll names declared in unnamed namespace or a namespace\n  within an unnamed namespace, even ones explicitly declared extern,\n  have internal linkage.</p>\n</blockquote>\n\n<p>However, I was unable to find anything in the one definition rule that exempts functions with internal linkage from it. Therefore, my question is: Is my intuitive reasoning correct, or am I still violating the one definition rule with functions that have internal linkage (and the compiler/linker just doesn't report it anymore)? Additionally, where does the standard (or cppreference.com <code>:)</code>) say whether or not it is ok?</p>\n"}, {"tags": ["c++", "boost", "r-tree", "mbr"], "comments": [{"owner": {"reputation": 1727, "user_id": 3166476, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/tU6SH.jpg?s=128&g=1", "display_name": "lakeweb", "link": "https://stackoverflow.com/users/3166476/lakeweb"}, "edited": false, "score": 0, "creation_date": 1553106012, "post_id": 55265962, "comment_id": 97266515, "body": "Your question is rather broad. The title of your question in google has many answers. <a href=\"https://stackoverflow.com/help/how-to-ask\">How to as a good question</a>"}], "answers": [{"tags": [], "owner": {"reputation": 70452, "user_id": 1060350, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/XCkw7.jpg?s=128&g=1", "display_name": "Has QUIT--Anony-Mousse", "link": "https://stackoverflow.com/users/1060350/has-quit-anony-mousse"}, "is_accepted": false, "score": 0, "last_activity_date": 1553108142, "creation_date": 1553108142, "answer_id": 55268245, "question_id": 55265962, "link": "https://stackoverflow.com/questions/55265962/minimum-bounding-rectangle-calculation-in-boost-r-tree/55268245#55268245", "title": "Minimum Bounding Rectangle calculation in Boost R-Tree", "body": "<p>Probably the obvious one.</p>\n\n<p>Iterate over the contents and store the minimum bounds.</p>\n\n<p>That is O(n) and you can't do any better than O(n), at the same time the algorithm is as easy a it gets, so it will come with small constant factors, too.</p>\n"}], "owner": {"reputation": 1, "user_id": 11233302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed2b9dd20d6e6bb8afdf1f23344ed09a?s=128&d=identicon&r=PG&f=1", "display_name": "user11233302", "link": "https://stackoverflow.com/users/11233302/user11233302"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553134723, "creation_date": 1553100059, "last_edit_date": 1553134723, "question_id": 55265962, "link": "https://stackoverflow.com/questions/55265962/minimum-bounding-rectangle-calculation-in-boost-r-tree", "title": "Minimum Bounding Rectangle calculation in Boost R-Tree", "body": "<p>Minimum Bounding Rectangles is a pre-requisite for R-Tree creation. What algorithm does Boost C++ library use for MBR creation given a set of points?</p>\n"}, {"tags": ["c++", "concurrency", "locking", "readwritelock"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1553100265, "post_id": 55265950, "comment_id": 97263379, "body": "It&#39;s not valid C++, and it seems to assume that things like <code>w++</code> are atomic."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1553100886, "post_id": 55265950, "comment_id": 97263745, "body": "You have no synchronization for your counters. This is <i>not</i> thread safe."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1553101086, "post_id": 55265950, "comment_id": 97263871, "body": "Go work through <a href=\"https://deadlockempire.github.io/#menu\" rel=\"nofollow noreferrer\">deadlockempire.github.io/#menu</a>"}, {"owner": {"reputation": 306, "user_id": 3667297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20ec2f87b8f78a4ae0b2764f37eba0cc?s=128&d=identicon&r=PG&f=1", "display_name": "tekkk", "link": "https://stackoverflow.com/users/3667297/tekkk"}, "edited": false, "score": 0, "creation_date": 1553101993, "post_id": 55265950, "comment_id": 97264420, "body": "Thanks for the link . I will go through the link"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1553104711, "post_id": 55265950, "comment_id": 97265907, "body": "It&#39;s currently not valid C++ (has no return type on functions). But worse it is not idiomatic C++. These are C-functions calls that <b>MUST</b> happen in pairs to work. There is a pattern for that. Also this code is not exception safe. In addition to the questionable and undefined <code>atomic_*()</code> functions there looks like a bug in <code>write_lock()</code>"}], "answers": [{"comments": [{"owner": {"reputation": 306, "user_id": 3667297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20ec2f87b8f78a4ae0b2764f37eba0cc?s=128&d=identicon&r=PG&f=1", "display_name": "tekkk", "link": "https://stackoverflow.com/users/3667297/tekkk"}, "edited": false, "score": 0, "creation_date": 1553101788, "post_id": 55266231, "comment_id": 97264290, "body": "Thanks eerorika for the answers. You are right, this is the implementation for spin lock. I have edited the post.  Spinlocks can be useful in operating systems , like in interrupt context , where one can&#39;t sleep."}, {"owner": {"reputation": 306, "user_id": 3667297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20ec2f87b8f78a4ae0b2764f37eba0cc?s=128&d=identicon&r=PG&f=1", "display_name": "tekkk", "link": "https://stackoverflow.com/users/3667297/tekkk"}, "edited": false, "score": 0, "creation_date": 1553101893, "post_id": 55266231, "comment_id": 97264347, "body": "If we use a system where all word manipulation are atomic , then  r++, w++ can be atomic right ?"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 306, "user_id": 3667297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20ec2f87b8f78a4ae0b2764f37eba0cc?s=128&d=identicon&r=PG&f=1", "display_name": "tekkk", "link": "https://stackoverflow.com/users/3667297/tekkk"}, "edited": false, "score": 0, "creation_date": 1553102031, "post_id": 55266231, "comment_id": 97264443, "body": "@sysinit x86 has atomic increment instructions, so an increment can be atomic. But it also has non-atomic increment, which is more efficient. There is no reason why the compiler would choose to use an atomic operation with an <code>int</code>."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1553101851, "last_edit_date": 1553101851, "creation_date": 1553100915, "answer_id": 55266231, "question_id": 55265950, "link": "https://stackoverflow.com/questions/55265950/simple-read-write-lock/55266231#55266231", "title": "Simple Read Write Lock", "body": "<p>If threads access <code>r</code> and <code>w</code> concurrently, they have a data-race. If a C++ program has a data-race, the behaviour of the program is undefined.</p>\n\n<p><code>int</code> is not guaranteed by the C++ standard to be atomic. Even if we assume a system where accessing an <code>int</code> is atomic,  <code>operator++</code> would probably not be an atomic operation even on such systems. As such, simultaneous increments could \"disappear\".</p>\n\n<p>Furthermore after the loop in <code>write_lock</code>, another thread could also end their loop before <code>w</code> is incremented, thereby allowing multiple simultaneous writers - which I assume this lock is supposed to prevent.</p>\n\n<hr>\n\n<p>Lastly, this appears to be an attempt at implementing a spinlock. Spinlocks have advantages and disadvantages. Their disadvantage is that they consume all CPU cycles of their thread while blocking. This is highly inefficient use of resources, and bad for battery time, and bad for other processes that could have used those cycles. But it can be optimal if the wait time is short.</p>\n"}], "owner": {"reputation": 306, "user_id": 3667297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20ec2f87b8f78a4ae0b2764f37eba0cc?s=128&d=identicon&r=PG&f=1", "display_name": "tekkk", "link": "https://stackoverflow.com/users/3667297/tekkk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1553101851, "creation_date": 1553100035, "last_edit_date": 1553101617, "question_id": 55265950, "link": "https://stackoverflow.com/questions/55265950/simple-read-write-lock", "title": "Simple Read Write Lock", "body": "<p>I find many read write Spin lock implementation over the internet are unnecessarily complex. I have written a simple read-write lock in c++.</p>\n\n<p>Could anybody tell me , if I am missing anything? </p>\n\n<pre><code>int r = 0;\nint w = 0;\n\nread_lock(void) \n{\n     atomic_inc(r); //increment value atomically\n     while( w != 0);    \n}\n\nread_unlock(void)\n{\n   atomic_dec(r); // Decrement value atomically\n}\nwrite_lock(void)\n{\n while( (r != 0) &amp;&amp; \n            ( w != 0))\n  atomic_inc(w); //increment value atomically\n}\n\nwrite_unlock(void)\n{\n    atomic_dec(w); //Decrement value atomically\n}\n</code></pre>\n\n<p>The usage would be as below.</p>\n\n<pre><code>read_lock()\n// Critical Section\nread_unlock();\n\nwrite_lock()\n// Critical Section\nwrite_unlock();\n</code></pre>\n\n<p>Edit: </p>\n\n<p>Thanks for the answers. \nI now changed answer to that of atomic equivalent</p>\n"}, {"tags": ["c++", "json", "swagger", "openapi"], "comments": [{"owner": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "edited": false, "score": 0, "creation_date": 1553155967, "post_id": 55265897, "comment_id": 97282333, "body": "What code generation tool do you use?"}, {"owner": {"reputation": 55, "user_id": 7227389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280e7cf4e023b7658b1ce86c89158d54?s=128&d=identicon&r=PG&f=1", "display_name": "Bortek", "link": "https://stackoverflow.com/users/7227389/bortek"}, "reply_to_user": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "edited": false, "score": 0, "creation_date": 1553269956, "post_id": 55265897, "comment_id": 97335216, "body": "OpenApi Generator <a href=\"https://github.com/OpenAPITools/openapi-generator\" rel=\"nofollow noreferrer\">github.com/OpenAPITools/openapi-generator</a> and/or swagger online <a href=\"https://editor.swagger.io\" rel=\"nofollow noreferrer\">editor.swagger.io</a>"}], "owner": {"reputation": 55, "user_id": 7227389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280e7cf4e023b7658b1ce86c89158d54?s=128&d=identicon&r=PG&f=1", "display_name": "Bortek", "link": "https://stackoverflow.com/users/7227389/bortek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 428, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554319794, "creation_date": 1553099864, "last_edit_date": 1554319794, "question_id": 55265897, "link": "https://stackoverflow.com/questions/55265897/generate-pistache-server-with-chosen-json-library-in-openapi", "title": "Generate pistache server with chosen JSON library in OpenApi", "body": "<p>I've got full REST API specification yaml file to generate c++ pistache server side code in OpenApi or SWAGGER. </p>\n\n<p>Could I change default nlohmann JSON included library to another in code generation process? </p>\n"}, {"tags": ["c++", "boost", "visual-studio-code", "boost-asio", "ncurses"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 11172267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QQdv1ZgEW_M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regGtqdKribn4yaKkJo4vcL4M51RA/mo/photo.jpg?sz=128", "display_name": "Jordan Ward", "link": "https://stackoverflow.com/users/11172267/jordan-ward"}, "edited": false, "score": 0, "creation_date": 1553101517, "post_id": 55266124, "comment_id": 97264132, "body": "I tried to do <code>#define NCURSES_NOMACROS</code> right after the <code>using boost::asio::ip::tcp;</code> but I still get the same errors."}, {"owner": {"reputation": 839, "user_id": 1135979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59464968f70aff62c07a7da3a0f6ba80?s=128&d=identicon&r=PG", "display_name": "yachoor", "link": "https://stackoverflow.com/users/1135979/yachoor"}, "reply_to_user": {"reputation": 61, "user_id": 11172267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QQdv1ZgEW_M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regGtqdKribn4yaKkJo4vcL4M51RA/mo/photo.jpg?sz=128", "display_name": "Jordan Ward", "link": "https://stackoverflow.com/users/11172267/jordan-ward"}, "edited": false, "score": 0, "creation_date": 1553102040, "post_id": 55266124, "comment_id": 97264448, "body": "@JordanWard You need it before including ncurses.h"}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "reply_to_user": {"reputation": 61, "user_id": 11172267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QQdv1ZgEW_M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regGtqdKribn4yaKkJo4vcL4M51RA/mo/photo.jpg?sz=128", "display_name": "Jordan Ward", "link": "https://stackoverflow.com/users/11172267/jordan-ward"}, "edited": false, "score": 1, "creation_date": 1553102097, "post_id": 55266124, "comment_id": 97264486, "body": "@JordanWard It is no use defining <code>NCURSES_NOMACROS</code> at a point after the broken code has already been compiled. Define it on the compilation commandline: <code>g++ battleship_client.cc -DNCURSES_NOMACROS -lboost_system -lncurses</code>"}], "tags": [], "owner": {"reputation": 839, "user_id": 1135979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59464968f70aff62c07a7da3a0f6ba80?s=128&d=identicon&r=PG", "display_name": "yachoor", "link": "https://stackoverflow.com/users/1135979/yachoor"}, "is_accepted": false, "score": 1, "last_activity_date": 1553100618, "creation_date": 1553100618, "answer_id": 55266124, "question_id": 55265851, "link": "https://stackoverflow.com/questions/55265851/getting-errors-when-trying-to-compile-program-using-boost-and-ncurses-libraries/55266124#55266124", "title": "Getting errors when trying to compile program using boost and ncurses libraries", "body": "<p>ncurses.h defines <code>timeout</code> as preprocessor macro. Try adding <code>NCURSES_NOMACROS</code> define</p>\n"}], "owner": {"reputation": 61, "user_id": 11172267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QQdv1ZgEW_M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regGtqdKribn4yaKkJo4vcL4M51RA/mo/photo.jpg?sz=128", "display_name": "Jordan Ward", "link": "https://stackoverflow.com/users/11172267/jordan-ward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553100618, "creation_date": 1553099738, "question_id": 55265851, "link": "https://stackoverflow.com/questions/55265851/getting-errors-when-trying-to-compile-program-using-boost-and-ncurses-libraries", "title": "Getting errors when trying to compile program using boost and ncurses libraries", "body": "<p>I have just started to write a server and client for an assignment but can't get my client code to compile. The server compiles just fine using just the boost library but in my client code I am using boost and ncurses. </p>\n\n<p>I am using <code>g++ battleship_client.cc -lboost_system -lncurses</code> when trying to compile.</p>\n\n<p>I have googled like crazy but I haven't found a solution. I should also note that I am on a mac and that I am using vscode. I have changed my includePath to look like this:</p>\n\n<pre><code>\"includePath\": [\n            \"${workspaceFolder}/**\",\n            \"/usr/local/Cellar/boost/1.68.0_1/\",\n            \"/usr/local/Cellar/ncurses/6.1/\"\n        ],\n</code></pre>\n\n<p>battleship_client.cc:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;ncurses.h&gt;\n#include &lt;boost/asio.hpp&gt;\n\nusing namespace std;\nusing boost::asio::ip::tcp;\n\n\nvoid draw_top_matrix(vector&lt;vector&lt;int&gt; &gt; &amp;board, int cur_row, int cur_col) {\n    for (int j=0;j&lt;4;j++) {\n        move(0,2*j);\n        printw(\"+-\");\n    }\n\n    move(0,2*4);\n    printw(\"+\");\n\n    for (int i=0;i&lt;4;i++) {\n        for (int j=0;j&lt;4;j++) {\n            move(2*i+1,2*j);\n            printw(\"|\");\n            move(2*i+1,2*j+1);\n\n            if (board[i][j] == 0) {\n                printw(\" \");\n            } \n            else {\n                printw(\"X\");\n            }\n        }\n\n        move(2*i+1,2*4);\n        printw(\"|\");\n\n        for (int j=0;j&lt;4;j++) {\n            move(2*i+2,2*j);\n            printw(\"+-\");\n        }\n\n        move(2*i+2,2*4);\n        printw(\"+\");\n    }\n\n    move(2*cur_row+1,2*cur_col+1);\n}\n\nvoid init(vector&lt;vector&lt;int&gt; &gt; &amp;board) {\n    int rows;\n    int cols;\n    int cur_row = 0;\n    int cur_col = 0;\n\n    for(int i = 0; i &lt; 4; i++) {\n        vector&lt;int&gt; temp;\n        for(int j = 0; j &lt; 4; j++) {\n            temp.push_back(0);\n        }\n        board.push_back(temp);\n    }\n\n    initscr();\n    clear();\n\n    getmaxyx(stdscr, rows, cols);\n\n    cbreak();\n    keypad(stdscr, TRUE);\n    refresh();\n\n    draw_top_matrix(board, 0, 0);\n    endwin();\n}\n\nint main(int argc, char *argv[]) {\n    int port = atoi(argv[3]);\n    vector&lt;vector&lt;int&gt; &gt; board;\n    boost::asio::io_service my_service;\n    tcp::resolver resolver(my_service);\n\n    tcp::socket socket(my_service);\n    socket.connect(tcp::endpoint(boost::asio::ip::address::from_string(argv[2]), port));\n\n    init(board);\n\n    return 0;\n}\n</code></pre>\n\n<p>The errors I am getting:</p>\n\n<pre><code>    In file included from battleship_client.cc:4:0:\n/usr/local/include/boost/asio/basic_socket_streambuf.hpp:595:7: error: 'stdscr' is not a type\n   int timeout() const\n       ^\n/usr/local/include/boost/asio/basic_socket_streambuf.hpp:595:7: error: expected identifier before ')' token\n   int timeout() const\n       ^\n/usr/local/include/boost/asio/basic_socket_streambuf.hpp: In member function 'std::basic_streambuf&lt;char&gt;::int_type boost::asio::basic_socket_streambuf&lt;Protocol, Clock, WaitTraits&gt;::underflow()':\n/usr/local/include/boost/asio/basic_socket_streambuf.hpp:479:42: error: expected primary-expression before ')' token\n             socket().native_handle(), 0, timeout(), ec_) &lt; 0)\n                                          ^\n/usr/local/include/boost/asio/basic_socket_streambuf.hpp: In member function 'std::basic_streambuf&lt;char&gt;::int_type boost::asio::basic_socket_streambuf&lt;Protocol, Clock, WaitTraits&gt;::overflow(std::basic_streambuf&lt;char&gt;::int_type)':\n/usr/local/include/boost/asio/basic_socket_streambuf.hpp:538:42: error: expected primary-expression before ')' token\n             socket().native_handle(), 0, timeout(), ec_) &lt; 0)\n                                          ^\n/usr/local/include/boost/asio/basic_socket_streambuf.hpp: In member function 'void boost::asio::basic_socket_streambuf&lt;Protocol, Clock, WaitTraits&gt;::connect_to_endpoints(EndpointIterator, EndpointIterator)':\n/usr/local/include/boost/asio/basic_socket_streambuf.hpp:656:39: error: expected primary-expression before ')' token\n             socket().native_handle(), timeout(), ec_) &lt; 0)\n</code></pre>\n"}, {"tags": ["c++", "templates", "language-lawyer"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1553158678, "post_id": 55265827, "comment_id": 97283651, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/190426/discussion-on-question-by-user42768-c-lookup-for-dependent-names\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553198763, "post_id": 55287635, "comment_id": 97306330, "body": "Thank you for your answer. One thing that is, in my opinion, ambiguous is the use of the two constructs: &quot;dependent name&quot; (which is defined in the first paragraph you linked) and &quot;name dependent on a template parameter&quot; (which is not defined explicitly). Paragraph 9 uses the latter wording. According to the definition of &quot;dependent name&quot;, A&lt;T&gt; (where A is a class template and T is a template parameter) is not a &quot;dependent name&quot;. What happens if that template is specialized after it is referred to? [continued]"}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553198846, "post_id": 55287635, "comment_id": 97306376, "body": "Are only specializations declared before the use considered, or are all specializations declared before the point of instantiation used? Paragraph 9 says that lookup is postponed, but is it specified elsewhere what locations are searched?"}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553198858, "post_id": 55287635, "comment_id": 97306378, "body": "Also, I think paragraph 2 should be reworded as: &quot;A name used in a template declaration or definition and that is dependent on a template-parameter is assumed not to name a type unless it can be determined to be a type name (this process may include name lookup of non-dependent parts of the name) or the name is qualified by the keyword typename. [...]&quot;. Is this a correct interpretation?"}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553211385, "post_id": 55287635, "comment_id": 97310746, "body": "@user42768: The longer formulation is <a href=\"http://eel.is/c++draft/temp.res#1.2\" rel=\"nofollow noreferrer\">identified</a> with the shorter.  <code>A&lt;T&gt;</code> is not a dependent <i>name</i> but a <a href=\"http://eel.is/c++draft/temp.res#temp.dep.type-9\" rel=\"nofollow noreferrer\">dependent <i>type</i></a>.  Specializations are consulted when the referencing template is <a href=\"http://eel.is/c++draft/temp.inst\" rel=\"nofollow noreferrer\">instantiated</a>.  Dependent <i>names</i> are looked up in the <a href=\"http://eel.is/c++draft/temp.dep.candidate#1\" rel=\"nofollow noreferrer\">instantiation context</a>.  I\u2019m sure [temp.res]/2 can be improved, but we can probably do better than \u201cit\u2019s not a type unless we know it is\u201d."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553212773, "post_id": 55287635, "comment_id": 97311027, "body": "@user42768: I should say that your proposed rewording looks \u201ccorrect\u201d in that I think you understand the rule; it\u2019s not <i>quite</i> right because of things like looking up names that turn out to be template parameters (which is certainly dependent\u2014after the lookup)."}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553243650, "post_id": 55287635, "comment_id": 97319549, "body": "I agree that dependent names still must be searched in order to determine that they are in fact &quot;dependent&quot; (T needs to be searched in order for the compiler to know it is a template parameter)."}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553243981, "post_id": 55287635, "comment_id": 97319722, "body": "So you&#39;re saying that &quot;name dependent on a template parameter&quot; = &quot;dependent name&quot; = &quot;unqualified function call with &quot;dependent&quot; arguments&quot; (my simplified (and probably incomplete) definition of <a href=\"http://eel.is/c++draft/temp.res#temp.dep-2\" rel=\"nofollow noreferrer\">temp.dep p.2</a>). But then the second sentence of paragraph 9 (The lookup of names dependent on the template parameters is postponed until the actual template argument is known ([temp.dep])) does not apply to <code>A&lt;T&gt;</code> because it is not a name dependent on the template parameters ( = dependent name). What am I missing?"}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553244175, "post_id": 55287635, "comment_id": 97319809, "body": "So if the name lookup for <code>A&lt;T&gt;</code> is not postponed, why are template specializations in the context of the point of instantiation found?"}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553260411, "post_id": 55287635, "comment_id": 97329099, "body": "Or did you want to say that &quot;dependent name&quot; = &quot;name dependent on a template parameter&quot; and that the definition in <a href=\"http://eel.is/c++draft/temp.res#temp.dep-2\" rel=\"nofollow noreferrer\">temo.dep p.2</a> describes just one type of &quot;dependent names&quot;? Based on that fact that you said that <code>A&lt;T&gt;</code> is not a dependent name, I think you did not mean this."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553264830, "post_id": 55287635, "comment_id": 97332035, "body": "@user42768: As <code>A&lt;T&gt;</code> is not a name at all, it is not a dependent name, nor is it <i>ever</i> subject to <i>name lookup</i>.  Specializations are <a href=\"http://eel.is/c++draft/temp.class.spec#7\" rel=\"nofollow noreferrer\">not found via name lookup</a>, but are selected by the \u201cinstantiation\u201d process (scare quotes because it might find an explicit specialization instead of instantiating anything)."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553265253, "post_id": 55287635, "comment_id": 97332318, "body": "@user42768: Technically, a <i>template-id</i> <a href=\"http://eel.is/c++draft/basic#4\" rel=\"nofollow noreferrer\">is a \u201cname\u201d</a>, but it is used as such only for declaration purposes, not lookup."}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553265940, "post_id": 55287635, "comment_id": 97332777, "body": "Ok, so <code>A&lt;T&gt;</code> is not a dependent name. Therefore its name lookup is not postponed. And the paragraph you quoted (regarding specializations), says the following: &quot;Rather, when the primary template name is used, any previously-declared partial specializations of the primary template are also considered.&quot;. So if I read this literally, in the template definition, the primary template name is used, therefore only &quot;previously-declared partial specializations of the primary template are also considered&quot;, right?"}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553267022, "post_id": 55287635, "comment_id": 97333426, "body": "@user42768: When one template is named in another\u2019s definition, the \u201cuse\u201d occurs only when the latter template is instantiated; only then does a specialization need to be chosen.  (It\u2019s also possible to name templates like <code>B&lt;T&gt;::template C&lt;T&gt;</code>, where <i>which template</i> is in use is determined only at instantiation.)"}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553267466, "post_id": 55287635, "comment_id": 97333681, "body": "I agree that logically the name should be considered &quot;used&quot; only inside a specialization. However, does the standard explicitly say this? Although I realise that maybe this clarification isn&#39;t really needed."}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553268152, "post_id": 55287635, "comment_id": 97334075, "body": "As you said, <code>A&lt;T&gt;</code> is not a &quot;dependent name&quot;, therefore its name lookup is not postponed. So a declaration (of the primary template) must be found at definition time. So even if I know for sure what template I am referring to, it is still considered not used in the definition?"}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553271921, "post_id": 55287635, "comment_id": 97336286, "body": "@user42768: Unfortunately, the actual process of template instantiation is never really specified; this is a <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#2\" rel=\"nofollow noreferrer\">very long-standing issue</a>.  You do know the <i>template</i> (except when <code>::template</code> must be used) but not what <i>unknown specialization</i> is being used (the word \u201cunknown\u201d referring to the possibility of a specialization declared after the definition of a client template but before its instantiation)."}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553273449, "post_id": 55287635, "comment_id": 97337180, "body": "Ok. So even though it is not explicitly specified in the standard, I agree that a template is &quot;used&quot; only inside a specialization of a template."}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553273533, "post_id": 55287635, "comment_id": 97337220, "body": "Regarding the concepts of &quot;dependent name&quot; and &quot;name that depends on a template parameter&quot;, in <a href=\"http://eel.is/c%2B%2Bdraft/temp.res#temp.dep-3\" rel=\"nofollow noreferrer\">temp.dep p.3</a> it says that &quot;The base class name B&lt;T&gt;, the type name T::A, the names B&lt;T&gt;::i and pb-&gt;j explicitly depend on the template-parameter&quot;. So <code>B&lt;T&gt;</code> is not a dependent name, but it depends on a template parameter."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553276174, "post_id": 55287635, "comment_id": 97338524, "body": "@user42768: Yes (although a <b>call</b> like <code>f&lt;T&gt;()</code> makes <code>f&lt;T&gt;</code> a dependent name); that example should be moved before /2 (which was only in this draft separated from /1)."}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553277214, "post_id": 55287635, "comment_id": 97339037, "body": "What I was trying to say is that the standard treats &quot;dependent name&quot; and &quot;name that depends on a type parameter&quot; differently in temp.dep p.3. &quot;Dependent names&quot; appears to be a subset of &quot;names that depend on a template parameter&quot;, at least based on this paragraph."}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553288033, "post_id": 55287635, "comment_id": 97343483, "body": "So, at least in [temp.dep] p.3, &quot;dependent name&quot; != &quot;name that depends on a template parameter&quot;. Or am I misinterpreting something again?"}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553289689, "post_id": 55287635, "comment_id": 97344048, "body": "@user42768: Sure\u2014I think the example is (as is common for non-normative text) using the word \u201cname\u201d very loosely, since of course <code>pb-&gt;j</code> is not a (single) name."}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1553290548, "post_id": 55287635, "comment_id": 97344338, "body": "Ok, so finally, &quot;name dependent on a template parameter&quot; = &quot;dependent name&quot; = definition in [temp.dep] p.2 (unqualified names used as the postfix expression in function calls and operators, under certain conditions). Although in the discussion under my question @LanguageLawyer mentioned a defect report that states that T::x should also be a dependent name."}], "tags": [], "owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "is_accepted": false, "score": 0, "last_activity_date": 1553195263, "creation_date": 1553195263, "answer_id": 55287635, "question_id": 55265827, "link": "https://stackoverflow.com/questions/55265827/c-lookup-for-dependent-names/55287635#55287635", "title": "C++ lookup for dependent names", "body": "<p>The lookup that is postponed is for <a href=\"http://eel.is/c%2B%2Bdraft/temp.dep#2\" rel=\"nofollow noreferrer\"><em>dependent names</em></a>: for example, <code>foo</code> in contexts like <code>T::foo</code> or <code>Bar&lt;T&gt;::foo</code>, or <code>operator@</code> in contexts like <code>T() @ 0</code>.  Obviously <code>T</code> and <code>Bar</code> must themselves be looked up just to know a template parameter is involved (template parameters <a href=\"http://eel.is/c++draft/temp.local#7\" rel=\"nofollow noreferrer\">can be hidden</a>) and to parse the template argument list.  Since a (type) template parameter is a <a href=\"http://eel.is/c++draft/temp.param#3\" rel=\"nofollow noreferrer\"><em>typedef-name</em></a> and any specialization of <code>Bar</code> is a type, that \u201cname lookup finds a type name\u201d.</p>\n"}], "owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1553195263, "creation_date": 1553099670, "last_edit_date": 1553110989, "question_id": 55265827, "link": "https://stackoverflow.com/questions/55265827/c-lookup-for-dependent-names", "title": "C++ lookup for dependent names", "body": "<p>In the current C++ standard (march 2019), there are these two paragraphs (emphasis mine):</p>\n\n<p><a href=\"http://eel.is/c%2B%2Bdraft/temp.res#2\" rel=\"nofollow noreferrer\">[temp.res] p.2</a>:</p>\n\n<blockquote>\n  <p>A name used in a template declaration or definition and that is dependent on a template-parameter is assumed not to name a type <strong>unless the applicable name lookup finds a type name</strong> or the name is qualified by the keyword typename. [...]</p>\n</blockquote>\n\n<p><a href=\"http://eel.is/c%2B%2Bdraft/temp.res#9\" rel=\"nofollow noreferrer\">[temp.res] p.9</a>:</p>\n\n<blockquote>\n  <p>When looking for the declaration of a name used in a template definition, the usual lookup rules ([basic.lookup.unqual], [basic.lookup.argdep]) are used for non-dependent names. The lookup of names dependent on the template parameters is postponed until the actual template argument is known ([temp.dep]). [...]</p>\n</blockquote>\n\n<p>The first paragraph implies that a name that is dependent on a template parameter will be looked up by \"the applicable name lookup\".</p>\n\n<p>However, the second paragraph states that lookup for names dependent on template parameters is postponed until the template argument is known.</p>\n\n<p>The example that is part of the first paragraph includes a situation similar to the following one:</p>\n\n<pre><code>template &lt;typename T&gt;\nclass A\n{\n    void f()\n    {\n        T* p;\n    }\n};\n</code></pre>\n\n<p>In method <code>f</code>, I believe <code>T</code> is a \"name dependent on template parameters\", therefore its lookup should be postponed until <code>T</code> is known, therefore there is no \"applicable name lookup\", the name should be assumed not to name a type.</p>\n\n<p>What does the first quoted paragraph mean by \"unless the applicable name lookup finds a type name\", if the second quoted paragraph seems to state that there is no lookup performed? Am I missing something?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "lambda"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 8, "creation_date": 1553099310, "post_id": 55265653, "comment_id": 97262821, "body": "I mean, you <i>can</i> do it with a lambda. Just like you can change your car&#39;s tires using an excavator. It doesn&#39;t mean you did it better... Unless you want to turn the code into <code>std::for_each</code> gibberish, just write <code>for (auto&amp; e : E) edgeMap[e].length = 1;</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553099339, "post_id": 55265653, "comment_id": 97262843, "body": "When you say you want to replace the function with a lambda, are you really asking how to use one of the standard algorithms plus a lambda to replace the fucntion?"}, {"owner": {"reputation": 319, "user_id": 11226898, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-suvAg66YwmA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcIggdXEKD-19IaYC84ilb6AvEm8Q/mo/photo.jpg?sz=128", "display_name": "black sheep", "link": "https://stackoverflow.com/users/11226898/black-sheep"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553099398, "post_id": 55265653, "comment_id": 97262882, "body": "@MaxLanghof good point, but I presume lambda are more efficient?"}, {"owner": {"reputation": 319, "user_id": 11226898, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-suvAg66YwmA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcIggdXEKD-19IaYC84ilb6AvEm8Q/mo/photo.jpg?sz=128", "display_name": "black sheep", "link": "https://stackoverflow.com/users/11226898/black-sheep"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553099468, "post_id": 55265653, "comment_id": 97262924, "body": "@NathanOliver yes, which standard algorithm should I use?"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553099477, "post_id": 55265653, "comment_id": 97262929, "body": "@blacksheep They are not. Don&#39;t get me wrong, they are more efficient than many will think, but they don&#39;t magically make your trivial loop faster."}, {"owner": {"reputation": 319, "user_id": 11226898, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-suvAg66YwmA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcIggdXEKD-19IaYC84ilb6AvEm8Q/mo/photo.jpg?sz=128", "display_name": "black sheep", "link": "https://stackoverflow.com/users/11226898/black-sheep"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553099645, "post_id": 55265653, "comment_id": 97263041, "body": "@MaxLanghof so I guess this page is incorrect [<a href=\"https://shaharmike.com/cpp/lambdas-and-functions/]\" rel=\"nofollow noreferrer\">shaharmike.com/cpp/lambdas-and-functions/]</a> - <i>Lambdas are also awesome when it comes to performance. Because they are objects rather than pointers they can be inlined very easily by the compiler, much like functors. This means that calling a lambda many times (such as with std::sort or std::copy_if) is much better than using a global function. This is one example of where C++ is actually faster than C.</i>"}, {"owner": {"reputation": 259, "user_id": 7886227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hec3U.jpg?s=128&g=1", "display_name": "Dr t", "link": "https://stackoverflow.com/users/7886227/dr-t"}, "edited": false, "score": 1, "creation_date": 1553099826, "post_id": 55265653, "comment_id": 97263130, "body": "There is nothing in your example to indicate that the Lambda would be called &quot;many times&quot;...to refer to all possibilities having not seen your complete code is not even close to being practical.  The responses you have so far are relevant to what you submitted for our speculation"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 2, "creation_date": 1553100118, "post_id": 55265653, "comment_id": 97263297, "body": "@blacksheep That comparison is about passing a <i>function pointer</i> to an algorithm (such as C&#39;s <code>qsort</code>) vs passing a <i>lambda</i> to an algorithm (such as <code>std::sort</code>). In the latter case, the compiler can usually optimize better because inlining lambdas is trivial while inlining function pointers is usually not. Your original code has neither function pointers nor library algorithms and thus isn&#39;t subject to the statement made in that article."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1553102321, "post_id": 55265653, "comment_id": 97264632, "body": "Note: a lambda <i>is</i> a function."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1553100086, "post_id": 55265848, "comment_id": 97263275, "body": "don&#39;t the lambdas in your examples need to capture <code>edgeMap</code> in order to access it?"}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": false, "score": 3, "last_activity_date": 1553100174, "last_edit_date": 1553100174, "creation_date": 1553099731, "answer_id": 55265848, "question_id": 55265653, "link": "https://stackoverflow.com/questions/55265653/replacing-a-function-with-a-lambda-in-c/55265848#55265848", "title": "Replacing a function with a lambda in C++", "body": "<p>I would consider the following code optimal (aside from given variable names):</p>\n\n<pre><code>void setEdgeLengths(Koala::AssocArray &lt;koalaGraph::PEdge, Koala::DijkstraHeap::EdgeLabs&lt;int &gt;&gt; &amp;edgeMap, std::vector&lt;koalaGraph::PEdge&gt;&amp; E) \n{\n    for (const auto&amp; e : E) {\n        edgeMap[e].length = 1;\n    }\n}\n</code></pre>\n\n<p>Style (or omit) the curly braces as you like.</p>\n\n<p>You can put any or all of this into arbitrarily many nested lambdas, but this is no more useful (but likely more harmful, at least in debug builds) than adding more whitespace. What you probably wanted to ask for is this:</p>\n\n<pre><code>void setEdgeLengths(Koala::AssocArray &lt;koalaGraph::PEdge, Koala::DijkstraHeap::EdgeLabs&lt;int &gt;&gt; &amp;edgeMap, std::vector&lt;koalaGraph::PEdge&gt;&amp; E) \n{\n    std::for_each(E.begin(), E.end(), [&amp;edgeMap](const auto&amp; e) {\n        edgeMap[e].length = 1;\n    });\n}\n</code></pre>\n\n<p>You no longer have a plain loop (which some advocate as good style), but I don't think the code has become any clearer. It also didn't get faster from doing this - if anything, debug performance is likely reduced slightly.</p>\n\n<p>Now, the latter form <em>does</em> allow for parallel execution by doing</p>\n\n<pre><code>std::for_each(std::execution::parallel, E.begin(), E.end(), [&amp;edgeMap](const auto&amp; e) {\n</code></pre>\n\n<p>but this is only legal if your <code>edgeMap</code> properly handles concurrent access. If it was a <code>std::map</code>, <code>operator[]</code> could potentially insert a new element (which is not thread-safe) so without further assumptions this would not be a legal optimization.</p>\n"}, {"comments": [{"owner": {"reputation": 698, "user_id": 2323908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80b84a0e679c6c32e168f2b8865cd4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Joakim Thor&#233;n", "link": "https://stackoverflow.com/users/2323908/joakim-thor%c3%a9n"}, "edited": false, "score": 0, "creation_date": 1553112052, "post_id": 55265902, "comment_id": 97269542, "body": "I think this answer can be improved upon by capturing solely <code>edgeMap</code> by reference, as opposed to capturing everything in scope with a plain <code>&amp;</code>. That way, it is clear that the <code>std::for_each</code> has few side-effects."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 698, "user_id": 2323908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80b84a0e679c6c32e168f2b8865cd4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Joakim Thor&#233;n", "link": "https://stackoverflow.com/users/2323908/joakim-thor%c3%a9n"}, "edited": false, "score": 1, "creation_date": 1553112161, "post_id": 55265902, "comment_id": 97269598, "body": "@JoakimThor&#233;n <code>[&amp;]</code> does not capture <i>everything</i> by reference.  In only captures everything it needs by reference.  In my example <code>[&amp;]</code> and <code>[&amp;edgeMap]</code> produce the exact same code, but <code>[&amp;]</code> requires less typing."}, {"owner": {"reputation": 698, "user_id": 2323908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80b84a0e679c6c32e168f2b8865cd4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Joakim Thor&#233;n", "link": "https://stackoverflow.com/users/2323908/joakim-thor%c3%a9n"}, "edited": false, "score": 0, "creation_date": 1553112637, "post_id": 55265902, "comment_id": 97269822, "body": "It&#39;s true that it does not capture <i>everything</i> by reference, sloppy wording on my part. Using <code>&amp;</code> introduces the possibility to accidentally capture something out of everything in scope, which may or may not be problematic."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 1, "last_activity_date": 1553099881, "creation_date": 1553099881, "answer_id": 55265902, "question_id": 55265653, "link": "https://stackoverflow.com/questions/55265653/replacing-a-function-with-a-lambda-in-c/55265902#55265902", "title": "Replacing a function with a lambda in C++", "body": "<p>If you want to apply an operation to every element of a container then you can use <a href=\"https://en.cppreference.com/w/cpp/algorithm/for_each\" rel=\"nofollow noreferrer\"><code>std::for_each</code></a>.  Since you want to use every element of <code>E</code> to access <code>edgeMap</code> you'll use <code>for_each</code> on <code>E</code> like</p>\n\n<pre><code>Koala::AssocArray &lt;koalaGraph::PEdge, Koala::DijkstraHeap::EdgeLabs&lt;int &gt;&gt; edgeMap = /* stuff */;\nstd::vector&lt;koalaGraph::PEdge&gt; E = /* stuff */;\n\nstd::for_each(E.begin(), E.end(),[&amp;](auto const&amp; index){ edgeMap[index].length = 1; });\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 11226898, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-suvAg66YwmA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcIggdXEKD-19IaYC84ilb6AvEm8Q/mo/photo.jpg?sz=128", "display_name": "black sheep", "link": "https://stackoverflow.com/users/11226898/black-sheep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553101457, "creation_date": 1553099121, "last_edit_date": 1553101457, "question_id": 55265653, "link": "https://stackoverflow.com/questions/55265653/replacing-a-function-with-a-lambda-in-c", "title": "Replacing a function with a lambda in C++", "body": "<p>I have a function that just sets a value of 1 to a struct member variable <code>length</code>. In modern C++ this doesn't seem like good code style. Could this be done with a lambda?  </p>\n\n<pre><code>void setEdgeLengths(Koala::AssocArray &lt;koalaGraph::PEdge, Koala::DijkstraHeap::EdgeLabs&lt;int &gt;&gt; &amp;edgeMap, std::vector&lt;koalaGraph::PEdge&gt;&amp; E) \n{\n    for (size_t i = 0; i &lt; E.size(); i++) {\n    edgeMap[E[i]].length = 1;\n    }\n}\n</code></pre>\n\n<p>The reason I am asking is <a href=\"https://shaharmike.com/cpp/lambdas-and-functions/\" rel=\"nofollow noreferrer\">https://shaharmike.com/cpp/lambdas-and-functions/</a> suggests that the lambda will be faster than an ordinary function.</p>\n\n<blockquote>\n  <p>Lambdas are also awesome when it comes to performance. Because they are objects rather than pointers they can be inlined very easily by the compiler, much like functors. This means that calling a lambda many times (such as with std::sort or std::copy_if) is much better than using a global function. This is one example of where C++ is actually faster than C.</p>\n</blockquote>\n"}, {"tags": ["python", "c++", "memory", "python-cffi"], "answers": [{"comments": [{"owner": {"reputation": 1563, "user_id": 7334162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2aa3c8e148927fb3ca4c94b03f051711?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/7334162/pierre"}, "edited": false, "score": 0, "creation_date": 1553104346, "post_id": 55265735, "comment_id": 97265704, "body": "I follow what you said. It works well but I have a weird error now. I updated my question."}, {"owner": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "reply_to_user": {"reputation": 1563, "user_id": 7334162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2aa3c8e148927fb3ca4c94b03f051711?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/7334162/pierre"}, "edited": false, "score": 0, "creation_date": 1553105195, "post_id": 55265735, "comment_id": 97266146, "body": "@Pierre: I think this is a very different question than your first since it is now a Python problem, not a C++/DLL problem. If your initial problem is fixed, you should close this question. Then start by Googling &#39;Python &quot;MemoryError: Stack overflow&quot;&#39; (with the double quotes), and you should find some other people with the same problem. If that does not lead you to a solution, post a new question on SO."}, {"owner": {"reputation": 1563, "user_id": 7334162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2aa3c8e148927fb3ca4c94b03f051711?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/7334162/pierre"}, "edited": false, "score": 0, "creation_date": 1553422529, "post_id": 55265735, "comment_id": 97371658, "body": "I didn&#39;t found an answer elsewhere. I asked a new question here: <a href=\"https://stackoverflow.com/questions/55322716/what-does-memoryerror-stack-overflow-mean-while-releasing-memory-using-cffi\" title=\"what does memoryerror stack overflow mean while releasing memory using cffi\">stackoverflow.com/questions/55322716/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "is_accepted": true, "score": 2, "last_activity_date": 1553099359, "last_edit_date": 1592644375, "creation_date": 1553099359, "answer_id": 55265735, "question_id": 55265547, "link": "https://stackoverflow.com/questions/55265547/why-my-app-crashes-when-i-free-a-char-allocated-by-a-dll-generated-with-cffi/55265735#55265735", "title": "Why my app crashes when I free a char* allocated by a DLL generated with CFFI?", "body": "<p>It is a dangerous practice to allocate in one place and then free across a DLL boundary. Avoid it unless you know that you're doing it right (same CRT version etc.). <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/potential-errors-passing-crt-objects-across-dll-boundaries?view=vs-2017\" rel=\"nofollow noreferrer\">Thus spake Microsoft</a>:</p>\n<blockquote>\n<p>When you pass C Run-time (CRT) objects such as file handles, locales, and environment variables into or out of a DLL (function calls across the DLL boundary), unexpected behavior can occur if the DLL, as well as the files calling into the DLL, use different copies of the CRT libraries.</p>\n<p>A related problem can occur when you allocate memory (either explicitly with new or malloc, or implicitly with strdup, strstreambuf::str, and so on) and then pass a pointer across a DLL boundary to be freed. This can cause a memory access violation or heap corruption if the DLL and its users use different copies of the CRT libraries.</p>\n</blockquote>\n<p>One solution to this is to expose a <code>free</code> function from your DLL that is turning over an allocated object so the client can call your <code>free</code> function on it, or in C++ you might use a smart pointer with a custom deleter to do it right.</p>\n"}], "owner": {"reputation": 1563, "user_id": 7334162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2aa3c8e148927fb3ca4c94b03f051711?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/7334162/pierre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 55265735, "answer_count": 1, "score": 0, "last_activity_date": 1553422287, "creation_date": 1553098761, "last_edit_date": 1553422287, "question_id": 55265547, "link": "https://stackoverflow.com/questions/55265547/why-my-app-crashes-when-i-free-a-char-allocated-by-a-dll-generated-with-cffi", "title": "Why my app crashes when I free a char* allocated by a DLL generated with CFFI?", "body": "<p>I'm using CFFI to generate a DLL:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import cffi\n\nffibuilder = cffi.FFI()\n\nffibuilder.embedding_api('''\n    char* get_string();\n''')\n\nffibuilder.set_source('my_plugin', '')\n\nffibuilder.embedding_init_code('''\n    from my_plugin import ffi, lib\n\n    @ffi.def_extern()\n    def get_string():\n        val = \"string\"\n        return lib.strdup(val.encode())\n''')\n\nffibuilder.cdef('''\n    char *strdup(const char *);\n''')\n\nffibuilder.compile(target='my-plugin.*', verbose=True)\n</code></pre>\n\n<p>I generate the DLL by running this previous script. Now, I create this sample of C++ code to use my DLL:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;windows.h&gt;\n\ntypedef char* (__stdcall *get_string_t)();\n\nint main()\n{\n    HINSTANCE hGetProcIDDLL = LoadLibrary(\"my-plugin.dll\");\n\n    if (!hGetProcIDDLL) {\n        std::cout &lt;&lt; \"could not load the dynamic library\" &lt;&lt; std::endl;\n        return -1;\n    }\n\n    get_string_t get_string = (get_string_t)GetProcAddress(hGetProcIDDLL, \"get_string\");\n    if (!get_string) {\n        std::cout &lt;&lt; \"could not locate the function\" &lt;&lt; std::endl;\n        return -1;\n    }\n\n    char* val = get_string();\n\n    std::cout &lt;&lt; \"Value = \" &lt;&lt; val &lt;&lt; std::endl;\n\n    free(val); // Crash !\n\n    std::cout &lt;&lt; \"End\" &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>I compile using the compiler of Visual Studio 2010 and, when I run my app, it crashes during the <code>free</code> instruction:</p>\n\n<pre><code>&gt; cl get_string.cpp\nCompilateur d'optimisation Microsoft (R) 32\u00a0bits C/C++ version\u00a016.00.40219.01 pour 80x86\nCopyright (C) Microsoft Corporation. Tous droits r\u00e9serv\u00e9s.\n\nget_string.cpp\nC:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\VC\\INCLUDE\\xlocale(323) : warning C4530: Gestionnaire d'exceptions C++ utilis\u00e9, mais les s\u00e9mantiques de d\u00e9roulement n'ont pas \u00e9t\u00e9 activ\u00e9es. Sp\u00e9cifiez /EHsc\nMicrosoft (R) Incremental Linker Version 10.00.40219.01\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\n/out:get_string.exe\nget_string.obj\n\n&gt; get_string.exe\nValue = string\n</code></pre>\n\n<p>I follow the indication given in <a href=\"https://stackoverflow.com/a/46766406/7334162\">this answer</a>. What should I do to free the memory and avoid my app to crash? Indeed, if I remove the <code>free</code> instruction, my app works well but it's not a clean solution.</p>\n"}, {"tags": ["c++", "opencv", "bgr"], "comments": [{"owner": {"reputation": 14828, "user_id": 1377097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eFG0R.png?s=128&g=1", "display_name": "beaker", "link": "https://stackoverflow.com/users/1377097/beaker"}, "edited": false, "score": 0, "creation_date": 1553105184, "post_id": 55265528, "comment_id": 97266145, "body": "<a href=\"https://docs.opencv.org/3.4.3/d3/d63/classcv_1_1Mat.html#ac40425b84f60b39fd35e03814122661f\" rel=\"nofollow noreferrer\"><code>cv::Mat::at</code></a> coordinate order is <code>(row, column)</code>. You&#39;ve got it backwards."}, {"owner": {"reputation": 17, "user_id": 10750066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6bb34d9fa6aa58acfbe782f8aa06df4?s=128&d=identicon&r=PG", "display_name": "momonosuke", "link": "https://stackoverflow.com/users/10750066/momonosuke"}, "reply_to_user": {"reputation": 14828, "user_id": 1377097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eFG0R.png?s=128&g=1", "display_name": "beaker", "link": "https://stackoverflow.com/users/1377097/beaker"}, "edited": false, "score": 0, "creation_date": 1553106059, "post_id": 55265528, "comment_id": 97266536, "body": "@breaker thanks a lot :))"}], "owner": {"reputation": 17, "user_id": 10750066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6bb34d9fa6aa58acfbe782f8aa06df4?s=128&d=identicon&r=PG", "display_name": "momonosuke", "link": "https://stackoverflow.com/users/10750066/momonosuke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553098680, "creation_date": 1553098680, "question_id": 55265528, "link": "https://stackoverflow.com/questions/55265528/changing-the-bgr-color-values-of-a-picture-on-opencv", "title": "changing the bgr color values of a picture on opencv", "body": "<p>My function below should change the color values of the original picture and then once the process is done it should create another picture with the changed colors.</p>\n\n<pre><code>void change(const cv::Mat &amp;first_image, cv::Mat &amp;new_image, const std::vector&lt;std::vector&lt;int&gt; &gt; &amp;colors)\n{\n    for (int i = 0; i &lt; first_image.cols; i++) {\n    for (int j = 0; j &lt; first_image.rows; j++) {\n\n int blue = first_image.at&lt;cv::Vec3b&gt;(i,j)[0];\n new_image.at&lt;cv::Vec3b&gt;(i,j)[2]= colors [2][blue];\n\n int green = first_image.at&lt;cv::Vec3b&gt;(i,j)[1];\n\n new_image.at&lt;cv::Vec3b&gt;(i,j)[1]= colors [1][green];\n\n int red = first_image.at&lt;cv::Vec3b&gt;(i,j)[2];\n\n new_image.at&lt;cv::Vec3b&gt;(i,j)[0]= colors [0][red];\n}\n}\n}\n</code></pre>\n\n<p>when I use the command make and run the whole code I get a segmentation fault.\nI use this command to run the code </p>\n\n<pre><code>../../build/mv/task/mvtask1d pic.json\n</code></pre>\n\n<p>Could someone tell me what I could be doing wrong?</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["c++", "r", "statistics", "linear-algebra", "rcpp"], "answers": [{"tags": [], "owner": {"reputation": 17516, "user_id": 1345455, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DrBTs.jpg?s=128&g=1", "display_name": "coatless", "link": "https://stackoverflow.com/users/1345455/coatless"}, "is_accepted": true, "score": 4, "last_activity_date": 1553108618, "creation_date": 1553108618, "answer_id": 55268390, "question_id": 55265496, "link": "https://stackoverflow.com/questions/55265496/calling-numderivhessian-with-multiple-parameter-objective-function-in-rcpp/55268390#55268390", "title": "Calling numDeriv:hessian() with multiple-parameter-objective-function in Rcpp", "body": "<p>Couple of quick notes:</p>\n\n<ul>\n<li>Try the implementation in <em>R</em> and then move it to <em>C++</em>.\n\n<ul>\n<li>Provides a reference point and makes sure that everything works as intended.</li>\n</ul></li>\n<li>Search paths and names matter\n\n<ul>\n<li>Explicitly load <code>numDeriv</code> package before compiling.</li>\n<li>Respect capitalization <code>X</code> vs. <code>x</code>.</li>\n</ul></li>\n<li>Ensure output types are accurate\n\n<ul>\n<li>From  <a href=\"https://cran.r-project.org/web/packages/numDeriv/numDeriv.pdf#page=8\" rel=\"nofollow noreferrer\"><code>?numDeriv::hessian</code></a>, the output type is an <strong>N</strong> x <strong>N</strong> <code>Rcpp::NumericMatrix</code> instead of <code>Rcpp::List</code>.</li>\n</ul></li>\n</ul>\n\n<h3>Implementing in R</h3>\n\n<p>Coding the example and running it in <strong>pure</strong> <em>R</em> would give: </p>\n\n<pre><code>k = 2\nk_dimensional = function(x, N) {\n x ^ N \n}\n\nnumDeriv::hessian(k_dimensional, x = rep(1, k), N = 3)\n</code></pre>\n\n<blockquote>\n  <p>Error in hessian.default(k_dimensional, x = rep(1, k), N = 3) :</p>\n  \n  <p>Richardson method for hessian assumes a scalar valued function.</p>\n</blockquote>\n\n<p>So, immediately, this means that the <code>k_dimensional()</code> function is missing a reduction down to a scalar (e.g. single value).</p>\n\n<h3>Environment Run Time Error with C++ variant</h3>\n\n<p>After compiling the original code, there is a <strong>runtime error</strong> or when the function was called the issue an issue appears. For example, we have:</p>\n\n<pre><code>Rcpp::sourceCpp(\"path/to/call_KD_hessian_in_C.cpp\")\ncall_KD_hessian_in_C(K = 2)\n</code></pre>\n\n<p>This provides the error of:</p>\n\n<blockquote>\n  <p>Error in call_KD_hessian_in_C(2) : </p>\n  \n  <p>Cannot convert object to an environment: [type=character; target=ENVSXP].</p>\n</blockquote>\n\n<p>As we are using an <em>R</em> function found in a package not loaded by default, we must explicitly load it via <code>library()</code> or <code>require()</code> before calling the function.</p>\n\n<p>Therefore, the process to avoid an environment issue should be:</p>\n\n<pre><code># Compile the routine\nRcpp::sourceCpp(\"path/to/call_KD_hessian_in_C.cpp\")\n\n# Load numDeriv to ensure it is on the search path\nlibrary(\"numDeriv\")\n\n# Call function\ncall_KD_hessian_in_C(2)\n</code></pre>\n\n<h3>Cleaned Up C++ Implementation</h3>\n\n<p>From prior discussion, note that we've:</p>\n\n<ol>\n<li>Changed the function used with the hessian to be a <strong>scalar</strong> or <strong>single value</strong>, e.g. <code>double</code>, instead of a <strong>vector of values</strong>, e.g. <code>NumericVector</code>.</li>\n<li>Ensured that before the function call the <code>numDeriv</code> <em>R</em> package is loaded. </li>\n<li>Changed the return type expected from the <code>hessian()</code> function from <code>Rcpp::List</code> to <code>Rcpp::NumericMatrix</code>.</li>\n</ol>\n\n<p>This results in the following <em>C++</em> code:</p>\n\n<pre><code>#include &lt;Rcpp.h&gt;\n\ndouble k_dimensional_cpp(Rcpp::NumericVector x, double N){\n// ^^ Change return type from NumericVector to double\n\n  // Speed up the process by writing the _C++_ loop\n  // instead of relying on Rcpp sugar.\n  double total = 0;\n  for(int i = 0 ; i &lt; x.size(); ++i) {\n      total += std::pow(x[i], N);\n  }\n\n  // Return the accumulated total\n  return total;\n}\n\n// [[Rcpp::export]]\nRcpp::NumericMatrix call_KD_hessian_in_C(double K) {\n\n  // Ensure that numDeriv package is loaded prior to calling this function\n  Rcpp::Environment numDeriv(\"package:numDeriv\");\n  Rcpp::Function hessian = numDeriv[\"hessian\"];\n\n  double param = 3;\n  Rcpp::NumericVector x = Rcpp::rep(1.0, K);\n\n  // Switched from Rcpp::List to Rcpp::NumericMatrix\n  Rcpp::NumericMatrix hessian_results = \n  hessian(\n    Rcpp::_[\"func\"] = Rcpp::InternalFunction(k_dimensional_cpp),\n    Rcpp::_[\"x\"] = x,    // use lower case x to match function signature.\n    Rcpp::_[\"N\"] = param\n  );\n\n  // Return the calculated hessian\n  return hessian_results;\n}\n</code></pre>\n\n<p>Testing the routine gives:</p>\n\n<pre><code># Ensure numDeriv is on search path\nlibrary(\"numDeriv\")\n\n# Call function\ncall_KD_hessian_in_C(K = 2)\n#              [,1]         [,2]\n# [1,] 6.000000e+00 3.162714e-12\n# [2,] 3.162714e-12 6.000000e+00\n</code></pre>\n"}], "owner": {"reputation": 867, "user_id": 2340598, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/abef243ec80de5b0757bf3ab016aa72f?s=128&d=identicon&r=PG", "display_name": "maciek", "link": "https://stackoverflow.com/users/2340598/maciek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 55268390, "answer_count": 1, "score": 0, "last_activity_date": 1553108618, "creation_date": 1553098599, "question_id": 55265496, "link": "https://stackoverflow.com/questions/55265496/calling-numderivhessian-with-multiple-parameter-objective-function-in-rcpp", "title": "Calling numDeriv:hessian() with multiple-parameter-objective-function in Rcpp", "body": "<p>My aim is to call the <code>hessian()</code> function from the <code>numDeriv</code> <code>R</code> package from a cpp file (using <code>Rcpp</code>).  </p>\n\n<p>A toy example:<br>\nI want to calculate a hessian of a one-dimensional function x^n at the point x=1 with parameter n=3.<br>\nR code:  </p>\n\n<pre><code>H = call_1D_hessian_in_C(K=1)\nprint(H)\n</code></pre>\n\n<p>Cpp code:</p>\n\n<pre><code>double one_dimensional(double X, double N){\n  return pow(X,N);\n}\n\n// [[Rcpp::export]]\ndouble call_1D_hessian_in_C(double K) {\n\n  Rcpp::Environment numDeriv(\"package:numDeriv\");\n  Rcpp::Function hessian = numDeriv[\"hessian\"];\n  double param = 3;\n\n  Rcpp::List hessian_results =\n  hessian(\n    Rcpp::_[\"func\"] = Rcpp::InternalFunction(one_dimensional), \n    Rcpp::_[\"x\"] = 1.0,\n    Rcpp::_[\"N\"] = param\n  );\n\n  return hessian_results[0];\n\n}\n</code></pre>\n\n<p>This works fine and I indeed get \"6\" at the output.<br>\nHowever my true goal is to calculate hessians of K-dimensional functions, therefore K=/=1. I try the following:  </p>\n\n<pre><code>H = call_KD_hessian_in_C(K=2)\nprint(H)\n</code></pre>\n\n<p>And in Cpp:</p>\n\n<pre><code>NumericVector k_dimensional(NumericVector X, double N){\n  return pow(X,N);\n}\n\n// [[Rcpp::export]]\ndouble call_KD_hessian_in_C(double K) {\n\n  Rcpp::Environment numDeriv(\"package:numDeriv\");\n  Rcpp::Function hessian = numDeriv[\"hessian\"];\n  double param = 3;\n\n  Rcpp::NumericVector x = rep(1.0,K);\n\n  Rcpp::List hessian_results = \n  hessian(\n    Rcpp::_[\"func\"] = Rcpp::InternalFunction(k_dimensional),\n    Rcpp::_[\"x\"] = x,\n    Rcpp::_[\"N\"] = param\n  );\n\n  return hessian_results[0];\n\n}\n</code></pre>\n\n<p>But now I get \"invalid pointer\" errors. A am not sure how to provide the hessian function call with a cpp function that takes a set of parameters to evaluate the partial derivatives at...</p>\n"}, {"tags": ["c++", "cmake", "cuda"], "comments": [{"owner": {"reputation": 1327, "user_id": 2990896, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/hSkaq.jpg?s=128&g=1", "display_name": "cplusplusrat", "link": "https://stackoverflow.com/users/2990896/cplusplusrat"}, "edited": false, "score": 1, "creation_date": 1553098583, "post_id": 55265364, "comment_id": 97262328, "body": "Have you tried <code>cuda_add_executable</code> instead of <code>add_executable</code> ?"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1553098884, "post_id": 55265364, "comment_id": 97262532, "body": "Indeed, you forgot to use the CUDA runtimes which won&#39;t be added by default. Also CMake 2.8 is very old and not 100% compatible with modern CMake."}, {"owner": {"reputation": 41, "user_id": 10847182, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nUph7eLX2MU/AAAAAAAAAAI/AAAAAAAAALk/P8MClzvBbE0/photo.jpg?sz=128", "display_name": "Black_Magic", "link": "https://stackoverflow.com/users/10847182/black-magic"}, "edited": false, "score": 0, "creation_date": 1553099085, "post_id": 55265364, "comment_id": 97262655, "body": "I use cmake 3.5.1. Also I tried <code>cuda_add_executable</code> and it gives <code>undefined reference to __cudaRegisterLinkedBinary_44_tmpxft_...</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1026, "user_id": 8469676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d870a9cbdcef704cebecb991662019?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertM", "link": "https://stackoverflow.com/users/8469676/albertm"}, "is_accepted": true, "score": 1, "last_activity_date": 1553099707, "last_edit_date": 1553099707, "creation_date": 1553099390, "answer_id": 55265753, "question_id": 55265364, "link": "https://stackoverflow.com/questions/55265364/separate-cuda-compilation-with-cmake/55265753#55265753", "title": "Separate CUDA compilation with CMAKE", "body": "<p>Cmake 3.8 added native support for CUDA (<a href=\"https://devblogs.nvidia.com/building-cuda-applications-cmake/\" rel=\"nofollow noreferrer\">here</a> is a document from NVIDIA that explains how to use it this way), you can simply add cuda as a language and the appropriate compiler will be used automatically for each file.</p>\n\n<pre><code>cmake_minimum_required (VERSION 3.8)\n\nproject(youProject LANGUAGES CXX CUDA)\n\nadd_executable(yourExecutable)\ntarget_sources(yourExecutable &lt;you can add c++ as well as cuda files here&gt;)\n\n// Or if you want to separate cuda and C++ more clearly, put your cuda code\n// in a library and link to it (which obviously allows you to compile them separately)\nadd_library(yourCudaLib &lt;you can add your cuda files here&gt;)\ntarget_link_libraries(yourProject PRIVATE yourCudaLib)\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10847182, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nUph7eLX2MU/AAAAAAAAAAI/AAAAAAAAALk/P8MClzvBbE0/photo.jpg?sz=128", "display_name": "Black_Magic", "link": "https://stackoverflow.com/users/10847182/black-magic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 0, "accepted_answer_id": 55265753, "answer_count": 1, "score": 0, "last_activity_date": 1553099707, "creation_date": 1553098197, "question_id": 55265364, "link": "https://stackoverflow.com/questions/55265364/separate-cuda-compilation-with-cmake", "title": "Separate CUDA compilation with CMAKE", "body": "<p>I want to compile .cu and .cpp to .o files separately, then link them to executable. I have few simple files: cuda_func.cu. cuda_func.h and main.cpp. In main cpp I include cuda_func.h and run cuda_func(). I've come up with following cmake code:</p>\n\n<pre><code>project(cuda)\n\ncmake_minimum_required(VERSION 2.8)\n\n# CUDA PACKAGE\nfind_package(CUDA REQUIRED)\nset(CUDA_SEPARABLE_COMPILATION ON)\nset(CUDA_PROPAGATE_HOST_FLAGS OFF)\nset(CUDA_HOST_COMPILER g++)\n\n# COMPILE CU FILES\nfile(GLOB CUDA_FILES *.cu)\nlist( APPEND CUDA_NVCC_FLAGS \"-gencode arch=compute_30,code=sm_30; -std=c++11\")\nCUDA_COMPILE(CU_O ${CUDA_FILES})\n\nSET(CMAKE_EXE_LINKER_FLAGS  \"-L/usr/local/cuda/lib -lcudart\")\n\n# SETUP FOR CPP FILES\nset(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -std=c++11\")\ninclude_directories(${CMAKE_CURRENT_SOURCE_DIR})\n\n# COMPILE AND LINK\nadd_executable(main main.cpp ${CU_O})\n</code></pre>\n\n<p>But I get undefined reference to \"cudaMemcpy\" error. When I compile it by hand, using nvcc and g++ to get .o files and g++ finally to make executable it works fine. It seems like the cuda library isnt linked properly at the end. What should I do?</p>\n"}, {"tags": ["c++", "windows", "exception", "seh"], "comments": [{"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 1, "creation_date": 1553098810, "post_id": 55265355, "comment_id": 97262491, "body": "Use an <a href=\"https://docs.microsoft.com/en-us/cpp/cpp/try-except-statement?view=vs-2017\" rel=\"nofollow noreferrer\">exception filter</a>"}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1553098971, "post_id": 55265355, "comment_id": 97262590, "body": "Although you cannot actually &#39;handle&#39; AccessViolations. Once an AV has happenned all bets are realistically off with respoect to the state of your program. Remeber an AV isn&#39;t <i>guaranteed</i> on bad access as far as c++ is concerned."}, {"owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "reply_to_user": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1553500296, "post_id": 55265355, "comment_id": 97391762, "body": "Hi and thanks for the help, i&#39;ve found out that there are many intrinsic function that may put some more details about the exception nature. In may case, i only care about AV exception, and i wish to avoid it. However, I&#39;m using C++ and prefer using the standard try-catch structure (while configuring The /EHa compiler option. is there an option to use those intrinsic function in order to check the exception type in my case ? thanks !"}], "answers": [{"tags": [], "owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "is_accepted": false, "score": 0, "last_activity_date": 1553505585, "creation_date": 1553505585, "answer_id": 55334585, "question_id": 55265355, "link": "https://stackoverflow.com/questions/55265355/handling-seh-exception-of-specific-type-access-violation-only/55334585#55334585", "title": "handling SEH exception of specific type (access violation only)", "body": "<p>using <code>_set_se_translator</code> I can define the required behavior in SEH exception only, leaving all non-seh exception to the <code>catch</code> statement. </p>\n\n<p>I defined the following handling (should be set per thread) : </p>\n\n<pre><code>void mySEHtranslator(unsigned int exceptionCode, PEXCEPTION_POINTERS exceptionRecord)\n{\n    if (exceptionRecord-&gt;ExceptionRecord-&gt;ExceptionCode == EXCEPTION_ACCESS_VIOLATION)\n    {\n        puts(\"access violation not count\");\n    }\n    else\n    {\n        throw \"1\"; // does not suppose to be caught. \n    }\n}\n</code></pre>\n\n<p>and in the relevant code section where i want to imply the translator that ignore access violation : </p>\n\n<pre><code>void mycode()\n{\n    _set_seh_translator(mySEHtranslator);\n\n    try {\n        .... my code ...\n    } \n    catch (...) // does not suppose to catch the \"1\" \n    {\n\n    }\n}\n</code></pre>\n\n<p>additional reference can be found <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/set-se-translator?view=vs-2017\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 422, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553505585, "creation_date": 1553098163, "last_edit_date": 1553500517, "question_id": 55265355, "link": "https://stackoverflow.com/questions/55265355/handling-seh-exception-of-specific-type-access-violation-only", "title": "handling SEH exception of specific type (access violation only)", "body": "<p>In order to handle access violation exception, project should be configured with SEH Exceptions (/EHa). </p>\n\n<p>I'm looking for handling access violation exceptions only. According to this Microsoft publication <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/eh-exception-handling-model?view=vs-2017\" rel=\"nofollow noreferrer\">here</a>, in order to catch this SEH exceptions, one must use the general catch <code>catch(...)</code> that will catch all exception. </p>\n\n<p>The question is whether there's an option to handle this exception in specific and leave other SEH unhandled, not necessarily by using the try/catch pattern. </p>\n\n<p>UPDATE: thanks to the link in a comment below, I've found out about the <code>__try/__except</code> structure to handle SEH exceptions with many intrinsic functions that may put some more details about the exception nature. </p>\n\n<p>In may case, i only care about AV exception, and i wish to avoid it. However, I'm using C++ and prefer using the standard <code>try/catch</code> structure (while configuring The /EHa compiler option). </p>\n\n<p>Is there an option to use those intrinsic function in order to check the exception type in my case ?</p>\n"}, {"tags": ["c++", "build", "cmake"], "comments": [{"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 0, "creation_date": 1553102018, "post_id": 55265317, "comment_id": 97264436, "body": "Complicating your CMAKE structure just to make your IDE happy seems like a bad choice. I would look into making Qt-Creator list your files dirrefently."}, {"owner": {"reputation": 2119, "user_id": 5879778, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ELi77pnET0A/AAAAAAAAAAI/AAAAAAAAAEQ/7gEOlIOZ6ow/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/5879778/chris"}, "edited": false, "score": 0, "creation_date": 1553103632, "post_id": 55265317, "comment_id": 97265332, "body": "Do you mean just making a <code>project(magic)</code> inside of <code>src</code>? Because that&#39;s how I&#39;ve always done it. And then your <code>myproject</code> solution would contain all of them. However, it&#39;s important that you get your dependencies correct."}, {"owner": {"reputation": 131, "user_id": 2759134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IeyNd.jpg?s=128&g=1", "display_name": "Lexusminds", "link": "https://stackoverflow.com/users/2759134/lexusminds"}, "edited": false, "score": 0, "creation_date": 1553153900, "post_id": 55265317, "comment_id": 97281502, "body": "Thanks for your answers. Yeah, creating multiple projects came to my mind as well. No idea if that&#39;s a good way to do it though."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1553182068, "post_id": 55265317, "comment_id": 97297675, "body": "Maybe modularize your applicatio? Also, public header should not be added into library sources, but into the <code>PUBLIC_HEADER</code> target property"}], "owner": {"reputation": 131, "user_id": 2759134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IeyNd.jpg?s=128&g=1", "display_name": "Lexusminds", "link": "https://stackoverflow.com/users/2759134/lexusminds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553098045, "creation_date": 1553098045, "question_id": 55265317, "link": "https://stackoverflow.com/questions/55265317/how-to-structure-cmake-project-into-smaller-projects", "title": "How to structure CMake project into smaller projects?", "body": "<p>:)</p>\n\n<p>My current project structure looks something like this:</p>\n\n<pre><code>MyProject\n|_ CMakeLists.txt   \n|_ src\n  |_ CMakeLists.txt\n  |_ clazz.cpp\n  |_ clazz.h\n  |_ magic.cpp\n  |_ magic.h\n|_ test\n  |_ CMakeLists.txt\n</code></pre>\n\n<p>Now the src directory has been growing and growing, containing 15+ files. Inside my IDE (Qt-Creator) I see all of those files listed underneath each other which doesn't help at keeping a good overview. Qt-Creator groups them by project and this far, there is only one.</p>\n\n<p>The root CMakeLists.txt reads:</p>\n\n<pre><code>project(myproject)\nadd_subdirectory(src)\nadd_subdirectory(test)\n</code></pre>\n\n<p>And the one inside src is something like:</p>\n\n<pre><code>set(SRCS clazz.cpp, magic.cpp)\nset(INCS clazz.h, magic.h)\nadd_library(mypro STATIC ${SRCS} ${INCS})\ntarget_include_directories(mypro PUBLIC ${CMAKE_CURRENT_SOURCE_DIR})\n</code></pre>\n\n<p>How'd you structure this project into kind of \"subprojects\" with CMake? Simply creating subdirectories won't do the trick here.</p>\n\n<p>Thanks in advance! :)</p>\n"}, {"tags": ["javascript", "jquery", "html", "c++", "esp32"], "comments": [{"owner": {"reputation": 1312, "user_id": 2011372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e69756cdad0cbf89d9a39743fbc1dd0?s=128&d=identicon&r=PG", "display_name": "d_shiv", "link": "https://stackoverflow.com/users/2011372/d-shiv"}, "reply_to_user": {"reputation": 20731, "user_id": 2181514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pS2Yo.jpg?s=128&g=1", "display_name": "freedomn-m", "link": "https://stackoverflow.com/users/2181514/freedomn-m"}, "edited": false, "score": 0, "creation_date": 1553100245, "post_id": 55265279, "comment_id": 97263370, "body": "I stand corrected @freedomn-m. <code>.load</code> indeed is a valid jQuery API. And it does exactly what the @bleah1 expects. Sorry, about the confusion."}, {"owner": {"reputation": 20731, "user_id": 2181514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pS2Yo.jpg?s=128&g=1", "display_name": "freedomn-m", "link": "https://stackoverflow.com/users/2181514/freedomn-m"}, "reply_to_user": {"reputation": 1312, "user_id": 2011372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e69756cdad0cbf89d9a39743fbc1dd0?s=128&d=identicon&r=PG", "display_name": "d_shiv", "link": "https://stackoverflow.com/users/2011372/d-shiv"}, "edited": false, "score": 0, "creation_date": 1553100379, "post_id": 55265279, "comment_id": 97263429, "body": "@elem4th no worries - it&#39;s not quite used correctly as the <code>.fadeIn</code> will occur before the <code>.load</code> - but that shouldn&#39;t stop things &quot;working&quot; - will just look bad"}, {"owner": {"reputation": 1312, "user_id": 2011372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e69756cdad0cbf89d9a39743fbc1dd0?s=128&d=identicon&r=PG", "display_name": "d_shiv", "link": "https://stackoverflow.com/users/2011372/d-shiv"}, "edited": false, "score": 0, "creation_date": 1553100490, "post_id": 55265279, "comment_id": 97263495, "body": "Yeah, the real issue is that jQuery isn&#39;t loaded at all. The ESP code isn&#39;t configured to serve that. Same goes for the <code>event.html</code>. Will update that in an answer."}], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 11233023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2401dac2930aac704ab87da3acc8d4?s=128&d=identicon&r=PG&f=1", "display_name": "bleah1", "link": "https://stackoverflow.com/users/11233023/bleah1"}, "edited": false, "score": 0, "creation_date": 1553159231, "post_id": 55266545, "comment_id": 97283935, "body": "Great explanation ! It worked perfectly ! Thank you so much! I&#39;ve made the source into a .js file and uploaded it on the ESP and then made a path for it usind server.on(); The only question I have left is if it&#39;s ok to use html tags around the divs of the placeholders inside <code>&#47;events-log.html</code>  Currently it&#39;s working. <code>&lt;!DOCTYPE html&gt;</code> <code>&lt;html&gt;</code> <code>&lt;div class=&quot;textbox&quot;&gt;%PLACEHOLDER_1%&lt;&#47;div&gt;</code> <code>&lt;div class=&quot;textbox&quot;&gt;%PLACEHOLDER_2%&lt;&#47;div&gt;</code> <code>&lt;div class=&quot;textbox&quot;&gt;%PLACEHOLDER_3%&lt;&#47;div&gt;</code> <code>&lt;div class=&quot;textbox&quot;&gt;%PLACEHOLDER_4%&lt;&#47;div&gt;</code> <code>&lt;div class=&quot;textbox&quot;&gt;%PLACEHOLDER_5%&lt;&#47;div&gt;</code> <code>&lt;&#47;html&gt;</code>"}, {"owner": {"reputation": 1312, "user_id": 2011372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e69756cdad0cbf89d9a39743fbc1dd0?s=128&d=identicon&r=PG", "display_name": "d_shiv", "link": "https://stackoverflow.com/users/2011372/d-shiv"}, "reply_to_user": {"reputation": 449, "user_id": 11233023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2401dac2930aac704ab87da3acc8d4?s=128&d=identicon&r=PG&f=1", "display_name": "bleah1", "link": "https://stackoverflow.com/users/11233023/bleah1"}, "edited": false, "score": 0, "creation_date": 1553177781, "post_id": 55266545, "comment_id": 97294702, "body": "The html tags won&#39;t be necessary. Everything that you put in <code>event-log.html</code> will get injected inside the big-box div. Now, a html tag inside div tag isn&#39;t syntactically correct, but the browsers will simply ignore the tag, so you can leave them if you want."}], "tags": [], "owner": {"reputation": 1312, "user_id": 2011372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e69756cdad0cbf89d9a39743fbc1dd0?s=128&d=identicon&r=PG", "display_name": "d_shiv", "link": "https://stackoverflow.com/users/2011372/d-shiv"}, "is_accepted": true, "score": 0, "last_activity_date": 1553101832, "creation_date": 1553101832, "answer_id": 55266545, "question_id": 55265279, "link": "https://stackoverflow.com/questions/55265279/refreshing-div-inside-html-without-any-php/55266545#55266545", "title": "Refreshing div inside HTML without any PHP?", "body": "<p>TL;DR The ESP server doesn't serve the <code>/jquery-1.9.0.min.js</code> and <code>/events.html</code> files that the original HTML references. Read on for details.</p>\n\n<p>When <code>$('#big-box').load('events.html')</code> code executes, the browser makes a HTTP GET call in background to your ESP server, at path <code>/event.html</code>. The requests on that path doesn't seem to be handled on ESP side. To handle requests on that path, you'd need something like this:</p>\n\n<pre><code>server.on('/event.html`, [](AsyncWebServerRequest *request) {\n    request-&gt;send(SPIFFS, \"/events-log.html\", \"text/html\", false, processor);\n})`.\n</code></pre>\n\n<p>Additionally, you'd need to create <code>events-log.html</code> file with following content (basically everything that <code>big-box</code> div contained):</p>\n\n<pre><code>&lt;div class=\"textbox\"&gt;%PLACEHOLDER_1%&lt;/div&gt;\n&lt;div class=\"textbox\"&gt;%PLACEHOLDER_2%&lt;/div&gt;\n&lt;div class=\"textbox\"&gt;%PLACEHOLDER_3%&lt;/div&gt;\n&lt;div class=\"textbox\"&gt;%PLACEHOLDER_4%&lt;/div&gt;\n&lt;div class=\"textbox\"&gt;%PLACEHOLDER_5%&lt;/div&gt;\n</code></pre>\n\n<p>Also note, that the <code>jquery-1.9.0.min.js</code> file that you included in your HTML file (using script tag) wouldn't be loaded for same reason. The browser will try to send a HTTP GET request to <code>/jquery-1.9.0.min.js</code>, and since request on that path isn't handled, browser will get 404 error. </p>\n\n<p>If the computer on which you are accessing this page has internet access, then you can load jQuery from CDN by changing your script tag to following snippet. If the machine doesn't have internet access then you'd need to download the jQuery file, save it to SPIFFS, and serve it in same manner as the other files.</p>\n\n<pre><code>   &lt;script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-1.12.4.min.js\"&gt;&lt;/script&gt;\n</code></pre>\n"}], "owner": {"reputation": 449, "user_id": 11233023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2401dac2930aac704ab87da3acc8d4?s=128&d=identicon&r=PG&f=1", "display_name": "bleah1", "link": "https://stackoverflow.com/users/11233023/bleah1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 1, "accepted_answer_id": 55266545, "answer_count": 1, "score": 1, "last_activity_date": 1553101832, "creation_date": 1553097920, "question_id": 55265279, "link": "https://stackoverflow.com/questions/55265279/refreshing-div-inside-html-without-any-php", "title": "Refreshing div inside HTML without any PHP?", "body": "<p>Good afternoon !</p>\n\n<p>The idea behind my project is to send made-by-hand logs to a webpage so that I don't have to rely solely on the Serial Monitor.</p>\n\n<p>I am sending Strings from ESP32 to a webpage that is hosted by the same ESP32.\nTo do that I am using ESPAsyncWebServer library that let's me use <code>placeholders</code> inside the HTML. The ESP then uses: </p>\n\n<p><code>String processor(const String&amp; var)</code> </p>\n\n<p>and</p>\n\n<p><code>server.on(\"/logs\", HTTP_GET, [](AsyncWebServerRequest* request){\n       request-&gt;send(SPIFFS, \"/events.html\", \"text/html\", false, processor);\n    });</code></p>\n\n<p>to replace the placeholder it founds with whatever piece of data I want.</p>\n\n<p>I am using a circular buffer so that I don't end up using all the memory.</p>\n\n<p>I googled how should I refresh a div inside a html and everywhere I looked there was a <code>.load('file.php')</code>. I don't have any .php files for my project.</p>\n\n<h3>The question is what do I load instead of that php file ?</h3>\n\n<p>Loading the same .html page did not work.</p>\n\n<h2>events.html</h2>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;    \n&lt;head&gt;\n    &lt;meta charset = \"utf-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n\n    &lt;link rel = \"stylesheet\" type = \"text/css\" href = \"master.css\"&gt;   \n    &lt;title&gt;Events Log&lt;/title&gt;\n&lt;script type=\"text/javascript\" src=\"jquery-1.9.0.min.js\"&gt;&lt;/script&gt;\n&lt;script&gt;\n$(document).ready( function(){\n$('#big-box').load('events.html');\nrefresh();\n});\n\nfunction refresh()\n{\n    setTimeout( function() {\n      $('#big-box').fadeOut('slow').load('events.html').fadeIn('slow');\n      refresh();\n    }, 2000);\n}\n&lt;/script&gt;\n&lt;/head&gt;\n\n\n&lt;body&gt;\n    &lt;div id=\"big-box\"&gt;\n        &lt;div class=\"textbox\"&gt;%PLACEHOLDER_1%&lt;/div&gt;\n        &lt;div class=\"textbox\"&gt;%PLACEHOLDER_2%&lt;/div&gt;\n        &lt;div class=\"textbox\"&gt;%PLACEHOLDER_3%&lt;/div&gt;\n        &lt;div class=\"textbox\"&gt;%PLACEHOLDER_4%&lt;/div&gt;\n        &lt;div class=\"textbox\"&gt;%PLACEHOLDER_5%&lt;/div&gt;\n    &lt;/div&gt;\n\n&lt;/body&gt;\n</code></pre>\n\n<h2>main.cpp</h2>\n\n<pre><code>#include &lt;Arduino.h&gt;\n#include &lt;ESPAsyncWebServer.h&gt;\n#include &lt;SPIFFS.h&gt;\n#include &lt;cstdio&gt;\n#include &lt;memory&gt;\n#include &lt;mutex&gt;\n\nvoid logOutput(String string);\n\n\n//---------- Circular Buffer\ntemplate &lt;class T&gt;\nclass circular_buffer {\npublic:\n    explicit circular_buffer(size_t size) :\n        buf_(std::unique_ptr&lt;T[]&gt;(new T[size])),\n        max_size_(size)\n    {\n\n    }\n\n    void put(T item){\n        std::lock_guard&lt;std::mutex&gt; lock(mutex_);\n\n        buf_[head_] = item;\n\n        if(full_){\n            tail_ = (tail_ + 1) % max_size_;\n        }\n        head_ = (head_ + 1) % max_size_;\n        full_ = head_ == tail_;\n    }\n\n    T get() {\n        std::lock_guard&lt;std::mutex&gt; lock(mutex_);\n\n        if(empty()) {\n            return T();\n        }\n        //Read data and advance the tail (we now have a free space)\n        auto val = buf_[tail_];\n        full_ = false;\n        tail_ = (tail_ + 1) % max_size_;\n\n        return val;\n    }\n\n    T get2() {\n        std::lock_guard&lt;std::mutex&gt; lock(mutex_);\n        if(empty()) {\n            return T();\n        }\n        auto val = buf_[tail_];\n        return val;\n    }\n\n    void reset() {\n        std::lock_guard&lt;std::mutex&gt; lock(mutex_);\n        head_ = tail_;\n        full_ = false;\n    }\n\n    bool empty() const {\n        //if head and tail are equal, we are empty\n        return (!full_ &amp;&amp; (head_ == tail_));\n    }\n\n    bool full() const   {\n        //If tail is ahead the head by 1, we are full\n        return full_;\n    }\n\n    size_t capacity() const {\n        return max_size_;\n    }\n\n    size_t size() const {\n        size_t size = max_size_;\n\n        if(!full_)  {\n            if(head_ &gt;= tail_)  {\n                size = head_ - tail_;\n            } else {\n                size = max_size_ + head_ - tail_;\n            }\n        }\n        return size;\n    }\n\nprivate:\n    std::mutex mutex_;\n    std::unique_ptr&lt;T[]&gt; buf_;\n    size_t head_ = 0;\n    size_t tail_ = 0;\n    const size_t max_size_;\n    bool full_ = 0;\n}; //---------- Circular Buffer\n\ncircular_buffer&lt;String&gt; circle(20);\n\nvoid logOutput(String string) {\n    delay(2000);\n    circle.put(string);\n    Serial.println(string); \n}\n\nAsyncWebServer server(80);\n\nconst char* ssid = \"metrici.ro\";\nconst char* password = \"cocoscocos\";\n\nString processor(const String&amp; var) { \n           if(var == \"PLACEHOLDER_1\"){\n        return circle.get();\n    } else if(var == \"PLACEHOLDER_2\") {\n        return circle.get();\n    } else if(var == \"PLACEHOLDER_3\") {\n        return circle.get();\n    } else if(var == \"PLACEHOLDER_4\") {\n        return circle.get();\n    } else if(var == \"PLACEHOLDER_5\") {\n        return circle.get();\n    }\n    return String();\n}\n\nvoid setup() {\n    Serial.begin(115200);\n    delay(2000);\n\n    if(!SPIFFS.begin(true)) {\n        logOutput(\"ERROR ! SPIFFS file system was not mounted. Reformatting !\");\n    }\n\n    WiFi.begin(ssid, password);\n    delay(1000);\n    int k = 0;\n    while(WiFi.status() != WL_CONNECTED &amp;&amp; k&lt;20) {\n        delay(1000);\n        k++;\n        logOutput(\"Connecting to WiFi\");\n    }\n    if(WiFi.status() == WL_CONNECTED) {\n        logOutput((String)\"Connected to: \" + ssid + \" with IP: \" + WiFi.localIP().toString());\n    } else {\n        logOutput(\"Couldn't connect to WiFi ! Restarting in 5 seconds\");\n        delay(5000);\n        ESP.restart();\n    }\n\n    server.on(\"/logs\", HTTP_GET, [](AsyncWebServerRequest* request){\n        request-&gt;send(SPIFFS, \"/events.html\", \"text/html\", false, processor);\n    });\n    server.on(\"/master.css\", HTTP_GET, [](AsyncWebServerRequest *request) {\n        request-&gt;send(SPIFFS, \"/master.css\", \"text/css\");\n    }); \n    server.on(\"/back-image.jpg\", HTTP_GET, [](AsyncWebServerRequest *request) {\n        request-&gt;send(SPIFFS, \"/back-image.jpg\", \"image/jpeg\");\n    });\n    server.on(\"/logo.png\", HTTP_GET, [](AsyncWebServerRequest *request) {\n        request-&gt;send(SPIFFS, \"/logo.png\", \"image/png\");\n    });\n\n    server.begin();\n    delay(5000);\n\n    logOutput(\"After server.begin()\");\n    for(int i = 1; i&lt;=10;i++){\n        logOutput((String)\"Linia \" + i);\n    }\n}\n\nvoid loop() {\n    logOutput(\"Beginning the loop()\");\n    logOutput(\"\\n\");\n    delay(10000);\n}\n</code></pre>\n"}, {"tags": ["c++", "hashtable", "c++17"], "comments": [{"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1553098025, "post_id": 55265221, "comment_id": 97261957, "body": "What exactly are you trying to <i>do</i> with this hash table that you <i>need</i> a 20-byte hash code?"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 1, "creation_date": 1553098203, "post_id": 55265221, "comment_id": 97262064, "body": "Please provide code, not just an error message. <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> are usually most helpful."}, {"owner": {"reputation": 408, "user_id": 398091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2788e8d7b2362a869fd4e73868157c6?s=128&d=identicon&r=PG", "display_name": "ppetraki", "link": "https://stackoverflow.com/users/398091/ppetraki"}, "reply_to_user": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1553098267, "post_id": 55265221, "comment_id": 97262098, "body": "@Xirema It&#39;s a data storage array, the LRU would manage the read cache."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1553098289, "post_id": 55265221, "comment_id": 97262119, "body": "I see some openSSL features, which are C level and this is probably source of your problems. Also hash in a map is completely different thing then hash used in security!"}, {"owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1553098418, "post_id": 55265221, "comment_id": 97262228, "body": "I think you misunderstand the purpose of the hash for <code>std::unordered_map</code>. It&#39;s only used to assign a bucket, the algorithm is designed to handle multiple keys mapping to the same bucket."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1553098589, "post_id": 55265221, "comment_id": 97262336, "body": "<i>&quot;it always returns size_t&quot;</i> - by-design. 20.9.3 [unord.hash] defines the behavior of <code>std::hash</code>, requiring 17.6.3.4 [hash.requirements], and how the unordered containers utilize it. If you want a different behavior; you need a different container and a different hashing ideology. It almost sounds like you want the behavior of a radix tree (which could work, but not something the std lib is going ot give you for free). Personally I&#39;d let <code>unordered_map</code> deal with the collisions for you and just write a <code>std::hash</code> specialization for your key type, following the rules of <code>std::hash</code>."}, {"owner": {"reputation": 408, "user_id": 398091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2788e8d7b2362a869fd4e73868157c6?s=128&d=identicon&r=PG", "display_name": "ppetraki", "link": "https://stackoverflow.com/users/398091/ppetraki"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1553098933, "post_id": 55265221, "comment_id": 97262562, "body": "@MarekR It&#39;s just a veneer over openssl, or any hash engine. The class just takes data and calls static &quot;engine&quot; methods to obtain the digest. So with with one base class and a static class I can declare a digest like so, using sha1 = basic_digest&lt;20, openssl_sha1_digest_engine_policy&gt;; specialize less_than and move on. Makes it really easy to try out different crypto engines system wide."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1553099179, "post_id": 55265221, "comment_id": 97262729, "body": "@ppetraki just edit question to provide code you have problem with. After that guessing what you need and what is your problem will end."}, {"owner": {"reputation": 13563, "user_id": 992490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac727873c5724326c84ed245faa9fe6c?s=128&d=identicon&r=PG", "display_name": "Marshall Clow", "link": "https://stackoverflow.com/users/992490/marshall-clow"}, "edited": false, "score": 0, "creation_date": 1553100811, "post_id": 55265221, "comment_id": 97263699, "body": "Why not use <code>std::map&lt;sha1, data&gt;</code> instead of <code>unordered_map</code>? You don&#39;t need a hash then (but you will need a &quot;less than&quot; operator on the sha1)"}, {"owner": {"reputation": 408, "user_id": 398091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2788e8d7b2362a869fd4e73868157c6?s=128&d=identicon&r=PG", "display_name": "ppetraki", "link": "https://stackoverflow.com/users/398091/ppetraki"}, "reply_to_user": {"reputation": 13563, "user_id": 992490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac727873c5724326c84ed245faa9fe6c?s=128&d=identicon&r=PG", "display_name": "Marshall Clow", "link": "https://stackoverflow.com/users/992490/marshall-clow"}, "edited": false, "score": 0, "creation_date": 1553101315, "post_id": 55265221, "comment_id": 97264003, "body": "@MarshallClow I think you&#39;re right. I reached for the shiny new thing first :). I just want fast look ups. If it turns out that it&#39;s not fast enough I can try the solution yakk-adam-nevraumont proposed. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 4, "last_activity_date": 1553102545, "last_edit_date": 1553102545, "creation_date": 1553099049, "answer_id": 55265627, "question_id": 55265221, "link": "https://stackoverflow.com/questions/55265221/how-to-specialize-stdhash-call-operator-for-return-types-other-than-size-t/55265627#55265627", "title": "how to specialize std::hash call operator for return types other than size_t?", "body": "<p>Unordered map does not assume the hashes (the <code>size_t</code>s) are unique.  It assumes keys are.  And it performs well if the hashes are <em>good</em>.</p>\n\n<p>Unordered map uses the <code>size_t</code> to determine which bucket to put the data into.  It handles collisions in the <code>size_t</code> space fine.</p>\n\n<p>Map your sha hash to a <code>size_t</code> however you want, and use the sha hash as your key.  In the unlikely event you get a <code>size_t</code> hashing collision (50/50 when you have roughly 4 billion elements in the unordered map, assuming good hashing - see \"birthday paradox \" for the math, or more often with smaller hash tables; it dynamically grows the table) it will fall back on equality of your sha hash keys to avoid \"real\" collisions.</p>\n\n<p>There are multiple kinds of collisions.</p>\n\n<ul>\n<li>Sha-hash collisions: bad, means same key different data.</li>\n<li>size_t hash collisions: meh, means the two elements will always be in same bucket.</li>\n<li>internal hash table collisions: common, means that at this specific size, the two elements are in the same bucket.</li>\n</ul>\n\n<p>Unless most of your data maos to the same size_t, that map being lossy is perfectly fine.  You just worry about the first kind of collision, and provide <code>==</code> on your sha-hashes.</p>\n"}], "owner": {"reputation": 408, "user_id": 398091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2788e8d7b2362a869fd4e73868157c6?s=128&d=identicon&r=PG", "display_name": "ppetraki", "link": "https://stackoverflow.com/users/398091/ppetraki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 55265627, "answer_count": 1, "score": 0, "last_activity_date": 1553102545, "creation_date": 1553097784, "last_edit_date": 1553098148, "question_id": 55265221, "link": "https://stackoverflow.com/questions/55265221/how-to-specialize-stdhash-call-operator-for-return-types-other-than-size-t", "title": "how to specialize std::hash call operator for return types other than size_t?", "body": "<p>This is the first time I've tried using <code>std::unordered_map</code>, c++17. I'm trying to build a quick <code>LRU</code> where I'm mapping <code>sha1</code> digests to blocks of data. My <code>sha1</code> object is fully comparable etc, but when I try to instantiate the map, I get this error:</p>\n\n<pre><code>/usr/include/c++/7/bits/hashtable_policy.h:87:34: error: no match for call to \u2018(const std::hash&lt;\nkbs::crypto::basic_digest&lt;20,kbs::crypto::openssl_sha1_digest_engine_policy&gt; &gt;) (const kbs::crypto::basic_digest&lt;20, kbs::crypto::openssl_sha1_digest_engine_policy&gt;&amp;)\u2019\n  noexcept(declval&lt;const _Hash&amp;&gt;()(declval&lt;const _Key&amp;&gt;()))&gt;\n</code></pre>\n\n<p>So it looks like I can specialize <code>std::hash</code> for my user defined type. But, it always returns <code>size_t</code>, which is bad, going from 20 bytes to 8 bytes kinda defeats the purpose of using sha1 for a hash_key.</p>\n\n<p>Is there a way to work around this? Alternative containers? It's a waste to have to write my own hashmap. I guess I could use std:set...</p>\n"}, {"tags": ["c++", "c++17"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553097819, "post_id": 55265172, "comment_id": 97261813, "body": "Are these member functions?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1553097821, "post_id": 55265172, "comment_id": 97261814, "body": "Since there is no way to introduce a <b>name</b> in C++ rather than writing a macro, you have to use macro on some level."}, {"owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553097897, "post_id": 55265172, "comment_id": 97261858, "body": "@NathanOliver No, I would like to have free functions to allow the very same syntax for my vector as for built in types."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1553098073, "post_id": 55265172, "comment_id": 97261988, "body": "Use <code>std::for_each(begin(vec), end(vec), fn)</code> instead?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1553098353, "post_id": 55265172, "comment_id": 97262185, "body": "Can&#39;t help with that then.  If you&#39;re willing to use a member function you can make an <code>apply</code> function and then you would just pass a lambda to it.  It would look like <a href=\"http://coliru.stacked-crooked.com/a/bf9c2a37aef69222\" rel=\"nofollow noreferrer\">this</a>"}], "answers": [{"tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": true, "score": 3, "last_activity_date": 1553103076, "creation_date": 1553103076, "answer_id": 55266913, "question_id": 55265172, "link": "https://stackoverflow.com/questions/55265172/how-to-define-several-functions-at-once-that-differ-only-by-name-without-using/55266913#55266913", "title": "How to define several functions at once that differ only by name (without using macros)?", "body": "<p>You will have to use a macro to introduce a name, but you can cut down on how long it is</p>\n\n<pre><code>constexpr auto make_op(double(*op)(double))\n{\n    return [op](MyVector x) \n    { \n        std::transform(std::begin(x), std::end(x), std::begin(x), op); \n        return x; \n    };\n}\n\n#define DEFINE(op) constexpr auto op = make_op(std::op);\n\nDEFINE(sqrt)\nDEFINE(exp)\nDEFINE(sin)\nDEFINE(cos)\n</code></pre>\n\n<p>Note that you may run into issues of redefining those symbols in <code>::</code>, so it's best to wrap this in a namespace.</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/b18ed730232838d5\" rel=\"nofollow noreferrer\">See it live!</a></p>\n"}], "owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 55266913, "answer_count": 1, "score": 1, "last_activity_date": 1553103076, "creation_date": 1553097649, "last_edit_date": 1553098166, "question_id": 55265172, "link": "https://stackoverflow.com/questions/55265172/how-to-define-several-functions-at-once-that-differ-only-by-name-without-using", "title": "How to define several functions at once that differ only by name (without using macros)?", "body": "<p>I have a simple math vector class that basically just wraps a <code>double</code> array.</p>\n\n<p>Now I want to be able to element-wise apply standard math functions on this vector. E.g. my <code>sqrt()</code> implementation looks like this:</p>\n\n<pre><code>MyVector sqrt(MyVector x) // side note: makes a copy of the input vector\n{\n    for (double&amp; d : x)\n        d = std::sqrt(d);\n    return x;\n}\n</code></pre>\n\n<p>This works fine. The issue I'm facing is, that I want my vector to be usable with basically all functions in <code>&lt;cmath&gt;</code> that have this signature: <code>double (*)(double)</code>.</p>\n\n<p>Note that the implementation of these functions would be <em>identical</em> to the one of <code>sqrt()</code>. The only difference is the function name.</p>\n\n<p>My current solution is a macro:</p>\n\n<pre><code>#define DEFINE(function) \\\nMyVector function(MyVector x) \\\n{ \\\n    for (double&amp; d : x) \\\n        d = std::function(d); \\\n    return x; \\\n}\n\nDEFINE(sqrt)\nDEFINE(exp)\nDEFINE(sin)\nDEFINE(cos)\n.\n.\n.\n</code></pre>\n\n<p>Is there any non-macro way?</p>\n\n<h2>Update</h2>\n\n<p>I want these to be free functions to allow generic template code without having to care if the type is a vector or built in.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553097453, "post_id": 55265068, "comment_id": 97261560, "body": "Voting to close as a typo.  <code>std::vector &lt; std::string &gt; vec;</code> should be <code>std::vector &lt; std::string &gt; Properties::vec;</code>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1553097505, "post_id": 55265068, "comment_id": 97261609, "body": "Above comment notwithstanding, the end goal is really unclear."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553097683, "post_id": 55265068, "comment_id": 97261733, "body": "FWIW, If you want global objects, that are scoped to a name, then use a namespace, not a class/struct."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1553097707, "post_id": 55265068, "comment_id": 97261747, "body": "These are just global variables and have the same downsides. The only difference is that these will require more typing than if they were declared in global scope."}, {"owner": {"reputation": 451, "user_id": 6950434, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/7a4ebbf0eaad72cdf9e546842ead8af3?s=128&d=identicon&r=PG&f=1", "display_name": "ark1974", "link": "https://stackoverflow.com/users/6950434/ark1974"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553097747, "post_id": 55265068, "comment_id": 97261773, "body": "@NathanOliver: namespace seems like better idea."}, {"owner": {"reputation": 451, "user_id": 6950434, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/7a4ebbf0eaad72cdf9e546842ead8af3?s=128&d=identicon&r=PG&f=1", "display_name": "ark1974", "link": "https://stackoverflow.com/users/6950434/ark1974"}, "edited": false, "score": 0, "creation_date": 1553097881, "post_id": 55265068, "comment_id": 97261846, "body": "But why this code doesn&#39;t compile?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1553098363, "post_id": 55265068, "comment_id": 97262192, "body": "Regarding downsides: it doesn&#39;t matter whether you hide your globals in a struct or in a namespace or inside a singleton \u2013 the problem is having globally shared mutable state, not the syntax that you use to access it."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1553099222, "post_id": 55265068, "comment_id": 97262762, "body": "Singleton or global variable == just different shades of bad."}], "answers": [{"comments": [{"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1553109999, "post_id": 55265372, "comment_id": 97268541, "body": "Alternatively, if you can guarantee that none of the static objects will ever be modified while a thread might be reading them (e.g. you modify them only during startup, before you spawn any threads), then they become effectively immutable, which means that threads can read them without having to do any synchronization.  (you might want to provide an accessor-API that enforces that read-only property at compile-time, though, to avoid the possibility of some programmer someday forgetting the rule and trying to modify them when he shouldn&#39;t)"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 2, "last_activity_date": 1553098715, "last_edit_date": 1553098715, "creation_date": 1553098232, "answer_id": 55265372, "question_id": 55265068, "link": "https://stackoverflow.com/questions/55265068/declare-of-global-variables-using-static-and-avoiding-singleton-pattern/55265372#55265372", "title": "Declare of global variables using Static and avoiding Singleton Pattern", "body": "<blockquote>\n  <p>why this code doesn't compile?</p>\n</blockquote>\n\n<pre><code>int Properties::roll = 1;\n    ^^^^^^^^^^^^\nstd::string Properties::name{};\n            ^^^^^^^^^^^^\nstd::vector &lt; std::string &gt;             vec;\n                            ^^^^^^^^^^^^\n</code></pre>\n\n<p>You've correctly defined the other static members, but failed to define <code>Properties::vec</code>. Instead, you defined a global <code>::vec</code>.</p>\n\n<blockquote>\n  <p>Any downside of the code?</p>\n</blockquote>\n\n<p>Potentially: Static initialisation order fiasco. Now, these static objects don't depend on each other, but if you at any point wish to add static objects that depend on these static objects (in their constructor or destructor either directly or indirectly), then your program could have undefined behaviour depending on what order the objects are initialised.</p>\n\n<p>It is best to avoid static objects when they're not necessary. Failing that, it is best to avoid dependencies between static objects, although such dependencies can sometimes be well hidden. Failing that, the way with least propensity to a fiasco is <em>initialisation on first use</em> idiom. Which is to simply use a local static instead of a namespace static or a static member:</p>\n\n<pre><code>struct Properties {\n    int roll;\n    std::string name;\n    std::vector&lt;std::string&gt; vec;\n};\n\nProperties&amp; static_properties() {\n    static Properties prop;\n    return prop;\n}\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>Can it be used in multithreaded environment ?</p>\n</blockquote>\n\n<p>None of your static objects are atomic, so you would need some form of synchronisation between threads that modify the objects, and all other threads that access the objects.</p>\n\n<p>Provided that you take care of synchronisation, and don't make assumptions about their state: Sure.</p>\n"}], "owner": {"reputation": 451, "user_id": 6950434, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/7a4ebbf0eaad72cdf9e546842ead8af3?s=128&d=identicon&r=PG&f=1", "display_name": "ark1974", "link": "https://stackoverflow.com/users/6950434/ark1974"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 55265372, "answer_count": 1, "score": 1, "last_activity_date": 1553098715, "creation_date": 1553097338, "last_edit_date": 1553097623, "question_id": 55265068, "link": "https://stackoverflow.com/questions/55265068/declare-of-global-variables-using-static-and-avoiding-singleton-pattern", "title": "Declare of global variables using Static and avoiding Singleton Pattern", "body": "<p>I want to declare global variables , avoiding Singleton Pattern, using static variables like so, without encapsulation. The end goal is to be able to access the variables from any functions/objects like a global variable. The code can't compile at vec.pushback under main(), need help here. Any downside of the code? Can it be used in multithreaded environment ? Thanks.</p>\n\n<pre><code>struct Properties {\n    static int roll;\n    static std::string name;\n    static std::vector&lt;std::string&gt; vec;\n};\n\nint Properties::roll = 1;\nstd::string Properties::name{};\nstd::vector &lt; std::string &gt; vec;\n\nint main()\n{\n    Properties::roll = 1;\n    Properties::name = \"Jack\";\n    Properties::vec.push_back(\"Hellooooo\"); // unresolved external symbol \"public: static class \n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "biginteger"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1553097091, "post_id": 55264906, "comment_id": 97261301, "body": "I&#39;m guessing <code>CTOI</code> is &quot;Char TO Int&quot; and <code>ITOC</code> is &quot;Int To Char&quot;. What does <code>creDec</code> do?"}, {"owner": {"reputation": 55, "user_id": 9577268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCKN1.jpg?s=128&g=1", "display_name": "F.Wu", "link": "https://stackoverflow.com/users/9577268/f-wu"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1553097212, "post_id": 55264906, "comment_id": 97261396, "body": "My bad. The creDec is to create two numbers a and b -&gt; a*10 +b. I updated all the functions."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 9577268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCKN1.jpg?s=128&g=1", "display_name": "F.Wu", "link": "https://stackoverflow.com/users/9577268/f-wu"}, "edited": false, "score": 0, "creation_date": 1553176723, "post_id": 55265696, "comment_id": 97294029, "body": "@R Sahu thanks for your answer. But i have a question that Why do you use auto type instead of int and push_back() instead of += operator?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 55, "user_id": 9577268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCKN1.jpg?s=128&g=1", "display_name": "F.Wu", "link": "https://stackoverflow.com/users/9577268/f-wu"}, "edited": false, "score": 1, "creation_date": 1553186765, "post_id": 55265696, "comment_id": 97300567, "body": "@F.Wu, using iterators to iterate over containers and container-like objects is more idiomatic than using an index and the array operator. It&#39;s better still to use a range-<code>for</code> loop. <code>push_back()</code> and <code>+=</code> are equivalent. You can use either."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 1, "last_activity_date": 1553186909, "last_edit_date": 1553186909, "creation_date": 1553099245, "answer_id": 55265696, "question_id": 55264906, "link": "https://stackoverflow.com/questions/55264906/dividing-bigint-presented-in-string-to-2/55265696#55265696", "title": "Dividing bigint presented in string to 2", "body": "<p>You seem to have added a lot of unnecessary complexity to the function. Here's a simplified function that works for me with my test cases.</p>\n\n<pre><code>string divide2(string str)\n{\n   string ret;  // Object to be returned.\n   int rem = 0; // Keep track of remainders.\n\n   // Iterate over the characters of the input string.\n   auto iter = str.begin();\n   auto end = str.end();\n   for ( ; iter != end; ++iter )\n   {\n      int n1 = CTOI(*iter);     // The number from the string.\n      int n2 = creDec(rem, n1); // The number after we account for the remainder.\n      int n3 = n2/2;            // Result of the division.\n      rem = n2%2;               // Remainder of the division.\n\n      if ( ret.empty() &amp;&amp; n3 == 0 )\n      {\n         // Do nothing. There is no need to addd leading zeros to ret.\n      }\n      else\n      {\n         // Add the character corresponding to n3 to ret.\n         ret.push_back(ITOC(n3));\n      }\n   }\n\n   // If the return value is an empty string, return \"0\".\n   if ( ret.empty() )\n   {\n      return \"0\";\n   }\n   else\n   {\n      return ret;\n   }\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/GPcyyx\" rel=\"nofollow noreferrer\">Working example</a>.</p>\n\n<p>It's better still to use a range-<code>for</code> loop to iterate over the characters of the string.</p>\n\n<pre><code>   for ( char ch : str )\n   {\n      int n1 = CTOI(ch);     // The number from the string.\n\n       ...\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 9577268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCKN1.jpg?s=128&g=1", "display_name": "F.Wu", "link": "https://stackoverflow.com/users/9577268/f-wu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 55265696, "answer_count": 1, "score": 0, "last_activity_date": 1553186909, "creation_date": 1553096894, "last_edit_date": 1553097242, "question_id": 55264906, "link": "https://stackoverflow.com/questions/55264906/dividing-bigint-presented-in-string-to-2", "title": "Dividing bigint presented in string to 2", "body": "<p>I am writting an function that divides a Big Int (128 bit) number presented in String by 2.\nEx: 8113 is  a string =\"8113\"\nI know my function errors in the case du != 0. When i fix the code for an input, other input make errors.\nPlease give me some advice for my solution. If my algorithm is so bad, tell me the better then i can change my function in another way.</p>\n\n<pre><code>int CTOI(char a)\n{\n    return a - 48;\n}\n\nchar ITOC(int a)\n{\n    if (a == 0)\n        return '0';\n    return a + '0';\n}\n\nint creDec(int a, int b)\n{\n    return (a * 10) + b;\n}\n\nstring divide2(string str)\n{\n    string temp = str, t2;\n    int du, kq;\n    du = CTOI(temp[0]);\n    if (du == 1) {\n        temp.erase(0, 1);\n        while (temp[0] != 0)\n        {\n            du = creDec(du, CTOI(temp[0]));\n            if (du == 1)\n            {\n                temp.erase(0, 1);\n            }\n            else\n                temp.erase(0, 1);\n            kq = du / 2;\n            t2 += ITOC(kq);\n            du = du - kq * 2;\n        }\n    }\n    else\n    {\n        while (temp[0] != 0)\n        {\n            if (du == 1)\n            {\n                temp.erase(0, 1);\n                du = creDec(du, CTOI(temp[0]));\n            }\n            kq = du / 2;\n            t2 += ITOC(kq);\n            du = du - kq * 2;\n            temp.erase(0, 1);\n            du = creDec(du, CTOI(temp[0]));\n        }\n\n    }\n    return t2;\n}\n</code></pre>\n"}, {"tags": ["c++", "foreach", "stl"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 5, "creation_date": 1553096946, "post_id": 55264900, "comment_id": 97261172, "body": "Please <b><a href=\"https://stackoverflow.com/posts/55264900/edit\">edit</a></b> your question with an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> or <a href=\"http://sscce.org\" rel=\"nofollow noreferrer\">SSCCE (Short, Self Contained, Correct Example)</a>"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1553097537, "post_id": 55264900, "comment_id": 97261632, "body": "You&#39;re trying to push a concrete object into a vector of pointers. <code>characterObject.getLevel()</code> clearly indicates <code>characterObject</code> is an object; not a pointer. Your vector object type is <code>_Ty=CharacterObject *</code>, which is a pointer type. They&#39;re not the same."}, {"owner": {"reputation": 1, "user_id": 10162208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c2f7c00439905c4e2f04a7f9149d9ff?s=128&d=identicon&r=PG&f=1", "display_name": "phil123456", "link": "https://stackoverflow.com/users/10162208/phil123456"}, "edited": false, "score": 0, "creation_date": 1553097573, "post_id": 55264900, "comment_id": 97261654, "body": "ok if you take it like this, I&#39;ll use regular good old for(..."}, {"owner": {"reputation": 1, "user_id": 10162208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c2f7c00439905c4e2f04a7f9149d9ff?s=128&d=identicon&r=PG&f=1", "display_name": "phil123456", "link": "https://stackoverflow.com/users/10162208/phil123456"}, "edited": false, "score": 0, "creation_date": 1553097597, "post_id": 55264900, "comment_id": 97261671, "body": "I tried pushing &amp;characterObject did not work"}, {"owner": {"reputation": 1, "user_id": 10162208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c2f7c00439905c4e2f04a7f9149d9ff?s=128&d=identicon&r=PG&f=1", "display_name": "phil123456", "link": "https://stackoverflow.com/users/10162208/phil123456"}, "edited": false, "score": 0, "creation_date": 1553097789, "post_id": 55264900, "comment_id": 97261800, "body": "dude I tried to push_back the pointer of the object, it does not work, hence the question"}, {"owner": {"reputation": 1, "user_id": 10162208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c2f7c00439905c4e2f04a7f9149d9ff?s=128&d=identicon&r=PG&f=1", "display_name": "phil123456", "link": "https://stackoverflow.com/users/10162208/phil123456"}, "edited": false, "score": 0, "creation_date": 1553097934, "post_id": 55264900, "comment_id": 97261881, "body": "nevermind , I&#39;ll use for(...thanks"}, {"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 0, "creation_date": 1553098038, "post_id": 55264900, "comment_id": 97261962, "body": "In the current example, you&#39;re capturing <code>stuffs</code> by value i.e. you&#39;re duplicating the variable and pushing back to <i>that</i> instead of pushing back to the original, uncopied version of <code>stuffs</code>.  (Also, I&#39;m kinda just assuming that you meant to capture <code>stuffs</code> and not <code>stuff</code>.)"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 2, "creation_date": 1553098268, "post_id": 55264900, "comment_id": 97262101, "body": "@phil123456 1) Please provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. You are trying to capture non-existing variable <code>stuff</code>, while not capturing <code>stuffs</code>, to which you are trying to <code>push_back</code>. 2) <code>for (std::vector&lt; CharacterObject* &gt;::iterator it = spawnedCharactersObjects.begin(); it != spawnedCharactersObjects.end(); ++it)</code> can be changed to <code>for (auto&amp; elem : spawnedCharactersObjects)</code>."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1553098596, "post_id": 55264900, "comment_id": 97262350, "body": "call it bad faith if you like, but we cannot help you when the code you post is not the code that produces the error you are trying to fix, thats why you were kindly asked to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "is_accepted": false, "score": 1, "last_activity_date": 1553099363, "last_edit_date": 1553099363, "creation_date": 1553098703, "answer_id": 55265537, "question_id": 55264900, "link": "https://stackoverflow.com/questions/55264900/c-stdvector-foreach-no-instance-of-overloaded-function/55265537#55265537", "title": "C++ - std::vector foreach - no instance of overloaded function", "body": "<p>This is how it would be done correct</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n\nclass Stuff\n{\n};  \n\nint main() {\n    std::vector&lt; Stuff* &gt; list;\n    list.push_back(new Stuff());\n    list.push_back(new Stuff());\n    list.push_back(new Stuff());\n\n    std::vector&lt; Stuff* &gt; stuffs;\n\n    std::for_each(list.begin(), list.end(), [&amp;stuffs] (Stuff *stuff) {\n        stuffs.push_back(stuff);\n    });\n    return 0;\n}\n</code></pre>\n\n<p><code>std::for_each</code> is a template function of kind</p>\n\n<pre><code>std::for_each(Container&lt;Type&gt;::iterator, Container&lt;Type&gt;::iterator, void(Type))\n</code></pre>\n\n<p>(That's not correct but it shows the relation between the iterator and the unary function).\n It expects as third parameter a function with one parameter of type <code>Stuff *</code> since <code>list</code> is a container containing elements of that type. Both types have to be same. Also you have to capture <code>stuffs</code> as reference if you want to change it.</p>\n"}], "owner": {"reputation": 1, "user_id": 10162208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c2f7c00439905c4e2f04a7f9149d9ff?s=128&d=identicon&r=PG&f=1", "display_name": "phil123456", "link": "https://stackoverflow.com/users/10162208/phil123456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "answer_count": 1, "score": -7, "last_activity_date": 1553099363, "creation_date": 1553096886, "last_edit_date": 1553098107, "question_id": 55264900, "link": "https://stackoverflow.com/questions/55264900/c-stdvector-foreach-no-instance-of-overloaded-function", "title": "C++ - std::vector foreach - no instance of overloaded function", "body": "<p>I can't figure this one; I recently started to use <code>std::for_each</code> but this one is a pain to solve</p>\n\n<p>I keep receiving an error for the code below :</p>\n\n<pre><code>**no instance of overloaded function \"std::vector&lt;_Ty, _Alloc&gt;::push_back [with _Ty=CharacterObject *, _Alloc=std::allocator&lt;CharacterObject *&gt;]\" matches the argument list**\n</code></pre>\n\n<p>code:</p>\n\n<pre><code>class Stuff\n{\n};  \n\nstd::vector&lt; Stuff* &gt; list;\nlist.push_back(new Stuff());\nlist.push_back(new Stuff());\nlist.push_back(new Stuff());\n\nstd::vector&lt; Stuff* &gt; stuffs;\n\nstd::for_each(list.begin(), list.end(), [this,level, stuff](Stuff &amp;stuff) \n{\n    ... // some conditions here\n    stuffs.push_back(stuff);  &lt;&lt; error\n    stuffs.push_back(&amp;stuff);  &lt;&lt; also throws an error\n});\n</code></pre>\n\n<p>I tried many different combinations, but it's hard to figure anything with STL template errors</p>\n\n<p>Any help greatly appreciated of course</p>\n\n<p>sheers</p>\n\n<p>[edit: there, works like acharm and no need for bad faith I consider extremely obnoxious]</p>\n\n<pre><code>for (std::vector&lt; CharacterObject* &gt;::iterator it = spawnedCharactersObjects.begin(); it != spawnedCharactersObjects.end(); ++it)\n{\n    CharacterObject* characterObject = *it;\n    if (characterObject-&gt;getLevel() == level)\n    {\n        characterObjects.push_back(characterObject);\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "opengl", "graphics", "glsl", "shader"], "comments": [{"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 1, "creation_date": 1553096856, "post_id": 55264611, "comment_id": 97261120, "body": "&quot;my drivers (mesa) don&#39;t allow me to use versions above GLSL 1.30 or ES 3.20.&quot;  They most likely do, you have to request a versioned Core context though."}, {"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 2, "creation_date": 1553097013, "post_id": 55264611, "comment_id": 97261237, "body": "And if they don&#39;t, you probably need to assign your result to <code>gl_FragColor</code> instead of your custom <code>out outputF</code> variable."}, {"owner": {"reputation": 453, "user_id": 1644736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b62c1b613a3f8d4d5985d83c169b498?s=128&d=identicon&r=PG", "display_name": "dmoody256", "link": "https://stackoverflow.com/users/1644736/dmoody256"}, "reply_to_user": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1553097624, "post_id": 55264611, "comment_id": 97261695, "body": "@NicoSchertler The GLSL 1.3 doc says it added user defined outs for the fragment processor even though I think that might fix the issue: <a href=\"https://www.khronos.org/registry/OpenGL/specs/gl/GLSLangSpec.1.30.pdf\" rel=\"nofollow noreferrer\">khronos.org/registry/OpenGL/specs/gl/GLSLangSpec.1.30.pdf</a>"}, {"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "reply_to_user": {"reputation": 453, "user_id": 1644736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b62c1b613a3f8d4d5985d83c169b498?s=128&d=identicon&r=PG", "display_name": "dmoody256", "link": "https://stackoverflow.com/users/1644736/dmoody256"}, "edited": false, "score": 0, "creation_date": 1553097677, "post_id": 55264611, "comment_id": 97261728, "body": "@dmoody256 Ah, ok. I was trying to find when this was introduced."}, {"owner": {"reputation": 19, "user_id": 11160704, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ukglErAiodI/AAAAAAAAAAI/AAAAAAAAAGY/43KYkM6h9cg/photo.jpg?sz=128", "display_name": "PrograMed IP", "link": "https://stackoverflow.com/users/11160704/programed-ip"}, "reply_to_user": {"reputation": 453, "user_id": 1644736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b62c1b613a3f8d4d5985d83c169b498?s=128&d=identicon&r=PG", "display_name": "dmoody256", "link": "https://stackoverflow.com/users/1644736/dmoody256"}, "edited": false, "score": 0, "creation_date": 1553098115, "post_id": 55264611, "comment_id": 97262014, "body": "@dmoody256 In which section is this explained ? Because I don&#39;t really understand what you mean by <i>user defined outs</i>..."}, {"owner": {"reputation": 453, "user_id": 1644736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b62c1b613a3f8d4d5985d83c169b498?s=128&d=identicon&r=PG", "display_name": "dmoody256", "link": "https://stackoverflow.com/users/1644736/dmoody256"}, "edited": false, "score": 0, "creation_date": 1553098477, "post_id": 55264611, "comment_id": 97262267, "body": "@PrograMedIP near the bottom of page 4, it says <code>Added user-defined fragment shader outputs.</code>. It&#39;s also referenced in other various places through the document."}, {"owner": {"reputation": 19, "user_id": 11160704, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ukglErAiodI/AAAAAAAAAAI/AAAAAAAAAGY/43KYkM6h9cg/photo.jpg?sz=128", "display_name": "PrograMed IP", "link": "https://stackoverflow.com/users/11160704/programed-ip"}, "reply_to_user": {"reputation": 453, "user_id": 1644736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b62c1b613a3f8d4d5985d83c169b498?s=128&d=identicon&r=PG", "display_name": "dmoody256", "link": "https://stackoverflow.com/users/1644736/dmoody256"}, "edited": false, "score": 0, "creation_date": 1553113750, "post_id": 55264611, "comment_id": 97270396, "body": "@dmoody256 But I still can&#39;t find how to fix the issue..."}, {"owner": {"reputation": 453, "user_id": 1644736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b62c1b613a3f8d4d5985d83c169b498?s=128&d=identicon&r=PG", "display_name": "dmoody256", "link": "https://stackoverflow.com/users/1644736/dmoody256"}, "edited": false, "score": 0, "creation_date": 1553114431, "post_id": 55264611, "comment_id": 97270745, "body": "@PrograMedIP yeah I reproduced the issue with your example on Ubuntu 14, but that was in a virtual box VM so I don&#39;t know for sure if the virtual box was causing issues or the mesa drivers themselves. Possibly mesa drivers are not supporting this, but that seems like a pretty basic thing to be missing. Btw can you add what color you saw on your triangle? I saw white triangle with cpu rendering enabled, and black triangle with Virtual Box hardware pass through options. Have you tested on different driver to make sure your code is working as expected in a different environment?"}, {"owner": {"reputation": 19, "user_id": 11160704, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ukglErAiodI/AAAAAAAAAAI/AAAAAAAAAGY/43KYkM6h9cg/photo.jpg?sz=128", "display_name": "PrograMed IP", "link": "https://stackoverflow.com/users/11160704/programed-ip"}, "reply_to_user": {"reputation": 453, "user_id": 1644736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b62c1b613a3f8d4d5985d83c169b498?s=128&d=identicon&r=PG", "display_name": "dmoody256", "link": "https://stackoverflow.com/users/1644736/dmoody256"}, "edited": false, "score": 0, "creation_date": 1553170537, "post_id": 55264611, "comment_id": 97290125, "body": "@dmoody256 It&#39;s rendering a white triangle, and I didn&#39;t test it yet on other drivers; the AMD GPU drivers don&#39;t want to work on my Kali system, and I didn&#39;t test it yet on my Windows, but I&#39;m pretty sure that the OpenGL version there is the latest, so I won&#39;t have to use old versions of OpenGL."}], "answers": [{"tags": [], "owner": {"reputation": 453, "user_id": 1644736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b62c1b613a3f8d4d5985d83c169b498?s=128&d=identicon&r=PG", "display_name": "dmoody256", "link": "https://stackoverflow.com/users/1644736/dmoody256"}, "is_accepted": true, "score": 1, "last_activity_date": 1553394403, "creation_date": 1553394403, "answer_id": 55320222, "question_id": 55264611, "link": "https://stackoverflow.com/questions/55264611/colors-set-in-fragment-shader-not-showing-glsl-1-30/55320222#55320222", "title": "Colors set in fragment shader not showing GLSL 1.30", "body": "<p>I got some time to look at this and found that you had a small copy paste error:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>unsigned int CreateShader(std::string&amp; vertexShader, std::string&amp; fragmentShader) {\n    unsigned int program = glCreateProgram();\n    unsigned int vs = CompileShader(GL_VERTEX_SHADER, vertexShader);\n    unsigned int fs = CompileShader(GL_FRAGMENT_SHADER, fragmentShader);\n\n    glAttachShader(program, vs);\n    glAttachShader(program, vs); //&lt;--should be fs\n</code></pre>\n\n<p>You are attaching the vertex shader twice. This will set an OpenGL error and actually the way I found it is with a OpenGL debugging method I usually use. When I went to test your code more in depth, I surrounded all OpenGL calls with a define which stops execution if OpenGL sets an error. I put this at the top of the source and recommend using this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;cstdlib&gt;\n#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n\nvoid CheckOpenGLError(const char *stmt, const char *fname, int line);\n#define GL_CHECK(stmt)                               \\\n    do                                               \\\n    {                                                \\\n        stmt;                                        \\\n        CheckOpenGLError(#stmt, __FILE__, __LINE__); \\\n    } while (0)\n\nvoid CheckOpenGLError(const char *stmt, const char *fname, int line)\n{\n    GLenum err = glGetError();\n    if (err != GL_NO_ERROR)\n    {\n        std::cout &lt;&lt; \"OpenGL error 0x\" &lt;&lt; std::setfill('0') &lt;&lt; std::setw(8) &lt;&lt; std::hex &lt;&lt; err &lt;&lt; std::dec &lt;&lt; \": \" &lt;&lt; gluErrorString(err) &lt;&lt; \", at \" &lt;&lt; fname &lt;&lt; \":\" &lt;&lt; line &lt;&lt; \" - for \" &lt;&lt; stmt &lt;&lt; std::endl;\n        abort();\n    }\n}\n</code></pre>\n\n<p>You will need to additionally link in the glu library (glu32.lib on windows or libGLU.so on linux) for the gluErrorString function if you want the OpenGL error to print out in a human readable form, otherwise you need to go look up the error code. In this case I surrounded your calls like this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>unsigned int CreateShader(std::string&amp; vertexShader, std::string&amp; fragmentShader) {\n    unsigned int program = glCreateProgram();\n    unsigned int vs = CompileShader(GL_VERTEX_SHADER, vertexShader);\n    unsigned int fs = CompileShader(GL_FRAGMENT_SHADER, fragmentShader);\n\n    GL_CHECK(glAttachShader(program, vs));\n    GL_CHECK(glAttachShader(program, vs)); //&lt;--should be fs\n</code></pre>\n\n<p>Which then threw this error when I ran the code:</p>\n\n<pre><code>OpenGL error 0x00000502: invalid operation, at main.cpp:147 - for glAttachShader(program, vs)\n</code></pre>\n\n<hr>\n\n<p>Also a minor note, you should probably detach the shaders after you are done linking:</p>\n\n<p><a href=\"https://gamedev.stackexchange.com/a/47912\">https://gamedev.stackexchange.com/a/47912</a></p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>unsigned int CreateShader(std::string&amp; vertexShader, std::string&amp; fragmentShader) {\n    unsigned int program = glCreateProgram();\n    unsigned int vs = CompileShader(GL_VERTEX_SHADER, vertexShader);\n    unsigned int fs = CompileShader(GL_FRAGMENT_SHADER, fragmentShader);\n\n    glAttachShader(program, vs);\n    glAttachShader(program, fs);\n\n    glLinkProgram(program);\n    glValidateProgram(program);\n\n    glDetachShader(program, vs);\n    glDetachShader(program, fs);\n\n    glDeleteShader(vs);\n    glDeleteShader(fs);\n\n    return program;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11160704, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ukglErAiodI/AAAAAAAAAAI/AAAAAAAAAGY/43KYkM6h9cg/photo.jpg?sz=128", "display_name": "PrograMed IP", "link": "https://stackoverflow.com/users/11160704/programed-ip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 55320222, "answer_count": 1, "score": 1, "last_activity_date": 1553394403, "creation_date": 1553096106, "last_edit_date": 1553096901, "question_id": 55264611, "link": "https://stackoverflow.com/questions/55264611/colors-set-in-fragment-shader-not-showing-glsl-1-30", "title": "Colors set in fragment shader not showing GLSL 1.30", "body": "<p>I'm learning OpenGL, and I just saw how to write shaders. But the first problem was that, in the course, GLSL 3.30+ was supported (OpenGL 4), but my drivers (mesa) don't allow me to use versions above GLSL 1.30 or ES 3.20. So I changed the <code>#version</code> preprocessor in the shaders, and I continued. But, unfortunately, when I tried to use colors, it didn't work. </p>\n\n<p>This is my code :</p>\n\n<pre><code>#include \"colors.h\"\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;regex&gt;\n#include &lt;GL/glew.h&gt;\n#include &lt;GLFW/glfw3.h&gt;\n\nunsigned int CompileShader(unsigned int type, std::string&amp; source);\nunsigned int CreateShader(std::string&amp; vertexShader, std::string&amp; fragmentShader);\n\nint main(int argc, char* argv[]) {\n    GLFWwindow* window;\n\n    /* Initialize the library */\n    if (!glfwInit()) {\n        std::cerr &lt;&lt; \"Couldn't initialize GLFW\" &lt;&lt; std::endl;\n        exit(1);\n    }\n\n    /* Create a windowed mode window and its OpenGL context */\n    window = glfwCreateWindow(640, 480, \"Hello World\", nullptr, nullptr);\n    if (!window)\n    {\n        glfwTerminate();\n        return -1;\n    }\n\n    /* Make the window's context current */\n    glfwMakeContextCurrent(window);\n\n    if(glewInit() != GLEW_OK) {\n        std::cerr &lt;&lt; \"Couldn't initialize GLEW\" &lt;&lt; std::endl;\n        exit(1);\n    }\n\n    float positions[6] = {\n        -0.5f, -0.5f,\n        0.0f, 0.5f,\n        0.5f, -0.5f\n    };\n    unsigned int buffer;\n\n    glGenBuffers(1, &amp;buffer);\n    glBindBuffer(GL_ARRAY_BUFFER, buffer);\n    glBufferData(GL_ARRAY_BUFFER, 6 * sizeof(float), positions, GL_STATIC_DRAW);\n\n    glEnableVertexAttribArray(0);\n    glVertexAttribPointer(0, 2, GL_FLOAT, GL_FALSE, 2 * sizeof(float), 0);\n\n    // Compiling Shader\n    std::string vertexShader = \"#version 130\\n\"\n                               \"\\n\"\n                               \"in vec4 position;\\n\"\n                               \"\\n\"\n                               \"void main () {\\n\"\n                               \"    gl_Position = position;\\n\"\n                               \"}\";\n    std::string fragmentShader = \"#version 130\\n\"\n                                 \"\\n\"\n                                 \"uniform vec4 color = vec4(1.0, 0.0, 0.0, 1.0);\\n\"\n                                 \"\\n\"\n                                 \"out vec4 outputF;\\n\"\n                                 \"\\n\"\n                                 \"void main () {\\n\"\n                                 \"    outputF = color;\\n\"\n                                 \"}\";\n\n    unsigned int shader = CreateShader(vertexShader, fragmentShader);\n\n    glUseProgram(shader);\n\n    /* Loop until the user closes the window */\n    while (!glfwWindowShouldClose(window))\n    {\n        /* Render here */\n        glClear(GL_COLOR_BUFFER_BIT);\n\n        glDrawArrays(GL_TRIANGLES, 0, 3);\n\n        /* Swap front and back buffers */\n        glfwSwapBuffers(window);\n\n        /* Poll for and process events */\n        glfwPollEvents();\n    }\n\n    glfwTerminate();\n    return 0;\n}\n\nunsigned int CompileShader(unsigned int type, std::string&amp; source) {\n    unsigned int id = glCreateShader(type);\n    const char* src = source.c_str();\n\n    glShaderSource(id, 1, &amp;src, nullptr);\n    glCompileShader(id);\n\n    int result;\n    glGetShaderiv(id, GL_COMPILE_STATUS, &amp;result);\n\n    if (result == GL_FALSE) {\n        int length;\n        glGetShaderiv(id, GL_INFO_LOG_LENGTH, &amp;length);\n\n        char* message = (char*)alloca(length * sizeof(char));\n        glGetShaderInfoLog(id, length, &amp;length, message);\n\n        std::cerr &lt;&lt; \"Failed to compile \"\n                  &lt;&lt; (type == GL_VERTEX_SHADER ? \"vertex\" : \"fragment\")\n                  &lt;&lt; \" shader. Error message:\" &lt;&lt; std::endl;\n\n        std::cerr &lt;&lt; \"\\t\" &lt;&lt; FG_ERROR &lt;&lt; message &lt;&lt; std::endl;\n    }\n\n    return id;\n}\n\nunsigned int CreateShader(std::string&amp; vertexShader, std::string&amp; fragmentShader) {\n    unsigned int program = glCreateProgram();\n    unsigned int vs = CompileShader(GL_VERTEX_SHADER, vertexShader);\n    unsigned int fs = CompileShader(GL_FRAGMENT_SHADER, fragmentShader);\n\n    glAttachShader(program, vs);\n    glAttachShader(program, vs);\n\n    glLinkProgram(program);\n    glValidateProgram(program);\n\n    glDeleteShader(vs);\n    glDeleteShader(fs);\n\n    return program;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "x86", "profiling", "intel-pin"], "answers": [{"comments": [{"owner": {"reputation": 1660, "user_id": 5501407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cz29B.jpg?s=128&g=1", "display_name": "R4444", "link": "https://stackoverflow.com/users/5501407/r4444"}, "edited": false, "score": 0, "creation_date": 1553192603, "post_id": 55285607, "comment_id": 97303603, "body": "this is perfect. Thanks so much!"}], "tags": [], "owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "is_accepted": true, "score": 1, "last_activity_date": 1553187569, "creation_date": 1553187569, "answer_id": 55285607, "question_id": 55264577, "link": "https://stackoverflow.com/questions/55264577/stack-allocation-size-using-intel-pin-tool/55285607#55285607", "title": "Stack allocation size using intel pin tool", "body": "<p>The sample pintool from <code>source/tools/SimpleExamples/oper-imm.cpp</code> shows how to get immediate operands. It looks like this:</p>\n\n<pre><code>if (INS_OperandIsImmediate(ins, i))\n{\n    // Get the value itself\n    ADDRINT value = INS_OperandImmediate(ins, i);\n\n    // Determine the size and the signedness of the immediate value.\n}\n</code></pre>\n\n<p>In your case, <code>i</code> is 1 because you need to check whether the second operand is an immediate value. You also need to check whether the first operand is an explicit <code>RSP</code> register and that the instruction is <code>ADD</code> or <code>SUB</code>. Essentially, you need to find the first such instruction.</p>\n\n<pre><code>if((INS_Opcode(ins) == XED_ICLASS_ADD || INS_Opcode(ins) == XED_ICLASS_SUB) &amp;&amp; \n   REG(INS_OperandReg(ins, 0)) == REG_STACK_PTR &amp;&amp; INS_OperandIsImmediate(ins, 1))\n{\n  // Obtain the immediate operand information as shown above.\n  // You can obtain the RSP register value before or after the instruction by\n  // passing IARG_REG_VALUE, REG_STACK_PTR to INS_Insert*.\n}\n</code></pre>\n\n<p>Some programming languages or specific implementations may allow allocating variables on the stack of dynamic sizes. For example, most C/C++ implementations offer <code>alloca</code>, which typically allocates memory from the stack. As another example, the C# language offers the <code>stackalloc</code> keyword. Therefore, the second operand is not necessarily always immediate and there can be multiple <code>ADD</code>/<code>SUB</code> instructions spread throughput the function that allocate/deallocate memory from the stack. </p>\n"}], "owner": {"reputation": 1660, "user_id": 5501407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cz29B.jpg?s=128&g=1", "display_name": "R4444", "link": "https://stackoverflow.com/users/5501407/r4444"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 55285607, "answer_count": 1, "score": 2, "last_activity_date": 1587424515, "creation_date": 1553096025, "last_edit_date": 1587424515, "question_id": 55264577, "link": "https://stackoverflow.com/questions/55264577/stack-allocation-size-using-intel-pin-tool", "title": "Stack allocation size using intel pin tool", "body": "<p>I have following c code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint foo()\n{\n  int a = 4;\n  int *p = &amp;a;\n  printf(\"%i\\n\", *p);\n  int b[10];\n  b[1] = 3;\n}\n\nint main(void)\n{\n  int a[10], b[20];\n  a[2] = 7;\n  b[7] = 9;\n  foo();\n  return 0;\n}\n</code></pre>\n\n<p>I created following PIN tool:</p>\n\n<pre><code>#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include \"pin.H\"\n\n// Additional library calls go here\n\n/*********************/\n\n// Output file object\nofstream OutFile;\n\n//static uint64_t counter = 0;\n\nuint32_t lock = 0;\nuint32_t unlock = 1;\nstd::string rtin = \"\";\n// Make this lock if you want to print from _start\nuint32_t key = unlock;\n\nvoid printmaindisas(uint64_t addr, std::string disassins)\n{\n    std::stringstream tempstream;\n    tempstream &lt;&lt; std::hex &lt;&lt; addr;\n    std::string address = tempstream.str();\n    if (key)\n        return;\n    if (addr &gt; 0x700000000000)\n        return;\n    std::cout&lt;&lt;address&lt;&lt;\"\\t\"&lt;&lt;disassins&lt;&lt;std::endl;\n}\n\nvoid mutex_lock()\n{\n\nkey = !lock;\nstd::cout&lt;&lt;\"out\\n\";\n\n}\nvoid mutex_unlock()\n{\n\n    key = lock;\n    std::cout&lt;&lt;\"in\\n\";\n\n}\n\nvoid Instruction(INS ins, VOID *v)\n{\n\n    // if (INS_IsStackWrite(ins) == true)\n    // {\n    //  std::cout &lt;&lt; \"Stack write instruction: \" &lt;&lt; INS_Disassemble(ins) &lt;&lt; '\\n';\n    // }\n  // Insert a call to docount before every instruction, no arguments are passed\n  INS_InsertCall(ins, IPOINT_BEFORE, (AFUNPTR)printmaindisas, IARG_ADDRINT, INS_Address(ins),\n  IARG_PTR, new string(INS_Disassemble(ins)), IARG_END);\n    //std::cout&lt;&lt;INS_Disassemble(ins)&lt;&lt;std::endl;\n}\n\nvoid Routine(RTN rtn, VOID *V)\n{\n    if (RTN_Name(rtn) == \"main\")\n    {\n        //std::cout&lt;&lt;\"Loading: \"&lt;&lt;RTN_Name(rtn) &lt;&lt; endl;\n        RTN_Open(rtn);\n        RTN_InsertCall(rtn, IPOINT_BEFORE, (AFUNPTR)mutex_unlock, IARG_END);\n        RTN_InsertCall(rtn, IPOINT_AFTER, (AFUNPTR)mutex_lock, IARG_END);\n        RTN_Close(rtn);\n    }\n}\n\nKNOB&lt;string&gt; KnobOutputFile(KNOB_MODE_WRITEONCE, \"pintool\", \"o\", \"mytool.out\", \"specify output file name\");\n/*\nVOID Fini(INT32 code, VOID *v)\n{\n    // Write to a file since cout and cerr maybe closed by the application\n    OutFile.setf(ios::showbase);\n    OutFile &lt;&lt; \"Count \" &lt;&lt; count &lt;&lt; endl;\n    OutFile.close();\n}\n*/\n\nint32_t Usage()\n{\n  cerr &lt;&lt; \"This is my custom tool\" &lt;&lt; endl;\n  cerr &lt;&lt; endl &lt;&lt; KNOB_BASE::StringKnobSummary() &lt;&lt; endl;\n  return -1;\n}\n\nint main(int argc, char * argv[])\n{\n  // It must be called for image instrumentation\n  // Initialize the symbol table\n  PIN_InitSymbols();\n  // Initialize pin\n    // PIN_Init must be called before PIN_StartProgram\n    // as mentioned in the documentation\n  if (PIN_Init(argc, argv)) return Usage();\n\n  // Open the output file to write\n  OutFile.open(KnobOutputFile.Value().c_str());\n\n  // Set instruction format as intel\n    // Not needed because my machine is intel\n  PIN_SetSyntaxIntel();\n\n  RTN_AddInstrumentFunction(Routine, 0);\n  //IMG_AddInstrumentFunction(Image, 0);\n\n  // Add an isntruction instrumentation\n  INS_AddInstrumentFunction(Instruction, 0);\n\n  //PIN_AddFiniFunction(Fini, 0);\n\n  // Start the program here\n  PIN_StartProgram();\n\n  return 0;\n\n}\n</code></pre>\n\n<p>It gives me following output:</p>\n\n<pre><code>in\n40051e  push rbp\n40051f  mov rbp, rsp\n400522  add rsp, 0xffffffffffffff80\n400526  mov dword ptr [rbp-0x28], 0x7\n40052d  mov dword ptr [rbp-0x64], 0x9\n400534  mov eax, 0x0\n400539  call 0x4004e6\n4004e6  push rbp\n4004e7  mov rbp, rsp\n4004ea  sub rsp, 0x40\n4004ee  mov dword ptr [rbp-0xc], 0x4\n4004f5  lea rax, ptr [rbp-0xc]\n4004f9  mov qword ptr [rbp-0x8], rax\n4004fd  mov rax, qword ptr [rbp-0x8]\n400501  mov eax, dword ptr [rax]\n400503  mov esi, eax\n400505  mov edi, 0x4005d0\n40050a  mov eax, 0x0\n40050f  call 0x4003f0\n4003f0  jmp qword ptr [rip+0x200c22]\n4003f6  push 0x0\n4003fb  jmp 0x4003e0\n4003e0  push qword ptr [rip+0x200c22]\n4003e6  jmp qword ptr [rip+0x200c24]\n4\n400514  mov dword ptr [rbp-0x3c], 0x3\n40051b  nop\n40051c  leave \n40051d  ret \n40053e  mov eax, 0x0\n400543  leave \nout\n</code></pre>\n\n<p>I want to get the value <code>0xffffffffffffff80</code> in the case of <em>main</em> function and <code>0x40</code> in case of function <em>foo</em>. In short I want to get the stack place which has been allocated, after function creation. So, one way this can be done is by detecting the particular instruction, say add/sub rsp in this case and then trimming the output to get the particular string. Another way would be by getting the value of rbp or rsp (correct me if I'm wrong here).</p>\n\n<p>I check the pin api documentation <a href=\"https://software.intel.com/sites/landingpage/pintool/docs/97619/Pin/html/modules.html\" rel=\"nofollow noreferrer\">here</a> and also saw some examples given <a href=\"https://software.intel.com/sites/landingpage/pintool/docs/97619/Pin/html/index.html#SafeCopy\" rel=\"nofollow noreferrer\">here</a>, but still couldn't find the way to get the particular string values.</p>\n\n<p>Following the documentation I tried this:</p>\n\n<pre><code>if (INS_RegR(ins, 0) == REG_RSP)\n        std::cout &lt;&lt; \"rsp: \" &lt;&lt; REG_Size(REG_RSP) &lt;&lt; '\\n';\n</code></pre>\n\n<p>But, still couldn't figure out how to get the values.</p>\n"}, {"tags": ["c++", "sql-server", "database-connection", "clr"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553095929, "post_id": 55264470, "comment_id": 97260461, "body": "There are several methods you can use in a native <code>c++</code> application to connect to a SQL server that don&#39;t use CLR. ADO is one of them. <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/ado-code-examples-in-visual-c?view=sql-server-2017\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/sql/ado/reference/ado-api/&hellip;</a>"}, {"owner": {"reputation": 29, "user_id": 11054947, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p6qi5W44IM/AAAAAAAAAAI/AAAAAAAAAHc/btgZBBCK3DU/photo.jpg?sz=128", "display_name": "Giorgi Van GoGh", "link": "https://stackoverflow.com/users/11054947/giorgi-van-gogh"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553096026, "post_id": 55264470, "comment_id": 97260525, "body": "Could you give me some links which would be helpful?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553096047, "post_id": 55264470, "comment_id": 97260546, "body": "There are many examples in the link. here is one: <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/open-and-close-methods-example-vc?view=sql-server-2017\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/sql/ado/reference/ado-api/&hellip;</a>"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553096294, "post_id": 55264470, "comment_id": 97260706, "body": "You may also be interested in this: <a href=\"https://www.codeproject.com/Articles/1075/A-set-of-ADO-classes-version-2-20\" rel=\"nofollow noreferrer\">codeproject.com/Articles/1075/A-set-of-ADO-classes-version-2&zwnj;&#8203;-20</a>"}], "owner": {"reputation": 29, "user_id": 11054947, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p6qi5W44IM/AAAAAAAAAAI/AAAAAAAAAHc/btgZBBCK3DU/photo.jpg?sz=128", "display_name": "Giorgi Van GoGh", "link": "https://stackoverflow.com/users/11054947/giorgi-van-gogh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553095729, "creation_date": 1553095729, "question_id": 55264470, "link": "https://stackoverflow.com/questions/55264470/connect-sql-server-using-c-without-clr", "title": "Connect SQL Server using C++ without /CLR", "body": "<p>I want to connect SQL Server with C++, but when i write some SqlConnection, SqlCommand and so on... it requires to change \"No Common Language Runtime Support\" to \"Common Language Runtime Support(/clr)\" from my project properties. Also it requirs to change \"Enable Minimal Rebuild - Yes(/Gm)\" to \"No (/Gm)\" and also some other stuffs to be changed. When i change i am not able to use \"thread\" in my C++ project and also debuger is not showing anything. It just shows me red arrow.</p>\n\n<p>And i wonder if there is any solution to Connect my C++ project to SQL Server without any changes from property?</p>\n"}, {"tags": ["c++", "compiler-optimization"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 5, "creation_date": 1553095044, "post_id": 55264208, "comment_id": 97259838, "body": "It might increase compile time, it has no effect on run time as it is all compiled away."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1553095252, "post_id": 55264208, "comment_id": 97259985, "body": "You should probably read about name mangling. Even if release executable files ship without debug symbols namespace names will still add up to import / export table size and will cause executable to consume more space."}, {"owner": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 3, "creation_date": 1553095256, "post_id": 55264208, "comment_id": 97259987, "body": "There is a theoretical run time cost: the mangled names are kept in the binary, and therefore are in memory at runtime. More namespace nesting = longer mangled names = more memory used = more cache misses = slower... However, I would be hugely surprised if you managed to measure this difference even with pathological nesting."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1553095656, "post_id": 55264208, "comment_id": 97260254, "body": "<code>compile-time</code> zero (in practice), <code>run-time</code> zero, <code>memory footprint</code> for dll-s almost zero (symbols have longer names), for lib/application zero (in release mode)."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 0, "creation_date": 1553095657, "post_id": 55264208, "comment_id": 97260255, "body": "@BoBTFish mangled names may be kept in binary, it is completely optional"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "reply_to_user": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 0, "creation_date": 1553096310, "post_id": 55264208, "comment_id": 97260717, "body": "@BoBTFish longer mangled names do not have impact how function is called. Only when mangled names are used this can have some impact on speed and this happens only when searching for symbols in dll-s, or system creates a crash log."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553096519, "post_id": 55264208, "comment_id": 97260871, "body": "If you created a header file that is 10 GB of namespaces being opened and closed, it would of course increase compile time - if only because the compiler has to work through 10 GB of text.  Similarly, if there was a platform where mangled symbols could be up to 10 GB in length, then your executable might take longer to run because the mangled symbol names are part of the binary (or at least a library) and thus it takes longer for the binary to be loaded from memory.  <b>But none of this really matters in the grand scheme of things.</b> C++ compilation is slow for other reasons."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553098845, "post_id": 55264208, "comment_id": 97262514, "body": "If you are concerned about compilation times in C++, you might want to look at <a href=\"https://www.reddit.com/r/cpp/comments/6gur2x/the_rule_of_chiel_aka_compiletime_cost_of/\" rel=\"nofollow noreferrer\">the rule of Chiel</a> and <a href=\"https://slides.com/onqtam/faster_builds/fullscreen#/1\" rel=\"nofollow noreferrer\">The Hitchhiker&#39;s Guide to Faster Builds</a>."}], "answers": [{"comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1553095754, "post_id": 55264438, "comment_id": 97260330, "body": "Runtime can increase where runtime type information (RTTI aka <code>typeid</code>) or debug symbols  (e.g. printing function names during stack trace) or compiler&#39;s <code>__FUNCTION__</code> macro are used."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 2, "creation_date": 1553095854, "post_id": 55264438, "comment_id": 97260412, "body": "@BenVoigt It might also increase because you expended more energy typing them out, thereby increasing the temperature of your room (and the entire universe), thereby reducing the thermal heat ceiling of your (and anyone else&#39;s) CPU. This is all pretty nonsensical if you ask me."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1553095917, "post_id": 55264438, "comment_id": 97260453, "body": "@BenVoigt Would <code>yes_ns::unique</code> be much bigger symbol than <code>no_ns_unique</code> though?"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1553095980, "post_id": 55264438, "comment_id": 97260497, "body": "@eerorika: Your own answer asserts, in the first sentence, that names are longer in the namespace version."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1553096037, "post_id": 55264438, "comment_id": 97260536, "body": "@MaxLanghof: Yes, looking at 14th-order effects is non-sensical.  That doesn&#39;t make it silly to look at second-order effects."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1553096041, "post_id": 55264438, "comment_id": 97260541, "body": "@BenVoigt yeah. But I&#39;m being snide in that part of my answer :)"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1553099077, "post_id": 55264438, "comment_id": 97262650, "body": "@BenVoigt The time for copying/printing out function name lengths is still an absolutely insignificant part of obtaining a stack trace. Similarly, all the other things you mention are only about the size of the strings that are stored in the binary somewhere. Does any real-world application really spend significant amounts of time processing results of <code>typeid</code> or the values of <code>__FUNCTION__</code> expansions? I don&#39;t believe it (and if it does, it&#39;s clearly got much bigger design problems). Without a concrete example I think it&#39;s as relevant as my entropy consideration."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 10, "last_activity_date": 1553096988, "last_edit_date": 1553096988, "creation_date": 1553095633, "answer_id": 55264438, "question_id": 55264208, "link": "https://stackoverflow.com/questions/55264208/cost-of-namespaces/55264438#55264438", "title": "Cost of namespaces", "body": "<blockquote>\n  <p>What is the cost of defining namespaces in c++?</p>\n</blockquote>\n\n<p>You have to write longer names<sup>\u2020</sup>. This cost is offset by the fact that name conflicts are avoided across different namespaces. A short name is of no use if the name has a conflict.</p>\n\n<p><sup>\u2020</sup>Not really though: A namespace lets you get off with less writing, since you don't always need to retype the namespace into unqualified identifiers.</p>\n\n<blockquote>\n  <p>By that I specifically mean compile-time</p>\n</blockquote>\n\n<p>Potentially marginally.</p>\n\n<blockquote>\n  <p>run-time increase</p>\n</blockquote>\n\n<p>None in practice.</p>\n\n<blockquote>\n  <p>Would I notice a change in these aforementioned statistics if I, say, define a namespace in my header?</p>\n</blockquote>\n\n<p>You can find out by measuring.</p>\n\n<p>You probably won't notice.</p>\n"}, {"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1553099166, "post_id": 55264574, "comment_id": 97262720, "body": "Are you sure that the lengthy linking time was caused by the namespaces though?"}, {"owner": {"reputation": 1409, "user_id": 6385640, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-muwyWfIjFd8/AAAAAAAAAAI/AAAAAAAAAG0/nctjQMOQOQY/photo.jpg?sz=128", "display_name": "Red.Wave", "link": "https://stackoverflow.com/users/6385640/red-wave"}, "edited": false, "score": 0, "creation_date": 1553101147, "post_id": 55264574, "comment_id": 97263911, "body": "Replace all namespace scope resolution operators with underscores and get that limit much faster; inside a namespace local names are used and cut the costs. I doubt that the code would even compile - due to global namespace exhaustion."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1553102347, "post_id": 55264574, "comment_id": 97264647, "body": "@eerorika no, I never meant to say that, if it made sound like that I wasn&#39;t clear enough. The lengthy linking time was caused by the amount of code linked in, I highlight this fact to show how big codebase was."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 1, "last_activity_date": 1553096005, "creation_date": 1553096005, "answer_id": 55264574, "question_id": 55264208, "link": "https://stackoverflow.com/questions/55264208/cost-of-namespaces/55264574#55264574", "title": "Cost of namespaces", "body": "<p>I can't help it, but here is a real-life (although anecdotal) example of real cost of namespaces.</p>\n\n<p>Several years ago I was working in a major company with very strong technological presence (no more would be said about them here). One of the distinctive aspects of their codebase was that it was dominantly server-side, Unix binaries <strong>compiled in 32 bit mode</strong>. One of the coding conventions used in the company was that <strong>every</strong> name should have been put in 3 nested namespaces - the rather long company name namespace, followed by 3 character name namespace, and than another one of 5 characters. (There were exceptions for legacy code).</p>\n\n<p>The codebase was huge (as in <strong>linking</strong> of the executable would take up to 15 minute on a very powerful machine) and they were coming to the natural limit of executable size for 32 bit. Coming quickly - the new code was added, and the doom limit approached. A lot of solutions were discussed in a fire-sale urgency mode, and the one was that if we just used the shorthand for company name in the namespace, and may be used less characters in nested namespaces, we would postpone the doom of 32 bit limitation by several months!</p>\n\n<p>Full disclosure - I do not know how this sutuation was resolved, I left the company before doomsday.</p>\n"}, {"comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1553096541, "post_id": 55264580, "comment_id": 97260888, "body": "Good insight. +1."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 1, "creation_date": 1553096621, "post_id": 55264580, "comment_id": 97260952, "body": "Can you provide some paper/measurements to support that. I&#39;m not saying that you are wrong, but I wonder how this is possible. Overloads are so rare that even if you are right impact should not be measurable. Also when you do not use namespace, usually some prefixes are used, so &quot;overload argument&quot; is also not valid."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553096730, "post_id": 55264580, "comment_id": 97261033, "body": "You are also not taking into account all the extra work the compiler has to take in maintaining the namespaces used and whats in them."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1553096863, "post_id": 55264580, "comment_id": 97261126, "body": "How much is <i>significantly</i>? Also, don&#39;t the namespaces also increase compile time (perhaps marginally) of unqualified lookups in the case when the overload is found in the global namespace?"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1553097488, "post_id": 55264580, "comment_id": 97261594, "body": "@MarekR I could write a blog post or something, I didn&#39;t thought about sharing my result. I might do that when I&#39;m less busy. However I think most of my gains were when moving free function into friend functions."}], "tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": false, "score": 4, "last_activity_date": 1553096031, "creation_date": 1553096031, "answer_id": 55264580, "question_id": 55264208, "link": "https://stackoverflow.com/questions/55264208/cost-of-namespaces/55264580#55264580", "title": "Cost of namespaces", "body": "<blockquote>\n  <p>By that I specifically mean compile-time</p>\n</blockquote>\n\n<p>Namespace can significantly reduce compile times since the compiler may have less overload to check when using a function.</p>\n\n<p>This advantage is lost when using <code>using namespace xyz;</code></p>\n\n<p>Further compile time improvement can be done by using friend functions instead of free function, since ADL will have even less overload to check (in case of operators or if you already were using ADL)</p>\n"}], "owner": {"reputation": 737, "user_id": 4860693, "user_type": "registered", "profile_image": "https://graph.facebook.com/838129839615438/picture?type=large", "display_name": "Anthony Monterrosa", "link": "https://stackoverflow.com/users/4860693/anthony-monterrosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 1, "answer_count": 3, "score": 4, "last_activity_date": 1553096988, "creation_date": 1553094858, "question_id": 55264208, "link": "https://stackoverflow.com/questions/55264208/cost-of-namespaces", "title": "Cost of namespaces", "body": "<p>What is the cost of defining namespaces in c++? By that I specifically mean compile-time/run-time increase, and/or memory footprint. Let's say I have trivial program with a header file and a .cpp with main. Would I notice a change in these aforementioned statistics if I, say, define a <code>namespace</code> in my header? What about 10, 100, or 1,000 namespaces? What if they are defined but never used: does that change the answer? I guess you could say I'm curious how this construct interacts with the compiler(s).</p>\n\n<p>Similarly, I am curious about the effect of <code>struct</code>/<code>class</code> definitions and <code>using</code>, but I couldn't think of a good title for a question encompassing all three. </p>\n"}, {"tags": ["c++", "text-to-speech", "sapi"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 2, "creation_date": 1553094528, "post_id": 55263883, "comment_id": 97259469, "body": "<code>std::wstring( str.begin(), str.end() );</code> will work correctly only if source string contains only ASCII symbols. In general case you will need to perform encoding conversion."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1553094601, "post_id": 55263883, "comment_id": 97259523, "body": "The most likely culprit is the character encoding. Simply widening each character will not produce a correct string."}, {"owner": {"reputation": 288, "user_id": 6379985, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/189723159d03a0cca63875de657f826d?s=128&d=identicon&r=PG&f=1", "display_name": "georges619", "link": "https://stackoverflow.com/users/6379985/georges619"}, "edited": false, "score": 0, "creation_date": 1553094707, "post_id": 55263883, "comment_id": 97259612, "body": "I need to perform encoding conversion between <code>string str( text );</code> and <code>std::wstring( str.begin(), str.end() );</code> right? And how can I do this?"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1553098404, "post_id": 55263883, "comment_id": 97262218, "body": "there are a lot of duplicates on that: <a href=\"https://stackoverflow.com/q/2573834/995714\">C++ Convert string (or char*) to wstring (or wchar_t*)</a>, <a href=\"https://stackoverflow.com/q/25485268/995714\">How to convert string to wstring in C++</a>, <a href=\"https://stackoverflow.com/q/6691555/995714\">converting narrow string to wide string</a>, <a href=\"https://stackoverflow.com/q/258050/995714\">How to convert CString and ::std::string  ::std::wstring to each other?</a>..."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1553106430, "post_id": 55263883, "comment_id": 97266715, "body": "Even if you convert the string correctly, you might need to choose the right normalization form, since accented latin letters can typically be represented a couple different ways in Unicode.  The Microsoft docs don&#39;t mention which form the API expects, but a good guess is NFC."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1553161093, "post_id": 55263883, "comment_id": 97284850, "body": "@AdrianMcCarthy: Unicode basically says that the different representations are equivalent. I.e. <code>&#225;==&#225;</code> regardless of representation."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1553185436, "post_id": 55263883, "comment_id": 97299820, "body": "@MSalters:  True, but that doesn&#39;t mean the implementation of this API does that.  I did qualify my comment with &quot;might.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1553101898, "post_id": 55264327, "comment_id": 97264352, "body": "Or, you could simply change <code>ttsSpeak()</code> to take a <code>const wchar_t*</code> to begin with, and get rid of the <code>str</code> and <code>stemp</code> local variables altogether, and pass <code>text</code> directly to <code>Speak()</code>. Then it becomes the responsibility of the caller of <code>ttsSpeak()</code> to pass in a valid Unicode string."}, {"owner": {"reputation": 2333, "user_id": 6783775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d399a7e1545b42ae65bca9b4568099a?s=128&d=identicon&r=PG", "display_name": "rveerd", "link": "https://stackoverflow.com/users/6783775/rveerd"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1553153463, "post_id": 55264327, "comment_id": 97281345, "body": "@RemyLebeau True, but that&#39;s more an architecture choice. From the question, it appears the poster doesn&#39;t even know the concepts of character types and encodings and that&#39;s the first thing to get right."}, {"owner": {"reputation": 288, "user_id": 6379985, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/189723159d03a0cca63875de657f826d?s=128&d=identicon&r=PG&f=1", "display_name": "georges619", "link": "https://stackoverflow.com/users/6379985/georges619"}, "edited": false, "score": 0, "creation_date": 1553155665, "post_id": 55264327, "comment_id": 97282214, "body": "@rveerd, the <b>MultiByteToWideChar</b> worked. However, I found a shorter way to implement it, but I will accept your answer"}], "tags": [], "owner": {"reputation": 2333, "user_id": 6783775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d399a7e1545b42ae65bca9b4568099a?s=128&d=identicon&r=PG", "display_name": "rveerd", "link": "https://stackoverflow.com/users/6783775/rveerd"}, "is_accepted": true, "score": 2, "last_activity_date": 1553095251, "creation_date": 1553095251, "answer_id": 55264327, "question_id": 55263883, "link": "https://stackoverflow.com/questions/55263883/microsoft-text-to-speech-doesnt-speak-accented-characters/55264327#55264327", "title": "Microsoft Text-To-Speech doesn&#39;t speak accented characters", "body": "<p>You can't simply copy a single-byte or multi-byte character string (<code>char</code>, <code>std::string</code>) to a wide character string (<code>wchar_t</code>, <code>std::wstring</code>). You need to do proper conversion between encodings or character sets.</p>\n\n<p>You have to determine the correct encodings used for both strings. On Windows, <code>std::string</code> data is usually in a local encoding, such as Windows-1252 and <code>std::wstring</code> data is in UTF-16.</p>\n\n<p>On Windows, you can use <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar\" rel=\"nofollow noreferrer\">MultiByteToWideChar</a> for the conversion.</p>\n\n<p>Alternatively, you can use standard functions such as <code>mbstowcs</code> or <code>std::mbtowc</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1553161193, "post_id": 55276173, "comment_id": 97284912, "body": "The chances of your input being UTF-7 are incredibly small. UTF-8 is probably a million times more common, and that is not exaggerating."}, {"owner": {"reputation": 288, "user_id": 6379985, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/189723159d03a0cca63875de657f826d?s=128&d=identicon&r=PG&f=1", "display_name": "georges619", "link": "https://stackoverflow.com/users/6379985/georges619"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1553161503, "post_id": 55276173, "comment_id": 97285085, "body": "@MSalters I tried with UTF-8, but I had the same error as explained in the context. This time, the <b>&#231;</b> was replaced with a <b>? in a black lozenge</b>"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1553161657, "post_id": 55276173, "comment_id": 97285174, "body": "Your input might also be in CP-1252 or a host of other common encodings. UTF-7 is really rare, if not outright theoretical."}, {"owner": {"reputation": 288, "user_id": 6379985, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/189723159d03a0cca63875de657f826d?s=128&d=identicon&r=PG&f=1", "display_name": "georges619", "link": "https://stackoverflow.com/users/6379985/georges619"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1553162629, "post_id": 55276173, "comment_id": 97285702, "body": "@MSalters you&#39;re probably right. I rechecked the documentation about <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar\" rel=\"nofollow noreferrer\">MultiByteToWideChar</a> and its written that UTF-8 is preferred. However, UTF-8 doesn&#39;t work for me, and I replaced UTF-7 with <b>CP_ACP</b>. Is this better ?"}, {"owner": {"reputation": 2333, "user_id": 6783775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d399a7e1545b42ae65bca9b4568099a?s=128&d=identicon&r=PG", "display_name": "rveerd", "link": "https://stackoverflow.com/users/6783775/rveerd"}, "edited": false, "score": 2, "creation_date": 1553169574, "post_id": 55276173, "comment_id": 97289610, "body": "@georges619 Yes, CP_ACP is usually what you want to use if the data comes from a Windows environment."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1553180441, "post_id": 55276173, "comment_id": 97296545, "body": "In the <code>MultiByteToWideChar()</code> example, the conversion from <code>char*</code> to <code>string</code> is unnecessary, just pass the <code>char*</code> directly to <code>MultiByteToWideChar()</code>. And don&#39;t forget to <code>delete[]</code> the <code>wchar_t*</code> you allocated with <code>new[]</code>."}, {"owner": {"reputation": 288, "user_id": 6379985, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/189723159d03a0cca63875de657f826d?s=128&d=identicon&r=PG&f=1", "display_name": "georges619", "link": "https://stackoverflow.com/users/6379985/georges619"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1553183077, "post_id": 55276173, "comment_id": 97298304, "body": "@RemyLebeau, I edited the code as you mentionned. Thanks for the advice :)"}], "tags": [], "owner": {"reputation": 288, "user_id": 6379985, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/189723159d03a0cca63875de657f826d?s=128&d=identicon&r=PG&f=1", "display_name": "georges619", "link": "https://stackoverflow.com/users/6379985/georges619"}, "is_accepted": false, "score": 0, "last_activity_date": 1553238865, "last_edit_date": 1553238865, "creation_date": 1553156175, "answer_id": 55276173, "question_id": 55263883, "link": "https://stackoverflow.com/questions/55263883/microsoft-text-to-speech-doesnt-speak-accented-characters/55276173#55276173", "title": "Microsoft Text-To-Speech doesn&#39;t speak accented characters", "body": "<p>I implemented the <code>MultiByteToWideChar</code> suggested by @rveerd. Here is the code:</p>\n\n<pre><code>int ttsSpeak( const char* text ) //Text to Speech speaking function\n{\n  if( SUCCEEDED(hr) )\n  {\n    hr = SpEnumTokens( SPCAT_VOICES, NULL, NULL, &amp;cpEnum );\n\n    cpEnum-&gt;Item( saveVoice, &amp;cpVoiceToken );\n    cpVoice-&gt;SetVoice( cpVoiceToken ); //Initialization of the voice\n\n    //processing conversion\n    int wchars_num = MultiByteToWideChar( CP_ACP, 0, text, -1, NULL, 0 ); \n    wchar_t* wstr = new wchar_t[ wchars_num ];\n    MultiByteToWideChar( CP_ACP, 0, text, -1, wstr, wchars_num );\n\n    printf( \"Text To Speech processing\\n\" );\n    hr = cpVoice-&gt;Speak( wstr, SPF_DEFAULT, NULL ); //speak my text\n\n    saveText = text;\n\n    cpEnum.Release();\n    cpVoiceToken.Release();\n    delete new wchar_t[wchars_num];\n  }\n  else\n  {\n    printf( \"Could not speak entered text\\n\" );\n  }\n\n  return true;\n}\n</code></pre>\n\n<p>I also found a shorter way to convert it. Just replace the <code>MultiByteToWideChar</code> code with following:</p>\n\n<pre><code>CA2W pszWide( str.c_str(), CP_ACP);\nhr = cpVoice-&gt;Speak( pszWide, SPF_DEFAULT, NULL );\n</code></pre>\n\n<p><strong>Edit</strong>: I replaced CP_UTF7 because it is rarely used. CP_UTF8 is prefered. However, it didn't worked for me, but I found out that CP_ACP works for me. For more information look at the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar\" rel=\"nofollow noreferrer\">link</a> @rveerd posted</p>\n"}], "owner": {"reputation": 288, "user_id": 6379985, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/189723159d03a0cca63875de657f826d?s=128&d=identicon&r=PG&f=1", "display_name": "georges619", "link": "https://stackoverflow.com/users/6379985/georges619"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 55264327, "answer_count": 2, "score": 0, "last_activity_date": 1553238865, "creation_date": 1553093944, "question_id": 55263883, "link": "https://stackoverflow.com/questions/55263883/microsoft-text-to-speech-doesnt-speak-accented-characters", "title": "Microsoft Text-To-Speech doesn&#39;t speak accented characters", "body": "<p>I'm developping a Text-To-Speech application using the Microsoft <code>sapi</code> library. I implemented the speaking function and discovered that the accented characters <strong>(\u00e0,\u00e1,\u00e2,\u00e4,\u00e9,\u00e8,\u00ea,\u00ed,\u00ec,\u00ee,\u00f3,\u00f2,\u00f4,\u00f6,\u00f9,\u00fa,\u00fb,\u00fc)</strong> are not spoken.\nHere is my code:</p>\n\n<pre><code>int ttsSpeak( const char* text ) //Text to Speech speaking function\n{\n  if( SUCCEEDED(hr) )\n  {\n    hr = SpEnumTokens( SPCAT_VOICES, NULL, NULL, &amp;cpEnum );\n\n    cpEnum-&gt;Item( saveVoice, &amp;cpVoiceToken );\n    cpVoice-&gt;SetVoice( cpVoiceToken ); //Initialization of the voice\n\n    string str( text );\n    cout &lt;&lt; str;\n    std::wstring stemp = std::wstring( str.begin(), str.end() );\n    LPCWSTR sw = ( LPCWSTR )stemp.c_str(); //variable allowing to speak my entered text\n\n    printf( \"Text To Speech processing\\n\" );\n    hr = cpVoice-&gt;Speak( sw, SPF_DEFAULT, NULL ); //speak my text\n\n    saveText = text;\n\n    cpEnum.Release();\n    cpVoiceToken.Release();\n  }\n  else\n  {\n    printf( \"Could not speak entered text\\n\" );\n  }\n\n  return true;\n}\n</code></pre>\n\n<p>I debugged my app and found out that the variable <code>str</code> gets the accented characters. However, I create a <code>wstring</code> variable called <code>stemp</code> where my string is converted, and here the accented character is replaced with a empty square. Then, a LPCWSTR variable (Long Pointer to Constant Wide String) is created in order to speak the entered text. Below a picture of my variables values.</p>\n\n<p><a href=\"https://i.stack.imgur.com/dP76M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dP76M.png\" alt=\"Variable values\"></a></p>\n\n<p>Maybe there is something wrong in my code, but what can I do to ensure that the accented characters are spoken out?</p>\n"}, {"tags": ["c++", "c++17", "constexpr", "char-traits"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 3, "creation_date": 1553094040, "post_id": 55263851, "comment_id": 97259103, "body": "Does the second snipped accesses the <code>b</code> pointer out of bounds so it is undefined behavior? It is, <a href=\"https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/bits/char_traits.h#L149\" rel=\"nofollow noreferrer\">looks like</a> and <a href=\"https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/bits/char_traits.h#L319\" rel=\"nofollow noreferrer\">looks like</a> it&#39;s a plain memcmp. So it is undefined behavior."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1553094076, "post_id": 55263851, "comment_id": 97259135, "body": "The first case is the same problem as doing any other function call, the compiler doesn&#39;t have to optimize it away."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1553094313, "post_id": 55263851, "comment_id": 97259326, "body": "But the <code>__constant_char_array_p(__s2, __n)</code> inside <code>char_traits&lt;char&gt;::compare</code> will evaluate to false, beacuse <code>b[4]</code> is not a constant expression. So it may or may not be a constexpr, because it&#39;s undefined. The <code>compare</code> function is not <code>strcmp</code> it is <code>memcmp</code>, it doesn&#39;t stop on null termination characters."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 3, "creation_date": 1553094335, "post_id": 55263851, "comment_id": 97259337, "body": "Because constexpr functions are not guaranteed to be called at compile time unless their result is used in a context which requires constant expression. Than it just becomes a case of missing optimization, there are millions of those."}, {"owner": {"reputation": 22670, "user_id": 955273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79903a88026b021e89735578bb71fd22?s=128&d=identicon&r=PG", "display_name": "Steve Lorimer", "link": "https://stackoverflow.com/users/955273/steve-lorimer"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1553094430, "post_id": 55263851, "comment_id": 97259394, "body": "@SergeyA I guess that is the exact answer - thank you! If you want to put it in an actual answer I&#39;ll gladly accept"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1553094531, "post_id": 55263851, "comment_id": 97259470, "body": "I feel this is relevant, if not a duplicate <a href=\"https://stackoverflow.com/questions/54181797/c-constexpr-function-in-return-statement\" title=\"c constexpr function in return statement\">stackoverflow.com/questions/54181797/&hellip;</a>"}, {"owner": {"reputation": 22670, "user_id": 955273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79903a88026b021e89735578bb71fd22?s=128&d=identicon&r=PG", "display_name": "Steve Lorimer", "link": "https://stackoverflow.com/users/955273/steve-lorimer"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1553094668, "post_id": 55263851, "comment_id": 97259577, "body": "@StoryTeller I agree it is definitely relevant - thanks for the link!"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1553094996, "post_id": 55263851, "comment_id": 97259806, "body": "@SteveLorimer done )"}], "answers": [{"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 3, "last_activity_date": 1553094959, "creation_date": 1553094959, "answer_id": 55264242, "question_id": 55263851, "link": "https://stackoverflow.com/questions/55263851/removing-constexpr-from-a-variable-capturing-a-constexpr-function-return-value-r/55264242#55264242", "title": "removing constexpr from a variable capturing a constexpr function return value removes compile-time evaluation", "body": "<p>Note, that nothing in the standard <strong>explicitly</strong> requires <code>constexpr</code> function to be called at compile time, see 9.1.5.7 in latest draft:</p>\n\n<blockquote>\n  <p>A call to a constexpr function produces the same result as a call to\n  an equivalent non-constexpr function <strong>in all respects</strong> except that (7.1)\n  a call to a constexpr function can appear in a constant expression and\n  (7.2) copy elision is not performed in a constant expression\n  ([class.copy.elision]).</p>\n</blockquote>\n\n<p>(emphasizes mine)</p>\n\n<p>Now, when the call appears in constant expression, there is no way compiler can avoid running the function at compile time, so it dutifully obliges. When it does not (as in your second snippet) it is just a case of missing optimization. There is no shortage of those around here.</p>\n"}, {"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 4, "last_activity_date": 1553095941, "last_edit_date": 1553095941, "creation_date": 1553094990, "answer_id": 55264254, "question_id": 55263851, "link": "https://stackoverflow.com/questions/55263851/removing-constexpr-from-a-variable-capturing-a-constexpr-function-return-value-r/55264254#55264254", "title": "removing constexpr from a variable capturing a constexpr function return value removes compile-time evaluation", "body": "<p>We have three working cases:</p>\n\n<p>1) the computed value is required to initialize a <code>constexpr</code> value or where a compile-time-known value is strictly required (not-type template parameter, size of a C-style array, a test in a <code>static_assert()</code>, ...)</p>\n\n<p>2) the <code>constexpr</code> function uses value not compile-time-known (by example: values received from standard input.</p>\n\n<p>3) the <code>constexpr</code> function receive values compile-time-known but the result goes in a place not compile-time required.</p>\n\n<p>If we ignore the as-if rule, we have that:</p>\n\n<ul>\n<li><p>in case (1) the compiler <strong>must</strong> compute the value compile-time because the computed value is required compile-time</p></li>\n<li><p>in case (2) the compiler <strong>must</strong> compute the value run-time because it's impossible compute it compile-time</p></li>\n<li><p>in case (3) we are in a grey area where the compiler can compute the value compile-time but the computed value isn't strictly required compile-time; in this case the compiler can choose if compute compile-time or run-time.</p></li>\n</ul>\n\n<p>With the initial code</p>\n\n<pre><code>constexpr bool result = static_strcmp(a, b);\n</code></pre>\n\n<p>you are in case (1): the compiler <strong>must</strong> compute compile-time because the <code>result</code> variable is declared <code>constexpr</code>.</p>\n\n<p>Removing the <code>constexpr</code>, </p>\n\n<pre><code>bool result = static_strcmp(a, b); // no more constexpr\n</code></pre>\n\n<p>your code translate in the grey area (case (3)), where compile-time computation is possible but not strictly required, because the input values are known compile time (<code>a</code> and <code>b</code>) but the result\ngoes where the value isn't compile-time required (an ordinary variable). So the compiler can choose and, in your case, choose the run-time computation with a version of the function, compile-time computation with another version.</p>\n"}, {"tags": [], "owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "is_accepted": false, "score": 2, "last_activity_date": 1553103612, "last_edit_date": 1553103612, "creation_date": 1553095527, "answer_id": 55264402, "question_id": 55263851, "link": "https://stackoverflow.com/questions/55263851/removing-constexpr-from-a-variable-capturing-a-constexpr-function-return-value-r/55264402#55264402", "title": "removing constexpr from a variable capturing a constexpr function return value removes compile-time evaluation", "body": "<p>Your program has undefined behavior, because you always compare <code>strlen(a)</code> characters. The string <code>b</code> doesn't have that much characters.</p>\n\n<p>If you modify your strings to be equal length (so your program becomes well-defined), your program will be <a href=\"https://godbolt.org/z/tbJpl1\" rel=\"nofollow noreferrer\">optimised</a> as you expect.</p>\n\n<p>So this is not missed optimization. The compiler would optimize your program, but because it contains undefined behavior, it doesn't optimize it.</p>\n\n<hr>\n\n<p>Note, that whether it is undefined behavior or not, is not super clear. Considering that the compiler uses <code>memcmp</code>, it thinks that both of the input strings must be at least <code>strlen(a)</code> long. So according to the behavior of the compiler, it is undefined behavior.</p>\n\n<p>Here's what the current draft standard says about compare:</p>\n\n<blockquote>\n  <p><em>Returns</em>: 0 if for each i in [0, n), X::eq(p[i],q[i]) is <code>true</code>; else, a negative value if, for some j in [0, n), X::lt(p[j],q[j]) is <code>true</code> and for each i in [0, j) X::eq(p[i],q[i]) is <code>true</code>; else a positive value.</p>\n</blockquote>\n\n<p>Now, it is not specified whether <code>compare</code> is allowed to read <code>p[j+1..n)</code> or <code>q[j+1..n)</code> (where <code>j</code> is the index of the first difference).</p>\n"}], "owner": {"reputation": 22670, "user_id": 955273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79903a88026b021e89735578bb71fd22?s=128&d=identicon&r=PG", "display_name": "Steve Lorimer", "link": "https://stackoverflow.com/users/955273/steve-lorimer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 55264242, "answer_count": 3, "score": 3, "last_activity_date": 1553103612, "creation_date": 1553093864, "last_edit_date": 1553099442, "question_id": 55263851, "link": "https://stackoverflow.com/questions/55263851/removing-constexpr-from-a-variable-capturing-a-constexpr-function-return-value-r", "title": "removing constexpr from a variable capturing a constexpr function return value removes compile-time evaluation", "body": "<p>Consider the following <code>constexpr</code> function, <code>static_strcmp</code>, which uses C++17's <code>constexpr</code> <code>char_traits::compare</code> function:</p>\n\n<pre><code>#include &lt;string&gt;\n\nconstexpr bool static_strcmp(char const *a, char const *b) \n{\n    return std::char_traits&lt;char&gt;::compare(a, b,\n        std::char_traits&lt;char&gt;::length(a)) == 0;\n}\n\nint main() \n{\n    constexpr const char *a = \"abcdefghijklmnopqrstuvwxyz\";\n    constexpr const char *b = \"abc\";\n\n    constexpr bool result = static_strcmp(a, b);\n\n    return result;\n}\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/nIORGd\" rel=\"nofollow noreferrer\">godbolt</a> shows this gets evaluated at compile-time, and optimised down to:</p>\n\n<blockquote>\n<pre><code>main:\n    xor     eax, eax\n    ret\n</code></pre>\n</blockquote>\n\n<p><strong>Remove <code>constexpr</code> from <code>bool result</code>:</strong></p>\n\n<p>If we remove the <code>constexpr</code> from <code>constexpr bool result</code>, now the call is no longer optimised.</p>\n\n<pre><code>#include &lt;string&gt;\n\nconstexpr bool static_strcmp(char const *a, char const *b) \n{\n    return std::char_traits&lt;char&gt;::compare(a, b,\n        std::char_traits&lt;char&gt;::length(a)) == 0;\n}\n\nint main() \n{\n    constexpr const char *a = \"abcdefghijklmnopqrstuvwxyz\";\n    constexpr const char *b = \"abc\";\n\n    bool result = static_strcmp(a, b);            // &lt;-- note no constexpr\n\n    return result;\n}\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/vF9pAt\" rel=\"nofollow noreferrer\">godbolt</a> shows we now call into <code>memcmp</code>:</p>\n\n<blockquote>\n<pre><code>.LC0:\n    .string \"abc\"\n.LC1:\n    .string \"abcdefghijklmnopqrstuvwxyz\"\nmain:\n    sub     rsp, 8\n    mov     edx, 26\n    mov     esi, OFFSET FLAT:.LC0\n    mov     edi, OFFSET FLAT:.LC1\n    call    memcmp\n    test    eax, eax\n    sete    al\n    add     rsp, 8\n    movzx   eax, al\n    ret\n</code></pre>\n</blockquote>\n\n<p><strong>Add a short circuiting <code>length</code> check:</strong></p>\n\n<p>if we first compare <code>char_traits::length</code> for the two arguments in <code>static_strcmp</code> <em>before</em> calling <code>char_traits::compare</code>, <strong>without</strong> <code>constexpr</code> on <code>bool result</code>, the call is optimised away again.</p>\n\n<pre><code>#include &lt;string&gt;\n\nconstexpr bool static_strcmp(char const *a, char const *b) \n{\n    return \n        std::char_traits&lt;char&gt;::length(a) == std::char_traits&lt;char&gt;::length(b) \n        &amp;&amp; std::char_traits&lt;char&gt;::compare(a, b, \n             std::char_traits&lt;char&gt;::length(a)) == 0;\n}\n\nint main() \n{\n    constexpr const char *a = \"abcdefghijklmnopqrstuvwxyz\";\n    constexpr const char *b = \"abc\";\n\n    bool result = static_strcmp(a, b);            // &lt;-- note still no constexpr!\n\n    return result;\n}\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/z7pBOs\" rel=\"nofollow noreferrer\">godbolt</a> shows we're back to the call being optimised away:</p>\n\n<blockquote>\n<pre><code>main:\n    xor     eax, eax\n    ret\n</code></pre>\n</blockquote>\n\n<ul>\n<li>Why does removing <code>constexpr</code> from the initial call to <code>static_strcmp</code> cause the constant evaluation to fail?</li>\n<li>Clearly even <strong>without</strong> <code>constexpr</code>, the call to <code>char_traits::length</code> is evaluated at compile time, so why not the same behaviour without <code>constexpr</code> in the first version of <code>static_strcmp</code>?</li>\n</ul>\n"}, {"tags": ["c++", "ubuntu", "g++"], "answers": [{"comments": [{"owner": {"reputation": 424, "user_id": 3520726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/678a32857aa0b85042868b22233c81b2?s=128&d=identicon&r=PG&f=1", "display_name": "Mdp11", "link": "https://stackoverflow.com/users/3520726/mdp11"}, "edited": false, "score": 0, "creation_date": 1553093308, "post_id": 55263429, "comment_id": 97258567, "body": "Thank you, this solved it! I thought that it could be const, but it looks like I was wrong. Thank you again."}], "tags": [], "owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "is_accepted": true, "score": 8, "last_activity_date": 1553093518, "last_edit_date": 1553093518, "creation_date": 1553092803, "answer_id": 55263429, "question_id": 55263255, "link": "https://stackoverflow.com/questions/55263255/uniform-real-distribution-operator-compilation-errors/55263429#55263429", "title": "uniform_real_distribution operator () compilation errors", "body": "<p><code>std::uniform_real_distrubution::operator()</code> is not a constant member function, therefore cannot be invoked for constant instances: <a href=\"http://eel.is/c++draft/rand.dist.uni.real\" rel=\"noreferrer\">[rand.dist.uni.real]</a>. </p>\n\n<hr>\n\n<p>Why does it work on Windows? Microsoft's <code>operator()</code> is likely <code>const</code>, IIRC implementations are allowed to strengthen <code>const</code> specification for member functions: <a href=\"http://eel.is/c++draft/member.functions#2\" rel=\"noreferrer\">http://eel.is/c++draft/member.functions#2</a>.</p>\n"}], "owner": {"reputation": 424, "user_id": 3520726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/678a32857aa0b85042868b22233c81b2?s=128&d=identicon&r=PG&f=1", "display_name": "Mdp11", "link": "https://stackoverflow.com/users/3520726/mdp11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "accepted_answer_id": 55263429, "answer_count": 1, "score": 5, "last_activity_date": 1553093518, "creation_date": 1553092346, "question_id": 55263255, "link": "https://stackoverflow.com/questions/55263255/uniform-real-distribution-operator-compilation-errors", "title": "uniform_real_distribution operator () compilation errors", "body": "<p>I've written this code:</p>\n\n<pre><code>std::pair&lt;std::weak_ptr&lt;Node&gt;, size_t&gt; NodeSelector::rouletteWheel() const {\n    const std::uniform_real_distribution&lt;long double&gt; urd;\n    size_t i = 0;\n    for(auto rnd = urd(shared_random_engine); rnd &gt;= 0; ++i) {\n        rnd -= getNormValue(i);\n    }\n    return std::make_pair(entries_[i - 1], i - 1);\n}\n</code></pre>\n\n<p>Where \"shared_random_engine\" is initialized in this way (in a separate .h file)</p>\n\n<pre><code>std::minstd_rand shared_random_engine(static_cast&lt;unsigned int&gt;(42));\n</code></pre>\n\n<p>As long as I compile it on Windows, everything works perfectly, but when I try to compile on Ubuntu 18.04.2 with g++ 7.3.0, I get this error:</p>\n\n<pre><code>montecarlo.cpp: In member function \u2018std::pair&lt;std::weak_ptr&lt;MonteCarloNode&gt;, long unsigned int&gt; NodeSelector::rouletteWheel() const\u2019:\nmontecarlo.cpp:728:41: error: no match for call to \u2018(const std::uniform_real_distribution&lt;long double&gt;) (std::minstd_rand&amp;)\u2019\n  for(auto rnd = urd(shared_random_engine); rnd &gt;= 0; ++i) {\n                                         ^\nIn file included from /usr/include/c++/7/random:49:0,\n                 from selector.h:15,\n                 from montecarlo.h:13,\n                 from montecarlo.cpp:7:\n/usr/include/c++/7/bits/random.h:1813:2: note: candidate: std::uniform_real_distribution&lt;_RealType&gt;::result_type std::uniform_real_distribution&lt;_RealType&gt;::operator()(_UniformRandomNumberGenerator&amp;) [with _UniformRandomNumberGenerator = std::linear_congruential_engine&lt;long unsigned int, 48271, 0, 2147483647&gt;; _RealType = long double; std::uniform_real_distribution&lt;_RealType&gt;::result_type = long double] &lt;near match&gt;\n  operator()(_UniformRandomNumberGenerator&amp; __urng)\n  ^~~~~~~~\n/usr/include/c++/7/bits/random.h:1813:2: note:   passing \u2018const std::uniform_real_distribution&lt;long double&gt;*\u2019 as \u2018this\u2019 argument discards qualifiers\n/usr/include/c++/7/bits/random.h:1818:2: note: candidate: template&lt;class _UniformRandomNumberGenerator&gt; std::uniform_real_distribution&lt;_RealType&gt;::result_type std::uniform_real_distribution&lt;_RealType&gt;::operator()(_UniformRandomNumberGenerator&amp;, const std::uniform_real_distribution&lt;_RealType&gt;::param_type&amp;) [with _UniformRandomNumberGenerator = _UniformRandomNumberGenerator; _RealType = long double]\n  operator()(_UniformRandomNumberGenerator&amp; __urng,\n  ^~~~~~~~\n/usr/include/c++/7/bits/random.h:1818:2: note:   template argument deduction/substitution failed:\nmontecarlo.cpp:728:41: note:   candidate expects 2 arguments, 1 provided\n  for(auto rnd = urd(shared_random_engine); rnd &gt;= 0; ++i) {\n                                         ^\n</code></pre>\n\n<p>Since the last lines of the errors tell me that 2 arguments are expected, I changed the code in the following way:</p>\n\n<pre><code>for(auto rnd = urd(shared_random_engine, urd.param())\n</code></pre>\n\n<p>On Windows, it still works fine, but on Ubuntu I get this error, now telling me to pass just 1 argument:</p>\n\n<pre><code>montecarlo.cpp: In member function \u2018std::pair&lt;std::weak_ptr&lt;MonteCarloNode&gt;, long unsigned int&gt; NodeSelector::rouletteWheel() const\u2019:\nmontecarlo.cpp:728:54: error: no match for call to \u2018(const std::uniform_real_distribution&lt;long double&gt;) (std::minstd_rand&amp;, std::uniform_real_distribution&lt;long double&gt;::param_type)\u2019\n  for(auto rnd = urd(shared_random_engine, urd.param()); rnd &gt;= 0; ++i) {\n                                                      ^\nIn file included from /usr/include/c++/7/random:49:0,\n                 from selector.h:15,\n                 from montecarlo.h:13,\n                 from montecarlo.cpp:7:\n/usr/include/c++/7/bits/random.h:1813:2: note: candidate: template&lt;class _UniformRandomNumberGenerator&gt; std::uniform_real_distribution&lt;_RealType&gt;::result_type std::uniform_real_distribution&lt;_RealType&gt;::operator()(_UniformRandomNumberGenerator&amp;) [with _UniformRandomNumberGenerator = _UniformRandomNumberGenerator; _RealType = long double]\n  operator()(_UniformRandomNumberGenerator&amp; __urng)\n  ^~~~~~~~\n/usr/include/c++/7/bits/random.h:1813:2: note:   template argument deduction/substitution failed:\nmontecarlo.cpp:728:54: note:   candidate expects 1 argument, 2 provided\n  for(auto rnd = urd(shared_random_engine, urd.param()); rnd &gt;= 0; ++i) {\n                                                      ^\nIn file included from /usr/include/c++/7/random:49:0,\n                 from selector.h:15,\n                 from montecarlo.h:13,\n                 from montecarlo.cpp:7:\n/usr/include/c++/7/bits/random.h:1818:2: note: candidate: std::uniform_real_distribution&lt;_RealType&gt;::result_type std::uniform_real_distribution&lt;_RealType&gt;::operator()(_UniformRandomNumberGenerator&amp;, const std::uniform_real_distribution&lt;_RealType&gt;::param_type&amp;) [with _UniformRandomNumberGenerator = std::linear_congruential_engine&lt;long unsigned int, 48271, 0, 2147483647&gt;; _RealType = long double; std::uniform_real_distribution&lt;_RealType&gt;::result_type = long double] &lt;near match&gt;\n  operator()(_UniformRandomNumberGenerator&amp; __urng,\n  ^~~~~~~~\n/usr/include/c++/7/bits/random.h:1818:2: note:   passing \u2018const std::uniform_real_distribution&lt;long double&gt;*\u2019 as \u2018this\u2019 argument discards qualifiers\n</code></pre>\n\n<p>Does anybody know what's the problem here?</p>\n"}, {"tags": ["c++", "iostream", "iomanip"], "answers": [{"comments": [{"owner": {"reputation": 120111, "user_id": 469935, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/14lYV.jpg?s=128&g=1", "display_name": "Armen Tsirunyan", "link": "https://stackoverflow.com/users/469935/armen-tsirunyan"}, "edited": false, "score": 0, "creation_date": 1553092681, "post_id": 55263254, "comment_id": 97258037, "body": "Ah, right. Now that you said it, it started to ring a bell. When I first started learning C++ many years ago, I remember I used to set any iostream flags like this. Later, I started using the standard manipulators and somehow forgot about this. Thank you :)"}], "tags": [], "owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "is_accepted": true, "score": 4, "last_activity_date": 1553092345, "creation_date": 1553092345, "answer_id": 55263254, "question_id": 55263166, "link": "https://stackoverflow.com/questions/55263166/check-if-skipws-noskipws-flag-is-set-for-an-input-stream/55263254#55263254", "title": "Check if skipws/noskipws flag is set for an input stream", "body": "<p>You're looking for <a href=\"https://en.cppreference.com/w/cpp/io/ios_base/flags\" rel=\"nofollow noreferrer\"><code>std::ios_base::flags()</code></a> :)</p>\n"}, {"tags": [], "owner": {"reputation": 1246, "user_id": 6556709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6389fba1f75367a547c52d9779902b20?s=128&d=identicon&r=PG&f=1", "display_name": "user6556709", "link": "https://stackoverflow.com/users/6556709/user6556709"}, "is_accepted": false, "score": 3, "last_activity_date": 1553102497, "last_edit_date": 1553102497, "creation_date": 1553092430, "answer_id": 55263283, "question_id": 55263166, "link": "https://stackoverflow.com/questions/55263166/check-if-skipws-noskipws-flag-is-set-for-an-input-stream/55263283#55263283", "title": "Check if skipws/noskipws flag is set for an input stream", "body": "<p>You have to use the flags of your stream:</p>\n\n<pre><code>my_input_stream.flags() &amp; std::ios_base::skipws\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 3, "last_activity_date": 1553102486, "last_edit_date": 1553102486, "creation_date": 1553092631, "answer_id": 55263351, "question_id": 55263166, "link": "https://stackoverflow.com/questions/55263166/check-if-skipws-noskipws-flag-is-set-for-an-input-stream/55263351#55263351", "title": "Check if skipws/noskipws flag is set for an input stream", "body": "<p>You need to use the <a href=\"https://en.cppreference.com/w/cpp/io/ios_base/flags\" rel=\"nofollow noreferrer\"><code>flags()</code></a> member function.  That will return the current flags, and you can test if the <code>std::ios_base::skipws</code> flag is set, like this:</p>\n\n<pre><code>int main()\n{\n    std::cin &gt;&gt; std::noskipws;\n    if (!(std::cin.flags() &amp; std::ios_base::skipws))\n        std::cout &lt;&lt; \"no skipws set\\n\";\n    std::cin &gt;&gt; std::skipws;\n    if (std::cin.flags() &amp; std::ios_base::skipws)\n        std::cout &lt;&lt; \"skipws set\";\n}\n</code></pre>\n"}], "owner": {"reputation": 120111, "user_id": 469935, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/14lYV.jpg?s=128&g=1", "display_name": "Armen Tsirunyan", "link": "https://stackoverflow.com/users/469935/armen-tsirunyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 55263254, "answer_count": 3, "score": 1, "last_activity_date": 1553102497, "creation_date": 1553092081, "question_id": 55263166, "link": "https://stackoverflow.com/questions/55263166/check-if-skipws-noskipws-flag-is-set-for-an-input-stream", "title": "Check if skipws/noskipws flag is set for an input stream", "body": "<p>In order to set the <code>std::skipws</code> (or <code>std::noskipws</code>) flag, one needs to write:</p>\n\n<pre><code>my_input_stream &gt;&gt; std::skipws; //or my_input_stream &gt;&gt; std::noskipws;\n</code></pre>\n\n<p>But how do I <em>check</em> if the flag is set? I need to enable <code>noskipws</code> for my <code>operator &gt;&gt;</code> , but I want to restore the previously set value after. I am aware of boost I/O state savers, but I need to do a demonstration for students and using boost might be overkill for this simple purpose.</p>\n"}, {"tags": ["c++", "pointers", "void-pointers", "pointer-to-pointer"], "answers": [{"tags": [], "owner": {"reputation": 2213, "user_id": 7757891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472798cf3c4d45c418314f837590985c?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Velev", "link": "https://stackoverflow.com/users/7757891/petar-velev"}, "is_accepted": false, "score": 1, "last_activity_date": 1553092340, "creation_date": 1553092340, "answer_id": 55263251, "question_id": 55263037, "link": "https://stackoverflow.com/questions/55263037/how-to-get-rid-of-wpointer-arith/55263251#55263251", "title": "How to get rid of -Wpointer-arith", "body": "<p>Well you're incrementing a <code>void</code> pointer.<br>\nWhat is the size of <code>void</code>??</p>\n\n<p>You should cast the pointer to the correct type before incrementing it.<br>\n<code>sizeof</code> gives the size in bytes so the correct type should be <code>uint8_t</code> or <code>unsigned char</code>.</p>\n\n<p><code>*buffer = (uint8_t*)(*buffer) + sizeof(unsigned int);</code></p>\n"}, {"comments": [{"owner": {"reputation": 168, "user_id": 3585651, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ac692b98befc4a8231752bc9956c58d?s=128&d=identicon&r=PG&f=1", "display_name": "larslars", "link": "https://stackoverflow.com/users/3585651/larslars"}, "edited": false, "score": 0, "creation_date": 1553171984, "post_id": 55263277, "comment_id": 97290952, "body": "I should have mentioned I don&#39;t have access to std::, as the code is supposed to run in Intel SGX enclaves :)  Other than that, your answer was really helpful! Thank you!"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 168, "user_id": 3585651, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ac692b98befc4a8231752bc9956c58d?s=128&d=identicon&r=PG&f=1", "display_name": "larslars", "link": "https://stackoverflow.com/users/3585651/larslars"}, "edited": false, "score": 0, "creation_date": 1553172570, "post_id": 55263277, "comment_id": 97291310, "body": "@larslars None of <code>std::</code> stuff are absolutely necessary here. Use <code>unsigned char</code> instead of <code>std::byte</code>. Include <code>string.h</code> for <code>::memcpy</code>. You can implement a <code>nonstd::addressof</code> easily yourself. <code>std::is_trivially_copyable</code> is probably non-trivial to implement, but the assertion can be removed and the requirement documented separately."}, {"owner": {"reputation": 168, "user_id": 3585651, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ac692b98befc4a8231752bc9956c58d?s=128&d=identicon&r=PG&f=1", "display_name": "larslars", "link": "https://stackoverflow.com/users/3585651/larslars"}, "edited": false, "score": 0, "creation_date": 1553172970, "post_id": 55263277, "comment_id": 97291577, "body": "Yes thanks it does work without it. We have our own memcpy and I&#39;m considering an addressof implementation. I will be adding sanity checks (memory bounds, range checking etc) as we go, but I will have to think more about is_trivially_copyable :)"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 2, "last_activity_date": 1553168080, "last_edit_date": 1553168080, "creation_date": 1553092407, "answer_id": 55263277, "question_id": 55263037, "link": "https://stackoverflow.com/questions/55263037/how-to-get-rid-of-wpointer-arith/55263277#55263277", "title": "How to get rid of -Wpointer-arith", "body": "<p>It's impossible to verify that this is correct unless you show what the pointer is pointing at.</p>\n\n<p>But given that you attempt to increment the pointer by <code>sizeof(unsigned int)</code>, it would make sense if <code>*buffer</code> points to an element of an array of <code>unsigned int</code>, and you attempt to increment the pointer to the next sibling.</p>\n\n<p>A correct way to do that is:</p>\n\n<pre><code>auto ptr = static_cast&lt;unsigned*&gt;(*buffer);\n*buffer = ptr + 1;\n</code></pre>\n\n<p>On the other hand, if if points to raw storage such as <code>std::byte</code>, a correct way is:</p>\n\n<pre><code>auto ptr = static_cast&lt;std::byte*&gt;(*buffer);\n*buffer = ptr + sizeof payload;\n</code></pre>\n\n<p>Instead of using <code>void**</code>, I recommend following instead:</p>\n\n<pre><code>template &lt;class T&gt;\nstd::byte* pack(std::byte* buffer, T payload) {\n    static_assert(std::is_trivially_copyable_v&lt;T&gt;);\n    std::memcpy(buffer, std::addressof(payload), sizeof payload);\n    return buffer + sizeof payload;\n}\n</code></pre>\n"}], "owner": {"reputation": 168, "user_id": 3585651, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ac692b98befc4a8231752bc9956c58d?s=128&d=identicon&r=PG&f=1", "display_name": "larslars", "link": "https://stackoverflow.com/users/3585651/larslars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 55263277, "answer_count": 2, "score": 0, "last_activity_date": 1553168080, "creation_date": 1553091716, "last_edit_date": 1553091961, "question_id": 55263037, "link": "https://stackoverflow.com/questions/55263037/how-to-get-rid-of-wpointer-arith", "title": "How to get rid of -Wpointer-arith", "body": "<p>This code: </p>\n\n<pre><code>void Pack::packUInteger(void **buffer, unsigned int payload){\n    memcpy(*buffer, &amp;payload, sizeof(unsigned int));\n    *buffer += sizeof(unsigned int);    \n}\n</code></pre>\n\n<p>yields this warning, that I would like to get rid off without telling the compiler to ignore it:</p>\n\n<pre><code>src/messaging/Pack.cpp: In static member function \u2018static void Pack::packUInteger(void**, unsigned int)\u2019:\nsrc/messaging/Pack.cpp:33:10: warning: pointer of type \u2018void *\u2019 used in arithmetic [-Wpointer-arith]\n  *buffer += sizeof(unsigned int);\n  ~~~~~~~~^~~~~~~~~~\n</code></pre>\n\n<p>I know it should there needs to be a de-referencing and casting, but I can't figure out exactly how to do it correctly.</p>\n\n<p>Thank you internet! :) </p>\n"}, {"tags": ["c++", "cmake"], "comments": [{"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1553091736, "post_id": 55262906, "comment_id": 97257338, "body": "It looks like your unit test is not linking with whatever target provides <code>QSPI_DRV_IpRead</code>, <code>g_qspiBase</code> and <code>ApplFblTimeDelay</code>. <i>Presumably</i> it has to do with one of the variables in your <code>build.cmake</code>, but we can&#39;t tell without knowing the over-arching build infrastructure"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1553092123, "post_id": 55262906, "comment_id": 97257601, "body": "I think one of these variables need to be updated to add the dependency <code>MODULES_unit_test</code> or <code>LOCAL_MODULES_unit_test</code> that @Botje mentioned."}, {"owner": {"reputation": 1, "user_id": 7255311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A3YQA.jpg?s=128&g=1", "display_name": "ecworks", "link": "https://stackoverflow.com/users/7255311/ecworks"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1553143504, "post_id": 55262906, "comment_id": 97278528, "body": "In build.cmake we added other required modules path to INC_DIR,But i gues its not linking correctly   @Botje    what  are the additional information will be helpful for you to get the over-arching build infrastructure i will try to provide it. actually here my work stucked last three days.I request your kind support"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1553150889, "post_id": 55262906, "comment_id": 97280438, "body": "By now you should have identified which &quot;local module&quot; compiles the source files that contain the symbols you need. @drescherjm (and I) think you need to add the name of that module to <code>LOCAL_MODULES_unit_test</code>."}], "owner": {"reputation": 1, "user_id": 7255311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A3YQA.jpg?s=128&g=1", "display_name": "ecworks", "link": "https://stackoverflow.com/users/7255311/ecworks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1597471141, "creation_date": 1553091358, "last_edit_date": 1597471141, "question_id": 55262906, "link": "https://stackoverflow.com/questions/55262906/cmakelists-modification", "title": "CMakeLists modification?", "body": "<p>we have build.cmake file as follows</p>\n<pre><code>cmake_minimum_required(VERSION 3.5 FATAL_ERROR)\n\n# \n# Define the name of the supported targets\n# \nset(BUILD_TARGETS unit_test)\n\n# \n# Baseline used for the CMAKE Tools\n# \nset(CMAKE_TOOLS_BASELINE    \n    &quot;${CMAKE_Repo}&quot;   &quot;${PROJECT_KEY}&quot;   &quot;${CMAKE_REV}&quot;)\n\n# \n# Revision of the GTest framework used to execute unit test of the module.\n# \nif( (&quot;${TARGET}&quot; STREQUAL &quot;unit_test&quot;) )\n   set(GTEST_BASELINE          &quot;casatool&quot;     &quot;rev_0.2&quot;)\nendif()\n\n# \n# Tools to be used by the project they doesn't contains code to be compiled,\n# if a tool contains code then it shall be handled as a module.\n# \nif( (&quot;${COMPILER}&quot; STREQUAL &quot;GNU&quot;) )\nset(TOOLS\n        &quot;GNU_tools&quot;                     &quot;casatool&quot;  &quot;rev_1&quot;\n    )\nendif()\n\n##############################################################################\n# TARGET: unit_test \n##############################################################################\n\n# \n# Specify the common modules that this module requires to compile, in unit\n# test only the header folders will be added, the imlementations must be\n# stubs.\n# \nset(MODULES_unit_test\n    )\n\n# \n# For unit test the local modules refer to the module that is\n# going to be tested, if headers from other modules are required\n# please add the path to INC_DIR\n# \nset(LOCAL_MODULES_unit_test\n    )\n\n# \n# Include only Folders\n# \nset(INC_DIR_unit_test\n        &quot;${CMAKE_CURRENT_LIST_DIR}/src&quot;\n        &quot;${CMAKE_CURRENT_LIST_DIR}/unit_test/src&quot;\n        &quot;${CMAKE_CURRENT_LIST_DIR}/unit_test/stubs&quot;\n        &quot;${CMAKE_CURRENT_LIST_DIR}/../../Common&quot;\n        &quot;${CMAKE_CURRENT_LIST_DIR}/../../../../../tools/dev_tools_ford_autosar_production_sip/BSW/Com&quot;\n        &quot;${CMAKE_CURRENT_LIST_DIR}/../../../../../tools/dev_tools_ford_autosar_production_sip/BSW/Det&quot;\n        #&quot;${CMAKE_CURRENT_LIST_DIR}/../../../../../tools/dev_tools_ford_autosar_production_sip/BSW/Os&quot;\n        &quot;${CMAKE_CURRENT_LIST_DIR}/../../AUTOSAR/Appl/GenData&quot;\n        &quot;${CMAKE_CURRENT_LIST_DIR}/../../AUTOSAR/Appl/GenData/Components&quot;\n        &quot;${CMAKE_CURRENT_LIST_DIR}/../../Startup/include&quot;\n        &quot;${CMAKE_CURRENT_LIST_DIR}/../../../../variants/S32K148/startup&quot;\n        &quot;${CMAKE_CURRENT_LIST_DIR}/../../../../variants/S32K148/include&quot;\n        &quot;${CMAKE_CURRENT_LIST_DIR}/../../CDD/QSPI/include&quot;\n        &quot;${CMAKE_CURRENT_LIST_DIR}/../../CDD/QSPI/include/src&quot;\n        &quot;${CMAKE_CURRENT_LIST_DIR}/../../Common&quot;\n    )\n\n# \n# Directories that contain project specific source.\n# \nset(BIN_SRC_DIR_unit_test\n        &quot;${CMAKE_CURRENT_LIST_DIR}/unit_test/src&quot;\n        &quot;${CMAKE_CURRENT_LIST_DIR}/unit_test/stubs&quot;\n    )\n\n# \n# Specific source files.\n# \nset(BIN_SRC_FILES_unit_test\n   )\n\n# \n# Add here all the custom precompiled libraries specific for\n# your project.\n# \nset(CUSTOM_LIB_unit_test\n    )\n\n##############################################################################\n# Set custom compiler/assembler/linker flags, is important to use\n# PARENT_SCOPE for the variables that are being set to behave properly.\n##############################################################################\nfunction(customConfig)\nendfunction()\n\n##############################################################################\n# Set custom dependencies to the target\n##############################################################################\nfunction(addTargetDependencies)\nendfunction()\n\n##############################################################################\n# This function is invoked after the configuration is done, at this\n# moment the targets are already created.\n##############################################################################\nfunction(postConfig)\nendfunction()\n</code></pre>\n<p>and the CMakelist.txt file is</p>\n<pre><code>cmake_minimum_required(VERSION 3.3 FATAL_ERROR)\n\n#\n# Include the library configuration files.\n#\ninclude(library.cmake)\n\nmessage(&quot;-------------------------------&quot;)\n#\n# Add the source directories to each target\n#\naddFilesToLib(&quot;${LIB_SRC_DIR}&quot; &quot;${LIB_SRC_FILES}&quot;)\n</code></pre>\n<p>When building this we get some error listed below. It looks like some issue with linking, because the error is ld returned 1 exit status.. Error list in detail below</p>\n<pre class=\"lang-none prettyprint-override\"><code>D:\\Sourcetree_gen3_build\\S32K&gt;build.bat avas_platform/app/Test/QSPI_CDD GNU unit_test run\n-- Performing Synchronize...\n-- Configuring done\n-- Generating done\n-- Build files have been written to: D:/Sourcetree_gen3_build/build/avas_platform/app/Test/QSPI_CDD/sync\n-- Building unit_test...\n-------- System Details ---------\nTarget           : unit_test\nOS               : Windows\nCompiler         : GNU\nCompiler Version : 4.9.3\n---------------------------------\n[  0%] Built target SystemDetails\n[ 76%] Built target gtest_unit_test_0\n[ 84%] Linking CXX executable D:\\Sourcetree_gen3_build\\bin\\avas_platform\\app\\Test\\QSPI_CDD\\unit_test\\GNU\\QSPI_CDD.exe\nCMakeFiles\\unit_test.dir/objects.a(SWC_QSPI_CDD_UT.cpp.obj): In function `QSPI_DRV_SetLut':\nD:/Sourcetree_gen3_build/S32K/avas_platform/app/Test/QSPI_CDD/../../CDD/QSPI/include/quadspi_driver.h:346: undefined reference to `g_qspiBase'\nCMakeFiles\\unit_test.dir/objects.a(SWC_QSPI_CDD_UT.cpp.obj): In function `QSPI_DRV_SetAhbSeqId':\nD:/Sourcetree_gen3_build/S32K/avas_platform/app/Test/QSPI_CDD/../../CDD/QSPI/include/quadspi_driver.h:436: undefined reference to `g_qspiBase'\nCMakeFiles\\unit_test.dir/objects.a(SWC_QSPI_CDD_UT.cpp.obj): In function `qspi_drv_transfer':\nD:/Sourcetree_gen3_build/S32K/avas_platform/app/Test/QSPI_CDD/src/qspi_drv.c:922: undefined reference to `QSPI_DRV_IpRead'\nD:/Sourcetree_gen3_build/S32K/avas_platform/app/Test/QSPI_CDD/src/qspi_drv.c:926: undefined reference to `QSPI_DRV_IpWrite'\nCMakeFiles\\unit_test.dir/objects.a(SWC_QSPI_CDD_UT.cpp.obj): In function `Z13qspi_drv_openP19QSPI_DRV_APP_CONFIG':\nD:/Sourcetree_gen3_build/S32K/avas_platform/app/Test/QSPI_CDD/src/qspi_drv.c:1039: undefined reference to `QSPI_DRV_Init'\nCMakeFiles\\unit_test.dir/objects.a(SWC_QSPI_CDD_UT.cpp.obj): In function `Z13qspi_drv_readjPhj':\nD:/Sourcetree_gen3_build/S32K/avas_platform/app/Test/QSPI_CDD/src/qspi_drv.c:1174: undefined reference to `ApplFblTimeDelay(unsigned int)'\nCMakeFiles\\unit_test.dir/objects.a(SWC_QSPI_CDD_UT.cpp.obj): In function `Z14qspi_drv_writejPhj':\nD:/Sourcetree_gen3_build/S32K/avas_platform/app/Test/QSPI_CDD/src/qspi_drv.c:1263: undefined reference to `ApplFblTimeDelay(unsigned int)'\nCMakeFiles\\unit_test.dir/objects.a(SWC_QSPI_CDD_UT.cpp.obj): In function `Z21qspi_drv_send_commandjh':\nD:/Sourcetree_gen3_build/S32K/avas_platform/app/Test/QSPI_CDD/src/qspi_drv.c:1423: undefined reference to `QSPI_DRV_IpCommand'\nCMakeFiles\\unit_test.dir/objects.a(SWC_QSPI_CDD_UT.cpp.obj): In function `Z27qspi_drv_send_erase_commandjh':\nD:/Sourcetree_gen3_build/S32K/avas_platform/app/Test/QSPI_CDD/src/qspi_drv.c:1470: undefined reference to `QSPI_DRV_IpErase'\nD:/Sourcetree_gen3_build/S32K/avas_platform/app/Test/QSPI_CDD/src/qspi_drv.c:1479: undefined reference to `ApplFblTimeDelay(unsigned int)'\nCMakeFiles\\unit_test.dir/objects.a(SWC_QSPI_CDD_UT.cpp.obj): In function `Z16qspi_drv_is_busyj':\nD:/Sourcetree_gen3_build/S32K/avas_platform/app/Test/QSPI_CDD/src/qspi_drv.c:1728: undefined reference to `QSPI_DRV_IpGetStatus'\nCMakeFiles\\unit_test.dir/objects.a(SWC_QSPI_CDD_UT.cpp.obj):SWC_QSPI_CDD_UT.cpp:(.data+0x0): undefined reference to `qspi1_Config0'\ncollect2.exe: error: ld returned 1 exit status\nCMakeFiles\\unit_test.dir\\build.make:124: recipe for target 'D:/Sourcetree_gen3_build/bin/avas_platform/app/Test/QSPI_CDD/unit_test/GNU/QSPI_CDD.exe' failed\nmingw32-make.exe[3]: *** [D:/Sourcetree_gen3_build/bin/avas_platform/app/Test/QSPI_CDD/unit_test/GNU/QSPI_CDD.exe] Error 1\nCMakeFiles\\Makefile2:104: recipe for target 'CMakeFiles/unit_test.dir/all' failed\nmingw32-make.exe[2]: *** [CMakeFiles/unit_test.dir/all] Error 2\nCMakeFiles\\Makefile2:116: recipe for target 'CMakeFiles/unit_test.dir/rule' failed\nmingw32-make.exe[1]: *** [CMakeFiles/unit_test.dir/rule] Error 2\nMakefile:130: recipe for target 'unit_test' failed\nmingw32-make.exe: *** [unit_test] Error 2\n</code></pre>\n<p>I am expecting some kind support to resolve it. Could you please advise me is it the issue of in proper CMakeLists.txt? If so, how can I update my CMakeLists.txt</p>\n"}, {"tags": ["c++", "operator-overloading"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1553091277, "post_id": 55262817, "comment_id": 97257023, "body": "there is already an overload for <code>int</code> plus the one you provided. What are you trying to achieve with the code? If you want to output an <code>xyz</code> then probably you want to write an overload for that type, not for its members"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1553091309, "post_id": 55262817, "comment_id": 97257047, "body": "I&#39;m curious. Assuming you <i>could</i> replace <a href=\"https://en.cppreference.com/w/cpp/io/basic_ostream/operator_ltlt\" rel=\"nofollow noreferrer\">the library provided overload</a> with your own, how do you expect <code>cout&lt;&lt;10+i&lt;&lt;endl;</code> to not recurse without termination?"}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1553091675, "post_id": 55262817, "comment_id": 97257295, "body": "there should also be a line number and file name (and with a navigation if use a good IDE). you can check there are two definition."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1553091902, "post_id": 55262817, "comment_id": 97257453, "body": "tbh it is difficult to answer your question, because its not really clear why there should be no ambiguity ;). Maybe the question would be more clear if you explain why you think you would have to write a <code>&lt;&lt;</code> overload for <code>int</code>"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1553092058, "post_id": 55262817, "comment_id": 97257554, "body": "You cannot just put random code and expect it to work, looks like you do not know what you are trying to do. Seems you try to follow an example but there operator would be overloaded for <code>xyz</code> not for <code>int</code>"}], "answers": [{"tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": false, "score": 2, "last_activity_date": 1553093191, "creation_date": 1553093191, "answer_id": 55263588, "question_id": 55262817, "link": "https://stackoverflow.com/questions/55262817/ambiguous-overload-for-operator/55263588#55263588", "title": "Ambiguous Overload For operator &quot;&lt;&lt;&quot;", "body": "<p>So obviously the problem is that you have written <code>ostream &amp; operator&lt;&lt;(ostream &amp; out , int i)</code> when this already exists. But it's clear that what you meant to write is this</p>\n\n<pre><code>ostream&amp; operator&lt;&lt;(ostream&amp; out, const xyz&amp; a) // overload for xyz not int\n{\n    out&lt;&lt;a.i&lt;&lt;endl; // use out not cout\n    return out;     // and don't forget to return out as well\n}\n</code></pre>\n\n<p>and this</p>\n\n<pre><code>int main()\n{\n    xyz A;\n    A.i=10;\n\n    cout&lt;&lt;A&lt;&lt;endl; // output A not 10\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2123, "user_id": 1964167, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/xAuAQ.png?s=128&g=1", "display_name": "jkj yuio", "link": "https://stackoverflow.com/users/1964167/jkj-yuio"}, "is_accepted": false, "score": -1, "last_activity_date": 1553093225, "creation_date": 1553093225, "answer_id": 55263601, "question_id": 55262817, "link": "https://stackoverflow.com/questions/55262817/ambiguous-overload-for-operator/55263601#55263601", "title": "Ambiguous Overload For operator &quot;&lt;&lt;&quot;", "body": "<pre><code>\n// this include brings std::ostream&amp; operator&lt;&lt;(std::ostream&amp;, int)\n// into scope and therefore you cannot define your own later\n#include&lt;iostream&gt;  \n\nusing namespace std;\nclass xyz\n{\n\n public:\n        int i;\n\n    // needs body \n    friend ostream &amp; operator&lt;&lt;( ostream &amp; Out , int)\n    {\n        return Out;\n    }\n};\n\n\n\n/* cant have this after including ostream\nostream &amp; operator&lt;&lt;(ostream &amp; out , int i)\n{\n    cout&lt;&lt;10+i&lt;&lt;endl;\n}\n*/\n\n\nint main()\n{\n    xyz A;\n    A.i=10;\n\n    cout&lt;&lt;10;\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9272870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f63d6b160f7d8cf537cbf6c60a7a0d7?s=128&d=identicon&r=PG&f=1", "display_name": "Sunny Khandare", "link": "https://stackoverflow.com/users/9272870/sunny-khandare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1836, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1553093515, "creation_date": 1553091141, "last_edit_date": 1553093515, "question_id": 55262817, "link": "https://stackoverflow.com/questions/55262817/ambiguous-overload-for-operator", "title": "Ambiguous Overload For operator &quot;&lt;&lt;&quot;", "body": "<p>I am learning operator overloading in c++ and I want to know the ouput of following code</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\nclass xyz\n{\n\n public:\n        int i;\n\n    friend ostream &amp; operator&lt;&lt;( ostream &amp; Out , int);\n};\n\n\n\nostream &amp; operator&lt;&lt;(ostream &amp; out , int i)\n{\n    cout&lt;&lt;10+i&lt;&lt;endl;\n}\n\n\nint main()\n{\n    xyz A;\n    A.i=10;\n\n    cout&lt;&lt;10;\n}\n</code></pre>\n\n<p>And i got two errors </p>\n\n<ol>\n<li><p>error: ambiguous overload for \u2018operator&lt;&lt;\u2019 (operand types are \u2018std::ostream {aka std::basic_ostream}\u2019 and \u2018int\u2019)\ncout&lt;&lt;10+i;</p></li>\n<li><p>error: ambiguous overload for \u2018operator&lt;&lt;\u2019 (operand types are \u2018std::ostream {aka std::basic_ostream}\u2019 and \u2018int\u2019)\ncout&lt;&lt;10;</p></li>\n</ol>\n\n<p>can anyone explain whats the problem ? </p>\n\n<p>I want to know that what happens if I overload an \"&lt;&lt;\" operator for printing int with only one parameter int(obvious) and I just want to print an number separately like \"cout&lt;&lt;10\" int the above mentioned code.\nSo how compiler will decide that which function should be called when i am trying to print just any integer number.</p>\n"}, {"tags": ["c++", "c++11", "gcc", "c++17", "constexpr"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 8, "creation_date": 1553091645, "post_id": 55262802, "comment_id": 97257272, "body": "<code>constexpr</code> means precisely &quot;evaluate at compile-time (when requested)&quot;. But we had to wait until C++14 to use loops in <code>constexpr</code> functions, hence the conflicting information (your links are for C++11). This is also completely orthogonal to what the optimizer does, as it operates under the <i>as-if</i> rule, and if there&#39;s anything it can do at compile-time it might as well do it."}, {"owner": {"reputation": 1212, "user_id": 1587755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6bfa53480be2aca93ac528eda21a7d3?s=128&d=identicon&r=PG", "display_name": "Taekahn", "link": "https://stackoverflow.com/users/1587755/taekahn"}, "edited": false, "score": 0, "creation_date": 1553765401, "post_id": 55262802, "comment_id": 97508650, "body": "If you tried to compile this on a C++11 compiler, you&#39;d get a compile error about the function not being allowed to be <code>constexpr</code>"}], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553092139, "post_id": 55263094, "comment_id": 97257616, "body": "I am not so sure about the &quot;<b>must</b> be evaluated at compile time&quot; in this context, I am not that experienced with <code>constexpr</code> but the only way to be sure it actually is evalauted at compile time I know is to use it as a template parameter"}, {"owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553092902, "post_id": 55263094, "comment_id": 97258238, "body": "@user463035818 A constexpr variable must be initialised as a constant expression (i.e., able to be evalutated at compile time), and will itself be a constant expression. So it&#39;s value must be known at compile time. The &quot;as-if&quot; rule means that while the compiler could technically evaluate it at run time, it (should) have no effect on your program (apart from the assembly output). But there is no reason for the compiler to do that."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553095353, "post_id": 55263094, "comment_id": 97260066, "body": "after reading <a href=\"https://en.cppreference.com/w/cpp/language/constexpr\" rel=\"nofollow noreferrer\">here</a> again I still think that declaring <code>b</code> as <code>constexpr</code> alone does not necessarily require that it is evaluated at compile time, though I dont see any reason why the compiler shouldnt do it, and I still might misunderstand it"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1553096861, "post_id": 55263094, "comment_id": 97261124, "body": "@user463035818: a constexpr constant can be used as a template parameter. I think this explains that there is no difference between constexpr and template parameter in this regard."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1553097008, "post_id": 55263094, "comment_id": 97261228, "body": "@geza when used a template parameter then there is no doubt, but I am not sure about declaring the variable <code>constexpr</code> alone. Anyhow, sorry for nitpicking on something I am not sure myself, will have to do some reading and experimenting..."}], "tags": [], "owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "is_accepted": false, "score": 9, "last_activity_date": 1553091847, "creation_date": 1553091847, "answer_id": 55263094, "question_id": 55262802, "link": "https://stackoverflow.com/questions/55262802/compile-time-loop-optimisation/55263094#55263094", "title": "Compile-time loop optimisation", "body": "<p>In C++14, <a href=\"https://en.cppreference.com/w/cpp/language/constexpr\" rel=\"noreferrer\"><code>constexpr</code></a> function requirements were relaxed.</p>\n\n<p>Previously, in C++11, constexpr functions could only contain <code>typedef</code>s, <code>static_assert</code>s and <code>using</code>s, but only a single return statement.</p>\n\n<p>In C++14, it became possible to use loops in <code>constexpr</code> function bodies.</p>\n\n<p>Because <code>b</code> was declared as <code>constexpr char</code>, it <em>must</em> be evaluated at compile time. The compiler then optimised out the <code>isStringNice</code> function, as it is not used at run time.</p>\n"}], "owner": {"reputation": 322, "user_id": 10139793, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yniuXUKWXmo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qT8eBjDM6gj4Blo5EcTKkpZLZlQg/mo/photo.jpg?sz=128", "display_name": "eucristian", "link": "https://stackoverflow.com/users/10139793/eucristian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1407, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1553572558, "creation_date": 1553091109, "question_id": 55262802, "link": "https://stackoverflow.com/questions/55262802/compile-time-loop-optimisation", "title": "Compile-time loop optimisation", "body": "<p>I am finding it a bit hard to understand why the following results in a compile time calculation. \nI have read <a href=\"https://akrzemi1.wordpress.com/2011/05/11/parsing-strings-at-compile-time-part-i/\" rel=\"nofollow noreferrer\">this</a>, <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html#Optimize-Options\" rel=\"nofollow noreferrer\">this</a>, <a href=\"https://www.codingame.com/playgrounds/2205/7-features-of-c17-that-will-simplify-your-code/constexpr-if\" rel=\"nofollow noreferrer\">this</a> and \na lot more questions on stackoverflow that tell me the following code( at least to my understanding) should not be computed at compile time because of the while loop (The code is just an example to illustrate the question):</p>\n\n<pre><code>template&lt; unsigned N &gt;\nconstexpr unsigned isStringNice(const char (&amp;arr)[N], unsigned pos = 0)\n{\n    //we do not like the 'D' char :)\n    int currPos = 0;\n    while(currPos &lt; N){\n        if(arr [currPos] == 'D'){\n            throw 1;\n        }\n        currPos ++;\n    }\n    return 1;\n}\nconstexpr unsigned isIdxValid( unsigned idx, unsigned len){\n    return idx &gt;= len?  throw 1 : idx;\n}\n\ntemplate&lt; unsigned N &gt;\nconstexpr char nth_char(const char (&amp;arr)[N], unsigned pos){\n  return  isStringNice(arr),isIdxValid(pos, N),arr[pos];\n}\n\nint main(){\n\n  constexpr char b = nth_char(\"ABC\", 2);\n\n  return b;\n}\n</code></pre>\n\n<p>this outputs with no flag the following <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">assembly</a> code (gcc 8.2 , thank you Godbolt)\nmain:</p>\n\n<pre><code>push    rbp\nmov     rbp, rsp\nmov     BYTE PTR [rbp-1], 67\nmov     eax, 67\npop     rbp\nret\n</code></pre>\n\n<p>and with -O3</p>\n\n<pre><code>main:\n        mov     eax, 67\n        ret\n</code></pre>\n\n<p>Notice as there is no jump in there, no branch on the while condition, nothing. I had the impression that <a href=\"https://www.codeproject.com/Articles/857354/Compile-Time-Loops-with-Cplusplus-Creating-a-Gener\" rel=\"nofollow noreferrer\">for-loops</a> and while loops <a href=\"https://stackoverflow.com/questions/6872919/compile-time-loops\">were not possible</a> to be evaluated at compile time. However, the compiler (gcc 8.2) evaluates the result at compile time. \nMy only thought is this happens because of loop unrolling, so i tried using <code>-fno-unroll-loops</code>, but this results in the same assembly code.On the other hand from my experience,  this flag is more like a compiler suggestion than a guarantee and gcc might still unroll the loop even though the flag is set.</p>\n\n<p><strong>Short version of my question</strong>: How come my while loop in a constexpr function is evaluated at compile time? </p>\n"}, {"tags": ["c++", "random"], "comments": [{"owner": {"reputation": 252, "user_id": 5364211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ixqyo.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5364211/tom"}, "edited": false, "score": 1, "creation_date": 1553090722, "post_id": 55262606, "comment_id": 97256562, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3032726/rand-generating-the-same-number-even-with-srandtimenull-in-my-main\">rand() generating the same number \u2013 even with srand(time(NULL)) in my main!</a>"}, {"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 2, "creation_date": 1553090739, "post_id": 55262606, "comment_id": 97256576, "body": "Global variables are initialized before <code>main</code> is run, i.e. before you call <code>srand</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11232317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sxTHg.png?s=128&g=1", "display_name": "MartienskieNum1", "link": "https://stackoverflow.com/users/11232317/martienskienum1"}, "edited": false, "score": 0, "creation_date": 1553091174, "post_id": 55262681, "comment_id": 97256951, "body": "I applied the suggested code but it still returns &#39;camera&#39; as codeword (index 0). It is an exercise on header files in Codecademy so I suppose that&#39;s why I had to include those functions in the header file"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 11, "user_id": 11232317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sxTHg.png?s=128&g=1", "display_name": "MartienskieNum1", "link": "https://stackoverflow.com/users/11232317/martienskienum1"}, "edited": false, "score": 0, "creation_date": 1553091885, "post_id": 55262681, "comment_id": 97257442, "body": "@MartienskieNum1 If codeacademy is suggesting that you should put non-inline functions in header files then you really need to find a better tutorial."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 11, "user_id": 11232317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sxTHg.png?s=128&g=1", "display_name": "MartienskieNum1", "link": "https://stackoverflow.com/users/11232317/martienskienum1"}, "edited": false, "score": 0, "creation_date": 1553092083, "post_id": 55262681, "comment_id": 97257571, "body": "@MartienskieNum1 Sorry I wasn&#39;t paying attention. It&#39;s basically the same problem again. You are using the <code>rand_number</code> first (in the header file) and the setting it afterwards. Obviously it should be the other way around. See updated answer."}, {"owner": {"reputation": 11, "user_id": 11232317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sxTHg.png?s=128&g=1", "display_name": "MartienskieNum1", "link": "https://stackoverflow.com/users/11232317/martienskienum1"}, "edited": false, "score": 0, "creation_date": 1553092505, "post_id": 55262681, "comment_id": 97257890, "body": "Your modification fixed it, thanks a lot :) and what are non-inline functions then?"}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": true, "score": 2, "last_activity_date": 1553091992, "last_edit_date": 1553091992, "creation_date": 1553090800, "answer_id": 55262681, "question_id": 55262606, "link": "https://stackoverflow.com/questions/55262606/using-srandtimenull-gives-same-output-each-time-my-program-is-run-not-in-lo/55262681#55262681", "title": "Using srand(time(NULL)) gives same output each time my program is run (not in loop, seeded with large enough values)", "body": "<p>It's a problem of timing. The random number expression in your header is executed before the random number generator seeding code in your <code>main</code> function. Change your code like this</p>\n\n<pre><code>// header\nint rand_number;\nstd::string codeword;\n\n// source\nint main() {\n    srand (time(NULL));\n    rand_number = rand() % codewords.size();\n    codeword = codewords[rand_number];\n</code></pre>\n\n<p>Now the random number is generated after the random number generator has been seeded.</p>\n\n<p>PS why are the <code>take_turn</code> and <code>display</code> functions in your header file? Functions (unless they are inline) should be placed in source files.</p>\n"}], "owner": {"reputation": 11, "user_id": 11232317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sxTHg.png?s=128&g=1", "display_name": "MartienskieNum1", "link": "https://stackoverflow.com/users/11232317/martienskienum1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "closed_date": 1553215396, "accepted_answer_id": 55262681, "answer_count": 1, "score": -1, "last_activity_date": 1553092186, "creation_date": 1553090604, "last_edit_date": 1553092186, "question_id": 55262606, "link": "https://stackoverflow.com/questions/55262606/using-srandtimenull-gives-same-output-each-time-my-program-is-run-not-in-lo", "closed_reason": "Not suitable for this site", "title": "Using srand(time(NULL)) gives same output each time my program is run (not in loop, seeded with large enough values)", "body": "<p>I've been following lessons in Codecademy to learn C++. I've come to the last project where I learned to make a program that works like hangman. I wanted to add a list of words from which the program chooses a new word each time the program is run. (line 5)</p>\n\n<pre><code>#include \"ufo.hpp\"\n\nint main() {\n\n  srand (time(NULL));\n\n  std::cout &lt;&lt; \"=============\\n\";\n  std::cout &lt;&lt; \"UFO: The Game\\n\";\n  std::cout &lt;&lt; \"=============\\n\";\n  std::cout &lt;&lt; \"Instructions: save your friend from alien\\nabduction by guessing the letters in the\\ncodeword.\\n\";\n\n  for (int i = 0; i &lt; codeword.size(); i++) {\n      answer.append(\"_\");\n  }\n\n  while (answer != codeword &amp;&amp; misses &lt;= 6) {\n      take_turn();\n  }\n\n  if (answer == codeword) {\n      std::cout &lt;&lt; \"Hooray! You saved the person and earned a medal of honor!\\n\";\n  } else {\n      std::cout &lt;&lt; \"Oh no! The UFO just flew away with another person!\\n\";\n      std::cout &lt;&lt; \"The codeword was: \" &lt;&lt; codeword &lt;&lt; \"\\n\";\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>In the code above, I used <code>srand(time(NULL))</code> in the <code>main</code> function. The <code>rand_number</code> variable can be found in the following header: (line 11)</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nvoid display(int misses);\n\n// Declare variables\n\nstd::vector&lt;std::string&gt; codewords = {\"camera\", \"computer\", \"table\", \"desk\", \"bed\", \"chair\", \"drawer\", \"button\", \"elephant\", \"mouse\", \"printer\", \"soap\", \"toothbrush\", \"pillow\", \"curtain\", \"wall\", \"roof\", \"poster\", \"grasland\", \"woodpecker\", \"jacket\", \"trousers\", \"waterfall\", \"softdrink\", \"laundry\"};\nint rand_number = rand() % codewords.size();\n\nstd::string codeword = codewords[rand_number];\nstd::string answer;\nint misses = 0;\nstd::vector&lt;char&gt; incorrect;\nbool guess = false;\nchar letter;\n\n// Define take_turn()\n\nvoid take_turn() {\n\n  display(misses);\n\n  std::cout &lt;&lt; \"Please enter your guess: \";\n  std::cin &gt;&gt; letter;\n\n  for (int i = 0; i &lt; codeword.size(); i++) {\n    if (letter == codeword[i]) {\n      answer[i] = letter;\n      guess = true;\n    }\n  }\n\n  if (guess) {\n    std::cout &lt;&lt; \"Correct!\\n\";\n  } else {\n    std::cout &lt;&lt; \"Incorrect! The tractor beam pulls the person in further.\\n\";\n    incorrect.push_back(letter);\n    misses++;\n  }\n\n  std::cout &lt;&lt; \"==========================\\n\";\n\n  std::cout &lt;&lt; \"Incorrect Guesses:\\n\";\n  for (int i = 0; i &lt; incorrect.size(); i++) {\n    std::cout &lt;&lt; incorrect[i] &lt;&lt; \" \";\n  }\n\n  std::cout &lt;&lt; \"\\nCodeword:\\n\";\n\n  for (int i = 0; i &lt; answer.size(); i++) {\n    std::cout &lt;&lt; answer[i] &lt;&lt; \" \";\n  }\n\n  std::cout &lt;&lt; \"\\n\";\n\n  guess = false;\n}\n\n\n\nvoid display(int misses) {\n\nif (misses == 0 || misses == 1) {\n\nstd::cout &lt;&lt; \"                 .                            \\n\";\nstd::cout &lt;&lt; \"                 |                            \\n\";\nstd::cout &lt;&lt; \"              .-\\\"^\\\"-.                       \\n\";\nstd::cout &lt;&lt; \"             /_....._\\\\                       \\n\";\nstd::cout &lt;&lt; \"         .-\\\"`         `\\\"-.                  \\n\";\nstd::cout &lt;&lt; \"        (  ooo  ooo  ooo  )                   \\n\";\nstd::cout &lt;&lt; \"         '-.,_________,.-'    ,-----------.   \\n\";\nstd::cout &lt;&lt; \"              /     \\\\        (  Send help! ) \\n\";\nstd::cout &lt;&lt; \"             /   0   \\\\      / `-----------'  \\n\";\nstd::cout &lt;&lt; \"            /  --|--  \\\\    /                 \\n\";\nstd::cout &lt;&lt; \"           /     |     \\\\                     \\n\";\nstd::cout &lt;&lt; \"          /     / \\\\     \\\\                   \\n\";\nstd::cout &lt;&lt; \"         /               \\\\                   \\n\";\n\n} else if (misses == 2) {\n\nstd::cout &lt;&lt; \"                 .                            \\n\";\nstd::cout &lt;&lt; \"                 |                            \\n\";\nstd::cout &lt;&lt; \"              .-\\\"^\\\"-.                       \\n\";\nstd::cout &lt;&lt; \"             /_....._\\\\                       \\n\";\nstd::cout &lt;&lt; \"         .-\\\"`         `\\\"-.                  \\n\";\nstd::cout &lt;&lt; \"        (  ooo  ooo  ooo  )                   \\n\";\nstd::cout &lt;&lt; \"         '-.,_________,.-'    ,-----------.   \\n\";\nstd::cout &lt;&lt; \"              /  0  \\\\        (  Send help! ) \\n\";\nstd::cout &lt;&lt; \"             / --|-- \\\\      / `-----------'  \\n\";\nstd::cout &lt;&lt; \"            /    |    \\\\    /                 \\n\";\nstd::cout &lt;&lt; \"           /    / \\\\    \\\\                    \\n\";\nstd::cout &lt;&lt; \"          /             \\\\                    \\n\";\nstd::cout &lt;&lt; \"         /               \\\\                   \\n\";\n\n} else if (misses == 3) {\n\nstd::cout &lt;&lt; \"                 .                            \\n\";\nstd::cout &lt;&lt; \"                 |                            \\n\";\nstd::cout &lt;&lt; \"              .-\\\"^\\\"-.                       \\n\";\nstd::cout &lt;&lt; \"             /_....._\\\\                       \\n\";\nstd::cout &lt;&lt; \"         .-\\\"`         `\\\"-.                  \\n\";\nstd::cout &lt;&lt; \"        (  ooo  ooo  ooo  )                   \\n\";\nstd::cout &lt;&lt; \"         '-.,_________,.-'    ,-----------.   \\n\";\nstd::cout &lt;&lt; \"              /--|--\\\\        (  Send help! ) \\n\";\nstd::cout &lt;&lt; \"             /   |   \\\\      / `-----------'  \\n\";\nstd::cout &lt;&lt; \"            /   / \\\\   \\\\    /                \\n\";\nstd::cout &lt;&lt; \"           /           \\\\                     \\n\";\nstd::cout &lt;&lt; \"          /             \\\\                    \\n\";\nstd::cout &lt;&lt; \"         /               \\\\                   \\n\";\n\n} else if (misses == 4) {\n\nstd::cout &lt;&lt; \"                 .                            \\n\";\nstd::cout &lt;&lt; \"                 |                            \\n\";\nstd::cout &lt;&lt; \"              .-\\\"^\\\"-.                       \\n\";\nstd::cout &lt;&lt; \"             /_....._\\\\                       \\n\";\nstd::cout &lt;&lt; \"         .-\\\"`         `\\\"-.                  \\n\";\nstd::cout &lt;&lt; \"        (  ooo  ooo  ooo  )                   \\n\";\nstd::cout &lt;&lt; \"         '-.,_________,.-'    ,-----------.   \\n\";\nstd::cout &lt;&lt; \"              /  |  \\\\        (  Send help! ) \\n\";\nstd::cout &lt;&lt; \"             /  / \\\\  \\\\      / `-----------' \\n\";\nstd::cout &lt;&lt; \"            /         \\\\    /                 \\n\";\nstd::cout &lt;&lt; \"           /           \\\\                     \\n\";\nstd::cout &lt;&lt; \"          /             \\\\                    \\n\";\nstd::cout &lt;&lt; \"         /               \\\\                   \\n\";\n\n} else if (misses == 5) {\n\nstd::cout &lt;&lt; \"                 .                            \\n\";\nstd::cout &lt;&lt; \"                 |                            \\n\";\nstd::cout &lt;&lt; \"              .-\\\"^\\\"-.                       \\n\";\nstd::cout &lt;&lt; \"             /_....._\\\\                       \\n\";\nstd::cout &lt;&lt; \"         .-\\\"`         `\\\"-.                  \\n\";\nstd::cout &lt;&lt; \"        (  ooo  ooo  ooo  )                   \\n\";\nstd::cout &lt;&lt; \"         '-.,_________,.-'    ,-----------.   \\n\";\nstd::cout &lt;&lt; \"              / / \\\\ \\\\        (  Send help! )\\n\";\nstd::cout &lt;&lt; \"             /       \\\\      / `-----------'  \\n\";\nstd::cout &lt;&lt; \"            /         \\\\    /                 \\n\";\nstd::cout &lt;&lt; \"           /           \\\\                     \\n\";\nstd::cout &lt;&lt; \"          /             \\\\                    \\n\";\nstd::cout &lt;&lt; \"         /               \\\\                   \\n\";\n\n} else if (misses == 6) {\n\nstd::cout &lt;&lt; \"                 .                            \\n\";\nstd::cout &lt;&lt; \"                 |                            \\n\";\nstd::cout &lt;&lt; \"              .-\\\"^\\\"-.                       \\n\";\nstd::cout &lt;&lt; \"             /_....._\\\\                       \\n\";\nstd::cout &lt;&lt; \"         .-\\\"`         `\\\"-.                  \\n\";\nstd::cout &lt;&lt; \"        (  ooo  ooo  ooo  )                   \\n\";\nstd::cout &lt;&lt; \"         '-.,_________,.-'    ,-----------.   \\n\";\nstd::cout &lt;&lt; \"              /     \\\\        (  Send help! ) \\n\";\nstd::cout &lt;&lt; \"             /       \\\\      / `-----------'  \\n\";\nstd::cout &lt;&lt; \"            /         \\\\    /                 \\n\";\nstd::cout &lt;&lt; \"           /           \\\\                     \\n\";\nstd::cout &lt;&lt; \"          /             \\\\                    \\n\";\nstd::cout &lt;&lt; \"         /               \\\\                   \\n\";\n\n}\n}\n</code></pre>\n\n<p>I haven't been coding for too long so tips are always welcome</p>\n"}, {"tags": ["c++", "visual-studio", "class", "methods"], "comments": [{"owner": {"reputation": 1409, "user_id": 5306400, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5df67f97524f2c76853231f0b9f0e986?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/5306400/max"}, "edited": false, "score": 0, "creation_date": 1553090072, "post_id": 55262315, "comment_id": 97256158, "body": "Change the method definition to myClass1&amp; getmyClass1(){...}"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1553090121, "post_id": 55262315, "comment_id": 97256189, "body": "btw once you return a reference from <code>getmyClass1</code> it will become rather pointless to make the <code>class1</code> member <code>private</code>. Instead of using a method to return a (non-const) reference you can make it public as well"}, {"owner": {"reputation": 135, "user_id": 10944850, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MGdllAwiEcE/AAAAAAAAAAI/AAAAAAAAAF0/oOwn6Rtxwbw/photo.jpg?sz=128", "display_name": "\u0645\u062d\u0645\u062f \u062e\u064a\u0631 \u0627\u0644\u062e\u0644\u0642", "link": "https://stackoverflow.com/users/10944850/%d9%85%d8%ad%d9%85%d8%af-%d8%ae%d9%8a%d8%b1-%d8%a7%d9%84%d8%ae%d9%84%d9%82"}, "reply_to_user": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 0, "creation_date": 1553090130, "post_id": 55262315, "comment_id": 97256196, "body": "@BoBTFish I get this error: &quot;Error\t1\terror LNK2019: unresolved external symbol &quot;public: __thiscall myClass2::myClass2(void)&quot; (??0myClass2@@QAE@XZ) referenced in function _main\tC:\\Users\\Ahmed\\Desktop\\VB\\Test2\\Test2\\Main.obj\tTest2 &quot;"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1553090160, "post_id": 55262315, "comment_id": 97256214, "body": "You forgot to define the default constructors. You will encounter the same error if you remove the line that you assumed to be the problem."}, {"owner": {"reputation": 135, "user_id": 10944850, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MGdllAwiEcE/AAAAAAAAAAI/AAAAAAAAAF0/oOwn6Rtxwbw/photo.jpg?sz=128", "display_name": "\u0645\u062d\u0645\u062f \u062e\u064a\u0631 \u0627\u0644\u062e\u0644\u0642", "link": "https://stackoverflow.com/users/10944850/%d9%85%d8%ad%d9%85%d8%af-%d8%ae%d9%8a%d8%b1-%d8%a7%d9%84%d8%ae%d9%84%d9%82"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1553090306, "post_id": 55262315, "comment_id": 97256307, "body": "@molbdnilo, Do I need to add them? I&#39;ve used a myClass1(); and myClass2(); as constructor to be able to create them, their attributes have default values."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1553090351, "post_id": 55262315, "comment_id": 97256327, "body": "Those are declarations, not definitions. A function body that doesn&#39;t do anything looks like <code>{}</code>, not like <code>;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 10944850, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MGdllAwiEcE/AAAAAAAAAAI/AAAAAAAAAF0/oOwn6Rtxwbw/photo.jpg?sz=128", "display_name": "\u0645\u062d\u0645\u062f \u062e\u064a\u0631 \u0627\u0644\u062e\u0644\u0642", "link": "https://stackoverflow.com/users/10944850/%d9%85%d8%ad%d9%85%d8%af-%d8%ae%d9%8a%d8%b1-%d8%a7%d9%84%d8%ae%d9%84%d9%82"}, "edited": false, "score": 0, "creation_date": 1553090691, "post_id": 55262497, "comment_id": 97256538, "body": "Thanks a lot, so I guess the main problem was I forgot to add {} after myClass2() and after myClass1()  right?"}, {"owner": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 0, "creation_date": 1553090815, "post_id": 55262497, "comment_id": 97256645, "body": "The problem is that these functions are <b>declared</b> but not <b>defined</b>. Basically, you say &quot;this function should exist&quot;, but it actually does not! Another solution would be to make them have <b>default</b> definitions: <code>myClass1() = default;</code>"}, {"owner": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 2, "creation_date": 1553090966, "post_id": 55262497, "comment_id": 97256783, "body": "I suspect your answer is getting downvotes because you don&#39;t actually explain the problem, or the reason your fix works. A good answer would help the asker understand, not just give something to copy/paste. That said, it is bad manners to drive-by downvote!"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553090981, "post_id": 55262497, "comment_id": 97256799, "body": "other than no explanation, messed up intendation and pretending to be encapsulated when it is not, I dont understand the downvotes ;)"}, {"owner": {"reputation": 549, "user_id": 6911200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05be3c3f1ae8e8eaab9648064182b932?s=128&d=identicon&r=PG&f=1", "display_name": "NelDav", "link": "https://stackoverflow.com/users/6911200/neldav"}, "edited": false, "score": 0, "creation_date": 1553091009, "post_id": 55262497, "comment_id": 97256820, "body": "I have a question about that. myClass1() and myClass2() is the contructor, if I don&#39;t define them, would that mean, that the compiler takes the standardt contructor? Or does class1 and class2 does not exist?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 549, "user_id": 6911200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05be3c3f1ae8e8eaab9648064182b932?s=128&d=identicon&r=PG&f=1", "display_name": "NelDav", "link": "https://stackoverflow.com/users/6911200/neldav"}, "edited": false, "score": 0, "creation_date": 1553091086, "post_id": 55262497, "comment_id": 97256879, "body": "@Ahrtaler a declaration is like a promise to the compiler that you will provide the definition, the exception is to delcare it as <code>= default</code> in which case the compiler will still provide the definition"}, {"owner": {"reputation": 549, "user_id": 6911200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05be3c3f1ae8e8eaab9648064182b932?s=128&d=identicon&r=PG&f=1", "display_name": "NelDav", "link": "https://stackoverflow.com/users/6911200/neldav"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553091495, "post_id": 55262497, "comment_id": 97257167, "body": "@user463035818 My compiler don&#39;t throw an error if I create a consturctor without an definition. Checked that a seccond ago. But I didn&#39;t checked, what happen if I call this consturctor. I think a runtimeexception would be the result. But I am not sure about that."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 549, "user_id": 6911200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05be3c3f1ae8e8eaab9648064182b932?s=128&d=identicon&r=PG&f=1", "display_name": "NelDav", "link": "https://stackoverflow.com/users/6911200/neldav"}, "edited": false, "score": 0, "creation_date": 1553091598, "post_id": 55262497, "comment_id": 97257243, "body": "@Ahrtaler if you dont call it, there is no problem, definition and declaration can be in different places. If you call it you get a linker error (the one you got in your example above, dont really understand why you think you need to test again ;)"}, {"owner": {"reputation": 549, "user_id": 6911200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05be3c3f1ae8e8eaab9648064182b932?s=128&d=identicon&r=PG&f=1", "display_name": "NelDav", "link": "https://stackoverflow.com/users/6911200/neldav"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553091670, "post_id": 55262497, "comment_id": 97257290, "body": "@user463035818 Oh I hadn&#39;t seen that link error. Yes that makes sense."}], "tags": [], "owner": {"reputation": 2123, "user_id": 1964167, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/xAuAQ.png?s=128&g=1", "display_name": "jkj yuio", "link": "https://stackoverflow.com/users/1964167/jkj-yuio"}, "is_accepted": false, "score": -2, "last_activity_date": 1553090329, "creation_date": 1553090329, "answer_id": 55262497, "question_id": 55262315, "link": "https://stackoverflow.com/questions/55262315/call-method-of-a-class-inside-of-another-c/55262497#55262497", "title": "Call method of a class inside of another C++", "body": "<p>See changes marked <code>HERE</code></p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nclass myClass1{\n\n    int myVar = 5;\n    public:\n    myClass1() {} // HERE\n\n        myClass1(int x){ myVar = x; }\n\n        int getmyVar(){ return myVar; }\n        void setmyVar(int y){ myVar = y; }\n\n\n};\n\nclass myClass2{\n\n    int myScore = 10;\n    myClass1 class1;\npublic:\n    myClass2() {} // HERE\n\n    myClass2(int x){ myScore = x; }\n\n    int getmyScore(){ return myScore; }\n    void setmyScore(int y){ myScore = y; }\n    myClass1&amp; getmyClass1(){ return class1; }  // HERE\n\n\n};\n\nint main(){\n\n    myClass2 class2;\n    class2.getmyClass1().setmyVar(40);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 10944850, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MGdllAwiEcE/AAAAAAAAAAI/AAAAAAAAAF0/oOwn6Rtxwbw/photo.jpg?sz=128", "display_name": "\u0645\u062d\u0645\u062f \u062e\u064a\u0631 \u0627\u0644\u062e\u0644\u0642", "link": "https://stackoverflow.com/users/10944850/%d9%85%d8%ad%d9%85%d8%af-%d8%ae%d9%8a%d8%b1-%d8%a7%d9%84%d8%ae%d9%84%d9%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1553090329, "creation_date": 1553089746, "last_edit_date": 1553090183, "question_id": 55262315, "link": "https://stackoverflow.com/questions/55262315/call-method-of-a-class-inside-of-another-c", "title": "Call method of a class inside of another C++", "body": "<p>I'm trying to set a value for the variable myVar (located inside the myClass1) from  myClass2 (as an intermediate class). However I get a compile error.\nHere is my attempt so far:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nclass myClass1{\n\n    int myVar = 5;\n    public:\n        myClass1();\n\n        myClass1(int x){ myVar = x; }\n\n        int getmyVar(){ return myVar; }\n        void setmyVar(int y){ myVar = y; }\n\n\n};\n\nclass myClass2{\n\n    int myScore = 10;\n    myClass1 class1;\npublic:\n    myClass2();\n\n    myClass2(int x){ myScore = x; }\n\n    int getmyScore(){ return myScore; }\n    void setmyScore(int y){ myScore = y; }\n    myClass1 getmyClass1(){ return class1; }\n\n\n};\n\nint main(){\n\n    myClass2 class2;\n    class2.getmyClass1().setmyVar(40);\n\n    return 0;\n}\n</code></pre>\n\n<p>The error is:</p>\n\n<pre><code>Error 1 error LNK2019: unresolved external symbol \"public: __thiscall myClass2::myClass2(void)\" (??0myClass2@@QAE@XZ) referenced in function _main C:\\Users\\Ahmed\\Desktop\\VB\\Test2\\Test2\\Main.obj Test2\n</code></pre>\n"}, {"tags": ["c++", "opencv", "duplicates", "multimap", "std-pair"], "comments": [{"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 0, "creation_date": 1553104788, "post_id": 55262314, "comment_id": 97265939, "body": "Just to be sure, if your points are at the same x and y is 0, 0.9, 1.8, 2.7, 3.6, ... will they all fall in the same tuple/cluster? Regardless with the order with which they appear?"}, {"owner": {"reputation": 664, "user_id": 5707440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54a4defbda5f9d7982bde84371a83c87?s=128&d=identicon&r=PG&f=1", "display_name": "Grillteller", "link": "https://stackoverflow.com/users/5707440/grillteller"}, "reply_to_user": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 0, "creation_date": 1553440670, "post_id": 55262314, "comment_id": 97376614, "body": "x and y have to have a smaller difference than 1. Then they fall into the same cluster."}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 0, "creation_date": 1553454761, "post_id": 55262314, "comment_id": 97381001, "body": "So in my example above you will have a single cluster?"}], "answers": [{"comments": [{"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 0, "creation_date": 1553454717, "post_id": 55276453, "comment_id": 97380984, "body": "The OP doesn&#39;t want to find duplicates."}, {"owner": {"reputation": 1574, "user_id": 10911905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/464f9d95f48b6f1d2ab156181e59c05a?s=128&d=identicon&r=PG&f=1", "display_name": "Nuzhny", "link": "https://stackoverflow.com/users/10911905/nuzhny"}, "reply_to_user": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 0, "creation_date": 1553458963, "post_id": 55276453, "comment_id": 97382226, "body": "@CostantinoGrana Read, plz, 2 last words: &quot;Form triples/quadruples of integers and delete duplicates&quot;"}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 0, "creation_date": 1553459912, "post_id": 55276453, "comment_id": 97382444, "body": "Check his code. Ad his clarification: &quot;x and y have to have a smaller difference than 1. Then they fall into the same cluster.&quot; Your solution works just for exact duplicates."}], "tags": [], "owner": {"reputation": 1574, "user_id": 10911905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/464f9d95f48b6f1d2ab156181e59c05a?s=128&d=identicon&r=PG&f=1", "display_name": "Nuzhny", "link": "https://stackoverflow.com/users/10911905/nuzhny"}, "is_accepted": false, "score": -1, "last_activity_date": 1553157402, "creation_date": 1553157402, "answer_id": 55276453, "question_id": 55262314, "link": "https://stackoverflow.com/questions/55262314/form-triples-quadruples-of-integers-and-delete-duplicates/55276453#55276453", "title": "Form triples/quadruples of integers and delete duplicates", "body": "<p>You need to create a good index for coordinates. For example:</p>\n\n<pre><code>int64 ind = (((int64)cvRound(p.x)) &lt;&lt; 32) | ((int64)cvRound(p.y));\n</code></pre>\n\n<p>And use one std::map for search duplicates.</p>\n"}, {"comments": [{"owner": {"reputation": 664, "user_id": 5707440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54a4defbda5f9d7982bde84371a83c87?s=128&d=identicon&r=PG&f=1", "display_name": "Grillteller", "link": "https://stackoverflow.com/users/5707440/grillteller"}, "edited": false, "score": 0, "creation_date": 1553591728, "post_id": 55349495, "comment_id": 97430683, "body": "Someone mentioned that in the first comment of the question but it was deleted (perhaps by himself?) very fast. You provide an answer to the question because I asked if there is a smarter approach, though it looks quite complicated ;). But I will try."}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "reply_to_user": {"reputation": 664, "user_id": 5707440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54a4defbda5f9d7982bde84371a83c87?s=128&d=identicon&r=PG&f=1", "display_name": "Grillteller", "link": "https://stackoverflow.com/users/5707440/grillteller"}, "edited": false, "score": 1, "creation_date": 1553618269, "post_id": 55349495, "comment_id": 97448222, "body": "@Grillteller It is not so complicated. But having already done it before definitely helps! In the edited answer you can find a complete solution. I&#39;m not claiming this is the best you can do, but at least it solves your problem. I&#39;m pretty sure someone has already proposed more efficient algorithms."}], "tags": [], "owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "is_accepted": true, "score": 1, "last_activity_date": 1553618164, "last_edit_date": 1553618164, "creation_date": 1553571412, "answer_id": 55349495, "question_id": 55262314, "link": "https://stackoverflow.com/questions/55262314/form-triples-quadruples-of-integers-and-delete-duplicates/55349495#55349495", "title": "Form triples/quadruples of integers and delete duplicates", "body": "<p>Ok, since you didn't follow up on my second comment, I'll go with the answer. Your question was \"Is there are smarter approach that the one I am using?\" and the answer is \"Yes\", because your code is not doing the task it is supposed to do. </p>\n\n<p>You want to cluster elements which fall in a square of side 1. Then these points:</p>\n\n<pre><code>matched_points.push_back(std::make_pair(100, cv::Point2d(0.0, 0.0 )));\nmatched_points.push_back(std::make_pair(101, cv::Point2d(0.0, 0.9 )));\nmatched_points.push_back(std::make_pair(102, cv::Point2d(0.0, 1.8 )));\nmatched_points.push_back(std::make_pair(103, cv::Point2d(0.0, 2.7 )));\nmatched_points.push_back(std::make_pair(104, cv::Point2d(0.0, 3.6 )));\nmatched_points.push_back(std::make_pair(105, cv::Point2d(0.0, 4.5 )));\nmatched_points.push_back(std::make_pair(106, cv::Point2d(0.0, 5.4 )));\n\nmatched_points.push_back(std::make_pair(200, cv::Point2d(0.0,  6.3)));\nmatched_points.push_back(std::make_pair(201, cv::Point2d(0.0,  7.2)));\nmatched_points.push_back(std::make_pair(202, cv::Point2d(0.0,  8.1)));\nmatched_points.push_back(std::make_pair(203, cv::Point2d(0.0,  9.0)));\nmatched_points.push_back(std::make_pair(204, cv::Point2d(0.0,  9.9)));\nmatched_points.push_back(std::make_pair(205, cv::Point2d(0.0, 10.8)));\nmatched_points.push_back(std::make_pair(206, cv::Point2d(0.0, 11.6)));\n</code></pre>\n\n<p>should all fall in one single cluster. Given your output, it's not the case.</p>\n\n<p>So the problem here is that you are failing to repeatedly join sets of points together. This is a very famous problem called <a href=\"https://en.wikipedia.org/wiki/Disjoint-set_data_structure\" rel=\"nofollow noreferrer\">Disjoint-set data structure</a> and in fact it is used to find the connected components of a graph. </p>\n\n<p>In your case you should use the first part of your code to create the edge matrix of a graph, then find its connected-components with the union-find algorithm.</p>\n\n<h1>Implementing Union-Find</h1>\n\n<p>Here you can find an example implementation of the Union-Find data structure based on indices, which map to the points in your vector. Not so smart, but it should work.</p>\n\n<pre><code>// Union-find (UF)\nstruct UF {\n    std::vector&lt;int&gt; P_;\n\n    UF(size_t size) : P_(size) {\n        iota(begin(P_), end(P_), 0);\n    }\n\n    int operator[](int i) {\n        return P_[i];\n    }\n\n    void Merge(int i, int j) {\n        // FindRoot(i)\n        while (P_[i] &lt; i) {\n            i = P_[i];\n        }\n\n        // FindRoot(j)\n        while (P_[j] &lt; j) {\n            j = P_[j];\n        }\n\n        if (i &lt; j)\n            P_[j] = i;\n        else\n            P_[i] = j;\n    }\n\n    int Flatten() {\n        int k = 0;\n        int size = P_.size();\n        for (int i = 0; i &lt; size; ++i) {\n            if (P_[i] &lt; i) {\n                P_[i] = P_[P_[i]];\n            }\n            else {\n                P_[i] = k;\n                k = k + 1;\n            }\n        }\n        return k;\n    }\n};\n</code></pre>\n\n<h1>Finding connected components</h1>\n\n<p>The trick is to build the adjacency matrix (who is connected to who) and while doing this, if two elements are connected merge their sets. The flatten operation, simply renumbers the sets from 0 to n-1, so it's easier to remap your elements to their clusters.</p>\n\n<pre><code>int main(int argc, char** argv)\n{\n    using elem = std::pair&lt;int, cv::Point2d&gt;;\n    std::vector&lt;elem&gt; matched_points;\n\n    // fill the matched_points vector here\n\n    auto connected = [](const elem&amp; a, const elem&amp; b) {\n        return abs(a.second.x - b.second.x) &lt; 1 &amp;&amp; (abs(a.second.y - b.second.y)) &lt; 1;\n    };\n\n    UF uf(matched_points.size());\n    for (size_t i = 0; i &lt; matched_points.size() - 1; ++i) {\n        for (size_t j = i + 1; j &lt; matched_points.size(); ++j) {\n            if (connected(matched_points[i], matched_points[j])) {\n                uf.Merge(i, j);\n            }\n        }\n    }\n    int ncc = uf.Flatten();\n\n    std::vector&lt;std::vector&lt;elem&gt;&gt; clusters(ncc);\n    for (size_t i = 0; i &lt; matched_points.size(); ++i) {\n        clusters[uf[i]].push_back(matched_points[i]);\n    }\n}\n</code></pre>\n\n<p>The clusters vector will contain vectors of points connected together (in no particular order).</p>\n"}], "owner": {"reputation": 664, "user_id": 5707440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54a4defbda5f9d7982bde84371a83c87?s=128&d=identicon&r=PG&f=1", "display_name": "Grillteller", "link": "https://stackoverflow.com/users/5707440/grillteller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 55349495, "answer_count": 2, "score": 0, "last_activity_date": 1553618164, "creation_date": 1553089745, "question_id": 55262314, "link": "https://stackoverflow.com/questions/55262314/form-triples-quadruples-of-integers-and-delete-duplicates", "title": "Form triples/quadruples of integers and delete duplicates", "body": "<p>I am comparing coordinates of points. When the coordinates are similar, the respecting Point IDs (e.g. 102 and 202) are saved in a multimap structure.<br>\nIf another Point has similar coordinates (e.g. ID 302) I want to form a Point ID triple (quadruple...) and so on.\nThe problem I have, is that ID 202 and ID 302 will also form a pair that is already in my triple. So I have to delete that pair. I only want to keep the largest sequence.<br>\nRight now I am using a combination of vectors, multimaps and multimap iterators and it seems quite bulky for such a \"simple\" operation.<br>\nIs there are smarter approach that the one I am using?</p>\n\n<p>Here is the working code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;opencv2/highgui/highgui.hpp&gt;\n#include &lt;opencv2/core/core.hpp&gt;\n#include &lt;opencv2/imgproc/imgproc.hpp&gt;\n#include &lt;map&gt;\n\nint main(int argc, char** argv)\n{\n    std::vector&lt;std::pair&lt;int, cv::Point2d&gt;&gt; matched_points;\n\n    matched_points.push_back(std::make_pair(100, cv::Point2d(260.103, 1335.96)));\n    matched_points.push_back(std::make_pair(101, cv::Point2d(238.017, 1313.15)));\n    matched_points.push_back(std::make_pair(102, cv::Point2d(112.052, 1338)));\n    matched_points.push_back(std::make_pair(103, cv::Point2d(326.396, 1301.1)));\n    matched_points.push_back(std::make_pair(104, cv::Point2d(328.225, 1302.48)));\n    matched_points.push_back(std::make_pair(105, cv::Point2d(259.943, 1386.1)));\n    matched_points.push_back(std::make_pair(106, cv::Point2d(1033.7, 1197.04)));\n\n    matched_points.push_back(std::make_pair(200, cv::Point2d(1430.65, 1304.55)));\n    matched_points.push_back(std::make_pair(201, cv::Point2d(1185.66, 1032.1)));\n    matched_points.push_back(std::make_pair(202, cv::Point2d(112.052, 1338)));\n    matched_points.push_back(std::make_pair(203, cv::Point2d(326.396, 1301.1)));\n    matched_points.push_back(std::make_pair(204, cv::Point2d(328.225, 1302.48)));\n    matched_points.push_back(std::make_pair(205, cv::Point2d(259.943, 1386.1)));\n    matched_points.push_back(std::make_pair(206, cv::Point2d(1033.7, 1197.04)));\n\n    matched_points.push_back(std::make_pair(300, cv::Point2d(1430.65, 1304.55)));\n    matched_points.push_back(std::make_pair(301, cv::Point2d(1185.66, 1032.1)));\n    matched_points.push_back(std::make_pair(302, cv::Point2d(112.052, 1338)));\n    matched_points.push_back(std::make_pair(303, cv::Point2d(326.396, 1301.1)));\n    matched_points.push_back(std::make_pair(304, cv::Point2d(328.225, 1302.48)));\n    matched_points.push_back(std::make_pair(305, cv::Point2d(259.943, 1386.1)));\n    matched_points.push_back(std::make_pair(306, cv::Point2d(1033.7, 1197.04)));\n\n    // Possibly adding more points (400s, 500s ...)\n\n    // Save integer numbers of matching points\n    std::multimap&lt;int, int&gt; matches_map;\n    for (size_t i = 0; i &lt; matched_points.size(); ++i) {\n        for (size_t j = 0; j &lt;matched_points.size(); ++j) {\n            if (j &gt; i) {\n                if (abs(matched_points[i].second.x - matched_points[j].second.x) &lt; 1 &amp;&amp; (abs(matched_points[i].second.y - matched_points[j].second.y)) &lt; 1) {\n                    //std::cout &lt;&lt; \" True \" &lt;&lt; std::endl;\n                    //std::cout &lt;&lt; \" Point 1:\" &lt;&lt; \" ID: \" &lt;&lt; Cam_4.unmatched_img_points[i].first &lt;&lt; \" X: \" &lt;&lt; Cam_4.unmatched_img_points[i].second.x &lt;&lt; \" Y: \" &lt;&lt; Cam_4.unmatched_img_points[i].second.y &lt;&lt; std::endl;\n                    //std::cout &lt;&lt; \" Point 2:\" &lt;&lt; \" ID: \" &lt;&lt; Cam_4.unmatched_img_points[j].first &lt;&lt; \" X: \" &lt;&lt; Cam_4.unmatched_img_points[j].second.x &lt;&lt; \" Y: \" &lt;&lt; Cam_4.unmatched_img_points[j].second.y &lt;&lt; std::endl;\n                    matches_map.insert(std::pair&lt;int, int&gt;(matched_points[i].first, matched_points[j].first));\n                }\n            }\n        }\n    }\n    // Eliminate similar pairs and form triples/quadruples/quintuples... if possible\n\n    std::vector&lt;int&gt; unique_keys;\n\n    for (std::multimap&lt;int, int&gt;::iterator multimap_iterator = matches_map.begin(), end = matches_map.end(); multimap_iterator != end; multimap_iterator = matches_map.upper_bound(multimap_iterator-&gt;first)) {\n        unique_keys.push_back(multimap_iterator-&gt;first);\n    }\n\n    typedef std::multimap&lt;int, int&gt;::iterator MMAPIterator;\n\n    std::vector&lt;std::vector&lt;int&gt;&gt; final_values;\n    std::vector&lt;int&gt; helper_vector;\n\n    for (size_t i = 0; i &lt; unique_keys.size(); ++i) {\n        std::pair&lt;MMAPIterator, MMAPIterator&gt; result = matches_map.equal_range(unique_keys[i]);\n        helper_vector.push_back(unique_keys[i]);\n        for (MMAPIterator it = result.first; it != result.second; it++) {\n            //std::cout &lt;&lt; it-&gt;second &lt;&lt; std::endl;\n            helper_vector.push_back(it-&gt;second);\n        }\n\n        final_values.push_back(helper_vector);\n        helper_vector.clear();\n\n    }\n\n    std::vector&lt;int&gt; v1, v2;\n    for (size_t i = 0; i &lt; final_values.size(); ++i) {\n        for (size_t j = 0; j &lt; final_values.size(); ++j) {\n            if (j &gt; i) {\n                v1 = final_values[i];\n                v2 = final_values[j];\n                if (std::includes(v1.begin(), v1.end(), v2.begin(), v2.end())) {\n                    std::cout &lt;&lt; \"Erased position \" &lt;&lt; j &lt;&lt; std::endl;\n                    final_values.erase(final_values.begin() + j);\n                }\n                v1.clear();\n                v2.clear();\n            }\n        }\n    }\n\n    for (size_t i = 0; i &lt; final_values.size(); ++i) {\n        std::cout &lt;&lt; \"Printing column \" &lt;&lt; i &lt;&lt; std::endl;\n        for (size_t j = 0; j &lt; final_values[i].size(); ++j) {\n            std::cout &lt;&lt; final_values[i][j] &lt;&lt; std::endl;\n        }\n    }\n\n\n}\n</code></pre>\n"}, {"tags": ["c++", "boolean", "bit-fields"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1553090496, "post_id": 55262298, "comment_id": 97256414, "body": "when it is all single bits i dont see the reason to use bitfields. I&#39;d probably go for <code>std::bitset</code> (or its evil brother <code>std::vector&lt;bool&gt;</code> ;)"}], "answers": [{"comments": [{"owner": {"reputation": 944, "user_id": 1499575, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/82374abfce29c20a6f214de4fa2226f5?s=128&d=identicon&r=PG", "display_name": "mreff555", "link": "https://stackoverflow.com/users/1499575/mreff555"}, "edited": false, "score": 0, "creation_date": 1553091554, "post_id": 55262638, "comment_id": 97257215, "body": "+1 For all your points but FYI,  If performance is strictly based off of number of instructions (I know you cannot usually do that),  They are actually the same.  I pasted in my code commenting out one structure at a time and adding a print statement and came out to 28 lines of instructions in both cases."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 5, "last_activity_date": 1553090679, "creation_date": 1553090679, "answer_id": 55262638, "question_id": 55262298, "link": "https://stackoverflow.com/questions/55262298/advantages-of-boolean-values-to-bit-fields/55262638#55262638", "title": "Advantages of boolean values to bit-fields", "body": "<p>There are several things to consider when using bitfields. Those are (order of importance would depend on situation)</p>\n\n<ul>\n<li>Performance</li>\n</ul>\n\n<p>Bitfields operation incur performance penalty when set or read (as compared to direct types). A simple example of codegen shows the extra instructions emitted: <a href=\"https://gcc.godbolt.org/z/DpcErN\" rel=\"noreferrer\">https://gcc.godbolt.org/z/DpcErN</a> However, bitfields provide for more compact data, which becomes more cache-friendly, and that could completely outweigh any drawbacks of additional operations. The only way to understand the real performance impact is by benchmarking actual application in the real use case.</p>\n\n<ul>\n<li>ABI Interoperability</li>\n</ul>\n\n<p>Endiannes of bit fields is implementation defined, so layout of the same struct produced by two compiler can differ.</p>\n\n<ul>\n<li>Usability</li>\n</ul>\n\n<p>There is no reference binding to a bitfield, nor you can take it's address. This could affect code and make it less clear.</p>\n"}, {"tags": [], "owner": {"reputation": 773, "user_id": 5265558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a0n94.jpg?s=128&g=1", "display_name": "Perette", "link": "https://stackoverflow.com/users/5265558/perette"}, "is_accepted": false, "score": 1, "last_activity_date": 1553093045, "creation_date": 1553093045, "answer_id": 55263532, "question_id": 55262298, "link": "https://stackoverflow.com/questions/55262298/advantages-of-boolean-values-to-bit-fields/55263532#55263532", "title": "Advantages of boolean values to bit-fields", "body": "<p>For you, as the programmer, there's not much difference.  But the machine code to access a whole byte is much simpler/shorter than to access an individual bit, so using bitfields bulks up the generated code.</p>\n\n<p>In a pseudo-assembly-language, your setter might turn into something like:</p>\n\n<pre><code>    ldb input1,b         ; get the new value into accumulator b\n    movb b,value1        ; put it into the variable\n    rts                  ; return from subroutine\n</code></pre>\n\n<p>But it's not so easy for bitfields:</p>\n\n<pre><code>    ldb input1,b        ; get the new value into accumulator b\n    movb bitfields,a    ; get current bitfield values into accumulator a\n    cmpb b,#0           ; See what to do.\n    brz clearvalue1:    ; If it's zero, go to clearing the bit\n    orb #$80,a          ; set the bit representing value1.\n    bra resume:         ; skip the clearing code.\nclearvalue1:\n    andb #$7f,a         ; clear the bit representing value1\nresume:\n    movb a,bitfields    ; put the value back\n    rts                 ; return\n</code></pre>\n\n<p>And it has to do that for each of your 8 members' setters, and something similar for getters.  It adds up.  Additionally, even today's dumbest compilers would probably inline the full-byte setter code, rather than actually make a subroutine call.  For the bitfield setter, it may depend whether you're compiling optimizing for speed vs. space.</p>\n\n<p>And you've only asked about booleans.  If they were integer bitfields, then the compiler has to deal with loading, masking out prior values, shifting the value to align into its field, masking out unused bits, <code>and</code>/<code>or</code> the value into place, then writing it back to memory.</p>\n\n<p>So why would you use one vs. the other?</p>\n\n<ul>\n<li>Bitfields are slower, but pack data more efficiently.</li>\n<li>Non-bitfields are faster, and require less machine code to access.</li>\n</ul>\n\n<p>As the developer, it's your judgement call.  If you will be keeping many instances of <code>Structure</code> in memory at once, the memory savings may be worth it.  If you aren't going to have many instances of that structure in memory at once, the compiled code bloat offsets memory savings and you're sacrificing speed.</p>\n"}, {"tags": [], "owner": {"reputation": 1409, "user_id": 6385640, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-muwyWfIjFd8/AAAAAAAAAAI/AAAAAAAAAG0/nctjQMOQOQY/photo.jpg?sz=128", "display_name": "Red.Wave", "link": "https://stackoverflow.com/users/6385640/red-wave"}, "is_accepted": false, "score": 0, "last_activity_date": 1553096739, "creation_date": 1553096739, "answer_id": 55264843, "question_id": 55262298, "link": "https://stackoverflow.com/questions/55262298/advantages-of-boolean-values-to-bit-fields/55264843#55264843", "title": "Advantages of boolean values to bit-fields", "body": "<pre><code>template&lt;typename enum_type,size_t n_bits&gt;\nclass bit_flags{\n    std::bitset&lt;n_bits&gt; bits;\n    auto operator[](enum_type bit){return bits[bit];};\n    auto&amp; set(enum_type bit)){return set(bit);};\n    auto&amp; reset(enum_type bit)){return set(bit);};\n     //go on with flip et al...\nstatic_assert(std::is_enum&lt;enum_type&gt;{});\n };\n\nenum class  v_flags{v1,v2,/*...*/vN};\n\nbit_flags&lt;v_flags,v_flags::vN+1&gt; my_flags;\n\nmy_flags.set(v_flags::v1);\nmy_flags.[v_flags::v2]=true;\n</code></pre>\n\n<p><code>std::bitset</code> is as efficient as <code>bool</code> bit fields. You can wrap it in a class to force using every bit by names defined in an <code>enum</code>. Now you have a small but scalable utility to use for multiple defferent sets of <code>bool</code> flags. C++17 makes it even more convenient:</p>\n\n<pre><code>template&lt;auto last_flag, typename enum_type=decltype(last_flag)&gt;\nclass bit_flags{\n    std::bitset&lt;last_flag+1&gt; bits;\n    //...\n};\n\nbit_flags&lt;v_flags::vN+1&gt; my_flags;\n</code></pre>\n"}], "owner": {"reputation": 944, "user_id": 1499575, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/82374abfce29c20a6f214de4fa2226f5?s=128&d=identicon&r=PG", "display_name": "mreff555", "link": "https://stackoverflow.com/users/1499575/mreff555"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 55262638, "answer_count": 3, "score": 1, "last_activity_date": 1553097001, "creation_date": 1553089715, "last_edit_date": 1553097001, "question_id": 55262298, "link": "https://stackoverflow.com/questions/55262298/advantages-of-boolean-values-to-bit-fields", "title": "Advantages of boolean values to bit-fields", "body": "<p>The code base I work in is quite old.  While we compile nearly everything with c++11.  Much of the code was written in c many years ago.  When developing new classes in old areas I always find myself in a situation where I have to choose between matching old methodologies, or going with a more modern approach.  </p>\n\n<p>In most cases, I prefer sticking with more modern techniques when possible.  However, one common old practice I often see, which I have a hard time arguing the use of, is bitfields.  We pass a lot of messages, here, many times, they are full of single bit values. Take the example below:</p>\n\n<pre><code>class NewStructure\n{\npublic:\n\n    const bool getValue1() const\n    {\n        return value1;\n    }\n\n    void setValue1(const bool input)\n    {\n        value1 = input;\n    }\n\nprivate:\n    bool value1;\n    bool value2;\n    bool value3;\n    bool value4;\n    bool value5;\n    bool value6;\n    bool value7;\n    bool value8;\n};\n\nstruct OldStructure\n{\n    const bool getValue1() const\n    {\n        return value1;\n    }\n\n    void setValue1(const bool input)\n    {\n        value1 = input;\n    }\n\n    unsigned char value1 : 1;\n    unsigned char value2 : 1;\n    unsigned char value3 : 1;\n    unsigned char value4 : 1;\n    unsigned char value5 : 1;\n    unsigned char value6 : 1;\n    unsigned char value7 : 1;\n    unsigned char value8 : 1;\n};\n</code></pre>\n\n<p>In this case the sizes are 8 bytes for the New Structure and 1 for the old.<br>\nI added a \"getter\" and \"setter\" to illustrate the point that from a user perspective, they can be identical. I realize that perhaps you could make the case of readability for the next developer, but other than that, is there a reason to avoid bit fields?  I know that packed fields take a performance hit, but because these are all characters, padding rules are still in place.</p>\n"}, {"tags": ["c++", "windows"], "comments": [{"owner": {"reputation": 1178, "user_id": 1406668, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/T4b1f.jpg?s=128&g=1", "display_name": "Dave M.", "link": "https://stackoverflow.com/users/1406668/dave-m"}, "edited": false, "score": 1, "creation_date": 1553090023, "post_id": 55262273, "comment_id": 97256126, "body": "You&#39;re not checking the result of <code>CreateDirectory</code>.  If that is a function you wrote yourself, you should include it in the sample above.  (As-is, your code will not properly compile, at least because <code>DirectoryExists</code> is not declared before it is used.)  You should also give information about your system / OS, because you&#39;re including a backslash in the directory name.  Different systems handle slashes and backslashes differently -- it&#39;s possible that you&#39;re trying to make a directory with an invalid name."}, {"owner": {"reputation": 9, "user_id": 11232334, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cd_6VfGZ4e8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reGtoqMPVLWNugGmZuUL89ALrDOEQ/mo/photo.jpg?sz=128", "display_name": "Andrea Cappabianca", "link": "https://stackoverflow.com/users/11232334/andrea-cappabianca"}, "reply_to_user": {"reputation": 1178, "user_id": 1406668, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/T4b1f.jpg?s=128&g=1", "display_name": "Dave M.", "link": "https://stackoverflow.com/users/1406668/dave-m"}, "edited": false, "score": 0, "creation_date": 1553090239, "post_id": 55262273, "comment_id": 97256267, "body": "Sorry, CreateDirecotry() it is not my function i think It is a system call of Windows. I am using Windows 10 as OS"}, {"owner": {"reputation": 1248, "user_id": 1791872, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6nnz7.png?s=128&g=1", "display_name": "flau", "link": "https://stackoverflow.com/users/1791872/flau"}, "edited": false, "score": 0, "creation_date": 1553090883, "post_id": 55262273, "comment_id": 97256707, "body": "You should still check the return value, check <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winbase/nf-winbase-createdirectory\" rel=\"nofollow noreferrer\">here</a>. It returns 0 on failure and you can check the reason with the GetLastError function."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1553094646, "post_id": 55262273, "comment_id": 97259558, "body": "Why are you using relative paths?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1553102670, "post_id": 55262273, "comment_id": 97264817, "body": "If a directory already exists, calling <code>CreateDirectory()</code> for it will return <code>FALSE</code> and then <code>GetLastError()</code> will return <code>ERROR_ALREADY_EXISTS</code>.  This is <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-createdirectorya\" rel=\"nofollow noreferrer\">documented behavior</a>.  But, you should be using absolute paths instead of relative paths."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11232334, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cd_6VfGZ4e8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reGtoqMPVLWNugGmZuUL89ALrDOEQ/mo/photo.jpg?sz=128", "display_name": "Andrea Cappabianca", "link": "https://stackoverflow.com/users/11232334/andrea-cappabianca"}, "edited": false, "score": 0, "creation_date": 1553091639, "post_id": 55262807, "comment_id": 97257268, "body": "Hi, thanks for answer but the folder &quot;database&quot; was already created"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1553102863, "post_id": 55262807, "comment_id": 97264913, "body": "You are not handling the case where <code>CreateDirectory()</code> fails with an <code>ERROR_ALREADY_EXISTS</code> error for an existing directory. That is not a failure, so don&#39;t treat it as one. And there is no good reason to call <code>DirectoryExists()</code> inside of <code>MakeDirectory()</code> at all. The result of <code>CreateDirectory()</code> is sufficient."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1553103063, "post_id": 55262807, "comment_id": 97265019, "body": "I would suggest moving the logic to create the intermediate sub-directories into <code>MakeDirectory()</code> itself so that you can pass it a full path and it can call <code>CreateDirectory()</code> in a loop for each intermediate sub-directory. Or, replace <code>CreateDirectory()</code> with <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreatedirectory\" rel=\"nofollow noreferrer\"><code>SHCreateDirectory()</code></a> instead, which handles that for you."}, {"owner": {"reputation": 9, "user_id": 11232334, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cd_6VfGZ4e8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reGtoqMPVLWNugGmZuUL89ALrDOEQ/mo/photo.jpg?sz=128", "display_name": "Andrea Cappabianca", "link": "https://stackoverflow.com/users/11232334/andrea-cappabianca"}, "edited": false, "score": 0, "creation_date": 1553112475, "post_id": 55262807, "comment_id": 97269744, "body": "Thanks to everyone, it was my error because I am stupid. I used che command SetCurrentDirectory() so my directory was different every time. For this the program says that the folder doesn&#39;t exist and for this reason when I close the program and restart it worked."}], "tags": [], "owner": {"reputation": 2123, "user_id": 1964167, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/xAuAQ.png?s=128&g=1", "display_name": "jkj yuio", "link": "https://stackoverflow.com/users/1964167/jkj-yuio"}, "is_accepted": false, "score": 0, "last_activity_date": 1553100928, "last_edit_date": 1553100928, "creation_date": 1553091122, "answer_id": 55262807, "question_id": 55262273, "link": "https://stackoverflow.com/questions/55262273/create-directory-on-windows-and-check-if-it-exists/55262807#55262807", "title": "Create directory on Windows and check if it exists", "body": "<p>If <code>marca</code> was \"database\" it would work. But if <code>marca</code> is \"database/foo\" you cannot create <em>both</em> of these at the same time. </p>\n\n<p>Here's a version of your code where I separate these operations.</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;io.h&gt;\n#include &lt;string&gt;\n#include &lt;cstdio&gt;\n#include &lt;cstdlib&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nbool DirectoryExists( const char* absolutePath )\n{\n    if( _access( absolutePath, 0 ) == 0 ){\n\n        struct stat status;\n        stat( absolutePath, &amp;status );\n\n        return (status.st_mode &amp; S_IFDIR) != 0;\n    }\n    return false;\n}\n\nbool MakeDirectory(const string&amp; marca)\n{\n    if(! CreateDirectory(marca.c_str(), NULL))\n    {\n        DWORD error = GetLastError();\n        TCHAR buf[256];\n        FormatMessage(FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,\n            NULL, GetLastError(), MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), \n            buf, (sizeof(buf) / sizeof(TCHAR)), NULL);\n        cout &lt;&lt; \"Failed to create directory: \" &lt;&lt; buf &lt;&lt; '\\n';\n        return false;\n    }\n\n    if(! DirectoryExists(marca.c_str() )  )\n    {\n        cout &lt;&lt; \"Directory does not exist\\n\";\n        return false;\n    }\n    return true;\n}\n\nint main()\n{\n    // name of subdirectory\n    string marca = \"foo\"; \n\n    // first create top directory\n    string d = \"database\";\n    MakeDirectory(d);\n\n    // then subdirectory\n    d += \"/\" + marca;\n    MakeDirectory(d);\n\n    return 0;\n\n}\n\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11232334, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cd_6VfGZ4e8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reGtoqMPVLWNugGmZuUL89ALrDOEQ/mo/photo.jpg?sz=128", "display_name": "Andrea Cappabianca", "link": "https://stackoverflow.com/users/11232334/andrea-cappabianca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553102771, "creation_date": 1553089628, "last_edit_date": 1553102771, "question_id": 55262273, "link": "https://stackoverflow.com/questions/55262273/create-directory-on-windows-and-check-if-it-exists", "title": "Create directory on Windows and check if it exists", "body": "<p>I have to create some directories and when I try to search one I have to know if it was already created.</p>\n\n<p>The problem is that after creating a directory with <code>CreateDirectory()</code> and trying to check if it was created I get an error which says that it wasn't created. </p>\n\n<p>If I close and restart the program, without creating the directory but just checking if it was created, everything works.</p>\n\n<pre><code>bool DirectoryExists( const char* absolutePath ){\n    if( _access( absolutePath, 0 ) == 0 ){\n        struct stat status;\n        stat( absolutePath, &amp;status );\n        return (status.st_mode &amp; S_IFDIR) != 0;\n    }\n    return false;\n}\n\nmarca = \"database\\\\\"+marca;\nCreateDirectory (marca.c_str(), NULL);\n// useless operation\nif(! DirectoryExists(marca.c_str() )  )\n{\n    cout&lt;&lt;\" Error !\";\n    return -1;\n}\n</code></pre>\n"}, {"tags": ["c++", "r", "rcpp"], "comments": [{"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 3, "creation_date": 1553089923, "post_id": 55262252, "comment_id": 97256041, "body": "&quot;I am trying to use Rcpp for the first time.&quot;  Welcome!  I (somewhat strongly) recommend you give the <a href=\"https://cloud.r-project.org/web/packages/Rcpp/vignettes/Rcpp-introduction.pdf\" rel=\"nofollow noreferrer\">Brief Introduction to Rcpp</a> vignette a read.  You should not need <code>cxxfunction()</code>."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 1, "creation_date": 1553090869, "post_id": 55262252, "comment_id": 97256694, "body": "You almost certainly want to declare <code>power</code> as a <code>std:vector&lt;double&gt;</code>. In fact, unless <code>totalRD</code> is a compile-time constant, your current code is invalid anyway."}, {"owner": {"reputation": 17516, "user_id": 1345455, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DrBTs.jpg?s=128&g=1", "display_name": "coatless", "link": "https://stackoverflow.com/users/1345455/coatless"}, "edited": false, "score": 1, "creation_date": 1553090996, "post_id": 55262252, "comment_id": 97256810, "body": "Please do not use the <code>inline</code> package. For help writing code with Rcpp attributes, please see: <a href=\"http://thecoatlessprofessor.com/programming/to-rcpp-attributes-and-beyond-from-inline/\" rel=\"nofollow noreferrer\">&quot;To Rcpp Attributers and Beyond from Inline&quot;</a> (Disclaimer: I wrote this.)"}, {"owner": {"reputation": 17516, "user_id": 1345455, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DrBTs.jpg?s=128&g=1", "display_name": "coatless", "link": "https://stackoverflow.com/users/1345455/coatless"}, "edited": false, "score": 0, "creation_date": 1553178434, "post_id": 55262252, "comment_id": 97295175, "body": "@tsv are you planning on cleaning this up by using Rcpp Attributes and making it reproducible? If not, we can&#39;t really help out."}, {"owner": {"reputation": 3, "user_id": 11232111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c02d4c7760ad5d06cc7f32b51d629553?s=128&d=identicon&r=PG&f=1", "display_name": "tsv", "link": "https://stackoverflow.com/users/11232111/tsv"}, "reply_to_user": {"reputation": 17516, "user_id": 1345455, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DrBTs.jpg?s=128&g=1", "display_name": "coatless", "link": "https://stackoverflow.com/users/1345455/coatless"}, "edited": false, "score": 0, "creation_date": 1553262085, "post_id": 55262252, "comment_id": 97330228, "body": "@coatless I am usually an R user, I have made a script in C++ that works (although I don&#39;t know what compile-time constant and things mean so maybe I&#39;m doing it wrong there??) I&#39;m now trying to put my code into R as the original example that I saw you seemed to be able to do that. Do I need to include Rcpp Attributes within the C++ script in order to make this work?"}], "answers": [{"tags": [], "owner": {"reputation": 502, "user_id": 2168696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc5c606080eca1db48ca88e8b6a50d9?s=128&d=identicon&r=PG", "display_name": "Qiang Kou", "link": "https://stackoverflow.com/users/2168696/qiang-kou"}, "is_accepted": false, "score": 0, "last_activity_date": 1553748014, "creation_date": 1553748014, "answer_id": 55390283, "question_id": 55262252, "link": "https://stackoverflow.com/questions/55262252/rcpp-not-sure-what-class-return-type-should-be-error-double-not-able-to-conver/55390283#55390283", "title": "Rcpp not sure what class return type should be. error: double not able to convert to const int&amp;", "body": "<p>Please change </p>\n\n<pre><code>double power[totalRD];\n</code></pre>\n\n<p>into </p>\n\n<pre><code>std::vector&lt;double&gt; power(totalRD);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11232111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c02d4c7760ad5d06cc7f32b51d629553?s=128&d=identicon&r=PG&f=1", "display_name": "tsv", "link": "https://stackoverflow.com/users/11232111/tsv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553748014, "creation_date": 1553089562, "question_id": 55262252, "link": "https://stackoverflow.com/questions/55262252/rcpp-not-sure-what-class-return-type-should-be-error-double-not-able-to-conver", "title": "Rcpp not sure what class return type should be. error: double not able to convert to const int&amp;", "body": "<p>I am trying to use Rcpp for the first time. I have made a script in C++ that works fine independently of R, but when trying to implement it in Rcpp I am getting an error message about the return type. Here is the gist of what I've done:</p>\n\n<pre><code>cppSim &lt;- '\n\n#include &lt;iostream&gt;\n#include &lt;random&gt;\n#include &lt;math.h&gt;\n//[[Rcpp::plugins(cpp11)]]\n#include &lt;Rcpp.h&gt;\n#include &lt;cmath&gt;\n#include &lt;iomanip&gt;\n#include &lt;boost/math/distributions/students_t.hpp&gt;\nusing boost::math::students_t;\n\n\nusing namespace std;\nusing namespace Rcpp;\n\n// function to calculate p-value from a t-test\n\ndouble ttestPValue(vector&lt;double&gt; obs1, vector&lt;double&gt; obs2, int nSamples){ \n\n    ...\n\n    return(q);  \\\\ q is a double, this bit works fine\n}\n\n\nNumericVector powerSimulation(int nSamples,  int meanDiff, int nPerm, double pValueCutOff){\n\n    ...\n\n    // create vectors to hold data\n    double sim1T[totalRD][nPerm]; \n\n    ...\n\n    sim1T[rdmu - minRD][j] = ttestPValue(obs1, obs2, nSamples);\n\n    double power[totalRD];\n    for (int j = 0; j &lt; 100; j++){\n        power[j] = 0;\n    }\n\n    for (int i = 0; i &lt; totalRD; i++){\n        for (int sum = 0; sum &lt; nPerm; sum ++){         \n            if (sim1T[i][sum] &lt; pValueCutOff){\n               power[i] = power[i] + 1;\n            }\n         }\n         power[i] = (power[i] / nPerm)*100;\n    }\n\n    return power; \n}'\n</code></pre>\n\n<p>To run it I am using:</p>\n\n<pre><code>settings=getPlugin(\"Rcpp\")\nsettings$env$PKG_CXXFLAGS=paste('-std=c++11',settings$env$PKG_CXXFLAGS,sep=' ')\n\nsimRcpp &lt;- cxxfunction(signature(nSamplesR = \"int\", meanDiffR = \"int\", nPermR = \"int\", pValueCutOffR = \"double\"),\n                          plugin=\"Rcpp\", \n                          settings = settings,\n                          includes = cppSim,\n                          body='\n                          int nSamples = Rcpp::as&lt;int&gt;(nSamplesR);\n                          int meanDiff = Rcpp::as&lt;int&gt;(meanDiffR);\n                          int nPerm = Rcpp::as&lt;int&gt;(nPermR);\n                          double pValueCutOff = Rcpp::as&lt;double&gt;(pValueCutOffR);\n                          return Rcpp::wrap( cppSim(nSamples, meanDiff, nPerm, pValueCutOff));')\n</code></pre>\n\n<p>The error that I'm getting is:              </p>\n\n<pre><code>file928498473e2.cpp: In function \u2018Rcpp::NumericVector powerSimulation(int, int, int, double)\u2019:\nfile928498473e2.cpp:165:8: error: invalid conversion from \u2018double*\u2019 to \u2018const int&amp;\u2019 [-fpermissive]\n return power;\n        ^\n</code></pre>\n\n<p>I get that my return type for power is wrong but how do I make it right? I've tried wrapping it as a NumericVector but that doesn't seem to work and I can't find an example with the same issue, as not everyone uses cxxfunction().</p>\n"}, {"tags": ["c++", "opencl", "amd-rocm"], "comments": [{"owner": {"reputation": 976, "user_id": 3565017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ca9b87bfc80f0428240ea6b8c0b5be?s=128&d=identicon&r=PG&f=1", "display_name": "L.C.", "link": "https://stackoverflow.com/users/3565017/l-c"}, "edited": false, "score": 0, "creation_date": 1553090828, "post_id": 55262250, "comment_id": 97256663, "body": "Running CUDA code on non CUDA hardware is a loss of time in my experience. It could work for very simple code, in which case you can probably re-write the OpenCL code yourself. CUDA is designed on the hardware and NVidia simply does not want you to be able to run it on non CUDA hardware... and believe me, they are good at it. In other words, CUDA cores are different enough (from ATI cores) that porting the code &quot;naively&quot; using OpenCL instructions won&#39;t run efficiently. So my suggestion is try, but don&#39;t lose too much time at it. You&#39;ll save time if you persuade the boss to buy NVidia hardware."}, {"owner": {"reputation": 404, "user_id": 1580636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/698454b00de1f56491f798e046c5f6ce?s=128&d=identicon&r=PG", "display_name": "Rafael Sisto", "link": "https://stackoverflow.com/users/1580636/rafael-sisto"}, "reply_to_user": {"reputation": 976, "user_id": 3565017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ca9b87bfc80f0428240ea6b8c0b5be?s=128&d=identicon&r=PG&f=1", "display_name": "L.C.", "link": "https://stackoverflow.com/users/3565017/l-c"}, "edited": false, "score": 0, "creation_date": 1553099431, "post_id": 55262250, "comment_id": 97262906, "body": "Thanks @L.C. , the main thing is time on the desktop, I have a non CUDA laptop and I want to minimize time on the CUDA hardware if possible. I&#39;m evaluating a remote desktop also."}], "owner": {"reputation": 404, "user_id": 1580636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/698454b00de1f56491f798e046c5f6ce?s=128&d=identicon&r=PG", "display_name": "Rafael Sisto", "link": "https://stackoverflow.com/users/1580636/rafael-sisto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2661, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1553089640, "creation_date": 1553089561, "last_edit_date": 1553089640, "question_id": 55262250, "link": "https://stackoverflow.com/questions/55262250/use-cuda-without-cuda-enabled-gpu-rocm-or-opencl", "title": "Use CUDA without CUDA enabled GPU - ROCm or OpenCL", "body": "<p>I'm doing academic robotics research, so we need to integrate several libraries in the field of vision, sensing, actuators.</p>\n\n<p>There's a huge problem when trying to use libraries that solve problems and also how to integrate them together, since some use CUDA, othres ROCm, others OpenCL. I don't have an NVidia hardware in my host machine.</p>\n\n<p>I'm starting the research on how to be a bit independent on this (I'm willing to sacrifice on performance), but there are several libraries that compile CUDA to portable C++, or CUDA to OpenCL, so it seems it shouldn't be a blocker having either NVidia or AMD in my opinion. </p>\n\n<p>I'd suggest having these libraries in mind\n<a href=\"https://github.com/hughperkins/coriander\" rel=\"nofollow noreferrer\">https://github.com/hughperkins/coriander</a> (convert CUDA to OpenCL to run in other cards)\n<a href=\"https://github.com/ROCm-Developer-Tools/HIP\" rel=\"nofollow noreferrer\">https://github.com/ROCm-Developer-Tools/HIP</a> (convert CUDA to portable C++). </p>\n\n<p>Can you suggest alternatives to this? There may be better ways on how to use CUDA enabled libraries on a non NVidia enabled host.</p>\n\n<p>The specific case would be to run PoseCNN library (it was built with CUDA) without CUDA or Nvidia in an Ubuntu machine. <a href=\"https://github.com/yuxng/PoseCNN\" rel=\"nofollow noreferrer\">https://github.com/yuxng/PoseCNN</a> </p>\n"}, {"tags": ["c++", "visual-studio", "opengl", "visual-c++", "glfw"], "comments": [{"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1553088916, "post_id": 55261794, "comment_id": 97255351, "body": "You&#39;re close. Use a global variable as counter. if the key equals B increment the counter, and then switch on the new value of the counter to run the correct <code>glClearColor</code> function."}], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 1491485, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/284c10871052a77e8e2bb067da036607?s=128&d=identicon&r=PG", "display_name": "Timur Kukharskiy", "link": "https://stackoverflow.com/users/1491485/timur-kukharskiy"}, "is_accepted": false, "score": 0, "last_activity_date": 1553095040, "last_edit_date": 1553095040, "creation_date": 1553089672, "answer_id": 55262287, "question_id": 55261794, "link": "https://stackoverflow.com/questions/55261794/change-background-of-glfwwindow-on-key-press/55262287#55262287", "title": "Change background of GLFWwindow on key press", "body": "<p>When you press the B key, cycle is started and you see the last color, you need to put the test of press key into the cycle. Like this:</p>\n\n<pre><code>static void key_callback(GLFWwindow* window, int key, int scancode, int action, int mods)\n{\n    for (int i = 0; i &lt; 5; i++)\n    {\n      Readkey(key);\n       if (key == GLFW_KEY_B &amp;&amp; action == GLFW_PRESS)\n        {\n        switch (i)\n            {\n              case 0:\n                glClearColor(1.0, 0.0, 0.0, 1.0);\n                break;\n\n              case 1:\n                glClearColor(0.0, 1.0, 0.0, 1.0);\n                break;\n\n            case 2:\n                glClearColor(0.41, 0.41, 0.41, 1.0);\n                break;\n\n            case 3:\n                glClearColor(1.0, 1.0, 1.0, 1.0);\n                break;\n\n            case 4:\n                glClearColor(0.0, 0.0, 1.0, 1.0);\n                return;\n           }\n       }\n    }\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9875107, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kp83ZFmnZ-0/AAAAAAAAAAI/AAAAAAAAAB0/Z5uz_N_A1Ho/photo.jpg?sz=128", "display_name": "Puneet Talapaneni", "link": "https://stackoverflow.com/users/9875107/puneet-talapaneni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 419, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553095040, "creation_date": 1553088293, "question_id": 55261794, "link": "https://stackoverflow.com/questions/55261794/change-background-of-glfwwindow-on-key-press", "title": "Change background of GLFWwindow on key press", "body": "<p>I want to be able to cycle through 5 background colours when I press the \"B\" key. Right now I can only change my colour to red. I'm not sure if I'm going about this the right way. Any help would be appreciated. </p>\n\n<pre><code>static void key_callback(GLFWwindow* window, int key, int scancode, int action, int mods) {\n\nif (key == GLFW_KEY_B &amp;&amp; action == GLFW_PRESS)\n{\n    for (int i = 0; i &lt; 5; i++)\n    {\n        switch (i)\n        {\n            case 0:\n                glClearColor(1.0, 0.0, 0.0, 1.0);\n                break;\n\n            case 1:\n                glClearColor(0.0, 1.0, 0.0, 1.0);\n                break;\n\n            case 2:\n                glClearColor(0.41, 0.41, 0.41, 1.0);\n                break;\n\n            case 3:\n                glClearColor(1.0, 1.0, 1.0, 1.0);\n                break;\n\n            case 4:\n                glClearColor(0.0, 0.0, 1.0, 1.0);\n                return;\n           }\n       }\n   }\n}\n</code></pre>\n"}, {"tags": ["python", "c++", "deserialization", "dlib"], "comments": [{"owner": {"reputation": 1995, "user_id": 4850111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26c63534a6d43180d0d0636e5c3a26b8?s=128&d=identicon&r=PG&f=1", "display_name": "nada", "link": "https://stackoverflow.com/users/4850111/nada"}, "edited": false, "score": 0, "creation_date": 1553695255, "post_id": 55261767, "comment_id": 97480311, "body": "What do you mean by <i>&quot;deserializes customly&quot;</i>?"}, {"owner": {"reputation": 1995, "user_id": 4850111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26c63534a6d43180d0d0636e5c3a26b8?s=128&d=identicon&r=PG&f=1", "display_name": "nada", "link": "https://stackoverflow.com/users/4850111/nada"}, "edited": false, "score": 0, "creation_date": 1553695476, "post_id": 55261767, "comment_id": 97480449, "body": "Not 100% of DLib&#39;s C++ API is available in Python, too. What is available can be found <a href=\"http://dlib.net/python/index.html\" rel=\"nofollow noreferrer\">here</a>. Just as an example <code>train_shape_predictor(...)</code> can be serialized with the overload parameter <code>predictor_output_filename</code> for serialization."}], "owner": {"reputation": 1, "user_id": 8249527, "user_type": "registered", "profile_image": "https://graph.facebook.com/2333819090176804/picture?type=large", "display_name": "Cynki", "link": "https://stackoverflow.com/users/8249527/cynki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573233869, "creation_date": 1553088218, "last_edit_date": 1573233869, "question_id": 55261767, "link": "https://stackoverflow.com/questions/55261767/python-how-to-deserialize-the-trained-dlib-model-data-dat-in-python", "title": "Python: How to Deserialize the Trained dlib Model Data(.dat) in Python?", "body": "<p>I'm studying dlib model in python, and now translating C++ dnn_mmod_dog_hipsterizer code into python code, for comport to using other python module.</p>\n\n<p>In C++ code, the given hipsterizer data is deserialized to net(network), sp(shape predictor), glasses, and mustache. But I can't find out that there is any function that deserializes customly. Only get_frontal_face_detector(), shape_detector(), etc.</p>\n\n<pre><code>net_type net;\nshape_predictor sp;\nmatrix&lt;rgb_alpha_pixel&gt; glasses, mustache;\ndeserialize(argv[1]) &gt;&gt; net &gt;&gt; sp &gt;&gt; glasses &gt;&gt; mustaches;\n</code></pre>\n\n<p>Could you suggest how to use this data in Python?</p>\n"}, {"tags": ["c++", "encryption", "openssl"], "comments": [{"owner": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 0, "creation_date": 1553088307, "post_id": 55261649, "comment_id": 97254952, "body": "You <code>malloc</code> <code>plaintext</code> but you never zero out the bytes so I suspect the last character is a random character or <code>null-terminator</code>.. Either use <code>calloc</code> or do <code>memset</code> on <code>plaintext</code> right after the <code>malloc</code> call and see if it helps? Also, why don&#39;t you use <code>new</code> operator instead of <code>malloc</code> since this is C++ after all? Perhaps you also need to have different lengths for the data and the decrypted data? Maybe the malloc needs to be len+1 but the parameters to decrypt don&#39;t need to be.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11222840"}, "reply_to_user": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 0, "creation_date": 1553088505, "post_id": 55261649, "comment_id": 97255077, "body": "@Brandon I modified the above code with a calloc, but nothing changes... The last byte is a &#39;0x01&#39;..."}, {"owner": {"reputation": 839, "user_id": 1135979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59464968f70aff62c07a7da3a0f6ba80?s=128&d=identicon&r=PG", "display_name": "yachoor", "link": "https://stackoverflow.com/users/1135979/yachoor"}, "edited": false, "score": 1, "creation_date": 1553088634, "post_id": 55261649, "comment_id": 97255173, "body": "Data is padded using PKCS#7 padding, which needs to be stripped after decryption"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11222840"}, "reply_to_user": {"reputation": 839, "user_id": 1135979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59464968f70aff62c07a7da3a0f6ba80?s=128&d=identicon&r=PG", "display_name": "yachoor", "link": "https://stackoverflow.com/users/1135979/yachoor"}, "edited": false, "score": 0, "creation_date": 1553088768, "post_id": 55261649, "comment_id": 97255258, "body": "@yachoor Can you explain me how to do this ?"}, {"owner": {"reputation": 839, "user_id": 1135979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59464968f70aff62c07a7da3a0f6ba80?s=128&d=identicon&r=PG", "display_name": "yachoor", "link": "https://stackoverflow.com/users/1135979/yachoor"}, "edited": false, "score": 0, "creation_date": 1553089269, "post_id": 55261649, "comment_id": 97255587, "body": "Check last byte and remove/ignore that many bytes at the end. The padding is x bytes with value x, where x is between 1 and 8."}, {"owner": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 0, "creation_date": 1553089881, "post_id": 55261649, "comment_id": 97256009, "body": "@cocool; I just tested your code.. it works fine for me.. It does NOT print any weird characters in my terminal or my console (using Xcode on a Mac). However, if I print the hex, I see the end of the file contains characters <code>0x3, 0x3, 0x3, 0x0</code>. so for me, the last character was 0x3 so removed 3 bytes.. for you, the last character is 0x1, remove 1 byte.. So yachoor is correct."}, {"owner": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 0, "creation_date": 1553090257, "post_id": 55261649, "comment_id": 97256280, "body": "I did: <a href=\"https://pastebin.com/K7eK2Xta\" rel=\"nofollow noreferrer\">pastebin.com/K7eK2Xta</a> and it now has no padding.."}, {"owner": {"reputation": 839, "user_id": 1135979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59464968f70aff62c07a7da3a0f6ba80?s=128&d=identicon&r=PG", "display_name": "yachoor", "link": "https://stackoverflow.com/users/1135979/yachoor"}, "edited": false, "score": 0, "creation_date": 1553090730, "post_id": 55261649, "comment_id": 97256568, "body": "@cocool openssl by default should strip the padding. I think in this case your data is not null terminated. Try setting <code>plaintext[len] = 0</code> after <code>aes_decrypt</code>"}, {"owner": {"reputation": 839, "user_id": 1135979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59464968f70aff62c07a7da3a0f6ba80?s=128&d=identicon&r=PG", "display_name": "yachoor", "link": "https://stackoverflow.com/users/1135979/yachoor"}, "edited": false, "score": 0, "creation_date": 1553092626, "post_id": 55261649, "comment_id": 97257996, "body": "@cocool also <code>strlen(contents.c_str())+1</code> will cause problems when encrypted data will contain bytes with 0 value. You should use <code>contents.size()</code> instead"}], "answers": [{"tags": [], "owner": {"reputation": 839, "user_id": 1135979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59464968f70aff62c07a7da3a0f6ba80?s=128&d=identicon&r=PG", "display_name": "yachoor", "link": "https://stackoverflow.com/users/1135979/yachoor"}, "is_accepted": false, "score": 0, "last_activity_date": 1553163058, "last_edit_date": 1553163058, "creation_date": 1553094505, "answer_id": 55264085, "question_id": 55261649, "link": "https://stackoverflow.com/questions/55261649/openssl-c-aes-decryption-adding-unexpected-symbols/55264085#55264085", "title": "Openssl C++ AES decryption adding unexpected symbols", "body": "<p>The input length is incorrect - <code>strlen(contents.c_str()) + 1</code> will either return length including additional null byte which should not be included as it is not part of encrypted data, or length of data to the first null byte in encrypted data if there is one. You should use <code>contents.size()</code> instead.\nThis causes <code>EVP_DecryptUpdate</code> to decrypt all data including last block with padding and expect more data and <code>EVP_DecryptFinal_ex</code> to fail after that. With correct length the padding from last block will be stripped as expected.</p>\n\n<p>There's also issue with output buffer length - it's <code>sizeof(char*) * p_len</code> instead of <code>sizeof(char) * (p_len + EVP_CIPHER_block_size(EVP_aes_256_cbc()))</code>. <code>EVP_DecryptUpdate</code> requires output buffer to be large enough to hold input length + cipher block size.</p>\n\n<p>You should also make sure to use only <code>len</code> data in <code>plaintext</code> buffer - <code>printf</code> will output data until null byte, which might not be included in decrypted data.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11222840"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 425, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556447337, "creation_date": 1553087806, "last_edit_date": 1556447337, "question_id": 55261649, "link": "https://stackoverflow.com/questions/55261649/openssl-c-aes-decryption-adding-unexpected-symbols", "title": "Openssl C++ AES decryption adding unexpected symbols", "body": "<p>I'm trying to decrypt in C++ a file that have been encrypted with the Linux command : <strong>openssl enc -aes-256-cbc -nosalt -K \"E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855\" -iv \"5DF6E0E2761359D30A8275058E299FCC\" -p -in file.json -out file.enc</strong> <br>\nThe decryption works well, but unexpected symbols appear at the end of the file when I print it in the terminal, as in the following image <a href=\"https://i.stack.imgur.com/IOt1S.png\" rel=\"nofollow noreferrer\">Image</a> <br>\nHere is my C++ code, can someone help me ? </p>\n\n<pre><code>int main(int argc, char **argv)\n{\n  EVP_CIPHER_CTX *en, *de;\n  en = EVP_CIPHER_CTX_new();\n  de = EVP_CIPHER_CTX_new();\n\n  unsigned char key_data[] = {0xE3, 0xB0, 0xC4, 0x42, 0x98, 0xFC, 0x1C, 0x14, 0x9A, 0xFB, 0xF4, 0xC8, 0x99, 0x6F, 0xB9, 0x24, 0x27, 0xAE, 0x41, 0xE4, 0x64, 0x9B, 0x93, 0x4C, 0xA4, 0x95, 0x99, 0x1B,0x78, 0x52, 0xB8, 0x55};\n  int key_data_len = 32;\n\n  std::ifstream in(\"file.enc\");\n  std::string contents((std::istreambuf_iterator&lt;char&gt;(in)), \n  std::istreambuf_iterator&lt;char&gt;());\n\n\n  unsigned char iv[] = {0x5D, 0xF6, 0xE0, 0xE2, 0x76, 0x13, 0x59, 0xD3, 0x0A, 0x82, 0x75, 0x05, 0x8E, 0x29, 0x9F, 0xCC};\n\n  EVP_CIPHER_CTX_init(en);\n  EVP_EncryptInit_ex(en, EVP_aes_256_cbc(), NULL, key_data, iv);\n  EVP_CIPHER_CTX_init(de);\n  EVP_DecryptInit_ex(de, EVP_aes_256_cbc(), NULL, key_data, iv);\n\n\n  char *plaintext;\n  int len = strlen(contents.c_str())+1;\n\n  plaintext = (char *)aes_decrypt(de, (unsigned char *)contents.c_str(), &amp;len);\n  printf(\"%s\", plaintext);\n\n\n  free(plaintext);\n  EVP_CIPHER_CTX_cleanup(en);\n  EVP_CIPHER_CTX_cleanup(de);\n}\n</code></pre>\n\n<p>And the function to decrypt : </p>\n\n<pre><code>unsigned char *aes_decrypt(EVP_CIPHER_CTX *e, unsigned char *ciphertext, int *len)\n{\n  int p_len = *len, f_len = 0;\n  unsigned char *plaintext = (unsigned char *)calloc(sizeof(char*), p_len);\n\n  EVP_DecryptInit_ex(e, NULL, NULL, NULL, NULL);\n  EVP_DecryptUpdate(e, plaintext, &amp;p_len, ciphertext, *len);\n  EVP_DecryptFinal_ex(e, plaintext+p_len, &amp;f_len);\n\n  *len = p_len + f_len;\n  return plaintext;\n}\n</code></pre>\n\n<p>SOLVED : I had to remove the PKCS#7 padding added by the encoder <a href=\"https://en.wikipedia.org/wiki/Padding_(cryptography)#PKCS#5_and_PKCS#7\" rel=\"nofollow noreferrer\">PKCS#7 Padding</a></p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1553089542, "post_id": 55261630, "comment_id": 97255778, "body": "If you override <code>MainWindow::paintEvent()</code>, then it&#39;s painted into the <code>MainWindow</code>. If you want to paint it into a stacked widget, then you should consider to override the <code>paintEvent()</code> of that stacked widget."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1553090458, "post_id": 55261630, "comment_id": 97256389, "body": "To draw into a certain page of a <code>QStackedWidget</code>, it could help to consider the <a href=\"https://doc.qt.io/qt-5/qstackedwidget.html#currentIndex-prop\" rel=\"nofollow noreferrer\"><code>currentIndex()</code></a>. E.g. <code>if (currentIndex() == paintIndex) { &#47;* your paint stuff *&#47; } else QStackedWidget::paintEvent(event);</code>. However, I&#39;m still not sure whether this can work. For a certain page, a widget has to be added to the stacked widget. I suspect that child widget might clip your painting away. Wouldn&#39;t it be better to derive a <code>QWidget</code>, override its <code>paintEvent()</code>, and add it as child widget to the stacked widget?"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 2, "creation_date": 1553102958, "post_id": 55261630, "comment_id": 97264967, "body": "What is the purpose of this? How you should do this, that depends on what you are trying to achieve, exactly. The simple answer is: create custon QWidget subclass which just paints the circle, and use that like you&#39;d use any widget (say, QLabel with circle image in it)."}, {"owner": {"reputation": 1205, "user_id": 2846068, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kHfXv.jpg?s=128&g=1", "display_name": "MasterAler", "link": "https://stackoverflow.com/users/2846068/masteraler"}, "edited": false, "score": 0, "creation_date": 1553115674, "post_id": 55261630, "comment_id": 97271359, "body": "Your example contains drawing on the main window. You need to implement <code>paintEvent()</code> of that exact widget, which serves as a page for QStackedWidget. So,   you create a custom one, paint on it and either propagate stackwidget&#39;s page to it (in Creator) or, better, place in on the desired page, so that it fills all of it (layout helps)."}, {"owner": {"reputation": 23, "user_id": 10859270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c1e2df091d44de37fd3d5eb3223fcb?s=128&d=identicon&r=PG&f=1", "display_name": "Saif", "link": "https://stackoverflow.com/users/10859270/saif"}, "edited": false, "score": 0, "creation_date": 1553158043, "post_id": 55261630, "comment_id": 97283337, "body": "Still after trying all your suggestions i am not getting a circle on any page. FYI  i have edited my post. Please tell me if i did any thing wrong or i haven&#39;t done as you said!"}], "owner": {"reputation": 23, "user_id": 10859270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c1e2df091d44de37fd3d5eb3223fcb?s=128&d=identicon&r=PG&f=1", "display_name": "Saif", "link": "https://stackoverflow.com/users/10859270/saif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553157655, "creation_date": 1553087743, "last_edit_date": 1553157655, "question_id": 55261630, "link": "https://stackoverflow.com/questions/55261630/how-to-draw-different-geometric-figures-like-circle-on-a-page-of-stackedwidget-u", "title": "How to draw different geometric figures like circle on a page of stackedwidget using QPainter in qt c++?", "body": "<p>I just started coding in qt and I want to draw a circle on a particular page of the stackedwidget. When I searched about this I got to know about QPainter class and while I am trying to implement this in my project it is not displaying anything, although there are no errors in my code.</p>\n\n<p>I can't understand why it is not displayed.\nI created a class named page_4 (this is the page where i want to display) inherited from QWidget class.</p>\n\n<p>Following is a part of my mainwindow.h.</p>\n\n<pre><code>class page_4:public QWidget{\n\npublic:\n\n  page_4(QWidget *parent = nullptr);\n\n~page_4();\n\nvirtual void paintEvent(QPaintEvent *paint); };\n</code></pre>\n\n<p>This is a part of my mainwindow.cpp:</p>\n\n<pre><code>void page_4::paintEvent(QPaintEvent *event)\n{    \n    QPainter painter(this);\n\n    QPen pen;\n    pen.setColor(Qt::black);\n    painter.setPen(pen);\n    painter.drawEllipse(400,100,80,80);\n}\n</code></pre>\n\n<p>where as when I run the same code in a fresh new project it runs perfectly.</p>\n\n<p>I guess in my project, I need to specify on which page it should draw the circle. But how to do that?\n(I edited my question after trying suggestions from comments).</p>\n\n<p>Someone please help me!!</p>\n"}, {"tags": ["c++", "visual-studio", "debugging", "vtk", "itk"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553087947, "post_id": 55261492, "comment_id": 97254745, "body": "Make sure the .pdb files for ITK are in the same folder as the ITK .dlls. Also make sure you did not move the source for ITK."}, {"owner": {"reputation": 3, "user_id": 10926872, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001667727986/picture?type=large", "display_name": "cndu", "link": "https://stackoverflow.com/users/10926872/cndu"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553089319, "post_id": 55261492, "comment_id": 97255625, "body": "can u please elaborate? I have .pdb files in the build folder. But where can I? find .dlls?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553090667, "post_id": 55261492, "comment_id": 97256522, "body": "if you don&#39;t know that you probably built itk as static libraries. And no before you ask compiling ITK as static libraries is not your problem."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553090823, "post_id": 55261492, "comment_id": 97256653, "body": "Check your output window in Visual Studio for PDB / symbol warnings about ITK. Ignore the pdb warnings about the OS."}, {"owner": {"reputation": 652, "user_id": 3921660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c4c1e3a9e6846d4696f644b3ef83ea8?s=128&d=identicon&r=PG&f=1", "display_name": "KabCode", "link": "https://stackoverflow.com/users/3921660/kabcode"}, "edited": false, "score": 0, "creation_date": 1554124606, "post_id": 55261492, "comment_id": 97625300, "body": "Have you tried the built-in VS run option (F5) instead of the command line? This triggers the break points."}], "owner": {"reputation": 3, "user_id": 10926872, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001667727986/picture?type=large", "display_name": "cndu", "link": "https://stackoverflow.com/users/10926872/cndu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553087277, "creation_date": 1553087277, "question_id": 55261492, "link": "https://stackoverflow.com/questions/55261492/how-to-debug-itk-c-code-in-visual-studio", "title": "How to debug ITK c++ code in visual studio?", "body": "<p>How can I debug the .cxx file in visual studio? I used CMake to configure it with ITK. I built the code and I am able to run the .exe file from windows command prompt. But I am not able to debug it. I also tried inserting sleep(10000) command at every breakpoint. </p>\n\n<p>The file I am trying to debug is in the following <a href=\"https://itk.org/Wiki/ITK/Examples/SimpleOperations/WidthHeight\" rel=\"nofollow noreferrer\">link for code</a> </p>\n"}, {"tags": ["c++", "visual-studio-code"], "comments": [{"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 0, "creation_date": 1553088628, "post_id": 55261266, "comment_id": 97255167, "body": "So using this tasks.json works as intended for you? Then what is your question? There is no default compiler in VSC, use an extension or the tasks like you currently do."}, {"owner": {"reputation": 1, "user_id": 11225383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11570d1f56e9fd63f74c8d570205c5b1?s=128&d=identicon&r=PG&f=1", "display_name": "Aris Martin Accola", "link": "https://stackoverflow.com/users/11225383/aris-martin-accola"}, "reply_to_user": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 0, "creation_date": 1553089149, "post_id": 55261266, "comment_id": 97255495, "body": "And is there any extension to set it. I use as extension the C/C++ of Microsoft and then I have the option to Build and Debug Active file. Then I can choose if using clang++ or g++."}, {"owner": {"reputation": 1, "user_id": 11225383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11570d1f56e9fd63f74c8d570205c5b1?s=128&d=identicon&r=PG&f=1", "display_name": "Aris Martin Accola", "link": "https://stackoverflow.com/users/11225383/aris-martin-accola"}, "reply_to_user": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 0, "creation_date": 1553090315, "post_id": 55261266, "comment_id": 97256311, "body": "@super but there I can choose the argument -std=c++17"}, {"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 0, "creation_date": 1553090923, "post_id": 55261266, "comment_id": 97256745, "body": "It is still very unclear to me what your question is. What exactly is not working? Are you looking for help to edit your <code>tasks.json</code>? Just pointing it to clang instead of g++ could be one way to do this. You need to edit your question so it&#39;s clear what you are actually asking."}, {"owner": {"reputation": 1, "user_id": 11225383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11570d1f56e9fd63f74c8d570205c5b1?s=128&d=identicon&r=PG&f=1", "display_name": "Aris Martin Accola", "link": "https://stackoverflow.com/users/11225383/aris-martin-accola"}, "reply_to_user": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 0, "creation_date": 1553091269, "post_id": 55261266, "comment_id": 97257020, "body": "@super my question is if there is an option to change the c_cpp_properties.json so that it compiles using g++ -std=c++17"}, {"owner": {"reputation": 1103, "user_id": 3847255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5ae0e1317d8f367da0af2a68990222?s=128&d=identicon&r=PG&f=1", "display_name": "pooya13", "link": "https://stackoverflow.com/users/3847255/pooya13"}, "edited": false, "score": 0, "creation_date": 1553296720, "post_id": 55261266, "comment_id": 97346017, "body": "I also recommend trying to be more specific with your question. The <code>c_cpp_properties.json</code> file is used for intellisense not building. To compile in VSC you create a build task and as you have posted you can change <code>command</code> to point to either gcc or clang and you can edit <code>args</code> to use c++17 or another standard. AFAIK there is not yet a global way to set the compiler for intellisense other than changing your systems default compiler. There is an open issue to enable global tasks: <a href=\"https://github.com/Microsoft/vscode/issues/1435\" rel=\"nofollow noreferrer\">github.com/Microsoft/vscode/issues/1435</a>"}], "owner": {"reputation": 1, "user_id": 11225383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11570d1f56e9fd63f74c8d570205c5b1?s=128&d=identicon&r=PG&f=1", "display_name": "Aris Martin Accola", "link": "https://stackoverflow.com/users/11225383/aris-martin-accola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 344, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553087071, "creation_date": 1553086506, "last_edit_date": 1553087071, "question_id": 55261266, "link": "https://stackoverflow.com/questions/55261266/vsc-setting-default-compiler-to-clang-std-c17-or-g-std-c17", "title": "VSC Setting default compiler to clang++ -std=c++17 or g++ -std=c++17", "body": "<p>How can I change the default settings when compiling in VSC to clang++ -std=c++17 or g++ -std=c++17.</p>\n\n<p>For now I need to include the arg in the tasks.json</p>\n\n<pre><code>\"tasks\": [\n    {\n      \"type\": \"shell\",\n      \"label\": \"g++ build active file\",\n      \"command\": \"/usr/bin/g++\",\n      \"args\": [\n        \"-std=c++17\",\n        \"-g\",\n        \"${file}\",\n        \"-o\",\n        \"${fileDirname}/${fileBasenameNoExtension}\"\n      ],\n      \"options\": {\n        \"cwd\": \"/usr/bin\"\n      }\n    }\n  ],\n  \"version\": \"2.0.0\"\n}\n</code></pre>\n\n<p>If it is not written in there VSC Compiles with c++98 and put outs a lot of errors. </p>\n\n<p>Thanks for any help:)</p>\n"}, {"tags": ["c++", "visual-c++", "stdstring", "unsigned-char", "uint8t"], "comments": [{"owner": {"reputation": 218, "user_id": 2935386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cdcd200e0a26a1b230b1dbe77fececf?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/2935386/harry"}, "edited": false, "score": 0, "creation_date": 1553086283, "post_id": 55260989, "comment_id": 97253725, "body": "Have you taken a look at <a href=\"https://stackoverflow.com/a/1673536/2935386\">this</a> reinterpret_cast should be to a <code>char const*</code>"}], "answers": [{"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 0, "last_activity_date": 1553086469, "creation_date": 1553086469, "answer_id": 55261249, "question_id": 55260989, "link": "https://stackoverflow.com/questions/55260989/convert-uint8-t-array-to-string/55261249#55261249", "title": "convert uint8_t array to string", "body": "<p>Just leave away the <code>std::to_string</code>. It converts numeric values to their string representation. So even if you give it a <code>char</code>, it will just cast that to an integer and convert it to the numerical representation of that integer instead. On the other hand, just adding a <code>char</code> to an <code>std::string</code> using <code>+=</code> works fine. Try this:</p>\n\n<pre><code>int main() {\n    typedef uint8_t  U8;\n    U8 Data[] = { 0x48, 0x65, 0x6C, 0x6C, 0x6F };\n        std::string temp;\n        for (unsigned char i : Data)\n        {\n            temp += i;\n        }\n        std::cout &lt;&lt; temp &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>See <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/operator%2B%3D\" rel=\"nofollow noreferrer\">here</a> for more information and examples on <code>std::string</code>'s <code>+=</code> operator.</p>\n"}, {"comments": [{"owner": {"reputation": 3140, "user_id": 1624844, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/SXXv0.png?s=128&g=1", "display_name": "Amir-Mousavi", "link": "https://stackoverflow.com/users/1624844/amir-mousavi"}, "edited": false, "score": 1, "creation_date": 1553087214, "post_id": 55261362, "comment_id": 97254283, "body": "Thanks a lot, and as you have described my problem, I am accepting this. finally, I asked a question in C++ that did not get downvotes at first place :))"}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1553087196, "last_edit_date": 1553087196, "creation_date": 1553086859, "answer_id": 55261362, "question_id": 55260989, "link": "https://stackoverflow.com/questions/55260989/convert-uint8-t-array-to-string/55261362#55261362", "title": "convert uint8_t array to string", "body": "<p>In your original cast <code>const std::string temp(reinterpret_cast&lt;char*&gt;(frm-&gt;Data, 8));</code> you put the closing parenthesis in the wrong place, so that it ends up doing <code>reinterpret_cast&lt;char*&gt;(8)</code> and that is the cause of the crash.</p>\n\n<p>Fix:</p>\n\n<pre><code>std::string temp(reinterpret_cast&lt;char const*&gt;(frm-&gt;Data), sizeof frm-&gt;Data);\n</code></pre>\n"}], "owner": {"reputation": 3140, "user_id": 1624844, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/SXXv0.png?s=128&g=1", "display_name": "Amir-Mousavi", "link": "https://stackoverflow.com/users/1624844/amir-mousavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1108, "favorite_count": 0, "accepted_answer_id": 55261362, "answer_count": 2, "score": 1, "last_activity_date": 1553087196, "creation_date": 1553085539, "last_edit_date": 1553086035, "question_id": 55260989, "link": "https://stackoverflow.com/questions/55260989/convert-uint8-t-array-to-string", "title": "convert uint8_t array to string", "body": "<p>I the project I have a struct that has one member of type <code>unsigned int array</code>(<code>uint8_t</code>) like below    </p>\n\n<pre><code>typedef uint8_t  U8;\ntypedef struct {\n    /* other members */\n    U8 Data[8];\n} Frame;\n</code></pre>\n\n<p>a pointer to a variable of type <code>Frame</code> is received that during debug I see it as below in console of VS2017 </p>\n\n<pre><code>/* the function signatur */\nvoid converter(Frame* frm){...}\n\nfrm-&gt;Data   0x20f1feb0 \"6\u00c3\u00bex}\\x1\u00f2\u00e0...   unsigned char[8] // in debug console\n</code></pre>\n\n<p>now I want to assign it to an 8byte string</p>\n\n<p>I did it like below, but it concatenates the numeric values of the array and results in something like <code>\"541951901201251242224\"</code></p>\n\n<pre><code>std::string temp;\nfor (unsigned char i : frm-&gt;Data)\n{\n    temp += std::to_string(i);\n}\n</code></pre>\n\n<p>also tried <code>const std::string temp(reinterpret_cast&lt;char*&gt;(frm-&gt;Data, 8));</code> which throws exception</p>\n"}, {"tags": ["c++", "objective-c", "openssl", "rsa", "objective-c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553085669, "post_id": 55260926, "comment_id": 97253341, "body": "Is <code>_to</code> actually null terminated?  If not you should be using <code>*to = std::string((char *)_to, decryptedSize);</code>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553085978, "post_id": 55260926, "comment_id": 97253536, "body": "Also, per <a href=\"https://www.openssl.org/docs/man1.0.2/man3/RSA_private_decrypt.html\" rel=\"nofollow noreferrer\">this</a>, your first call to decrypt is UB: <i><code>to</code> must point to a memory section large enough to hold the decrypted data (which is smaller than RSA_size(rsa)).</i>"}, {"owner": {"reputation": 20158, "user_id": 994107, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oKnAc.jpg?s=128&g=1", "display_name": "Andrey Chernukha", "link": "https://stackoverflow.com/users/994107/andrey-chernukha"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553086410, "post_id": 55260926, "comment_id": 97253815, "body": "@NathanOliver As for your second comment - this is the whole reason why I am calling RSA_private_decrypt two times. I simply don&#39;t know the size that I should allocate for _to buffer. I need to get it first. do you see?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553086601, "post_id": 55260926, "comment_id": 97253931, "body": "Looks like using <code>RSA_size(rsa)</code> should give you a buffer size to use.  It gets that value from <code>rsa-&gt;n</code>.  So you could do <code>unsigned char* _to = new unsigned char[RSA_size(rsa)]; ...; delete _to</code>."}, {"owner": {"reputation": 20158, "user_id": 994107, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oKnAc.jpg?s=128&g=1", "display_name": "Andrey Chernukha", "link": "https://stackoverflow.com/users/994107/andrey-chernukha"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553087874, "post_id": 55260926, "comment_id": 97254691, "body": "@NathanOliver I&#39;m not really good at RSA. Do you mean that the size of the decrypted text will always be less or equal than n? Right?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553088061, "post_id": 55260926, "comment_id": 97254806, "body": "From my first time casual perusal of the documentation, that was the assumption I made.  You&#39;ll have to wait for someone who actually knows though for a real answer.  I just figured I&#39;d lend a fresh set of eyes and see if it might be something that was overlooked."}, {"owner": {"reputation": 20158, "user_id": 994107, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oKnAc.jpg?s=128&g=1", "display_name": "Andrey Chernukha", "link": "https://stackoverflow.com/users/994107/andrey-chernukha"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553088232, "post_id": 55260926, "comment_id": 97254903, "body": "@NathanOliver thanks for your help"}, {"owner": {"reputation": 20158, "user_id": 994107, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oKnAc.jpg?s=128&g=1", "display_name": "Andrey Chernukha", "link": "https://stackoverflow.com/users/994107/andrey-chernukha"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553089347, "post_id": 55260926, "comment_id": 97255638, "body": "@NathanOliver your comment helped me to get rid of the crash. It is gone. I&#39;m not sure by now whether I should remove the second call to RSA_private_decrypt or not, but the crash is fixed. You can post the comment as answer and I will accept it"}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 1, "last_activity_date": 1553090018, "creation_date": 1553090018, "answer_id": 55262418, "question_id": 55260926, "link": "https://stackoverflow.com/questions/55260926/rsa-private-decrypt-crashes-when-called-for-the-second-time/55262418#55262418", "title": "RSA_private_decrypt crashes when called for the second time", "body": "<p><code>RSA_private_decrypt</code> requires that the <code>to</code> parameter points to a buffer of an adequate size.  Your first call only uses a buffer of size 1, which is too small and is undefined behavior.  What you need to do is get the size from <code>rsa</code> using <code>RSA_size(rsa)</code>, and then you can use that to allocate space for <code>_to</code>.  That means you don't need to call the function twice, since you'll already have the size the first time around</p>\n\n<p>You should also be using <code>decryptedSize</code> for the length if the string to build instead of using <code>strlen</code> as <code>_to</code> may not be null terminated.</p>\n\n<p>Putting all that together you could should look something like</p>\n\n<pre><code>int BCVirtualCard::decrypt(std::string from, std::string *to, int keyId, bool padding)\n{\n    if (to == nullptr)\n    {\n        NSCAssert(NO, @\"Invalid params\");\n        return 0;\n    }\n\n    NSString* privateKey            = [m_storage privateKeyForSlot:keyId];\n    NSArray&lt;NSString*&gt;* components  = [privateKey componentsSeparatedByString:@\"_\"];\n    const NSInteger componentsCount = 4;\n\n    if (components.count != componentsCount)\n    {\n        *to = \"\";\n        return 0;\n    }\n\n    const char* d = [components[0] UTF8String];\n    const char* n = [components[1] UTF8String];\n    const char* p = [components[2] UTF8String];\n    const char* q = [components[3] UTF8String];\n\n    RSA* rsa = RSA_new();\n\n    BN_hex2bn(&amp;rsa-&gt;d, d);\n    BN_hex2bn(&amp;rsa-&gt;n, n);\n    BN_hex2bn(&amp;rsa-&gt;p, p);\n    BN_hex2bn(&amp;rsa-&gt;q, q);\n\n    auto _to = std::make_unique&lt;unsigned char[]&gt;(RSA_size(rsa)); // use smart pointers so you don't have to worry about releasing the memory\n\n    int decryptedSize = RSA_private_decrypt((int)from.length(), (unsigned char *)from.c_str(), _to.get(), rsa, RSA_NO_PADDING);\n\n    if (decryptedSize &lt;= 0)\n    {\n        ERR_print_errors_cb(test, NULL);    \n        *to = \"\";\n        return 0;\n    }\n\n    *to = std::string((char *)_to.get(), decryptedSize);\n    return 1;\n}\n</code></pre>\n"}], "owner": {"reputation": 20158, "user_id": 994107, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oKnAc.jpg?s=128&g=1", "display_name": "Andrey Chernukha", "link": "https://stackoverflow.com/users/994107/andrey-chernukha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 55262418, "answer_count": 1, "score": 0, "last_activity_date": 1553090018, "creation_date": 1553085334, "last_edit_date": 1553085521, "question_id": 55260926, "link": "https://stackoverflow.com/questions/55260926/rsa-private-decrypt-crashes-when-called-for-the-second-time", "title": "RSA_private_decrypt crashes when called for the second time", "body": "<p>Please take a look at the following method:</p>\n\n<pre><code>int BCVirtualCard::decrypt(std::string from, std::string *to, int keyId, bool padding)\n{\n    if (to == nullptr)\n    {\n        NSCAssert(NO, @\"Invalid params\");\n        return 0;\n    }\n\n    NSString* privateKey            = [m_storage privateKeyForSlot:keyId];\n    NSArray&lt;NSString*&gt;* components  = [privateKey componentsSeparatedByString:@\"_\"];\n    const NSInteger componentsCount = 4;\n\n    if (components.count != componentsCount)\n    {\n        *to = \"\";\n        return 0;\n    }\n\n    const char* d = [components[0] UTF8String];\n    const char* n = [components[1] UTF8String];\n    const char* p = [components[2] UTF8String];\n    const char* q = [components[3] UTF8String];\n\n    RSA* rsa = RSA_new();\n\n    BN_hex2bn(&amp;rsa-&gt;d, d);\n    BN_hex2bn(&amp;rsa-&gt;n, n);\n    BN_hex2bn(&amp;rsa-&gt;p, p);\n    BN_hex2bn(&amp;rsa-&gt;q, q);\n\n    unsigned char* _to = (unsigned char *)calloc(1, sizeof(unsigned char));\n\n    int decryptedSize = RSA_private_decrypt((int)from.length(), (unsigned char *)from.c_str(), _to, rsa, RSA_NO_PADDING);\n\n    free(_to);\n\n    if (decryptedSize &lt;= 0)\n    {\n        ERR_print_errors_cb(test, NULL);\n\n        *to = \"\";\n        return 0;\n    }\n\n    _to = (unsigned char *)calloc(decryptedSize, sizeof(unsigned char));\n\n    RSA_private_decrypt((int)from.length(), (unsigned char *)from.c_str(), _to, rsa, RSA_NO_PADDING);\n\n    *to = std::string((char *)_to, strlen((char *)_to));\n\n    free(_to);\n\n    RSA_free(rsa);\n\n    return 1;\n}\n</code></pre>\n\n<p>Here the string <code>from</code> is supposed to be decrypted and written to the string <code>to</code>. For decryption I use <code>RSA_private_decrypt</code> function. I call it two times. First time in order to determine the size of the decrypted text and second time in order to write the decrypted text into <code>_to</code> buffer. And when I call it second time it usually crashes like this:</p>\n\n<pre><code>malloc: Heap corruption detected, free list is damaged at 0x280ff3d70\n*** Incorrect guard value: 0\nNo1BCmail(2171,0x170efb000) malloc: *** set a breakpoint in malloc_error_break to debug\n</code></pre>\n\n<p>The breakpoint is on and this let me find the place of the crash. However I can't understand the reason why it crashes. I tried recreating the <code>RSA</code> structure and playing with the size allocated for <code>_to</code> for the second time, but nothing helps. Can you see what is wrong here? Thanks </p>\n"}, {"tags": ["c++", "opengl", "struct", "vertex"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1553085687, "post_id": 55260708, "comment_id": 97253354, "body": "I believe you have to apply your ID per vertex. You cannot provide attributes per primitive (i.e. line in your case), you can do this only per vertex. <code>glVertexAttribPointer()</code> can consider a <a href=\"https://stackoverflow.com/a/22046794/7478597\">stride</a> (i.e. skipping parts of data as well as address particular offset in a struct) but it can do this only per vertex."}, {"owner": {"reputation": 2256, "user_id": 5690248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dabe0ffbb33a4bffa6ed4801272c759b?s=128&d=identicon&r=PG&f=1", "display_name": "The Dreams Wind", "link": "https://stackoverflow.com/users/5690248/the-dreams-wind"}, "edited": false, "score": 0, "creation_date": 1553085753, "post_id": 55260708, "comment_id": 97253405, "body": "The code you provides looks inconsistent: where do you pass your data into openGL attribute? Why do you use <code>4</code> as an address of the attribute? How are your attrbutes stored in the shaders?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7190389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02aa0bdfa752aca7f49ca50b24d79406?s=128&d=identicon&r=PG&f=1", "display_name": "Nas25", "link": "https://stackoverflow.com/users/7190389/nas25"}, "edited": false, "score": 0, "creation_date": 1553088350, "post_id": 55261067, "comment_id": 97254977, "body": "Thank you so much Michael, I really appreciate the time you spent answering my question and helping me out. I have simply created a new vector and copied only the position data for lines. My thought process was flawed as I did not remember the ID value was being uploaded to the GPU regardless of my glAttrib specification and , as you stated, OpenGL does not need it at the end of the day."}], "tags": [], "owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "is_accepted": true, "score": 3, "last_activity_date": 1553102096, "last_edit_date": 1553102096, "creation_date": 1553085814, "answer_id": 55261067, "question_id": 55260708, "link": "https://stackoverflow.com/questions/55260708/how-do-i-use-a-mixed-type-c-struct-and-only-pass-some-values-to-opengl/55261067#55261067", "title": "How do I use a mixed type c++ struct and only pass some values to OpenGL?", "body": "<p>Just because you need to represent lines in a certain way inside your application doesn't mean that you have to feed exactly that data in exactly that way to OpenGL for drawing. OpenGL doesn't need this <code>ID</code> field. There seems to be no reason to upload this <code>ID</code> data to the GPU. Besides that, there's no way to make OpenGL vertex attribute arrays use a memory layout like the one you have with your array of <code>Line</code> structs. Think about what multiple <code>Line</code>s look like in memory:</p>\n\n<pre><code>B1 C1 ID1  B2 C2 ID2  B3 C3 ID3  \u2026\n</code></pre>\n\n<p>Note how the gap between consecutive vertex positions is not fixed but is either 0 between two points of the same line segment or <code>sizeof(int)</code> between the end vertex of one line and the start vertex of the next line. There is no way to describe such a vertex attribute array with just a stride and base offset. And all of this is ignoring the fact that compilers are free to add padding bytes between struct members in whatever way they see fit. So your memory layout is not even guaranteed to look like that and, at least in theory, is subject to change depending on which version of which compiler you're using with which compile options.</p>\n\n<p>I would suggest to let go of the idea that the <code>Line</code> struct is a given and every aspect of your application must absolutely work with that exact data representation. You have to upload the data to the GPU for drawing at some point anyways. When you do, simply copy just the start and end points and skip the id. Apart from that, consider the fact that you could also just generally switch from the <a href=\"https://en.wikipedia.org/wiki/AOS_and_SOA\" rel=\"nofollow noreferrer\">Array of Structures approach</a> you have now (where you keep an array of <code>Line</code> structures) to a Structure of Arrays approach, i.e., have one array for all the line start points, one for all the end points, and one for the IDs. Depending on how exactly you process your data, this is often beneficial even on the CPU. Finally, there would be the option to upload the data to a <a href=\"https://www.khronos.org/opengl/wiki/Shader_Storage_Buffer_Object\" rel=\"nofollow noreferrer\">Shader Storage Buffer</a> and manually look up the vertex attributes in the vertex shader. I don't think I would recommend going that way here though\u2026</p>\n"}], "owner": {"reputation": 45, "user_id": 7190389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02aa0bdfa752aca7f49ca50b24d79406?s=128&d=identicon&r=PG&f=1", "display_name": "Nas25", "link": "https://stackoverflow.com/users/7190389/nas25"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 55261067, "answer_count": 1, "score": 1, "last_activity_date": 1553102096, "creation_date": 1553084582, "question_id": 55260708, "link": "https://stackoverflow.com/questions/55260708/how-do-i-use-a-mixed-type-c-struct-and-only-pass-some-values-to-opengl", "title": "How do I use a mixed type c++ struct and only pass some values to OpenGL?", "body": "<p>I have read high and low and thought I understood C++ and OpenGL vertex data layouts, but I must be wrong somewhere...</p>\n\n<p>I have a struct to create a Line object. Therefore it has two points (each of 3 floats to represent a vector position). It must also have an object ID to allow me to track the specific object on creation for collisions, etc later on in the application. The struct is shown below.</p>\n\n<pre><code>struct Point\n{\n    Vector position = { 0.0f, 0.0f, 0.0f };\n};\n\nstruct Line\n{\n    Point B = { 0.0f,0.0f,0.0f };\n    Point C = { 0.0f,0.0f,0.0f };\n    int ID = 0;\n};\n</code></pre>\n\n<p>I then create a simpe c++ STL vector of Lines and push back two line objects:</p>\n\n<pre><code>vector&lt;Line&gt; lines; \n\nLine w0;\n    w0.B = { 2.0f,2.0f, 0.0f };\n    w0.C = { 8.0f,2.0f, 0.0f }; \n    w0.ID = 0; \n    lines.push_back(w0);\n\nLine w1;\n    w1.B = { 10.0f,4.0f, 0.0f };\n    w1.C = { 18.0f,4.0f, 0.0f };\n    w1.ID = 1;\n    lines.push_back(w1);\n</code></pre>\n\n<p>Further on I specify the glVertexAttribPointer as follows:</p>\n\n<pre><code>glVertexAttribPointer(4, 3, GL_FLOAT, GL_FALSE, 0, (void*)(0));\nglEnableVertexAttribArray(4);\n</code></pre>\n\n<p>This gives draws only 1 line and not the two I create objects for(!). <em>If I remove the ID int variable from my struct I get both lines showing correctly.</em>\nIt appeared later that I may not have specified the glVertexAttribPointer correctly, so I changed it logically as follows:</p>\n\n<pre><code>glVertexAttribPointer(4, 3, GL_FLOAT, GL_FALSE, sizeof(Line), (void*)offsetof(Line, B));\n</code></pre>\n\n<p>It then drew only 1 line at completely different coordinates! Different combinations of offsets etc. didn't help. Can I ultimately use an int value, different from the rest of the struct and pass only the floats over to OpenGL? I really need the ID of the object and use it later in the application. There must be a way - I must be missing something..please help. </p>\n"}, {"tags": ["c++", "operator-overloading", "extraction", "insertion"], "comments": [{"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 0, "creation_date": 1553084858, "post_id": 55260703, "comment_id": 97252846, "body": "What is it intended to do that does not work right? A concrete example would help"}, {"owner": {"reputation": 480, "user_id": 6948160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129c8f620f47a08105f596962677b4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Gojita", "link": "https://stackoverflow.com/users/6948160/gojita"}, "edited": false, "score": 0, "creation_date": 1553084924, "post_id": 55260703, "comment_id": 97252903, "body": "I think you have to send a minimal and complete example of your probleme."}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 0, "creation_date": 1553085180, "post_id": 55260703, "comment_id": 97253042, "body": "In any case, your code has many problems including non-idiomatic operator&lt;&lt; (and &gt;&gt;) overloads, memory leaks, multiple uses of 21 rather than defining and using a constant, not checking input success/errors, doing output inside input overload"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1553085648, "post_id": 55260703, "comment_id": 97253326, "body": "I flagged as dupe, just let me know in case you dont agree. And note that even if you fix your code, it is a rather atypical use of the in/out operator overloads, eg I would never expect a <code>operator&gt;&gt;</code> to print some output. Consider to use named methods instead"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553085778, "post_id": 55260703, "comment_id": 97253421, "body": "PS: for your question please read about <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and you need to explain what is wrong about the code. What is it supposed to do, what does it do, how do the two differ? Any compiler errors? runtime errors? We cannot know what you consider as &quot;proper solution&quot; unless you tell us"}], "owner": {"reputation": 31, "user_id": 11108999, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sjmp2-s0Vaw/AAAAAAAAAAI/AAAAAAAAAg4/4hLiFiZB8y8/photo.jpg?sz=128", "display_name": "Shoukat Ali", "link": "https://stackoverflow.com/users/11108999/shoukat-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "closed_date": 1553085531, "answer_count": 0, "score": 1, "last_activity_date": 1553085550, "creation_date": 1553084576, "question_id": 55260703, "link": "https://stackoverflow.com/questions/55260703/how-to-use-insertion-and-extraction-operator-to-overload-the-object-in-c", "closed_reason": "Duplicate", "title": "How to use insertion and extraction operator to overload the object in c++", "body": "<p>There is a some part of code in which class is defined as Meal. The class,Meal, has a object of named total and I want to show and take input for total's attributes. I went many solutions but didn't get any proper solution. Please help me in solving this problem. I would be grateful.</p>\n\n<pre><code>void operator &lt;&lt;(ostream &amp;out, Meal &amp;ob)\n    {\n        out&lt;&lt;\"Entree: \"&lt;&lt;ob.entree&lt;&lt;endl;\n        out&lt;&lt;\"Calorie: \"&lt;&lt;ob.countCalorie&lt;&lt;endl;\n    }\n    void operator &gt;&gt;(istream &amp;input, Meal &amp;ob)\n    {\n        cout&lt;&lt;\"Enter entree: \";\n        input&gt;&gt;ob.entree;\n        cout&lt;&lt;\"Enter calorie: \";\n        input&gt;&gt;ob.countCalorie;\n    }\n\n\nint main()\n{\nMeal *week[21], total;\nstring entree;\nint cal;\nfor(int i = 0; i &lt; 21; i++)\n{\n    cout&lt;&lt;\"Enter \"&lt;&lt;i+1&lt;&lt;\" entree: \";\n    cin&gt;&gt;entree;\n    cout&lt;&lt;\"Enter \"&lt;&lt;i+1&lt;&lt;\" calorie: \";\n    cin&gt;&gt;cal;\n\n    week[i] = new Meal(entree,cal);\n}\nfor(int i = 0; i &lt; 21 ; i++)\n{\n    total = total + week[i];\n}\ncout&lt;&lt;total;\n\ncin&gt;&gt;total;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c++", "gradle", "kotlin", "protocol-buffers"], "answers": [{"tags": [], "owner": {"reputation": 1557, "user_id": 1156377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0tsJk.jpg?s=128&g=1", "display_name": "Mark K Cowan", "link": "https://stackoverflow.com/users/1156377/mark-k-cowan"}, "is_accepted": true, "score": 4, "last_activity_date": 1553084523, "creation_date": 1553084523, "answer_id": 55260687, "question_id": 55260686, "link": "https://stackoverflow.com/questions/55260686/gradle-java-kotlin-c-protobuf-in-the-same-project/55260687#55260687", "title": "Gradle: Java/Kotlin, C++, ProtoBuf in the same project", "body": "<p>I solved this while I was writing the question.</p>\n\n<p>The gradle configuration files are shown below.  There are a couple redundant blocks which are not needed for this example (or needed at all), however they achieve the objective.</p>\n\n<p>/build.gradle</p>\n\n<pre><code>subprojects {\n        group = 'com.whatever.your.group'\n        version = '0.0.0'\n        repositories {\n                mavenCentral()\n        }\n}\n</code></pre>\n\n<p>/settings.gradle</p>\n\n<pre><code>rootProject.name = 'my-project'\ninclude 'java-app'\ninclude 'cpp-app'\ninclude 'protocol'\n</code></pre>\n\n<p>/java-app/build.gradle</p>\n\n<pre><code>buildscript {\n        repositories {\n                mavenCentral()\n        }\n        dependencies {\n                classpath \"org.jetbrains.kotlin:kotlin-gradle-plugin:1.3.20\"\n        }\n}\n\nplugins {\n        // Java\n        id 'maven'\n        id 'idea'\n        id 'application'\n        id 'java'\n        id 'org.jetbrains.kotlin.jvm' version '1.3.20'\n\n        // ProtoBuf\n        id 'com.google.protobuf' version '0.8.8'\n}\n\ndescription = \"\"\"\"\"\"\n\nsourceCompatibility = 8\ntargetCompatibility = 8\n\ncompileKotlin {\n        kotlinOptions.jvmTarget = \"1.8\"\n}\ncompileTestKotlin {\n        kotlinOptions.jvmTarget = \"1.8\"\n}\n\nmainClassName = 'my.main.Class'\n\ndependencies {\n        protobuf project(':protocol') // &lt;-- name of protobuf project\n        compile project(':protocol')  // &lt;-- name of protobuf project\n        // We have \"protobuf\" and \"compile\", as \"compile\" brings in transitive dependencies\n\n        testCompile 'junit:junit:4.12'\n\n        implementation \"org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.3.20\"\n\n        testImplementation \"org.jetbrains.kotlin:kotlin-test:1.3.20\"\n        testImplementation \"org.jetbrains.kotlin:kotlin-test-junit:1.3.20\"\n}\n\nsourceSets {\n        main {\n                java {\n                        srcDir \"src/main/java\"\n                }\n                kotlin {\n                        srcDir \"src/main/kotlin\"\n                }\n        }\n}\n</code></pre>\n\n<p>/java-app/settings.gradle</p>\n\n<pre><code>rootProject.name = 'java-app'\n</code></pre>\n\n<p>/cpp-app/build.gradle</p>\n\n<pre><code>plugins {\n        id 'maven'\n        id 'cpp'\n}\n\ndescription = \"\"\"\"\"\"\n\nproject.tasks.build.dependsOn 'protocol'  // &lt;-- name of protobuf project\n\nmodel {\n        components {\n                main(NativeExecutableSpec) {\n                        ...\n                }\n        }\n        ...\n}\n</code></pre>\n\n<p>/cpp-app/settings.gradle</p>\n\n<pre><code>rootProject.name = 'cpp-app'\n</code></pre>\n\n<p>/protocol/build.gradle</p>\n\n<pre><code>plugins {\n        id 'maven'\n        id 'java'\n        id 'com.google.protobuf' version '0.8.8'\n}\n\nrepositories {\n        mavenCentral()\n}\n\ndescription = \"\"\"\"\"\"\n\nsourceCompatibility = 8\ntargetCompatibility = 8\n\ndependencies {\n        compile 'com.google.protobuf:protobuf-java:3.7.0'\n        compile 'io.grpc:grpc-stub:1.19.0'\n        compile 'io.grpc:grpc-protobuf:1.19.0'\n}\n\nsourceSets {\n        main {\n                proto {\n                        srcDir \"src/main/proto\"\n                }\n        }\n}\n\nprotobuf {\n        protoc {\n                artifact = \"com.google.protobuf:protoc:3.7.0\"\n        }\n        plugins {\n                grpc_java {\n                        artifact = 'io.grpc:protoc-gen-grpc-java:1.19.0'\n                }\n                grpc_cpp {\n                        path = getPluginPath('cpp')\n                }\n                grpc_python {\n                        path = getPluginPath('python')\n                }\n        }\n        generateProtoTasks {\n                generatedFilesBaseDir = \"${buildDir}/build/generated/src\"\n                all()*.builtins {\n                        java { }\n                        cpp { }\n                        python { }\n                }\n                all()*.plugins {\n                        grpc_java {\n                                outputSubDir = 'java'\n                        }\n                        grpc_cpp {\n                                outputSubDir = 'cpp'\n                        }\n                        grpc_python {\n                                outputSubDir = 'python'\n                        }\n                }\n        }\n}\n\nclean {\n        delete protobuf.generatedFilesBaseDir\n}\n\n// Used to find executables for generating C++ and Java gRPC\nstatic def getPluginPath(name) {\n        def path = \"which grpc_${name}_plugin\".execute()\n        path.waitFor()\n        path = path.in.text.trim()\n        if (!path) {\n                println \"Failed to locate GRPC plugin for ${name}\"\n        } else {\n                println \"Found GRPC plugin for ${name} at ${path}\"\n        }\n        return path\n}\n</code></pre>\n\n<p>/protocol/settings.gradle</p>\n\n<pre><code>rootProject.name = 'protocol'\n</code></pre>\n\n<p>Then in the project root, I can run <code>gradle assemble</code>, and:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ gradle assemble\n\n&gt; Configure project :protocol\nFound GRPC plugin for cpp at /usr/bin/grpc_cpp_plugin\nFound GRPC plugin for python at /usr/bin/grpc_python_plugin\n\n&gt; Task :cpp-app:linkMainExecutable NO-SOURCE\n&gt; Task :cpp-app:mainExecutable UP-TO-DATE\n&gt; Task :cpp-app:assemble UP-TO-DATE\n&gt; Task :protocol:extractIncludeProto\n&gt; Task :protocol:extractProto\n&gt; Task :protocol:generateProto\n&gt; Task :protocol:compileJava\n&gt; Task :protocol:processResources\n&gt; Task :protocol:classes\n&gt; Task :protocol:jar\n&gt; Task :protocol:assemble\n&gt; Task :java-app:extractIncludeProto\n&gt; Task :java-app:extractProto\n&gt; Task :java-app:generateProto\n&gt; Task :java-app:compileKotlin\n&gt; Task :java-app:compileJava\n&gt; Task :java-app:processResources\n&gt; Task :java-app:classes\n&gt; Task :java-app:inspectClassesForKotlinIC\n&gt; Task :java-app:jar\n&gt; Task :java-app:startScripts\n&gt; Task :java-app:distTar\n&gt; Task :java-app:distZip\n&gt; Task :java-app:assemble\n\nBUILD SUCCESSFUL in 10s\n17 actionable tasks: 17 executed\n</code></pre>\n"}], "owner": {"reputation": 1557, "user_id": 1156377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0tsJk.jpg?s=128&g=1", "display_name": "Mark K Cowan", "link": "https://stackoverflow.com/users/1156377/mark-k-cowan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 915, "favorite_count": 1, "accepted_answer_id": 55260687, "answer_count": 1, "score": 5, "last_activity_date": 1553084523, "creation_date": 1553084523, "question_id": 55260686, "link": "https://stackoverflow.com/questions/55260686/gradle-java-kotlin-c-protobuf-in-the-same-project", "title": "Gradle: Java/Kotlin, C++, ProtoBuf in the same project", "body": "<p>I have a Java+Kotlin application, building with Gradle.</p>\n\n<p>Some of its low-level functionality is provided by a separate C++ application.</p>\n\n<p>The two applications communicate via a socket or pipe, using Protocol Buffers and gRPC.</p>\n\n<p>Initially, I'd hoped to build all three (ProtoBuf generated code, Java application, C++ application) in one project, however the <code>cpp-application</code> and <code>java</code> conflict over certain tasks (compile/implementation/test?).</p>\n\n<p>I've since split this into three projects:</p>\n\n<pre><code>/\n build.gradle\n settings.gradle\n cpp-app/\n         build.gradle\n         settings.gradle\n         ...\n java-app/\n          build.gradle\n          settings.gradle\n          ...\n protocol/\n          build.gradle\n          settings.gradle\n          build/generated/source/proto/main/java/...   &lt;-- Java generated code\n          build/generated/source/proto/main/cpp/...    &lt;-- C++ generated code\n          ...\n</code></pre>\n\n<p>I have the <code>protocol</code> project successfully generating C++ and Java implementations.</p>\n\n<p>How do I get the C++ and Java application projects to resolve and to use these outputs in their builds?</p>\n"}, {"tags": ["c++", "visual-c++"], "comments": [{"owner": {"reputation": 1923, "user_id": 2683320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1277edc9447bb239cc46b68236a465?s=128&d=identicon&r=PG&f=1", "display_name": "Hanjoung Lee", "link": "https://stackoverflow.com/users/2683320/hanjoung-lee"}, "edited": false, "score": 3, "creation_date": 1553084541, "post_id": 55260571, "comment_id": 97252625, "body": "For version control you can have two individual integers - major and minor which is a common practice. See also: <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is floating point math broken?</a>"}, {"owner": {"reputation": 3112, "user_id": 278521, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/95147ce6f08f5039d98a2fd334c38b91?s=128&d=identicon&r=PG", "display_name": "Sijith", "link": "https://stackoverflow.com/users/278521/sijith"}, "reply_to_user": {"reputation": 1923, "user_id": 2683320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1277edc9447bb239cc46b68236a465?s=128&d=identicon&r=PG&f=1", "display_name": "Hanjoung Lee", "link": "https://stackoverflow.com/users/2683320/hanjoung-lee"}, "edited": false, "score": 0, "creation_date": 1553084609, "post_id": 55260571, "comment_id": 97252672, "body": "yes something similar only I need"}, {"owner": {"reputation": 1923, "user_id": 2683320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1277edc9447bb239cc46b68236a465?s=128&d=identicon&r=PG&f=1", "display_name": "Hanjoung Lee", "link": "https://stackoverflow.com/users/2683320/hanjoung-lee"}, "edited": false, "score": 0, "creation_date": 1553084731, "post_id": 55260571, "comment_id": 97252763, "body": "If having two variables bothers you, save it as a int value like <code>102</code> for version 1.2."}, {"owner": {"reputation": 3112, "user_id": 278521, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/95147ce6f08f5039d98a2fd334c38b91?s=128&d=identicon&r=PG", "display_name": "Sijith", "link": "https://stackoverflow.com/users/278521/sijith"}, "reply_to_user": {"reputation": 1923, "user_id": 2683320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1277edc9447bb239cc46b68236a465?s=128&d=identicon&r=PG&f=1", "display_name": "Hanjoung Lee", "link": "https://stackoverflow.com/users/2683320/hanjoung-lee"}, "edited": false, "score": 2, "creation_date": 1553084816, "post_id": 55260571, "comment_id": 97252820, "body": "So is it better to convert both into two integers and check indipendly"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 2, "creation_date": 1553085226, "post_id": 55260571, "comment_id": 97253074, "body": "Yes, your version system should not be based on floats anyway."}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 2208491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25de5e938818257da3ef2b2c135d9311?s=128&d=identicon&r=PG", "display_name": "Slobodan Markovic", "link": "https://stackoverflow.com/users/2208491/slobodan-markovic"}, "is_accepted": true, "score": 1, "last_activity_date": 1553084585, "creation_date": 1553084585, "answer_id": 55260710, "question_id": 55260571, "link": "https://stackoverflow.com/questions/55260571/float-comparison-gives-wrong-result-and-precision-changes/55260710#55260710", "title": "Float comparison gives wrong result and precision changes", "body": "<p>Why don't you create class that hold major version and minor version of passed versionInfo and add logic that checks there. The idea would be not to parse this as float, but to separate it by comma and take that info as int.</p>\n"}, {"tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": false, "score": 2, "last_activity_date": 1553085325, "creation_date": 1553085325, "answer_id": 55260922, "question_id": 55260571, "link": "https://stackoverflow.com/questions/55260571/float-comparison-gives-wrong-result-and-precision-changes/55260922#55260922", "title": "Float comparison gives wrong result and precision changes", "body": "<p>Version numbers are inherently integers. You already have a class, this class should have an integer value for the major version, and integer version for the minor version, and <strong>comparison operators</strong> (that's what you are trying to do).</p>\n\n<p>Other schemes even have a third patch integer, a string for alpha/RC... Implement this properly in a class that uses proper semantics (i.e. a method named <code>is_one_minor_version_away</code> where you properly test is there is only one minor version change).</p>\n\n<p>Also what happens if it's 2.9 against 3.0 in your case?</p>\n"}], "owner": {"reputation": 3112, "user_id": 278521, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/95147ce6f08f5039d98a2fd334c38b91?s=128&d=identicon&r=PG", "display_name": "Sijith", "link": "https://stackoverflow.com/users/278521/sijith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 55260710, "answer_count": 2, "score": -2, "last_activity_date": 1553088936, "creation_date": 1553084127, "last_edit_date": 1553088936, "question_id": 55260571, "link": "https://stackoverflow.com/questions/55260571/float-comparison-gives-wrong-result-and-precision-changes", "title": "Float comparison gives wrong result and precision changes", "body": "<p>I have version number 1.1, 1.2, 1.3 and I need to check version less or greater than 1.2, but while debugging I get wrong answer than expected</p>\n\n<pre><code>    float versionNumber = versinInfo.toFloat();\n    static float const VERSION_NUMBER(1.2);\n    if(abs((versionNumber - VERSION_NUMBER) &lt;= 0.001))\n    {\n      // do operation\n    }\n</code></pre>\n\n<p>versionNumber comes 1.10000005, I though to change check from 0.001 to 0.0000005 but it maynt be a correct fix</p>\n\n<p>please suggest best method</p>\n"}]