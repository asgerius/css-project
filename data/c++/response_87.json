[{"tags": ["c++", "output", "overloading"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 3, "creation_date": 1473291966, "post_id": 39380530, "comment_id": 66088942, "body": "Do not use new/delete needlessly."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 2977386, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/507798d4974f879e0d819b07a6062abb?s=128&d=identicon&r=PG&f=1", "display_name": "Ky6000", "link": "https://stackoverflow.com/users/2977386/ky6000"}, "edited": false, "score": 1, "creation_date": 1473291983, "post_id": 39380548, "comment_id": 66088946, "body": "Wow I put the asterix after test and not before... Thanks for the quick reply."}], "tags": [], "owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "is_accepted": true, "score": 6, "last_activity_date": 1473291814, "creation_date": 1473291814, "answer_id": 39380548, "question_id": 39380530, "link": "https://stackoverflow.com/questions/39380530/cant-overload-operator/39380548#39380548", "title": "Can&#39;t overload &quot;&lt;&lt;&quot; operator", "body": "<p>How about trying this:</p>\n\n<pre><code>std::cout &lt;&lt; \"output is: \" &lt;&lt; *test &lt;&lt; std::endl;\n</code></pre>\n\n<p>In your code, you are <code>cout</code>ing the pointer, not the object.</p>\n"}], "owner": {"reputation": 93, "user_id": 2977386, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/507798d4974f879e0d819b07a6062abb?s=128&d=identicon&r=PG&f=1", "display_name": "Ky6000", "link": "https://stackoverflow.com/users/2977386/ky6000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 39380548, "answer_count": 1, "score": 2, "last_activity_date": 1473291814, "creation_date": 1473291627, "question_id": 39380530, "link": "https://stackoverflow.com/questions/39380530/cant-overload-operator", "title": "Can&#39;t overload &quot;&lt;&lt;&quot; operator", "body": "<p>Everywhere I look I see everyone overloading the &lt;&lt; operator in a few lines, it seems very simple, but for some reason, overloading the &lt;&lt; operator in my code does nothing.</p>\n\n<p>In my .h I have:</p>\n\n<pre><code>    friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, const Test&amp; test);\n</code></pre>\n\n<p>And in my .cpp I have:</p>\n\n<pre><code>    std::ostream&amp; operator&lt;&lt;(std::ostream&amp; out,const DeckOfCards&amp; deck) {\n    out &lt;&lt; \"oi\"; //just testing with a normal string before i try methods\n    return out;\n}\n</code></pre>\n\n<p>And finally in the main function I have:</p>\n\n<pre><code>Test* test = new Test();\nstd::cout &lt;&lt; \"output is: \" &lt;&lt; test &lt;&lt; std::endl;\n</code></pre>\n\n<p>Could someone please tell me what I'm doing wrong? \nThanks in advance. </p>\n"}, {"tags": ["c++", "user-interface"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1473289632, "post_id": 39380272, "comment_id": 66088384, "body": "Do you include linking in the &quot;recompiling&quot; step? You could relink your code to the library of choice with little difficulty."}, {"owner": {"reputation": 118, "user_id": 1010049, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P3FB5.jpg?s=128&g=1", "display_name": "Jean Gregory", "link": "https://stackoverflow.com/users/1010049/jean-gregory"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1473290909, "post_id": 39380272, "comment_id": 66088690, "body": "Sorry, my question is not correctly formulated. I&#39;d like to know if there is a good way to code the same interface to a lib. Like using different namespace for the lib and using namespace alias to show the application the interface functions, Or using the same header file, with two different definition files (uh that one seems ugly) Geez already -2, guess my english aint good enough to ask questions, sorry :("}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1473291009, "post_id": 39380272, "comment_id": 66088713, "body": "No, your English is fine, it&#39;s just that the question is unclear. First you say &quot;without recompiling&quot;, but then you suggest using different namespaces and changing aliases, which is something you do <i>in the source code</i> and which would thus necessitate recompiling."}, {"owner": {"reputation": 118, "user_id": 1010049, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P3FB5.jpg?s=128&g=1", "display_name": "Jean Gregory", "link": "https://stackoverflow.com/users/1010049/jean-gregory"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1473291822, "post_id": 39380272, "comment_id": 66088896, "body": "My english is fine on paper, but it does not clearly ask what&#39;s in my head, leading to confusion and unclear question ;) Add to this that some aspect of c++ (like the linking part) is little known to me, you get the messy question here. I&#39;ll try to reformulate then thx :)"}], "answers": [{"tags": [], "owner": {"reputation": 1622, "user_id": 35951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14841b385915426bdf8ce0d98d26d3b1?s=128&d=identicon&r=PG", "display_name": "mooware", "link": "https://stackoverflow.com/users/35951/mooware"}, "is_accepted": true, "score": 1, "last_activity_date": 1473289826, "creation_date": 1473289826, "answer_id": 39380306, "question_id": 39380272, "link": "https://stackoverflow.com/questions/39380272/how-to-program-an-interchangeable-library/39380306#39380306", "title": "How to program an interchangeable library?", "body": "<p>Look up \"ABI compatibility\". The Qt/KDE projects have a good guide about that:</p>\n\n<p><a href=\"https://wiki.qt.io/Qt-Version-Compatibility\" rel=\"nofollow\">https://wiki.qt.io/Qt-Version-Compatibility</a>\n<a href=\"https://community.kde.org/Policies/Binary_Compatibility_Issues_With_C%2B%2B\" rel=\"nofollow\">https://community.kde.org/Policies/Binary_Compatibility_Issues_With_C++</a></p>\n\n<p>The extreme version of that would be the \"Hourglass Interface\" pattern, where the binary interface of the library is pure C, but there's an inlined C++ API above it and a C++ implementation below:</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=PVYdHDm0q6Y\" rel=\"nofollow\">https://www.youtube.com/watch?v=PVYdHDm0q6Y</a></p>\n\n<p>EDIT: Just wanted to add a clarification: Where these guides talk about compatibility between different versions, your libraries would have to adhere to the same restrictions for different backends.</p>\n"}], "owner": {"reputation": 118, "user_id": 1010049, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P3FB5.jpg?s=128&g=1", "display_name": "Jean Gregory", "link": "https://stackoverflow.com/users/1010049/jean-gregory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "closed_date": 1473290354, "accepted_answer_id": 39380306, "answer_count": 1, "score": -1, "last_activity_date": 1473293234, "creation_date": 1473289514, "last_edit_date": 1473293234, "question_id": 39380272, "link": "https://stackoverflow.com/questions/39380272/how-to-program-an-interchangeable-library", "closed_reason": "Needs more focus", "title": "How to program an interchangeable library?", "body": "<p>I'm currently programming a small library with abstract classes. Its a library that offers simple GUI creation classes, like <code>widget</code>, <code>main_window</code> etc. </p>\n\n<p>My goal is to code an application using interfaces and factory functions to creates actual objects. I use cmake for my project (for info but doesnt really matters). I'd like to include in my lib the abstract classes (easy) and different engine (like qt5_engine, gtk_engine, ...).</p>\n\n<p>The client(my application) using the lib can see only the abstract interfaces, and factory functions(methods, lambdas, builder classes??). When building the lib, I choose which engine to build (only one) to get libmy_lib.so. My application will use libmy_lib.so, no matter if its compiled with my qt5_engine or gtk_engine (staticly linked into my_lib for each engine)</p>\n\n<p>So that finally, I can simply overwrite libmy_lib.so compiled with a different engine to change the GUI used by my application. But I also like to know of a clean way to implement such lib with different engine, to get a clean code, the 'best pratices' for lib programming in other word.</p>\n\n<p>I kinda found the way to ask it, and so, the way to search for it >&lt; I accepted an answer which is the part for the 'change le lib file to change the GUI' but if you have references to library coding the clean way, the modern way, that would be awesome...</p>\n\n<p>Thx</p>\n"}, {"tags": ["c++", "file-io"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1473289171, "post_id": 39380174, "comment_id": 66088254, "body": "<a href=\"http://stackoverflow.com/questions/18577404/how-can-a-mixed-data-type-int-float-char-etc-be-stored-in-an-array/18577481#18577481\" title=\"how can a mixed data type int float char etc be stored in an array\">stackoverflow.com/questions/18577404/&hellip;</a>"}, {"owner": {"reputation": 9704, "user_id": 893254, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e4417c43fd253cd5b52e2dd709e34b44?s=128&d=identicon&r=PG&f=1", "display_name": "FreelanceConsultant", "link": "https://stackoverflow.com/users/893254/freelanceconsultant"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1473290635, "post_id": 39380174, "comment_id": 66088639, "body": "@Barmar That seems to be totally irrelevant to this question."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1473291260, "post_id": 39380174, "comment_id": 66088761, "body": "Why is that irrelevant? Make a vector of discriminated unions."}, {"owner": {"reputation": 9704, "user_id": 893254, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e4417c43fd253cd5b52e2dd709e34b44?s=128&d=identicon&r=PG&f=1", "display_name": "FreelanceConsultant", "link": "https://stackoverflow.com/users/893254/freelanceconsultant"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1473291376, "post_id": 39380174, "comment_id": 66088782, "body": "@Barmar I guess that could be a possible solution - you could add some code which implements a solution in that manner if you wish... but it doesn&#39;t seem sensible to me as there would be huge amounts of wasted memory for reading types such as <code>char</code> / <code>unsigned char</code>."}, {"owner": {"reputation": 9704, "user_id": 893254, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e4417c43fd253cd5b52e2dd709e34b44?s=128&d=identicon&r=PG&f=1", "display_name": "FreelanceConsultant", "link": "https://stackoverflow.com/users/893254/freelanceconsultant"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1473291415, "post_id": 39380174, "comment_id": 66088795, "body": "@Barmar I guess for me personally it&#39;s not a sensible solution. The question you linked is actually asking a totally different question, so I&#39;m not sure why you added it."}, {"owner": {"reputation": 9704, "user_id": 893254, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e4417c43fd253cd5b52e2dd709e34b44?s=128&d=identicon&r=PG&f=1", "display_name": "FreelanceConsultant", "link": "https://stackoverflow.com/users/893254/freelanceconsultant"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1473291459, "post_id": 39380174, "comment_id": 66088808, "body": "Just to clarify here, this is not a question about being able to store multiple different types in the same array..."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1473291795, "post_id": 39380174, "comment_id": 66088887, "body": "I misunderstood. Now I see that the file is uniform, either all int or all float, depending on the first 4 bytes."}, {"owner": {"reputation": 9704, "user_id": 893254, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e4417c43fd253cd5b52e2dd709e34b44?s=128&d=identicon&r=PG&f=1", "display_name": "FreelanceConsultant", "link": "https://stackoverflow.com/users/893254/freelanceconsultant"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1473291868, "post_id": 39380174, "comment_id": 66088909, "body": "@Barmar Okay fair enough... I can add a note about that if you like? (I did think it didn&#39;t make much sense, now I understand the confusion.)"}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 6918396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yQn6W.jpg?s=128&g=1", "display_name": "American Patriot", "link": "https://stackoverflow.com/users/6918396/american-patriot"}, "is_accepted": false, "score": 0, "last_activity_date": 1476549838, "last_edit_date": 1476549838, "creation_date": 1475888277, "answer_id": 39927620, "question_id": 39380174, "link": "https://stackoverflow.com/questions/39380174/c-reading-data-into-memory-when-data-format-and-type-is-unknown-at-compile-tim/39927620#39927620", "title": "C++ Reading Data into Memory when Data Format and Type is Unknown at Compile Time", "body": "<p>This may not be the easiest way to solve this problem, but I think it would work. I kind of feel like I need to have more information and code in order to actually solve this problem, so this is all I can do with the information given:</p>\n\n<p>I would read the integer (which denotes the data type in the file) into a <code>bool</code>. I would then pass it as an argument to some function like <code>vectorDataType</code> or something. In that function, use <code>if-else</code> statements and <code>typedef</code>. The <code>if-else</code> statements:</p>\n\n<pre><code>if (dataType == 0) {\n    typedef float fileData;\n}\nelse {\n    typedef double fileData;\n}\n</code></pre>\n\n<p>Now, you don't need to use type names, just the name you have defined as <code>float</code> or <code>double</code>.</p>\n\n<pre><code>std::vector&lt;fileData&gt;;\n</code></pre>\n\n<p>Not knowing the data type may create more problems in the program. But, assuming you don't need to know the data type outside of making the vector, this should be a good way to fix your present issue.</p>\n"}], "owner": {"reputation": 9704, "user_id": 893254, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e4417c43fd253cd5b52e2dd709e34b44?s=128&d=identicon&r=PG&f=1", "display_name": "FreelanceConsultant", "link": "https://stackoverflow.com/users/893254/freelanceconsultant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 1, "answer_count": 1, "score": -9, "last_activity_date": 1476549838, "creation_date": 1473288885, "last_edit_date": 1473373865, "question_id": 39380174, "link": "https://stackoverflow.com/questions/39380174/c-reading-data-into-memory-when-data-format-and-type-is-unknown-at-compile-tim", "title": "C++ Reading Data into Memory when Data Format and Type is Unknown at Compile Time", "body": "<h1>Question</h1>\n\n<p>How do I read data into a vector inside a class if the data format from a filestream is unknown?</p>\n\n<p><em>(Note: ... as discussed in the comments ... if the file format type is <code>float</code>, then the file only contains <code>float</code> data. It cannot be a mix of <code>float</code> and <code>double</code>. - This will make sense after understanding the question below...)</em></p>\n\n<p>I am writing a C++ class to read data from a file in a specified format. For the purposes of this question, let us simplify the file format. It is described below.</p>\n\n<ul>\n<li><p>The first 4 bytes of the file form an <code>int</code>, this is used as a flag to specify the file data format.</p>\n\n<ul>\n<li>If the <code>int</code> is 0, the file data is of type <code>float</code>.</li>\n<li>If the <code>int</code> is 1, the file data is of type <code>double</code>.</li>\n</ul></li>\n<li><p>The next 4 bytes of the file form an <code>int</code>. This specifies the number of elements to be read into an array or <code>std::vector</code>.</p></li>\n</ul>\n\n<p>However we do not know whether <code>std::vector&lt;float&gt;</code> or <code>std::vector&lt;double&gt;</code> is required in advance.</p>\n\n<p>I have had an attempt at solving this problem for myself, however I removed the attempt because this question was attracting a large number of downvotes, and as discussed in the meta one possible reason for this was that the attempt as solving the problem was not complete. (However you can see my completed attempt in the answer below - it has some problems as discussed in the comments which have not yet been fixed.)</p>\n"}, {"tags": ["c++", "class", "loops", "iterator"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 2, "creation_date": 1473288504, "post_id": 39380105, "comment_id": 66088067, "body": "No there isn&#39;t. Now, what is the real problem here. No, not the one you&#39;re asking about, but the one for which you think the solution is what you&#39;re asking about, here."}, {"owner": {"reputation": 1, "user_id": 5641250, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205342733913446/picture?type=large", "display_name": "Panagiotis Bellos", "link": "https://stackoverflow.com/users/5641250/panagiotis-bellos"}, "edited": false, "score": 0, "creation_date": 1473288794, "post_id": 39380105, "comment_id": 66088148, "body": "ok! thank you! i will try to think a different approach!"}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1473289232, "post_id": 39380105, "comment_id": 66088277, "body": "There is only one class in your code, there are three variables which are instances of the class."}, {"owner": {"reputation": 1577, "user_id": 6776535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c515e458c92c554943b271a6789f0372?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Pr&#233;vost", "link": "https://stackoverflow.com/users/6776535/robert-pr%c3%a9vost"}, "edited": false, "score": 0, "creation_date": 1473289303, "post_id": 39380105, "comment_id": 66088298, "body": "Do you mean something like this class samples{} a[3];?  This seems to work with g++ and clang++, but I&#39;ve never seen it."}], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 0, "last_activity_date": 1473291529, "creation_date": 1473291529, "answer_id": 39380516, "question_id": 39380105, "link": "https://stackoverflow.com/questions/39380105/loop-through-multiple-classes/39380516#39380516", "title": "loop through multiple classes", "body": "<p>You may want something like:</p>\n\n<pre><code>class samples{\n    void foo() const;\n};\n\nsamples a, b, c;\n\nfor (const auto&amp; s : { std::ref(a), std::ref(b), std::ref(c) }) {\n    s.foo();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 0, "last_activity_date": 1473291881, "creation_date": 1473291881, "answer_id": 39380552, "question_id": 39380105, "link": "https://stackoverflow.com/questions/39380105/loop-through-multiple-classes/39380552#39380552", "title": "loop through multiple classes", "body": "<p>...or equally horrid...</p>\n\n<pre><code>int main()\n{\n    class samples{\n    public:\n        samples(int x, int y, int z) : x(x), y(y), z(z) {}\n        int x, y , z;\n    }\n    a { 1, 2, 3 },\n    b { 4, 5, 6},\n    c { 7, 8, 9 };\n\n    for (auto&amp; s : { &amp;a, &amp;b, &amp;c })\n    {\n        std::cout &lt;&lt; s-&gt;x &lt;&lt; \" \" &lt;&lt; s-&gt;y &lt;&lt; \" \" &lt;&lt; s-&gt;z &lt;&lt; '\\n';\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 96, "user_id": 3546845, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNvCk.jpg?s=128&g=1", "display_name": "Matheus Nogueira", "link": "https://stackoverflow.com/users/3546845/matheus-nogueira"}, "is_accepted": false, "score": 0, "last_activity_date": 1473303214, "creation_date": 1473303214, "answer_id": 39381873, "question_id": 39380105, "link": "https://stackoverflow.com/questions/39380105/loop-through-multiple-classes/39381873#39381873", "title": "loop through multiple classes", "body": "<p>If you want to iterate different classes that do the same action, use polymorphism to accomplish that. You can create an abstract class to create an interface for your other classes, as this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class MyInterface {\n\n    public:\n        /* Common method that must be implemented by all children classes */\n        virtual void doSomething() = 0;\n };\n</code></pre>\n\n<p>And then you implement the specific method for each of your classes.\n</p>\n\n<pre><code>class MyClassA : public MyInterface {\n\n    public:\n        void doSomething() { /* Implementation for class A */ }\n};\n\nclass MyClassB : public MyInteface {\n\n    public:\n        void doSomething() { /* Implementation for class B */ }\n};\n</code></pre>\n\n<p>After that you can iterate your classes using the common interface and calling the common method. Like that:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>std::vector&lt;MyInterface&gt; classes;\n// Fill your vector with instances of your classes.\nfor (int i = 0; i &lt; classes.size(); ++i) {\n    classes.doSomething();\n}\n</code></pre>\n\n<p>Hope that helps you with your problem.</p>\n"}], "owner": {"reputation": 1, "user_id": 5641250, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205342733913446/picture?type=large", "display_name": "Panagiotis Bellos", "link": "https://stackoverflow.com/users/5641250/panagiotis-bellos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1473303214, "creation_date": 1473288422, "question_id": 39380105, "link": "https://stackoverflow.com/questions/39380105/loop-through-multiple-classes", "title": "loop through multiple classes", "body": "<p>in my code there are several classes </p>\n\n<pre><code>class samples{\nsome_public_variables\n} a, b, c;\n</code></pre>\n\n<p>I want to ask if there is any way to loop through all these classes, something like this</p>\n\n<pre><code>for(i=0; i&lt;number_of_classes; i++){\n    class[i].variable.do_something   }\n</code></pre>\n\n<p>thanks in advance!</p>\n"}, {"tags": ["c++", "string", "file", "stl"], "comments": [{"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 8, "creation_date": 1473286649, "post_id": 39379811, "comment_id": 66087513, "body": "<i>&quot;[If] the implementation was sharing strings&quot;</i> That&#39;s not legal as of C++11."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 3, "creation_date": 1473286742, "post_id": 39379811, "comment_id": 66087543, "body": "<i>&quot;Unfortunately, the string equivalent only provides the const variant:&quot;</i> That will be fixed in C++17, see <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/data\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/string/basic_string/data</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 2, "creation_date": 1473286791, "post_id": 39379811, "comment_id": 66087560, "body": "C++ 17 will have a non const std::string member <code>CharT* data();</code>"}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1473286857, "post_id": 39379811, "comment_id": 66087578, "body": "@BaummitAugen: that&#39;s good to know.  Is there actually something in the C++11 standard which guarantees that the <code>&amp;contents[0]</code> (or better, <code>const_cast</code> on <code>data()</code>) is safe?"}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "edited": false, "score": 0, "creation_date": 1473287008, "post_id": 39379811, "comment_id": 66087623, "body": "Actually, it notes: &quot;Modifying the character array accessed through data has undefined behavior.&quot; So my question stands for C++11..."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1473287080, "post_id": 39379811, "comment_id": 66087648, "body": "Can&#39;t find it right now but for 99.999999999999% of the time <code>&amp;contents[0]</code> will work until C++17.  Looking for the thread"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1473287080, "post_id": 39379811, "comment_id": 66087649, "body": "@Mohan That&#39;s somewhat murky water because <code>std::string</code> gets changed all the time, but iirc the <code>const_cast</code> is technically UB but the <code>&amp;contents[0]</code> is fine. I&#39;m sure this is answered somewhere on SO in detail."}, {"owner": {"reputation": 19253, "user_id": 657267, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1dcf516021abb964aecd6ae2386fd59d?s=128&d=identicon&r=PG", "display_name": "user657267", "link": "https://stackoverflow.com/users/657267/user657267"}, "edited": false, "score": 1, "creation_date": 1473287157, "post_id": 39379811, "comment_id": 66087675, "body": "C++ filebufs are implemented in <a href=\"http://en.cppreference.com/w/cpp/io/basic_filebuf/seekoff\" rel=\"nofollow noreferrer\">terms of the C library</a>, where seeking to the end of a binary stream has undefined behaviour. I&#39;ve never seen it not work correctly, but caveat emptor."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 2, "creation_date": 1473288441, "post_id": 39379811, "comment_id": 66088050, "body": "&quot;If, for example, the implementation was sharing strings then modifying the data at &amp;contents[0] could affect strings other than the one being read.&quot; -- this is 100% false. If that happens, it&#39;s a bug in the C++ library."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 1, "creation_date": 1473290652, "post_id": 39379811, "comment_id": 66088644, "body": "@Mohan: &quot;<i>Is there actually something in the C++11 standard which guarantees that the &amp;contents[0] (or better, const_cast on data()) is safe?</i>&quot; Yes. <code>std::basic_string</code> is <i>required</i> to be a contiguously allocated array of characters. From C++14: [string.require]/3: &quot;The char-like objects in a <code>basic_string</code> object shall be stored contiguously.&quot;"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1473291166, "post_id": 39379811, "comment_id": 66088743, "body": "@Mohan: &quot;<i>C++ and the STL are designed to provide features that are efficient as C</i>&quot; Which is too bad, since <code>iostream</code> was <i>not</i> designed by the same people who designed the STL."}, {"owner": {"reputation": 93172, "user_id": 1734130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AZ5Sn.png?s=128&g=1", "display_name": "mvp", "link": "https://stackoverflow.com/users/1734130/mvp"}, "edited": false, "score": 0, "creation_date": 1473291200, "post_id": 39379811, "comment_id": 66088746, "body": "If you are looking for high performance reading of text files, you should use <code>mmap</code>. Check this question: <a href=\"http://stackoverflow.com/questions/17925051/fast-textfile-reading-in-c/17925143#17925143\" title=\"fast textfile reading in c\">stackoverflow.com/questions/17925051/fast-textfile-reading-i&zwnj;&#8203;n-c/&hellip;</a>"}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "edited": false, "score": 0, "creation_date": 1473292101, "post_id": 39379811, "comment_id": 66088975, "body": "mvp: I had considered it but as it reduces portability will hold off unless profiling suggests it&#39;s really necessary.  Also, mmapping is indeed faster than reading the whole file into memory, but there is no guarantee that the subsequent access will be fast, which is actually more important for the application in question."}], "answers": [{"comments": [{"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "edited": false, "score": 0, "creation_date": 1473289171, "post_id": 39380181, "comment_id": 66088255, "body": "&quot;The istringstream would have to copy the data anyway&quot;. What a pain -- I assumed it was efficient.  Apparently &quot;Boost.IOStreams has a stream that works like a stringstream, but wraps a native array, so you avoid having to copy the data.&quot; (<a href=\"http://stackoverflow.com/a/1448504/1908650\">stackoverflow.com/a/1448504/1908650</a>)"}, {"owner": {"reputation": 1622, "user_id": 35951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14841b385915426bdf8ce0d98d26d3b1?s=128&d=identicon&r=PG", "display_name": "mooware", "link": "https://stackoverflow.com/users/35951/mooware"}, "reply_to_user": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "edited": false, "score": 0, "creation_date": 1473289222, "post_id": 39380181, "comment_id": 66088276, "body": "I forgot to mention the other alternative I was thinking of: why not just read  the file with std::ifstream in the first place?"}, {"owner": {"reputation": 1622, "user_id": 35951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14841b385915426bdf8ce0d98d26d3b1?s=128&d=identicon&r=PG", "display_name": "mooware", "link": "https://stackoverflow.com/users/35951/mooware"}, "reply_to_user": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "edited": false, "score": 0, "creation_date": 1473289392, "post_id": 39380181, "comment_id": 66088322, "body": "About the copying: apparently a std::stringbuf could store a std::string, but e.g. the MSVC STL doesn&#39;t as far as I remember. And it wouldn&#39;t help much anyway, since the istringstream ctor and str() method don&#39;t take rvalue refs as far as I can see."}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "edited": false, "score": 0, "creation_date": 1473289411, "post_id": 39380181, "comment_id": 66088331, "body": "Are you asking why am reading the file into a string and then using an <code>istringstream</code>? I need a transparent interface that can&#39;t tell whether it&#39;s accessing data in memory or on disk.  The fact that <code>istringstream</code> and <code>ifstream</code> both derive from <code>istream</code> seemed to provide a convenient way of achieving this.  But it&#39;s no use if the <code>istringstream</code> is copying the entire file."}, {"owner": {"reputation": 1622, "user_id": 35951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14841b385915426bdf8ce0d98d26d3b1?s=128&d=identicon&r=PG", "display_name": "mooware", "link": "https://stackoverflow.com/users/35951/mooware"}, "reply_to_user": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "edited": false, "score": 0, "creation_date": 1473289563, "post_id": 39380181, "comment_id": 66088363, "body": "I think I still don&#39;t understand: If you&#39;re using the <code>std::istream</code> interface, then you could use a <code>std::ifstream</code> instance."}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "edited": false, "score": 0, "creation_date": 1473289848, "post_id": 39380181, "comment_id": 66088445, "body": "A certain body of code has to perform a lot of random access on some binary data. Users want the option to have that data stored either on disk (to keep memory footprint down) or in memory (for speed).  The choice is made at runtime.  So the code in question needs to be written in a way that either accesses data on disk or accesses data in memory. Data on disk can be accessed using a <code>ifstream</code>; data in memory (specifically a string) can be accessed using an <code>istringstream</code>. So if the code accepts an <code>istream&amp;</code>, then it can handle either data on disk or data in memory."}], "tags": [], "owner": {"reputation": 1622, "user_id": 35951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14841b385915426bdf8ce0d98d26d3b1?s=128&d=identicon&r=PG", "display_name": "mooware", "link": "https://stackoverflow.com/users/35951/mooware"}, "is_accepted": false, "score": 1, "last_activity_date": 1473290777, "last_edit_date": 1473290777, "creation_date": 1473288951, "answer_id": 39380181, "question_id": 39379811, "link": "https://stackoverflow.com/questions/39379811/reading-large-strings-in-c-is-there-a-safe-fast-way/39380181#39380181", "title": "Reading large strings in C++ -- is there a safe fast way?", "body": "<p>I think using <code>&amp;string[0]</code> is just fine, and it should work with the widely used standard library implementations (even if it is technically UB).</p>\n\n<p>But since you mention that you want to put the data into an <code>istringstream</code>, here's an alternative:</p>\n\n<ol>\n<li>Read the data into a char array (<code>new char[in.tellg()]</code>)</li>\n<li>Construct a <code>stringstream</code> (without the leading 'i')</li>\n<li>Insert the data with <a href=\"http://en.cppreference.com/w/cpp/io/basic_ostream/write\" rel=\"nofollow\" title=\"std::basic_ostream::write\">stringstream::write</a></li>\n</ol>\n\n<p>The <code>istringstream</code> would have to copy the data anyway, because a <code>std::stringstream</code> doesn't store a <code>std::string</code> internally as far as I'm aware, so you can leave the <code>std::string</code> away and put the data into it directly.</p>\n\n<p>EDIT: Actually, instead of the manual allocation (or <code>make_unique</code>), this way you could also use the <code>vector&lt;char&gt;</code> you mentioned.</p>\n"}, {"comments": [{"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "edited": false, "score": 0, "creation_date": 1473292218, "post_id": 39380374, "comment_id": 66089003, "body": "It&#39;s a few megabytes of memory which will subsequently be accessed randomly, so the buffer inside the <code>ifstream</code> is definitely not going to do the trick. Avoiding copying is important because the memory footprint needs to be kept down. I may indeed roll my own <code>std::basic_stringbuf</code> or use the one provided by boost iostreams."}], "tags": [], "owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "is_accepted": false, "score": 2, "last_activity_date": 1473290418, "creation_date": 1473290418, "answer_id": 39380374, "question_id": 39379811, "link": "https://stackoverflow.com/questions/39379811/reading-large-strings-in-c-is-there-a-safe-fast-way/39380374#39380374", "title": "Reading large strings in C++ -- is there a safe fast way?", "body": "<p>If you really want to avoid copies, you can slurp the file into a <code>std::vector&lt;char&gt;</code>, and then roll your own <a href=\"http://en.cppreference.com/w/cpp/io/basic_stringbuf\" rel=\"nofollow\"><code>std::basic_stringbuf</code></a> to pull data from the vector.</p>\n\n<p>You can then declare a <code>std::istringstream</code> and use <a href=\"http://en.cppreference.com/w/cpp/io/basic_ios/rdbuf\" rel=\"nofollow\"><code>std::basic_ios::rdbuf</code></a> to replace the input buffer with your own one.</p>\n\n<p>The caveat is that if you choose to call <a href=\"http://en.cppreference.com/w/cpp/io/basic_stringstream/str\" rel=\"nofollow\"><code>istringstream::str</code></a> it will invoke <a href=\"http://en.cppreference.com/w/cpp/io/basic_stringbuf/str\" rel=\"nofollow\"><code>std::basic_stringbuf::str</code></a> and will require a copy.  But then, it sounds like you won't be needing that function, and can actually stub it out.</p>\n\n<p>Whether you get better performance this way would require actual measurement.  But at least you avoid having to have two large contiguous memory blocks during the copy.  Additionally, you could use something like <code>std::deque</code> as your underlying structure if you want to cope with truly huge files that cannot be allocated in contiguous memory.</p>\n\n<p>It's also worth mentioning that if you're really just streaming that data you are essentially double-buffering by reading it into a string first.  Unless you also require the contents in memory for some other purpose, the buffering inside <code>std::ifstream</code> is likely to be sufficient.  If you <em>do</em> slurp the file, you may get a boost by turning buffering <em>off</em>.</p>\n"}], "owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1880, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1473290777, "creation_date": 1473286507, "question_id": 39379811, "link": "https://stackoverflow.com/questions/39379811/reading-large-strings-in-c-is-there-a-safe-fast-way", "title": "Reading large strings in C++ -- is there a safe fast way?", "body": "<p><a href=\"http://insanecoding.blogspot.co.uk/2011/11/how-to-read-in-file-in-c.html\" rel=\"noreferrer\">http://insanecoding.blogspot.co.uk/2011/11/how-to-read-in-file-in-c.html</a> reviews a number of ways of reading an entire file into a string in C++. The key code for the fastest option looks like this:</p>\n\n<pre><code>std::string contents;\nin.seekg(0, std::ios::end);\ncontents.resize(in.tellg());\nin.seekg(0, std::ios::beg);\nin.read(&amp;contents[0], contents.size());\n</code></pre>\n\n<p>Unfortunately, this is not safe as it relies on the <code>string</code> being implemented in a particular way. If, for example, the implementation was sharing strings then modifying the data at <code>&amp;contents[0]</code> could affect strings other than the one being read.  (More generally, there's no guarantee that this won't trash arbitrary memory -- it's unlikely to happen in practice, but it's not good practice to rely on that.)</p>\n\n<p>C++ and the STL are designed to provide features that are efficient as C, so one would expect there to be a version of the above that was just as fast but guaranteed to be safe. </p>\n\n<p>In the case of <code>vector&lt;T&gt;</code>, there are functions which can be used to access the raw data, which can be used to read a vector efficiently:</p>\n\n<pre><code>T* vector::data();\nconst T* vector::data() const; \n</code></pre>\n\n<p>The first of these can be used to read a <code>vector&lt;T&gt;</code> efficiently. Unfortunately, the <code>string</code> equivalent <em>only</em> provides the <code>const</code> variant:</p>\n\n<pre><code>const char* string::data() const noexcept;\n</code></pre>\n\n<p>So this cannot be used to read a string efficiently. (Presumably the <code>non-const</code> variant is omitted to support the shared string implementation.)</p>\n\n<p>I have also checked the string constructors, but the ones that accept a <code>char*</code> copy the data -- there's no option to move it.</p>\n\n<p>Is there a safe and fast way of reading the whole contents of a file into a string?</p>\n\n<p>It may be worth noting that I want to read a <code>string</code> rather than a <code>vector&lt;char&gt;</code> so that I can access the resulting data using a <code>istringstream</code>. There's no equivalent of that for <code>vector&lt;char&gt;</code>.</p>\n"}, {"tags": ["c++", "opencv", "tensorflow", "ros"], "answers": [{"comments": [{"owner": {"reputation": 413, "user_id": 6806574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cc49db249fce6fdbb77cab4c25334ec?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6806574/paul"}, "edited": false, "score": 0, "creation_date": 1473349171, "post_id": 39380345, "comment_id": 66116328, "body": "Awesome, thanks for the quick response!  I will try to use the C api to get a tensor into my code.  I use the C++ api currently to load my graph from disk, so I guess I will have to try to use the private friend API.  I will let you know as soon as I can get results."}, {"owner": {"reputation": 413, "user_id": 6806574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cc49db249fce6fdbb77cab4c25334ec?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6806574/paul"}, "edited": false, "score": 0, "creation_date": 1475623771, "post_id": 39380345, "comment_id": 67014530, "body": "I am trying to get this to work with my external library but having no luck compiling it.  I can get the compiler happy by declaring the TensorCApi class and the TF_Tensor class in my source.  However, when I run it, I get an error: <code>&#47;opt&#47;ros&#47;indigo&#47;lib&#47;nodelet&#47;nodelet: symbol lookup error: &#47;home&#47;paul&#47;catkin_ws&#47;devel&#47;lib&#47;&#47;libDeepModel.so: undefined symbol: TF_NewTensor</code>.  When I tried to define the class in the tensorflow source (in <code>c_api.h</code>), it seems it is not being compiled.  I am using the <code>&#47;&#47;tensorflow:libtensorflow.so</code> build target, does this build target not include the C api?"}, {"owner": {"reputation": 303, "user_id": 1850614, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7e349b8cc3a3a8e6290f9fa489d18567?s=128&d=identicon&r=PG", "display_name": "dcofer", "link": "https://stackoverflow.com/users/1850614/dcofer"}, "edited": false, "score": 1, "creation_date": 1483875822, "post_id": 39380345, "comment_id": 70269668, "body": "Did you ever get this working? If so, do you have any code snippets you can share? I am also looking to interface opencv from ROS and need something like this. I was amazed when I started looking into this that the only way to get an opencv Mat into a Tensor was a horribly slow copy loop."}, {"owner": {"reputation": 284, "user_id": 576734, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6333fba0bb94b09857d63cf94142ed4e?s=128&d=identicon&r=PG", "display_name": "Allan N&#248;rgaard", "link": "https://stackoverflow.com/users/576734/allan-n%c3%b8rgaard"}, "reply_to_user": {"reputation": 413, "user_id": 6806574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cc49db249fce6fdbb77cab4c25334ec?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6806574/paul"}, "edited": false, "score": 0, "creation_date": 1484664580, "post_id": 39380345, "comment_id": 70596138, "body": "@Paul, I know this is quite some time later, but aren&#39;t you supposed to compile //tensorflow:libtensorflow_c.so instead? Also, did you succed in doing the above? I basically need to to the same, and was very disappointed that the C++ API cannot do this"}, {"owner": {"reputation": 413, "user_id": 6806574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cc49db249fce6fdbb77cab4c25334ec?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6806574/paul"}, "reply_to_user": {"reputation": 284, "user_id": 576734, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6333fba0bb94b09857d63cf94142ed4e?s=128&d=identicon&r=PG", "display_name": "Allan N&#248;rgaard", "link": "https://stackoverflow.com/users/576734/allan-n%c3%b8rgaard"}, "edited": false, "score": 0, "creation_date": 1488495057, "post_id": 39380345, "comment_id": 72268902, "body": "@allan, I did get this working.  I edited my initial question to point to an explanation.  I also opened a github issue to hopefully get this included in the tensorflow source."}, {"owner": {"reputation": 1034, "user_id": 2168245, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/LrOaG.jpg?s=128&g=1", "display_name": "mhaghighat", "link": "https://stackoverflow.com/users/2168245/mhaghighat"}, "reply_to_user": {"reputation": 413, "user_id": 6806574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cc49db249fce6fdbb77cab4c25334ec?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6806574/paul"}, "edited": false, "score": 0, "creation_date": 1488580445, "post_id": 39380345, "comment_id": 72311467, "body": "@Paul, Could you also get it working in C++? Can you please share your code?"}, {"owner": {"reputation": 284, "user_id": 576734, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6333fba0bb94b09857d63cf94142ed4e?s=128&d=identicon&r=PG", "display_name": "Allan N&#248;rgaard", "link": "https://stackoverflow.com/users/576734/allan-n%c3%b8rgaard"}, "reply_to_user": {"reputation": 413, "user_id": 6806574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cc49db249fce6fdbb77cab4c25334ec?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6806574/paul"}, "edited": false, "score": 0, "creation_date": 1488802112, "post_id": 39380345, "comment_id": 72378306, "body": "@Paul We ended up opening a github issue too, and were told that it is currently possible in the C API only. But using pure memcpy turned out to be fast enough for our C++ implementation (~60fps HD images)"}, {"owner": {"reputation": 284, "user_id": 576734, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6333fba0bb94b09857d63cf94142ed4e?s=128&d=identicon&r=PG", "display_name": "Allan N&#248;rgaard", "link": "https://stackoverflow.com/users/576734/allan-n%c3%b8rgaard"}, "reply_to_user": {"reputation": 1034, "user_id": 2168245, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/LrOaG.jpg?s=128&g=1", "display_name": "mhaghighat", "link": "https://stackoverflow.com/users/2168245/mhaghighat"}, "edited": false, "score": 0, "creation_date": 1488802178, "post_id": 39380345, "comment_id": 72378344, "body": "@MBA see above ;) The memcpy can eat raw amounts of data in no time, I bet it might be enough for your problem aswell, although it is not the preferred method"}, {"owner": {"reputation": 413, "user_id": 6806574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cc49db249fce6fdbb77cab4c25334ec?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6806574/paul"}, "reply_to_user": {"reputation": 1034, "user_id": 2168245, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/LrOaG.jpg?s=128&g=1", "display_name": "mhaghighat", "link": "https://stackoverflow.com/users/2168245/mhaghighat"}, "edited": false, "score": 0, "creation_date": 1488826201, "post_id": 39380345, "comment_id": 72394329, "body": "@MBA I had to declare the <code>TF_Tensor</code> type in my code: <code>struct TF_Tensor {   TF_DataType dtype;   TensorShape shape;   TensorBuffer* buffer; };</code> and add several additional tensorflow directories in my cmake file to get it to compile.  I don&#39;t have a public version of the code yet, and I don&#39;t think there is any officially supported way of doing this out of source build with the C++ interface."}, {"owner": {"reputation": 413, "user_id": 6806574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cc49db249fce6fdbb77cab4c25334ec?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6806574/paul"}, "reply_to_user": {"reputation": 284, "user_id": 576734, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6333fba0bb94b09857d63cf94142ed4e?s=128&d=identicon&r=PG", "display_name": "Allan N&#248;rgaard", "link": "https://stackoverflow.com/users/576734/allan-n%c3%b8rgaard"}, "edited": false, "score": 0, "creation_date": 1488826478, "post_id": 39380345, "comment_id": 72394481, "body": "@AllanN&#248;rgaard Thanks for the tip with memcopy.  Sounds like a viable solution as well."}, {"owner": {"reputation": 199, "user_id": 3535616, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/20ad9d8fe2c4f95af377d649437d9e6d?s=128&d=identicon&r=PG", "display_name": "Jim", "link": "https://stackoverflow.com/users/3535616/jim"}, "reply_to_user": {"reputation": 284, "user_id": 576734, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6333fba0bb94b09857d63cf94142ed4e?s=128&d=identicon&r=PG", "display_name": "Allan N&#248;rgaard", "link": "https://stackoverflow.com/users/576734/allan-n%c3%b8rgaard"}, "edited": false, "score": 0, "creation_date": 1512049611, "post_id": 39380345, "comment_id": 82106740, "body": "@AllanN&#248;rgaard Could you llink the github issue you created? I&#39;d love to look at the memcpy solution."}], "tags": [], "owner": {"reputation": 119710, "user_id": 3574081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LIW6C.jpg?s=128&g=1", "display_name": "mrry", "link": "https://stackoverflow.com/users/3574081/mrry"}, "is_accepted": true, "score": 9, "last_activity_date": 1473293722, "last_edit_date": 1473293722, "creation_date": 1473290186, "answer_id": 39380345, "question_id": 39379747, "link": "https://stackoverflow.com/questions/39379747/import-opencv-mat-into-c-tensorflow-without-copying/39380345#39380345", "title": "Import OpenCV Mat into C++ Tensorflow without copying", "body": "<p>The TensorFlow C API (as opposed to the C++ API) exports the <a href=\"https://github.com/tensorflow/tensorflow/blob/f71cc62282bf2e066f9ebd08cf3f605fc98c6e41/tensorflow/c/c_api.h#L183\" rel=\"noreferrer\"><code>TF_NewTensor()</code></a> function, which allows you to create a tensor from a pointer and a length, and you can pass the resulting object to the <a href=\"https://github.com/tensorflow/tensorflow/blob/f71cc62282bf2e066f9ebd08cf3f605fc98c6e41/tensorflow/c/c_api.h#L652\" rel=\"noreferrer\"><code>TF_Run()</code></a> function.</p>\n\n<p>Currently this is the only public API for creating a TensorFlow tensor from a pre-allocated buffer. There is no supported way to cast a <code>TF_Tensor*</code> to a <code>tensorflow::Tensor</code> but if you look at the implementation there is a private API with <code>friend</code> access that can do this. If you experiment with this, and can show an appreciable speedup, we'd consider a <a href=\"https://github.com/tensorflow/tensorflow/issues\" rel=\"noreferrer\">feature request</a> for adding this to the public API.</p>\n"}, {"comments": [{"owner": {"reputation": 199, "user_id": 3535616, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/20ad9d8fe2c4f95af377d649437d9e6d?s=128&d=identicon&r=PG", "display_name": "Jim", "link": "https://stackoverflow.com/users/3535616/jim"}, "edited": false, "score": 2, "creation_date": 1512050164, "post_id": 46415124, "comment_id": 82107107, "body": "Any way to do this for a tensor which has a batch of images?  Eg. <code>Tensor inputImg(DT_FLOAT, TensorShape({4,inputHeight,inputWidth,3}));</code>  Since tensors aren&#39;t subscriptable, I&#39;d imagine you would create tensors for each image, load the <code>cv::Mat</code> into it, and combine them somehow to forrn <code>inputImg</code>. If so, is there a way to combine tensors?"}], "tags": [], "owner": {"reputation": 201, "user_id": 8672942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89df8717bdc2bf31f20746a33e3e8d4?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Michel", "link": "https://stackoverflow.com/users/8672942/guillaume-michel"}, "is_accepted": false, "score": 16, "last_activity_date": 1506378524, "creation_date": 1506378524, "answer_id": 46415124, "question_id": 39379747, "link": "https://stackoverflow.com/questions/39379747/import-opencv-mat-into-c-tensorflow-without-copying/46415124#46415124", "title": "Import OpenCV Mat into C++ Tensorflow without copying", "body": "<p>I know that it is old thread but there is a zero copy solution to your problem using the existing C++ API: I updated your github issue with my solution. <a href=\"https://github.com/tensorflow/tensorflow/issues/8033\" rel=\"noreferrer\">tensorflow/issues/8033</a></p>\n\n<p>For the record I copy my solution here:</p>\n\n<pre><code>// allocate a Tensor\nTensor inputImg(DT_FLOAT, TensorShape({1,inputHeight,inputWidth,3}));\n\n// get pointer to memory for that Tensor\nfloat *p = inputImg.flat&lt;float&gt;().data();\n// create a \"fake\" cv::Mat from it \ncv::Mat cameraImg(inputHeight, inputWidth, CV_32FC3, p);\n\n// use it here as a destination\ncv::Mat imagePixels = ...; // get data from your video pipeline\nimagePixels.convertTo(cameraImg, CV_32FC3);\n</code></pre>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 413, "user_id": 6806574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cc49db249fce6fdbb77cab4c25334ec?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6806574/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7465, "favorite_count": 12, "accepted_answer_id": 39380345, "answer_count": 2, "score": 10, "last_activity_date": 1506378524, "creation_date": 1473286133, "last_edit_date": 1495542384, "question_id": 39379747, "link": "https://stackoverflow.com/questions/39379747/import-opencv-mat-into-c-tensorflow-without-copying", "title": "Import OpenCV Mat into C++ Tensorflow without copying", "body": "<p>My goal is to run a TensorFlow model in real time to control a vehicle from a learned model.  Our vehicle system uses ROS (Robot Operating System) which is tied closely to OpenCV.  So, I receive an OpenCV Mat containing the image of interest from ROS.</p>\n\n<pre><code>    cv::Mat cameraImg;\n</code></pre>\n\n<p>I would like to create a Tensorflow Tensor directly from the data in this OpenCV matrix to avoid the expense of copying the matrix line-by-line.  Using the answer to <a href=\"https://stackoverflow.com/questions/36044197/how-do-i-pass-an-opencv-mat-into-a-c-tensorflow-graph\">This Question</a> I have managed to get the forward pass of the network working with the following code:</p>\n\n<pre><code>cameraImg.convertTo(cameraImg, CV_32FC3);\n\nTensor inputImg(DT_FLOAT, TensorShape({1,inputheight,inputwidth,3}));\nauto inputImageMapped = inputImg.tensor&lt;float, 4&gt;();\nauto start = std::chrono::system_clock::now();\n//Copy all the data over\nfor (int y = 0; y &lt; inputheight; ++y) {\n    const float* source_row = ((float*)cameraImg.data) + (y * inputwidth * 3);\n    for (int x = 0; x &lt; inputwidth; ++x) {\n        const float* source_pixel = source_row + (x * 3);\n        inputImageMapped(0, y, x, 0) = source_pixel[2];\n        inputImageMapped(0, y, x, 1) = source_pixel[1];\n        inputImageMapped(0, y, x, 2) = source_pixel[0];\n    }\n}\nauto end = std::chrono::system_clock::now();\n</code></pre>\n\n<p>However, using this method the copy to the tensor takes between 80ms and 130ms, while the entire forward pass (for a 10-layer convolutional network) only takes 25ms.  </p>\n\n<p>Looking at <a href=\"https://www.tensorflow.org/versions/r0.10/api_docs/cc/ClassTensor.html\" rel=\"noreferrer\">the tensorflow documentation</a>, it appears there is a Tensor constructor that takes an allocator.  However, I have not been able to find any Tensorflow or Eigen documentation relating to this functionality or the <a href=\"https://eigen.tuxfamily.org/dox/group__TutorialMapClass.html\" rel=\"noreferrer\">Eigen Map class</a> as it relates to Tensors.</p>\n\n<p>Does anyone have any insight into how this code can be sped up, ideally by re-using my OpenCV memory?</p>\n\n<p><strong>EDIT:</strong>\nI have successfully implemented what @mrry suggested, and can re-use the memory allocated by OpenCV.  I have opened <a href=\"https://github.com/tensorflow/tensorflow/issues/8033\" rel=\"noreferrer\">github issue 8033</a> requesting this be added to the tensorflow source tree.  My method isn't that pretty, but it works.</p>\n\n<p>It is still very difficult to compile an external library and link it to the libtensorflow.so library.  Potentially the <a href=\"https://github.com/cjweeks/tensorflow-cmake\" rel=\"noreferrer\">tensorflow cmake library</a> will help with this, I have not yet tried it.</p>\n"}, {"tags": ["c++", "c++11", "x86", "atomic", "lock-free"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 9, "creation_date": 1473285187, "post_id": 39379424, "comment_id": 66087011, "body": "The meaning of <code>asm</code> statements is implementation-defined."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 3, "creation_date": 1473289248, "post_id": 39379424, "comment_id": 66088283, "body": "Yes it is a race condition but not a bug in this case as you don&#39;t rely on the order of the result. As Kerrek pointed out <i>asm</i> is implementation defined (it is documented by the compiler developer), not undefined behavior."}, {"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1473308685, "post_id": 39379424, "comment_id": 66092441, "body": "@MichaelPetch, it is a data race and it is safe because of atomicity, yeah?"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 2, "creation_date": 1473326904, "post_id": 39379424, "comment_id": 66101071, "body": "The example given in the question is not a good one. At least, it is not a particularly instructive one. As has been pointed out, you do not rely on the order of the result, so although there is a race condition, it is merely theoretical and cannot manifest itself in a bug. It is not clear to me how atomicity is relevant here."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1529851487, "post_id": 39379424, "comment_id": 89014592, "body": "@KerrekSB Is anything about interfacing C++ with other languages that isn&#39;t implementation defined?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1529858297, "post_id": 39379424, "comment_id": 89016519, "body": "@curiousguy: Depends what you mean. &quot;C language linkage&quot; is somewhat defined."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1529858736, "post_id": 39379424, "comment_id": 89016638, "body": "The program doesn&#39;t do anything remotely significant so it&#39;s hard to see where you are going."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1529859065, "post_id": 39379424, "comment_id": 89016727, "body": "@KerrekSB Linkage is defined in C++, linking with C is not defined and cannot be defined as there is no C/C++ std and the C++ doesn&#39;t defer to the C std for definition of C like stuff. There is the intuition and then there is the spec. As usual, <b>intuition matters more</b> and should be followed by compiler writers, and the intuition says that there is a C/C++ with all the common constructs. But in the spec, you have nothing. <b>There is not one strictly conformant program with both C and C++ code.</b>"}], "answers": [{"comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1473960855, "post_id": 39517110, "comment_id": 66349933, "body": "I started writing this when the question was posted, but never got back to it!"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1529860293, "post_id": 39517110, "comment_id": 89017008, "body": "While a compiler could conceivably add a temporary in some cases for an output argument of an <code>asm</code> statement (or a call out an ADA function with OUT argument), introducing temporaries for IN/OUT arguments wouldn&#39;t make sense."}], "tags": [], "owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 1, "last_activity_date": 1473960834, "creation_date": 1473960834, "answer_id": 39517110, "question_id": 39379424, "link": "https://stackoverflow.com/questions/39379424/does-inline-asm-access-to-shared-variables-count-as-a-data-race-in-c11/39517110#39517110", "title": "Does inline asm access to shared variables count as a data race in C++11?", "body": "<p>The standard leaves inline asm implementation-defined, for obvious reasons.  To say anything about this, we have to make stuff up and hand-wave about things.</p>\n\n<p>More importantly, we're no longer considering pure ISO C++, but rather the GNU dialect of C++, which defines a lot of behaviour that ISO C++ leaves Undefined.  e.g. <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Structures-unions-enumerations-and-bit-fields-implementation.html\" rel=\"nofollow\">the gcc manual says</a> type-punning by writing one union member and reading another is well-defined in GNU C++, even though it's UB in ISO C++.  A lot of things are still UB in GNU C++, and \"whatever g++ actually does\" doesn't count as a definition.  See <a href=\"https://gcc.gnu.org/onlinedocs/gcc/index.html#toc_C-Implementation\" rel=\"nofollow\">the manual's implementation-defined behaviour section in the table of contents</a>.</p>\n\n<p>The C++ -> asm stage of gcc doesn't even understand the instructions in an inline-asm statement, it just fills in the operands and passes it on to the assembler.  It doesn't \"think about\" what the instructions are doing; it treats it as a black box described by the output, input, and clobber constraints.</p>\n\n<p>Since you used an <code>\"=m\"(i)</code> output operand, your asm statement <em>does</em> interact with the C++ variable in a C++ish way (rather than behind the compiler's back with <code>asm(\"mov $1, i\");</code>).  I think the compiler sees it as something like <code>i = __builtin_my_asm_statement();</code>.  Plus the <code>volatile</code> keyword that prevents compile-time reordering / hoisting / dead-code-elimination.</p>\n\n<hr>\n\n<p>Not every data race is a C++-standard Undefined-Behaviour causing Data Race.  For example, if <code>i</code> was a std::atomic type, the final value of <code>i</code> is still indeterminate because of the <a href=\"https://en.wikipedia.org/wiki/Race_condition#Software\" rel=\"nofollow\">race condition</a>.  (The program would be free of C++ UB, though, and <code>i</code> would be either 2 or 1, with no tearing.  Undefined Behaviour technically means anything could happen, of course.)</p>\n\n<hr>\n\n<p>So, <strong>what can we say about this code</strong>:</p>\n\n<ul>\n<li>We can assume that <code>i</code> is naturally aligned, because all the usual x86 ABIs guarantee that.</li>\n<li>We know that the asm will include a store to memory as a single instruction, not copying one byte at a time.  (Which no sane compiler would do anyway).</li>\n<li>I'm <em>not</em> 100% sure that we can guarantee that the store goes directly to the shared value of <code>i</code>, rather than to scratch space on the stack which the compiler will then copy from.  An evil compiler that did this would break a <em>lot</em> of code, including anything like the Linux kernel that uses inline asm to run <code>lock</code>ed instructions on shared variables using memory operands.</li>\n</ul>\n\n<p>So if we can assume a non-malicious compiler, we can be pretty sure what the compiler output will do.  Or perhaps the behaviour of an <code>\"=m\"</code> operand on a shared value should be considered well-defined behaviour in GNU C, so we can say that this is well-defined.</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 1, "accepted_answer_id": 39517110, "answer_count": 1, "score": 0, "last_activity_date": 1473964519, "creation_date": 1473284410, "last_edit_date": 1473964519, "question_id": 39379424, "link": "https://stackoverflow.com/questions/39379424/does-inline-asm-access-to-shared-variables-count-as-a-data-race-in-c11", "title": "Does inline asm access to shared variables count as a data race in C++11?", "body": "<pre><code>#include &lt;thread&gt;\nint i;\nint main()\n{\n    std::thread t1([&amp;i]() {\n        asm volatile(\"movl $1, %0\"\n                     : \"=m\"(i));\n    });\n    std::thread t2([&amp;i]() {\n        asm volatile(\"movl $2, %0\"\n                     : \"=m\"(i));\n    });\n    t2.join();\n    t1.join();\n    return 0;\n}\n</code></pre>\n\n<p>Is it a data race (  and in result UB) in C++? Let's assume that address of <code>i</code> is aligned and that on our CPU load/store of aligned double words are atomic. </p>\n\n<p>Probably, it satisfies a defintion of data race. </p>\n"}, {"tags": ["c++", "vector", "compare"], "comments": [{"owner": {"reputation": 17992, "user_id": 278326, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/29b774f602a4e39d45f5c4f142566f2b?s=128&d=identicon&r=PG", "display_name": "Arun", "link": "https://stackoverflow.com/users/278326/arun"}, "edited": false, "score": 0, "creation_date": 1473284506, "post_id": 39379411, "comment_id": 66086753, "body": "Is it necessary to retain the relative order of the retained elements?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1473284577, "post_id": 39379411, "comment_id": 66086786, "body": "If both vectors are sorted, you could use <a href=\"http://en.cppreference.com/w/cpp/algorithm/set_difference\" rel=\"nofollow noreferrer\"><code>std::set_difference</code></a>."}, {"owner": {"reputation": 21, "user_id": 6806564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a0cc87d7549ea7a1d045120cbafec3e?s=128&d=identicon&r=PG&f=1", "display_name": "hournet562", "link": "https://stackoverflow.com/users/6806564/hournet562"}, "edited": false, "score": 0, "creation_date": 1473284585, "post_id": 39379411, "comment_id": 66086789, "body": "No, I will resort them via sort(fileList.begin(), fileList.end() ); after"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1473284724, "post_id": 39379411, "comment_id": 66086831, "body": "@hournet562 You might as well sort them before and use the <code>std::set_difference</code> as stated previously. -- <i>and strncmp the values</i> -- strcmp???"}], "answers": [{"tags": [], "owner": {"reputation": 17992, "user_id": 278326, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/29b774f602a4e39d45f5c4f142566f2b?s=128&d=identicon&r=PG", "display_name": "Arun", "link": "https://stackoverflow.com/users/278326/arun"}, "is_accepted": false, "score": 0, "last_activity_date": 1473285437, "creation_date": 1473285437, "answer_id": 39379617, "question_id": 39379411, "link": "https://stackoverflow.com/questions/39379411/c-remove-elements-that-are-in-one-vector-from-another/39379617#39379617", "title": "c++: Remove Elements that are in one vector from another", "body": "<p>I might try something like the following.</p>\n\n<pre><code>// Create sets from vectors. This eliminates the duplicate elements.\nconst unordered_set&lt;int&gt; setA{vecA.cbegin(), vecA.cend()};\nconst unordered_set&lt;int&gt; setB{vecB.cbegin(), vecB.cend()};\n\nPopulateSetDiff(vecA, setA, setB);\nPopulateSetDiff(vecB, setB, setA);\n\n// Populate 'vec' with 'set1 - set2'\ntemplate &lt;typename T&gt;\nvoid PopulateSetDiff(\n  vector&lt;T&gt;&amp; vec,\n  unordered_set&lt;T&gt; const&amp; set1,\n  unordered_set&lt;T&gt; const&amp; set2) {\n  vec.clear();\n  for (const auto elem : set1) {\n    if (set2.find(elem) == set2.cend()) {\n      vec.push_back(elem);\n    }\n  }\n  vec.shrink_to_fit();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19910, "user_id": 1621391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ec331963e9d60347c1e80e294b14940c?s=128&d=identicon&r=PG", "display_name": "WhiZTiM", "link": "https://stackoverflow.com/users/1621391/whiztim"}, "is_accepted": false, "score": 1, "last_activity_date": 1473288219, "last_edit_date": 1473288219, "creation_date": 1473285510, "answer_id": 39379632, "question_id": 39379411, "link": "https://stackoverflow.com/questions/39379411/c-remove-elements-that-are-in-one-vector-from-another/39379632#39379632", "title": "c++: Remove Elements that are in one vector from another", "body": "<p>That's a lot of work there. I would have suggested <a href=\"http://en.cppreference.com/w/cpp/algorithm/set_difference\" rel=\"nofollow\"><code>std::set_difference</code></a>, but since you want to do it in place, this code will do it for you with good algorithmic complexity:</p>\n\n<pre><code>template&lt;typename T&gt;\nvoid remove_intersection(std::vector&lt;T&gt;&amp; a, std::vector&lt;T&gt;&amp; b){\n    std::unordered_multiset&lt;T&gt; st;\n    st.insert(a.begin(), a.end());\n    st.insert(b.begin(), b.end());\n    auto predicate = [&amp;st](const T&amp; k){ return st.count(k) &gt; 1; };\n    a.erase(std::remove_if(a.begin(), a.end(), predicate), a.end());\n    b.erase(std::remove_if(b.begin(), b.end(), predicate), b.end());\n}\n</code></pre>\n\n<p>Isn't C++ beautiful? :-)</p>\n\n<hr>\n\n<p>A Demo:</p>\n\n<pre><code>int main(){\n    std::vector&lt;int&gt; a = {1,4,66,22};\n    std::vector&lt;int&gt; b = {1,22,44,93,102,543};\n\n    remove_intersection(a, b);\n\n    for(auto k : a) std::cout &lt;&lt; k &lt;&lt; ' ';\n    std::cout &lt;&lt; std::endl;\n    for(auto k : b) std::cout &lt;&lt; k &lt;&lt; ' ';\n}\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>4 66 \n44 93 102 543 \n</code></pre>\n\n<p>See it <kbd><a href=\"http://coliru.stacked-crooked.com/a/4ba5bed203e62102\" rel=\"nofollow\">Live On Coliru</a></kbd></p>\n\n<p>There are many variations of the above method. For example, if you are worried that <code>count</code> may take too long when such count is really large, you can implement a simple function to find and count up to at most 2 elements; another one: you can simply use two different unordered sets.</p>\n"}, {"tags": [], "owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "is_accepted": false, "score": 0, "last_activity_date": 1473288543, "creation_date": 1473288543, "answer_id": 39380124, "question_id": 39379411, "link": "https://stackoverflow.com/questions/39379411/c-remove-elements-that-are-in-one-vector-from-another/39380124#39380124", "title": "c++: Remove Elements that are in one vector from another", "body": "<blockquote>\n  <p>No, I will resort them via sort(fileList.begin(), fileList.end() ); after</p>\n</blockquote>\n\n<p>So asymptotically it's the same to sort before.</p>\n\n<p>Using <a href=\"http://en.cppreference.com/w/cpp/algorithm/set_difference\" rel=\"nofollow\"><code>set_difference</code></a>, you can do something like:</p>\n\n<pre><code>template&lt;typename T&gt;\nvoid remove_intersection(std::vector&lt;T&gt;* c1, std::vector&lt;T&gt;* c2) {\n  assert(c1 != nullptr);\n  assert(c2 != nullptr);\n\n  std::sort(std::begin(*c1), std::end(*c1));  // O(n1 logn1)\n  std::sort(std::begin(*c2), std::end(*c2));  // O(n2 logn2)\n\n  std::vector&lt;T&gt; difference1, difference2;\n  difference1.reserve(c1-&gt;size());\n  difference2.reserve(c2-&gt;size());\n\n  std::set_difference(std::begin(*c1), std::end(*c1),\n                      std::begin(*c2), std::end(*c2),\n                      std::back_inserter(difference1));\n  // O(2*[N1 + N2 - 1])\n\n  std::set_difference(std::begin(*c2), std::end(*c2),\n                      std::begin(*c1), std::end(*c1),\n                      std::back_inserter(difference2));\n  // O(2*[N1 + N2 - 1])\n\n  *c1 = std::move(difference1);  // O(1)\n  *c2 = std::move(difference2);  // O(1)\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6806564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a0cc87d7549ea7a1d045120cbafec3e?s=128&d=identicon&r=PG&f=1", "display_name": "hournet562", "link": "https://stackoverflow.com/users/6806564/hournet562"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1471, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1473288543, "creation_date": 1473284303, "last_edit_date": 1473284658, "question_id": 39379411, "link": "https://stackoverflow.com/questions/39379411/c-remove-elements-that-are-in-one-vector-from-another", "title": "c++: Remove Elements that are in one vector from another", "body": "<p>I need to remove the elements that appear in Vector A and Vector B, but keep the elements that are only in Vector A. The vectors can be of any size, but are not necessarily equal to each other. </p>\n\n<p>For example, if:\nvector A contains the values &lt;1,4,66,22>\nvector B contains the values &lt;1,22,44,93,102,543></p>\n\n<p>Then after preforming the operation:\nvector A should contain &lt;4,66>\nvector B should contain &lt;44,93,102,543></p>\n\n<p>Do I need to loop through both with a for loop and strncmp the values or is the a function that I can use to streamline the process?\nThis is what I tried but doesn't seem to work.</p>\n\n<pre><code>string rawInput;\nstring fileInput;\nvector&lt;string&gt; stdInput; //vector to hold standard input values\nvector&lt;string&gt; fileList; //vector to hold file values   \n\nsizeIn = stdInput.size();\nsizeFile = fileList.size(); \n\nif (sizeIn &gt;= sizeFile)\n    {\n        for (count = 0;count &lt;= sizeIn; count++)\n        {\n            for (count1 = 0; count1 &lt;= sizeFile; count1++)\n            {\n                if (stdInput[count1] == fileList[count])\n                {\n                    stdInput.erase(stdInput.begin()+count1-1);\n                    fileList.erase(fileList.begin()+count-1);\n\n                }\n\n            }\n        }\n    }\n    else\n    {\n        for (count = 0; count &lt;= sizeFile; count ++)\n        {\n            for (count1 = 0; count1 &lt;= sizeIn; count1++)\n            {\n                if (stdInput[count] == fileList[count1])\n                {\n                    stdInput.erase(stdInput.begin()+count-1);\n                    fileList.erase(fileList.begin()+count1-1);\n\n                }   \n            }\n        }\n    }\n</code></pre>\n"}, {"tags": ["c++", "class", "member"], "comments": [{"owner": {"reputation": 20231, "user_id": 1342730, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/36543a7316596ec6e930bc8c996bf14b?s=128&d=identicon&r=PG", "display_name": "mathematician1975", "link": "https://stackoverflow.com/users/1342730/mathematician1975"}, "edited": false, "score": 3, "creation_date": 1473284255, "post_id": 39379372, "comment_id": 66086659, "body": "You are missing semicolons"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1473284274, "post_id": 39379372, "comment_id": 66086671, "body": "First  please <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>, and then learn how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>. We need an MCVE and the complete and unedited error, in full, to be able to help you."}], "answers": [{"comments": [{"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1473284404, "post_id": 39379403, "comment_id": 66086722, "body": "@JoachimPileborg edited"}], "tags": [], "owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "is_accepted": false, "score": 2, "last_activity_date": 1473284333, "last_edit_date": 1473284333, "creation_date": 1473284261, "answer_id": 39379403, "question_id": 39379372, "link": "https://stackoverflow.com/questions/39379372/overwrite-member-data-with-member-function-c/39379403#39379403", "title": "overwrite member data with member function c++", "body": "<pre><code>class example\n{\n     public:\n         int Test //&lt;-- Missing semicolon here, should be int Test;\n         void changeTest ( int newTest) { Test = newTest;}\n} //&lt;-- Missing semicolon here too.\n</code></pre>\n\n<p>You are missing a semicolon, so you get an unqualified identifier error, and the unqualified identifier is <code>Test</code>. Most old compilers give weird errors, but many modern ones say:</p>\n\n<blockquote>\n  <p>Error: expected a ';'</p>\n</blockquote>\n\n<p>In addition, the end of your class also needs a semicolon, which I have mentioned above.</p>\n"}], "owner": {"reputation": 1, "user_id": 6806556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205329161347516/picture?type=large", "display_name": "Kyle Beyer", "link": "https://stackoverflow.com/users/6806556/kyle-beyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1473322520, "answer_count": 1, "score": 0, "last_activity_date": 1473285054, "creation_date": 1473284135, "question_id": 39379372, "link": "https://stackoverflow.com/questions/39379372/overwrite-member-data-with-member-function-c", "closed_reason": "Not suitable for this site", "title": "overwrite member data with member function c++", "body": "<p>I'm having some trouble putting together some code, and my problem boils down to this:</p>\n\n<p>I have a class with several data members, which I use a constructor to set.</p>\n\n<p>I later want to change some of those data members, if a certain public member function is called.</p>\n\n<p>for example:</p>\n\n<pre><code>class example\n{\n     public:\n                  int Test\n                  void changeTest ( int newTest) { Test = newTest;}\n}\n</code></pre>\n\n<p>I'm getting the unqualified id error regarding Test inside the changeTest() function.</p>\n\n<p>Is what I'm trying to do not possible or am I just doing it wrong? I can't seem to find a good resource on the internet.</p>\n"}, {"tags": ["c++", "qt", "qml", "qt-creator", "app-manager"], "comments": [{"owner": {"reputation": 5455, "user_id": 2788674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2eaf786e0c365b68573e38c4625ce3?s=128&d=identicon&r=PG&f=1", "display_name": "GrecKo", "link": "https://stackoverflow.com/users/2788674/grecko"}, "edited": false, "score": 0, "creation_date": 1473324021, "post_id": 39379345, "comment_id": 66099347, "body": "This might interest you <a href=\"http://gitlab.unique-conception.org/groups/qt-can-2.0\" rel=\"nofollow noreferrer\">gitlab.unique-conception.org/groups/qt-can-2.0</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5647, "user_id": 527559, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0692973925991d289430688104a9c33?s=128&d=identicon&r=PG", "display_name": "Aras", "link": "https://stackoverflow.com/users/527559/aras"}, "edited": false, "score": 0, "creation_date": 1473291846, "post_id": 39380241, "comment_id": 66088903, "body": "Thank you for responding. I think you are right, I put <code>qmlRegisterType&lt;MyObject&gt;...</code>  in the header file which seems incorrect. But since I am using <code>appman</code> my application does not have a <code>main</code> method. Any idea where I could do the registering?"}, {"owner": {"reputation": 4381, "user_id": 568254, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25f8ba19300a829b712fac3c8b73dfbd?s=128&d=identicon&r=PG", "display_name": "Daniel B. Chapman", "link": "https://stackoverflow.com/users/568254/daniel-b-chapman"}, "reply_to_user": {"reputation": 5647, "user_id": 527559, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0692973925991d289430688104a9c33?s=128&d=identicon&r=PG", "display_name": "Aras", "link": "https://stackoverflow.com/users/527559/aras"}, "edited": false, "score": 1, "creation_date": 1473293754, "post_id": 39380241, "comment_id": 66089322, "body": "@Aras I&#39;m at a loss for appman as I&#39;ve never used it. I would try any <code>initialize</code> methods to see if you can load before the QML viewer starts, but barring that I would reach out to the developers directly and see if they can give you a hook to tie it in. Good luck!"}, {"owner": {"reputation": 5817, "user_id": 4742108, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/GvE0m.jpg?s=128&g=1", "display_name": "Velkan", "link": "https://stackoverflow.com/users/4742108/velkan"}, "edited": false, "score": 1, "creation_date": 1473316085, "post_id": 39380241, "comment_id": 66094938, "body": "I usually do the registrations in their <code>*.cpp</code> files: <code>const int registration = qmlRegisterType&lt;...&gt;</code>. These variables are created before <code>main()</code> is executed. A bit dangerous, but haven&#39;t had any problems yet."}], "tags": [], "owner": {"reputation": 4381, "user_id": 568254, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25f8ba19300a829b712fac3c8b73dfbd?s=128&d=identicon&r=PG", "display_name": "Daniel B. Chapman", "link": "https://stackoverflow.com/users/568254/daniel-b-chapman"}, "is_accepted": false, "score": 2, "last_activity_date": 1473289310, "creation_date": 1473289310, "answer_id": 39380241, "question_id": 39379345, "link": "https://stackoverflow.com/questions/39379345/module-is-not-installed-registering-custom-c-wrapper-for-qml/39380241#39380241", "title": "module [] is not installed -- registering custom C++ wrapper for QML", "body": "<p>I'm responding because you tagged an older post as similar.</p>\n\n<p>Here's a couple questions:\n1) Where are you calling <code>qmlRegisterType&lt;MyObject&gt;(\"can.myapp\", 1, 0, \"CANService\");</code> My understanding is that this needs to be called in the <code>main</code> method before you instantiate the <code>QtQuickApplicationViewer</code> (if you're loading it that way.)</p>\n\n<p>2) Does this work with a simple example (passing a simple <code>QString</code> value to a function)?</p>\n\n<p>I'm not actively coding in Qt right at the moment, but hopefully this can point you in the right direction:</p>\n\n<p>Here's the \"main\" method from one of my applications that uses custom components (for simple Java connectivity over the command line).</p>\n\n<pre><code>#include &lt;QtGui/QGuiApplication&gt;\n#include &lt;QtCore&gt;\n#include &lt;QtQml&gt;\n#include \"qtquick2applicationviewer.h\"\n#include \"globals.h\"\n#include \"lightassistant.h\"\n#include \"reporting.h\"\n\nint main(int argc, char *argv[])\n{\n    QGuiApplication app(argc, argv);\n\n    //C++ Types\n    qmlRegisterType&lt;LightAssistant&gt;(\"com.lightassistant\", 1, 0, \"LightAssistant\");\n    qmlRegisterType&lt;Reporting&gt;(\"com.lightassistant\", 1, 0, \"Reporting\");\n    //Singletons\n    //qmlRegisterSingletonType(QUrl(\"file:///qml/LightAssistant/Styles.qml\"), \"com.lightassistant\", 1, 0, \"Styles\");\n\n    QtQuick2ApplicationViewer viewer;\n    viewer.setMainQmlFile(QStringLiteral(\"qml/LightAssistant/main.qml\"));\n    viewer.showExpanded();\n    qDebug() &lt;&lt; \"offline path is \" &lt;&lt; viewer.engine()-&gt;offlineStoragePath();\n    LA::OFFLINE_STORAGE_PATH = viewer.engine()-&gt;offlineStoragePath();\n    return app.exec();\n}\n</code></pre>\n\n<p>Here's a simplified class (these classes are ~600 lines)</p>\n\n<pre><code>#ifndefLIGHTASSISTANT_H\n#define LIGHTASSISTANT_H\n\n#include &lt;QtSql&gt;\n#include &lt;QtCore&gt;\n#include &lt;QtXml&gt;\n#include &lt;QtXmlPatterns&gt;\n#include \"globals.h\"\n\n\n\nclass LightAssistant : public QObject\n    {\n        Q_OBJECT\n    public:\n        explicit LightAssistant(QObject *parent = 0);\n\n        /**\n         * Is this running on Android?\n         */\n        Q_INVOKABLE\n        int isAndroid()\n        {\n           #ifdef Q_OS_ANDROID\n           return 1;\n           #else\n           return 0;\n           #endif\n        }\n\n        /**\n         * Is this running on Android?\n         */\n        Q_INVOKABLE\n        int isIOS()\n        {\n           #ifdef Q_OS_IOS\n           return 1;\n           #else\n           return 0;\n           #endif\n        }\n\n        /**\n         * @brief isMobile is this on a mobile device?\n         * @return\n         */\n        Q_INVOKABLE\n        int isMobile()\n        {\n            return isIOS() + isAndroid();\n        }\n        ....\n        }\n#endif // LIGHTASSISTANT_H\n</code></pre>\n\n<p>Theoretically you can invoke this in QML as such now:</p>\n\n<pre><code>import com.lightassistant 1.0\nItem {\n  LightAssistant {\n    id: la\n  }\n\n  function isIos(){\n    return la.isIOS();\n  }\n\n}\n</code></pre>\n\n<p>I would suggest doing something really simple like this to make sure there isn't a problem in the plumbing and then, if that works, go method by method to see if there's another call that's blocking something. My best guess without full source is that it is probably where you're registering the components.</p>\n"}], "owner": {"reputation": 5647, "user_id": 527559, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0692973925991d289430688104a9c33?s=128&d=identicon&r=PG", "display_name": "Aras", "link": "https://stackoverflow.com/users/527559/aras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1269, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473291969, "creation_date": 1473284037, "last_edit_date": 1473291969, "question_id": 39379345, "link": "https://stackoverflow.com/questions/39379345/module-is-not-installed-registering-custom-c-wrapper-for-qml", "title": "module [] is not installed -- registering custom C++ wrapper for QML", "body": "<p>I need to access a C++ API to work with CAN bus. Looks like the best solution is to write a QML wrapper to expose all the functionality I need. </p>\n\n<p>Here is my <code>canservice.cpp</code> so far:</p>\n\n<pre><code>#include \"canservice.h\"\n#include &lt;QCanBus&gt;\n#include &lt;QDebug&gt;\n#include &lt;QCanBusFrame&gt;\n#include &lt;QTimer&gt;\n\n#include &lt;QtCore/qbytearray.h&gt;\n#include &lt;QtCore/qvariant.h&gt;\n#include &lt;QtCore/qdebug.h&gt;\n\nCANService::CANService(QObject *parent) :\n    QObject(parent),\n    m_canDevice(nullptr)\n{\n    QString status = \"\";\n\n    initializeSettings();\n\n\n    // TODO\" disable sending messages until connection is stablished\n}\n\nCANService::~CANService()\n{\n    delete m_canDevice;\n}\n\nvoid CANService::receiveError(QCanBusDevice::CanBusError error) const\n{\n    switch (error) {\n        case QCanBusDevice::ReadError:\n        case QCanBusDevice::WriteError:\n        case QCanBusDevice::ConnectionError:\n        case QCanBusDevice::ConfigurationError:\n        case QCanBusDevice::UnknownError:\n            qWarning() &lt;&lt; m_canDevice-&gt;errorString();\n    default:\n        break;\n    }\n}\n\nvoid CANService::initializeSettings()\n{\n    foreach (const QByteArray &amp;backend, QCanBus::instance()-&gt;plugins()) {\n        qInfo() &lt;&lt; \"found: \" + backend;\n        if (backend == \"socketcan\") {\n            // found socketcan\n            m_currentSettings.backendName = \"socketcan\";\n            break;\n        }\n    }\n\n    if(m_currentSettings.backendName.length() &lt; 1) {\n        qWarning() &lt;&lt; \"did not find a backend\";\n    }\n\n    m_currentSettings.backendName = \"socketcan\";\n    m_currentSettings.deviceInterfaceName = QStringLiteral(\"vcan0\");\n}\n\nvoid CANService::connectDevice()\n{\n    m_canDevice = QCanBus::instance()-&gt;createDevice(m_currentSettings.backendName.toLocal8Bit(), m_currentSettings.deviceInterfaceName);\n    if (!m_canDevice) {\n        showStatusMessage(tr(\"Connection error\"));\n        return;\n    }\n    connect(m_canDevice, &amp;QCanBusDevice::errorOccurred,\n            this, &amp;MainWindow::receiveError);\n    connect(m_canDevice, &amp;QCanBusDevice::framesReceived,\n            this, &amp;MainWindow::checkMessages);\n    connect(m_canDevice, &amp;QCanBusDevice::framesWritten,\n            this, &amp;MainWindow::framesWritten);\n\n    if (p.useConfigurationEnabled) {\n        foreach (const ConnectDialog::ConfigurationItem &amp;item, p.configurations)\n            m_canDevice-&gt;setConfigurationParameter(item.first, item.second);\n    }\n\n    if (!m_canDevice-&gt;connectDevice()) {\n        delete m_canDevice;\n        m_canDevice = nullptr;\n        qInfo() &lt;&lt; \"Connection error\";\n    } else {\n        qInfo() &lt;&lt; m_currentSettings.backendName &lt;&lt; \"is connected\";\n    }\n}\n\nvoid CANService::sendMessage() const\n{\n    if (!m_canDevice)\n        return;\n\n    // TODO: replace test message with input\n    QByteArray writings = dataFromHex(\"1122334455667788\");\n\n    QCanBusFrame frame;\n    const int maxPayload = 8; // 64 : 8;\n    int size = writings.size();\n    if (size &gt; maxPayload)\n        size = maxPayload;\n    writings = writings.left(size);\n    frame.setPayload(writings);\n\n    //TODO: get from UI\n    qint32 id = 100;\n    if (id &gt; 2047) {\n        //11 bits\n        id = 2047;\n    }\n\n    frame.setFrameId(id);\n    frame.setExtendedFrameFormat(true);\n\n    // frame.setFrameType(QCanBusFrame::RemoteRequestFrame);\n    // frame.setFrameType(QCanBusFrame::ErrorFrame);\n    frame.setFrameType(QCanBusFrame::DataFrame);\n\n    m_canDevice-&gt;writeFrame(frame);\n}\n\nvoid CANService::checkMessages()\n{\n    if (!m_canDevice)\n        return;\n\n    const QCanBusFrame frame = m_canDevice-&gt;readFrame();\n\n    const qint8 dataLength = frame.payload().size();\n\n    const qint32 id = frame.frameId();\n\n    QString view;\n    if (frame.frameType() == QCanBusFrame::ErrorFrame) {\n        interpretError(view, frame);\n    } else {\n        view += QLatin1String(\"Id: \");\n        view += QString::number(id, 16).toUpper();\n        view += QLatin1String(\" bytes: \");\n        view += QString::number(dataLength, 10);\n        view += QLatin1String(\" data: \");\n        view += dataToHex(frame.payload());\n    }\n\n    if (frame.frameType() == QCanBusFrame::RemoteRequestFrame) {\n        qInfo() &lt;&lt; \"got remote request message\" &lt;&lt; view;\n    } else if (frame.frameType() == QCanBusFrame::ErrorFrame) {\n        qWarning() &lt;&lt; \"got can error frame: \" &lt;&lt; view;\n    } else {\n        qInfo() &lt;&lt; \"got can frame: \" &lt;&lt; view;\n    }\n}\n\nvoid CANService::interpretError(QString &amp;view, const QCanBusFrame &amp;frame)\n{\n    if (!m_canDevice)\n        return;\n\n    view = m_canDevice-&gt;interpretErrorFrame(frame);\n}\n\nstatic QByteArray dataToHex(const QByteArray &amp;data)\n{\n    QByteArray result = data.toHex().toUpper();\n\n    for (int i = 0; i &lt; result.size(); i += 3)\n        result.insert(i, ' ');\n\n    return result;\n}\n\nstatic QByteArray dataFromHex(const QString &amp;hex)\n{\n    QByteArray line = hex.toLatin1();\n    line.replace(' ', QByteArray());\n    return QByteArray::fromHex(line);\n}\n</code></pre>\n\n<p>In the <code>canservice.h</code> I have:</p>\n\n<pre><code>#ifndef CANSERVICE_H\n#define CANSERVICE_H\n\n#include &lt;QObject&gt;\n#include &lt;QQuickItem&gt;\n#include &lt;QCanBusDevice&gt;\n\n\nclass CANService : public QObject\n{\n    Q_OBJECT\npublic:\n    explicit CANService(QObject *parent = 0);\n    typedef QPair&lt;QCanBusDevice::ConfigurationKey, QVariant&gt; ConfigurationItem;\n\n    struct Settings {\n        QString backendName;\n        QString deviceInterfaceName;\n        QList&lt;ConfigurationItem&gt; configurations;\n        bool useConfigurationEnabled;\n    };\n\n\n    void connectDevice();\n\n    Q_INVOKABLE void connect(const QString &amp;query) {\n        qDebug() &lt;&lt; \"invoking connect with \" &lt;&lt; query;\n\n\n    }\n\n    explicit ConnectDialog(QWidget *parent = nullptr);\n    ~ConnectDialog();\n\n    Settings settings() const;\n\nprivate:\n    Settings m_currentSettings;\n    void initializeSettings();\n\n\nsignals:\n\npublic slots:\n\n};\n\nqmlRegisterType&lt;MyObject&gt;(\"can.myapp\", 1, 0, \"CANService\");\n\n#endif // CANSERVICE_H\n</code></pre>\n\n<p>In my QML file I first attempt to import the newly defined service: <code>import can.myapp 1.0</code> and then I declare an instance of it:</p>\n\n<pre><code>CANService {\n    id: \"myCanService\"\n}\n</code></pre>\n\n<p>When I try to run this application and load the QML file that makes the call to <code>CANService</code>, it does not load and I get the following error in application console:</p>\n\n<pre><code> component not ready:\n \"file:///home/aras/Projects/myapp/apps/com.myapp.diagnostics/Diagnostics.qml:5 module \\\"can.myapp\\\" is not installed\\n\"  \n</code></pre>\n\n<p><strong>EDIT</strong>:\nProblem is most likely with where I am calling <code>qmlRegisterType</code>. I am using <code>appman</code> so my application has no <code>main</code> function. Where is the right place to run <code>qmlRegisterType</code> from? </p>\n"}, {"tags": ["c++", "protected", "virtual-functions"], "answers": [{"comments": [{"owner": {"reputation": 7210, "user_id": 1421332, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/39f3da5b153edf32201b9e9100dad01a?s=128&d=identicon&r=PG", "display_name": "Silicomancer", "link": "https://stackoverflow.com/users/1421332/silicomancer"}, "edited": false, "score": 0, "creation_date": 1473283944, "post_id": 39379247, "comment_id": 66086549, "body": "Ok. The strange thing is I could swear I have seen something like this before and it successfully compiled."}, {"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "reply_to_user": {"reputation": 7210, "user_id": 1421332, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/39f3da5b153edf32201b9e9100dad01a?s=128&d=identicon&r=PG", "display_name": "Silicomancer", "link": "https://stackoverflow.com/users/1421332/silicomancer"}, "edited": false, "score": 0, "creation_date": 1473284044, "post_id": 39379247, "comment_id": 66086585, "body": "You may have marked <code>f()</code> public before... I have added an example anyways"}, {"owner": {"reputation": 7210, "user_id": 1421332, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/39f3da5b153edf32201b9e9100dad01a?s=128&d=identicon&r=PG", "display_name": "Silicomancer", "link": "https://stackoverflow.com/users/1421332/silicomancer"}, "edited": false, "score": 0, "creation_date": 1473284412, "post_id": 39379247, "comment_id": 66086725, "body": "Maybe. Could it depend from the compiler? I used to use VC++"}, {"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "reply_to_user": {"reputation": 7210, "user_id": 1421332, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/39f3da5b153edf32201b9e9100dad01a?s=128&d=identicon&r=PG", "display_name": "Silicomancer", "link": "https://stackoverflow.com/users/1421332/silicomancer"}, "edited": false, "score": 1, "creation_date": 1473284458, "post_id": 39379247, "comment_id": 66086741, "body": "Compiling your example on Visual Studio 2015, I get similar errors, compiling on g++ gives similar errors as well."}, {"owner": {"reputation": 1190, "user_id": 3207828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EPkw.jpg?s=128&g=1", "display_name": "Dan Korn", "link": "https://stackoverflow.com/users/3207828/dan-korn"}, "edited": false, "score": 0, "creation_date": 1473285862, "post_id": 39379247, "comment_id": 66087252, "body": "Yeah, I&#39;m not sure about this either.  I mean, a copy constructor can access protected and private member variables from the object passed as an argument, right?  How else would copy constructors work?  So why can&#39;t an object of class A call a protected member function of another object of the same class?"}, {"owner": {"reputation": 1190, "user_id": 3207828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EPkw.jpg?s=128&g=1", "display_name": "Dan Korn", "link": "https://stackoverflow.com/users/3207828/dan-korn"}, "edited": false, "score": 0, "creation_date": 1473285928, "post_id": 39379247, "comment_id": 66087278, "body": "I guess it&#39;s different for inherited classes than for the base class.  Every C++ class is implicitly a friend of itself, but inherited classes are not."}, {"owner": {"reputation": 7210, "user_id": 1421332, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/39f3da5b153edf32201b9e9100dad01a?s=128&d=identicon&r=PG", "display_name": "Silicomancer", "link": "https://stackoverflow.com/users/1421332/silicomancer"}, "edited": false, "score": 0, "creation_date": 1473318764, "post_id": 39379247, "comment_id": 66096414, "body": "I understand the rule. However I don&#39;t understand why it exists. Where is the harm in calling protected members of some other object of base type? When using virtual functions this could be useful."}], "tags": [], "owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "is_accepted": true, "score": 1, "last_activity_date": 1473284111, "last_edit_date": 1473284111, "creation_date": 1473283575, "answer_id": 39379247, "question_id": 39379178, "link": "https://stackoverflow.com/questions/39379178/cant-call-virtual-protected-method-in-derived-class/39379247#39379247", "title": "Can&#39;t call virtual protected method in derived class", "body": "<pre><code>A* a = new A; a-&gt;f();\n</code></pre>\n\n<p>IS the problem here:\nYou cannot call <code>f()</code> from <code>a</code> since it is not <code>public</code>, and not accessible to <code>B</code> in the member function scope. </p>\n\n<p><hr/>\n<a href=\"http://coliru.stacked-crooked.com/a/59b46ff8acc9f965\" rel=\"nofollow\">It Works!</a></p>\n"}, {"comments": [{"owner": {"reputation": 7210, "user_id": 1421332, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/39f3da5b153edf32201b9e9100dad01a?s=128&d=identicon&r=PG", "display_name": "Silicomancer", "link": "https://stackoverflow.com/users/1421332/silicomancer"}, "edited": false, "score": 0, "creation_date": 1473283740, "post_id": 39379257, "comment_id": 66086476, "body": "No, not A::f(). Did that behavior change with newer C++ standards?"}], "tags": [], "owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "is_accepted": false, "score": 1, "last_activity_date": 1473283748, "last_edit_date": 1473283748, "creation_date": 1473283605, "answer_id": 39379257, "question_id": 39379178, "link": "https://stackoverflow.com/questions/39379178/cant-call-virtual-protected-method-in-derived-class/39379257#39379257", "title": "Can&#39;t call virtual protected method in derived class", "body": "<p>You cannot <em>cross-invoke</em> protected methods between different instances of a class or instances of a parent class just because <code>B</code> inherit from that class.</p>\n\n<p>Anyway <code>B</code> is already an <code>A</code>.<br>\nDid you intend to call <code>A::f();</code>?</p>\n\n<pre><code>class B : public A {\nprotected:\n    virtual void f() override { A::f(); /* ... whatever ... */ }\n};\n</code></pre>\n"}], "owner": {"reputation": 7210, "user_id": 1421332, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/39f3da5b153edf32201b9e9100dad01a?s=128&d=identicon&r=PG", "display_name": "Silicomancer", "link": "https://stackoverflow.com/users/1421332/silicomancer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "closed_date": 1473283634, "accepted_answer_id": 39379247, "answer_count": 2, "score": 1, "last_activity_date": 1473284111, "creation_date": 1473283272, "question_id": 39379178, "link": "https://stackoverflow.com/questions/39379178/cant-call-virtual-protected-method-in-derived-class", "closed_reason": "Duplicate", "title": "Can&#39;t call virtual protected method in derived class", "body": "<p>The following code does not compile in GCC 4.9.1:</p>\n\n<pre><code>class A\n{\nprotected:\n   virtual void f() {}\n\n};\n\nclass B : public A\n{\nprotected:\n   virtual void f() override { A* a = new A; a-&gt;f(); }\n};\n</code></pre>\n\n<p>I get the following:</p>\n\n<pre><code>header.h: In member function 'virtual void B::f()':\nheader.h:51:17: error: 'virtual void A::f()' is protected\n</code></pre>\n\n<p>I would have expected this to compile.</p>\n\n<p>Why does it fail? Is there a better way than making f() public?</p>\n"}, {"tags": ["c++", "qt", "unicode", "utf-8"], "comments": [{"owner": {"reputation": 5956, "user_id": 1249472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d2ac9163237829d11cbf4ee7d563d?s=128&d=identicon&r=PG", "display_name": "Nikita", "link": "https://stackoverflow.com/users/1249472/nikita"}, "edited": false, "score": 0, "creation_date": 1473283633, "post_id": 39379119, "comment_id": 66086443, "body": "Looks like a duplicate of <a href=\"http://stackoverflow.com/questions/4072016/qapplication-in-unicode\">&quot;QApplication in unicode&quot;</a>"}, {"owner": {"reputation": 4119, "user_id": 4447998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be2b81fe09ceb2ec13da299127f242f3?s=128&d=identicon&r=PG", "display_name": "roeland", "link": "https://stackoverflow.com/users/4447998/roeland"}, "edited": false, "score": 0, "creation_date": 1473285546, "post_id": 39379119, "comment_id": 66087142, "body": "Using non-ASCII characters in a string literal is not a standard feature, so you can&#39;t know for sure what bytes actually end up in <code>charArray</code>."}, {"owner": {"reputation": 1190, "user_id": 3207828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EPkw.jpg?s=128&g=1", "display_name": "Dan Korn", "link": "https://stackoverflow.com/users/3207828/dan-korn"}, "edited": false, "score": 0, "creation_date": 1473357010, "post_id": 39379119, "comment_id": 66120474, "body": "It doesn&#39;t really have anything to do with C# directly, although that bit of information lets us know that this is specific to the Windows platform (though that should have been explicitly specified either in the question or the tags)."}], "answers": [{"comments": [{"owner": {"reputation": 4119, "user_id": 4447998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be2b81fe09ceb2ec13da299127f242f3?s=128&d=identicon&r=PG", "display_name": "roeland", "link": "https://stackoverflow.com/users/4447998/roeland"}, "edited": false, "score": 1, "creation_date": 1473285246, "post_id": 39379284, "comment_id": 66087032, "body": "<code>GetCommandLineW</code> will return the program arguments as Unicode regardless of whether you use <code>main</code> or <code>wmain</code> or <code>WinMain</code>."}, {"owner": {"reputation": 1190, "user_id": 3207828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EPkw.jpg?s=128&g=1", "display_name": "Dan Korn", "link": "https://stackoverflow.com/users/3207828/dan-korn"}, "reply_to_user": {"reputation": 4119, "user_id": 4447998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be2b81fe09ceb2ec13da299127f242f3?s=128&d=identicon&r=PG", "display_name": "roeland", "link": "https://stackoverflow.com/users/4447998/roeland"}, "edited": false, "score": 0, "creation_date": 1473285594, "post_id": 39379284, "comment_id": 66087159, "body": "True, I guess I should have said &quot;<b>OR</b> call GetCommandLineW.&quot;"}, {"owner": {"reputation": 5956, "user_id": 1249472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d2ac9163237829d11cbf4ee7d563d?s=128&d=identicon&r=PG", "display_name": "Nikita", "link": "https://stackoverflow.com/users/1249472/nikita"}, "edited": false, "score": 1, "creation_date": 1473311027, "post_id": 39379284, "comment_id": 66093048, "body": "@DanKorn It&#39;s not possible to use <code>wmain</code> here. <a href=\"http://doc.qt.io/qt-5/qapplication.html\" rel=\"nofollow noreferrer\"><code>QApplication</code></a> class doesn&#39;t have constructor with <code>wchar_t**</code> parameter."}, {"owner": {"reputation": 1190, "user_id": 3207828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EPkw.jpg?s=128&g=1", "display_name": "Dan Korn", "link": "https://stackoverflow.com/users/3207828/dan-korn"}, "reply_to_user": {"reputation": 5956, "user_id": 1249472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d2ac9163237829d11cbf4ee7d563d?s=128&d=identicon&r=PG", "display_name": "Nikita", "link": "https://stackoverflow.com/users/1249472/nikita"}, "edited": false, "score": 1, "creation_date": 1473352842, "post_id": 39379284, "comment_id": 66118405, "body": "@Nikita: Those two statements are not causally linked.  It&#39;s true that QApplication doesn&#39;t have a constructor that takes a wchar_t**.  But that doesn&#39;t mean that you can&#39;t use wmain."}, {"owner": {"reputation": 5956, "user_id": 1249472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d2ac9163237829d11cbf4ee7d563d?s=128&d=identicon&r=PG", "display_name": "Nikita", "link": "https://stackoverflow.com/users/1249472/nikita"}, "edited": false, "score": 0, "creation_date": 1473354143, "post_id": 39379284, "comment_id": 66119074, "body": "@DanKorn <code>QApplication</code> is used in context of this question, it&#39;s central part of QT application. So it&#39;s critical to construct proper <code>QApplication</code> instance, but it&#39;s not possible with <code>wchar_t**</code> parameter."}, {"owner": {"reputation": 1190, "user_id": 3207828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EPkw.jpg?s=128&g=1", "display_name": "Dan Korn", "link": "https://stackoverflow.com/users/3207828/dan-korn"}, "edited": false, "score": 0, "creation_date": 1473356937, "post_id": 39379284, "comment_id": 66120436, "body": "Yes, QApplication is a central part of a QT application, but its initialization does not seem to be pertinent to the original question here, which is &quot;how can I get QT main function argv parameter as unicode.&quot;  If you use wmain, or call GetCommandLineW, then you will indeed get the main function argv parameters as Unicode, which, I submit, answers the question posed."}], "tags": [], "owner": {"reputation": 1190, "user_id": 3207828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EPkw.jpg?s=128&g=1", "display_name": "Dan Korn", "link": "https://stackoverflow.com/users/3207828/dan-korn"}, "is_accepted": false, "score": 0, "last_activity_date": 1473283737, "creation_date": 1473283737, "answer_id": 39379284, "question_id": 39379119, "link": "https://stackoverflow.com/questions/39379119/how-can-i-get-qt-main-function-argv-parameter-as-unicode-encoding-format/39379284#39379284", "title": "how can I get QT main function argv parameter as unicode encoding format", "body": "<p>Change the first line to:</p>\n\n<pre><code>int wmain(int argc, wchar_t *argv[])\n</code></pre>\n\n<p>Then call <a href=\"https://msdn.microsoft.com/en-us/library/ms683156%28VS.85%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">GetCommandLineW</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": true, "score": 3, "last_activity_date": 1473336255, "creation_date": 1473336255, "answer_id": 39390408, "question_id": 39379119, "link": "https://stackoverflow.com/questions/39379119/how-can-i-get-qt-main-function-argv-parameter-as-unicode-encoding-format/39390408#39390408", "title": "how can I get QT main function argv parameter as unicode encoding format", "body": "<p>Use <code>QCoreApplication::arguments</code> For example</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    QCoreApplication a(argc, argv);\n    if (argc &gt; 1)\n    {\n        QString str1 = \"\u00e7\u015f\u00fc\u011f\";\n        QString str2 = a.arguments().at(1);\n    }\n    return a.exec();\n}\n</code></pre>\n\n<p>Note that in Windows environment Unicode refers to UTF-16 standard, you need wide char strings, example <code>const wchar_t *charArray = L\"\u00e7\u015f\u00fc\u011f\";</code> While in Unix based environment Unicode refers to UTF-8. </p>\n\n<p>Qt is supposed to be cross platform compatible so it tries to hide these differences through <code>QString</code> and other functions.</p>\n"}], "owner": {"reputation": 309, "user_id": 1568630, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4962c318089b1755a41b515430a95c5c?s=128&d=identicon&r=PG", "display_name": "do\u011fan ", "link": "https://stackoverflow.com/users/1568630/do%c4%9fan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1078, "favorite_count": 0, "accepted_answer_id": 39390408, "answer_count": 2, "score": 3, "last_activity_date": 1473338634, "creation_date": 1473282952, "last_edit_date": 1473338634, "question_id": 39379119, "link": "https://stackoverflow.com/questions/39379119/how-can-i-get-qt-main-function-argv-parameter-as-unicode-encoding-format", "title": "how can I get QT main function argv parameter as unicode encoding format", "body": "<p>I am new on QT and I have a problem with encoding. This is my main function</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    QApplication a(argc, argv);\n    MainWindow w;\n\n    const char *charArray = \"\u00e7\u015f\u00fc\u011f\";\n\n    QStr\u0131ng str1(charArray);\n    QString str2(argv[1]);\n}\n</code></pre>\n\n<p><code>argv[1]</code> value is the same with <code>charArray</code> on the caller exe side. But If I control the <code>str1</code> and <code>str2</code> values <code>str1</code> is looking <em>\u00e7\u015f\u00fc\u011f</em> but <code>str2</code> \u0131s <em>.!?>&lt;</em>. I think it is because of encoding type. How can I fix this problem? Caller exe is c# application.</p>\n"}, {"tags": ["c++", "c++11", "visual-studio-2015"], "owner": {"reputation": 1435, "user_id": 384126, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/d0aa2c60dd45164161c487355fbe11c3?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/384126/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "closed_date": 1473282725, "answer_count": 0, "score": 1, "last_activity_date": 1473282570, "creation_date": 1473282570, "question_id": 39379048, "link": "https://stackoverflow.com/questions/39379048/virtual-method-that-takes-a-vector-of-a-specific-type-in-parameter", "closed_reason": "Duplicate", "title": "Virtual method that takes a vector of a specific type in parameter", "body": "<p>I'm trying make a virtual method that takes a vector of a specific type in parameter.</p>\n\n<p>This is the parent class:</p>\n\n<pre><code>template &lt;typename T&gt;\nclass Syncable\n{\n    virtual void update(vector&lt;typename T::PropertyType&gt;&amp; properties) = 0\n};\n</code></pre>\n\n<p>This is the child class:</p>\n\n<pre><code>class MyUser : public Syncable &lt;MyUser&gt;\n{\npublic:\n    enum class Property\n    {\n        Id,\n        DisplayName\n    };\n    using PropertyType = Property;\n\n    virtual void update(vector&lt;PropertyType&gt;&amp; properties) override\n    {\n        cout &lt;&lt; \"Update\";\n    }\n};\n</code></pre>\n\n<p>However, I get the following error:</p>\n\n<p><code>error C2039: 'PropertyType': is not a member of 'MyUser</code></p>\n\n<p>I think it might say so because in the <code>Syncable</code> class, MyUser is not defined yet. How can I workaround this problem?</p>\n\n<p>I use Visual Studio 2015.</p>\n"}, {"tags": ["c++", "pointers"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1473282534, "post_id": 39379027, "comment_id": 66085998, "body": "You would have to pass the variable by references."}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1473282538, "post_id": 39379027, "comment_id": 66086000, "body": "Can you use C++11 at least?"}, {"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1473282541, "post_id": 39379027, "comment_id": 66086003, "body": "Use <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr\" rel=\"nofollow noreferrer\"><code>std::shared_ptr</code></a>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473282544, "post_id": 39379027, "comment_id": 66086005, "body": "No.  It sounds like you might want a <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr\" rel=\"nofollow noreferrer\"><code>std::shared_ptr</code></a>"}, {"owner": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 3, "creation_date": 1473282726, "post_id": 39379027, "comment_id": 66086082, "body": "if you can&#39;t use shared_ptr, reinvent shared_ptr"}, {"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "edited": false, "score": 0, "creation_date": 1473282728, "post_id": 39379027, "comment_id": 66086085, "body": "If test 2 is null, then so is test"}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 1, "creation_date": 1473282734, "post_id": 39379027, "comment_id": 66086089, "body": "... or use <code>std::unique_ptr</code> if you want to make sure there is only one instance holding the pointer. Here, if you passed the value to <code>test2</code>, <code>test</code> would be automatically empty. This approach would be similar to standard behavior in Rust, where ownership is moved by default rather than copied."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1473283293, "post_id": 39379027, "comment_id": 66086324, "body": "What&#39;s your outer problem? Why would you want to do this? This sounds awful to me. What if code later compares <code>test</code> to <code>NULL</code>, sees that it is, and concludes that the allocation failed even though it didn&#39;t? Whatever actual problem you&#39;re trying to solve, there&#39;s probably a good way to solve it. But secretly changing values out from under the code isn&#39;t it."}, {"owner": {"reputation": 333, "user_id": 5637644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c82eee7c77b49c2c9650894a550231bf?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.SrJenea", "link": "https://stackoverflow.com/users/5637644/mr-srjenea"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1473285406, "post_id": 39379027, "comment_id": 66087093, "body": "@David Scwartz: What if we have two liked lists that share the same data but have different nodes. When destructor gets invoked for the first list, it deletes the data pointed to and the nodes. When it gets invoked the second time, it cannot check if data pointer is pointing to a valid data and tries to delete it again."}, {"owner": {"reputation": 457352, "user_id": 87234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FkjBe.png?s=128&g=1", "display_name": "GManNickG", "link": "https://stackoverflow.com/users/87234/gmannickg"}, "edited": false, "score": 2, "creation_date": 1473285519, "post_id": 39379027, "comment_id": 66087131, "body": "@Mr.SrJenea: You want <code>shared_ptr</code> and <code>weak_ptr</code>. If those aren&#39;t available to you, make them yourself."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1473288182, "post_id": 39379027, "comment_id": 66087975, "body": "@Mr.SrJenea As above, we have a perfect solution for that problem, <code>shared_ptr</code>/<code>weak_ptr</code>. This is <i>exactly</i> what they&#39;re for. I doubt we can improve on it. If you can&#39;t use them for some reason, about the best you can do is re-implement the parts of them that you need."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1473283029, "post_id": 39379085, "comment_id": 66086212, "body": "<i>However in modern C++ it&#39;s generally better to avoid raw pointers whenever possible</i> I would not say that.  Owning raw pointers yes, non-owning raw pointers are nothing to get upset about.  They are very useful."}], "tags": [], "owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "is_accepted": false, "score": 1, "last_activity_date": 1473289158, "last_edit_date": 1473289158, "creation_date": 1473282795, "answer_id": 39379085, "question_id": 39379027, "link": "https://stackoverflow.com/questions/39379027/set-a-sharing-pointer-to-null/39379085#39379085", "title": "Set a sharing pointer to NULL", "body": "<p>By default, when you pass a pointer to a function, you are passing a copy of the value:</p>\n\n<pre><code>void f(int* p) {\n    // p has the same value as x below, but is independent\n    delete p;\n    p = nullptr;\n    // p is null, but back in main 'x' still has the original value\n}\n\nint main() {\n    int* x = new int;\n    f(x);\n    // 'x' is unmodified and now points to a deleted block of memory\n}\n</code></pre>\n\n<p>Your options are to pass the pointer by reference or pass a pointer to the pointer:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nvoid by_pointer(int** p) {\n    delete *p;\n    *p = nullptr;\n}\n\nvoid by_reference(int*&amp; p) {\n    delete p;\n    p = nullptr;\n}\n\nint main() {\n    int* x = new int;\n    by_pointer(&amp;x);\n    std::cout &lt;&lt; (void*)x &lt;&lt; \"\\n\";  // outputs null\n\n    int* y = new int;\n    by_reference(y);\n    std::cout &lt;&lt; (void*)y &lt;&lt; \"\\n\";  // outputs null\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473283219, "post_id": 39379150, "comment_id": 66086296, "body": "Except <code>test2</code> is still not null but pointing to deleted memory."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473286330, "post_id": 39379150, "comment_id": 66087411, "body": "@NathanOliver that could be solved by having <code>int*&amp; test2 = test;</code> initially"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1473286870, "post_id": 39379150, "comment_id": 66087580, "body": "@M.M You could but that changes what the OP has."}], "tags": [], "owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "is_accepted": false, "score": 1, "last_activity_date": 1473283287, "last_edit_date": 1473283287, "creation_date": 1473283116, "answer_id": 39379150, "question_id": 39379027, "link": "https://stackoverflow.com/questions/39379027/set-a-sharing-pointer-to-null/39379150#39379150", "title": "Set a sharing pointer to NULL", "body": "<p>Pass the pointer be reference, since a copy would be passed to the function had you used a normal pointer, on which you can only change the pointed value, and since both pointers point to the same thing, no need to call <code>change()</code> on both:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nvoid change(int*&amp; p)\n{\n    delete p;\n    p = nullptr;\n}\n\nint main()\n{\n\n    int* test = new int;\n    *test = 5;\n    int* test2 = test;\n    std::cout  &lt;&lt; *test; //5\n    std::cout &lt;&lt; *test2; //5\n    change(test);\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/900fd7181d7572da\" rel=\"nofollow\">Example</a></p>\n\n<p>BTW, I recommend <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr\" rel=\"nofollow\"><code>std::shared_ptr</code></a> for a purpose like this, or <a href=\"http://en.cppreference.com/w/cpp/memory/unique_ptr\" rel=\"nofollow\"><code>std::unique_ptr</code></a></p>\n\n<p><em>EDIT</em>\nThe only problem above is that <code>test2</code> is deleted, not pointing to <code>nullptr</code>, but that cannot be changed unless with smart pointers or a different function.</p>\n"}, {"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 1, "last_activity_date": 1473289188, "creation_date": 1473289188, "answer_id": 39380219, "question_id": 39379027, "link": "https://stackoverflow.com/questions/39379027/set-a-sharing-pointer-to-null/39380219#39380219", "title": "Set a sharing pointer to NULL", "body": "<p>The <code>shared_ptr</code> and <code>weak_ptr</code> classes do exactly what you want. Since you can't use them, your best option is to re-implement just the portions of them that you need. I'm going to assume you don't need any thread safety and that you don't care about optimizations for simplicity. If you do, use the standard library.</p>\n\n<p>You need a control object. It should have a pointer to the real object and two integers, one the count of strong pointers, the other the count of weak pointers. Strong pointers and weak pointers should have a pointer to the control object.</p>\n\n<p>When a strong pointer is destroyed, decrement the strong pointer count. If the strong pointer count is zero, delete the object and set its pointer to NULL. If the weak pointer count is also zero, discard the control object.</p>\n\n<p>When a weak pointer is destroyed, decrement the weak pointer count. If both pointers counts are zero, discard the control object.</p>\n\n<p>When pointers are copied, you must bump the count. When a weak pointer is promoted to a strong pointer, bump the strong pointer count and fail the operation if it was previously zero.</p>\n\n<p>That should be enough to give you the idea.</p>\n"}, {"tags": [], "owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "is_accepted": false, "score": 1, "last_activity_date": 1473289311, "creation_date": 1473289311, "answer_id": 39380242, "question_id": 39379027, "link": "https://stackoverflow.com/questions/39379027/set-a-sharing-pointer-to-null/39380242#39380242", "title": "Set a sharing pointer to NULL", "body": "<p>If you <em>really</em> want this (though I'd <strong>strongly</strong> suggest you to reconsider your design), then the following might work for you:</p>\n\n<p>We wrap the pointer in a structure/class to be able to \"hook\" us on construction and destruction of such pointers:</p>\n\n<pre><code>template&lt;typename T&gt;\nstruct pointer {\n</code></pre>\n\n<p>Since when freeing the stored value, we also need to modify all <code>pointer</code>s that still point to it, we need to keep track of them somehow. I'd say just store them alongside the value:</p>\n\n<pre><code>  struct boxing {\n    T value;\n    std::set&lt;pointer&lt;T&gt; *&gt; references;\n  };\n  boxing * box;\n</code></pre>\n\n<p>Next comes constructing a pointer. I simplified here. You might want to add perfect forwarding, a possibility to construct a \"null pointer\", and so on ...    </p>\n\n<pre><code>  pointer(T value) : box(new boxing{value}) {\n    add_myself();\n  }\n</code></pre>\n\n<p>As you see, we \"add ourselves\" (to the set of references). When the <code>pointer</code> is destructed, we need to remove ourselves from that set again:</p>\n\n<pre><code>  ~pointer() {\n    remove_myself();\n  }\n</code></pre>\n\n<p>When being copy constructed, we just use the <code>box</code> from the original and add ourselves:</p>\n\n<pre><code>  pointer(pointer const &amp; p) : box(p.box) {\n    add_myself();\n  }\n</code></pre>\n\n<p>When being copy assigned to, we first need to remove ourselves from the current <code>box</code>, use the box of the original and add ourselves:</p>\n\n<pre><code>  pointer &amp; operator=(pointer const &amp; p) {\n    remove_myself();\n    box = p.box;\n    add_myself();\n  }\n</code></pre>\n\n<p>I'm lazy. Implement move construction / assignment yourself ;)    </p>\n\n<pre><code>  pointer(pointer &amp;&amp;) = delete;\n  pointer &amp; operator=(pointer &amp;&amp;) = delete;\n</code></pre>\n\n<p>We want to be able to use the <code>pointer</code>, so we add a conversion operator to a raw pointer:</p>\n\n<pre><code>  operator T*(void) {\n    return box ? &amp;(box-&gt;value) : nullptr;\n  }\n</code></pre>\n\n<p>Finally, freeing a pointer. We set all <code>box</code> members of the current <code>pointers</code> in the references set to <code>nullptr</code> (this includes ourself, thus the additional pointer <code>b</code>), and then delete the box:</p>\n\n<pre><code>  void free() {\n    boxing * b = box;\n    for (pointer * p : b-&gt;references) {\n      p-&gt;box = nullptr;\n    }\n    delete b;\n  }\n</code></pre>\n\n<p>Oh, and last but not least, adding and removing ourselves:</p>\n\n<pre><code>  private:\n  void remove_myself() {\n    if (box == nullptr) return;\n    box-&gt;references.erase(this);\n    if (box-&gt;references.size() == 0) {\n      delete box;\n    }\n  }\n  void add_myself() {\n    if (box == nullptr) return;\n    box-&gt;references.insert(this);\n  }\n};\n</code></pre>\n\n<p>Some function. Note that I pass by value to force another copy construction: </p>\n\n<pre><code>void foo(pointer&lt;int&gt; p) {\n  p.free();\n}\n</code></pre>\n\n<p>Two <code>pointers</code>, pointing to the same boxed value:</p>\n\n<pre><code>int main(int, char **) {\n  pointer&lt;int&gt; a{21};\n  pointer&lt;int&gt; b = a;\n  *b = 42;\n  std::cout &lt;&lt; *a &lt;&lt; std::endl;\n  foo(a);\n  std::cout &lt;&lt; \"a is \" &lt;&lt; ((a == nullptr) ? \"null\" : \"non-null\") &lt;&lt; std::endl;\n  return 0;\n}\n</code></pre>\n\n<p><a href=\"http://ideone.com/vkymt7\" rel=\"nofollow\">Above example on ideone.</a></p>\n"}, {"tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 1, "last_activity_date": 1473291390, "creation_date": 1473291390, "answer_id": 39380498, "question_id": 39379027, "link": "https://stackoverflow.com/questions/39379027/set-a-sharing-pointer-to-null/39380498#39380498", "title": "Set a sharing pointer to NULL", "body": "<p>The idea of shared controllers of a uniquely-owned object is of course horrid (for reasons that will become clear).</p>\n\n<p>Nevertheless, it can be done:</p>\n\n<pre><code>template&lt;class T, class Deleter = std::default_delete&lt;T&gt;&gt;\nstruct shared_unique\n{\n    struct control_block\n    {\n        control_block(Deleter del, T* p) : del_(std::move(del)), ptr_(p), refs_(1) {}\n\n        Deleter del_;\n        T* ptr_;\n        std::size_t refs_;\n\n        void addref()\n        {\n            ++refs_;\n        }\n\n        void release()\n        {\n            if (--refs_ == 0)\n                delete this;\n        }\n\n        ~control_block() {\n            if (ptr_)\n                del_(ptr_);\n        }\n    };\n\n    control_block* ctrl_;\n\n    shared_unique(T* p = nullptr, Deleter del = Deleter()) : ctrl_(new control_block(std::move(del), p)) {}\n    shared_unique(shared_unique const&amp; r) : ctrl_(r.ctrl_) { ctrl_-&gt;addref(); }\n    shared_unique&amp; operator=(shared_unique const&amp; r)\n    {\n        auto tmp = r;\n        swap(r);\n        return *this;\n    }\n\n    shared_unique(shared_unique&amp;&amp; r) : ctrl_(r.ctrl_) { r.ctrl_ = nullptr; }\n    shared_unique&amp; operator=(shared_unique&amp;&amp; r)\n    {\n        auto tmp = std::move(r);\n        swap(tmp);\n        return *this;\n    }\n\n    ~shared_unique()\n    {\n        ctrl_-&gt;release();\n    }\n\n    void swap(shared_unique&amp; r) noexcept\n    {\n        std::swap(ctrl_, r.ctrl_);\n    }\n\n    void reset(T* p = nullptr)\n    {\n        std::swap(ctrl_-&gt;ptr_, p);\n        delete p;\n    }\n\n    T* get() const {\n        return ctrl_-&gt;ptr_;\n    }\n};\n\nint main()\n{\n    shared_unique&lt;int&gt; su1(new int(5));\n    assert( su1.get() );\n    assert( *(su1.get()) == 5 );\n\n    shared_unique&lt;int&gt; su2 = su1;\n    assert( su2.get() );\n    assert( *(su2.get()) == 5 );\n\n    su1.reset();\n    assert( su1.get() == nullptr );\n    assert( su2.get() == nullptr );\n}\n</code></pre>\n\n<p>The problem is that it is impossible to make this arrangement thread-safe, unless you provide some kind of 'lock' mechanism to keep the pointed-to object alive while it's being accessed.</p>\n\n<p>If you want to know when an object has been destroyed, it's probably better to have it (or its smart pointer) emit a signal when this happens and have the interested observers listen on the slot (or similar).</p>\n"}], "owner": {"reputation": 333, "user_id": 5637644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c82eee7c77b49c2c9650894a550231bf?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.SrJenea", "link": "https://stackoverflow.com/users/5637644/mr-srjenea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1381, "favorite_count": 0, "accepted_answer_id": 39380219, "answer_count": 5, "score": -1, "last_activity_date": 1473291390, "creation_date": 1473282460, "last_edit_date": 1473286005, "question_id": 39379027, "link": "https://stackoverflow.com/questions/39379027/set-a-sharing-pointer-to-null", "title": "Set a sharing pointer to NULL", "body": "<p>Lets say I have the following:</p>\n\n<pre><code>int main() {\n    int* test = new int;\n    *test = 5;\n    int* test2 = test;\n}\n</code></pre>\n\n<p>Then, somewhere, in some function , I deallocate memory for <code>test2</code> and set it to <code>NULL</code>. Is there a way to set <code>test</code> to <code>NULL</code>, in the same function without passing it to the function?</p>\n\n<hr>\n\n<p>EDIT: <code>std::shared_ptr</code> cannot be used</p>\n"}, {"tags": ["c++", "inheritance"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1473282189, "post_id": 39378897, "comment_id": 66085829, "body": "private doesn&#39;t hide it."}, {"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1473282190, "post_id": 39378897, "comment_id": 66085831, "body": "Because both <code>Base</code> and <code>Time</code> have a member function named <code>foo</code> and the compiler doesn&#39;t know which one you are trying to invoke. There&#39;s a dupe of this out there somewhere."}, {"owner": {"reputation": 667, "user_id": 6730526, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1131892593548201/picture?type=large", "display_name": "Yurkee", "link": "https://stackoverflow.com/users/6730526/yurkee"}, "edited": false, "score": 0, "creation_date": 1473282230, "post_id": 39378897, "comment_id": 66085843, "body": "will namespace inside Base hide it?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1473282291, "post_id": 39378897, "comment_id": 66085872, "body": "maybe visibility is checked after scope resolution?"}, {"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 3, "creation_date": 1473282384, "post_id": 39378897, "comment_id": 66085920, "body": "See <a href=\"http://stackoverflow.com/questions/9975291/ambiguous-when-two-superclasses-have-a-member-function-with-the-same-name-but\" title=\"ambiguous when two superclasses have a member function with the same name but\">stackoverflow.com/questions/9975291/&hellip;</a>, <a href=\"http://stackoverflow.com/questions/18158094/fixing-c-multiple-inheritance-ambiguous-call\" title=\"fixing c multiple inheritance ambiguous call\">stackoverflow.com/questions/18158094/&hellip;</a>, and <a href=\"http://stackoverflow.com/questions/6845854/c-multiple-inheritance-function-call-ambiguity\" title=\"c multiple inheritance function call ambiguity\">stackoverflow.com/questions/6845854/&hellip;</a> just to start."}, {"owner": {"reputation": 14050, "user_id": 1858225, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8afcf8a38024eb5b17c0b0b58ff96d79?s=128&d=identicon&r=PG", "display_name": "Kyle Strand", "link": "https://stackoverflow.com/users/1858225/kyle-strand"}, "edited": false, "score": 2, "creation_date": 1473282449, "post_id": 39378897, "comment_id": 66085951, "body": "You may find the answers here (including but not limited to mine!) helpful: <a href=\"http://stackoverflow.com/q/39042240/1858225\">stackoverflow.com/q/39042240/1858225</a>  In short, visibility is <i>never</i> part of function-lookup and overload resolution; the compiler picks the best match <i>before</i> checking whether the function is visible from the calling context."}, {"owner": {"reputation": 667, "user_id": 6730526, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1131892593548201/picture?type=large", "display_name": "Yurkee", "link": "https://stackoverflow.com/users/6730526/yurkee"}, "edited": false, "score": 0, "creation_date": 1473282461, "post_id": 39378897, "comment_id": 66085959, "body": "yaay, knowledge :3 thank you!  btw: Child::Time::foo() is not ambiguous"}, {"owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "edited": false, "score": 1, "creation_date": 1473283169, "post_id": 39378897, "comment_id": 66086274, "body": "<code>foo()</code> is private. You cannot call from any derivative class."}], "answers": [{"tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": false, "score": 0, "last_activity_date": 1473286526, "last_edit_date": 1473286526, "creation_date": 1473284084, "answer_id": 39379360, "question_id": 39378897, "link": "https://stackoverflow.com/questions/39378897/c-inheritance-ambiguous-function/39379360#39379360", "title": "C++ inheritance - ambiguous Function", "body": "<p><strong>Preliminary remarks</strong></p>\n\n<p>Your code snippet doesn't compile for another reason: <code>Base</code> has no access to <code>Time</code>'s <code>foo()</code> as it is a private member.  So the <code>foo1()</code> causes an error, before you have the reported ambiguity.  </p>\n\n<p>If you change <code>Time</code> to make its member protected, then you can reproduce your error exactly as you describe:  </p>\n\n<pre><code>class Time{\nprotected:\n    void foo();\n};\n</code></pre>\n\n<p><strong>What's wrong here ?</strong></p>\n\n<p><code>Base</code> privately inherits <code>Time</code>, so that it's members are not expected to be visible to the outside world.   </p>\n\n<p>But what could be true for the external world is not true for derived classes. The name lookup rules in the case of derivation say that first the name is looked up in the class hierarchy, then overloading is applied, than only is access control carried out: </p>\n\n<blockquote>\n  <p><strong>10.2/1</strong> Member name lookup determines the meaning of a name (<em>id-expression</em>) in a class scope. Name lookup can result in an\n  ambiguity, in which case the program is ill-formed. For an\n  <em>id-expression</em>, name lookup begins in the class scope of this; for a qualified-id, name lookup begins in the scope of the\n  nested-name-specifier. Name lookup <strong>takes place before access\n  control.</strong><br/>\n  <strong>10.2/8</strong> If the name of an overloaded function is unambiguously found, overloading resolution also takes place before access control.\n  Ambiguities can often be resolved by qualifying a name with its class\n  name.</p>\n</blockquote>\n\n<p>As you use multiple inheritance:  </p>\n\n<pre><code>Time     \n  :\n  :\nBase  Time \n    \\  :\n     \\ : \n    Child\n</code></pre>\n\n<p>So you inherit twice a <code>foo()</code>, once via private inheritance and onve via public. This ambiguity makes the name <code>foo</code> in <code>foo2()</code> ambiguous according to the standard, and before access is verified, making your code invalid.   </p>\n\n<p>Note that Child sees 2 foo() but ironically can't use none of them: both come via private inherited.  So even if you'd resolve the ambiguity, you'd get another error message about accessibility.  </p>\n"}, {"tags": [], "owner": {"reputation": 3797, "user_id": 2874856, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kWxOm.jpg?s=128&g=1", "display_name": "Raindrop7", "link": "https://stackoverflow.com/users/2874856/raindrop7"}, "is_accepted": false, "score": 1, "last_activity_date": 1473296020, "creation_date": 1473296020, "answer_id": 39381023, "question_id": 39378897, "link": "https://stackoverflow.com/questions/39378897/c-inheritance-ambiguous-function/39381023#39381023", "title": "C++ inheritance - ambiguous Function", "body": "<p>there's another error in your code: class base inherits privately from class Time and class Child inherits again privately from class time!!!</p>\n\n<p>the law of inheritance: </p>\n\n<pre><code>class Time\n{};\n\nclass Base : private Time\n{};\n\nclass Child : public Base, private Time\n{};\n</code></pre>\n\n<p>Base  has a copy of class Time because it inherits from it.</p>\n\n<p>child has a copy of class Base because it inherits from it.</p>\n\n<p>*** Child has a copy of class Time because its parents (Base) has this copy.</p>\n\n<p>if Child tries to inherit explicitly from class Time will issue a compile-time-error: error C2584: 'Child' : direct base 'Time' is inaccessible; already a base of 'Base'</p>\n"}], "owner": {"reputation": 667, "user_id": 6730526, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1131892593548201/picture?type=large", "display_name": "Yurkee", "link": "https://stackoverflow.com/users/6730526/yurkee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 989, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1473324824, "creation_date": 1473281934, "last_edit_date": 1473324824, "question_id": 39378897, "link": "https://stackoverflow.com/questions/39378897/c-inheritance-ambiguous-function", "title": "C++ inheritance - ambiguous Function", "body": "<p>I've got an Inheritance problem:\nLet's say I've got </p>\n\n<pre><code>class Time{\nprotected:\nvoid foo();\n};\n</code></pre>\n\n<p>and also</p>\n\n<pre><code>class Base: private Time{\nvoid foo1(){ foo(); }\n};\n\nclass Child: public Base, private Time{\nvoid foo2(){ foo(); }// here my compiler says that foo is ambiguous\n};\n</code></pre>\n\n<p>why is foo() ambiguous, if the inheritance of Time in Base is private?</p>\n\n<p>PS.\nJust&amp;only for those who need to see the full code, here is the GitHub Project: \n<a href=\"https://github.com/huntekah/Interior_decorator-OpenGL_Project/blob/master/Grafika-OpenGL/Interior_decorator/Display.cpp#L133\" rel=\"nofollow\">https://github.com/huntekah/Interior_decorator-OpenGL_Project/blob/master/Grafika-OpenGL/Interior_decorator/Display.cpp#L133</a>\nclass Time( utilities directory ) is inherited by ControlObjects and ControlCamera, both of which are the base for Controls. Display inherits Controls , and additionally Time. commented line shows a place where SetDeltaTime() is ambiguous; </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1473281818, "post_id": 39378821, "comment_id": 66085667, "body": "First convert to 64-bit unsigned. Then <a href=\"http://stackoverflow.com/questions/1873352/how-do-i-convert-a-value-from-host-byte-order-to-little-endian\">convert as necessary to little endian</a>."}, {"owner": {"reputation": 17992, "user_id": 278326, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/29b774f602a4e39d45f5c4f142566f2b?s=128&d=identicon&r=PG", "display_name": "Arun", "link": "https://stackoverflow.com/users/278326/arun"}, "edited": false, "score": 1, "creation_date": 1473281904, "post_id": 39378821, "comment_id": 66085713, "body": "The diagrams at <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Endianness</a> might be helpful."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1473281956, "post_id": 39378821, "comment_id": 66085730, "body": "memcpy to unsigned char array and then swap as necessary. memcpy to your destination."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1473324323, "post_id": 39378821, "comment_id": 66099510, "body": "@Cheersandhth.-Alf, I&#39;m afraid that <code>uint64-t</code> is already unsigned, no need to convert it to unsigned again."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1473325457, "post_id": 39378821, "comment_id": 66100200, "body": "@LuisColorado: Oh, thanks. I was mislead by the &quot;convert ... to unsigned&quot; in the question title  and main text. Fixing. But, now it&#39;s a duplicate. Closing. :)"}], "answers": [{"tags": [], "owner": {"reputation": 1251, "user_id": 2397809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/z7E3O.jpg?s=128&g=1", "display_name": "Barrett Adair", "link": "https://stackoverflow.com/users/2397809/barrett-adair"}, "is_accepted": true, "score": 0, "last_activity_date": 1473298267, "creation_date": 1473298267, "answer_id": 39381287, "question_id": 39378821, "link": "https://stackoverflow.com/questions/39378821/convert-uint64-t-to-8-byte-little-endian-long/39381287#39381287", "title": "Convert uint64_t to 8 byte little endian long", "body": "<p>Well, there is <a href=\"http://www.boost.org/doc/libs/1_62_0_b1/libs/endian/doc/conversion.html\" rel=\"nofollow\">Boost.Endian</a>.</p>\n\n<pre><code>#include &lt;boost/endian/conversion.hpp&gt;\n\n#include &lt;iostream&gt;\n#include &lt;cstddef&gt;\n\nint main() {\n   std::uint64_t foo = 1;\n   std::cout &lt;&lt; boost::endian::endian_reverse(foo);\n}\n</code></pre>\n\n<p>Output: <code>72057594037927936</code></p>\n"}], "owner": {"reputation": 99, "user_id": 1984300, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7ea146654c58825bd57f6a93c1b63c0f?s=128&d=identicon&r=PG", "display_name": "user1984300", "link": "https://stackoverflow.com/users/1984300/user1984300"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1123, "favorite_count": 0, "closed_date": 1473325573, "accepted_answer_id": 39381287, "answer_count": 1, "score": 0, "last_activity_date": 1473325491, "creation_date": 1473281600, "last_edit_date": 1473325491, "question_id": 39378821, "link": "https://stackoverflow.com/questions/39378821/convert-uint64-t-to-8-byte-little-endian-long", "closed_reason": "Duplicate", "title": "Convert uint64_t to 8 byte little endian long", "body": "<p>I have a variable called length that is of type uint64_t. I want to convert it to 8 byte little endian long and I'm very confused about these data types.</p>\n\n<p>Can someone guide me on how to make this conversion?</p>\n"}, {"tags": ["c++", "tensorflow"], "comments": [{"owner": {"reputation": 119710, "user_id": 3574081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LIW6C.jpg?s=128&g=1", "display_name": "mrry", "link": "https://stackoverflow.com/users/3574081/mrry"}, "edited": false, "score": 0, "creation_date": 1473289612, "post_id": 39378657, "comment_id": 66088379, "body": "What type of C++ object do you have?"}, {"owner": {"reputation": 91, "user_id": 6166308, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/66e06b152dc503068ebb5067fa0a283c?s=128&d=identicon&r=PG&f=1", "display_name": "boother", "link": "https://stackoverflow.com/users/6166308/boother"}, "reply_to_user": {"reputation": 119710, "user_id": 3574081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LIW6C.jpg?s=128&g=1", "display_name": "mrry", "link": "https://stackoverflow.com/users/3574081/mrry"}, "edited": false, "score": 0, "creation_date": 1473328789, "post_id": 39378657, "comment_id": 66102218, "body": "I use the following sequence:  &lt;code&gt; Status status = NewSession(SessionOptions(), &amp;session); // create new session     ReadBinaryProto(tensorflow::Env::Default(), model, &amp;graph_def); // read Graph session-&gt;Create(graph_def); // add Graph to Tensorflow session  std::vector&lt;tensorflow::Tensor&gt; output; // create Tensor to store output std::vector&lt;string&gt; vNames; // vector of names for required graph nodes  vNames.push_back(&quot;some_name&quot;); // I checked names and they are presented in loaded Graph  session-&gt;Run({}, vNames, {}, &amp;output); // ??? As a result I have empty output&lt;code&gt;"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 6166308, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/66e06b152dc503068ebb5067fa0a283c?s=128&d=identicon&r=PG&f=1", "display_name": "boother", "link": "https://stackoverflow.com/users/6166308/boother"}, "edited": false, "score": 0, "creation_date": 1473420760, "post_id": 39394704, "comment_id": 66145406, "body": "Thanks for the advice! It and <a href=\"https://habrahabr.ru/post/308002/\" rel=\"nofollow noreferrer\">these</a> examples helped me to understand."}, {"owner": {"reputation": 199, "user_id": 3535616, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/20ad9d8fe2c4f95af377d649437d9e6d?s=128&d=identicon&r=PG", "display_name": "Jim", "link": "https://stackoverflow.com/users/3535616/jim"}, "edited": false, "score": 0, "creation_date": 1508768332, "post_id": 39394704, "comment_id": 80730409, "body": "What are the alternatives to using the C++ <code>tensorflow::Session</code> API for this?"}], "tags": [], "owner": {"reputation": 119710, "user_id": 3574081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LIW6C.jpg?s=128&g=1", "display_name": "mrry", "link": "https://stackoverflow.com/users/3574081/mrry"}, "is_accepted": false, "score": 3, "last_activity_date": 1473347884, "last_edit_date": 1495541382, "creation_date": 1473347884, "answer_id": 39394704, "question_id": 39378657, "link": "https://stackoverflow.com/questions/39378657/c-equivalent-of-python-tf-graph-get-tensor-by-name-in-tensorflow/39394704#39394704", "title": "C++ equivalent of python: tf.Graph.get_tensor_by_name() in Tensorflow?", "body": "<p>From <a href=\"https://stackoverflow.com/questions/39378657/c-equivalent-of-python-tf-graph-get-tensor-by-name-in-tensorflow#comment66102218_39378657\">your comment</a>, it sounds like you are using the C++ <code>tensorflow::Session</code> API, which represents graphs as <code>GraphDef</code> protocol buffers. There is <strong>no equivalent</strong> to <a href=\"https://www.tensorflow.org/versions/r0.10/api_docs/python/framework.html#Graph.get_tensor_by_name\" rel=\"nofollow noreferrer\"><code>tf.Graph.get_tensor_by_name()</code></a> in this API.</p>\n\n<p>Instead of passing typed <a href=\"https://www.tensorflow.org/versions/r0.10/api_docs/python/framework.html#Tensor\" rel=\"nofollow noreferrer\"><code>tf.Tensor</code></a> objects to <a href=\"https://www.tensorflow.org/versions/r0.10/api_docs/cc/ClassSession.html#virtual_Status_tensorflow_Session_Run\" rel=\"nofollow noreferrer\"><code>Session::Run()</code></a>, you pass the <code>string</code> names of tensors, which have the form <code>&lt;NODE NAME&gt;:&lt;N&gt;</code>, where <code>&lt;NODE NAME&gt;</code> matches one of the <code>NodeDef.name</code> values in the <code>GraphDef</code>, and <code>&lt;N&gt;</code> is an integer corresponding to the index of the the output from that node that you want to fetch.</p>\n\n<p>The code in your question looks roughly correct, but there are two things I'd advise:</p>\n\n<ol>\n<li><p>The <code>session-&gt;Run()</code> call returns a <code>tensorflow::Status</code> value. If <code>output</code> is empty after the the call returns, it is almost certain that the call returned an error status with a message that explains the problem.</p></li>\n<li><p>You're passing <code>\"some_name\"</code> as the name of a tensor to fetch, but it is the name of a node, not a tensor. It is possible that this API requires you to specify the output index explicitly: try replacing it with <code>\"some_name:0\"</code>.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 87, "user_id": 8744431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f708325171510c02d57f6f14c4b502?s=128&d=identicon&r=PG&f=1", "display_name": "zhen liu", "link": "https://stackoverflow.com/users/8744431/zhen-liu"}, "is_accepted": false, "score": 3, "last_activity_date": 1512558630, "creation_date": 1512558630, "answer_id": 47672920, "question_id": 39378657, "link": "https://stackoverflow.com/questions/39378657/c-equivalent-of-python-tf-graph-get-tensor-by-name-in-tensorflow/47672920#47672920", "title": "C++ equivalent of python: tf.Graph.get_tensor_by_name() in Tensorflow?", "body": "<p>there is a way to get neural node from graph_def directly. \nif u only want the shape\\type of node: \"some_name\":</p>\n\n<pre><code>void readPB(GraphDef &amp; graph_def)\n{\n\n    int i;\n    for (i = 0; i &lt; graph_def.node_size(); i++)\n    {\n        if (graph_def.node(i).name() == \"inputx\")\n        {\n            graph_def.node(i).PrintDebugString();\n        }\n    }\n}\n</code></pre>\n\n<p>results:</p>\n\n<pre><code>name: \"inputx\"\nop: \"Placeholder\"\nattr {\n  key: \"dtype\"\n  value {\n    type: DT_FLOAT\n  }\n}\nattr {\n  key: \"shape\"\n  value {\n    shape {\n      dim {\n        size: -1\n      }\n      dim {\n        size: 5120\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>try member functins of the node and get the informations.</p>\n"}, {"tags": [], "owner": {"reputation": 1096, "user_id": 2135504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kmscJ.png?s=128&g=1", "display_name": "gebbissimo", "link": "https://stackoverflow.com/users/2135504/gebbissimo"}, "is_accepted": false, "score": 1, "last_activity_date": 1553534259, "creation_date": 1553534259, "answer_id": 55343255, "question_id": 39378657, "link": "https://stackoverflow.com/questions/39378657/c-equivalent-of-python-tf-graph-get-tensor-by-name-in-tensorflow/55343255#55343255", "title": "C++ equivalent of python: tf.Graph.get_tensor_by_name() in Tensorflow?", "body": "<p>In case anybody is interested, here is how you extract the shape of an arbitrary sensor from graph_def using the tensorflow C++ API</p>\n\n<pre><code>vector&lt;int64_t&gt; get_shape_of_tensor(tensorflow::GraphDef graph_def, std::string name_tensor)\n{\n    vector&lt;int64_t&gt; tensor_shape;\n    for (int i=0; i &lt; graph_def.node_size(); ++i) {\n        if (graph_def.node(i).name() == name_tensor) {\n            auto node = graph_def.node(i);\n            auto attr_map = node.attr();\n            for (auto it=attr_map.begin(); it != attr_map.end(); it++) {\n                auto key = it-&gt;first;\n                auto value = it-&gt;second;\n                if (value.has_shape()) {\n                    auto shape = value.shape();\n                    for (int i=0; i&lt;shape.dim_size(); ++i) {\n                        auto dim = shape.dim(i);\n                        auto dim_size = dim.size();\n                        tensor_shape.push_back(dim_size);\n                    }\n                }\n            }\n        }\n    }\n    return tensor_shape\n}\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 6166308, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/66e06b152dc503068ebb5067fa0a283c?s=128&d=identicon&r=PG&f=1", "display_name": "boother", "link": "https://stackoverflow.com/users/6166308/boother"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4377, "favorite_count": 2, "answer_count": 3, "score": 5, "last_activity_date": 1576832115, "creation_date": 1473280875, "last_edit_date": 1473347697, "question_id": 39378657, "link": "https://stackoverflow.com/questions/39378657/c-equivalent-of-python-tf-graph-get-tensor-by-name-in-tensorflow", "title": "C++ equivalent of python: tf.Graph.get_tensor_by_name() in Tensorflow?", "body": "<p>What is the C++ equivalent of python: tf.Graph.get_tensor_by_name(name) in Tensorflow? Thanks!</p>\n\n<p>Here is the code I am trying to run, but I get an empty <code>output</code>:</p>\n\n<pre><code>Status status = NewSession(SessionOptions(), &amp;session); // create new session\nReadBinaryProto(tensorflow::Env::Default(), model, &amp;graph_def); // read Graph\nsession-&gt;Create(graph_def); // add Graph to Tensorflow session \nstd::vector&lt;tensorflow::Tensor&gt; output; // create Tensor to store output\nstd::vector&lt;string&gt; vNames; // vector of names for required graph nodes\nvNames.push_back(\"some_name\"); // I checked names and they are presented in loaded Graph\n\nsession-&gt;Run({}, vNames, {}, &amp;output); // ??? As a result I have empty output\n</code></pre>\n"}, {"tags": ["c++", "sockets"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1473280432, "post_id": 39378489, "comment_id": 66085048, "body": "seeing setup code for <code>fd</code> would be helpful. Also, invest in some Wireshark (or Message Analyzer if this is loopback traffic on Windows). Seeing network traffic (or a lack of it) helps narrow these problems down."}, {"owner": {"reputation": 17992, "user_id": 278326, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/29b774f602a4e39d45f5c4f142566f2b?s=128&d=identicon&r=PG", "display_name": "Arun", "link": "https://stackoverflow.com/users/278326/arun"}, "edited": false, "score": 0, "creation_date": 1473280439, "post_id": 39378489, "comment_id": 66085050, "body": "At the receiving side, how is it known how many integers to receive? I think sender has to send the size of the array (<i>k</i>) first."}, {"owner": {"reputation": 996, "user_id": 6382969, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/6573906dc8d142351d2f6ec09fd942ce?s=128&d=identicon&r=PG&f=1", "display_name": "PHcoDer", "link": "https://stackoverflow.com/users/6382969/phcoder"}, "reply_to_user": {"reputation": 17992, "user_id": 278326, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/29b774f602a4e39d45f5c4f142566f2b?s=128&d=identicon&r=PG", "display_name": "Arun", "link": "https://stackoverflow.com/users/278326/arun"}, "edited": false, "score": 0, "creation_date": 1473280595, "post_id": 39378489, "comment_id": 66085108, "body": "@Arun I am using them with same k on both sides, for test case. So thats not an issue."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1473280819, "post_id": 39378489, "comment_id": 66085192, "body": "This looks uncomfortably close to C, rather than (modern) C++..."}, {"owner": {"reputation": 996, "user_id": 6382969, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/6573906dc8d142351d2f6ec09fd942ce?s=128&d=identicon&r=PG&f=1", "display_name": "PHcoDer", "link": "https://stackoverflow.com/users/6382969/phcoder"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1473280996, "post_id": 39378489, "comment_id": 66085270, "body": "@JesperJuhl, yes thats correct. I am using these as API calls for other c++ program. However what do you want to convey by this?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1473281345, "post_id": 39378489, "comment_id": 66085447, "body": "I assume you&#39;re not getting errors from your <code>rc</code> return ..? Does your program appear to hang or does it execute to completion?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1473281706, "post_id": 39378489, "comment_id": 66085615, "body": "@PHcoDer what I want to convey is that seeing manual memory management in modern C++ code is more often than not unneeded and a code smell and source of bugs. And even if you really <i>have</i> to, then <code>new</code>/<code>delete</code> should be used (since they deal correctly with ctors/dtors), never <code>malloc</code>/<code>free</code>. The fact that this code uses raw pointers rather than smart pointers or just <code>std::</code> containers, tells me that there are bound to be problems ahead..  that&#39;s all - the code looks like C, C is error prone, modern C++14 has better alternatives.."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473282633, "post_id": 39378489, "comment_id": 66086038, "body": "Invalid C code. Dropped tag."}], "answers": [{"tags": [], "owner": {"reputation": 17031, "user_id": 185915, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/207045374ab195353388d9fcc77af9c5?s=128&d=identicon&r=PG", "display_name": "Chad", "link": "https://stackoverflow.com/users/185915/chad"}, "is_accepted": false, "score": 2, "last_activity_date": 1473281520, "creation_date": 1473281520, "answer_id": 39378804, "question_id": 39378489, "link": "https://stackoverflow.com/questions/39378489/transfer-array-of-integers-over-a-socket-in-c-c/39378804#39378804", "title": "Transfer array of integers over a socket in C/C++", "body": "<p>You declare two <code>data</code> variables, the second one hiding the first.</p>\n\n<pre><code>bool sendKInt(int fd, int num[], int k){ // returns true on success\n    int32_t conv[k];\n\n    // First \"data\", points to undefined value\n    char *data;\n    for (int i=0; i&lt;k; i++){\n        conv[i] = htonl(num[i]);\n\n        // local data, points to conv\n        // HIDES the first data declared above\n        char *data = (char*)conv;\n    }\n\n    // uses the only \"data\" in scope, which points to undefined location\n    return sendTill(sizeof(int32_t)*k, fd, data);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 996, "user_id": 6382969, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/6573906dc8d142351d2f6ec09fd942ce?s=128&d=identicon&r=PG&f=1", "display_name": "PHcoDer", "link": "https://stackoverflow.com/users/6382969/phcoder"}, "edited": false, "score": 0, "creation_date": 1473281955, "post_id": 39378805, "comment_id": 66085729, "body": "Thanks! Then same would be issue with receiveIntK too?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 996, "user_id": 6382969, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/6573906dc8d142351d2f6ec09fd942ce?s=128&d=identicon&r=PG&f=1", "display_name": "PHcoDer", "link": "https://stackoverflow.com/users/6382969/phcoder"}, "edited": false, "score": 0, "creation_date": 1473282022, "post_id": 39378805, "comment_id": 66085763, "body": "@PHcoDer Yes. <code>ret[k]</code> will have the same problem."}, {"owner": {"reputation": 996, "user_id": 6382969, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/6573906dc8d142351d2f6ec09fd942ce?s=128&d=identicon&r=PG&f=1", "display_name": "PHcoDer", "link": "https://stackoverflow.com/users/6382969/phcoder"}, "edited": false, "score": 0, "creation_date": 1473282102, "post_id": 39378805, "comment_id": 66085795, "body": "But I think doing malloc there will solve the problem?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 996, "user_id": 6382969, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/6573906dc8d142351d2f6ec09fd942ce?s=128&d=identicon&r=PG&f=1", "display_name": "PHcoDer", "link": "https://stackoverflow.com/users/6382969/phcoder"}, "edited": false, "score": 3, "creation_date": 1473282197, "post_id": 39378805, "comment_id": 66085834, "body": "<code>malloc</code> should be used as a last resort in C++. Prefer <code>new</code>. In this case though you could read directly into <code>num</code> and <code>num[i] = ntohl(num[i]);</code> to save yourself any more allocations."}, {"owner": {"reputation": 996, "user_id": 6382969, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/6573906dc8d142351d2f6ec09fd942ce?s=128&d=identicon&r=PG&f=1", "display_name": "PHcoDer", "link": "https://stackoverflow.com/users/6382969/phcoder"}, "edited": false, "score": 0, "creation_date": 1473282391, "post_id": 39378805, "comment_id": 66085925, "body": "also, the last line throws compilation error (char *)conv::data. Also (char *)conv throws error."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 996, "user_id": 6382969, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/6573906dc8d142351d2f6ec09fd942ce?s=128&d=identicon&r=PG&f=1", "display_name": "PHcoDer", "link": "https://stackoverflow.com/users/6382969/phcoder"}, "edited": false, "score": 0, "creation_date": 1473282452, "post_id": 39378805, "comment_id": 66085956, "body": "My mistake. I left off the <code>()</code> on <code>conv::data()</code>. Actually, I screwed it up bigtime. Should be <code>conv.data()</code>"}], "tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": false, "score": 4, "last_activity_date": 1473282393, "last_edit_date": 1473282393, "creation_date": 1473281521, "answer_id": 39378805, "question_id": 39378489, "link": "https://stackoverflow.com/questions/39378489/transfer-array-of-integers-over-a-socket-in-c-c/39378805#39378805", "title": "Transfer array of integers over a socket in C/C++", "body": "<p>This</p>\n\n<pre><code>char *data;\n</code></pre>\n\n<p>is not the same as </p>\n\n<pre><code>char *data = (char*)conv;\n</code></pre>\n\n<p>You have two <code>data</code>s, one inside the <code>for</code> loop which is assigned and one outside that is not so </p>\n\n<pre><code>return sendTill(sizeof(int32_t)*k, fd, data);\n</code></pre>\n\n<p>winds up sending the outer, uninitialized, <code>data</code>. Crom only knows what will happen.</p>\n\n<p>Fortunately, there is no point to doing</p>\n\n<pre><code>char *data = (char*)conv;\n</code></pre>\n\n<p>a few hundred times, so</p>\n\n<pre><code>return sendTill(sizeof(int32_t)*k, fd, (char*)conv);\n</code></pre>\n\n<p>looks like it will work. Sadly it won't in C++.</p>\n\n<pre><code>int32_t conv[k];\n</code></pre>\n\n<p>is invalid C++. <code>k</code> is not known at compile time, so this requires a non-standard Variable Length Array compiler extension. Some compilers will allow this syntax, but it has some downsides (common implementations easily overrun the stack and horribly messes with the behaviour of <code>sizeof</code>) and won't compile on all compilers. Really sucks if you need to port the code to other platforms or the code is being submitted to someone who will evaluate the code and uses, for example, Visual Studio.</p>\n\n<p>C++11 has <a href=\"http://en.cppreference.com/w/cpp/container/vector/data\" rel=\"nofollow\"><code>std::vector::data</code></a> so you can</p>\n\n<pre><code>bool sendKInt(int fd, int num[], int k){ // returns true on success\n    std::vector&lt;int32_t&gt; conv(k);\n    for (int i=0; i&lt;k; i++){\n        conv[i] = htonl(num[i]);\n    }\n    return sendTill(sizeof(int32_t)*k, fd, (char *)conv.data());\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 996, "user_id": 6382969, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/6573906dc8d142351d2f6ec09fd942ce?s=128&d=identicon&r=PG&f=1", "display_name": "PHcoDer", "link": "https://stackoverflow.com/users/6382969/phcoder"}, "edited": false, "score": 0, "creation_date": 1473282727, "post_id": 39378963, "comment_id": 66086084, "body": "Thanks!. Only edit needed would be use of calloc in receiveKInt. Right?"}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 996, "user_id": 6382969, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/6573906dc8d142351d2f6ec09fd942ce?s=128&d=identicon&r=PG&f=1", "display_name": "PHcoDer", "link": "https://stackoverflow.com/users/6382969/phcoder"}, "edited": false, "score": 0, "creation_date": 1473284337, "post_id": 39378963, "comment_id": 66086700, "body": "@PHcoDer the important thing is that data is initialized with allocated memory for the conversion to take place.  So no change of this pointer within the loop (second edit).  And no return with a function call as you need to free the allocated data before.   Oh !  I just notice that I forgot to return the value.  i&#39;ll edit"}], "tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": false, "score": 2, "last_activity_date": 1473284374, "last_edit_date": 1473284374, "creation_date": 1473282200, "answer_id": 39378963, "question_id": 39378489, "link": "https://stackoverflow.com/questions/39378489/transfer-array-of-integers-over-a-socket-in-c-c/39378963#39378963", "title": "Transfer array of integers over a socket in C/C++", "body": "<p><strong>Why it doesn't work</strong></p>\n\n<p>It is not clear if you intend from <code>sendKInt()</code>: </p>\n\n<ul>\n<li>to send all the data via <code>sendTill()</code>, as suggest by the parameter <code>sizeof(int32_t)*k</code> that you use in the call</li>\n<li>to send the data one by one, as your conversion loop converts only a single item</li>\n</ul>\n\n<p>In <code>sendKInt()</code> loop you have two very big mistakes:  </p>\n\n<ul>\n<li>you declare a bloc variable <code>char *data</code> in the loop.  This variable hides the outside variable with the same name, and its value is lost as soon as you exit the loop.  </li>\n<li>when you exit the loop you call <code>sendTill()</code> using the outside data variable which is still uninitialized.  This is undefined behavior guaranteed ! </li>\n<li>Note that even if you wouldn't hide the data variable it wouldn't work, because you cast the conv value (i.e. an integer to transmit) into a pointer to a character (e.g. if the interger is 0, you'll use a null poitner).  So you would try to send a rogue pointer, so certainly not the value that yo've expected.  </li>\n</ul>\n\n<p><strong>How to solve it</strong></p>\n\n<p>I assume C as you use <code>malloc()</code>.   </p>\n\n<pre><code>bool sendKInt(int fd, int num[], int k){ // returns true on success\n    int32_t *data = calloc (sizeof(int32_t), k);  // allocate for everything\n    if (data==NULL)                            // allocation failure\n        return 0;                               \n    for (int i=0; i&lt;k; i++){                   // convert everything \n        data[i] = htonl(num[i]);\n    }\n    bool rc = sendTill(sizeof(int32_t)*k, fd, (char*)data);\n    free(data);                               // malloc=&gt; free (or you'll leak memory) \n    return rc;                            // now that memory is freed, return the result\n}\n</code></pre>\n\n<p>Note that you have to review the rest of the code according to this new logic.  Don't forget to free memory that you allocate in a function in order to avoid memory leakage. </p>\n"}, {"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 3, "creation_date": 1473289455, "post_id": 39379670, "comment_id": 66088342, "body": "A few things that should be fixed in this answer. 1) Code only answers lead to <a href=\"https://en.wikipedia.org/wiki/Cargo_cult_programming\" rel=\"nofollow noreferrer\">Cargo Cult Programmers</a>. I recommend marking what you changed, why, and how it&#39;s better than what OP had. 2) Switches back and forth between C and C++ styles of programming. While most C code works just fine in C++, the reverse is not true and C in C++ often results in sub-optimal code. 3) <code>sendTill</code> does not <code>free</code> its <code>malloc</code>ed data."}], "tags": [], "owner": {"reputation": 431, "user_id": 5511758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cd20f798173e1b1ed60b0191d2f8b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Chor Sipahi", "link": "https://stackoverflow.com/users/5511758/chor-sipahi"}, "is_accepted": true, "score": 0, "last_activity_date": 1473285683, "creation_date": 1473285683, "answer_id": 39379670, "question_id": 39378489, "link": "https://stackoverflow.com/questions/39378489/transfer-array-of-integers-over-a-socket-in-c-c/39379670#39379670", "title": "Transfer array of integers over a socket in C/C++", "body": "<p>A nicely working code:</p>\n\n<pre><code>bool sendKInt(int fd, int num[], int k){ // returns true on success\n    std::vector&lt;int32_t&gt; conv(k);\n    for (int i=0; i&lt;k; i++){\n        conv[i] = htonl(num[i]);\n    }\n    return sendTill(sizeof(int32_t)*k, fd, (char *)conv.data());\n}\n\nbool receiveKInt(int fd, int *num, int k){ // returns true on success\n    int32_t *ret = (int32_t*)calloc (sizeof(int32_t), k);\n    bool toReturn = receiveTill(sizeof(int32_t)*k,fd,(char*)ret);\n    for (int i=0; i&lt;k; i++){\n        num[i] = ntohl(ret[i]);\n    }\n    free(ret);\n    return toReturn;\n}\n\nbool sendTill(int size, int fd, char* dataU){ // dataU - dataUser pointer is NULL then create your own buffer and send random thing // returns true on successs\n    char *data;\n    int left = size;\n    int rc;\n    if(dataU == NULL){\n        data = (char*)malloc(size);\n    }else{\n        data = dataU;\n    }\n    while (left) {\n        rc = write(fd, data + size - left, left);\n        if (rc &lt; 0){\n            cout &lt;&lt;\"-1 in sendTill \\n\";\n            return false;\n        }\n        left -= rc;\n    }\n    return true;\n}\n\nbool receiveTill(int size, int fd, char* data){ // just give a char pointer after allocating size // returns true on success\n    int ret;\n    int left = size;\n    while (left) {\n        ret = read(fd, data + size - left, left);\n        if (ret &lt; 0){\n            cout &lt;&lt;\"-1 in receiveTill \\n\";\n            return false;\n        }\n        left -= ret;\n    }\n    return true;\n}\n</code></pre>\n"}], "owner": {"reputation": 996, "user_id": 6382969, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/6573906dc8d142351d2f6ec09fd942ce?s=128&d=identicon&r=PG&f=1", "display_name": "PHcoDer", "link": "https://stackoverflow.com/users/6382969/phcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "accepted_answer_id": 39379670, "answer_count": 4, "score": 2, "last_activity_date": 1473285683, "creation_date": 1473280184, "last_edit_date": 1495535351, "question_id": 39378489, "link": "https://stackoverflow.com/questions/39378489/transfer-array-of-integers-over-a-socket-in-c-c", "title": "Transfer array of integers over a socket in C/C++", "body": "<p><a href=\"https://stackoverflow.com/questions/9140409/transfer-integer-over-a-socket-in-c\">This</a> answer shows methods for sending and receiving integers over sockets in c/c++. Based on that I wrote following two functions, sendKInt and receiveKInt to send and receive K integers. But its not working correctly. Maybe my pointer arithmetic is wrong, but I cannot find the error. Please help with that, I am new to c++. Also see sendTill and receiveTill functions.</p>\n\n<pre><code>bool sendKInt(int fd, int num[], int k){ // returns true on success\n    int32_t conv[k];\n    char *data;\n    for (int i=0; i&lt;k; i++){\n        conv[i] = htonl(num[i]);\n        char *data = (char*)conv;\n    }\n    return sendTill(sizeof(int32_t)*k, fd, data);\n}\n\nbool receiveKInt(int fd, int *num, int k){ // returns true on success\n    int32_t ret[k];\n    int toReturn = receiveTill(sizeof(int32_t)*k,fd,(char*)ret);\n    for (int i=0; i&lt;k; i++){\n        num[i] = ntohl(ret[i]);\n    }\n    return toReturn;\n}\n\nbool sendTill(int size, int fd, char* dataU){ // dataU - dataUser pointer is NULL then create your own buffer and send random thing // returns true on successs\n    char *data;\n    int left = size;\n    int rc;\n    if(dataU == NULL){\n        data = (char*)malloc(size);\n    }else{\n        data = dataU;\n    }\n    while (left) {\n        rc = write(fd, data + size - left, left);\n        if (rc &lt; 0){\n            cout &lt;&lt;\"-1 in sendTill \\n\";\n            return false;\n        }\n        left -= rc;\n    }\n    return true;\n}\n\nbool receiveTill(int size, int fd, char* data){ // just give a char pointer after allocating size // returns true on success\n    int ret;\n    int left = size;\n    while (left) {\n        ret = read(fd, data + size - left, left);\n        if (ret &lt; 0){\n            cout &lt;&lt;\"-1 in receiveTill \\n\";\n            return false;\n        }\n        left -= ret;\n    }\n    return true;\n}\n</code></pre>\n"}, {"tags": ["c++", "qt", "listview", "qml"], "comments": [{"owner": {"reputation": 21247, "user_id": 904422, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/55cf313c546e7c5aa1aeefae0e772c53?s=128&d=identicon&r=PG", "display_name": "Mitch", "link": "https://stackoverflow.com/users/904422/mitch"}, "edited": false, "score": 0, "creation_date": 1473314687, "post_id": 39378449, "comment_id": 66094342, "body": "I get an error when I run your example: <code>file:&#47;&#47;&#47;tmp&#47;untitled3&#47;main.qml:9: TypeError: Cannot read property of null</code> Please post a complete, minimal example. I&#39;m guessing this code was taken out of a larger piece of code, and hence the parent it&#39;s referring to is the window?"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 6791790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669e688dca5d2c77d169621355b591c7?s=128&d=identicon&r=PG&f=1", "display_name": "Magnus2552", "link": "https://stackoverflow.com/users/6791790/magnus2552"}, "edited": false, "score": 0, "creation_date": 1473346933, "post_id": 39384240, "comment_id": 66114762, "body": "Thank you very much, you are an angel! :D however, it is not completely working, whenever I choose a color, it does not change the rectangles color, but instead it generates this error message: qml: You chose: #fdfdfd QCoreApplication::postEvent: Unexpected null receiver Any idea on how to fix this? Also you have to add newDialog.visible = true after the connect to show the dialog"}, {"owner": {"reputation": 77, "user_id": 6791790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669e688dca5d2c77d169621355b591c7?s=128&d=identicon&r=PG&f=1", "display_name": "Magnus2552", "link": "https://stackoverflow.com/users/6791790/magnus2552"}, "edited": false, "score": 0, "creation_date": 1473369865, "post_id": 39384240, "comment_id": 66126882, "body": "Ok, now the color dialog itself works fine, however when I choose a color, it doesn&#39;t change it in the rectangle. Do i have to invoke any method to tell Qt that the rectangle&#39;s color is dirty?"}, {"owner": {"reputation": 77, "user_id": 6791790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669e688dca5d2c77d169621355b591c7?s=128&d=identicon&r=PG&f=1", "display_name": "Magnus2552", "link": "https://stackoverflow.com/users/6791790/magnus2552"}, "edited": false, "score": 0, "creation_date": 1473370821, "post_id": 39384240, "comment_id": 66127297, "body": "I added while Debugging these lines:     console.log(newColor);                 playerListViewModel.get(index).playerColor = newColor;                 console.log(playerListViewModel.get(index).playerColor); Now I don&#39;t understand anything anymore: In the console it says: qml: #193ca2 qml: red So it just ignores the line setting the color?"}, {"owner": {"reputation": 77, "user_id": 6791790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669e688dca5d2c77d169621355b591c7?s=128&d=identicon&r=PG&f=1", "display_name": "Magnus2552", "link": "https://stackoverflow.com/users/6791790/magnus2552"}, "edited": false, "score": 0, "creation_date": 1473409712, "post_id": 39384240, "comment_id": 66139172, "body": "I tried both and it did not work. The problem seems not to be in the ColorDialog, but in the function changeColor(). As I said I added these lines to the function: <code>function changeColor(newColor) {                 console.log(newColor);                 playerListViewModel.get(index).playerColor = newColor;                 console.log(playerListViewModel.get(index).playerColor);</code>, the first log reports that the function got the correct color. Then we set playerColor and report playerColor afterwards, but playerColor is red although we set it to something else the line before"}, {"owner": {"reputation": 77, "user_id": 6791790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669e688dca5d2c77d169621355b591c7?s=128&d=identicon&r=PG&f=1", "display_name": "Magnus2552", "link": "https://stackoverflow.com/users/6791790/magnus2552"}, "edited": false, "score": 0, "creation_date": 1473409900, "post_id": 39384240, "comment_id": 66139275, "body": "Here is a full console.log: <code>qml: You chose: #2c07b3 qml: newColor=#2c07b3 qml: After setting playerColor = newColor, playerColor=red</code> As you see the = operator does not seem to work anymore, because playerColor is still red although setting it to #2c07b3. This bug is really making me nervous now, how can QML just ignore the = operator?"}, {"owner": {"reputation": 77, "user_id": 6791790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669e688dca5d2c77d169621355b591c7?s=128&d=identicon&r=PG&f=1", "display_name": "Magnus2552", "link": "https://stackoverflow.com/users/6791790/magnus2552"}, "edited": false, "score": 0, "creation_date": 1473509903, "post_id": 39384240, "comment_id": 66175867, "body": "I don&#39;t quite understand your second thought. (The first one alone did not change anything) When I try what I think you mean, it says: Component objects cannot declare new properties."}, {"owner": {"reputation": 1936, "user_id": 4322884, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007767376821/picture?type=large", "display_name": "mike510a", "link": "https://stackoverflow.com/users/4322884/mike510a"}, "reply_to_user": {"reputation": 77, "user_id": 6791790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669e688dca5d2c77d169621355b591c7?s=128&d=identicon&r=PG&f=1", "display_name": "Magnus2552", "link": "https://stackoverflow.com/users/6791790/magnus2552"}, "edited": false, "score": 0, "creation_date": 1473624495, "post_id": 39384240, "comment_id": 66202700, "body": "I think I found something that will work for you. I edited my answer to include it"}, {"owner": {"reputation": 1936, "user_id": 4322884, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007767376821/picture?type=large", "display_name": "mike510a", "link": "https://stackoverflow.com/users/4322884/mike510a"}, "reply_to_user": {"reputation": 77, "user_id": 6791790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669e688dca5d2c77d169621355b591c7?s=128&d=identicon&r=PG&f=1", "display_name": "Magnus2552", "link": "https://stackoverflow.com/users/6791790/magnus2552"}, "edited": false, "score": 0, "creation_date": 1473825922, "post_id": 39384240, "comment_id": 66283385, "body": "Just happy to help"}], "tags": [], "owner": {"reputation": 1936, "user_id": 4322884, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007767376821/picture?type=large", "display_name": "mike510a", "link": "https://stackoverflow.com/users/4322884/mike510a"}, "is_accepted": true, "score": 0, "last_activity_date": 1473626526, "last_edit_date": 1473626526, "creation_date": 1473317104, "answer_id": 39384240, "question_id": 39378449, "link": "https://stackoverflow.com/questions/39378449/qml-how-to-dynamically-access-listview-items/39384240#39384240", "title": "QML How to dynamically access ListView items", "body": "<p>Here is a sure fire way to make a working colorDialog --</p>\n\n<h3> in playerDelegate </h3>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code> Component {\r\n   id: playerDelegate\r\n   Item {\r\n     anchors.left: parent.left\r\n     anchors.right: parent.right\r\n     height: 50\r\n     Column {\r\n       Text {\r\n         text: '&lt;b&gt;Name:&lt;/b&gt; ' + name\r\n       }\r\n\r\n      /* Object to store value from color selector */\r\n       Item {\r\n         id: colorSelector\r\n\r\n\r\n           property color color: \"#000000\"\r\n           onColorChanged: { playerColor = color; }\r\n\r\n       }\r\n/* box to display color */\r\n       Rectangle {\r\n\r\n         //Layout.fillWidth: true\r\n         height: 120\r\n         width: 120\r\n         anchors.left: button.right\r\n           //Layout.alignment: Qt.AlignHCenter\r\n         color: colorSelector.color\r\n         border.width: 1\r\n         border.color: \"#000000\"\r\n\r\n       }\r\n/* button to open dialog -- can be mousearea or other clickable object */\r\n\r\n       Button {\r\n         id: button\r\n         text: \"Browse...\"\r\n         onClicked: {\r\n           colorDialog.color = colorSelector.color\r\n           colorDialog.open()\r\n         }\r\n       }\r\n\r\n/* actual color dialog for this delegate */\r\n\r\n\r\n\r\n\r\n       ColorDialog {\r\n         id: colorDialog\r\n         modality: Qt.ApplicationModal\r\n         title: \"Please choose a color\"\r\n         onAccepted: colorSelector.color = currentColor\r\n       }\r\n     }\r\n   }\r\n }\r\n </code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><br><br>\n<hr>\n<br></p>\n"}], "owner": {"reputation": 77, "user_id": 6791790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669e688dca5d2c77d169621355b591c7?s=128&d=identicon&r=PG&f=1", "display_name": "Magnus2552", "link": "https://stackoverflow.com/users/6791790/magnus2552"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1044, "favorite_count": 0, "accepted_answer_id": 39384240, "answer_count": 1, "score": 1, "last_activity_date": 1473626526, "creation_date": 1473279999, "last_edit_date": 1473301603, "question_id": 39378449, "link": "https://stackoverflow.com/questions/39378449/qml-how-to-dynamically-access-listview-items", "title": "QML How to dynamically access ListView items", "body": "<p>I have a ListView which has dynamically added Items, and what I kinda want to know is how I could access items for example by index. Specifically, I want to have the color of the item rectangle change when I change the color using the Color Dialog. I guessed it should be maybe possible to first set a variable to the current item before calling the color dialog and then in the onAccepted method change the color of that item using the variable, but I don't know how to achieve anything of this in QML, because I am rather new to QML. Maybe you can offer even a cleaner way to change the color of the item's rectangle when the color dialog was closed (onAccepted). Thx for any help! :)</p>\n\n<pre><code>import QtQuick 2.0\nimport QtQuick.Window 2.2\nimport QtQuick.Controls 1.4\nimport QtQuick.Dialogs 1.2\nimport QtQuick.Controls.Styles 1.4\n\nRectangle {\n    id: listViewContainer\n    width: parent.width/10*9;\n    height: 50\n    Behavior on height {\n        NumberAnimation {\n            duration: 100;\n        }\n    }\n\n    gradient: Gradient {\n        GradientStop {position: 0.0; color: \"white\" }\n        GradientStop {position: 1.0; color: \"silver\" }\n    }\n    radius: 5\n    ColorDialog {\n        id: colorDialog\n        title: \"Please choose a color\"\n        onAccepted: {\n            console.log(\"You chose: \" + colorDialog.color)\n            Qt.quit()\n        }\n        onRejected: {\n            console.log(\"Canceled\")\n            Qt.quit()\n        }\n    }\n\n    Component {\n        id: playerDelegate\n        Item {\n            anchors.left: parent.left\n            anchors.right: parent.right\n            height: 50\n            Column {\n                Text { text: '&lt;b&gt;Name:&lt;/b&gt; ' + name }\n                Row {\n                    MouseArea {\n                        width: 20\n                        height: 20\n                        onClicked: {\n                            colorDialog.visible = true;\n                            playerColor = colorDialog.color;\n                            //open color dialog\n                        }\n\n                        Rectangle {\n                            radius: 3\n                            anchors.fill: parent\n                            color: playerColor\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    ListView {\n        id: playerListView\n        anchors.fill: parent\n        model:\n            ListModel {\n                id: playerListViewModel;\n                ListElement {\n                    name: \"Bill Smith\"\n                    playerColor: \"red\"\n                }\n        }\n        delegate: playerDelegate\n    }\n    Button {\n        id: addPlayerButton\n        anchors.top: playerListView.bottom\n        anchors.left: playerListView.left\n        anchors.right: playerListView.right\n        style: ButtonStyle {\n            label: Text {\n                text: \"Add new player\"\n                horizontalAlignment: Text.Center\n            }\n        }\n        onClicked: {\n            root.addnewPlayer(playerListView); //dont worry about this method\n            playerListViewModel.append({name: \"Billy\", playerColor: \"blue\"});\n            listViewContainer.height += 50;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "macos", "qt"], "comments": [{"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 3, "creation_date": 1473279358, "post_id": 39378276, "comment_id": 66084584, "body": "As a user, I would not be too happy about this. When I close some application, I want it to be closed."}, {"owner": {"reputation": 511, "user_id": 4415245, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dF1bj.jpg?s=128&g=1", "display_name": "Flare Cat", "link": "https://stackoverflow.com/users/4415245/flare-cat"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1473279699, "post_id": 39378276, "comment_id": 66084719, "body": "@BaummitAugen I am aware of that. The issue is that if it is in the middle of a cleanup process after a cancellation, and the user quits it, then the cleanup process would not have finished."}, {"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "edited": false, "score": 3, "creation_date": 1473280001, "post_id": 39378276, "comment_id": 66084871, "body": "A thread cannot exist without an application. In your case the application should wait for the cleanup thread to finish working (using <code>join</code>)."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 2, "creation_date": 1473280029, "post_id": 39378276, "comment_id": 66084884, "body": "So catch the termination signal instead. If the user force-kills your app with some uncatchable signal, any data loss is their own fault."}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1473340288, "post_id": 39378276, "comment_id": 66109841, "body": "This smells of an <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a>. Please edit the question to remove irrelevant implementation details that presume a particular solution. You don&#39;t care about any threads. All you want is for some code to run after the user has Quit (\u2318-Q) the application, and for the dock icon/menubar to disappear as expected. Thus: ask for what you really want."}], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 4415245, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dF1bj.jpg?s=128&g=1", "display_name": "Flare Cat", "link": "https://stackoverflow.com/users/4415245/flare-cat"}, "edited": false, "score": 0, "creation_date": 1473280737, "post_id": 39378454, "comment_id": 66085159, "body": "Thank you. In the documentation, one argument for calling <code>QProcess::startDetached</code> is <code>const QString &amp; program</code>. What exactly would that string contain?"}, {"owner": {"reputation": 1438, "user_id": 3732337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LzGs.jpg?s=128&g=1", "display_name": "HazemGomaa", "link": "https://stackoverflow.com/users/3732337/hazemgomaa"}, "reply_to_user": {"reputation": 511, "user_id": 4415245, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dF1bj.jpg?s=128&g=1", "display_name": "Flare Cat", "link": "https://stackoverflow.com/users/4415245/flare-cat"}, "edited": false, "score": 1, "creation_date": 1473280922, "post_id": 39378454, "comment_id": 66085240, "body": "check this out <a href=\"http://stackoverflow.com/questions/4185388/qt-qprocess-is-not-working\" title=\"qt qprocess is not working\">stackoverflow.com/questions/4185388/qt-qprocess-is-not-worki&zwnj;&#8203;ng</a>"}, {"owner": {"reputation": 511, "user_id": 4415245, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dF1bj.jpg?s=128&g=1", "display_name": "Flare Cat", "link": "https://stackoverflow.com/users/4415245/flare-cat"}, "edited": false, "score": 1, "creation_date": 1473280998, "post_id": 39378454, "comment_id": 66085271, "body": "Ahh, thank you. Will try this out when I get a chance, and will report how it worked in my app."}, {"owner": {"reputation": 1438, "user_id": 3732337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LzGs.jpg?s=128&g=1", "display_name": "HazemGomaa", "link": "https://stackoverflow.com/users/3732337/hazemgomaa"}, "reply_to_user": {"reputation": 511, "user_id": 4415245, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dF1bj.jpg?s=128&g=1", "display_name": "Flare Cat", "link": "https://stackoverflow.com/users/4415245/flare-cat"}, "edited": false, "score": 1, "creation_date": 1473281014, "post_id": 39378454, "comment_id": 66085282, "body": "The 1st argument is the path to your app, and 2nd (optional) is the list of the arguments .."}, {"owner": {"reputation": 1438, "user_id": 3732337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LzGs.jpg?s=128&g=1", "display_name": "HazemGomaa", "link": "https://stackoverflow.com/users/3732337/hazemgomaa"}, "reply_to_user": {"reputation": 511, "user_id": 4415245, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dF1bj.jpg?s=128&g=1", "display_name": "Flare Cat", "link": "https://stackoverflow.com/users/4415245/flare-cat"}, "edited": false, "score": 0, "creation_date": 1473281125, "post_id": 39378454, "comment_id": 66085344, "body": "you welcome, also find more examples here <a href=\"http://www.qtcentre.org/threads/61261-Qt-start-new-application-and-quit\" rel=\"nofollow noreferrer\">qtcentre.org/threads/61261-Qt-start-new-application-and-quit</a>"}], "tags": [], "owner": {"reputation": 1438, "user_id": 3732337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LzGs.jpg?s=128&g=1", "display_name": "HazemGomaa", "link": "https://stackoverflow.com/users/3732337/hazemgomaa"}, "is_accepted": true, "score": 3, "last_activity_date": 1473346523, "last_edit_date": 1592644375, "creation_date": 1473280022, "answer_id": 39378454, "question_id": 39378276, "link": "https://stackoverflow.com/questions/39378276/how-to-start-a-thread-that-doesnt-close-on-application-quit-qt-c/39378454#39378454", "title": "How to start a thread that doesn&#39;t close on application quit? (Qt C++)", "body": "<p>it's possible to achieve your goal by initiating a new process via QProcess::startDetached, as per documents <a href=\"http://doc.qt.io/qt-4.8/qprocess.html#startDetached\" rel=\"nofollow noreferrer\">http://doc.qt.io/qt-4.8/qprocess.html#startDetached</a></p>\n<blockquote>\n<p>Starts the program program with the arguments arguments in a new process, and detaches from it. Returns true on success; otherwise returns false. <strong>If the calling process exits, the detached process will continue to live</strong>.</p>\n<p>Unix: The started process will run in its own session and act like a daemon.</p>\n</blockquote>\n<p><strong>Edit:</strong></p>\n<p>Here is an example for MacOS</p>\n<pre><code>// run start script\nQString scriptPath = &quot;path-to-start-script/start.sh&quot; ;\nQString cmd = &quot;open -a &quot; + scriptPath;\nQProcess::startDetached(cmd);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 511, "user_id": 4415245, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dF1bj.jpg?s=128&g=1", "display_name": "Flare Cat", "link": "https://stackoverflow.com/users/4415245/flare-cat"}, "edited": false, "score": 0, "creation_date": 1473280123, "post_id": 39378464, "comment_id": 66084929, "body": "And how would I spawn an independent process in Qt?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 511, "user_id": 4415245, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dF1bj.jpg?s=128&g=1", "display_name": "Flare Cat", "link": "https://stackoverflow.com/users/4415245/flare-cat"}, "edited": false, "score": 1, "creation_date": 1473280343, "post_id": 39378464, "comment_id": 66085019, "body": "@Flare Cat - look up <code>QProcess</code>."}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": false, "score": 2, "last_activity_date": 1473280071, "creation_date": 1473280071, "answer_id": 39378464, "question_id": 39378276, "link": "https://stackoverflow.com/questions/39378276/how-to-start-a-thread-that-doesnt-close-on-application-quit-qt-c/39378464#39378464", "title": "How to start a thread that doesn&#39;t close on application quit? (Qt C++)", "body": "<p>When you terminate a process, all threads within that process die - the process is the thread \"container\". If you want to spawn something that lives on beyond your current process, then spawn a new independant process.</p>\n"}, {"comments": [{"owner": {"reputation": 1438, "user_id": 3732337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LzGs.jpg?s=128&g=1", "display_name": "HazemGomaa", "link": "https://stackoverflow.com/users/3732337/hazemgomaa"}, "edited": false, "score": 0, "creation_date": 1473341006, "post_id": 39378475, "comment_id": 66110339, "body": "How&#39;s your code is related to the question, or to your answer ? You are not using Qt and your main{} is empty !  ..."}, {"owner": {"reputation": 392, "user_id": 5860608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jam4D.png?s=128&g=1", "display_name": "pPanda_beta", "link": "https://stackoverflow.com/users/5860608/ppanda-beta"}, "reply_to_user": {"reputation": 1438, "user_id": 3732337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LzGs.jpg?s=128&g=1", "display_name": "HazemGomaa", "link": "https://stackoverflow.com/users/3732337/hazemgomaa"}, "edited": false, "score": 0, "creation_date": 1473360987, "post_id": 39378475, "comment_id": 66122554, "body": "No no no  U r free to write anything in main  This piece of code should be placed in &quot;main.cpp&quot; just right after #include &lt;QApplication&gt;  Or you can place that singleton_obj any where but either in global scope or in static storage class..."}], "tags": [], "owner": {"reputation": 392, "user_id": 5860608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jam4D.png?s=128&g=1", "display_name": "pPanda_beta", "link": "https://stackoverflow.com/users/5860608/ppanda-beta"}, "is_accepted": false, "score": -1, "last_activity_date": 1473361074, "last_edit_date": 1473361074, "creation_date": 1473280125, "answer_id": 39378475, "question_id": 39378276, "link": "https://stackoverflow.com/questions/39378276/how-to-start-a-thread-that-doesnt-close-on-application-quit-qt-c/39378475#39378475", "title": "How to start a thread that doesn&#39;t close on application quit? (Qt C++)", "body": "<p>If u mean closing of Gui window by \"Application Close\" then it  can be done easily...</p>\n\n<pre><code>#include \"MainWindow.h\"\n#include &lt;QApplication&gt;\n\n//////////////////////////////////////\n#include &lt;thread&gt;\nstruct blabla {\n    std::thread th;\n    blabla():th([]{\n        // body of your thread  \n    }) {}\n    ~blabla(){\n        if(th.joinable())\n            th.join();\n    }   \n} singleton_obj;\n/////////////////////////////////////\n\nint main(int argc, char *argv[])\n{\n    QApplication a(argc, argv);\n    MainWindow w;\n    w.show();\n\n    return a.exec();\n}\n</code></pre>\n\n<p>Now the applicaton window will quit but the daemon thread will run n background...\nEnjoy</p>\n"}, {"tags": [], "owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1473340570, "last_edit_date": 1495541962, "creation_date": 1473340175, "answer_id": 39391862, "question_id": 39378276, "link": "https://stackoverflow.com/questions/39378276/how-to-start-a-thread-that-doesnt-close-on-application-quit-qt-c/39391862#39391862", "title": "How to start a thread that doesn&#39;t close on application quit? (Qt C++)", "body": "<p>If your user force-quits the application, that usually means that they want to control the energy or resource expenditure on their system. Thinking that you know better than the user would be rather in the user's face. Don't anger your users :)</p>\n\n<p>All you really want is:</p>\n\n<ol>\n<li>For the process to survive quitting it through normal means (pressing \u2318-Q, selecting Quit from the menu, closing the last window, etc.).</li>\n<li>For the dock icon to disappear after the GUI has been quit, as is the normal and expected behavior.</li>\n<li>For a cleanup code to run after the GUI has vanished.</li>\n</ol>\n\n<p>To that effect, you only need to <a href=\"https://stackoverflow.com/q/620841/1329652\">hide the dock icon/menubar</a> and then perform the cleanup:</p>\n\n<h3>main.mm</h3>\n\n<pre><code>// https://github.com/KubaO/stackoverflown/tree/master/questions/hidedock-39378276\n#include &lt;QtWidgets&gt;\n#include &lt;AppKit/AppKit.h&gt;\n\nvoid hideDockIcon() {\n    [NSApp setActivationPolicy: NSApplicationActivationPolicyProhibited];\n}\n\nint main(int argc, char ** argv) {\n    QApplication app{argc, argv};\n    QLabel label{\"Quit Me\"};\n    label.setMinimumSize(200, 100);\n    label.show();\n    int rc = app.exec();\n    hideDockIcon();\n    qDebug() &lt;&lt; \"cleaning up\";\n    QThread::sleep(5);\n    qDebug() &lt;&lt; \"cleanup finished\";\n    return rc;\n}\n</code></pre>\n\n<h3>hidedock-39378276.pro</h3>\n\n<pre><code>QT = widgets\nCONFIG += c++11\nTARGET = hidedock-39378276\nTEMPLATE = app\nOBJECTIVE_SOURCES += main.mm\nLIBS += -framework AppKit\n</code></pre>\n"}], "owner": {"reputation": 511, "user_id": 4415245, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dF1bj.jpg?s=128&g=1", "display_name": "Flare Cat", "link": "https://stackoverflow.com/users/4415245/flare-cat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 0, "accepted_answer_id": 39378454, "answer_count": 4, "score": 2, "last_activity_date": 1473361074, "creation_date": 1473279209, "last_edit_date": 1473340435, "question_id": 39378276, "link": "https://stackoverflow.com/questions/39378276/how-to-start-a-thread-that-doesnt-close-on-application-quit-qt-c", "title": "How to start a thread that doesn&#39;t close on application quit? (Qt C++)", "body": "<p>I'm making an application for Mac OS X in Qt, and wanted to spawn a thread that doesn't close on application close.</p>\n\n<p>Is this possible? If so, how? I don't want the process to be stopped if a user force quits the application.</p>\n\n<p>Thanks in advance.</p>\n\n<p>Note: If this is not possible, is there any way I can make this happen? (Maybe with calling a command in bash?)</p>\n"}, {"tags": ["c++", "c++11", "typedef", "stdmap", "stdtuple"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473282402, "post_id": 39378254, "comment_id": 66085929, "body": "The error you have included looks to be related to an instance of <code>RequestStatus</code> not <code>requestStatistics</code>.  Please edit your question to contain a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": false, "score": 1, "last_activity_date": 1473294891, "creation_date": 1473294891, "answer_id": 39380908, "question_id": 39378254, "link": "https://stackoverflow.com/questions/39378254/error-assigning-values-to-the-nested-map-with-tuple-as-its-value/39380908#39380908", "title": "Error assigning values to the nested map with tuple as its value", "body": "<p>The last parameter in your <code>insert</code> or <code>make_tuple</code> calls is <code>sampleStatus[functionName][status::READY]=1</code>, which is an <code>int</code>, while the tuple is expecting a <code>RequestStatus</code>.  This type difference would be the cause of your error.</p>\n"}], "owner": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473294891, "creation_date": 1473279125, "last_edit_date": 1473291161, "question_id": 39378254, "link": "https://stackoverflow.com/questions/39378254/error-assigning-values-to-the-nested-map-with-tuple-as-its-value", "title": "Error assigning values to the nested map with tuple as its value", "body": "<p>I been maintaining some statistics in a map, the below are my typedefs to create the map</p>\n\n<pre><code>typedef Time TOTALTIME,MINM,MAXM,AVRG;\ntypedef std::map&lt;std::string,std::map&lt;status,int&gt;&gt; RequestStatus;//status is an enum\ntypedef std::tuple&lt;int,TOTALTIME,MINM,MAXM,AVRG,RequestStatus&gt; Attributes ;\ntypedef std::map&lt;std::string,Attributes&gt; requestStatistics ;\n</code></pre>\n\n<p><code>requestStatistics sampleStruct</code>  //my final map</p>\n\n<p>And i have been initializing like </p>\n\n<pre><code>sampleStruct.insert(make_pair(someskey,std::make_tuple(1,TOTALTIME(),MINM(),MAXM(),AVRG(),sampleStatus[functionName][status::READY]=1)));\n</code></pre>\n\n<p>other way I have tried</p>\n\n<pre><code>sampleStruct[somekey]=std::make_tuple(1,TOTALTIME(),MINM(),MAXM(),AVRG(),sampleStatus[functionName][status::READY]=1)\n</code></pre>\n\n<p>Both doesn't pass the compiler always endup in compile error, lemme put out some compile error I,ve got</p>\n\n<pre><code>     std::map&lt;endstor::Data::statistics::status, int, std::less&lt;endstor::Data::statistics::status&gt;, std::allocator&lt;std::pair&lt;const endstor::Data::statistics::status, int&gt; &gt; &gt;,\nstd::less&lt;std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt;, std::allocator&lt;std::pair&lt;const std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::map&lt;endstor::Data::statistics::status, int, std::less&lt;endstor::Data::statistics::status&gt;, std::allocator&lt;std::pair&lt;const endstor::Data::statistics::status, int&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;]\n             insert(const_iterator __position, _Pair&amp;&amp; __x)\n</code></pre>\n\n<p>1)was the structure I've created is valid?were the assignments are ok?</p>\n"}, {"tags": ["c++", "point-cloud-library"], "answers": [{"tags": [], "owner": {"reputation": 1101, "user_id": 1525865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71694cac93edcd9f6757139a9af32939?s=128&d=identicon&r=PG", "display_name": "taketwo", "link": "https://stackoverflow.com/users/1525865/taketwo"}, "is_accepted": true, "score": 3, "last_activity_date": 1473315816, "creation_date": 1473315816, "answer_id": 39383856, "question_id": 39378086, "link": "https://stackoverflow.com/questions/39378086/number-of-points-in-a-unorganised-point-cloud/39383856#39383856", "title": "Number of points in a unorganised point cloud", "body": "<p>The number of points in a PCL point cloud is equal to the product of its width and height. By definition, an unorganized point cloud has height equal to 1. Therefore width is indeed equal to the number of points.</p>\n\n<p>However, I would recommend using the <code>size()</code> function. It returns the number of points regardless of the type (organized/unorganized) and has clear semantics.</p>\n\n<pre><code>size_t num_points = cloud_z-&gt;size();  \n</code></pre>\n"}], "owner": {"reputation": 1479, "user_id": 1414831, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/63346ad40db38cf3a54e84403099e91e?s=128&d=identicon&r=PG", "display_name": "kungphil", "link": "https://stackoverflow.com/users/1414831/kungphil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3138, "favorite_count": 0, "accepted_answer_id": 39383856, "answer_count": 1, "score": 0, "last_activity_date": 1473315816, "creation_date": 1473278330, "question_id": 39378086, "link": "https://stackoverflow.com/questions/39378086/number-of-points-in-a-unorganised-point-cloud", "title": "Number of points in a unorganised point cloud", "body": "<p>I would like to know the number of points in a point cloud using PCL. The point cloud is created using <code>pcl::PointCloud&lt;pcl::PointXYZ&gt;::Ptr cloud_z(new pcl::PointCloud&lt;pcl::PointXYZ&gt;);</code>. This is then populated using a filter which basically creates a subset from a larger point cloud. The point cloud is unorganised.</p>\n\n<p>I am guessing I need to return the <code>width</code>, but can't figure out how to do this. Sure this is an easy answer but I am new to c++ and PCL.</p>\n"}, {"tags": ["c++", "opencv", "vector", "mergesort"], "answers": [{"tags": [], "owner": {"reputation": 3510, "user_id": 4128833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/079bb7879c594630684e2c9ed4ecad7e?s=128&d=identicon&r=PG", "display_name": "paul-g", "link": "https://stackoverflow.com/users/4128833/paul-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1473281154, "creation_date": 1473281154, "answer_id": 39378720, "question_id": 39378031, "link": "https://stackoverflow.com/questions/39378031/mergesort-vector-c-opencv/39378720#39378720", "title": "mergesort vector c+ opencv", "body": "<p>You should achieve this by providing a custom comparator to the <code>std::sort</code> function, not by rewriting it. Something along the lines of:</p>\n\n<pre><code>struct PointCmp {  \n    Mat* d;\n    PointCmp(Mat* _d): d(_d) {} \n\n    inline bool operator() (const Point&amp; p1, const Point&amp; p2) {\n        return d-&gt;at&lt;int&gt;(p1.x, p1.y) &lt; d-&gt;at&lt;int&gt;(p2.x, p2.y);\n    }\n};\n\nint main() {\n   // other stuff\n   std::vector&lt;Point&gt; v;    \n   Mat d(2, 2);\n   std::sort(v.begin(), v.end(), PointCmp(&amp;d));\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6790526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daebe2549bf232bad78be6a3801b3f12?s=128&d=identicon&r=PG&f=1", "display_name": "kiaka", "link": "https://stackoverflow.com/users/6790526/kiaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 39378720, "answer_count": 1, "score": 0, "last_activity_date": 1473283069, "creation_date": 1473278006, "last_edit_date": 1473283069, "question_id": 39378031, "link": "https://stackoverflow.com/questions/39378031/mergesort-vector-c-opencv", "title": "mergesort vector c+ opencv", "body": "<p>I need to order a vector of the coordinates for points not present but to the value obtained by pointing the coordinate in a matrix. For example </p>\n\n<pre><code>vector &lt; Point &gt; // v has two coordinates within\nMat D ( 2,2 ) ;\nint a = v [ 0 ] .x ;\nint b = v [ 0 ] .y ;\nint c = v [ 1 ] .x ;\nint d = v [ 1 ] .y ;\nif ( D.at &lt; int &gt; ( a, b) &lt;  D.at&lt;int&gt; ( c, d ) )\n// Sort in ascending order\n</code></pre>\n\n<p>I tried to use mergesort with the appropriate changes to search \" the coordinate values \u200b\u200b\":</p>\n\n<pre><code>void work::merge(vector&lt;cv::Point&gt;&amp; Q1, int low, int high, int mid, Mat &amp; Densita)\n{\n    cout &lt;&lt; \"merge\" &lt;&lt; endl;\n    int i, j, k;\n    vector&lt;cv::Point&gt; c;\n    i = low;\n    k = low;\n    j = mid + 1;\n    while (i &lt;= mid &amp;&amp; j &lt;= high)\n    {\n        cout &lt;&lt; \"-\" &lt;&lt; endl;\n        int X = Q1[i].x;\n        int Y = Q1[i].y;\n        int W = Q1[j].x;\n        int Q = Q1[j].y;\n        int a = Densita.at&lt;int&gt;(X, Y);\n        int b = Densita.at&lt;int&gt;(W,Q);\n        if (a &lt; b)\n        {   \n            cout &lt;&lt; \"min\" &lt;&lt; endl;\n            c.push_back(cv::Point(X, Y));\n            k++;\n            i++;\n        }\n        else\n        {\n            cout &lt;&lt; \"max\" &lt;&lt; endl;\n            c.push_back(cv::Point(W, Q));\n            k++;\n            j++;\n        }\n    }\n    while (i &lt;= mid)\n    {\n        cout &lt;&lt; \"D\" &lt;&lt; endl;\n        int X = Q1[i].x;\n        int Y = Q1[i].y;\n        c.push_back(cv::Point(X, Y));\n        k++;\n        i++;\n    }\n    while (j &lt;= high)\n    {\n        cout &lt;&lt; \"\u00a7\" &lt;&lt; endl;\n        int W = Q1[j].x;\n        int Q = Q1[j].y;\n        c.push_back(cv::Point(W, Q));\n        k++;\n        j++;\n    }\n    for (k = low; k &lt; high; k++)\n    {\n        cout &lt;&lt; \"***\" &lt;&lt; endl;\n        Q1.at(k) = c.at(k);\n    }\n\n}\n\n\nvoid work::mergesort(vector&lt;cv::Point&gt;&amp; Q1, int low, int high, Mat &amp; Densita)\n{   \n    cout &lt;&lt; \"RichiamoMergesort\" &lt;&lt; endl;\n    int mid;\n    if (low &lt; high)\n    {\n        mid = (low + high) / 2;\n        mergesort(Q1, low, mid, Densita);\n        mergesort(Q1, mid + 1, high, Densita);\n        merge(Q1, low, high, mid, Densita);\n    }\n}\n</code></pre>\n\n<p>but after entering the merge he works a bit and then returned me this error</p>\n\n<pre><code>invalid vector&lt;T&gt; subscript ------&gt;with vs2015\n</code></pre>\n\n<p>why? what am I doing wrong? how to solve ? </p>\n"}, {"tags": ["c++", "pointers", "segmentation-fault", "c++14"], "comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 3, "creation_date": 1473277893, "post_id": 39377977, "comment_id": 66083910, "body": "Between ignoring the Rule of 5/3/0 and the undefined behavior in handling your <code>union</code> I&#39;d say you&#39;ve got some problems son."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473278094, "post_id": 39377977, "comment_id": 66083996, "body": "What is the purpose of the union?  Are you trying to save a little space?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1473278129, "post_id": 39377977, "comment_id": 66084013, "body": "<code>Job = arg_1</code> puts junk in pointer in <code>Subtasks</code>, and crash when deleted."}, {"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1473278233, "post_id": 39377977, "comment_id": 66084052, "body": "@Jean-Fran&#231;oisFabre - But only if he ever invokes that constructor. Since he doesn&#39;t provide a <code>main()</code>, it&#39;s hard to know."}, {"owner": {"reputation": 596, "user_id": 6036665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-v3znGKV8B74/AAAAAAAAAAI/AAAAAAAAAFY/-u-7OdaCm9g/photo.jpg?sz=128", "display_name": "niraami", "link": "https://stackoverflow.com/users/6036665/niraami"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473278281, "post_id": 39377977, "comment_id": 66084073, "body": "@NathanOliver Hmm, you are right. I was planning to implement this header in a different way and I forgot that here, I don&#39;t need the union."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473278337, "post_id": 39377977, "comment_id": 66084098, "body": "If you do not need it then I would just get rid of it.  Solves at least half of your problems."}, {"owner": {"reputation": 596, "user_id": 6036665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-v3znGKV8B74/AAAAAAAAAAI/AAAAAAAAAFY/-u-7OdaCm9g/photo.jpg?sz=128", "display_name": "niraami", "link": "https://stackoverflow.com/users/6036665/niraami"}, "reply_to_user": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1473278339, "post_id": 39377977, "comment_id": 66084099, "body": "@Rob\u1d69 I provided it in the online IDE example, and yes, I did invoke it. But even after removing the union (that should resolve that problem), the seg. fault remains."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1473278359, "post_id": 39377977, "comment_id": 66084107, "body": "can you edit your post showing your fixes then? I bet you don&#39;t set <code>Subtasks=nullptr</code> in the <code>job</code> constructor: destructor still deletes undefined pointer. Classical mistake."}, {"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 2, "creation_date": 1473278429, "post_id": 39377977, "comment_id": 66084136, "body": "@areuz - Please provide a short, <b>complete</b> example in the question itself. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for more information."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1473278446, "post_id": 39377977, "comment_id": 66084149, "body": "Now that you have done that you need to include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> in the question so we can try and run it.  Also if you know what line causes the segfault that would be nice to know."}, {"owner": {"reputation": 596, "user_id": 6036665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-v3znGKV8B74/AAAAAAAAAAI/AAAAAAAAAFY/-u-7OdaCm9g/photo.jpg?sz=128", "display_name": "niraami", "link": "https://stackoverflow.com/users/6036665/niraami"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473278623, "post_id": 39377977, "comment_id": 66084239, "body": "@NathanOliver Edited the question, I do not really know what causes it. But I will investigate more and update the question."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1473281355, "post_id": 39377977, "comment_id": 66085452, "body": "To avoid this problem, use vector of smart pointers, instead of pointer to vector of pointers."}], "answers": [{"comments": [{"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1473278637, "post_id": 39378147, "comment_id": 66084242, "body": "In <a href=\"http://ideone.com/i0p8jd\" rel=\"nofollow noreferrer\">his ideone.com example</a>, he calls the default constructor. It will need to initialize <code>Subtasks</code>, also."}, {"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "edited": false, "score": 0, "creation_date": 1473278881, "post_id": 39378147, "comment_id": 66084364, "body": "checking for <code>nullptr</code> is not needed, since deleting <code>nullptr</code> is perfectly safe"}, {"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 2, "creation_date": 1473279577, "post_id": 39378147, "comment_id": 66084665, "body": "Another thing that should be addressed is why <code>Task</code> deleting the contents of the vector but not the vector itself. Ownership here is not clear but <code>Task</code> is deleting the contents of the vector but not the vector itself. Using <code>std::unique_ptr</code> or <code>std::shared_ptr</code> here takes care of that, simplifies destroying the object (from a code writing perspective), and makes it easier to work with."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1473279705, "post_id": 39378147, "comment_id": 66084723, "body": "@CaptainObvlious: you have a point. Either destroy everything or nothing. An empty destructor would probably be the good choice of design."}, {"owner": {"reputation": 596, "user_id": 6036665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-v3znGKV8B74/AAAAAAAAAAI/AAAAAAAAAFY/-u-7OdaCm9g/photo.jpg?sz=128", "display_name": "niraami", "link": "https://stackoverflow.com/users/6036665/niraami"}, "edited": false, "score": 0, "creation_date": 1473280278, "post_id": 39378147, "comment_id": 66084990, "body": "Amazing answer, and a lot of good points in the comments. I really do not know why the <i>Subtasks</i> was a pointer, as I said, I had a different approach in mind, but I changed it, as I actually wrote the code - That is probably the cause of all of my problems.  Thanks for all of the answers."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1473281512, "post_id": 39378147, "comment_id": 66085532, "body": "A vector of pointers is useful though (polymorphic elements), but a pointer on a vector is generally asking for trouble :)"}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 1, "last_activity_date": 1473279912, "last_edit_date": 1473279912, "creation_date": 1473278581, "answer_id": 39378147, "question_id": 39377977, "link": "https://stackoverflow.com/questions/39377977/seg-fault-on-exit-caused-by-pointer-to-vector-of-pointers-to-struct/39378147#39378147", "title": "Seg. Fault on exit caused by pointer to vector of pointers to struct", "body": "<p>If this constructor is called:</p>\n\n<pre><code>Task(std::string const &amp;arg_0, std::function&lt;void(std::string const &amp;)&gt; arg_1)\n{ Name = arg_0; Job = arg_1; }\n</code></pre>\n\n<p>then it crashes for sure when destructor is called because <code>Subtasks</code> is not initialized.</p>\n\n<pre><code>~Task() { for (auto tItem : *Subtasks) { delete tItem; } }\n</code></pre>\n\n<p>Fix:</p>\n\n<pre><code>Task(std::string const &amp;arg_0, std::function&lt;void(std::string const &amp;)&gt; arg_1)\n{ Name = arg_0; Job = arg_1; Subtasks = nullptr;}\n\n~Task() { if (Subtasks!=nullptr) for (auto tItem : *Subtasks) { delete tItem; } }\n</code></pre>\n\n<p>and (thx for the comments) gather/replace and fix all other constructors like this:</p>\n\n<pre><code> Task(std::string const &amp;arg_0 = \"\", std::vector&lt;Task*&gt; *arg_1 = nullptr) { Name = arg_0; Subtasks = arg_1; }\n</code></pre>\n\n<p>After some discussion, it appears that there's a possible design flaw in the code of the question: deleting the contents of the vector is dangerous since the pointers may be still in use by other clients, or may not even been allocated, but just reference local variables.\nAnd why <code>Subtasks</code> is a pointer in the first place? Why not deleting it?</p>\n"}], "owner": {"reputation": 596, "user_id": 6036665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-v3znGKV8B74/AAAAAAAAAAI/AAAAAAAAAFY/-u-7OdaCm9g/photo.jpg?sz=128", "display_name": "niraami", "link": "https://stackoverflow.com/users/6036665/niraami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 1, "accepted_answer_id": 39378147, "answer_count": 1, "score": 0, "last_activity_date": 1473281332, "creation_date": 1473277732, "last_edit_date": 1592644375, "question_id": 39377977, "link": "https://stackoverflow.com/questions/39377977/seg-fault-on-exit-caused-by-pointer-to-vector-of-pointers-to-struct", "title": "Seg. Fault on exit caused by pointer to vector of pointers to struct", "body": "<p>After a few days of delaying this question and debugging I've found that If my code below is run after removing the <em>vector</em> from the union (and all of the code mentioning this vector) the seg. fault dissapears.</p>\n<pre><code>#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;functional&gt;\n\nstruct Task\n{\n  std::string Name;\n\n  std::vector&lt;Task*&gt; *Subtasks;\n  std::function&lt;void(std::string const &amp;)&gt; Job;\n\n  Task() {}\n  Task(std::string const &amp;arg_0) { Name = arg_0; }\n  Task(std::string const &amp;arg_0, std::vector&lt;Task*&gt; *arg_1) { Name = arg_0; Subtasks = arg_1; }\n  Task(std::string const &amp;arg_0, std::function&lt;void(std::string const &amp;)&gt; arg_1)\n  { Name = arg_0; Job = arg_1; }\n\n  ~Task() { for (auto tItem : *Subtasks) { delete tItem; } }\n};\n\nclass Console\n{\nprivate:\n  std::vector&lt;Task*&gt; Routine;\n\npublic:\n  ~Console() { for (auto tItem : Routine) { delete tItem; } } //I thought that this is not needed but Valgrind thinks otherwise, strangely the deconstructors of the Tasks are not called, I guess.\n\n  void add(Task *arg_0) { Routine.push_back(arg_0); }\n\n  void foo()\n  {\n    Task *tTask = new Task();\n    //Task *tTask = new Task(&quot;Name&quot;);\n    //Task *tTask = new Task(&quot;Name&quot;, [this](std::string const &amp;arg_0){ ; });\n   //Seg. fault still remains.\n    add(tTask);\n  }\n};\n\nint main()\n{\n    Console _Console;\n    _Console.foo();\n}\n</code></pre>\n<p><a href=\"http://ideone.com/i0p8jd\" rel=\"nofollow noreferrer\">For quick online IDE code test</a></p>\n<hr />\n<p>This should probably be another question, but I think it's too simple.\nI've heard before, that if a non-trivial is used in a union, it should be taken care of if the values are switched, how would one do that, and is it necessary if I do not intend to have any value changes on runtime?</p>\n<h1>EDIT1</h1>\n<p>Removed the union of vector and std::function</p>\n<h1>EDIT2</h1>\n<p>The Seg. Fault is most likely caused by the deconstructor <em>~Task();</em>.</p>\n"}, {"tags": ["c++", "templates", "compiler-errors", "g++", "shadow"], "comments": [{"owner": {"reputation": 31438, "user_id": 908939, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/etRsI.jpg?s=128&g=1", "display_name": "Trevor Hickey", "link": "https://stackoverflow.com/users/908939/trevor-hickey"}, "reply_to_user": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1473277910, "post_id": 39377928, "comment_id": 66083919, "body": "@skypjack Ok, so I should leave out the &#39;T&#39; in &lt;class T&gt;, because just &lt;class&gt; builds for me."}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1473278054, "post_id": 39377928, "comment_id": 66083983, "body": "It&#39;s a valid and working solution. That <code>T</code> is useless in your example, isn&#39;t it?"}, {"owner": {"reputation": 31438, "user_id": 908939, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/etRsI.jpg?s=128&g=1", "display_name": "Trevor Hickey", "link": "https://stackoverflow.com/users/908939/trevor-hickey"}, "reply_to_user": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1473278439, "post_id": 39377928, "comment_id": 66084143, "body": "@skypjack You&#39;re right.  I must have been confused in thinking that the container type name had to be specialized on type T, but that happens on the actual parameters."}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1473278548, "post_id": 39377928, "comment_id": 66084200, "body": "Yeah, exactly, the template parameter list of the function only mentions a template class having a parameter list with size 1. The name of the parameter is useless in this case."}], "answers": [{"comments": [{"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1473278750, "post_id": 39378064, "comment_id": 66084299, "body": "Why this works instead? <code>template &lt;template &lt;class T&gt; class Container, typename T&gt; </code>. Are they different scopes being part of different parameter lists?"}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "reply_to_user": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1473283223, "post_id": 39378064, "comment_id": 66086298, "body": "@skypjack the first <code>T</code>&#39;s scope does not extend to the rest of the template parameter list , so the second <code>T</code> does not hide it."}], "tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": true, "score": 4, "last_activity_date": 1473278235, "creation_date": 1473278235, "answer_id": 39378064, "question_id": 39377928, "link": "https://stackoverflow.com/questions/39377928/g-6-errors-on-shadowed-template-parameters-while-g-5-does-not/39378064#39378064", "title": "g++-6 errors on shadowed template parameters while g++-5 does not", "body": "<p>The behaviour of g++6 is correct because according to the standard:</p>\n\n<blockquote>\n  <p>A <em>template-parameter</em> shall not be redeclared within its scope (including nested scopes). A <em>template-parameter</em> shall not have the same name as the template name.</p>\n</blockquote>\n\n<p>The scope of <code>T</code> begins right after its declaration, so it extends into the following template template parameter, which redeclares <code>T</code> as a template parameter, therefore this rule is violated.</p>\n\n<p>I imagine the change between g++5 and g++6 was due to fixing some bug report around a similar issue.</p>\n"}], "owner": {"reputation": 31438, "user_id": 908939, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/etRsI.jpg?s=128&g=1", "display_name": "Trevor Hickey", "link": "https://stackoverflow.com/users/908939/trevor-hickey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "closed_date": 1473280977, "accepted_answer_id": 39378064, "answer_count": 1, "score": 6, "last_activity_date": 1473278625, "creation_date": 1473277550, "question_id": 39377928, "link": "https://stackoverflow.com/questions/39377928/g-6-errors-on-shadowed-template-parameters-while-g-5-does-not", "closed_reason": "Duplicate", "title": "g++-6 errors on shadowed template parameters while g++-5 does not", "body": "<p>Take the following example:  </p>\n\n<pre><code>#include &lt;vector&gt;\n\ntemplate &lt;typename T, template &lt;class T&gt; class Container&gt;\nstd::vector&lt;T&gt; To_Vector(Container&lt;T&gt; const&amp; c){\n  return std::vector&lt;T&gt;( c.begin(), c.end() );\n}\n\nint main(){}\n</code></pre>\n\n<p>With <code>g++-5</code>, it compiles without errors:  </p>\n\n<pre><code>g++-5 -o main main.cpp \n</code></pre>\n\n<p>With <code>g++-6</code> is fails to compile:  </p>\n\n<pre><code>g++-6 -o main main.cpp\nmain.cpp:4:33: error: declaration of template parameter \u2018T\u2019 shadows template parameter\n template &lt;typename T, template &lt;class T&gt; class Container&gt;\n                                 ^~~~~\nmain.cpp:4:11: note: template parameter \u2018T\u2019 declared here\n template &lt;typename T, template &lt;class T&gt; class Container&gt;\n</code></pre>\n\n<p>Is the compiler wrong?  Is my code wrong?<br>\nWhy does  <code>g++-5</code> compile this code while <code>g++-6</code> does not?  </p>\n\n<hr>\n\n<pre><code>g++-5 --version    \ng++-5 (Ubuntu 5.4.1-2ubuntu1~14.04) 5.4.1 20160904\nCopyright (C) 2015 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n</code></pre>\n\n<hr>\n\n<pre><code>g++-6 --version\ng++-6 (Ubuntu 6.2.0-3ubuntu11~14.04) 6.2.0 20160901\nCopyright (C) 2016 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n</code></pre>\n"}, {"tags": ["c++", "algorithm", "grid", "breadth-first-search"], "comments": [{"owner": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 0, "creation_date": 1473277080, "post_id": 39377781, "comment_id": 66083553, "body": "\\\\ is added to reduce the line for SO . :p"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1473277509, "post_id": 39377781, "comment_id": 66083739, "body": "The right tool to solve such problems is your debugger. You should step through your code line-by-line <i>before</i> asking on Stack Overflow. For more help, please read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs (by Eric Lippert)</a>. At a minimum, you should &#91;edit] your question to include a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable</a> example that reproduces your problem, along with the observations you made in the debugger."}], "answers": [{"comments": [{"owner": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 1, "creation_date": 1473278440, "post_id": 39378077, "comment_id": 66084144, "body": "It will have a very high time and space complexity I suppose . Matrix can be of sizes 5000 x 5000 ."}, {"owner": {"reputation": 3882, "user_id": 1040597, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c993933eeeb895833f1938b8c1308964?s=128&d=identicon&r=PG&f=1", "display_name": "Saeid", "link": "https://stackoverflow.com/users/1040597/saeid"}, "reply_to_user": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 0, "creation_date": 1473278526, "post_id": 39378077, "comment_id": 66084194, "body": "This is <code>O(n^2)</code> you can&#39;t do it better than <code>O(n^2)</code>. <code>O(n^2)</code> is acceptable for 5000."}, {"owner": {"reputation": 3882, "user_id": 1040597, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c993933eeeb895833f1938b8c1308964?s=128&d=identicon&r=PG&f=1", "display_name": "Saeid", "link": "https://stackoverflow.com/users/1040597/saeid"}, "edited": false, "score": 0, "creation_date": 1473278871, "post_id": 39378077, "comment_id": 66084356, "body": "I don&#39;t see the need for <code>L</code> factor. You just need to traverse the graph once. I think it is straightforward to calculate these matrices in one pass."}, {"owner": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 0, "creation_date": 1473278994, "post_id": 39378077, "comment_id": 66084419, "body": "Can you give me a heads up on how would you check all <code>#</code>s in all directions for a particular <code>#</code> in one pass ? How would you go about checking till the bounds ? It&#39;d be great if you could add it to your answer ."}, {"owner": {"reputation": 3882, "user_id": 1040597, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c993933eeeb895833f1938b8c1308964?s=128&d=identicon&r=PG&f=1", "display_name": "Saeid", "link": "https://stackoverflow.com/users/1040597/saeid"}, "reply_to_user": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 1, "creation_date": 1473279043, "post_id": 39378077, "comment_id": 66084440, "body": "@saru95 it is the simplest example of dynamic programming. I&#39;ll add it to the answer."}, {"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 1, "creation_date": 1473279196, "post_id": 39378077, "comment_id": 66084504, "body": "Never mind, I misinterpreted your answer. But your graph for the left direction is actually the right direction again."}, {"owner": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 0, "creation_date": 1473279709, "post_id": 39378077, "comment_id": 66084727, "body": "My god , checking a previous <code>#</code>s value . I&#39;m sorry. I see it straight now . BTW do you see any major thing wrong with the BFS algorithm ."}, {"owner": {"reputation": 3882, "user_id": 1040597, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c993933eeeb895833f1938b8c1308964?s=128&d=identicon&r=PG&f=1", "display_name": "Saeid", "link": "https://stackoverflow.com/users/1040597/saeid"}, "edited": false, "score": 1, "creation_date": 1473280070, "post_id": 39378077, "comment_id": 66084902, "body": "Well it&#39;s not a real BFS because you are not pushing all the neighbors to queue and you are not maintaining a visited list. Also you are doing that for every <code>#</code> that you see which is gonna be inefficient."}], "tags": [], "owner": {"reputation": 3882, "user_id": 1040597, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c993933eeeb895833f1938b8c1308964?s=128&d=identicon&r=PG&f=1", "display_name": "Saeid", "link": "https://stackoverflow.com/users/1040597/saeid"}, "is_accepted": true, "score": 1, "last_activity_date": 1473279413, "last_edit_date": 1473279413, "creation_date": 1473278291, "answer_id": 39378077, "question_id": 39377781, "link": "https://stackoverflow.com/questions/39377781/algorithm-for-finding-a-plus-sign-in-a-grid/39378077#39378077", "title": "Algorithm for finding a plus sign in a grid", "body": "<p>I don't exactly know what is wrong with your code and whether your algorithm is correct or not. But I don't think you need BFS to solve this problem. Create 4 matrices that keeps the number of consecutive <code>#</code>s up, down, left and right of each <code>#</code>:</p>\n\n<pre><code>..#..\n..#.#\n#####\n..#.#\n..#..\n</code></pre>\n\n<p>up</p>\n\n<pre><code>..0..\n..1.0\n00201\n..3.2\n..4..\n</code></pre>\n\n<p>down</p>\n\n<pre><code>..4..\n..3.2\n00201\n..1.0\n..0..\n</code></pre>\n\n<p>right</p>\n\n<pre><code>..0..\n..0.0\n43210\n..0.0\n..0..\n</code></pre>\n\n<p>left</p>\n\n<pre><code>..0..\n..0.0\n01234\n..0.0\n..0..\n</code></pre>\n\n<p>now create a matrix by keeping the minimum of 4 matrices for each element</p>\n\n<p>min</p>\n\n<pre><code>..0..\n..0.0\n00200\n..0.0\n..0..\n</code></pre>\n\n<p>The answer is maximum of the <code>min</code> matrix.</p>\n\n<p>suppose you want to count how many consecutive '#'s are behind each '#'. </p>\n\n<pre><code>for i from 0 to str.length\n    if s[i]=='#':\n        if s[i-1]=='#': // beware of i==0\n            dp[i] = dp[i-1]+1\n        else \n            dp[i] = 0\n\nstr ..##.###...##...\ndp  ..01.012...01...\n</code></pre>\n"}], "owner": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 831, "favorite_count": 0, "accepted_answer_id": 39378077, "answer_count": 1, "score": -1, "last_activity_date": 1473283500, "creation_date": 1473276962, "last_edit_date": 1473283500, "question_id": 39377781, "link": "https://stackoverflow.com/questions/39377781/algorithm-for-finding-a-plus-sign-in-a-grid", "title": "Algorithm for finding a plus sign in a grid", "body": "<p>I have this problem of finding the largest 'PLUS' in a given grid.\nFor example, If I have the following grid:</p>\n\n<pre><code>..#..\n..#.#\n#####\n..#.#\n..#..\n</code></pre>\n\n<p>The largest 'PLUS' in it would be of size 3 . Similarly, for </p>\n\n<pre><code>..#\n#.#\n#.#\n</code></pre>\n\n<p>The answer would be 1 as no particular 'PLUS' exists (except the origin of course).</p>\n\n<p>The algorithm I have in mind goes like this: </p>\n\n<ol>\n<li>Find a location with <code>#</code> and with <code>#</code> on all its 4 directions. Like <code>(2, 2)</code> in figure 1.</li>\n<li>Use Breadth First Search strategy to add all its neighbors in the queue along with the direction they lie in (left, right, up, down).</li>\n<li>Keep visiting and adding neighbors pertaining to that particular direction.</li>\n<li>Repeat until you encounter a <code>.</code> or run out of bounds.</li>\n</ol>\n\n<p>While doing all this, we can maintain an array which can maintain the count of <code>#</code> occurring in each direction.  </p>\n\n<p>Code: </p>\n\n<pre><code>int x[4] = {-1,0,1,0} ;\nint y[4] = {0,1,0,-1} ;\nint n, dir[4], result ;\nchar adj[2001][2001] ;\n\nint bfs(int sx, int sy) {\n    queue &lt; pair &lt;int, pair &lt;int, int&gt; &gt; &gt; q ;\n    q.push(make_pair(0, make_pair(sx+x[0], sy+y[0]))) ;\n    q.push(make_pair(1, make_pair(sx+x[1], sy+y[1]))) ;\n    q.push(make_pair(2, make_pair(sx+x[2], sy+y[2]))) ;\n    q.push(make_pair(3, make_pair(sx+x[3], sy+y[3]))) ;\n    while (!q.empty()) {\n        pair &lt;int, pair &lt;int, int&gt; &gt; curr = q.front() ;\n        q.pop() ;\n        int current_direction =  curr.first ;\n        int current_x = curr.second.first + x[current_direction] ;\n        int current_y = curr.second.second + y[current_direction] ;\n        if (current_x&gt;=0&amp;&amp;current_x&lt;n&amp;&amp;current_y&gt;=0&amp;&amp;current_y&lt;n) {\n            if (adj[current_x][current_y] == '#') {\n                ++dir[current_direction] ;\n                q.push(make_pair(current_direction, make_pair(current_x, current_y))) ;\n            }\n            else\n                break ;\n        }\n        else\n            break ;\n    }\n    result = *min_element(dir, dir+4) ;\n    return result ;\n}\n\nint main() {\n    int t ; scanf(\"%d\", &amp;t) ;\n    while (t--) {\n        scanf(\"%d\", &amp;n) ;\n        for (int i = 0; i &lt; n; i++)\n            cin &gt;&gt; adj[i] ;\n        bool flag = true ;\n        int max_plus = 0 ;\n        for (int i = 1; i &lt; n - 1; i++)\n            for (int j = 1; j &lt; n - 1; j++) {\n                if (adj[i][j] == '#' &amp;&amp; adj[i-1][j] == '#' \\\\\n                    &amp;&amp; adj[i][j+1] == '#' &amp;&amp; adj[i+1][j] == '#' \\\\\n                    &amp;&amp; adj[i][j-1] == '#') {\n                    // cout &lt;&lt; i &lt;&lt; \" \" &lt;&lt; j &lt;&lt; endl ;\n                    flag = false ;\n                    memset(dir, 2, sizeof(dir)) ;\n                    max_plus = max(max_plus, bfs(i, j)) ;\n                }\n            }\n        if(flag)\n            cout &lt;&lt; \"1\" &lt;&lt; endl ;\n        else\n            cout &lt;&lt; max_plus &lt;&lt; endl ;\n    }\n    return 0 ;\n}\n</code></pre>\n\n<p>This code seems to give a weird output (<code>33686019</code>) for figure 1. \nI can't seem to find the error I'm running into with respect to the code. Also, if there is something wrong with the algorithm I have, I'd love some advice. </p>\n"}, {"tags": ["c++", "opengl", "graphics", "3d", "opengl-3"], "answers": [{"tags": [], "owner": {"reputation": 343, "user_id": 2213455, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/12186010a66796b42edae4ea42a7c9d1?s=128&d=identicon&r=PG", "display_name": "TJR", "link": "https://stackoverflow.com/users/2213455/tjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1473970091, "creation_date": 1473970091, "answer_id": 39519520, "question_id": 39377679, "link": "https://stackoverflow.com/questions/39377679/scaling-and-moving-3d-object-with-opengl/39519520#39519520", "title": "Scaling and moving 3d object with openGL", "body": "<p>So I finally solved the issue.\nSince the scaling method just changed the matrix, moving the object must be relative to how much you scaled the object.</p>\n\n<pre><code>float x_trans, y_trans, z_trans;\n\nmodel.Scale(xn * x_unit / model.GetWidth(), yn * y_unit / model.GetHeight(), zn * z_unit / model.GetDepth());\nmodel.Move(0.0f - model.GetX() / (xn * x_unit / model.GetOriginalWidth()), 0.0f - model.GetY() / (yn * y_unit / model.GetOriginalHeight()), 0.0f - model.GetZ() / (zn * z_unit / model.GetOriginalDepth()));\n\nx_trans = (((xn - (2.0f / x_unit)) / 2.0f + x_offset) * model.GetOriginalWidth()) / xn;\ny_trans = ((yn / 2.0f + y_offset) * model.GetOriginalHeight()) / yn;\nz_trans = (((zn - (2.0f / z_unit)) / 2.0f + z_offset) * model.GetOriginalDepth()) / zn;\n\nmodel.Move(x_trans, y_trans, z_trans);\n</code></pre>\n\n<p>This code just works perfectly for me.</p>\n"}], "owner": {"reputation": 343, "user_id": 2213455, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/12186010a66796b42edae4ea42a7c9d1?s=128&d=identicon&r=PG", "display_name": "TJR", "link": "https://stackoverflow.com/users/2213455/tjr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1885, "favorite_count": 0, "accepted_answer_id": 39519520, "answer_count": 1, "score": 1, "last_activity_date": 1473970091, "creation_date": 1473276459, "last_edit_date": 1473364524, "question_id": 39377679, "link": "https://stackoverflow.com/questions/39377679/scaling-and-moving-3d-object-with-opengl", "title": "Scaling and moving 3d object with openGL", "body": "<p>I'm trying to load a 3D object from an .obj file, to scale it to a certain size to to move it to a certain coordinate (I prefer changing its matrix than scaling and moving each vector).\nFrom the .obj parsing function, I know the width, height, depth and center of the object's bounding box.</p>\n\n<p>To make it clear, I have a map of tiles from (-1.0, 0, 1.0) to (1.0, 0, -1.0) and for modeling the all thing I use an obj file of a cube (with length of 40.0). Clearly, I had to scale the cube before printing it.</p>\n\n<p>My problem is that I keep failing on moving the cube correctly on the z axis.\nScaling was done this way:</p>\n\n<pre><code>model.Scale(xn * x_unit / model.GetWidth(), yn * y_unit / model.GetHeight(), zn * z_unit / model.GetDepth());\n</code></pre>\n\n<p>Where xn, yn and zn are the amount of tiles the cube will stretch on in each axis and x_unit, y_unit and z_unit are the length of each tile in that axis (this function works perfectly)</p>\n\n<p>In order to move the cube to the desired place I calculated the translation amount in each axis (assuming the cube's center is at 0, 0, 0):</p>\n\n<pre><code>x_trans = (((xn - (2.0f / x_unit)) / 2.0f) * model.GetOriginalWidth()) / xn;\ny_trans = (0.5f * model.GetOriginalHeight());\nz_trans = ((zn - (2.0f / z_unit)) / 2.0f) * model.GetOriginalDepth() / zn;\n</code></pre>\n\n<p>And transalting the all model:</p>\n\n<pre><code>model.Move(x_trans - model.GetX(), y_trans - model.GetY(), z_trans - model.GetZ());\n</code></pre>\n\n<p>The Move function and the Scale function moves and scales the model matrix, not the real array of coordinates:</p>\n\n<pre><code>void Graphic3dModelPart::Move(float dx, float dy, float dz)\n{\n    model_ = glm::translate(model_, glm::vec3(dx, dy, dz));\n    mvp_ = projection_ * view_ * model_;\n}\n\nvoid Graphic3dModelPart::Scale(float sx, float sy, float sz)\n{\n    model_ *= glm::scale(glm::mat4(), glm::vec3(sx, sy, sz));\n    mvp_ = projection_ * view_ * model_;\n}\n</code></pre>\n\n<p>Yet the problem is that in the Z axis something goes wrong (when the cube's depth is more than one tile's length (on the x axis and y axis it works perfectly).</p>\n\n<p>If pictures will help understanding the situation tell me and I will upload.</p>\n"}, {"tags": ["c++", "debugging"], "comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1473281202, "post_id": 39377605, "comment_id": 66085375, "body": "Presumably the address is somewhere in the code of your &quot;memory checker tool&quot;. Which is what?"}, {"owner": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1473281853, "post_id": 39377605, "comment_id": 66085690, "body": "Good thought, I am using application verifier but that module address range is 10450000 - 104b0000 and that would put this address out of its range though. When I do <code>lm a 773bbb47</code> to find which module this address belongs to, it doesn&#39;t return any module!"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1473283586, "post_id": 39377605, "comment_id": 66086425, "body": "Break and have a look at the stack frame window"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1473286695, "post_id": 39377605, "comment_id": 66087526, "body": "The exception is likely being raised directly inside your own executable code, that would explain why the address does not correspond to any external modules the app is using (like <code>kernel32.dll</code>, where <code>GetExitCodeThread()</code> resides). Your verifier tool is likely hooking into your call to <code>GetExitCodeThread()</code> and throwing an exception at the call site if bad input is about to be passed to the OS function. The debugger then sees that exception like any other before your app sees it. The popup is coming from the debugger."}, {"owner": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1473288335, "post_id": 39377605, "comment_id": 66088025, "body": "@RemyLebeau If it helps to know, this is a brand new default MFC application where only thing I added was this button handler. I saw this behaviour in my real application but went on to create a simple demo where I was easily able to produce it.   You seem to imply <code>lmi</code> doesn&#39;t show the main module? It shows StringDemo address range is 013d0000 - 0141c000 which is my main application and this address is again out of range."}], "owner": {"reputation": 9091, "user_id": 841330, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bcafddab5ef9efc3a31235b7db56680e?s=128&d=identicon&r=PG", "display_name": "zar", "link": "https://stackoverflow.com/users/841330/zar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1473282032, "creation_date": 1473276092, "last_edit_date": 1473282032, "question_id": 39377605, "link": "https://stackoverflow.com/questions/39377605/what-does-the-address-really-means-in-exception-thrown-at-address-in-app-exe", "title": "What does the address really means in &quot;Exception thrown at &lt;address&gt; in app.exe..&quot; dialog?", "body": "<p>I am deliberately passing a NULL handle to <code>GetExitCodeThread()</code> in this very simple function below to understand something.</p>\n\n<pre><code>void CStringDemoDlg::OnBnClickedButtonTest()\n{\n    DWORD dwExitCode = 0;\n    HANDLE hThread = 0;\n\n    GetExitCodeThread(hThread, &amp;dwExitCode);\n}\n</code></pre>\n\n<p>In regular run, nothing bad happens but when I run with my memory checker tool, it catches a NULL handle is being passed and stops the execution and I see the handle is NULL, so far so good.</p>\n\n<p>Now if I choose to continue debugging, it throws an exception below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/oUE54.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oUE54.png\" alt=\"enter image description here\"></a></p>\n\n<p>But the address it mentions (773bbb47) doesn't match to anything in registers or anything else. The value of registers are:</p>\n\n<pre><code>0:000&gt; r\neax=00000000 ebx=00000000 ecx=0043e104 edx=0043e105 esi=77560560 edi=0043e6c4\neip=77560572 esp=0043e568 ebp=0043e588 iopl=0         nv up ei pl zr na pe nc\ncs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00000246\nntdll!NtQueryInformationThread+0x12:\n77560572 83c404  \n</code></pre>\n\n<p>On top of that, it was throwing the dialog above after it threw first chance exception but after subsequent runs it no longer throw the exception error dialog but first chance is thrown (seems like it is being handled now without any code change!?)</p>\n\n<p>My question is what does the address really mean in this error dialog? Why does it not correspond to anything?</p>\n\n<p>If I try to set breakpoint on this address, the result is below (it doesn't find symbol) but the symbols are really not an issue as they are loaded (i am running from source code). This is just another unexpected error.</p>\n\n<pre><code>0:000&gt; bm r 773bbb47\nNo matching code symbols found, no breakpoints set.\n</code></pre>\n\n<p>I know I should not be worrying about this error dialog because it obviously resulted from the NULL handle but I wanted to understand why such a follow through with an exception for memory which doesn't correspond to anything!</p>\n"}, {"tags": ["c++", "dll", ".net-core"], "answers": [{"comments": [{"owner": {"reputation": 5956, "user_id": 1249472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d2ac9163237829d11cbf4ee7d563d?s=128&d=identicon&r=PG", "display_name": "Nikita", "link": "https://stackoverflow.com/users/1249472/nikita"}, "edited": false, "score": 0, "creation_date": 1473715445, "post_id": 39439464, "comment_id": 66239212, "body": "Hi @gemr1423! Does it solve your problem or you need more help?"}, {"owner": {"reputation": 689, "user_id": 973441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VhmtD.jpg?s=128&g=1", "display_name": "gemr1423", "link": "https://stackoverflow.com/users/973441/gemr1423"}, "edited": false, "score": 0, "creation_date": 1473772080, "post_id": 39439464, "comment_id": 66261097, "body": "Hi @Nikita I have a question, is the same with .xproj?"}, {"owner": {"reputation": 5956, "user_id": 1249472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d2ac9163237829d11cbf4ee7d563d?s=128&d=identicon&r=PG", "display_name": "Nikita", "link": "https://stackoverflow.com/users/1249472/nikita"}, "reply_to_user": {"reputation": 689, "user_id": 973441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VhmtD.jpg?s=128&g=1", "display_name": "gemr1423", "link": "https://stackoverflow.com/users/973441/gemr1423"}, "edited": false, "score": 0, "creation_date": 1473804610, "post_id": 39439464, "comment_id": 66278561, "body": "@gemr1423 Info about packing of native dlls with <code>xproj</code> added."}, {"owner": {"reputation": 689, "user_id": 973441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VhmtD.jpg?s=128&g=1", "display_name": "gemr1423", "link": "https://stackoverflow.com/users/973441/gemr1423"}, "edited": false, "score": 0, "creation_date": 1473863031, "post_id": 39439464, "comment_id": 66303290, "body": "Hi @Nikita, I got the same error trying to execute a method of the C++ DLL in the class library project. I was done the steps that you explain without error. &quot;Unable to load DLL &#39;TLHDArchive.dll&#39;: The specified module could not be found. (Exception from HRESULT: 0x8007007E)&quot; I calling the method this way: [DllImport(&quot;NameOfDll.dll&quot;, CallingConvention = CallingConvention.Cdecl)]"}, {"owner": {"reputation": 5956, "user_id": 1249472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d2ac9163237829d11cbf4ee7d563d?s=128&d=identicon&r=PG", "display_name": "Nikita", "link": "https://stackoverflow.com/users/1249472/nikita"}, "reply_to_user": {"reputation": 689, "user_id": 973441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VhmtD.jpg?s=128&g=1", "display_name": "gemr1423", "link": "https://stackoverflow.com/users/973441/gemr1423"}, "edited": false, "score": 0, "creation_date": 1473867993, "post_id": 39439464, "comment_id": 66306799, "body": "@gemr1423 I&#39;ve found an <a href=\"https://github.com/dotnet/cli/issues/4021\" rel=\"nofollow noreferrer\">issue</a> at their bug tracking system about it. <code>dotnet</code> doesn&#39;t copy included files of installed packages. According to the  <a href=\"https://github.com/dotnet/core/blob/master/roadmap.md\" rel=\"nofollow noreferrer\">release roadmap</a> next 1.1 version will be available soon and you will be able to use the second proposed solution. .NET Core will migrate from <code>project.json</code> to <code>.csproj</code> and <code>MSBuild</code>."}, {"owner": {"reputation": 5956, "user_id": 1249472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d2ac9163237829d11cbf4ee7d563d?s=128&d=identicon&r=PG", "display_name": "Nikita", "link": "https://stackoverflow.com/users/1249472/nikita"}, "reply_to_user": {"reputation": 689, "user_id": 973441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VhmtD.jpg?s=128&g=1", "display_name": "gemr1423", "link": "https://stackoverflow.com/users/973441/gemr1423"}, "edited": false, "score": 0, "creation_date": 1473869631, "post_id": 39439464, "comment_id": 66307781, "body": "@gemr1423 Refer to the <a href=\"https://github.com/dotnet/corefxlab\" rel=\"nofollow noreferrer\">Dotnet/corefxlab</a> project as a sample of right <code>&quot;packOptions&quot;</code> usage. Component <a href=\"https://github.com/dotnet/corefxlab/blob/71d1b2220a59d1780aafc04d42a58e15296fc96f/src/System.Drawing.Graphics/project.json#L19\" rel=\"nofollow noreferrer\"><code>System.Drawing.Graphics</code></a> uses the same approach to include <code>libgd.dll</code> native library."}, {"owner": {"reputation": 689, "user_id": 973441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VhmtD.jpg?s=128&g=1", "display_name": "gemr1423", "link": "https://stackoverflow.com/users/973441/gemr1423"}, "edited": false, "score": 2, "creation_date": 1473879656, "post_id": 39439464, "comment_id": 66313117, "body": "Thanks for your help @Nikita"}, {"owner": {"reputation": 290, "user_id": 130985, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e817d9b01cf15d473c070bb51561ca78?s=128&d=identicon&r=PG", "display_name": "Anish", "link": "https://stackoverflow.com/users/130985/anish"}, "edited": false, "score": 0, "creation_date": 1498115137, "post_id": 39439464, "comment_id": 76368026, "body": "I got &quot;The method or operation is not implemented.&quot; when trying .csproj on macOS 10.12      <code>$ nuget pack MyClassLibrary.csproj  Attempting to build package from MyClassLibrary.csproj.  System.NotImplementedException: The method or operation is not implemented.</code>"}, {"owner": {"reputation": 290, "user_id": 130985, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e817d9b01cf15d473c070bb51561ca78?s=128&d=identicon&r=PG", "display_name": "Anish", "link": "https://stackoverflow.com/users/130985/anish"}, "edited": false, "score": 0, "creation_date": 1498117535, "post_id": 39439464, "comment_id": 76369501, "body": "my nuget package maker on macOS was <b>2.12.0.0</b> and after upgrading it to  <b>4.1.0.2450</b> fixed the above error <i>(However i am not getting a different error)</i>"}, {"owner": {"reputation": 290, "user_id": 130985, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e817d9b01cf15d473c070bb51561ca78?s=128&d=identicon&r=PG", "display_name": "Anish", "link": "https://stackoverflow.com/users/130985/anish"}, "edited": false, "score": 0, "creation_date": 1498124622, "post_id": 39439464, "comment_id": 76374577, "body": "if <code>nuget pack MyClassLibrary.csproj</code> doesn&#39;t work then we can try <code>dotnet pack MyClassLibrary.csproj</code>"}], "tags": [], "owner": {"reputation": 5956, "user_id": 1249472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d2ac9163237829d11cbf4ee7d563d?s=128&d=identicon&r=PG", "display_name": "Nikita", "link": "https://stackoverflow.com/users/1249472/nikita"}, "is_accepted": true, "score": 12, "last_activity_date": 1473804486, "last_edit_date": 1495542734, "creation_date": 1473619556, "answer_id": 39439464, "question_id": 39377602, "link": "https://stackoverflow.com/questions/39377602/how-to-add-c-library-in-a-net-core-project/39439464#39439464", "title": "How to add C++ library in a .NET Core project", "body": "<p><em>dependencies</em> attribute in <code>project.json</code> specifies package dependencies, because of this NuGet handles <code>NameOfDll.dll</code> as a package ID, but not as a dll name.</p>\n\n<p>To add native C++ dlls into you NuGet package for <code>.xproj</code> library you should do the following steps:</p>\n\n<ol>\n<li>Put your <code>NameOfDll.dll</code> in <code>\\lib</code> directory near <code>MyClassLibrary.xproj</code></li>\n<li><p>Open <code>project.json</code> file and add there:</p>\n\n<pre><code>\"packOptions\": {\n  \"files\" : {\n    \"includeFiles\" : \"lib/NameOfDll.dll\"\n  }\n}\n</code></pre></li>\n<li><p>Execute <code>dotnet pack</code></p></li>\n</ol>\n\n<p><code>NameOfDll.dll</code> will be included into NuGet package under the path <code>lib\\NameOfDll.dll</code>.</p>\n\n<p>To add native C++ dlls into your NuGet package for <code>.csproj</code> library you should do the following steps:</p>\n\n<ol>\n<li>I assume you have managed project with name <code>MyClassLibrary.csproj</code>.</li>\n<li>Create new NuGet package for you class library with <code>nuget spec</code> command.</li>\n<li>Create <code>\\lib</code>, <code>\\build</code>, <code>\\content</code> and <code>\\tools</code> directories near <code>MyClassLibrary.nuspec</code>.</li>\n<li>Copy all your native dlls into the <code>\\build</code> folder.</li>\n<li>Change extension of copied native dlls to <code>.native</code>.</li>\n<li><p>Create <code>MyClassLibrary.targets</code> with the following content inside <code>\\build</code> folder:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Project ToolsVersion=\"4.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\"&gt;\n  &lt;ItemGroup&gt;\n    &lt;AvailableItemName Include=\"NativeBinary\" /&gt;\n  &lt;/ItemGroup&gt;\n  &lt;ItemGroup&gt;\n    &lt;NativeBinary Include=\"$(MSBuildThisFileDirectory)*\"&gt;\n      &lt;TargetPath&gt;&lt;/TargetPath&gt;\n    &lt;/NativeBinary&gt;\n  &lt;/ItemGroup&gt;\n  &lt;PropertyGroup&gt;\n    &lt;PrepareForRunDependsOn&gt;\n      $(PrepareForRunDependsOn);\n      CopyNativeBinaries\n    &lt;/PrepareForRunDependsOn&gt;\n  &lt;/PropertyGroup&gt;\n  &lt;Target Name=\"CopyNativeBinaries\" DependsOnTargets=\"CopyFilesToOutputDirectory\"&gt;\n    &lt;Copy SourceFiles=\"@(NativeBinary)\"\n          DestinationFiles=\"@(NativeBinary-&gt;'$(OutDir)\\%(TargetPath)\\%(Filename).dll')\"\n          Condition=\"'%(Extension)'=='.native'\"&gt;\n      &lt;Output TaskParameter=\"DestinationFiles\" ItemName=\"FileWrites\" /&gt;\n    &lt;/Copy&gt;\n    &lt;Copy SourceFiles=\"@(NativeBinary)\"\n          DestinationFiles=\"@(NativeBinary-&gt;'$(OutDir)\\%(TargetPath)\\%(Filename).%(Extension)')\"\n          Condition=\"'%(Extension)'!='.native'\"&gt;\n      &lt;Output TaskParameter=\"DestinationFiles\" ItemName=\"FileWrites\" /&gt;\n    &lt;/Copy&gt;\n  &lt;/Target&gt;\n&lt;/Project&gt;\n</code></pre>\n\n<p><em>Hint</em>: The <code>.targets</code> content is taken from <a href=\"https://stackoverflow.com/questions/19478775/add-native-files-from-nuget-package-to-project-output-directory\">this</a> question.\nThe above <code>.targets</code> file will be injected on an installation of the NuGet package into the target project file.</p></li>\n<li><p>Add the following lines into your <code>MyClassLibrary.nuspec</code>:</p>\n\n<pre><code>&lt;files&gt;\n  &lt;file src=\"lib\\\" target=\"lib\" /&gt;\n  &lt;file src=\"tools\\\" target=\"tools\" /&gt;\n  &lt;file src=\"content\\\" target=\"content\" /&gt;\n  &lt;file src=\"build\\\" target=\"build\" /&gt;\n&lt;/files&gt;\n</code></pre></li>\n<li><p>Execute <code>nuget pack MyClassLibrary.csproj</code> to build your NuGet package.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 7514248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128cff6caed17e2d4eff81cea2363103?s=128&d=identicon&r=PG&f=1", "display_name": "Serena Yu", "link": "https://stackoverflow.com/users/7514248/serena-yu"}, "is_accepted": false, "score": 1, "last_activity_date": 1513076907, "creation_date": 1513076907, "answer_id": 47771145, "question_id": 39377602, "link": "https://stackoverflow.com/questions/39377602/how-to-add-c-library-in-a-net-core-project/47771145#47771145", "title": "How to add C++ library in a .NET Core project", "body": "<p>Here is a one-click way to do it in .net core 2. I used it in my website and it works.</p>\n\n<p>Right click your project in Solution Explorer, select Add->Existing Item, browse and choose your dll (select show all extensions). Then your dll will appear in Solution explorer.</p>\n\n<p>In the Solution Explorer, right-click your dll -> Properties. Set build action: Content, and Copy to Output Directory: Copy if newer (or always copy). </p>\n\n<p>It's done. Use your dll in your code staightforward like this:</p>\n\n<p>[DllImport(\"my_dll.dll\", CallingConvention = CallingConvention.Cdecl)]</p>\n"}], "owner": {"reputation": 689, "user_id": 973441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VhmtD.jpg?s=128&g=1", "display_name": "gemr1423", "link": "https://stackoverflow.com/users/973441/gemr1423"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9699, "favorite_count": 6, "accepted_answer_id": 39439464, "answer_count": 2, "score": 14, "last_activity_date": 1513076907, "creation_date": 1473276070, "question_id": 39377602, "link": "https://stackoverflow.com/questions/39377602/how-to-add-c-library-in-a-net-core-project", "title": "How to add C++ library in a .NET Core project", "body": "<p>How is the way to add a C++ Library in a .NET Core project (Class Library). I tried creating a nuget package but doesn't work. I got this error: </p>\n\n<p><code>An unhandled exception of type 'System.DllNotFoundException' occurred in \"NameOfDll.dll\"</code></p>\n\n<p>When I add the nuget package the project.json add the following reference:</p>\n\n<pre><code>  \"dependencies\": {\n    \"Core\": \"1.0.0-*\",\n    \"NETStandard.Library\": \"1.6.0\",\n    \"NameOfDll.dll\": \"1.0.0\"\n  },\n</code></pre>\n"}, {"tags": ["c++", "qt", "qprocess"], "comments": [{"owner": {"reputation": 1, "user_id": 6767848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dca27761a9ebc7c4ba5be566d56cde2?s=128&d=identicon&r=PG&f=1", "display_name": "ASDasasd Dasdasdrqw", "link": "https://stackoverflow.com/users/6767848/asdasasd-dasdasdrqw"}, "edited": false, "score": 0, "creation_date": 1473276655, "post_id": 39377563, "comment_id": 66083351, "body": "By the way, it works as I expected it to work, when I do it using WinAPI functions."}, {"owner": {"reputation": 1438, "user_id": 3732337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LzGs.jpg?s=128&g=1", "display_name": "HazemGomaa", "link": "https://stackoverflow.com/users/3732337/hazemgomaa"}, "edited": false, "score": 1, "creation_date": 1473279472, "post_id": 39377563, "comment_id": 66084628, "body": "<a href=\"http://stackoverflow.com/questions/2622864/start-a-process-using-qprocess\" title=\"start a process using qprocess\">stackoverflow.com/questions/2622864/&hellip;</a> duplicate ?"}], "answers": [{"comments": [{"owner": {"reputation": 7466, "user_id": 2146682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7120fc7548c43237662da906e3c84f43?s=128&d=identicon&r=PG", "display_name": "MrEricSir", "link": "https://stackoverflow.com/users/2146682/mrericsir"}, "edited": false, "score": 1, "creation_date": 1473278767, "post_id": 39377716, "comment_id": 66084310, "body": "&quot;C:\\&quot; is not a valid string literal in C++."}, {"owner": {"reputation": 1, "user_id": 6767848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dca27761a9ebc7c4ba5be566d56cde2?s=128&d=identicon&r=PG&f=1", "display_name": "ASDasasd Dasdasdrqw", "link": "https://stackoverflow.com/users/6767848/asdasasd-dasdasdrqw"}, "edited": false, "score": 0, "creation_date": 1473343914, "post_id": 39377716, "comment_id": 66112489, "body": "What is &#39;this&#39; here? I don&#39;t have any classes. I know about <code>system()</code>, but I want to use Qt&#39;s functions."}, {"owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "edited": false, "score": 0, "creation_date": 1473347216, "post_id": 39377716, "comment_id": 66114948, "body": "do you test <code>process-&gt;start()</code> in my answer?"}], "tags": [], "owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "is_accepted": false, "score": 1, "last_activity_date": 1473276640, "creation_date": 1473276640, "answer_id": 39377716, "question_id": 39377563, "link": "https://stackoverflow.com/questions/39377563/how-to-start-a-process-in-windows-using-qt/39377716#39377716", "title": "How to start a process in Windows using QT?", "body": "<p>use of bellow example :</p>\n\n<pre><code>QProcess *process = new QProcess(this);\nQString program = \"explorer.exe\";\nQString folder = \"C:\\\";\nprocess-&gt;start(program, QStringList() &lt;&lt; folder);\n</code></pre>\n\n<p>also you can use of <code>system()</code> as bellow :</p>\n\n<pre><code>system(\"C:/Windows/System32/cmd.exe\");\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6767848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dca27761a9ebc7c4ba5be566d56cde2?s=128&d=identicon&r=PG&f=1", "display_name": "ASDasasd Dasdasdrqw", "link": "https://stackoverflow.com/users/6767848/asdasasd-dasdasdrqw"}, "edited": false, "score": 0, "creation_date": 1473344266, "post_id": 39380234, "comment_id": 66112782, "body": "Detatched works fine, but this is not what is needed."}], "tags": [], "owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "is_accepted": false, "score": 1, "last_activity_date": 1473289286, "creation_date": 1473289286, "answer_id": 39380234, "question_id": 39377563, "link": "https://stackoverflow.com/questions/39377563/how-to-start-a-process-in-windows-using-qt/39380234#39380234", "title": "How to start a process in Windows using QT?", "body": "<p>How about this static call?</p>\n\n<pre><code>QProcess::startDetached(FilePath,Arguments,StartInDir);\n</code></pre>\n\n<p>No need to create any objects!</p>\n"}], "owner": {"reputation": 1, "user_id": 6767848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dca27761a9ebc7c4ba5be566d56cde2?s=128&d=identicon&r=PG&f=1", "display_name": "ASDasasd Dasdasdrqw", "link": "https://stackoverflow.com/users/6767848/asdasasd-dasdasdrqw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1433, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473289286, "creation_date": 1473275950, "question_id": 39377563, "link": "https://stackoverflow.com/questions/39377563/how-to-start-a-process-in-windows-using-qt", "title": "How to start a process in Windows using QT?", "body": "<p>I'm trying to start a console application on Windows using QProcess's method 'start'. Official documentation says I can do it like this:</p>\n\n<pre><code>QProcess process;\nprocess.start(\"C:/Windows/System32/cmd.exe\");\n</code></pre>\n\n<p>I expect that a standard greeting message will appear in the calling application's console, but this does not happen, though the called process is running. What is wrong here?</p>\n"}, {"tags": ["c++", "windows", "makefile", "linker-errors"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 1, "creation_date": 1473275714, "post_id": 39377428, "comment_id": 66082890, "body": "Of course the exe won&#39;t run if you use -c. It compiles the code as object file and doesn&#39;t link it into an executable. Nothing magical about it."}, {"owner": {"reputation": 6940, "user_id": 1559401, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/t9DjW.jpg?s=128&g=1", "display_name": "rbaleksandar", "link": "https://stackoverflow.com/users/1559401/rbaleksandar"}, "edited": false, "score": 0, "creation_date": 1473276006, "post_id": 39377428, "comment_id": 66083029, "body": "True. It&#39;s like creating a text file, renaming its file extension to <code>exe</code>  and wondering why it doesn&#39;t run. :D This is basically what the <code>helloworld</code> command does - it produces an <i>object file</i> but the output has the wrong file extension which makes Windows go nuts."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2717116"}, "edited": false, "score": 0, "creation_date": 1473276876, "post_id": 39377428, "comment_id": 66083453, "body": "alright, so user error on the -c flag then, I must have misunderstood what it does. as for the linker errors, that still doesn&#39;t help but ech."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2717116"}, "edited": false, "score": 0, "creation_date": 1473277623, "post_id": 39377428, "comment_id": 66083788, "body": "at least that&#39;s one down, will keep hacking at the makefile to see if I can get it to work at all."}], "answers": [{"comments": [{"owner": {"reputation": 6940, "user_id": 1559401, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/t9DjW.jpg?s=128&g=1", "display_name": "rbaleksandar", "link": "https://stackoverflow.com/users/1559401/rbaleksandar"}, "edited": false, "score": 0, "creation_date": 1473275970, "post_id": 39377513, "comment_id": 66083016, "body": "I was scratching my head and wondering &quot;Wait, doesn&#39;t <code>-c</code> just build the object file? Why on earth is there <code>helloworld.exe</code> as the output file?&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2717116"}, "edited": false, "score": 0, "creation_date": 1473276781, "post_id": 39377513, "comment_id": 66083403, "body": "so... user error then, gotcha.  while this does answer why the -c flag compiles just fine [somehow] it still doesn&#39;t help me with my linker errors and linker errors are hard to solve"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2717116"}, "edited": false, "score": 0, "creation_date": 1473277060, "post_id": 39377513, "comment_id": 66083539, "body": "as for the build line, sorry about that - brainfart when typing it in, updated it g++ -march=core2 -o hello_world.exe -g -m32 hello_world.cpp"}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473277143, "post_id": 39377513, "comment_id": 66083573, "body": "I do not see any dll/exe link recipe in your makefile."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2717116"}, "edited": false, "score": 0, "creation_date": 1473277468, "post_id": 39377513, "comment_id": 66083723, "body": "it creates a static library, that&#39;s what the -DPTW32_BUILD -DPTW32_STATIC_LIB -D_NEWTON_STATIC_LIB flags do, although I suppose I can hack at it by taking the posix32 makefile and hacking at it until it builds a shared version under windows, at this point I just care if I can get it to build."}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473277582, "post_id": 39377513, "comment_id": 66083770, "body": "So, do you have problems to create a static lib using <code>-c</code> switch in cpp source comiling recipe?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2717116"}, "edited": false, "score": 0, "creation_date": 1473282790, "post_id": 39377513, "comment_id": 66086125, "body": "library compiles (seemingly fine) with and without -c, I just can&#39;t link to it either way and I can&#39;t figure out exactly why, Analyzing the file in a hex editor reveals that the .a file has the general header structure of other libraries (compared to libglu32.a) so the library file looks correct. [note: comparing one built without -c, no idea what it&#39;d look like with -c left in there] but more or less yes, I&#39;m either having trouble getting the library to build (and thus link) correctly or I&#39;m somehow using the -l flag wrong but I doubt it."}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473283170, "post_id": 39377513, "comment_id": 66086275, "body": "What you mean you cant link it? You made a static library that is to be used as one of a linker inputs while linking the other project. And yes, in any case the *.cpp files should be only compiled (with <code>-c</code> switch)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2717116"}, "edited": false, "score": 0, "creation_date": 1473288132, "post_id": 39377513, "comment_id": 66087964, "body": "yes, I built a static library that is linked using -lNewton and I get undefined reference errors, that&#39;s what I&#39;m trying to figure out now."}], "tags": [], "owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "is_accepted": true, "score": 1, "last_activity_date": 1473275668, "creation_date": 1473275668, "answer_id": 39377513, "question_id": 39377428, "link": "https://stackoverflow.com/questions/39377428/mingw32-cant-link-to-library/39377513#39377513", "title": "mingw32 can&#39;t link to library", "body": "<p>Your problem is simple.</p>\n\n<p>the <code>-c</code> switch of <code>gcc</code> does only compilation step without linking and producing an executable module.</p>\n\n<p>The fact that you instructed <code>gcc</code> to write an output to a file with <code>.exe</code> extension makes no special meaning to the <code>gcc</code>. </p>\n\n<p>So you are just trying to execute the object file, so Winodws complains.</p>\n\n<p><hr>\nI assume that you mistyped the last arguments in the commands shown and they should read as <code>hello_world.c</code></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2717116"}, "is_accepted": false, "score": 0, "last_activity_date": 1474255352, "creation_date": 1474255352, "answer_id": 39564889, "question_id": 39377428, "link": "https://stackoverflow.com/questions/39377428/mingw32-cant-link-to-library/39564889#39564889", "title": "mingw32 can&#39;t link to library", "body": "<p>Alright, I finally narrowed down the root cause of not being able to compile or link anything.</p>\n\n<p>The cause being that the two libraries I already linked successfully are written to be C++98 compatible - these build and link fine.\nHowever newton dynamics and box2D that are also used by my framework [which is what I'm having trouble porting] are both dependent on C++11 or higher.</p>\n\n<p>This took a while to find because it never occurred to me that the problem may be with just the C++11 subset of the toolchain, I noticed it entirely coincidentally when I noticed that I can't build even the simplest c++11 projects (projects only using nullptr), if I were using g++ 4.5 or older this would be expected but it's been available since 4.6 and up.</p>\n\n<p>Thus we get to the troubleshooting, I take the hello world app (pretty standard but code included anyway) and build it using</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main()\n{\n    cout &lt;&lt; \"Hello world!\" &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>g++.exe -Wall -fexceptions -g -O2 -c gcc530_sanitytest\\main.cpp -o obj\\Debug\\main.o</p>\n\n<p>This works very well.</p>\n\n<p>if we then try with</p>\n\n<p>g++.exe -Wall -fexceptions -std=c++11 -g -O2 -c gcc530_sanitytest\\main.cpp -o obj\\Debug\\main.o</p>\n\n<p>then we get a slew of errors</p>\n\n<p>namely:</p>\n\n<pre><code>||=== Build: Debug in gcc530_sanitytest (compiler: GNU GCC Compiler) ===|\nc:\\mingw\\include\\sys\\stat.h|173|error: '_dev_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|173|error: '_ino_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|173|error: '_mode_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|173|error: '_dev_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|173|error: '_off_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|173|error: 'time_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|173|error: 'time_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|173|error: 'time_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|180|error: '_dev_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|180|error: '_ino_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|180|error: '_mode_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|180|error: '_dev_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|180|error: '_off_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|180|error: 'time_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|180|error: 'time_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|180|error: 'time_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|188|error: '_dev_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|188|error: '_ino_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|188|error: '_mode_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|188|error: '_dev_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|188|error: '__off64_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|188|error: 'time_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|188|error: 'time_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|188|error: 'time_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|195|error: '_dev_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|195|error: '_ino_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|195|error: '_mode_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|195|error: '_dev_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|195|error: '__off64_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|195|error: '__time64_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|195|error: '__time64_t' does not name a type|\nc:\\mingw\\include\\sys\\stat.h|195|error: '__time64_t' does not name a type|\nc:\\mingw\\include\\io.h|335|error: 'time_t' does not name a type|\nc:\\mingw\\include\\io.h|335|error: 'time_t' does not name a type|\nc:\\mingw\\include\\io.h|335|error: 'time_t' does not name a type|\nc:\\mingw\\include\\io.h|336|error: 'time_t' does not name a type|\nc:\\mingw\\include\\io.h|336|error: 'time_t' does not name a type|\nc:\\mingw\\include\\io.h|336|error: 'time_t' does not name a type|\nc:\\mingw\\include\\io.h|362|error: '__time64_t' does not name a type|\nc:\\mingw\\include\\io.h|362|error: '__time64_t' does not name a type|\nc:\\mingw\\include\\io.h|362|error: '__time64_t' does not name a type|\nc:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\cwchar|146|error: '::fwide' has not been declared|\nc:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\cwchar|153|error: '::mbsinit' has not been declared|\nc:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\cwchar|198|error: '::wmemcmp' has not been declared|\nc:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\cwchar|199|error: '::wmemcpy' has not been declared|\nc:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\cwchar|200|error: '::wmemmove' has not been declared|\nc:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\cwchar|201|error: '::wmemset' has not been declared|\nc:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\cwchar|208|error: '::wmemchr' has not been declared|\nc:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\cwchar||In function 'wchar_t* std::wmemchr(wchar_t*, wchar_t, std::size_t)':|\nc:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\cwchar|229|error: invalid conversion from 'const wchar_t*' to 'wchar_t*' [-fpermissive]|\nc:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\cwchar|228|note:   initializing argument 1 of 'wchar_t* std::wmemchr(wchar_t*, wchar_t, std::size_t)'|\nc:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\bits\\char_traits.h|353|error: 'wmemcmp' was not declared in this scope|\n||More errors follow but not being shown.|\n||Edit the max errors limit in compiler options...|\n||=== Build failed: 50 error(s), 0 warning(s) (0 minute(s), 0 second(s)) ===|\n</code></pre>\n\n<p>this thus leads to the obvious conclusion that the build environment is broken, this answers the question nicely enough as far as I'm concerned - still giving serge the confirmed answer because of reminding/educating me on what -c does (although it was not the root cause).</p>\n\n<p>perhaps this is the way mingw is designed to work but then it's broken by design (somehow I doubt that however, rather I see no reason why they would intentionally break C++11)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2717116"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "accepted_answer_id": 39377513, "answer_count": 2, "score": 0, "last_activity_date": 1474255352, "creation_date": 1473275296, "last_edit_date": 1473277023, "question_id": 39377428, "link": "https://stackoverflow.com/questions/39377428/mingw32-cant-link-to-library", "title": "mingw32 can&#39;t link to library", "body": "<p>Alright, so this is an interesting one that has been tested on two versions of mingw*, it's probably user error but google failed me.</p>\n\n<p>I still can't build more complex projects correctly even though they ought to, for example - let's take the example included in the newton physics engine sdk, it's a pretty simple program.</p>\n\n<p>first we build newton using the included makefile (as specifically recommended by a maintainer because cmake kept outputting broken makefiles), this is simple enough - it outputs a perfectly reasonable .a file.</p>\n\n<p>these are the flags in the newton makefile</p>\n\n<pre><code>-c -Wall -Wno-strict-aliasing  -DPTW32_BUILD -DPTW32_STATIC_LIB -D_NEWTON_STATIC_LIB -D_MINGW_32_VER -m32 -O2 -fpic -g -msse -msse3 -msse4 -mfpmath=sse -ffloat-store -ffast-math -freciprocal-math -funsafe-math-optimizations -fsingle-precision-constant -I$(DG_INCLUDED_PATH) -I$(DG_INCLUDED_PHYSICS_PATH) -I$(DG_INCLUDED_MESH_PATH) -I$(DG_INCLUDED_OPENCL_PATH)\n</code></pre>\n\n<p>however, if I then want to actually build the example then we get some slight problems.</p>\n\n<pre><code>g++ -march=core2 -o out.exe ex.cpp -g -m32 -lNewton 2&gt;&amp;1 | tee build.log\n</code></pre>\n\n<p>And what do we get? linker errors. undefined references everywhere because the name mangling doesn't seem to match</p>\n\n<p>I'm probably just overlooking something obvious but I'm a tad lost as to what that obvious thing would be.</p>\n\n<p>*g++.exe (TDM-2 mingw32) 4.4.1 and g++.exe (GCC) 5.3.0\nso that would be TDM mingw g++ 4.4.1 and vanilla mingw 5.3.0</p>\n\n<p>here's the makefile (you may notice some minor tweaks to the makefile from the default mingw32 makefile, that is because originally it didn't build at all until I fixed some whitespace problems):</p>\n\n<pre><code>#*******************************************************\n#\n# Newton game dynamics \n# copy right by Julio Jerez 2002 - 2012\n#\n#*******************************************************\n#\n# Generic makefile \n# this make file generate the libraries: \n# dg, physics, and newton\n#\n#*******************************************************  \n\n\n# ******************************************************\n#\n# dg low level library\n#\n# ******************************************************\nDG_INCLUDED_PATH = ../../source/core\nDG_PATH = $(DG_INCLUDED_PATH)/\nDG_SRCS = \\\n    $(DG_PATH)dgAABBPolygonSoup.cpp \\\n    $(DG_PATH)dgAsyncThread.cpp \\\n    $(DG_PATH)dgConvexHull3d.cpp \\\n    $(DG_PATH)dgConvexHull4d.cpp \\\n    $(DG_PATH)dg.cpp \\\n    $(DG_PATH)dgCRC.cpp \\\n    $(DG_PATH)dgDebug.cpp \\\n    $(DG_PATH)dgDelaunayTetrahedralization.cpp \\\n    $(DG_PATH)dgGeneralMatrix.cpp \\\n    $(DG_PATH)dgGeneralVector.cpp \\\n    $(DG_PATH)dgGoogol.cpp \\\n    $(DG_PATH)dgIntersections.cpp \\\n    $(DG_PATH)dgMatrix.cpp \\\n    $(DG_PATH)dgMemory.cpp \\\n    $(DG_PATH)dgMutexThread.cpp \\\n    $(DG_PATH)dgNode.cpp \\\n    $(DG_PATH)dgPolygonSoupBuilder.cpp \\\n    $(DG_PATH)dgPolyhedra.cpp \\\n    $(DG_PATH)dgPolyhedraMassProperties.cpp \\\n    $(DG_PATH)dgQuaternion.cpp \\\n    $(DG_PATH)dgRandom.cpp \\\n    $(DG_PATH)dgRefCounter.cpp \\\n    $(DG_PATH)dgRef.cpp \\\n    $(DG_PATH)dgSmallDeterminant.cpp \\\n    $(DG_PATH)dgSPDMatrix.cpp \\\n    $(DG_PATH)dgObb.cpp \\\n    $(DG_PATH)dgThread.cpp \\\n    $(DG_PATH)dgThreadHive.cpp \\\n    $(DG_PATH)dgTree.cpp \\\n    $(DG_PATH)dgTypes.cpp\n\n\n# ******************************************************\n#\n# Physics engine files\n#\n# ******************************************************\nDG_INCLUDED_PHYSICS_PATH = ../../source/physics\nDG_PHYSICS_PATH = $(DG_INCLUDED_PHYSICS_PATH)/\nDG_PHYSICS_SRCS = \\\n    $(DG_PHYSICS_PATH)dgBody.cpp \\\n    $(DG_PHYSICS_PATH)dgDynamicBody.cpp \\\n    $(DG_PHYSICS_PATH)dgKinematicBody.cpp \\\n    $(DG_PHYSICS_PATH)dgBallConstraint.cpp \\\n    $(DG_PHYSICS_PATH)dgBilateralConstraint.cpp \\\n    $(DG_PHYSICS_PATH)dgBody.cpp \\\n    $(DG_PHYSICS_PATH)dgDynamicBody.cpp \\\n    $(DG_PHYSICS_PATH)dgKinematicBody.cpp \\\n    $(DG_PHYSICS_PATH)dgBodyMasterList.cpp \\\n    $(DG_PHYSICS_PATH)dgBroadPhase.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionBox.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionBVH.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionCapsule.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionChamferCylinder.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionCompoundFractured.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionCompound.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionCone.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionConvex.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionConvexHull.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionConvexPolygon.cpp \\\n    $(DG_PHYSICS_PATH)dgCollision.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionCylinder.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionDeformableClothPatch.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionDeformableSolidMesh.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionDeformableMesh.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionHeightField.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionInstance.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionMesh.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionNull.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionScene.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionSphere.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionTaperedCapsule.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionTaperedCylinder.cpp \\\n    $(DG_PHYSICS_PATH)dgCollisionUserMesh.cpp \\\n    $(DG_PHYSICS_PATH)dgConstraint.cpp \\\n    $(DG_PHYSICS_PATH)dgContact.cpp \\\n    $(DG_PHYSICS_PATH)dgCorkscrewConstraint.cpp \\\n    $(DG_PHYSICS_PATH)dgDeformableBody.cpp \\\n    $(DG_PHYSICS_PATH)dgDeformableContact.cpp \\\n    $(DG_PHYSICS_PATH)dgHingeConstraint.cpp \\\n    $(DG_PHYSICS_PATH)dgNarrowPhaseCollision.cpp \\\n    $(DG_PHYSICS_PATH)dgSlidingConstraint.cpp \\\n    $(DG_PHYSICS_PATH)dgUniversalConstraint.cpp \\\n    $(DG_PHYSICS_PATH)dgUpVectorConstraint.cpp \\\n    $(DG_PHYSICS_PATH)dgUserConstraint.cpp \\\n    $(DG_PHYSICS_PATH)dgWorld.cpp \\\n    $(DG_PHYSICS_PATH)dgDeformableBodiesUpdate.cpp \\\n    $(DG_PHYSICS_PATH)dgWorldDynamicsParallelSolver.cpp \\\n    $(DG_PHYSICS_PATH)dgWorldDynamicsSimpleSolver.cpp \\\n    $(DG_PHYSICS_PATH)dgWorldDynamicUpdate.cpp\n\n\n# ******************************************************\n#\n# mesh gemotry \n#\n# ******************************************************\nDG_INCLUDED_MESH_PATH = ../../source/meshUtil\nDG_MESH_PATH = $(DG_INCLUDED_MESH_PATH)/\nDG_MESH_SRCS = \\\n    $(DG_MESH_PATH)dgMeshEffect1.cpp \\\n    $(DG_MESH_PATH)dgMeshEffect2.cpp \\\n    $(DG_MESH_PATH)dgMeshEffect3.cpp \\\n    $(DG_MESH_PATH)dgMeshEffect4.cpp \\\n    $(DG_MESH_PATH)dgMeshEffect5.cpp \\\n    $(DG_MESH_PATH)dgMeshEffect6.cpp \n\n# ******************************************************\n#\n# open cl \n#\n# ******************************************************\nDG_INCLUDED_OPENCL_PATH = ../../source/openCL\nDG_OPENCL_PATH = $(DG_INCLUDED_OPENCL_PATH)/\n#DG_OPENCL_SRCS = \\\n#   $(DG_OPENCL_PATH)dgOpencl.cpp \\\n#   $(DG_OPENCL_PATH)dgOpenclInstance.cpp \\\n#   $(DG_OPENCL_PATH)dgOpenclBroadPhase.cpp\n\n\n\n# ******************************************************\n#\n# Newton engine files\n#g++ -shared -o libNewton.dll libNewton.a\n# ******************************************************\nDG_INCLUDED_NEWTON_PATH = ../../source/newton\nDG_NEWTON_PATH = $(DG_INCLUDED_NEWTON_PATH)/\nDG_NEWTON_SRCS = \\\n    $(DG_NEWTON_PATH)Newton.cpp \\\n    $(DG_NEWTON_PATH)NewtonClass.cpp\n\n# ******************************************************\n#\n# Allsource files\n#\n# ******************************************************\nALL_SRC_FILES = $(DG_SRCS) $(DG_PHYSICS_SRCS) $(DG_OPENCL_SRCS) $(DG_MESH_SRCS) $(DG_NEWTON_SRCS)\nDG_OBJ_FILES = $(ALL_SRC_FILES:.cpp=.o)\n\nCOMPILER = gcc\n\n# mingw options  gcc 4.4.2\n#CPU_FLAGS = -m32 -O0 -fPIC -g -msse -msse2 -mfpmath=sse \n#CPU_FLAGS = -m32 -O0 -fPIC -g -msse -msse4.1 -mfpmath=sse \n#CPU_FLAGS = -m32 -O2 -fpic -g -msse -msse4.1 -mfpmath=sse -ffloat-store -ffast-math -freciprocal-math -funsafe-math-optimizations -fsingle-precision-constant\nCPU_FLAGS = -m32 -O2 -fpic -g -msse -msse3 -msse4 -mfpmath=sse -ffloat-store -ffast-math -freciprocal-math -funsafe-math-optimizations -fsingle-precision-constant\n\nFLAGS  = -Wall -Wno-strict-aliasing  -DPTW32_BUILD -DPTW32_STATIC_LIB -D_NEWTON_STATIC_LIB -D_MINGW_32_VER $(CPU_FLAGS) -I$(DG_INCLUDED_PATH) -I$(DG_INCLUDED_PHYSICS_PATH) -I$(DG_INCLUDED_MESH_PATH) -I$(DG_INCLUDED_OPENCL_PATH)\n\n.SUFFIXES : .o .cpp\n.cpp.o :\n    $(COMPILER) $(FLAGS) -o $@ $&lt;\n\n# main target\nengine : libNewton.a\n\n\n# clean all objects target\nclean :\n    rm $(DG_OBJ_FILES)\n    touch $(ALL_SRC_FILES)\n\n# libraries targets\nlibNewton.a : $(DG_OBJ_FILES)\n    ar r $@ $?\n    strip -g -S -d -v libNewton.a -o libNewton.a\n    cp libNewton.a ../../../packages/mingw32/libNewton.a\n    cp ../../source/newton/Newton.h ../../../packages/mingw32/Newton.h\n#   $(COMPILER) -shared -Wl,-soname,libNewton.dll $? -o libNewton.dll \n#   cp libNewton.dll ../../../packages/mingw32/libNewton.dll\n    #sudo cp libNewton.dll /usr/lib\n</code></pre>\n\n<p>and the linker errors I get if I build without -c (all of the newton functionality is undefined, this is not a surprise to anyone since that's what -c is meant to do but the fact that it breaks for even the simplest of test cases implies something is wrong)</p>\n\n<pre><code>C:\\Users\\Thunder\\AppData\\Local\\Temp\\cchfxWSh.o: In function `Z20CreateBackgroundBodyP11NewtonWorld':\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:17: undefined reference to `_imp__NewtonCreateTreeCollision'\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:20: undefined reference to `_imp__NewtonTreeCollisionBeginBuild'\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:23: undefined reference to `_imp__NewtonTreeCollisionAddFace'\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:26: undefined reference to `_imp__NewtonTreeCollisionEndBuild'\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:29: undefined reference to `dGetIdentityMatrix()'\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:30: undefined reference to `_imp__NewtonCreateDynamicBody'\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:33: undefined reference to `_imp__NewtonDestroyCollision'\nC:\\Users\\Thunder\\AppData\\Local\\Temp\\cchfxWSh.o: In function `ApplyGravity':\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:45: undefined reference to `_imp__NewtonBodyGetMassMatrix'\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:47: undefined reference to `_imp__NewtonBodySetForce'\nC:\\Users\\Thunder\\AppData\\Local\\Temp\\cchfxWSh.o: In function `Z18CreateFreeFallBallP11NewtonWorld':\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:53: undefined reference to `_imp__NewtonCreateSphere'\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:56: undefined reference to `dGetIdentityMatrix()'\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:58: undefined reference to `_imp__NewtonCreateDynamicBody'\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:61: undefined reference to `_imp__NewtonBodySetForceAndTorqueCallback'\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:65: undefined reference to `_imp__NewtonBodySetMassProperties'\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:68: undefined reference to `_imp__NewtonBodySetLinearDamping'\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:71: undefined reference to `_imp__NewtonDestroyCollision'\nC:\\Users\\Thunder\\AppData\\Local\\Temp\\cchfxWSh.o: In function `main':\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:79: undefined reference to `_imp__NewtonCreate'\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:86: undefined reference to `_imp__NewtonInvalidateCache'\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:90: undefined reference to `_imp__NewtonUpdate'\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:93: undefined reference to `_imp__NewtonBodyGetMatrix'\nC:\\Users\\Thunder\\Documents\\projects\\libproto framework\\src/ex.cpp:98: undefined reference to `_imp__NewtonDestroy'\ncollect2.exe: error: ld returned 1 exit status\n</code></pre>\n"}, {"tags": ["c++", "object", "constructor", "member-initialization"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1473275191, "post_id": 39377396, "comment_id": 66082646, "body": "What is the reason for this?  Do you need some code to run to determine what the members should be set to?"}, {"owner": {"reputation": 685, "user_id": 2868284, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/76f42be013abf833273224eb4eaef29c?s=128&d=identicon&r=PG", "display_name": "cenouro", "link": "https://stackoverflow.com/users/2868284/cenouro"}, "edited": false, "score": 0, "creation_date": 1473275251, "post_id": 39377396, "comment_id": 66082668, "body": "The class function could be implemented to construct and return a new object, like a factory."}, {"owner": {"reputation": 65, "user_id": 1901609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93dfe021ac5e68d758085e3b4c8391ef?s=128&d=identicon&r=PG", "display_name": "Neobonde", "link": "https://stackoverflow.com/users/1901609/neobonde"}, "edited": false, "score": 0, "creation_date": 1473275597, "post_id": 39377396, "comment_id": 66082827, "body": "I need to load some files before i can create my objects because the require the files as parameters."}, {"owner": {"reputation": 1739, "user_id": 4538963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ba105f9fb46af4d9825e87fd585d2f3?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel de Grimouard", "link": "https://stackoverflow.com/users/4538963/gabriel-de-grimouard"}, "edited": false, "score": 1, "creation_date": 1473275764, "post_id": 39377396, "comment_id": 66082917, "body": "Then use a factory or create a method initialize for your object and call this method once you have loaded your files to initialize your object."}, {"owner": {"reputation": 65, "user_id": 1901609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93dfe021ac5e68d758085e3b4c8391ef?s=128&d=identicon&r=PG", "display_name": "Neobonde", "link": "https://stackoverflow.com/users/1901609/neobonde"}, "edited": false, "score": 0, "creation_date": 1473276026, "post_id": 39377396, "comment_id": 66083039, "body": "Can you guide me in the direction of where i can learn more about factories. I have not worked with that yet."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1473276108, "post_id": 39377396, "comment_id": 66083088, "body": "<code>C++ factory method pattern</code> via google-fu will bring back <i>hundreds</i> of topics on the subject."}], "owner": {"reputation": 65, "user_id": 1901609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93dfe021ac5e68d758085e3b4c8391ef?s=128&d=identicon&r=PG", "display_name": "Neobonde", "link": "https://stackoverflow.com/users/1901609/neobonde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473275117, "creation_date": 1473275117, "question_id": 39377396, "link": "https://stackoverflow.com/questions/39377396/is-it-possible-to-initialize-an-object-in-a-class-function-not-in-constructor", "title": "Is it possible to initialize an object in a class function, not in constructor", "body": "<p>Hey i am looking to see if there is a way for me to initialize a member object in a class function. Meaning i would like not to use the member initializer list.</p>\n\n<p>I don't want:<code>Foo::Foo(): bar(), barBar(){}</code></p>\n\n<p>but want: <code>Foo::setup(){bar(); barBar() }</code></p>\n\n<p>Hope you can help me out here.</p>\n"}, {"tags": ["c++", "mfc", "ctabctrl"], "comments": [{"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 0, "creation_date": 1473275045, "post_id": 39377360, "comment_id": 66082569, "body": "What&#39;s your actual problem? That you&#39;re seeing an assert fail?"}, {"owner": {"reputation": 21, "user_id": 6272273, "user_type": "registered", "profile_image": "https://graph.facebook.com/1697577057183388/picture?type=large", "display_name": "Pablo Iocco", "link": "https://stackoverflow.com/users/6272273/pablo-iocco"}, "reply_to_user": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 0, "creation_date": 1473275186, "post_id": 39377360, "comment_id": 66082641, "body": "My problem is that I can&#39;t change the properties of the controls, when I try to do it I get an assert fail."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 2, "creation_date": 1473276103, "post_id": 39377360, "comment_id": 66083081, "body": "Please post the <b>exact</b> error message of the assertion dialog. You can copy the text using [Ctrl]+C. A screenshot can help, but that&#39;s not strictly required."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 0, "creation_date": 1473276174, "post_id": 39377360, "comment_id": 66083116, "body": "@LynnCrumbling: <code>UpdateData</code> is an MFC implementation, that stores data from controls to attached instance variables, or restores the control contents back (depending on the argument)."}, {"owner": {"reputation": 21, "user_id": 6272273, "user_type": "registered", "profile_image": "https://graph.facebook.com/1697577057183388/picture?type=large", "display_name": "Pablo Iocco", "link": "https://stackoverflow.com/users/6272273/pablo-iocco"}, "edited": false, "score": 0, "creation_date": 1473276557, "post_id": 39377360, "comment_id": 66083302, "body": "--------------------------- Microsoft Visual C++ Runtime Library --------------------------- Debug Assertion Failed!  Program: C:\\Windows\\SYSTEM32\\mfc140d.dll File: f:\\dd\\vctools\\vc7libs\\ship\\atlmfc\\src\\mfc\\wincore.cpp Line: 4355  For information on how your program can cause an assertion failure, see the Visual C++ documentation on asserts."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1473276959, "post_id": 39377360, "comment_id": 66083491, "body": "The line of code that fails is <code>ASSERT(::IsWindow(m_hWnd)); &#47;&#47; calling UpdateData before DoModal?</code> (the comment is interesting). Unless I&#39;m using a different version of MFC than you are. You should <a href=\"http://stackoverflow.com/posts/39377360/edit\">update</a> your question and include both the assertion dialog text as well as the code with the failed assertion (press <i>Debug</i> to get there), including a few more lines."}, {"owner": {"reputation": 21, "user_id": 6272273, "user_type": "registered", "profile_image": "https://graph.facebook.com/1697577057183388/picture?type=large", "display_name": "Pablo Iocco", "link": "https://stackoverflow.com/users/6272273/pablo-iocco"}, "edited": false, "score": 0, "creation_date": 1473278574, "post_id": 39377360, "comment_id": 66084215, "body": "I updated the post, but I don&#39;t understand what you are saying about calling UpdateData before doModal"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6272273, "user_type": "registered", "profile_image": "https://graph.facebook.com/1697577057183388/picture?type=large", "display_name": "Pablo Iocco", "link": "https://stackoverflow.com/users/6272273/pablo-iocco"}, "edited": false, "score": 0, "creation_date": 1473278641, "post_id": 39377848, "comment_id": 66084244, "body": "I tried this, ConfigDialog is one of the childDialog of the mainDialog, But I&#39;m no sure if I understand what you are saying"}, {"owner": {"reputation": 5085, "user_id": 1181353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zqKlZ.jpg?s=128&g=1", "display_name": "Joseph Willcoxson", "link": "https://stackoverflow.com/users/1181353/joseph-willcoxson"}, "reply_to_user": {"reputation": 21, "user_id": 6272273, "user_type": "registered", "profile_image": "https://graph.facebook.com/1697577057183388/picture?type=large", "display_name": "Pablo Iocco", "link": "https://stackoverflow.com/users/6272273/pablo-iocco"}, "edited": false, "score": 0, "creation_date": 1473279673, "post_id": 39377848, "comment_id": 66084710, "body": "You are trying to get text from and edit control.  Is the control a child of the dialog or is it a child of the tab?  In addition, are you calling UpdateData() before you call DoModal?  You have to call DoModal before you can call UpdateData."}, {"owner": {"reputation": 21, "user_id": 6272273, "user_type": "registered", "profile_image": "https://graph.facebook.com/1697577057183388/picture?type=large", "display_name": "Pablo Iocco", "link": "https://stackoverflow.com/users/6272273/pablo-iocco"}, "edited": false, "score": 0, "creation_date": 1473279994, "post_id": 39377848, "comment_id": 66084868, "body": "The edit control is a child of the tab, Do I have to call DoModal in the main dialog o in the tab dialog?"}, {"owner": {"reputation": 5085, "user_id": 1181353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zqKlZ.jpg?s=128&g=1", "display_name": "Joseph Willcoxson", "link": "https://stackoverflow.com/users/1181353/joseph-willcoxson"}, "reply_to_user": {"reputation": 21, "user_id": 6272273, "user_type": "registered", "profile_image": "https://graph.facebook.com/1697577057183388/picture?type=large", "display_name": "Pablo Iocco", "link": "https://stackoverflow.com/users/6272273/pablo-iocco"}, "edited": false, "score": 0, "creation_date": 1473280592, "post_id": 39377848, "comment_id": 66085107, "body": "I don&#39;t know.  There is not enough intormation. If the edit control is a child of the tab, then you have to call SetDlgItemText and GetDlgItemText with it."}], "tags": [], "owner": {"reputation": 5085, "user_id": 1181353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zqKlZ.jpg?s=128&g=1", "display_name": "Joseph Willcoxson", "link": "https://stackoverflow.com/users/1181353/joseph-willcoxson"}, "is_accepted": false, "score": 0, "last_activity_date": 1473277214, "creation_date": 1473277214, "answer_id": 39377848, "question_id": 39377360, "link": "https://stackoverflow.com/questions/39377360/controls-handling-in-a-ctabctrl-mfc/39377848#39377848", "title": "Controls handling in a CTabCtrl MFC", "body": "<p>I assume it's an edit control because it has the ID of IDC_EDIT1.  The ASSERT is being given because you do no have a window with the ID of IDC_EDIT1 as a child window of ConfigDialog.  Is it a child of one of the tab controls?  The DDX_* macros will only work for child windows of your dialog class.</p>\n\n<p>If you have a child window of some tab, try something like:</p>\n\n<pre><code>tabCtrl.SetDlgItemText(IDC_EDIT1, valueTest);\n</code></pre>\n\n<p>To retrieve it,</p>\n\n<pre><code>tabCtrl.GetDlgItemTText(IDC_EDIT1, valueTest);\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6272273, "user_type": "registered", "profile_image": "https://graph.facebook.com/1697577057183388/picture?type=large", "display_name": "Pablo Iocco", "link": "https://stackoverflow.com/users/6272273/pablo-iocco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 738, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473278385, "creation_date": 1473274905, "last_edit_date": 1473278385, "question_id": 39377360, "link": "https://stackoverflow.com/questions/39377360/controls-handling-in-a-ctabctrl-mfc", "title": "Controls handling in a CTabCtrl MFC", "body": "<p>I have a MFC application that have a class who inherits from CTabCtrl, on my Main Dialog::OnInit() Method I do.</p>\n\n<pre><code>tabCtrl.InsertItem(0, _T(\"Tab 1\"));\ntabCtrl.InsertItem(1, _T(\"Tab 2\"));\ntabCtrl.InitDialogs();\n\ntabCtrl.ActivateTabDialogs();\ntabCtrl.ShowWindow(SW_SHOW);\n</code></pre>\n\n<p>tabCtrl is a variable from a class that inherits from CTabCtrl, the method InitDialogs is:</p>\n\n<pre><code>m_Dialog[0]-&gt;Create(m_DialogID[0], this);\nm_Dialog[1]-&gt;Create(m_DialogID[1], this);\nm_Dialog[0]-&gt;ShowWindow(SW_SHOW);\n</code></pre>\n\n<p>m_Dialog* is contains both dialog class that I drawn from the resource class.</p>\n\n<p>I see both tabs as I drawn it when I run the program, but when I do something like</p>\n\n<pre><code>UpdateData(TRUE);\nvalueTest = \"tEST\";\nUpdateData(FALSE);\n</code></pre>\n\n<p>I get an assertion fail error. My DoDataExchange is being called and it looks like:</p>\n\n<pre><code> void ConfigDialog::DoDataExchange(CDataExchange* pDX)\n{\n    CDialogEx::DoDataExchange(pDX);\n    DDX_Text(pDX, IDC_EDIT1, valueTest);\n}\n</code></pre>\n\n<p>I've been strugling with this for days, and I only been able to found examples with dummy tabs who doesn't have any controls inside them. Is there any step that I'm missing?</p>\n\n<p>Update: The assertion error show this</p>\n\n<blockquote>\n  <p>Microsoft Visual C++ Runtime Library ---------------------------\n  Debug Assertion Failed! Program: C:\\Windows\\SYSTEM32\\mfc140d.dll File:\n  f:\\dd\\vctools\\vc7libs\\ship\\atlmfc\\src\\mfc\\wincore.cpp Line: 4355 For\n  information on how your program can cause an assertion failure, see\n  the Visual C++ documentation on asserts</p>\n</blockquote>\n\n<p>And it fails to UpdateData(TRUE) sentence</p>\n"}, {"tags": ["c++", "image", "qt", "opencv", "image-processing"], "comments": [{"owner": {"reputation": 473, "user_id": 3663774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t64yX.jpg?s=128&g=1", "display_name": "ikaro", "link": "https://stackoverflow.com/users/3663774/ikaro"}, "edited": false, "score": 0, "creation_date": 1473315196, "post_id": 39377345, "comment_id": 66094533, "body": "The problem could be that you are running the program in a external terminal. Just configure your QtCreator to disable it in <code>Check Projects -&gt; Run Settings -&gt; Run in terminal</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2174, "user_id": 5876041, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-CBOOazSg3-c/AAAAAAAAAAI/AAAAAAAAAao/6MQIFAQGtGY/photo.jpg?sz=128", "display_name": "Saransh Kejriwal", "link": "https://stackoverflow.com/users/5876041/saransh-kejriwal"}, "is_accepted": false, "score": 0, "last_activity_date": 1475053340, "creation_date": 1475053340, "answer_id": 39742692, "question_id": 39377345, "link": "https://stackoverflow.com/questions/39377345/image-is-not-being-shown-in-opencv-in-qt/39742692#39742692", "title": "Image is not being shown in OpenCV in Qt", "body": "<p>Try:</p>\n\n<pre><code>int main( )\n{\n    Mat image=imread(\"C:/Users/richa/Desktop/IMG-20150324-WA0001.jpg\",CV_LOAD_IMAGE_COLOR); // Read the file\n\n\n    if( image.empty() )                      // Check for invalid input\n    {\n        cout &lt;&lt;  \"Could not open or find the image\" &lt;&lt; std::endl ;\n        return -1;\n    }\n\n    namedWindow(\"Image\",WINDOW_AUTOSIZE); // Create a window for display.\n\n    for(;;)//infinite loop\n    {\n    imshow( \"Image\", image );                // Show our image inside it.\n\n    char c=waitKey(10); // Wait for a keystroke in the window for 10ms, then move on\n    if(c=='b' || c=='B')//if b is pressed\n    break;\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 265, "user_id": 5785252, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/2cbd388c49f217c0356ebaa01095e5f3?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek Mangal", "link": "https://stackoverflow.com/users/5785252/vivek-mangal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475053340, "creation_date": 1473274852, "question_id": 39377345, "link": "https://stackoverflow.com/questions/39377345/image-is-not-being-shown-in-opencv-in-qt", "title": "Image is not being shown in OpenCV in Qt", "body": "<p>I am new to OpenCV and using it in Qt Creator. I want to display an image. My code is:</p>\n\n<pre><code>#include &lt;opencv2/core/core.hpp&gt;\n#include &lt;opencv2/highgui/highgui.hpp&gt;\n\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nusing namespace cv;\nusing namespace std;\n\nint main( )\n{\n    Mat image=imread(\"C:/Users/richa/Desktop/IMG-20150324-WA0001.jpg\",CV_LOAD_IMAGE_COLOR); // Read the file\n\n\n    if( image.empty() )                      // Check for invalid input\n    {\n        cout &lt;&lt;  \"Could not open or find the image\" &lt;&lt; std::endl ;\n        return -1;\n    }\n\n    namedWindow(\"Image\",WINDOW_AUTOSIZE); // Create a window for display.\n    imshow( \"Image\", image );                // Show our image inside it.\n\n    waitKey(); // Wait for a keystroke in the window\n    return 0;\n}\n</code></pre>\n\n<p>Output is only a console window with no image. Also the program exits with code -1073741511. Why the image is not being loaded in a new window?\nScreenshot:\n<a href=\"https://i.stack.imgur.com/zS3nU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zS3nU.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "oop", "c++11", "destructor"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1473274601, "post_id": 39377239, "comment_id": 66082360, "body": "Why not call <code>reset</code> on the <code>unique_ptr</code> which clears the pointer and destroys the object it pointed to?"}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1473275186, "post_id": 39377239, "comment_id": 66082642, "body": "This isn&#39;t really related to your question so I put it as a comment, but FYI while smart pointers are the preferred way to handle heap allocations, even more preferred is not to use the heap at all. Unless you have inheritance hierarchy (which may or may not be a good idea) with <code>Entity</code> as the base, it would just be preferable to create local variables on the stack instead of using pointers."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3325043"}, "edited": false, "score": 0, "creation_date": 1473275053, "post_id": 39377329, "comment_id": 66082573, "body": "Sadly you did not answer my question. I already know that this is bad, but I do not want to <i>wait</i> for my eaten entity to run out of scope. If it is consumed by another entity it should die and be removed from the memory. Otherwise a entity could be eaten multiple times."}], "tags": [], "owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "is_accepted": false, "score": 0, "last_activity_date": 1473274788, "creation_date": 1473274788, "answer_id": 39377329, "question_id": 39377239, "link": "https://stackoverflow.com/questions/39377239/is-it-a-bad-design-decision-to-manually-call-the-destructor-in-the-following-cas/39377329#39377329", "title": "Is it a bad design decision to manually call the destructor in the following case?", "body": "<p>Yes, plese don't manually do it.\nThis one of the few things that you actually do <em>not</em> have to care about. Your program does that for you!\nThe rule is: once a variable leaves the scope, it get's thrown away (desconstructor get's called). Except for dynamic allocated memory, there you need to free (delte) the variable/s.</p>\n\n<p>Also if you manually delete a variable, your program crashes:</p>\n\n<pre><code>{\n    Type variable;\n    delete variable;\n} //Scope end: deconstructor get's called. ERROR: already deleated, undefined behaviour, crash. everything destroyed.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1473287385, "post_id": 39377351, "comment_id": 66087735, "body": "Or, pass the <code>std::unique_ptr</code> by reference to <code>eat()</code>, and then <code>eat()</code> can call <code>reset()</code> on it, thus still destroying the object without having to actually take ownership of it, or needing the caller to <code>std::move()</code> to transfer ownership. <code>void Entity::eat(std::unique_ptr&lt;Edible&gt; &amp;subject) { energy += subject-&gt;getNutritionalInformation(); subject.reset(); }</code> ... <code>e1-&gt;eat(e2);</code>"}], "tags": [], "owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "is_accepted": true, "score": 12, "last_activity_date": 1473274878, "creation_date": 1473274878, "answer_id": 39377351, "question_id": 39377239, "link": "https://stackoverflow.com/questions/39377239/is-it-a-bad-design-decision-to-manually-call-the-destructor-in-the-following-cas/39377351#39377351", "title": "Is it a bad design decision to manually call the destructor in the following case?", "body": "<p>Well, by <code>e2</code> \"eating\" <code>e1</code> it is actually taking ownership of it. Specifically, it has to take ownership of it, in order to destroy it. So the way to do it is actually this:</p>\n\n<pre><code>void Entity::eat(std::unique_ptr&lt;Edible&gt; subject) {\n    this-&gt;energy += subject-&gt;getNutritionalInformation();\n}\n</code></pre>\n\n<p>And... that's it. the subject will automatically be destroyed at the end of scope. In order to use this, you'll need to call <code>std::move</code> explicitly; this indicates that you are <em>transferring</em> ownership from the calling scope, into e2.</p>\n\n<pre><code>std::unique_ptr&lt;Entity&gt; e1(new Entity);\nstd::unique_ptr&lt;Entity&gt; e2(new Entity);\n\nstd::cout &lt;&lt; \"Pre feasting energy: \" &lt;&lt; e1-&gt;getNutritionalInformation() &lt;&lt; std::endl;\ne1-&gt;eat(std::move(e2));\nstd::cout &lt;&lt; \"After feasting energy: \" &lt;&lt; e1-&gt;getNutritionalInformation( &lt;&lt; std::endl;\n</code></pre>\n\n<p>Note that after <code>std::move</code> has been called on <code>e2</code>, <code>e2</code> can no longer be assumed to actually point to an entity (since ownership has been transferred).</p>\n"}, {"tags": [], "owner": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "is_accepted": false, "score": 1, "last_activity_date": 1473274897, "creation_date": 1473274897, "answer_id": 39377357, "question_id": 39377239, "link": "https://stackoverflow.com/questions/39377239/is-it-a-bad-design-decision-to-manually-call-the-destructor-in-the-following-cas/39377357#39377357", "title": "Is it a bad design decision to manually call the destructor in the following case?", "body": "<p>You want the owner of <code>e2</code> to call <code>delete</code> on its variable to prevent problems down the line.</p>\n\n<p>You can accomplish this in two ways:</p>\n\n<pre><code>e1-&gt;eat(std::move(e2));\nvoid Entity::eat(std::unique_ptr&lt;Edible&gt; subject) {\n    this-&gt;energy += subject-&gt;getNutritionalInformation();\n}\n</code></pre>\n\n<p>Or alternatively:</p>\n\n<pre><code>e1-&gt;eat(*e2);\ne2.reset(nullptr);\n</code></pre>\n\n<p>In either case your caller (the function in your first example) knows that <code>e2</code> is being destroyed by the operation, in the first instance I gave that is because you moved out of it, in the second because it manually called <code>reset</code> (which destroys the old pointer).</p>\n"}, {"tags": [], "owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "is_accepted": false, "score": 0, "last_activity_date": 1473276399, "creation_date": 1473276399, "answer_id": 39377661, "question_id": 39377239, "link": "https://stackoverflow.com/questions/39377239/is-it-a-bad-design-decision-to-manually-call-the-destructor-in-the-following-cas/39377661#39377661", "title": "Is it a bad design decision to manually call the destructor in the following case?", "body": "<p>Other way around is to have some higher level manager controlling life cycles of entities, so the e2 during eat would do only: e1->kill(); e1->eatenEnergy(energy); (lowering it's nutritional value, if partly eaten entities are possible).</p>\n\n<p>And wait till the entities manager gets its turn, to cycle trough all entities (or react to reported signals, like death event from inside e1->kill() implementation) and releasing those which are dead and completely eaten/decayed/etc (killing those which are hungry, ...).</p>\n\n<p>Depends a lot if you want to keep in the simple event-based world like your current example, or you want some \"life cycles\" to happen in the world, while the [memory/instance] management is centralized in single class.</p>\n\n<p>I think centralized managers would complicate things a bit, but then some possibilities should be easier with them, like better debug-check of initial/end state of turn, prioritize some entities processing, reuse memory of entities (w/o dynamic allocation), etc..</p>\n\n<p>In both cases you should thing ahead, how some corner-case situations (mostly race conditions) will be resolved, like:</p>\n\n<ul>\n<li>e1 is wanting to eat e2 at the same time, as e2 wants to eat e1</li>\n<li>both e1 and e3 wants to eat e2 at the same time</li>\n<li>e3 trying to eat e2 after it was already eaten by e1 (e2 is \"dead\" but allocated)</li>\n</ul>\n\n<p>So the state of entities should be designed to be valid in such situation, and ending in desired result.</p>\n"}, {"tags": [], "owner": {"reputation": 197, "user_id": 6227513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84125f15bf73242bcd2e31dc030444a5?s=128&d=identicon&r=PG&f=1", "display_name": "Osama Khalid", "link": "https://stackoverflow.com/users/6227513/osama-khalid"}, "is_accepted": false, "score": 1, "last_activity_date": 1473287188, "last_edit_date": 1473287188, "creation_date": 1473277774, "answer_id": 39377987, "question_id": 39377239, "link": "https://stackoverflow.com/questions/39377239/is-it-a-bad-design-decision-to-manually-call-the-destructor-in-the-following-cas/39377987#39377987", "title": "Is it a bad design decision to manually call the destructor in the following case?", "body": "<p>An object's destructor is called automatically when <code>std::unique_ptr</code> goes out of scope.  You don't need to worry about it.</p>\n\n<p>Manually destroying an object may cause problems.  In this case, when <code>eat()</code> manually destroys the <code>subject</code> object, the <code>std::unique_ptr</code> which owns that object does not know the object has been destroyed, and will crash when it tries to destroy the object again a second time.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3325043"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 39377351, "answer_count": 5, "score": 3, "last_activity_date": 1473287188, "creation_date": 1473274475, "question_id": 39377239, "link": "https://stackoverflow.com/questions/39377239/is-it-a-bad-design-decision-to-manually-call-the-destructor-in-the-following-cas", "title": "Is it a bad design decision to manually call the destructor in the following case?", "body": "<p>so I am currently working on my OOP/C++ skills and stumbled upon the following case:</p>\n\n<p>I am making a game which is populated by entities, which have to eat in order to survive. They can either eat other entities or food. In order to achieve this behaviour I created an <code>edible</code> interface which forces every implementing class to create a <code>getNutritionalInformation()</code> method to calculate how saturated a unit will be after feasting.</p>\n\n<p>So the whole thing is supposed to work like this code-wise:</p>\n\n<pre><code>std::unique_ptr&lt;Entity&gt; e1(new Entity);\nstd::unique_ptr&lt;Entity&gt; e2(new Entity);\n\nstd::cout &lt;&lt; \"Pre feasting energy: \" &lt;&lt; e1-&gt;getNutritionalInformation() &lt;&lt; std::endl;\ne1-&gt;eat(*e2);\nstd::cout &lt;&lt; \"After feasting energy: \" &lt;&lt; e1-&gt;getNutritionalInformation() &lt;&lt; std::endl;\n</code></pre>\n\n<p>After this operation <code>c1</code>s energy should be higher than before, this value is currently randomly assigned during creation of an entity. But in order to simulate the <em>death</em> of the eaten entity I want to manually <em>kill</em> it while it is being eaten. I achieved this the following way:</p>\n\n<pre><code>void Entity::eat(Edible&amp; subject) {\n   this-&gt;energy += subject.getNutritionalInformation();\n   delete &amp;subject;\n}\n</code></pre>\n\n<p>But in the end this simply seems kind of dirty to me, I would really like to let the smart pointer know in some way, that the object it currently holds/points to is not valid any longer. Is there a cleaner way to achieve this? I am pretty sure the way I am trying to do this is very hacky and not considered proper OOP programming. </p>\n\n<p>Thank you for your help in advance.</p>\n"}, {"tags": ["c++", "loops", "dictionary", "memory"], "comments": [{"owner": {"reputation": 489, "user_id": 5432349, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a49c998284a38d23d9e741472f26eef5?s=128&d=identicon&r=PG&f=1", "display_name": "FallenWarrior", "link": "https://stackoverflow.com/users/5432349/fallenwarrior"}, "edited": false, "score": 0, "creation_date": 1473274095, "post_id": 39377117, "comment_id": 66082126, "body": "Sorry for the typo in the title, wanted to change the first character and accidentally hit return together with backspace and the # character."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1473274117, "post_id": 39377117, "comment_id": 66082134, "body": "I strongly suggest you drop the manual memory allocation and use a <code>std::wstring</code> instead of all of the <code>TCHAR*</code>s."}, {"owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "edited": false, "score": 1, "creation_date": 1473274208, "post_id": 39377117, "comment_id": 66082168, "body": "@FallenWarrior There&#39;s an <i>edit</i> button."}, {"owner": {"reputation": 489, "user_id": 5432349, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a49c998284a38d23d9e741472f26eef5?s=128&d=identicon&r=PG&f=1", "display_name": "FallenWarrior", "link": "https://stackoverflow.com/users/5432349/fallenwarrior"}, "reply_to_user": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "edited": false, "score": 1, "creation_date": 1473282175, "post_id": 39377117, "comment_id": 66085824, "body": "@LogicStuff I knew, didn&#39;t know it could edit titles though. Maybe I&#39;m a bit too accustomed to reddit."}], "answers": [{"comments": [{"owner": {"reputation": 489, "user_id": 5432349, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a49c998284a38d23d9e741472f26eef5?s=128&d=identicon&r=PG&f=1", "display_name": "FallenWarrior", "link": "https://stackoverflow.com/users/5432349/fallenwarrior"}, "edited": false, "score": 0, "creation_date": 1473282375, "post_id": 39377861, "comment_id": 66085910, "body": "Thanks for the tip, I&#39;ll try it out tomorrow. But now that you said it, it totally makes sense. I had that false assumption as I&#39;m coming from C# where you can copy a string by simply assigning it to a new variable. Not wanting to try it but just for understanding: would this work if I copied <code>ffd.cFileName</code> to a <code>new TCHAR[]</code> using a copy function like <code>StringCchCopy</code> in each iteration?"}, {"owner": {"reputation": 2933, "user_id": 6350858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfeae5d1ddef3ed5e81e88bdd30063f?s=128&d=identicon&r=PG&f=1", "display_name": "Ap31", "link": "https://stackoverflow.com/users/6350858/ap31"}, "reply_to_user": {"reputation": 489, "user_id": 5432349, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a49c998284a38d23d9e741472f26eef5?s=128&d=identicon&r=PG&f=1", "display_name": "FallenWarrior", "link": "https://stackoverflow.com/users/5432349/fallenwarrior"}, "edited": false, "score": 0, "creation_date": 1473286306, "post_id": 39377861, "comment_id": 66087401, "body": "@FallenWarrior Oh yeah, that should work, but then you&#39;ll have classical memory management problem on your hands - that new TCHAR[] will require a <code>delete</code> somewhere. Also naked <code>new</code>s are considered somewhat rude nowadays.  As you&#39;ve said, <code>TCHAR*</code>, being a pointer, has no copying mechanics upon assignment, but <code>std::wstring</code> has - and this is exactly why it would work here. Worth noting that <code>std::wstring</code> also has a constructor that allows implicit cast from <code>TCHAR*</code> so just replacing <code>std::map</code> template arguments should do the trick. All other <code>TCHAR*</code>s can stay the way they are."}, {"owner": {"reputation": 489, "user_id": 5432349, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a49c998284a38d23d9e741472f26eef5?s=128&d=identicon&r=PG&f=1", "display_name": "FallenWarrior", "link": "https://stackoverflow.com/users/5432349/fallenwarrior"}, "edited": false, "score": 0, "creation_date": 1473344381, "post_id": 39377861, "comment_id": 66112889, "body": "@Ap32 I&#39;ll probably still replace all that are possible for reasons of consistency. The only ones I gotta leave at their place are the <code>LPCWSTR</code>s the Rainmeter API uses. Still, using the implicit conversion to <code>std::wstring</code> will also do the trick for that, I think."}], "tags": [], "owner": {"reputation": 2933, "user_id": 6350858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfeae5d1ddef3ed5e81e88bdd30063f?s=128&d=identicon&r=PG&f=1", "display_name": "Ap31", "link": "https://stackoverflow.com/users/6350858/ap31"}, "is_accepted": true, "score": 1, "last_activity_date": 1473277248, "creation_date": 1473277248, "answer_id": 39377861, "question_id": 39377117, "link": "https://stackoverflow.com/questions/39377117/unexpected-behavior-when-inserting-values-into-a-map-using-a-loop-and-a-function/39377861#39377861", "title": "Unexpected behavior when inserting values into a map using a loop and a function", "body": "<p>The reason for this behavior is <code>const TCHAR*</code> keys in your maps. As <code>std::map</code> compares key values to determine where to put data, it will not use the string <code>name</code> refers to;</p>\n\n<p>Instead it will compare the pointer value itself - a memory address corresponding to <code>ffd.cFileName</code>, and that remains the same throughout the whole scope, which results in the single <code>std::map</code> entry.</p>\n\n<p>Futhermore, <code>std::map::insert</code> does nothing when the key is already present in the map, which explains the fact that the data corresponds to the very first entry. As for the key itself, it always equals to <code>ffd.cFileName</code>, and as such the data it points to cycles through filenames and will stop at the last one.</p>\n\n<p>The easiest (and correct) way to fix it is just as NathanOliver said - drop <code>TCHAR*</code>s altogether or at least in <code>std::map</code> etc, and use <code>std::wstring</code> instead. </p>\n"}], "owner": {"reputation": 489, "user_id": 5432349, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a49c998284a38d23d9e741472f26eef5?s=128&d=identicon&r=PG&f=1", "display_name": "FallenWarrior", "link": "https://stackoverflow.com/users/5432349/fallenwarrior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 39377861, "answer_count": 1, "score": 1, "last_activity_date": 1473282081, "creation_date": 1473273990, "last_edit_date": 1473282081, "question_id": 39377117, "link": "https://stackoverflow.com/questions/39377117/unexpected-behavior-when-inserting-values-into-a-map-using-a-loop-and-a-function", "title": "Unexpected behavior when inserting values into a map using a loop and a function", "body": "<p>I'm quite the beginner at C++ but I was trying to write a Rainmeter plugin which basically does the following:</p>\n\n<ol>\n<li>Scan all files in a directory set by Rainmeter options.</li>\n<li>Filter out all directories that aren't <code>.</code> or <code>..</code> and only process those. </li>\n<li>Add some data to a <code>map</code>, mostly calculated or fixed, with only the name directly influenced by the directory currently being processed.</li>\n<li>Write the whole thing to an ini-formatted file (that's the reason for using <code>map</code>). </li>\n</ol>\n\n<p>For debug reasons, I used the console instead of an actual filestream. And that's how I noticed the problem. For some mysterious reasons, probably references expiring because of objects going out of scope, the final output is totally messed up.<br>\nFirst of all, it only consists of one entry, no matter what method I use to iterate over it. Now it gets weird. In two places it uses the name of the last found directory and in two other places it uses the name of the first found directory. And this output doesn't change no matter what I try. I already tried putting the code from inside the loop into a separate function and back, using pointers and explicit memory allocation with <code>new</code> literally everywhere I could and intentionally not calling <code>delete</code> on those to try and keep them alive, and also using <code>shared_ptr</code> at some places.</p>\n\n<p>This is the current code used at the relevant part</p>\n\n<pre><code>typedef std::pair&lt;const TCHAR*, const TCHAR*&gt; kv_pair;\nint elem_index = 1;\nstd::map&lt;const TCHAR*, std::map&lt;const TCHAR*, const TCHAR*&gt;&gt; content;\nWIN32_FIND_DATA ffd;\nHANDLE hFind;\nTCHAR[] measure_name = L\"MeasureTest\";\nTCHAR[] dir = L\"C:\\\\Foo\\\\Bar\";\nTCHAR[] searchPath = L\"C:\\\\Foo\\\\Bar\\\\*\"; //Of course these are actually dynamically sized\n\nhFind = FindFirstFile(searchPath, &amp;ffd);\n//Error handling\n\ndo {\n    if((ffd.dwFileAttributes &amp; FILE_ATTRIBUTE_DIRECTORY) &amp;&amp; (*ffd.cFileName != L'.')) {\n        StringCchCat(dir, wcslen(dir) + wcslen(ffd.cFileName) + 2, L\"\\\\\");\n        StringCchCat(dir, wcslen(dir) + wcslen(ffd.cFileName) + 2, ffd.cFileName);\n\n        const TCHAR* name = ffd.cFileName;\n        const TCHAR* measure_name = data-&gt;_measureName;\n\n        std::map&lt;const TCHAR*, const TCHAR*&gt;* tmp = new std::map&lt;const TCHAR*, const TCHAR*&gt;;\n\n        // BEGIN More or less irrelevant for the actual problem\n        int col = ((int) elem_index / 5) + 1;\n        int row = elem_index++ % 5;\n        TCHAR* style = new TCHAR[wcslen(L\"PlaylistGeneral | PlaylistRow1 | PlaylistCol1\") + 1];\n        StringCchPrintf(style, wcslen(L\"PlaylistGeneral | PlaylistRow1 | PlaylistCol1\") + 1, L\"PlaylistGeneral | PlaylistRow%d | PlaylistCol%d\", row, col);\n\n        TCHAR* lmuAction = new TCHAR[wcslen(L\"[!CommandMeasure  \\\"\\\"]\") + wcslen(measure_name) + wcslen(path) + 1];\n        TCHAR* rmuAction = new TCHAR[wcslen(L\"[\\\"\\\"]\") + wcslen(path) + 1];\n        StringCchPrintf(lmuAction, wcslen(L\"[!CommandMeasure  \\\"\\\"]\") + wcslen(measure_name) + wcslen(path) + 1, L\"[!CommandMeasure %s \\\"%s\\\"]\", measure_name, path);\n        StringCchPrintf(rmuAction, wcslen(L\"[\\\"\\\"]\") + wcslen(path) + 1, L\"[\\\"%s\\\"]\", path);\n       // END More or less irrelevant for the problem\n\n\n        tmp-&gt;insert(kv_pair(L\"Meter\", L\"String\"));\n        tmp-&gt;insert(kv_pair(L\"Group\", L\"Playlist\"));\n        tmp-&gt;insert(kv_pair(L\"Hidden\", L\"1\"));\n        tmp-&gt;insert(kv_pair(L\"Text\", name));                    // These parts\n        tmp-&gt;insert(kv_pair(L\"MeterStyle\", style));             // are the\n        tmp-&gt;insert(kv_pair(L\"LeftMouseUpAction\", lmuAction));  // actual\n        tmp-&gt;insert(kv_pair(L\"RightMouseUpAction\", rmuAction)); // problem\n\n        content.insert(section(name, *tmp));\n    }\n} while (FindNextFile(hFind, &amp;ffd) &amp;&amp; elem_index &lt; 30);\n\n//Some more error handling\n\nfor (const auto&amp; section : content) {\n    std::wcout &lt;&lt; '[' &lt;&lt; current.first &lt;&lt; ']' &lt;&lt; std::endl;\n\n    for (const auto&amp; kv : section.second) std::wcout &lt;&lt; kv.first &lt;&lt; '=' &lt;&lt; kv.second &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Running this with 3 folders being in <code>C:\\Foo\\Bar</code>, named <code>abc</code>, <code>def</code> and <code>ghi</code>, yields the following output</p>\n\n<pre><code>[ghi]\nMeter=String\nGroup=Playlist\nHidden=1\nText=ghi\nMeterStyle=PlaylistGeneral | PlaylistRow1 | PlaylistCol1\nLeftMouseUpAction=[!CommandMeasure MeasureTest \"C:\\Foo\\Bar\\abc\"]\nRightMouseUpAction=[\"C:\\Foo\\Bar\\abc\"]\n</code></pre>\n\n<p>As visible, the key holding <code>name</code> uses the value from the last iteration of the <code>do-while</code> while <code>style</code>, <code>lmuAction</code> and <code>rmuAction</code> each refer to their first values and only the last entry actually shows up.</p>\n\n<p>Finally, I've reached the point of running out of ideas so I came here.</p>\n"}, {"tags": ["c++", "delphi", "dev-c++", "api-hook"], "comments": [{"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473273965, "post_id": 39377040, "comment_id": 66082070, "body": "Where did you read that Windows maps PIMAGE_DOS_HEADER into the process space?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3812497"}, "reply_to_user": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473280505, "post_id": 39377040, "comment_id": 66085081, "body": "@Serge, i edited my question above."}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473282984, "post_id": 39377040, "comment_id": 66086199, "body": "Could you run equivalent of <code>printf(&quot;%04x\\n&quot;, *(WORD*)pMapping)</code> for me please (I have no windows)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3812497"}, "reply_to_user": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473283587, "post_id": 39377040, "comment_id": 66086426, "body": "@Serge, my dll code not have a Console Window. So how stays this in a <code>MessageBox</code>?"}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473283703, "post_id": 39377040, "comment_id": 66086466, "body": "just simple console app that get a handle of any library, say msvcrt.dll (I might be incorrect with that particular name)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3812497"}, "reply_to_user": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473284120, "post_id": 39377040, "comment_id": 66086606, "body": "But if you want know if <code>pMapping</code> is <code>== NULL</code>. No, it&#39;s not."}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473284240, "post_id": 39377040, "comment_id": 66086655, "body": "I want to know the content of two bytes at address that is numericaly equal to a handle returned by GetModuleHandle() call for any dll mapped into the process"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3812497"}, "reply_to_user": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473285605, "post_id": 39377040, "comment_id": 66087163, "body": "@Serge, I have done: <code>char *charData = (char*)pMapping;   MessageBox(NULL, charData, &quot;Hello&quot;, NULL);</code> and this returns the string <code>MZP</code>"}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473285904, "post_id": 39377040, "comment_id": 66087270, "body": "Strange. Indeed dos-header. It seems I started to forget the things. Ok, sorry for confusing you. Anyway, why do you expect the hooked func to be called by every process while you injected it into a single process using virt mem write?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3812497"}, "reply_to_user": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473286296, "post_id": 39377040, "comment_id": 66087396, "body": "@Serge, The idea here is inject a dll with this code above in my app, and when i call <code>MessageBoxA</code> from my Delphi application not appear &quot;Delphi application here!&quot; :D. But without success for make it works until now."}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473286464, "post_id": 39377040, "comment_id": 66087446, "body": "So you are pretty sure that you inject the module into your Delphi app, the function get hooked but then not activated by the call to MessageBoxA from with this delphi app. correct?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3812497"}, "reply_to_user": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473286865, "post_id": 39377040, "comment_id": 66087579, "body": "@Serge, Yes, So, this line here <code>MessageBoxA(hWnd, &quot;Hello&quot;, &quot;DLL answering here!&quot;, uType);</code> that should be executed when call <code>MessageBoxA</code> from my Delphi app. This is api hooking tecnique :D. I&#39;ll test now on Windows XP and see if works, because don&#39;t is working on Windows 7 here."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3812497"}, "reply_to_user": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473287333, "post_id": 39377040, "comment_id": 66087718, "body": "@Serge, your last suggestion not worked :-("}, {"owner": {"user_type": "does_not_exist", "display_name": "user3812497"}, "reply_to_user": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473287968, "post_id": 39377040, "comment_id": 66087917, "body": "@Serge, on my code above, in this line: <code>MessageBox(NULL, NameImg-&gt;Name, &quot;&quot;, NULL); </code> is returned <code>MessageBoxA</code> and dll is injected with sucess on my Delphi app :D"}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473288214, "post_id": 39377040, "comment_id": 66087988, "body": "Sorry, I misread you"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3812497"}, "reply_to_user": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473288497, "post_id": 39377040, "comment_id": 66088065, "body": "@Serge, I think that <code>FoundIAT</code> method, before of close the last <code>}</code> is retuning always 0 and not <code>(LPDWORD)&amp;(FirstThunk-&gt;u1.Function);</code>. This could be a error?"}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473288903, "post_id": 39377040, "comment_id": 66088182, "body": "Hardly. If it returns 0, the HookFunction does not check the returned value and it would set the IAT enntry at zero, so any attempt to access that address should cause GP fault"}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473288985, "post_id": 39377040, "comment_id": 66088206, "body": "Do you see <code>&quot;Injeted with success!&quot;, &quot;Hello&quot;</code> dialog on win7?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3812497"}, "reply_to_user": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473289422, "post_id": 39377040, "comment_id": 66088332, "body": "@Serge, Yes, I see :D"}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473289685, "post_id": 39377040, "comment_id": 66088403, "body": "Then it looks strange. Unfortunatelly, I can&#39;t help, as I already mentioned I have no windows, thank god!"}], "owner": {"user_type": "does_not_exist", "display_name": "user3812497"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 758, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1473342860, "creation_date": 1473273639, "last_edit_date": 1495542312, "question_id": 39377040, "link": "https://stackoverflow.com/questions/39377040/iat-hook-using-c-dll-by-inject-not-intercepts-api", "title": "IAT hook using C++ dll by inject not intercepts api", "body": "<p>I'm trying make a hook in <code>MessageBoxA</code> api in a remote process made by me using IAT hook tecnique. I'm using <em>Process Hacker</em> software for inject my dll file into my process and until here works fine. </p>\n\n<p>My unique trouble is that <code>MessageBoxA</code> never is intercepted when i will call this api from my application. </p>\n\n<p>I have discovered that this api don't can be found in table of import of my process.</p>\n\n<p>So, i want know any suggestion about how i can find this api on table.</p>\n\n<p>Here is code that i use:</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid HookFunction(char* funcName, LPDWORD function);\nLPDWORD FoundIAT(char* funcName);\n\nint WINAPI HookMessageBoxA(HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption, UINT uType);  \n\nBOOL APIENTRY DllMain (HINSTANCE hInstance, DWORD dwReason, LPVOID lpReserved) \n{\n    if(dwReason == DLL_PROCESS_ATTACH)\n    {\n        MessageBox(NULL, \"Injeted with success!\", \"Hello\", NULL);\n        HookFunction(\"MessageBoxA\", (LPDWORD)&amp;HookMessageBoxA);\n    }\n    return TRUE;\n}\n\nvoid HookFunction(char* funcName, LPDWORD function)\n{\n    LPDWORD pOldFunction = FoundIAT(funcName);\n\n    DWORD accessProtectionValue , accessProtec;\n\n    int vProtect = VirtualProtect(pOldFunction, sizeof(LPDWORD), PAGE_EXECUTE_READWRITE, &amp;accessProtectionValue);\n\n    *pOldFunction = (DWORD)function;\n\n    vProtect = VirtualProtect(pOldFunction, sizeof(LPDWORD), accessProtectionValue, &amp;accessProtec);\n}\n\nint WINAPI HookMessageBoxA(HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption, UINT uType)\n{\n    return MessageBoxA(hWnd, \"Hello\", \"DLL answering here!\", uType);\n}\n\nLPDWORD FoundIAT(char* funcName)\n{\n    DWORD test = 0;\n\n    LPVOID pMapping = GetModuleHandle(NULL);\n\n    if (pMapping == NULL)\n\n        exit(-1);\n\n    PIMAGE_DOS_HEADER DosHeader = (PIMAGE_DOS_HEADER) pMapping;\n\n    if (DosHeader-&gt;e_magic != IMAGE_DOS_SIGNATURE)\n\n        exit(-1);\n\n    PIMAGE_NT_HEADERS NtHeaders = (PIMAGE_NT_HEADERS) ((char*) DosHeader + DosHeader-&gt;e_lfanew);\n\n    if (NtHeaders-&gt;Signature != IMAGE_NT_SIGNATURE)\n\n        exit(-1);\n\n    PIMAGE_DATA_DIRECTORY DataDirectory = &amp;NtHeaders-&gt;OptionalHeader.DataDirectory[1];\n\n    PIMAGE_IMPORT_DESCRIPTOR ImportDescriptor = (PIMAGE_IMPORT_DESCRIPTOR) ((char*) DosHeader + DataDirectory-&gt;VirtualAddress);\n\n    PIMAGE_THUNK_DATA32 OriginalFirstThunk = (PIMAGE_THUNK_DATA32)((char*) DosHeader + ImportDescriptor-&gt;OriginalFirstThunk);\n\n    while(OriginalFirstThunk != 0)\n    {\n        DWORD name = (DWORD)((char*) pMapping + ImportDescriptor-&gt;Name);\n\n        OriginalFirstThunk = (PIMAGE_THUNK_DATA32)((char*) DosHeader + ImportDescriptor-&gt;OriginalFirstThunk);\n\n        PIMAGE_THUNK_DATA32 FirstThunk = (PIMAGE_THUNK_DATA32)((char*) DosHeader + ImportDescriptor-&gt;FirstThunk);\n\n        while(OriginalFirstThunk-&gt;u1.AddressOfData != 0)\n        {\n            PIMAGE_IMPORT_BY_NAME NameImg = (PIMAGE_IMPORT_BY_NAME)((char*) DosHeader + (DWORD)OriginalFirstThunk-&gt;u1.AddressOfData);\n\n            test = (DWORD)OriginalFirstThunk-&gt;u1.Function &amp; (DWORD)IMAGE_ORDINAL_FLAG32;\n\n            if (test == 0)\n            {\n                if(strcmp(funcName, (const char*)NameImg-&gt;Name) == 0)\n                {\n                    MessageBox(NULL, NameImg-&gt;Name, \"\", NULL);\n                    return (LPDWORD)&amp;(FirstThunk-&gt;u1.Function);\n                }\n            }\n            OriginalFirstThunk++;\n            FirstThunk++;\n        }\n        ImportDescriptor++;\n    }\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"http://www.rohitab.com/discuss/topic/37089-c-hookmsgbox/\" rel=\"nofollow noreferrer\">Source</a></p>\n\n<p><strong>EDIT 1:</strong></p>\n\n<p><em>I have seen with more datails, that now this code is able to find <code>MessageBoxA</code> api :D, but still when i'll call this api from my application (made in Delphi), the hook don't work.\n:-(</em></p>\n\n<p><em>My Delphi code here:</em></p>\n\n<pre><code>procedure TForm1.btn1Click(Sender: TObject);\nbegin\n MessageBoxA(Application.Handle, 'Delphi application here!', 'Hello',0);\nend;\n</code></pre>\n\n<p><strong>EDIT 2:</strong></p>\n\n<p><strong><em><a href=\"https://stackoverflow.com/questions/11592446/how-to-modify-import-address-table-for-run-time-loaded-dll\">This</a> can be a definitive solution, but link is offline. Someone can help me about how it can be adapted to my code above please?</em></strong></p>\n"}, {"tags": ["c++", "gcc", "c++14"], "comments": [{"owner": {"reputation": 959, "user_id": 6779010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i7Jj0.png?s=128&g=1", "display_name": "torkleyy", "link": "https://stackoverflow.com/users/6779010/torkleyy"}, "edited": false, "score": 0, "creation_date": 1473273699, "post_id": 39376982, "comment_id": 66081949, "body": "I&#39;m not sure but probably you can&#39;t use <code>= default</code> for destructors?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 2, "creation_date": 1473274356, "post_id": 39376982, "comment_id": 66082236, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 586, "user_id": 873389, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c256eb7df3685e3d906de0d8bbd45ca0?s=128&d=identicon&r=PG", "display_name": "Kenny", "link": "https://stackoverflow.com/users/873389/kenny"}, "reply_to_user": {"reputation": 959, "user_id": 6779010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i7Jj0.png?s=128&g=1", "display_name": "torkleyy", "link": "https://stackoverflow.com/users/6779010/torkleyy"}, "edited": false, "score": 0, "creation_date": 1473274478, "post_id": 39376982, "comment_id": 66082295, "body": "@User9182736455 I think it&#39;s OK: <a href=\"http://en.cppreference.com/w/cpp/language/destructor\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/destructor</a>"}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1473275253, "post_id": 39376982, "comment_id": 66082670, "body": "@Kenny post an actual example. <i>Where</i> do you call <code>delete</code> and how? The error doesn&#39;t mention the constructors at all"}, {"owner": {"reputation": 586, "user_id": 873389, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c256eb7df3685e3d906de0d8bbd45ca0?s=128&d=identicon&r=PG", "display_name": "Kenny", "link": "https://stackoverflow.com/users/873389/kenny"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1473275845, "post_id": 39376982, "comment_id": 66082959, "body": "@Barry I added a simple example."}, {"owner": {"reputation": 586, "user_id": 873389, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c256eb7df3685e3d906de0d8bbd45ca0?s=128&d=identicon&r=PG", "display_name": "Kenny", "link": "https://stackoverflow.com/users/873389/kenny"}, "reply_to_user": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1473275935, "post_id": 39376982, "comment_id": 66083004, "body": "@PanagiotisKanavos Added. I&#39;m not calling <code>new</code> or <code>delete</code> which is part of why I&#39;m confused."}, {"owner": {"reputation": 586, "user_id": 873389, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c256eb7df3685e3d906de0d8bbd45ca0?s=128&d=identicon&r=PG", "display_name": "Kenny", "link": "https://stackoverflow.com/users/873389/kenny"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1473276709, "post_id": 39376982, "comment_id": 66083377, "body": "@Barry Thanks for the reference to the duplicate question. I read it but still don&#39;t understand why this is happening if delete isn&#39;t being called explicitly on the object.."}], "owner": {"reputation": 586, "user_id": 873389, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c256eb7df3685e3d906de0d8bbd45ca0?s=128&d=identicon&r=PG", "display_name": "Kenny", "link": "https://stackoverflow.com/users/873389/kenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 547, "favorite_count": 0, "closed_date": 1473275118, "answer_count": 0, "score": 0, "last_activity_date": 1473275785, "creation_date": 1473273454, "last_edit_date": 1473275785, "question_id": 39376982, "link": "https://stackoverflow.com/questions/39376982/c14-undefined-reference-to-operator-delete", "closed_reason": "Duplicate", "title": "C++14 Undefined Reference to Operator Delete", "body": "<p>I'm getting <code>undefined reference to 'operator delete(void*, unsigned int)'</code> in my virtual destructors.</p>\n\n<pre><code>26:        virtual ~ADC() = default;\n21:        virtual ~FPGA() = default;\n25:        virtual ~Emitter() = default;\n40:        virtual ~Object() = default;\n</code></pre>\n\n<p>ADC, FPGA, Emitter and inherit from DMA::Object. DMA is a namespace.</p>\n\n<p>This code compiled with GCC 4.9 but began failing when I switched tools to GCC 5.4.1.</p>\n\n<p>This is an embedded system and I'm not using dynamic memory allocation though I do use placement new for a root container object.</p>\n\n<p>It occurred to me that <code>#include &lt;new&gt;</code> might help as cppreference <a href=\"http://en.cppreference.com/w/cpp/memory/new/operator_delete\" rel=\"nofollow\">suggests that it is defined here</a> but that did not work.</p>\n\n<p>It's not necessary that these be virtual but I'd like to understand why delete is called when I'm not using new directly on these classes. Furthermore it suggests that delete is missing from the actual destructor itself which wouldn't know how it was allocated.</p>\n\n<p>I'd also appreciate it if someone can shed some light on these sized delete operators.</p>\n\n<p>Here's a minimal example compiled with <code>std=c++14</code>:</p>\n\n<pre><code>class A\n{\n    public:\n\n        A() = default;\n\n        virtual ~A() = default;\n};\n\nclass B : public A\n{\n    public: \n\n        B() = default;\n\n        virtual ~B() = default;\n};\n\nint main(void)\n{\n    static B b;\n}\n\n&gt; Building \u2018Verify\u2019 from solution \u2018Louise\u2019 in configuration \u2018Debug\u2019 1&gt;\n&gt; Compiling \u2018Verify.cpp\u2019 1&gt; Linking Verify.elf 1&gt; Output/Verify\n&gt; Debug/Obj/Verify.o: In function `A::~A()': 1&gt;\n&gt; /Volumes/Development/louise/Verify.cpp:7: undefined reference to\n&gt; `operator delete(void*, unsigned int)' 1&gt; Output/Verify\n&gt; Debug/Obj/Verify.o: In function `A::~A()': 1&gt;\n&gt; /Volumes/Development/louise/Verify.cpp:7: undefined reference to\n&gt; `operator delete(void*, unsigned int)' 1&gt; Output/Verify\n&gt; Debug/Obj/Verify.o: In function `B::~B()': 1&gt;\n&gt; /Volumes/Development/louise/Verify.cpp:16: undefined reference to\n&gt; `operator delete(void*, unsigned int)' 1&gt; Output/Verify\n&gt; Debug/Obj/Verify.o: In function `B::~B()': 1&gt;\n&gt; /Volumes/Development/louise/Verify.cpp:16: undefined reference to\n&gt; `operator delete(void*, unsigned int)' Build failed\n</code></pre>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 2278, "user_id": 1030289, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eee464c521a9fda49eca648eabbcf201?s=128&d=identicon&r=PG", "display_name": "Him_Jalpert", "link": "https://stackoverflow.com/users/1030289/him-jalpert"}, "edited": false, "score": 1, "creation_date": 1473276326, "post_id": 39376947, "comment_id": 66083199, "body": "Are you sure it&#39;s only strings in your text file? If there&#39;s symbols like ^&amp;%$# etc. Then C++ may not know what to do with these when it hits them. To be sure, try with a small set of 10 values, and then copy paste these values over and over in the same text file, try loading in that text file and see if it works fine. If so, then it&#39;s a problem within the other text file."}, {"owner": {"reputation": 1, "user_id": 5544230, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205400183739688/picture?type=large", "display_name": "Sam ", "link": "https://stackoverflow.com/users/5544230/sam"}, "reply_to_user": {"reputation": 2278, "user_id": 1030289, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eee464c521a9fda49eca648eabbcf201?s=128&d=identicon&r=PG", "display_name": "Him_Jalpert", "link": "https://stackoverflow.com/users/1030289/him-jalpert"}, "edited": false, "score": 0, "creation_date": 1473310036, "post_id": 39376947, "comment_id": 66092811, "body": "Yes, I have found that its not actually the size that is causing the crash. I have a function that compares two vectors and deletes the common entries,  and I am hitting the seg fault there. Thanks for your help though!"}], "owner": {"reputation": 1, "user_id": 5544230, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205400183739688/picture?type=large", "display_name": "Sam ", "link": "https://stackoverflow.com/users/5544230/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473281479, "creation_date": 1473273320, "last_edit_date": 1473281479, "question_id": 39376947, "link": "https://stackoverflow.com/questions/39376947/my-vector-cant-handle-a-certain-amount-of-strings", "title": "My vector can&#39;t handle a certain amount of strings", "body": "<p>I am trying to read in a text file of strings into a vector like so:</p>\n\n<pre><code>ifstream data;\nvector&lt;string&gt; set;\nstring name;\n\ndata.open(argv[2]);\n\nwhile (data &gt;&gt; name) {      \n    set.push_back(name);\n}\n</code></pre>\n\n<p>This works perfectly with a smaller data set, say with about 10 values, but when I get up into the 200 string area, it crashes into a segmentation fault. I have another function in my program that creates another vector of integer values that works with any number of values in the file. Is there a certain reason that the strings crash my program and is there any way that I can fix it?</p>\n"}, {"tags": ["c++", "performance", "memory", "optimization", "fortran"], "answers": [{"comments": [{"owner": {"reputation": 817, "user_id": 1896529, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FBsq6.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/1896529/charles"}, "edited": false, "score": 0, "creation_date": 1473302939, "post_id": 39376989, "comment_id": 66091285, "body": "Thank you for the theoretical answer, I like this viewpoint, and I would have selected this as the answer, however, you haven&#39;t included any sort of estimate on how big &quot;q&quot; and &quot;s&quot; are, which is why I accepted the other answer."}], "tags": [], "owner": {"reputation": 13815, "user_id": 6575931, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CumJFhlEBdA/AAAAAAAAAAI/AAAAAAAAi5U/sqexnazvXek/photo.jpg?sz=128", "display_name": "Uriel", "link": "https://stackoverflow.com/users/6575931/uriel"}, "is_accepted": false, "score": 3, "last_activity_date": 1473425103, "last_edit_date": 1473425103, "creation_date": 1473273487, "answer_id": 39376989, "question_id": 39376920, "link": "https://stackoverflow.com/questions/39376920/open-file-and-close-file-statement-positioning-best-practice-advantages-disad/39376989#39376989", "title": "Open file and close file statement positioning: best practice, advantages, disadvantages", "body": "<p>If you can do a task outside the loop, you better do it, since every time you add it to the loop queue results in worse performance (n times instead of 1). Therefore, declaring variables or opening files before the loop is better than repeating it with every iteration.</p>\n\n<hr>\n\n<ul>\n<li>Main loop\n\n<ol>\n<li>do work - <strong>cost:</strong> k * n</li>\n<li>open files - <strong>cost:</strong> q * n</li>\n<li>write to files - <strong>cost:</strong> r * n</li>\n<li>close files - <strong>cost:</strong> s * n</li>\n<li>continue work - <strong>cost:</strong> l * n</li>\n</ol></li>\n<li>end loop</li>\n</ul>\n\n<p><strong>Total:</strong> n * (k + q + r + s + l)</p>\n\n<hr>\n\n<ul>\n<li>open files - <strong>cost:</strong> q</li>\n<li>Main loop\n\n<ol>\n<li>do work - <strong>cost:</strong> k * n</li>\n<li>write to files - <strong>cost:</strong> r * n</li>\n<li>continue work - <strong>cost:</strong> l * n</li>\n</ol></li>\n<li>end loop</li>\n<li>close files - <strong>cost:</strong> s</li>\n</ul>\n\n<p><strong>Total:</strong> n * (k + r + l) + q + s</p>\n\n<hr>\n\n<p><code>s</code> and <code>q</code> are very expensive, since accessing files on the system disk costs much more time and is very slow compared to accessing variables or performing calculation, since it is needs to get the data from the disk, as opposed to the variables that are stored in the RAM and are easily accessible through the code flow. See more on caching and io buffering for that.</p>\n\n<p>As for performance:</p>\n\n<pre><code>$ python -m timeit 'open(\"hw.txt\").read()'\n1000 loops, best of 3: 240 usec per loop\n$ python -m timeit 'a=2;b=3;c=a**b'\n100000 loops, best of 3: 2.15 usec per loop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6498, "user_id": 1004168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c05e808436031bc45a7620adc236e3d?s=128&d=identicon&r=PG", "display_name": "agentp", "link": "https://stackoverflow.com/users/1004168/agentp"}, "edited": false, "score": 0, "creation_date": 1473292840, "post_id": 39377214, "comment_id": 66089138, "body": "he evidently needs to flush in the loop for some reason  (though not explained very well in the question).  Maybe a third case with a flush would be good to add to the timing test."}, {"owner": {"reputation": 817, "user_id": 1896529, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FBsq6.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/1896529/charles"}, "edited": false, "score": 0, "creation_date": 1473302845, "post_id": 39377214, "comment_id": 66091264, "body": "Thank you for the practical example. I do need flush for monitoring certain transient data, so thank you for including remarks regarding flush."}, {"owner": {"reputation": 817, "user_id": 1896529, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FBsq6.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/1896529/charles"}, "edited": false, "score": 0, "creation_date": 1473311405, "post_id": 39377214, "comment_id": 66093158, "body": "I do wish you included some information about code design. It seems that the slower design may be favorable in certain situations. For example, I want to edit a file while the code is executing, which then imports this data and is used in the simulation. When I try this while the code is open, I get an error: &quot;Error: the process cannot access the file because its being used by another process.&quot;."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 817, "user_id": 1896529, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FBsq6.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/1896529/charles"}, "edited": false, "score": 0, "creation_date": 1473311625, "post_id": 39377214, "comment_id": 66093234, "body": "@Charlie Right. That could be another consideration (of which I did not think)."}], "tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": true, "score": 2, "last_activity_date": 1473276279, "last_edit_date": 1473276279, "creation_date": 1473274362, "answer_id": 39377214, "question_id": 39376920, "link": "https://stackoverflow.com/questions/39376920/open-file-and-close-file-statement-positioning-best-practice-advantages-disad/39377214#39377214", "title": "Open file and close file statement positioning: best practice, advantages, disadvantages", "body": "<p>As usual, you should profile your specific code to see what are the bottlenecks. However, in general, opening and closing files is <em>very</em> expensive.</p>\n\n<p>Consider the following:</p>\n\n<pre><code>def foo():\n    f = open('bar.txt', 'w')\n    for i in range(1000):\n        f.write('a')\n    f.close()\n\ndef bar():\n    for i in range(1000):\n        f = open('bar.txt', 'w')\n        f.write('a')\n        f.close()\n</code></pre>\n\n<p>Let's time it:</p>\n\n<pre><code>&gt;&gt;&gt; %timeit foo()\n10000 loops, best of 3: 190 \u00b5s per loop\n\n&gt;&gt;&gt; %timeit bar()\n10 loops, best of 3: 47.8 ms per loop\n</code></pre>\n\n<p>So, opening and closing is extremely expensive.</p>\n\n<p>What are the advantages (or at least mitigating factors) for the constant opens and closes?</p>\n\n<ol>\n<li><p>Less open file descriptors.</p></li>\n<li><p>When you close a file, the data is flushed to it. Of course you could just call <code>flush</code>, but that is an expensive operation in itself, and the time differences would become narrower.</p></li>\n</ol>\n\n<p>If you don't have critical data (i.e., you can just rerun the program if it crashes), and don't have too many open file descriptor problems - few opens and closes will probably be faster.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": false, "score": 0, "last_activity_date": 1473278373, "creation_date": 1473278373, "answer_id": 39378096, "question_id": 39376920, "link": "https://stackoverflow.com/questions/39376920/open-file-and-close-file-statement-positioning-best-practice-advantages-disad/39378096#39378096", "title": "Open file and close file statement positioning: best practice, advantages, disadvantages", "body": "<p>Doing a task many times (in the loop) versus doing it just once (outside the loop) is obviously going to be more costly - regardless of the language used.</p>\n"}], "owner": {"reputation": 817, "user_id": 1896529, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FBsq6.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/1896529/charles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "accepted_answer_id": 39377214, "answer_count": 3, "score": 1, "last_activity_date": 1473425103, "creation_date": 1473273217, "question_id": 39376920, "link": "https://stackoverflow.com/questions/39376920/open-file-and-close-file-statement-positioning-best-practice-advantages-disad", "title": "Open file and close file statement positioning: best practice, advantages, disadvantages", "body": "<p>I have a code, containing <em>many</em> loop iterations, with <code>open file</code> and <code>close file</code> statements positioned as follows:</p>\n\n<ul>\n<li><p>Main loop</p>\n\n<ol>\n<li><p>do work</p></li>\n<li><p>open files</p></li>\n<li><p>write to files</p></li>\n<li><p>close files</p></li>\n<li><p>continue work</p></li>\n</ol></li>\n<li><p>end loop</p></li>\n</ul>\n\n<p>But, an alternative is:</p>\n\n<ul>\n<li><p>open files</p></li>\n<li><p>Main loop</p>\n\n<ol>\n<li><p>do work</p></li>\n<li><p>write to files, [flush]</p></li>\n<li><p>continue work</p></li>\n</ol></li>\n<li><p>end loop</p></li>\n<li><p>close files</p></li>\n</ul>\n\n<p>Is there a \"best practice\" to positioning <code>open file</code> and <code>close file</code> statements containing <em>many</em> loop iterations? Are there advantages / disadvantages to each? Will I see performance differences? Memory restrictions? Future development issues down the line? </p>\n\n<p>I'm mainly coding in Fortran (hence the tag), however, I would like to know if this is language dependent or not, since I also program in other languages. Any help is greatly appreciated.</p>\n"}, {"tags": ["c++", "c++11", "memcpy", "reinterpret-cast"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473272889, "post_id": 39376813, "comment_id": 66081586, "body": "Are you doing the copy using <code>data</code>/<code>&amp;array_name[0]</code> or using the name of the &quot;array&quot; itself?"}, {"owner": {"reputation": 10492, "user_id": 603688, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1058344e1b119c4d9dd3aedc5456277b?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/603688/dan"}, "edited": false, "score": 5, "creation_date": 1473272911, "post_id": 39376813, "comment_id": 66081599, "body": "Not through <code>reinterpret_cast</code>, because of strict aliasing."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 1, "creation_date": 1473282367, "post_id": 39376813, "comment_id": 66085904, "body": "Hmm... the original question was about copying, the new question is about <code>reinterpret_cast</code>-ing. That&#39;s somewhat different..."}, {"owner": {"reputation": 2526, "user_id": 190806, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6b29176e9164775cc5dd2c5822b8c6f4?s=128&d=identicon&r=PG", "display_name": "shinjin", "link": "https://stackoverflow.com/users/190806/shinjin"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1473282638, "post_id": 39376813, "comment_id": 66086042, "body": "@Barry, the original question was &quot;Is the std::array bit compatible with the old C array?&quot;, and still is. Everything else is a consequence of that."}, {"owner": {"reputation": 2765, "user_id": 2071258, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6da5a603fd4dcea53e578bcfac0c178b?s=128&d=identicon&r=PG", "display_name": "Laurent LA RIZZA", "link": "https://stackoverflow.com/users/2071258/laurent-la-rizza"}, "edited": false, "score": 1, "creation_date": 1473331164, "post_id": 39376813, "comment_id": 66103777, "body": "It looks like you&#39;re trying to modernize legacy C++ code by replacing old constructs by new ones, right?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1473340384, "post_id": 39376813, "comment_id": 66109906, "body": "Then somebody changes <code>VecNew</code> by adding new field for example and enjoy debugging. No, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 2526, "user_id": 190806, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6b29176e9164775cc5dd2c5822b8c6f4?s=128&d=identicon&r=PG", "display_name": "shinjin", "link": "https://stackoverflow.com/users/190806/shinjin"}, "edited": false, "score": 4, "creation_date": 1473273671, "post_id": 39376848, "comment_id": 66081939, "body": "It is exactly the &quot;so it seems&quot; part that I&#39;d like to get clarified."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 2526, "user_id": 190806, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6b29176e9164775cc5dd2c5822b8c6f4?s=128&d=identicon&r=PG", "display_name": "shinjin", "link": "https://stackoverflow.com/users/190806/shinjin"}, "edited": false, "score": 0, "creation_date": 1473273697, "post_id": 39376848, "comment_id": 66081947, "body": "you did not answer why"}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 14, "last_activity_date": 1473273576, "last_edit_date": 1473273576, "creation_date": 1473272859, "answer_id": 39376848, "question_id": 39376813, "link": "https://stackoverflow.com/questions/39376813/is-the-stdarray-bit-compatible-with-the-old-c-array/39376848#39376848", "title": "Is the std::array bit compatible with the old C array?", "body": "<p><code>std::array</code> provides method <a href=\"http://en.cppreference.com/w/cpp/container/array/data\">data()</a> which can be used to copy to/from c-style array of proper size:</p>\n\n<pre><code>const size_t size = 123;\nint carray[size];\nstd::array&lt;int,size&gt; array;\n\nmemcpy( carray, array.data(), sizeof(int) * size );\nmemcpy( array.data(), carray, sizeof(int) * size );\n</code></pre>\n\n<p>As stated on <a href=\"http://en.cppreference.com/w/cpp/container/array\">documentation</a></p>\n\n<blockquote>\n  <p>This container is an aggregate type with the same semantics as a struct holding a C-style array T[N] as its only non-static data member.</p>\n</blockquote>\n\n<p>so it seems that memory footprint would be compatible with c-style array, though it is not clear why you want to use \"hacks\" with <code>reinterpret_cast</code> when there is a proper way which does not have any overhead.</p>\n"}, {"comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 2, "creation_date": 1473273952, "post_id": 39377033, "comment_id": 66082063, "body": "The <a href=\"http://eel.is/c++draft/array\" rel=\"nofollow noreferrer\">new draft</a> got rid of that part. Now we just have that it&#39;s an aggregate that can be list initialized with <code>N</code> <code>T</code>s (but +1)."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1473274870, "post_id": 39377033, "comment_id": 66082477, "body": "@Barry: I&#39;m not at all sure that really changes much. Offhand, I don&#39;t see a way of meeting its requirements (contiguous container, aggregate) except by having only one data member, which is an array. I suppose if you could assure against padding between elements, you <i>could</i> create a variadic template of discrete elements, but only because the elements would still be addressable like an array."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1473275076, "post_id": 39377033, "comment_id": 66082586, "body": "The initialization couldn&#39;t work if <code>array</code> wasn&#39;t a simple <code>struct</code> wrapper of a raw array."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 1, "creation_date": 1473275370, "post_id": 39377033, "comment_id": 66082721, "body": "@JerryCoffin Oh I&#39;m not saying <code>std::array</code> isn&#39;t definitely a wrapper around a raw array. I&#39;m just saying that now the wording around that description is totally different (not sure what the significance of that chance is tbh. just pointing it out)."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1473276051, "post_id": 39377033, "comment_id": 66083053, "body": "The initialization (but not other parts)could work if the storage were discrete members in the correct order."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1473283449, "post_id": 39377033, "comment_id": 66086386, "body": "I mean, the <code>data</code> functionality only guarantees that there is effectively an array in there. The initialization means that there&#39;s nothing before that array. So there is an array, and there&#39;s nothing before it, and so as the first member of a struct a pointer to it can be reinterpreted as pointer to the struct and vice versa (this is at the end of the section about class members)."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1473293195, "post_id": 39377033, "comment_id": 66089205, "body": "@JerryCoffin &quot;(but not other parts)&quot; yeah, like basic indexing and pointer arithmetic!"}], "tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": false, "score": 7, "last_activity_date": 1473274653, "last_edit_date": 1473274653, "creation_date": 1473273612, "answer_id": 39377033, "question_id": 39376813, "link": "https://stackoverflow.com/questions/39376813/is-the-stdarray-bit-compatible-with-the-old-c-array/39377033#39377033", "title": "Is the std::array bit compatible with the old C array?", "body": "<p><code>array</code> doesn't mandate much about the underlying type over which you instantiate it.</p>\n\n<p>To have <em>any</em> possibility of useful results from using <code>memcpy</code> or <code>reinterpret_cast</code> to do a copy, the type you instantiated it over would have to be trivially copyable. Storing those items in an <code>array</code> doesn't affect the requirement that <code>memcpy</code> (and such) only work with trivially copyable types.</p>\n\n<p><code>array</code> is required to be a <em>contiguous container</em> and an aggregate, which pretty much means that the storage for the elements must be an array. The standard shows it as:</p>\n\n<pre><code>T elems[N]; // exposition only\n</code></pre>\n\n<p>It later, however, has a note that at least implies that it's being an array is required (\u00a7[array.overview]/4):</p>\n\n<blockquote>\n  <p>[Note: The member variable <code>elems</code> is shown for exposition only, to emphasize that <code>array</code> is a class aggregate.\n  <strong>The name <code>elems</code> is not part of array\u2019s interface.</strong> \u2014end note]</p>\n</blockquote>\n\n<p>[emphasis added]</p>\n\n<p>Note how it's really only the specific name <code>elems</code> that isn't required.</p>\n"}, {"comments": [{"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 7, "creation_date": 1473280099, "post_id": 39377145, "comment_id": 66084916, "body": "nitpick: <code>std::copy</code> doesn&#39;t always compile down to <code>memcpy</code> it&#39;s an implementation detail. For example VC++ uses <code>memmove</code> for byte copies."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 9, "creation_date": 1473293334, "post_id": 39377145, "comment_id": 66089233, "body": "I&#39;m torn. This is a great answer... for a different question!"}, {"owner": {"reputation": 553, "user_id": 1171163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e1013351707fada043aa99c6c184204?s=128&d=identicon&r=PG", "display_name": "Bad_ptr", "link": "https://stackoverflow.com/users/1171163/bad-ptr"}, "edited": false, "score": 0, "creation_date": 1532168952, "post_id": 39377145, "comment_id": 89879657, "body": "<a href=\"https://godbolt.org/g/SGdWwp\" rel=\"nofollow noreferrer\">godbolt.org/g/SGdWwp</a> Looks like it is doing the fast copy only if the two arguments are of the same array type(only <code>test</code> and <code>test3</code> compile to <code>memmove</code>)."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 20, "last_activity_date": 1473274094, "creation_date": 1473274094, "answer_id": 39377145, "question_id": 39376813, "link": "https://stackoverflow.com/questions/39376813/is-the-stdarray-bit-compatible-with-the-old-c-array/39377145#39377145", "title": "Is the std::array bit compatible with the old C array?", "body": "<p>This doesn't directly answer your question, but you should simply use <a href=\"http://en.cppreference.com/w/cpp/algorithm/copy\" rel=\"noreferrer\"><code>std::copy</code></a>:</p>\n\n<pre><code>T c[N];\nstd::array&lt;T, N&gt; cpp;\n\n// from C to C++\nstd::copy(std::begin(c), std::end(c), std::begin(cpp));\n\n// from C++ to C\nstd::copy(std::begin(cpp), std::end(cpp), std::begin(c));\n</code></pre>\n\n<p>If <code>T</code> is a trivially copyable type, this'll compile down to <code>memcpy</code>. If it's not, then this'll do element-wise copy assignment and be correct. Either way, this does the Right Thing and is quite readable. No manual byte arithmetic necessary. </p>\n"}, {"comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1473275163, "post_id": 39377268, "comment_id": 66082627, "body": "&quot;as data() is not required to actually be backed by an array&quot;, uhm, that&#39;s nonsense."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 5, "creation_date": 1473275244, "post_id": 39377268, "comment_id": 66082665, "body": "Re &quot; since C++17 you cannot (even using reinterpret_cast) cast a pointer to an array to/from a pointer to its first member (you have to use std::launder)&quot;, that sounds interesting: the committee going lunatically berserk! More info please. In the meantime I&#39;ll make some popcorn."}, {"owner": {"reputation": 137021, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1473275753, "post_id": 39377268, "comment_id": 66082907, "body": "@Cheersandhth.-Alf &quot;not required to actually be backed by an array&quot; - trivially true for N=0 and N=1; implementable via vendor-library cooperation for N&gt;1."}, {"owner": {"reputation": 137021, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 2, "creation_date": 1473275830, "post_id": 39377268, "comment_id": 66082945, "body": "@Cheersandhth.-Alf &quot;a pointer to an array cannot be cast to/from a pointer to its first element&quot;: see <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0137r1.html\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0137r1.html</a>"}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1473275851, "post_id": 39377268, "comment_id": 66082963, "body": "Not the N=1; a variable is an array of size 1."}, {"owner": {"reputation": 137021, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1473275999, "post_id": 39377268, "comment_id": 66083027, "body": "@Cheersandhth.-Alf &quot;for purposes of pointer arithmetic and comparison&quot;; not for all purposes and certainly not as far as aliasing goes."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 3, "creation_date": 1473276001, "post_id": 39377268, "comment_id": 66083028, "body": "Uhm, re the link, that&#39;s a wall of text. Several hundred kilometers of it. Can you sort of vaguely indicate a region of, say, less than 203 meters?"}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1473276179, "post_id": 39377268, "comment_id": 66083122, "body": "re the &quot;certainly not&quot;, that&#39;s nonsense."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 2, "creation_date": 1473276293, "post_id": 39377268, "comment_id": 66083176, "body": "It seems this is about giving a compiler vendor a controlling interest in the management of the standard, whence, that compiler&#39;s shortcomings and silly behaviors become standardized. Oh well."}, {"owner": {"reputation": 137021, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 1, "creation_date": 1473276296, "post_id": 39377268, "comment_id": 66083180, "body": "@Cheersandhth.-Alf the edits and additions to [basic.compound]/3 are the really fun bit. Note that I linked the wrong version initially; you should be reading P0137r1."}, {"owner": {"reputation": 137021, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 2, "creation_date": 1473276459, "post_id": 39377268, "comment_id": 66083249, "body": "@Cheersandhth.-Alf nonsense maybe, but that&#39;s the direction the Standard is going: <code>int a; int (&amp;r)[1] = reinterpret_cast&lt;int(&amp;)[1]&gt;(a); r[0] = 42;</code> is now UB. Truly we live in interesting times."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 2, "creation_date": 1473276562, "post_id": 39377268, "comment_id": 66083304, "body": "Do you know if the persons doing this work have given any rationale for the, uh, changes? Like what they hope to achieve?"}, {"owner": {"reputation": 137021, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 1, "creation_date": 1473277271, "post_id": 39377268, "comment_id": 66083641, "body": "@Cheersandhth.-Alf to my understanding they&#39;re formalising what compilers are already doing while making it possible to implement containers that create and destroy objects (esp. vector and optional). The intent is presumably to be able to squeeze every last drop of UB out of the aliasing rules to perform better on SPEC (ahem: on user code)."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1473294148, "post_id": 39377268, "comment_id": 66089414, "body": "Why on Earth did the authors, right after specifically allowing for conversion between pointers to a standard-layout struct vs its 1st member, then tack on - <i>in a friggin&#39; Note</i>, as if a passing afterthought - that the same allowance does not hold for an array and its 1st element? Is there a nuance I&#39;m missing where one should be allowed but the second not? Surely <code>( (NonexistentStruct*)somePointer )-&gt;nonexistentMember</code> is not any less dangerous than <code>( (NonexistentArray[42]*)somePointer )[23]</code>? ...or whatever the syntax; I don&#39;t do this stuff, ofc. What&#39;s the crucial distinction I&#39;m missing?"}, {"owner": {"reputation": 2115, "user_id": 1934349, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/LyNoA.jpg?s=128&g=1", "display_name": "paulotorrens", "link": "https://stackoverflow.com/users/1934349/paulotorrens"}, "edited": false, "score": 0, "creation_date": 1473322737, "post_id": 39377268, "comment_id": 66098626, "body": "I bet a lot of libboost&#39;s hacks are gonna break now."}, {"owner": {"reputation": 137021, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 4, "creation_date": 1473332601, "post_id": 39377268, "comment_id": 66104691, "body": "@underscore_d it&#39;s not about danger, it&#39;s about optimization; a lot of scientific code (<i>cough</i> SPEC <i>cough</i>) can be effectively accelerated if the compiler assumes that different-sized arrays and pointers don&#39;t alias even when the element type is the same. The speed-ups this yields are considered (by compiler authors, and, being fair, to their customers writing scientific, Fortran-style code) to be worth the potential confusion and breakage to their users writing more systems- or object-oriented code."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1473368662, "post_id": 39377268, "comment_id": 66126386, "body": "@ecatmur Just <code>optional</code>. <code>vector</code> is still formally broken. In particular, <code>vector::data</code> is unimplementable in standard C++."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1473521597, "post_id": 39377268, "comment_id": 66178844, "body": "@T.C. Can you link to a discussion of the problem with <code>vector</code>?"}], "tags": [], "owner": {"reputation": 137021, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "is_accepted": false, "score": 9, "last_activity_date": 1473274548, "creation_date": 1473274548, "answer_id": 39377268, "question_id": 39376813, "link": "https://stackoverflow.com/questions/39376813/is-the-stdarray-bit-compatible-with-the-old-c-array/39377268#39377268", "title": "Is the std::array bit compatible with the old C array?", "body": "<p>The requirement on the <code>data()</code> method is that it return a pointer <code>T*</code> such that:</p>\n\n<blockquote>\n  <p><code>[data(), data() + size())</code> is a valid range, and <code>data() == addressof(front())</code>.</p>\n</blockquote>\n\n<p>This implies that you can access each element sequentially via the <code>data()</code> pointer, and so if <code>T</code> is trivially copyable you can indeed use <code>memcpy</code> to copy <code>sizeof(T) * size()</code> bytes to/from an array <code>T[size()]</code>, since this is equivalent to <code>memcpy</code>ing each element individually.</p>\n\n<p>However, you cannot use <code>reinterpret_cast</code>, since that would violate strict aliasing, as <code>data()</code> is not required to <em>actually</em> be backed by an array - and also, even if you were to guarantee that <code>std::array</code> contains an array, since C++17 you cannot (even using <code>reinterpret_cast</code>) cast a pointer to an array to/from a pointer to its first member (you have to use <code>std::launder</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1473285025, "post_id": 39379359, "comment_id": 66086938, "body": "I disagree that aliasing problems could occur. What is your reasoning for that claim?"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "reply_to_user": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1473285800, "post_id": 39379359, "comment_id": 66087222, "body": "A structure  and an array are incompatible types in terms of strict aliasing."}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1473286014, "post_id": 39379359, "comment_id": 66087309, "body": "I don&#39;t think your interpretation of the strict aliasing rule is correct. If that were the case, then an array type would also be incompatible with its element type, which is clearly absurd."}, {"owner": {"reputation": 500, "user_id": 1644925, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd6b59cb8b550984582d0db4473779ce?s=128&d=identicon&r=PG", "display_name": "alexchandel", "link": "https://stackoverflow.com/users/1644925/alexchandel"}, "edited": false, "score": 0, "creation_date": 1473286512, "post_id": 39379359, "comment_id": 66087462, "body": "His assertion on strict aliasing does not imply what you claim it does."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 1, "creation_date": 1473292862, "post_id": 39379359, "comment_id": 66089142, "body": "@Brian That&#39;s not what RustyX was saying. An array has never been compatible with a <code>struct</code> having the same number of same-typed members. However, even your tangential inference about the compatibility of pointers to arrays versus pointers to their elements is soon to be all too true! See ecatmur&#39;s answer regarding the fun in store from the in-drafting P0137R1. And please, if you are so inclined and in a position to, file a National Body comment expressing scepticism of it."}], "tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": true, "score": 11, "last_activity_date": 1473325543, "last_edit_date": 1473325543, "creation_date": 1473284084, "answer_id": 39379359, "question_id": 39376813, "link": "https://stackoverflow.com/questions/39376813/is-the-stdarray-bit-compatible-with-the-old-c-array/39379359#39379359", "title": "Is the std::array bit compatible with the old C array?", "body": "<p>I say yes (but the standard does not guarantee it).</p>\n\n<p>According to [array]/2:</p>\n\n<blockquote>\n  <p>An array is an <em>aggregate</em> ([<a href=\"http://eel.is/c++draft/dcl.init.aggr\" rel=\"noreferrer\">dcl.init.aggr</a>]) that can be\n  list-initialized with up to N elements whose types are convertible to\n  T.</p>\n</blockquote>\n\n<p>And [dcl.init.aggr]:</p>\n\n<blockquote>\n  <p>An <em>aggregate</em> is an array or a class (Clause [class]) with</p>\n  \n  <ul>\n  <li><p>no user-provided, explicit, or inherited constructors ([class.ctor]),</p></li>\n  <li><p>no private or protected non-static data members (Clause\n  [class.access]),</p></li>\n  <li><p>no virtual functions ([class.virtual]), and</p></li>\n  <li><p>no virtual, private, or protected base classes ([class.mi]).</p></li>\n  </ul>\n</blockquote>\n\n<p>In light of this, <em>\"can be list-initialized\"</em> is only possible if there are no other members in the beginning of the class and no vtable.</p>\n\n<p>Then, <code>data()</code> is specified as:</p>\n\n<blockquote>\n  <p><code>constexpr T* data() noexcept;</code>\n  <br><br>\n  <em>Returns</em>: A pointer such that <code>[data(), data() + size())</code> is a valid range, and <code>data() == addressof(front())</code>.</p>\n</blockquote>\n\n<p>The standard basically wants to say \"it returns an array\" but leaves the door open for other implementations.</p>\n\n<p>The only possible other implementation is a structure with individual elements, in which case you <em>can</em> run into aliasing problems. But in my view this approach does not add anything but complexity. There is nothing to gain by unrolling an array into a struct.</p>\n\n<p>So it makes <strong>no sense</strong> <em>not</em> to implement <code>std::array</code> as an array.</p>\n\n<p>But a loophole does exist.</p>\n"}], "owner": {"reputation": 2526, "user_id": 190806, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6b29176e9164775cc5dd2c5822b8c6f4?s=128&d=identicon&r=PG", "display_name": "shinjin", "link": "https://stackoverflow.com/users/190806/shinjin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6984, "favorite_count": 4, "accepted_answer_id": 39379359, "answer_count": 5, "score": 37, "last_activity_date": 1473325543, "creation_date": 1473272683, "last_edit_date": 1473280733, "question_id": 39376813, "link": "https://stackoverflow.com/questions/39376813/is-the-stdarray-bit-compatible-with-the-old-c-array", "title": "Is the std::array bit compatible with the old C array?", "body": "<p>Is the underlying <em>bit representation</em> for an <code>std::array&lt;T,N&gt; v</code> and a <code>T u[N]</code> the same?</p>\n\n<p>In other words, is it safe to copy <code>N*sizeof(T)</code> bytes from one to the other? (Either through <code>reinterpret_cast</code> or <code>memcpy</code>.)</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>For clarification, the emphasis is on <em>same bit representation</em> and <code>reinterpret_cast</code>.</p>\n\n<p>For example, let's suppose I have these two classes over some trivially copyable type <code>T</code>, for some <code>N</code>:</p>\n\n<pre><code>struct VecNew {\n    std::array&lt;T,N&gt; v;\n};\n\nstruct VecOld {\n    T v[N];\n};\n</code></pre>\n\n<p>And there is the legacy function</p>\n\n<pre><code>T foo(const VecOld&amp; x);\n</code></pre>\n\n<p>If the representations are the same, then this call is safe and avoids copying:</p>\n\n<pre><code>VecNew x;\nfoo(reinterpret_cast&lt;const VecOld&amp;&gt;(x));\n</code></pre>\n"}, {"tags": ["c++", "matrix", "3d", "directx", "raycasting"], "comments": [{"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1473426872, "post_id": 39376687, "comment_id": 66149141, "body": "Both approaches are equivalent. In fact, <code>XMVector3Unproject()</code> internally uses the computations from the second approach. Why do you think that the result is wrong? What is the <code>Vector3</code> type? DirectXMath has two kinds of data types for vectors and matrices. One plain structure (<code>XMFLOAT3</code>, <code>XMFLOAT4X4</code>, ...) and a type for data loaded into SIMD registers (<code>XMVECTOR</code>, <code>XMMATRIX</code>). You need to be sure to pass the correct ones."}, {"owner": {"reputation": 1, "user_id": 6805787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cef3f19133964ae51096bf05c0e1f79e?s=128&d=identicon&r=PG&f=1", "display_name": "whileNotZero", "link": "https://stackoverflow.com/users/6805787/whilenotzero"}, "reply_to_user": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1473908754, "post_id": 39376687, "comment_id": 66322367, "body": "I&#39;m glad to hear they&#39;re equivalent, because <code>XMVectorUnproject()</code> looks much cleaner. <code>Vector3</code> seems to come from DirectXTK, and apparently is just a wrapper for the <code>XMVECTOR</code> type that simplifies operations and loading. I rewrote the function replacing all <code>Vector3</code>s with <code>XMVECTOR</code>s and got the same result so I don&#39;t think that&#39;s the issue. By the way, I should have specified the result - it looks like <a href=\"https://gfycat.com/DescriptiveJointGrayling\" rel=\"nofollow noreferrer\">this</a>. The ray always originates at (512, 384, 1) and is cast toward the mouse. That&#39;s not correct, right?"}, {"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1473941932, "post_id": 39376687, "comment_id": 66337596, "body": "Is your world matrix the identity when you call this? Are you sure that your bullet code is correct? Have you checked the actual values of <code>orig</code> and <code>dest</code>?"}, {"owner": {"reputation": 1, "user_id": 6805787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cef3f19133964ae51096bf05c0e1f79e?s=128&d=identicon&r=PG&f=1", "display_name": "whileNotZero", "link": "https://stackoverflow.com/users/6805787/whilenotzero"}, "reply_to_user": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1473948816, "post_id": 39376687, "comment_id": 66342523, "body": "Oh yes, I forgot that I I had replaced the world matrix with the identity matrix in the unproject call. When I use the world matrix the ray originates at z = -900, y = -350, and varying negative x values depending on where I click (even depends on click height), and loosely follows the mouse movement. The bullet behavior matches the origin direction vectors I see when debugging with breakpoints. The reason the birds are being killed is because collision detection disregards z values at the moment, so when it reaches the correct x and y coords in the distance a collision is detected."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6805787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cef3f19133964ae51096bf05c0e1f79e?s=128&d=identicon&r=PG&f=1", "display_name": "whileNotZero", "link": "https://stackoverflow.com/users/6805787/whilenotzero"}, "is_accepted": false, "score": 0, "last_activity_date": 1474128465, "last_edit_date": 1474128465, "creation_date": 1474126727, "answer_id": 39548634, "question_id": 39376687, "link": "https://stackoverflow.com/questions/39376687/mouse-picking-with-ray-casting-in-directx/39548634#39548634", "title": "Mouse picking with ray casting in DirectX", "body": "<p>In the end I realized my problem originated with switching from perspective to orthographic view to draw the HUD and never resetting the view matrix. I was able to use the <code>XMVector3Unproject()</code> function with the identity matrix in place of the world matrix and everything works flawlessly now.</p>\n\n<p>Thanks Nico Schertler for the information and reassurance!</p>\n"}], "owner": {"reputation": 1, "user_id": 6805787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cef3f19133964ae51096bf05c0e1f79e?s=128&d=identicon&r=PG&f=1", "display_name": "whileNotZero", "link": "https://stackoverflow.com/users/6805787/whilenotzero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1270, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474128465, "creation_date": 1473272135, "last_edit_date": 1495541965, "question_id": 39376687, "link": "https://stackoverflow.com/questions/39376687/mouse-picking-with-ray-casting-in-directx", "title": "Mouse picking with ray casting in DirectX", "body": "<p>I'm trying to implement raycasting with DirectX in C++ but have run into problems. I've tried two approaches, using <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/microsoft.directx_sdk.transformation.xmvector3unproject(v=vs.85).aspx\" rel=\"nofollow noreferrer\">XMVector3Unproject</a> and following the instructions provided <a href=\"https://stackoverflow.com/a/19153090/6805787\">here on stackoverflow</a> a while ago.</p>\n\n<p>Unproject Approach:</p>\n\n<pre><code>//p is mouse location vector\n\n//Don't know if I need to normalize mouse input\n//p.x = (2.0f * p.x) / g_nScreenWidth - 1.0f;\n//p.y = 1.0f - (2.0f * p.y) / g_nScreenHeight;\n\nVector3 orig = XMVector3Unproject(Vector3(p.x, p.y, 0),\n                 0,\n                 0,\n                 g_nScreenWidth,\n                 g_nScreenHeight,\n                 0,\n                 1,\n                 GameRenderer.m_matProj,\n                 GameRenderer.m_matView,\n                 GameRenderer.m_matWorld);\n\nVector3 dest = XMVector3Unproject(Vector3(p.x, p.y, 1),\n                 0,\n                 0,\n                 g_nScreenWidth,\n                 g_nScreenHeight,\n                 0,\n                 1,\n                 GameRenderer.m_matProj,\n                 GameRenderer.m_matView,\n                 GameRenderer.m_matWorld);\n\nVector3 direction = dest - orig;\ndirection.Normalize();\n\n//shoot a bullet to visualize the ray for testing\ng_cObjectManager.createObject(BUL_OBJ, \"bullet\", orig, direction*100);\n</code></pre>\n\n<p>Matrix Inversion Approach:</p>\n\n<pre><code>//Normalized device coordinates\np.x = (2.0f * p.x) / g_nScreenWidth - 1.0f;\np.y = 1.0f - (2.0f * p.y) / g_nScreenHeight;\n\nXMVECTOR det; //Determinant, needed for matrix inverse function call\nVector3 origin = Vector3(p.x, p.y, 0);\nVector3 faraway = Vector3(p.x, p.y, 1);\n\nXMMATRIX invViewProj = XMMatrixInverse(&amp;det, GameRenderer.m_matView * GameRenderer.m_matProj);\nVector3 rayorigin = XMVector3Transform(origin, invViewProj);\nVector3 rayend = XMVector3Transform(faraway, invViewProj);\nVector3 raydirection = rayend - rayorigin;\nraydirection.Normalize();\n\ng_cObjectManager.createObject(BUL_OBJ, \"bullet\", rayorigin, raydirection * 5);\n</code></pre>\n\n<p>I assume at least the matrix inversion approach from stackoverflow should work, but for some reason my attempt doesn't. Do I need the world matrix as well, or is there some step I'm missing?</p>\n\n<p>This is my first stackoverflow post, so if anything is unclear or more information is needed please let me know.</p>\n"}, {"tags": ["python", "c++", "multithreading", "c++11", "boost-python"], "answers": [{"comments": [{"owner": {"reputation": 1830, "user_id": 6409928, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/LaYJ6.jpg?s=128&g=1", "display_name": "Elad Maimoni", "link": "https://stackoverflow.com/users/6409928/elad-maimoni"}, "edited": false, "score": 0, "creation_date": 1502970156, "post_id": 45698334, "comment_id": 78425965, "body": "Indeed, at the time I did not understand the behavior of std::async and the fact the std::future destructor blocks. But regarding calling a python function on a different c++ thread, it is not as simple as you illustrate and requires manipulating with the GIL (python global interpreter lock)."}], "tags": [], "owner": {"reputation": 116, "user_id": 2139518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfdc20e5e8570576dbe17ceaa788d84f?s=128&d=identicon&r=PG", "display_name": "Satie", "link": "https://stackoverflow.com/users/2139518/satie"}, "is_accepted": false, "score": 0, "last_activity_date": 1502819070, "last_edit_date": 1502819070, "creation_date": 1502818558, "answer_id": 45698334, "question_id": 39376579, "link": "https://stackoverflow.com/questions/39376579/boostpython-how-to-invoke-a-python-function-in-its-own-thread-from-c/45698334#45698334", "title": "boost::python - how to invoke a python function in its own thread from C++?", "body": "<p>Seems you misunderstood  the behavior of  <a href=\"http://en.cppreference.com/w/cpp/thread/async\" rel=\"nofollow noreferrer\">std::async</a> </p>\n\n<p>a snippet of test code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;chrono&gt;\n#include &lt;thread&gt;\n#include &lt;future&gt;\n\nint doSomething(){\n  std::cout &lt;&lt; \"do something\"&lt;&lt;std::endl;\n  return 1;\n}\n\nint main(){\n   auto f = std::async(doSomething);\n\n   std::this_thread::sleep_for(std::chrono::seconds(3));\n   std::cout &lt;&lt;\"wait a while\"&lt;&lt;std::endl;\n   f.get();\n   return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>wait a while\ndo something\n</code></pre>\n\n<p>change the line</p>\n\n<pre><code>auto f = std::async(doSomething);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>auto f = std::async(std::launch::async,doSomething);\n</code></pre>\n\n<p>Then output:</p>\n\n<pre><code>do something\nwait a while\n</code></pre>\n\n<p>As your example, to run it immediately in another thread, you can try :</p>\n\n<pre><code>std::async(std::launch::async,loadScene);\n</code></pre>\n"}], "owner": {"reputation": 1830, "user_id": 6409928, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/LaYJ6.jpg?s=128&g=1", "display_name": "Elad Maimoni", "link": "https://stackoverflow.com/users/6409928/elad-maimoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 668, "favorite_count": 0, "answer_count": 1, "score": 11, "last_activity_date": 1502819070, "creation_date": 1473271641, "last_edit_date": 1473335619, "question_id": 39376579, "link": "https://stackoverflow.com/questions/39376579/boostpython-how-to-invoke-a-python-function-in-its-own-thread-from-c", "title": "boost::python - how to invoke a python function in its own thread from C++?", "body": "<p>I have a module written in python. this module is sort of an interface to many different functionalities I implemented in Python:</p>\n\n<p>EmbeddingInterface.py simply imports this module and creates an instance:</p>\n\n<pre><code>import CPPController\n\ncppControllerInstance = CPPController()\n</code></pre>\n\n<p>I would like to use cppControllerInstance in c++. this is what I have done so far:</p>\n\n<pre><code>#include &lt;Python.h&gt;\n#include &lt;boost\\python.hpp&gt;\n\nusing namespace boost;\n\npython::object createController()\n{\n    try\n    {\n        Py_Initialize();\n\n        python::object mainModule = python::import(\"__main__\");\n        python::object mainNamespace = mainModule.attr(\"__dict__\");\n\n        python::dict locals;\n\n        python::exec(\n            \"print \\\"loading python implementetion:\\\"\\n\"\n            \"import sys\\n\"\n            \"sys.path.insert(0, \\\"C:\\\\Projects\\\\Python\\\\ProjectName\\\\Panda\\\")\\n\"\n            \"import EmbeddingInterface\\n\"\n            \"controller = EmbeddingInterface.cppControllerInstance\\n\",\n            mainNamespace, locals);\n\n            python::object controller = locals[\"controller\"];\n            return controller;\n    }\n    catch(...) {}\n}\n</code></pre>\n\n<p><strong>The Problem:</strong></p>\n\n<p>This 'controller' has some functions which must be called asynchronously.\nits work is continuous and in addition it can throw exceptions.\nwhich is why std::async sounded great.</p>\n\n<p>But it doesn't work:</p>\n\n<pre><code>int main()\n{\n    python::object controller = createController();\n    python::object loadScene = controller.attr(\"loadScene\");\n    //loadScene(); // works OK but blocking!\n    std::async(loadScene); // non blocking but nothing happens!\n    while(true); // do some stuff\n}\n</code></pre>\n\n<p>I tried to invoke the python function 'loadScene' with its own thread but the function seemed to be blocking. It never returns.</p>\n\n<p>What is the proper way of doing that?</p>\n"}, {"tags": ["c++", "memory-management", "polymorphism", "c++14"], "answers": [{"comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1473271260, "post_id": 39376382, "comment_id": 66080861, "body": "<code>reinterpret_cast</code> always looks (smells) <i>fishy</i> for me :/"}, {"owner": {"reputation": 2725, "user_id": 2296177, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/854fa6632f9806fae99a1b49b4e07e08?s=128&d=identicon&r=PG", "display_name": "user2296177", "link": "https://stackoverflow.com/users/2296177/user2296177"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1473271581, "post_id": 39376382, "comment_id": 66081010, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 It does, but I believe I&#39;m using it safely. One of the goals was to hide anything that had to do with pointers/memory management from the user."}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1473271672, "post_id": 39376382, "comment_id": 66081050, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 It depends actually. I worked on a wrapper of libuv and it was the fastest (only?) way to deal with the underlying data structures. It&#39;s useful when you work with low level <i>C-ish</i> libraries indeed."}], "tags": [], "owner": {"reputation": 2725, "user_id": 2296177, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/854fa6632f9806fae99a1b49b4e07e08?s=128&d=identicon&r=PG", "display_name": "user2296177", "link": "https://stackoverflow.com/users/2296177/user2296177"}, "is_accepted": true, "score": 10, "last_activity_date": 1473405300, "last_edit_date": 1592644375, "creation_date": 1473270780, "answer_id": 39376382, "question_id": 39376380, "link": "https://stackoverflow.com/questions/39376380/how-can-i-polymorphically-store-and-access-different-types-from-the-same-inherit/39376382#39376382", "title": "How can I polymorphically store and access different types from the same inheritance hierarchy in contiguous memory?", "body": "<p>Now with alignment support.</p>\n<p>Demo: <a href=\"http://coliru.stacked-crooked.com/a/c304d2b6a475d70c\" rel=\"noreferrer\">http://coliru.stacked-crooked.com/a/c304d2b6a475d70c</a></p>\n<hr />\n<p>This answer focuses on solving the three features requested in the question.</p>\n<ul>\n<li>No static memory is used because it will lead to code breaking changes if a new type is added to the inheritance hierarchy and that new type exceeds the static limit.</li>\n<li>All types inside the storage are properly aligned.</li>\n<li>The correct move/copy constructors are called when reallocation occurs.</li>\n</ul>\n<p>It compiles with <code>fstrict-aliasing</code>, so don't be too afraid of that <code>reinterpret_cast&lt;&gt;()</code> usage.</p>\n<hr />\n<p>The <code>handle_base</code> type has a <code>void*</code> data member called <code>src_</code>, which points to some value. It has two member functions that act on <code>src_</code>.</p>\n<h3><code>void transfer( void* dst, std::size_t&amp; out_size )</code></h3>\n<p>Uses placement-new to either move or copy construct the value pointed to by <code>src_</code> at <code>dst</code>, then sets <code>src_</code> to <code>dst</code>. It also adds the size, in bytes, taken by the type to the <code>out_size</code> reference argument; this is useful for properly aligning types.</p>\n<h3><code>void* src()</code></h3>\n<p>Returns the pointer <code>src_</code>.</p>\n<p><em>handle_base.h</em></p>\n<pre><code>namespace gut\n{\n    template&lt;class T&gt; class handle;\n\n    class handle_base\n    {\n    public:\n        virtual ~handle_base() = default;\n\n        handle_base() = default;\n        handle_base( handle_base&amp;&amp; ) = default;\n        handle_base( handle_base const&amp; ) = default;\n        handle_base&amp; operator=( handle_base&amp;&amp; ) = default;\n        handle_base&amp; operator=( handle_base const&amp; ) = default;\n\n        void* src() const noexcept\n        {\n            return src_;\n        }\n\n        virtual void transfer( void* dst, std::size_t&amp; out_size ) = 0;\n        virtual void destroy() = 0;\n\n    protected:\n        handle_base( void* src ) noexcept\n            : src_{ src }\n        {}\n\n        void* src_;\n    };\n}\n</code></pre>\n<hr />\n<p>Next, I create the <code>handle&lt;T&gt;</code> type which inherits from <code>handle_base</code> in order to provide the correct move/copy operations. Type information is available at this level; this enables everything from proper alignment to proper move/copy operations.</p>\n<h3><code>void transfer( void* dst, std::size_t&amp; out_size )</code></h3>\n<p>The function will take care of selecting whether to use the move or copy constructor. The move constructor will always be chosen if it is available. It calculates any required padding for alignment, transfers the value at <code>src_</code> to <code>dst + padding</code> and increments the <code>out_size</code> reference argument by its size and padding.</p>\n<p><em>handle.h</em></p>\n<pre><code>namespace gut\n{\n    template&lt;class T&gt;\n    static std::size_t calculate_padding( void* p ) noexcept\n    {\n        std::size_t r{ reinterpret_cast&lt;std::uintptr_t&gt;( p ) % alignof( T ) };\n        return r == 0 ? 0 : alignof( T ) - r;\n    }\n\n    template &lt;class T&gt;\n    class handle final : public handle_base\n    {\n    public:\n        using byte = unsigned char;\n\n        static_assert( sizeof( void* ) == sizeof( T* ),\n            &quot;incompatible pointer sizes&quot; );\n\n        static constexpr std::integral_constant\n        &lt;\n            bool, std::is_move_constructible&lt;T&gt;::value\n        &gt; is_moveable{};\n\n        handle( T* src ) noexcept\n            : handle_base( src )\n        {}\n\n        handle( handle&amp;&amp; ) = default;\n        handle( handle const&amp; ) = default;\n        handle&amp; operator=( handle&amp;&amp; ) = default;\n        handle&amp; operator=( handle const&amp; ) = default;\n\n        void transfer( std::true_type, void* dst )\n        noexcept( std::is_nothrow_move_assignable&lt;T&gt;::value )\n        {\n            src_ = ::new ( dst ) T{ std::move( *reinterpret_cast&lt;T*&gt;( src_ ) ) };\n        }\n\n        void transfer( std::false_type, void* dst )\n        noexcept( std::is_nothrow_copy_assignable&lt;T&gt;::value )\n        {\n            src_ = ::new ( dst ) T{ *reinterpret_cast&lt;T*&gt;( src_ ) };\n        }\n\n        virtual void transfer( void* dst, std::size_t&amp; out_size )\n        noexcept( noexcept(\n            std::declval&lt;handle&gt;().transfer( is_moveable, dst ) ) ) override\n        {\n            std::size_t padding{ gut::calculate_padding&lt;T&gt;( dst ) };\n            transfer( is_moveable, reinterpret_cast&lt;byte*&gt;( dst ) + padding );\n            out_size += sizeof( T ) + padding;\n        }\n\n        virtual void destroy()\n        noexcept( std::is_nothrow_destructible&lt;T&gt;::value )\n        {\n            reinterpret_cast&lt;T*&gt;( src_ )-&gt;~T();\n            src_ = nullptr;\n        }\n    };\n}\n</code></pre>\n<hr />\n<p>Since I know for a fact that <code>sizeof( handle_base ) == sizeof( handle&lt;T&gt; )</code> for any <code>T</code>, I create a <code>polymorphic_handle</code> type as an extra indirection for ease of use. This type can hold any <code>handle&lt;T&gt;</code> and overloads <code>operator-&gt;()</code> so that it can act as a generic handle to any handle.</p>\n<p><em>polymorphic_handle.h</em></p>\n<pre><code>namespace gut\n{\n    class polymorphic_handle\n    {\n    public:\n        using value_type = gut::handle_base;\n        using pointer = value_type*;\n        using const_pointer = value_type const*;\n\n        template&lt;class T&gt;\n        polymorphic_handle( gut::handle&lt;T&gt; h ) noexcept\n        {\n            ::new ( &amp;h_ ) gut::handle&lt;T&gt;{ h };\n        }\n\n        pointer operator-&gt;()\n        {\n            return reinterpret_cast&lt;pointer&gt;( &amp;h_ );\n        }\n\n        const_pointer operator-&gt;() const\n        {\n            return reinterpret_cast&lt;const_pointer&gt;( &amp;h_ );\n        }\n\n    private:\n        std::aligned_storage_t&lt;sizeof( value_type ), alignof( value_type )&gt; h_;\n    };\n}\n</code></pre>\n<hr />\n<p>Now that all the building blocks are present, the <code>polymorphic_storage&lt;T&gt;</code> type can be defined. It simply stores a <code>std::vector&lt;gut::polymorphic_handle&gt;</code>, a buffer and size information.</p>\n<p>The storage type ensures that only classes that derive from its template argument type can be added. It can only be created with an initial instance or some initial capacity (in bytes).</p>\n<h3><code>template&lt;class D&gt; void ensure_capacity()</code></h3>\n<p>This function does almost all of the work. It ensures that there is enough capacity for the type specified as a template argument and transfers all data to a new buffer on reallocation. It also updates the <code>size_</code> member function to the next construction location.</p>\n<h3><code>void emplace_back( D&amp;&amp; value )</code></h3>\n<p>This will emplace <code>value</code> into the <code>polymorphic_storage&lt;B&gt;</code> and create a handle to the newly emplaced value.</p>\n<pre><code>namespace gut\n{\n    template&lt;class B&gt;\n    class polymorphic_storage\n    {\n    public:\n        using byte = unsigned char;\n        using size_type = std::size_t;\n\n        ~polymorphic_storage() noexcept\n        {\n            for ( auto&amp; h : handles_ )\n            {\n                h-&gt;destroy();\n            }\n            std::free( data_ );\n        }\n\n        explicit polymorphic_storage( size_type const initial_capacity )\n        {\n            byte* new_data\n            {\n                reinterpret_cast&lt;byte*&gt;( std::malloc( initial_capacity ) )\n            };\n\n            if ( new_data )\n            {\n                data_ = new_data;\n                size_ = 0;\n                capacity_ = initial_capacity;\n            }\n            else\n            {\n                throw std::bad_alloc{};\n            }\n        }\n\n        template\n        &lt;\n            class D,\n            std::enable_if_t&lt;std::is_base_of&lt;B, std::decay_t&lt;D&gt;&gt;::value, int&gt; = 0\n        &gt;\n        explicit polymorphic_storage( D&amp;&amp; value )\n            : data_{ nullptr }\n            , size_{ 0 }\n            , capacity_{ 0 }\n        {\n            using der_t = std::decay_t&lt;D&gt;;\n            \n            byte* new_data{ reinterpret_cast&lt;byte*&gt;(\n                std::malloc( sizeof( der_t ) + alignof( der_t ) ) ) };\n            \n            if ( new_data )\n            {\n                data_ = new_data;\n                size_ = sizeof( der_t );\n                capacity_ = sizeof( der_t ) + alignof( der_t );\n                handles_.emplace_back( gut::handle&lt;der_t&gt;\n                {\n                    ::new ( data_ ) der_t{ std::forward&lt;D&gt;( value ) }\n                } );\n            }\n            else\n            {\n                throw std::bad_alloc{};\n            }\n        }\n\n        template\n        &lt;\n            class D,\n            std::enable_if_t&lt;std::is_base_of&lt;B, std::decay_t&lt;D&gt;&gt;::value, int&gt; = 0\n        &gt;\n        void emplace_back( D&amp;&amp; value )\n        {\n            using der_t = std::decay_t&lt;D&gt;;\n\n            ensure_capacity&lt;der_t&gt;();\n            der_t* p{ ::new ( data_ + size_ ) der_t{ std::forward&lt;D&gt;( value ) } };\n            size_ += sizeof( der_t );\n            handles_.emplace_back( gut::handle&lt;der_t&gt;{ p } );\n        }\n\n        template\n        &lt;\n            class D,\n            std::enable_if_t&lt;std::is_base_of&lt;B, std::decay_t&lt;D&gt;&gt;::value, int&gt; = 0\n        &gt;\n        void ensure_capacity()\n        {\n            using der_t = std::decay_t&lt;D&gt;;\n\n            auto padding = gut::calculate_padding&lt;der_t&gt;( data_ + size_ );\n            if ( capacity_ - size_ &lt; sizeof( der_t ) + padding )\n            {\n                auto new_capacity =\n                    ( sizeof( der_t ) + alignof( der_t ) + capacity_ ) * 2;\n\n                auto new_data = reinterpret_cast&lt;byte*&gt;(\n                    std::malloc( new_capacity ) );\n\n                if ( new_data )\n                {\n                    size_ = 0;\n                    capacity_ = new_capacity;\n                    for ( auto&amp; h : handles_ )\n                    {\n                        h-&gt;transfer( new_data + size_, size_ );\n                    }\n                    std::free( data_ );\n                    data_ = new_data;\n                }\n                else\n                {\n                    throw std::bad_alloc{};\n                }\n            }\n            else\n            {\n                size_ += padding;\n            }\n        }\n\n    public:\n        std::vector&lt;gut::polymorphic_handle&gt; handles_;\n        byte* data_;\n        size_type size_;\n        size_type capacity_;\n    };\n}\n</code></pre>\n<hr />\n<p>Here is an example of the storage in use. Note that types <code>der0</code>, <code>der1</code> and <code>der2</code> inherit from <code>base</code> and have different sizes and alignments.</p>\n<p>Demo: <a href=\"http://coliru.stacked-crooked.com/a/c304d2b6a475d70c\" rel=\"noreferrer\">http://coliru.stacked-crooked.com/a/c304d2b6a475d70c</a></p>\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nstruct base\n{\n    virtual ~base() = default;\n    virtual void print() const = 0;\n};\n\nstruct der0 : public base\n{\n    der0( int&amp;&amp; i ) noexcept : i_{ i } {}\n    void print() const override { std::cout &lt;&lt; &quot;der0_&quot; &lt;&lt; i_ &lt;&lt; '\\n'; }\n    int i_;\n};\n\nstruct der1 : public base\n{\n    der1( std::string const&amp; s ) noexcept : s_{ s } {}\n    void print() const override { std::cout &lt;&lt; &quot;der1_&quot; &lt;&lt; s_ &lt;&lt; '\\n'; }\n    std::string s_;\n};\n\nstruct der2 : public base\n{\n    der2( std::string&amp;&amp; s ) noexcept : s_{ std::move( s ) } {}\n    void print() const override { std::cout &lt;&lt; &quot;der2_&quot; &lt;&lt; s_ &lt;&lt; '\\n'; }\n    std::string s_;\n    double d[ 22 ];\n};\n\nint main()\n{\n    gut::polymorphic_storage&lt;base&gt; ps{ 32 };\n    ps.emplace_back( der1{ &quot;aa&quot; } );\n    ps.emplace_back( der2{ &quot;bb&quot; } );\n    ps.emplace_back( der1{ &quot;cc&quot; } );\n    ps.emplace_back( der2{ &quot;ee&quot; } );\n    ps.emplace_back( der0{ 13 } );\n    ps.emplace_back( der2{ &quot;ff&quot; } );\n\n    for ( auto handle : ps.handles_ )\n        reinterpret_cast&lt;base*&gt;( handle-&gt;src() )-&gt;print();\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1473279510, "post_id": 39377398, "comment_id": 66084644, "body": "<i>&quot;it creates manual vtables, and extends them&quot;</i> - In the 90&#39;s we called that <i>&quot;COM&quot;</i>. Although your <i>&quot;manual&quot;</i> looks a lot more <i>&quot;automatic&quot;</i>."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1473281096, "post_id": 39377398, "comment_id": 66085330, "body": "@IInspectable COM is one way to build your own object model.  C libraries build object models before C++ existed, using tables of function pointers in place of vtables.  C++ object model with virtual inheritance leaves a <i>lot</i> of stuff undefined and makes questionable choices, so by rolling your own you can be a touch more portable and have finer grained control (such as the above, where it splits the vtable from the object, which would permit me to create a value-view class that is a pseudo-reference to any value type).  The <code>any_method</code> does auto-write &quot;manual&quot; vtables for you, true."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1473281257, "post_id": 39377398, "comment_id": 66085408, "body": "@IInspectable and by &quot;manual&quot; I mean &quot;in user-code&quot;.  Naturally my user-code write the entries, anything else would violate DRY."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 5, "last_activity_date": 1506554353, "last_edit_date": 1506554353, "creation_date": 1473275134, "answer_id": 39377398, "question_id": 39376380, "link": "https://stackoverflow.com/questions/39376380/how-can-i-polymorphically-store-and-access-different-types-from-the-same-inherit/39377398#39377398", "title": "How can I polymorphically store and access different types from the same inheritance hierarchy in contiguous memory?", "body": "<p>This approach tried to avoid creating virtual objects in a buffer.  Instead, it creates manual vtables, and extends them.</p>\n\n<p>The first thing we start with is a value vtable that lets us deal with a value virtually:</p>\n\n<pre><code>struct value_vtable {\n  void(* copy_ctor)(void* dest, void const* src) = nullptr;\n  void(* move_ctor)(void* dest, void* src) = nullptr;\n  void(* dtor)(void* delete_this) = nullptr;\n};\n</code></pre>\n\n<p>Creating one of these for a type <code>T</code> looks like this:</p>\n\n<pre><code>template&lt;class T&gt;\nvalue_vtable make_value_vtable() {\n  return {\n    [](void* dest, void const* src) { // copy\n      new(dest) T( *(T const*)src );\n    },\n    [](void* dest, void * src) { // move\n      new(dest) T( std::move(*(T*)src) );\n    },\n    [](void* delete_this) { // dtor\n      ((T*)delete_this)-&gt;~T();\n    },\n  };\n}\n</code></pre>\n\n<p>We can store these vtables inline, or we can create static storage for them:</p>\n\n<pre><code>template&lt;class T&gt;\nvalue_vtable const* get_value_vtable() {\n  static auto const table = make_value_vtable&lt;T&gt;();\n  return &amp;table;\n}\n</code></pre>\n\n<p>At this point we haven't stored anything.</p>\n\n<p>Here is a value_storage.  It can store any value (can be copied and moved and destroyed):</p>\n\n<pre><code>template&lt;std::size_t S, std::size_t A&gt;\nstruct value_storage {\n  value_vtable const* vtable;\n  std::aligned_storage_t&lt;S, A&gt; data;\n  template&lt;class T,\n    std::enable_if_t&lt;!std::is_same&lt; std::decay_t&lt;T&gt;, value_storage &gt;{}, int&gt; =0,\n    std::enable_if_t&lt; ( sizeof(T)&lt;=S &amp;&amp; alignof(T)&lt;=A ), int &gt; = 0\n  &gt;\n  value_storage( T&amp;&amp; tin ) {\n    new ((void*)&amp;data) std::decay_t&lt;T&gt;( std::forward&lt;T&gt;(tin) );\n    vtable = get_value_vtable&lt;std::decay_t&lt;T&gt;&gt;();\n  }\n  // to permit overriding the vtable:\nprotected:\n  template&lt;class T&gt;\n  value_storage( value_vtable const* vt, T&amp;&amp; t ):\n    value_storage( std::forward&lt;T&gt;(t) )\n  {\n    vtable = vt;\n  }\npublic:\n  void move_from( value_storage&amp;&amp; rhs ) {\n    clear();\n    if (!rhs.vtable) return;\n    rhs.vtable-&gt;move_ctor( &amp;data, &amp;rhs.data );\n    vtable = rhs.vtable;\n  }\n  void copy_from( value_storage const&amp; rhs ) {\n    clear();\n    if (!rhs.vtable) return;\n    rhs.vtable-&gt;copy_ctor( &amp;data, &amp;rhs.data );\n    vtable = rhs.vtable;\n  }\n  value_storage( value_storage const&amp; rhs ) {\n    copy_from(rhs);\n  }\n  value_storage( value_storage &amp;&amp; rhs ) {\n    move_from(std::move(rhs));\n  }\n  value_storage&amp; operator=( value_storage const&amp; rhs ) {\n    copy_from(rhs);\n    return *this;\n  }\n  value_storage&amp; operator=( value_storage &amp;&amp; rhs ) {\n    move_from(std::move(rhs));\n    return *this;\n  }\n  template&lt;class T&gt;\n  T* get() { return (T*)&amp;data; }\n  template&lt;class T&gt;\n  T const* get() const { return (T*)&amp;data; }\n  explicit operator bool() const { return vtable; }\n  void clear() {\n    if (!vtable) return;\n    vtable-&gt;dtor( &amp;data );\n    vtable = nullptr;\n  }\n  value_storage() = default;\n  ~value_storage() { clear(); }\n};\n</code></pre>\n\n<p>This type stores something that acts like a value, maybe, up to size <code>S</code> and align <code>A</code>.  It does not store what type it stores, that is someone else's job.  It does store how to copy, move and destroy anything it stores, but it doesn't know what the thing is it is storing.</p>\n\n<p>It assumes objects constructed in a block are constructed at the front of it.  You can add a <code>void* ptr</code> field if you do not want to make that assumption.</p>\n\n<p>Now we can augment this <code>value_storage</code> with operations.</p>\n\n<p>In particular, we want cast-to-base.</p>\n\n<pre><code>template&lt;class Base&gt;\nstruct based_value_vtable:value_vtable {\n  Base*(* to_base)(void* data) = nullptr;\n};\n\ntemplate&lt;class Base, class T&gt;\nbased_value_vtable&lt;Base&gt; make_based_value_vtable() {\n  based_value_vtable&lt;Base&gt; r;\n  (value_vtable&amp;)(r) = make_value_vtable&lt;T&gt;();\n  r.to_base = [](void* data)-&gt;Base* {\n    return (T*)data;\n  };\n  return r;\n}\n\ntemplate&lt;class Base, class T&gt;\nbased_value_vtable&lt;Base&gt; const* get_based_value_vtable() {\n  static const auto vtable = make_based_value_vtable&lt;Base, T&gt;();\n  return &amp;vtable;\n}\n</code></pre>\n\n<p>Now we have extended the <code>value_vtable</code> to include a family of \"vtable with base\".</p>\n\n<pre><code>template&lt;class Base, std::size_t S, std::size_t A&gt;\nstruct based_value:value_storage&lt;S, A&gt; {\n  template&lt;class T,\n    std::enable_if_t&lt; !std::is_same&lt; std::decay_t&lt;T&gt;, based_value &gt;{}, int&gt; = 0\n  &gt;\n  based_value( T&amp;&amp; tin ):\n    value_storage&lt;S, A&gt;(\n      get_based_value_vtable&lt;Base, std::decay_t&lt;T&gt; &gt;(),\n      std::forward&lt;T&gt;(tin)\n    )\n  {}\n\n  template&lt;class T&gt;\n  based_value(\n    based_value_vtable&lt;Base&gt; const* vt,\n    T&amp;&amp; tin\n  ) : value_storage&lt;S, A&gt;( vt, std::forward&lt;T&gt;(tin) )\n  {}\n\n  based_value() = default;\n  based_value( based_value const&amp; ) = default;\n  based_value( based_value &amp;&amp; ) = default;\n  based_value&amp; operator=( based_value const&amp; ) = default;\n  based_value&amp; operator=( based_value &amp;&amp; ) = default;\n  based_value_vtable&lt;Base&gt; const* get_vt() const {\n    return static_cast&lt; based_value_vtable&lt;Base&gt;* &gt;(this-&gt;vtable);\n  }\n  Base* get() {\n    if (!*this) return nullptr;\n    return get_vt()-&gt;to_base( &amp;this-&gt;data );\n  }\n  Base const* get() const {\n    if (!*this) return nullptr;\n    return get_vt()-&gt;to_base( (void*)&amp;this-&gt;data );\n  }\n};\n</code></pre>\n\n<p>These are regular value types that store locally, are polymorphic, and can be anything descended from <code>Base</code> that match the size and alignment requirements.</p>\n\n<p>Simply store a vector of these.  And that solves your problem.  These objects satisfy the axioms of value types that <code>std::vector</code> expects.</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/98e07495d929d9fd\" rel=\"nofollow noreferrer\">live example</a>.  Code not heavily tested (you can see the very small test), it probably still contains some typos.  But the design is solid, I have done this before.</p>\n\n<p>Augmenting with <code>operator*</code> and <code>operator-&gt;</code> is an excercise left to the reader.  If you want extreme performance at the cost of some size, you can store the vtable function pointers inline in the class instead of in shared memory.</p>\n\n<hr>\n\n<p>If you find yourself doing this more than once or adding new capabilities to your <code>based_value</code>, a better extension than the bespoke <code>based_value</code> trick would be to automate the vtable extension procedure.  I'd use something like <a href=\"http://stackoverflow.com/a/38837687/1774667\">type erasure with <code>std::any</code></a>, simply replacing the <code>any</code> with the <code>value_storage&lt;Size, Align&gt;</code> for guaranteed automatic storage, adding in better <code>const</code> support, and integrating the two vtables into one (like in <code>based_value</code> above).</p>\n\n<p>In the end, we'd get:</p>\n\n<pre><code>template&lt;class T&gt;\nauto to_base = [](auto&amp;&amp; self)-&gt;copy_const&lt; decltype(self), T&amp; &gt; {\n  return decltype(self)(self);\n};\n\ntemplate&lt;class Base, std::size_t S, std::size_t A&gt;\nusing based_value = super_value_storage&lt; S, A, decltype(to_base&lt;Base&gt;) &gt;;\n\nusing my_type = based_value&lt; Some_Base, 100, 32 &gt;;\n\nmy_type bob = // some expression\nif (bob)\n  return (bob-&gt;*to_base&lt;Some_Base&gt;)()\nelse\n  return nullptr;\n</code></pre>\n\n<p>or somesuch.</p>\n\n<p>All of the C-style casts can be replaced with a combination of static and const casts, but I got lazy.  I don't believe I ever do anything requiring a reinterpret cast.</p>\n\n<p>But really, once you have this kind of magic value-based polymorphism, why bother with a base at all?  Simply erase all of the operations you want on the value, and accept anything that supports the erased operations.</p>\n\n<p>With careful use of ADL in your <code>any_method</code>s, you can now concept-map distinct objects over to your set of concepts that must be supported.  If you know how to chicken a vector of dogs, you can directly store a vector of dogs in a <code>super_value_storage&lt; Size, Align, ..., decltype(do_the_chicken) &gt;</code>.</p>\n\n<p>That might be going too far, however.</p>\n"}], "owner": {"reputation": 2725, "user_id": 2296177, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/854fa6632f9806fae99a1b49b4e07e08?s=128&d=identicon&r=PG", "display_name": "user2296177", "link": "https://stackoverflow.com/users/2296177/user2296177"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 4, "accepted_answer_id": 39376382, "answer_count": 2, "score": 14, "last_activity_date": 1506554353, "creation_date": 1473270780, "last_edit_date": 1473271145, "question_id": 39376380, "link": "https://stackoverflow.com/questions/39376380/how-can-i-polymorphically-store-and-access-different-types-from-the-same-inherit", "title": "How can I polymorphically store and access different types from the same inheritance hierarchy in contiguous memory?", "body": "<p>For polymorphism, the usual approach is to use <code>std::vector&lt;base*&gt;</code>. However, I have to provide the addresses myself, that is to manage the memory myself whether I use <code>std::unique_ptr&lt;&gt;</code> or raw pointers.</p>\n\n<p>I would like to have a <code>polymorphic_storage&lt;base&gt;</code> type that accepts any type that inherits from <code>base</code>. I also want the types to be stored in contiguous memory for faster traversal and for cache related concerns.</p>\n\n<p>However, there's a pretty big issue: In the absence of type information at the storage level, the correct move/copy operations must be called on resize.</p>\n\n<p>Feature request:</p>\n\n<ul>\n<li>Any type that inherits from the base class can be added to the storage; no fixed inheritance hierarchies.</li>\n<li>The inheriting types must be correctly aligned inside of the storage type.</li>\n<li>The correct move and copy operations must be called since I am not dealing with POD types.</li>\n</ul>\n\n<p>What mechanism can I use to achieve this?</p>\n\n<hr>\n\n<p>While I provide an answer, I would welcome anyone to post their solution.</p>\n"}, {"tags": ["c++", "opengl", "events", "camera", "sdl"], "comments": [{"owner": {"reputation": 56, "user_id": 6431969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nqDLd.jpg?s=128&g=1", "display_name": "nica.dan.cs", "link": "https://stackoverflow.com/users/6431969/nica-dan-cs"}, "edited": false, "score": 0, "creation_date": 1473271325, "post_id": 39376356, "comment_id": 66080885, "body": "First of all I would make sure there is no performance issue. How many FPS do you have?"}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 1, "creation_date": 1473271377, "post_id": 39376356, "comment_id": 66080914, "body": "Why do you call <code>ProcessEvents</code> inside event loop? Shouldn&#39;t it be called once per frame regardless on how many events are here?"}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 1, "creation_date": 1473271536, "post_id": 39376356, "comment_id": 66080991, "body": "By the way behaviour you&#39;ve explaied is called &#39;key repeat&#39;. It is the same if you press a letter button here in your question edit and hold it - first press, pause, then continuous repeat. Both pause and repeat interval are controlled by OS/display server."}, {"owner": {"reputation": 39, "user_id": 2890770, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b74d54a0f64294347f9786d729848260?s=128&d=identicon&r=PG&f=1", "display_name": "therealkf", "link": "https://stackoverflow.com/users/2890770/therealkf"}, "edited": false, "score": 0, "creation_date": 1473273562, "post_id": 39376356, "comment_id": 66081885, "body": "My FPS is easily 100+ Nica and keltar I guess because I wanted to split the event processing away from the main engine loop to try and prevent it being too messy and cluttered. It&#39;s not all properly organised yet because I was just trying to sort this out and thanks for your second comment, that makes a lot of sense!"}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 1, "creation_date": 1473273693, "post_id": 39376356, "comment_id": 66081945, "body": "It isn&#39;t about organised, it just wrong. Say I move mouse pointer quickly, press multiple buttons, have some events from gamepad, etc.., and you call moveforward how many times at this frame? While it should be just 1. Or if there is no events at all (e.g. key repeat is disabled), and you don&#39;t move at all while you should."}, {"owner": {"reputation": 39, "user_id": 2890770, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b74d54a0f64294347f9786d729848260?s=128&d=identicon&r=PG&f=1", "display_name": "therealkf", "link": "https://stackoverflow.com/users/2890770/therealkf"}, "edited": false, "score": 0, "creation_date": 1473274652, "post_id": 39376356, "comment_id": 66082382, "body": "Yeah makes sense, I moved the processevents call out of the event loops, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 2890770, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b74d54a0f64294347f9786d729848260?s=128&d=identicon&r=PG&f=1", "display_name": "therealkf", "link": "https://stackoverflow.com/users/2890770/therealkf"}, "edited": false, "score": 0, "creation_date": 1473273463, "post_id": 39376481, "comment_id": 66081849, "body": "Ahh okay that makes sense. So is all I need to do what you put there? Or do I have to make a loop kinda like with PollEvent to actually check for new events?"}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 1, "creation_date": 1473273764, "post_id": 39376481, "comment_id": 66081975, "body": "<code>SDL_GetKeyState</code> wouldn&#39;t update if you don&#39;t flush event queue, either with <code>SDL_WaitEvent</code>, <code>SDL_PollEvent</code> or <code>SDL_PumpEvents</code>."}, {"owner": {"reputation": 39, "user_id": 2890770, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b74d54a0f64294347f9786d729848260?s=128&d=identicon&r=PG&f=1", "display_name": "therealkf", "link": "https://stackoverflow.com/users/2890770/therealkf"}, "edited": false, "score": 1, "creation_date": 1473274587, "post_id": 39376481, "comment_id": 66082349, "body": "Seems like GetKeyState doesn&#39;t exist anymore and was replaced with GetKeyboardState which I&#39;m assuming works similarly so I&#39;ll try it out. Thanks!"}, {"owner": {"reputation": 39, "user_id": 2890770, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b74d54a0f64294347f9786d729848260?s=128&d=identicon&r=PG&f=1", "display_name": "therealkf", "link": "https://stackoverflow.com/users/2890770/therealkf"}, "edited": false, "score": 1, "creation_date": 1473274905, "post_id": 39376481, "comment_id": 66082495, "body": "Works perfectly thanks! Just needed to change around a few things and it works better than I expected. Accepted as answer though you might want to update it to say that SDL_GetKeyState has been replaced with SDL_GetKeyboardState."}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "reply_to_user": {"reputation": 39, "user_id": 2890770, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b74d54a0f64294347f9786d729848260?s=128&d=identicon&r=PG&f=1", "display_name": "therealkf", "link": "https://stackoverflow.com/users/2890770/therealkf"}, "edited": false, "score": 0, "creation_date": 1473307573, "post_id": 39376481, "comment_id": 66092204, "body": "@therealkf just so you understand - it is <b>very</b> similar to what you initially did in the question. SDL fills key state array based on the same events, and you did that yourself, so result is the same. Your only problem, as I&#39;ve said before, was calling move inside event loop. Once you fix that both your version and this one will work because its underlying code is almost identical."}], "tags": [], "owner": {"reputation": 15997, "user_id": 16725, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Ym5wb.jpg?s=128&g=1", "display_name": "Paul-Jan", "link": "https://stackoverflow.com/users/16725/paul-jan"}, "is_accepted": true, "score": 5, "last_activity_date": 1473321116, "last_edit_date": 1473321116, "creation_date": 1473271213, "answer_id": 39376481, "question_id": 39376356, "link": "https://stackoverflow.com/questions/39376356/non-instantaneous-jerky-movement-using-sdl2-opengl/39376481#39376481", "title": "Non instantaneous/jerky movement using SDL2 &amp; OpenGL", "body": "<p>Do not use <code>SDL_PollEvent</code> with the <code>SDL_KEYDOWN</code> and <code>SDL_KEYUP</code> events, it is subject to OS keyboard repeat rates. Which is great for typing, but not for camera/player controls. Use <a href=\"https://wiki.libsdl.org/SDL_GetKeyboardState\" rel=\"nofollow\">SDL_GetKeyboardState(NULL)</a> in stead to query the current state of the keys.</p>\n\n<p>For example:</p>\n\n<pre><code>Uint8* keystate = SDL_GetKeyState(NULL);\n\nif(keystate[SDL_SCANCODE_W])\n{\n  m_Camera-&gt;MoveForward(5.0f*(deltaTime*0.001));\n}\nif(keystate[SDL_SCANCODE_S])\n{\n  m_Camera-&gt;MoveForward(-5.0f*(deltaTime*0.001));\n}\n// etc\n</code></pre>\n\n<p><em>(Answer edited to take corrections from comments into account)</em></p>\n"}], "owner": {"reputation": 39, "user_id": 2890770, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b74d54a0f64294347f9786d729848260?s=128&d=identicon&r=PG&f=1", "display_name": "therealkf", "link": "https://stackoverflow.com/users/2890770/therealkf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 854, "favorite_count": 0, "accepted_answer_id": 39376481, "answer_count": 1, "score": 0, "last_activity_date": 1473321116, "creation_date": 1473270720, "last_edit_date": 1473271482, "question_id": 39376356, "link": "https://stackoverflow.com/questions/39376356/non-instantaneous-jerky-movement-using-sdl2-opengl", "title": "Non instantaneous/jerky movement using SDL2 &amp; OpenGL", "body": "<p>I've been working on a little 3D engine trying to fix up the camera and make it less jerky. I've been using SDL for the input and while it works it's doing this thing where if I press and hold a button it will instantly move once then pause and then start moving properly making the movement feel unresponsive. </p>\n\n<p>I recorded a GIF of it and while it may be slightly hard to see what's happening hopefully it'll give some idea:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ROPvL.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ROPvL.gif\" alt=\"gif\"></a>\n<br></p>\n\n<p>Moving forward and then right would be like: </p>\n\n<p>w   wwwwwwwwwwwwwwww a   aaaaaaaaaaaaaaaaaaaaa</p>\n\n<p>The important code is here but feel free to ask for more if necessary: </p>\n\n<pre><code>//Poll events\n    SDL_Event event;\n    while (m_EngineState != EngineState::EXIT)\n    {\n        m_last = m_current;\n        m_current = SDL_GetPerformanceCounter();\n        deltaTime = (double)((m_current - m_last) * 1000 / SDL_GetPerformanceFrequency());\n\n        while (SDL_PollEvent(&amp;event))\n        {\n            switch (event.type) {\n            case SDL_QUIT:\n                m_EngineState = EngineState::EXIT;\n                break;\n\n            case SDL_MOUSEMOTION:\n                break;\n\n            case SDL_KEYDOWN:\n                m_Keys[event.key.keysym.sym] = true;\n                break;\n            case SDL_KEYUP:\n                m_Keys[event.key.keysym.sym] = false;\n                break;\n            }\n            ProcessEvents();\n        }\n\nvoid Engine::ProcessEvents()\n{\n    if (m_Keys[SDLK_w])\n    {\n        m_Camera-&gt;MoveForward(5.0f*(deltaTime*0.001));\n    }\n    if (m_Keys[SDLK_s])\n    {\n        m_Camera-&gt;MoveForward(-5.0f*(deltaTime*0.001));\n    }\n    if (m_Keys[SDLK_d])\n    {\n        m_Camera-&gt;MoveRight(5.0f*(deltaTime*0.001));\n    }\n    if (m_Keys[SDLK_a])\n    {\n        m_Camera-&gt;MoveRight(-5.0f*(deltaTime*0.001));\n    }\n}\n\nvoid Camera::MoveForward(float amount)\n{  \n    m_pos += m_forward * amount;\n}\n\nvoid Camera::MoveRight(float amount)\n{\n    m_pos += glm::cross(m_forward, m_up) * amount;\n}\n</code></pre>\n"}, {"tags": ["c++", "sockets"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1473270431, "post_id": 39376270, "comment_id": 66080445, "body": "How do you make a streaming socket from a file? Do you mean use local sockets (i.e. <code>AF_LOCAL</code>or <code>AF_UNIX</code>)? Please try to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> that you can show us. And if you haven&#39;t done it before, please <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1473270897, "post_id": 39376270, "comment_id": 66080685, "body": "Which OS? Socket&#39;s aren&#39;t part of the standard c++ library?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1473271526, "post_id": 39376270, "comment_id": 66080983, "body": "What do you mean by &quot;causes a client exception&quot; exactly?"}, {"owner": {"reputation": 771, "user_id": 654495, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d796bdee06a3aff4eb200aa6a60b5cb6?s=128&d=identicon&r=PG", "display_name": "Chaos", "link": "https://stackoverflow.com/users/654495/chaos"}, "edited": false, "score": 0, "creation_date": 1473272154, "post_id": 39376270, "comment_id": 66081282, "body": "I&#39;ve updated the question to be more clear. Let me know if it&#39;s still isn&#39;t up to standard."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1473281555, "post_id": 39376270, "comment_id": 66085559, "body": "Sockets are in their very nature two-way. There&#39;s no way to make them unidirectional. There&#39;s also no way to &quot;broadcast&quot; on a local socket, except to send to each connected client one by one You could use UDP broadcasting for the <code>127.0.0.1&#47;8</code> network, but as sockets those are bidirectional. You <i>could</i> use named pipes, those are unidirectional, but then you can&#39;t broadcast at all. You might want to look into other <a href=\"https://en.wikipedia.org/wiki/Inter-process_communication\" rel=\"nofollow noreferrer\">inter-process communication methods</a> as well."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1473281738, "post_id": 39376270, "comment_id": 66085631, "body": "There is a simple solution for <i>emulating</i> unidirectional sockets though: Don&#39;t write to it. And if the clients write to the socket, just don&#39;t read anything in the server. Sooner or later the buffers on the server and client side will fill up, and the client will get an error trying to write to the socket."}, {"owner": {"reputation": 771, "user_id": 654495, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d796bdee06a3aff4eb200aa6a60b5cb6?s=128&d=identicon&r=PG", "display_name": "Chaos", "link": "https://stackoverflow.com/users/654495/chaos"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1473285767, "post_id": 39376270, "comment_id": 66087213, "body": "@JoachimPileborg , perhaps I am misunderstanding. But anything a client writes is also sent to all other clients. Is that correct?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1473314167, "post_id": 39376270, "comment_id": 66094131, "body": "Yes you misunderstand. Local sockets are still peer to peer, not broadcast."}], "answers": [{"tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": true, "score": 1, "last_activity_date": 1473272534, "creation_date": 1473272534, "answer_id": 39376777, "question_id": 39376270, "link": "https://stackoverflow.com/questions/39376270/one-way-sock-stream/39376777#39376777", "title": "One-way SOCK_STREAM", "body": "<p>It is not possible to make a read-only unix domain socket and enforce this with file permissions. From the relevant man page <a href=\"http://man7.org/linux/man-pages/man7/unix.7.html\" rel=\"nofollow\">unix(7)</a></p>\n\n<blockquote>\n  <p>On Linux, <strong>connecting to a stream socket object requires write permission on that socket</strong>; sending a datagram to a datagram socket <strong>likewise requires write permission on that socket</strong>.  POSIX does not make any statement about the effect of the permissions on a socket file, and on some systems (e.g., older BSDs), the socket permissions are ignored.  Portable programs should not rely on this feature for       security.</p>\n</blockquote>\n"}], "owner": {"reputation": 771, "user_id": 654495, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d796bdee06a3aff4eb200aa6a60b5cb6?s=128&d=identicon&r=PG", "display_name": "Chaos", "link": "https://stackoverflow.com/users/654495/chaos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 39376777, "answer_count": 1, "score": -1, "last_activity_date": 1473272534, "creation_date": 1473270340, "last_edit_date": 1473271901, "question_id": 39376270, "link": "https://stackoverflow.com/questions/39376270/one-way-sock-stream", "title": "One-way SOCK_STREAM", "body": "<p>We're creating a socket using SOCK_STREAM over AF_UNIX (a local file). We have many processes on the system which are clients, and we are only interested in broadcasting messages to those clients. OS is Ubuntu 14.04.5 LTS.</p>\n\n<p>This all works if the file permissions are 666, however as a security measure we want to change it to 644. However, this causes a permission exception when clients try to connect using the below code:</p>\n\n<pre><code>int XyzClient::establish_connection() {\n     int fd;\n\n     if ((fd = socket(AF_UNIX, SOCK_STREAM, 0)) == -1) {\n         throw XyzException(strerror(errno));\n     }\n\n     sockaddr_un addr = {};\n     addr.sun_family = AF_UNIX;\n     strncpy(addr.sun_path, DEFAULT_SOCKET_PATH, sizeof(addr.sun_path)-1);\n\n     if (connect(fd, (sockaddr*)&amp;addr, sizeof(addr)) == -1) {\n         // connect failed, close fd and throw exception\n         close(fd);\n         throw XyzException(strerror(errno));\n     }\n\n     return fd;\n }\n</code></pre>\n\n<p>Presumably the issue is the above code tries to establish read-write access to the file and which is causing the permission error.</p>\n\n<p>Is it possible to do a one-way SOCK_STREAM such that we can lock down the file to be read-only by everyone except the owner/broadcaster?</p>\n"}, {"tags": ["c++"], "answers": [{"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 1, "last_activity_date": 1473271054, "last_edit_date": 1473271054, "creation_date": 1473270505, "answer_id": 39376305, "question_id": 39376190, "link": "https://stackoverflow.com/questions/39376190/how-to-read-spaced-string-with-get-line-from-a-file/39376305#39376305", "title": "How to read spaced string with get line() from a file?", "body": "<p>Problem is that your input file has empty lines in it.</p>\n\n<p>If you use <code>cin &gt;&gt;</code> only, it will work OK because <code>&gt;&gt;</code> operator skips blank chars (but stops at blank chars, as you noted: can't have it all)</p>\n\n<p>On the other hand, <code>getline</code> will read the line, even if it's blank.</p>\n\n<p>I propose the following standalone code slightly modified from yours: note the loop until end of file or non-blank line.\n(note: it there are spaces only in the line, it will fail)</p>\n\n<p>I also replaced array by a vector, resized on the fly (more C++-ish)</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;fstream&gt;\n#include&lt;string&gt;\n#include&lt;vector&gt;\nusing namespace std;\n\ntypedef struct {\n\n    string number; //I use string because it is an alphanumeric cellphone number \n    string person;\n    int identifier;\n} cellphone;\n\n\nint main()\n{\n\nifstream entry;\nstring fileName = \"file.txt\";\nentry.open(fileName.c_str());\n\nvector&lt;cellphone&gt; c;\n\ncellphone current;\n\nint j=0;\n\n    if(entry)\n    {\n        cout &lt;&lt; \"The file has been successfully opened\\n\\n\";\n        while(!entry.eof())\n        {\n            entry &gt;&gt; current.identifier &gt;&gt; current.number;\n            while(!entry.eof())\n            {\n            getline(entry,current.person);\n            if (current.person!=\"\") break;  // stops if non-blank line\n            }\n            c.push_back(current);\n\n            cout &lt;&lt; \"Start: \" &lt;&lt; c[j].identifier &lt;&lt; \"\\nNumber: \" &lt;&lt; c[j].number &lt;&lt; \"\\nPerson: \" &lt;&lt; c[j].person &lt;&lt;endl&lt;&lt;endl;\n            j++;\n        }\n    }\n    return 0;\n}  \n</code></pre>\n\n<p>output:</p>\n\n<pre><code>The file has been successfully opened\n\nStart: 1\nNumber: +546343864246\nPerson: Penelope Pasaft\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6805924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92410ecc542ae167e184d60d75b9a0fa?s=128&d=identicon&r=PG&f=1", "display_name": "Charlotte", "link": "https://stackoverflow.com/users/6805924/charlotte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473274140, "creation_date": 1473269979, "last_edit_date": 1473274140, "question_id": 39376190, "link": "https://stackoverflow.com/questions/39376190/how-to-read-spaced-string-with-get-line-from-a-file", "title": "How to read spaced string with get line() from a file?", "body": "<p>I want to read a name like \"Penelope Pasaft\" all together from a file and save it to a variable \"person\". I have understood that I have to use the get line(file, person). But I have a problem doing it because I want also to read other variables before. \nImagine a .txt like:</p>\n\n<hr>\n\n<p>1</p>\n\n<p>+546343864246</p>\n\n<p>Penelope Pasaft</p>\n\n<hr>\n\n<p>So here is the code:</p>\n\n<pre><code>typedef struct {\n\n    string number; //I use string because it is an alphanumeric cellphone number \n    string person;\n    int identifier;\n} cellphone;\n\nifstream entry;\n\nentry.open(fileName.c_str());\n\ncellphone c[10];\n\nint j=0;\n\n    if(entry)\n    {\n        cout &lt;&lt; \"The file has been successfully opened\\n\\n\";\n        while(!entry.eof())\n        {\n            entry &gt;&gt; c[j].identifier &gt;&gt; c[j].number;\n            getline(entry,c[j].person);\n\n            cout &lt;&lt; \"Start: \" &lt;&lt; c[j].identifier &lt;&lt; \"\\nNumber: \" &lt;&lt;\n                c[j].number &lt;&lt; \"\\nPerson: \" &lt;&lt; c[j].person &lt;&lt; endl &lt;&lt; endl;\n            j++;\n        }\n    }\n</code></pre>\n\n<p>Well the problem I have it's that it doesn't seem to print or save me any data to the variable c[j].person</p>\n"}, {"tags": ["c++", "unicode", "glfw", "utf-32"], "comments": [{"owner": {"reputation": 91026, "user_id": 131433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e6eeaf8698180e971e169a925d8e0f4f?s=128&d=identicon&r=PG", "display_name": "bmargulies", "link": "https://stackoverflow.com/users/131433/bmargulies"}, "edited": false, "score": 5, "creation_date": 1473269778, "post_id": 39376089, "comment_id": 66080158, "body": "What characters are in question? What conversion did you try? What operating system are you on?"}, {"owner": {"reputation": 21, "user_id": 5671891, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/445b6e3ecbc6c854547c584ef11344a1?s=128&d=identicon&r=PG&f=1", "display_name": "Sven G", "link": "https://stackoverflow.com/users/5671891/sven-g"}, "reply_to_user": {"reputation": 91026, "user_id": 131433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e6eeaf8698180e971e169a925d8e0f4f?s=128&d=identicon&r=PG", "display_name": "bmargulies", "link": "https://stackoverflow.com/users/131433/bmargulies"}, "edited": false, "score": 0, "creation_date": 1473277859, "post_id": 39376089, "comment_id": 66083888, "body": "The characters I&#39;m looking for are the actual letters (unless I&#39;m missunderstanding the function), i.e. pressing &#39;e&#39; on the keyboard sends the character &#39;e&#39; to the callback method. As I said: I&#39;ve tried codecvt (from this example code <a href=\"http://en.cppreference.com/w/cpp/locale/codecvt\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/locale/codecvt</a> ) and using the ICU library. With ICU I tried creating two converters. One from UTF-32 to Unicode, and finally from Unicode to UTF-8. However, since ucnv_toUChars takes char* as input, and explicitly typecasting the unsigned int didn&#39;t work. I can recreate the deleted code if you want me to."}, {"owner": {"reputation": 21, "user_id": 5671891, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/445b6e3ecbc6c854547c584ef11344a1?s=128&d=identicon&r=PG&f=1", "display_name": "Sven G", "link": "https://stackoverflow.com/users/5671891/sven-g"}, "reply_to_user": {"reputation": 91026, "user_id": 131433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e6eeaf8698180e971e169a925d8e0f4f?s=128&d=identicon&r=PG", "display_name": "bmargulies", "link": "https://stackoverflow.com/users/131433/bmargulies"}, "edited": false, "score": 0, "creation_date": 1473277883, "post_id": 39376089, "comment_id": 66083903, "body": "Also, I&#39;m using Linux."}, {"owner": {"reputation": 91026, "user_id": 131433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e6eeaf8698180e971e169a925d8e0f4f?s=128&d=identicon&r=PG", "display_name": "bmargulies", "link": "https://stackoverflow.com/users/131433/bmargulies"}, "edited": false, "score": 1, "creation_date": 1473278132, "post_id": 39376089, "comment_id": 66084016, "body": "What do you mean by Unicode? And is your Linux terminal window set up to handle UTF-8? ICU can convert, I believe, UTF-32 directly to UTF-8. It would help if you posted your conversion code."}, {"owner": {"reputation": 21, "user_id": 5671891, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/445b6e3ecbc6c854547c584ef11344a1?s=128&d=identicon&r=PG&f=1", "display_name": "Sven G", "link": "https://stackoverflow.com/users/5671891/sven-g"}, "reply_to_user": {"reputation": 91026, "user_id": 131433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e6eeaf8698180e971e169a925d8e0f4f?s=128&d=identicon&r=PG", "display_name": "bmargulies", "link": "https://stackoverflow.com/users/131433/bmargulies"}, "edited": false, "score": 0, "creation_date": 1473279682, "post_id": 39376089, "comment_id": 66084712, "body": "The terminal should be set up for UTF-8 by default, shouldn&#39;t it? I&#39;ve added my code in the post above (also commented the line that causes the ICU error). Am I feeding ucnv_toUChars bad data?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5671891, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/445b6e3ecbc6c854547c584ef11344a1?s=128&d=identicon&r=PG&f=1", "display_name": "Sven G", "link": "https://stackoverflow.com/users/5671891/sven-g"}, "edited": false, "score": 0, "creation_date": 1473322016, "post_id": 39379412, "comment_id": 66098257, "body": "Yup, that&#39;s correct. Thank you very much!"}], "tags": [], "owner": {"reputation": 1190, "user_id": 3207828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EPkw.jpg?s=128&g=1", "display_name": "Dan Korn", "link": "https://stackoverflow.com/users/3207828/dan-korn"}, "is_accepted": true, "score": 0, "last_activity_date": 1473284304, "creation_date": 1473284304, "answer_id": 39379412, "question_id": 39376089, "link": "https://stackoverflow.com/questions/39376089/printing-a-utf-32-character-to-terminal/39379412#39379412", "title": "Printing a UTF-32 character to terminal", "body": "<p>You're calling ucnv_toUChars(), which converts an 8-bit string to Unicode.  But you need to go the other way, and convert your Unicode string to 8-bit, such as UTF-8.  I would use the UnicodeString class, which has a constructor taking UTF-32, and a method toUTF8String().</p>\n"}], "owner": {"reputation": 21, "user_id": 5671891, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/445b6e3ecbc6c854547c584ef11344a1?s=128&d=identicon&r=PG&f=1", "display_name": "Sven G", "link": "https://stackoverflow.com/users/5671891/sven-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 839, "favorite_count": 0, "closed_date": 1473295227, "accepted_answer_id": 39379412, "answer_count": 1, "score": 0, "last_activity_date": 1473284304, "creation_date": 1473269635, "last_edit_date": 1473279824, "question_id": 39376089, "link": "https://stackoverflow.com/questions/39376089/printing-a-utf-32-character-to-terminal", "closed_reason": "Not suitable for this site", "title": "Printing a UTF-32 character to terminal", "body": "<p>I'm reading user input from GLFW using callbacks (set using glfwSetCharCallback) according to this page:\n<a href=\"http://www.glfw.org/docs/latest/input.html#input_char\" rel=\"nofollow\">http://www.glfw.org/docs/latest/input.html#input_char</a></p>\n\n<p>The callback function recieves the pressed key as a 32-bit unsigned int. How can I convert this to something that I can print on my screen? I've tried both codecvt from C++11 and the ICU library, but couldn't get anything to print readable characters to my terminal.</p>\n\n<p>This is the code of my callback function:</p>\n\n<pre><code>void InputManager::charInputCallback(GLFWwindow* window, unsigned int key)\n    {\n        UErrorCode errorStatus = U_ZERO_ERROR; //initialize to no error\n        UConverter *utf32toUnicode = ucnv_open(\"UTF-32\", &amp;errorStatus); //create converter utf-32 &lt;=&gt; Unicode\n        if(U_FAILURE(errorStatus))\n            std::cout &lt;&lt; u_errorName(errorStatus) &lt;&lt; std::endl;\n        UChar unicode[10] = {0};\n        ucnv_toUChars(utf32toUnicode, unicode, 10, (char*)key, 4, &amp;errorStatus); // this fails with an U_ILLEGAL_ARGUMENT_ERROR\n        if(U_FAILURE(errorStatus))\n            std::cout &lt;&lt; u_errorName(errorStatus) &lt;&lt; std::endl;\n\n        std::cout &lt;&lt; unicode &lt;&lt; std::endl;\n    }\n</code></pre>\n\n<p>If I do nothing to the input (key), nothing's shown at all. Just a blank line.</p>\n"}, {"tags": ["c#", "c++", "winapi", "audio-capture"], "comments": [{"owner": {"reputation": 2125, "user_id": 6691061, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1219688551388660/picture?type=large", "display_name": "Shannon Holsinger", "link": "https://stackoverflow.com/users/6691061/shannon-holsinger"}, "edited": false, "score": 0, "creation_date": 1473267711, "post_id": 39375591, "comment_id": 66079146, "body": "Yeah - that&#39;s WHY the &quot;majority of applications [you] intend to capture are protected by various anti-cheat systems.&quot; Danged copwrite laws. Who needs &#39;em?"}, {"owner": {"reputation": 64286, "user_id": 868014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PoaTp.png?s=128&g=1", "display_name": "Roman R.", "link": "https://stackoverflow.com/users/868014/roman-r"}, "edited": false, "score": 0, "creation_date": 1473267906, "post_id": 39375591, "comment_id": 66079243, "body": "You will have to hook. And most likely not just <code>IAudioRenderClient</code> but all audio APIs the applications in question use."}], "owner": {"reputation": 1, "user_id": 6805622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a44b8e7e5879397763ae0c1962e5772e?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/6805622/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "closed_date": 1473267963, "answer_count": 0, "score": 0, "last_activity_date": 1473270540, "creation_date": 1473267535, "last_edit_date": 1495542765, "question_id": 39375591, "link": "https://stackoverflow.com/questions/39375591/capturing-a-single-applications-audio-with-win32", "closed_reason": "Duplicate", "title": "Capturing a single application&#39;s audio with Win32", "body": "<p>How would I go about capturing the audio output of a single application with Win32/C++/C#, whilst avoiding hooking against <code>IAudioRenderClient</code>?</p>\n\n<p>I have only been able to find solutions to capture the whole audio output of the system (or rather, the currently active audio output port / capture device), either through DirectShow or various other Win32 API functions (WASAPI etc.) which were of little help (because I only need a single applications audio output). The only viable solution seemed to be hooking the applications IAudioRenderClient and then calling <code>IAudioRenderClient::GetBuffers()</code> according to <a href=\"https://stackoverflow.com/questions/6084550/capture-audio-of-a-single-application-on-windows-7\">this</a>.</p>\n\n<p>The reason I am trying to avoid this is that a majority of applications I intend to capture are protected by various anti-cheat systems, able to detect the code injection but unable to differentiate it from an actual cheat.</p>\n\n<p>Any pointers towards APIs/API-functions etc. or anything silencing my concerns of false detection would be highly appreciated.</p>\n"}, {"tags": ["c++", "templates", "c++11", "variadic-templates"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1473267656, "post_id": 39375575, "comment_id": 66079113, "body": "Do you think you could provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>? I&#39;d like to compile the top snippet myself."}, {"owner": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "edited": false, "score": 1, "creation_date": 1473267697, "post_id": 39375575, "comment_id": 66079136, "body": "Missing <code>template</code> disambiguation, my friend. Also <code>(int[]) { .. }</code> is non-standard syntax borrowed from C."}, {"owner": {"reputation": 1790, "user_id": 1494080, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bb73686af44a279f58a72f79263a41ef?s=128&d=identicon&r=PG", "display_name": "user1494080", "link": "https://stackoverflow.com/users/1494080/user1494080"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1473268075, "post_id": 39375575, "comment_id": 66079318, "body": "@AndyG I am not sure what you are missing. You can take both snippets, copy them as they are to e.g. <code>www.cpp.sh</code> and observe that the above compiles successfully and the below does not."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1473268266, "post_id": 39375575, "comment_id": 66079409, "body": "<code>o.template getValue&lt;Attributes&gt;()</code>. This has nothing to do with pack expansions."}, {"owner": {"reputation": 1790, "user_id": 1494080, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bb73686af44a279f58a72f79263a41ef?s=128&d=identicon&r=PG", "display_name": "user1494080", "link": "https://stackoverflow.com/users/1494080/user1494080"}, "reply_to_user": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "edited": false, "score": 0, "creation_date": 1473268573, "post_id": 39375575, "comment_id": 66079561, "body": "@JohannesSchaub-litb Are you sure that this is non-standard syntax? Have a look at <a href=\"http://en.cppreference.com/w/cpp/language/list_initialization\" rel=\"nofollow noreferrer\">link</a>: <code>T { arg1, arg2, ... };</code> initializes an unnamed temporary with a braced-init-list."}, {"owner": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "edited": false, "score": 0, "creation_date": 1473277332, "post_id": 39375575, "comment_id": 66083665, "body": "@user1494080 yes.. you can ask a new question if you are unsure about it. it is nonstandard and not shown on the site you link"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1473281549, "post_id": 39375575, "comment_id": 66085553, "body": "<code>(int []) { stuff }</code> is a C99 compound literal. The <code>T</code> in C++ has to be a <i>simple-type-specifier</i> or a <i>typename-specifier</i>; <code>(int [])</code> is neither."}], "owner": {"reputation": 1790, "user_id": 1494080, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bb73686af44a279f58a72f79263a41ef?s=128&d=identicon&r=PG", "display_name": "user1494080", "link": "https://stackoverflow.com/users/1494080/user1494080"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "closed_date": 1473268240, "answer_count": 0, "score": 0, "last_activity_date": 1473268128, "creation_date": 1473267475, "last_edit_date": 1473268128, "question_id": 39375575, "link": "https://stackoverflow.com/questions/39375575/calling-a-function-template-in-a-pack-expansion-pattern", "closed_reason": "Duplicate", "title": "Calling a function template in a pack expansion pattern", "body": "<p>Let's keep it short. Why does the following code compile successfully...</p>\n\n<pre><code>#define RUN_FORALL(pattern) (int[]){0, ((pattern), void(), 0)...}\ntemplate &lt;typename ...Attributes&gt;\nclass Foo : public Attributes... {\n  template &lt;typename T&gt;\n  void bar(T o) { RUN_FORALL(Attributes::value = o.getValue()); }\n};\nint main() {}\n</code></pre>\n\n<p>... and the following code does not?</p>\n\n<pre><code>#define RUN_FORALL(pattern) (int[]){0, ((pattern), void(), 0)...}\ntemplate &lt;typename ...Attributes&gt;\nclass Foo : public Attributes... {\n  template &lt;typename T&gt;\n  void bar(T o) { RUN_FORALL(Attributes::value = o.getValue&lt;Attributes&gt;()); }\n};\nint main() {}\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>1:30: error: expected primary-expression before 'int'\n5:19: note: in expansion of macro 'RUN_FORALL'\n</code></pre>\n\n<p>How can I call a function template in a pack expansion pattern?</p>\n"}, {"tags": ["c++", "qt"], "owner": {"reputation": 11, "user_id": 6805770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b1578053cf85b2bf4896583b62bb66?s=128&d=identicon&r=PG&f=1", "display_name": "herme", "link": "https://stackoverflow.com/users/6805770/herme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1473267841, "creation_date": 1473267280, "last_edit_date": 1473267841, "question_id": 39375517, "link": "https://stackoverflow.com/questions/39375517/qt-5-7-imx6-compilation", "title": "Qt 5.7 IMX6 compilation", "body": "<p>I'm trying to compile Qt 5.7 for my imx6 platform and I have a problem with opengl. </p>\n\n<p>Yocto + meta-qt5</p>\n\n<p>Error msg:</p>\n\n<pre><code>/usr/include/GLES2/gl2.h:67:25: note: previous declaration as 'typedef khronos_ssize_t GLsizeiptr'\n typedef khronos_ssize_t GLsizeiptr;\n                         ^\nusr/include/qt5/QtGui/qopenglext.h:475:19: error: conflicting declaration 'typedef ptrdiff_t GLintptr'\n typedef ptrdiff_t GLintptr;\n                   ^\nusr/include/GLES2/gl2.h:68:26: note: previous declaration as 'typedef khronos_intptr_t GLintptr'\n typedef khronos_intptr_t GLintptr;\n                          ^\n</code></pre>\n\n<p>Does someone know what I can do with this?</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 778, "user_id": 6618289, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1149829745350f27012281268c37c618?s=128&d=identicon&r=PG&f=1", "display_name": "meetaig", "link": "https://stackoverflow.com/users/6618289/meetaig"}, "edited": false, "score": 2, "creation_date": 1473267317, "post_id": 39375511, "comment_id": 66078936, "body": "QString supports initialization using char*"}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1473272450, "post_id": 39376663, "comment_id": 66081400, "body": "<code>const char *</code> in this case"}], "tags": [], "owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "is_accepted": true, "score": 0, "last_activity_date": 1473275401, "last_edit_date": 1473275401, "creation_date": 1473272000, "answer_id": 39376663, "question_id": 39375511, "link": "https://stackoverflow.com/questions/39375511/why-qfile-test-work-though-class-qfile-has-no-qfilechar-s-constructor/39376663#39376663", "title": "Why QFile(&quot;./test&quot;) work though [Class QFile] has no QFile(char* s) constructor", "body": "<p>Consider the statement:</p>\n\n<pre><code>QFile(\"/home/mythicsr/test\");\n</code></pre>\n\n<p>It leads to the creation of a temporary object of type <code>QString</code> under the hood and thus the constructor <code>QFile(const QString &amp;name)</code> is invoked.<br>\nAs mentioned by @meetaig in the comments it's possible because:</p>\n\n<blockquote>\n  <p>QString supports initialization using char*</p>\n</blockquote>\n\n<p>Or better, as noted in the comments by @Slava - <em><code>const char *</code> in this case</em>.</p>\n\n<p>That's all.</p>\n"}], "owner": {"reputation": 3, "user_id": 6134424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3489de1d73920365b5485f00283cb0dd?s=128&d=identicon&r=PG&f=1", "display_name": "ellischan", "link": "https://stackoverflow.com/users/6134424/ellischan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 39376663, "answer_count": 1, "score": -5, "last_activity_date": 1473275401, "creation_date": 1473267257, "last_edit_date": 1473271893, "question_id": 39375511, "link": "https://stackoverflow.com/questions/39375511/why-qfile-test-work-though-class-qfile-has-no-qfilechar-s-constructor", "title": "Why QFile(&quot;./test&quot;) work though [Class QFile] has no QFile(char* s) constructor", "body": "<p>I check the <em>QT-Help</em>, I found that class <code>QFile</code> has the following constructors:</p>\n\n<pre><code>QFile()\nQFile(const QString &amp;name)\nQFile(QObject *parent)\nQFile(const QString &amp;name, QObject *parent)\n</code></pre>\n\n<p>There is no <code>QFile(char *)</code> for class <code>QFile</code>\nBut <code>QFile(\"/home/mythicsr/test\");</code> is ok, why?</p>\n"}, {"tags": ["c++", "sockets", "winsock"], "answers": [{"comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1473269636, "post_id": 39376006, "comment_id": 66080103, "body": "I believe it&#39;s inherited on pretty much all modern implementations. But I&#39;d definitely try setting it on the individual socket to make sure, it&#39;s not well documented."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1473297192, "post_id": 39376006, "comment_id": 66089987, "body": "On Windows, it should definitely be a <code>DWORD</code>, not an <code>int</code>.  The <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms740532.aspx\" rel=\"nofollow noreferrer\">MSDN documentation</a> says as much."}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 2, "last_activity_date": 1473269312, "creation_date": 1473269312, "answer_id": 39376006, "question_id": 39375481, "link": "https://stackoverflow.com/questions/39375481/set-a-timeout-for-recv-from-socket-on-windows/39376006#39376006", "title": "Set a timeout for recv from socket on Windows", "body": "<blockquote>\n  <p>To set a timeout for recv function on windows i know i must use this code:</p>\n</blockquote>\n\n<pre><code>             DWORD timeout = 2000;\n\n             if (setsockopt(listenSocket, SOL_SOCKET, SO_RCVTIMEO, (char*)&amp;timeout, sizeof(DWORD)))\n             { perror(\"setsockopt\");\n            return -1;\n             }\n</code></pre>\n\n<p>No. It should be an <code>int</code>, not a <code>DWORD</code>, but the main problem is that youre are here setting an <code>accept()</code> timeout, as this is the listening socket. You need to set it on the accepted socket(s).</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 6805599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d365b48eadbcc7b4af76293c1091867f?s=128&d=identicon&r=PG&f=1", "display_name": "cerry92", "link": "https://stackoverflow.com/users/6805599/cerry92"}, "edited": false, "score": 0, "creation_date": 1473275523, "post_id": 39376241, "comment_id": 66082791, "body": "Thanks for the answer. I will modify my code taking into account your comment."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 3, "last_activity_date": 1473270225, "creation_date": 1473270225, "answer_id": 39376241, "question_id": 39375481, "link": "https://stackoverflow.com/questions/39375481/set-a-timeout-for-recv-from-socket-on-windows/39376241#39376241", "title": "Set a timeout for recv from socket on Windows", "body": "<p>Your code tries to use the socket after it has timed out. This is not a good idea because the socket is still somewhere in the middle of the failed blocking operation and in no shape to start a new operation. There's no way to unwind the portions of the operation that have previously completed and put the socket back where it was before the operation started.</p>\n\n<p>Once a blocking socket operation times out, all you can safely do is close the socket. There is no support for undoing an operation that is partially completed and leaving the socket in any kind of sane state.</p>\n\n<blockquote>\n  <p>If a send or receive operation times out on a socket, the socket state is indeterminate, and should not be used[.] -- <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms740476(v=vs.85).aspx\" rel=\"nofollow\">MSDN</a></p>\n</blockquote>\n\n<p>The SO_RCVTIMEO socket option should never be used in code that's designed to work with sockets. It's a kludge to prevent infinite waits in code that wasn't designed to work with sockets natively. These aren't the droids you're looking for.</p>\n"}], "owner": {"reputation": 21, "user_id": 6805599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d365b48eadbcc7b4af76293c1091867f?s=128&d=identicon&r=PG&f=1", "display_name": "cerry92", "link": "https://stackoverflow.com/users/6805599/cerry92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3818, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1473274744, "creation_date": 1473267153, "last_edit_date": 1473274744, "question_id": 39375481, "link": "https://stackoverflow.com/questions/39375481/set-a-timeout-for-recv-from-socket-on-windows", "title": "Set a timeout for recv from socket on Windows", "body": "<p>Ih,\nI think my code is correct but it doesn't work :(</p>\n\n<p>To set a timeout for recv function on windows i know i must use this code:</p>\n\n<pre><code>                    DWORD timeout = 2000;\n\n                 if (setsockopt(listenSocket, SOL_SOCKET, SO_RCVTIMEO, (char*)&amp;timeout, sizeof(DWORD)))\n                 { perror(\"setsockopt\");\n                return -1;\n                 }\n</code></pre>\n\n<p>But it doesn't work.</p>\n\n<p>The code of my server is:</p>\n\n<pre><code>    SOCKET listenSocket;\nSOCKET remoteSocket= INVALID_SOCKET;\nSOCKADDR_IN Server_addr;\nSOCKADDR_IN Client_addr;\nint sin_size;\nshort port;\n\nint wsastartup;\nint ls_result;\nWORD wVersionRequested = 0x0202;\nWSADATA wsaData;\n\nwsastartup = WSAStartup(wVersionRequested, &amp;wsaData);\nif (wsastartup != NO_ERROR) cout &lt;&lt; \"Errore WSAStartup()\" &lt;&lt; endl;\n\nlistenSocket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\n\nport = 4000;\nServer_addr.sin_family = AF_INET;\nServer_addr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n\nServer_addr.sin_port = htons(port);\n\nif (bind(listenSocket,(LPSOCKADDR) &amp;Server_addr,sizeof(struct sockaddr)) &lt; 0) {\n    cout &lt;&lt; \"Server: error bind.\" &lt;&lt; endl;\nclosesocket(listenSocket);\nreturn -1;\n}\n\nls_result = listen(listenSocket, SOMAXCONN);\n\nsin_size = sizeof(struct sockaddr_in);\nremoteSocket = accept(listenSocket, (struct sockaddr *) &amp;Client_addr, &amp;sin_size);\n\n// SET THE TIME OUT\nDWORD timeout = 300;\nif (setsockopt(remoteSocket, SOL_SOCKET, SO_RCVTIMEO, (char*)&amp;timeout, sizeof(DWORD)))\n{ perror(\"setsockopt\");\n    return -1;\n}\n\nint i=0;\nwhile (i&lt;50){\n    t_start = clock();\n\n    // when client receives the send below it wait 3 seconds and then trasmits the answer\n    send(remoteSocket, \"code of start transmission\", sizeof(\"code of start transmission\"), 0);\n\n    recv_size=recv(remoteSocket, messaggio, sizeof(messaggio), 0);\n\n    printf(\"time for read=  %f second \\n\", ((double)(end - t_start)) / CLOCKS_PER_SEC);\n\n    i=i+1;\n}\n</code></pre>\n\n<p>The client when receives the message \"code of start transmission\" from servers, it wait 3 seconds and then aswer to server.\nI expect time for read is 300 ms and recv_size&lt;0, instead recv_size&lt;0 but time for read is more or less 1.5 seconds (The server waits for the client's message). I don't understand why. </p>\n\n<p>I'm on windows and i'm using eclipse and mingw-w64.</p>\n\n<p>Please someone can help me??</p>\n"}, {"tags": ["c++", "algorithm", "data-structures"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 1, "creation_date": 1473267198, "post_id": 39375473, "comment_id": 66078859, "body": "How is the number represented?  I&#39;m struggling to see how you&#39;d end up with an O(N^2) approach."}, {"owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "edited": false, "score": 0, "creation_date": 1473267541, "post_id": 39375473, "comment_id": 66079043, "body": "Should the sequence of non-erased digits be kept same in answer?"}, {"owner": {"reputation": 2347, "user_id": 958571, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/052c91fa0832efce3af47d40d5ed04b9?s=128&d=identicon&r=PG", "display_name": "notbad", "link": "https://stackoverflow.com/users/958571/notbad"}, "edited": false, "score": 1, "creation_date": 1473267572, "post_id": 39375473, "comment_id": 66079065, "body": "Seems similar to this question: <a href=\"http://stackoverflow.com/questions/28223580/how-to-get-the-least-number-after-deleting-k-digits-from-the-input-number\" title=\"how to get the least number after deleting k digits from the input number\">stackoverflow.com/questions/28223580/&hellip;</a>, which try to find the minimum value."}, {"owner": {"reputation": 153, "user_id": 5610655, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VBn8i.jpg?s=128&g=1", "display_name": "Jahirul Islam Monir", "link": "https://stackoverflow.com/users/5610655/jahirul-islam-monir"}, "edited": false, "score": 0, "creation_date": 1473267817, "post_id": 39375473, "comment_id": 66079202, "body": "I saw it but couldn&#39;t catch the the approach from there.Can you please make a answer for this"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1473269147, "post_id": 39375473, "comment_id": 66079847, "body": "If the largest number has magnitude 10^6 it&#39;s 6 digits long, and the asymptotic behavior of your algorithm just doesn&#39;t matter."}, {"owner": {"reputation": 153, "user_id": 5610655, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VBn8i.jpg?s=128&g=1", "display_name": "Jahirul Islam Monir", "link": "https://stackoverflow.com/users/5610655/jahirul-islam-monir"}, "edited": false, "score": 0, "creation_date": 1473269716, "post_id": 39375473, "comment_id": 66080129, "body": "I made many mistakes to ask this question.It&#39;s 10^6 digits long."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1473277531, "post_id": 39375473, "comment_id": 66083745, "body": "Keep the representation as a string.  You can compare digit characters similarly to numbers."}, {"owner": {"reputation": 153, "user_id": 5610655, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VBn8i.jpg?s=128&g=1", "display_name": "Jahirul Islam Monir", "link": "https://stackoverflow.com/users/5610655/jahirul-islam-monir"}, "edited": false, "score": 0, "creation_date": 1473279937, "post_id": 39375473, "comment_id": 66084840, "body": "Yeah.Got it.. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "edited": false, "score": 0, "creation_date": 1473270350, "post_id": 39376117, "comment_id": 66080407, "body": "Second last reason (4&lt;5) seems to be wrong. Since even if you have 6 in place of 4, you need to append last two digits anyways to make the number 4 digits long."}, {"owner": {"reputation": 153, "user_id": 5610655, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VBn8i.jpg?s=128&g=1", "display_name": "Jahirul Islam Monir", "link": "https://stackoverflow.com/users/5610655/jahirul-islam-monir"}, "edited": false, "score": 0, "creation_date": 1473271204, "post_id": 39376117, "comment_id": 66080827, "body": "Thanks brother.@sudonakeinstall2"}, {"owner": {"reputation": 153, "user_id": 5610655, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VBn8i.jpg?s=128&g=1", "display_name": "Jahirul Islam Monir", "link": "https://stackoverflow.com/users/5610655/jahirul-islam-monir"}, "edited": false, "score": 0, "creation_date": 1473271737, "post_id": 39376117, "comment_id": 66081073, "body": "Awesome explanation.. But my reputation doesn&#39;t allow me to up vote your solution.. It&#39;s my bad luck.. Lots of thanks"}, {"owner": {"reputation": 3882, "user_id": 1040597, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c993933eeeb895833f1938b8c1308964?s=128&d=identicon&r=PG&f=1", "display_name": "Saeid", "link": "https://stackoverflow.com/users/1040597/saeid"}, "reply_to_user": {"reputation": 153, "user_id": 5610655, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VBn8i.jpg?s=128&g=1", "display_name": "Jahirul Islam Monir", "link": "https://stackoverflow.com/users/5610655/jahirul-islam-monir"}, "edited": false, "score": 0, "creation_date": 1473271803, "post_id": 39376117, "comment_id": 66081106, "body": "@JahirulIslamMonir Don&#39;t worry man I just explained another dude&#39;s solution. I don&#39;t deserve rep for this ;)"}, {"owner": {"reputation": 153, "user_id": 5610655, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VBn8i.jpg?s=128&g=1", "display_name": "Jahirul Islam Monir", "link": "https://stackoverflow.com/users/5610655/jahirul-islam-monir"}, "edited": false, "score": 0, "creation_date": 1473271908, "post_id": 39376117, "comment_id": 66081165, "body": "You explained even much better from that solution... Thanks man"}, {"owner": {"reputation": 3882, "user_id": 1040597, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c993933eeeb895833f1938b8c1308964?s=128&d=identicon&r=PG&f=1", "display_name": "Saeid", "link": "https://stackoverflow.com/users/1040597/saeid"}, "edited": false, "score": 0, "creation_date": 1473272312, "post_id": 39376117, "comment_id": 66081346, "body": "look at the example. when we want to push 4 we repeatedly pop 1s from the stack. because they are less than 4"}, {"owner": {"reputation": 153, "user_id": 5610655, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VBn8i.jpg?s=128&g=1", "display_name": "Jahirul Islam Monir", "link": "https://stackoverflow.com/users/5610655/jahirul-islam-monir"}, "edited": false, "score": 0, "creation_date": 1473274518, "post_id": 39376117, "comment_id": 66082309, "body": "Yeah Got it.Thanks"}], "tags": [], "owner": {"reputation": 3882, "user_id": 1040597, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c993933eeeb895833f1938b8c1308964?s=128&d=identicon&r=PG&f=1", "display_name": "Saeid", "link": "https://stackoverflow.com/users/1040597/saeid"}, "is_accepted": true, "score": 1, "last_activity_date": 1473270463, "last_edit_date": 1592644375, "creation_date": 1473269740, "answer_id": 39376117, "question_id": 39375473, "link": "https://stackoverflow.com/questions/39375473/how-to-get-the-maximum-number-after-erasing-n-digits-from-the-number/39376117#39376117", "title": "How to get the maximum number after erasing n digits from the number", "body": "<p>The solution to this question has been beautifully answered <a href=\"https://stackoverflow.com/a/28223817/1040597\">here</a>.\nOnly difference is you have to keep the stack sorted decreasingly.</p>\n<pre><code># process digits from left to right\nfor each digit from left to right\n  if digit &lt;= top of the stack\n    push(digit)\n    continue\n  while (digit &gt; top of the stack) and (we have enough digits to reach n-k digits)\n    pop()\n  push(digit)\npop extra digits\n\n9511145\npush(9) =&gt; 9\npush(5) because 5 &lt;= 9 =&gt; 95\npush(1) because 1 &lt;= 5 =&gt; 951\npush(1) because 1 &lt;= 1 =&gt; 9511\npush(1) because 1 &lt;= 1 =&gt; 95111\npop() because 4 &gt; 1 and we can still end up with 4 digits =&gt; 9511\npop() because 4 &gt; 1 and we can still end up with 4 digits =&gt; 951\npop() because 4 &gt; 1 and we can still end up with 4 digits =&gt; 95\npush(4) because 4 &lt;= 5 =&gt; 954\npush(5) because we need to have 4 digits at least =&gt; 9545\n</code></pre>\n<h1>NOTE: upvote original <a href=\"https://stackoverflow.com/a/28223817/1040597\">answer</a>.</h1>\n"}], "owner": {"reputation": 153, "user_id": 5610655, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VBn8i.jpg?s=128&g=1", "display_name": "Jahirul Islam Monir", "link": "https://stackoverflow.com/users/5610655/jahirul-islam-monir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "closed_date": 1473270435, "accepted_answer_id": 39376117, "answer_count": 1, "score": -5, "last_activity_date": 1610560982, "creation_date": 1473267124, "last_edit_date": 1610560982, "question_id": 39375473, "link": "https://stackoverflow.com/questions/39375473/how-to-get-the-maximum-number-after-erasing-n-digits-from-the-number", "closed_reason": "Needs details or clarity", "title": "How to get the maximum number after erasing n digits from the number", "body": "<p>For example for the number <code>9511145</code> if I want to delete 3 digits from this number the maximum number will be <code>9545</code>. Deleted digits don't have to be contiguous. However, the relative position of the remaining digits should be left unchanged. The number can be 10<sup>6</sup> digits long. To solve this problem in an iterative approach it could take O(N<sup>2</sup>) time. If anyone could suggest any better way to solve this problem then it would be a great help.</p>\n"}, {"tags": ["c++", "multithreading", "sqlite"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473265535, "post_id": 39375012, "comment_id": 66078000, "body": "Does the API you are using to communicate to the DB support asynchronous calls?"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1473265571, "post_id": 39375012, "comment_id": 66078013, "body": "Don&#39;t use thread 1 to insert into the database - use an in-memory queue and insert it from thread 1a.  Re: multi-threading see <a href=\"https://www.sqlite.org/threadsafe.html\" rel=\"nofollow noreferrer\">sqlite.org/threadsafe.html</a>"}, {"owner": {"reputation": 818, "user_id": 19232, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6e7475633864f2aa4392a1a43d48fae3?s=128&d=identicon&r=PG", "display_name": "fistameeny", "link": "https://stackoverflow.com/users/19232/fistameeny"}, "edited": false, "score": 0, "creation_date": 1473323440, "post_id": 39375012, "comment_id": 66099052, "body": "Thanks, I&#39;m exploring the queue option. Seems like that might be the most scalable version for the situation if the volume of data increases"}], "answers": [{"comments": [{"owner": {"reputation": 818, "user_id": 19232, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6e7475633864f2aa4392a1a43d48fae3?s=128&d=identicon&r=PG", "display_name": "fistameeny", "link": "https://stackoverflow.com/users/19232/fistameeny"}, "edited": false, "score": 0, "creation_date": 1473323405, "post_id": 39375232, "comment_id": 66099029, "body": "Thanks. Finding it hard to work out how to check if the DB has been compiled with multi-thread support. If I try to use it with the sqlite3_config(SQLITE_CONFIG_MULTITHREAD); command, we&#39;re getting a memory error. I&#39;m also exploring the queue idea too."}], "tags": [], "owner": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "is_accepted": false, "score": 0, "last_activity_date": 1473266152, "creation_date": 1473266152, "answer_id": 39375232, "question_id": 39375012, "link": "https://stackoverflow.com/questions/39375012/database-access-with-threading/39375232#39375232", "title": "Database access with threading", "body": "<p>SQlite database can be opened with or without multi-threading support. Both threads should open the database  separately. \nIf you want to do the hard way, you can use a priority queue and process the queries.</p>\n"}], "owner": {"reputation": 818, "user_id": 19232, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6e7475633864f2aa4392a1a43d48fae3?s=128&d=identicon&r=PG", "display_name": "fistameeny", "link": "https://stackoverflow.com/users/19232/fistameeny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473266152, "creation_date": 1473265301, "question_id": 39375012, "link": "https://stackoverflow.com/questions/39375012/database-access-with-threading", "title": "Database access with threading", "body": "<p>I'm developing a program (using C++ running on a Linux machine) that uses SQLite as a back-end.  </p>\n\n<p>It has 2 threads which carry out the following tasks:</p>\n\n<ul>\n<li><strong>Thread 1</strong>\n\n<ul>\n<li>Waits for a piece of data to arrive (in this case, via a radio module)</li>\n<li>Immediately inserts it into the database</li>\n<li>Returns to waiting for new data</li>\n<li>It is important this thread is \"listening\" for as much of the time as possible and isn't blocked waiting to insert into the database</li>\n</ul></li>\n<li><strong>Thread 2</strong>\n\n<ul>\n<li>Every 2 minutes, runs a SELECT on the database to find un-processed data</li>\n<li>Processes the data</li>\n<li>UPDATEs the rows fetched with a flag to show they have been processed</li>\n</ul></li>\n</ul>\n\n<p>The key thing is to make sure that Thread 1 can always INSERT into the database, even if this means that Thread 2 is unable to SELECT or UPDATE (as this can just take place at a future point, the timing isn't critical). </p>\n\n<p>I was hoping to find a way to prioritise INSERTs somehow using SQLite, but have failed to find a way so far. Another thought was for Thread 1 to push it's the data into a basic queue (held in memory) and then bulk INSERT it every so often (as this wouldn't be blocking the receiving of data and could do a simple check to see if the database was locked, if so, wait a few milliseconds and try again). </p>\n\n<p>However, what is the \"proper\" way to do this with SQLite and C++ threads?</p>\n"}, {"tags": ["c++", "encryption", "openssl", "aes", "redhat"], "comments": [{"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 1, "creation_date": 1473270980, "post_id": 39374906, "comment_id": 66080726, "body": "Show the code, pls."}, {"owner": {"reputation": 2079, "user_id": 4233342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zBkZL.jpg?s=128&g=1", "display_name": "yahavi", "link": "https://stackoverflow.com/users/4233342/yahavi"}, "reply_to_user": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1473276664, "post_id": 39374906, "comment_id": 66083357, "body": "Hi, there is no code yet. Just a shell command. Please look at my edit. Thanks!"}, {"owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 0, "creation_date": 1473278084, "post_id": 39374906, "comment_id": 66083990, "body": "<i>&quot;i need a tool that i can use with C++.&quot;</i> - You mean you need a library to be used in C++? Well, OpenSSL provides one. Also, if you want the ciphertext be of the same size as the plaintext, then you will have lower security, because now the encryption cannot be semantically secure (it needs to be randomized, and that randomization must be stored somewhere)."}], "answers": [{"comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1473266827, "post_id": 39374983, "comment_id": 66078666, "body": "Padding explains 16-bytes, but not 32-bytes; there are 16-bytes unaccounted for. Maybe he&#39;s using the command line tool and its writing a 16-byte salt/iv? Or maybe its an AuthEnc mode like CCM or GCM, and the additional bytes are a tag."}, {"owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1473277945, "post_id": 39374983, "comment_id": 66083931, "body": "@jww That&#39;s exactly it. It adds an 8 byte <i>header</i> (&quot;Salted__&quot;) and an 8 byte salt for key derivation from the given password."}], "tags": [], "owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "is_accepted": true, "score": 4, "last_activity_date": 1473278184, "last_edit_date": 1473278184, "creation_date": 1473265195, "answer_id": 39374983, "question_id": 39374906, "link": "https://stackoverflow.com/questions/39374906/encrypt-with-aes-without-header/39374983#39374983", "title": "Encrypt with AES without header", "body": "<p><s>No, it did not put a header</s>. It did <a href=\"https://en.wikipedia.org/wiki/Padding_(cryptography)\" rel=\"nofollow\">padding</a>. </p>\n\n<p>The <code>AES</code> is a block cipher with 128 bit block size that requires the length of data being enciphered to be even to the cipher block size. This padding is also used to recover the original data stream length after deciphering.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>According to @jww the openssl lib also prepends the stream with 16byte header containing a magic 8-byte string \"Salted__\" and and an IV, derived from the password</p>\n"}], "owner": {"reputation": 2079, "user_id": 4233342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zBkZL.jpg?s=128&g=1", "display_name": "yahavi", "link": "https://stackoverflow.com/users/4233342/yahavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1312, "favorite_count": 0, "accepted_answer_id": 39374983, "answer_count": 1, "score": 0, "last_activity_date": 1473278184, "creation_date": 1473264956, "last_edit_date": 1473278169, "question_id": 39374906, "link": "https://stackoverflow.com/questions/39374906/encrypt-with-aes-without-header", "title": "Encrypt with AES without header", "body": "<p>I'm trying to encrypt a 16KiB block with AES.</p>\n\n<p>I tried to do it with openssl, but the size grew from 16384 to 16416. Looks like openssl put a 32B header.</p>\n\n<p>Is there any way to \"remove\" the 32B header? If it matters, my environment is Redhat 5.11.</p>\n\n<p>Edit: \nI tried only the command line tools of openssl:\nEncryption:</p>\n\n<pre><code>openssl aes-256-cbc -in text.txt -out encrypted.txt\n</code></pre>\n\n<p>Decryption:</p>\n\n<pre><code>openssl aes-256-cbc -d -in encrypted.txt -out decrypted.txt\n</code></pre>\n\n<p>Also - I need a tool that I can use with C++.</p>\n"}, {"tags": ["c++", "caching", "tree"], "comments": [{"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1473265088, "post_id": 39374887, "comment_id": 66077761, "body": "any chance you can post the complete test program?"}, {"owner": {"reputation": 1789, "user_id": 4038196, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/071217da03754ce35d099a0e889f95c2?s=128&d=identicon&r=PG&f=1", "display_name": "jsguy", "link": "https://stackoverflow.com/users/4038196/jsguy"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1473265653, "post_id": 39374887, "comment_id": 66078069, "body": "unfortunately it&#39;s big because of the tree generation and is part of a larger system. I would need to clean up a lot of unnecessary functions to make it easy to work with. But the experiment file at least is not too big:  <a href=\"http://pastebin.com/HwJYyuhQ\" rel=\"nofollow noreferrer\">pastebin.com/HwJYyuhQ</a>  I was wondering if my understanding regarding cache behavior when it comes to recursions is wrong. Many of my functions are easier to code using recursion. I am using this preorder layout to make sure the code is cache friendly, however I can&#39;t get it to be that even for something simple as summing all the ids in the tree."}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473266670, "post_id": 39374887, "comment_id": 66078573, "body": "the node size is 20 so three nodes roughly occupy a row. the cache size let&#39;s say the cache size is L2 8MB on some i7. You have 5 billion nodes, so the total array size is 12715 times bigger than your L2 cache. Why do you expect a small number of misses?"}, {"owner": {"reputation": 1789, "user_id": 4038196, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/071217da03754ce35d099a0e889f95c2?s=128&d=identicon&r=PG&f=1", "display_name": "jsguy", "link": "https://stackoverflow.com/users/4038196/jsguy"}, "edited": false, "score": 0, "creation_date": 1473266886, "post_id": 39374887, "comment_id": 66078701, "body": "I was mostly wondering about why the behavior is so different in the two functions. The function that recursively iterates over the tree array is so much faster then the function that does the same but uses the children pointers."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1473267571, "post_id": 39374887, "comment_id": 66079064, "body": "Pointers are inherently cache-unfriendly. They usually have poor locality, making cache misses a lot more common. <a href=\"http://netundocumented.com/blog/2005/08/algorithmic-complexity\" rel=\"nofollow noreferrer\">Algorithmic Complexity</a> produces a bit more background information."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1473269556, "post_id": 39374887, "comment_id": 66080056, "body": "If <code>int lpos = TreeArray[cur].lpos;</code> (and <code>rpos</code>) are reordered to the end of function (which is an optimization valid to save registers), then, you access data not in order."}, {"owner": {"reputation": 2007, "user_id": 543913, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/a7d76a4187acf1918902f0a2ab239aba?s=128&d=identicon&r=PG", "display_name": "dshin", "link": "https://stackoverflow.com/users/543913/dshin"}, "edited": false, "score": 3, "creation_date": 1473269934, "post_id": 39374887, "comment_id": 66080219, "body": "&quot;The values of cur will be sequential, I will first access position 0 of TreeArray, then position 1, 2, 3 etc.&quot; - Are you certain of this? A tree with this property would have been oddly constructed. You might want to add a debug print or validate by tracking last_cur in a global variable with an assert() statement."}, {"owner": {"reputation": 1789, "user_id": 4038196, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/071217da03754ce35d099a0e889f95c2?s=128&d=identicon&r=PG&f=1", "display_name": "jsguy", "link": "https://stackoverflow.com/users/4038196/jsguy"}, "edited": false, "score": 0, "creation_date": 1473275124, "post_id": 39374887, "comment_id": 66082612, "body": "In the beginning the tree is generated using pointers and thus all the nodes are scattered around in the main memory. Then we perform a DFS traversal of the original tree and create a copy of it, but now the nodes of the copy tree come from this array, so that when you do a DFS traversal of the copy tree, you will essentially be scanning the array. I will perform more tests tomorrow and will report back, to be honest my head felt dizzy when I posted this question because of all the digging. Thank you for the comments!"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1473277604, "post_id": 39374887, "comment_id": 66083777, "body": "Are you talking about data cache or instruction cache?"}, {"owner": {"reputation": 1789, "user_id": 4038196, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/071217da03754ce35d099a0e889f95c2?s=128&d=identicon&r=PG&f=1", "display_name": "jsguy", "link": "https://stackoverflow.com/users/4038196/jsguy"}, "edited": false, "score": 0, "creation_date": 1473330860, "post_id": 39374887, "comment_id": 66103602, "body": "I added the source of the entire experiment, I am not sure if data cache or instruction cache is the bottleneck here, but seeing that the two functions do not have a lot of instructions I would guess the data cache. I find it hard to understand the difference in the running time of the two experiments, maybe the reason is completely unrelated to cache."}], "answers": [{"comments": [{"owner": {"reputation": 1789, "user_id": 4038196, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/071217da03754ce35d099a0e889f95c2?s=128&d=identicon&r=PG&f=1", "display_name": "jsguy", "link": "https://stackoverflow.com/users/4038196/jsguy"}, "edited": false, "score": 0, "creation_date": 1473356054, "post_id": 39396591, "comment_id": 66119993, "body": "thank you for the answer, everything is so much clearer now. When I run the experiments with the optimization flags disabled, the function calls of <code>testCache4</code> indeed began to be expensive. I definitely need to read more about these low level topics, because when it comes to stress testing seemingly simple functions,  they are the ones that can play the major role. Thanks again!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4407569"}, "is_accepted": true, "score": 3, "last_activity_date": 1473448908, "last_edit_date": 1473448908, "creation_date": 1473354127, "answer_id": 39396591, "question_id": 39374887, "link": "https://stackoverflow.com/questions/39374887/why-does-this-recursive-c-function-have-such-a-bad-cache-behavior/39396591#39396591", "title": "Why does this recursive C++ function have such a bad cache behavior?", "body": "<p>I guess the problem is a misunderstanding of what cache-references actually count.</p>\n\n<p>As explained in <a href=\"https://stackoverflow.com/questions/24093416/linux-perf-command-for-cache-references\">this answer</a> cache-references on Intel CPUs actually are the number of references to the last-level cache. Therefore memory references which were served by the L1 cache are not counted.\nThe <a href=\"https://www-ssl.intel.com/content/www/us/en/architecture-and-technology/64-ia-32-architectures-software-developer-manual-325462.html\" rel=\"nofollow\">Intel 64 and IA-32 Architectures Developer's Manual</a> states that loads from the L1 prefetcher however are counted.</p>\n\n<p>If you actually compare the absolute number of cache-misses, you will see that they are roughly equal for both functions. I used a fully balanced tree for the test, removed <code>pos</code> to get a size of 16 fitting nicely into cache lines and got the following numbers:</p>\n\n<p><code>testCache4</code>:</p>\n\n<pre><code>843.628.131      L1-dcache-loads                                               (56,83%)\n193.006.858      L1-dcache-load-misses     #   22,73% of all L1-dcache hits    (57,31%)\n326.698.621      cache-references                                              (57,07%)\n188.435.203      cache-misses              #   57,679 % of all cache refs      (56,76%)\n</code></pre>\n\n<p><code>testCache1</code>:</p>\n\n<pre><code>3.519.968.253    L1-dcache-loads                                               (57,17%)\n193.664.806      L1-dcache-load-misses     #    5,50% of all L1-dcache hits    (57,24%)\n256.638.490      cache-references                                              (57,12%)\n188.007.927      cache-misses              #   73,258 % of all cache refs      (57,23%)\n</code></pre>\n\n<p>And if I manually disable all hardware prefetchers:</p>\n\n<p><code>testCache4</code>:</p>\n\n<pre><code>846.124.474      L1-dcache-loads                                               (57,22%)\n192.495.450      L1-dcache-load-misses     #   22,75% of all L1-dcache hits    (57,31%)\n193.699.811      cache-references                                              (57,03%)\n185.445.753      cache-misses              #   95,739 % of all cache refs      (57,17%)\n</code></pre>\n\n<p><code>testCache1</code>:</p>\n\n<pre><code>3.534.308.118    L1-dcache-loads                                               (57,16%)\n193.595.962      L1-dcache-load-misses     #    5,48% of all L1-dcache hits    (57,18%)\n193.639.498      cache-references                                              (57,12%)\n185.120.733      cache-misses              #   95,601 % of all cache refs      (57,15%)\n</code></pre>\n\n<p>As you can see the differences are gone now. There simply were additional cache-references events due to the prefetcher and the actual reference being counted twice.</p>\n\n<p>Actually if you count all memory references <code>testCache1</code> has a lower total cache miss ratio, because each <code>tree_node</code> is referenced 4 times instead of ones, but each data member of a <code>tree_node</code> lies on the same cache line and so there is only one out of 4 misses.</p>\n\n<p>For <code>testCache4</code> you can see that the L1d load miss ratio is actually close to 25% which you would expect if <code>sizeof(tree_node) == 16</code> and cache lines are 64 bytes.</p>\n\n<p>Also the compiler (at least gcc with -O2) applies tail recursion optimization to both functions eliminating the recursion of <code>testCache4</code>, while making <code>testCache1</code> one-way recursive. Therefore <code>testCache1</code> has many additional cache references to the stack frames which <code>testCache4</code> does not have.</p>\n\n<p>You can get the result without prefetcher also by using valgrind, which probably is also more reliable in its output. It does not simulate all properties of CPU caches though.</p>\n\n<p>Regarding your edits: As I metioned gcc aplies tail recursion optimization, so there are no calls left in <code>testCache4</code> and of course recursion and additional memory loads in <code>testCache1</code> have significant instruction overhead compared to the simple load/add loop left in <code>testCache4</code>.</p>\n"}], "owner": {"reputation": 1789, "user_id": 4038196, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/071217da03754ce35d099a0e889f95c2?s=128&d=identicon&r=PG&f=1", "display_name": "jsguy", "link": "https://stackoverflow.com/users/4038196/jsguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 0, "accepted_answer_id": 39396591, "answer_count": 1, "score": 6, "last_activity_date": 1473448908, "creation_date": 1473264892, "last_edit_date": 1473349986, "question_id": 39374887, "link": "https://stackoverflow.com/questions/39374887/why-does-this-recursive-c-function-have-such-a-bad-cache-behavior", "title": "Why does this recursive C++ function have such a bad cache behavior?", "body": "<p>Let <code>T</code> be a rooted binary tree such that every internal node has exactly two children. The nodes of the tree will be stored in an array, let us call it <code>TreeArray</code> by following the preorder layout.</p>\n\n<p>So for example if this is the tree that we have:\n<a href=\"https://i.stack.imgur.com/F4Rf7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F4Rf7.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Then <code>TreeArray</code> will contain the following node objects:</p>\n\n<p><code>7, 3, 1, 0, 2, 6, 12, 9, 8, 11, 13</code></p>\n\n<p>A node in this tree is a struct of this kind:</p>\n\n<pre><code>struct tree_node{\n\n    int id; //id of the node, randomly generated\n    int numChildren; //number of children, it is 2 but for the leafs it's 0\n\n    int pos; //position in TreeArray where the node is stored\n    int lpos; //position of the left child\n    int rpos; //position of the right child\n\n    tree_node(){\n            id = -1;\n            pos = lpos = rpos = -1;\n            numChildren = 0;\n       }\n\n};\n</code></pre>\n\n<p>Now suppose that we want a function that returns the sum of all the ids in the tree. Sounds very trivial, all you have to do is use a for loop that iterates over <code>TreeArray</code> and accumulates all the found ids. However, I am interested in understanding the cache behavior of the following implementation:</p>\n\n<pre><code>void testCache1(int cur){\n\n     //find the positions of the left and right children\n     int lpos = TreeArray[cur].lpos;\n     int rpos = TreeArray[cur].rpos;\n\n     //if there are no children we are at a leaf so update r and return\n\n     if(TreeArray[cur].numChildren == 0){\n        r += TreeArray[cur].id;\n        return;\n     }\n\n     //otherwise we are in an internal node, so update r and recurse\n     //first to the left subtree and then to the right subtree\n\n     r += TreeArray[cur].id;\n\n     testCache1(lpos);\n     testCache1(rpos);\n\n}\n</code></pre>\n\n<p>To test the cache behavior I have the following experiment:</p>\n\n<pre><code>r = 0; //r is a global variable\nint main(int argc, char* argv[]){\n\n    for(int i=0;i&lt;100;i++) {\n        r = 0;\n        testCache1(0);\n    }\n\n    cout&lt;&lt;r&lt;&lt;endl;\n    return 0;\n}\n</code></pre>\n\n<p>For a random tree with 5 million leafs, <code>perf stat -B -e cache-misses,cache-references,instructions ./run_tests 111.txt</code> prints the following:</p>\n\n<pre><code> Performance counter stats for './run_tests 111.txt':\n\n   469,511,047      cache-misses              #   89.379 % of all cache refs    \n   525,301,814      cache-references                                            \n20,715,360,185      instructions             \n\n  11.214075268 seconds time elapsed\n</code></pre>\n\n<p>In the beginning I thought maybe it is because of the way I generate the tree, which I exclude including it in my question, but when I run <code>sudo perf record -e cache-misses ./run_tests 111.txt</code> I received the following output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FlH3u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FlH3u.png\" alt=\"enter image description here\"></a></p>\n\n<p>As we can see most of the cache misses come from this function. However I can not understand why this is the case. The values of <code>cur</code> will be sequential, I will first access position <code>0</code> of <code>TreeArray</code>, then position <code>1</code>, <code>2</code>, <code>3</code> etc.</p>\n\n<p>To add more doubt to my understanding of what is happening, I have the following function that finds the same summation:</p>\n\n<pre><code>void testCache4(int index){\n\n     if(index == TreeArray.size) return;\n\n     r += TreeArray[index].id;\n\n     testCache4(index+1);\n\n}\n</code></pre>\n\n<p><code>testCache4</code> accesses the elements of <code>TreeArray</code> in the same way, but the cache behavior is so much better.</p>\n\n<p>output from <code>perf stat -B -e cache-misses,cache-references,instructions ./run_tests 11.txt</code>:</p>\n\n<pre><code> Performance counter stats for './run_tests 111.txt':\n\n   396,941,872      cache-misses              #   54.293 % of all cache refs    \n   731,109,661      cache-references                                            \n11,547,097,924      instructions             \n\n   4.306576556 seconds time elapsed\n</code></pre>\n\n<p>in the output from <code>sudo perf record -e cache-misses ./run_tests 111.txt</code> the function is not even there:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6i9lZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6i9lZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>I apologize for the long post but I feel completely lost. Thank you in advance. </p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Here is the entire test file, together with the parsers and everything that is required. It is assumed that the tree is available inside a text file that is given as an argument. Compile by typing <code>g++ -O3  -std=c++11 file.cpp</code> and run by typing <code>./executable tree.txt</code>. The tree I am using can be found <a href=\"https://bitbucket.org/nick111/tree/raw/e9d898e62de0b6aeb31ab69d0a6d4651bdd2f7a1/111.txt\" rel=\"nofollow noreferrer\">here</a> (don't open, click save us).</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#define BILLION  1000000000LL\n\nusing namespace std;\n\n/*\n *\n * Timing functions\n *\n */\n\ntimespec startT, endT;\n\nvoid startTimer(){\n    clock_gettime(CLOCK_PROCESS_CPUTIME_ID, &amp;startT);\n}\n\ndouble endTimer(){\n    clock_gettime(CLOCK_PROCESS_CPUTIME_ID, &amp;endT);\n    return endT.tv_sec * BILLION + endT.tv_nsec - (startT.tv_sec * BILLION + startT.tv_nsec);\n}\n\n/*\n *\n * tree node\n *\n */\n\n//this struct is used for creating the first tree after reading it from the external file, for this we need left and child pointers\n\nstruct tree_node_temp{\n\n    int id; //id of the node, randomly generated\n    int numChildren; //number of children, it is 2 but for the leafs it's 0\n    int size; //size of the subtree rooted at the current node\n    tree_node_temp *leftChild;\n    tree_node_temp *rightChild;\n\n    tree_node_temp(){\n        id = -1;\n        size = 1;\n        leftChild = nullptr;\n        rightChild = nullptr;\n        numChildren = 0;\n    }\n\n};\n\nstruct tree_node{\n\n    int id; //id of the node, randomly generated\n    int numChildren; //number of children, it is 2 but for the leafs it's 0\n    int size; //size of the subtree rooted at the current node\n\n    int pos; //position in TreeArray where the node is stored\n    int lpos; //position of the left child\n    int rpos; //position of the right child\n\n    tree_node(){\n        id = -1;\n        pos = lpos = rpos = -1;\n        numChildren = 0;\n    }\n\n};\n\n/*\n *\n * Tree parser. The input is a file containing the tree in the newick format.\n *\n */\n\nstring treeNewickStr; //string storing the newick format of a tree that we read from a file\nint treeCurSTRindex; //index to the current position we are in while reading the newick string\nint treeNumLeafs; //number of leafs in current tree\ntree_node ** treeArrayReferences; //stack of references to free node objects\ntree_node *treeArray; //array of node objects\nint treeStackReferencesTop; //the top index to the references stack\nint curpos; //used to find pos,lpos and rpos when creating the pre order layout tree\n\n\n//helper function for readNewick\ntree_node_temp* readNewickHelper() {\n\n    int i;\n    if(treeCurSTRindex == treeNewickStr.size())\n        return nullptr;\n\n    tree_node_temp * leftChild;\n    tree_node_temp * rightChild;\n\n    if(treeNewickStr[treeCurSTRindex] == '('){\n        //create a left child\n        treeCurSTRindex++;\n        leftChild = readNewickHelper();\n    }\n\n    if(treeNewickStr[treeCurSTRindex] == ','){\n        //create a right child\n        treeCurSTRindex++;\n        rightChild = readNewickHelper();\n    }\n\n    if(treeNewickStr[treeCurSTRindex] == ')' || treeNewickStr[treeCurSTRindex] == ';'){\n        treeCurSTRindex++;\n        tree_node_temp * cur = new tree_node_temp();\n        cur-&gt;numChildren = 2;\n        cur-&gt;leftChild = leftChild;\n        cur-&gt;rightChild = rightChild;\n        cur-&gt;size = 1 + leftChild-&gt;size + rightChild-&gt;size;\n        return cur;\n    }\n\n    //we are about to read a label, keep reading until we read a \",\" \")\" or \"(\" (we assume that the newick string has the right format)\n    i = 0;\n    char treeLabel[20]; //buffer used for the label\n    while(treeNewickStr[treeCurSTRindex]!=',' &amp;&amp; treeNewickStr[treeCurSTRindex]!='(' &amp;&amp; treeNewickStr[treeCurSTRindex]!=')'){\n        treeLabel[i] = treeNewickStr[treeCurSTRindex];\n        treeCurSTRindex++;\n        i++;\n    }\n\n    treeLabel[i] = '\\0';\n    tree_node_temp * cur = new tree_node_temp();\n    cur-&gt;numChildren = 0;\n    cur-&gt;id = atoi(treeLabel)-1;\n    treeNumLeafs++;\n\n    return cur;\n}\n\n//create the pre order tree, curRoot in the first call points to the root of the first tree that was given to us by the parser\nvoid treeInit(tree_node_temp * curRoot){\n\n    tree_node * curFinalRoot = treeArrayReferences[curpos];\n\n    curFinalRoot-&gt;pos = curpos;\n\n    if(curRoot-&gt;numChildren == 0) {\n        curFinalRoot-&gt;id = curRoot-&gt;id;\n        return;\n    }\n\n    //add left child\n    tree_node * cnode = treeArrayReferences[treeStackReferencesTop];\n    curFinalRoot-&gt;lpos = curpos + 1;\n    curpos = curpos + 1;\n    treeStackReferencesTop++;\n    cnode-&gt;id = curRoot-&gt;leftChild-&gt;id;\n    treeInit(curRoot-&gt;leftChild);\n\n    //add right child\n    curFinalRoot-&gt;rpos = curpos + 1;\n    curpos = curpos + 1;\n    cnode = treeArrayReferences[treeStackReferencesTop];\n    treeStackReferencesTop++;\n    cnode-&gt;id = curRoot-&gt;rightChild-&gt;id;\n    treeInit(curRoot-&gt;rightChild);\n\n    curFinalRoot-&gt;id = curRoot-&gt;id;\n    curFinalRoot-&gt;numChildren = 2;\n    curFinalRoot-&gt;size = curRoot-&gt;size;\n\n}\n\n//the ids of the leafs are deteremined by the newick file, for the internal nodes we just incrementally give the id determined by the dfs traversal\nvoid updateInternalNodeIDs(int cur){\n\n    tree_node* curNode = treeArrayReferences[cur];\n\n    if(curNode-&gt;numChildren == 0){\n        return;\n    }\n    curNode-&gt;id = treeNumLeafs++;\n    updateInternalNodeIDs(curNode-&gt;lpos);\n    updateInternalNodeIDs(curNode-&gt;rpos);\n\n}\n\n//frees the memory of the first tree generated by the parser\nvoid treeFreeMemory(tree_node_temp* cur){\n\n    if(cur-&gt;numChildren == 0){\n        delete cur;\n        return;\n    }\n    treeFreeMemory(cur-&gt;leftChild);\n    treeFreeMemory(cur-&gt;rightChild);\n\n    delete cur;\n\n}\n\n//reads the tree stored in \"file\" under the newick format and creates it in the main memory. The output (what the function returns) is a pointer to the root of the tree.\n//this tree is scattered anywhere in the memory.\n\ntree_node* readNewick(string&amp; file){\n\n    treeCurSTRindex = -1;\n    treeNewickStr = \"\";\n    treeNumLeafs = 0;\n\n    ifstream treeFin;\n\n    treeFin.open(file, ios_base::in);\n    //read the newick format of the tree and store it in a string\n    treeFin&gt;&gt;treeNewickStr;\n    //initialize index for reading the string\n    treeCurSTRindex = 0;\n    //create the tree in main memory\n    tree_node_temp* root = readNewickHelper();\n\n    //store the tree in an array following the pre order layout\n    treeArray = new tree_node[root-&gt;size];\n    treeArrayReferences = new tree_node*[root-&gt;size];\n    int i;\n    for(i=0;i&lt;root-&gt;size;i++)\n        treeArrayReferences[i] = &amp;treeArray[i];\n    treeStackReferencesTop = 0;\n\n    tree_node* finalRoot = treeArrayReferences[treeStackReferencesTop];\n    curpos = treeStackReferencesTop;\n    treeStackReferencesTop++;\n    finalRoot-&gt;id = root-&gt;id;\n    treeInit(root);\n\n    //update the internal node ids (the leaf ids are defined by the ids stored in the newick string)\n    updateInternalNodeIDs(0);\n    //close the file\n    treeFin.close();\n\n    //free the memory of initial tree\n    treeFreeMemory(root);\n    //return the pre order tree\n    return finalRoot;\n\n}\n\n/*\n * experiments\n *\n */\n\nint r;\ntree_node* T;\n\nvoid testCache1(int cur){\n\n    int lpos = treeArray[cur].lpos;\n    int rpos = treeArray[cur].rpos;\n\n    if(treeArray[cur].numChildren == 0){\n        r += treeArray[cur].id;\n        return;\n    }\n\n    r += treeArray[cur].id;\n\n    testCache1(lpos);\n    testCache1(rpos);\n\n}\n\n\nvoid testCache4(int index){\n\n    if(index == T-&gt;size) return;\n\n    r += treeArray[index].id;\n\n    testCache4(index+1);\n\n}\n\n\nint main(int argc, char* argv[]){\n\n    string Tnewick = argv[1];\n    T = readNewick(Tnewick);\n    double tt;\n\n    startTimer();\n    for(int i=0;i&lt;100;i++) {\n        r = 0;\n        testCache4(0);\n    }\n    tt = endTimer();\n    cout&lt;&lt;r&lt;&lt;endl;\n    cout&lt;&lt;tt/BILLION&lt;&lt;endl;\n\n    startTimer();\n    for(int i=0;i&lt;100;i++) {\n        r = 0;\n        testCache1(0);\n    }\n    tt = endTimer();\n    cout&lt;&lt;r&lt;&lt;endl;\n    cout&lt;&lt;tt/BILLION&lt;&lt;endl;\n\n    delete[] treeArray;\n    delete[] treeArrayReferences;\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>EDIT2:</strong></p>\n\n<p>I run some profiling tests with valgrind. The instructions might actually be the overhead here, but I don't understand why. For example even in the experiments above with perf, one version gives around 20 billion instructions and the other 11 billion.  That's a 9 billion difference.</p>\n\n<p>With <code>-O3</code> enabled I get the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/F6FjU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F6FjU.png\" alt=\"enter image description here\"></a></p>\n\n<p>so the function calls are expensive in <code>testCache1</code> and cost nothing in <code>testCache4</code>? The amount of function calls in both cases should be the same...</p>\n"}, {"tags": ["c++", "allocator"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473264200, "post_id": 39374575, "comment_id": 66077235, "body": "It is not the function but it is <code>allocator</code> that is marked <code>const</code>.  You might want to look at how libc++, libstdc++ implement this in something like <code>std::vector</code>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1473265853, "post_id": 39374575, "comment_id": 66078181, "body": "standard containers usually use this const reference to initialize their own  member (or base class) and than call allocate on this member."}], "answers": [{"comments": [{"owner": {"reputation": 448, "user_id": 4226809, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6198d3604a3c4344579ec2a8220ba0b4?s=128&d=identicon&r=PG&f=1", "display_name": "Ji\u0159&#237; Lechner", "link": "https://stackoverflow.com/users/4226809/ji%c5%99%c3%ad-lechner"}, "edited": false, "score": 0, "creation_date": 1473271457, "post_id": 39375892, "comment_id": 66080946, "body": "Would it be a bad practice to const_cast it away? Although making it a member seems pretty natural and elegant."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 448, "user_id": 4226809, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6198d3604a3c4344579ec2a8220ba0b4?s=128&d=identicon&r=PG&f=1", "display_name": "Ji\u0159&#237; Lechner", "link": "https://stackoverflow.com/users/4226809/ji%c5%99%c3%ad-lechner"}, "edited": false, "score": 0, "creation_date": 1473272114, "post_id": 39375892, "comment_id": 66081266, "body": "@Ji\u0159&#237;Lechner <code>const_cast</code>s are usually a clear sign of some problem. Here, also, as you note, there&#39;s a very natural way to bypass it, so why not?"}, {"owner": {"reputation": 448, "user_id": 4226809, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6198d3604a3c4344579ec2a8220ba0b4?s=128&d=identicon&r=PG&f=1", "display_name": "Ji\u0159&#237; Lechner", "link": "https://stackoverflow.com/users/4226809/ji%c5%99%c3%ad-lechner"}, "edited": false, "score": 0, "creation_date": 1473339883, "post_id": 39375892, "comment_id": 66109515, "body": "One more question. I would like to use unique_ptr. Is it a good idea making a specialisation of an allocator that would return a unique_ptr or is it out of scope of the allocator&#39;s job?"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 448, "user_id": 4226809, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6198d3604a3c4344579ec2a8220ba0b4?s=128&d=identicon&r=PG&f=1", "display_name": "Ji\u0159&#237; Lechner", "link": "https://stackoverflow.com/users/4226809/ji%c5%99%c3%ad-lechner"}, "edited": false, "score": 0, "creation_date": 1473340178, "post_id": 39375892, "comment_id": 66109748, "body": "@Ji\u0159&#237;Lechner Actually, if you use a <code>unique_ptr</code>, you&#39;d probably just want to <a href=\"http://stackoverflow.com/questions/28413035/stdunique-ptrt-and-custom-allocator-deleter\">set your allocator&#39;s <code>deallocate</code> as its deallocator</a>. I would personally avoid this direction. If you&#39;re indeed writing a container, it&#39;s one of the rare cases where it&#39;s probably just simpler to have the destructor explicitly deallocate the memory."}, {"owner": {"reputation": 448, "user_id": 4226809, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6198d3604a3c4344579ec2a8220ba0b4?s=128&d=identicon&r=PG&f=1", "display_name": "Ji\u0159&#237; Lechner", "link": "https://stackoverflow.com/users/4226809/ji%c5%99%c3%ad-lechner"}, "edited": false, "score": 0, "creation_date": 1473341550, "post_id": 39375892, "comment_id": 66110763, "body": "you mean set the unique_ptr&#39;s deleter to allocator&#39;s deallocate()?"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 448, "user_id": 4226809, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6198d3604a3c4344579ec2a8220ba0b4?s=128&d=identicon&r=PG&f=1", "display_name": "Ji\u0159&#237; Lechner", "link": "https://stackoverflow.com/users/4226809/ji%c5%99%c3%ad-lechner"}, "edited": false, "score": 0, "creation_date": 1473341603, "post_id": 39375892, "comment_id": 66110809, "body": "@Ji\u0159&#237;Lechner That&#39;s what I meant, yes."}, {"owner": {"reputation": 448, "user_id": 4226809, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6198d3604a3c4344579ec2a8220ba0b4?s=128&d=identicon&r=PG&f=1", "display_name": "Ji\u0159&#237; Lechner", "link": "https://stackoverflow.com/users/4226809/ji%c5%99%c3%ad-lechner"}, "edited": false, "score": 0, "creation_date": 1473343363, "post_id": 39375892, "comment_id": 66112097, "body": "hm, what I have understood it is allowed to make an allocator that yields a user-defined class as a pointer to the allocated resource.Am I right? Since unique_ptr accepts only real pointers I must implement a deleter that will provide the translation..."}], "tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": true, "score": 1, "last_activity_date": 1473268886, "creation_date": 1473268886, "answer_id": 39375892, "question_id": 39374575, "link": "https://stackoverflow.com/questions/39374575/trivial-allocator-aware-container/39375892#39375892", "title": "trivial allocator aware container?", "body": "<p>Your line</p>\n\n<pre><code>allocator.allocate(n);\n</code></pre>\n\n<p>attempts to call the <code>allocate</code> method of <code>allocator</code>, which is not defined as a <code>const</code> method. If you look, though, the type of <code>allocator</code> is <code>const allocator_type&amp;</code>, that is, a const reference to <code>allocator_type</code>.</p>\n\n<p>How can you use it then? One thing you can usually do with a const object (or reference to one) is to construct a different non-const object from it. This, for example, builds:</p>\n\n<pre><code>allocator_type(allocator).allocate(n);\n</code></pre>\n\n<p>As SergeyA correctly notes in the comments, it is fairly common not to construct a temporary ad-hoc <code>allocator_type</code>, but rather make such a member:</p>\n\n<pre><code>    allocator_type m_alloc; // Should probably be private\n\n    Container( size_type n =0 , const allocator_type&amp; allocator =allocator_type() ) : \n            m_alloc{allocator}{\n        std::cout &lt;&lt; \"ctor\" &lt;&lt; std::endl;\n        m_alloc.allocate(n);\n    };\n</code></pre>\n"}], "owner": {"reputation": 448, "user_id": 4226809, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6198d3604a3c4344579ec2a8220ba0b4?s=128&d=identicon&r=PG&f=1", "display_name": "Ji\u0159&#237; Lechner", "link": "https://stackoverflow.com/users/4226809/ji%c5%99%c3%ad-lechner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 2, "accepted_answer_id": 39375892, "answer_count": 1, "score": 4, "last_activity_date": 1473268886, "creation_date": 1473263979, "question_id": 39374575, "link": "https://stackoverflow.com/questions/39374575/trivial-allocator-aware-container", "title": "trivial allocator aware container?", "body": "<p>I am studying/playing with allocators trying to understand how it works. But I run into problems trying to implement trivial container that accepts an allocator. For now I ended up with this:</p>\n\n<pre><code>template&lt;class T, class Allocator =std::allocator&lt;T&gt;&gt; class Container {\npublic:\n    using allocator_type    = Allocator;\n    using value_type        = T;\n    using pointer           = typename std::allocator_traits&lt;allocator_type&gt;::pointer;\n    using reference         = value_type&amp;;\n    using size_type         = std::size_t;\n\n    Container( size_type n =0 , const allocator_type&amp; allocator =allocator_type() ){\n        std::cout &lt;&lt; \"ctor\" &lt;&lt; std::endl;\n        allocator.allocate(n);\n    };\n};\n\nint main(int argc, const char* argv[]){\n    Container&lt;int&gt; c {5};\n    return 0;\n}\n</code></pre>\n\n<p>It gives me an error <code>member function 'allocate' not viable: 'this' argument has type 'const allocator_type' (aka 'const std::__1::allocator&lt;int&gt;'), but function is not marked const</code></p>\n\n<p>How to fix that error, please? Am I missing something ?\nI intend to use traits later but would like to make it work using the old way first.</p>\n"}, {"tags": ["c++", "qt", "qt-creator"], "comments": [{"owner": {"reputation": 108, "user_id": 6032583, "user_type": "registered", "profile_image": "https://graph.facebook.com/1029550100417258/picture?type=large", "display_name": "Josh Yolles", "link": "https://stackoverflow.com/users/6032583/josh-yolles"}, "edited": false, "score": 0, "creation_date": 1473264173, "post_id": 39374553, "comment_id": 66077219, "body": "So can you build/compile the project without errors?"}, {"owner": {"reputation": 29, "user_id": 6205901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFkQs.png?s=128&g=1", "display_name": "SkwisgaarFC", "link": "https://stackoverflow.com/users/6205901/skwisgaarfc"}, "reply_to_user": {"reputation": 108, "user_id": 6032583, "user_type": "registered", "profile_image": "https://graph.facebook.com/1029550100417258/picture?type=large", "display_name": "Josh Yolles", "link": "https://stackoverflow.com/users/6032583/josh-yolles"}, "edited": false, "score": 0, "creation_date": 1473264272, "post_id": 39374553, "comment_id": 66077287, "body": "It compiles and executes when I run it (Ctrl+R) correctly."}, {"owner": {"reputation": 227, "user_id": 5128743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b9d92714fd136bbc31c59e8091c578?s=128&d=identicon&r=PG&f=1", "display_name": "Bettorun", "link": "https://stackoverflow.com/users/5128743/bettorun"}, "edited": false, "score": 0, "creation_date": 1473264863, "post_id": 39374553, "comment_id": 66077638, "body": "Does it happen on any projects (if needed try Qt&#39;s example projects), or only for one in particular? If its the first, you might want to ask on Qt&#39;s forum"}, {"owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "edited": false, "score": 2, "creation_date": 1473273098, "post_id": 39374553, "comment_id": 66081693, "body": "You are trying to debug a binary compiled in Release mode. Have you tried to compile it in Debug mode?"}, {"owner": {"reputation": 29, "user_id": 6205901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFkQs.png?s=128&g=1", "display_name": "SkwisgaarFC", "link": "https://stackoverflow.com/users/6205901/skwisgaarfc"}, "reply_to_user": {"reputation": 227, "user_id": 5128743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b9d92714fd136bbc31c59e8091c578?s=128&d=identicon&r=PG&f=1", "display_name": "Bettorun", "link": "https://stackoverflow.com/users/5128743/bettorun"}, "edited": false, "score": 0, "creation_date": 1473277436, "post_id": 39374553, "comment_id": 66083713, "body": "@Bettorun I&#39;ve tried example projects, they also fail at debugging."}, {"owner": {"reputation": 29, "user_id": 6205901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFkQs.png?s=128&g=1", "display_name": "SkwisgaarFC", "link": "https://stackoverflow.com/users/6205901/skwisgaarfc"}, "reply_to_user": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "edited": false, "score": 0, "creation_date": 1473277525, "post_id": 39374553, "comment_id": 66083742, "body": "@jpo38 I think I&#39;m using the debug mode, like this:  <a href=\"http://image.prntscr.com/image/94e8fa54ae5344cdb7ecc009b306eebc.png\" rel=\"nofollow noreferrer\">image.prntscr.com/image/94e8fa54ae5344cdb7ecc009b306eebc.png</a>"}, {"owner": {"reputation": 885, "user_id": 1758897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hMoc1.png?s=128&g=1", "display_name": "basslo", "link": "https://stackoverflow.com/users/1758897/basslo"}, "edited": false, "score": 0, "creation_date": 1473279501, "post_id": 39374553, "comment_id": 66084636, "body": "in the menu go to tools-&gt;options-&gt;Debuggers and see if you have any debugger installed."}, {"owner": {"reputation": 29, "user_id": 6205901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFkQs.png?s=128&g=1", "display_name": "SkwisgaarFC", "link": "https://stackoverflow.com/users/6205901/skwisgaarfc"}, "reply_to_user": {"reputation": 885, "user_id": 1758897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hMoc1.png?s=128&g=1", "display_name": "basslo", "link": "https://stackoverflow.com/users/1758897/basslo"}, "edited": false, "score": 0, "creation_date": 1473291731, "post_id": 39374553, "comment_id": 66088872, "body": "@basslo Yes, I have. 1st is GNU gdb 7.10.1 for MinGW 5.3.0 32bit (Default on Qt I guess), 2nd and 3rd (I&#39;ve downloaded and installed them today before asking here to see if I could make it work), they are (Auto-detected) CDB from Windows Kits, one x86 and the other x64. All three appear on Tools-&gt;Options-&gt;Debuggers."}, {"owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "edited": false, "score": 1, "creation_date": 1473314712, "post_id": 39374553, "comment_id": 66094352, "body": "@SkwisgaarFC: If you selected &quot;Debug&quot;, it&#39;s wierd that it tries to execute <code>build-GIFS-Desktop_Qt_5_7_0_MSVC2015_64bit-Release&#47;release&#47;G&zwnj;&#8203;IFS.exe</code> which is apparently Release"}, {"owner": {"reputation": 885, "user_id": 1758897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hMoc1.png?s=128&g=1", "display_name": "basslo", "link": "https://stackoverflow.com/users/1758897/basslo"}, "edited": false, "score": 0, "creation_date": 1473335015, "post_id": 39374553, "comment_id": 66106067, "body": "ok i see what is the problem you are compiling in debug mode but running the release .exe. You should change the .exe in the project configuration choosing the one that is in the Debug directory and it will work."}, {"owner": {"reputation": 29, "user_id": 6205901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFkQs.png?s=128&g=1", "display_name": "SkwisgaarFC", "link": "https://stackoverflow.com/users/6205901/skwisgaarfc"}, "reply_to_user": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "edited": false, "score": 0, "creation_date": 1473346127, "post_id": 39374553, "comment_id": 66114190, "body": "@jpo38 I&#39;m sorry for the misunderstanding, when I select &quot;Debug&quot; it uses the .exe debug path; selecting &quot;Release&quot; it uses the release path."}, {"owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "edited": false, "score": 0, "creation_date": 1473359132, "post_id": 39374553, "comment_id": 66121590, "body": "@SkwisgaarFC: Then update your post. Because it shows you tryin gto debug a release binary..."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6205901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFkQs.png?s=128&g=1", "display_name": "SkwisgaarFC", "link": "https://stackoverflow.com/users/6205901/skwisgaarfc"}, "edited": false, "score": 0, "creation_date": 1473365982, "post_id": 39398596, "comment_id": 66125116, "body": "<a href=\"http://image.prntscr.com/image/dc665ae7e4b24ca08c151ce67a20d9b7.png\" rel=\"nofollow noreferrer\">image.prntscr.com/image/dc665ae7e4b24ca08c151ce67a20d9b7.png</a>   I&#39;ve done exactly what you said, though the same dialog error occurrs. I also select the new .exe added when I followed your instructions."}, {"owner": {"reputation": 885, "user_id": 1758897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hMoc1.png?s=128&g=1", "display_name": "basslo", "link": "https://stackoverflow.com/users/1758897/basslo"}, "reply_to_user": {"reputation": 29, "user_id": 6205901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFkQs.png?s=128&g=1", "display_name": "SkwisgaarFC", "link": "https://stackoverflow.com/users/6205901/skwisgaarfc"}, "edited": false, "score": 0, "creation_date": 1473405291, "post_id": 39398596, "comment_id": 66136893, "body": "can you provide a screenshot of error dialog please."}, {"owner": {"reputation": 29, "user_id": 6205901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFkQs.png?s=128&g=1", "display_name": "SkwisgaarFC", "link": "https://stackoverflow.com/users/6205901/skwisgaarfc"}, "edited": false, "score": 0, "creation_date": 1473431829, "post_id": 39398596, "comment_id": 66152486, "body": "<a href=\"http://image.prntscr.com/image/ca0f10af7afd427b8b834238c3221406.png\" rel=\"nofollow noreferrer\">image.prntscr.com/image/ca0f10af7afd427b8b834238c3221406.png</a>     Maybe there&#39;s something wrong with the .pro file and I have to add something (I&#39;m a Qt beginner). The .pro file can be seen in the image."}, {"owner": {"reputation": 885, "user_id": 1758897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hMoc1.png?s=128&g=1", "display_name": "basslo", "link": "https://stackoverflow.com/users/1758897/basslo"}, "reply_to_user": {"reputation": 29, "user_id": 6205901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFkQs.png?s=128&g=1", "display_name": "SkwisgaarFC", "link": "https://stackoverflow.com/users/6205901/skwisgaarfc"}, "edited": false, "score": 0, "creation_date": 1473452825, "post_id": 39398596, "comment_id": 66163527, "body": "I see nothing wrong with the pro. try to clean the project the run Qmake and try again. If it doesn&#39;t work provide screenshot of the directory containing the .exe and the Kit your are using to build (by going in the menu to Tools-&gt;options select Build &amp; Run in the left menu then select the kit tab and select the Kit you&#39;re using to display the information the one with (default)"}, {"owner": {"reputation": 29, "user_id": 6205901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFkQs.png?s=128&g=1", "display_name": "SkwisgaarFC", "link": "https://stackoverflow.com/users/6205901/skwisgaarfc"}, "edited": false, "score": 0, "creation_date": 1473528763, "post_id": 39398596, "comment_id": 66180978, "body": "Cleaned and ran QMake. Files:   <a href=\"http://image.prntscr.com/image/bd9375598cb846c3a8858a1f50586bbe.png\" rel=\"nofollow noreferrer\">image.prntscr.com/image/bd9375598cb846c3a8858a1f50586bbe.png</a>   Build&amp;Run:   <a href=\"http://image.prntscr.com/image/b38ee64165424285a9a859314751447c.png\" rel=\"nofollow noreferrer\">image.prntscr.com/image/b38ee64165424285a9a859314751447c.png</a>"}], "tags": [], "owner": {"reputation": 885, "user_id": 1758897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hMoc1.png?s=128&g=1", "display_name": "basslo", "link": "https://stackoverflow.com/users/1758897/basslo"}, "is_accepted": false, "score": 0, "last_activity_date": 1473362120, "creation_date": 1473362120, "answer_id": 39398596, "question_id": 39374553, "link": "https://stackoverflow.com/questions/39374553/qt-creator-cant-use-debugger-program-exe-not-in-executable-format-file-form/39398596#39398596", "title": "Qt Creator - Can&#39;t use debugger: program.exe not in executable format: File format not recognized", "body": "<p>you are in debug mode for build, but you are running the release executable you have to configure Qt Creator ->Project->run and the Add->custom Executable then choose the executable inside you debug directory see picture below </p>\n\n<p><a href=\"https://i.stack.imgur.com/x6UUc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x6UUc.png\" alt=\"enter image description here\"></a>  </p>\n"}, {"comments": [{"owner": {"reputation": 885, "user_id": 1758897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hMoc1.png?s=128&g=1", "display_name": "basslo", "link": "https://stackoverflow.com/users/1758897/basslo"}, "edited": false, "score": 0, "creation_date": 1473665257, "post_id": 39435969, "comment_id": 66212394, "body": "ok cool because your configuration was ok. So there was no reason why it wasn&#39;t working."}], "tags": [], "owner": {"reputation": 29, "user_id": 6205901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFkQs.png?s=128&g=1", "display_name": "SkwisgaarFC", "link": "https://stackoverflow.com/users/6205901/skwisgaarfc"}, "is_accepted": false, "score": -1, "last_activity_date": 1473596067, "creation_date": 1473596067, "answer_id": 39435969, "question_id": 39374553, "link": "https://stackoverflow.com/questions/39374553/qt-creator-cant-use-debugger-program-exe-not-in-executable-format-file-form/39435969#39435969", "title": "Qt Creator - Can&#39;t use debugger: program.exe not in executable format: File format not recognized", "body": "<p>I've found the solution. I \"just\" had to reinstall Qt. Not Qt creator, but the framework itself. Now I can use the debugger.</p>\n"}], "owner": {"reputation": 29, "user_id": 6205901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFkQs.png?s=128&g=1", "display_name": "SkwisgaarFC", "link": "https://stackoverflow.com/users/6205901/skwisgaarfc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2241, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1473596067, "creation_date": 1473263907, "last_edit_date": 1473365461, "question_id": 39374553, "link": "https://stackoverflow.com/questions/39374553/qt-creator-cant-use-debugger-program-exe-not-in-executable-format-file-form", "title": "Qt Creator - Can&#39;t use debugger: program.exe not in executable format: File format not recognized", "body": "<p>Using Qt version 5.7.0 for Desktop Windows 10</p>\n\n<p>I can run can't use the debug option (F5), it displays in a dialog:</p>\n\n<pre><code>\"D:/DEV Programas/build-GIFS-Desktop_Qt_5_7_0_MSVC2015_64bit-Debug/debug/GIFS.exe\": not in executable format: File format not recognized\n</code></pre>\n\n<p>I can't use at all the debugger. What can I do?\n<br>Sorry I don't display more information. I don't know much how Qt Creator works and what info you may need to help me.</p>\n"}, {"tags": ["c++", "string"], "comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1473263747, "post_id": 39374463, "comment_id": 66076938, "body": "It&#39;s basically the same as reading it into a <code>char</code> buffer. If you&#39;re sure your buffer is big enough there&#39;s nothing wrong with it."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1473263765, "post_id": 39374463, "comment_id": 66076949, "body": "It really depends on the use case.  If the data is not really a string then you may want to consider a <code>std::vector</code> so you do not &quot;lie&quot; to yourself."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1473263940, "post_id": 39374463, "comment_id": 66077056, "body": "There is no such thing as <i>good practice</i>. There are techniques suitable to achieve a particular goal or not suitable for a specific set of reasons. Stop thinking about best practices, think like an engineer."}, {"owner": {"reputation": 758, "user_id": 1388104, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/600787e614f453f06608954a8897dbaa?s=128&d=identicon&r=PG", "display_name": "Aaron Swan", "link": "https://stackoverflow.com/users/1388104/aaron-swan"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1473264320, "post_id": 39374463, "comment_id": 66077316, "body": "@SergeyA I understand what you mean. By good practice, I meant, in this scenario, are there specific reasons not to do this."}, {"owner": {"reputation": 758, "user_id": 1388104, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/600787e614f453f06608954a8897dbaa?s=128&d=identicon&r=PG", "display_name": "Aaron Swan", "link": "https://stackoverflow.com/users/1388104/aaron-swan"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473264431, "post_id": 39374463, "comment_id": 66077375, "body": "@NathanOliver Thank you. I&#39;ve clarified for the intent of interpreting as a string."}, {"owner": {"reputation": 758, "user_id": 1388104, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/600787e614f453f06608954a8897dbaa?s=128&d=identicon&r=PG", "display_name": "Aaron Swan", "link": "https://stackoverflow.com/users/1388104/aaron-swan"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1473283346, "post_id": 39374463, "comment_id": 66086344, "body": "@GillBates It looks like you&#39;re right in practice. I found the following link that says until c++11, a string wasn&#39;t defined to have contiguous storage, but in practice it does: <a href=\"http://stackoverflow.com/questions/1986966/does-s0-point-to-contiguous-characters-in-a-stdstring\" title=\"does s0 point to contiguous characters in a stdstring\">stackoverflow.com/questions/1986966/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 758, "user_id": 1388104, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/600787e614f453f06608954a8897dbaa?s=128&d=identicon&r=PG", "display_name": "Aaron Swan", "link": "https://stackoverflow.com/users/1388104/aaron-swan"}, "edited": false, "score": 0, "creation_date": 1473280959, "post_id": 39374706, "comment_id": 66085260, "body": "In answer to your prompt, I found the following <a href=\"http://stackoverflow.com/questions/1986966/does-s0-point-to-contiguous-characters-in-a-stdstring\" title=\"does s0 point to contiguous characters in a stdstring\">stackoverflow.com/questions/1986966/&hellip;</a> which partially addresses my question."}], "tags": [], "owner": {"reputation": 13013, "user_id": 475150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rOCEK.png?s=128&g=1", "display_name": "BRPocock", "link": "https://stackoverflow.com/users/475150/brpocock"}, "is_accepted": false, "score": 1, "last_activity_date": 1473264363, "creation_date": 1473264363, "answer_id": 39374706, "question_id": 39374463, "link": "https://stackoverflow.com/questions/39374463/are-there-any-issues-reading-directly-into-an-stdstring/39374706#39374706", "title": "Are there any issues reading directly into an std::string?", "body": "<p>Look at it this way: \u201cWhat's the worst that could happen?\u201d</p>\n\n<p>Are you obtaining a file from the local user? And if they supply a file that's too big, perhaps their machine will thrash, or even kill your program with an out-of-memory error?</p>\n\n<p>Do you expect the user to do that often enough to worry about?</p>\n\n<p>Alternatively:</p>\n\n<p>Are you obtaining the file from a network source or untrusted user? Would giving that user the ability to potentially thrash your system or kill your application constitute a risk?</p>\n"}, {"comments": [{"owner": {"reputation": 758, "user_id": 1388104, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/600787e614f453f06608954a8897dbaa?s=128&d=identicon&r=PG", "display_name": "Aaron Swan", "link": "https://stackoverflow.com/users/1388104/aaron-swan"}, "edited": false, "score": 0, "creation_date": 1473281035, "post_id": 39375291, "comment_id": 66085289, "body": "Thanks. Encoding is not something I considered."}], "tags": [], "owner": {"reputation": 37828, "user_id": 1629821, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/861cfc0de6bf99a544b500eac16229eb?s=128&d=identicon&r=PG", "display_name": "Mr.C64", "link": "https://stackoverflow.com/users/1629821/mr-c64"}, "is_accepted": true, "score": 2, "last_activity_date": 1473266905, "last_edit_date": 1473266905, "creation_date": 1473266404, "answer_id": 39375291, "question_id": 39374463, "link": "https://stackoverflow.com/questions/39374463/are-there-any-issues-reading-directly-into-an-stdstring/39375291#39375291", "title": "Are there any issues reading directly into an std::string?", "body": "<p>First, if it's a text file made by several lines, I find the <code>std::string</code> class not a good choice as a \"container\"; I would prefer just a <code>std::vector&lt;char&gt;</code>, or if you want to do some additional parsing and break the file into its single lines, a <code>std::vector&lt;std::string&gt;</code>.</p>\n\n<p>I'd also pay attention to the <strong>encoding</strong> used by the file: is it UTF-8? Is it some other <code>char</code>-based encoding?</p>\n\n<p>For example, if the file is UTF-16, reading it as a raw sequence of bytes into a <code>std::string</code> would be very misleading (and bug prone).</p>\n\n<p>Moreover, it's important also to pay attention to the <strong>size</strong> of the file. If you have a gigantic text file (e.g. 5GB) and you are building a 32-bit Windows application, your code won't work (as 32-bit processes on Windows are limited to 2GB by default). In such cases, reading the file content in smaller chunks (or using memory-mapped file techniques with smaller <em>\"views\"</em> on the file) may be a better alternative.</p>\n"}], "owner": {"reputation": 758, "user_id": 1388104, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/600787e614f453f06608954a8897dbaa?s=128&d=identicon&r=PG", "display_name": "Aaron Swan", "link": "https://stackoverflow.com/users/1388104/aaron-swan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "closed_date": 1473267413, "accepted_answer_id": 39375291, "answer_count": 2, "score": 1, "last_activity_date": 1473289604, "creation_date": 1473263679, "last_edit_date": 1473289604, "question_id": 39374463, "link": "https://stackoverflow.com/questions/39374463/are-there-any-issues-reading-directly-into-an-stdstring", "closed_reason": "Opinion-based", "title": "Are there any issues reading directly into an std::string?", "body": "<p>I've seen in code a direct read into <code>std::string</code> where the contents are intended to be interpreted as a string as follows:</p>\n\n<pre><code>std::string note;\nnote.resize(n);\nread( &amp;note[0], n );\n</code></pre>\n\n<p>Assume that n is of a fixed size, as in a parsing scenario.</p>\n\n<p>Are there are any issues with reading directly into a string? I have seen a lot of uses of ifstreams, but it seems excessive in this case.</p>\n"}, {"tags": ["c++", "opengl", "geometry", "glut"], "comments": [{"owner": {"reputation": 2438, "user_id": 6517320, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/5AiJr.jpg?s=128&g=1", "display_name": "Ivan Rubinson", "link": "https://stackoverflow.com/users/6517320/ivan-rubinson"}, "edited": false, "score": 0, "creation_date": 1473263741, "post_id": 39374433, "comment_id": 66076930, "body": "That&#39;s probably because your camera is off. Disambiguation: in terms of position."}, {"owner": {"reputation": 729, "user_id": 4296407, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5b6394226433412b0d1ad46bb0318b28?s=128&d=identicon&r=PG&f=1", "display_name": "JMV12", "link": "https://stackoverflow.com/users/4296407/jmv12"}, "reply_to_user": {"reputation": 2438, "user_id": 6517320, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/5AiJr.jpg?s=128&g=1", "display_name": "Ivan Rubinson", "link": "https://stackoverflow.com/users/6517320/ivan-rubinson"}, "edited": false, "score": 0, "creation_date": 1473263793, "post_id": 39374433, "comment_id": 66076963, "body": "Inside this function also have if statements for other shapes such as squares and triangles. All of those draw correctly. This is the only one that is off."}, {"owner": {"reputation": 2438, "user_id": 6517320, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/5AiJr.jpg?s=128&g=1", "display_name": "Ivan Rubinson", "link": "https://stackoverflow.com/users/6517320/ivan-rubinson"}, "edited": false, "score": 0, "creation_date": 1473263949, "post_id": 39374433, "comment_id": 66077064, "body": "I think it&#39;s relevant to include in the question how your projection is made (ortho or perspective? Dimensions? Fov?)"}], "answers": [{"comments": [{"owner": {"reputation": 729, "user_id": 4296407, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5b6394226433412b0d1ad46bb0318b28?s=128&d=identicon&r=PG&f=1", "display_name": "JMV12", "link": "https://stackoverflow.com/users/4296407/jmv12"}, "edited": false, "score": 0, "creation_date": 1473264674, "post_id": 39374602, "comment_id": 66077519, "body": "I tried this and I can&#39;t see the circles. I guess my camera is off but I haven&#39;t made any code to change it from its default."}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "reply_to_user": {"reputation": 729, "user_id": 4296407, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5b6394226433412b0d1ad46bb0318b28?s=128&d=identicon&r=PG&f=1", "display_name": "JMV12", "link": "https://stackoverflow.com/users/4296407/jmv12"}, "edited": false, "score": 0, "creation_date": 1473264846, "post_id": 39374602, "comment_id": 66077620, "body": "You&#39;d have to provide code explaining how the projection matrix is set up, then. Chances are pretty good that the circles are being rendered way beyond the boundaries of the window, because OpenGL coordinate space is <code>[-1, 1]</code> but Screen/window coordinates are <code>[0, window_size)</code>. An Orthogonal Projection matrix set to <code>(0, framebuffer_width, 0, framebuffer_height, -1, 1)</code> would probably fix that."}], "tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": true, "score": 2, "last_activity_date": 1473264043, "creation_date": 1473264043, "answer_id": 39374602, "question_id": 39374433, "link": "https://stackoverflow.com/questions/39374433/opengl-draw-circle-with-mouse-move/39374602#39374602", "title": "OpenGL draw circle with Mouse Move", "body": "<p>This answer assumes that things like your viewport and projection matrices are set up correctly, and that the input to this function is taking into account the fact that \"screen coordinates\" (what the mouse uses) are not the same thing as \"OpenGL Coordinate Space\" (this usually implies reversing the direction of the y-axis for one or the other).</p>\n\n<p>The math you're using for setting your vertex coordinates is wrong. The mouse's <code>x</code> and <code>y</code> coordinates should not be multiplied by the sine/cosine functions.</p>\n\n<p>The correct way to write it is</p>\n\n<pre><code>glVertex2f((size/2) * cos(theta) + x, (size/2) * sin(theta) + y);\n</code></pre>\n\n<p>I would also add that you appear to still be using OpenGL's Immediate Mode rendering, which is Deprecated and will offer extremely poor training for a professional setting. I highly advise you learn Modern OpenGL (3.x+) and reapply those concepts to whatever projects you're already working on. <a href=\"http://www.learnopengl.com/#!Introduction\" rel=\"nofollow\">This is a very good tutorial.</a></p>\n"}], "owner": {"reputation": 729, "user_id": 4296407, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5b6394226433412b0d1ad46bb0318b28?s=128&d=identicon&r=PG&f=1", "display_name": "JMV12", "link": "https://stackoverflow.com/users/4296407/jmv12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2258, "favorite_count": 0, "accepted_answer_id": 39374602, "answer_count": 1, "score": 0, "last_activity_date": 1473264431, "creation_date": 1473263602, "last_edit_date": 1473264431, "question_id": 39374433, "link": "https://stackoverflow.com/questions/39374433/opengl-draw-circle-with-mouse-move", "title": "OpenGL draw circle with Mouse Move", "body": "<p>I am trying to use the function mouseMove(int x, int y) to draw a circle centered at my mouse as I click and drag it across the screen. Circles will be drawn on the moving mouse like a spray paint. So far, this is what I have</p>\n\n<pre><code>void mouseMove(int x, int y) {\n    glBegin(GL_POLYGON);\n        for (int i = 0; i &lt;= 360; i++)\n        {\n            float theta = (2 * 3.14 * i) / 360;\n            glVertex2f((size/2 + x) * cos(theta), (size/2 + y) * sin(theta));\n        }\n    glEnd();\n    glutPostRedisplay();\n}\n</code></pre>\n\n<p>But when using this, it draws very large circles that aren't centered around my mouse. How would I alter this to make the program draw circles centered at my mouse?</p>\n\n<p>To describe the project, I am creating a painting program that changes shapes, colors, sizes, and rotations of the drawing done in mouseMove. For now, the size is an int set to 32. When the user selects the shape using the 'b' key in a keyboard function, he/she can switch the shapes that are drawn around the mouse as the user clicks and drags the mouse around. Like a spray paint. All the other shapes work shaped around the mouse except for the circle shape spray. </p>\n"}, {"tags": ["c++", "c", "macros", "c-preprocessor"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1473263055, "post_id": 39374219, "comment_id": 66076495, "body": "Your macro would not make sense."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1473263122, "post_id": 39374219, "comment_id": 66076546, "body": "Are you using C or C++?  In C++ I would suggest making a template function."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1473263244, "post_id": 39374219, "comment_id": 66076624, "body": "<code>##</code> is used for pasting two tokens into a single token, e.g. <code>MYMACRO(foo, bar)</code> results in the variable <code>foobar</code>. But <code>this-&gt;var++</code> is multiple tokens, so you can&#39;t paste them together like that. It doesn&#39;t work at the text level, so it doesn&#39;t just put things next to each other and reparse it."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 1, "creation_date": 1473265965, "post_id": 39374219, "comment_id": 66078226, "body": "There is no place for macros such as this in c++. You&#39;re 15 years behind."}], "answers": [{"comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 4, "creation_date": 1473263577, "post_id": 39374344, "comment_id": 66076820, "body": "I&#39;m pretty sure you <i>would have preferred to answer that as</i> <code>#define MYMACRO(a, op) ((a)op)</code> instead (but what the OP wants is kind of silly, including the semicolon in the macro)."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473263934, "post_id": 39374344, "comment_id": 66077047, "body": "Technically you&#39;re not doing what the OP asked for. The OP&#39;s example does <i>not</i> introduce parentheses."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473264260, "post_id": 39374344, "comment_id": 66077277, "body": "@EOF True, but parentheses are needed in case <code>a</code> has subexpressions that have lower precedence than the operator."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473266143, "post_id": 39374344, "comment_id": 66078306, "body": "@Barmar Unless the OP <i>wants</i> <code>MYMACRO(*ptr, ++)</code> to modify the pointer rather than the pointed-to object. In the absence of anything the OP has said about this, you should <i>probably</i> not introduce bugs for them."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1473266315, "post_id": 39374344, "comment_id": 66078396, "body": "If the parentheses are unwanted, a space would work too: <code>#define MYMACRO(a, op) a op</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473282291, "post_id": 39374344, "comment_id": 66085871, "body": "@EOF Without specific information to the contrary, I assume that people want function-like macros to be parsed similar to functions, where the comma has the lowest precedence. Failing to add parentheses is usually the <i>cause</i> of unexpected behavior."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473282429, "post_id": 39374344, "comment_id": 66085940, "body": "@EOF <a href=\"http://stackoverflow.com/questions/36862207/bad-parentheses-in-macro-definition?s=1|1.8332\" title=\"bad parentheses in macro definition\">stackoverflow.com/questions/36862207/&hellip;</a>"}, {"owner": {"reputation": 27, "user_id": 6805507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226a5e70421d2fcb4ddabeb5ff664e90?s=128&d=identicon&r=PG&f=1", "display_name": "Georgios Chatzigiannis", "link": "https://stackoverflow.com/users/6805507/georgios-chatzigiannis"}, "edited": false, "score": 0, "creation_date": 1473404384, "post_id": 39374344, "comment_id": 66136423, "body": "thanks @Barmar. Thats what i was looking for. Although i had already somehow found a way around it to do what i needed"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1473437572, "post_id": 39374344, "comment_id": 66156122, "body": "I wonder why you accepted the other answer instead of mine. The code is the same, but I added more explanation of the problem with your code."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 6, "last_activity_date": 1473263345, "creation_date": 1473263345, "answer_id": 39374344, "question_id": 39374219, "link": "https://stackoverflow.com/questions/39374219/c-c-how-to-create-a-macro-that-accepts-the-increment-operator/39374344#39374344", "title": "(C/C++) how to create a macro that accepts the increment operator", "body": "<p>You don't need the <code>##</code> token pasting operator, because you're not trying to combine the parameters into a single token. Just use:</p>\n\n<pre><code>#define MYMACRO(a, op) (a)op;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "is_accepted": true, "score": 0, "last_activity_date": 1473263557, "creation_date": 1473263557, "answer_id": 39374415, "question_id": 39374219, "link": "https://stackoverflow.com/questions/39374219/c-c-how-to-create-a-macro-that-accepts-the-increment-operator/39374415#39374415", "title": "(C/C++) how to create a macro that accepts the increment operator", "body": "<p>You just need to combine the tokens like this:</p>\n\n<pre><code>#define MYMACRO(a, incrdecr) (a)incrdecr\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6805507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226a5e70421d2fcb4ddabeb5ff664e90?s=128&d=identicon&r=PG&f=1", "display_name": "Georgios Chatzigiannis", "link": "https://stackoverflow.com/users/6805507/georgios-chatzigiannis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 505, "favorite_count": 0, "accepted_answer_id": 39374415, "answer_count": 2, "score": -2, "last_activity_date": 1473264511, "creation_date": 1473262972, "last_edit_date": 1473264511, "question_id": 39374219, "link": "https://stackoverflow.com/questions/39374219/c-c-how-to-create-a-macro-that-accepts-the-increment-operator", "title": "(C/C++) how to create a macro that accepts the increment operator", "body": "<p>to make my question precise i would like to create a macro that accepts as variable ++ and pastes it with another variable. In code:</p>\n\n<pre><code>#define MYMACRO(A, OP) /* .... */\n</code></pre>\n\n<p>and then if i write in the source file</p>\n\n<pre><code>MYMACRO(this-&gt;var, ++)\n</code></pre>\n\n<p>the preprocessor should paste in the code</p>\n\n<pre><code>this-&gt;var++;\n</code></pre>\n\n<p>When i am trying to define the macro as A##OP , it provides the following error:</p>\n\n<blockquote>\n  <p>pasting \"++\" and \"var\" does not give a valid preprocessing token</p>\n</blockquote>\n\n<p>Is it possible to do what i am trying?</p>\n\n<p>thanks in advance for the answer</p>\n"}, {"tags": ["c++", "google-nativeclient", "ppapi"], "comments": [{"owner": {"reputation": 1006, "user_id": 6311801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iuBbo.jpg?s=128&g=1", "display_name": "xec86", "link": "https://stackoverflow.com/users/6311801/xec86"}, "edited": false, "score": 0, "creation_date": 1473263714, "post_id": 39374003, "comment_id": 66076912, "body": "You need the header file that defines the vardictionary class which is var_dictionary.h and is called with a #include var_dictionary.h according to <a href=\"https://developer.chrome.com/native-client/pepper_dev/cpp/classpp_1_1_var_dictionary\" rel=\"nofollow noreferrer\">developer.chrome.com/native-client/pepper_dev/cpp/&hellip;</a>"}, {"owner": {"reputation": 488, "user_id": 4418333, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/5b73935bb834bf63d997ad6c3e1d6207?s=128&d=identicon&r=PG&f=1", "display_name": "TalG", "link": "https://stackoverflow.com/users/4418333/talg"}, "reply_to_user": {"reputation": 1006, "user_id": 6311801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iuBbo.jpg?s=128&g=1", "display_name": "xec86", "link": "https://stackoverflow.com/users/6311801/xec86"}, "edited": false, "score": 0, "creation_date": 1473263787, "post_id": 39374003, "comment_id": 66076959, "body": "@xec86 do you know where I can get one?"}, {"owner": {"reputation": 488, "user_id": 4418333, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/5b73935bb834bf63d997ad6c3e1d6207?s=128&d=identicon&r=PG&f=1", "display_name": "TalG", "link": "https://stackoverflow.com/users/4418333/talg"}, "reply_to_user": {"reputation": 1006, "user_id": 6311801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iuBbo.jpg?s=128&g=1", "display_name": "xec86", "link": "https://stackoverflow.com/users/6311801/xec86"}, "edited": false, "score": 0, "creation_date": 1473264030, "post_id": 39374003, "comment_id": 66077137, "body": "@xec86 found it <code>#include &quot;ppapi&#47;cpp&#47;var_dictionary.h&quot;</code>. Thanks for the tip!!!"}, {"owner": {"reputation": 1006, "user_id": 6311801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iuBbo.jpg?s=128&g=1", "display_name": "xec86", "link": "https://stackoverflow.com/users/6311801/xec86"}, "edited": false, "score": 1, "creation_date": 1473264193, "post_id": 39374003, "comment_id": 66077232, "body": "no problem.  The source is available from <a href=\"https://www.samsungdforum.com/pepper_37/cpp/var__dictionary_8h_source.html\" rel=\"nofollow noreferrer\">samsungdforum.com/pepper_37/cpp/var__dictionary_8h_source.ht&zwnj;&#8203;ml</a> if you ever need that"}], "answers": [{"comments": [{"owner": {"reputation": 1006, "user_id": 6311801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iuBbo.jpg?s=128&g=1", "display_name": "xec86", "link": "https://stackoverflow.com/users/6311801/xec86"}, "reply_to_user": {"reputation": 488, "user_id": 4418333, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/5b73935bb834bf63d997ad6c3e1d6207?s=128&d=identicon&r=PG&f=1", "display_name": "TalG", "link": "https://stackoverflow.com/users/4418333/talg"}, "edited": false, "score": 0, "creation_date": 1473453208, "post_id": 39374689, "comment_id": 66163716, "body": "not familiar with it. Sorry.  Just a C++ intermediate."}], "tags": [], "owner": {"reputation": 1006, "user_id": 6311801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iuBbo.jpg?s=128&g=1", "display_name": "xec86", "link": "https://stackoverflow.com/users/6311801/xec86"}, "is_accepted": true, "score": 1, "last_activity_date": 1473264307, "creation_date": 1473264307, "answer_id": 39374689, "question_id": 39374003, "link": "https://stackoverflow.com/questions/39374003/no-type-named-vardictionary-in-namespace-pp-using-pnacl/39374689#39374689", "title": "No type named &#39;VarDictionary&#39; in namespace &#39;pp&#39; using PNaCl", "body": "<p>You need to add the header file for var_dictionary.h that is where the class you are trying to access is declared.</p>\n\n<p>Source code for that header is available <a href=\"https://www.samsungdforum.com/pepper_37/cpp/var__dictionary_8h_source.html\" rel=\"nofollow\">here</a></p>\n"}], "owner": {"reputation": 488, "user_id": 4418333, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/5b73935bb834bf63d997ad6c3e1d6207?s=128&d=identicon&r=PG&f=1", "display_name": "TalG", "link": "https://stackoverflow.com/users/4418333/talg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 39374689, "answer_count": 1, "score": 1, "last_activity_date": 1473264307, "creation_date": 1473262265, "last_edit_date": 1473263070, "question_id": 39374003, "link": "https://stackoverflow.com/questions/39374003/no-type-named-vardictionary-in-namespace-pp-using-pnacl", "title": "No type named &#39;VarDictionary&#39; in namespace &#39;pp&#39; using PNaCl", "body": "<p>Can someone explain me why am I getting the compile error</p>\n\n<pre><code>error: no type named 'VarDictionary' in namespace 'pp'\n        pp::VarDictionary dictionary;\n        ~~~~^\n</code></pre>\n\n<p>I'm tying to set a dictionary in the function</p>\n\n<pre><code>virtual void HandleMessage(const pp::Var&amp; message) {\n}\n</code></pre>\n\n<p>I copied the example from the bottom of this Google page <a href=\"https://developer.chrome.com/native-client/devguide/coding/message-system\" rel=\"nofollow\">https://developer.chrome.com/native-client/devguide/coding/message-system</a></p>\n\n<p>and tried something simple like this</p>\n\n<pre><code>virtual void HandleMessage(const pp::Var&amp; message) {\n    pp::VarDictionary dictionary;\n    pp::VarArray an_array;\n    an_array.Set(0, pp::Var(\"string0\"));\n    an_array.Set(1, pp::Var(\"string1\"));\n    dictionary.Set(pp::Var(\"param_array\"), an_array);\n    PostMessage(dictionary);    \n}\n</code></pre>\n\n<p>but when I compile the code i get the error message for the <code>pp::VarDictionary dictionary;</code> however no problem with the <code>pp::VarArray an_array;</code></p>\n\n<p>I'm using this Makefile from Google</p>\n\n<pre><code># Copyright (c) 2013 The Native Client Authors. All rights reserved.\n# Use of this source code is governed by a BSD-style license that can be\n# found in the LICENSE file.\n\n#\n# GNU Make based build file. \u00a0For details on GNU Make see:\n# http://www.gnu.org/software/make/manual/make.html\n#\n\n#\n# Get pepper directory for toolchain and includes.\n#\n# If NACL_SDK_ROOT is not set, then assume it can be found three directories up.\n#\nTHIS_MAKEFILE := $(abspath $(lastword $(MAKEFILE_LIST)))\nNACL_SDK_ROOT ?= $(abspath $(dir $(THIS_MAKEFILE))../..)\n\n# Project Build flags\nWARNINGS := -Wno-long-long -Wall -Wswitch-enum -pedantic -Werror\nCXXFLAGS := -pthread -std=gnu++98 $(WARNINGS)\n\n#\n# Compute tool paths\n#\nGETOS := python $(NACL_SDK_ROOT)/tools/getos.py\nOSHELPERS = python $(NACL_SDK_ROOT)/tools/oshelpers.py\nOSNAME := $(shell $(GETOS))\nRM := $(OSHELPERS) rm\n\nPNACL_TC_PATH := $(abspath $(NACL_SDK_ROOT)/toolchain/$(OSNAME)_pnacl)\nPNACL_CXX := $(PNACL_TC_PATH)/bin/pnacl-clang++\nPNACL_FINALIZE := $(PNACL_TC_PATH)/bin/pnacl-finalize\nCXXFLAGS := -I$(NACL_SDK_ROOT)/include\nLDFLAGS := -L$(NACL_SDK_ROOT)/lib/pnacl/Release -lppapi_cpp -lppapi -ljsoncpp\n\n#\n# Disable DOS PATH warning when using Cygwin based tools Windows\n#\nCYGWIN ?= nodosfilewarning\nexport CYGWIN\n\n\n# Declare the ALL target first, to make the 'all' target the default build\nall: job1.pexe\n\nclean:\n    $(RM) job1.pexe job1.bc\n\njob1.bc: job1.cc\n    $(PNACL_CXX) -o $@ $&lt; -O2 $(CXXFLAGS) $(LDFLAGS)\n\njob1.pexe: job1.bc\n    $(PNACL_FINALIZE) -o $@ $&lt;\n\n\n#\n# Makefile target to run the SDK's simple HTTP server and serve this example.\n#\nHTTPD_PY := python $(NACL_SDK_ROOT)/tools/httpd.py\n\n.PHONY: serve\nserve: all\n    $(HTTPD_PY) -C $(CURDIR)\n</code></pre>\n"}, {"tags": ["c++", "c++11", "makefile"], "comments": [{"owner": {"reputation": 1475, "user_id": 2201317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1pP5.jpg?s=128&g=1", "display_name": "Francesca Nannizzi", "link": "https://stackoverflow.com/users/2201317/francesca-nannizzi"}, "edited": false, "score": 1, "creation_date": 1473263056, "post_id": 39373916, "comment_id": 66076496, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/16886591/how-do-i-enable-c11-in-gcc\">How do I enable C++11 in gcc?</a>"}, {"owner": {"reputation": 4802, "user_id": 3852968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e803f34d50b5355d8cf39bdb4ce2932?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/3852968/andrew"}, "edited": false, "score": 1, "creation_date": 1473263101, "post_id": 39373916, "comment_id": 66076530, "body": "Use <code>CXX</code> and <code>CXXFLAGS</code>. Delete your rule for <code>%.o: %.c</code>, which doesn&#39;t apply to <code>.cpp</code> files anyway, and try again. Make has predefined (&quot;implicit&quot;, in Make terminology) rules for building <code>.o</code> targets from <code>.cpp</code> files which use the <code>CXX</code> and <code>CXXFLAGS</code> variables."}], "answers": [{"tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": true, "score": 5, "last_activity_date": 1473263152, "creation_date": 1473263152, "answer_id": 39374275, "question_id": 39373916, "link": "https://stackoverflow.com/questions/39373916/cflags-not-recognised-in-makefile/39374275#39374275", "title": "CFLAGS not recognised in makefile", "body": "<p>Your rule is </p>\n\n<pre><code>%.o: %.c $(DEPS)\n</code></pre>\n\n<p>but you are compiling a <code>.cpp</code> file.</p>\n\n<p>The implicit <code>make</code> rule for <code>.cpp</code> source files will be used.</p>\n\n<p>Either change your rule to </p>\n\n<pre><code>%.o: %.cpp $(DEPS)\n</code></pre>\n\n<p>Or set the <code>CXXFLAGS</code> variable used in the implicit rule.</p>\n"}], "owner": {"reputation": 13, "user_id": 3993655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1afaa9d9d0c8aab37cfc2ff5b2cdfec4?s=128&d=identicon&r=PG&f=1", "display_name": "Iramch", "link": "https://stackoverflow.com/users/3993655/iramch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "accepted_answer_id": 39374275, "answer_count": 1, "score": 1, "last_activity_date": 1473263152, "creation_date": 1473262002, "question_id": 39373916, "link": "https://stackoverflow.com/questions/39373916/cflags-not-recognised-in-makefile", "title": "CFLAGS not recognised in makefile", "body": "<p>I'm complicating a small school assignment which uses lambda functions, so it needs the '-std=c++11' in the gcc call. However the output of the make file seems to show that it is not being added. I'm not having linking problems so there is no need to copy all the source here. </p>\n\n<p>Here is my makefile:</p>\n\n<pre><code>CC=g++\nCFLAGS= -std=c++11 -I. -Wall\nDEPS = wordarray.h\nOBJ = ayalajL03b.o wordarray.o\n\n%.o: %.c $(DEPS)\n        $(CC) -c -o $@ $&lt; $(CFLAGS)\n\nL03b.out: $(OBJ)\n        $(CC) -o $@ $^ $(CFLAGS)\n\n.PHONY: clean\n\nclean:\n        rm -f -v *.o\n        rm -f -v *.out\n</code></pre>\n\n<p>Here is the output:</p>\n\n<pre><code>[user@server Lab03]$ make\ng++    -c -o wordarray.o wordarray.cpp\nwordarray.cpp:28:77: warning: lambda expressions only available with -std=c++11 or =gnu++11\n    counter([](char a)-&gt;bool{return !isvowel(a) &amp;&amp; !isdigit(a) &amp;&amp; isalpha(a);}, Worount].word);\n</code></pre>\n\n<p>Please help me understand what I'm doing wrong.</p>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 2, "creation_date": 1473262350, "post_id": 39373898, "comment_id": 66076025, "body": "A better solution would be to discard comments as they are read in, rather than to read in the entire file at once and then attempt to discard. Each erasure will result in the vector shifting elements. It does not sounds very efficient."}, {"owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "edited": false, "score": 0, "creation_date": 1473262358, "post_id": 39373898, "comment_id": 66076032, "body": "Your code is farther from working than you think. Re-think the algorithm. What does copying the stream contents to <code>std::vector</code> give you? You can do this in one iteration through the stream and a <code>bool</code> variable indicating whether you&#39;re reading inside a comment or not."}], "answers": [{"comments": [{"owner": {"reputation": 593, "user_id": 6534541, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/561c59a13a698b9777eb0b88d2e29158?s=128&d=identicon&r=PG&f=1", "display_name": "I&#39;m here for Winter Hats", "link": "https://stackoverflow.com/users/6534541/im-here-for-winter-hats"}, "edited": false, "score": 0, "creation_date": 1473263679, "post_id": 39374232, "comment_id": 66076887, "body": "I understand the code and see where I went wrong but the issue is the fstream and the infile isn&#39;t compatible with the class string."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 593, "user_id": 6534541, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/561c59a13a698b9777eb0b88d2e29158?s=128&d=identicon&r=PG&f=1", "display_name": "I&#39;m here for Winter Hats", "link": "https://stackoverflow.com/users/6534541/im-here-for-winter-hats"}, "edited": false, "score": 0, "creation_date": 1473263807, "post_id": 39374232, "comment_id": 66076976, "body": "@user5468794 What do you mean? Besides, the code didn&#39;t go through a compiler, I&#39;ll check it as soon as I have access to my computer"}, {"owner": {"reputation": 2667, "user_id": 572332, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ede4acd1b1775241fa41834dd1406fef?s=128&d=identicon&r=PG&f=1", "display_name": "robor", "link": "https://stackoverflow.com/users/572332/robor"}, "reply_to_user": {"reputation": 593, "user_id": 6534541, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/561c59a13a698b9777eb0b88d2e29158?s=128&d=identicon&r=PG&f=1", "display_name": "I&#39;m here for Winter Hats", "link": "https://stackoverflow.com/users/6534541/im-here-for-winter-hats"}, "edited": false, "score": 0, "creation_date": 1473263831, "post_id": 39374232, "comment_id": 66076991, "body": "@user5468794 What do you mean not compatible? Add &quot;std::ifstream infile(&quot;thefile.txt&quot;);&quot; before the while loop."}, {"owner": {"reputation": 593, "user_id": 6534541, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/561c59a13a698b9777eb0b88d2e29158?s=128&d=identicon&r=PG&f=1", "display_name": "I&#39;m here for Winter Hats", "link": "https://stackoverflow.com/users/6534541/im-here-for-winter-hats"}, "edited": false, "score": 0, "creation_date": 1473263934, "post_id": 39374232, "comment_id": 66077048, "body": "The way I&#39;m getting the file through the fstream and istream_iterator, the getline is having issues with the line, infile you posted above. And no worries."}, {"owner": {"reputation": 2667, "user_id": 572332, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ede4acd1b1775241fa41834dd1406fef?s=128&d=identicon&r=PG&f=1", "display_name": "robor", "link": "https://stackoverflow.com/users/572332/robor"}, "edited": false, "score": 0, "creation_date": 1473263963, "post_id": 39374232, "comment_id": 66077076, "body": "Before adding the line to the fileContent do a check to see if the string is empty &quot;  if(line.find_first_not_of(&#39; &#39;) != std::string::npos) {... push_back...}&quot;"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 593, "user_id": 6534541, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/561c59a13a698b9777eb0b88d2e29158?s=128&d=identicon&r=PG&f=1", "display_name": "I&#39;m here for Winter Hats", "link": "https://stackoverflow.com/users/6534541/im-here-for-winter-hats"}, "edited": false, "score": 0, "creation_date": 1473264578, "post_id": 39374232, "comment_id": 66077465, "body": "@user5468794 Found the error: I switched the parameters of <code>std::getline</code> around :)"}, {"owner": {"reputation": 593, "user_id": 6534541, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/561c59a13a698b9777eb0b88d2e29158?s=128&d=identicon&r=PG&f=1", "display_name": "I&#39;m here for Winter Hats", "link": "https://stackoverflow.com/users/6534541/im-here-for-winter-hats"}, "edited": false, "score": 0, "creation_date": 1473265327, "post_id": 39374232, "comment_id": 66077891, "body": "Ok I have no idea what I&#39;m doing wrong. One time it removed all the numbers and the other time it had everything for the output."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 593, "user_id": 6534541, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/561c59a13a698b9777eb0b88d2e29158?s=128&d=identicon&r=PG&f=1", "display_name": "I&#39;m here for Winter Hats", "link": "https://stackoverflow.com/users/6534541/im-here-for-winter-hats"}, "edited": false, "score": 0, "creation_date": 1473265540, "post_id": 39374232, "comment_id": 66078004, "body": "@user5468794 You should debug in this case"}], "tags": [], "owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "is_accepted": false, "score": 2, "last_activity_date": 1473264589, "last_edit_date": 1473264589, "creation_date": 1473263003, "answer_id": 39374232, "question_id": 39373898, "link": "https://stackoverflow.com/questions/39373898/remove-comments-from-file-and-keep-integers/39374232#39374232", "title": "Remove comments from file and keep integers", "body": "<p>Well, the logic is wrong, as you noticed.\nYou remove characters from the beginning if the current character is not a digit nor a <code>)</code>.</p>\n\n<p>What you probably want to do is remove the comments, so why not search for the start <code>(*</code> and end <code>*)</code> and remove everything in between?</p>\n\n<pre><code>std::vector&lt;std::string&gt; fileContent;\nstd::string line;\nwhile (std::getline(infile, line))\n{\n    //Find starting character sequence\n    auto begin = line.find(\"(*\");\n    if (begin != std::string::npos)\n    {\n        //Find matching ending sequence, it's not a comment otherwise\n        auto end = line.find(\"*)\", begin);\n        if (end != std::string::npos)\n            line.erase(line.begin() + begin, line.begin() + end + 2);\n    }\n\n    fileContent.push_back(line);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 2, "creation_date": 1473267925, "post_id": 39375542, "comment_id": 66079249, "body": "Very nice. Just not sure why the regex object is <i>in</i> the loop, though - it&#39;s possible it might be more efficient to place it before, and construct it once."}, {"owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "reply_to_user": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 0, "creation_date": 1473268504, "post_id": 39375542, "comment_id": 66079531, "body": "Ah true. my bad. Thank you ;)"}], "tags": [], "owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "is_accepted": true, "score": 4, "last_activity_date": 1473270982, "last_edit_date": 1473270982, "creation_date": 1473267348, "answer_id": 39375542, "question_id": 39373898, "link": "https://stackoverflow.com/questions/39373898/remove-comments-from-file-and-keep-integers/39375542#39375542", "title": "Remove comments from file and keep integers", "body": "<p>I would first save everything as a string, prepare the string and <em>then</em> safely push_back the result into a vector.\nNow I used std::regex to filter your file. It's not the easiest, though.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;regex&gt;\n#include &lt;fstream&gt;\n\nint main(){\n\n    std::string file_name;\n    std::cout &lt;&lt; \"Enter name/path of the txt file: \";\n    std::getline(std::cin, file_name);\n    std::ifstream file(file_name);\n\n    std::vector&lt;int&gt; vec; //here save integers\n\n    std::string text; //save current line here\n\n\n    std::smatch match; //here the found \"comment\" get's saved, later to be removed from text\n\n    std::regex remove(\"[\\(\\*]\\.*[\\*\\)] *\"); //the expression to search for\n    //translation\n    //     _[\\(\\*]   -&gt; (*\n    //     _\\.*      -&gt; any number of characters\n    //     _[\\*\\)]   -&gt; *)\n    //     _ *       -&gt; any number of whitespaces (important to cast to integer)..\n\n\n\n    while (std::getline(file, text)){ //loop through all lines in file.txt\n\n        if (std::regex_search(text, match, remove)){ //if a comment was found\n            text.erase(text.begin(), text.begin() + match[0].length()); //remove the comment\n        }\n\n        if (!text.empty()) { //empty, line was a pure comment\n            vec.push_back(std::stoi(text)); //else add integer to list\n        }\n    }\n\n\n    std::cout &lt;&lt; \"The file contains:\" &lt;&lt; std::endl;\n    for (int i = 0; i &lt; vec.size(); i++){\n        std::cout &lt;&lt; vec.at(i) &lt;&lt; std::endl;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>ouput:</p>\n\n<pre><code>Enter name/path of the txt file: file.txt\nThe file contains:\n58\n63\n70\n56\n</code></pre>\n\n<p>of course, using <code>std::stoi</code> works only if there are no characters <em>after</em> the integer. Well, this is just an idea and of course highly modifiable.</p>\n"}, {"tags": [], "owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "is_accepted": false, "score": 0, "last_activity_date": 1473603286, "creation_date": 1473603286, "answer_id": 39436980, "question_id": 39373898, "link": "https://stackoverflow.com/questions/39373898/remove-comments-from-file-and-keep-integers/39436980#39436980", "title": "Remove comments from file and keep integers", "body": "<p>You could use <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/getline\" rel=\"nofollow\">std::getline</a> to read past the closing <code>')'</code> character then you know the next read will be your number:</p>\n\n<pre><code>int main()\n{\n    std::ifstream ifs(\"test.txt\");\n\n    std::string line;\n    while(std::getline(ifs, line)) // line by line\n    {\n        std::string skip;\n        int value;\n\n        // skip data upto and past ')', then read number\n        if(std::getline(std::istringstream(line), skip, ')') &gt;&gt; value)\n            std::cout &lt;&lt; \"found: \" &lt;&lt; value &lt;&lt; '\\n';\n    }\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>found: 58\nfound: 63\nfound: 70\nfound: 56\n</code></pre>\n"}], "owner": {"reputation": 593, "user_id": 6534541, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/561c59a13a698b9777eb0b88d2e29158?s=128&d=identicon&r=PG&f=1", "display_name": "I&#39;m here for Winter Hats", "link": "https://stackoverflow.com/users/6534541/im-here-for-winter-hats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 39375542, "answer_count": 3, "score": 4, "last_activity_date": 1473603286, "creation_date": 1473261952, "question_id": 39373898, "link": "https://stackoverflow.com/questions/39373898/remove-comments-from-file-and-keep-integers", "title": "Remove comments from file and keep integers", "body": "<p>I am trying to remove comments from my .txt file. My text file looks like this:</p>\n\n<pre><code>(* Sunspot data collected by Robin McQuinn from *)\n(* http://sidc.oma.be/html/sunspot.html         *)\n\n(* Month: 1749 01 *) 58\n(* Month: 1749 02 *) 63\n(* Month: 1749 03 *) 70\n(* Month: 1749 04 *) 56\n</code></pre>\n\n<p>The comments are everything between (* and *).I need to only keep the 58,63,70, and 56 from this file.</p>\n\n<p>My code is removing some of the chars but not properly. My code looks like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;iterator&gt;\n#include &lt;algorithm&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n#include &lt;cctype&gt;\n#include &lt;numeric&gt;\n#include &lt;iomanip&gt;\n\nusing namespace std;\n\nint main() {\n\n    int digit = 1;\n    string filename;\n    //cout for getting user path\n    //the compiler parses string literals differently so use a double backslash or a forward slash\n    cout &lt;&lt; \"Enter the path of the data file, be sure to include extension.\" &lt;&lt; endl;\n    cout &lt;&lt; \"You can use either of the following:\" &lt;&lt; endl;\n    cout &lt;&lt; \"A forwardslash or double backslash to separate each directory.\" &lt;&lt; endl;\n    getline(cin, filename);\n\n    //gets file\n    ifstream infile{filename};\n    istream_iterator&lt;char&gt; infile_begin{ infile };\n    istream_iterator&lt;char&gt; eof{};\n    vector&lt;char&gt; file{ infile_begin, eof };\n\n    for(int i =0; i &lt; file.size(); i++){\n    if(!isdigit(file[i])) {\n        if(file[i] != ')') {\n            file.erase(file.begin(),file.begin()+i);\n        }\n    }\n    }\n    copy(begin(file), end(file), ostream_iterator&lt;char&gt;(cout, \" \"));\n    }\n</code></pre>\n\n<p>Should I not use <code>vector.erase()</code>? I know that it is not right in this code. If that is the case what is the better solution? I know in C you can write it to memory and go to each location, would this be the better way?</p>\n"}, {"tags": ["c++", "mingw", "sublimetext2"], "comments": [{"owner": {"reputation": 10249, "user_id": 1329116, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e58c33b56b00d4148810d427a04e21e0?s=128&d=identicon&r=PG", "display_name": "idleberg", "link": "https://stackoverflow.com/users/1329116/idleberg"}, "edited": false, "score": 0, "creation_date": 1473325201, "post_id": 39373798, "comment_id": 66100033, "body": "Did you save the file? Did you try and prepend <code>&quot;echo&quot;</code> to see what you&#39;re command looks like? Variants can be selected using Ctrl-Shift-B, but since you don&#39;t have bash, there&#39;s no need to use it."}], "owner": {"reputation": 11, "user_id": 6805301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/612afce350720cf2903bb74d488ed6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Mongia", "link": "https://stackoverflow.com/users/6805301/ankit-mongia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1473268638, "creation_date": 1473261691, "last_edit_date": 1473268638, "question_id": 39373798, "link": "https://stackoverflow.com/questions/39373798/sublime-build-system-variables-not-working", "title": "sublime: build system variables not working", "body": "<p>I have tried using the default build system for C++. It seems the variable <code>$file</code> is messed up. Here's how build script looks like:</p>\n\n<pre><code>{\n  \"cmd\": [\"g++\", \"${file}\", \"-o\", \"${file_path}/${file_base_name}\"],\n  \"file_regex\": \"^(..[^:]*):([0-9]+):?([0-9]+)?:? (.*)$\",\n  \"working_dir\": \"${file_path}\",\n  \"selector\": \"source.c, source.c++\",\n\n  \"variants\":\n  [\n    {\n        \"name\": \"Run\",\n        \"cmd\": [\"bash\", \"-c\", \"g++ '${file}' -o '${file_path}/${file_base_name}' &amp;&amp; '${file_path}/${file_base_name}'\"]\n    }\n  ]\n}\n</code></pre>\n\n<p>And, whenever I am trying to compile, I get the errors:</p>\n\n<pre><code> [Error 2] The system cannot find the file specified\n[cmd:  [u'g++', u'C:\\\\Users\\\\Ankit Mongia\\\\workspace\\\\HelloWorld\\\\HelloWorld.cpp', u'-o', u'C:\\\\Users\\\\Ankit Mongia\\\\workspace\\\\HelloWorld${file_base_name}']]\n[dir:  C:\\Users\\Ankit Mongia\\workspace\\HelloWorld]\n[path: C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Users\\Ankit Mongia\\AppData\\Local\\Programs\\Python\\Python35-32\\Scripts\\;C:\\Users\\Ankit Mongia\\AppData\\Local\\Programs\\Python\\Python35-32\\; E:\\Development\\MinGW\\bin\\]\n[Finished]\n</code></pre>\n\n<p>I don't understand why the script is messing up the path format of windows? it has got double backslashes up in \"cmd\" and single backslash in \"path\". And I dont understand the \"u\" literal in \"cmd\".\nI am not sure how important that \"variants\" is, I don't have bash executable on my windows machine. I am unable to understand the compilation error.</p>\n"}, {"tags": ["c++", "makefile", "autotools", "autoconf", "automake"], "comments": [{"owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "edited": false, "score": 0, "creation_date": 1473274523, "post_id": 39373777, "comment_id": 66082312, "body": "Can you try using: <code>autoreconf -fvi</code> instead of the <code>aclocal; ....;</code> commands?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1473276610, "post_id": 39373777, "comment_id": 66083326, "body": "May I suggest investigating <a href=\"http://scons.org\" rel=\"nofollow noreferrer\">SCons</a>, <a href=\"https://cmake.org\" rel=\"nofollow noreferrer\">CMake</a>, and other build systems - even plain <a href=\"https://www.gnu.org/software/make/\" rel=\"nofollow noreferrer\">make</a> - <i>anything</i> but the horror that is <code>autoconf</code>/<code>automake</code>..."}, {"owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1473296718, "post_id": 39373777, "comment_id": 66089887, "body": "@JesperJuhl - yes, cmake started out with pure intentions... only to find that it&#39;s a <i>hard</i> problem, and effectively reinvents the wheel without the 20 years of experience in the autotools - along with a syntax used nowhere else - unlike bash / m4."}, {"owner": {"reputation": 1836, "user_id": 2299414, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/71c93eb34525f3acb094e984caf9e340?s=128&d=identicon&r=PG", "display_name": "Filippo Lauria", "link": "https://stackoverflow.com/users/2299414/filippo-lauria"}, "reply_to_user": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "edited": false, "score": 0, "creation_date": 1473320162, "post_id": 39373777, "comment_id": 66097190, "body": "@BrettHale Thank you for answering. Please have a look at EDIT 1 in the question;"}, {"owner": {"reputation": 1836, "user_id": 2299414, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/71c93eb34525f3acb094e984caf9e340?s=128&d=identicon&r=PG", "display_name": "Filippo Lauria", "link": "https://stackoverflow.com/users/2299414/filippo-lauria"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1473320219, "post_id": 39373777, "comment_id": 66097225, "body": "@JesperJuhl Ty for the answer. I prefer investigate a little bit more on autoconf / automake and hopefully, soon or later and with some help, I will figure out how it has to be done."}, {"owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "edited": false, "score": 0, "creation_date": 1473439168, "post_id": 39373777, "comment_id": 66156961, "body": "@FilippoLauria - It would still be interesting to know why it didn&#39;t work. I&#39;m wondering if you haven&#39;t made automake aware of the existence of the <code>containers</code> directory, e.g., <code>EXTRA_DIST = containers</code> in <code>src&#47;Makefile.am</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1836, "user_id": 2299414, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/71c93eb34525f3acb094e984caf9e340?s=128&d=identicon&r=PG", "display_name": "Filippo Lauria", "link": "https://stackoverflow.com/users/2299414/filippo-lauria"}, "is_accepted": true, "score": 0, "last_activity_date": 1473669101, "creation_date": 1473669101, "answer_id": 39446225, "question_id": 39373777, "link": "https://stackoverflow.com/questions/39373777/cannot-totally-compile-and-link-cpp-project-as-a-static-library/39446225#39446225", "title": "Cannot totally compile and link cpp project as a static library", "body": "<p>Still I don't know what I was doing wrong following the typical <code>recursive approach</code>; but, finally I made this work, switching to a <code>non-recursive approach</code> (as I wrote in <strong>EDIT 2</strong>). <a href=\"http://karelzak.blogspot.it/2013/02/non-recursive-automake.html\" rel=\"nofollow\">This article</a> on Karel Zak's Blog helped me a lot!</p>\n\n<pre><code># -- new configure.ac file --\nAC_PREREQ([2.68])\nAC_INIT([filea], [1.0], [dev@host.net])\nAM_INIT_AUTOMAKE([filea], [1.0])\nAC_CONFIG_HEADERS([config.h])\nAC_CONFIG_SRCDIR([src/HashFunctions.cpp])\n\nAM_INIT_AUTOMAKE([filea], [1.0])\nLT_INIT\n\nAC_CANONICAL_HOST\nAC_PROG_LIBTOOL\nAC_PROG_GREP\nAC_PROG_EGREP\nAC_PROG_CXX\n ...\nAC_HEADER_STDBOOL\nAC_C_INLINE\nAC_TYPE_PID_T\nAC_TYPE_SIZE_T\nAC_TYPE_SSIZE_T\nAC_TYPE_UINT8_T\nAC_TYPE_UINT16_T\nAC_TYPE_UINT32_T\n\nAC_FUNC_ERROR_AT_LINE\nAC_FUNC_FORK\nAC_FUNC_MALLOC\nAC_FUNC_MKTIME\nAC_CHECK_FUNCS([memset socket])\n\nAC_OUTPUT([Makefile]) # the makefile is only one!\n                      # In the subdirectory I have created few\n                      # Makemodule.am included in the \"main makefile.am\"\n\n# --- makefile.am ---\nAUTOMAKE_OPTIONS = foreign\nlib_LIBRARIES = filea.a\n\nlibfilea_a_SOURCES =\ninclude src/Makemodule.am\ninclude src/containers/Makemodule.am # now filea_a_SOURCES is a\n                                     # \"global variable\"\n# -- src/Makemodule.am\nlibfilea_a_SOURCES += \\\n    src/ConfigLib.hpp \\\n    src/ConfigLib.cpp \\\n    src/HashFunctions.cpp \\\n    src/HashFunctions.hpp \\\n    src/Logger.hpp \\\n    src/Logger.cpp \\\n    src/Queue.hpp\n\n# -- src/containers/Makemodule.am\nlibfile_a_SOURCES += \\\n    src/containers/SafeContainer.cpp \\\n    src/containers/SafeInterger.cpp \\\n    src/containers/SafeMap.cpp\n</code></pre>\n\n<p>Notice that now, even if <code>Makemodule.am</code> files are placed at different levels in the dir tree, whenever a filename is typed in one those modules, it has to be preceded by its relative path. This path is relative to <code>Makefile</code> location.</p>\n"}], "owner": {"reputation": 1836, "user_id": 2299414, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/71c93eb34525f3acb094e984caf9e340?s=128&d=identicon&r=PG", "display_name": "Filippo Lauria", "link": "https://stackoverflow.com/users/2299414/filippo-lauria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 39446225, "answer_count": 1, "score": 0, "last_activity_date": 1473669101, "creation_date": 1473261628, "last_edit_date": 1495540863, "question_id": 39373777, "link": "https://stackoverflow.com/questions/39373777/cannot-totally-compile-and-link-cpp-project-as-a-static-library", "title": "Cannot totally compile and link cpp project as a static library", "body": "<p>I have followed this <a href=\"http://mij.oltrelinux.com/devel/autoconf-automake/\" rel=\"nofollow noreferrer\">link</a> and adapted its steps to make it work for my project.</p>\n\n<p>My goal is to create a <code>libfile.a</code> to distribute as a static library. The project tree is the following:</p>\n\n<pre><code>project\n   |\n   +-src\n      +- &lt;some cpp and hpp files&gt;\n      |\n      + containers\n             |\n             +- &lt;other cpp and hpp files&gt;\n</code></pre>\n\n<p>I easily created <code>configure.ac</code> file and the <code>Makefile.am</code>s. The tree structure changed this way:</p>\n\n<pre><code>project\n   |\n   +- configure.ac\n   +- Makefile.am\n   +-src\n      +- &lt;some cpp and hpp files&gt;\n      + Makefile.am\n      |\n      + containers\n             |\n             +- &lt;other cpp and hpp files&gt;\n</code></pre>\n\n<p>Now, when I go: <code>(*)</code></p>\n\n<pre><code>aclocal; autoreconf --install; autoconf; ./configure\nmake\n</code></pre>\n\n<p><code>.o files</code> are generated for all the <code>.*pp files</code> contained in <code>src</code>, but it fails when it starts generating those targets in <code>src/containers</code>. So the <code>Makefile</code> is not generated properly. What am I doing wrong? Can someone help me?</p>\n\n<p>PS here there are files involved:</p>\n\n<pre><code># --- configure.ac ---\n\nAC_PREREQ([2.68])\nAC_INIT([filea], [1.0], [dev@host.net])\nAM_INIT_AUTOMAKE([filea], [1.0])\nAC_CONFIG_SRCDIR([src/HashFunctions.cpp])\nAC_CONFIG_HEADERS([config.h])\n\nAC_PROG_CXX\nAC_PROG_RANLIB\n\nAC_CHECK_HEADERS([stddef.h stdint.h string.h])\nAC_HEADER_STDBOOL\n\nAC_C_INLINE\nAC_TYPE_SIZE_T\nAC_TYPE_UINT16_T\nAC_TYPE_UINT32_T\nAC_TYPE_UINT8_T\n\nAC_FUNC_MALLOC\nAC_FUNC_MKTIME\nAC_CHECK_FUNCS([memset])\n\nAC_OUTPUT([Makefile src/Makefile])\n\n# --- Makefile.am ---\n\nAUTOMAKE_OPTIONS = foreign\nSUBDIRS = src\n\n\n# --- src/Makefile.am ---\n\nlib_LIBRARIES = libfile.a\nlibfile_a_SOURCES = \\\n    ConfigLib.hpp \\\n    ConfigLib.cpp \\\n    HashFunctions.cpp \\\n    HashFunctions.hpp \\\n    Logger.hpp \\\n    Logger.cpp \\\n    Queue.hpp\n\nlibfile_a_SOURCES += \\\n    containers/SafeContainer.cpp \\\n    containers/SafeInterger.cpp \\\n    containers/SafeMap.cpp\n</code></pre>\n\n<p><strong>EDIT 1</strong>\nas suggested by <a href=\"https://stackoverflow.com/users/906839/brett-hale\">Brett Hale</a> the commands marked with <code>(*)</code> have been replaced by the following ones:</p>\n\n<pre><code>autoreconf -fvi\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>autoreconf: Entering directory `.'\nautoreconf: configure.ac: not using Gettext\nautoreconf: running: aclocal --force \nautoreconf: configure.ac: tracing\nautoreconf: configure.ac: not using Libtool\nautoreconf: running: /usr/bin/autoconf --force\nautoreconf: running: /usr/bin/autoheader --force\nautoreconf: running: automake --add-missing --copy --force-missing\nautoreconf: Leaving directory `.'\n</code></pre>\n\n<p>When going with:</p>\n\n<pre><code>./configure\nmake\n</code></pre>\n\n<p>Still no rules are found to generate targets in the subdirectory.</p>\n\n<p><strong>EDIT 2</strong> I switched to a non-recursive approach (Thanks to <a href=\"http://karelzak.blogspot.it/2013/02/non-recursive-automake.html\" rel=\"nofollow noreferrer\">Karel Zak's blog</a>) and finally I can <code>make</code>my lib.</p>\n"}, {"tags": ["c++", "templates", "c++11", "lambda"], "comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1473261572, "post_id": 39373678, "comment_id": 66075504, "body": "If it was me, I&#39;d have both the <code>Func&amp;&amp;</code> and <code>const Func&amp;</code> overloads."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 2, "creation_date": 1473261815, "post_id": 39373678, "comment_id": 66075678, "body": "@DeiDei: Because of type-inference, <code>Func&amp;&amp;</code> can handle the <code>const Func&amp;</code> case as well."}], "answers": [{"comments": [{"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 1, "creation_date": 1473262765, "post_id": 39373876, "comment_id": 66076327, "body": "True answer in general, but notice that SFINAE only really makes sense if there are other overloads to choose instead of the disabled one. If all you&#39;re after is a compilation error with incompatible types, a <code>static_assert</code> is easier to both write and read, and can produce a nicer error message."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 0, "creation_date": 1473263540, "post_id": 39373876, "comment_id": 66076796, "body": "@Angew Not necessarily - it&#39;s also useful if something else is inspecting if your function is callable and will do some kind of fallback. Or if you&#39;re wrapping this function template in a generic lambda that you&#39;re passing to something else, etc."}, {"owner": {"reputation": 7526, "user_id": 4108376, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/163807162a115b27e50f5f5f2b90de26?s=128&d=identicon&r=PG&f=1", "display_name": "tmlen", "link": "https://stackoverflow.com/users/4108376/tmlen"}, "edited": false, "score": 0, "creation_date": 1473264734, "post_id": 39373876, "comment_id": 66077557, "body": "The first version wouldn&#39;t work on function objects, or on lambdas, when <code>function_type = int(int).</code> Also for the second version, I&#39;m not sure if it can be used with locally defined lambdas, since it doesn&#39;t make a copy."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1473265041, "post_id": 39373876, "comment_id": 66077738, "body": "For SFINAE, i would not use the form <code>class = std::enable_if_t&lt;cond&gt;</code> as this form disallows the disable counter part. I prefer <code>std::enable_if_t&lt;cond&gt;* = nullptr</code>."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 7526, "user_id": 4108376, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/163807162a115b27e50f5f5f2b90de26?s=128&d=identicon&r=PG&f=1", "display_name": "tmlen", "link": "https://stackoverflow.com/users/4108376/tmlen"}, "edited": false, "score": 0, "creation_date": 1473265137, "post_id": 39373876, "comment_id": 66077790, "body": "@tmlen Confused what your typedef meant. Should be taking <code>std::function&lt;function_type&gt;</code>, fixed."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 7526, "user_id": 4108376, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/163807162a115b27e50f5f5f2b90de26?s=128&d=identicon&r=PG&f=1", "display_name": "tmlen", "link": "https://stackoverflow.com/users/4108376/tmlen"}, "edited": false, "score": 0, "creation_date": 1473265157, "post_id": 39373876, "comment_id": 66077797, "body": "@tmlen What do you mean about locally defined lambdas?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1473265166, "post_id": 39373876, "comment_id": 66077800, "body": "@Jarod42 There is no disable counterpart here."}, {"owner": {"reputation": 7526, "user_id": 4108376, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/163807162a115b27e50f5f5f2b90de26?s=128&d=identicon&r=PG&f=1", "display_name": "tmlen", "link": "https://stackoverflow.com/users/4108376/tmlen"}, "edited": false, "score": 0, "creation_date": 1473265282, "post_id": 39373876, "comment_id": 66077859, "body": "The lambda is defined inside a function, and passed to the <code>Wrapper</code>. The lambda then goes out of scope, but the <code>Wrapper</code> still has the reference to it. I don&#39;t know if <code>std::function</code> keeps a copy of the lambda object."}, {"owner": {"reputation": 5668, "user_id": 966376, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/L6Wh4.jpg?s=128&g=1", "display_name": "GreenScape", "link": "https://stackoverflow.com/users/966376/greenscape"}, "reply_to_user": {"reputation": 7526, "user_id": 4108376, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/163807162a115b27e50f5f5f2b90de26?s=128&d=identicon&r=PG&f=1", "display_name": "tmlen", "link": "https://stackoverflow.com/users/4108376/tmlen"}, "edited": false, "score": 0, "creation_date": 1473265852, "post_id": 39373876, "comment_id": 66078180, "body": "@tmlen Of course it does. That&#39;s basically the purpose of <code>std::function</code>."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 7526, "user_id": 4108376, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/163807162a115b27e50f5f5f2b90de26?s=128&d=identicon&r=PG&f=1", "display_name": "tmlen", "link": "https://stackoverflow.com/users/4108376/tmlen"}, "edited": false, "score": 0, "creation_date": 1473266443, "post_id": 39373876, "comment_id": 66078455, "body": "@tmlen <code>std::function</code> owns its function, yes."}, {"owner": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "edited": false, "score": 0, "creation_date": 1473266447, "post_id": 39373876, "comment_id": 66078459, "body": "Why the SFINAE boiler-plate when <code>set</code> isn&#39;t overloaded anyway? It&#39;s going to be an error in all cases when you try to call <code>foo.set</code> even with the SFINAE in place, right?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "edited": false, "score": 0, "creation_date": 1473266557, "post_id": 39373876, "comment_id": 66078516, "body": "@JohannesSchaub-litb Maybe somebody wants to check if <code>foo.set</code> is callable with an argument and, if so, call it, else do something else."}, {"owner": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "edited": false, "score": 0, "creation_date": 1473267267, "post_id": 39373876, "comment_id": 66078907, "body": "Note that a default template argument is not a context where SFINAE applies, according to the spec text: &quot;Only invalid types and expressions in the immediate context of the function type and its template parameter types can result in a deduction failure.&quot; Until we have a clear definition of &quot;immediate context&quot; (<a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1844\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1844</a>), the use of SFINAE in default template arguments is insecure. To be in the safe side, the SFINAE should be put in the template parameter type itself or the function template type."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 6, "last_activity_date": 1473265062, "last_edit_date": 1473265062, "creation_date": 1473261907, "answer_id": 39373876, "question_id": 39373678, "link": "https://stackoverflow.com/questions/39373678/template-argument-for-function-type-in-c/39373876#39373876", "title": "Template argument for function type in C++", "body": "<p>The simplest version:</p>\n\n<pre><code>void set(std::function&lt;function_type&gt; f) {\n    func_ = std::move(f);\n}\n</code></pre>\n\n<p>The complex version:</p>\n\n<pre><code>template &lt;class F,\n    class = std::enable_if_t&lt;std::is_assignable&lt;std::function&lt;function_type&gt;&amp;, F&amp;&amp;&gt;::value&gt;\n    &gt;\nvoid set(F&amp;&amp; f) {\n    func_ = std::forward&lt;F&gt;(f);\n}\n</code></pre>\n\n<p>There's no reason to do anything else. Both of these handle every case gracefully and correctly, the simple case has an extra move, which for <code>std::function</code> isn't an expensive operation, so I would strongly prefer the simple version unless you have a compelling, proven performance requirement to need the complex one. </p>\n"}], "owner": {"reputation": 7526, "user_id": 4108376, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/163807162a115b27e50f5f5f2b90de26?s=128&d=identicon&r=PG&f=1", "display_name": "tmlen", "link": "https://stackoverflow.com/users/4108376/tmlen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 1, "accepted_answer_id": 39373876, "answer_count": 1, "score": 4, "last_activity_date": 1473265062, "creation_date": 1473261354, "question_id": 39373678, "link": "https://stackoverflow.com/questions/39373678/template-argument-for-function-type-in-c", "title": "Template argument for function type in C++", "body": "<p>Here, <code>Wrapper::set</code> should be able to take any function or function object that matches the <code>int(int)</code> signature, and store it into the <code>std::function</code>. It should work with function pointers, lambdas, objects with <code>operator()</code>, <code>std::bind</code> expressions, etc.</p>\n\n<pre><code>#include &lt;functional&gt;\n\nstruct Wrapper {\n    using function_type = int(int);\n\n    std::function&lt;function_type&gt; func_;\n\n    template&lt;typename Func&gt; void set(Func func) { func_ = func; }\n};\n</code></pre>\n\n<p>What would be the best form of <code>set</code> so that it works in all cases? I.e. one of</p>\n\n<ul>\n<li><code>set(Func func) { func_ = func; }</code></li>\n<li><code>set(Func&amp;&amp; func) { func_ = std::forward&lt;Func&gt;(func); }</code></li>\n<li><code>set(Func&amp; func) { func_ = func; }</code></li>\n<li><code>set(const Func&amp; func) { func_ = func; }</code></li>\n</ul>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "edited": false, "score": 1, "creation_date": 1473261208, "post_id": 39373556, "comment_id": 66075287, "body": "Well for starters you don&#39;t have a destructor, and that could lead to a memory leak"}, {"owner": {"reputation": 423, "user_id": 2660756, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/uBvKF.jpg?s=128&g=1", "display_name": "Loay", "link": "https://stackoverflow.com/users/2660756/loay"}, "reply_to_user": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "edited": false, "score": 0, "creation_date": 1473261271, "post_id": 39373556, "comment_id": 66075337, "body": "@ArnavBorborah but is that the only <i>unsafe</i> thing?"}], "answers": [{"comments": [{"owner": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 1, "creation_date": 1473261628, "post_id": 39373640, "comment_id": 66075548, "body": "Note that both <a href=\"http://coliru.stacked-crooked.com/a/08d42bdb5e31d8ed\" rel=\"nofollow noreferrer\">gcc and clang</a> will warn you if you place members in a member initializer list in a different order than they will be constructed, and you&#39;ve got -Wall (or, more specifically -Wreorder) enabled."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 0, "creation_date": 1473261688, "post_id": 39373640, "comment_id": 66075591, "body": "@jaggedSpire,  and this is the warning which annoys me the most!"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 0, "creation_date": 1473261692, "post_id": 39373640, "comment_id": 66075595, "body": "@jaggedSpire That is nice, I did not know it did that.  To bad too many people do not use that."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 12, "last_activity_date": 1473261849, "last_edit_date": 1473261849, "creation_date": 1473261287, "answer_id": 39373640, "question_id": 39373556, "link": "https://stackoverflow.com/questions/39373556/unsafe-template-array-constructor/39373640#39373640", "title": "unsafe template array constructor", "body": "<p>The code is \"unsafe\" in the fact that it relies on <code>n</code> being constructed before <code>buff</code>.  This dependency adds brittleness to the code.</p>\n\n<p>When you construct the members of the class they are constructed in the order the are declared in the class, not how they are called in the member initialization list, so if the code was changed to</p>\n\n<pre><code>template&lt;typename Type&gt;\nclass Array {\n    Type* buff;\n    size_t n;\npublic:\n    Array(size_t n_): n(n_), buff(new Type[n]) {}\n};\n</code></pre>\n\n<p>Then when you do <code>buff(new Type[n])</code>, <code>n</code> is uninitialized and you have undefined behavior.</p>\n"}, {"comments": [{"owner": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 0, "creation_date": 1473261971, "post_id": 39373762, "comment_id": 66075772, "body": "That doesn&#39;t apply here, though it would if there was some non-<code>noexcept</code> code that executed after the <code>new</code>, even another <code>new</code>. If the new fails, then construction fails there. Nothing else in the class is dynamically allocated, so it cleans up after itself."}], "tags": [], "owner": {"reputation": 151, "user_id": 1643530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sNKvZ.jpg?s=128&g=1", "display_name": "feldi", "link": "https://stackoverflow.com/users/1643530/feldi"}, "is_accepted": false, "score": -1, "last_activity_date": 1473261566, "last_edit_date": 1495541787, "creation_date": 1473261566, "answer_id": 39373762, "question_id": 39373556, "link": "https://stackoverflow.com/questions/39373556/unsafe-template-array-constructor/39373762#39373762", "title": "unsafe template array constructor", "body": "<p>It is not safe to call new operator inside initialization list.\nif new fails the destructor of Array will not be called.\nhere is a similar question.\n<a href=\"https://stackoverflow.com/questions/9064298/are-there-any-issues-with-allocating-memory-within-constructor-initialization-li\">Are there any issues with allocating memory within constructor initialization lists?</a></p>\n"}, {"tags": [], "owner": {"reputation": 2630, "user_id": 5053331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d9a0047e09056279f06b7fb3b0c101e?s=128&d=identicon&r=PG&f=1", "display_name": "cdonat", "link": "https://stackoverflow.com/users/5053331/cdonat"}, "is_accepted": false, "score": 3, "last_activity_date": 1473262103, "creation_date": 1473262103, "answer_id": 39373952, "question_id": 39373556, "link": "https://stackoverflow.com/questions/39373556/unsafe-template-array-constructor/39373952#39373952", "title": "unsafe template array constructor", "body": "<p>First of all the order, the initializations for the constructor are executed is not determined by the order they are written down, but by the order the initialized fields appear in the code:</p>\n\n<pre><code>class Array {\n    size_t n;\n    Type* buff;\npublic:\n    Array(size_t n_): n(n_), buff(new Type[n]) {}\n};\n</code></pre>\n\n<p>Here first n will be initialized and then buff.</p>\n\n<pre><code>class Array {\n    Type* buff;\n    size_t n;\npublic:\n    Array(size_t n_): n(n_), buff(new Type[n]) {}\n};\n</code></pre>\n\n<p>Now first buff will be initialized and then n, so n has no defined value in that case.</p>\n\n<p>Using initialization lists for constructors is good practice, but be careful, that you don't create any assumptions on the order.</p>\n\n<p>Generally it is a good idea to refrain from owning raw pointers. If you use smart pointers instead, you can not forget to release the data.</p>\n\n<p>In the specific case, you might also want to use std::vector instead of a C-style array. That handles all the allocation, reallocation, releases, etc. in a thread safe manner for you. It seems like you are trying to write something like your own std::vector. Please only do that for educational purposes. Always prefer the standard implementation in production code. You probably won't get it better for quite a while. If you did, you would ask different questions here ;-)</p>\n"}, {"tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": false, "score": 3, "last_activity_date": 1473279415, "last_edit_date": 1473279415, "creation_date": 1473262257, "answer_id": 39374000, "question_id": 39373556, "link": "https://stackoverflow.com/questions/39373556/unsafe-template-array-constructor/39374000#39374000", "title": "unsafe template array constructor", "body": "<p>First of all, you have a memory leak. But the question probably isn't about that. So let's assume you have a destructor that deallocates the array.</p>\n\n<pre><code>template&lt;typename Type&gt;\nclass Array {\n    size_t n;\n    Type* buff;\npublic:\n    Array(size_t n_): n(n_), buff(new Type[n]) {}\n    ~Array() { delete[] buff; }\n};\n</code></pre>\n\n<p>Now <em>this</em> particular code is perfectly safe. No exception can be thrown while assigning <code>n_</code>, the order of initialization is correct and <code>buff</code> is the only raw pointer in your class. However, as you start expanding your class and writing more classes, the risk of a memory leak increases.</p>\n\n<p>Imagine that you need to add one more members to the <code>class Array</code>:</p>\n\n<pre><code>template&lt;typename Type&gt;\nclass Array {\n    size_t n;\n    Type* buff;\n    SomethingElse xyz;\npublic:\n    Array(size_t n_): n(n_), buff(new Type[n_]), xyz(n_) {}\n    ~Array() { delete[] buff; }\n};\n</code></pre>\n\n<p>If the constructor of <code>SomethingElse</code> throws, the memory allocated for <code>buff</code> will leak, because the destructor <code>~Array()</code> will never be called.</p>\n\n<p>Modern C++ calls pointers such as <code>Type* buff</code> <em>raw pointers</em> because you are responsible for deallocating storage yourself (taking exceptions into account), and introduces tools such as <a href=\"http://en.cppreference.com/w/cpp/memory/unique_ptr\" rel=\"nofollow\"><code>std::unique_ptr</code></a> and <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr\" rel=\"nofollow\"><code>std::shared_ptr</code></a> that can take care of storage deallocation automatically.</p>\n\n<p>In modern C++ you could write your class like this:</p>\n\n<pre><code>template&lt;typename Type&gt;\nclass Array {\n    size_t n;\n    std::unique_ptr&lt;Type[]&gt; buff;\npublic:\n    Array(size_t n_): n(n_), buff(new Type[n_]) {}\n};\n</code></pre>\n\n<p>Notice the absence of a destructor. The <code>unique_ptr</code> will take care of calling <code>delete</code> for you.</p>\n\n<p>Note also no dependency on class members inside the initializer list (simply writing <code>new Type[n_]</code> instead of <code>new Type[n]</code> makes your code more robust)</p>\n"}, {"tags": [], "owner": {"reputation": 13642, "user_id": 4013258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d423395e1033fa23d80a5561ab170fa?s=128&d=identicon&r=PG&f=1", "display_name": "Surt", "link": "https://stackoverflow.com/users/4013258/surt"}, "is_accepted": false, "score": 0, "last_activity_date": 1473285249, "creation_date": 1473285249, "answer_id": 39379584, "question_id": 39373556, "link": "https://stackoverflow.com/questions/39373556/unsafe-template-array-constructor/39379584#39379584", "title": "unsafe template array constructor", "body": "<p>C++98 Standard 12.6.2.5.4 (I don't expect new versions to have relaxed this).</p>\n\n<blockquote>\n  <p>\u2014 Then, nonstatic data members shall be initialized in the order they\n  were declared in the class definition (again regardless of the order\n  of the mem-initializers).</p>\n</blockquote>\n\n<p>So the order of initialization is defined according to this.</p>\n\n<p>If you want an example of how to crash it simply make <code>sizeof(Type)*n</code> > total memory in your system.</p>\n"}], "owner": {"reputation": 423, "user_id": 2660756, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/uBvKF.jpg?s=128&g=1", "display_name": "Loay", "link": "https://stackoverflow.com/users/2660756/loay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "answer_count": 5, "score": 10, "last_activity_date": 1473285249, "creation_date": 1473261041, "last_edit_date": 1473261158, "question_id": 39373556, "link": "https://stackoverflow.com/questions/39373556/unsafe-template-array-constructor", "title": "unsafe template array constructor", "body": "<p>This is probably a simple question but I have this <code>template class</code>:</p>\n\n<pre><code>template&lt;typename Type&gt;\nclass Array {\n    size_t n;\n    Type* buff;\npublic:\n    Array(size_t n_): n(n_), buff(new Type[n]) {}\n};\n</code></pre>\n\n<p>The code is from a course pdf file where it says <code>buff(new Type[n])</code> is unsafe. I don't understand why it's unsafe, isn't size_t generally unsigned? Can I have an example where it could have a compile and/or run-time error?</p>\n"}, {"tags": ["c++", "csv"], "comments": [{"owner": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "edited": false, "score": 0, "creation_date": 1473269743, "post_id": 39373524, "comment_id": 66080144, "body": "What exactly is central problem? Do You try debugging?"}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 0, "creation_date": 1473346507, "post_id": 39373524, "comment_id": 66114457, "body": "Offtopic : you are using c++, so use c++ library, instead of old C one =&gt; <code>FILE *</code> and associated functions =&gt; replaced by <code>ifstream</code>; <code>sscanf</code> =&gt; <code>stringstream</code>; <code>fgets</code> =&gt; <code>std::getline</code>; <code>char *</code> or <code>char[]</code>=&gt; <code>std::string</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5668645"}, "reply_to_user": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 0, "creation_date": 1473346828, "post_id": 39373524, "comment_id": 66114692, "body": "@Garf365 yeah i&#39;m aware of that , thanks mate!"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5668645"}, "is_accepted": true, "score": 0, "last_activity_date": 1473346286, "creation_date": 1473346286, "answer_id": 39394074, "question_id": 39373524, "link": "https://stackoverflow.com/questions/39373524/cannot-write-csv-file-to-stringgrid-in-c-builder/39394074#39394074", "title": "Cannot write .csv file to StringGrid in C++ Builder", "body": "<p>It was not working because of that unnecessary for loop, now it works.</p>\n\n<pre><code>        int i= 0;\n        while (fgets(line,100,DosyaGiris)!=NULL){\n            sscanf(line,\"%d,%lf,%lf,%lf\",&amp;ID,&amp;x,&amp;y,&amp;z);\n\n                StringGrid1-&gt;Cells[0][i+1] = IntToStr(ID);\n                StringGrid1-&gt;Cells[1][i+1] = FloatToStr(x);\n                StringGrid1-&gt;Cells[2][i+1] = FloatToStr(y);\n                StringGrid1-&gt;Cells[3][i+1] = FloatToStr(z);\n                i++;\n\n        }\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5668645"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 0, "accepted_answer_id": 39394074, "answer_count": 1, "score": 0, "last_activity_date": 1473368444, "creation_date": 1473260980, "last_edit_date": 1473368444, "question_id": 39373524, "link": "https://stackoverflow.com/questions/39373524/cannot-write-csv-file-to-stringgrid-in-c-builder", "title": "Cannot write .csv file to StringGrid in C++ Builder", "body": "<p>EDIT: Codeblock edited,  now only problem is only last line of .csv file is printed in each row of StringGrid. What can be the reason? Thanks in advance.</p>\n\n<p>Basically , one module of project does create an output file with toushands of point coordinates in comma seperated format like shown below :</p>\n\n<pre><code>#pt,     x     ,     y     ,z    \n124,4500003.833,3499999.500,0\n125,4500003.833,3499999.833,0\n126,4500003.833,3500000.167,0\n</code></pre>\n\n<p>What i'm trying to do is reading the .csv with another module and put it into a StringGrid. </p>\n\n<pre><code> FILE *coord;\n\n //some other things here\n\nwhile (fgets(line,100,DosyaGiris)!=NULL) {\n\n sscanf(line,\"%d,%lf,%lf,%lf\",&amp;number,&amp;x,&amp;y,&amp;z);\n        for (col = 0; col &lt; 4; col++) {\n\n                StringGrid1-&gt;Cells[0][row] = IntToStr(number);\n                StringGrid1-&gt;Cells[1][row] = FloatToStr(x);\n                StringGrid1-&gt;Cells[2][row] = FloatToStr(y);\n                StringGrid1-&gt;Cells[3][row] = FloatToStr(z);\n\n        }\n\n}\n</code></pre>\n\n<p>Please be constructive , have a good one. </p>\n"}, {"tags": ["c++", "string"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473260892, "post_id": 39373483, "comment_id": 66075065, "body": "Have you checked the <a href=\"http://en.cppreference.com/w/cpp/string/basic_string\" rel=\"nofollow noreferrer\">reference material</a>?"}, {"owner": {"reputation": 3, "user_id": 6802894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac7fe1c7180e2cbf951294dfbe1dc317?s=128&d=identicon&r=PG&f=1", "display_name": "Ivami", "link": "https://stackoverflow.com/users/6802894/ivami"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473260996, "post_id": 39373483, "comment_id": 66075138, "body": "Yes I have and it is incomprehesible"}], "answers": [{"comments": [{"owner": {"reputation": 1194, "user_id": 6800367, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6MJwj.jpg?s=128&g=1", "display_name": "Benson Lin", "link": "https://stackoverflow.com/users/6800367/benson-lin"}, "edited": false, "score": 1, "creation_date": 1473260983, "post_id": 39373518, "comment_id": 66075129, "body": "Another option is <code>x.size()</code>"}, {"owner": {"reputation": 3, "user_id": 6802894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac7fe1c7180e2cbf951294dfbe1dc317?s=128&d=identicon&r=PG&f=1", "display_name": "Ivami", "link": "https://stackoverflow.com/users/6802894/ivami"}, "edited": false, "score": 0, "creation_date": 1473261778, "post_id": 39373518, "comment_id": 66075655, "body": "Thank you George for your quick response"}], "tags": [], "owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "is_accepted": true, "score": 1, "last_activity_date": 1473260960, "creation_date": 1473260960, "answer_id": 39373518, "question_id": 39373483, "link": "https://stackoverflow.com/questions/39373483/simple-way-of-returning-the-length-of-the-string-to-output/39373518#39373518", "title": "Simple way of returning the length of the string to output", "body": "<p>There's a function that belongs to the string object, in your case <code>x.length()</code> will return the length of the string.</p>\n"}, {"tags": [], "owner": {"reputation": 2630, "user_id": 5053331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d9a0047e09056279f06b7fb3b0c101e?s=128&d=identicon&r=PG&f=1", "display_name": "cdonat", "link": "https://stackoverflow.com/users/5053331/cdonat"}, "is_accepted": false, "score": 0, "last_activity_date": 1473260990, "creation_date": 1473260990, "answer_id": 39373529, "question_id": 39373483, "link": "https://stackoverflow.com/questions/39373483/simple-way-of-returning-the-length-of-the-string-to-output/39373529#39373529", "title": "Simple way of returning the length of the string to output", "body": "<pre><code>cout &lt;&lt; \"You entered: \" &lt;&lt; x &lt;&lt; \"String lenght/size is: \"&lt;&lt; x.size() &lt;&lt; endl;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "is_accepted": false, "score": 0, "last_activity_date": 1473261023, "creation_date": 1473261023, "answer_id": 39373544, "question_id": 39373483, "link": "https://stackoverflow.com/questions/39373483/simple-way-of-returning-the-length-of-the-string-to-output/39373544#39373544", "title": "Simple way of returning the length of the string to output", "body": "<p>Use the <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/size\" rel=\"nofollow\"><code>string.length()</code></a> member function  or the <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/size\" rel=\"nofollow\"><code>string.size()</code></a> like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\nint main()\n{\n    string x ;\n    getline (cin, x) ;\n    cout &lt;&lt; \"You entered: \" &lt;&lt; x &lt;&lt; \"String length/size is: \"&lt;&lt; x.length()&lt;&lt;endl;\n}\n</code></pre>\n\n<p>The function above returns a <code>size_t</code> with the size of the string.</p>\n"}], "owner": {"reputation": 3, "user_id": 6802894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac7fe1c7180e2cbf951294dfbe1dc317?s=128&d=identicon&r=PG&f=1", "display_name": "Ivami", "link": "https://stackoverflow.com/users/6802894/ivami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 39373518, "answer_count": 3, "score": -3, "last_activity_date": 1473343355, "creation_date": 1473260836, "last_edit_date": 1473343355, "question_id": 39373483, "link": "https://stackoverflow.com/questions/39373483/simple-way-of-returning-the-length-of-the-string-to-output", "title": "Simple way of returning the length of the string to output", "body": "<p>I am writing a program that prints out a user-entered string and its length.\nI was able to get this part:</p>\n\n<pre><code> #include &lt;iostream&gt;\n #include &lt;string&gt;\n using namespace std;\n int main()\n {\n     string x;\n     getline(cin, x);\n     cout &lt;&lt; \"You entered: \" &lt;&lt; x &lt;&lt; \"String length/size is: \"&lt;&lt;  /*  What comes Here ? */  &lt;&lt;endl;\n }\n</code></pre>\n\n<p>Rest of the process remains incomprehensible. </p>\n"}, {"tags": ["c++", "image", "visual-studio", "opencv"], "comments": [{"owner": {"reputation": 3122, "user_id": 1874627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eV76W.jpg?s=128&g=1", "display_name": "saurabheights", "link": "https://stackoverflow.com/users/1874627/saurabheights"}, "edited": false, "score": 0, "creation_date": 1473328242, "post_id": 39373055, "comment_id": 66101906, "body": "Please attach the image. It will help others to debug the issue. As you already know, setting opencv and data is already time-taking task. Also, mention opencv version you are using."}], "owner": {"reputation": 31, "user_id": 6070827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4092bc3e601421af95bd7c0ae74b8933?s=128&d=identicon&r=PG", "display_name": "jay", "link": "https://stackoverflow.com/users/6070827/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1955, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1473401988, "creation_date": 1473259651, "last_edit_date": 1473401988, "question_id": 39373055, "link": "https://stackoverflow.com/questions/39373055/vignetting-correction-on-rgb-image-with-opencv", "title": "Vignetting correction on RGB image with OpenCV", "body": "<p>First of all: I'm new to opencv :-) \nI want to perform a vignetting correction on a 24bit RGB Image. I used an area scan camera as a line camera and put together an image from 1780x2 px parts to get an complete image with 1780x3000 px. Because of the vignetting, i made a white reference picture with 1780x2 px to calculate a LUT (with correction factor in it) for the vignetting removal. Here is my code idea:</p>\n\n<pre><code>    Mat white = imread(\"WHITE_REF_2L.bmp\", 0);\n    Mat lut(2, 1780, CV_8UC3, Scalar(0));\n    lut = 255 / white;\n    imwrite(\"lut_test.bmp\", lut*white);\n</code></pre>\n\n<p>As i understood, what the second last line will (hopefully) do, is to divide 255 with every intensity value of every channel and store this in the lut matrice. \nI want to use that lut then to to calculate the \u201creal\u201d (not distorted) intensity\nlevel of each pixel by multiplying every element of the src img with every element of the lut matrice.</p>\n\n<p>obviously its not working how i want to do it, i get a memory exception.</p>\n\n<p>Can anybody help me with that problem?</p>\n\n<p>edit: i'm using opencv 3.1.0 and i solved the problem like this:</p>\n\n<pre><code>    // read white reference image\n    Mat white = imread(\"WHITE_REF_2L_D.bmp\", IMREAD_COLOR);\n    white.convertTo(white, CV_32FC3);\n    // calculate LUT with vignetting correction factors\n    Mat vLUT(2, 1780, CV_32FC3, Scalar(0.0f));\n    divide(240.0f, white, vLUT);\n</code></pre>\n\n<p>of course that's not optimal, i will read in more white references and calculate the mean value to optimize.</p>\n\n<p><a href=\"http://i.stack.imgur.com/vYUje.png\" rel=\"nofollow\">Here's the 2 lines white reference, you can see the shadows at the image borders i want to correct</a></p>\n\n<p>when i multiply vLUT with the white reference i obviously get a homogenous <a href=\"http://i.stack.imgur.com/jVrjT.png\" rel=\"nofollow\">image</a> as the result.</p>\n\n<p>thanks, maybe this can help anyone else ;)</p>\n"}, {"tags": ["c++", "boost", "c++14"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473260147, "post_id": 39373008, "comment_id": 66074511, "body": "Can&#39;t say why it compiles but it most definitely looks like a typo. Even more so when you consider <code>_s</code> returns <code>return state&lt;aux::string&lt;Chrs...&gt;&gt;{};</code>."}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473260339, "post_id": 39373008, "comment_id": 66074665, "body": "@NathanOliver: Exactly what I think. But something is behind the curtain..."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1473260726, "post_id": 39373325, "comment_id": 66074946, "body": "This, to me, is <i>evil</i>"}, {"owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 0, "creation_date": 1473260816, "post_id": 39373325, "comment_id": 66075010, "body": "I was impressed myself. What previously was unmistakably admitted as an instance of a template class (e.g. <code>vector&lt;int&gt;</code>) could now be an actual object."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1473261723, "post_id": 39373325, "comment_id": 66075621, "body": "@NathanOliver, I hope people use a naming convention to indicate that a name represents a template variable. Just like <code>_t</code> is used to indicate a type alias, it will be nice if people use <code>_v</code> or something along those line to  indicate a variable. <code>event_v</code> would have been easier to grasp. Otherwise, I am with you on the <i>evil</i> part."}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1473265719, "post_id": 39373325, "comment_id": 66078111, "body": "Thanks! I did not find the code part because my ctags did not find template variables :-) So I only go through the tag list in my editor and did not see the template for the variable... a normal grep returns to many &quot;events&quot; ;)"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1473273188, "post_id": 39373325, "comment_id": 66081733, "body": "@RSahu This wouldn&#39;t be a problem if people would use <code>ThisStyle</code> for user-defined object types and <code>this_style</code> for instance names ;-) [also, I use <code>this_style_type</code> for type aliases, in case I ever start using POSIX...] Sadly for my opinion, the stdlib and Boost name <code>everything_like_this</code>, which means that many programmers follow their example, leading to opaque names everywhere."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1473274336, "post_id": 39373325, "comment_id": 66082227, "body": "@underscore_d, coming up with a naming convention and convincing others that it is a good one is rather hard."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1473279326, "post_id": 39373325, "comment_id": 66084565, "body": "@RSahu Of course. Stylistic preferences aside, my real point is that it would be better if we had some differentiation in the stdlib and other big libraries, rather than (mostly) <code>names_like_this</code> for pretty much every kind of entity, which as this thread shows, can make it difficult to understand what&#39;s going on."}], "tags": [], "owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "is_accepted": true, "score": 7, "last_activity_date": 1554904747, "last_edit_date": 1554904747, "creation_date": 1473260399, "answer_id": 39373325, "question_id": 39373008, "link": "https://stackoverflow.com/questions/39373008/how-can-returning-a-type-instead-of-a-object-be-valid-misunderstanding-a-code-f/39373325#39373325", "title": "how can returning a type instead of a object be valid, misunderstanding a code fragment", "body": "<pre><code>template &lt;class T, T... Chrs&gt;\nauto operator\"\"_t() BOOST_MSM_LITE_NOEXCEPT {\n    return event&lt;aux::string&lt;Chrs...&gt;&gt;;       // ??? How this can work?\n}\n</code></pre>\n\n<p>It works because this operator is not returning a type, but an instance of the template variable <code>event</code>, which is defined in <a href=\"https://github.com/boost-experimental/sml/blob/f636c05cb1a483e5131348d59d6151453ca3f9f2/include/boost/msm-lite.hpp#L1536-L1537\" rel=\"nofollow noreferrer\">line 1536</a>:</p>\n\n<pre><code>template &lt;class TEvent&gt;\ndetail::event&lt;TEvent&gt; event{};\n</code></pre>\n\n<p>Template variables were only introduced in C++14, which is likely why this was harder for you to find and understand. Also note that the _s operator relies on <a href=\"https://github.com/boost-experimental/sml/blob/f636c05cb1a483e5131348d59d6151453ca3f9f2/include/boost/msm-lite.hpp#L1542-L1543\" rel=\"nofollow noreferrer\"><code>state</code></a>, which is not a template variable (thus why it has to be instantiated at the operator function).</p>\n"}], "owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 39373325, "answer_count": 1, "score": 4, "last_activity_date": 1554904747, "creation_date": 1473259510, "last_edit_date": 1554904699, "question_id": 39373008, "link": "https://stackoverflow.com/questions/39373008/how-can-returning-a-type-instead-of-a-object-be-valid-misunderstanding-a-code-f", "title": "how can returning a type instead of a object be valid, misunderstanding a code fragment", "body": "<p>I tried out boost msm lite which is a very nice state machine implementation. As always I try to understand how it is working and found a code fragment which I can't understand.</p>\n\n<p>As a remark: I would not post the whole file from boost here, it is here: <a href=\"https://github.com/boost-experimental/sml/blob/f636c05cb1a483e5131348d59d6151453ca3f9f2/include/boost/msm-lite.hpp\" rel=\"nofollow noreferrer\">https://github.com/boost-experimental/sml/blob/f636c05cb1a483e5131348d59d6151453ca3f9f2/include/boost/msm-lite.hpp</a></p>\n\n<p>The test code only for understanding the things behind the curtain:</p>\n\n<pre><code> auto x2 = \"test\"_t;  //compiles fine!\n</code></pre>\n\n<p>That should go to this code fragment:</p>\n\n<pre><code> template &lt;class T, T... Chrs&gt;\n auto operator\"\"_t() BOOST_MSM_LITE_NOEXCEPT {\n      return event&lt;aux::string&lt;Chrs...&gt;&gt;;       // ??? How this can work?\n }\n</code></pre>\n\n<p>My (mis)understanding here is, that it will return the <code>type</code> instead of a instance of the type? But it compiles... why?</p>\n\n<p><code>event</code> is defined as:</p>\n\n<pre><code>template &lt;class&gt;\nstruct event {\n\n    template &lt;class T, BOOST_MSM_LITE_REQUIRES(concepts::callable&lt;bool, T&gt;::value)&gt;\n        auto operator[](const T &amp;t) const BOOST_MSM_LITE_NOEXCEPT {\n            return transition_eg&lt;event, T&gt;{*this, t};\n        }                                                                           template &lt;class T, BOOST_MSM_LITE_REQUIRES(concepts::callable&lt;void, T&gt;::value)&gt;\n        auto operator/(const T &amp;t) const BOOST_MSM_LITE_NOEXCEPT {\n            return transition_ea&lt;event, T&gt;{*this, t}; \n        }   \n};\n</code></pre>\n\n<p>The following example compiles fine:</p>\n\n<pre><code>#include &lt;cassert&gt;\n#include &lt;iostream&gt;\n#include \"boost/msm-lite.hpp\"\nnamespace msm = boost::msm::lite;\n\nint main()\n{\n    using namespace msm;\n    auto x1 = \"idle\"_s;\n    auto x2 = \"test\"_t;\n}\n</code></pre>\n"}, {"tags": ["c++", "algorithm", "gmp"], "comments": [{"owner": {"reputation": 62673, "user_id": 492336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/UjW5c.png?s=128&g=1", "display_name": "sashoalm", "link": "https://stackoverflow.com/users/492336/sashoalm"}, "edited": false, "score": 0, "creation_date": 1473259469, "post_id": 39372912, "comment_id": 66073956, "body": "Can you post the call stack after it has crashed? A screenshot would do. Also post the line of code calling the crashed function, and the arguments you pass to it (their values as the debugger shows them)."}, {"owner": {"reputation": 717, "user_id": 5309828, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9b1d938c6c7dca82919b3e00d5d43c14?s=128&d=identicon&r=PG&f=1", "display_name": "a concerned citizen", "link": "https://stackoverflow.com/users/5309828/a-concerned-citizen"}, "reply_to_user": {"reputation": 62673, "user_id": 492336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/UjW5c.png?s=128&g=1", "display_name": "sashoalm", "link": "https://stackoverflow.com/users/492336/sashoalm"}, "edited": false, "score": 0, "creation_date": 1473260871, "post_id": 39372912, "comment_id": 66075047, "body": "@sashoalm I don&#39;t really understand the 2nd part, but <code>f()</code> is called inside <code>main()</code>, at <code>roots[k] = initial[k] - ...</code>, and the debugger points inside the definition of <code>f()</code>, at <code>sum += static_cast...</code>. The values shown by the debugger are of mixed sort, I have to keep on expanding every line for every value, it goes something like <code>coeff &gt; [0] &gt; mp &gt; [0]</code> and there are <code>_mp_alloc</code>, <code>_mp_size</code> and <code>_mp_d</code>."}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1473270742, "post_id": 39372912, "comment_id": 66080604, "body": "&quot;warning: comparison of unsigned expression &gt;= 0 is always true&quot; first fix all the warnings? And don&#39;t use unsigned types."}, {"owner": {"reputation": 717, "user_id": 5309828, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9b1d938c6c7dca82919b3e00d5d43c14?s=128&d=identicon&r=PG&f=1", "display_name": "a concerned citizen", "link": "https://stackoverflow.com/users/5309828/a-concerned-citizen"}, "reply_to_user": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1473271610, "post_id": 39372912, "comment_id": 66081023, "body": "@MarcGlisse I must have missed that between the errors. As soon as I replaced all <code>unsigned</code> it didn&#39;t crash anymore. There are wrong results, but that&#39;s my doing now. Thank you for the solution. If you&#39;d post this as an answer, I&#39;ll mark it down."}], "answers": [{"comments": [{"owner": {"reputation": 717, "user_id": 5309828, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9b1d938c6c7dca82919b3e00d5d43c14?s=128&d=identicon&r=PG&f=1", "display_name": "a concerned citizen", "link": "https://stackoverflow.com/users/5309828/a-concerned-citizen"}, "edited": false, "score": 0, "creation_date": 1473271988, "post_id": 39376624, "comment_id": 66081210, "body": "I am using big ints, longer than <code>long long</code>, but GMP should more than cover that. At any rate, it&#39;s working now, though not for high order polynomials, but that&#39;s another question if I don&#39;t fix it."}], "tags": [], "owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "is_accepted": true, "score": 2, "last_activity_date": 1473273741, "last_edit_date": 1473273741, "creation_date": 1473271822, "answer_id": 39376624, "question_id": 39372912, "link": "https://stackoverflow.com/questions/39372912/c-durand-kerner-root-finding-algorithm-crashes-with-gmp-but-not-with-long-dou/39376624#39376624", "title": "C++ Durand-Kerner root finding algorithm crashes with GMP, but not with long double", "body": "<p>Gcc can point out one important issue:</p>\n\n<pre><code>a.cc: In function \u2018cplx f(const std::vector&lt;__gmp_expr&lt;__mpz_struct [1], __mpz_struct [1]&gt; &gt;&amp;, const cplx&amp;)\u2019:\na.cc:40:40: warning: comparison of unsigned expression &gt;= 0 is always true [-Wtype-limits]\n     for (unsigned int k=coeff.size(); k&gt;=0; --k)\n                                       ~^~~\n</code></pre>\n\n<p>Unsigned types should be avoided, unless you are creating your own bigint type (or possibly using a bitfield) and know what you are doing.</p>\n"}], "owner": {"reputation": 717, "user_id": 5309828, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9b1d938c6c7dca82919b3e00d5d43c14?s=128&d=identicon&r=PG&f=1", "display_name": "a concerned citizen", "link": "https://stackoverflow.com/users/5309828/a-concerned-citizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 39376624, "answer_count": 1, "score": 3, "last_activity_date": 1473273741, "creation_date": 1473259254, "last_edit_date": 1473259949, "question_id": 39372912, "link": "https://stackoverflow.com/questions/39372912/c-durand-kerner-root-finding-algorithm-crashes-with-gmp-but-not-with-long-dou", "title": "C++ Durand-Kerner root finding algorithm crashes with GMP, but not with long double", "body": "<p>I am trying a root-finding algorithm based on <a href=\"https://en.wikipedia.org/wiki/Durand%E2%80%93Kerner_method\" rel=\"nofollow\">Durand-Kerner</a> and I need it for polynomials of orders maybe up to 50, with coefficients that go beyond <code>long double</code> or <code>long long</code>, so I am trying (for the 1st time) <a href=\"https://gmplib.org/\" rel=\"nofollow\">GMP</a>.</p>\n\n<p>Now, I made this program as a test, which is why the <code>main()</code> is as it is (plus I am not an advanced programmer), and it works if I don't involve GMP, so I think it's something in my implementation that makes it crash. With Codeblock's debugger it points to some lines inside <code>gmpxx.h</code> and at the function <code>f()</code>, the line with the <code>sum +=</code>.</p>\n\n<p>Here's the code, minus the polynomial coefficient generation (here a simple loop):</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;   // std::vector\n#include &lt;complex&gt;\n#include &lt;cmath&gt;\n#include &lt;iomanip&gt;  // std::setprecision\n#include &lt;gmpxx.h&gt;\n\ntypedef std::complex&lt;mpf_class&gt; cplx;\n\n// x!\nmpz_class fact(const unsigned int &amp;x)\n{\n    mpz_class z {1};\n    for (unsigned int i=1; i&lt;=x; ++i)\n        z *= i;\n    return z;\n}\n\n// 2^n\nmpz_class pwr2(const unsigned int &amp;n)\n{\n    mpz_class z {1};\n    for (unsigned int i=0; i&lt;n; ++i)\n        z *= 2;\n    return (n == 0 ? 1 : z);\n}\n\nvoid bessel(std::vector&lt;mpz_class&gt; &amp;a, const unsigned int &amp;N)\n{\n    for (unsigned int i=0; i&lt;=N; ++i)\n        a[i] = fact(N + i) / fact(N - i) / fact(i) / pwr2(i);\n    //return *a;\n}\n\n// Definition for f(x), will be called for every iteration\ncplx f(const std::vector&lt;mpz_class&gt; &amp;coeff, const cplx &amp;xterm)\n{\n    cplx sum {0, 0};\n    cplx factor {1, 0};\n    for (unsigned int k=coeff.size(); k&gt;=0; --k)\n    {\n        sum += static_cast&lt;cplx&gt;(coeff[k]) * factor;\n        factor *= xterm;\n        std::cout&lt;&lt;sum&lt;&lt;'\\n';\n    }\n    return sum;\n}\n\n// Denominator, product of differences. root is the current root's value\ncplx prod(const std::vector&lt;cplx&gt; &amp;roots, const cplx &amp;root)\n{\n    cplx product {1.0, 0};\n    for (unsigned int k=0; k&lt;roots.size(); ++k)\n    {\n        // Skip if an element of the matrix == current root\n        if (roots[k] == root)\n            product = product;\n        else\n            product *= root - roots[k];\n    }\n    return product;\n}\n\nint main()\n{\n    std::cout &lt;&lt; \"N=\";\n    unsigned int N;\n    double eps {1e-10}; // relative error\n    std::cin &gt;&gt; N;\n    std::cout &lt;&lt; std::setprecision(16);\n\n    // Declaring arrays for coefficients, initial and final roots\n    unsigned int arraySize {N + 1};\n    std::vector&lt;mpz_class&gt; coeffs;\n    std::vector&lt;cplx&gt; initial;\n    std::vector&lt;cplx&gt; roots;\n    coeffs.resize(arraySize);\n    initial.resize(arraySize);\n    roots.resize(arraySize);\n    // Keep track of number and maximum numbers of iterations.\n    unsigned int maxIter {200};\n    unsigned int iters {0};\n\n    for (unsigned int k=0; k&lt;arraySize; ++k)\n    {\n        coeffs[k] = k+1;\n        std::cout &lt;&lt; coeffs[k] &lt;&lt; \" \";\n    }\n    std::cout &lt;&lt; '\\n';\n\n    // Initialize the seed roots\n    for (unsigned int k=0; k&lt;N; ++k)\n        initial[k] = pow(cplx(0.6, 0.8), k);\n    // Temporary array to hold next iteration's values\n    bool delta[N];\n    mpf_class tmp[N];\n    while (iters &lt;= maxIter)\n    {\n        for (unsigned int k=0; k&lt;N; ++k)\n        {\n            roots[k] = initial[k] - f(coeffs, initial[k]) / prod(initial, initial[k]);\n        }\n        // Calculate the abs() average of the temporary roots\n        bool test {1};\n        for (unsigned int k=0; k&lt;N; ++k)\n        {\n            tmp[k] = fabs(initial[k] - roots[k]);\n            delta[k] = tmp[k] &lt;= eps;\n            test *= delta[k];\n            //test *= fabs(initial[k] - roots[k]) &lt;= eps;\n            //std::cout &lt;&lt; tmp[k] &lt;&lt; \" \";\n        }\n        //std::cout &lt;&lt; '\\n';\n        // Check if eps has been reached\n        if (test)\n            break;\n        // if not, initial roots take current roots' value\n        for (unsigned int k=0; k&lt;N; ++k)\n            initial[k] = roots[k];\n        ++iters;\n    }\n    /// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    for (unsigned short k=0; k&lt;N; ++k)\n        std::cout &lt;&lt; tmp[k] &lt;&lt; \" \";\n    std::cout &lt;&lt; \"\\n\\n\";\n    for (unsigned short k=0; k&lt;N; ++k)\n        std::cout &lt;&lt; initial[k] &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; iters &lt;&lt; \"\\n\";\n\n    return 0;\n}\n</code></pre>\n\n<p>The <code>std::cout</code> line in the <code>f()</code> function gets printed only if it's inside the loop, else it won't, so the error must have some connection, but I'm afraid it goes over my head. Can someone help me with the error? What gets me is that the whole algorithm works just fine with standard types.</p>\n\n<hr>\n\n<p>Here's the callstack:</p>\n\n<pre><code>#0 0x7ffff7951e00   __gmpf_set_z() (/usr/lib/libgmp.so.10:??)\n#1 0x404562 __gmp_set_expr&lt;__mpz_struct [1]&gt;(f=0x7fffffffe2f0, expr=...) (/usr/include/gmpxx.h:2114)\n#2 0x403661 __gmp_expr&lt;__mpf_struct [1], __mpf_struct [1]&gt;::__gmp_expr&lt;__mpz_struct [1], __mpz_struct [1]&gt;(this=0x7fffffffe2f0, expr=...) (/usr/include/gmpxx.h:1844)\n#3 0x401d5c f(coeff=std::vector of length 5, capacity 5 = {...}, xterm=...) (/home/xxx/Documents/cpp/Durand_Kerner_gmp/main.cpp:51)\n#4 0x40250f main() (/home/xxx/Documents/cpp/Durand_Kerner_gmp/main.cpp:112)\n</code></pre>\n\n<p>The program starts showing <code>N=</code>, input 4, for example.</p>\n"}, {"tags": ["c++", "mfc", "propertygrid"], "comments": [{"owner": {"reputation": 454, "user_id": 682537, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0d9841d5c680d13c0dcd8d90098f2e63?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/682537/jonathan"}, "edited": false, "score": 0, "creation_date": 1473259242, "post_id": 39372677, "comment_id": 66073760, "body": "Look into the ES_PASSWORD style. I think you can take the normal CEdit ctrl and modify its style so it will become a password box."}], "answers": [{"tags": [], "owner": {"reputation": 172, "user_id": 2666964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dX1GU.jpg?s=128&g=1", "display_name": "kissLife", "link": "https://stackoverflow.com/users/2666964/kisslife"}, "is_accepted": true, "score": 3, "last_activity_date": 1473260110, "creation_date": 1473260110, "answer_id": 39373227, "question_id": 39372677, "link": "https://stackoverflow.com/questions/39372677/how-to-insert-an-edit-box-into-cmfcpropertygridctrl-for-password-usage/39373227#39373227", "title": "How to insert an edit box into CMFCPropertyGridCtrl for password usage?", "body": "<p>Derive a new class from <code>CMFCPropertyGridProperty</code> and override two functions: <code>OnDrawValue()</code> and <code>CreateInPlaceEdit()</code>.</p>\n\n<p>The code prototype may look like this:</p>\n\n<pre><code>void CMyGridProperty::OnDrawValue(CDC* pDC, CRect rect)\n{\n    // pre-processing\n    // ...\n\n    CString strVal = FormatProperty();\n    if(!strVal.IsEmpty())\n    {\n        strVal = _T(\"******\");  // NOTE: replace the plain text with \"******\"\n    }\n    rect.DeflateRect(AFX_TEXT_MARGIN, 0);\n    pDC-&gt;DrawText(strVal, rect, DT_LEFT | DT_SINGLELINE | DT_VCENTER | DT_NOPREFIX | DT_END_ELLIPSIS);\n\n    // post-processing\n    // ...\n}\n\nCWnd* CMyGridProperty::CreateInPlaceEdit(CRect rectEdit, BOOL&amp; bDefaultFormat)\n{\n    // pre-processing\n    // ...\n\n    CEdit* pWndEdit = new CEdit;\n    DWORD dwStyle = WS_VISIBLE | WS_CHILD | ES_AUTOHSCROLL | ES_PASSWORD;   // NOTE: add 'ES_PASSWORD' style here\n    pWndEdit-&gt;Create(dwStyle, rectEdit, m_pWndList, AFX_PROPLIST_ID_INPLACE);\n\n    // post-processing\n    // ...\n\n    return pWndEdit;\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6792005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f2ab6d7450b3354edfeb5cc305cd52?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/6792005/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 1, "accepted_answer_id": 39373227, "answer_count": 1, "score": 1, "last_activity_date": 1473260110, "creation_date": 1473258590, "question_id": 39372677, "link": "https://stackoverflow.com/questions/39372677/how-to-insert-an-edit-box-into-cmfcpropertygridctrl-for-password-usage", "title": "How to insert an edit box into CMFCPropertyGridCtrl for password usage?", "body": "<p>I want to insert an edit box into CMFCPropertyGridCtrl for inputting password. But the CMFCPropertyGridProperty can only create normal edit box. How can i create a new one for password usage ?</p>\n"}, {"tags": ["c++", "concurrency", "locking", "mutex"], "comments": [{"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 13, "creation_date": 1473258285, "post_id": 39372486, "comment_id": 66072975, "body": "the mutex doesn&#39;t lock any variables, it merely blocks a thread that&#39;s trying to acquire it. This has the effect of protecting variables if the program only accesses them between a <code>lock()</code> and <code>unlock()</code> call. The presence of the mutex <code>lock()</code> and <code>unlock()</code> in the code also prevents the compiler from re-ordering memory access of variable <i>accesses</i> thus protected."}, {"owner": {"reputation": 4718, "user_id": 152359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9462dee3e00416ea83771eead7902e1c?s=128&d=identicon&r=PG", "display_name": "Hayt", "link": "https://stackoverflow.com/users/152359/hayt"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 3, "creation_date": 1473258510, "post_id": 39372486, "comment_id": 66073175, "body": "You also need to make sure that the threads use the same mutex object. Having a different mutex in each thread will do nothing. Instead it blocks if another thread tries to lock an already locked mutex like @RichardHodges described."}, {"owner": {"reputation": 1048, "user_id": 5178988, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/8a2d5605e6a40cca41971150fd02bfe3?s=128&d=identicon&r=PG&f=1", "display_name": "niko", "link": "https://stackoverflow.com/users/5178988/niko"}, "edited": false, "score": 0, "creation_date": 1473258929, "post_id": 39372486, "comment_id": 66073528, "body": "Thanks, that really cleared it!"}], "answers": [{"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 1, "last_activity_date": 1473263983, "last_edit_date": 1473263983, "creation_date": 1473258525, "answer_id": 39372655, "question_id": 39372486, "link": "https://stackoverflow.com/questions/39372486/how-does-a-c-stdmutex-bind-to-a-resource/39372655#39372655", "title": "How does a C++ std::mutex bind to a resource?", "body": "<p>In terms of resource usage, the compiler couldn't care less about <code>mutex.lock()</code>. It is programmers duty to ensure that resource access is happening within proper locking/unlocking.</p>\n\n<p>However, the compiler cares about a mutex in a way that it knows not to optimize away certain constructs which it would otherwise - but you are probably not interested in this right now.</p>\n"}, {"tags": [], "owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "is_accepted": false, "score": 7, "last_activity_date": 1473258570, "creation_date": 1473258570, "answer_id": 39372672, "question_id": 39372486, "link": "https://stackoverflow.com/questions/39372486/how-does-a-c-stdmutex-bind-to-a-resource/39372672#39372672", "title": "How does a C++ std::mutex bind to a resource?", "body": "<p>\"mutex\" is short for \"mutual exclusion\"; the proper discipline for using a mutex is to lock it before entering any code that modifies variables that are shared between threads and to unlock it when that section of code is done. If one thread locks the mutex, any other thread that tries to lock it will be blocked until the thread that owns the mutex unlocks it. That means that only one thread at a time is inside code that can modify the shared variables, and that eliminates race conditions.</p>\n\n<p>The rest of what a mutex does relies on compiler magic at some level: it also prevents the compiler from moving loads and stores of data from inside the protected code to outside it, and vice versa, which is necessary for the protected code to stay protected.</p>\n"}, {"comments": [{"owner": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "edited": false, "score": 0, "creation_date": 1473293060, "post_id": 39373028, "comment_id": 66089177, "body": "Because I&#39;ve been burned by treating mutex and binary semaphore as interchangable, there is a difference.  In many threading libraries (such as pthreads), a mutex may only be unlocked by the thread that locked it, while a semaphore can be &quot;unlocked&quot; by any thread."}], "tags": [], "owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "is_accepted": false, "score": 3, "last_activity_date": 1473259551, "creation_date": 1473259551, "answer_id": 39373028, "question_id": 39372486, "link": "https://stackoverflow.com/questions/39372486/how-does-a-c-stdmutex-bind-to-a-resource/39373028#39373028", "title": "How does a C++ std::mutex bind to a resource?", "body": "<p>A mutex is a particular implementation of a <a href=\"https://en.wikipedia.org/wiki/Semaphore_(programming)\" rel=\"nofollow\">semaphore</a>. In particular it's a <em>binary</em> semaphore.</p>\n\n<p>A semaphore (obviously in a computer science context) can be implemented as a integer variable and hardware or software (operative system) <em>primitive</em> which are <em>atomic</em> (cannot be interrupted).</p>\n\n<p>Imagine something <em>like</em>  (pseudo-hight level code):</p>\n\n<pre><code>int mutex = 1;  // The mutex is free when created (free=1, occupied=0).\n\n// in a concurrency block\n{\n  :try-again\n\n  // test if mutex is 1 (is free).\n  if (mutex &gt; 0) {\n\n    // mutex WAS free so now I set as occupied (set 0)\n    --mutex;\n    // Now I've 'acquired' the mutex and since the mutex is 0 or 1\n    // only me can be here.\n\n    // Do something in mutual exclusion\n    // Done.\n    // Unlock the mutex\n    ++mutex;\n    // Now the mutex is free so other threads can acquire it.\n\n  } else {\n    // Mutex is 0 so I tried but it's already occupied.\n    // Block the thread and try again.\n    goto try-again;\n  }\n\n}\n</code></pre>\n\n<p>Obvious in a pure high-level language, that approach cannot work because a thread could be interrupted after it has tested the mutex is free and before it can set as occupied.</p>\n\n<p>For that reason the semaphores and so mutex are implemented with the aid of primitive instructions which implement those \"test and set\" operation in \"one clock\" (atomically).</p>\n\n<p>An example is the <a href=\"https://en.wikipedia.org/wiki/Test-and-set\" rel=\"nofollow\"><code>test-and-set</code></a> primitive.</p>\n"}, {"comments": [{"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 4, "creation_date": 1473273131, "post_id": 39373223, "comment_id": 66081712, "body": "Your last sentence is an understatement. :)"}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": true, "score": 17, "last_activity_date": 1473263916, "last_edit_date": 1473263916, "creation_date": 1473260102, "answer_id": 39373223, "question_id": 39372486, "link": "https://stackoverflow.com/questions/39372486/how-does-a-c-stdmutex-bind-to-a-resource/39373223#39373223", "title": "How does a C++ std::mutex bind to a resource?", "body": "<p>Given that <code>m</code> is a variable of type <code>std::mutex</code>:</p>\n\n<p>Imagine this sequence:</p>\n\n<pre><code>int a;\nm.lock();\nb += 1;\na = b;\nm.unlock();\ndo_something_with(a);\n</code></pre>\n\n<p>There is an 'obvious' thing going on here:</p>\n\n<p>The assignment of a from b and the increment of b is 'protected' from interference from other threads, because other threads will attempt to lock the same <code>m</code> and will be blocked until we call <code>m.unlock()</code>.</p>\n\n<p><strong>And there is a more subtle thing going on.</strong></p>\n\n<p>In single-threaded code, the compiler will seek to re-order loads and stores. Without the locks, the compiler would be free to effectively re-write your code if this turned out to be more efficient on your chipset:</p>\n\n<pre><code>int a = b + 1;\n//    m.lock();\nb = a;\n//    m.unlock();\ndo_something_with(a);\n</code></pre>\n\n<p>Or even:</p>\n\n<pre><code>do_something_with(++b);\n</code></pre>\n\n<p>However, <code>std::mutex::lock()</code>, <code>unlock()</code>, <code>std::thread()</code>, <code>std::async()</code>, <code>std::future::get()</code> and so on are <em>fences</em>. The compiler 'knows' that it may not reorder loads and stores (reads and writes) in such a way that the operation ends up on the other side of the fence from where you specified when you wrote the code.</p>\n\n<pre><code>1:\n2:    m.lock(); &lt;--- This is a fence\n3:    b += 1;   &lt;--- So this load/store operation may not move above line 2\n4:    m.unlock(); &lt;-- Nor may it be moved below this line\n</code></pre>\n\n<p>Imagine what would happen if this wasn't the case:</p>\n\n<p>(Reordered code)</p>\n\n<pre><code>thread1: int a = b + 1;\n  &lt;--- Here another thread precedes us and executes the same block of code\n  thread2: int a = b + 1;\n  thread2: m.lock();\n  thread2: b = a;\n  thread2: m.unlock();\nthread1: m.lock();\nthread1: b = a;\nthread1: m.unlock();\nthread1:do_something_with(a);\nthread2:do_something_with(a);\n</code></pre>\n\n<p>If you follow it through, you'll see that b now has the wrong value in it, because the compiler was tying to make your code faster.</p>\n\n<p>...and that's only the compiler optimisations. <code>std::mutex</code>, etc. also prevents the memory caches from reordering loads and stores in a more 'optimal' way, which would be fine in a single-threaded environment but disastrous in a multi-core (i.e. any modern PC or phone) system.</p>\n\n<p>There is a cost for this safety, because thread A's cache must be flushed before thread B reads the same data, and flushing caches to memory is hideously slow compared to cached memory access. But c'est la vie. It's the only way to make concurrent execution safe.</p>\n\n<p>This is why we prefer that, if possible, in an SMP system, each thread has its own copy of data on which to work. We want to minimise not only the time spent in a lock, but also the number of times we cross a fence.</p>\n\n<p>I could go on to talk about the <code>std::memory_order</code> modifiers, but that is a dark and dangerous hole, which experts often get wrong and in which beginners have no hope of getting it right.</p>\n"}, {"comments": [{"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 1, "creation_date": 1473260614, "post_id": 39373384, "comment_id": 66074862, "body": "the cleverness is in the fact that the compiler&#39;s optimiser and code generator recognise and respect the implied memory fences."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1473305056, "post_id": 39373384, "comment_id": 66091697, "body": "Never mind that without walls you don&#39;t have very much of a house."}], "tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 3, "last_activity_date": 1473260547, "creation_date": 1473260547, "answer_id": 39373384, "question_id": 39372486, "link": "https://stackoverflow.com/questions/39372486/how-does-a-c-stdmutex-bind-to-a-resource/39373384#39373384", "title": "How does a C++ std::mutex bind to a resource?", "body": "<p>There's no such cleverness at all, and making it work correctly is the programmer's responsibility.</p>\n\n<p>A mutex is like a lockable door on a house that has no walls.  </p>\n\n<p>All you can do with it is prevent others from entering the house <em>through the door</em> when it's locked.<br>\nThe door is only useful if everyone agrees to exclusively enter the house through the door, and that when the door is locked wait for the person inside to unlock the door and exit.<br>\nNothing prohibits a bad person from entering the house through the non-existent walls except the agreement that you shouldn't.</p>\n"}], "owner": {"reputation": 1048, "user_id": 5178988, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/8a2d5605e6a40cca41971150fd02bfe3?s=128&d=identicon&r=PG&f=1", "display_name": "niko", "link": "https://stackoverflow.com/users/5178988/niko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2536, "favorite_count": 1, "accepted_answer_id": 39373223, "answer_count": 5, "score": 16, "last_activity_date": 1473263983, "creation_date": 1473258124, "last_edit_date": 1473262804, "question_id": 39372486, "link": "https://stackoverflow.com/questions/39372486/how-does-a-c-stdmutex-bind-to-a-resource", "title": "How does a C++ std::mutex bind to a resource?", "body": "<p>Does the compiler simply check which variables are being modified between the lock and unlock statements and bind them to the mutex so there is exclusive access to them?</p>\n\n<p>Or does a <code>mutex.lock()</code> lock all resources which are visible in the current scope?</p>\n"}, {"tags": ["c++", "list", "qt", "qml", "repeater"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6804774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVYjC.jpg?s=128&g=1", "display_name": "Spatz", "link": "https://stackoverflow.com/users/6804774/spatz"}, "edited": false, "score": 0, "creation_date": 1473772153, "post_id": 39377196, "comment_id": 66261141, "body": "Hi follbis, first of all thank you for your reply. Your implementation looks exactly like mine. I edited my question including my model.  As you can see there I am returning the list of X and Y points.  I am struggling because x: and y: (in delegate:Rectangle) cannot handle a list of points like <i>xcoord</i> and <i>ycoord</i> but only a simple int or float. Do you agree? Thx again"}, {"owner": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "reply_to_user": {"reputation": 21, "user_id": 6804774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVYjC.jpg?s=128&g=1", "display_name": "Spatz", "link": "https://stackoverflow.com/users/6804774/spatz"}, "edited": false, "score": 0, "creation_date": 1473774066, "post_id": 39377196, "comment_id": 66262414, "body": "There is no problem to return QPoint instead of int"}, {"owner": {"reputation": 21, "user_id": 6804774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVYjC.jpg?s=128&g=1", "display_name": "Spatz", "link": "https://stackoverflow.com/users/6804774/spatz"}, "edited": false, "score": 0, "creation_date": 1473780244, "post_id": 39377196, "comment_id": 66266625, "body": "Yes, but the problem is to handle a list of QPoints instead of a single one.  x: and y: properties seem not to handle a list.  &lt; <a href=\"http://doc.qt.io/qt-5/qml-qtquick-item.html#x-prop\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/qml-qtquick-item.html#x-prop</a> &gt;"}, {"owner": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "reply_to_user": {"reputation": 21, "user_id": 6804774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVYjC.jpg?s=128&g=1", "display_name": "Spatz", "link": "https://stackoverflow.com/users/6804774/spatz"}, "edited": false, "score": 0, "creation_date": 1473832483, "post_id": 39377196, "comment_id": 66285160, "body": "I didn&#39;t exactly understand that. Assuming  <code>MyModel::data()</code> returns QPoint, is <code>x: point.x; y: point.y</code> is what you want to achieve? A model handles list but <code>data()</code> should return only single item from the list."}, {"owner": {"reputation": 21, "user_id": 6804774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVYjC.jpg?s=128&g=1", "display_name": "Spatz", "link": "https://stackoverflow.com/users/6804774/spatz"}, "edited": false, "score": 0, "creation_date": 1473840499, "post_id": 39377196, "comment_id": 66289121, "body": "Hi folibis, what I want to achieve is slightly different.  <b>For each instance (mymodel)</b> of MyModel I would like to display a list of related points <b>at the same time</b>.  i.e. : mymodel1 has these related points (1,2), (3,4)        mymodel2 has these ones (5,6), (7,8), (9,9) and so on.   My impression now is that for each mymodel instance I can display only 1 point. Thanks for your time"}, {"owner": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "reply_to_user": {"reputation": 21, "user_id": 6804774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVYjC.jpg?s=128&g=1", "display_name": "Spatz", "link": "https://stackoverflow.com/users/6804774/spatz"}, "edited": false, "score": 0, "creation_date": 1473852440, "post_id": 39377196, "comment_id": 66296115, "body": "Ok, in other words, you want <code>data()</code> will return <code>QList&lt;QPoint&gt;</code>, right?"}, {"owner": {"reputation": 21, "user_id": 6804774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVYjC.jpg?s=128&g=1", "display_name": "Spatz", "link": "https://stackoverflow.com/users/6804774/spatz"}, "edited": false, "score": 0, "creation_date": 1473861767, "post_id": 39377196, "comment_id": 66302457, "body": "If there&#39;s an easy way to draw QList&lt;QPoint&gt; in QML, yes.  What I&#39;m currently doing is exposing xCoordinatesList and yCoordinatesList from C++ to QML and it works.   So xCoordinatesList can be something like: [5,7,9] and yCoordinatesList: [6,8,9]. I can clearly log these arrays on a qml file but I&#39;m not able to use them!  Would it be simpler exposing  QList&lt;QPoint&gt; from C++ to QML? Which block should I use to draw all the points in the list at the same time?  I think that QList&lt;QPoint&gt; is exposable in C++ since: QPoint can be QVariant and QList&lt;QVariant&gt; can be QVariant it self. Thx"}], "tags": [], "owner": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "is_accepted": false, "score": 0, "last_activity_date": 1473274612, "last_edit_date": 1473274612, "creation_date": 1473274308, "answer_id": 39377196, "question_id": 39372314, "link": "https://stackoverflow.com/questions/39372314/how-to-display-values-from-lists-in-a-ui-qml-qt-inside-a-repeater/39377196#39377196", "title": "How to display values from lists in a UI QML (QT) inside a Repeater", "body": "<p>The Qt documentation is very clear. The first you have to read is <a href=\"http://doc.qt.io/qt-5/qtquick-modelviewsdata-modelview.html\" rel=\"nofollow\">that article</a>. I think that in your case the simpliest way is <a href=\"http://doc.qt.io/qt-5/qtquick-modelviewsdata-cppmodels.html#qobjectlist-based-model\" rel=\"nofollow\">list-based model</a>. Or, of cource, you can subclass <a href=\"http://doc.qt.io/qt-5/qabstractitemmodel.html\" rel=\"nofollow\">QAbstractListModel</a>.</p>\n\n<p>Your question is not so clear and you didn't provide the code of your model but maybe this small example will help you:</p>\n\n<p><strong>Declaration</strong></p>\n\n<pre><code>    class MyModel : public QAbstractListModel\n    {\n        Q_OBJECT\n    public:\n        enum PointRoles {\n                  XRole = Qt::UserRole + 1,\n                  YRole\n              };\n        MyModel(QObject *parent = Q_NULLPTR);\n        int rowCount(const QModelIndex &amp;parent = QModelIndex()) const;\n        QVariant data(const QModelIndex &amp;index, int role = Qt::DisplayRole) const;\n        QHash&lt;int, QByteArray&gt; roleNames() const;\n\n    private:\n        QList&lt;QPoint&gt; m_list;\n    };\n</code></pre>\n\n<p><strong>Implementation</strong></p>\n\n<pre><code>MyModel::MyModel(QObject *parent) :\n    QAbstractListModel(parent)\n{\n}\n\nQHash&lt;int, QByteArray&gt; MyModel::roleNames() const {\n     QHash&lt;int, QByteArray&gt; roles;\n     roles[XRole] = \"xcoord\";\n     roles[YRole] = \"ycoord\";\n     return roles;\n }\n\nint MyModel::rowCount(const QModelIndex &amp;parent) const\n{\n    Q_UNUSED(parent);\n    return m_list.count();\n}\n\nQVariant MyModel::data(const QModelIndex &amp;index, int role) const\n{\n    if(role == XRole)\n        return m_list[index.row()].x();\n    else if(role == YRole)\n        return m_list[index.row()].y();\n\n    return QVariant();\n}\n</code></pre>\n\n<p><strong>Registation</strong></p>\n\n<pre><code>qmlRegisterType&lt;MyModel&gt;(\"qt.test\", 1, 0, \"PointModel\");\n</code></pre>\n\n<p><strong>Usage</strong></p>\n\n<pre><code>Window {\n    visible: true\n    width: 800\n    height: 800\n    PointModel {id: mymodel}\n    Repeater {\n        model: mymodel\n        delegate: Rectangle {\n            x: 100 + xcoord\n            y: 100 + ycoord\n            width: 20\n            height: 20\n            color: \"red\"\n            radius: 10\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 6804774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVYjC.jpg?s=128&g=1", "display_name": "Spatz", "link": "https://stackoverflow.com/users/6804774/spatz"}, "is_accepted": true, "score": 0, "last_activity_date": 1474028519, "creation_date": 1474028519, "answer_id": 39531413, "question_id": 39372314, "link": "https://stackoverflow.com/questions/39372314/how-to-display-values-from-lists-in-a-ui-qml-qt-inside-a-repeater/39531413#39531413", "title": "How to display values from lists in a UI QML (QT) inside a Repeater", "body": "<p><strong>* SOLVED *</strong></p>\n\n<p>In your <strong>main.qml</strong> you can have something like this, which handles the global drawing routine.</p>\n\n<pre><code>    Repeater\n    {\n        model: dotModel\n        delegate:\n        DotPositionOnMap{}\n    }\n</code></pre>\n\n<p><strong>DotPositionOnMap.qml</strong> will read the list of x and y coordinates and for each element of both will create a dot Item object which will be displayed on the screen.</p>\n\n<pre><code>import QtQuick 2.5\n\nItem\n{\n\nid: dotPositionOnMap\nobjectName: \"dotoPositionOnMap\"\n\nComponent.onCompleted:\n{\n // yCoordinatesList would have given the same result\n var dotListLength = xCoordinatesList.length;\n\n// Dot properties can by handled dynamically\nvar dotWidth = 5;\nvar dotHeight = 5;\nvar dotRadius = 10;\nvar dotColor = \"red\"\n\n// For each entry of xCoordinatesList and yCoordinatesList\n// I generate a DotShape qml object that will display a dot on the screen\nfor(var i = 0; i &lt; dotListLength; i++)\n{\n\n    var currentXValue = xCoordinatesList[i];\n    var currentYValue = yCoordinatesList[i];\n    // x and y pixrl values for a DotShape.qml instance\n    var xPositionOnMap = currentXValue-(dotWidth/2);\n    var yPositionOnMap = currentYValue-(dotHeight/2);\n\n    // Creating DotShape.qml component\n    var comp = Qt.createComponent(\"DotShape.qml\");\n\n    var dotComponent = comp.createObject(dotPositionOnMap,\n                                           {\n                                               \"x\": xPositionOnMap,\n                                               \"y\": yPositionOnMap,\n                                               \"width\": dotWidth,\n                                               \"height\": dotHeight,\n                                               \"color\": dotColor,\n                                               \"radius\": dotRadius\n                                           });\n} // end for\n} // end script\n} // end Item\n</code></pre>\n\n<p>Finally <strong>DotShape.qml</strong> , which's just a small red dot plotted at x,y coordinate</p>\n\n<pre><code>import QtQuick 2.5\n\nRectangle\n{ \n// Other properties are generated at runtime\nid: dotShapeId;\nobjectName: \"dotShapeId\";\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6804774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVYjC.jpg?s=128&g=1", "display_name": "Spatz", "link": "https://stackoverflow.com/users/6804774/spatz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1193, "favorite_count": 0, "accepted_answer_id": 39531413, "answer_count": 2, "score": 0, "last_activity_date": 1474028519, "creation_date": 1473257719, "last_edit_date": 1473772419, "question_id": 39372314, "link": "https://stackoverflow.com/questions/39372314/how-to-display-values-from-lists-in-a-ui-qml-qt-inside-a-repeater", "title": "How to display values from lists in a UI QML (QT) inside a Repeater", "body": "<p>I've been facing this issue for days without coming to a conclusion, I hope someone could give me some useful hints to solve it.</p>\n\n<p>I'll try to simplify the issue with an example:</p>\n\n<ul>\n<li>In my C++ code I defined the class <strong>MyObjectModel</strong> that will act\nlater as a model in the <strong>Repeater</strong> block in my main <em>ui.qml</em> file.\nMyObjectModel is visible to the QQmlApplicationEngine.</li>\n<li><strong>MyObjectModel</strong>\nhas 2 attributes (lists) : xCoordinatesList and yCoordinatesList.\nThey represent the x and y pixel coordinates of a list of points.\nI.e. xCoordinatesList = [100, 200], yCoordinatesList = [10, 20] mean logically that I have 2 points with the following pixel coordinates that I want to display on the screen: (100,10), (10,20).</li>\n<li><p>The xCoordinatesList and yCoordinatesList are <strong>Roles</strong> of my model\nfor the <strong>QML engine</strong>.  This means for instance that in a common\n.qml file i can clearly print the content of xCoordinatesList by\ntyping:</p>\n\n<pre><code>Component.onCompleted\n{\n    console.log(\"x coordinates: \",xCoordinatesList);\n}\n</code></pre></li>\n</ul>\n\n<p><strong>The question is: how can I display at the same time the list of points on the screen?</strong></p>\n\n<p>If I want to display only one dot (so one couple of coordinates) my code works. I really don't know how to extend it to make it print all of them.</p>\n\n<p>In my <strong>MainForm.ui.qml</strong> I defined a <strong>Repeater</strong> inside a <strong>Rectangle</strong> :</p>\n\n<pre><code>Rectangle\n {\n ....\n            Repeater\n        {\n            model: dotModel\n\n             delegate:\n                 DotItem\n                 {\n                 id: dotItem;\n                 objectName: \"dotItem\";\n                 DotPositionOnMap\n                 {\n                     id: dotPositionId;\n                     objectWidth: dotItem.width;\n                     objectHeight: dotItem.height;\n                 }\n                 x: dotPositionId.xPositionOnMap;\n                 y: dotPositionId.yPositionOnMap;\n                 }\n         }\n....\n}\n</code></pre>\n\n<p>I need a Repeater because <strong>MyObjectModel</strong> which holds the two lists of x and y coordinates can dynamically change over time.\n<strong>dotModel</strong> is just a fake model I use for an other purpose.\n<strong>DotItem</strong>  is my qml Item that identifies the red dot circle image I want to depict on the screen for each couple of elements in xCoordinatesList, yCoordinatesList.</p>\n\n<p><strong>DotItem.ui.qml</strong></p>\n\n<pre><code>import QtQuick 2.4\nimport QtQuick.Layouts 1.1\n\nItem\n{\n    width:  10\n    height: 10\n    opacity: 1\n    Image\n    {\n      id: dotItemImage\n      anchors.fill: parent\n      source: \"red_dot.png\"\n    }   \n}\n</code></pre>\n\n<p><em>red_dot.png</em> image should be displayed for each point depicted on the screen.</p>\n\n<p><strong>DotPositionOnMap.qml</strong> is responsible for computing the right <em>x</em> and <em>y</em> pixel position on the screen.</p>\n\n<pre><code>import QtQuick 2.5\nimport \"calcCurrentPos_script.js\" as CurrentPos\n\nItem\n{\n// Values filled from MainForm.ui.qml\nproperty int objectWidth\nproperty int objectHeight\n\n// Getting current coordinates\n// Fetching element 0 from both lists\nproperty real currentx: CurrentPos.getCurrentxPoint(0);\nproperty real currenty: CurrentPos.getCurrentyPoint(0);\n\n// Generating the x and y pixel position on map.\n// Toy example\nproperty int xPositionOnMap : currentx-(objectWidth/2);\nproperty int yPositionOnMap : currenty-(objectHeight/2);\n}\n</code></pre>\n\n<p>Where <strong>calcCurrentPos_script.js</strong></p>\n\n<pre><code>function getCurrentxPoint(val)\n{\n    return xCoordinatesList[val];\n}\n\nfunction getCurrentyPoint(val)\n{\n    return yCoordinatesList[val];\n}\n</code></pre>\n\n<p>In this way I can only display one dot on the screen since I specify in <strong>DotPositionOnMap.qml</strong> which point to fetch:</p>\n\n<pre><code>// Fetching element 0 in this case\nproperty real currentx: CurrentPos.getCurrentxPoint(0);\nproperty real currenty: CurrentPos.getCurrentyPoint(0);\n</code></pre>\n\n<p>I used javascript for this attempt because I thought I could use a <em>for loop</em> to scan all the elements to be displayed, but it didn't work.</p>\n\n<p><strong>Extract of my model</strong></p>\n\n<pre><code>QVariant MyModelObject::data(const QModelIndex&amp; index, int role) const\n{\n    const MyModelObject&amp; object = objects.values().value(index.row());\n    ....\n    if(role == XRole)\n    {\n    QList&lt;TrackPoint&gt; tkrList = object.getList();\n    QList&lt;QVariant&gt; tkrVariantList;\n    for(auto track: trackpointList)\n        {\n        tkrVariantList.append(track.getPosition().getX());\n        }\n\n    return QVariant(tkrVariantList);\n    }\n    else if(role == YRole)\n    {\n    QList&lt;TrackPoint&gt; tkrList = object.getList();\n    QList&lt;QVariant&gt; tkrVariantList;\n    for(auto track: trackpointList)\n        {\n        tkrVariantList.append(track.getPosition().getY());\n        }\n    return QVariant(tkrVariantList);\n    }\n}\n\n....\n....\nQHash&lt;int, QByteArray&gt; MyModelObject::roleNames() const\n{\n  QHash&lt;int, QByteArray&gt; roles;\n  roles[XRole]        = \"xCoordinatesList\";\n  roles[YRole]      = \"yCoordinatesList\";\n  return roles;\n}\n</code></pre>\n\n<p>I truly appreciate any ideas concerning the generalisation of this implementation.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c++", "oop", "c++11", "constructor", "stl"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1781434"}, "edited": false, "score": 1, "creation_date": 1473257798, "post_id": 39372305, "comment_id": 66072564, "body": "If it would, it would not compile."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1473257840, "post_id": 39372305, "comment_id": 66072594, "body": "you can still define copy constructor &amp; assignment operator as private in your class."}, {"owner": {"reputation": 2214, "user_id": 4785903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d61c4afb483e6a17ea80aa4a91dc65ad?s=128&d=identicon&r=PG&f=1", "display_name": "hg_git", "link": "https://stackoverflow.com/users/4785903/hg-git"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1473257903, "post_id": 39372305, "comment_id": 66072647, "body": "@Jean-Fran&#231;oisFabre what would be the possible benefit? It still wouldn&#39;t be accessible, right?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1473257970, "post_id": 39372305, "comment_id": 66072692, "body": "you could never do <code>a1=a2</code> or <code>A a2(a1);</code> isn&#39;t what you want?"}, {"owner": {"reputation": 2214, "user_id": 4785903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d61c4afb483e6a17ea80aa4a91dc65ad?s=128&d=identicon&r=PG&f=1", "display_name": "hg_git", "link": "https://stackoverflow.com/users/4785903/hg-git"}, "edited": false, "score": 0, "creation_date": 1473257977, "post_id": 39372305, "comment_id": 66072697, "body": "@Tobias no subtle failures/undefined scenarios? I&#39;m quite skeptical of them atm with cpp given I&#39;m still learning it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1781434"}, "edited": false, "score": 0, "creation_date": 1473258216, "post_id": 39372305, "comment_id": 66072915, "body": "@hg_git No -- since all calls will be resolved by the compiler."}, {"owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "edited": false, "score": 0, "creation_date": 1473259928, "post_id": 39372305, "comment_id": 66074345, "body": "I didn&#39;t get if you want to avoid un-controlled copies or just make sure each copy has different id. In the last case you can create an unique-id for each copy."}, {"owner": {"reputation": 2214, "user_id": 4785903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d61c4afb483e6a17ea80aa4a91dc65ad?s=128&d=identicon&r=PG&f=1", "display_name": "hg_git", "link": "https://stackoverflow.com/users/4785903/hg-git"}, "reply_to_user": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "edited": false, "score": 0, "creation_date": 1473261885, "post_id": 39372305, "comment_id": 66075730, "body": "@BiagioFesta I&#39;ve said that option exists but what about <code>printerNum</code> then? It has to be unique and even if I assign 0 or something to it, that becomes entirely different object now. Now if I want to sort an vector, and what I get is a vector of entirely different objects, that&#39;s not a good way to do things..."}, {"owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "edited": false, "score": 0, "creation_date": 1473262115, "post_id": 39372305, "comment_id": 66075862, "body": "I cannot understand. <code>printNum</code> can be setted with a method?"}, {"owner": {"reputation": 2214, "user_id": 4785903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d61c4afb483e6a17ea80aa4a91dc65ad?s=128&d=identicon&r=PG&f=1", "display_name": "hg_git", "link": "https://stackoverflow.com/users/4785903/hg-git"}, "reply_to_user": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "edited": false, "score": 0, "creation_date": 1473264433, "post_id": 39372305, "comment_id": 66077377, "body": "@BiagioFesta There are atmost 3 printers (hardware device). Only 3 objects can exist at max holding access to those printers. Hence <code>printerNum</code>. <code>printerNum = 2</code> means 2nd printer."}], "answers": [{"comments": [{"owner": {"reputation": 2214, "user_id": 4785903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d61c4afb483e6a17ea80aa4a91dc65ad?s=128&d=identicon&r=PG&f=1", "display_name": "hg_git", "link": "https://stackoverflow.com/users/4785903/hg-git"}, "edited": false, "score": 0, "creation_date": 1473261985, "post_id": 39372424, "comment_id": 66075787, "body": "on operations like copy-construction or later, is it guaranteed that those two objects will not exist simultaneously after it completes? It should delete either the copy or original at the end right?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 2214, "user_id": 4785903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d61c4afb483e6a17ea80aa4a91dc65ad?s=128&d=identicon&r=PG&f=1", "display_name": "hg_git", "link": "https://stackoverflow.com/users/4785903/hg-git"}, "edited": false, "score": 0, "creation_date": 1473262587, "post_id": 39372424, "comment_id": 66076203, "body": "@hg_git, I am  not sure if I understand the question. Can you please clarify a bit?"}, {"owner": {"reputation": 2214, "user_id": 4785903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d61c4afb483e6a17ea80aa4a91dc65ad?s=128&d=identicon&r=PG&f=1", "display_name": "hg_git", "link": "https://stackoverflow.com/users/4785903/hg-git"}, "edited": false, "score": 0, "creation_date": 1473264546, "post_id": 39372424, "comment_id": 66077446, "body": "say I have an <code>vector</code> with 3 objects, with member <code>int a</code> <code>=</code> <code>1, 2 &amp; 3</code> respectively. During reallocation, there must be a time when copy constructor call will make a copy of say object with member <code>a = 1</code>. So at that moment, two identical objects exist, right? Considering value of member <code>a</code> determines the uniqueness."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 2214, "user_id": 4785903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d61c4afb483e6a17ea80aa4a91dc65ad?s=128&d=identicon&r=PG&f=1", "display_name": "hg_git", "link": "https://stackoverflow.com/users/4785903/hg-git"}, "edited": false, "score": 0, "creation_date": 1473269227, "post_id": 39372424, "comment_id": 66079880, "body": "@hg_git, it will try to move, so if your type implements move semantics, object will be moved, not copied. For non-movable objects, a copy would exist."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 3, "last_activity_date": 1473258360, "last_edit_date": 1473258360, "creation_date": 1473257977, "answer_id": 39372424, "question_id": 39372305, "link": "https://stackoverflow.com/questions/39372305/would-deleting-copy-constructor-assignment-break-standard-library-operations/39372424#39372424", "title": "would deleting copy constructor/assignment break standard library operations", "body": "<p>In C++11,  the requirements to the types used in the containers depend on  the operations you call.\nThe only thing which they require unconditionally is that type is <code>Erasable</code>, which, when used with standard allocator, is equivalent to requiring <code>p-&gt;~T()</code> to be well-formed and valid.</p>\n\n<p>So, copy-construction is required when vector is reallocated or copy-construction version of insert is used. Assignment is needed when, for example, elements are inserted in  the middle of the vector, or container is sorted.</p>\n\n<p>For example, here is a quote from <a href=\"http://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow\">http://en.cppreference.com/w/cpp/container/vector</a> on <code>vector</code>:</p>\n\n<blockquote>\n  <p>The requirements that are imposed on the elements depend on the actual\n  operations performed on the container. Generally, it is required that\n  element type is a complete type and meets the requirements of\n  Erasable, but many member functions impose stricter requirements.</p>\n</blockquote>\n"}], "owner": {"reputation": 2214, "user_id": 4785903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d61c4afb483e6a17ea80aa4a91dc65ad?s=128&d=identicon&r=PG&f=1", "display_name": "hg_git", "link": "https://stackoverflow.com/users/4785903/hg-git"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 39372424, "answer_count": 1, "score": 0, "last_activity_date": 1473258360, "creation_date": 1473257699, "last_edit_date": 1473257812, "question_id": 39372305, "link": "https://stackoverflow.com/questions/39372305/would-deleting-copy-constructor-assignment-break-standard-library-operations", "title": "would deleting copy constructor/assignment break standard library operations", "body": "<p>I have a few classes with requirements that their instances must not have similar copies at runtime. Let's say one of the class looks like -</p>\n\n<pre><code>class A{\n    int id;\n    int printerNum;\n\n    bool failState = true;\n    //....\n\npublic:\n    //....\n\n};\n</code></pre>\n\n<p>Now <code>id</code> and <code>printerNum</code> must be unique to each instance since no two instance can control same printer at a time. <code>id</code> is only generated at construction of the object but <code>printerNum</code> can change. For these two requirements, I provide checks at constructor and a <code>failState</code> variable which never initializes the object properly and sets the <code>failState</code> to true if something bad occurs.</p>\n\n<p>Also I was thinking of deleting the copy constructor and assignment operator to make sure a user never creates a copy and can only initialize it from constructor so that id and printerNum remain unique.</p>\n\n<p>But before making this change I was thinking of asking, would this break other algorithms and containers available inside the standard namespace? They might be using assignment operators and copy constructors often and what would happen if I delete these explicitly like - </p>\n\n<pre><code>// no copy\nA(const A&amp;) = delete;\n\n// no assign\nA&amp; operator=(const A&amp;) = delete;\n</code></pre>\n\n<p>If not possible, or there's another way to do this, I would welcome all suggestions. Thankyou :) </p>\n"}, {"tags": ["c++", "templates", "c++11"], "comments": [{"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 2, "creation_date": 1473257477, "post_id": 39372213, "comment_id": 66072334, "body": "any reason not to simply use a lambda?"}, {"owner": {"reputation": 2548, "user_id": 1745291, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a1cb774f2559ce8b8a6f4a5d2e33c4f6?s=128&d=identicon&r=PG", "display_name": "hl037_", "link": "https://stackoverflow.com/users/1745291/hl037"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1473257809, "post_id": 39372213, "comment_id": 66072571, "body": "readability and I&#39;d like to learn how to write such a template"}], "answers": [{"comments": [{"owner": {"reputation": 2548, "user_id": 1745291, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a1cb774f2559ce8b8a6f4a5d2e33c4f6?s=128&d=identicon&r=PG", "display_name": "hl037_", "link": "https://stackoverflow.com/users/1745291/hl037"}, "edited": false, "score": 0, "creation_date": 1473257884, "post_id": 39372309, "comment_id": 66072628, "body": "...I didn&#39;t asked how to do it with lambda, I did asked how to correct my template, since it&#39;s useful to know how to write such a template ;)"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 2548, "user_id": 1745291, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a1cb774f2559ce8b8a6f4a5d2e33c4f6?s=128&d=identicon&r=PG", "display_name": "hl037_", "link": "https://stackoverflow.com/users/1745291/hl037"}, "edited": false, "score": 0, "creation_date": 1473257965, "post_id": 39372309, "comment_id": 66072689, "body": "@hl037_ understood, I did a similar thing and then went back to lambdas. In the end they are more maintainable and easier to read and debug. Best of luck! :)"}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 0, "last_activity_date": 1473257708, "creation_date": 1473257708, "answer_id": 39372309, "question_id": 39372213, "link": "https://stackoverflow.com/questions/39372213/handle-pointer-to-member-in-templates-while-creating-a-simpler-bind-to-use-wit/39372309#39372309", "title": "Handle pointer to member in templates while creating a simpler `bind` to use with asio", "body": "<p>c++11:</p>\n\n<pre><code>boost::asio::async_read(socket,\n                        boost::asio::buffer(d, n),\n                        [this](boost::system::error_code const&amp; ec, std::size_t transferred)\n                        { this-&gt;method(ec, transferred); });\n</code></pre>\n\n<p>c++14:</p>\n\n<pre><code>boost::asio::async_read(socket,\n                        boost::asio::buffer(d, n),\n                        [this](auto const&amp; ec, auto transferred)\n                        { this-&gt;method(ec, transferred); });\n</code></pre>\n\n<p>Lambdas are perfectly good asynchronous handlers in asio.</p>\n\n<p>They also work with strands etc:</p>\n\n<pre><code>boost::asio::async_read(socket,\n                        boost::asio::buffer(d, n),\n                        this-&gt;strand_.wrap([this](auto const&amp; ec, auto transferred)\n                        { this-&gt;method(ec, transferred); }));\n</code></pre>\n\n<p>not to mention <code>shared_from_this()</code>...</p>\n\n<pre><code>boost::asio::async_read(socket,\n                        boost::asio::buffer(d, n),\n                        this-&gt;strand_.wrap([self = this-&gt;shared_from_this()]\n                        (auto const&amp; ec, auto transferred)\n                        { self-&gt;method(ec, transferred); }));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2548, "user_id": 1745291, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a1cb774f2559ce8b8a6f4a5d2e33c4f6?s=128&d=identicon&r=PG", "display_name": "hl037_", "link": "https://stackoverflow.com/users/1745291/hl037"}, "edited": false, "score": 0, "creation_date": 1473257905, "post_id": 39372347, "comment_id": 66072648, "body": "...I didn&#39;t asked how to do it with lambda, I did asked how to correct my template, since it&#39;s useful to know how to write such a template ;)"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 2548, "user_id": 1745291, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a1cb774f2559ce8b8a6f4a5d2e33c4f6?s=128&d=identicon&r=PG", "display_name": "hl037_", "link": "https://stackoverflow.com/users/1745291/hl037"}, "edited": false, "score": 0, "creation_date": 1473258159, "post_id": 39372347, "comment_id": 66072856, "body": "@hl037_ Why do you want to write a 20 line template when you can write a 3 line lambda?"}, {"owner": {"reputation": 2548, "user_id": 1745291, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a1cb774f2559ce8b8a6f4a5d2e33c4f6?s=128&d=identicon&r=PG", "display_name": "hl037_", "link": "https://stackoverflow.com/users/1745291/hl037"}, "edited": false, "score": 0, "creation_date": 1473258563, "post_id": 39372347, "comment_id": 66073226, "body": "because <code>handler(callback, session)</code> is much faster to write and to understand than a 3 line lambda, while the 20 line template is just a tool that doesn&#39;t introduce overhead compared to a lambda"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 2548, "user_id": 1745291, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a1cb774f2559ce8b8a6f4a5d2e33c4f6?s=128&d=identicon&r=PG", "display_name": "hl037_", "link": "https://stackoverflow.com/users/1745291/hl037"}, "edited": false, "score": 0, "creation_date": 1473258639, "post_id": 39372347, "comment_id": 66073300, "body": "@hl037_ The lambda doesn&#39;t introduce overhead... Agree to strongly disagree on faster to understand."}, {"owner": {"reputation": 2548, "user_id": 1745291, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a1cb774f2559ce8b8a6f4a5d2e33c4f6?s=128&d=identicon&r=PG", "display_name": "hl037_", "link": "https://stackoverflow.com/users/1745291/hl037"}, "edited": false, "score": 0, "creation_date": 1473258790, "post_id": 39372347, "comment_id": 66073421, "body": "yes, I meant the lambda doesn&#39;t introduce overhead and the template neither ;)"}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 0, "last_activity_date": 1473258040, "last_edit_date": 1473258040, "creation_date": 1473257787, "answer_id": 39372347, "question_id": 39372213, "link": "https://stackoverflow.com/questions/39372213/handle-pointer-to-member-in-templates-while-creating-a-simpler-bind-to-use-wit/39372347#39372347", "title": "Handle pointer to member in templates while creating a simpler `bind` to use with asio", "body": "<p>The simplest would be to just use a lambda:</p>\n\n<pre><code>boost::asio::async_read(socket,\n    boost::asio::buffer(d, n),\n    [&amp;](boost::system::error_code const&amp; ec, size_t transferred) {\n        // either it's a free function\n        return callback(session, ec, transferred);\n\n        // or it's a member function\n        return session.member(ec, transferred);\n    }\n);\n</code></pre>\n\n<hr />\n\n<p>The most generic with <a href=\"http://en.cppreference.com/w/cpp/utility/functional/invoke\" rel=\"nofollow\"><code>std::invoke()</code></a>:</p>\n\n<pre><code>boost::asio::async_read(socket,\n    boost::asio::buffer(d, n),\n    [&amp;](auto&amp;&amp;... args) -&gt; decltype(std::invoke(callback, session, decltype(args)(args)...)) {\n        return std::invoke(callback, session, decltype(args)(args)...);\n    }\n);\n</code></pre>\n\n<p>Or if you always know if the callback is a pointer to member function or not, you can just use the right one, whether:</p>\n\n<pre><code>[&amp;](auto&amp;&amp;... args) -&gt; decltype(callback(session, decltype(args)(args)...)) {\n    return callback(session, decltype(args)(args)...);\n}\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>[&amp;](auto&amp;&amp;... args) -&gt; decltype(session.member(decltype(args)(args)...)) {\n    return session.member(decltype(args)(args)...);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 1, "last_activity_date": 1473258586, "creation_date": 1473258586, "answer_id": 39372676, "question_id": 39372213, "link": "https://stackoverflow.com/questions/39372213/handle-pointer-to-member-in-templates-while-creating-a-simpler-bind-to-use-wit/39372676#39372676", "title": "Handle pointer to member in templates while creating a simpler `bind` to use with asio", "body": "<p>If you really want to write your own template, there's a lot to fix in yours. First, you're keeping references to temporaries. Your <code>handler()</code> function needs to take references itself, or you need to keep values. Prefer to keep values. If the user wants to pass in references, they can always use <code>std::ref</code>. So let's start with that. Here's a simple handler with data:</p>\n\n<pre><code>template &lt;typename Func, typename Data&gt;\nstruct Handler\n{\n   Func func;  // NB: not a reference\n   Data data;\n\n   template&lt;class... Args&gt;\n   auto operator()(Args&amp;&amp;... args) const  // NB: this wasn't a forwarding ref before\n       -&gt; decltype(func(data, std::forward&lt;Args&gt;(args)...))\n   {\n      return func(data, std::forward&lt;Args&gt;(args)... );\n   }\n};\n</code></pre>\n\n<p>Okay, so now we have an aggregate, which is already copyable and movable and all the good things we want without having to write it out ourselves (not that your <code>Handler</code> is movable - but moving it called the copy constructor...)</p>\n\n<p>Now, we can write our function out:</p>\n\n<pre><code>template &lt;class F, class D&gt;\nHandler&lt;std::decay_t&lt;F&gt;, std::decay_t&lt;D&gt;&gt; handler(F&amp;&amp; f, D&amp;&amp; d) {\n    return {std::forward&lt;F&gt;(f), std::forward&lt;D&gt;(d)};\n}\n</code></pre>\n\n<p>To handle member functions, you just need a separate overload of <code>handler</code>. Everything else remains the same, we'll just conditionally wrap pointers to members with <code>mem_fn</code>:</p>\n\n<pre><code>template &lt;class R, class T&gt;\nauto handler(R T::* p, T* cls)\n    -&gt; Handler&lt;decltype(std::mem_fn(p)), T*&gt;\n{\n    return {std::mem_fn(p), cls};\n}\n</code></pre>\n\n<p>Eh voila. </p>\n"}], "owner": {"reputation": 2548, "user_id": 1745291, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a1cb774f2559ce8b8a6f4a5d2e33c4f6?s=128&d=identicon&r=PG", "display_name": "hl037_", "link": "https://stackoverflow.com/users/1745291/hl037"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 39372676, "answer_count": 3, "score": 1, "last_activity_date": 1473258586, "creation_date": 1473257430, "question_id": 39372213, "link": "https://stackoverflow.com/questions/39372213/handle-pointer-to-member-in-templates-while-creating-a-simpler-bind-to-use-wit", "title": "Handle pointer to member in templates while creating a simpler `bind` to use with asio", "body": "<p>I would like to create a wrapper to simplify writing the binds for the handlers, so that I just have to give the callback and a data pointer.</p>\n\n<p>This is my code :</p>\n\n<pre><code>#include &lt;utility&gt;\n\ntemplate &lt;typename Func, typename Data&gt;\nclass Handler\n{\n   const Func &amp; m_func;\n   volatile Data &amp; m_data;\n\npublic:\n   Handler(const Func &amp; f, Data &amp; d) :\n      m_func(f),\n      m_data(d)\n   {}\n\n   Handler(const Handler &amp; cpy) :\n      m_func(cpy.m_func),\n      m_data(cpy.m_data)\n   {}\n\n   template&lt;typename Res=void, typename... Args&gt;\n   Res operator()(Args... args) const\n   {\n      return m_func(m_data, std::forward&lt;Args&gt;(args)... );\n   }\n};\n\n/* I need help to handle this specialization */\ntemplate&lt;typename T&gt;\ntemplate&lt;typename Res=void, typename... Args&gt;\nRes Handler&lt;(T::*)(Args...), T*&gt;::operator()(Args... args) const\n{\n   return (m_data-&gt;*m_func)(std::forward&lt;Args&gt;(args)... );\n}\n\n\ntemplate &lt;typename Func, typename Data&gt;\ninline Handler&lt;Func, Data&gt; handler(Func f, Data d)\n{\n   return Handler&lt;Func, Data&gt;(f, d);\n}\n</code></pre>\n\n<p>The goal is to use it like this : </p>\n\n<pre><code>boost::asio::async_read(socket,\n                        boost::asio::buffer(d, n),\n                        handler(callback, session)\n);\n</code></pre>\n\n<p>or like this :</p>\n\n<pre><code>boost::asio::async_read(socket,\n                        boost::asio::buffer(d, n),\n                        handler(&amp;Object::method, this_ptr)\n);\n</code></pre>\n\n<p>But I have problem handling the specialization for the latter case...</p>\n"}, {"tags": ["c++", "c++11", "types"], "comments": [{"owner": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 3, "creation_date": 1473257475, "post_id": 39372202, "comment_id": 66072327, "body": "try looking at bigint libraries instead."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473257554, "post_id": 39372202, "comment_id": 66072390, "body": "Why not make it a template and specify what the underlying type should be?  That way if you know you need a small counter you use a small type.  If you need a big counter or unknown then you use a larger type?"}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1473257580, "post_id": 39372202, "comment_id": 66072417, "body": "You&#39;re going to need dynamic allocation for this"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 10, "creation_date": 1473257673, "post_id": 39372202, "comment_id": 66072489, "body": "Just use <code>unsigned int</code> from the start. Is there an actual practical issue you are trying to solve? Your question sounds suspiciously like <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">an XY problem</a>."}, {"owner": {"reputation": 1177, "user_id": 2697007, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/093ff120a7d81d7f2a71707bd1408253?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2697007/andrew"}, "edited": false, "score": 0, "creation_date": 1473257720, "post_id": 39372202, "comment_id": 66072520, "body": "I should add, I don&#39;t know how much the count is going to be incremented at compile time, so I can&#39;t just specify a template parameter at compile time. I need a dynamic resizing at runtime."}, {"owner": {"reputation": 1177, "user_id": 2697007, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/093ff120a7d81d7f2a71707bd1408253?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2697007/andrew"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1473257840, "post_id": 39372202, "comment_id": 66072592, "body": "@Igor Tandetnik If I have 10 million Counters, I don&#39;t want to use an extra 2 bytes for an int (as that would require 20 million extra bytes). I know alignment might fix the issue for short -&gt; int but I want this to also be valid for int32 -&gt; int64"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 10, "creation_date": 1473258073, "post_id": 39372202, "comment_id": 66072784, "body": "Any solution involving dynamic memory allocation and such is guaranteed to cost you much more than 2 bytes per instance. You can&#39;t magically get something for nothing. Besides, if <code>Counter</code> is expected to play clever games with storage, it can&#39;t just expose <code>x</code> as a public member like that and allow any odd piece of code to modify it."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1473258680, "post_id": 39372202, "comment_id": 66073334, "body": "I have a feeling that the branch(es) you need to do this would hurt your performance more then using some space that is not needed."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1473262443, "post_id": 39372202, "comment_id": 66076101, "body": "You can&#39;t do this without some kind of flag that says if space is reserved or not ( attempt without <a href=\"http://ideone.com/mtVmoA\" rel=\"nofollow noreferrer\">ideone.com/mtVmoA</a> ). This is because if the value goes to unsigned short max + 1 your unsigned short bits will be 00000000 and thus trying to check if you need to read an int or just the short by reading the short and determining it&#39;s value you&#39;ll get 0 instead of the actual value, max + 1."}], "answers": [{"tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": false, "score": 0, "last_activity_date": 1473259388, "creation_date": 1473259388, "answer_id": 39372952, "question_id": 39372202, "link": "https://stackoverflow.com/questions/39372202/is-there-an-easy-and-efficient-way-to-dynamically-change-a-data-type-once-that-d/39372952#39372952", "title": "Is there an easy and efficient way to dynamically change a data type once that data type&#39;s limit has been reached?", "body": "<p>C++ is a statically typed language. Every data structure has a compile-time size which cannot be changed.</p>\n\n<p>You can have a class <em>allocate</em> more memory. But that is a separate allocation from the class's own storage (and as noted in the comments, it would be just as memory costly if not moreso than an <code>int</code>). A specific C++ class will only ever have a single size.</p>\n"}, {"tags": [], "owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1473259651, "creation_date": 1473259651, "answer_id": 39373056, "question_id": 39372202, "link": "https://stackoverflow.com/questions/39372202/is-there-an-easy-and-efficient-way-to-dynamically-change-a-data-type-once-that-d/39373056#39373056", "title": "Is there an easy and efficient way to dynamically change a data type once that data type&#39;s limit has been reached?", "body": "<p>Have a look at  your data storage policy for the 20 million values. There are two basic ways:</p>\n\n<p>If you store objects in an array their size and type is set in stone. That is Nicol's answer. It's what has been recommended in the comments: Use the largest integer type needed and be done.</p>\n\n<p>If you store pointers to your objects you are free to replace an object pointed to with another type which has a larger value space. But you have a memory overhead built-in <em>from the start</em>, probably an overhead of two pointers per value (the second one is the hidden vtable pointer inside the polymorphic object). That doesn't make sense.</p>\n\n<p>If you want to change the underlying integer type <em>of the same object</em> you must allocate the integer dynamically and hold a pointer to that memory in your object; you just moved the pointer (this time to an integer object of various sizes) into the object, with the same overhead, <em>plus</em> the memory overhead for the heap administration which becomes dominant for small little chunks like here.</p>\n"}, {"tags": [], "owner": {"reputation": 2251, "user_id": 6639082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44da46c9168a90de2479557760523d3d?s=128&d=identicon&r=PG&f=1", "display_name": "WindyFields", "link": "https://stackoverflow.com/users/6639082/windyfields"}, "is_accepted": false, "score": 1, "last_activity_date": 1473260398, "last_edit_date": 1473260398, "creation_date": 1473259807, "answer_id": 39373115, "question_id": 39372202, "link": "https://stackoverflow.com/questions/39372202/is-there-an-easy-and-efficient-way-to-dynamically-change-a-data-type-once-that-d/39373115#39373115", "title": "Is there an easy and efficient way to dynamically change a data type once that data type&#39;s limit has been reached?", "body": "<p>The only way to do that is just, as you said, to check each increment whether incremented values fits current type, if not - create new obj with say uint32 instead of uint16 and copy the old val. However, in this case if objects are polymorphic -> they must contain a pointer to a virtual table function which requires additional 8 byte memory.</p>\n\n<p>Sure, you can consider storing count number in a different data structure rather then just a fundamental type, but most likely they contain some extra info which requires more memory (but the memory is vital in you case ) so that is not an option. Also you can't deal with a free store, because the pointer is 32-64 bits (depending on the machine) and it's the same as storing a uint64.</p>\n\n<p>The point of all this is that you can't avoid copying the same reason you have to copy when reallocating a memory for a vector. You can never now what is located next to your counter in the memory -> now way to just \"resize\" a type.</p>\n\n<p>How you can figure out that the counter number is too big for current type and new type is needed? Very simple, just check x + 1 value for being equal to 0. If that happened -> overflow took place -> current type is to small.</p>\n\n<p>To summarize, copying is the only way you can \"resize\" an object. But if you agree to do that, you will need to write some code for checking and copying and also you can't avoid value checking overhead each increment.</p>\n"}, {"comments": [{"owner": {"reputation": 1177, "user_id": 2697007, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/093ff120a7d81d7f2a71707bd1408253?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2697007/andrew"}, "edited": false, "score": 0, "creation_date": 1473260675, "post_id": 39373146, "comment_id": 66074910, "body": "What do you think of the idea of returning a new Object that holds a different data type (for example, exact copy of Counter class with a int instead of a short) when count would reach the data type&#39;s limit?"}, {"owner": {"reputation": 30181, "user_id": 209629, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3784fe19d5c3d40d66ba91788f9bf007?s=128&d=identicon&r=PG", "display_name": "vz0", "link": "https://stackoverflow.com/users/209629/vz0"}, "reply_to_user": {"reputation": 1177, "user_id": 2697007, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/093ff120a7d81d7f2a71707bd1408253?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2697007/andrew"}, "edited": false, "score": 0, "creation_date": 1473260773, "post_id": 39373146, "comment_id": 66074978, "body": "In C++ instances of classes with virtual methods have a penalty of at least 4/8 bytes for the vtable. And then you have to pay a pointer to the instance. So you save 2 bytes but you need to pay 16 bytes more. And also you need to pay for the extra code that gets executed. Also virtual method calls are usually 10x slower."}, {"owner": {"reputation": 1177, "user_id": 2697007, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/093ff120a7d81d7f2a71707bd1408253?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2697007/andrew"}, "edited": false, "score": 0, "creation_date": 1473261435, "post_id": 39373146, "comment_id": 66075430, "body": "But if the Counter was already a part of an inheritance with virtual methods, would those penalties be nullified? Obviously not the same use case as my simple example, but it is worth noting."}], "tags": [], "owner": {"reputation": 30181, "user_id": 209629, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3784fe19d5c3d40d66ba91788f9bf007?s=128&d=identicon&r=PG", "display_name": "vz0", "link": "https://stackoverflow.com/users/209629/vz0"}, "is_accepted": false, "score": 1, "last_activity_date": 1473260303, "last_edit_date": 1495535628, "creation_date": 1473259913, "answer_id": 39373146, "question_id": 39372202, "link": "https://stackoverflow.com/questions/39372202/is-there-an-easy-and-efficient-way-to-dynamically-change-a-data-type-once-that-d/39373146#39373146", "title": "Is there an easy and efficient way to dynamically change a data type once that data type&#39;s limit has been reached?", "body": "<p>Data types in C and C++ have to be totally defined at compile time. You can't have a short variable that then gets promoted to an int.</p>\n\n<p>Programming languages like Python attach the data type to values, not variables. That's the reason why you can do:</p>\n\n<pre><code>a = 1\na = \"hi\"\n</code></pre>\n\n<p>Because the data type is attached to the value 1 and then to the value \"hi\". </p>\n\n<p>The price to pay for this is that the bookkeeping for \"a\" is usually high, with at least one pointer to a dynamically allocated block of memory, bookkeeping for dynamic memory allocation, and values have a data type discrimination mechanism to get the value of a data type. This mechanism allows to infer data types at runtime at the cost of lower runtime efficiency.</p>\n\n<p>There are at least two ways to implement this. Historically this has been done as a variant data type. <a href=\"https://stackoverflow.com/questions/4788965/when-would-anyone-use-a-union-is-it-a-remnant-from-the-c-only-days/4789053#4789053\">See here for more information</a>. The alternative is to do it as an object oriented way, where you have a base class Object with all possible operations. This is more or less what Python does, but in C instead with C++ and with function pointers. For example:</p>\n\n<pre><code>class Object {\npublic:\n  virtual Object_ptr add(Object_ptr other) = 0;\n};\n</code></pre>\n\n<p>For example the + operation for ints is the usual arithmetic add, where 2+2=4 but for strings is the concatenation operation, where \"Hello \" + \"World\" = \"Hello World\". Following the same logic we can do:</p>\n\n<pre><code>class IntObject {\npublic:\n  virtual Object_ptr add(Object_ptr other) {\n    if (other-&gt;dataType() == DATATYPE_INT) {\n      return new IntObject(this-&gt;value + other-&gt;value);\n    } else {\n      raiseError(\"dataTypeError\");\n    }\n  }\n};\n</code></pre>\n\n<p>Python also have the nice feature of long-arbitrary size integers. You can have a value with as many bits as memory you have. For example in Python:</p>\n\n<pre><code>&gt;&gt;&gt; 1&lt;&lt;128\n340282366920938463463374607431768211456L\n</code></pre>\n\n<p>Internally, Python detects that the number won't fit in an int32/int64 and will upgrade the data type at runtime. This is what more or less Python does internally:</p>\n\n<pre><code>class IntObject {\npublic:\n  virtual Object_ptr add(Object_ptr other) {\n    if (other-&gt;dataType() == DATATYPE_INT) {\n      if (operationWillOverflow(other)) {\n        auto a = new LongIntObject(this);\n        auto b = new LongIntObject(other);\n        return a.add(b);\n      } else {\n        return new IntObject(this-&gt;value + other-&gt;value);\n      }\n    } else {\n      raiseError(\"dataTypeError\");\n    }\n  }\n};\n</code></pre>\n"}], "owner": {"reputation": 1177, "user_id": 2697007, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/093ff120a7d81d7f2a71707bd1408253?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2697007/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 1, "answer_count": 4, "score": 3, "last_activity_date": 1473260398, "creation_date": 1473257407, "last_edit_date": 1473259915, "question_id": 39372202, "link": "https://stackoverflow.com/questions/39372202/is-there-an-easy-and-efficient-way-to-dynamically-change-a-data-type-once-that-d", "title": "Is there an easy and efficient way to dynamically change a data type once that data type&#39;s limit has been reached?", "body": "<p>I would like to increase the size of a data type once that data type's limit has been reached. For example, let's say I have a class:</p>\n\n<pre><code>struct Counter {\n    unsigned short x;\n    void IncrementCount() { x++; }\n};\n</code></pre>\n\n<p>Once I change the value of Counter.x, I would like it to promote x to be an unsigned int instead of an unsigned short. </p>\n\n<pre><code>int main() {\n    Counter c;\n    c.x = ~0;  // c.x is max unsigned short value 2^16\n    c.IncrementCount();     // c.x is now an unsigned int with value 2^16 + 1, NOT an unsigned short with value 0\n}\n</code></pre>\n\n<p>The reason for me doing this is so that I store as little memory in my Counter class as possible.</p>\n\n<p>Obviously I want as little impact to performance and readability as possible.</p>\n\n<p>I've considered using a void pointer and casting to the appropriate data type (but how would I track the type without using extra memory?), changing the IncrementCount() method on my Counter class and creating a new Counter object (with an int instead of a short) when the unsigned short's limit is reached (but this will add some complexity, as well as an extra if on every increment). Maybe a bitmap which increases in size every time it needs an extra bit? Still adds complexity and some performance hit.</p>\n\n<p>If I have 10 million Counters, I don't want to use an extra 2 bytes for an int (as that would require 20 million extra bytes). I know alignment might fix the issue for short -> int but I want this to also be valid for int32 -> int64 and other types. It is also worth noting that this is a runtime problem (I don't know the size at compile time).</p>\n\n<p>Is there a simpler way in C++ to do this?</p>\n"}, {"tags": ["c++", "point-cloud-library"], "comments": [{"owner": {"reputation": 546, "user_id": 2941914, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/51c67dde6fa4f806bd8133ac97c27801?s=128&d=identicon&r=PG", "display_name": "bashbug", "link": "https://stackoverflow.com/users/2941914/bashbug"}, "edited": false, "score": 0, "creation_date": 1473340240, "post_id": 39372144, "comment_id": 66109799, "body": "The cov matrix uses the correspondence points of your source and target point clouds. You set a max correspondence distance of 0.3, but maybe the correspondences in your clouds have a greater distance. So you have no correspondences to build a cov matrix."}], "answers": [{"tags": [], "owner": {"reputation": 616, "user_id": 4704607, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/2b64a4e938b6c85ec5f8313aed8c9803?s=128&d=identicon&r=PG&f=1", "display_name": "TobSta", "link": "https://stackoverflow.com/users/4704607/tobsta"}, "is_accepted": false, "score": 0, "last_activity_date": 1481014980, "creation_date": 1481014980, "answer_id": 40991437, "question_id": 39372144, "link": "https://stackoverflow.com/questions/39372144/pcl-registration-of-clouds/40991437#40991437", "title": "PCL registration of clouds", "body": "<p>It was indeed the CorrespondenceDistance. My point clouds were in a different scale. In the PCL documentation, the distances are in meters but my point clouds are in millimeters, so i need a correspondence distance *1000</p>\n"}], "owner": {"reputation": 616, "user_id": 4704607, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/2b64a4e938b6c85ec5f8313aed8c9803?s=128&d=identicon&r=PG&f=1", "display_name": "TobSta", "link": "https://stackoverflow.com/users/4704607/tobsta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 462, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1481014980, "creation_date": 1473257257, "question_id": 39372144, "link": "https://stackoverflow.com/questions/39372144/pcl-registration-of-clouds", "title": "PCL registration of clouds", "body": "<p>I'm trying to pairwise register clouds to get a 3D template, but i get the warnings         </p>\n\n<pre><code>[pcl::SampleConsensusModelRegistration::computeSampleDistanceThreshold] Covariance matrix has NaN values! Is the input cloud finite?\n[pcl::RandomSampleConsensus::computeModel] No samples could be selected!\n</code></pre>\n\n<p>followed by signal SIGSEGV, segmentation fault:</p>\n\n<pre><code>0x00007ffff344114d in pcl::registration::TransformationEstimationSVD&lt;pcl::PointXYZRGBA, pcl::PointXYZRGBA, float&gt;::estimateRigidTransformation(pcl::ConstCloudIterator&lt;pcl::PointXYZRGBA&gt;&amp;, pcl::ConstCloudIterator&lt;pcl::PointXYZRGBA&gt;&amp;, Eigen::Matrix&lt;float, 4, 4, 0, 4, 4&gt;&amp;) const ()\n</code></pre>\n\n<p>My code is:</p>\n\n<pre><code>    registration-&gt;setInputSource(source);\n    registration-&gt;setInputTarget(target);\n    registration-&gt;setMaxCorrespondenceDistance(0.3);\n    registration-&gt;setRANSACOutlierRejectionThreshold(0.00001);\n    registration-&gt;setTransformationEpsilon(10e-6);\n    registration-&gt;setMaximumIterations(400);\n    registration-&gt;setRANSACIterations(10);\n    CloudMapper::Cloud::Ptr c(new CloudMapper::Cloud);\n    registration-&gt;align(*c);\n</code></pre>\n\n<p>Any ideas why the covariance matrix could have NaN values? The clouds are from different frames from a kinect stream.</p>\n"}, {"tags": ["c++", "mfc", "atl"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1473259920, "post_id": 39372044, "comment_id": 66074337, "body": "<code>Func1((str.IsEmpty() ? NULL : str));</code> doesn&#39;t compile on VS2015, I get <code>Error C2446 &#39;:&#39;: no conversion from &#39;CString&#39; to &#39;int&#39;\t...</code>"}], "answers": [{"tags": [], "owner": {"reputation": 64564, "user_id": 302139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ea13e6d50c94ba30296c4e5326e1634?s=128&d=identicon&r=PG", "display_name": "Edwin Buck", "link": "https://stackoverflow.com/users/302139/edwin-buck"}, "is_accepted": false, "score": 1, "last_activity_date": 1473257333, "creation_date": 1473257333, "answer_id": 39372175, "question_id": 39372044, "link": "https://stackoverflow.com/questions/39372044/condition-operator-and-lpctstr-in-function-header/39372175#39372175", "title": "Condition operator &quot;?:&quot; and LPCTSTR in function header", "body": "<p>At first glance, I imagine that </p>\n\n<pre><code>Func1((str.IsEmpty() ? (LPCTSTR)NULL : str));\n</code></pre>\n\n<p>would also work, and if it does, you probably have a type casting problem which was fixed by the </p>\n\n<pre><code>LPCTSTR strNull = NULL;\n</code></pre>\n\n<p>assignment because it will associate the type <code>LPCTSTR</code> with the value of null when <code>strNull</code> is called later.</p>\n"}, {"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1473257735, "post_id": 39372207, "comment_id": 66072528, "body": "<code>CString</code> does have an implicit conversion operator (<a href=\"https://msdn.microsoft.com/en-us/library/tk1z2hd9.aspx\" rel=\"nofollow noreferrer\">CSimpleStringT::operator PCXSTR</a>). I still don&#39;t quite follow, how the <a href=\"https://msdn.microsoft.com/en-us/library/cws1zdt8.aspx\" rel=\"nofollow noreferrer\">CStringT::CStringT</a> constructor is resolved. There are more than one that matches a <code>NULL</code> pointer."}], "tags": [], "owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "is_accepted": false, "score": 5, "last_activity_date": 1473257423, "creation_date": 1473257423, "answer_id": 39372207, "question_id": 39372044, "link": "https://stackoverflow.com/questions/39372044/condition-operator-and-lpctstr-in-function-header/39372207#39372207", "title": "Condition operator &quot;?:&quot; and LPCTSTR in function header", "body": "<p>The conditional operator converts its second and third arguments to a type that's common to the two of them. I don't know the details of <code>CString</code>, so this is just a guess, but it looks like the conditional operator converts <code>NULL</code> to a <code>CString</code> to match the type of the third argument, and passes that, through an implicit conversion to <code>LPCTSTR</code>, to the function.</p>\n"}, {"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1473258668, "post_id": 39372616, "comment_id": 66073323, "body": "And I&#39;m still confused how the <a href=\"https://msdn.microsoft.com/en-us/library/cws1zdt8.aspx\" rel=\"nofollow noreferrer\">CString</a> c&#39;tor is resolved in the expression <code>CString(NULL)</code>. There are several c&#39;tors that take pointer arguments. How does the compiler pick one (and which one is it)?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1473258995, "post_id": 39372616, "comment_id": 66073579, "body": "I get it now: All c&#39;tors taking a single pointer argument are <code>explicit</code>, except for the one taking a <code>const XCHAR*</code>."}], "tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": true, "score": 5, "last_activity_date": 1473278246, "last_edit_date": 1473278246, "creation_date": 1473258426, "answer_id": 39372616, "question_id": 39372044, "link": "https://stackoverflow.com/questions/39372044/condition-operator-and-lpctstr-in-function-header/39372616#39372616", "title": "Condition operator &quot;?:&quot; and LPCTSTR in function header", "body": "<p>This is caused by the need to convert both the second and third operands to a common type.<br>\n(The result can't have different types depending on whether the condition is true or not.)</p>\n\n<p>The first parameter is equivalent to</p>\n\n<pre><code>str.IsEmpty() ? CString(NULL) : str\n</code></pre>\n\n<p>since <code>NULL</code> doesn't have a type that you convert a <code>CString</code> to.<br>\nAnd <code>CString(NULL)</code> constructs an empty <code>CString</code>.  </p>\n\n<p>The second is equivalent to</p>\n\n<pre><code>str.IsEmpty() ? strNull : (LPCTSTR) str\n</code></pre>\n\n<p>since <code>CString</code> is convertible to <code>LPCTSTR</code> but not the other way around.</p>\n\n<p>Inlining the cast,</p>\n\n<pre><code>    str.IsEmpty() ? (LPCTSTR) NULL : str\n</code></pre>\n\n<p>should give the same effect as the second.</p>\n"}], "owner": {"reputation": 725, "user_id": 3667714, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U7EM5.png?s=128&g=1", "display_name": "Ramunas", "link": "https://stackoverflow.com/users/3667714/ramunas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 1, "accepted_answer_id": 39372616, "answer_count": 3, "score": 8, "last_activity_date": 1473278246, "creation_date": 1473256975, "last_edit_date": 1473257895, "question_id": 39372044, "link": "https://stackoverflow.com/questions/39372044/condition-operator-and-lpctstr-in-function-header", "title": "Condition operator &quot;?:&quot; and LPCTSTR in function header", "body": "<p>Maybe anyone can explain this to me:</p>\n\n<pre><code>bool Func1(LPCTSTR sData)\n{\n    if (sData) { ... }\n}\n</code></pre>\n\n<p>And I called the function like this:</p>\n\n<pre><code>CString str = _T(\"\");\nFunc1((str.IsEmpty() ? NULL : str));\n</code></pre>\n\n<p>And 'sData' inside function is never NULL, it is allways empty string but not NULL, why?\nEddited code like this:</p>\n\n<pre><code>LPCTSTR strNull = NULL;\nFunc1((str.IsEmpty() ? strNull : str));\n</code></pre>\n\n<p>In this case it works correct.</p>\n"}, {"tags": ["c++", "stl", "set"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 10, "creation_date": 1473256393, "post_id": 39371802, "comment_id": 66071527, "body": "Run it and find out?"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 1, "creation_date": 1473256574, "post_id": 39371802, "comment_id": 66071674, "body": "I predict <code>{11, 2, 4, 7}</code> (I didn&#39;t run the example, honest)."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 2, "creation_date": 1473256631, "post_id": 39371802, "comment_id": 66071717, "body": "<a href=\"http://ideone.com/8eL2f4\" rel=\"nofollow noreferrer\">ideone.com/8eL2f4</a> I&#39;m so kind"}, {"owner": {"reputation": 1, "user_id": 6804967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff691cdc8a725070e705af39f566adc?s=128&d=identicon&r=PG&f=1", "display_name": "C.Chew", "link": "https://stackoverflow.com/users/6804967/c-chew"}, "edited": false, "score": 0, "creation_date": 1473257955, "post_id": 39371802, "comment_id": 66072683, "body": "I ran it, but I couldn&#39;t properly explain why. :("}], "answers": [{"comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1473256978, "post_id": 39371967, "comment_id": 66071980, "body": "<code>set</code> doesn&#39;t use equality (as in, <code>operator==</code>). It uses equivalence, which is defined as <code>!(a&lt;b) &amp;&amp; !(b&lt;a)</code> (neither element compares less than the other) or, with custom comparator, <code>!comp(a, b) &amp;&amp; !comp(b, a)</code>. That&#39;s how the second set ends up only with elements that are unique modulo 10."}, {"owner": {"reputation": 1194, "user_id": 6800367, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6MJwj.jpg?s=128&g=1", "display_name": "Benson Lin", "link": "https://stackoverflow.com/users/6800367/benson-lin"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1473257053, "post_id": 39371967, "comment_id": 66072027, "body": "Thanks for clarifying, I actually was not sure how <code>set</code> checks for equality"}, {"owner": {"reputation": 1, "user_id": 6804967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff691cdc8a725070e705af39f566adc?s=128&d=identicon&r=PG&f=1", "display_name": "C.Chew", "link": "https://stackoverflow.com/users/6804967/c-chew"}, "edited": false, "score": 0, "creation_date": 1473258084, "post_id": 39371967, "comment_id": 66072795, "body": "Thanks Igor, I think you just gave me the clue to what I should look for. The set is formed by the fact that only the unique modulo 10 values are stored. I completely did not link the fact that 2 and 12 are the same with that custom operator."}], "tags": [], "owner": {"reputation": 1194, "user_id": 6800367, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6MJwj.jpg?s=128&g=1", "display_name": "Benson Lin", "link": "https://stackoverflow.com/users/6800367/benson-lin"}, "is_accepted": true, "score": 3, "last_activity_date": 1473256750, "creation_date": 1473256750, "answer_id": 39371967, "question_id": 39371802, "link": "https://stackoverflow.com/questions/39371802/what-values-are-inserted-in-the-set-with-this-c-code/39371967#39371967", "title": "What values are inserted in the set with this C++ code?", "body": "<p>When run, x contains in order:</p>\n\n<pre><code>2 4 7 11 12 14 17\n</code></pre>\n\n<p>y contains in order:</p>\n\n<pre><code>11 2 4 7\n</code></pre>\n\n<p>My hunch is that the <code>set</code> reverses the operator to check for equality (since a <code>set</code> only contains unique values). Thus only unique values of <code>a%10</code> exist.</p>\n"}], "owner": {"reputation": 1, "user_id": 6804967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff691cdc8a725070e705af39f566adc?s=128&d=identicon&r=PG&f=1", "display_name": "C.Chew", "link": "https://stackoverflow.com/users/6804967/c-chew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 39371967, "answer_count": 1, "score": -6, "last_activity_date": 1473256980, "creation_date": 1473256322, "question_id": 39371802, "link": "https://stackoverflow.com/questions/39371802/what-values-are-inserted-in-the-set-with-this-c-code", "title": "What values are inserted in the set with this C++ code?", "body": "<p>I was recently given an interview question that had the following code. Unfortunately, I didn't get it right. Could someone help explain what the code is doing, especially the commented line?</p>\n\n<p>Here is the code.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;set&gt;\n\nstruct C\n{\n    bool operator()(const int &amp;a, const int &amp;b) const\n    {\n        return a % 10 &lt; b % 10;\n    }\n};\n\nint main()\n{\n    std::set&lt;int&gt; x({ 4, 2, 7, 11, 12, 14, 17, 2 });\n    std::cout &lt;&lt; x.size();\n    std::set&lt;int, C&gt; y(x.begin(), x.end());  // Not sure what is inserted in the set\n    std::cout &lt;&lt; y.size() &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "clang", "ubsan", "address-sanitizer"], "comments": [{"owner": {"reputation": 10521, "user_id": 1316462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2de3149d5f602449f41083ca17a5ceab?s=128&d=identicon&r=PG&f=1", "display_name": "Jans", "link": "https://stackoverflow.com/users/1316462/jans"}, "edited": false, "score": 0, "creation_date": 1473461600, "post_id": 39371798, "comment_id": 66166420, "body": "You might check this <a href=\"http://stackoverflow.com/questions/38719560/is-there-a-way-to-store-clang-compile-time-flags-in-the-output-binary\" title=\"is there a way to store clang compile time flags in the output binary\">stackoverflow.com/questions/38719560/&hellip;</a>"}, {"owner": {"reputation": 249, "user_id": 4734520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-vhJtKtxFjiE/AAAAAAAAAAI/AAAAAAAAAEc/_n7w1N97mgI/photo.jpg?sz=128", "display_name": "Jonathan Abrahams", "link": "https://stackoverflow.com/users/4734520/jonathan-abrahams"}, "reply_to_user": {"reputation": 10521, "user_id": 1316462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2de3149d5f602449f41083ca17a5ceab?s=128&d=identicon&r=PG&f=1", "display_name": "Jans", "link": "https://stackoverflow.com/users/1316462/jans"}, "edited": false, "score": 0, "creation_date": 1473690798, "post_id": 39371798, "comment_id": 66226948, "body": "That doesn&#39;t work the same way as ASAN detection."}, {"owner": {"reputation": 137021, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "edited": false, "score": 0, "creation_date": 1538162988, "post_id": 39371798, "comment_id": 92061741, "body": "A request for this was opened at <a href=\"https://github.com/google/sanitizers/issues/765\" rel=\"nofollow noreferrer\">github.com/google/sanitizers/issues/765</a> and subsequently closed for lack of a convincing use case."}], "answers": [{"tags": [], "owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "is_accepted": false, "score": 2, "last_activity_date": 1536149665, "last_edit_date": 1536149665, "creation_date": 1477298664, "answer_id": 40214127, "question_id": 39371798, "link": "https://stackoverflow.com/questions/39371798/how-can-i-determine-if-ubsan-has-been-compiled-in-using-clang-or-gcc/40214127#40214127", "title": "How can I determine if UBSAN has been compiled in using clang or gcc?", "body": "<p>I suggest you file this as a bug to ASan github (or GCC bugzilla) about this (we already have defined for ASan and TSan so it makes sense to cook one for UBSan as well). For now it seems your only option is to pass a custom define together with <code>-fsanitize-undefined</code> in a Makefile.</p>\n"}, {"tags": [], "owner": {"reputation": 137021, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "is_accepted": false, "score": 0, "last_activity_date": 1538163519, "creation_date": 1538163519, "answer_id": 52561740, "question_id": 39371798, "link": "https://stackoverflow.com/questions/39371798/how-can-i-determine-if-ubsan-has-been-compiled-in-using-clang-or-gcc/52561740#52561740", "title": "How can I determine if UBSAN has been compiled in using clang or gcc?", "body": "<p>A request for this was opened at <a href=\"https://github.com/google/sanitizers/issues/765\" rel=\"nofollow noreferrer\">https://github.com/google/sanitizers/issues/765</a> and subsequently closed for lack of a convincing use case.</p>\n\n<p>A hack to detect presence of ubsan at run time is to look for one of its symbols, typically a symbol associated with the undefined behavior you are interested in. For example, to detect whether ubsan is sanitizing <code>__builtin_unreachable</code> you can check for the presence of <code>__ubsan_handle_builtin_unreachable</code>:</p>\n\n<pre><code>extern \"C\" void __attribute__((weak)) __ubsan_handle_builtin_unreachable();\n\nif (&amp;__ubsan_handle_builtin_unreachable)\n    ; // ubsan is present\nelse\n    ; // ubsan is not present\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4208, "user_id": 2343847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cf8c5e3c346c7734cb1ff728264f6cfb?s=128&d=identicon&r=PG", "display_name": "aij", "link": "https://stackoverflow.com/users/2343847/aij"}, "is_accepted": false, "score": 1, "last_activity_date": 1591808329, "creation_date": 1591808329, "answer_id": 62309041, "question_id": 39371798, "link": "https://stackoverflow.com/questions/39371798/how-can-i-determine-if-ubsan-has-been-compiled-in-using-clang-or-gcc/62309041#62309041", "title": "How can I determine if UBSAN has been compiled in using clang or gcc?", "body": "<p>With Clang, you can now check for UBSan very similarly to how you can check for ASan:</p>\n\n<pre><code>#if defined(__has_feature)\n#  if __has_feature(undefined_behavior_sanitizer)\n#    define HAS_UBSAN 1\n#  endif\n#endif\n</code></pre>\n\n<p>I don't know if it's possible to check under GCC yet though.</p>\n"}], "owner": {"reputation": 249, "user_id": 4734520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-vhJtKtxFjiE/AAAAAAAAAAI/AAAAAAAAAEc/_n7w1N97mgI/photo.jpg?sz=128", "display_name": "Jonathan Abrahams", "link": "https://stackoverflow.com/users/4734520/jonathan-abrahams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 953, "favorite_count": 0, "answer_count": 3, "score": 7, "last_activity_date": 1591808329, "creation_date": 1473256310, "last_edit_date": 1536149652, "question_id": 39371798, "link": "https://stackoverflow.com/questions/39371798/how-can-i-determine-if-ubsan-has-been-compiled-in-using-clang-or-gcc", "title": "How can I determine if UBSAN has been compiled in using clang or gcc?", "body": "<p>We use the following code to determine if <code>-fsanitize=address</code> has been specified at compile time for clang and gcc. How do we determine if <code>-fsanitize=undefined</code> has been specified?</p>\n\n<pre><code>    bool isSanitized = false;\n#if defined(__has_feature)\n#if __has_feature(address_sanitizer)\n    isSanitized = true;\n#endif\n#elif defined(__SANITIZE_ADDRESS__)\n    isSanitized = true;\n#endif\n</code></pre>\n"}, {"tags": ["c#", "c++", "visual-studio-2012", "msbuild"], "owner": {"reputation": 121, "user_id": 448308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d8cd75701651d9b70db7f05d6ebe2d?s=128&d=identicon&r=PG", "display_name": "Abhay Joshi", "link": "https://stackoverflow.com/users/448308/abhay-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 287, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1473256185, "creation_date": 1473256185, "last_edit_date": 1495541703, "question_id": 39371746, "link": "https://stackoverflow.com/questions/39371746/how-to-compile-single-c-file-programmatically-using-microsoft-build-evaluation", "title": "How to compile single c++ file programmatically using Microsoft.Build.Evaluation.Project", "body": "<p>I want to compile single c++ file from project in Visual Studio 2012 solution. similar to (<a href=\"https://stackoverflow.com/questions/4172438/using-msbuild-to-compile-a-single-cpp-file\">Using MSBuild to compile a single cpp file</a>) but using <strong>Microsoft.Build.Evaluation.Project</strong></p>\n\n<p>For command line I can use <code>msbuild &lt;projectfile&gt; /V:q /p:Configuration=\"&lt;configuration&gt;\" /p:Platform=x64 /t:ClCompile /p:SelectedFiles=\"&lt;files separated by semicolon&gt;\"</code></p>\n\n<p>I tried following code </p>\n\n<pre><code>Microsoft.Build.Evaluation.Project project;\nstring projFile = \"C:\\\\ProjDir\\\\ProjectFile.vcxproj\";\n\nDictionary&lt;string, string&gt; props = new Dictionary&lt;string, string&gt;();\nprops.Add(\"Configuration\", \"_64ReleaseDI\");\nprops.Add(\"Platform\", \"x64\");\nprops.Add(\"SelectedFiles\", \"CodeFile.cpp\");\n\nproject = new Microsoft.Build.Evaluation.Project(projFile, props, \"4.0\");\n\nMyCustomBuildLogger logger = new MyCustomBuildLogger();\n\nbool bOutput = project.Build(new string[] { \"ClCompile\" }, new MyCustomBuildLogger[] {logger});\nTextBox1.Text = logger.Output;\n</code></pre>\n\n<p>But found it compile complete project and other projects that this project depend on.</p>\n\n<p>Please provide snippet to achieve it.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 3, "creation_date": 1473256148, "post_id": 39371685, "comment_id": 66071336, "body": "<code>*(pointer + counter)</code> is just another (and wackier) way to write <code>pointer[counter]</code>. It&#39;s not clear why the author chose to obfuscate matters in this way. In any case, it would have been better to use <code>std::vector&lt;int&gt;</code> in place of raw pointers and manual memory management."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 2, "creation_date": 1473256702, "post_id": 39371685, "comment_id": 66071764, "body": "In real code this should be <code>std::vector</code>."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 3, "creation_date": 1473256871, "post_id": 39371685, "comment_id": 66071901, "body": "And while I&#39;m giving unsolicited coding advice: don&#39;t define <code>pointer</code> until it&#39;s used, i.e., <code>int *pointer = new int[input];</code>; and define <code>temp</code> inside the body of the <code>for</code> loop, since that&#39;s the only place it&#39;s used."}], "answers": [{"tags": [], "owner": {"reputation": 20315, "user_id": 963881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e82a2a2b9ddf6fb580a9c34b2eca65f4?s=128&d=identicon&r=PG&f=1", "display_name": "syntagma", "link": "https://stackoverflow.com/users/963881/syntagma"}, "is_accepted": false, "score": 1, "last_activity_date": 1473256202, "creation_date": 1473256202, "answer_id": 39371756, "question_id": 39371685, "link": "https://stackoverflow.com/questions/39371685/dynamically-allocating-arrays-depending-on-user-input-in-c/39371756#39371756", "title": "Dynamically Allocating Arrays Depending on User Input in C++", "body": "<p>This part:</p>\n\n<pre><code>*(pointer + counter)\n</code></pre>\n\n<p>is just simple pointer arithmetic: we are adding <code>counter</code> (of type <code>int</code>) to the pointer address and then dereferencing it using <code>*</code>. <strong>It is the same as     <code>pointer[counter]</code></strong>. After that, we are savig value of <code>temp</code> into that particular (dereferenced) location in memory.</p>\n"}, {"tags": [], "owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "is_accepted": false, "score": 1, "last_activity_date": 1473256831, "last_edit_date": 1473256831, "creation_date": 1473256452, "answer_id": 39371844, "question_id": 39371685, "link": "https://stackoverflow.com/questions/39371685/dynamically-allocating-arrays-depending-on-user-input-in-c/39371844#39371844", "title": "Dynamically Allocating Arrays Depending on User Input in C++", "body": "<p><code>*(pointer + counter)</code> is equivalent to <code>pointer[counter]</code> as has been pointed out, the reason it's equivalent is because pointer holds a memory address, when you add say 1 to the that memory address you are infact adding the size of whatever the data type that pointer is pointing to is, multiplied by 1. </p>\n\n<p>If you have a primitive array </p>\n\n<pre><code>int arr[2] = {1,55};\n</code></pre>\n\n<p><code>*arr</code> would give you 1 and <code>*(arr + 1)</code> would give you 55</p>\n"}, {"comments": [{"owner": {"reputation": 693, "user_id": 5289164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/622adef0cf2ee22736ade5366b7509fa?s=128&d=identicon&r=PG&f=1", "display_name": "knivil", "link": "https://stackoverflow.com/users/5289164/knivil"}, "edited": false, "score": 0, "creation_date": 1473345817, "post_id": 39372296, "comment_id": 66113946, "body": "It is odd to start with bits when the smallest addressable memory location is a &#39;byte&#39;."}], "tags": [], "owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "is_accepted": true, "score": 2, "last_activity_date": 1473257669, "creation_date": 1473257669, "answer_id": 39372296, "question_id": 39371685, "link": "https://stackoverflow.com/questions/39371685/dynamically-allocating-arrays-depending-on-user-input-in-c/39372296#39372296", "title": "Dynamically Allocating Arrays Depending on User Input in C++", "body": "<p><a href=\"https://www.cs.umd.edu/class/sum2003/cmsc311/Notes/BitOp/pointer.html\" rel=\"nofollow\">Pointer Arithmetic</a> is a good point where to start.</p>\n\n<p>I'm going to try to explain you briefly how it works, but I strongly suggest you to integrate those concepts with a good book or internet references because they are very important for proper handling pointers.</p>\n\n<p>A pointer (as you can imagine from the name) <em>points</em> a memory cell:</p>\n\n<pre><code>int* ptr = /*an address to the memory cell*/\n</code></pre>\n\n<p>Your memory is composed by sequentially cells, graphically:</p>\n\n<pre><code>Address|      Value\n-------|------------\n0x00   |    [#some value] 8 bit\n0x01   |    [#some value] 8 bit\n...    |    ...\n0xN    |    [#some value] 8 bit\n</code></pre>\n\n<p>Just to make this example not so long, we can assume each cell contains 8 bits and a integer value is represented with exactly 32 bit (usually that is not true, and it depends on the machine architecture and compiler). </p>\n\n<p>Then a <code>int</code> value is stored exactly in <code>4</code> cells. (We explicitly don't consider memory alignment).</p>\n\n<p>So your pointer contains a memory location, the address in the memory which contains the value you've allocated (with the usage of dynamic memory).</p>\n\n<p>For example:</p>\n\n<pre><code>int* ptr = 0x01\n</code></pre>\n\n<p>That means the variable ptr, stored somewhere in the memory, contains the address <code>0x01</code>. In the memory cell <code>0x01</code> there will be the integer value allocated dynamically. </p>\n\n<p>But, since the value is an <em>integer</em> type, the data will take 4 cell in order to store the complete information. So the data will be \"split\" among the cell <code>0x01, 0x02, 0x03, 0x04</code>.</p>\n\n<p>The pointer will points the first memory location of the data, and the number of cell occupied is given by the type of pointer (in that case pointer <code>int</code> so the compiler knows the information starts from cell <code>0x01</code> and ends <code>0x04</code>). </p>\n\n<p>A <em>variable pointer</em> can be evaluated in an arithmetic expression, such sums and differences.</p>\n\n<p>Fo example:</p>\n\n<pre><code>ptr + 10\nptr - 10 \n</code></pre>\n\n<p>Simply, the meaning of that expression is to access to memory address starting from the address stored in <code>ptr</code> and jumping <code>10</code> <em>int cells</em> forward or backward.</p>\n\n<p><em>Attention Note:</em> the expression <em>does not</em> mean to simply add the value to the address obtaining a new address. </p>\n\n<p>Indeed, assuming <code>ptr = 0x01</code>, then the expression:</p>\n\n<pre><code>ptr + 10;\n</code></pre>\n\n<p><em>does not mean</em> <code>0x01 + 10 = 0xa</code>!</p>\n\n<p>Instead that means to jump 10 \"block\" of size equal to the type's size\npointed by the pointer itself.</p>\n\n<p>That is, <code>0x01 + 10 * 4bytes</code>. \nSince <code>ptr</code> is a pointer to <code>int</code>, then <code>+10</code> means <em>\"plus 10 block of integers\"</em>, and, in this example, each <code>int</code> occupies 4 bytes (32 bit).</p>\n\n<hr>\n\n<p>To conclude, the expression: </p>\n\n<pre><code>*(pointer + counter) = temp;\n</code></pre>\n\n<p>means to access to the address start from <code>pointer</code> and adding <code>#counter</code> block of <code>int</code>, then deference that address with the <code>operator*</code> and write in that address the value <code>temp</code>.</p>\n\n<p>That notation can be easily simplify  with the <code>operator[]</code>:</p>\n\n<pre><code>pointer[counter] = temp;\n</code></pre>\n\n<p>where the meaning is exactly the same, but the notation is more readable, especially when you have to do with array.</p>\n"}, {"tags": [], "owner": {"reputation": 1861, "user_id": 6737471, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/yp8Hu.jpg?s=128&g=1", "display_name": "pz64_", "link": "https://stackoverflow.com/users/6737471/pz64"}, "is_accepted": false, "score": 1, "last_activity_date": 1507056457, "last_edit_date": 1507056457, "creation_date": 1473344508, "answer_id": 39393454, "question_id": 39371685, "link": "https://stackoverflow.com/questions/39371685/dynamically-allocating-arrays-depending-on-user-input-in-c/39393454#39393454", "title": "Dynamically Allocating Arrays Depending on User Input in C++", "body": "<pre><code>  *(pointer + counter) = temp;\n</code></pre>\n\n<p>is same as </p>\n\n<pre><code>pointer[counter] = temp;\n</code></pre>\n\n<p>The variable <strong>pointer</strong> contain the address of the first element of the array. \nAdding <strong>counter</strong> means selecting the address of <strong>counter</strong> away from starting address. </p>\n\n<p><strong>counter</strong> is simply an offset from <strong>pointer</strong>.</p>\n"}], "owner": {"reputation": 937, "user_id": 6343586, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Z17cb.png?s=128&g=1", "display_name": "Vadamadafaka", "link": "https://stackoverflow.com/users/6343586/vadamadafaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1190, "favorite_count": 0, "accepted_answer_id": 39372296, "answer_count": 4, "score": 2, "last_activity_date": 1507056457, "creation_date": 1473256044, "question_id": 39371685, "link": "https://stackoverflow.com/questions/39371685/dynamically-allocating-arrays-depending-on-user-input-in-c", "title": "Dynamically Allocating Arrays Depending on User Input in C++", "body": "<p>im watching this tutorial on youtube <a href=\"https://www.youtube.com/watch?v=8XAQzcJvOHk\" rel=\"nofollow\">https://www.youtube.com/watch?v=8XAQzcJvOHk</a> Dynamically Allocating Arrays Depending on User Input in C++</p>\n\n<p>this is his code</p>\n\n<pre><code>1 int main()\n2 {\n3   int *pointer = nullptr;\n4   \n5   cout &lt;&lt; \"how many items u are gonna enter\" &lt;&lt; endl;\n6   int input;\n7   cin &gt;&gt; input;\n8\n9   pointer = new int[input];\n10\n11  int temp;\n12\n13  for (int counter = 0; counter &lt; input; counter++) {\n14      cout &lt;&lt; \"enter the item \" &lt;&lt; counter + 1 &lt;&lt; endl;\n15      cin &gt;&gt; temp;\n16      *(pointer + counter) = temp;\n17  }\n18\n19  cout &lt;&lt; \"the items you have entered are\" &lt;&lt; endl;\n20  for (int counter = 0; counter &lt; input; counter++) {\n21      cout &lt;&lt; counter + 1 &lt;&lt; \"  item is  \" &lt;&lt; *(pointer + counter) &lt;&lt; endl;\n22  }\n23\n24  delete[]pointer;\n25\n26  return 0;\n27}\n</code></pre>\n\n<p>im stuck in line 16, i dont understand why is that, inside the (), the pointer variable and counter are added to each other</p>\n"}, {"tags": ["c++", "arrays", "memory", "dynamic", "runtime"], "comments": [{"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1473256178, "post_id": 39371617, "comment_id": 66071352, "body": "As for me then I have understood nothing."}, {"owner": {"reputation": 3740, "user_id": 1030870, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8f96f7ac4f0bf4c2421a9f58b6893400?s=128&d=identicon&r=PG", "display_name": "Mine", "link": "https://stackoverflow.com/users/1030870/mine"}, "edited": false, "score": 0, "creation_date": 1473256999, "post_id": 39371617, "comment_id": 66071994, "body": "I don&#39;t understand the question, but I guess what you need is <code>std::vector&lt;std::vector&lt;int&gt;&gt;</code>"}, {"owner": {"reputation": 57, "user_id": 6711722, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/402ac325434a452c9e1755b86550975e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/6711722/nick"}, "edited": false, "score": 0, "creation_date": 1473257618, "post_id": 39371617, "comment_id": 66072444, "body": "I&#39;ve tried changing MAP_BUFFER tileMap (towards the bottom of the code) to MAP_BUFFER * tileMap = new MAP_BUFFER, but then I get an error on the &quot;new&quot; that says &quot; a value of type &quot; ENTITY(<i>)[30]&quot; cannot be used to initialize an entity of type &quot;MAP_BUFFER</i> &quot; &quot;"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 6711722, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/402ac325434a452c9e1755b86550975e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/6711722/nick"}, "edited": false, "score": 0, "creation_date": 1473305870, "post_id": 39373451, "comment_id": 66091874, "body": "Thanks for all that, i&#39;ll keep it in mind. But is there anyway possible to create a new array instead of it being a vector?"}, {"owner": {"reputation": 151, "user_id": 4225596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6bae47562fbf1187c9eb19933414e09?s=128&d=identicon&r=PG&f=1", "display_name": "Gamenotcore", "link": "https://stackoverflow.com/users/4225596/gamenotcore"}, "reply_to_user": {"reputation": 57, "user_id": 6711722, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/402ac325434a452c9e1755b86550975e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/6711722/nick"}, "edited": false, "score": 0, "creation_date": 1473363442, "post_id": 39373451, "comment_id": 66123822, "body": "Edited my answer. Short answer is yes, but use c++ containers instead: it is usually better to use std:array or std::vector than to manage the heap yourself."}], "tags": [], "owner": {"reputation": 151, "user_id": 4225596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6bae47562fbf1187c9eb19933414e09?s=128&d=identicon&r=PG&f=1", "display_name": "Gamenotcore", "link": "https://stackoverflow.com/users/4225596/gamenotcore"}, "is_accepted": false, "score": 0, "last_activity_date": 1473363521, "last_edit_date": 1473363521, "creation_date": 1473260756, "answer_id": 39373451, "question_id": 39371617, "link": "https://stackoverflow.com/questions/39371617/attempting-to-create-a-dynamic-array/39373451#39373451", "title": "Attempting to create a dynamic array", "body": "<p>The syntax you are using for defining your array is for a constant sized C array. In general you should shy away from C arrays unless the size of the data is determined at compile time(and never needs to change) and the array never leaves the scope(because a C array does not retain information on its own size.)</p>\n\n<p>In place of constant or dynamically sized C arrays I would suggest to use the Vector container. The Vector is a dynamically sized container that fills up from the back, the last element you have added to</p>\n\n<pre><code>std::vector&lt;std::vector&lt;ENTITY&gt;&gt;\n</code></pre>\n\n<p>To add the vector container to your project add the line</p>\n\n<pre><code>#include &lt;vector&gt;\n</code></pre>\n\n<p>To fill the container your loop could look like:</p>\n\n<pre><code>MAP_BUFFER tileMap;\n\nfor (unsigned int row = 0; row &lt; MAP_HEIGHT; row++)\n{\n    std::vector&lt;ENTITY&gt; column; // A column of the tile map\n    for (unsigned int col = 0; col &lt; MAP_WIDTH; col++)\n    {\n        column.push_back(WALL); // Add one element to the column\n    }\n    tileMap.push_back(column); // Add the column to the tile map\n}\n</code></pre>\n\n<p>or you could initialize the Vector to the size you want at the beginning and use your current loop to assign the tile values:</p>\n\n<pre><code>using TILE_MAP = vector&lt;vector&lt;ENTITY&gt;&gt;;\n// MAP_WIDTH x MAP_HEIGHT multidimensional vector\nTILE_MAP tileMap(MAP_WIDTH, vector&lt;ENTITY&gt;(MAP_HEIGHT)); \n\nfor (unsigned int row = 0; row &lt; MAP_HEIGHT; row++)\n{\n    for (unsigned int col = 0; col &lt; MAP_WIDTH; col++)\n    {\n        tileMap [row][col] = WALL;\n    }\n}\n</code></pre>\n\n<p>Calling an element of a vector after it has been filled has the same syntax as an array.</p>\n\n<pre><code>tileMap[2][4]\n</code></pre>\n\n<p>You can also check the length of the vector:</p>\n\n<pre><code>int rows = tileMap.size();\nif( rows &gt; 0 )\n   int columnsInRow0 = tileMap[0].size()\n</code></pre>\n\n<p>While you are at it you should look into other containers like Maps and Sets since they make your life easier.</p>\n\n<p>Edit:</p>\n\n<p>Since you want to know how to make a dynamic array not using a vector I will give you an answer: std::vector is the C++ defined dynamically sized array. C arrays will not change size after they are defined, vector will.</p>\n\n<p>However I think you are asking about the ability to define runtime constant sized arrays. So I will explain what they are and why you should not use them.</p>\n\n<p>When you define the C array you are probably getting a warning saying that the expression needs to be constant.</p>\n\n<p>A C array is a pointer to the stack. And the implementation of the compiletime C array is that it needs to be a constant size at compile time.</p>\n\n<pre><code>int compiletimeArray[] = { 1, 2, 3 };\n// turns out c arrays are pointers\nint* ptr = compiletimeArray;\n// prints 2\nstd::cout &lt;&lt; compiletimeArray[1];\n// prints 2\nstd::cout &lt;&lt; ptr[1];\n// prints 2\nstd::cout &lt;&lt; *(compiletimeArray + 1);\n// also prints 2\nstd::cout &lt;&lt; *(ptr + 1); //move pointer 1 element and de-reference\n</code></pre>\n\n<p>Pointers are like a whiteboard with a telephone number written on it. The same kind of issues occur as with telephone numbers; number on whiteboard has been erased, number on whiteboard has changed, recipient does not exist, recipient changed their number, service provider running out of available numbers to give new users... Keep that in mind.</p>\n\n<p>To get create a runtime constant sized array you need to allocate the array on the heap and assign it to a pointer.</p>\n\n<pre><code>int size = 4;\nint* runtimeArray = new int[size];           // this will work\ndelete[] runtimeArray;                       // de-allocate\nsize = 8;                                    // change size\nruntimeArray = new int[size];                // allocate a new array\n</code></pre>\n\n<p>The main difference between the stack and heap is that the stack will de-allocate the memory used by a variable when the program exits the scope the variable was declared in, on the other hand anything declared on the heap will still remain in memory and has to be explicitly de-allocated or you will get a memory leak.  </p>\n\n<pre><code> // You must call this when you are never going to use the data at the memory address again\n // release the memory from the heap\n delete[] runtimeArray; // akin to releasing a phone number to be used by someone else\n</code></pre>\n\n<p>If you do not release memory from the heap eventually you will run out.</p>\n\n<pre><code> // Try running this\n void crashingFunction() {\n   while(true)\n   {\n       // every time new[] is called ptr is assigned a new address, the memory at the old address is not freed\n       // 90001 ints worth of space(generally 32 or 64 bytes each int) is reserved on the heap\n       int* ptr = new int[90001]; // new[] eventually crashes because your system runs out of memory space to give\n   }\n }\n\n void okFunction() {\n   // Try running this\n   while(true)\n   {\n       // every time new[] is called ptr is assigned a new address, the old is not freed\n       // 90001 ints worth of space is reserved on the heap\n       int* ptr = new int[90001]; // never crashes\n       delete[] ptr; // reserved space above is de-allocated \n   }\n }\n</code></pre>\n\n<p>Why use std::vector? Because std::vector internally manages the runtime array. </p>\n\n<pre><code> // allocates for you\n vector(int size) {\n      // ...\n      runtimeArray = new runtimeArray[size];\n }\n\n // When the vector exits scope the deconstructor is called and it deletes allocated memory\n //   So you do not have to remember to do it yourself\n ~vector() { \n      // ...\n      delete[] runtimeArray;\n }\n</code></pre>\n\n<p>So if you had the same scenario as last time</p>\n\n<pre><code> void vectorTestFunction() {\n   // Try running this\n   while(true)\n   {\n       std::vector&lt;int&gt; vec(9001); // internally allocates memory\n   } // &lt;-- deallocates memory here because ~vector is called\n }\n</code></pre>\n\n<p>If you want to use a runtime constant array I suggest the std:array container. It is like vector in that it manages its internal memory but is optimized for if you never need to add new elements. It is declared just like vector but does not contain resizing functions after its constructor.</p>\n"}], "owner": {"reputation": 57, "user_id": 6711722, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/402ac325434a452c9e1755b86550975e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/6711722/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 239, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473363521, "creation_date": 1473255896, "last_edit_date": 1473256407, "question_id": 39371617, "link": "https://stackoverflow.com/questions/39371617/attempting-to-create-a-dynamic-array", "title": "Attempting to create a dynamic array", "body": "<p>I have the following piece of code, which is only half on the entire code:</p>\n\n<pre><code>// Declare map elements using an enumeration\nenum entity_labels {\n    EMPTY = 0,\n    WALL\n};\ntypedef entity_labels   ENTITY;\n\n// Define an array of ASCII codes to use for visualising the map\nconst int TOKEN[2] = {\n    32,     // EMPTY\n    178     // WALL\n};\n\n// create type aliases for console and map array buffers\n\nusing GUI_BUFFER = CHAR_INFO[MAP_HEIGHT][MAP_WIDTH];\nusing MAP_BUFFER = ENTITY[MAP_HEIGHT][MAP_WIDTH];\n\n//Declare application subroutines\nvoid InitConsole(unsigned int, unsigned int);\nvoid ClearConsole(HANDLE hStdOut);\nWORD GetKey();\nvoid DrawMap(MAP_BUFFER &amp; rMap);\n\n\n/**************************************************************************\n  * Initialise the standard output console\n  */\nHANDLE  hStdOut = GetStdHandle(STD_OUTPUT_HANDLE);\nif (hStdOut != INVALID_HANDLE_VALUE)\n{\n    ClearConsole(hStdOut);\n\n    // Set window title\n    SetConsoleTitle(TEXT(\"Tile Map Demo\"));\n\n    // Set window size\n    SMALL_RECT srWindowRect;\n    srWindowRect.Left = 0;\n    srWindowRect.Top = 0;\n    srWindowRect.Bottom = srWindowRect.Top + MAP_HEIGHT;\n    srWindowRect.Right = srWindowRect.Left + MAP_WIDTH;\n\n    SetConsoleWindowInfo(hStdOut, true, &amp;srWindowRect);\n\n    // Set screen buffer size\n    COORD cWindowSize = { MAP_WIDTH, MAP_HEIGHT };\n    SetConsoleScreenBufferSize(hStdOut, cWindowSize);\n}\n/*************************************************************************/\n\n\n/*************************************************************************\n* Initialise the tile map with appropriate ENTITY values\n*/\n\nMAP_BUFFER tileMap;\n\nfor (unsigned int row = 0; row &lt; MAP_HEIGHT; row++)\n{\n    for (unsigned int col = 0; col &lt; MAP_WIDTH; col++)\n    {\n        tileMap [row][col] = WALL;\n    }\n}\n</code></pre>\n\n<p>Essentially the entire code is used to create a tile map and output it to screen but I'm attempting to make tileMap a dynamic array in runtime. \nI have tried creating one down where the tileMap is being created.\nI've tried creating one just after \"entity_lables\" are given the typedef \"ENTITY\".\nI've tried creating one after the \"MAP_BUFFER\" and \"GUI_BUFFER\" become aliases.\nBut still I'm at a loss, I have no idea on how to successfully implement a dynamic array to tileMap, and I certainly don't know the best spot to put it.</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["c++", "posix"], "comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 1, "creation_date": 1473255796, "post_id": 39371527, "comment_id": 66071066, "body": "Into milliseconds starting from when?? do you mean a UNIX epoch timestamp?"}, {"owner": {"reputation": 514, "user_id": 3101811, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ba5f8730303c43ef341089d9ddd29972?s=128&d=identicon&r=PG", "display_name": "Will_Panda", "link": "https://stackoverflow.com/users/3101811/will-panda"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 1, "creation_date": 1473255846, "post_id": 39371527, "comment_id": 66071097, "body": "@GillBates I will be given a string in the format mentioned above."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 1, "creation_date": 1473255900, "post_id": 39371527, "comment_id": 66071145, "body": "Yes, but that&#39;s just a date, you can&#39;t convert some random date to milliseconds without knowing what the start point is."}, {"owner": {"reputation": 5455, "user_id": 4115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2688a9684db617a20f9da3959e5890d7?s=128&d=identicon&r=PG&f=1", "display_name": "Danh", "link": "https://stackoverflow.com/users/4115625/danh"}, "edited": false, "score": 2, "creation_date": 1473255980, "post_id": 39371527, "comment_id": 66071205, "body": "@Will_Panda He meant which epoch do you use? to calculate number of ms from. Like &quot;20160907-05:00:54.123 is 123 ms from &quot;20160907-05:00:54.000"}, {"owner": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "edited": false, "score": 0, "creation_date": 1473255984, "post_id": 39371527, "comment_id": 66071209, "body": "Is boost an option <a href=\"http://www.boost.org/doc/libs/1_56_0/doc/html/date_time/date_time_io.html\" rel=\"nofollow noreferrer\">boost.org/doc/libs/1_56_0/doc/html/date_time/date_time_io.ht&zwnj;&#8203;ml</a>?"}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "edited": false, "score": 0, "creation_date": 1473256085, "post_id": 39371527, "comment_id": 66071290, "body": "@antonio &quot;I can&#39;t use third party libraries as well&quot;."}, {"owner": {"reputation": 514, "user_id": 3101811, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ba5f8730303c43ef341089d9ddd29972?s=128&d=identicon&r=PG", "display_name": "Will_Panda", "link": "https://stackoverflow.com/users/3101811/will-panda"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1473256518, "post_id": 39371527, "comment_id": 66071632, "body": "@GillBates Sorry I misunderstood your question. Yes I am using UNIX epoch."}, {"owner": {"reputation": 1820, "user_id": 6797552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/196e325077d7a6e974c49ccaea2681c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shmuel H.", "link": "https://stackoverflow.com/users/6797552/shmuel-h"}, "edited": false, "score": 0, "creation_date": 1473257165, "post_id": 39371527, "comment_id": 66072112, "body": "Can you use C++11?"}, {"owner": {"reputation": 3740, "user_id": 1030870, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8f96f7ac4f0bf4c2421a9f58b6893400?s=128&d=identicon&r=PG", "display_name": "Mine", "link": "https://stackoverflow.com/users/1030870/mine"}, "edited": false, "score": 0, "creation_date": 1473257433, "post_id": 39371527, "comment_id": 66072301, "body": "Try <code>std::get_time</code>?"}, {"owner": {"reputation": 514, "user_id": 3101811, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ba5f8730303c43ef341089d9ddd29972?s=128&d=identicon&r=PG", "display_name": "Will_Panda", "link": "https://stackoverflow.com/users/3101811/will-panda"}, "reply_to_user": {"reputation": 3740, "user_id": 1030870, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8f96f7ac4f0bf4c2421a9f58b6893400?s=128&d=identicon&r=PG", "display_name": "Mine", "link": "https://stackoverflow.com/users/1030870/mine"}, "edited": false, "score": 0, "creation_date": 1473257772, "post_id": 39371527, "comment_id": 66072547, "body": "@Mine I tried using it. But it needs breakpoints to split apparently. My date format doesn&#39;t have any breakpoints."}, {"owner": {"reputation": 3740, "user_id": 1030870, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8f96f7ac4f0bf4c2421a9f58b6893400?s=128&d=identicon&r=PG", "display_name": "Mine", "link": "https://stackoverflow.com/users/1030870/mine"}, "edited": false, "score": 0, "creation_date": 1473258745, "post_id": 39371527, "comment_id": 66073394, "body": "@Will_Panda <code>std::get_time(&amp;when, &quot;%Y%m%d-%H:%M:%S&quot;);</code> should do, just without miliseconds"}, {"owner": {"reputation": 1820, "user_id": 6797552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/196e325077d7a6e974c49ccaea2681c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shmuel H.", "link": "https://stackoverflow.com/users/6797552/shmuel-h"}, "edited": false, "score": 0, "creation_date": 1473258813, "post_id": 39371527, "comment_id": 66073434, "body": "<code>strptime</code> <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strptime.html\" rel=\"nofollow noreferrer\">doesn&#39;t support milliseconds</a>.  By the way, what about just sscanf?"}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1473259189, "post_id": 39371527, "comment_id": 66073726, "body": "Which compiler are you using? Visual C++ added C++ 11 support and get_time specifically in Visual Studio 2010"}, {"owner": {"reputation": 514, "user_id": 3101811, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ba5f8730303c43ef341089d9ddd29972?s=128&d=identicon&r=PG", "display_name": "Will_Panda", "link": "https://stackoverflow.com/users/3101811/will-panda"}, "reply_to_user": {"reputation": 3740, "user_id": 1030870, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8f96f7ac4f0bf4c2421a9f58b6893400?s=128&d=identicon&r=PG", "display_name": "Mine", "link": "https://stackoverflow.com/users/1030870/mine"}, "edited": false, "score": 0, "creation_date": 1473306064, "post_id": 39371527, "comment_id": 66091910, "body": "@Mine I used std::get_time(&amp;t, &quot;%Y%m%d-%H:%M:%S&quot;) but parsing fails."}], "answers": [{"comments": [{"owner": {"reputation": 514, "user_id": 3101811, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ba5f8730303c43ef341089d9ddd29972?s=128&d=identicon&r=PG", "display_name": "Will_Panda", "link": "https://stackoverflow.com/users/3101811/will-panda"}, "edited": false, "score": 0, "creation_date": 1473258042, "post_id": 39372386, "comment_id": 66072760, "body": "Thank you. Yes I was planning to opt to this option in case I can&#39;t find an elegant solution."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 514, "user_id": 3101811, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ba5f8730303c43ef341089d9ddd29972?s=128&d=identicon&r=PG", "display_name": "Will_Panda", "link": "https://stackoverflow.com/users/3101811/will-panda"}, "edited": false, "score": 0, "creation_date": 1473258081, "post_id": 39372386, "comment_id": 66072792, "body": "@Will_Panda :-) I unfortunately agree - it is not the most elegant thing constructed; more like ugly brown duct-tape."}, {"owner": {"reputation": 514, "user_id": 3101811, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ba5f8730303c43ef341089d9ddd29972?s=128&d=identicon&r=PG", "display_name": "Will_Panda", "link": "https://stackoverflow.com/users/3101811/will-panda"}, "edited": false, "score": 0, "creation_date": 1473258178, "post_id": 39372386, "comment_id": 66072879, "body": "A duct-tape is a duct-tape nevertheless. :)"}, {"owner": {"reputation": 3740, "user_id": 1030870, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8f96f7ac4f0bf4c2421a9f58b6893400?s=128&d=identicon&r=PG", "display_name": "Mine", "link": "https://stackoverflow.com/users/1030870/mine"}, "edited": false, "score": 1, "creation_date": 1473258953, "post_id": 39372386, "comment_id": 66073543, "body": "Except for the miliseconds part, <code>std::get_time(&amp;when, &quot;%Y%m%d-%H:%M:%S&quot;);</code> looks cleaner."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 3740, "user_id": 1030870, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8f96f7ac4f0bf4c2421a9f58b6893400?s=128&d=identicon&r=PG", "display_name": "Mine", "link": "https://stackoverflow.com/users/1030870/mine"}, "edited": false, "score": 0, "creation_date": 1473259061, "post_id": 39372386, "comment_id": 66073629, "body": "@Mine I agree (also wrote that in the answer); note the question isn&#39;t tagged as c++11, though. The milliseconds are an inherent problem, BTW, as <code>tm</code> seems to have no sub-second field."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1473259291, "post_id": 39372386, "comment_id": 66073798, "body": "@AmiTavory Visual C++ added C++11 support and get_time specifically in 2010."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1473259455, "post_id": 39372386, "comment_id": 66073942, "body": "@PanagiotisKanavos Well, where <code>get_time</code> exists, that&#39;s the way to go, then - I agree. Am not that familiar with Visual C++ (and it doesn&#39;t look like the question is tagged like it), so thanks for the info! Will update the answer."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1473259835, "post_id": 39372386, "comment_id": 66074248, "body": "The OP mentioned Windows. It&#39;s either Visual C++ or gcc. Some projects are stuck with ancient Borland or Microsoft compilers though (think 1998)"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1473259878, "post_id": 39372386, "comment_id": 66074296, "body": "@PanagiotisKanavos Well, I added your correct remark to the answer. Thanks again."}, {"owner": {"reputation": 514, "user_id": 3101811, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ba5f8730303c43ef341089d9ddd29972?s=128&d=identicon&r=PG", "display_name": "Will_Panda", "link": "https://stackoverflow.com/users/3101811/will-panda"}, "reply_to_user": {"reputation": 3740, "user_id": 1030870, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8f96f7ac4f0bf4c2421a9f58b6893400?s=128&d=identicon&r=PG", "display_name": "Mine", "link": "https://stackoverflow.com/users/1030870/mine"}, "edited": false, "score": 0, "creation_date": 1473306766, "post_id": 39372386, "comment_id": 66092057, "body": "@Mine It worked when the format is in like &quot;2011.01.05-05:05:05&quot; where there are delimiters in the date. But without delimiters parsing failed."}, {"owner": {"reputation": 514, "user_id": 3101811, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ba5f8730303c43ef341089d9ddd29972?s=128&d=identicon&r=PG", "display_name": "Will_Panda", "link": "https://stackoverflow.com/users/3101811/will-panda"}, "edited": false, "score": 0, "creation_date": 1473307827, "post_id": 39372386, "comment_id": 66092266, "body": "@AmiTavory The year should be the last two digits plus 100 right? Because we are taking time from Unix epoch. So 2016 becomes 116. (1900+116)."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 514, "user_id": 3101811, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ba5f8730303c43ef341089d9ddd29972?s=128&d=identicon&r=PG", "display_name": "Will_Panda", "link": "https://stackoverflow.com/users/3101811/will-panda"}, "edited": false, "score": 0, "creation_date": 1473311975, "post_id": 39372386, "comment_id": 66093360, "body": "@Will_Panda I don&#39;t think so. Once the <code>tm</code> structure is properly set up (except for the seconds, which is a separate issue), <a href=\"http://stackoverflow.com/questions/11979655/how-to-convert-a-time-into-epoch-time\"><code>mktime</code>  already does that for you</a>."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 514, "user_id": 3101811, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ba5f8730303c43ef341089d9ddd29972?s=128&d=identicon&r=PG", "display_name": "Will_Panda", "link": "https://stackoverflow.com/users/3101811/will-panda"}, "edited": false, "score": 0, "creation_date": 1473312095, "post_id": 39372386, "comment_id": 66093407, "body": "@Will_Panda One thing I&#39;ve just noticed from the answer there is that the months seem 0 based, so you might want to pay attention to that if your input is 1 based."}, {"owner": {"reputation": 514, "user_id": 3101811, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ba5f8730303c43ef341089d9ddd29972?s=128&d=identicon&r=PG", "display_name": "Will_Panda", "link": "https://stackoverflow.com/users/3101811/will-panda"}, "edited": false, "score": 0, "creation_date": 1473312165, "post_id": 39372386, "comment_id": 66093429, "body": "I tried and it didn&#39;t work. But the way i suggested worked. Anyways I am going to use this approach and hence I will accept this answer. :-)"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 514, "user_id": 3101811, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ba5f8730303c43ef341089d9ddd29972?s=128&d=identicon&r=PG", "display_name": "Will_Panda", "link": "https://stackoverflow.com/users/3101811/will-panda"}, "edited": false, "score": 0, "creation_date": 1473312230, "post_id": 39372386, "comment_id": 66093459, "body": "@Will_Panda Oh, thanks for the comment (and the upvote)! I&#39;ll play around with it too to see what&#39;s happening. Good luck!"}, {"owner": {"reputation": 143, "user_id": 8123074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0309565b51ceb4c4406865b77fc50e3?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian B.", "link": "https://stackoverflow.com/users/8123074/adrian-b"}, "edited": false, "score": 0, "creation_date": 1613690230, "post_id": 39372386, "comment_id": 117161235, "body": "Nothing about mktime() using the locale timezone ? As an example (not tested), it will not work if the locale timezone is &quot;America/Montreal&quot; and the tm contains UTC values."}], "tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": true, "score": 3, "last_activity_date": 1473259573, "last_edit_date": 1473259573, "creation_date": 1473257862, "answer_id": 39372386, "question_id": 39371527, "link": "https://stackoverflow.com/questions/39371527/convert-date-time-to-milliseconds-c-cross-platform/39372386#39372386", "title": "Convert Date-Time to Milliseconds - C++ - cross platform", "body": "<p>Given the format of your string, it is fairly easy to parse it as follows (although a regex or <code>get_time</code> might be more elegant):</p>\n\n<pre><code>tm t;\nt.tm_year = stoi(s.substr(0, 4));\nt.tm_mon = stoi(s.substr(4, 2));\nt.tm_mday = stoi(s.substr(6, 2));\nt.tm_hour = stoi(s.substr(9, 2));\nt.tm_min = stoi(s.substr(12, 2));\nt.tm_sec = 0;\ndouble sec = stod(s.substr(15));\n</code></pre>\n\n<p>Finding the time since the epoch can be done with <a href=\"http://linux.die.net/man/3/mktime\" rel=\"nofollow\"><code>mktime</code></a>:</p>\n\n<pre><code>mktime(&amp;t) + sec * 1000\n</code></pre>\n\n<p>Note that the fractional seconds need to be handled differently - unfortunately, <a href=\"http://www.cplusplus.com/reference/ctime/tm/\" rel=\"nofollow\"><code>tm</code> has only integer seconds</a>.</p>\n\n<p>(See the full code <a href=\"https://ideone.com/WFNfYK\" rel=\"nofollow\">here</a>.)</p>\n\n<hr>\n\n<p><strong>Edit</strong></p>\n\n<p>As Mine and Panagiotis Kanavos correctly note in the comments, Visual C++ apparently supports <code>get_time</code> for quite a while, and it's much shorter with it (note that the fractional seconds need to be handled the same way, though).</p>\n"}, {"comments": [{"owner": {"reputation": 514, "user_id": 3101811, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ba5f8730303c43ef341089d9ddd29972?s=128&d=identicon&r=PG", "display_name": "Will_Panda", "link": "https://stackoverflow.com/users/3101811/will-panda"}, "edited": false, "score": 0, "creation_date": 1473306324, "post_id": 39374005, "comment_id": 66091969, "body": "Yes. This works and you are right I have to make sure the input is valid. But I was looking for something more elegant rather than splitting the each element individually. Thank you."}], "tags": [], "owner": {"reputation": 1820, "user_id": 6797552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/196e325077d7a6e974c49ccaea2681c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shmuel H.", "link": "https://stackoverflow.com/users/6797552/shmuel-h"}, "is_accepted": false, "score": 6, "last_activity_date": 1473262619, "last_edit_date": 1473262619, "creation_date": 1473262271, "answer_id": 39374005, "question_id": 39371527, "link": "https://stackoverflow.com/questions/39371527/convert-date-time-to-milliseconds-c-cross-platform/39374005#39374005", "title": "Convert Date-Time to Milliseconds - C++ - cross platform", "body": "<p>What about <code>std::sscanf</code>? </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstring&gt;\n\nint main() {\n    const char *str_time = \"20160907-05:00:54.123\";\n    unsigned int year, month, day, hour, minute, second, miliseconds;\n\n    if (std::sscanf(str_time, \"%4u%2u%2u-%2u:%2u:%2u.%3u\", &amp;year, &amp;month,\n               &amp;day, &amp;hour, &amp;minute, &amp;second,&amp;miliseconds) != 7)\n    {\n        std::cout &lt;&lt; \"Parse failed\" &lt;&lt; std::endl;\n    } \n    else\n    {\n        std::cout &lt;&lt; year &lt;&lt; month &lt;&lt; day &lt;&lt; \"-\" &lt;&lt; hour &lt;&lt; \":\" \n                  &lt;&lt; minute &lt;&lt; \":\" &lt;&lt; second &lt;&lt; \".\" &lt;&lt; miliseconds\n                  &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n\n<p><strong>Output</strong> (<a href=\"https://ideone.com/bxVSyT\" rel=\"noreferrer\">ideone</a>):\n201697-5:0:54.123.</p>\n\n<p>However, you should make sure the input is valid (for example, day can be in the range of [0,99]).</p>\n"}, {"comments": [{"owner": {"reputation": 514, "user_id": 3101811, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ba5f8730303c43ef341089d9ddd29972?s=128&d=identicon&r=PG", "display_name": "Will_Panda", "link": "https://stackoverflow.com/users/3101811/will-panda"}, "edited": false, "score": 0, "creation_date": 1473305395, "post_id": 39378196, "comment_id": 66091769, "body": "It looks like a great option. But unfortunately I can&#39;t use any."}], "tags": [], "owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "is_accepted": false, "score": 4, "last_activity_date": 1473279158, "last_edit_date": 1473279158, "creation_date": 1473278846, "answer_id": 39378196, "question_id": 39371527, "link": "https://stackoverflow.com/questions/39371527/convert-date-time-to-milliseconds-c-cross-platform/39378196#39378196", "title": "Convert Date-Time to Milliseconds - C++ - cross platform", "body": "<p>Too bad about no 3rd party libraries, because <a href=\"https://github.com/HowardHinnant/date/blob/master/date.h\" rel=\"nofollow\">here is one</a> (MIT license) that is just a single header, runs on linux and Windows, and handles the milliseconds seamlessly:</p>\n\n<pre><code>#include \"date.h\"\n#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n\nint\nmain()\n{\n    date::sys_time&lt;std::chrono::milliseconds&gt; tp;\n    std::istringstream in{\"20160907-05:00:54.123\"};\n    date::parse(in, \"%Y%m%d-%T\", tp);\n    std::cout &lt;&lt; tp.time_since_epoch().count() &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>This outputs:</p>\n\n<pre><code>1473224454123\n</code></pre>\n\n<p>Error checking is done for you.  The stream will <code>fail()</code> if the date is invalid.</p>\n\n<p><code>date::sys_time&lt;std::chrono::milliseconds&gt;</code> is a type alias for <code>std::chrono::time_point&lt;std::chrono::system_clock, std::chrono::milliseconds&gt;</code>.  I.e. it is from the family of <code>system_clock::time_point</code>, just <code>milliseconds</code> precision.</p>\n\n<p>Fully documented:</p>\n\n<p><a href=\"https://howardhinnant.github.io/date/date.html\" rel=\"nofollow\">https://howardhinnant.github.io/date/date.html</a></p>\n\n<p>Doesn't get much more elegant than this.</p>\n"}], "owner": {"reputation": 514, "user_id": 3101811, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ba5f8730303c43ef341089d9ddd29972?s=128&d=identicon&r=PG", "display_name": "Will_Panda", "link": "https://stackoverflow.com/users/3101811/will-panda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4702, "favorite_count": 1, "accepted_answer_id": 39372386, "answer_count": 3, "score": 3, "last_activity_date": 1473279158, "creation_date": 1473255646, "last_edit_date": 1473255797, "question_id": 39371527, "link": "https://stackoverflow.com/questions/39371527/convert-date-time-to-milliseconds-c-cross-platform", "title": "Convert Date-Time to Milliseconds - C++ - cross platform", "body": "<p>I want to convert a string in the format of \"20160907-05:00:54.123\" into milliseconds. \nI know that <strong><em>strptime</em></strong> is not available in Windows and I want to run my program in both windows and linux. I can't use third party libraries as well.\nI can tokenize the string and convert it. But is there a more elegant way like using the strptime to do so?</p>\n"}, {"tags": ["android", "c++", "android-ndk", "virtual-serial-port"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473256890, "post_id": 39371524, "comment_id": 66071916, "body": "There is no language &quot;C/C++&quot;! Only the two different languages C and C++."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 6804849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8995c3991904caad4491aad97a54517?s=128&d=identicon&r=PG&f=1", "display_name": "Claudia Ramos", "link": "https://stackoverflow.com/users/6804849/claudia-ramos"}, "is_accepted": true, "score": 3, "last_activity_date": 1474037996, "creation_date": 1474037996, "answer_id": 39534598, "question_id": 39371524, "link": "https://stackoverflow.com/questions/39371524/read-write-bytes-within-two-processes-apps-using-virtual-serial-communication/39534598#39534598", "title": "Read/Write bytes within two processes (apps) using virtual serial communication on Android", "body": "<p>I have solved the problem so I will post the solution in case someone else is interested:</p>\n\n<p>(1) Your phone should be rooted.</p>\n\n<p>(2) The master opens a port in the form \"/dev/pts/N\" (variable <em>pts_name</em> in this example) where N is a number. This port is given by: </p>\n\n<pre><code>int fd = open(\"/dev/ptmx\", O_RDWR | O_NOCTTY);  \nif (fd == -1) {\n     LOGW(\"error opening file\");\n     return 1;  \n}  \nchar* pts_name = ptsname(fd);  \nLOGI(\"ptsname: %s\\n\", pts_name);\n</code></pre>\n\n<p>(3) Give permissions to the port (this can be done programmatically or from the adb shell). From the shell would be:</p>\n\n<ul>\n<li>su</li>\n<li>chmod 666 pts_name (for example chmod 666 /dev/pts/4).</li>\n</ul>\n\n<p>(4) Execute the slave which opens exactly this port. For example int fd = open(\"/dev/pts/4\", O_RDWR);</p>\n\n<p>(5) Voil\u00e0!</p>\n"}], "owner": {"reputation": 51, "user_id": 6804849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8995c3991904caad4491aad97a54517?s=128&d=identicon&r=PG&f=1", "display_name": "Claudia Ramos", "link": "https://stackoverflow.com/users/6804849/claudia-ramos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 39534598, "answer_count": 1, "score": 2, "last_activity_date": 1474037996, "creation_date": 1473255635, "last_edit_date": 1473257012, "question_id": 39371524, "link": "https://stackoverflow.com/questions/39371524/read-write-bytes-within-two-processes-apps-using-virtual-serial-communication", "title": "Read/Write bytes within two processes (apps) using virtual serial communication on Android", "body": "<p>I have written a C/C++ application (NDK) for Android which can open a virtual port for serial communication. It writes and reads bytes from the port within the same process. This is so far working and I didn\u00b4t have to root my device in order to do this. It is a simple programm which does the following: </p>\n\n<pre><code>int fd = open(\"/dev/ptmx\", O_RDWR | O_NOCTTY);\nif (fd == -1) {\n    LOGW(\"error opening file\");\n\n    return 1;\n}\n\ngrantpt(fd);\nunlockpt(fd);\n\nchar* pts_name = ptsname(fd);\nLOGI(\"ptsname: %s\\n\", pts_name);\n\nchar* inputbyte = \"This is a test\\n\";\n\nchar byte;\n\nint numOfBytesWritten = write(fd, inputbyte, strlen(inputbyte));\nLOGI(\"Number of bytes written: %d\\n\", numOfBytesWritten);\n\nwhile (read(fd, &amp;byte, 1) == 1) {\nLOGI(\"Byte: %c\\n\", byte);\n}\n\nclose(fd);\n</code></pre>\n\n<p>Now the problem is that if I want to do this same thing within two processes (two apps) it doesn\u00b4t work. One process opens /dev/ptmx, and the other process should open the /dev/pts directory. Everytime the slave tries to open the /dev/pts directory I get the error \"error opening file\" (-1). I have rooted my device and this is still not working. I have a sleep function after opening the /dev/ptmx directory in order to wait for the slave.</p>\n\n<p>What should I do? Any ideas? </p>\n"}, {"tags": ["c++", "c++14", "variadic-templates"], "comments": [{"owner": {"reputation": 7052, "user_id": 3854570, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d7bda3cab79b9bc5570667f8c0e24134?s=128&d=identicon&r=PG&f=1", "display_name": "Nelfeal", "link": "https://stackoverflow.com/users/3854570/nelfeal"}, "edited": false, "score": 0, "creation_date": 1473256031, "post_id": 39371345, "comment_id": 66071248, "body": "Why not make <code>Chrs</code> a <code>char...</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1473257106, "post_id": 39372002, "comment_id": 66072067, "body": "Ok, in case of a known type you are right. My question is imprecise. It should fit to any parameter type like <code>mystring&lt;1,2,3&gt;</code> and others. I updated my question. Sorry for my unclear wording."}, {"owner": {"reputation": 7052, "user_id": 3854570, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d7bda3cab79b9bc5570667f8c0e24134?s=128&d=identicon&r=PG&f=1", "display_name": "Nelfeal", "link": "https://stackoverflow.com/users/3854570/nelfeal"}, "edited": false, "score": 3, "creation_date": 1473257292, "post_id": 39372002, "comment_id": 66072190, "body": "What is <code>mystring&lt;1,2,3&gt;().c_str()</code> supposed to be ? <code>&quot;123&quot;</code> ?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1473257402, "post_id": 39372002, "comment_id": 66072281, "body": "@Klaus That&#39;s not much of a string at that point. But added a general array bit."}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1473257689, "post_id": 39372002, "comment_id": 66072503, "body": "Thanks for the hint to c++17. So in conclusion it can not be done with c++14, right?"}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "reply_to_user": {"reputation": 7052, "user_id": 3854570, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d7bda3cab79b9bc5570667f8c0e24134?s=128&d=identicon&r=PG&f=1", "display_name": "Nelfeal", "link": "https://stackoverflow.com/users/3854570/nelfeal"}, "edited": false, "score": 0, "creation_date": 1473258053, "post_id": 39372002, "comment_id": 66072770, "body": "@Nelxiost: Sorry, you are right. The use case is a copy of a working example and with <code>int</code> it makes no sense at all. But it should be possible to find use cases for the requested template definition problem. My question goes to the template syntax for a parameter pack of an unknown type."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 3, "last_activity_date": 1506554153, "last_edit_date": 1506554153, "creation_date": 1473256859, "answer_id": 39372002, "question_id": 39371345, "link": "https://stackoverflow.com/questions/39371345/template-which-takes-a-pack-of-type-t/39372002#39372002", "title": "template which takes a pack of type T", "body": "<p>The same way you're doing it right now. Except instead of using <code>T</code>, where <code>T</code> is a template parameter, just use <code>char</code> directly:</p>\n\n<pre><code>template &lt;char... Chrs&gt;\nstruct mystring\n{\n    /* rest as before */\n};\n</code></pre>\n\n<p>Of course this now only works for <code>char</code> and not <code>wchar_t</code> (but then again, so does the original) </p>\n\n<hr />\n\n<p>You can generalize this by writing something like:</p>\n\n<pre><code>template &lt;class T, T... Vals&gt;\nstruct array { ... };\n\ntemplate &lt;char... Chrs&gt;\nusing mystring  = array&lt;char, Chrs...&gt;;\n</code></pre>\n\n<p>In C++17, we'll have <code>template auto</code> which would let you write:</p>\n\n<pre><code>template &lt;auto... Vals&gt;\nstruct array { /* .. */ };\n</code></pre>\n\n<p>and then it's up to you to verify that all the <code>Vals</code> are the same type. Perhaps via:</p>\n\n<pre><code>template &lt;auto Val, decltype(Val)... Vals&gt;\nstruct array { /* .. */ };\n</code></pre>\n"}], "owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 39372002, "answer_count": 1, "score": 3, "last_activity_date": 1506554153, "creation_date": 1473255225, "last_edit_date": 1473257176, "question_id": 39371345, "link": "https://stackoverflow.com/questions/39371345/template-which-takes-a-pack-of-type-t", "title": "template which takes a pack of type T", "body": "<p>I have the following minimal code fragment which compiles and executes as expected:</p>\n\n<pre><code>template &lt; class T, T... Chrs&gt;\nstruct mystring\n{\n    static auto c_str()\n    {\n        static char str[] = {Chrs..., 0};\n        return str;\n    }\n\n};\n\ntemplate &lt;class T, T... Chrs&gt;\nauto operator\"\"_t()\n{\n    return mystring&lt;T, Chrs...&gt;();\n}\n\nint main()\n{\n    auto x = \"Hallo\"_t ;\n    std::cout &lt;&lt; x.c_str() &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Question:</p>\n\n<p>Is it possible to write the template <code>mystring</code> in a way that it excepts:</p>\n\n<pre><code> auto x = mystring&lt;'a','b','c'&gt;();\n</code></pre>\n\n<p>but also</p>\n\n<pre><code> auto x = mystring&lt; 1,2,3&gt; ();\n</code></pre>\n\n<p>or any other type.</p>\n\n<p>I have no idea how to write something like ( pseudo code ):</p>\n\n<pre><code>template &lt; T ... Chrs&gt; // how to define T here?\nstruct mystring\n{ }\n</code></pre>\n\n<p>Also the following is not allowed:</p>\n\n<pre><code>template &lt;typename T, T ...Chrs &gt;\nstruct mystring&lt;T...Chrs&gt; {};\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "c++-standard-library"], "answers": [{"comments": [{"owner": {"reputation": 5978, "user_id": 954927, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/RxggX.png?s=128&g=1", "display_name": "Neutrino", "link": "https://stackoverflow.com/users/954927/neutrino"}, "edited": false, "score": 0, "creation_date": 1473260278, "post_id": 39371506, "comment_id": 66074616, "body": "That does work but disable_recursion_pending is only available in VS2015 and I&#39;m trying to do this in VS2012. Documentation for disable_recursion_pending states that it &quot;stores true in no_push&quot;, VS2012 has a no_push method instead, but the effect of that is to disable recursion in every subsequent tree node not just the one you call it on. This also seems totally broken because that&#39;s not how the Boost implementation that the tr2 filesystem library is based on behaves. In the Boost implementation no_push sensibly only applies to the node the iterator is currently pointing to."}, {"owner": {"reputation": 4427, "user_id": 193887, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/54a2fc2a8cb81440a442aa45fc0f41a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/193887/jeremy"}, "reply_to_user": {"reputation": 5978, "user_id": 954927, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/RxggX.png?s=128&g=1", "display_name": "Neutrino", "link": "https://stackoverflow.com/users/954927/neutrino"}, "edited": false, "score": 0, "creation_date": 1473266019, "post_id": 39371506, "comment_id": 66078251, "body": "The description of <code>pop()</code> that you quote is for VS2015 - the description of <code>pop()</code> for VS2012 says only <code>Discontinues reading in the current subdirectory and increments the iterator</code> - with no guarantees about what will happen subsequently."}, {"owner": {"reputation": 5978, "user_id": 954927, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/RxggX.png?s=128&g=1", "display_name": "Neutrino", "link": "https://stackoverflow.com/users/954927/neutrino"}, "edited": false, "score": 0, "creation_date": 1473324477, "post_id": 39371506, "comment_id": 66099601, "body": "You&#39;re right about that, I&#39;m testing this in VS2012 and VS2015 and I copied the documentation snippet from the wrong page. It still doesn&#39;t increment the iterator in VS2012 though."}, {"owner": {"reputation": 4427, "user_id": 193887, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/54a2fc2a8cb81440a442aa45fc0f41a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/193887/jeremy"}, "reply_to_user": {"reputation": 5978, "user_id": 954927, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/RxggX.png?s=128&g=1", "display_name": "Neutrino", "link": "https://stackoverflow.com/users/954927/neutrino"}, "edited": false, "score": 0, "creation_date": 1473326553, "post_id": 39371506, "comment_id": 66100872, "body": "Personally I think that expecting the VS2012 implementation to work is asking too much.  And expecting it to work the same as Boost is asking way more.  (For example, as you point out, <code>no_push()</code> doesn&#39;t even take an argument, so the even the API is already at odds with even the first revision of the TR2 proposal.)"}], "tags": [], "owner": {"reputation": 4427, "user_id": 193887, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/54a2fc2a8cb81440a442aa45fc0f41a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/193887/jeremy"}, "is_accepted": false, "score": 0, "last_activity_date": 1473255588, "creation_date": 1473255588, "answer_id": 39371506, "question_id": 39371227, "link": "https://stackoverflow.com/questions/39371227/is-visual-studio-recursive-directory-iterator-pop-broken/39371506#39371506", "title": "Is Visual Studio recursive_directory_iterator.pop() broken?", "body": "<p>Isn't the code you want more like the following, using <a href=\"http://en.cppreference.com/w/cpp/filesystem/recursive_directory_iterator/disable_recursion_pending\" rel=\"nofollow\"><code>disable_recursion_pending()</code></a>?</p>\n\n<pre><code>   while (it != recursive_directory_iterator())\n   {\n      if (it-&gt;path().filename() == \"A\")\n      {\n         it.disable_recursion_pending();\n      }\n      ++it;\n   }\n</code></pre>\n"}], "owner": {"reputation": 5978, "user_id": 954927, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/RxggX.png?s=128&g=1", "display_name": "Neutrino", "link": "https://stackoverflow.com/users/954927/neutrino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473255588, "creation_date": 1473254897, "question_id": 39371227, "link": "https://stackoverflow.com/questions/39371227/is-visual-studio-recursive-directory-iterator-pop-broken", "title": "Is Visual Studio recursive_directory_iterator.pop() broken?", "body": "<p>Given an example directory tree for testing:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Root\n   A\n      A1\n      A2\n   B\n      B1\n      B2\n</code></pre>\n\n<p>I wish to recursively enumerate the directories, but skip the processing of directory A completely.</p>\n\n<p>According to the MSDN documentation code something like the following should do the job:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void TestRecursion1()\n{\n   path directory_path(\"Root\");\n   recursive_directory_iterator it(directory_path);\n\n   while (it != recursive_directory_iterator())\n   {\n      if (it-&gt;path().filename() == \"A\")\n      {\n         it.pop();\n      }\n      else\n      {\n         ++it;\n      }\n   }\n}\n</code></pre>\n\n<p>...it does not. MSDN for recursive_directory_iterator.pop() states</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>If depth() == 0 the object becomes an end-of-sequence iterator. \nOtherwise, the member function terminates scanning of the current\n(deepest) directory and resumes at the next lower depth.\n</code></pre>\n\n<p>What actually happens is that due to a short circuit test in pop() if 'depth == 0' nothing happens at all, the iterator is neither incremented nor does it become the end of sequence iterator and the program enters an infinite loop.</p>\n\n<p>The issue seems to be that semantically pop() is intended to shunt processing of the tree to the next level higher than the current level, whereas in this example I wish to skip processing of A and continue processing at B. The first problem is that both these directories (A and B) exist at the same level in the tree, the second problem is that this level is also the top level of the tree so there is no higher level at which to resume processing. All that said it still seems like a bug that pop() fails to set the iterator to the end-of-sequence iterator thus causing an infinite loop.</p>\n\n<p>After this testing I reasoned that if I can't pop() A directly, I should at least be able to pop() from any child of A and achieve a similar result. I tested this with the following code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;class TContainer&gt;\nbool begins_with(const TContainer&amp; input, const TContainer&amp; match)\n{\n   return input.size() &gt;= match.size()\n      &amp;&amp; equal(match.begin(), match.end(), input.begin());\n}\n\nvoid TestRecursion2()\n{\n   path base_path(\"C:\\\\_Home\\\\Development\\\\Workspaces\\\\Scratch \\\\TestDirectoryRecursion\\\\bin\\\\Debug\\\\Root\");\n   recursive_directory_iterator it(base_path);\n\n   while (it != recursive_directory_iterator())\n   {\n      string relative_path =  it-&gt;path().parent_path().string().substr(base_path.string().size());\n      cout &lt;&lt; relative_path &lt;&lt; \"\\n\";\n\n      if (begins_with(relative_path, string(\"\\\\A\")))\n      {\n         it.pop();\n      }\n      else\n      {\n         cout &lt;&lt; it-&gt;path().filename() &lt;&lt; \" depth:\" &lt;&lt; it.depth() &lt;&lt; \"\\n\";\n         ++it;\n      }\n   }\n}\n</code></pre>\n\n<p>Here I test every item being processed to determine whether its parent is Root\\A, and if it is call pop(). Even this doesn't work. The test correctly identifies whether a node in the tree is a child of A and calls pop() accordingly, but even at this deeper level pop() still fails to increment the iterator, again causing an infinite loop. What's more, even if this <em>did</em> work it would still be very undesirable since there is no guarantee of the order in which sub nodes are enumerated, so despite the test to check whether a particular node is a child of A because those nodes might be indirect children you could still end up processing a goodly amount of A anyway.</p>\n\n<p>I think my next course of action is to abandon use of this recursive_directory_iterator and drive the recursion manually using a standard directory_iterator, but it seems as if I should be able to achieve what I need more simply with the recursive_directory_iterator but I'm getting blocked at every turn. So my questions are:</p>\n\n<p>Is the recursive_directory_iterator.pop() method broken?</p>\n\n<p>If not how do I use it to skip the processing of a directory?</p>\n"}, {"tags": ["c++", "sorting", "vector", "set", "compare"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1473254081, "post_id": 39370916, "comment_id": 66069865, "body": "You cannot sort associative containers(set, map, and the unordered counterparts)."}, {"owner": {"reputation": 4718, "user_id": 152359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9462dee3e00416ea83771eead7902e1c?s=128&d=identicon&r=PG", "display_name": "Hayt", "link": "https://stackoverflow.com/users/152359/hayt"}, "edited": false, "score": 1, "creation_date": 1473254183, "post_id": 39370916, "comment_id": 66069936, "body": "see here: <a href=\"http://en.cppreference.com/w/cpp/container/set\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/set</a> your set can have a custom comparator. With this you can custumize the &quot;order&quot; inside your set and also what is considered &quot;unique&quot;"}, {"owner": {"reputation": 19910, "user_id": 1621391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ec331963e9d60347c1e80e294b14940c?s=128&d=identicon&r=PG", "display_name": "WhiZTiM", "link": "https://stackoverflow.com/users/1621391/whiztim"}, "edited": false, "score": 0, "creation_date": 1473254559, "post_id": 39370916, "comment_id": 66070230, "body": "And, rather than this recursive use of <code>std::pair</code>, why don&#39;t you just use a <code>tuple</code> or better still a simple <code>struct</code> to aggregate the elements?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6804842, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153760309500841/picture?type=large", "display_name": "Dilia Mar&#237;a Portillo Quintero", "link": "https://stackoverflow.com/users/6804842/dilia-mar%c3%ada-portillo-quintero"}, "edited": false, "score": 0, "creation_date": 1473254658, "post_id": 39371102, "comment_id": 66070294, "body": "Thanks Benson!  I just realize that I have to construct a  struct that compares   struct Cmp       { \tbool operator ()(const pair&lt; pair&lt;int, int&gt;, double &gt; &amp;a, const pair&lt; pair&lt;int, int&gt;, double &gt;  &amp;b) \t{ \t  return a.second &lt; b.second; \t}       };"}], "tags": [], "owner": {"reputation": 1194, "user_id": 6800367, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6MJwj.jpg?s=128&g=1", "display_name": "Benson Lin", "link": "https://stackoverflow.com/users/6800367/benson-lin"}, "is_accepted": false, "score": 2, "last_activity_date": 1473254540, "creation_date": 1473254540, "answer_id": 39371102, "question_id": 39370916, "link": "https://stackoverflow.com/questions/39370916/how-to-order-a-set-pair-pairint-int-double-for-the-second-value-doubl/39371102#39371102", "title": "How to order a set&lt; pair&lt; pair&lt;int, int&gt;, double &gt; &gt; for the second value &quot;double&quot;?", "body": "<p>If you wish to sort according to the <code>.second</code> element of the pair, then why not placing the <code>double</code> in front of the <code>pair&lt;int,int&gt;</code>? Sorting orders pairs by their first element then their second element, thus instead of</p>\n\n<pre><code>set&lt; pair &lt;pair&lt;int, int&gt;, double &gt; &gt; map\n</code></pre>\n\n<p>You could use</p>\n\n<pre><code>set&lt; pair &lt;double, pair&lt;int, int&gt; &gt; &gt; map\n</code></pre>\n\n<p>Also I suggest not using keywords as variable names (<code>map</code> is an in-built data structure in C++)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6804842, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153760309500841/picture?type=large", "display_name": "Dilia Mar&#237;a Portillo Quintero", "link": "https://stackoverflow.com/users/6804842/dilia-mar%c3%ada-portillo-quintero"}, "is_accepted": false, "score": 0, "last_activity_date": 1473254870, "creation_date": 1473254870, "answer_id": 39371220, "question_id": 39370916, "link": "https://stackoverflow.com/questions/39370916/how-to-order-a-set-pair-pairint-int-double-for-the-second-value-doubl/39371220#39371220", "title": "How to order a set&lt; pair&lt; pair&lt;int, int&gt;, double &gt; &gt; for the second value &quot;double&quot;?", "body": "<p>Thanks Benson!  I just realize that I have to construct a  struct that compares</p>\n\n<pre><code>s struct Cmp\n  {\n   bool operator ()(const pair&lt; pair&lt;int, int&gt;, double &gt; &amp;a, const pair&lt; pair&lt;int, int&gt;, double &gt;  &amp;b)\n   {\n    return a.second &lt; b.second;\n   }\n  };\n  set&lt; pair&lt; pair&lt;int, int&gt;, double &gt; , Cmp&gt; map;\n</code></pre>\n\n<p>Thanks for the advise!</p>\n"}], "owner": {"reputation": 1, "user_id": 6804842, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153760309500841/picture?type=large", "display_name": "Dilia Mar&#237;a Portillo Quintero", "link": "https://stackoverflow.com/users/6804842/dilia-mar%c3%ada-portillo-quintero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473254870, "creation_date": 1473254024, "question_id": 39370916, "link": "https://stackoverflow.com/questions/39370916/how-to-order-a-set-pair-pairint-int-double-for-the-second-value-doubl", "title": "How to order a set&lt; pair&lt; pair&lt;int, int&gt;, double &gt; &gt; for the second value &quot;double&quot;?", "body": "<p>I am super new in C++ and I am really struggling with this: I want to organize my second component of the set:</p>\n\n<pre><code>set&lt; pair &lt;pair&lt;int, int&gt;, double &gt; &gt; map\nint N_t = 10, N_r = 10;\nfor (unsigned int i_t = 0; i_t &lt; N_t; i_t++ )\n {\n for(unsigned int i_r = 0; i_r &lt; N_r; i_r++ )\n  {\n   Double_t dR = i_t*i_r ;\n   map.insert( make_pair(make_pair(i_r, i_t) ,dR));\n   }\n }\n</code></pre>\n\n<p>And I want to organice the second component. I have try this and I dont know how to to it:</p>\n\n<pre><code>sort(map.begin(), map.end(), [](const pair&lt;pair&lt;int,int&gt; &amp;x, double&gt;,const pair&lt;pair&lt;int,int&gt;, double&gt; &amp;y)\n{\n  return x.second &lt; y.second;\n });\n</code></pre>\n\n<p>Thanks!!</p>\n"}, {"tags": ["c++", "inheritance", "unordered-set"], "comments": [{"owner": {"reputation": 19910, "user_id": 1621391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ec331963e9d60347c1e80e294b14940c?s=128&d=identicon&r=PG", "display_name": "WhiZTiM", "link": "https://stackoverflow.com/users/1621391/whiztim"}, "edited": false, "score": 0, "creation_date": 1473254018, "post_id": 39370880, "comment_id": 66069820, "body": "<i>&quot;And, unto you, this day, I tell you, Thou shall not inherit from an STL Container&quot;</i> ...Prefer Composition over inheritance"}, {"owner": {"reputation": 4718, "user_id": 152359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9462dee3e00416ea83771eead7902e1c?s=128&d=identicon&r=PG", "display_name": "Hayt", "link": "https://stackoverflow.com/users/152359/hayt"}, "edited": false, "score": 1, "creation_date": 1473254053, "post_id": 39370880, "comment_id": 66069843, "body": "also see here: <a href=\"http://stackoverflow.com/questions/2034916/is-it-okay-to-inherit-implementation-from-stl-containers-rather-than-delegate\" title=\"is it okay to inherit implementation from stl containers rather than delegate\">stackoverflow.com/questions/2034916/&hellip;</a>"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1473254662, "post_id": 39370880, "comment_id": 66070297, "body": "This could only make sense to me if you intended your <code>DrinksList</code> to be everything an <code>std::unordered_set</code> is. I suspect that is not really the case. I suspect <code>std::unordered_set</code> is more of an <i>implementation detail</i> and those are best hidden from outsiders. At the very least I would consider <code>private</code> inheritance, but most likely <i>composition</i> is the way to go (make <code>std::unordered_set</code> a <i>member</i>). Also <b>don&#39;t</b> do this if you intend to use <code>DrinksList</code> <i>polymorphically</i> because badstuff."}, {"owner": {"reputation": 1, "user_id": 6131665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bfa065ca2b6b1d48bd568a845aca21?s=128&d=identicon&r=PG&f=1", "display_name": "DrCampy", "link": "https://stackoverflow.com/users/6131665/drcampy"}, "edited": false, "score": 0, "creation_date": 1473254896, "post_id": 39370880, "comment_id": 66070440, "body": "Thanks guys. I do not intend to use polymorphism with that class. I indeed do not need the user of that class (that is me but let&#39;s imagine) to know that it is an unordered set. I will use composition.  I did not know that it was evil to inherit from STL containers but now, I know ;)"}], "owner": {"reputation": 1, "user_id": 6131665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bfa065ca2b6b1d48bd568a845aca21?s=128&d=identicon&r=PG&f=1", "display_name": "DrCampy", "link": "https://stackoverflow.com/users/6131665/drcampy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "closed_date": 1473254954, "answer_count": 0, "score": 0, "last_activity_date": 1473253943, "creation_date": 1473253943, "question_id": 39370880, "link": "https://stackoverflow.com/questions/39370880/unordered-set-and-inheritance-good-practice", "closed_reason": "Duplicate", "title": "(unordered_)set and inheritance, good practice?", "body": "<p>I'm working on a personal project which requires at some point to manage a list of drinks. I planned to manage them by their name and not an ID.\nhat I first thought is an unordered_set because I do not specifically need them to be sorted alphabetically. I also need to export/import such a list. \nI have a class: </p>\n\n<pre><code>class DrinkList : public std::unordered_set&lt;Drink&gt;{\n\npublic:\n\nvoid import();\nvoid export();\n\n};\n</code></pre>\n\n<p>Is it a good idea or should I create a class containing an unordered_set with functions to interact with it ?</p>\n\n<p>If I should keep it the way it is, what should I do as constructor/deconstructor? It is a bit blurry to me :/</p>\n\n<p>Thank you for your help!</p>\n"}, {"tags": ["c++", "multithreading", "qt", "signals-slots"], "comments": [{"owner": {"reputation": 731, "user_id": 4600847, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2hdPz.jpg?s=128&g=1", "display_name": "tobilocker", "link": "https://stackoverflow.com/users/4600847/tobilocker"}, "edited": false, "score": 0, "creation_date": 1473255756, "post_id": 39370841, "comment_id": 66071036, "body": "if you really want to connect the signals and slots from inside the slot&#39;s scope you need to pass <code>Qt::UniqueConnection</code> to <code>connect</code> like: <code>connect(thread, SIGNAL (started()), calculationManager.data(), SLOT (process()), Qt::UniqueConnection);</code>"}, {"owner": {"reputation": 1438, "user_id": 3732337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LzGs.jpg?s=128&g=1", "display_name": "HazemGomaa", "link": "https://stackoverflow.com/users/3732337/hazemgomaa"}, "edited": false, "score": 4, "creation_date": 1473273043, "post_id": 39370841, "comment_id": 66081665, "body": "<a href=\"http://stackoverflow.com/questions/3530590/qt-signals-and-slot-connected-twice-what-happens\" title=\"qt signals and slot connected twice what happens\">stackoverflow.com/questions/3530590/&hellip;</a> (duplicate ?)"}], "answers": [{"comments": [{"owner": {"reputation": 483, "user_id": 1138688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a351fb5d7eb25907f5136ffa23f18fb?s=128&d=identicon&r=PG", "display_name": "retinotop", "link": "https://stackoverflow.com/users/1138688/retinotop"}, "edited": false, "score": 0, "creation_date": 1473257833, "post_id": 39370979, "comment_id": 66072589, "body": "Yes, that&#39;s what @Evgeny described before..."}], "tags": [], "owner": {"reputation": 2714, "user_id": 843458, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e600bfa3509ddea2d693514cbe11bbdb?s=128&d=identicon&r=PG", "display_name": "Matthias Pospiech", "link": "https://stackoverflow.com/users/843458/matthias-pospiech"}, "is_accepted": false, "score": 1, "last_activity_date": 1473254215, "creation_date": 1473254215, "answer_id": 39370979, "question_id": 39370841, "link": "https://stackoverflow.com/questions/39370841/qt-slot-from-thread-called-more-than-once/39370979#39370979", "title": "Qt slot from thread called more than once", "body": "<p>Doing all connections withint the pushbotton slot was the reason. The connection is thus done multiple times.</p>\n\n<pre><code>void MainWindow::on_pushButtonStartFFT_clicked()\n{\n    ...\n    connect(thread, SIGNAL (started()), calculationManager.data(), SLOT (process()));\n}\n</code></pre>\n\n<p>Once this is moved to the gui constructor everything works fine</p>\n"}, {"tags": [], "owner": {"reputation": 3575, "user_id": 2750816, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c28ad318c9e95eda7bf7ee211db86a76?s=128&d=identicon&r=PG", "display_name": "Evgeny", "link": "https://stackoverflow.com/users/2750816/evgeny"}, "is_accepted": false, "score": 4, "last_activity_date": 1473254284, "creation_date": 1473254284, "answer_id": 39371008, "question_id": 39370841, "link": "https://stackoverflow.com/questions/39370841/qt-slot-from-thread-called-more-than-once/39371008#39371008", "title": "Qt slot from thread called more than once", "body": "<p>Every time you click the button, you create this connections</p>\n\n<pre><code>connect(thread, SIGNAL (started()), calculationManager.data(), SLOT (process()));\nconnect(calculationManager.data(), SIGNAL (finished()), thread, SLOT (quit()));\nconnect(calculationManager.data(), SIGNAL (finished()), this, SLOT (getResultsAndPlot()));\n</code></pre>\n\n<p>So, after first click there is one connection and slot <code>process()</code> called once. After second click there are two connections and this slot called twice. And so on. Just make this connections outside slot <code>on_pushButtonStartFFT_clicked()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1438, "user_id": 3732337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LzGs.jpg?s=128&g=1", "display_name": "HazemGomaa", "link": "https://stackoverflow.com/users/3732337/hazemgomaa"}, "is_accepted": false, "score": 0, "last_activity_date": 1473273818, "last_edit_date": 1473273818, "creation_date": 1473273431, "answer_id": 39376976, "question_id": 39370841, "link": "https://stackoverflow.com/questions/39370841/qt-slot-from-thread-called-more-than-once/39376976#39376976", "title": "Qt slot from thread called more than once", "body": "<p>Agree with @Matthias Pospiech. One option you have if you want to use connect on button click is to use disconnect before connect, as per <a href=\"http://doc.qt.io/qt-4.8/qobject.html#disconnect\" rel=\"nofollow\">http://doc.qt.io/qt-4.8/qobject.html#disconnect</a> ... This way you ensure that your signal is connected only one time ...  for example, </p>\n\n<pre><code>void MainWindow::on_pushButtonStartFFT_clicked()\n{\n... \n\n disconnect(thread, SIGNAL (started()), calculationManager.data(), SLOT(process()));\n connect(thread, SIGNAL (started()), calculationManager.data(), SLOT(process())); \n\n...\n}\n</code></pre>\n"}], "owner": {"reputation": 2714, "user_id": 843458, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e600bfa3509ddea2d693514cbe11bbdb?s=128&d=identicon&r=PG", "display_name": "Matthias Pospiech", "link": "https://stackoverflow.com/users/843458/matthias-pospiech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 0, "closed_date": 1473291730, "answer_count": 3, "score": -1, "last_activity_date": 1473273818, "creation_date": 1473253831, "question_id": 39370841, "link": "https://stackoverflow.com/questions/39370841/qt-slot-from-thread-called-more-than-once", "closed_reason": "Duplicate", "title": "Qt slot from thread called more than once", "body": "<p>I have created a class CalculationManager which has a public slot process() emitting a signal finished().</p>\n\n<pre><code>void CalculationManager::process()\n{\n    cout &lt;&lt; \"calc FFT: process()\" &lt;&lt; endl;\n    ...\n    emit finished();\n}\n</code></pre>\n\n<p>This is used with a QThread from the gui (calculationManager is a QScopedPointer)</p>\n\n<pre><code>void MainWindow::on_pushButtonStartFFT_clicked()\n{\n    cout &lt;&lt; \"on_pushButtonStartFFT_clicked()\" &lt;&lt; endl;\n\n    ...\n    calculationManager-&gt;moveToThread(thread);\n\n    connect(thread, SIGNAL (started()), calculationManager.data(), SLOT (process()));\n    connect(calculationManager.data(), SIGNAL (finished()), thread, SLOT (quit()));\n    connect(calculationManager.data(), SIGNAL (finished()), this, SLOT (getResultsAndPlot()));\n\n    cout &lt;&lt; \"FFT thread started.\" &lt;&lt; endl;\n    thread-&gt;start();\n}\n</code></pre>\n\n<p>with a slot for the plots</p>\n\n<pre><code>void MainWindow::getResultsAndPlot()\n{\n    fftAction doShift = static_cast&lt;fftAction&gt;(calculationManager-&gt;shiftBeforeFFT());\n\n    updatePlotData(ui-&gt;qplot1, calculationManager-&gt;data(doShift) );\n    cout &lt;&lt; \"update plots\" &lt;&lt; endl;\n}\n</code></pre>\n\n<p>At startup of the gui the function is called. and the output is as expected:</p>\n\n<pre><code>on_pushButtonStartFFT_clicked()\nFFT thread started.\ncalc FFT: process()\nupdate plots\n</code></pre>\n\n<p>however every further click on the buttons calls process multiple times and getResultsAndPlot() even more often. I have not clue why this happens. How can I debug or solve this ?</p>\n\n<pre><code>on_pushButtonStartFFT_clicked()\nFFT thread started.\ncalc FFT: process()\ncalc FFT: process()\nupdate plots\nupdate plots\nupdate plots\nupdate plots\non_pushButtonStartFFT_clicked()\nFFT thread started.\ncalc FFT: process()\ncalc FFT: process()\ncalc FFT: process()\nupdate plots\nupdate plots\nupdate plots\nupdate plots\nupdate plots\nupdate plots\nupdate plots\nupdate plots\nupdate plots\n</code></pre>\n"}, {"tags": ["c++", "ffmpeg"], "comments": [{"owner": {"reputation": 8454, "user_id": 958529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3ec25db39c63bab1a11037649e326b8?s=128&d=identicon&r=PG", "display_name": "halfelf", "link": "https://stackoverflow.com/users/958529/halfelf"}, "edited": false, "score": 0, "creation_date": 1473301868, "post_id": 39370835, "comment_id": 66091042, "body": "You have set <code>--disable-static</code> in configure cmd line while you want a static lib?"}, {"owner": {"reputation": 2051, "user_id": 1672927, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/66f6cd793f1a4545226095400c11eea7?s=128&d=identicon&r=PG&f=1", "display_name": "HRM", "link": "https://stackoverflow.com/users/1672927/hrm"}, "reply_to_user": {"reputation": 8454, "user_id": 958529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3ec25db39c63bab1a11037649e326b8?s=128&d=identicon&r=PG", "display_name": "halfelf", "link": "https://stackoverflow.com/users/958529/halfelf"}, "edited": false, "score": 0, "creation_date": 1473394320, "post_id": 39370835, "comment_id": 66132878, "body": "@halfelf: If I enable-static, I&#39;ll get <code>.a</code> files only; but what I want actually is <code>.lib</code> files only for linking in visual studio."}, {"owner": {"reputation": 8454, "user_id": 958529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3ec25db39c63bab1a11037649e326b8?s=128&d=identicon&r=PG", "display_name": "halfelf", "link": "https://stackoverflow.com/users/958529/halfelf"}, "edited": false, "score": 0, "creation_date": 1473397842, "post_id": 39370835, "comment_id": 66133838, "body": "MinGW generated <code>.a</code> libs are compatible with VC most of the time. You need to add them to linker input in visual studio. However, if you really want to make sure the binary compatibility, it&#39;s better to compile ffmpeg with msvc."}, {"owner": {"reputation": 387, "user_id": 2432174, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/ioAZo.jpg?s=128&g=1", "display_name": "dinu0101", "link": "https://stackoverflow.com/users/2432174/dinu0101"}, "edited": false, "score": 0, "creation_date": 1544208795, "post_id": 39370835, "comment_id": 94208238, "body": "Also, I have same issue. I cloned project <a href=\"https://github.com/ShiftMediaProject/FFmpeg/\" rel=\"nofollow noreferrer\">link</a>. I created successfully project on MSVC 2017.It create only lib but not creating <b>dll</b>. Please help me to generate <b>dll</b>"}], "owner": {"reputation": 2051, "user_id": 1672927, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/66f6cd793f1a4545226095400c11eea7?s=128&d=identicon&r=PG&f=1", "display_name": "HRM", "link": "https://stackoverflow.com/users/1672927/hrm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 429, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473256512, "creation_date": 1473253824, "question_id": 39370835, "link": "https://stackoverflow.com/questions/39370835/ffmpeg-generate-libs-only", "title": "ffmpeg generate libs only", "body": "<p>I'm trying to build ffmpeg static libraries to be used in VC++.\nFrom a fedora machine I'm able to build ffmpeg successfully using the following configure option.</p>\n\n<pre><code>/configure --pkg-config=mingw32-pkg-config --prefix=$INSTALL_ROOT --disable-static --enable-memalign-hack --arch=x86 --target-os=mingw32 --cross-prefix=i686-w64-mingw32- --enable-shared\n</code></pre>\n\n<p>After generating the dlls, I've tried using <code>lib.exe</code> tool to generate libs. </p>\n\n<pre><code>lib /machine:i386 /def:avcodec-56.def /out:avcodec.lib\n</code></pre>\n\n<p>I'm getting lib files but the size of lib file is too small which indicates that I need dll also during the runtime. But what I need is single lib file which can be statically linked to one of my VC++ project and that project dll is only required. So my question is how to generate lib files only? (not lib and dll)</p>\n\n<p>Any help would be appreciated. Thanks.</p>\n"}, {"tags": ["c++", "c++11", "smart-pointers", "unique-ptr", "ownership"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1473253894, "post_id": 39370779, "comment_id": 66069736, "body": "Ask yourself: If it is <code>const</code> can it be moved from?"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 1, "creation_date": 1473253914, "post_id": 39370779, "comment_id": 66069751, "body": "Are you saying there are lots of examples that fail to compile? The one you show certainly does. In particular, <code>_child(std::move(child))</code> part makes no sense."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 4, "creation_date": 1473254000, "post_id": 39370779, "comment_id": 66069807, "body": "Trying to move a  <code>const</code> unique_ptr will fail to compile as copying is deleted and there is no constructor that takes a const rvalue ref."}, {"owner": {"reputation": 610, "user_id": 3628232, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6e9915bded70c0e2fc473af214357d9?s=128&d=identicon&r=PG&f=1", "display_name": "Peet Whittaker", "link": "https://stackoverflow.com/users/3628232/peet-whittaker"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1473254592, "post_id": 39370779, "comment_id": 66070251, "body": "@IgorTandetnik that&#39;s not what I was implying at all - both versions compile fine :)"}, {"owner": {"reputation": 610, "user_id": 3628232, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6e9915bded70c0e2fc473af214357d9?s=128&d=identicon&r=PG&f=1", "display_name": "Peet Whittaker", "link": "https://stackoverflow.com/users/3628232/peet-whittaker"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1473254806, "post_id": 39370779, "comment_id": 66070372, "body": "@GillBates - ah yes, good point! I felt like I was missing something, but couldn&#39;t quite place it :) Feel free to add it as an answer and I&#39;ll mark it as correct"}, {"owner": {"reputation": 610, "user_id": 3628232, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6e9915bded70c0e2fc473af214357d9?s=128&d=identicon&r=PG&f=1", "display_name": "Peet Whittaker", "link": "https://stackoverflow.com/users/3628232/peet-whittaker"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1473255303, "post_id": 39370779, "comment_id": 66070720, "body": "@RichardHodges the question originally had a typo in - it&#39;s now been edited out."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1473255344, "post_id": 39370779, "comment_id": 66070747, "body": "@PeetWhittaker I see. I&#39;m always late to the party... Will remove the comment."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1473255964, "post_id": 39370779, "comment_id": 66071195, "body": "@richardhodges Ctrl + F5 at least 10 times a minute."}, {"owner": {"reputation": 3497, "user_id": 4973224, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LYTV7.jpg?s=128&g=1", "display_name": "Lmn", "link": "https://stackoverflow.com/users/4973224/lmn"}, "edited": false, "score": 1, "creation_date": 1473317674, "post_id": 39370779, "comment_id": 66095758, "body": "Ask yourself: what would Jesus do?"}], "answers": [{"comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "reply_to_user": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1473254992, "post_id": 39371204, "comment_id": 66070508, "body": "@nwp Why sholdn&#39;t it? It doesn&#39;t attempt to copy or move an instance of <code>Parent</code>."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1473255044, "post_id": 39371204, "comment_id": 66070545, "body": "@nwp because it constructs a <code>unique_ptr</code> through the moved <i>non</i> const <code>child</code>."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 1, "creation_date": 1473255072, "post_id": 39371204, "comment_id": 66070564, "body": "@IgorTandetnik Nothing in the question states that <code>Parent</code> must be movable, and it could be made to."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1473255120, "post_id": 39371204, "comment_id": 66070597, "body": "The question asked about <code>_child</code> being <code>const</code>, the member variable, not <code>child</code> the parameter."}, {"owner": {"reputation": 610, "user_id": 3628232, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6e9915bded70c0e2fc473af214357d9?s=128&d=identicon&r=PG&f=1", "display_name": "Peet Whittaker", "link": "https://stackoverflow.com/users/3628232/peet-whittaker"}, "edited": false, "score": 0, "creation_date": 1473255243, "post_id": 39371204, "comment_id": 66070673, "body": "I see in the original question that I made a small error, the <code>Parent</code> constructor should have taken <code>std::unique_ptr&lt;Child&gt;&amp;&amp;</code> as its param, not <code>Child&amp;&amp;</code>. I&#39;m not sure that would affect things though?"}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 1, "creation_date": 1473255346, "post_id": 39371204, "comment_id": 66070749, "body": "Not much, as @nwp said the current implementation allows moving into the const unique_ptr but this prevents any copy or move operation for Parent as the const unique ptr is disallowing it."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "reply_to_user": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 3, "creation_date": 1473255486, "post_id": 39371204, "comment_id": 66070847, "body": "@nwp The OP asked what the &quot;unexpected side effects&quot; might be of making <code>_child</code> member const. Rendering <code>Parent</code> non-movable is a side effect that the OP didn&#39;t appear to expect."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1473255623, "post_id": 39371204, "comment_id": 66070936, "body": "@IgorTandetnik I agree, and that is what I wrote in my answer. This answer, however, is talking about a compilation error and I&#39;m not sure where/why that would be."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1473255668, "post_id": 39371204, "comment_id": 66070968, "body": "@nwp &quot;if you&#39;d try to make your <code>_child</code> const and move it you&#39;d get a nice compilation error&quot; note the <i>and move it</i> (through moving <code>Parent</code>)."}], "tags": [], "owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "is_accepted": true, "score": 8, "last_activity_date": 1473255077, "last_edit_date": 1473255077, "creation_date": 1473254819, "answer_id": 39371204, "question_id": 39370779, "link": "https://stackoverflow.com/questions/39370779/marking-stdunique-ptr-class-member-as-const/39371204#39371204", "title": "Marking std::unique_ptr class member as const", "body": "<p>Because of the nature of a <code>std::unique_ptr</code>(sole ownership of an object) it's required to have no copy constructor whatsoever. The <a href=\"http://en.cppreference.com/w/cpp/memory/unique_ptr/unique_ptr\" rel=\"noreferrer\">move constructor</a>(6) only takes non-const rvalue-references which means that if you'd try to make your <code>_child</code> <code>const</code> and move it you'd get a nice compilation error :)</p>\n\n<p>Even if a custom <code>unique_ptr</code> would take a const rvalue-reference it would be impossible to implement.</p>\n"}, {"comments": [{"owner": {"reputation": 610, "user_id": 3628232, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6e9915bded70c0e2fc473af214357d9?s=128&d=identicon&r=PG&f=1", "display_name": "Peet Whittaker", "link": "https://stackoverflow.com/users/3628232/peet-whittaker"}, "edited": false, "score": 0, "creation_date": 1473255555, "post_id": 39371217, "comment_id": 66070893, "body": "Good points. Probably explains why I haven&#39;t seen it before in any examples!"}], "tags": [], "owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "is_accepted": false, "score": 1, "last_activity_date": 1473255184, "last_edit_date": 1473255184, "creation_date": 1473254861, "answer_id": 39371217, "question_id": 39370779, "link": "https://stackoverflow.com/questions/39370779/marking-stdunique-ptr-class-member-as-const/39371217#39371217", "title": "Marking std::unique_ptr class member as const", "body": "<p>The downsides are like with any <code>const</code> member: That the assignment and move-assignment operators don't work right (they would require you to overwrite <code>_child</code>) and that moving from the parent would not steal the <code>_child</code> (performance bug). Also it is uncommon to write code like this, possibly confusing people.</p>\n\n<p>The gain is marginal because <code>_child</code> is <code>private</code> and therefore can only be accessed from inside the <code>Parent</code>, so the amount of code that can break invariants revolving around changing <code>_child</code> is limited to member functions and friends which need to be able to maintain invariants anyways.</p>\n\n<p>I cannot imagine a situation where the gain would outweigh the downsides, but if you do you can certainly do it your way without breakage of other parts of the program.</p>\n"}, {"tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": false, "score": 1, "last_activity_date": 1473329135, "creation_date": 1473329135, "answer_id": 39388074, "question_id": 39370779, "link": "https://stackoverflow.com/questions/39370779/marking-stdunique-ptr-class-member-as-const/39388074#39388074", "title": "Marking std::unique_ptr class member as const", "body": "<p>Yes, you can do this, and it's what I regularly do when implementing UI classes in Qt:</p>\n\n<pre><code>namespace Ui {\n    class MyWidget\n}\n\nclass MyWidget : public QWidget\n{\n    Q_OBJECT  \n\n    const std::unique_ptr&lt;Ui::MyWidget&gt; ui;\n\npublic:\n    explicit MyWidgetQWidget *parent = 0)\n        : ui(new Ui::MyWidget{})\n    {\n    }\n\n    ~MyWidgetQWidget();\n    // destructor defined as = default in implementation file,\n    // where Ui::MyWidget is complete\n}\n</code></pre>\n\n<p>It's exactly comparable to writing <code>Ui::MyWidget *const ui</code> in C++03 code.</p>\n\n<p>The above code creates a new object, but there's no reason not to pass one in using <code>std::move()</code> as in the question.</p>\n"}], "owner": {"reputation": 610, "user_id": 3628232, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6e9915bded70c0e2fc473af214357d9?s=128&d=identicon&r=PG&f=1", "display_name": "Peet Whittaker", "link": "https://stackoverflow.com/users/3628232/peet-whittaker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1590, "favorite_count": 0, "accepted_answer_id": 39371204, "answer_count": 3, "score": 10, "last_activity_date": 1473329135, "creation_date": 1473253662, "last_edit_date": 1473254264, "question_id": 39370779, "link": "https://stackoverflow.com/questions/39370779/marking-stdunique-ptr-class-member-as-const", "title": "Marking std::unique_ptr class member as const", "body": "<p>A lot of the examples for using <code>std::unique_ptr</code> to manage ownership of class dependencies look like the following:</p>\n\n<pre><code>class Parent\n{\npublic:\n    Parent(Child&amp;&amp; child) :\n    _child(std::make_unique&lt;Child&gt;(std::move(child))){}\nprivate:\n    std::unique_ptr&lt;Child&gt; _child;\n};\n</code></pre>\n\n<p>My question is whether marking the <code>_child</code> member as <code>const</code> have any unexpected side effects? (Aside from being ensuring that <code>reset()</code>, <code>release()</code> etc. cannot be called on <code>_child</code>).</p>\n\n<p>I ask since I have not yet seen it in an example and don't whether that is intentional or just for brevity/generality.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "edited": false, "score": 1, "creation_date": 1473253722, "post_id": 39370741, "comment_id": 66069613, "body": "Could you be a little more clear about what a &#39;treble&#39; is, I am slightly confused, do you mean as in triple?"}, {"owner": {"reputation": 483, "user_id": 1138688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a351fb5d7eb25907f5136ffa23f18fb?s=128&d=identicon&r=PG", "display_name": "retinotop", "link": "https://stackoverflow.com/users/1138688/retinotop"}, "edited": false, "score": 1, "creation_date": 1473253784, "post_id": 39370741, "comment_id": 66069654, "body": "I think you should use a debug tool -&gt; and some pen and paper ;)  this would be good for your code understanding..."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1473253800, "post_id": 39370741, "comment_id": 66069667, "body": "You mean you want something like <a href=\"http://melpon.org/wandbox/permlink/JIaKlSHnE7vBA9lF\" rel=\"nofollow noreferrer\">this</a>?"}], "answers": [{"tags": [], "owner": {"reputation": 1194, "user_id": 6800367, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6MJwj.jpg?s=128&g=1", "display_name": "Benson Lin", "link": "https://stackoverflow.com/users/6800367/benson-lin"}, "is_accepted": true, "score": 0, "last_activity_date": 1473254090, "creation_date": 1473254090, "answer_id": 39370935, "question_id": 39370741, "link": "https://stackoverflow.com/questions/39370741/if-treble-product-of-first-2-digits/39370935#39370935", "title": "If treble product of first 2 digits", "body": "<pre><code> if ((n&gt;1) &amp;&amp; (n&lt;1000)) {\n       s = n/10;\n    d = n/100%10; // 2.\n    k = n/1000%100%10; //1.\n    w = n/10%10; //3.\n\n    product = k*d;\n\n}\n</code></pre>\n\n<p>This part should be your \"treble\" part. This line is the issue:</p>\n\n<pre><code>product = k*d;.\n</code></pre>\n\n<p>If <code>n &lt; 1000</code>, then k becomes <code>0%100%10</code> which is <code>0</code>. Thus your product is 0. I think your intention was:</p>\n\n<pre><code>product = w*d;\n</code></pre>\n\n<p>For the general solution, repeatedly divide and take the running product of the modulus. Like this:</p>\n\n<pre><code>n = n/10;\nproduct = 1;\nwhile (n &gt; 0){\n    product = product * (n%10);\n    n = n/10;\n}\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 6802953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n1hLl.jpg?s=128&g=1", "display_name": "Lortnok", "link": "https://stackoverflow.com/users/6802953/lortnok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 39370935, "answer_count": 1, "score": 0, "last_activity_date": 1473254090, "creation_date": 1473253540, "last_edit_date": 1473253784, "question_id": 39370741, "link": "https://stackoverflow.com/questions/39370741/if-treble-product-of-first-2-digits", "title": "If treble product of first 2 digits", "body": "<p>I am writing a program that should be able to calculate the product of first n-1 digits.<br>\nNote: If treble first 2 digits.</p>\n\n<p>The code is working when 4 digits entered , example : 1234 , product is 6 . Cant figure out the treble part</p>\n\n<p>So far I tried this, but no solution:</p>\n\n<pre><code> using namespace std;\n int main()\n{\n\nint n , sum = 0, s,d,k,w, product ;\ncout &lt;&lt;\"Enter number: \" &lt;&lt; endl;\ncin &gt;&gt; n;\n\nif ((n&gt;1) &amp;&amp; (n&lt;10000)) {\n{\n s= n/10;\n    d = n/100%10; // 2.\n    k = n/1000%100%10; //1.\n    w = n/10%10; //3.\n//1234\n   product = w*d*k;\n\n\n  if ((n&gt;1) &amp;&amp; (n&lt;1000)) {\n       s = n/10;\n    d = n/100%10; // 2.\n    k = n/1000%100%10; //1.\n    w = n/10%10; //3.\n\n    product = k*d;\n\n}\n     cout &lt;&lt;\"Sum of digits inp numb is : \" &lt;&lt; d+k+w  &lt;&lt; \" and product is : \" &lt;&lt; product  &lt;&lt;  endl;\n\n     cout &lt;&lt; \"w: \" &lt;&lt; w &lt;&lt; \" k: \" &lt;&lt; k &lt;&lt; \" d: \" &lt;&lt; d &lt;&lt; \" s: \" &lt;&lt; s &lt;&lt; endl;\n\n   }\n }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "pointers"], "comments": [{"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "edited": false, "score": 2, "creation_date": 1473253388, "post_id": 39370624, "comment_id": 66069370, "body": "Have you tried compiling it?"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1473253501, "post_id": 39370624, "comment_id": 66069446, "body": "Whether it is possible (safe) will depend on what is passed to <code>mtd1</code>. By the way, what is <code>String</code>?"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 0, "creation_date": 1473253528, "post_id": 39370624, "comment_id": 66069471, "body": "You probably meant <code>std::make_pair</code> with the regular, not angular, brackets."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1473253579, "post_id": 39370624, "comment_id": 66069505, "body": "<code>std::make_pair &lt;argv[1],99999 &gt;</code> <a href=\"http://melpon.org/wandbox/permlink/yMX8YZtW8pENVScS\" rel=\"nofollow noreferrer\">didn&#39;t compile</a>. Do you mean <code>std::make_pair (argv[1],99999 )</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1456, "user_id": 2507632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/326eefba530053b206b79d301bdbb451?s=128&d=identicon&r=PG", "display_name": "someone", "link": "https://stackoverflow.com/users/2507632/someone"}, "edited": false, "score": 0, "creation_date": 1473253699, "post_id": 39370734, "comment_id": 66069597, "body": "how could you map <code>string</code> with <code>integer</code> <code>pair&lt;std::string, int&gt; mtd1 (int argc, char * argv[])</code>"}, {"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "reply_to_user": {"reputation": 1456, "user_id": 2507632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/326eefba530053b206b79d301bdbb451?s=128&d=identicon&r=PG", "display_name": "someone", "link": "https://stackoverflow.com/users/2507632/someone"}, "edited": false, "score": 0, "creation_date": 1473253721, "post_id": 39370734, "comment_id": 66069611, "body": "@someone There was a typo. I fixed it."}, {"owner": {"reputation": 343, "user_id": 6268947, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/b27a22f070dbbc34e426bcd91fe078d2?s=128&d=identicon&r=PG&f=1", "display_name": "J.doe", "link": "https://stackoverflow.com/users/6268947/j-doe"}, "edited": false, "score": 0, "creation_date": 1473253775, "post_id": 39370734, "comment_id": 66069647, "body": "@TheQuantumPhysicist   the method shall return a std::pair&lt;const char *, int&gt;"}, {"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "reply_to_user": {"reputation": 343, "user_id": 6268947, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/b27a22f070dbbc34e426bcd91fe078d2?s=128&d=identicon&r=PG&f=1", "display_name": "J.doe", "link": "https://stackoverflow.com/users/6268947/j-doe"}, "edited": false, "score": 1, "creation_date": 1473253825, "post_id": 39370734, "comment_id": 66069690, "body": "@J.doe While I don&#39;t see why that&#39;s necessary, I&#39;ll add that to my code too."}, {"owner": {"reputation": 343, "user_id": 6268947, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/b27a22f070dbbc34e426bcd91fe078d2?s=128&d=identicon&r=PG&f=1", "display_name": "J.doe", "link": "https://stackoverflow.com/users/6268947/j-doe"}, "edited": false, "score": 0, "creation_date": 1473253960, "post_id": 39370734, "comment_id": 66069774, "body": "@TheQuantumPhysicist sorry I am just learning c++ Iam just a bit confused about things so i might ask silly questions ..."}, {"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "reply_to_user": {"reputation": 343, "user_id": 6268947, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/b27a22f070dbbc34e426bcd91fe078d2?s=128&d=identicon&r=PG&f=1", "display_name": "J.doe", "link": "https://stackoverflow.com/users/6268947/j-doe"}, "edited": false, "score": 1, "creation_date": 1473254115, "post_id": 39370734, "comment_id": 66069886, "body": "@J.doe For a beginner, I don&#39;t recommend using <code>char*</code> in an <code>std::pair</code> (even for an expert, but a beginner is easily confused with that). If that works for you, then great. But remember that the <code>std::pair&lt;char*,int&gt;</code> doesn&#39;t have your string, but has a <i>pointer</i> to your string, meaning that you have to be aware of all memory management stuff. And don&#39;t worry about being a beginner. We all were beginners once."}, {"owner": {"reputation": 343, "user_id": 6268947, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/b27a22f070dbbc34e426bcd91fe078d2?s=128&d=identicon&r=PG&f=1", "display_name": "J.doe", "link": "https://stackoverflow.com/users/6268947/j-doe"}, "edited": false, "score": 0, "creation_date": 1473256387, "post_id": 39370734, "comment_id": 66071525, "body": "@TheQuantumPhysicist , but argv[1] is not of type: const char*  ,so why is it possible? argv[1] is: char * right?"}, {"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "reply_to_user": {"reputation": 343, "user_id": 6268947, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/b27a22f070dbbc34e426bcd91fe078d2?s=128&d=identicon&r=PG&f=1", "display_name": "J.doe", "link": "https://stackoverflow.com/users/6268947/j-doe"}, "edited": false, "score": 1, "creation_date": 1473259440, "post_id": 39370734, "comment_id": 66073933, "body": "@j.doe casting char* to const char* is no problem. The other way around can be a problem and needs a special kind of cast operator."}], "tags": [], "owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "is_accepted": false, "score": 1, "last_activity_date": 1473254167, "last_edit_date": 1473254167, "creation_date": 1473253507, "answer_id": 39370734, "question_id": 39370624, "link": "https://stackoverflow.com/questions/39370624/stdmake-pair-const-char-int/39370734#39370734", "title": "std::make_pair &lt;const char*,int &gt;", "body": "<p>How about doing it the safe way?</p>\n\n<pre><code>std::pair&lt;std::string, int&gt; mtd1 (int argc, char * argv[])\n{\n.\n.\n.\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>return std::make_pair (std::string(argv[1]),99999);\n</code></pre>\n\n<p>If you insist on returning <code>std::pair&lt;char*,int&gt;</code>, then this should work:</p>\n\n<pre><code>return std::make_pair (argv[1],99999);\n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 6268947, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/b27a22f070dbbc34e426bcd91fe078d2?s=128&d=identicon&r=PG&f=1", "display_name": "J.doe", "link": "https://stackoverflow.com/users/6268947/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1082, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1473257812, "creation_date": 1473253185, "last_edit_date": 1473257812, "question_id": 39370624, "link": "https://stackoverflow.com/questions/39370624/stdmake-pair-const-char-int", "title": "std::make_pair &lt;const char*,int &gt;", "body": "<p>I have a function which was called from the of 'main' method with the same arguments that main was called with  <code>(int main (int argc, char* argv[]))</code></p>\n\n<pre><code>std::pair&lt;const char *, int&gt; mtd1 (int argc, char * argv[]){\n.\n.\n.\n}\n</code></pre>\n\n<p>since  argv[1]  is a pointer to a String (assume that it was atleast one program argument except for argv[0]), but not a constant pointer, is it still possible (not an error) to pass argv[1] in a return statement  inside <code>mtd1</code></p>\n\n<pre><code>return std::make_pair &lt;argv[1],99999 &gt;\n</code></pre>\n\n<p>or do i need to do this inside my <code>mtd1</code> method</p>\n\n<pre><code>const char *abc  = arg[1]\n</code></pre>\n\n<p>before returning</p>\n\n<pre><code>return std::make_pair (abc,99999 )      &lt;- edited\n</code></pre>\n"}, {"tags": ["java", "android", "c++", "android-ndk", "java-native-interface"], "comments": [{"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 0, "creation_date": 1473253306, "post_id": 39370562, "comment_id": 66069307, "body": "Show your <code>Application.mk</code> please."}, {"owner": {"reputation": 4182, "user_id": 2992101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7363e9ce46406af3326492e2f6cf40ca?s=128&d=identicon&r=PG", "display_name": "michalsrb", "link": "https://stackoverflow.com/users/2992101/michalsrb"}, "edited": false, "score": 2, "creation_date": 1473253383, "post_id": 39370562, "comment_id": 66069365, "body": "Adding  <code>APP_STL=c++_shared</code> into <code>Application.mk</code> may help."}, {"owner": {"reputation": 188, "user_id": 3974340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfff223947b1de4cb2a74cde08b60db4?s=128&d=identicon&r=PG&f=1", "display_name": "Arjun", "link": "https://stackoverflow.com/users/3974340/arjun"}, "reply_to_user": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 0, "creation_date": 1473254145, "post_id": 39370562, "comment_id": 66069907, "body": "@Serhio \t My Application.mk has only the target specified. APP_ABI := arm64-v8a"}, {"owner": {"reputation": 188, "user_id": 3974340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfff223947b1de4cb2a74cde08b60db4?s=128&d=identicon&r=PG&f=1", "display_name": "Arjun", "link": "https://stackoverflow.com/users/3974340/arjun"}, "reply_to_user": {"reputation": 4182, "user_id": 2992101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7363e9ce46406af3326492e2f6cf40ca?s=128&d=identicon&r=PG", "display_name": "michalsrb", "link": "https://stackoverflow.com/users/2992101/michalsrb"}, "edited": false, "score": 0, "creation_date": 1473254174, "post_id": 39370562, "comment_id": 66069930, "body": "@michalsrb I tried it. Still facing the same issue"}, {"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "reply_to_user": {"reputation": 4182, "user_id": 2992101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7363e9ce46406af3326492e2f6cf40ca?s=128&d=identicon&r=PG", "display_name": "michalsrb", "link": "https://stackoverflow.com/users/2992101/michalsrb"}, "edited": false, "score": 1, "creation_date": 1473254452, "post_id": 39370562, "comment_id": 66070145, "body": "I guess your device is simply not <code>arm64-v8a</code>. Set <code>APP_ABI</code> to <code>all</code> and add <code>APP_STL</code> as @michalsrb has suggested."}, {"owner": {"reputation": 188, "user_id": 3974340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfff223947b1de4cb2a74cde08b60db4?s=128&d=identicon&r=PG&f=1", "display_name": "Arjun", "link": "https://stackoverflow.com/users/3974340/arjun"}, "reply_to_user": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 0, "creation_date": 1473312602, "post_id": 39370562, "comment_id": 66093598, "body": "@Serhio I have updated my question. Please check the last part of the question"}], "answers": [{"comments": [{"owner": {"reputation": 188, "user_id": 3974340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfff223947b1de4cb2a74cde08b60db4?s=128&d=identicon&r=PG&f=1", "display_name": "Arjun", "link": "https://stackoverflow.com/users/3974340/arjun"}, "edited": false, "score": 1, "creation_date": 1473324086, "post_id": 39385003, "comment_id": 66099389, "body": "You are right. libmodule1.so was built specifically for this target. That is why my Application.mk file is having that specific target."}, {"owner": {"reputation": 188, "user_id": 3974340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfff223947b1de4cb2a74cde08b60db4?s=128&d=identicon&r=PG&f=1", "display_name": "Arjun", "link": "https://stackoverflow.com/users/3974340/arjun"}, "edited": false, "score": 1, "creation_date": 1473324147, "post_id": 39385003, "comment_id": 66099424, "body": "I know it wont work for x86_64 since it wasn&#39;t built for that. But it was an update given for  Serhio."}, {"owner": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "reply_to_user": {"reputation": 188, "user_id": 3974340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfff223947b1de4cb2a74cde08b60db4?s=128&d=identicon&r=PG&f=1", "display_name": "Arjun", "link": "https://stackoverflow.com/users/3974340/arjun"}, "edited": false, "score": 0, "creation_date": 1473351224, "post_id": 39385003, "comment_id": 66117562, "body": "Oh. I&#39;m fairly certain that comment is wrong. Set <code>APP_ABI</code> back to arm64-v8a if you just want to target arm64. I&#39;d remove that part of your question as well, since it&#39;s detracting from your real problem.  &quot;You are right. libmodule1.so was built specifically for this target.&quot; Does that mean you <code>adb pull</code>&#39;d it? Are you pushing you app back to <i>exactly</i> the same device? Is that device running Android N?"}, {"owner": {"reputation": 188, "user_id": 3974340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfff223947b1de4cb2a74cde08b60db4?s=128&d=identicon&r=PG&f=1", "display_name": "Arjun", "link": "https://stackoverflow.com/users/3974340/arjun"}, "edited": false, "score": 0, "creation_date": 1473671645, "post_id": 39385003, "comment_id": 66215589, "body": "Well i built this .so file using another compiler (AOSP) and &#39;mm&#39; utility. I am pushing the app back to the same device and Yes it is android N"}, {"owner": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "reply_to_user": {"reputation": 188, "user_id": 3974340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfff223947b1de4cb2a74cde08b60db4?s=128&d=identicon&r=PG&f=1", "display_name": "Arjun", "link": "https://stackoverflow.com/users/3974340/arjun"}, "edited": false, "score": 0, "creation_date": 1473716149, "post_id": 39385003, "comment_id": 66239503, "body": "You can&#39;t do that unless you build that library against the NDK: <a href=\"https://developer.android.com/about/versions/nougat/android-7.0-changes.html#ndk\" rel=\"nofollow noreferrer\">developer.android.com/about/versions/nougat/&hellip;</a>"}], "tags": [], "owner": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "is_accepted": false, "score": 1, "last_activity_date": 1473319831, "creation_date": 1473319831, "answer_id": 39385003, "question_id": 39370562, "link": "https://stackoverflow.com/questions/39370562/java-lang-unsatisfiedlinkerror-dlopen-failed-library-libc-so-not-found/39385003#39385003", "title": "java.lang.UnsatisfiedLinkError: dlopen failed: library &quot;libc++.so&quot; not found", "body": "<p>What is libmodule1.so? It sounds like it's a library that you pulled off an android device and are trying to use. That's pretty much only going to work for the exact device you pulled it from.</p>\n\n<p>As for the second part, it sounds like the libraries in your x86_64 directory aren't actually x86_64 libraries. Try <code>$NDK/toolchains/x86_64-4.9/prebuilt/$YOUR_OS/bin/x86_64-linux-android-readelf -h module1.so</code>. It will print the ELF header for the library. One of the lines should be:</p>\n\n<pre><code>Machine:                           Advanced Micro Devices X86-64\n</code></pre>\n\n<p>If the value of machine is anything else, it's not an x86_64 library.</p>\n"}], "owner": {"reputation": 188, "user_id": 3974340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfff223947b1de4cb2a74cde08b60db4?s=128&d=identicon&r=PG&f=1", "display_name": "Arjun", "link": "https://stackoverflow.com/users/3974340/arjun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5436, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1473319831, "creation_date": 1473252980, "last_edit_date": 1473312427, "question_id": 39370562, "link": "https://stackoverflow.com/questions/39370562/java-lang-unsatisfiedlinkerror-dlopen-failed-library-libc-so-not-found", "title": "java.lang.UnsatisfiedLinkError: dlopen failed: library &quot;libc++.so&quot; not found", "body": "<p>I am trying to use two prebuilt native libraries (.so) in my Android application. For this i have created a JNI project where i have done the following,</p>\n\n<ol>\n<li>Created a java native library and compiled with javac</li>\n<li>Created a C header with javah -jni command</li>\n<li>Created a corresponding C source file where the methods are implemented</li>\n<li>This C source code (the methods in it) will refer to the methods that .so file expose</li>\n<li>Android.mk file is written. It is given below.</li>\n<li>Using ndk-build it is built and then pushed to the mobile</li>\n</ol>\n\n<h2>Android.mk</h2>\n\n<pre><code>LOCAL_PATH := $(call my-dir)\ninclude $(CLEAR_VARS)\nLOCAL_MODULE    := libmodule1\nLOCAL_SRC_FILES := prebuilts/$(TARGET_ARCH_ABI)/libmodule1.so\ninclude $(PREBUILT_SHARED_LIBRARY)\ninclude $(CLEAR_VARS)\nLOCAL_MODULE    := libmodule2\nLOCAL_SRC_FILES := prebuilts/$(TARGET_ARCH_ABI)/libmodule2.so\ninclude $(PREBUILT_SHARED_LIBRARY)\ninclude $(CLEAR_VARS)\nLOCAL_MODULE    := com_example_androidwrapper_NativeLibrary\nLOCAL_SRC_FILES := com_example_androidwrapper_NativeLibrary.c\nLOCAL_SHARED_LIBRARIES := libmodule1 libmodule2 \ninclude $(BUILD_SHARED_LIBRARY)\n</code></pre>\n\n<p>When i run this app I am getting the following error.</p>\n\n<pre><code>java.lang.UnsatisfiedLinkError: dlopen failed: library \"libc++.so\" not found\n</code></pre>\n\n<p>If i dont load the module1, module2 libraries app will work fine (i commented out the calls to the methods exposed by these two modules and rewrote the Android.mk file to just to build a shared library and not to use any prebuilt ones) This is working fine. </p>\n\n<p>Any help is appreciated. Thanks.</p>\n\n<p>I had successfully used the prebuilt .so files from a native application which i ran in the same target device. \nWhen i changed the application.mk \"APP_ABI := all\"\nIt gave me the following error.</p>\n\n<pre><code>[x86_64] Prebuilt       : module1.so &lt;= jni/\n[x86_64] Install        : module1.so =&gt; libs/x86_64/module1.so\nC:/Users/user/AppData/Local/Android/android-ndk-r12b/build//../toolchains/x86_64-4.9/prebuilt/windows/bin/x86_64-linux-android-strip: Un\nable to recognise the format of the input file `./libs/x86_64/module1.so'\nmake: *** [libs/x86_64/module1.so] Error 1\nmake: *** Deleting file `libs/x86_64/module1.so'\n</code></pre>\n\n<p>I think the prebuilt .so files are supposed to run in the arm64-v8a itself.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 145, "user_id": 6710316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42cc95b07d420e571d6c36e16b631226?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Bargie\u0142", "link": "https://stackoverflow.com/users/6710316/krzysztof-bargie%c5%82"}, "edited": false, "score": 0, "creation_date": 1473252821, "post_id": 39370403, "comment_id": 66068923, "body": "1) It helps in figuring out which methods are derived. 2) Possibly it can help compiler with some optimisations  It is the same as in java (@override)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1473252933, "post_id": 39370403, "comment_id": 66069014, "body": "It is a nice catch in case you change the signature in the base but forget to update the derived."}, {"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 1, "creation_date": 1473252954, "post_id": 39370403, "comment_id": 66069028, "body": "You don&#39;t technically need <code>virtual</code> in the subclass either, yet you use it. <code>override</code> is just better in that it more clearly conveys the intent."}, {"owner": {"reputation": 19628, "user_id": 1873944, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MaDna.jpg?s=128&g=1", "display_name": "peppe", "link": "https://stackoverflow.com/users/1873944/peppe"}, "reply_to_user": {"reputation": 145, "user_id": 6710316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42cc95b07d420e571d6c36e16b631226?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Bargie\u0142", "link": "https://stackoverflow.com/users/6710316/krzysztof-bargie%c5%82"}, "edited": false, "score": 0, "creation_date": 1473252959, "post_id": 39370403, "comment_id": 66069034, "body": "@KrzysztofBargie\u0142: &quot;help&quot; how? The compiler surely knows that that function is an override. <code>override</code> is for the humans."}, {"owner": {"reputation": 4718, "user_id": 152359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9462dee3e00416ea83771eead7902e1c?s=128&d=identicon&r=PG", "display_name": "Hayt", "link": "https://stackoverflow.com/users/152359/hayt"}, "reply_to_user": {"reputation": 19628, "user_id": 1873944, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MaDna.jpg?s=128&g=1", "display_name": "peppe", "link": "https://stackoverflow.com/users/1873944/peppe"}, "edited": false, "score": 0, "creation_date": 1473253206, "post_id": 39370403, "comment_id": 66069243, "body": "@peppe there are reasons for override being implementes. If you change the signature in the base class (on a non-pure virtual function) everythign still compiles and you don&#39;t get any errors without override."}, {"owner": {"reputation": 19628, "user_id": 1873944, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MaDna.jpg?s=128&g=1", "display_name": "peppe", "link": "https://stackoverflow.com/users/1873944/peppe"}, "reply_to_user": {"reputation": 4718, "user_id": 152359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9462dee3e00416ea83771eead7902e1c?s=128&d=identicon&r=PG", "display_name": "Hayt", "link": "https://stackoverflow.com/users/152359/hayt"}, "edited": false, "score": 0, "creation_date": 1473253327, "post_id": 39370403, "comment_id": 66069322, "body": "@Hayt: what I mean is that whether a function is overriding or not is <i>not</i> determined by the presence of the <code>override</code> keyword. That&#39;s a development aid, not a help for the compiler."}, {"owner": {"reputation": 4718, "user_id": 152359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9462dee3e00416ea83771eead7902e1c?s=128&d=identicon&r=PG", "display_name": "Hayt", "link": "https://stackoverflow.com/users/152359/hayt"}, "edited": false, "score": 0, "creation_date": 1473253530, "post_id": 39370403, "comment_id": 66069474, "body": "It is a helper for the compiler to know whether this function is intended to override something or not and generate an error if needed."}, {"owner": {"reputation": 56338, "user_id": 4573247, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/JHd9a.png?s=128&g=1", "display_name": "dfrib", "link": "https://stackoverflow.com/users/4573247/dfrib"}, "reply_to_user": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1473255296, "post_id": 39370403, "comment_id": 66070714, "body": "@SebastianRedl, Hayt, ...: thanks for the contributions in the discussion above; <code>override</code> in this context clearly holds some merit w.r.t. semantics and maintanability."}], "answers": [{"tags": [], "owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "is_accepted": true, "score": 9, "last_activity_date": 1473252945, "creation_date": 1473252945, "answer_id": 39370547, "question_id": 39370403, "link": "https://stackoverflow.com/questions/39370403/implementing-pure-virtual-function-from-abstract-base-class-does-override-speci/39370547#39370547", "title": "Implementing pure virtual function from abstract base class: does override specifier have any meaning?", "body": "<p>I'm not a big fan of <code>override</code>, but, assuming it's something that you find useful in general, then, yes, putting <code>override</code> on a virtual function that overrides a pure virtual functions is useful. Consider this rather contrived example:</p>\n\n<pre><code>struct Base {\n    virtual void f() = 0;\n};\n\nstruct Derived : Base {\n    virtual void f();\n    virtual void f(int);\n};\n</code></pre>\n\n<p>Now suppose that the maintainer of <code>Base</code> (perhaps even your future self) changes <code>Base</code> to look like this:</p>\n\n<pre><code>struct Base {\n    virtual void f(int) = 0;\n};\n</code></pre>\n\n<p>Now the behavior of <code>Derived</code> has quietly changed. With <code>override</code> the compiler would report an error.</p>\n"}, {"tags": [], "owner": {"reputation": 4718, "user_id": 152359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9462dee3e00416ea83771eead7902e1c?s=128&d=identicon&r=PG", "display_name": "Hayt", "link": "https://stackoverflow.com/users/152359/hayt"}, "is_accepted": false, "score": 2, "last_activity_date": 1473253456, "last_edit_date": 1473253456, "creation_date": 1473253044, "answer_id": 39370585, "question_id": 39370403, "link": "https://stackoverflow.com/questions/39370403/implementing-pure-virtual-function-from-abstract-base-class-does-override-speci/39370585#39370585", "title": "Implementing pure virtual function from abstract base class: does override specifier have any meaning?", "body": "<p>In case of pure virtual functions and compilations not really. You will get an error anyway (except in as in the example from Pete)</p>\n\n<p>But the error message may be more readable if you get an error like \"<em>your function does not override anything</em>\" compared to later \"<em>cannot instantiate abstract class</em>\"</p>\n\n<p>Another advantage would be while reading the declaration you know this is a derived method from a base class. </p>\n\n<p>Also it is good practice to just get used to declare all overridden methods with <code>override</code>. So why make a difference here and have inconsistent style.</p>\n\n<p>As to <strong>why</strong> it is good to have all overriden methods be declared <code>override</code>:</p>\n\n<p>imagine you have </p>\n\n<pre><code>class A\n{\n    virtual void Foo();\n};\n\nclass B: public A\n{\n    virtual void Foo() override;\n};\n</code></pre>\n\n<p>And then you change <code>Foo</code> to a <code>const</code> function in <code>A</code>. Without <code>override</code> this will compile but when you call <code>A-&gt;foo()</code> and it is a B object <code>B-&gt;foo()</code> will not be called without any indication something changed there. With <code>override</code> you get an error here.</p>\n"}, {"tags": [], "owner": {"reputation": 181, "user_id": 6523780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0iKNK.jpg?s=128&g=1", "display_name": "Felix Lauer", "link": "https://stackoverflow.com/users/6523780/felix-lauer"}, "is_accepted": false, "score": 3, "last_activity_date": 1473253398, "creation_date": 1473253398, "answer_id": 39370698, "question_id": 39370403, "link": "https://stackoverflow.com/questions/39370403/implementing-pure-virtual-function-from-abstract-base-class-does-override-speci/39370698#39370698", "title": "Implementing pure virtual function from abstract base class: does override specifier have any meaning?", "body": "<p>Technically, both versions are syntactically correct and legal. The <code>override</code> specifier is mainly meant to prevent unexpected behavior. The compiler will throw an error as soon as it encounters a member function marked as <code>override</code> which is not actually overriding a virtual function. This may occur if, for some reason, you change the signature of the virtual base class function. Consider this example:</p>\n\n<pre><code>class Abstract {\n    virtual void foo() { ...}\n}; \n\nclass Derived : public Abstract {\n    void foo() override { ... }\n};\n</code></pre>\n\n<p>Now, if the signature of <code>Abstract::foo</code> is changed, let's say to</p>\n\n<pre><code>class Abstract {\n    virtual void foo(int bar) { ...}\n}; \n</code></pre>\n\n<p>the compiler will throw an error at <code>Derived::foo</code> as it no longer overrides a function of <code>Abstract</code> which it wouldn't without the <code>override</code> qualifier. This helps you to better maintain your code. However, in your specific case (i.e. with pure virtual declarations), an error would be thrown as well. So using <code>override</code> is mainly considered \"good practice\", I guess. More on that topic: <a href=\"http://en.cppreference.com/w/cpp/language/override\" rel=\"nofollow\">http://en.cppreference.com/w/cpp/language/override</a></p>\n"}, {"tags": [], "owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "is_accepted": false, "score": 1, "last_activity_date": 1473253560, "creation_date": 1473253560, "answer_id": 39370748, "question_id": 39370403, "link": "https://stackoverflow.com/questions/39370403/implementing-pure-virtual-function-from-abstract-base-class-does-override-speci/39370748#39370748", "title": "Implementing pure virtual function from abstract base class: does override specifier have any meaning?", "body": "<p>The main advantage of <code>override</code> here would be to encourage maintainability. Consider below:</p>\n\n<pre><code>class Foo\n{\npublic: \n    virtual void foo() = 0;\n};\nclass Derived : public Foo\n{\npublic:\n    //....\n    virtual void foo(double x) override\n    {\n         //This throws error\n    }\n};\n</code></pre>\n\n<p>As you can see above, the compiler would throw an error if you compiled the above. What would happen is the compiler would complain about the function not having the same signature. Without the <code>override</code> keyword, the outcome would have differed.</p>\n"}], "owner": {"reputation": 56338, "user_id": 4573247, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/JHd9a.png?s=128&g=1", "display_name": "dfrib", "link": "https://stackoverflow.com/users/4573247/dfrib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1870, "favorite_count": 0, "accepted_answer_id": 39370547, "answer_count": 4, "score": 4, "last_activity_date": 1473253560, "creation_date": 1473252565, "last_edit_date": 1495540304, "question_id": 39370403, "link": "https://stackoverflow.com/questions/39370403/implementing-pure-virtual-function-from-abstract-base-class-does-override-speci", "title": "Implementing pure virtual function from abstract base class: does override specifier have any meaning?", "body": "<h3>Background</h3>\n\n<p>I just stumbled over a use case of the <a href=\"http://en.cppreference.com/w/cpp/language/override\" rel=\"nofollow noreferrer\"><code>override</code> specifier</a> that, as far as I can tell, seems redundant and also without any particular semantics meaning, but maybe I'm missing something, hence this question. Before proceeding, I should point out that I've tried to find an answer to it here on SO, but the nearest I got were the following threads, not really answering my query (maybe someone can point out a Q&amp;A that actually already answers my question).</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/1306778/c-virtual-pure-virtual-explained\">C++ Virtual/Pure Virtual Explained</a></li>\n<li><a href=\"https://stackoverflow.com/questions/29708210/c-override-pure-virtual-method-with-pure-virtual-method\">C++ override pure virtual method with pure virtual method</a></li>\n</ul>\n\n<h3>Question</h3>\n\n<p>Consider the following abstract class:</p>\n\n<pre><code>struct Abstract {\n  virtual ~Abstract() {};\n  virtual void foo() = 0;\n};\n</code></pre>\n\n<p>Is there any reason to use the <code>override</code> specifier when implementing <code>foo()</code> in a non-abstract class derived directly from <code>Abstract</code> (as in <code>DerivedB</code> below)? I.e., when the implementation of <code>foo()</code> is already required for the derived class to be non-abstract (and not really overriding anything)?</p>\n\n<pre><code>/* \"common\" derived class implementation, in my personal experience\n   (include virtual keyword for semantics) */\nstruct DerivedA : public Abstract {\n  virtual void foo() { std::cout &lt;&lt; \"A foo\" &lt;&lt; std::endl; }\n};\n\n/* is there any reason for having the override specifier here? */\nstruct DerivedB : public Abstract {\n  virtual void foo() override { std::cout &lt;&lt; \"B foo\" &lt;&lt; std::endl; }\n};\n</code></pre>\n"}]