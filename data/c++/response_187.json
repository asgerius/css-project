[{"tags": ["c++", "c", "sockets", "epoll"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1533772639, "post_id": 51757113, "comment_id": 90473705, "body": "Sure, it is not a <i>requirement</i>, but if the data can&#39;t be sent right away, the <code>write()</code> will either block the calling thread (blocking socket) or fail with <code>EAGAIN</code>/<code>EWOULDBLOCK</code> (non-blocking socket). In the latter case, you could just call <code>write()</code> again periodically, or you could use <code>EPOLLOUT</code> to know when the socket is ready to send data before calling <code>write()</code> again."}, {"owner": {"reputation": 518, "user_id": 4483126, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bcfed78ecf9eaa839b4603318bc4042?s=128&d=identicon&r=PG&f=1", "display_name": "Oktaheta", "link": "https://stackoverflow.com/users/4483126/oktaheta"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1533773021, "post_id": 51757113, "comment_id": 90473769, "body": "Can I do <code>if (EWOULDBLOCK || EINTR ||  EAGAIN) then I retry to write</code> ?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1533773305, "post_id": 51757113, "comment_id": 90473819, "body": "You can. But in such case, if the socket is blocked for awhile (network lag, unresponsive peer, etc), you would end up in a busy loop calling <code>write()</code> over and over, wasting CPU cycles.  Better to put the calling thread to sleep waiting for <code>EPOLLOUT</code> (or have the thread go do something else for awhile and come back later) before calling <code>write()</code> again."}], "answers": [{"comments": [{"owner": {"reputation": 518, "user_id": 4483126, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bcfed78ecf9eaa839b4603318bc4042?s=128&d=identicon&r=PG&f=1", "display_name": "Oktaheta", "link": "https://stackoverflow.com/users/4483126/oktaheta"}, "edited": false, "score": 0, "creation_date": 1533974128, "post_id": 51757553, "comment_id": 90552327, "body": "what if i do EPOLLIN for listenfd only, once accepted, bring along accepted fd and spawn new thread to do recv and send and close? It won&#39;t blocked the epoll, it also work alone in the thread."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 518, "user_id": 4483126, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bcfed78ecf9eaa839b4603318bc4042?s=128&d=identicon&r=PG&f=1", "display_name": "Oktaheta", "link": "https://stackoverflow.com/users/4483126/oktaheta"}, "edited": false, "score": 0, "creation_date": 1533974493, "post_id": 51757553, "comment_id": 90552402, "body": "You never want to write to the accepting socket, so EPOLLIN only is fine for that socket. Generally speaking, pre-emptive thread per connection servers don&#39;t scale very well, but if the load is expected to be light, it works well and the code can be easier to understand."}, {"owner": {"reputation": 518, "user_id": 4483126, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bcfed78ecf9eaa839b4603318bc4042?s=128&d=identicon&r=PG&f=1", "display_name": "Oktaheta", "link": "https://stackoverflow.com/users/4483126/oktaheta"}, "edited": false, "score": 0, "creation_date": 1533974764, "post_id": 51757553, "comment_id": 90552455, "body": "I mean in psuedo coding fd = accept(...); new thread(fd) { recv(fd...); heavyProcess(); send(fd...); close(fd); }  So I can handle multi threaded request concurrently?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 518, "user_id": 4483126, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bcfed78ecf9eaa839b4603318bc4042?s=128&d=identicon&r=PG&f=1", "display_name": "Oktaheta", "link": "https://stackoverflow.com/users/4483126/oktaheta"}, "edited": false, "score": 0, "creation_date": 1534352844, "post_id": 51757553, "comment_id": 90678697, "body": "@Oktaheta My comment is the same. It doesn&#39;t scale, but if that doesn&#39;t matter, it works."}, {"owner": {"reputation": 766, "user_id": 9158613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fdc7af72ee7dd5897b002474701d285?s=128&d=identicon&r=PG&f=1", "display_name": "asinix", "link": "https://stackoverflow.com/users/9158613/asinix"}, "edited": false, "score": 0, "creation_date": 1567678594, "post_id": 51757553, "comment_id": 102038237, "body": "@jxh  &quot;Enable edge triggered notifications, and leave EPOLLOUT enabled all the time&quot; should it not be &quot;Enable edge triggered notifications, and start with EPOLLOUT disabled. When you get EWOULDBLOCK or EAGAIN on write enable EPOLLOUT&quot;"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 766, "user_id": 9158613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fdc7af72ee7dd5897b002474701d285?s=128&d=identicon&r=PG&f=1", "display_name": "asinix", "link": "https://stackoverflow.com/users/9158613/asinix"}, "edited": false, "score": 1, "creation_date": 1567701337, "post_id": 51757553, "comment_id": 102050922, "body": "@asinix: No. With edge triggered and EPOLLOUT always enabled, the application always attempts to write. When write blocks, it only waits for notification, since EPOLLOUT is already enabled."}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 3, "last_activity_date": 1533777013, "creation_date": 1533777013, "answer_id": 51757553, "question_id": 51757113, "link": "https://stackoverflow.com/questions/51757113/what-happened-if-i-dont-set-epollout-event-and-direct-call-write-function/51757553#51757553", "title": "What happened if I don&#39;t set EPOLLOUT event and direct call write() function?", "body": "<p>When using <code>epoll</code> with level triggered notifications, you will get constant <code>EPOLLOUT</code> notifications on a socket except for those brief periods of time that the output buffer for the socket is actually full. The impact of this is that your event loop will wake up even if you have nothing to send, and there was no data to receive either.</p>\n\n<p>To deal with that, you have two practical choices:</p>\n\n<ol>\n<li><p>Disable <code>EPOLLOUT</code> until those times you actually get <code>EWOULDBLOCK</code> / <code>EAGAIN</code>. At that point, you enable <code>EPOLLOUT</code>, and disable it again once your send is complete.</p></li>\n<li><p>Enable edge triggered notifications, and leave <code>EPOLLOUT</code> enabled all the time. Now, you will only get <code>EPOLLOUT</code> notifications when the system changes from a output buffer full state to non-full state. However, <code>EPOLLIN</code> is now also also edge triggered, which means you only get one <code>EPOLLIN</code> notification until you drain the input buffer.</p></li>\n</ol>\n\n<p>In comments, a third option was presented to you to implement your own polling loop to deal with the sockets with full output buffers. This can be made to work, but should not be necessary, since <code>epoll</code> can tell you when it is okay to write.</p>\n"}], "owner": {"reputation": 518, "user_id": 4483126, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bcfed78ecf9eaa839b4603318bc4042?s=128&d=identicon&r=PG&f=1", "display_name": "Oktaheta", "link": "https://stackoverflow.com/users/4483126/oktaheta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1533777013, "creation_date": 1533772220, "question_id": 51757113, "link": "https://stackoverflow.com/questions/51757113/what-happened-if-i-dont-set-epollout-event-and-direct-call-write-function", "title": "What happened if I don&#39;t set EPOLLOUT event and direct call write() function?", "body": "<p>I have EPOLLIN event for read data only. Is it ok to direct write the data without setting EPOLLOUT event? </p>\n"}, {"tags": ["c++", "unit-testing", "googletest", "googlemock"], "answers": [{"comments": [{"owner": {"reputation": 324, "user_id": 1200515, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/24a9bf4bb8ebbefd5f9a9efbd48be94f?s=128&d=identicon&r=PG", "display_name": "Dillon", "link": "https://stackoverflow.com/users/1200515/dillon"}, "edited": false, "score": 0, "creation_date": 1533852203, "post_id": 51769958, "comment_id": 90511124, "body": "Hi, a side question with a problem i ran into, I&#39;ve mocked the Singleton method, however, the EXPECT_CALL seems to always pass, even without calling it. Any ideas on why that could happen?"}, {"owner": {"reputation": 1705, "user_id": 9103250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3c613d7186c7314ee818673ea4c79fd?s=128&d=identicon&r=PG&f=1", "display_name": "CharonX", "link": "https://stackoverflow.com/users/9103250/charonx"}, "reply_to_user": {"reputation": 324, "user_id": 1200515, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/24a9bf4bb8ebbefd5f9a9efbd48be94f?s=128&d=identicon&r=PG", "display_name": "Dillon", "link": "https://stackoverflow.com/users/1200515/dillon"}, "edited": false, "score": 0, "creation_date": 1533885278, "post_id": 51769958, "comment_id": 90519403, "body": "@Dillon Without looking at the source code, hard to say. Remember that you can Debug module tests through (at least in Visual Studio, using the google test adapter), so you may be able set a breakpoint in the mocked function and see where the call comes from. This is the issue with Singletons: Some unrelated part of your code might instantiate it (without you realizing) and suddendly you get unexpected effects."}], "tags": [], "owner": {"reputation": 1705, "user_id": 9103250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3c613d7186c7314ee818673ea4c79fd?s=128&d=identicon&r=PG&f=1", "display_name": "CharonX", "link": "https://stackoverflow.com/users/9103250/charonx"}, "is_accepted": true, "score": 2, "last_activity_date": 1533825789, "creation_date": 1533825789, "answer_id": 51769958, "question_id": 51757105, "link": "https://stackoverflow.com/questions/51757105/googletest-mock-c-singleton/51769958#51769958", "title": "GoogleTest Mock C++ singleton", "body": "<p>Singletons are <strong>very</strong> troublesome to mock (and a pain in unit testing in general).</p>\n\n<p>If you can replace the singleton call with dependency injection you will relieve lots of pain and can use standard methods to mock it, i.e.</p>\n\n<pre><code>Foo::Foo(Singleton* flushSingleton) : myFlushSingletion(flushSingleton) {};\n\nvoid Foo::action(int value) {\n    if (value &gt; 1) {\n        myFlushSingletion-&gt;flush();\n    } else {\n        // do nothing\n    }\n}\n</code></pre>\n\n<p>Failing that you may be able to use darker magic - but do so at your own peril...<br>\nYou might turn the (local static) Singleton instance into a protected static variable (and its functions virtual)</p>\n\n<pre><code>class Singleton {\n//...\nprotected:\nstatic std::shared_ptr&lt;Singleton&gt; mySingletonInstance;\n//...\n}\n</code></pre>\n\n<p>Then you can derive a MockSingleton which places itself in the <code>mySingletonInstance</code> of the real Singleton - but as I said... better refactor your code, you will be happier in the future.</p>\n"}], "owner": {"reputation": 324, "user_id": 1200515, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/24a9bf4bb8ebbefd5f9a9efbd48be94f?s=128&d=identicon&r=PG", "display_name": "Dillon", "link": "https://stackoverflow.com/users/1200515/dillon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2756, "favorite_count": 0, "accepted_answer_id": 51769958, "answer_count": 1, "score": 3, "last_activity_date": 1533825789, "creation_date": 1533772143, "question_id": 51757105, "link": "https://stackoverflow.com/questions/51757105/googletest-mock-c-singleton", "title": "GoogleTest Mock C++ singleton", "body": "<p>I am trying to find out the best/preferred way of mocking a singleton object.</p>\n\n<p>I have a class Singleton here.</p>\n\n<pre><code>class Singleton {\n\npublic:\n\nstatic std::shared_ptr&lt;Singleton&gt; getInstance() {\n    static std::shared_ptr&lt;Singleton&gt; instance =\n            std::make_shared&lt;Singleton&gt;(); // Guaranteed to be destroyed.\n    // Instantiated on first use.\n    return instance;\n}\n\nSingleton(Singleton const&amp;) = delete;\nSingleton(Singleton &amp;&amp;) = delete;\nSingleton&amp; operator=(Singleton const&amp;) = delete;\nSingleton&amp; operator=(Singleton &amp;&amp;) = delete;\n~Singleton();\n\nvoid flush();\n\n}\n</code></pre>\n\n<p>with a Foo class calling the singleton at some point...</p>\n\n<pre><code>#include &lt;Foo.h&gt;\n#include &lt;Singleton.h&gt;\n\nvoid Foo::action(int value) {\n\n    if (value &gt; 1) {\n        Singleton::getInstance()-&gt;flush();\n    } else {\n        // do nothing\n    }\n}\n</code></pre>\n\n<p>I would like to mock the Singleton object have the follow FooTest to make sure the flush method is called.</p>\n\n<pre><code>TEST_F(FooTest, testFlushIsCalled) {\n    auto foo = Foo();\n    foo.someAction(2);\n    EXPECT_CALL(Singleton::getInstance(), flush()).Times(1);\n}\n</code></pre>\n\n<p>Thanks in advance!!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1533771952, "post_id": 51757048, "comment_id": 90473570, "body": "Step through with a debugger and watch for where the program differs from what you expect."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1533772055, "post_id": 51757048, "comment_id": 90473584, "body": "Simplify your life, use <code>std::string</code> for text, not character arrays.  Character arrays can suffer from overrun.  Also, if the array doesn&#39;t have the nul terminator, many algorithms keep going into other parts of memory until the nul is found."}], "answers": [{"comments": [{"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1533774386, "post_id": 51757091, "comment_id": 90474038, "body": "<code>This copies one character</code> Then at least 1st char should show in the output, but this is not the case"}], "tags": [], "owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "is_accepted": false, "score": 2, "last_activity_date": 1533772051, "creation_date": 1533772051, "answer_id": 51757091, "question_id": 51757048, "link": "https://stackoverflow.com/questions/51757048/c-char-array-not-working/51757091#51757091", "title": "C++ Char array not working", "body": "<pre><code>*sname = *s;\n</code></pre>\n\n<p>This copies one character, not the entire string.  If you want to copy the entire string, you need to use <a href=\"https://en.cppreference.com/w/cpp/string/byte/strcpy\" rel=\"nofollow noreferrer\"><code>std::strcpy</code></a></p>\n\n<pre><code>std::strcpy(sname, s);\n</code></pre>\n\n<p>or a loop</p>\n\n<pre><code>char* src = s;\nchar* dst = sname;\nwhile (src) {\n    *dst = *src;\n    ++src;\n    ++dst;\n}\n</code></pre>\n\n<p>Of course, you could do away with all of this manual string handling and use <a href=\"https://en.cppreference.com/w/cpp/string/basic_string\" rel=\"nofollow noreferrer\"><code>std::string</code></a> instead:</p>\n\n<pre><code>//Place your class definition here\nclass student {\n   public:\n      void inputData(int a, std::string s, float e, float m, float sci);\n      void printData();\n\n   private:\n      int admno;\n      std::string sname;\n      float eng;\n      float math;\n      float science;\n      float total;\n      float ctotal();\n};\n\nvoid student::inputData(int a, std::string s, float e, float m, float sci) {\n   admno = a;\n   sname = std::move(s);\n   eng = e;\n   math = m;\n   science = sci;\n   total = ctotal();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "is_accepted": false, "score": 1, "last_activity_date": 1533776644, "last_edit_date": 1533776644, "creation_date": 1533775801, "answer_id": 51757431, "question_id": 51757048, "link": "https://stackoverflow.com/questions/51757048/c-char-array-not-working/51757431#51757431", "title": "C++ Char array not working", "body": "<p>Here is what happening:</p>\n\n<pre><code>cin &gt;&gt; a;\ncin.getline(s,20);\ncin.clear(); // never mind this, doesn't do anything in this context\ncin.ignore(10,'\\n');\n</code></pre>\n\n<ol>\n<li>Your <code>int</code> is read and stored in <code>a</code></li>\n<li><code>cin</code> now contains <code>\\n</code> left over after you pressed <code>Enter</code></li>\n<li><code>getline</code> immediately attempts to read it into <code>s</code> but it discards it, <code>s</code> is now empty, but <code>getline</code> operation is complete.</li>\n<li>Why does it still wait for the input of the name? Because <code>cin.ignore</code> is waiting for <code>\\n</code> or at least 10 <code>char</code>s to be entered, but the stream buffer is now empty. </li>\n<li>You enter your name and press <code>Enter</code>, <code>ignore</code> at least gets its <code>\\n</code> and is now complete but your entered string is not stored anywhere. It is just ignored. If it wasn't ignored you would have gotten the 1st <code>char</code> of this string in the output, but you haven't.</li>\n</ol>\n\n<p>Long story short, your input is broken. You should clear that <code>\\n</code> after you entered the first number before <code>getline</code>. Only then, after you have your name stored in <code>s</code> you can attempt to pass it to the function, there is no point in passing a pointer to empty array and expecting it to work. </p>\n"}], "owner": {"reputation": 21, "user_id": 6716343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fd4a9974e84f92de68a598e1e5615b9?s=128&d=identicon&r=PG&f=1", "display_name": "jBit", "link": "https://stackoverflow.com/users/6716343/jbit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 989, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1538676380, "creation_date": 1533771567, "last_edit_date": 1538676380, "question_id": 51757048, "link": "https://stackoverflow.com/questions/51757048/c-char-array-not-working", "title": "C++ Char array not working", "body": "<p>I'm trying to get this program working, but get odd output. I know a char buffer is not ideal here, but it's for an assignment and not of my own design. Here's my code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;cstring&gt;\nusing namespace std;\n\n\n//Place your class definition here\nclass student {\n   public:\n      void inputData(int a, char s[20], float e, float m, float sci);\n      void printData();\n\n   private:\n      int admno;\n      char sname[20];\n      float eng;\n      float math;\n      float science;\n      float total;\n      float ctotal();\n};\n\n\nint main ()   //This is your main driver.  Do NOT make any changes to it\n{\n    student obj ;\n    int a;\n    char s[20];\n    float e, m, sci;\n    cin &gt;&gt; a;\n    cin.getline(s,20);\n    cin.clear();\n    cin.ignore(10,'\\n');\n    cin &gt;&gt; e;\n    cin &gt;&gt; m;\n    cin &gt;&gt; sci;\n    obj.inputData(a, s, e, m, sci);\n    obj.printData();\n    return 0;\n}\n\n//Place your class member function definitions here\n\nvoid student::inputData(int a, char s[], float e, float m, float sci) {\n   admno = a;\n   *sname = *s;\n   eng = e;\n   math = m;\n   science = sci;\n   total = ctotal();\n}\n\nvoid student::printData() {\n   cout &lt;&lt; \"Admission number: \" &lt;&lt; admno &lt;&lt; endl &lt;&lt; \"Student name: \";\n   for (int i = 0; i &lt; 20; i++)\n      cout &lt;&lt; sname[i];\n   cout &lt;&lt; endl &lt;&lt; \"English: \" &lt;&lt; eng &lt;&lt; endl &lt;&lt; \"Math: \" &lt;&lt; science &lt;&lt; endl &lt;&lt; \"Science: \" &lt;&lt; science &lt;&lt; endl &lt;&lt; \"Total: \" &lt;&lt; total;\n}\n\nfloat student::ctotal() {\n   return (eng + math + science);\n}\n</code></pre>\n\n<p>Here's my input:</p>\n\n<pre><code>98745\nKyle Smith\n98\n78\n62\n</code></pre>\n\n<p>Here's the expected output:</p>\n\n<pre><code>Admission number: 98745\nStudent name: Kyle Smith\nEnglish: 98\nMath: 78\nScience: 62\nTotal: 238\n</code></pre>\n\n<p>Here's the actual output:</p>\n\n<pre><code>Admission number: 98745\nStudent name:  \u00a0m  \u2569`u\u00c4M\u25a0\u00c5\u25a0\u00a0\u00a0\u00a0\u2551k`u\nEnglish: 98\nMath: 62\nScience: 62\nTotal: 238\n</code></pre>\n\n<p>Please give advice on how to fix. I have to stick with that char buffer, but don't know why I'm getting this corruption.\nThanks!</p>\n"}, {"tags": ["c++", "vector", "smart-pointers"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1533771419, "post_id": 51757010, "comment_id": 90473469, "body": "You have too many <code>std::unique_ptr</code>. Use shared ownership, or use pointer for <code>prev</code>/<code>tail</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "is_accepted": true, "score": 0, "last_activity_date": 1533778854, "creation_date": 1533778854, "answer_id": 51757726, "question_id": 51757010, "link": "https://stackoverflow.com/questions/51757010/generic-double-linkled-list-using-smart-pointers/51757726#51757726", "title": "Generic double linkled list using smart pointers", "body": "<p>As reiterated by Jarod42 use shared_ptr and make struct node accessible. Try this:</p>\n\n<pre><code>template &lt;class T&gt;\nstruct Node {\n    Node(T val):data(val){}\n    T data;\n    std::shared_ptr&lt;Node&gt; next = nullptr;\n    std::weak_ptr&lt;Node&gt; previous ; //weak_ptr to avoid cyclic reference\n\n};\n\ntemplate &lt;class T&gt;\nclass DoubleLinkedList {\npublic:\n    void push_back(T thedata);\n\n    std::shared_ptr&lt;Node&lt;T&gt;&gt; head = nullptr;\n    std::shared_ptr&lt;Node&lt;T&gt;&gt; tail = nullptr;\n};\n\ntemplate &lt;class T&gt;\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, DoubleLinkedList&lt;T&gt;&amp; obj) {\n    std::shared_ptr&lt;Node&lt;T&gt;&gt; node = obj.head;\n    while (node!= nullptr) {\n        os &lt;&lt; node-&gt;data &lt;&lt; std::endl;\n        node = node-&gt;next;\n    }\n    return os;\n}\n\ntemplate &lt;class T&gt;\nvoid DoubleLinkedList&lt;T&gt;::push_back(T thedata) {\n    std::shared_ptr&lt;Node&lt;T&gt;&gt; newNode = std::make_shared&lt;Node&lt;T&gt;&gt;(thedata);\n    newNode-&gt;previous = tail;\n\n    if (!head) {\n        head = newNode;\n        tail = head;\n    }\n\n    else {\n        tail-&gt;next = newNode;\n        tail = tail-&gt;next;\n    }\n}\n\nint main()\n{\n    DoubleLinkedList&lt;int&gt; obj;\n    obj.push_back(2);\n    obj.push_back(4);\n    obj.push_back(6);\n    obj.push_back(8);\n    obj.push_back(10);\n    std::cout &lt;&lt; \"\\n--------------------------------------------------\\n\";\n    std::cout &lt;&lt; \"---------------displaying all nodes---------------\";\n    std::cout &lt;&lt; \"\\n--------------------------------------------------\\n\";\n    std::cout &lt;&lt; obj &lt;&lt; \"\\n\";\n\n    std::cin.get();\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1533845215, "post_id": 51757783, "comment_id": 90508623, "body": "You could do that but it isn&#39;t the purpose of <code>weak_ptr</code>."}, {"owner": {"reputation": 26620, "user_id": 23934, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wO0su.jpg?s=128&g=1", "display_name": "Drew Hall", "link": "https://stackoverflow.com/users/23934/drew-hall"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1533931036, "post_id": 51757783, "comment_id": 90544168, "body": "@curiousguy:  Agreed--I said you could do it, but in the end I wouldn&#39;t."}], "tags": [], "owner": {"reputation": 26620, "user_id": 23934, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wO0su.jpg?s=128&g=1", "display_name": "Drew Hall", "link": "https://stackoverflow.com/users/23934/drew-hall"}, "is_accepted": false, "score": 0, "last_activity_date": 1533779442, "creation_date": 1533779442, "answer_id": 51757783, "question_id": 51757010, "link": "https://stackoverflow.com/questions/51757010/generic-double-linkled-list-using-smart-pointers/51757783#51757783", "title": "Generic double linkled list using smart pointers", "body": "<p>A doubly-linked list is not a good candidate for smart pointers (at least for the internal front/back links) due to the cycles.  Nodes don't own each other, and because there's not an ownership or hierarchical relationship, there's no way for reference counts or similar to decrement such that the memory can be reclaimed when the list is no longer needed.</p>\n\n<p>However, you could conceivably use owning pointers (unique or shared) for links in one direction and weak_ptrs in the other direction to avoid those problems.  That would establish a clear parent/child relationship and allow memory management to work correctly.</p>\n\n<p>Having said all that, clients of the list certainly might want to use smart pointers to hold the items they insert into the list.  I just wouldn't use them in the list internals.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9366862"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 51757726, "answer_count": 2, "score": 0, "last_activity_date": 1533779442, "creation_date": 1533771162, "question_id": 51757010, "link": "https://stackoverflow.com/questions/51757010/generic-double-linkled-list-using-smart-pointers", "title": "Generic double linkled list using smart pointers", "body": "<p>I am trying to implement a generic double linked list using smart pointers. At the moment I am trying to write a push_back function but I get this error:</p>\n\n<pre><code>1&gt;------ Build started: Project: LinkedList, Configuration: Debug Win32 ------\n1&gt;main.cpp\n1&gt;c:\\dev\\linkedlist\\linkedlist\\doublelinkedlist.h(155): error C2679: binary '=': no operator found which takes a right-hand operand of type 'DoubleLinkedList&lt;int&gt;::Node *' (or there is no acceptable conversion)\n1&gt;c:\\program files (x86)\\microsoft visual studio\\2017\\community\\vc\\tools\\msvc\\14.14.26428\\include\\memory(2309): note: could be 'std::unique_ptr&lt;DoubleLinkedList&lt;int&gt;::Node,std::default_delete&lt;_Ty&gt;&gt; &amp;std::unique_ptr&lt;_Ty,std::default_delete&lt;_Ty&gt;&gt;::operator =(const std::unique_ptr&lt;_Ty,std::default_delete&lt;_Ty&gt;&gt; &amp;)'\n1&gt;        with\n1&gt;        [\n1&gt;            _Ty=DoubleLinkedList&lt;int&gt;::Node\n1&gt;        ]\n1&gt;c:\\program files (x86)\\microsoft visual studio\\2017\\community\\vc\\tools\\msvc\\14.14.26428\\include\\memory(2247): note: or       'std::unique_ptr&lt;DoubleLinkedList&lt;int&gt;::Node,std::default_delete&lt;_Ty&gt;&gt; &amp;std::unique_ptr&lt;_Ty,std::default_delete&lt;_Ty&gt;&gt;::operator =(std::unique_ptr&lt;_Ty,std::default_delete&lt;_Ty&gt;&gt; &amp;&amp;) noexcept'\n1&gt;        with\n1&gt;        [\n1&gt;            _Ty=DoubleLinkedList&lt;int&gt;::Node\n1&gt;        ]\n1&gt;c:\\program files (x86)\\microsoft visual studio\\2017\\community\\vc\\tools\\msvc\\14.14.26428\\include\\memory(2173): note: or       'std::unique_ptr&lt;DoubleLinkedList&lt;int&gt;::Node,std::default_delete&lt;_Ty&gt;&gt; &amp;std::unique_ptr&lt;_Ty,std::default_delete&lt;_Ty&gt;&gt;::operator =(std::nullptr_t) noexcept'\n1&gt;        with\n1&gt;        [\n1&gt;            _Ty=DoubleLinkedList&lt;int&gt;::Node\n1&gt;        ]\n1&gt;c:\\dev\\linkedlist\\linkedlist\\doublelinkedlist.h(155): note: while trying to match the argument list '(std::unique_ptr&lt;DoubleLinkedList&lt;int&gt;::Node,std::default_delete&lt;_Ty&gt;&gt;, DoubleLinkedList&lt;int&gt;::Node *)'\n1&gt;        with\n1&gt;        [\n1&gt;            _Ty=DoubleLinkedList&lt;int&gt;::Node\n1&gt;        ]\n1&gt;c:\\dev\\linkedlist\\linkedlist\\doublelinkedlist.h(153): note: while compiling class template member function 'void DoubleLinkedList&lt;int&gt;::push_back(T &amp;&amp;)'\n1&gt;        with\n1&gt;        [\n1&gt;            T=int\n1&gt;        ]\n1&gt;c:\\dev\\linkedlist\\linkedlist\\main.cpp(97): note: see reference to function template instantiation 'void DoubleLinkedList&lt;int&gt;::push_back(T &amp;&amp;)' being compiled\n1&gt;        with\n1&gt;        [\n1&gt;            T=int\n1&gt;        ]\n1&gt;c:\\dev\\linkedlist\\linkedlist\\main.cpp(96): note: see reference to class template instantiation 'DoubleLinkedList&lt;int&gt;' being compiled\n1&gt;c:\\dev\\linkedlist\\linkedlist\\doublelinkedlist.h(159): error C2679: binary '=': no operator found which takes a right-hand operand of type 'DoubleLinkedList&lt;int&gt;::Node *' (or there is no acceptable conversion)\n1&gt;c:\\program files (x86)\\microsoft visual studio\\2017\\community\\vc\\tools\\msvc\\14.14.26428\\include\\memory(2309): note: could be 'std::unique_ptr&lt;DoubleLinkedList&lt;int&gt;::Node,std::default_delete&lt;_Ty&gt;&gt; &amp;std::unique_ptr&lt;_Ty,std::default_delete&lt;_Ty&gt;&gt;::operator =(const std::unique_ptr&lt;_Ty,std::default_delete&lt;_Ty&gt;&gt; &amp;)'\n1&gt;        with\n1&gt;        [\n1&gt;            _Ty=DoubleLinkedList&lt;int&gt;::Node\n1&gt;        ]\n1&gt;c:\\program files (x86)\\microsoft visual studio\\2017\\community\\vc\\tools\\msvc\\14.14.26428\\include\\memory(2247): note: or       'std::unique_ptr&lt;DoubleLinkedList&lt;int&gt;::Node,std::default_delete&lt;_Ty&gt;&gt; &amp;std::unique_ptr&lt;_Ty,std::default_delete&lt;_Ty&gt;&gt;::operator =(std::unique_ptr&lt;_Ty,std::default_delete&lt;_Ty&gt;&gt; &amp;&amp;) noexcept'\n1&gt;        with\n1&gt;        [\n1&gt;            _Ty=DoubleLinkedList&lt;int&gt;::Node\n1&gt;        ]\n1&gt;c:\\program files (x86)\\microsoft visual studio\\2017\\community\\vc\\tools\\msvc\\14.14.26428\\include\\memory(2173): note: or       'std::unique_ptr&lt;DoubleLinkedList&lt;int&gt;::Node,std::default_delete&lt;_Ty&gt;&gt; &amp;std::unique_ptr&lt;_Ty,std::default_delete&lt;_Ty&gt;&gt;::operator =(std::nullptr_t) noexcept'\n1&gt;        with\n1&gt;        [\n1&gt;            _Ty=DoubleLinkedList&lt;int&gt;::Node\n1&gt;        ]\n1&gt;c:\\dev\\linkedlist\\linkedlist\\doublelinkedlist.h(159): note: while trying to match the argument list '(std::unique_ptr&lt;DoubleLinkedList&lt;int&gt;::Node,std::default_delete&lt;_Ty&gt;&gt;, DoubleLinkedList&lt;int&gt;::Node *)'\n1&gt;        with\n1&gt;        [\n1&gt;            _Ty=DoubleLinkedList&lt;int&gt;::Node\n1&gt;        ]\n1&gt;c:\\dev\\linkedlist\\linkedlist\\doublelinkedlist.h(163): error C2065: 'newnode': undeclared identifier\n1&gt;c:\\dev\\linkedlist\\linkedlist\\doublelinkedlist.h(164): error C2679: binary '=': no operator found which takes a right-hand operand of type 'DoubleLinkedList&lt;int&gt;::Node *' (or there is no acceptable conversion)\n1&gt;c:\\program files (x86)\\microsoft visual studio\\2017\\community\\vc\\tools\\msvc\\14.14.26428\\include\\memory(2309): note: could be 'std::unique_ptr&lt;DoubleLinkedList&lt;int&gt;::Node,std::default_delete&lt;_Ty&gt;&gt; &amp;std::unique_ptr&lt;_Ty,std::default_delete&lt;_Ty&gt;&gt;::operator =(const std::unique_ptr&lt;_Ty,std::default_delete&lt;_Ty&gt;&gt; &amp;)'\n1&gt;        with\n1&gt;        [\n1&gt;            _Ty=DoubleLinkedList&lt;int&gt;::Node\n1&gt;        ]\n1&gt;c:\\program files (x86)\\microsoft visual studio\\2017\\community\\vc\\tools\\msvc\\14.14.26428\\include\\memory(2247): note: or       'std::unique_ptr&lt;DoubleLinkedList&lt;int&gt;::Node,std::default_delete&lt;_Ty&gt;&gt; &amp;std::unique_ptr&lt;_Ty,std::default_delete&lt;_Ty&gt;&gt;::operator =(std::unique_ptr&lt;_Ty,std::default_delete&lt;_Ty&gt;&gt; &amp;&amp;) noexcept'\n1&gt;        with\n1&gt;        [\n1&gt;            _Ty=DoubleLinkedList&lt;int&gt;::Node\n1&gt;        ]\n1&gt;c:\\program files (x86)\\microsoft visual studio\\2017\\community\\vc\\tools\\msvc\\14.14.26428\\include\\memory(2173): note: or       'std::unique_ptr&lt;DoubleLinkedList&lt;int&gt;::Node,std::default_delete&lt;_Ty&gt;&gt; &amp;std::unique_ptr&lt;_Ty,std::default_delete&lt;_Ty&gt;&gt;::operator =(std::nullptr_t) noexcept'\n1&gt;        with\n1&gt;        [\n1&gt;            _Ty=DoubleLinkedList&lt;int&gt;::Node\n1&gt;        ]\n1&gt;c:\\dev\\linkedlist\\linkedlist\\doublelinkedlist.h(164): note: while trying to match the argument list '(std::unique_ptr&lt;DoubleLinkedList&lt;int&gt;::Node,std::default_delete&lt;_Ty&gt;&gt;, DoubleLinkedList&lt;int&gt;::Node *)'\n1&gt;        with\n1&gt;        [\n1&gt;            _Ty=DoubleLinkedList&lt;int&gt;::Node\n1&gt;        ]\n1&gt;Done building project \"LinkedList.vcxproj\" -- FAILED.\n========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ==========\n</code></pre>\n\n<p>This is the function I am trying to implement:</p>\n\n<pre><code>template &lt;class T&gt;\nvoid DoubleLinkedList&lt;T&gt;::push_back(T &amp;&amp;thedata) {\n    std::unique_ptr&lt;Node&gt; newNode = std::make_unique&lt;Node&gt;(std::move(thedata));\n    newNode-&gt;previous = std::move(tail.get());\n\n    if (!head) {\n        head = std::move(newNode);\n        tail = head.get();\n    }\n\n    else {\n        tail-&gt;next = std::move(newnode);\n        tail = tail-&gt;next.get();\n    }\n}\n</code></pre>\n\n<p>The error occurs at <code>newNode-&gt;previous = std::move(tail.get());</code> and at <code>tail = tail-&gt;next.get();</code>. I do not know how to fix this issue to make sure I am making the correct links I need for a double linked list.</p>\n\n<p>This what the class where I initialize tail and head looks like:</p>\n\n<pre><code>class DoubleLinkedList {\nprivate:\n\n    struct Node {\n        T data;\n        std::unique_ptr&lt;Node&gt; next = nullptr;\n        std::unique_ptr&lt;Node&gt; previous = nullptr;\n\n    };\n    std::unique_ptr&lt;Node&gt; head = nullptr;\n    std::unique_ptr&lt;Node&gt; tail = nullptr;\n};\n</code></pre>\n\n<p>Here is when I try to use the push_back function:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iterator&gt;\n#include &lt;memory&gt;\n#include &lt;utility&gt;\n#include &lt;stdexcept&gt;\n#include &lt;iosfwd&gt;\n#include &lt;stdexcept&gt;\n#include &lt;ostream&gt;\n#include \"DoubleLinkedList.h\"\n\nint main(int argc, const char * argv[]) {\n\n\n     ///////////////////////////////////////////////////////////////////////\n     ///////////////////////////// Double Linked List //////////////////////\n     ///////////////////////////////////////////////////////////////////////\n     DoubleLinkedList&lt;int&gt; obj;\n     obj.push_back(2);\n     obj.push_back(4);\n     obj.push_back(6);\n     obj.push_back(8);\n     obj.push_back(10);\n     std::cout&lt;&lt;\"\\n--------------------------------------------------\\n\";\n     std::cout&lt;&lt;\"---------------displaying all nodes---------------\";\n     std::cout&lt;&lt;\"\\n--------------------------------------------------\\n\";\n     std::cout &lt;&lt; obj &lt;&lt; \"\\n\";\n\n\n    std::cin.get();\n}\n</code></pre>\n"}, {"tags": ["c++", "oop", "opencl"], "comments": [{"owner": {"reputation": 641, "user_id": 8387427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/883d5988e104bc94054083b9d6a10bb3?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Savonichev", "link": "https://stackoverflow.com/users/8387427/andrew-savonichev"}, "edited": false, "score": 0, "creation_date": 1533792985, "post_id": 51756967, "comment_id": 90478104, "body": "Can you move <code>cl_program</code> into <code>clfunctor</code> object, and call <code>clReleaseProgram</code> only in <code>~clfunctor()</code>?  I&#39;m not sure what happens if you release a program, and then use a kernel from this program."}, {"owner": {"reputation": 834, "user_id": 2024007, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d112c032d7f7ac87bbbfb8bd57a90299?s=128&d=identicon&r=PG", "display_name": "MooMoo", "link": "https://stackoverflow.com/users/2024007/moomoo"}, "reply_to_user": {"reputation": 641, "user_id": 8387427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/883d5988e104bc94054083b9d6a10bb3?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Savonichev", "link": "https://stackoverflow.com/users/8387427/andrew-savonichev"}, "edited": false, "score": 0, "creation_date": 1533793994, "post_id": 51756967, "comment_id": 90478441, "body": "Thanks Andrew. Yep I tested it but the result is same. ;("}, {"owner": {"reputation": 8423, "user_id": 463796, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/Yihjq.png?s=128&g=1", "display_name": "w-m", "link": "https://stackoverflow.com/users/463796/w-m"}, "edited": false, "score": 0, "creation_date": 1533808688, "post_id": 51756967, "comment_id": 90486732, "body": "<code>set_kernel_code setting</code> is setting <code>kernel</code> and <code>operator()</code> is using <code>kernel</code> to execute, but the member variable is called <code>*my*kernel</code>. If this isn&#39;t a copy/paste error in the StackOverflow question, you maybe writing a global variable called <code>kernel</code>, and not the member."}, {"owner": {"reputation": 834, "user_id": 2024007, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d112c032d7f7ac87bbbfb8bd57a90299?s=128&d=identicon&r=PG", "display_name": "MooMoo", "link": "https://stackoverflow.com/users/2024007/moomoo"}, "edited": false, "score": 0, "creation_date": 1533824241, "post_id": 51756967, "comment_id": 90497376, "body": "Oh. Thanks for pointing out. my typo. It should name mykernel. I changed the variable name a bit before posted in StackOverflow. I will fix it"}], "answers": [{"comments": [{"owner": {"reputation": 834, "user_id": 2024007, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d112c032d7f7ac87bbbfb8bd57a90299?s=128&d=identicon&r=PG", "display_name": "MooMoo", "link": "https://stackoverflow.com/users/2024007/moomoo"}, "edited": false, "score": 0, "creation_date": 1533824484, "post_id": 51764249, "comment_id": 90497550, "body": "I pass arguments instead of using flag -D. It works!. I think same as you the problem about caching something. If I reuse the same code with different -D flag, the problem will happen but if I use other cl codes, everything is fine."}, {"owner": {"reputation": 641, "user_id": 8387427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/883d5988e104bc94054083b9d6a10bb3?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Savonichev", "link": "https://stackoverflow.com/users/8387427/andrew-savonichev"}, "edited": false, "score": 0, "creation_date": 1533830680, "post_id": 51764249, "comment_id": 90501807, "body": "Caching mechanism should take compiler options into account, otherwise it is a bug in the opencl driver."}], "tags": [], "owner": {"reputation": 3844, "user_id": 711654, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/Eyh5u.jpg?s=128&g=1", "display_name": "Boris Ivanov", "link": "https://stackoverflow.com/users/711654/boris-ivanov"}, "is_accepted": false, "score": 1, "last_activity_date": 1533809238, "creation_date": 1533809238, "answer_id": 51764249, "question_id": 51756967, "link": "https://stackoverflow.com/questions/51756967/opencl-reuse-cl-kernel-with-different-define-d/51764249#51764249", "title": "OpenCL reuse cl_kernel with different DEFINE ( -D )", "body": "<p>I am afraid caching happen. Compiler generates binary with 123 inside and simply reused. \ncreate on-fly cl file with random name and u will be always with correct value. Or better don't use flags but just pass argument to kernel</p>\n"}], "owner": {"reputation": 834, "user_id": 2024007, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d112c032d7f7ac87bbbfb8bd57a90299?s=128&d=identicon&r=PG", "display_name": "MooMoo", "link": "https://stackoverflow.com/users/2024007/moomoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533959270, "creation_date": 1533770728, "last_edit_date": 1533959270, "question_id": 51756967, "link": "https://stackoverflow.com/questions/51756967/opencl-reuse-cl-kernel-with-different-define-d", "title": "OpenCL reuse cl_kernel with different DEFINE ( -D )", "body": "<p>My goal is to reduce calling overhead when I call cl_kernel\nI started by creating functor class called <em>clfunctor</em></p>\n\n<p>The class consists of constructor with 'kernel sourcecode', 'main function name' and compile 'options' as parameters\n      then the constructor will call <em>set_kernel_code(...)</em> to compile and build the code with those parameters. finally will get '<em>mykernel</em>' as the output of the '<em>set_kernel_code</em>' function</p>\n\n<pre><code>class clfunctor \n{\n      // comile sourcecode to cl_kernel\n      void set_kernel_code(const std::string&amp; sourcecode, const std::string&amp; \n                           program_name, const std::string&amp; options=\"\")\n      { \n              char* kernel_source = new char[ sourcecode.size() + 1 ];\n              std::copy( sourcecode.begin(), sourcecode.end(), kernel_source \n              );\n              kernel_source[ sourcecode.size() ] = '\\0'; // opencl need \\0 to end kernel_code\n\n              cl_program program;\n\n              program = clCreateProgramWithSource( myclcontext, 1, (const char **)&amp;kernel_source, NULL, &amp;err);\n              if( err != 0 ) echo_error( cl_error_string(err) ); // if error here.. call cl_init() ???\n\n              //build program from opencl device\n              clBuildProgram(program, 1, &amp;device[iplatform][idevice], options.c_str(), NULL, NULL);\n              if( err != 0 ) echo_error( cl_error_string(err) );\n\n              // no have kernel\n              mykernel = clCreateKernel( program, program_name.c_str(), &amp;err );\n              const size_t LOG_SIZ = 2040;\n\n\n              clReleaseProgram( program );\n              delete kernel_source;\n       }\n\n\n\n\n\npublic:\n\ncl_kernel           mykernel;\nstd::vector&lt;size_t&gt; local_nd;\nstd::vector&lt;size_t&gt; global_nd;\n\n\n\nclfunctor(const std::string&amp; sourcecode, const std::string&amp; program_name, const std::string&amp; options)\n{\n    set_kernel_code( sourcecode, program_name, options );\n}\n\n\n\n\nvoid operator()() const\n{\n    cl_int err;\n\n\n    //-----------------------------------\n    //        create GPU queue\n    //----------------------------------\n    cl_command_queue queue = clCreateCommandQueue( myclcontext, device[iplatform][idevice], 0, &amp;err);\n    if( err != 0 ) echo_error( cl_error_string(err) );\n\n\n\n    cl_uint work_dim = local_nd.size(); // ND dimension ( N )\n    err = clEnqueueNDRangeKernel( queue, kernel, work_dim, NULL, global_nd.data(), local_nd.data(), 0, NULL, NULL);\n    if( err != 0 ) echo_error( cl_error_string(err) );\n    clFinish( queue );\n\n\n\n\n    clReleaseCommandQueue( queue );\n}\n\n\nvirtual ~clfunctor()\n{\n    // relase kernel with object is destroyed\n    clReleaseKernel( mykernel );\n}\n\n};\n</code></pre>\n\n<p>and I have a sample cl file 'nothing.cl 'is</p>\n\n<pre><code>kernel void nothing()\n{\n    printf(\"[ echo ]: %d\\n\", MYID  );\n}\n</code></pre>\n\n<p>after that I create this functor object by</p>\n\n<pre><code>clfunctor0 hello( file2code(\"nothing.cl\"), \"nothing\", \"-DMYID=100\");\nhello.local_nd  = {1,1,1};\nhello.global_nd = {1,1,1};\nhello();   // print 100\n\n\nclfunctor0 hello2( file2code(\"nothing.cl\"), \"nothing\", \"-DMYID=123\");\nhello2.local_nd  = {1,1,1};\nhello2.global_nd = {1,1,1};\nhello2(); // print 123\n\n\nhello();  // THIS IS WRONG I expect it to print 100 but it print 123\n</code></pre>\n\n<p>as the code above, you can see I create two objects. one is 'hello' and another is 'hello2' both objects share the same code from 'nothing.cl' but differ in DEFINE (-D) compilation. 'hello' uses <strong>-DMYID=100</strong> ( MYID = 100 ) but hello2 uses <strong>-DMYID=123</strong> ( MYID = 123 )</p>\n\n<p>I expect those objects hold different mykernel since the compilation options are different. First I call <em>hello()</em> I print correctly  '100'</p>\n\n<p>then I call <em>hello2()</em> it also print correctly '123'</p>\n\n<p>However when I call hello() again It instead of print '100' \nit print the parameter from hello2 which is 123</p>\n\n<p>How could I make the kernel for each object differently with only -D(DEFINE) compilation parameter. Or I did something wrong or misunderstand about opencl kernel.</p>\n"}, {"tags": ["c++", "c++11", "sfinae"], "answers": [{"tags": [], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": true, "score": 5, "last_activity_date": 1533771710, "creation_date": 1533771710, "answer_id": 51757063, "question_id": 51756936, "link": "https://stackoverflow.com/questions/51756936/separate-definition-and-declaration-of-template-member-function-using-enable-if/51757063#51757063", "title": "Separate definition and declaration of template member function using enable_if whose template parameter also includes a constexpr member function", "body": "<p>The matching of expressions in template declarations is based on <a href=\"https://timsong-cpp.github.io/cppwp/temp.over.link#5.sentence-1\" rel=\"noreferrer\"><em>equivalence</em></a>, a concept based on the one-definition rule. For two expressions to be considered equivalent, they must be at least token-by-token identical modulo the renaming of template parameters. </p>\n\n<p>The expressions <code>is_valid&lt;T&gt;()</code> and <code>Hey::is_valid&lt;T&gt;()</code> are not equivalent (the second has two tokens the first doesn't have), and so the compiler is not required to match them.</p>\n\n<p><code>Hey::EnableType&lt;T&gt;</code> is a type, and is not subject to the strict equivalence rules for expressions.</p>\n"}], "owner": {"reputation": 336, "user_id": 2555084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a61cfad88316ce9aea416ff9c6ae78?s=128&d=identicon&r=PG", "display_name": "Zark Bardoo", "link": "https://stackoverflow.com/users/2555084/zark-bardoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 708, "favorite_count": 0, "accepted_answer_id": 51757063, "answer_count": 1, "score": 3, "last_activity_date": 1533772139, "creation_date": 1533770433, "last_edit_date": 1533771239, "question_id": 51756936, "link": "https://stackoverflow.com/questions/51756936/separate-definition-and-declaration-of-template-member-function-using-enable-if", "title": "Separate definition and declaration of template member function using enable_if whose template parameter also includes a constexpr member function", "body": "<p>The following doesn't compile under g++ 8.1.0 on CentOS 7:</p>\n\n<p><strong>hey.h</strong></p>\n\n<pre><code>#pragma once\n#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\nclass Valid {};\nclass Invalid {};\n\nstruct Hey\n{\n  template&lt;typename T&gt;\n  static constexpr bool is_valid() { return std::is_same_v&lt;T, Valid&gt;; }\n\n  template&lt;typename T, std::enable_if_t&lt;is_valid&lt;T&gt;()&gt;* = nullptr&gt;\n    void howdy() const;\n};\n\ntemplate&lt;typename T, std::enable_if_t&lt;Hey::is_valid&lt;T&gt;()&gt;*&gt;\n  void Hey::howdy() const\n{\n  std::cout &lt;&lt; \"Howdy\" &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Compiler output:</p>\n\n<pre><code>In file included from hey.cpp:1:\nhey.h:18:8: error: no declaration matches \u2018void Hey::howdy() const\u2019\n   void Hey::howdy() const\n        ^~~\nhey.h:14:10: note: candidate is: \u2018template&lt;class T, std::enable_if_t&lt;is_valid&lt;T&gt;()&gt;* &lt;anonymous&gt; &gt; void Hey::howdy() const\u2019\n     void howdy() const;\n          ^~~~~\nhey.h:8:8: note: \u2018struct Hey\u2019 defined here\n struct Hey\n        ^~~\n</code></pre>\n\n<p>Amazingly, all I have to do to both compile correctly and get the desired behavior is add a typedef in Hey:</p>\n\n<p><strong>hey.h (fixed, first few boring lines skipped)</strong></p>\n\n<pre><code>struct Hey\n{\n  template&lt;typename T&gt;\n  static constexpr bool is_valid() { return std::is_same_v&lt;T, Valid&gt;; }\n\n  template&lt;typename T&gt;\n  using EnableType = std::enable_if_t&lt;is_valid&lt;T&gt;()&gt;;\n\n  template&lt;typename T, EnableType&lt;T&gt;* = nullptr&gt;\n    void howdy() const;\n};\n\ntemplate&lt;typename T, Hey::EnableType&lt;T&gt;*&gt;\n  void Hey::howdy() const\n{\n  std::cout &lt;&lt; \"Howdy\" &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p><strong>hey.cpp</strong></p>\n\n<pre><code>#include \"hey.h\"\n\nint main(int, char**)\n{\n  Hey hey;\n  hey.howdy&lt;Valid&gt;();\n\n  // Adding this line breaks the build, as it should:\n  // hey.howdy&lt;Invalid&gt;();\n\n  return 0;\n}\n</code></pre>\n\n<p>After many tweaks, I've narrowed the compiler error situation to the fact that 1) <code>is_valid()</code> is a member of <code>Hey</code> and 2) <code>howdy()</code> is declared inside <code>Hey</code>'s body but defined outside. If you delete the <code>using</code> and make <code>is_valid()</code> a standalone function outside of <code>Hey</code>, there are no issues compiling. If you delete the <code>using</code> and define <code>howdy()</code> inside the class definition, there are also no issue compiling. But when <code>howdy()</code> is defined outside of the class definition, <code>is_valid()</code> is declared inside of the class definition, and the <code>using</code> isn't present, the compiler fails. Is this correct behavior? Am I looking at a compiler bug?</p>\n"}, {"tags": ["c++", "twincat"], "comments": [{"owner": {"reputation": 3832, "user_id": 5771128, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/g8dup.jpg?s=128&g=1", "display_name": "Charlie Joynt", "link": "https://stackoverflow.com/users/5771128/charlie-joynt"}, "edited": false, "score": 0, "creation_date": 1533770546, "post_id": 51756724, "comment_id": 90473269, "body": "Hi and welcome to Stack Overflow. You&#39;ll get better help if you can focus your post into just one question, and include any code you have written while trying to solve your problem."}, {"owner": {"reputation": 898, "user_id": 1645097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nnBkv.png?s=128&g=1", "display_name": "Jakob", "link": "https://stackoverflow.com/users/1645097/jakob"}, "edited": false, "score": 1, "creation_date": 1534002598, "post_id": 51756724, "comment_id": 90559010, "body": "Just out of curiosity, why C++? Is it not possible to do in with any of the IEC61131-3 languages, such as structured text? Although it is possible to use C++ in TwinCAT, it generally comes with some caveats, so if you do not have any specific requirements or reason to go with C++ I would advise to use ST, in which case you would use the FB_FileOpen, FB_FileWrite, FB_FileClose function blocks in TwinCAT."}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 2235945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f2feced3fa441070d269b7f88f7171e?s=128&d=identicon&r=PG", "display_name": "Teuxe", "link": "https://stackoverflow.com/users/2235945/teuxe"}, "is_accepted": false, "score": 0, "last_activity_date": 1535643829, "creation_date": 1535643829, "answer_id": 52100916, "question_id": 51756724, "link": "https://stackoverflow.com/questions/51756724/beckhoff-how-to-open-and-read-a-file-in-twincat-3-c-in-a-cycleupdate/52100916#52100916", "title": "Beckhoff How to Open and Read a file in TWINCAT 3 C++ in a CycleUpdate?", "body": "<p>As a first step, you have to understand that TwinCAT is providing you a PLC with real-time capabilities. Which means each task you program will need to be executed at every cycle: your task must NOT exceed a certain duration.</p>\n\n<p>Many accesses to the operating system require a lot of wait times, that you would not keep in a real-time system. For that, most of function blocks you will find are equipped with an \"Execute\" boolean input (or similar) and outputs like \"Busy\", \"Done\" and \"Error\" (even \"ErrorID\"). These are here in order to start a process and check periodically (i.e. in each cycle) whether the process is complete.</p>\n\n<p>You cannot manage a file opening, reading, writing or closing (OS functions) within a single CycleUpdate. This is the cost for assuring real-time capabilities besides.</p>\n"}], "owner": {"reputation": 1, "user_id": 9897328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Leonardo Bortoni", "link": "https://stackoverflow.com/users/9897328/leonardo-bortoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 691, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535643829, "creation_date": 1533768769, "last_edit_date": 1533770749, "question_id": 51756724, "link": "https://stackoverflow.com/questions/51756724/beckhoff-how-to-open-and-read-a-file-in-twincat-3-c-in-a-cycleupdate", "title": "Beckhoff How to Open and Read a file in TWINCAT 3 C++ in a CycleUpdate?", "body": "<p>I am learning to use TWINCAT 3 with C++ and as my first work, I decided open a <code>.txt</code> file and get a number inside, and put on an string or an integer.</p>\n\n<p>I have read all the documentation and have many questions. I discovered that I can't use the C++ libraries, just the TWINCAT functions. Then I got lost.</p>\n\n<p>First: What are the exacts steps to Open a file in TWINCAT 3 with C++?</p>\n\n<p>Second: How can I read the data in the file and put in an string or integer?</p>\n\n<p>I would like to do that in a CycleUpdate.</p>\n\n<p>I am sorry if it is a noob question.</p>\n"}, {"tags": ["c++", "cmake", "cuda", "include-path"], "comments": [{"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 2163, "user_id": 5085250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/10k8D.jpg?s=128&g=1", "display_name": "havogt", "link": "https://stackoverflow.com/users/5085250/havogt"}, "edited": false, "score": 0, "creation_date": 1533800863, "post_id": 51756562, "comment_id": 90481817, "body": "@havogt: Yes, and you can make that an answer. But is there also a similar variable for the CUDA libraries?"}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1533824426, "post_id": 51756562, "comment_id": 90497513, "body": "on a normal CUDA install, the include location (dir) for CUDA libraries (i.e. their header files) is the same as the one for CUDA toolkit."}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1533825369, "post_id": 51756562, "comment_id": 90498163, "body": "@RobertCrovella: Yes, but I want to know what CMake knows, not make my own guesses which may be inconsistent with it."}], "answers": [{"comments": [{"owner": {"reputation": 2163, "user_id": 5085250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/10k8D.jpg?s=128&g=1", "display_name": "havogt", "link": "https://stackoverflow.com/users/5085250/havogt"}, "reply_to_user": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 1, "creation_date": 1533827991, "post_id": 51769885, "comment_id": 90500016, "body": "I think support for CUDA with MSVC was added only in 3.9 that&#39;s why I picked that."}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1601119200, "post_id": 51769885, "comment_id": 113309611, "body": "Thank you for the update (which I happened upon accidentally...) this is much more convenient. Unfortunately, it&#39;ll be several years before we can assume CMake 3.17 is available on people&#39;s systems... :-("}], "tags": [], "owner": {"reputation": 2163, "user_id": 5085250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/10k8D.jpg?s=128&g=1", "display_name": "havogt", "link": "https://stackoverflow.com/users/5085250/havogt"}, "is_accepted": true, "score": 17, "last_activity_date": 1601118908, "last_edit_date": 1601118908, "creation_date": 1533825613, "answer_id": 51769885, "question_id": 51756562, "link": "https://stackoverflow.com/questions/51756562/obtaining-the-cuda-include-dir-in-c-targets-with-native-cuda-support-cmake/51769885#51769885", "title": "Obtaining the CUDA include dir in C++ targets with native-CUDA-support CMake?", "body": "<p>The <strong>include directories</strong>, which are used by the compiler set by <code>CMAKE_CUDA_COMPILER</code>, can be retrieved from the CMake variable <a href=\"https://cmake.org/cmake/help/latest/variable/CMAKE_CUDA_TOOLKIT_INCLUDE_DIRECTORIES.html\" rel=\"noreferrer\"><code>CMAKE_CUDA_TOOLKIT_INCLUDE_DIRECTORIES</code></a>.</p>\n<p>For getting the <strong>libraries</strong>, the best way is probably to use <code>find_library()</code> in combination with <a href=\"https://cmake.org/cmake/help/latest/variable/CMAKE_LANG_IMPLICIT_INCLUDE_DIRECTORIES.html\" rel=\"noreferrer\"><code>CMAKE_CUDA_IMPLICIT_LINK_DIRECTORIES</code></a>.</p>\n<p>Example:</p>\n<pre><code>cmake_minimum_required(VERSION 3.9)\nproject(MyProject VERSION 1.0)\nenable_language(CUDA)\n\nfind_library(CUDART_LIBRARY cudart ${CMAKE_CUDA_IMPLICIT_LINK_DIRECTORIES})\n\nadd_executable(\n    binary_linking_to_cudart \n    my_cpp_file_using_cudart.cpp\n)\ntarget_include_directories(\n    binary_linking_to_cudart \n    PRIVATE \n    ${CMAKE_CUDA_TOOLKIT_INCLUDE_DIRECTORIES}\n)\ntarget_link_libraries(\n    binary_linking_to_cudart \n    ${CUDART_LIBRARY}\n)\n</code></pre>\n<p>This issue is also discussed on the CMake bug tracker: <a href=\"https://gitlab.kitware.com/cmake/cmake/issues/17816\" rel=\"noreferrer\">Provide target libraries for cuda libraries</a>.</p>\n<hr />\n<p><strong>Update: CMake 3.17.0 adds FindCUDAToolkit</strong></p>\n<p>Instead of doing <code>find_library()</code> manually, the best way as of CMake 3.17.0 would be to use the <code>CUDAToolkit</code> module.</p>\n<pre><code>find_package(CUDAToolkit)\nadd_executable(\n    binary_linking_to_cudart \n    my_cpp_file_using_cudart.cpp\n)\ntarget_link_libraries(binary_linking_to_cudart PRIVATE CUDA::cudart)\n</code></pre>\n<p>For support with earlier CMake versions, you can ship the <code>CUDATookit</code> module file with minimal changes in your repository.</p>\n"}], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6058, "favorite_count": 1, "accepted_answer_id": 51769885, "answer_count": 1, "score": 5, "last_activity_date": 1601118908, "creation_date": 1533767517, "last_edit_date": 1545932426, "question_id": 51756562, "link": "https://stackoverflow.com/questions/51756562/obtaining-the-cuda-include-dir-in-c-targets-with-native-cuda-support-cmake", "title": "Obtaining the CUDA include dir in C++ targets with native-CUDA-support CMake?", "body": "<p>In CMake version 3.8, native support for CUDA as a language was introduced. When a project has CUDA as one of its languages, CMake will proceed to locate CUDA (e.g. it locates the nvcc binary).</p>\n\n<p>As long as you only compile CUDA code - this is enough. But what if you want to compile a C++ target in that project? The CUDA includes are not <code>-I</code>'ed automatically, and <code>CMakeCache.txt</code> does not seem to contain the CUDA include path anywhere.</p>\n\n<p>Do I actually have to run something <code>find_package(CUDA 9.0 REQUIRED)</code> even when CMake itself has already located CUDA? Or - can I obtain the include directory some other way?</p>\n"}, {"tags": ["c++", "scanf", "istream"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1533766300, "post_id": 51756337, "comment_id": 90472227, "body": "<i>Which way achieves the quickest runtime ignoring memory footprint?</i> <code>sscanf&#47;fscanf</code> is probably tad faster but it might not be sigfnificant. Give it a shot and find out the difference."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1533766568, "post_id": 51756337, "comment_id": 90472298, "body": "&quot;<i>Which way achieves the quickest runtime ignoring memory footprint?</i>&quot; - profile the code and find out for yourself"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1533766575, "post_id": 51756337, "comment_id": 90472300, "body": "Since you asked about <code>mmap</code> performance, see my answers: <a href=\"https://stackoverflow.com/questions/37172740/how-does-mmap-improve-file-reading-speed/37173063#37173063\" title=\"how does mmap improve file reading speed\">stackoverflow.com/questions/37172740/&hellip;</a> and more to the point: <a href=\"https://stackoverflow.com/questions/33616284/read-line-by-line-in-the-most-efficient-way-platform-specific/33620968#33620968\" title=\"read line by line in the most efficient way platform specific\">stackoverflow.com/questions/33616284/&hellip;</a>"}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1533766593, "post_id": 51756337, "comment_id": 90472309, "body": "Overloading <code>operator&gt;&gt;</code> mostly determines the syntax for calling it. If you want to implement that using <code>scanf</code>, that&#39;s pretty trivial to do. In other words, this isn&#39;t really an either/or situation. You can do one or both as you see fit."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 4, "creation_date": 1533766699, "post_id": 51756337, "comment_id": 90472353, "body": "The <code>sscanf</code> does not have format specifiers for <code>std::string</code>."}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 0, "creation_date": 1533766744, "post_id": 51756337, "comment_id": 90472358, "body": "You can use <code>std::cin</code> and <code>&gt;&gt;</code> without overloading the <code>&gt;&gt;</code> operator. Just read into a temporary object and push it into the vector like you do with <code>sscanf</code>. Might as well stick with C++ I/O if you don&#39;t need to use C I/O."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 1, "creation_date": 1533766986, "post_id": 51756337, "comment_id": 90472437, "body": "Note: If you are using std::cin rather than a file. Remember to unlink the C++ buffer from the C buffer. That will improve performance. <a href=\"https://en.cppreference.com/w/cpp/io/ios_base/sync_with_stdio\" rel=\"nofollow noreferrer\"><code>std::ios::sync_with_stdio(false);</code></a>"}, {"owner": {"reputation": 379, "user_id": 7771270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9768b57b64496acdbb5438b76c1cad8e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Petrosyan", "link": "https://stackoverflow.com/users/7771270/alex-petrosyan"}, "reply_to_user": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1533812921, "post_id": 51756337, "comment_id": 90489337, "body": "@MartinYork, unfortunately I do need to mix C/C++ io, otherwise it\u2019s sound advice."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1533835821, "post_id": 51756337, "comment_id": 90504472, "body": "@AlexPetrosyan I question the &quot;Need&quot;. You may happen to have C code mixed with your C++. But need is a strong word. You just don&#39;t want to pay the effort to re-factor it out. Which could be a valid choice. But mixing these completely different languages you will not get the full power of C++. Pick one language it makes things simpler in the long run."}, {"owner": {"reputation": 379, "user_id": 7771270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9768b57b64496acdbb5438b76c1cad8e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Petrosyan", "link": "https://stackoverflow.com/users/7771270/alex-petrosyan"}, "reply_to_user": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1533836202, "post_id": 51756337, "comment_id": 90504633, "body": "@MartinYork, I understand what you mean, but sometimes you simply can&#39;t refactor the code out, e.g. when you&#39;re using an external library and you&#39;re not allowed to touch it (my case)."}], "answers": [{"comments": [{"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1533766842, "post_id": 51756420, "comment_id": 90472389, "body": "Beat me to it. :-). But you can also use the <code>std::vector&lt;Person&gt;</code> constructor that takes two iterators: <code>std::vector&lt;Person&gt;   person_vector(iit, eos);</code>"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1533767434, "post_id": 51756420, "comment_id": 90472559, "body": "@MartinYork Thank you very much, that makes perfect sense!"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 379, "user_id": 7771270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9768b57b64496acdbb5438b76c1cad8e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Petrosyan", "link": "https://stackoverflow.com/users/7771270/alex-petrosyan"}, "edited": false, "score": 0, "creation_date": 1533812468, "post_id": 51756420, "comment_id": 90489033, "body": "@AlexPetrosyan Sure, <code>std::istreambuf_iterator&lt;Person&gt;</code> should work as well. I am not sure what advantages you would get from operating on the &quot;raw&quot; character level, though."}, {"owner": {"reputation": 379, "user_id": 7771270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9768b57b64496acdbb5438b76c1cad8e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Petrosyan", "link": "https://stackoverflow.com/users/7771270/alex-petrosyan"}, "edited": false, "score": 0, "creation_date": 1533812659, "post_id": 51756420, "comment_id": 90489178, "body": "@dasblinkenlight, I think this is the exact use case for buffered io. In Java, <code>bufferedReader</code> when used to read objects from standard input(s), will not construct temporary objects for assignment on a character by character, but rather object by object basis. In my case this leads to a performance bump, so I think it\u2019s worthwhile."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 379, "user_id": 7771270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9768b57b64496acdbb5438b76c1cad8e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Petrosyan", "link": "https://stackoverflow.com/users/7771270/alex-petrosyan"}, "edited": false, "score": 1, "creation_date": 1533813655, "post_id": 51756420, "comment_id": 90489801, "body": "@AlexPetrosyan In C++ the implementation is very different, so &quot;raw characters&quot; means something else. See <a href=\"https://stackoverflow.com/a/34458016/335858\">this answer</a> for a very detailed explanation of what&#39;s different (spoiler: not much)."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 9, "last_activity_date": 1533767966, "last_edit_date": 1533767966, "creation_date": 1533766622, "answer_id": 51756420, "question_id": 51756337, "link": "https://stackoverflow.com/questions/51756337/overriding-istream-operator-vs-using-sscanf/51756420#51756420", "title": "overriding `istream operator&gt;&gt;` vs using `sscanf`", "body": "<p>Since you are reading from a file, the performance is going to be I/O-bound. Almost no matter what you do in memory, the effect on the overall performance is not going to be detectable.</p>\n\n<p>I would prefer the <code>operator&gt;&gt;</code> route, because this would let me use the input iterator idiom of C++:</p>\n\n<pre><code>std::istream_iterator&lt;Person&gt; eos;\nstd::istream_iterator&lt;Person&gt; iit(inputFile);\nstd::copy(iit, eos, std::back_inserter(person_vector));\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>std::vector&lt;Person&gt;   person_vector(\n    std::istream_iterator&lt;Person&gt;(inputFile)\n,   std::istream_iterator&lt;Person&gt;()\n);\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 7771270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9768b57b64496acdbb5438b76c1cad8e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Petrosyan", "link": "https://stackoverflow.com/users/7771270/alex-petrosyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 51756420, "answer_count": 1, "score": 1, "last_activity_date": 1533767966, "creation_date": 1533766148, "question_id": 51756337, "link": "https://stackoverflow.com/questions/51756337/overriding-istream-operator-vs-using-sscanf", "title": "overriding `istream operator&gt;&gt;` vs using `sscanf`", "body": "<p>Say I wanted to initialise a <code>std::vector</code> of objects e.g. </p>\n\n<p><code>class Person { int ID; string name; ...}</code></p>\n\n<p>from a file that contains a line for each object. One route, is to override <code>operator&gt;&gt;</code> and simply <code>std::cin&gt;&gt;temp_person</code>, another - which I used to favour is to use <code>sscanf(\"%...\", &amp;...)</code> a bunch of temporary primitive types and simply <code>.emplace_back(Person(temp_primitives...)</code>.  </p>\n\n<p>Which way achieves the quickest runtime ignoring memory footprint? Is there any point in <code>mmap()</code>ing the entire file? </p>\n"}, {"tags": ["c++", "arrays", "multidimensional-array", "variable-length-array", "lcs"], "comments": [{"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 0, "creation_date": 1533765886, "post_id": 51756152, "comment_id": 90472104, "body": "If your problem specifies maximum limits for the size of the input, just make the arrays constant size. You have to be careful not to make large arrays on the stack though. You can also use <code>std::vector</code>, which would be the best in terms of good practice."}, {"owner": {"reputation": 7, "user_id": 9070326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94d45da929995873a2c12746bd2593fd?s=128&d=identicon&r=PG&f=1", "display_name": "drewalc", "link": "https://stackoverflow.com/users/9070326/drewalc"}, "reply_to_user": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 0, "creation_date": 1533765967, "post_id": 51756152, "comment_id": 90472133, "body": "That&#39;s what I started with for my own program I was mostly just wondering how the code above was even supposed to compile."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 3, "creation_date": 1533766099, "post_id": 51756152, "comment_id": 90472172, "body": "GCC extension - compile with <code>-pedantic</code>."}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1533769477, "post_id": 51756152, "comment_id": 90473036, "body": "Possible duplicate: <a href=\"https://stackoverflow.com/questions/19340544/gcc-allowing-arrays-to-be-initialized-with-variable-length\" title=\"gcc allowing arrays to be initialized with variable length\">stackoverflow.com/questions/19340544/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 5927645, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0tn1xLkspbs/AAAAAAAAAAI/AAAAAAAAATk/rAd0Puw1fCU/photo.jpg?sz=128", "display_name": "Vaisak Mohan", "link": "https://stackoverflow.com/users/5927645/vaisak-mohan"}, "edited": false, "score": 0, "creation_date": 1602446186, "post_id": 51756353, "comment_id": 113716322, "body": "&quot;...you&#39;ll probably end up with a stackoverflow...&quot; !  Yes, he will have to end up at stackoverflow to find further solutions."}], "tags": [], "owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "is_accepted": true, "score": 0, "last_activity_date": 1533766847, "last_edit_date": 1533766847, "creation_date": 1533766232, "answer_id": 51756353, "question_id": 51756152, "link": "https://stackoverflow.com/questions/51756152/creating-array-with-non-constant-sizes/51756353#51756353", "title": "Creating array with non constant sizes", "body": "<p>There is a non-standard extension in the GCC compiler which most people use that allows variable length arrays. You really shouldn't use it though, because VLAs have <a href=\"https://stackoverflow.com/q/1887097/9254539\">a lot of downsides</a>, which is why they aren't in the C++ standard in the first place. Also, you will probably end up with a stack overflow when your program receives a large input due to attempting to create a big array on the stack.</p>\n\n<p>Make your arrays constant size or use <code>std::vector</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 678, "user_id": 9255087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6ca68d0c24bb5002be694945e5a3d1f?s=128&d=identicon&r=PG&f=1", "display_name": "Dames", "link": "https://stackoverflow.com/users/9255087/dames"}, "is_accepted": false, "score": 0, "last_activity_date": 1533767069, "creation_date": 1533767069, "answer_id": 51756496, "question_id": 51756152, "link": "https://stackoverflow.com/questions/51756152/creating-array-with-non-constant-sizes/51756496#51756496", "title": "Creating array with non constant sizes", "body": "<p>adding <code>#include &lt;cstring&gt;</code> (for <code>strlen()</code>)\nmakes me able to compile it: <a href=\"http://cpp.sh/3gwwd\" rel=\"nofollow noreferrer\">http://cpp.sh/3gwwd</a>\nand outputs</p>\n\n<pre><code>LCS of ABCBDAB and BDCABA is \nBDAB\n</code></pre>\n\n<p>which is correct isn't it? (I do not know about LCS) [<a href=\"http://lcs-demo.sourceforge.net/]\" rel=\"nofollow noreferrer\">http://lcs-demo.sourceforge.net/]</a></p>\n\n<p>When performance is not absolute priority you could consider using <code>std::vector&lt;char&gt;</code> which comes with a lot less hurdles (also you included the vector class but didn't use it?)</p>\n"}], "owner": {"reputation": 7, "user_id": 9070326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94d45da929995873a2c12746bd2593fd?s=128&d=identicon&r=PG&f=1", "display_name": "drewalc", "link": "https://stackoverflow.com/users/9070326/drewalc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 713, "favorite_count": 0, "accepted_answer_id": 51756353, "answer_count": 2, "score": -5, "last_activity_date": 1533770482, "creation_date": 1533765064, "last_edit_date": 1533770482, "question_id": 51756152, "link": "https://stackoverflow.com/questions/51756152/creating-array-with-non-constant-sizes", "title": "Creating array with non constant sizes", "body": "<p>I'm currently working on an assignment where I must find a way to output the longest common subsequence of two strings. In all of the other places I have found implementations of this code, they all share one similarity: multiple arrays are initialized with non-constant variables which I had always learned was not allowed. When I tried to compile the program, I got an error because of this. How is code like this even supposed to compile in the first place?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\n//Prints the Longest common subsequence\nvoid printLCS(char *s1, char *s2, int m, int n);\n/* Driver program to test above function */\nint main()\n{\nchar s1[] = \"ABCBDAB\";\nchar s2[] = \"BDCABA\";\nprintLCS(s1, s2, strlen(s1), strlen(s2));\nreturn 0;\n}\n\nvoid printLCS(char *s1, char *s2, const int m, const int n)\n{\nint L[m + 1][n + 1];\n\n//Building L[m][n] as in algorithm\nfor (int i = 0; i &lt;= m; i++)\n{\n    for (int j = 0; j &lt;= n; j++)\n    {\n        if (i == 0 || j == 0)\n            L[i][j] = 0;\n        else if (s1[i - 1] == s2[j - 1])\n            L[i][j] = L[i - 1][j - 1] + 1;\n        else\n            L[i][j] = max(L[i - 1][j], L[i][j - 1]);\n    }\n}\n\n//To print LCS\nint index = L[m][n];\n//charcater array to store LCS\nchar LCS[index + 1];\nLCS[index] = '\\0'; // Set the terminating character\n\n                   //Stroing characters in LCS\n                   //Start from the right bottom corner character\nint i = m, j = n;\nwhile (i &gt; 0 &amp;&amp; j &gt; 0)\n{\n    //if current character in s1 and s2 are same, then include this character in LCS[]\n    if (s1[i - 1] == s2[j - 1])\n    {\n        LCS[index - 1] = s1[i - 1]; // Put current character in result\n        i--; j--; index--;     // reduce values of i, j and index\n\n    }\n    // compare values of L[i-1][j] and L[i][j-1] and go in direction of greater value.\n    else if (L[i - 1][j] &gt; L[i][j - 1])\n        i--;\n    else\n        j--;\n}\n\n// Print the LCS\ncout &lt;&lt; \"LCS of \" &lt;&lt; s1 &lt;&lt; \" and \" &lt;&lt; s2 &lt;&lt; \" is \" &lt;&lt; endl &lt;&lt; LCS &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Specifically the declarations for array <code>L</code> and array <code>LCS</code>.</p>\n\n<p>Sorry if this code is a mess I don't really post here.  Any help would be greatly appreciated.</p>\n"}, {"tags": ["c++", "multithreading", "c++11", "locking", "mutex"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1533765028, "post_id": 51756116, "comment_id": 90471817, "body": "We would have to see what <code>moveFile()</code> does to let you know if it would be safe or not."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1533765054, "post_id": 51756116, "comment_id": 90471823, "body": "Nope, if you have multiple threads reading and writing the same resource, it doesn&#39;t matter whether or not that resource is a class - you will need a lock of some kind. Also, <code>std::thread fileProc[threadSize];</code> is not valid C++."}, {"owner": {"reputation": 11, "user_id": 10095210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lcLxD.jpg?s=128&g=1", "display_name": "Schyzos", "link": "https://stackoverflow.com/users/10095210/schyzos"}, "edited": false, "score": 0, "creation_date": 1533765292, "post_id": 51756116, "comment_id": 90471904, "body": "@Neil Butterworth it that case do I have any other option to process files parallely ?"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1533765339, "post_id": 51756116, "comment_id": 90471914, "body": "If all what <code>fileOperator</code> does is a synchronized call to <code>moveFile</code>, then there will not be much parallelism in your program. Look inside <code>moveFile</code> to see where the actual shared resource is accessed, and guard these accesses."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1533765398, "post_id": 51756116, "comment_id": 90471946, "body": "You may not need a mutex at all, but it&#39;s not posible to tell from the code you have posted."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533766976, "post_id": 51756116, "comment_id": 90472431, "body": "<i>&quot;To avoid conflict...&quot;</i> conflict with <i>what</i>? If the names of the files are unique, and distributed to distinctly unique threads (no file name is drafted by more than one thread), where would you expect a conflict to be encountered?"}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1533780506, "post_id": 51756116, "comment_id": 90475187, "body": "Re, &quot;my goal is to move all those files in parallel.&quot; If those files are all on the same drive, then all of the reads and writes that accomplish the moves will have to go through the same, single hardware interface. You won&#39;t get any speedup, if that&#39;s what you were expecting, by having those commands issued by multiple threads."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10095210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lcLxD.jpg?s=128&g=1", "display_name": "Schyzos", "link": "https://stackoverflow.com/users/10095210/schyzos"}, "edited": false, "score": 0, "creation_date": 1533826383, "post_id": 51760809, "comment_id": 90498855, "body": "Unfortunately, I don&#39;t have access to the content of the moveFile. I will post if I can get a hand on it."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1533881521, "post_id": 51760809, "comment_id": 90517698, "body": "This is the same code as in question and you don&#39;t provide any answer here. You should have just left a comment if you wanted to ask the content of <code>moveFile</code>."}], "tags": [], "owner": {"reputation": 1876, "user_id": 1118878, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/XumqG.jpg?s=128&g=1", "display_name": "drodil", "link": "https://stackoverflow.com/users/1118878/drodil"}, "is_accepted": false, "score": 0, "last_activity_date": 1533798588, "creation_date": 1533798588, "answer_id": 51760809, "question_id": 51756116, "link": "https://stackoverflow.com/questions/51756116/can-i-avoid-using-mutex-lock-by-implementing-function-as-a-class-object-method/51760809#51760809", "title": "Can I avoid using mutex lock by implementing function as a class object method", "body": "<p>Not really sure what the problem here is, most probably it's located in the moveFile function but something like this should work:</p>\n\n<pre><code>#include &lt;future&gt;\n#include &lt;iostream&gt;\n#include &lt;mutex&gt;\n#include &lt;thread&gt;\n#include &lt;vector&gt;\n\nstd::mutex mtx;\n\nenum class status { SUCCESS, FAILED };\n\nstatus moveFile() {\n    std::cout &lt;&lt; \"Moving file\" &lt;&lt; std::endl;\n    return status::SUCCESS;\n}\n\nvoid fileOperator() {\n    std::lock_guard&lt;std::mutex&gt; lock(mtx);\n    moveFile();\n}\n\nint main(int argc, char** argv) {\n    std::vector&lt;std::thread&gt; threads;\n    int threadSize = 3;\n\n    for (int index = 0; index &lt; threadSize; ++index) {\n        threads.push_back(std::thread(&amp;fileOperator));\n    }\n\n    for (auto&amp; th : threads) {\n        th.join();\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Could you also please post the contents of the moveFile to be able to help you with that? Thanks.</p>\n"}], "owner": {"reputation": 11, "user_id": 10095210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lcLxD.jpg?s=128&g=1", "display_name": "Schyzos", "link": "https://stackoverflow.com/users/10095210/schyzos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533881403, "creation_date": 1533764901, "last_edit_date": 1533881403, "question_id": 51756116, "link": "https://stackoverflow.com/questions/51756116/can-i-avoid-using-mutex-lock-by-implementing-function-as-a-class-object-method", "title": "Can I avoid using mutex lock by implementing function as a class object method", "body": "<p><strong>Background:</strong> I have a list of files in a location and <code>moveFile()</code> function that will be used to move these files. my goal is to move all those files in parallel. So, I implemented multiple threads. </p>\n\n<p>To avoid conflict initially I considered mutex lock before <code>moveFile()</code>. That will prevent threads to run in parallel.</p>\n\n<p>Here's how it's been implemented:</p>\n\n<pre><code>std::mutex mtx;\nenum class status\n{ SUCCESS, FAILED };\n\nstatus moveFile()\n{   //function implementation }\n\nvoid fileOperator()\n{   // This is prevent parallel operation \n    mtx.lock;\n      moveFile();\n    mtx.unlock;\n} \n\nint main ()\n{\n  int threadSize= 3; //generic size\n  std::thread fileProc[threadSize];\n  int index = 0;\n\n  // staring new threads\n  for (index; index &lt; threadSize; index++)\n  {\n    fileProc[index] = std::thread (&amp;fileOperator);\n  }\n\n  //joining all the threads\n  for (int i=0; i &lt;threadSize; i++)\n  {\n    fileProc[i].join();\n  }\n  return 0;\n}\n</code></pre>\n\n<p><strong>Suggestion:</strong> I was wondering, if I remove mutex lock implement the <code>moveFile()</code> as in a class and call it as an object method, will it be a better way to implement parallel operation?</p>\n"}, {"tags": ["c++", "c++11", "c++14", "variadic-functions"], "comments": [{"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 1, "creation_date": 1533762668, "post_id": 51755658, "comment_id": 90471021, "body": "Please show us what you have tried.  It might also not be a bad idea to explain a possible use-case."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533764327, "post_id": 51755658, "comment_id": 90471561, "body": "you know that a <code>f(int,char)</code> can be called as <code>f(2,2)</code> without error and are seeking for a way to make it an error or is it sufficient to get the signature right?"}, {"owner": {"reputation": 1663, "user_id": 916672, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/56c85230b3c9262e003bade8156e48be?s=128&d=identicon&r=PG", "display_name": "Kevin Meier", "link": "https://stackoverflow.com/users/916672/kevin-meier"}, "edited": false, "score": 2, "creation_date": 1533764411, "post_id": 51755658, "comment_id": 90471599, "body": "Actually, there is no use-case for this. I just wanted to know if it is possible;-) Thanks for the hint with the auto-casting; I do not care about the used types in the signature, but more about how to create this pattern."}], "answers": [{"comments": [{"owner": {"reputation": 13842, "user_id": 759253, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0136e90dfd678a82c1dbba77dcbfc28e?s=128&d=identicon&r=PG", "display_name": "Igor R.", "link": "https://stackoverflow.com/users/759253/igor-r"}, "edited": false, "score": 1, "creation_date": 1533763764, "post_id": 51755812, "comment_id": 90471386, "body": "Awesome! Very laconic and elegant."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533763897, "post_id": 51755812, "comment_id": 90471428, "body": "but isnt <code>2</code> a valid <code>char</code> and <code>f(int,char)</code> can be called without error as <code>f(2,2)</code> ? (I am refering to &quot;it does not compile with other parameter patterns (e.g. <code>f(2, 2)</code> is an error, but <code>f(2, &#39;2&#39;)</code> is ok).&quot;)"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533764171, "post_id": 51755812, "comment_id": 90471508, "body": "@user463035818 valid concern, but probably best addressed at OP. I wonder about that too."}, {"owner": {"reputation": 13842, "user_id": 759253, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0136e90dfd678a82c1dbba77dcbfc28e?s=128&d=identicon&r=PG", "display_name": "Igor R.", "link": "https://stackoverflow.com/users/759253/igor-r"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533764171, "post_id": 51755812, "comment_id": 90471510, "body": "@user463035818 Try <code>static_assert(std::is_same_v&lt;decltype(2), char&gt;);</code>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 13842, "user_id": 759253, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0136e90dfd678a82c1dbba77dcbfc28e?s=128&d=identicon&r=PG", "display_name": "Igor R.", "link": "https://stackoverflow.com/users/759253/igor-r"}, "edited": false, "score": 0, "creation_date": 1533764240, "post_id": 51755812, "comment_id": 90471534, "body": "@IgorR. I know that <code>2</code> is not a <code>char</code>, I just wonder how to fullfill the requirement stated by OP"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533764593, "post_id": 51755812, "comment_id": 90471665, "body": "@user463035818 I got it: it&#39;s pure template deduction, then the types are matched exactly in the SFINAE test. No implicit conversions are considered."}, {"owner": {"reputation": 13842, "user_id": 759253, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0136e90dfd678a82c1dbba77dcbfc28e?s=128&d=identicon&r=PG", "display_name": "Igor R.", "link": "https://stackoverflow.com/users/759253/igor-r"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533764853, "post_id": 51755812, "comment_id": 90471765, "body": "@user463035818 Take a look at the following: <a href=\"https://wandbox.org/permlink/Pyrn50SLSrG0X6qj\" rel=\"nofollow noreferrer\">wandbox.org/permlink/Pyrn50SLSrG0X6qj</a>"}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 10, "last_activity_date": 1533763890, "last_edit_date": 1533763890, "creation_date": 1533763329, "answer_id": 51755812, "question_id": 51755658, "link": "https://stackoverflow.com/questions/51755658/c-hacky-parameter-pattern-with-variadic-arguments/51755812#51755812", "title": "C++: Hacky parameter pattern with variadic arguments", "body": "<p>Assuming:</p>\n\n<pre><code>constexpr bool is_prime(size_t);\n</code></pre>\n\n<p>Then something like this:</p>\n\n<pre><code>template &lt;typename... Ts&gt; struct typelist;\n\ntemplate &lt;size_t... Is&gt;\nconstexpr auto expected(std::index_sequence&lt;Is...&gt;)\n    -&gt; typelist&lt;std::conditional_t&lt;is_prime(Is+1), char, int&gt;...&gt;;\n\ntemplate &lt;typename... Ts,\n    std::enable_if_t&lt;std::is_same&lt;\n        typelist&lt;Ts...&gt;,\n        decltype(expected(std::index_sequence_for&lt;Ts...&gt;{}))\n        &gt;::value, int&gt; = 0&gt;\nauto f(Ts... ts);\n</code></pre>\n"}], "owner": {"reputation": 1663, "user_id": 916672, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/56c85230b3c9262e003bade8156e48be?s=128&d=identicon&r=PG", "display_name": "Kevin Meier", "link": "https://stackoverflow.com/users/916672/kevin-meier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 4, "accepted_answer_id": 51755812, "answer_count": 1, "score": 4, "last_activity_date": 1533763890, "creation_date": 1533762426, "last_edit_date": 1533763335, "question_id": 51755658, "link": "https://stackoverflow.com/questions/51755658/c-hacky-parameter-pattern-with-variadic-arguments", "title": "C++: Hacky parameter pattern with variadic arguments", "body": "<p>Is it possible to use C++ variadic arguments to define a function that allows exactly the following calls:</p>\n\n<pre><code>f(int, char)\nf(int, char, char)\nf(int, char, char, int)\nf(int, char, char, int, char)\n...\n</code></pre>\n\n<p>Where every nth argument is a <code>char</code> if n is a prime number, and otherwise it is an <code>int</code>. The function can only be called in this way; it does not compile with other parameter patterns (e.g. <code>f(2, 2)</code> is an error, but <code>f(2, '2')</code> is ok).</p>\n"}, {"tags": ["c++", "templates", "return-type", "stdmap"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1533762055, "post_id": 51755569, "comment_id": 90470821, "body": "Just like you have <code>std::map &lt;std::string, Movie&gt;</code> when you declare <code>movie_archive</code> you have to use the same thing as the return type, or just use <code>auto</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1533762079, "post_id": 51755569, "comment_id": 90470827, "body": "map is a template - you want <code>std::map &lt;std::string,Movie&gt; getMovieArchive();</code> and similar elsewhere."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1533764778, "post_id": 51755602, "comment_id": 90471744, "body": "You might also consider using a <code>typedef</code>/<code>using</code> statement to simplify the declarations, eg: <code>typedef std::map&lt;std::string, Movie&gt; MovieMap;</code> or <code>using MovieMap = std::map&lt;std::string, Movie&gt;;</code>, and then you can do this: <code>MovieMap movie_archive; ... const MovieMap&amp; getMovieArchive()</code>. Or, just use <code>auto</code> instead: <code>const auto&amp; getMovieArchive() { return movie_archive; }</code>  Either way, you should also consider declaring <code>getMovieArchive()</code> itself as <code>const</code> as well"}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 4, "last_activity_date": 1533764691, "last_edit_date": 1533764691, "creation_date": 1533762127, "answer_id": 51755602, "question_id": 51755569, "link": "https://stackoverflow.com/questions/51755569/return-stdmap-with-a-getter-method/51755602#51755602", "title": "return std::map with a getter method", "body": "<p>You probably mean</p>\n\n<pre><code>class MovieArchive {\nprivate:\n  std::map &lt;std::string, Movie&gt; movie_archive;\n\npublic:\n  std::map&lt;std::string, Movie&gt; getMovieArchive();\n};\n</code></pre>\n\n<p>i.e., you have to provide the template parameters in the return type of the getter as well.</p>\n\n<p>BTW: you probably want to write </p>\n\n<pre><code>class MovieArchive {\nprivate:\n  std::map &lt;std::string, Movie&gt; movie_archive;\n\npublic:\n  const std::map&lt;std::string, Movie&gt; &amp; getMovieArchive();\n};\n</code></pre>\n\n<p>i.e. returning a const reference instead of a copy of the internal data structure.</p>\n"}], "owner": {"reputation": 13, "user_id": 9025159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/796d49724b1f81442aac429d554cd0f6?s=128&d=identicon&r=PG", "display_name": "Alle", "link": "https://stackoverflow.com/users/9025159/alle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "closed_date": 1533764636, "accepted_answer_id": 51755602, "answer_count": 1, "score": -2, "last_activity_date": 1533764691, "creation_date": 1533761941, "question_id": 51755569, "link": "https://stackoverflow.com/questions/51755569/return-stdmap-with-a-getter-method", "closed_reason": "Not suitable for this site", "title": "return std::map with a getter method", "body": "<p>As the title indicates I'm trying to grab on to a std::map container and return it.</p>\n\n<p>I get the following error: invalid use of template-name 'std::map' without an argument list</p>\n\n<p>Now I pretty sure the reason has to do with templates, but simply haven't found an example that describes my specific situation.</p>\n\n<p>My program i rather simple since I'm a newbie on parantal leave. It consists of these files:</p>\n\n<ul>\n<li>main.cpp</li>\n<li>Movie_Archive.hpp</li>\n<li>Movie_Archive.cpp</li>\n<li>Movie.hpp</li>\n<li>Movie.cpp</li>\n<li>Helper.hpp</li>\n<li>Helper.cpp</li>\n</ul>\n\n<p>I don't think anyone wants me to paste all the code so I've pasted the parts that I belive to be vital to my question. Code below:</p>\n\n<p>Movie_Archive.hpp</p>\n\n<pre><code>class MovieArchive {\nprivate:\nstd::map &lt;std::string, Movie&gt; movie_archive;\n\npublic:\nstd::map getMovieArchive();\n};\n</code></pre>\n\n<p>Movie_Archive.cpp</p>\n\n<pre><code>std::map MovieArchive::getMovieArchive() {\n    return movie_archive;\n}\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>TheMovieArchive.controlArchiveStatus(TheMovieArchive.getMovieArchive(), TheMovieArchive.getTitle());\n</code></pre>\n\n<p>// Checks if the movie title already has been entered</p>\n\n<p>Thank soo much for taking a look. I hope someone can find a solution.</p>\n\n<p>Kind regards//Alle</p>\n"}, {"tags": ["php", "c++"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1533763805, "post_id": 51755493, "comment_id": 90471399, "body": "What is <code>$this-&gt;Crypto()</code>? Is the C++ code decrypting it before trying to parse the JSON?"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1533803905, "post_id": 51755493, "comment_id": 90483631, "body": "Your image of text <a href=\"//meta.unix.stackexchange.com/q/4086\">isn&#39;t very helpful</a>.  It can&#39;t be read aloud or copied into an editor, and it doesn&#39;t index very well, meaning that other users with the same problem are less likely to find the answer here.  Please <a href=\"https://stackoverflow.com/posts/51755493/edit\">edit</a> your post to incorporate the relevant text directly (preferably using copy+paste to avoid transcription errors)."}], "owner": {"reputation": 11, "user_id": 8850286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5be554adb185c018b39ffe87775301?s=128&d=identicon&r=PG&f=1", "display_name": "sleep", "link": "https://stackoverflow.com/users/8850286/sleep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533763608, "creation_date": 1533761620, "last_edit_date": 1533763608, "question_id": 51755493, "link": "https://stackoverflow.com/questions/51755493/checking-response-from-php-script-c", "title": "checking response from php script C++", "body": "<p>im trying to get the salt from a table in my database and return the value to my C++ application so i can encrypt the users password and match vs database. im running into some trouble</p>\n\n<pre><code>$state = $this-&gt;con-&gt;prepare(\"SELECT salt FROM Login WHERE user = ?\");\n$state-&gt;bind_param(\"s\", $this-&gt;SanatizeString($this-&gt;GetValue('salt')));\n$state-&gt;execute();\n$result = $state-&gt;get_result();\n$row = $result-&gt;fetch_assoc();\n\n$salt = $row['salt'];\n\necho $this-&gt;Crypto(json_encode(array(\"response\" =&gt; $salt), false);\n</code></pre>\n\n<p>this is what im doing in the script to return the salt.\nand in the application im doing</p>\n\n<pre><code>salt = result[\"response\"].get&lt;std::string&gt;().c_str();\n</code></pre>\n\n<p>but json is giving me a weird error</p>\n\n<p><a href=\"https://i.stack.imgur.com/2TM9i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2TM9i.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1533761221, "post_id": 51755360, "comment_id": 90470450, "body": "Make test.h be test.cpp and link main.cpp with it. Also, main() returns an int, not void."}, {"owner": {"reputation": 1476, "user_id": 9309959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8b6ed5480d92d983b0e87bc4af448?s=128&d=identicon&r=PG", "display_name": "Krystian S", "link": "https://stackoverflow.com/users/9309959/krystian-s"}, "reply_to_user": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1533761268, "post_id": 51755360, "comment_id": 90470474, "body": "@Stephan Lechner my bad about that, just wrote it incorrectly, in the actual code they are the same"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1533761300, "post_id": 51755360, "comment_id": 90470488, "body": "<code>main</code> must return <code>int</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1533761336, "post_id": 51755360, "comment_id": 90470504, "body": "What&#39;s the error message?"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1533761414, "post_id": 51755360, "comment_id": 90470535, "body": "Look at <a href=\"https://stackoverflow.com/a/10422050/10077\">a good example of using <code>extern</code></a>."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1533761447, "post_id": 51755360, "comment_id": 90470554, "body": "Does your cpp file include the header file?"}], "answers": [{"tags": [], "owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "is_accepted": false, "score": 2, "last_activity_date": 1533761530, "creation_date": 1533761530, "answer_id": 51755478, "question_id": 51755360, "link": "https://stackoverflow.com/questions/51755360/no-clue-why-extern-is-not-working/51755478#51755478", "title": "No clue why extern is not working", "body": "<p>Header files are not typically translation units.</p>\n\n<p>Put the definition in a <code>Test.cpp</code> file.</p>\n\n<pre><code>int externalInteger = 10;\n</code></pre>\n\n<p>Put your main function in <code>Main.cpp</code> file.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main()\n{\n  extern int externalInteger;\n  std::cout &lt;&lt; externalInteger &lt;&lt; std::endl;\n  std::cin.ignore();\n}\n</code></pre>\n\n<p>Compile and link.</p>\n\n<pre><code>g++ -c Test.cpp\ng++ -c Main.cpp\ng++ Main.o Test.o\n</code></pre>\n\n<p>For MS, use <code>cl.exe</code> as the compiler instead of <code>g++</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 6, "last_activity_date": 1533761701, "creation_date": 1533761701, "answer_id": 51755512, "question_id": 51755360, "link": "https://stackoverflow.com/questions/51755360/no-clue-why-extern-is-not-working/51755512#51755512", "title": "No clue why extern is not working", "body": "<p>Header files are usually not translation units but meant to be included by them. That's why header files usually do not \"define\" variables, since this would lead to multiple definition errors when the header file is included by different translation units (thereby re-defining the variable again and again).</p>\n\n<p>That's where \"extern\" comes into place, since this is for just \"declaring\" a variable without \"defining\" it. \"extern\" means \"will be defined in some other translation unit\".</p>\n\n<p>So the usual way is:</p>\n\n<pre><code>// Test.h\nextern int externalint;  // just declares externalint\n\n// Test.cpp\nint externalint = 10;  // defines externalint\n\n// main.cpp\n#include \"Test.h\"  // importing the declaration of \"externalint\" defined elsewhere\nint main() {\n  std::cout &lt;&lt; externalint &lt;&lt; std::endl;  \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 7906145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/555c033cba1f4160bad70f8e19c47c90?s=128&d=identicon&r=PG&f=1", "display_name": "Volt", "link": "https://stackoverflow.com/users/7906145/volt"}, "is_accepted": false, "score": 0, "last_activity_date": 1533762939, "creation_date": 1533762939, "answer_id": 51755746, "question_id": 51755360, "link": "https://stackoverflow.com/questions/51755360/no-clue-why-extern-is-not-working/51755746#51755746", "title": "No clue why extern is not working", "body": "<p>First ask yourself why would you use such a thing as extern. And then you will understand how to use it.\nImagine you would like a piece of code to be called in different programs.\nOnce from console application and once from an external program.</p>\n\n<p>So you will write Test.cpp.</p>\n\n<p>Now you can use it at console app using main() function and once you build it together with the external program you can use it there too.</p>\n\n<p>Both will use the externalint value of 10 and as long as you update this Test library in both projects like through git. You would have the identical behaviour in both the console application and the external program.</p>\n\n<p>Where is the Test.h you ask? \nThere you go:</p>\n\n<p>The Test.cpp will be compiled separately from your Main.cpp but you would like to use the variables and functions from your Test.cpp. How does the compiler know what functions are there?</p>\n\n<p>You will let him know.\nYou simply create an interface -> Test.h.\nAnd then you will include it in your Main.cpp</p>\n\n<pre><code>#include \"Test.h\"\n</code></pre>\n\n<p>Example of interface:</p>\n\n<pre><code>//Test.h\nint externalint = 10;\n</code></pre>\n\n<p>But, what if you have more .cpp files interested in this interface?\nThen it will be duplicate and it will not compile. Because you cannot initialize the same variable twice.</p>\n\n<p>Luckily you can declare it and announce that the initialization will be done in one of the .cpp files.</p>\n\n<pre><code>// Test.h\nextern int externint;\n// Test.cpp\nint externint = 10;\n</code></pre>\n"}], "owner": {"reputation": 1476, "user_id": 9309959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8b6ed5480d92d983b0e87bc4af448?s=128&d=identicon&r=PG", "display_name": "Krystian S", "link": "https://stackoverflow.com/users/9309959/krystian-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 51755512, "answer_count": 3, "score": -7, "last_activity_date": 1533762939, "creation_date": 1533761042, "last_edit_date": 1533761376, "question_id": 51755360, "link": "https://stackoverflow.com/questions/51755360/no-clue-why-extern-is-not-working", "title": "No clue why extern is not working", "body": "<p>I'm just testing out how extern works (using MSVC) and I cannot get it to work, no matter what I do:</p>\n\n<pre><code>// Test.h\nint externalint = 10\n\n// Main.cpp\nvoid main()\n{\n  extern int externalint;\n  std::cout &lt;&lt; externalint &lt;&lt; std::endl;\n  std::cin.ignore();\n}\n</code></pre>\n\n<p>This results in a linking error, even though I defined it in the header. I do not wish to include the header because the way I read it says it can be in another translation unit and does not need to be included. Am I wrong with the way I am reading it or did I write something incorrectly? If I include the header, it works, as it should, even without the extern declaration.</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1533762453, "post_id": 51755340, "comment_id": 90470940, "body": "The answer really depends what you need that type for.  Types are generally resolved statically at compile time, so for most purposes you&#39;ll need to provide virtual member functions that act on appropriate base classes rather than determining the exact type of the object pointed to."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 8007684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab3adb7e551aee3746dc5489d20c8c3?s=128&d=identicon&r=PG&f=1", "display_name": "inspire", "link": "https://stackoverflow.com/users/8007684/inspire"}, "edited": false, "score": 0, "creation_date": 1533904476, "post_id": 51755601, "comment_id": 90530361, "body": "thanks, that works perfectly! But now I try to instantiate an object of this type which is not possible by using a <code>std::type_info</code> I think. Can I somehow directly get the type T for something like <code>decltype(myMap[&quot;test1&quot;]-&gt;myType()) myNewObjectOfTypeT;</code>?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 99, "user_id": 8007684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab3adb7e551aee3746dc5489d20c8c3?s=128&d=identicon&r=PG&f=1", "display_name": "inspire", "link": "https://stackoverflow.com/users/8007684/inspire"}, "edited": false, "score": 1, "creation_date": 1533914352, "post_id": 51755601, "comment_id": 90536432, "body": "@inspire, that&#39;s not possible from my solution. That is a different requirement. You should look up the Factory Pattern and the Builder Pattern. That might give you some ideas."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 2, "last_activity_date": 1533763207, "last_edit_date": 1533763207, "creation_date": 1533762119, "answer_id": 51755601, "question_id": 51755340, "link": "https://stackoverflow.com/questions/51755340/get-template-parameter-type-of-derived-class-in-map-that-doesnt-know-about-temp/51755601#51755601", "title": "Get template parameter type of derived class in map that doesn&#39;t know about template parameters", "body": "<blockquote>\n  <p>Do you have hints to resolve this problem?</p>\n</blockquote>\n\n<p>type names don't work like <code>virtual</code> member functions. What you need is a <code>virtual</code> member function.</p>\n\n<p>Here's a demonstrative program:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;map&gt;\n#include &lt;typeinfo&gt;\n\nclass Base {\npublic:\n    virtual std::type_info const&amp; myType() const { return typeid(char); }\n};\n\ntemplate &lt;typename T&gt;\nclass Derived : public Base {\npublic:\n    virtual std::type_info const&amp; myType() const { return typeid(T); }\n};\n\nint main() {\n    std::map&lt;std::string, Base*&gt; myMap;\n    myMap[\"test1\"] = new Derived&lt;int&gt;();\n    myMap[\"test2\"] = new Derived&lt;float&gt;();\n\n    std::cout &lt;&lt; myMap[\"test1\"]-&gt;myType().name() &lt;&lt; std::endl;\n    std::cout &lt;&lt; myMap[\"test2\"]-&gt;myType().name() &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Output with g++:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>i\nf\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 8007684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab3adb7e551aee3746dc5489d20c8c3?s=128&d=identicon&r=PG&f=1", "display_name": "inspire", "link": "https://stackoverflow.com/users/8007684/inspire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 51755601, "answer_count": 1, "score": 0, "last_activity_date": 1533763207, "creation_date": 1533760953, "question_id": 51755340, "link": "https://stackoverflow.com/questions/51755340/get-template-parameter-type-of-derived-class-in-map-that-doesnt-know-about-temp", "title": "Get template parameter type of derived class in map that doesn&#39;t know about template parameters", "body": "<p>I am trying to get the template parameter type in this scenario:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;map&gt;\n#include &lt;typeinfo&gt;\n\nclass Base {\npublic:\n    typedef char myType;\n};\n\ntemplate &lt;typename T&gt;\nclass Derived : public Base {\npublic:\n    typedef T myType;\n};\n\nint main() {\n    std::map&lt;std::string, Base*&gt; myMap;\n    myMap[\"test1\"] = new Derived&lt;int&gt;();\n    myMap[\"test2\"] = new Derived&lt;float&gt;();\n\n    std::cout &lt;&lt; typeid(myMap[\"test1\"]).name() &lt;&lt; std::endl; // prints Base\n    std::cout &lt;&lt; typeid(myMap[\"test2\"]).name() &lt;&lt; std::endl; // prints Base\n\n    //myMap[\"test1\"]-&gt;myType test; // invalid use of 'Base::myType'\n\n    std::cout &lt;&lt; typeid(dynamic_cast&lt;Derived*&gt;(myMap[\"test1\"])-&gt;myType).name() &lt;&lt; std::endl; // invalid use of template-name 'Derived' without an argument list. Should print \"int\" ...\n    std::cout &lt;&lt; typeid(dynamic_cast&lt;Derived*&gt;(myMap[\"test2\"])-&gt;myType).name() &lt;&lt; std::endl; // invalid use of template-name 'Derived' without an argument list. Should print \"float\" ...\n}\n</code></pre>\n\n<p>The map holds elements of type Base and thus, also of type Derived with a template parameter. However on retrieving elements from the map I am not able to get the template parameter type back again. I tried to add a typedef to both classes but it doesn't work. </p>\n\n<p>Do you have hints to resolve this problem?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c++", "multithreading", "chrono"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1533761111, "post_id": 51755266, "comment_id": 90470387, "body": "This looks like a bug.  On 4.9 or newer it does not hang."}, {"owner": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "edited": false, "score": 0, "creation_date": 1533762736, "post_id": 51755266, "comment_id": 90471045, "body": "My answer was wrong, so I deleted it. The wording in the standard doesn&#39;t really specify, as far as I can parse it, what happens when the time_point passed is in the past. It still looks like a bug, though."}, {"owner": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "edited": false, "score": 0, "creation_date": 1533762880, "post_id": 51755266, "comment_id": 90471095, "body": "It does specify, however, that if the clock is adjusted to after said time_point, it should wake as soon as possible. This is what I (wrongly) quoted in my answer."}, {"owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "reply_to_user": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "edited": false, "score": 0, "creation_date": 1533763042, "post_id": 51755266, "comment_id": 90471142, "body": "@C&#225;ssioRenan:  I&#39;m the one that upvoted your answer before you deleted it, and I&#39;m also the one who led the standardization process on <code>&lt;chrono&gt;</code> and the <code>_until</code> functions.  If the spec doesn&#39;t say this is a bug, then there&#39;s also a bug in the spec.  If you have suggestions on how to improve the spec, <a href=\"http://cplusplus.github.io/LWG/lwg-active.html#submit_issue\" rel=\"nofollow noreferrer\">here is how to go about that</a>."}, {"owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "reply_to_user": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "edited": false, "score": 0, "creation_date": 1533763380, "post_id": 51755266, "comment_id": 90471247, "body": "@C&#225;ssioRenan: If you like, I can vote to undelete your answer (so you don&#39;t have to re-type it if you are so inclined)."}, {"owner": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "reply_to_user": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "edited": false, "score": 0, "creation_date": 1533763851, "post_id": 51755266, "comment_id": 90471413, "body": "@HowardHinnant thanks for your comments! I&#39;m not really sure where to start on suggesting improvements, since I&#39;m not sure I got everything right. About the answer: I could undelete it, since I deleted it myself, but it&#39;s still wrong, because it doesn&#39;t answer the question. (The clock is never <i>adjusted during the timeout</i> in the question)."}, {"owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "edited": false, "score": 0, "creation_date": 1533764111, "post_id": 51755266, "comment_id": 90471485, "body": "If I were writing the answer, I would do what you did, except emphasize &quot;Given a clock time point argument Ct, the clock time point of the return from timeout should be Ct+Di+Dm when the clock is not adjusted during the timeout.&quot;.  Then note that this is true whether or not Ct is in the past or future, and the implementation <i>should</i> strive to minimize Di and Dm (which are both non-negative)."}, {"owner": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "reply_to_user": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "edited": false, "score": 1, "creation_date": 1557425781, "post_id": 51755266, "comment_id": 98770617, "body": "@HowardHinnant I know Stackoverflow is not really the place for &quot;Thanks&quot; and all of that, but I must say our small exchange here inspired me to study more, and I finally can read this section of the standard and understand it well enough to say I know what I&#39;m talking about, which I was not confortable with doing before. So, thanks a lot! (BTW, the bug is fixed on gcc: I&#39;ve updated the answer)."}], "answers": [{"tags": [], "owner": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "is_accepted": true, "score": 4, "last_activity_date": 1557426461, "last_edit_date": 1557426461, "creation_date": 1533761676, "answer_id": 51755506, "question_id": 51755266, "link": "https://stackoverflow.com/questions/51755266/sleep-until-a-timepoint-in-the-past/51755506#51755506", "title": "sleep_until a timepoint in the past", "body": "<p>Looks like a bug:</p>\n\n<blockquote>\n  <h3>30.2.4 Timing specifications [thread.req.timing]</h3>\n  \n  <p><a href=\"http://eel.is/c++draft/thread.req.timing#4\" rel=\"nofollow noreferrer\">4</a> &nbsp;\n  The functions whose names end in <code>_\u00aduntil</code> take an argument that specifies a time point.\n  These functions produce absolute timeouts.\n  Implementations should use the clock specified in the time point to measure time for these functions.\n  <strong>Given a clock time point argument C<sub>t</sub>, the clock time point of the return from timeout should be C<sub>t</sub>+D<sub>i</sub>+D<sub>m</sub> when the clock is not adjusted during the timeout.</strong>\n  (...)</p>\n</blockquote>\n\n<p>Where D<sub>i</sub> is defined as a \"quality of implementation\" delay, and D<sub>m</sub> is defined as a \"quality of management\" delay.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/51755266/sleep-until-a-timepoint-in-the-past/51755506#comment90471485_51755266\">As Howard Hinnant brilliantly emphasizes</a>, an implementation should strive to minimize D<sub>i</sub> and D<sub>m</sub>:</p>\n\n<blockquote>\n  <h3>30.2.4 Timing specifications [thread.req.timing]</h3>\n  \n  <p><a href=\"http://eel.is/c++draft/thread.req.timing#2\" rel=\"nofollow noreferrer\">2</a> &nbsp;\n  Implementations necessarily have some delay in returning from a timeout.\n  Any overhead in interrupt response, function return, and scheduling induces a \u201cquality of implementation\u201d delay, expressed as duration D<sub>i</sub>.\n  <strong>Ideally, this delay would be zero</strong>.\n  Further, any contention for processor and memory resources induces a \u201cquality of management\u201d delay, expressed as duration D<sub>m</sub>.\n  <strong>The delay durations may vary from timeout to timeout, but in all cases shorter is better.</strong></p>\n</blockquote>\n\n<p>Note that this must be true no matter what the value of C<sub>t</sub> is, and that an <strong>infinite</strong> delay is definitely not minimal.</p>\n\n<p>As a small update, <a href=\"http://coliru.stacked-crooked.com/a/6609fedbefc78776\" rel=\"nofollow noreferrer\">this is now fixed</a>, as of version 4.9.3. <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=58038\" rel=\"nofollow noreferrer\">Here is the information on the bug tracker.</a></p>\n"}], "owner": {"reputation": 478, "user_id": 1725816, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e46d33a24749378a59c25348e8bc435?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/1725816/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 823, "favorite_count": 0, "accepted_answer_id": 51755506, "answer_count": 1, "score": 3, "last_activity_date": 1557426461, "creation_date": 1533760595, "last_edit_date": 1533770799, "question_id": 51755266, "link": "https://stackoverflow.com/questions/51755266/sleep-until-a-timepoint-in-the-past", "title": "sleep_until a timepoint in the past", "body": "<p>I have what I thought was a simple pattern - I want to make a timepoint 5 seconds in the future, run a task which might take a while, and then sleep until that timepoint (potentially not sleeping at all if that time has already been reached.) However, whenever trying to use <code>std::this_thread::sleep_until</code> with a timepoint in the past, my application instead hangs forever. Here is an MCVE:</p>\n\n<pre><code>#include &lt;chrono&gt;\n#include &lt;thread&gt;\n\nint main(){\n  std::this_thread::sleep_until(std::chrono::steady_clock::now() - std::chrono::seconds(1));\n}\n</code></pre>\n\n<p>Using g++ (GCC) 4.8.5, this never returns. I've also tried system_clock with the same results. Using strace to examine what's happening, the last thing I get is:</p>\n\n<pre><code>nanosleep({4294967295, 0},\n</code></pre>\n\n<p>so I guess it would return eventually, but I don't feel like waiting that long.</p>\n\n<p>Is this a g++ bug? I can't imagine this behavior is intentional. I found the question <a href=\"https://stackoverflow.com/questions/39848236/is-behaviour-well-defined-when-sleep-until-specifies-a-time-point-in-the-pas\">Is behaviour well-defined when <code>sleep_until()</code> specifies a time point in the past?</a> but it doesn't seem that any conclusion was actually reached on whether or not the standard actually specifies what should happen. I've since implemented another solution to my problem; I'm just curious as to whether or not what I'm seeing is UB or a bug.</p>\n"}, {"tags": ["c++", "java-native-interface", "cygwin"], "comments": [{"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1533769897, "post_id": 51755226, "comment_id": 90473119, "body": "The 1st error looks simple.  What did you try (to fix that first error)?  i.e. can you clarify your problem ... (perhaps they are simple typo&#39;s)"}, {"owner": {"reputation": 6281, "user_id": 5105383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2YCB5.jpg?s=128&g=1", "display_name": "matzeri", "link": "https://stackoverflow.com/users/5105383/matzeri"}, "edited": false, "score": 0, "creation_date": 1533783956, "post_id": 51755226, "comment_id": 90475803, "body": "it seems you are using the compiler for cygwin, while you should use the cross compiler cygwin2windows <a href=\"https://sourceware.org/ml/cygwin-announce/2018-07/msg00010.html\" rel=\"nofollow noreferrer\">sourceware.org/ml/cygwin-announce/2018-07/msg00010.html</a>"}, {"owner": {"reputation": 91, "user_id": 3235815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0567230e828845712ce4bba3124c3399?s=128&d=identicon&r=PG&f=1", "display_name": "user3235815", "link": "https://stackoverflow.com/users/3235815/user3235815"}, "edited": false, "score": 0, "creation_date": 1533843331, "post_id": 51755226, "comment_id": 90507846, "body": "i compile my code with MinGW64 but dose not work."}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 3235815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0567230e828845712ce4bba3124c3399?s=128&d=identicon&r=PG&f=1", "display_name": "user3235815", "link": "https://stackoverflow.com/users/3235815/user3235815"}, "is_accepted": false, "score": 1, "last_activity_date": 1533848168, "creation_date": 1533848168, "answer_id": 51775636, "question_id": 51755226, "link": "https://stackoverflow.com/questions/51755226/c-compilation-error-with-netbean-and-cygwin/51775636#51775636", "title": "c++ compilation error with netbean and cygwin?", "body": "<p>i find the solution of my problem. because GCC doesn't have a __int64 built-in, and this patch basically uses \"long long\" instead we must edit edit the file /include/win32/jni_md.h, Where is the installation root (eg., c:/jdk1.4.2).\nreplace the code</p>\n\n<pre><code>typedef long jint;\ntypedef __int64 jlong;\ntypedef signed char jbyte;\n</code></pre>\n\n<p>with</p>\n\n<pre><code>typedef long jint;\n#ifdef __GNUC__\ntypedef long long jlong;\n#else\ntypedef __int64 jlong;\n#endif\ntypedef signed char jbyte;\n</code></pre>\n\n<p>useful source</p>\n\n<p><a href=\"https://gist.github.com/ssfang/e52c00cd446081cd72a982a2dd8634d4\" rel=\"nofollow noreferrer\">https://gist.github.com/ssfang/e52c00cd446081cd72a982a2dd8634d4</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/27891478/error-when-compiling-in-cygwin/27891654\">Error when compiling in cygwin</a></p>\n"}], "owner": {"reputation": 91, "user_id": 3235815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0567230e828845712ce4bba3124c3399?s=128&d=identicon&r=PG&f=1", "display_name": "user3235815", "link": "https://stackoverflow.com/users/3235815/user3235815"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533848168, "creation_date": 1533760413, "last_edit_date": 1533760535, "question_id": 51755226, "link": "https://stackoverflow.com/questions/51755226/c-compilation-error-with-netbean-and-cygwin", "title": "c++ compilation error with netbean and cygwin?", "body": "<p>my program code</p>\n\n<pre><code>#include \"HelloWorld.h\"\n#include &lt;stdio.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;signal.h&gt;\nusing namespace std;\nJNIEnv *cur_env; /* pointer to native method interface */\nvoid registerWndProc();\nJNIEXPORT void JNICALL Java_HelloWorld_print\n(JNIEnv *env, jobject){\ncur_env = env; /* Creates window &amp; enters message loop */\nregisterWndProc();\n}\nvoid calljvm() {\nJavaVM *jvm;\ncur_env-&gt;GetJavaVM(&amp;jvm);\njint AttachCurrentThread = (*jvm).AttachCurrentThread((void **)(&amp;cur_env),NULL);\njclass cls=cur_env-&gt;FindClass(\"helloworld/HelloWorld\");\njmethodID mid=cur_env-&gt;GetStaticMethodID(cls,\"callback\",\"()V\");      \n(*cur_env).CallStaticVoidMethod(cls, mid);\n(*jvm).DetachCurrentThread();\n} \nLRESULT CALLBACK WndProc(HWND hwnd, UINT msg, WPARAM wParam,LPARAM lParam)\n{\nswitch(msg) {\n    case WM_ENDSESSION :\n        calljvm();\n    break;\n    default:\n    break;\n}\n\nreturn DefWindowProc(hwnd, msg, wParam, lParam);\n}\nvoid registerWndProc() {\nHINSTANCE h2 = GetModuleHandle(NULL); \nstatic char szAppName[] = \"winhello\";\nWNDCLASSEX wndclass;\nwndclass.cbSize = sizeof(wndclass);\nwndclass.style = CS_HREDRAW | CS_VREDRAW;\nwndclass.lpfnWndProc = WndProc;\nwndclass.cbClsExtra = 0;\nwndclass.cbWndExtra = 0;\nwndclass.hInstance = h2;\nwndclass.hIcon = LoadIcon(NULL, IDI_APPLICATION);\nwndclass.hIconSm = LoadIcon(NULL, IDI_APPLICATION);\nwndclass.hCursor = LoadCursor(NULL, IDC_ARROW);\nwndclass.hbrBackground = (HBRUSH) GetStockObject(WHITE_BRUSH);\nwndclass.lpszClassName = szAppName;\nwndclass.lpszMenuName = NULL; \n/* Register a new window class with Windows */\nif (!RegisterClassEx(&amp;wndclass)) {\n    MessageBox(NULL, TEXT(\"Registering class failed!\"), TEXT(\"Error!\"), MB_ICONEXCLAMATION | MB_OK);\n    return;\n} \n/* Create a window based on our new class */\nHWND hwnd; hwnd = CreateWindow(szAppName, \"Hello, world!\",\nWS_OVERLAPPEDWINDOW,\nCW_USEDEFAULT, CW_USEDEFAULT,\nCW_USEDEFAULT, CW_USEDEFAULT,\nNULL, NULL, h2, NULL); \n/* CreateWindow failed? */\nif( !hwnd ) {\n    MessageBox(NULL, TEXT(\"Window creation failed!\"), TEXT(\"Error!\"), MB_ICONEXCLAMATION | MB_OK);\n    return;\n} \n/* Show and update our window */\nShowWindow(hwnd, 0); /* 0 = SW_HIDE */\nUpdateWindow(hwnd); MSG msg;\nwhile (GetMessage(&amp;msg, NULL, 0, 0) ) {\n    TranslateMessage(&amp;msg); /* for certain keyboard messages */\n    DispatchMessage(&amp;msg); /* send message to WndProc */\n }\n} \n</code></pre>\n\n<p>when i compile it in netbean compiled faild</p>\n\n<pre><code>cd 'C:\\Users\\ma\\Documents\\NetBeansProjects\\HelloWorld'\nC:\\cygwin64\\bin\\make.exe -f Makefile CONF=Debug\n\"/usr/bin/make\" -f nbproject/Makefile-Debug.mk QMAKE= SUBPROJECTS= .build-conf\nmake[1]: Entering directory '/cygdrive/c/Users/ma/Documents/NetBeansProjects/HelloWorld'\n\"/usr/bin/make\"  -f nbproject/Makefile-Debug.mk dist/Debug/Cygwin_1-Windows/libHelloWorld.dll\nmake[2]: Entering directory '/cygdrive/c/Users/ma/Documents/NetBeansProjects/HelloWorld'\nmkdir -p build/Debug/Cygwin_1-Windows\nrm -f \"build/Debug/Cygwin_1-Windows/helloworld.o.d\"\ng++    -c -g -I../../../../../Program\\ Files/Java/jdk1.8.0_144/include -I../../HelloWorld/src -include ../../HelloWorld/src/HelloWorld.h  -MMD -MP -MF \"build/Debug/Cygwin_1-Windows/helloworld.o.d\" -o build/Debug/Cygwin_1-Windows/helloworld.o helloworld.cpp\nIn file included from /cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:45:0,\n                 from ./../../HelloWorld/src/HelloWorld.h:2,\n                 from &lt;command-line&gt;:31:\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni_md.h:34:9: error: '__int64' does not name a type; did you mean '__int64_t'?\n typedef __int64 jlong;\n         ^~~~~~~\n         __int64_t\nIn file included from ./../../HelloWorld/src/HelloWorld.h:2:0,\n                 from &lt;command-line&gt;:31:\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:126:5: error: 'jlong' does not name a type; did you mean 'ulong'?\n     jlong    j;\n     ^~~~~\n     ulong\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:334:20: error: expected identifier before '*' token\n     jlong (JNICALL *CallLongMethod)\n                    ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:334:21: warning: '__stdcall__' attribute only applies to function types [-Wattributes]\n     jlong (JNICALL *CallLongMethod)\n                     ^~~~~~~~~~~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:335:57: error: 'jlong' declared as function returning a function\n       (JNIEnv *env, jobject obj, jmethodID methodID, ...);\n                                                         ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:336:20: error: expected identifier before '*' token\n     jlong (JNICALL *CallLongMethodV)\n                    ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:336:21: warning: '__stdcall__' attribute only applies to function types [-Wattributes]\n     jlong (JNICALL *CallLongMethodV)\n                     ^~~~~~~~~~~~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:337:66: error: 'jlong' declared as function returning a function\n       (JNIEnv *env, jobject obj, jmethodID methodID, va_list args);\n                                                                  ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:338:20: error: expected identifier before '*' token\n     jlong (JNICALL *CallLongMethodA)\n                    ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:338:21: warning: '__stdcall__' attribute only applies to function types [-Wattributes]\n     jlong (JNICALL *CallLongMethodA)\n                     ^~~~~~~~~~~~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:339:72: error: 'jlong' declared as function returning a function\n       (JNIEnv *env, jobject obj, jmethodID methodID, const jvalue *args);\n                                                                        ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:416:20: error: expected identifier before '*' token\n     jlong (JNICALL *CallNonvirtualLongMethod)\n                    ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:416:21: warning: '__stdcall__' attribute only applies to function types [-Wattributes]\n     jlong (JNICALL *CallNonvirtualLongMethod)\n                     ^~~~~~~~~~~~~~~~~~~~~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:417:71: error: 'jlong' declared as function returning a function\n       (JNIEnv *env, jobject obj, jclass clazz, jmethodID methodID, ...);\n                                                                       ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:418:20: error: expected identifier before '*' token\n     jlong (JNICALL *CallNonvirtualLongMethodV)\n                    ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:418:21: warning: '__stdcall__' attribute only applies to function types [-Wattributes]\n     jlong (JNICALL *CallNonvirtualLongMethodV)\n                     ^~~~~~~~~~~~~~~~~~~~~~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:420:20: error: 'jlong' declared as function returning a function\n        va_list args);\n                    ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:421:20: error: expected identifier before '*' token\n     jlong (JNICALL *CallNonvirtualLongMethodA)\n                    ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:421:21: warning: '__stdcall__' attribute only applies to function types [-Wattributes]\n     jlong (JNICALL *CallNonvirtualLongMethodA)\n                     ^~~~~~~~~~~~~~~~~~~~~~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:423:26: error: 'jlong' declared as function returning a function\n        const jvalue *args);\n                          ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:467:20: error: expected identifier before '*' token\n     jlong (JNICALL *GetLongField)\n                    ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:467:21: warning: '__stdcall__' attribute only applies to function types [-Wattributes]\n     jlong (JNICALL *GetLongField)\n                     ^~~~~~~~~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:468:50: error: 'jlong' declared as function returning a function\n       (JNIEnv *env, jobject obj, jfieldID fieldID);\n                                                  ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:487:52: error: 'jlong' has not been declared\n       (JNIEnv *env, jobject obj, jfieldID fieldID, jlong val);\n                                                    ^~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:538:20: error: expected identifier before '*' token\n     jlong (JNICALL *CallStaticLongMethod)\n                    ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:538:21: warning: '__stdcall__' attribute only applies to function types [-Wattributes]\n     jlong (JNICALL *CallStaticLongMethod)\n                     ^~~~~~~~~~~~~~~~~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:539:58: error: 'jlong' declared as function returning a function\n       (JNIEnv *env, jclass clazz, jmethodID methodID, ...);\n                                                          ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:540:20: error: expected identifier before '*' token\n     jlong (JNICALL *CallStaticLongMethodV)\n                    ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:540:21: warning: '__stdcall__' attribute only applies to function types [-Wattributes]\n     jlong (JNICALL *CallStaticLongMethodV)\n                     ^~~~~~~~~~~~~~~~~~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:541:67: error: 'jlong' declared as function returning a function\n       (JNIEnv *env, jclass clazz, jmethodID methodID, va_list args);\n                                                                   ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:542:20: error: expected identifier before '*' token\n     jlong (JNICALL *CallStaticLongMethodA)\n                    ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:542:21: warning: '__stdcall__' attribute only applies to function types [-Wattributes]\n     jlong (JNICALL *CallStaticLongMethodA)\n                     ^~~~~~~~~~~~~~~~~~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:543:73: error: 'jlong' declared as function returning a function\n       (JNIEnv *env, jclass clazz, jmethodID methodID, const jvalue *args);\n                                                                         ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:580:20: error: expected identifier before '*' token\n     jlong (JNICALL *GetStaticLongField)\n                    ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:580:21: warning: '__stdcall__' attribute only applies to function types [-Wattributes]\n     jlong (JNICALL *GetStaticLongField)\n                     ^~~~~~~~~~~~~~~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:581:51: error: 'jlong' declared as function returning a function\n       (JNIEnv *env, jclass clazz, jfieldID fieldID);\n                                                   ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:600:53: error: 'jlong' has not been declared\n       (JNIEnv *env, jclass clazz, jfieldID fieldID, jlong value);\n                                                     ^~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:662:5: error: 'jlong' does not name a type; did you mean 'ulong'?\n     jlong * (JNICALL *GetLongArrayElements)\n     ^~~~~\n     ulong\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:680:39: error: 'jlong' has not been declared\n       (JNIEnv *env, jlongArray array, jlong *elems, jint mode);\n                                       ^~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:697:63: error: 'jlong' has not been declared\n       (JNIEnv *env, jlongArray array, jsize start, jsize len, jlong *buf);\n                                                               ^~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:714:69: error: 'jlong' does not name a type; did you mean 'ulong'?\n       (JNIEnv *env, jlongArray array, jsize start, jsize len, const jlong *buf);\n                                                                     ^~~~~\n                                                                     ulong\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:758:37: error: 'jlong' has not been declared\n        (JNIEnv* env, void* address, jlong capacity);\n                                     ^~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:761:20: error: expected identifier before '*' token\n     jlong (JNICALL *GetDirectBufferCapacity)\n                    ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:761:21: warning: '__stdcall__' attribute only applies to function types [-Wattributes]\n     jlong (JNICALL *GetDirectBufferCapacity)\n                     ^~~~~~~~~~~~~~~~~~~~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:762:33: error: 'jlong' declared as function returning a function\n        (JNIEnv* env, jobject buf);\n                                 ^\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1000:5: error: 'jlong' does not name a type; did you mean 'ulong'?\n     jlong CallLongMethod(jobject obj, jmethodID methodID, ...) {\n     ^~~~~\n     ulong\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1008:5: error: 'jlong' does not name a type; did you mean 'ulong'?\n     jlong CallLongMethodV(jobject obj, jmethodID methodID,\n     ^~~~~\n     ulong\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1012:5: error: 'jlong' does not name a type; did you mean 'ulong'?\n     jlong CallLongMethodA(jobject obj, jmethodID methodID,\n     ^~~~~\n     ulong\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1192:5: error: 'jlong' does not name a type; did you mean 'ulong'?\n     jlong CallNonvirtualLongMethod(jobject obj, jclass clazz,\n     ^~~~~\n     ulong\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1202:5: error: 'jlong' does not name a type; did you mean 'ulong'?\n     jlong CallNonvirtualLongMethodV(jobject obj, jclass clazz,\n     ^~~~~\n     ulong\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1207:5: error: 'jlong' does not name a type; did you mean 'ulong'?\n     jlong CallNonvirtualLongMethodA(jobject obj, jclass clazz,\n     ^~~~~\n     ulong\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1300:5: error: 'jlong' does not name a type; did you mean 'ulong'?\n     jlong GetLongField(jobject obj, jfieldID fieldID) {\n     ^~~~~\n     ulong\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1334:23: error: 'jlong' has not been declared\n                       jlong val) {\n                       ^~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1459:5: error: 'jlong' does not name a type; did you mean 'ulong'?\n     jlong CallStaticLongMethod(jclass clazz,\n     ^~~~~\n     ulong\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1468:5: error: 'jlong' does not name a type; did you mean 'ulong'?\n     jlong CallStaticLongMethodV(jclass clazz,\n     ^~~~~\n     ulong\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1472:5: error: 'jlong' does not name a type; did you mean 'ulong'?\n     jlong CallStaticLongMethodA(jclass clazz,\n     ^~~~~\n     ulong\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1550:5: error: 'jlong' does not name a type; did you mean 'ulong'?\n     jlong GetStaticLongField(jclass clazz, jfieldID fieldID) {\n     ^~~~~\n     ulong\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1585:25: error: 'jlong' has not been declared\n                         jlong value) {\n                         ^~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1679:5: error: 'jlong' does not name a type; did you mean 'ulong'?\n     jlong * GetLongArrayElements(jlongArray array, jboolean *isCopy) {\n     ^~~~~\n     ulong\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1715:35: error: 'jlong' has not been declared\n                                   jlong *elems,\n                                   ^~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1751:53: error: 'jlong' has not been declared\n                             jsize start, jsize len, jlong *buf) {\n                                                     ^~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1784:35: error: 'jlong' does not name a type; did you mean 'ulong'?\n                             const jlong *buf) {\n                                   ^~~~~\n                                   ulong\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1847:48: error: 'jlong' has not been declared\n     jobject NewDirectByteBuffer(void* address, jlong capacity) {\n                                                ^~~~~\n/cygdrive/c/Program Files/Java/jdk1.8.0_144/include/jni.h:1853:5: error: 'jlong' does not name a type; did you mean 'ulong'?\n     jlong GetDirectBufferCapacity(jobject buf) {\n     ^~~~~\n     ulong\nmake[2]: *** [nbproject/Makefile-Debug.mk:68: build/Debug/Cygwin_1-Windows/helloworld.o] Error 1\nmake[2]: Leaving directory '/cygdrive/c/Users/ma/Documents/NetBeansProjects/HelloWorld'\nmake[1]: *** [nbproject/Makefile-Debug.mk:59: .build-conf] Error 2\nmake[1]: Leaving directory '/cygdrive/c/Users/ma/Documents/NetBeansProjects/HelloWorld'\nmake: *** [nbproject/Makefile-impl.mk:40: .build-impl] Error 2\n\nBUILD FAILED (exit value 2, total time: 2s)\n</code></pre>\n"}, {"tags": ["c++", "exception", "exception-handling", "c++14"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1533759528, "post_id": 51754962, "comment_id": 90469591, "body": "Exceptions most not crossing into (be unwound into) code that does not have exceptions enabled and/or does not understand exceptions.Some code throws, stack unwinding starts, a stackframe is encountered that as not setup for exceptions bad things happen."}, {"owner": {"reputation": 4503, "user_id": 1345959, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/993c78d24d979bd4e9aaea30c065e932?s=128&d=identicon&r=PG", "display_name": "Ela782", "link": "https://stackoverflow.com/users/1345959/ela782"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1533759614, "post_id": 51754962, "comment_id": 90469638, "body": "@RichardCritten I am aware of that. As I wrote in the question, I catch all the exceptions in the library that is compiled with exceptions enabled. So in theory, I guess no exceptions should ever cross the &quot;border&quot;. But I am still linking non-exception enabled code to exception-enabled code and asking whether this is defined or undefined behavior."}, {"owner": {"reputation": 109, "user_id": 7906145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/555c033cba1f4160bad70f8e19c47c90?s=128&d=identicon&r=PG&f=1", "display_name": "Volt", "link": "https://stackoverflow.com/users/7906145/volt"}, "edited": false, "score": 0, "creation_date": 1533765208, "post_id": 51754962, "comment_id": 90471875, "body": "I am confused. Are you linking a no exception library into your exception project? Or the other way round? Also how do you mean it disabled? All functions are marked as nothrow? Or is it an option in your IDE? Is the library precompiled?"}, {"owner": {"reputation": 4503, "user_id": 1345959, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/993c78d24d979bd4e9aaea30c065e932?s=128&d=identicon&r=PG", "display_name": "Ela782", "link": "https://stackoverflow.com/users/1345959/ela782"}, "reply_to_user": {"reputation": 109, "user_id": 7906145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/555c033cba1f4160bad70f8e19c47c90?s=128&d=identicon&r=PG&f=1", "display_name": "Volt", "link": "https://stackoverflow.com/users/7906145/volt"}, "edited": false, "score": 0, "creation_date": 1533765376, "post_id": 51754962, "comment_id": 90471937, "body": "@Volt I am linking an exception-enabled library (i.e. exceptions enabled via compiler flag, the library has throw statements, etc.) into a project that has exceptions disabled via compiler flags. As mentioned, I do have (partial) control over the exception-enabled library, so I can catch all exceptions and hopefully make it so that it would never &quot;leak&quot; an exception back to the exception-disabled project."}], "owner": {"reputation": 4503, "user_id": 1345959, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/993c78d24d979bd4e9aaea30c065e932?s=128&d=identicon&r=PG", "display_name": "Ela782", "link": "https://stackoverflow.com/users/1345959/ela782"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533793095, "creation_date": 1533759380, "last_edit_date": 1533765800, "question_id": 51754962, "link": "https://stackoverflow.com/questions/51754962/linking-a-library-that-has-been-compiled-with-exceptions-enabled-to-a-project-th", "title": "Linking a library that has been compiled with exceptions enabled to a project that has exceptions disabled", "body": "<p>I've got one project that is compiled to a library (static .lib or dynamic .dll), which is compiled with C++ exceptions enabled.\nThen I've got another, separate project, that I have no control over, where exceptions are disabled, and that project links to the library that has exceptions enabled (and obviously uses classes and functions from the library that it's linking in).</p>\n\n<p>To clarify:</p>\n\n<ul>\n<li>Library (static or dynamic, let's say .lib file): Compiled with exceptions enabled (C++ compiler flag). The library can throw but can catch all its exceptions so I can make it so that it would not leak any exceptions to the \"outside\"</li>\n<li>Project: It has exceptions disabled via compiler flag, and I cannot change this. This project links against the library above.</li>\n</ul>\n\n<p>Is this a supported scenario or does that result in undefined behavior or something like that?\nLet's assume that inside the .lib, I catch all exceptions that could possibly occur and handle them, and no exceptions are \"leaked\" or thrown out of the .lib back into the project that does not have exceptions enabled.</p>\n\n<p>Does it depend on the platform (Win/Linux/macOS etc.) or compiler (MSVC/clang/gcc) whether this works?\nDoes it depend on whether the library is created and linked as static or dynamic library?</p>\n\n<p>If it matters, the projects are compiled in C++14 mode.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/13990892/throwing-c-exceptions-outside-static-library?rq=1\">This question</a> is somewhat related, it basically says \"Don't allow exceptions to propagate between two pieces of code\" (unless they have the exact same compiler flags). But it doesn't specifically answer my question, which is, given I catch all exceptions (so none should cross boundaries, in theory), to link together an exception-enabled library to an exception-disabled project.</p>\n"}, {"tags": ["c++", "arrays", "compilation"], "comments": [{"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 3, "creation_date": 1533759084, "post_id": 51754860, "comment_id": 90469384, "body": "<code>array</code> is not a <code>static</code> variable in your example. It is a local variable in the <code>main()</code> function. The storage for it is not allocated until <code>main()</code> is called."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 3, "creation_date": 1533759195, "post_id": 51754860, "comment_id": 90469425, "body": "It will give an error (or at least a warning) if you use the correct compiler options - for example, <code>-pedantic</code> with GCC."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 6, "creation_date": 1533759264, "post_id": 51754860, "comment_id": 90469462, "body": "... and arrays of dynamic size, i.e. where <code>NUM</code> is not a <code>constexpr</code>, are not supported by C++ standard. Some compilers provide extensions (e.g. gcc), but these extensions are still not standard."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 2, "creation_date": 1533759697, "post_id": 51754860, "comment_id": 90469683, "body": "The term you are looking for is VLA. They started as a gcc extension, got standardized in C but not in C++. g++ will accept them in C++ as well with all but most restrictive command line options."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1533760813, "post_id": 51754860, "comment_id": 90470274, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/737240/array-size-at-run-time-without-dynamic-allocation-is-allowed\">Array size at run time without dynamic allocation is allowed?</a>"}], "owner": {"reputation": 21, "user_id": 10199759, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DUcZl26uZpQ/AAAAAAAAAAI/AAAAAAAAAAc/pEzb9xYzc2M/photo.jpg?sz=128", "display_name": "WZHANG", "link": "https://stackoverflow.com/users/10199759/wzhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1533759005, "creation_date": 1533759005, "question_id": 51754860, "link": "https://stackoverflow.com/questions/51754860/c-compiling-static-arrays-of-unknown-size", "title": "C++ Compiling Static Arrays Of Unknown Size?", "body": "<p>For example, if you have some code that takes an integer as input and then declare an array of that size, like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nint main(){\n    size_t NUM;\n    cin &gt;&gt; NUM;\n    size_t array[NUM];\n    //do whatever\n    return 0;\n}\n</code></pre>\n\n<p>How does this <strong>not</strong> give an error when compiling? The compiler should set aside a specific part of memory for the array, but how can it do that when the size is NUM, and is not known during compilation? Does the compiler automatically convert it to a dynamic array with new? </p>\n\n<p>I am using g++ 7.3.0 compiler.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1533759434, "post_id": 51754816, "comment_id": 90469536, "body": "You should ref-qualify your <code>operator int&amp;&amp;()</code>: <code>operator int&amp;&amp;() &amp;&amp; { ... }</code>"}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1533759764, "post_id": 51754816, "comment_id": 90469717, "body": "I would if I had a compiler that supported ref qualifiers..."}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 1, "creation_date": 1533759865, "post_id": 51754816, "comment_id": 90469775, "body": "@SeanMcAllister Don&#39;t tell me you&#39;re again using Intel 13."}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "reply_to_user": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1533759914, "post_id": 51754816, "comment_id": 90469797, "body": "@Walter I am indeed"}], "answers": [{"comments": [{"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533759747, "post_id": 51755006, "comment_id": 90469706, "body": "I see, so if my T&amp; operator was non-const as well, it could choose to call either?"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 2, "creation_date": 1533759799, "post_id": 51755006, "comment_id": 90469736, "body": "It would be ambiguous."}], "tags": [], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": true, "score": 7, "last_activity_date": 1533759568, "creation_date": 1533759568, "answer_id": 51755006, "question_id": 51754816, "link": "https://stackoverflow.com/questions/51754816/will-c-always-prefer-an-rvalue-reference-conversion-operator-over-const-lvalue/51755006#51755006", "title": "Will C++ always prefer an rvalue reference conversion operator over const lvalue reference when possible?", "body": "<p>There's no such preference.</p>\n\n<p>Your example is actually showing preference for a non-const member function over a const one when called on a non-const object.</p>\n"}, {"comments": [{"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1533759991, "post_id": 51755074, "comment_id": 90469837, "body": "What happens if the conversion to <code>int&amp;&amp;</code> is also ref qualified and you <code>std::move(h)</code>? Is it still ambiguous?"}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1533760098, "post_id": 51755074, "comment_id": 90469887, "body": "@Walter what do you mean <b>also</b> ref qualified? No operator in the example is ref qualified. What you do in the body of the function be it <code>std::move</code> or anything else has absolutely no impact on overload resolution."}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1533760518, "post_id": 51755074, "comment_id": 90470126, "body": "I meant <code>operator int&amp;&amp;() &amp;&amp;;</code>"}], "tags": [], "owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": false, "score": 2, "last_activity_date": 1533759823, "creation_date": 1533759823, "answer_id": 51755074, "question_id": 51754816, "link": "https://stackoverflow.com/questions/51754816/will-c-always-prefer-an-rvalue-reference-conversion-operator-over-const-lvalue/51755074#51755074", "title": "Will C++ always prefer an rvalue reference conversion operator over const lvalue reference when possible?", "body": "<p>So I don't have the energy and time to bury myself in the standard for this one. I am sure someone will.</p>\n\n<p>However I want to point out your assumption is wrong. And you are missing a crucial information: one operator is <code>const</code>, one is not and it turns out this is the deciding factor in your case not <code>&amp;&amp;</code> vs <code>const &amp;</code>. Let's see:</p>\n\n<h1>Both methods mutable, mutable object:</h1>\n\n<pre><code>operator       int&amp;&amp;();\noperator const int&amp;() ;\n</code></pre>\n\n\n\n<pre><code>holds h;\nint val = h; // compile error\n</code></pre>\n\n<p>Gives the error:</p>\n\n<blockquote>\n  <p>conversion from 'holds' to 'int' is ambiguous</p>\n</blockquote>\n\n<p>So you see both conversion operators are <em>equal</em> and none is preferred so there is an ambiguity.</p>\n\n<h2>Both methods mutable, const object:</h2>\n\n<pre><code>operator       int&amp;&amp;();\noperator const int&amp;() ;\n</code></pre>\n\n\n\n<pre><code>const holds h;\nint val = h;   // error no viable method\n</code></pre>\n\n<p>Well, this is an easy and non-interesting one: no mutable method can be called on a const object</p>\n\n<h2><code>&amp;&amp;</code> mutable, <code>const&amp;</code> const, object mutable</h2>\n\n<pre><code>operator       int&amp;&amp;();\noperator const int&amp;() const;\n</code></pre>\n\n\n\n<pre><code>holds h;\nint val = h; // calls holds::operator int&amp;&amp;()\n</code></pre>\n\n<p>Now the mutable method is preferred because the object is mutable</p>\n\n<h2><code>&amp;&amp;</code> mutable, <code>const&amp;</code> const, object const</h2>\n\n<pre><code>operator       int&amp;&amp;();\noperator const int&amp;() const;\n</code></pre>\n\n\n\n<pre><code>const holds h;\nint val = h;   // calls  holds::operator int const&amp;() const\n</code></pre>\n\n<p>Now the <code>const</code> method is the only choice as a mutable method cannot be called on a const object.</p>\n"}], "owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "accepted_answer_id": 51755006, "answer_count": 2, "score": 6, "last_activity_date": 1533759823, "creation_date": 1533758833, "question_id": 51754816, "link": "https://stackoverflow.com/questions/51754816/will-c-always-prefer-an-rvalue-reference-conversion-operator-over-const-lvalue", "title": "Will C++ always prefer an rvalue reference conversion operator over const lvalue reference when possible?", "body": "<p>When writing conversion operators, if I provide both a conversion to <code>const T&amp;</code> and <code>T&amp;&amp;</code>, will C++ always prefer the rvalue operator when possible?  This seems to be true in this small test:</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;stdio.h&gt;\n\nstruct holds {\n  operator       int&amp;&amp;()      { printf(\"moving!\\n\");  return std::move(i); }\n  operator const int&amp;() const { printf(\"copying!\\n\"); return i;            }\n\nprivate:\n  int i = 0;\n};\n\n\nint main() {\n  holds h;\n  int val = h;\n}\n</code></pre>\n\n<p>prints:</p>\n\n<pre><code> \u2570\u2500\u25b8 ./test\nmoving!\n</code></pre>\n\n<p>But perhaps someone that speaks spec-ese better than I can verify?</p>\n"}, {"tags": ["c++", "c++17"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 3, "creation_date": 1533758100, "post_id": 51754612, "comment_id": 90468901, "body": "<code>::B(A{})</code>? ---"}], "answers": [{"tags": [], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": true, "score": 21, "last_activity_date": 1533758102, "creation_date": 1533758102, "answer_id": 51754648, "question_id": 51754612, "link": "https://stackoverflow.com/questions/51754612/how-to-force-class-template-argument-deduction-when-constructing-a-class-in-its/51754648#51754648", "title": "How to force class template argument deduction when constructing a class in its own member functions?", "body": "<p>You qualify it so that it's not the injected-class-name.</p>\n\n<pre><code>auto foo() {return ::B(A{});}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 4, "last_activity_date": 1533763121, "last_edit_date": 1533763121, "creation_date": 1533758267, "answer_id": 51754689, "question_id": 51754612, "link": "https://stackoverflow.com/questions/51754612/how-to-force-class-template-argument-deduction-when-constructing-a-class-in-its/51754689#51754689", "title": "How to force class template argument deduction when constructing a class in its own member functions?", "body": "<p>Another option is to use a function to do the type deduction for you.</p>\n\n<pre><code>template &lt;typename T&gt; B&lt;T&gt; make_b(T t) { return B&lt;T&gt;(t); }\n</code></pre>\n\n<p>and use</p>\n\n<pre><code>auto foo() {return make_b(A{});} \n</code></pre>\n"}], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 1, "accepted_answer_id": 51754648, "answer_count": 2, "score": 11, "last_activity_date": 1533763121, "creation_date": 1533757942, "question_id": 51754612, "link": "https://stackoverflow.com/questions/51754612/how-to-force-class-template-argument-deduction-when-constructing-a-class-in-its", "title": "How to force class template argument deduction when constructing a class in its own member functions?", "body": "<p>Consider following code:</p>\n\n<pre><code>struct A {};\n\ntemplate &lt;typename T&gt; struct B\n{\n    B(T) {}\n    auto foo() {return B(A{});} // error: no matching function for call to 'B&lt;int&gt;::B(A)'\n};\n\nauto foo() {return B(A{});} // compiles\n\nint main()\n{\n    foo();\n    B b(0);\n    b.foo();\n}\n</code></pre>\n\n<p><kbd><a href=\"https://godbolt.org/g/f1sRuk\" rel=\"noreferrer\">Try it live</a></kbd></p>\n\n<p>I understand why <code>B::foo()</code> doesn't compile: Inside of <code>struct B&lt;T&gt;</code>, <code>B</code> (as an injected-class-name) means <code>B&lt;T&gt;</code> unless it's explicitly used as a template. Which in this case prevents class template argument deduction.</p>\n\n<p>Let's say I can't do <code>auto foo() {return B&lt;A&gt;(A{});}</code> since my actual code relies on slightly elaborate user-provided deduction guides.</p>\n\n<p>The question is: How do I force class template argument deduction when constructing <code>B</code> inside of <code>B::foo</code>?</p>\n\n<p><sub>I hope I'm not missing something obvious.</sub></p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1533759323, "post_id": 51754610, "comment_id": 90469489, "body": "Intel 13 was never C++11. They may have said something like that, but this was wishful thinking."}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "reply_to_user": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1533759384, "post_id": 51754610, "comment_id": 90469515, "body": "@Walter seriously..."}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1533759608, "post_id": 51754610, "comment_id": 90469634, "body": "yes? I am serious. I gave up on Intel compilers for any C++ standard less then 5 years old...."}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "reply_to_user": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1533759666, "post_id": 51754610, "comment_id": 90469666, "body": "Sorry, the tone got lost, I was agreeing with you, it&#39;s awful but I&#39;m stuck with it for now =D"}], "answers": [{"comments": [{"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533759321, "post_id": 51754877, "comment_id": 90469488, "body": "But I have an rvalue reference through my conversion operator (note this compiles fine on gcc).  In any event, std::move(m) generates the same error."}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "reply_to_user": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533759515, "post_id": 51754877, "comment_id": 90469584, "body": "@SeanMcAllister,  this answer, it if works, satisfies your request: it would be a work around and you can avoid allowing copies but keep the conversion. I&#39;m surprised about the futile downvote."}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533760114, "post_id": 51754877, "comment_id": 90469898, "body": "Unfortunately neither works, the static_cast generates an invalid type conversion error.   I guess I&#39;m stuck with an explicit member function ::value() in the non-copyable case."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1533760304, "post_id": 51754877, "comment_id": 90470009, "body": "Wording might have been better... Adjusted, plus added some further options."}], "tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": true, "score": 1, "last_activity_date": 1533760648, "last_edit_date": 1533760648, "creation_date": 1533759096, "answer_id": 51754877, "question_id": 51754610, "link": "https://stackoverflow.com/questions/51754610/workaround-for-poor-c-behavior-in-intel-13-1-2-with-deleted-copy-constructor/51754877#51754877", "title": "Workaround for poor C++ behavior in Intel 13.1.2 with deleted copy constructor", "body": "<p>You might try to make the rvalue explicit:</p>\n\n<pre><code>moveonly a = std::move(m);\n</code></pre>\n\n<p>Possibly, explicit cast helps as well:</p>\n\n<pre><code>moveonly a = static_cast&lt;moveonly&amp;&amp;&gt;(m);\n</code></pre>\n\n<p>Calling the cast operator explicitly:</p>\n\n<pre><code>moveonly a = m.operator moveonly&amp;&amp;();\n</code></pre>\n\n<p>If all fails, falling back to pre-C++11 means:</p>\n\n<pre><code>struct holds\n{\n    operator T&amp;&amp;() { return std::move(t); }\n    T t;\n    swap(T&amp; tt)\n    {\n        swap(t, tt);\n    }\n};\n</code></pre>\n\n<p>with appropriate swap defined for moveonly, so you could:</p>\n\n<pre><code>moveonly a;\nm.swap(a);\n</code></pre>\n"}], "owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 51754877, "answer_count": 1, "score": 1, "last_activity_date": 1533760648, "creation_date": 1533757934, "question_id": 51754610, "link": "https://stackoverflow.com/questions/51754610/workaround-for-poor-c-behavior-in-intel-13-1-2-with-deleted-copy-constructor", "title": "Workaround for poor C++ behavior in Intel 13.1.2 with deleted copy constructor", "body": "<p>I'm stuck supporting back to Intel 13.1.2, which is nominally C++11 compliant, but this code:</p>\n\n<pre><code>#include &lt;algorithm&gt;\n\nstruct moveonly {\n  moveonly()                =default;\n  moveonly(const moveonly&amp;) =delete;\n  moveonly(moveonly&amp;&amp; other) { member = std::move(other.member); }\n\nprivate:\n  int member = 0;\n};\n\ntemplate &lt;typename T&gt;\nstruct holds {\n  operator T&amp;&amp;() { return std::move(t); }\n  T t;\n};\n\n\nint main() {\n  holds&lt;moveonly&gt; m;\n  moveonly a = m;\n}\n</code></pre>\n\n<p>Fails to compile:</p>\n\n<pre><code> \u2570\u2500\u25b8 icc -std=c++11 test.cc -o test\ntest.cc(21): error: function \"moveonly::moveonly(const moveonly &amp;)\" (declared at line 5) cannot be referenced -- it is a deleted function\n    moveonly a = m;\n                 ^\n\ntest.cc(21): error: function \"moveonly::moveonly(const moveonly &amp;)\" (declared at line 5) cannot be referenced -- it is a deleted function\n    moveonly a = m;\n                 ^\n\ncompilation aborted for test.cc (code 2)\n</code></pre>\n\n<p>Assuming I can't make the class copyable, and would like to keep the conversion operator, can anyone come up with a workaround?</p>\n"}, {"tags": ["c++", "delphi", "dll"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1533757798, "post_id": 51754539, "comment_id": 90468760, "body": "Where is the memory for the buffer allocated?"}, {"owner": {"reputation": 2661, "user_id": 3164070, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5woQK.jpg?s=128&g=1", "display_name": "Dave Nottage", "link": "https://stackoverflow.com/users/3164070/dave-nottage"}, "edited": false, "score": 0, "creation_date": 1533757894, "post_id": 51754539, "comment_id": 90468808, "body": "Without some code of how the application is calling to the function, it&#39;s going to be difficult to determine where the problem is. Perhaps show the code that works"}, {"owner": {"reputation": 13, "user_id": 10199681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9f659843f533f96e2c27ad3384642b?s=128&d=identicon&r=PG&f=1", "display_name": "Sargis", "link": "https://stackoverflow.com/users/10199681/sargis"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1533758269, "post_id": 51754539, "comment_id": 90468984, "body": "The memory is allocated in application side @RichardCritten"}, {"owner": {"reputation": 13, "user_id": 10199681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9f659843f533f96e2c27ad3384642b?s=128&d=identicon&r=PG&f=1", "display_name": "Sargis", "link": "https://stackoverflow.com/users/10199681/sargis"}, "reply_to_user": {"reputation": 2661, "user_id": 3164070, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5woQK.jpg?s=128&g=1", "display_name": "Dave Nottage", "link": "https://stackoverflow.com/users/3164070/dave-nottage"}, "edited": false, "score": 0, "creation_date": 1533758455, "post_id": 51754539, "comment_id": 90469069, "body": "As for the call of a function, we don&#39;t have application source codes, so no idea how the call is performed. @DaveNottage"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1533758768, "post_id": 51754539, "comment_id": 90469210, "body": "@Sargis You don&#39;t need the application source code. You just need to translate the DLL declarations <i>correctly</i> (which you are not)."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1533798182, "post_id": 51754539, "comment_id": 90480416, "body": "@Remy That&#39;s still not enough to know <i>how</i> to call the function. For instance, int* could be a pointer to single value or pointer to array, and could be optional. It&#39;s impossible to know. Which is why this question has no definitive answer without guesswork."}], "answers": [{"comments": [{"owner": {"reputation": 5808, "user_id": 96201, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e60460eb060dbca30ec2c678bbd34793?s=128&d=identicon&r=PG", "display_name": "HeartWare", "link": "https://stackoverflow.com/users/96201/heartware"}, "edited": false, "score": 0, "creation_date": 1533797215, "post_id": 51754685, "comment_id": 90479937, "body": "Technically, isn&#39;t <code>var Buffer: Pointer</code> equivalent to <code>void*&amp;</code> or <code>void&amp;*</code> (can&#39;t figure out the order of the two modifiers). <code>void**</code> would be <code>Buffer: PPointer</code> (where PPointer = <code>^POINTER</code>)."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 5808, "user_id": 96201, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e60460eb060dbca30ec2c678bbd34793?s=128&d=identicon&r=PG", "display_name": "HeartWare", "link": "https://stackoverflow.com/users/96201/heartware"}, "edited": false, "score": 0, "creation_date": 1533802416, "post_id": 51754685, "comment_id": 90482814, "body": "@HeartWare the order is <code>void*&amp;</code>, and yes, you are right, from a C++ perspective. From a C perspective, it is <code>void**</code>."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1533812404, "post_id": 51754685, "comment_id": 90488984, "body": "And even in C++, <code>void**</code> will work fine. So tht would be my preferred translation. But <code>unsigned char **</code> would probably work too (same binary representation) and would probably be easier to use in the DLL."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1533812569, "post_id": 51754685, "comment_id": 90489102, "body": "Anyway, translation is the art of failure. ;-)"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 4, "last_activity_date": 1533802519, "last_edit_date": 1533802519, "creation_date": 1533758260, "answer_id": 51754685, "question_id": 51754539, "link": "https://stackoverflow.com/questions/51754539/calling-c-function-from-delphi/51754685#51754685", "title": "Calling c++ function from delphi", "body": "<p>The DLL function you showed is declared wrong in your Delphi code.  <code>var Buffer: Pointer</code> is equivilent to <code>void**</code> in C, or <code>void*&amp;</code> in C++, but certainly not to <code>char*</code> like the DLL function is expecting.  Using a <code>void**</code>/<code>void*&amp;</code> parameter would be useful if the DLL were allocating memory to return to the application, but from your description that is not the case.</p>\n\n<p>Use this Delphi declaration instead:</p>\n\n<pre><code>function functionName(Buffer: PAnsiChar; var BuffLen: Integer): Integer; stdcall;\n</code></pre>\n\n<p><code>PAnsiChar</code> in Delphi is equivalent to <code>char*</code> in C/C++.</p>\n\n<p>You should read the following blog article about the gotchas to watch out for when converting C/C++ declarations to Delphi:</p>\n\n<p><a href=\"http://rvelthuis.de/articles/articles-convert.html\" rel=\"nofollow noreferrer\">Rudy's Delphi Corner: Pitfalls of converting</a></p>\n"}], "owner": {"reputation": 13, "user_id": 10199681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9f659843f533f96e2c27ad3384642b?s=128&d=identicon&r=PG&f=1", "display_name": "Sargis", "link": "https://stackoverflow.com/users/10199681/sargis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 0, "accepted_answer_id": 51754685, "answer_count": 1, "score": -1, "last_activity_date": 1533802519, "creation_date": 1533757583, "last_edit_date": 1533758364, "question_id": 51754539, "link": "https://stackoverflow.com/questions/51754539/calling-c-function-from-delphi", "title": "Calling c++ function from delphi", "body": "<p>I wrote a DLL in C++ whose functions will be called from a Delphi application.</p>\n\n<p>One of the functions in the DLL takes a <code>Pointer</code> to a buffer where an XML string should be written.  But, when I write a string into the buffer, after returning from the function the application crashes with an \"Access violation at address 0048B... in module ....exe. Write of address 3030D...\" error.</p>\n\n<p>The calling convention of the function declarations are the same, both in the DLL and the application.</p>\n\n<p>I've made a simple application in Delphi to simulate the behavior of the application and it works fine.  The biggest problem is that I don't have any information about the application internals: no sources, no documents, not even logs. Just function declarations and parameter descriptions.</p>\n\n<p>Function declaration in delphi:</p>\n\n<pre><code>function functionName(var Buffer: Pointer; var BuffLen: Integer): Integer; stdcall;\n</code></pre>\n\n<p>Function Declaration in the DLL:</p>\n\n<pre><code>extern \"C\" int WINAPI functionName(char*, int*);\n</code></pre>\n\n<p>Does someone know how to solve this?</p>\n\n<p>From my tests, I have a feeling that the problem is in the application, not in the DLL.  However, I'm not completely sure about this.  Are there any possible tests I can do at the DLL site to either solve the problem or locate the issue? </p>\n\n<p>I'd really appreciate any help in this matter.</p>\n\n<p>As a side note, the DLL is compiled with Visual Studio. Can this cause the problem?</p>\n"}, {"tags": ["c++"], "owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1533756470, "creation_date": 1533756470, "question_id": 51754290, "link": "https://stackoverflow.com/questions/51754290/the-difference-of-handling-signed-overflow-of-int-and-short", "title": "The difference of handling signed overflow of int and short", "body": "<p>Signed overflow of <code>int</code> is undefined behavior:</p>\n\n<pre><code>int a = INT_MAX;\na += 1; // Undefined Behavior\n</code></pre>\n\n<p>The same operation of <code>short</code> is implementation defined (if <code>short</code> is smaller than <code>int</code>):</p>\n\n<pre><code>short a = SHRT_MAX;\na += 1; // Implementation defined\n</code></pre>\n\n<p>It is implementation defined, because <code>a</code> first gets promoted to <code>int</code> (a usually wider type than <code>short</code>), and after the addition, the result gets converted to <code>short</code>, which is implementation defined, if the value cannot be represented in a <code>short</code>.</p>\n\n<p>Am I right on this? If yes, why is there the difference? Wouldn't it be logical that both are undefined behavior or implementation defined?</p>\n"}, {"tags": ["c++", "templates", "namespaces", "overloading"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 1, "creation_date": 1533756777, "post_id": 51754170, "comment_id": 90468316, "body": "I guess you could use <code>typeid</code> for this specific case."}, {"owner": {"reputation": 1239, "user_id": 2065863, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hJIRR.jpg?s=128&g=1", "display_name": "Deathicon", "link": "https://stackoverflow.com/users/2065863/deathicon"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1533758236, "post_id": 51754170, "comment_id": 90468965, "body": "@Rakete1111 I forgot to mention that I cannot use rtti in my case."}, {"owner": {"reputation": 245, "user_id": 10025445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c215777ec0036f32d949a80dbf259345?s=128&d=identicon&r=PG&f=1", "display_name": "acade", "link": "https://stackoverflow.com/users/10025445/acade"}, "edited": false, "score": 0, "creation_date": 1533759242, "post_id": 51754170, "comment_id": 90469452, "body": "<code>int(&amp;)[size]</code>, with  template size. do you need it?"}, {"owner": {"reputation": 1239, "user_id": 2065863, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hJIRR.jpg?s=128&g=1", "display_name": "Deathicon", "link": "https://stackoverflow.com/users/2065863/deathicon"}, "reply_to_user": {"reputation": 245, "user_id": 10025445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c215777ec0036f32d949a80dbf259345?s=128&d=identicon&r=PG&f=1", "display_name": "acade", "link": "https://stackoverflow.com/users/10025445/acade"}, "edited": false, "score": 0, "creation_date": 1533760150, "post_id": 51754170, "comment_id": 90469926, "body": "@acade unfortunately I can&#39;t use class reference in my case. Your solution works fine if I could use references."}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1533757468, "post_id": 51754351, "comment_id": 90468623, "body": "I do not see how this tag can be used in the real life, without calling code actually knowing it deals with the array - at which point it  can simply call a different function instead."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1533757880, "post_id": 51754351, "comment_id": 90468798, "body": "@SergeyA: <code>constexpr auto name = getName((int* const)nullptr);</code> would be <code>constexpr auto name = getName(Tag&lt;int&gt;{});</code> (where I suppose <code>int</code> would be <code>T</code> in generic code). but indeed <code>getName&lt;T&gt;()</code> would also work but handling <code>getName&lt;std::vector&lt;T&gt;&gt;()</code> would be more problematic."}, {"owner": {"reputation": 1239, "user_id": 2065863, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hJIRR.jpg?s=128&g=1", "display_name": "Deathicon", "link": "https://stackoverflow.com/users/2065863/deathicon"}, "edited": false, "score": 0, "creation_date": 1533759818, "post_id": 51754351, "comment_id": 90469749, "body": "@Jarod42 I tried your solution but it didn&#39;t work for the array type, online test: <a href=\"http://cpp.sh/9mxh7\" rel=\"nofollow noreferrer\">cpp.sh/9mxh7</a>"}, {"owner": {"reputation": 1239, "user_id": 2065863, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hJIRR.jpg?s=128&g=1", "display_name": "Deathicon", "link": "https://stackoverflow.com/users/2065863/deathicon"}, "edited": false, "score": 0, "creation_date": 1533760253, "post_id": 51754351, "comment_id": 90469974, "body": "@Jarod42 oh nice I didn&#39;t think to combine it with the template size constant. It works now, cheers!"}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 1, "last_activity_date": 1533760080, "last_edit_date": 1533760080, "creation_date": 1533756773, "answer_id": 51754351, "question_id": 51754170, "link": "https://stackoverflow.com/questions/51754170/c-namespaced-function-template-specialization-alternative-using-overloading-wi/51754351#51754351", "title": "C++ namespaced function template specialization alternative using overloading with class pointer?", "body": "<p>You might use \"tag\" instead:</p>\n\n<pre><code>template &lt;typename T&gt; struct Tag{};\n\n// template &lt;typename T&gt;\n//constexpr auto getName(Tag&lt;T&gt;) { return \"\"; }\n\ninline constexpr auto getName(Tag&lt;int&gt;) { return \"int\"; }\n\ninline constexpr auto getName(Tag&lt;int[]&gt;) { return \"int[]\"; }\n\ntemplate &lt;std::size_t N&gt;\nconstexpr auto registerName(Tag&lt;int[N]&gt;) { return \"int[N]\"; }\n</code></pre>\n\n<p><a href=\"http://cpp.sh/5kzyd\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}], "owner": {"reputation": 1239, "user_id": 2065863, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hJIRR.jpg?s=128&g=1", "display_name": "Deathicon", "link": "https://stackoverflow.com/users/2065863/deathicon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 51754351, "answer_count": 1, "score": 0, "last_activity_date": 1533760080, "creation_date": 1533756017, "question_id": 51754170, "link": "https://stackoverflow.com/questions/51754170/c-namespaced-function-template-specialization-alternative-using-overloading-wi", "title": "C++ namespaced function template specialization alternative using overloading with class pointer?", "body": "<p>So I've come across a problem where using function template specialization forces me to write the function in the same namespace as the function template. I cannot do this because some other code requires to define some function template within another specific namespace.</p>\n\n<p>To work-around the namespace issue, I'm trying to use function overloading instead. Furthermore, these functions return value need to be <code>constexpr</code>, so I could not overload using a class reference, so I used a class pointer instead.</p>\n\n<p>So I ended up with this:</p>\n\n<pre><code>template&lt;class T&gt; constexpr auto getName(T* const) { return \"\"; }\n</code></pre>\n\n<p>and then I overload them like this:</p>\n\n<pre><code>inline constexpr auto getName(int* const) { return \"int\"; }\n</code></pre>\n\n<p>This works fine and allows me to call the correct overload using a <code>nullptr</code> trick like this:</p>\n\n<pre><code>auto name = getName((int* const)nullptr);\n</code></pre>\n\n<p>My problem is it seems I am unable to overload this when the type is an array. I would like to be able to overload when the type is <code>int[]</code>, and return the string <code>\"int[]\"</code> in that case.</p>\n\n<p>Perhaps there is a better solution to avoid the namespace hell for function template specialization? I know this all stinks but I could not find a better alternative yet.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 1235, "user_id": 3418011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f91f9e48d447aaa7fb1a3caae8825407?s=128&d=identicon&r=PG", "display_name": "Bill", "link": "https://stackoverflow.com/users/3418011/bill"}, "edited": false, "score": 2, "creation_date": 1533755986, "post_id": 51754129, "comment_id": 90467990, "body": "The answer referenced does not say &quot;pointers in C++ are useless&quot;, but it recommends the use of smart pointers."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 8, "creation_date": 1533756119, "post_id": 51754129, "comment_id": 90468039, "body": "&quot;It has always been claimed that pointers in C++ are useless.&quot; It has never been claimed - C++ is deeply dependent on the use of pointers, as at heart are all  programming languages."}, {"owner": {"reputation": 413, "user_id": 6415979, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b9e3987becca782d06105588adc1f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "RangerBob", "link": "https://stackoverflow.com/users/6415979/rangerbob"}, "edited": false, "score": 0, "creation_date": 1533756125, "post_id": 51754129, "comment_id": 90468041, "body": "No he did not say that. He said : &quot;For somebody who knows modern C++, it\u2019s clear that you very rarely need any pointers (either smart or raw; except when using them as iterators)&quot;"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 2, "creation_date": 1533756219, "post_id": 51754129, "comment_id": 90468079, "body": "You missed the part about iterators. Pointers are fine iterators. They are also fine nullable things. The problem is too many people seem to associate the word &quot;pointer&quot; with dynamic allocation and ownership."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1533756246, "post_id": 51754129, "comment_id": 90468092, "body": "And from Konrad&#39;s answer &quot;There are definitely legitimate uses of (raw) pointers. &quot;"}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1533756437, "post_id": 51754129, "comment_id": 90468170, "body": "You can write C++ code that does all of the same things with pointers that C code can do.  You can also do many new things in C++, and some of those new things let you write safer, cleaner, non-raw-pointer solutions to problems that you could only have solved in C by using pointers."}, {"owner": {"reputation": 413, "user_id": 6415979, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b9e3987becca782d06105588adc1f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "RangerBob", "link": "https://stackoverflow.com/users/6415979/rangerbob"}, "edited": false, "score": 0, "creation_date": 1533756454, "post_id": 51754129, "comment_id": 90468179, "body": "@NeilButterworth : The end of his phrase is quite important too: &quot;But I (and many professional C++ programmers) maintain that these cases are exceedingly rare. &quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 3, "creation_date": 1533756586, "post_id": 51754129, "comment_id": 90468233, "body": "@RangerBob &quot;rare&quot; is not the same thing as &quot;useless&quot;."}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1533756769, "post_id": 51754129, "comment_id": 90468313, "body": "What do you expect with <code>a[k]=A + q</code>?"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1533758421, "post_id": 51754129, "comment_id": 90469050, "body": "This question has a false premise. Furthermore many problems are solvable without pointers. But asking how to replace pointers makes no sense. The <code>C++</code> equivalent of pointers is pointers. They are simply not needed as much in <code>C++</code> as in <code>C</code>."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533759372, "post_id": 51754129, "comment_id": 90469514, "body": "i grew up in the believe that if you dont have enough <code>new</code> and <code>delete</code> in your code then you arent really writing c++. Its nice that times have changed and some beginners get pushed away from overusing pointers right from the start, but I hope there will be a time when pointers are not such a religious topic anymore and we dont need articles titled &quot;don&#39;t use f*cking pointers&quot; anymore"}], "answers": [{"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1533757246, "post_id": 51754354, "comment_id": 90468516, "body": "And even <code>std::vector&lt;double*&gt; a{&amp;A[0], &amp;A[2]};</code> (with <code>{}</code> and not <code>()</code>)."}, {"owner": {"reputation": 413, "user_id": 6415979, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b9e3987becca782d06105588adc1f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "RangerBob", "link": "https://stackoverflow.com/users/6415979/rangerbob"}, "edited": false, "score": 0, "creation_date": 1533758637, "post_id": 51754354, "comment_id": 90469151, "body": "Can you give me more information about the difference between  Non-Owning Raw Pointers and Raw, Owning Pointers?"}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "reply_to_user": {"reputation": 413, "user_id": 6415979, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b9e3987becca782d06105588adc1f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "RangerBob", "link": "https://stackoverflow.com/users/6415979/rangerbob"}, "edited": false, "score": 1, "creation_date": 1533759701, "post_id": 51754354, "comment_id": 90469687, "body": "@RangerBob What you need to know about is &quot;Ownership&quot; in C++, which is a pretty broad topic, where Dynamic Memory/Pointers/Smart Pointers are just a subset of that topic. <a href=\"https://isocpp.org/wiki/faq/cpp11-library#unique-ptr\" rel=\"nofollow noreferrer\">The C++ FAQ</a> is a good resource to start with, And <a href=\"http://www.stroustrup.com/resource-model.pdf\" rel=\"nofollow noreferrer\">Bjarne Stroustrup&#39;s (short) paper</a> on a similar topic is also good to look into, as he tends to write in relatively plain language to keep things accessible to laypeople. Also do some google searches for &quot;C++ Ownership semantics&quot; and look around."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1533760091, "post_id": 51754354, "comment_id": 90469882, "body": "It&#39;s not a property of the pointers, but of your logical program structure. Whatever entity is responsible for tracking the lifetime of a resource and then deleting/freeing/otherwise releasing it, is the <i>owner</i>. If your code has a raw pointer variable eventually used to delete an allocated object, that is the owning pointer. Actual ownership is really split between the pointer and the code using it, which is why smart pointers are generally preferred for clearly locating ownership in one place"}, {"owner": {"reputation": 413, "user_id": 6415979, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b9e3987becca782d06105588adc1f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "RangerBob", "link": "https://stackoverflow.com/users/6415979/rangerbob"}, "edited": false, "score": 0, "creation_date": 1533762319, "post_id": 51754354, "comment_id": 90470904, "body": "Thanks for those informations!"}, {"owner": {"reputation": 413, "user_id": 6415979, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b9e3987becca782d06105588adc1f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "RangerBob", "link": "https://stackoverflow.com/users/6415979/rangerbob"}, "edited": false, "score": 0, "creation_date": 1533827138, "post_id": 51754354, "comment_id": 90499390, "body": "@Xirema : In your example, would be nice to replace <code>std::vector&lt;double*&gt;</code> by a iterator vector ?"}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "reply_to_user": {"reputation": 413, "user_id": 6415979, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b9e3987becca782d06105588adc1f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "RangerBob", "link": "https://stackoverflow.com/users/6415979/rangerbob"}, "edited": false, "score": 0, "creation_date": 1533829504, "post_id": 51754354, "comment_id": 90501080, "body": "@RangerBob Iterators are generally a good/better solution for this kind of problem, only issue is that the type system makes it a bit verbose. <code>std::vector&lt;std::vector&lt;double&gt;::iterator&gt;</code> is the full type of this kind of vector, or <code>std::vector&lt;std::vector&lt;double&gt;::const_iterator&gt;</code> for iterators that can&#39;t alter the other vector&#39;s contents. Can replace with <code>std::vector&lt;decltype(A.begin())&gt;</code> or <code>std::vector&lt;decltype(a.cbegin())&gt;</code> to slightly reduce the verbosity."}], "tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": true, "score": 7, "last_activity_date": 1533757112, "last_edit_date": 1533757112, "creation_date": 1533756779, "answer_id": 51754354, "question_id": 51754129, "link": "https://stackoverflow.com/questions/51754129/what-is-the-equivalent-of-cs-double-pointers-in-c/51754354#51754354", "title": "What is the equivalent of C&#39;s double pointers in C++?", "body": "<p>Some important clarity: what you're being advised is to not use <em>Raw, Owning Pointers</em>. It's perfectly fine to use Non-Owning Raw Pointers iff you know, as a fact, that you're not responsible for <code>delete</code>ing said memory; or Owning Smart Pointers iff you are responsible for said memory, but <code>delete</code>ing will be handled by the RAII principles of the smart pointer class.</p>\n\n<p>So let's consider what's happening in your code:</p>\n\n<ul>\n<li><code>A</code> represents ownership over a runtime-sized array of <code>double</code>s.</li>\n<li><code>a</code> represents ownership over a runtime-sized array of non-owning pointers to <code>double</code>s, all of which will come from <code>A</code>.</li>\n</ul>\n\n<p>Simply creating an array of objects is either best represented by <code>std::array</code>, for compile-time-sized arrays, or <code>std::vector</code>, for runtime-sized arrays. So we'll need the latter. This is easy to construct:</p>\n\n<pre><code>std::vector&lt;double&gt; A(4);//Array of 4 doubles.\n</code></pre>\n\n<p>Since <code>a</code> will contain non-owning pointers to <code>A</code>, which we know will outlive <code>a</code>, it's perfectly fine to use raw pointers inside this vector:</p>\n\n<pre><code>std::vector&lt;double*&gt; a(2);\n</code></pre>\n\n<p>Then, we assign into it, just like your code was already doing:</p>\n\n<pre><code>//Use size_t for sizes in C++. Always, always, always.\nfor (size_t q = 0, k = 0; k &lt; 2; k++){\n    a[k] = A + q;//Uh oh, this doesn't compile!\n    q += 2;\n}\n</code></pre>\n\n<p>Ah, hmm. <code>A</code> isn't a raw pointer anymore. Well, we'll need to use a member function of <code>std::vector</code> to get the raw pointer.</p>\n\n<pre><code>//Use size_t for sizes in C++. Always, always, always.\nfor (size_t q = 0, k = 0; k &lt; 2; k++){\n    a[k] = A.data() + q;//There we go.\n    q += 2;\n}\n</code></pre>\n\n<p>Finally, because our memory is RAII-managed, we don't need to <code>delete</code> this memory afterwards:</p>\n\n<pre><code>//No longer needed\n//delete[] A;\n//delete[] a;\n</code></pre>\n\n<p>So the final code will end up looking like this:</p>\n\n<pre><code>std::vector&lt;double&gt; A(4);\nstd::vector&lt;double*&gt; a(2);\nfor (size_t q = 0, k = 0; k &lt; 2; k++){\n    a[k] = A.data() + q;\n    q += 2;\n}\n</code></pre>\n\n<p>This code is nearly identical to the C-style code you wrote originally, and is much easier to read and maintain. The only difference is the small amount of overhead in <code>std::vector</code>, which the compiler can optimize away for the final program.</p>\n\n<p>If you want code which <em>literally</em> emulates the behavior of your original code, this would be the result. I don't recommend it, because it's more complicated than you need, and limits how the code can be used, but if you just want the direct port (or just want to see how Smart Pointers fit into this kind of problem), here it is:</p>\n\n<pre><code>std::unique_ptr&lt;double[]&gt; A = std::make_unique&lt;double[]&gt;(4);\nstd::unique_ptr&lt;double*[]&gt; a = std::make_unique&lt;double*[](2);\nfor (size_t q = 0, k = 0; k &lt; 2; k++){\n    a[k] = A.get() + q;\n    q += 2;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "is_accepted": false, "score": 1, "last_activity_date": 1533761913, "creation_date": 1533761913, "answer_id": 51755563, "question_id": 51754129, "link": "https://stackoverflow.com/questions/51754129/what-is-the-equivalent-of-cs-double-pointers-in-c/51755563#51755563", "title": "What is the equivalent of C&#39;s double pointers in C++?", "body": "<p>One of the primary uses of pointer-to-pointer in C is to return a pointer value:</p>\n\n<pre><code>error_t Allocate Object(Object ** ptr);\n</code></pre>\n\n<p>While the same will work in C++ it can be made somewhat more intuitive by making the function take a reference-to-pointer instead of pointer-to-pointer:</p>\n\n<pre><code>error_t AllocateObject(Object *&amp; ref);\n</code></pre>\n\n<p>This way the calling code can simply pass the pointer variable (instead of needing to use &amp; to take its address) and the function definition can simply assign to the parameter (rather than needing to dereference it with *).</p>\n"}, {"comments": [{"owner": {"reputation": 413, "user_id": 6415979, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b9e3987becca782d06105588adc1f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "RangerBob", "link": "https://stackoverflow.com/users/6415979/rangerbob"}, "edited": false, "score": 0, "creation_date": 1533825839, "post_id": 51763217, "comment_id": 90498469, "body": "Could I mix your solution with the one by @Xirema? I mean can I use a vector of iterator instead of std::vector&lt;double*&gt; a(2);? This would avoid me using smart pointers, isn&#39;t?"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 413, "user_id": 6415979, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b9e3987becca782d06105588adc1f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "RangerBob", "link": "https://stackoverflow.com/users/6415979/rangerbob"}, "edited": false, "score": 0, "creation_date": 1533826183, "post_id": 51763217, "comment_id": 90498721, "body": "Yes, if I understand what you&#39;re asking.  I used a vector because we have a compile-time constant size, so it&#39;s a better choice than a vector here.  But if your size might vary, then a vector would be suitable.  Note that if <code>A</code> is a vector, then you need to know when its references could be invalidated, just as you would with pointers (in fact, vector iterators are usually implemented as pointers)."}, {"owner": {"reputation": 413, "user_id": 6415979, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b9e3987becca782d06105588adc1f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "RangerBob", "link": "https://stackoverflow.com/users/6415979/rangerbob"}, "edited": false, "score": 0, "creation_date": 1533826644, "post_id": 51763217, "comment_id": 90499026, "body": "Thanks! What i also meant is can we simply remove the smart pointers in your example? Can we have your example without any raw/smarts pointers?"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 413, "user_id": 6415979, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b9e3987becca782d06105588adc1f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "RangerBob", "link": "https://stackoverflow.com/users/6415979/rangerbob"}, "edited": false, "score": 0, "creation_date": 1533827402, "post_id": 51763217, "comment_id": 90499574, "body": "Yes, you can (and I&#39;ve shown in comments a non-pointer version - you obviously need to change <code>-&gt;</code> to <code>.</code> and <code>*a</code> to <code>a</code>).  Take the code and experiment with it to see what you like and what doesn&#39;t work (and if you&#39;re not sure whether something that seems to work is good C++, come back to SO with a question; it will likely be a good question, with your new understanding!)"}], "tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": false, "score": 0, "last_activity_date": 1533806267, "creation_date": 1533806267, "answer_id": 51763217, "question_id": 51754129, "link": "https://stackoverflow.com/questions/51754129/what-is-the-equivalent-of-cs-double-pointers-in-c/51763217#51763217", "title": "What is the equivalent of C&#39;s double pointers in C++?", "body": "<p>The modern C++ equivalent of your example code would use smart pointers for ownership, and iterators to access array elements:</p>\n\n<pre><code>#include &lt;array&gt;\n#include &lt;memory&gt;\n\nint main()\n{\n    // Define our types:\n    using A_array = std::array&lt;double, 4&gt;;\n    using A_iterator = A_array::iterator;\n\n    // Make smart pointers to manage ownership for us:\n    auto const A = std::make_unique&lt;A_array&gt;();\n    auto const a = std::make_unique&lt;std::array&lt;A_iterator, 2&gt;&gt;();\n\n    // Normally, we'd just put these in automatic storage, as\n    // they are small, and don't outlive the function scope:\n    // A_array A;\n    // std::array&lt;A_iterator, 2&gt; a;)\n\n    {\n        // Populate a with iterators to A's elements\n        auto target = A-&gt;begin();\n        for (auto&amp; element: *a) {\n            element = target;\n            target += 2;\n        }\n    }\n\n    // No need for delete[] at end of function or at any other\n    // return statement.\n}\n</code></pre>\n"}], "owner": {"reputation": 413, "user_id": 6415979, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b9e3987becca782d06105588adc1f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "RangerBob", "link": "https://stackoverflow.com/users/6415979/rangerbob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 1, "closed_date": 1533807911, "accepted_answer_id": 51754354, "answer_count": 3, "score": -4, "last_activity_date": 1533806267, "creation_date": 1533755856, "question_id": 51754129, "link": "https://stackoverflow.com/questions/51754129/what-is-the-equivalent-of-cs-double-pointers-in-c", "closed_reason": "Needs details or clarity", "title": "What is the equivalent of C&#39;s double pointers in C++?", "body": "<p>I am a C/C++ newbie, so sorry if my question seems straightforward. </p>\n\n<p>It has always been claimed that pointers in C++ are useless. See for example the answer from Konrad Rudolph here <a href=\"https://softwareengineering.stackexchange.com/questions/56935/why-are-pointers-not-recommended-when-coding-with-c\">https://softwareengineering.stackexchange.com/questions/56935/why-are-pointers-not-recommended-when-coding-with-c</a></p>\n\n<p>Below I have an example for which I am wondering how can I replace the C code by a C++ code without using any pointers:</p>\n\n<pre><code>  double *A;                              \n  double **a;\n\n  A=new(std::nothrow) double[4];\n\n  a=new(std::nothrow) double*[2];\n\nfor (unsigned int q=0, k=0; k &lt; 2; k++)\n    {\n        a[k]=A + q;\n        q+=2;\n    }\n\n  delete[] A;\n delete[] a;\n</code></pre>\n\n<p>The programmer codes up as above because he/she needs the pointer <code>a</code> to point to the pointer <code>A</code> so that when modifying the variable to which <code>A</code> points, he/she does not to modify <code>a</code>.</p>\n\n<p>Sometimes, the programmer does a <code>for loop</code> with a[k] from k={0,1,2,3}, and sometimes he does a double <code>for loop</code> a[i][j] from i,j={0,1}.</p>\n\n<p>How can I replace this by a C++ code without using pointers? </p>\n"}, {"tags": ["c++", "windows", "windows-10", "h.264", "ms-media-foundation"], "comments": [{"owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "edited": false, "score": 0, "creation_date": 1533808960, "post_id": 51754065, "comment_id": 90486903, "body": "Can you maybe post the code in github or some place? Also, when using the <code>IMFSinkWriterCallback</code> does the <code>IMFSinkWriter::Finalize</code> exit with <code>S_OK</code> ?"}, {"owner": {"reputation": 15641, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "reply_to_user": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "edited": false, "score": 0, "creation_date": 1533823096, "post_id": 51754065, "comment_id": 90496602, "body": "@RudolfsBundulis That\u2019s work for hire, I\u2019ll ask the client but I don\u2019t think they gonna allow it.  Yes, when passing IMFSinkWriterCallback, IMFSinkWriter::Finalize returns <code>S_OK</code> and it\u2019s very fast. That\u2019s how I\u2019ve implemented a workaround: I pass callbacks when constructing the writer, when finished I call Finalize, wait for some time for IMFSinkWriterCallback::OnFinalize to arrive (using a Win32 event), if it doesn\u2019t happen I proceed anyway, Release() the writer COM interface, then call Shutdown() and Release() on my IMFMediaSink object."}], "answers": [{"comments": [{"owner": {"reputation": 15641, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "edited": false, "score": 0, "creation_date": 1534099617, "post_id": 51811724, "comment_id": 90578631, "body": "Yes I\u2019ve also implemented custom stream sink. No I\u2019m using framework-provided writer, created by <code>MFCreateSinkWriterFromMediaSink</code> API.  I can\u2019t remember where I saw that but I\u2019m under the impression that I must first shutdown the writer only then the sink. I have no problem shutting down my sink. It\u2019s the writer that has this problem."}, {"owner": {"reputation": 15641, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "edited": false, "score": 0, "creation_date": 1534100307, "post_id": 51811724, "comment_id": 90578798, "body": "Remarks in the <code>MFCreateSinkWriterFromMediaSink</code> article say \u201cThe sink writer does not shut down the media sink\u2026 Release the sink writer before calling Shutdown on the media sink\u201d. And the documentation for <code>IMFSinkWriter::Finalize</code> says \u201cIf you do not call Finalize, the output from the media sink might be incomplete or invalid\u201d.  Correct me if I\u2019m wrong, but from these two articles, the correct shutdown sequence (implying I want complete and valid video stream) must be the following: <code>writer-&gt;Finalize(); writer-&gt;Release(); sink-&gt;Shutdown();</code> It\u2019s the first of them that hangs."}, {"owner": {"reputation": 15641, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "edited": false, "score": 0, "creation_date": 1534439421, "post_id": 51811724, "comment_id": 90715978, "body": "\u201cDo you handle this message?\u201d yes I\u2019m getting the message but I\u2019m not doing anything special, just check for shutdown and return S_OK. Should I do more? \u201cdo you release interfaces correctly?\u201d I do, but the problem happens earlier than that, before releasing the sink. \u201cassuming you implements IMFMediaTypeHandler\u201d I do not, I\u2019m using a handler created by MFCreateSimpleTypeHandler. But I\u2019m not sure the problem is with SPS/PPS, that\u2019s an idea based on my previous experience with MF."}, {"owner": {"reputation": 15641, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "edited": false, "score": 0, "creation_date": 1534439437, "post_id": 51811724, "comment_id": 90715985, "body": "In my test app I have one more sink writer downstream, created by another API, <code>MFCreateSinkWriterFromURL</code>. That second writer doesn\u2019t encode anything, it writes .mp4 files from already encoded h264 MF samples. That downstream writer finalizes OK and produces valid video files. It\u2019s the intermediate sink writer that hangs on Finalize()."}, {"owner": {"reputation": 1257, "user_id": 5110855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93f29bdd015d8a9b204efd66fb798c72?s=128&d=identicon&r=PG&f=1", "display_name": "mofo77", "link": "https://stackoverflow.com/users/5110855/mofo77"}, "reply_to_user": {"reputation": 15641, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "edited": false, "score": 0, "creation_date": 1534489444, "post_id": 51811724, "comment_id": 90730898, "body": "It&#39;s not clear how your app works. Could you show the complete topology with a drawing. In the finalize method, your sink writer should writes all output sample, if any. If you can produce out sample, writes them, if not nothing to do."}, {"owner": {"reputation": 15641, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "edited": false, "score": 0, "creation_date": 1534518382, "post_id": 51811724, "comment_id": 90747409, "body": "My library captures RGB pics from external API. Uses sink writer (with automatically constructed MFTs) to resize &amp; and encode into h264 using GPU hardware. Uses custom media sink (with a custom stream sink) to grab h264 samples. My test client for the library receives h264 samples, uses another sink writer to produce mp4 file (this one without any custom sinks). The library\u2019s for streaming, this test app is only to debug &amp; test this capture/encode library. When I call finalize method on the writer, the only call my custom sink received is end segment marker."}, {"owner": {"reputation": 1257, "user_id": 5110855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93f29bdd015d8a9b204efd66fb798c72?s=128&d=identicon&r=PG&f=1", "display_name": "mofo77", "link": "https://stackoverflow.com/users/5110855/mofo77"}, "reply_to_user": {"reputation": 15641, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "edited": false, "score": 0, "creation_date": 1534526590, "post_id": 51811724, "comment_id": 90751554, "body": "With your explanation, i don&#39;t understand the dataflow from begin to end. Could you make a drawing of the topology and the dataflow ? I don&#39;t understand how all the component are connected, and how the dataflow is."}, {"owner": {"reputation": 1257, "user_id": 5110855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93f29bdd015d8a9b204efd66fb798c72?s=128&d=identicon&r=PG&f=1", "display_name": "mofo77", "link": "https://stackoverflow.com/users/5110855/mofo77"}, "reply_to_user": {"reputation": 15641, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "edited": false, "score": 0, "creation_date": 1534527024, "post_id": 51811724, "comment_id": 90751737, "body": "You say you have an the intermediate sink writer (the custom one). you can&#39;t have a custom sink writer between a MFT and another sink writer. It should be a MFT..."}, {"owner": {"reputation": 15641, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "edited": false, "score": 0, "creation_date": 1534529470, "post_id": 51811724, "comment_id": 90752837, "body": "I don\u2019t have topology, I don\u2019t have session, and I don\u2019t have custom MFTs.  Data flow is custom API -&gt; first sink writer (library calls MF-implemented <code>IMFSinkWriter::WriteSample</code> on the first writer, created by <code>MFCreateSinkWriterFromMediaSink</code>) -&gt; custom sink (MF calls my <code>IMFStreamSink::ProcessSample</code>) -&gt; second sync writer (client app calls <code>IMFSinkWriter::WriteSample</code> on the second writer, created by <code>MFCreateSinkWriterFromURL</code>) -&gt; mp4 file (second writer writes samples without my code involved anywhere)."}, {"owner": {"reputation": 15641, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "edited": false, "score": 0, "creation_date": 1534529791, "post_id": 51811724, "comment_id": 90752979, "body": "Obviously, shutdown needs to work in the same order: first shutdown writer #1, then custom sink, then writer #2. It\u2019s the first shutdown step that fails with this issue, before trying to shutdown the custom sink."}, {"owner": {"reputation": 1257, "user_id": 5110855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93f29bdd015d8a9b204efd66fb798c72?s=128&d=identicon&r=PG&f=1", "display_name": "mofo77", "link": "https://stackoverflow.com/users/5110855/mofo77"}, "reply_to_user": {"reputation": 15641, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "edited": false, "score": 0, "creation_date": 1534533580, "post_id": 51811724, "comment_id": 90754447, "body": "When i talk about topology and dataflow, it is just to visualize how your app behaves. Topology is just a word to represent where MediaFoundation Object are. I will show you a drawing in EDIT3, you will tell me if it is like your app is. Like i said, i&#39;l not sure, even after your explanation."}], "tags": [], "owner": {"reputation": 1257, "user_id": 5110855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93f29bdd015d8a9b204efd66fb798c72?s=128&d=identicon&r=PG&f=1", "display_name": "mofo77", "link": "https://stackoverflow.com/users/5110855/mofo77"}, "is_accepted": false, "score": 0, "last_activity_date": 1534538927, "last_edit_date": 1534538927, "creation_date": 1534098823, "answer_id": 51811724, "question_id": 51754065, "link": "https://stackoverflow.com/questions/51754065/video-recording-hangs-on-imfsinkwriter-finalize/51811724#51811724", "title": "Video Recording Hangs on IMFSinkWriter-&gt;Finalize", "body": "<p>You\u2019ve implemented custom IMFMediaSink, so i suppose you 've also implemented IMFStreamSink.</p>\n\n<p>Doing this in the usual way with Mediafoundation, you have circular COM reference between IMFMediaSink and IMFStreamSink. That's why the Shutdown method from IMFMediaSink interface exists.</p>\n\n<p>If a program that uses your custom MediaSink does not call Shutdown at the right place, there will be memory leaks.</p>\n\n<p>From your IMFSinkWriterCallback problem, we don't have enough information to find where the problem is.</p>\n\n<p>Also it is not clear about \"custom IMFMediaSink\" and \"IMFSinkWriter\". Are you also implementing a IMFSinkWriter...</p>\n\n<p><strong>EDIT1</strong></p>\n\n<p>Just two things :</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/mfreadwrite/nf-mfreadwrite-mfcreatesinkwriterfrommediasink\" rel=\"nofollow noreferrer\">MFCreateSinkWriterFromMediaSink</a></p>\n\n<p>Call CoInitialize(Ex) and MFStartup before calling this function.</p>\n\n<p>When you are done using the media sink, call the media sink's IMFMediaSink::Shutdown method. (The sink writer does not shut down the media sink.) Release the sink writer before calling Shutdown on the media sink.</p>\n\n<p>do you release interfaces correctly ?</p>\n\n<p><a href=\"https://docs.microsoft.com/fr-fr/windows/desktop/api/mfreadwrite/nf-mfreadwrite-imfsinkwriter-finalize\" rel=\"nofollow noreferrer\">IMFSinkWriter::Finalize</a></p>\n\n<p>Internally, this method calls IMFStreamSink::PlaceMarker to place end-of-segment markers for each stream on the media sink.</p>\n\n<p>Do you handle this message (MFSTREAMSINK_MARKER_ENDOFSEGMENT) ?</p>\n\n<p>We don't know how you handle CriticalSection/Event/CircularReference, so it's hard to found the problem.</p>\n\n<p><strong>EDIT2</strong></p>\n\n<blockquote>\n  <p>Is there a way to instruct the h264 encoder to output SPS/PPS somewhere?</p>\n</blockquote>\n\n<p>Normally, for h264 video format, you need to get the attributes MF_MT_MPEG_SEQUENCE_HEADER (BLOB type) when SetCurrentMediaType is called on your IMFStreamSink (assuming you implements IMFMediaTypeHandler).</p>\n\n<p><strong>EDIT3</strong></p>\n\n<p>Could you provide the real one (this is how i think the app should be) :</p>\n\n<p><a href=\"https://i.stack.imgur.com/ny8qY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ny8qY.png\" alt=\"topology and dataflow\"></a></p>\n\n<p>I don't remember if your custom sink creates a mp4 file. If it is, in the IMFSinkWriter::Finalize, you have to generate ftpy/moov atom.</p>\n\n<p><strong>EDIT4</strong></p>\n\n<p>Also you can read this : <a href=\"https://stackoverflow.com/questions/33767688/video-recording-hangs-on-imfsinkwriter-finalize/33878513#33878513\">Video Recording Hangs on IMFSinkWriter->Finalize();\n</a></p>\n\n<p>With no source code, this is the only answer i can give.</p>\n"}], "owner": {"reputation": 15641, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 495, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534538927, "creation_date": 1533755579, "last_edit_date": 1534126258, "question_id": 51754065, "link": "https://stackoverflow.com/questions/51754065/video-recording-hangs-on-imfsinkwriter-finalize", "title": "Video Recording Hangs on IMFSinkWriter-&gt;Finalize", "body": "<p>I\u2019ve implemented custom IMFMediaSink for use with sink writer. Works OK, receives h264 video samples. I don\u2019t have any container, I\u2019m consuming raw h264 video samples. I have not implemented custom writer, I'm using <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/mfreadwrite/nf-mfreadwrite-mfcreatesinkwriterfrommediasink\" rel=\"nofollow noreferrer\">MFCreateSinkWriterFromMediaSink</a> API to wrap my custom media sink into a framework-provided writer.</p>\n\n<p>I\u2019m unable to implement graceful shutdown, <code>IMFSinkWriter::Finalize()</code> never returns. When I implemented <code>IMFSinkWriterCallback</code>, <code>IMFSinkWriter::Finalize()</code> returns immediately but my <code>IMFSinkWriterCallback::OnFinalize</code> was never called.</p>\n\n<p>The problem reproduces in 100% tests with both nvenc and MS software encoder.</p>\n\n<p>Writer attributes: </p>\n\n<pre><code>MF_LOW_LATENCY = TRUE\nMF_READWRITE_ENABLE_HARDWARE_TRANSFORMS = TRUE (1)\nMF_READWRITE_DISABLE_CONVERTERS = FALSE (2)\nMF_SINK_WRITER_DISABLE_THROTTLING = TRUE\nMF_SINK_WRITER_D3D_MANAGER\nMF_SINK_WRITER_ASYNC_CALLBACK\n</code></pre>\n\n<p>(1) Tried both, same result</p>\n\n<p>(2) Need the converters because nvenc only supports YUV and I have RGB textures on input.</p>\n\n<p>Output media type (it\u2019s fixed, I\u2019m using the built-in handler created by <code>MFCreateSimpleTypeHandler</code> API).</p>\n\n<pre><code>MF_MT_MAJOR_TYPE = MFMediaType_Video\nMF_MT_SUBTYPE = MFVideoFormat_H264\nMF_MT_INTERLACE_MODE = MFVideoInterlace_Progressive\nMF_MT_AVG_BITRATE = 40*1000*1000\nMF_MT_FRAME_SIZE = { 3840, 2160 }\nMF_MT_FRAME_RATE = { 60, 1 }\nMF_MT_PIXEL_ASPECT_RATIO = { 1, 1 }\n</code></pre>\n\n<p>Input media type:</p>\n\n<pre><code>MF_MT_MAJOR_TYPE = MFMediaType_Video\nMF_MT_SUBTYPE = MFVideoFormat_RGB32\nMF_MT_INTERLACE_MODE = MFVideoInterlace_Progressive\nMF_MT_FRAME_SIZE = { 3840, 2160 }\nMF_MT_FRAME_RATE = { 60, 1 }\nMF_MT_PIXEL_ASPECT_RATIO = { 1, 1 }\n</code></pre>\n\n<p>When not using IMFSinkWriterCallback, here\u2019s a call stack at the time of hang:</p>\n\n<pre><code>ntdll.dll!_NtWaitForSingleObject@12 ()\nKernelBase.dll!WaitForSingleObjectEx()\nmfreadwrite.dll!CMFSinkWriter::InternalFinalize(void)\nmfreadwrite.dll!CMFSinkWriter::Finalize(void)\n</code></pre>\n\n<p>MFTrace doesn\u2019t have anything related to finalize even with <code>-k All</code>:</p>\n\n<pre><code>13700,3C60 19:01:25.79566 CMFTransformDetours::ProcessOutput @02EA6E3C failed hr=0xC00D6D72 MF_E_TRANSFORM_NEED_MORE_INPUT\n13700,2A98 19:01:25.80250 CMFTransformDetours::ProcessOutput @1A6CEF38 Stream ID 0, Sample @1C244F30, Time 1216ms, Duration 16ms, Buffers 1, Size 12441600B, MFSampleExtension_CleanPoint=1;MFSampleExtension_Interlaced=0\n13700,2098 19:01:25.80254 CMFTransformDetours::ProcessInput @02EA6E3C Stream ID 0, Sample @1C244F30, Time 1216ms, Duration 16ms, Buffers 1, Size 12441600B, MFSampleExtension_CleanPoint=1;MFSampleExtension_Interlaced=0\n13700,2A98 19:01:25.80256 CMFTransformDetours::ProcessOutput @1A6CEF38 failed hr=0xC00D6D72 MF_E_TRANSFORM_NEED_MORE_INPUT\n13700,2A98 19:01:25.80266 CMFTransformDetours::ProcessMessage @1A6CEF38 Message type=0x00000001 MFT_MESSAGE_COMMAND_DRAIN, param=00000000\n13700,2A98 19:01:25.80267 CMFTransformDetours::ProcessOutput @1A6CEF38 failed hr=0xC00D6D72 MF_E_TRANSFORM_NEED_MORE_INPUT\n13700,2098 19:01:25.81669 CMFTransformDetours::ProcessOutput @02EA6E3C Stream ID 0, Sample @1FB68CF8, Time 1216ms, Duration 16ms, Buffers 1, Size 680B, {2B5D5457-5547-4F07-B8C8-B4A3A9A1DAAC}=1;{73A954D4-09E2-4861-BEFC-94BD97C08E6E}=12166667 (0,12166667);{9154733F-E1BD-41BF-81D3-FCD918F71332}=65535;{973704E6-CD14-483C-8F20-C9FC0928BAD5}=1;MFSampleExtension_CleanPoint=0;{B2EFE478-F979-4C66-B95E-EE2B82C82F36}=16 (0,16)\n13700,82C 19:01:25.81674 CMFTransformDetours::ProcessOutput @02EA6E3C failed hr=0xC00D6D72 MF_E_TRANSFORM_NEED_MORE_INPUT\n13700,82C 19:01:25.81674 CMFTransformDetours::ProcessMessage @02EA6E3C Message type=0x00000001 MFT_MESSAGE_COMMAND_DRAIN, param=00000000\n13700,82C 19:01:25.81674 CMFTransformDetours::ProcessOutput @02EA6E3C failed hr=0xC00D6D72 MF_E_TRANSFORM_NEED_MORE_INPUT\n13700,1F54 19:01:27.24237 CKernel32ExportDetours::OutputDebugStringA @ D3D11 WARNING: Process is terminating. Using simple reporting. Please call ReportLiveObjects() at runtime for standard reporting. [ STATE_CREATION WARNING #0: UNKNOWN] \n13700,1F54 19:01:27.24255 CKernel32ExportDetours::OutputDebugStringA @ D3D11 WARNING: Live Producer at 0x0311D91C, Refcount: 13. [ STATE_CREATION WARNING #0: UNKNOWN] \n</code></pre>\n\n<p>Warnings about live D3D resources are expected as I terminated the process after the hang.</p>\n\n<p>Any ideas what\u2019s going on? I think the writer probably waits for these SPS/PPS magic blobs to arrive but it never happens. Is there a way to instruct the h264 encoder to output SPS/PPS somewhere?</p>\n"}, {"tags": ["c++", "c++14"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1533755213, "post_id": 51753955, "comment_id": 90467677, "body": "C++17 allows to use <code>typename</code> or <code>class</code> there."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 3, "creation_date": 1533755508, "post_id": 51753955, "comment_id": 90467800, "body": "An example of something which SHOULD have been a template template parameter is a standard allocator. It would normally be a template itself, instantiated with a specific element being allocated (which for many standard containers is not the data type). However, the lack of support for template template parameters was circumvented with a <code>rebind</code> member of a concrete type allocator."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1533755992, "post_id": 51753955, "comment_id": 90467993, "body": "When you want type, you might even use both method (template template parameters + its parameters vs type). But sometime you might really want only the <code>template template parameters</code> (<code>void foo(C&lt;int&gt;)</code> or <code>bar&lt;std::vector&gt;()</code>)."}], "owner": {"reputation": 1476, "user_id": 9309959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8b6ed5480d92d983b0e87bc4af448?s=128&d=identicon&r=PG", "display_name": "Krystian S", "link": "https://stackoverflow.com/users/9309959/krystian-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1533755172, "answer_count": 0, "score": 0, "last_activity_date": 1533755085, "creation_date": 1533755085, "question_id": 51753955, "link": "https://stackoverflow.com/questions/51753955/in-what-case-would-template-template-parameters-be-useful", "closed_reason": "Duplicate", "title": "In what case would template template parameters be useful?", "body": "<p>I don't see a case where template template parameters would ever be useful, when they could be simply replaced with one template parameter that would work just as well. Referring to my example:</p>\n\n<pre><code>template&lt;template&lt;typename, typename...&gt; typename Cont, typename T, typename... Args&gt;\nvoid Foo(Cont&lt;T, Args...&gt; container)\n{\n  for (auto i : container)\n    std::cout &lt;&lt; i &lt;&lt; \" \";\n  std::cout &lt;&lt; std::endl;\n}\n\ntemplate&lt;typename T&gt;\nvoid Bar(T container)\n{\n  for (auto i : container)\n    std::cout &lt;&lt; i &lt;&lt; \" \";\n  std::cout &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>These will function identically, and <code>Bar</code> will work on any container defining an iterator (allocator not needed). <code>Foo</code> however, does the same thing, but is a lot more confusing to write (and more confusing to understand). I don't know if I missed the point on template template parameters, but they really seem useless to me as a single template parameter will deduce the type too, albeit without the other parameters.</p>\n\n<p>Also - should I be using <code>typename</code> or <code>class</code> for the template template parameter? </p>\n\n<p><code>template&lt;typename&gt; class T</code> </p>\n\n<p>or </p>\n\n<p><code>template&lt;typename&gt; typename T</code> </p>\n"}, {"tags": ["c++", "performance", "optimization", "compiler-construction", "llvm"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2512323"}, "edited": false, "score": 0, "creation_date": 1533758012, "post_id": 51754477, "comment_id": 90468856, "body": "There is also convenient <a href=\"http://llvm.org/doxygen/IRBuilder_8h_source.html#l00307\" rel=\"nofollow noreferrer\"><code>getInt32</code></a> method in the <code>IRBuilder</code> doing exactly this"}, {"owner": {"reputation": 69, "user_id": 6216599, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-R8X_JJ2676k/AAAAAAAAAAI/AAAAAAAANUY/lVRSAyDZy5k/photo.jpg?sz=128", "display_name": "Tasmia Rahman", "link": "https://stackoverflow.com/users/6216599/tasmia-rahman"}, "edited": false, "score": 0, "creation_date": 1533831676, "post_id": 51754477, "comment_id": 90502349, "body": "Used the IRBuilder and it worked. Thank you so much. I want to learn the context thing though as I did not get it. How to get the value of Ctx and what does context mean? Again, thanks to both of you"}, {"owner": {"reputation": 111, "user_id": 7365834, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-K6jDYcJ8-ug/AAAAAAAAAAI/AAAAAAAAAKg/nK1-l1gaNtA/photo.jpg?sz=128", "display_name": "Anahit Hayrapetyan", "link": "https://stackoverflow.com/users/7365834/anahit-hayrapetyan"}, "edited": false, "score": 0, "creation_date": 1533841128, "post_id": 51754477, "comment_id": 90506861, "body": "You can get Contect from Function, BasicBlock or Module with getContext() function. As for the explanation of Context check out llvm documentation <a href=\"http://llvm.org/doxygen/classllvm_1_1LLVMContext.html\" rel=\"nofollow noreferrer\">llvm.org/doxygen/classllvm_1_1LLVMContext.html</a>"}], "tags": [], "owner": {"reputation": 111, "user_id": 7365834, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-K6jDYcJ8-ug/AAAAAAAAAAI/AAAAAAAAAKg/nK1-l1gaNtA/photo.jpg?sz=128", "display_name": "Anahit Hayrapetyan", "link": "https://stackoverflow.com/users/7365834/anahit-hayrapetyan"}, "is_accepted": false, "score": 4, "last_activity_date": 1533757340, "creation_date": 1533757340, "answer_id": 51754477, "question_id": 51753888, "link": "https://stackoverflow.com/questions/51753888/convert-constant-integer-to-value-llvm/51754477#51754477", "title": "Convert Constant Integer to Value* LLVM", "body": "<p>You can use llvm::Constant for the *val, llvm Constant inherits from Value. One way to create a Constant for 0 is</p>\n\n<pre><code>llvm::ConstantInt::get(llvm::Type::getInt64Ty(Ctx), 0)\n</code></pre>\n\n<p>Where Ctx is context of a function you'r inserting StoreInst to</p>\n"}], "owner": {"reputation": 69, "user_id": 6216599, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-R8X_JJ2676k/AAAAAAAAAAI/AAAAAAAANUY/lVRSAyDZy5k/photo.jpg?sz=128", "display_name": "Tasmia Rahman", "link": "https://stackoverflow.com/users/6216599/tasmia-rahman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1717, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1533757340, "creation_date": 1533754773, "last_edit_date": 1533755174, "question_id": 51753888, "link": "https://stackoverflow.com/questions/51753888/convert-constant-integer-to-value-llvm", "title": "Convert Constant Integer to Value* LLVM", "body": "<p>I am trying to create an IR instruction </p>\n\n<pre><code>store i32 0, i32* %3, align 4\n</code></pre>\n\n<p>I am using the method </p>\n\n<pre><code>StoreInst *CreateAlignedStore(Value *Val, Value *Ptr, unsigned Align, bool isVolatile = false)\n</code></pre>\n\n<p>to create the instruction. Since the first argument takes a <code>Value*</code>, somehow I need to convert <code>0</code> to <code>Value*</code>.  </p>\n\n<p>Can you help me with that?</p>\n"}, {"tags": ["c++", "if-statement", "c++14"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 7, "creation_date": 1533754650, "post_id": 51753851, "comment_id": 90467438, "body": "Where do you set <code>Bob</code> or <code>Emily</code> to anything?"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 2, "creation_date": 1533754715, "post_id": 51753851, "comment_id": 90467467, "body": "Might want to use a debugger next time."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1533754863, "post_id": 51753851, "comment_id": 90467532, "body": "Change <code>string Bob;</code> to <code>string Bob{&quot;Bob&quot;};</code> and see what happens."}, {"owner": {"reputation": 126, "user_id": 10115558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3pKmx.jpg?s=128&g=1", "display_name": "Marijan", "link": "https://stackoverflow.com/users/10115558/marijan"}, "edited": false, "score": 1, "creation_date": 1533755038, "post_id": 51753851, "comment_id": 90467609, "body": "Did you by any chance mean to compare q to a literal string &quot;Bob&quot; and &quot;Emily&quot;? Your code example suggests that could be the case, in which case you should write them as string literals (e.g. &quot;Bob&quot;). The way you have them, they are empty string variables that have not yet been assigned any value."}, {"owner": {"reputation": 1, "user_id": 10199527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75071e82f7eeba6c718591066de7e336?s=128&d=identicon&r=PG&f=1", "display_name": "Zii", "link": "https://stackoverflow.com/users/10199527/zii"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1533755602, "post_id": 51753851, "comment_id": 90467839, "body": "@NathanOliver &quot;if (q == Emily)&quot; line? Doesn&#39;t that make it so when the user inputs &quot;Emily&quot; it will show the &quot;Hi friend&quot; message instead?"}, {"owner": {"reputation": 1, "user_id": 10199527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75071e82f7eeba6c718591066de7e336?s=128&d=identicon&r=PG&f=1", "display_name": "Zii", "link": "https://stackoverflow.com/users/10199527/zii"}, "reply_to_user": {"reputation": 126, "user_id": 10115558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3pKmx.jpg?s=128&g=1", "display_name": "Marijan", "link": "https://stackoverflow.com/users/10115558/marijan"}, "edited": false, "score": 0, "creation_date": 1533755611, "post_id": 51753851, "comment_id": 90467842, "body": "@Marijan you mean I need to put them in &quot;double quotes&quot; to make them literal?"}, {"owner": {"reputation": 1, "user_id": 10199527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75071e82f7eeba6c718591066de7e336?s=128&d=identicon&r=PG&f=1", "display_name": "Zii", "link": "https://stackoverflow.com/users/10199527/zii"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1533755623, "post_id": 51753851, "comment_id": 90467845, "body": "@drescherjm I&#39;ll give that a shot! Thanks"}, {"owner": {"reputation": 1, "user_id": 10199527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75071e82f7eeba6c718591066de7e336?s=128&d=identicon&r=PG&f=1", "display_name": "Zii", "link": "https://stackoverflow.com/users/10199527/zii"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1533755634, "post_id": 51753851, "comment_id": 90467848, "body": "@Rakete1111 I started C++ yesterday, what is a debugger? Doesn&#39;t Visual studio give you warnings and errors if you make a mistake?"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1533755697, "post_id": 51753851, "comment_id": 90467874, "body": "@Zii <a href=\"https://stackoverflow.com/questions/25385173/what-is-a-debugger-and-how-can-it-help-me-diagnose-problems\">See this Q</a>. Debuggers are great to find bugs, because they allow to go through your program step by step and inspect variables in real-time :) Yes they do, but there are many different tools to help programmers not make mistakes."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 3, "creation_date": 1533757242, "post_id": 51753851, "comment_id": 90468512, "body": "Re, &quot;Doesn&#39;t Visual studio give you warnings and errors if you make a mistake?&quot; Mistakes can be made on many different levels. A tool like Visual Studio can find and highlight the simplest mistakes before you ever try to run the program. A <i><a href=\"https://en.wikipedia.org/wiki/Debugger\" rel=\"nofollow noreferrer\">debugger</a></i> can help you to find deeper mistakes that only become apparent when you actually do run the program, and it doesn&#39;t do what you expected it to do."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1533757370, "post_id": 51753851, "comment_id": 90468573, "body": "P.S.: Visual Studio has a debugger built-in, but I can&#39;t tell you how to use it."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1533758217, "post_id": 51753851, "comment_id": 90468959, "body": "<b><i>Doesn&#39;t Visual studio give you warnings and errors if you make a mistake?</i></b> Visual Studio would have had no idea you made a mistake for this case. Your program is syntactically correct. Although it does not do what you expect."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1533758246, "post_id": 51753851, "comment_id": 90468970, "body": "I <i>think</i> you start debugging pressing F5. Not 100% sure, only rarely using MSVC... At least, it is one of the Fn keys."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1533758488, "post_id": 51753851, "comment_id": 90469086, "body": "Typical (potential) errors IDE in general warn about are comparing signed and unsigned integrals, bad format specifiers for printf (GCC does, MSVC: not sure), possible operator precedence issues (A &amp; B == C - recommending to set parentheses), possible unintended assignment (<code>if(x = y)</code> - <code>if((x = y))</code> prevents the warning, with the additional, normally obsolete parentheses you tell the compiler assignment and comparison of result were intentional), ..."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1533758488, "post_id": 51753851, "comment_id": 90469087, "body": "<b><i>I think you start debugging pressing F5</i></b>  Make sure you set a breakpoint at the beginning of your code if you do that otherwise your code will likely execute past the point where you want to debug."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1533758752, "post_id": 51753851, "comment_id": 90469201, "body": "@drescherjm Good point - got that natural to me during the years that I forget to hint beginners to..."}], "answers": [{"comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1533755342, "post_id": 51753932, "comment_id": 90467725, "body": "&quot;<i>I desperately assigned them inverse!</i>&quot; Did you, by any chance, mean, that you &quot;<i>Purposefully assigned them in the opposite manner</i>&quot;? I had to re-read the sentence multiple times, to grasp what you had in mind."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1533755543, "post_id": 51753932, "comment_id": 90467816, "body": "@AlgirdasPreid\u017eius Haha, discovered that myself already - bad luck that someone spotted as well before I could correct it... Sorry, English is not my mother tongue, so, although it&#39;s (hopefully???) not <i>that</i> bad, sometimes..."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1533755710, "post_id": 51753932, "comment_id": 90467881, "body": "Your English is fine."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1533755842, "post_id": 51753932, "comment_id": 90467941, "body": "@Aconcagua Your English is fine. It&#39;s just that one bit, that was confusing to me, and I decided, that I might as well share it. Note: English isn&#39;t a native language to a majority of speakers (for example, I am not a native speaker either)."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1533757984, "post_id": 51753932, "comment_id": 90468845, "body": "Thanks, guys... @AlgirdasPreid\u017eius Imagined so already. However could not find out <i>which</i> language uses z with trema. Would be curious now..."}], "tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 1, "last_activity_date": 1533755369, "last_edit_date": 1533755369, "creation_date": 1533755000, "answer_id": 51753932, "question_id": 51753851, "link": "https://stackoverflow.com/questions/51753851/why-are-my-if-statements-not-working-with-strings-in-c/51753932#51753932", "title": "Why are my if statements not working with strings in c++?", "body": "<p><code>std::string</code> comes with its own <code>operator==</code>, comparing the string's <em>contents</em>.</p>\n\n<pre><code>string Bob;\nstring Emily;\n</code></pre>\n\n<p>Well, now you have created two strings, both using the default constructor, and so both are <em>empty</em> strings (i. e. they both would compare equal to <code>\"\"</code>).</p>\n\n<p>You need to assign them a value:</p>\n\n<pre><code>string Bob(\"Emily\");\nstring Emily(\"Bob\");\n</code></pre>\n\n<p>I deliberately assigned them inverse! Try this piece of code and you'll discover yourself that it is the content that is relevant for comparison, <em>not</em> the variable's name...</p>\n"}, {"comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 3, "creation_date": 1533755249, "post_id": 51753956, "comment_id": 90467689, "body": "This is probably what the OP actually wanted to do."}], "tags": [], "owner": {"reputation": 908, "user_id": 3292279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VX393.jpg?s=128&g=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/3292279/alex-johnson"}, "is_accepted": false, "score": 4, "last_activity_date": 1533755725, "last_edit_date": 1533755725, "creation_date": 1533755091, "answer_id": 51753956, "question_id": 51753851, "link": "https://stackoverflow.com/questions/51753851/why-are-my-if-statements-not-working-with-strings-in-c/51753956#51753956", "title": "Why are my if statements not working with strings in c++?", "body": "<p>Why not just compare directly to strings?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nint main()\n{\n  std::string q;\n  std::string w;\n  std::cout &lt;&lt; \"Who is this? \";\n  std::cin &gt;&gt; q;\n  if (q == \"Bob\") // note the quotation marks around Bob\n  {\n      std::cout &lt;&lt; \"Hey there bro. \" &lt;&lt; std::endl;\n  }\n  else if (q == \"Emily\") // note the quotation marks around Emily\n  {\n      std::cout &lt;&lt; \"Hi friend :) \" &lt;&lt; std::endl;\n  }\n  else\n  {\n      std::cout &lt;&lt; \"Oh hey \" &lt;&lt; q &lt;&lt; \", how are you? \";\n      std::cin &gt;&gt; w;\n      std::cout &lt;&lt; \"Hey, that's \" &lt;&lt; w &lt;&lt; std::endl;\n  }\n  return 0;\n}\n</code></pre>\n\n<p>Also, you should avoid <code>using namespace std</code> because it leads to <a href=\"https://stackoverflow.com/questions/22903542/what-is-namespace-pollution\">namespace pollution</a>. Instead, you can just put std:: in front of <code>string</code>, <code>cin</code>, <code>cout</code>, and <code>endl</code> as I've done above, or include a using statement for each of those specifically, like this:</p>\n\n<pre><code>using std::string;\nusing std::cin;\nusing std::cout;\nusing std::endl;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 846, "user_id": 9572393, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z7AXs.png?s=128&g=1", "display_name": "GKE", "link": "https://stackoverflow.com/users/9572393/gke"}, "is_accepted": false, "score": 1, "last_activity_date": 1533925897, "last_edit_date": 1533925897, "creation_date": 1533756343, "answer_id": 51754259, "question_id": 51753851, "link": "https://stackoverflow.com/questions/51753851/why-are-my-if-statements-not-working-with-strings-in-c/51754259#51754259", "title": "Why are my if statements not working with strings in c++?", "body": "<p>You obtain the value for <code>string q</code> from the user and compare it to <code>string Emily</code> or <code>string Bob</code> , neither of which have any values assigned. </p>\n\n<blockquote>\n  <p>The problem I'm having is my \"if\" statements are completely ignored when I run the .exe from powershell.</p>\n</blockquote>\n\n<p>Your <code>if</code> statements are not being ignored instead you're comparing <code>string q</code> to \"\". </p>\n\n<p>You can give <code>string Bob</code> and <code>string Emily</code> initial values:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nint main()\n{\n  std::string Bob = \"Bob\";\n  std::string Emily = \"Emily\";\n  std::string q;\n}\n</code></pre>\n\n<p>This way you have something to compare the values you're getting from <code>cin</code> to:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nint main()\n{\n  std::string Bob = \"Bob\";\n  std::string Emily = \"Emily\";\n  std::string q;\n\n  std::cout&lt;&lt;\"What is your name? \";\n  std::cin&gt;&gt;q; //Obtain value from cin\n\n  if(q == Emily){}//If q is Emily, then do something\n}\n</code></pre>\n\n<p>You can read more about default variable values <a href=\"https://stackoverflow.com/questions/6032638/default-variable-value\">here</a> and <a href=\"https://stackoverflow.com/questions/11556394/initializing-strings-as-null-vs-empty-string\">here.</a></p>\n"}], "owner": {"reputation": 1, "user_id": 10199527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75071e82f7eeba6c718591066de7e336?s=128&d=identicon&r=PG&f=1", "display_name": "Zii", "link": "https://stackoverflow.com/users/10199527/zii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1533925897, "creation_date": 1533754594, "last_edit_date": 1533754679, "question_id": 51753851, "link": "https://stackoverflow.com/questions/51753851/why-are-my-if-statements-not-working-with-strings-in-c", "title": "Why are my if statements not working with strings in c++?", "body": "<p>I'm a newbie with c++, and I tried googling a solution but every one I came across was so different from the issue I was facing so I couldn't figure it out. The problem I'm having is my \"if\" statements are completely ignored when I run the .exe from powershell. </p>\n\n<p><a href=\"https://pastebin.com/aE6MiQig\" rel=\"nofollow noreferrer\">https://pastebin.com/aE6MiQig</a></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nint main()\n{\n    string q;\n    string w;\n    string Bob;\n    string Emily;\n    {\n        cout &lt;&lt; \"Who is this? \";\n        cin &gt;&gt; q;\n        if (q == Bob)\n        {\n            cout &lt;&lt; \"Hey there bro. \";\n        }\n        if (q == Emily)\n        {\n            cout &lt;&lt; \"Hi friend :) \";\n        }\n        else\n        {\n            cout &lt;&lt; \"Oh hey \" &lt;&lt; q &lt;&lt; \", how are you? \";\n        }\n        cin &gt;&gt; w;\n        cout &lt;&lt; \"Hey, that's \" &lt;&lt; w;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>When I input my name as \"Bob\" I should be seeing the message from the if statement \"Hey there bro.\" but I am instead seeing the else statement, \"Oh hey Bob, how are you?\". Same goes when I input Emily. Only seeing the else statement. </p>\n\n<p>I'm not getting any errors (running this in visual studio) so where am I messing this up?</p>\n"}, {"tags": ["c++", "opengl"], "comments": [{"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 3, "creation_date": 1533754700, "post_id": 51753838, "comment_id": 90467456, "body": "Do you have blending enabled when you draw the arrows? Otherwise I wouldn&#39;t see how the background color could influence the drawing. It might be good to add the code where you draw the arrows so we can reproduce the problem."}, {"owner": {"reputation": 516, "user_id": 2290639, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/dUoG4.jpg?s=128&g=1", "display_name": "Reza Hajianpour", "link": "https://stackoverflow.com/users/2290639/reza-hajianpour"}, "reply_to_user": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1533755239, "post_id": 51753838, "comment_id": 90467687, "body": "@BDL Thank you for reminding me about blending stuff. Apparently, I had <code>glBlendEquation(GL_MAX);</code> set, so that was causing a problem. Getting rid of it fixed the issue. Please post this as an answer so that I can mark it as the working solution."}], "answers": [{"tags": [], "owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "is_accepted": true, "score": 4, "last_activity_date": 1533755811, "creation_date": 1533755811, "answer_id": 51754120, "question_id": 51753838, "link": "https://stackoverflow.com/questions/51753838/glclearcolor1-0-1-0-1-0-1-0-makes-the-whole-screen-white-instead-of-just-t/51754120#51754120", "title": "glClearColor(1.0, 1.0, 1.0, 1.0) makes the whole screen white, instead of just the background", "body": "<p>The behavior described in the question can only happen when blending is enabled while drawing the arrows. Disable blending before drawing and everything should work as expected:</p>\n\n<pre><code>glDisable(GL_BLEND);\n</code></pre>\n"}], "owner": {"reputation": 516, "user_id": 2290639, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/dUoG4.jpg?s=128&g=1", "display_name": "Reza Hajianpour", "link": "https://stackoverflow.com/users/2290639/reza-hajianpour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1567, "favorite_count": 0, "closed_date": 1533765696, "accepted_answer_id": 51754120, "answer_count": 1, "score": -2, "last_activity_date": 1533765555, "creation_date": 1533754563, "last_edit_date": 1533765555, "question_id": 51753838, "link": "https://stackoverflow.com/questions/51753838/glclearcolor1-0-1-0-1-0-1-0-makes-the-whole-screen-white-instead-of-just-t", "closed_reason": "Not suitable for this site", "title": "glClearColor(1.0, 1.0, 1.0, 1.0) makes the whole screen white, instead of just the background", "body": "<p>When I draw shapes on a black background with <code>glClearColor(0.0, 0.0, 0.0, 1.0);</code>, everything gets drawn perfectly on a black background, like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TX23b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TX23b.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now when I increase the RGB closer to white (0.8, 0.8, 0.8, 1.0), things get fade out, like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wDlNC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wDlNC.png\" alt=\"enter image description here\"></a></p>\n\n<p>When it's white, everything is completely fade out:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TGzUh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TGzUh.png\" alt=\"enter image description here\"></a></p>\n\n<p>Changing the alpha to 0.0 doesn't make a difference either. I'm calling these two functions at the beginning of each frame (and their order doesn't make a difference):</p>\n\n<pre><code>glClearColor(clear_color.x, clear_color.y, clear_color.z, clear_color.w);\nglClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n</code></pre>\n\n<p>What I want is obvious: to be able to see my blue arrows on white background. </p>\n"}, {"tags": ["c++", "function", "class", "inheritance", "overriding"], "comments": [{"owner": {"reputation": 908, "user_id": 3292279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VX393.jpg?s=128&g=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/3292279/alex-johnson"}, "edited": false, "score": 1, "creation_date": 1533754192, "post_id": 51753711, "comment_id": 90467256, "body": "What errors are you seeing? You can add them to your question."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1533754306, "post_id": 51753711, "comment_id": 90467292, "body": "Your functions are not virtual, so they do not override base class function."}, {"owner": {"reputation": 589, "user_id": 9996677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13449a17a4c18ed091939cf1b501c185?s=128&d=identicon&r=PG", "display_name": "meat", "link": "https://stackoverflow.com/users/9996677/meat"}, "edited": false, "score": 0, "creation_date": 1533754363, "post_id": 51753711, "comment_id": 90467325, "body": "See <a href=\"https://stackoverflow.com/questions/2391679/why-do-we-need-virtual-functions-in-c\" title=\"why do we need virtual functions in c\">stackoverflow.com/questions/2391679/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 8032304, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3a8f6kGoO7c/AAAAAAAAAAI/AAAAAAAAAFU/tWXKVr1r7IM/photo.jpg?sz=128", "display_name": "Gleb", "link": "https://stackoverflow.com/users/8032304/gleb"}, "edited": false, "score": 0, "creation_date": 1533754456, "post_id": 51753771, "comment_id": 90467355, "body": "would i have to do it for every instance?"}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1533754483, "post_id": 51753771, "comment_id": 90467368, "body": "This does not address the slicing happening with <code>arr</code>"}, {"owner": {"reputation": 589, "user_id": 9996677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13449a17a4c18ed091939cf1b501c185?s=128&d=identicon&r=PG", "display_name": "meat", "link": "https://stackoverflow.com/users/9996677/meat"}, "reply_to_user": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1533754807, "post_id": 51753771, "comment_id": 90467500, "body": "@alterigel can you elaborate?"}, {"owner": {"reputation": 107, "user_id": 8032304, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3a8f6kGoO7c/AAAAAAAAAAI/AAAAAAAAAFU/tWXKVr1r7IM/photo.jpg?sz=128", "display_name": "Gleb", "link": "https://stackoverflow.com/users/8032304/gleb"}, "edited": false, "score": 0, "creation_date": 1533754874, "post_id": 51753771, "comment_id": 90467537, "body": "adding virtual keyword does not help... I have tried that before. and just did once again. I get exactly the same result"}, {"owner": {"reputation": 107, "user_id": 8032304, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3a8f6kGoO7c/AAAAAAAAAAI/AAAAAAAAAFU/tWXKVr1r7IM/photo.jpg?sz=128", "display_name": "Gleb", "link": "https://stackoverflow.com/users/8032304/gleb"}, "edited": false, "score": 0, "creation_date": 1533754957, "post_id": 51753771, "comment_id": 90467571, "body": "perhaps i need to implement the array differently?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1533754970, "post_id": 51753771, "comment_id": 90467581, "body": "@meat, checkout <a href=\"https://stackoverflow.com/questions/274626/what-is-object-slicing\">What is object slicing?</a>"}, {"owner": {"reputation": 589, "user_id": 9996677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13449a17a4c18ed091939cf1b501c185?s=128&d=identicon&r=PG", "display_name": "meat", "link": "https://stackoverflow.com/users/9996677/meat"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1533755021, "post_id": 51753771, "comment_id": 90467604, "body": "@RSahu I just noticed it."}], "tags": [], "owner": {"reputation": 589, "user_id": 9996677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13449a17a4c18ed091939cf1b501c185?s=128&d=identicon&r=PG", "display_name": "meat", "link": "https://stackoverflow.com/users/9996677/meat"}, "is_accepted": false, "score": 0, "last_activity_date": 1533755505, "last_edit_date": 1533755505, "creation_date": 1533754309, "answer_id": 51753771, "question_id": 51753711, "link": "https://stackoverflow.com/questions/51753711/c-function-redefining-code-not-working-logic-error/51753771#51753771", "title": "c++ function redefining (code not working - logic error)", "body": "<p>There are two issues at play here.</p>\n\n<p>1) Based on your <code>for</code> loop at the end, you need to declare some functions, like <code>displayQuestion()</code>, <code>userAnswer()</code>, and <code>isCorrect()</code> as <code>virtual</code>. </p>\n\n<p>2) Secondly, change your <code>arr</code> declaration to <code>Question *arr[] = {&amp;q1, &amp;q2, &amp;q3};</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1533755391, "post_id": 51753970, "comment_id": 90467752, "body": "I&#39;d recommend a <code>std::unique_ptr</code> instead of a <code>std::shared_ptr</code> unless you really need shared ownership.  Otherwise you are paying for reference counting you will never use."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1533755453, "post_id": 51753970, "comment_id": 90467780, "body": "@NathanOliver I considered that, but it would mean <code>std::move</code>-ing them into the vector, and I&#39;m not sure OP would be ready for that"}, {"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1533758668, "post_id": 51753970, "comment_id": 90469164, "body": "@NathanOliver at the current level the asker is, the cost of reference counting is certainly negligible. IMO, it&#39;s even too early to introduce shared pointers. It&#39;s a very nice answer but you may be dropping fancy modern C++ that his class professor might not even know about."}], "tags": [], "owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "is_accepted": false, "score": 2, "last_activity_date": 1533755184, "creation_date": 1533755184, "answer_id": 51753970, "question_id": 51753711, "link": "https://stackoverflow.com/questions/51753711/c-function-redefining-code-not-working-logic-error/51753970#51753970", "title": "c++ function redefining (code not working - logic error)", "body": "<p>You're <a href=\"https://stackoverflow.com/questions/274626/what-is-object-slicing\">slicing objects</a> when you assign subclasses of <code>Question</code>s by value to an array of <code>Question</code> when you do <code>Question arr[] = { q1, q2, q3 };</code>. This means that even though some of your derived <code>Question</code> objects have extra members that the base class doesn't, they're being truncated away by the assignment into the array. Another problem is that because <code>arr</code> is declared to hold plain and simple <code>Question</code> objects, the compiler will assume that a call like <code>arr[i].isCorrect();</code> will <em>always</em> refer to <code>Question::isCorrect()</code>, and not a derived method. Here's a couple things to fix.</p>\n\n<p>Make overridable functions <a href=\"https://stackoverflow.com/questions/2391679/why-do-we-need-virtual-functions-in-c\">virtual</a>:</p>\n\n<pre><code>class Question {\n    ...\n    virtual void isCorrect() {\n        cout &lt;&lt; \"default function\" &lt;&lt; endl;\n        if (input.compare(answer) == 0)\n            cout &lt;&lt; \"True\" &lt;&lt; endl;\n        else\n            cout &lt;&lt; \"False\" &lt;&lt; endl;\n    }\n</code></pre>\n\n<p>and <a href=\"https://stackoverflow.com/questions/18198314/what-is-the-override-keyword-in-c-used-for\">override</a> them in subclasses:</p>\n\n<pre><code>class NumericQuestion : public Question {\n    ...\n    void isCorrect() override {\n        cout &lt;&lt; \"numeric function\" &lt;&lt; endl;\n        if (inp == ans)\n            cout &lt;&lt; \"True\" &lt;&lt; endl;\n        else if ((inp - ans) &lt;= 0.01)\n            cout &lt;&lt; \"False\" &lt;&lt; endl;\n        else\n            cout &lt;&lt; \"False\" &lt;&lt; endl;\n    }\n</code></pre>\n\n<p>Finally, avoid the slicing by storing base class pointers to your <code>Questions</code>. Here, I'm using <a href=\"https://en.cppreference.com/w/cpp/memory/shared_ptr\" rel=\"nofollow noreferrer\">std::shared_ptr</a> to avoid the headaches of manual memory management. Also appearing is a <a href=\"https://stackoverflow.com/questions/15927033/what-is-the-correct-way-of-using-c11s-range-based-for\">ranged-for loop</a>:</p>\n\n<pre><code>auto q1 = std::make_shared&lt;Question&gt;(\"whats 2+2\", \"four\");\nauto q2 = std::make_shared&lt;NumericQuestion&gt; q2(\"2+2\", 4);\n\nauto q3 = std::make_shared&lt;MultipleChoice&gt;(\"The Right Answer is C\", \"answer A\", \"thisisB\", \"thats C\", \"Wrong\", 'c');\n\n// even though q1...q3 are shared_ptrs to derived classes, they can be safely cast to shared_ptrs to the base class\nstd::vector&lt;std::shared_ptr&lt;Question&gt;&gt; questions { q1, q2, q3 };\n\nfor (const auto&amp; question: questions) {\n    question-&gt;displayQuestion();\n    cin &gt;&gt; ans;\n    question-&gt;userAnswer(ans);\n    question-&gt;isCorrect();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "is_accepted": true, "score": 0, "last_activity_date": 1533755223, "creation_date": 1533755223, "answer_id": 51753980, "question_id": 51753711, "link": "https://stackoverflow.com/questions/51753711/c-function-redefining-code-not-working-logic-error/51753980#51753980", "title": "c++ function redefining (code not working - logic error)", "body": "<p>You need to set <code>userAnswer</code>, <code>displayQuestion</code> and <code>isCorrect</code> as virtual in the base class.</p>\n\n<p>You also need to store your question as pointers (there's other options) to prevent slicing. Personally, I find it simpler to fix it like this:</p>\n\n<pre><code>Question* arr[] = {&amp;q1,&amp;q2,&amp;q3};\n...\narr[i]-&gt;displayQuestion();\n</code></pre>\n\n<p>(you need to change all usage or arr[i] to use arrows)</p>\n"}], "owner": {"reputation": 107, "user_id": 8032304, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3a8f6kGoO7c/AAAAAAAAAAI/AAAAAAAAAFU/tWXKVr1r7IM/photo.jpg?sz=128", "display_name": "Gleb", "link": "https://stackoverflow.com/users/8032304/gleb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 51753980, "answer_count": 3, "score": 1, "last_activity_date": 1533755505, "creation_date": 1533754054, "question_id": 51753711, "link": "https://stackoverflow.com/questions/51753711/c-function-redefining-code-not-working-logic-error", "title": "c++ function redefining (code not working - logic error)", "body": "<p>I am currently learning c++ and i am now working on Inheritance.\nI have to make a regular question class as well as a derived class that is a Numeric question and a multiple choice question. I make the questions in the code, and then display them 1 by 1 to the user. The user then answers the questions, and the program is supposed to check whether the answer is correct.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nclass Question {\nprotected:\n    string text;\n    string answer;\n    string input;\npublic:\n    Question(string inText, string inAnswer) {\n        text = inText;\n        answer = inAnswer;\n    }\n    Question() {\n        text = \"blank question\";\n        answer = \" \";\n    }\n    void setQuestion(string txt) {\n        text = txt;\n    }\n    void setAnswer(string answr){\n        answer = answr;\n    }\n    void userAnswer(string ans) {\n        input = ans;\n    }\n    string getAnswer() {\n        return answer;\n    }\n    string getQuestion() {\n        return text;\n    }\n\n    void displayQuestion() {\n        cout &lt;&lt; getQuestion() &lt;&lt; endl;\n    }\n    void isCorrect() {\n        cout &lt;&lt; \"default function\" &lt;&lt; endl;\n        if (input.compare(answer) == 0)\n            cout &lt;&lt; \"True\" &lt;&lt; endl;\n        else\n            cout &lt;&lt; \"False\" &lt;&lt; endl;\n    }\n};\nclass NumericQuestion : public Question {\nprotected:\n    double ans;\n    double inp;\npublic:\n    NumericQuestion(string inText, double inAns) {\n        text = inText;\n        ans = inAns;\n    }\n    void userAnswer(string ans) {\n        inp = stod(ans);\n    }\n\n    void isCorrect() {\n        cout &lt;&lt; \"numeric function\" &lt;&lt; endl;\n        if (inp == ans)\n            cout &lt;&lt; \"True\" &lt;&lt; endl;\n        else if ((inp - ans) &lt;= 0.01)\n        cout &lt;&lt; \"False\" &lt;&lt; endl;\n        else\n            cout &lt;&lt; \"False\" &lt;&lt; endl;\n}\n};\nclass MultipleChoice : public Question {\nprotected:\n    string qA, qB, qC, qD;\npublic:\n    MultipleChoice(string inText, string qA, string aB, string qC, string qD,         char inAnswer) {\n        text = inText;\n        answer = inAnswer;\n    }\n    void displayQuestion() {\n        cout &lt;&lt; text &lt;&lt; endl;\n        cout &lt;&lt; \"a) \" &lt;&lt; qA &lt;&lt; \"    \" &lt;&lt; \"b) \" &lt;&lt; qB &lt;&lt; endl;\n        cout &lt;&lt; \"c) \" &lt;&lt; qC &lt;&lt; \"    \" &lt;&lt; \"d) \" &lt;&lt; qD &lt;&lt; endl;\n    }\n};\n\nint main() {\n    string ans;\n\n    Question q1(\"whats 2+2\", \"four\");\n    NumericQuestion q2(\"2+2\", 4);\n\n    MultipleChoice q3(\"The Right Answer is C\", \"answer A\", \"thisisB\", \"thats C\", \"Wrong\", 'c');\n\n    Question arr[] = { q1,q2,q3};\n    for (int i = 0; i &lt; 3; i++) {\n        arr[i].displayQuestion();\n        cin &gt;&gt; ans;\n        arr[i].userAnswer(ans);\n        arr[i].isCorrect();\n    }\n\ngetchar();\nreturn 0;\n}\n</code></pre>\n\n<p>The member function isCorrect() from NumericQuestion class and displayQuestion() from MultipleChoice class don't get used, instead, the ones from Question class get used, which lead to logical errors in my code. </p>\n"}, {"tags": ["c++", "qt", "qt5", "qtcharts", "qchartview"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1533803516, "post_id": 51753500, "comment_id": 90483427, "body": "Everyone needs help, for that is SO. A question where it shows what has been tried usually has better answers, so I recommend you show your solution attempt."}, {"owner": {"reputation": 13, "user_id": 10199469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4NDT.jpg?s=128&g=1", "display_name": "Joan Cornela", "link": "https://stackoverflow.com/users/10199469/joan-cornela"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1533804798, "post_id": 51753500, "comment_id": 90484181, "body": "The problem is that I have not found such a signal anywhere. I tried to use      chrt = new QChart;     chrt-&gt;legend()-&gt;hide();     ui-&gt;vchrt-&gt;setChart(chrt);     ui-&gt;vchrt-&gt;setRubberBand(QChartView::VerticalRubberBand);  Zoom works, but its need to do zoom-in and zoom-out by mousewheel scroll events. I searched documentation but didn&#39;t find that signals."}], "answers": [{"tags": [], "owner": {"reputation": 5555, "user_id": 2927205, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/luWrX.jpg?s=128&g=1", "display_name": "Mailerdaimon", "link": "https://stackoverflow.com/users/2927205/mailerdaimon"}, "is_accepted": false, "score": 0, "last_activity_date": 1533811800, "last_edit_date": 1533811800, "creation_date": 1533806734, "answer_id": 51763370, "question_id": 51753500, "link": "https://stackoverflow.com/questions/51753500/i-cant-find-mouse-wheel-scroll-events-for-zoom-graphics-in-qchartview/51763370#51763370", "title": "I can&#39;t find mouse wheel scroll events for zoom graphics in QChartView", "body": "<p><code>QChartView</code> inherits from <code>QGraphicsView</code> which offers <a href=\"http://doc.qt.io/archives/qt-4.8/qgraphicsscenewheelevent.html\" rel=\"nofollow noreferrer\"><code>QGraphicsSceneWheelEvent</code></a></p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10199469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4NDT.jpg?s=128&g=1", "display_name": "Joan Cornela", "link": "https://stackoverflow.com/users/10199469/joan-cornela"}, "edited": false, "score": 0, "creation_date": 1533811216, "post_id": 51763431, "comment_id": 90488243, "body": "Thanks a lot, @eyllanesc !!! Transformed QWidget on Form in ChartView and used your modified class. It works! :) But MousewheelUp action performs zoom-out action instead of zoom-in. Thanks anyway! :)"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 13, "user_id": 10199469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4NDT.jpg?s=128&g=1", "display_name": "Joan Cornela", "link": "https://stackoverflow.com/users/10199469/joan-cornela"}, "edited": false, "score": 0, "creation_date": 1533814576, "post_id": 51763431, "comment_id": 90490399, "body": "@JoanCornela only change to <code>const qreal factor = 1&#47;1.001;</code>"}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 0, "last_activity_date": 1533806910, "creation_date": 1533806910, "answer_id": 51763431, "question_id": 51753500, "link": "https://stackoverflow.com/questions/51753500/i-cant-find-mouse-wheel-scroll-events-for-zoom-graphics-in-qchartview/51763431#51763431", "title": "I can&#39;t find mouse wheel scroll events for zoom graphics in QChartView", "body": "<p><code>QChartView</code> is a <code>QWidget</code> so you could implement that logic using the <a href=\"https://doc.qt.io/qt-5.11/qwidget.html#wheelEvent\" rel=\"nofollow noreferrer\"><code>wheelEvent()</code></a> method:</p>\n\n<pre><code>#include &lt;QApplication&gt;\n#include &lt;QChartView&gt;\n#include &lt;QLineSeries&gt;\n#include &lt;random&gt;\n\nQT_CHARTS_USE_NAMESPACE\n\nclass ChartView : public QChartView\n{\npublic:\n    using QChartView::QChartView;\n    enum DirectionZoom{\n        NotZoom,\n        VerticalZoom,\n        HorizontalZoom,\n        BothDirectionZoom = VerticalZoom | HorizontalZoom\n    };\n    DirectionZoom directionZoom() const{\n        return mDirectionZoom;\n    }\n    void setDirectionZoom(const DirectionZoom &amp;directionZoom){\n        mDirectionZoom = directionZoom;\n    }\n\nprotected:\n    void wheelEvent(QWheelEvent *event)\n    {\n        if(chart() &amp;&amp; mDirectionZoom != NotZoom){\n            const qreal factor = 1.001;\n            QRectF r = chart()-&gt;plotArea();\n            QPointF c = r.center();\n            qreal val = std::pow(factor, event-&gt;delta());\n            if(mDirectionZoom &amp; VerticalZoom)\n                r.setHeight(r.height()*val);\n            if (mDirectionZoom &amp; HorizontalZoom) {\n                r.setWidth(r.width()*val);\n            }\n            r.moveCenter(c);\n            chart()-&gt;zoomIn(r);\n        }\n        QChartView::wheelEvent(event);\n    }\nprivate:\n    DirectionZoom mDirectionZoom = NotZoom;\n};\n\nint main(int argc, char *argv[])\n{\n    QApplication a(argc, argv);\n    QChart *chart = new QChart();\n    chart-&gt;legend()-&gt;hide();\n    chart-&gt;setTitle(\"Simple line chart example\");\n    std::random_device rd;\n    std::mt19937 rng(rd());\n    std::uniform_int_distribution&lt;int&gt; uni(0, 10);\n\n    for(size_t i=0; i&lt; 5; i++){\n        QLineSeries *series = new QLineSeries();\n        for(size_t j=0; j &lt; 10; j++){\n            *series &lt;&lt; QPointF(j, uni(rng));\n        }\n        chart-&gt;addSeries(series);\n    }\n    chart-&gt;createDefaultAxes();\n\n    ChartView chartView(chart);\n    chartView.setDirectionZoom(ChartView::VerticalZoom);\n    chartView.setRenderHint(QPainter::Antialiasing);\n    chartView.resize(640, 480);\n    chartView.show();\n\n    return a.exec();\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10199469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4NDT.jpg?s=128&g=1", "display_name": "Joan Cornela", "link": "https://stackoverflow.com/users/10199469/joan-cornela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 51763431, "answer_count": 2, "score": 1, "last_activity_date": 1533817480, "creation_date": 1533753244, "last_edit_date": 1533817480, "question_id": 51753500, "link": "https://stackoverflow.com/questions/51753500/i-cant-find-mouse-wheel-scroll-events-for-zoom-graphics-in-qchartview", "title": "I can&#39;t find mouse wheel scroll events for zoom graphics in QChartView", "body": "<p>I have QChartView on the program window. There are arrays of data that correctly shown on chart as QLineSeries (curves of temperature vs time). I can't find mousewheel events for 'mousewheelup zoom-in' and 'mousewheeldown zoom-out' on QChartView? Need ability to zoom by only vertical direction, like a <code>setRubberBand(QChartView::VerticalRubberBand)</code> but only by mousewheel scroll. Need help</p>\n"}, {"tags": ["c++", "c++11", "memory-management", "new-operator"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1533752265, "post_id": 51753102, "comment_id": 90466267, "body": "<code>operator new</code> is per-class; it&#39;s implicitly <code>static</code>. The object that would be <code>*this</code> doesn&#39;t exist yet; it&#39;s this function&#39;s responsibility to prepare the memory that it&#39;s going to be created in."}, {"owner": {"reputation": 41, "user_id": 7319339, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y2YEQ4R1pTA/AAAAAAAAAAI/AAAAAAAAADA/HHvAi4DzxPE/photo.jpg?sz=128", "display_name": "aalisha", "link": "https://stackoverflow.com/users/7319339/aalisha"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1533754000, "post_id": 51753102, "comment_id": 90467174, "body": "any suggestions how to solve this issue??"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1533754407, "post_id": 51753102, "comment_id": 90467342, "body": "Use a local variable instead of a member variable."}], "owner": {"reputation": 41, "user_id": 7319339, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y2YEQ4R1pTA/AAAAAAAAAAI/AAAAAAAAADA/HHvAi4DzxPE/photo.jpg?sz=128", "display_name": "aalisha", "link": "https://stackoverflow.com/users/7319339/aalisha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "closed_date": 1533752603, "answer_count": 0, "score": 0, "last_activity_date": 1533751723, "creation_date": 1533751723, "question_id": 51753102, "link": "https://stackoverflow.com/questions/51753102/unable-to-set-new-handler", "closed_reason": "Duplicate", "title": "Unable to set_new_handler", "body": "<p>I am trying to learn new_handler in  C++\nI have the following piece of code:</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;new&gt;\nusing namespace std;\n\nclass A\n{   \n    new_handler O_Handler;\n    static void NoMem()\n    {\n        cout&lt;&lt;\"No more mem\"&lt;&lt;endl;\n        throw bad_alloc();\n    }\n\n    public: \n    void* operator new(size_t size) throw(bad_alloc)\n    {\n            cout&lt;&lt;\"Custom handler called\"&lt;&lt;endl;\n            O_Handler=set_new_handler(NoMem);//set for current class\n            void *pv=::operator new(size);\n            set_new_handler(O_Handler);//restor\n            return pv;\n    }\n    A()\n    {\n        cout&lt;&lt;\"ctor\"&lt;&lt;endl;\n    }\n};\nint main()\n{\n    //cout&lt;A::_cnt;\n    try{\n        A *a[13];\n        for(int i=0;i&lt;13;++i)\n            a[i]=new A();\n    }\n    catch(bad_alloc &amp;e)\n    {\n        cout&lt;&lt;\"Size to large\"&lt;&lt;endl;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>However I am getting a compilation issue as below:</p>\n\n<pre><code>F:\\prep\\c++\\overloading_new_operator_set_new_handler.cpp    In static member function 'static void* A::operator new(size_t)':\n7   14  F:\\prep\\c++\\overloading_new_operator_set_new_handler.cpp    [Error] invalid use of member 'A::O_Handler' in static member function\n19  4   F:\\prep\\c++\\overloading_new_operator_set_new_handler.cpp    [Error] from this location\n7   14  F:\\prep\\c++\\overloading_new_operator_set_new_handler.cpp    [Error] invalid use of member 'A::O_Handler' in static member function\n21  20  F:\\prep\\c++\\overloading_new_operator_set_new_handler.cpp    [Error] from this location\n</code></pre>\n\n<p>I haven't declared <code>new</code> as <code>static</code>.\nWhat is the reason for this and how to solve??</p>\n"}, {"tags": ["c++", "string", "vector", "position"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1533750831, "post_id": 51752818, "comment_id": 90465475, "body": "Sounds like you should make a <code>Record</code> class that stores the individual columns as distinct variables and then you can have a <code>std::vector&lt;Record&gt; records;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 605, "user_id": 7128840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdNYI.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/7128840/adam"}, "reply_to_user": {"reputation": 73, "user_id": 10187164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10f31741a80da0dd3f244fc2d16b8e95?s=128&d=identicon&r=PG&f=1", "display_name": "M.TwT", "link": "https://stackoverflow.com/users/10187164/m-twt"}, "edited": false, "score": 0, "creation_date": 1533752130, "post_id": 51752892, "comment_id": 90466191, "body": "No problem! Glad I could help! If you wouldn&#39;t mind please upvote my comment and click the checkmark! I need to increase my points lol"}], "tags": [], "owner": {"reputation": 605, "user_id": 7128840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdNYI.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/7128840/adam"}, "is_accepted": false, "score": 2, "last_activity_date": 1533750912, "creation_date": 1533750912, "answer_id": 51752892, "question_id": 51752818, "link": "https://stackoverflow.com/questions/51752818/how-to-select-the-nth-position-from-a-string-vector/51752892#51752892", "title": "How to select the nth position from a string vector?", "body": "<p>The return value of <code>example.at(2)</code> is the 3rd item in your vector, in this case, a  <code>std::string</code>. </p>\n\n<p>To access a specific character in your string, you can use the <code>operator[]</code>. So to select 2 from the first row, you would simply need to do the following:</p>\n\n<pre><code>example.at(0)[2];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2261, "user_id": 7327572, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/111afeb457014dbcc846245eec06e492?s=128&d=identicon&r=PG&f=1", "display_name": "FilipRistic", "link": "https://stackoverflow.com/users/7327572/filipristic"}, "is_accepted": false, "score": 1, "last_activity_date": 1533751397, "creation_date": 1533751397, "answer_id": 51753016, "question_id": 51752818, "link": "https://stackoverflow.com/questions/51752818/how-to-select-the-nth-position-from-a-string-vector/51753016#51753016", "title": "How to select the nth position from a string vector?", "body": "<p>So what you actually have is <code>vector</code> of <code>string</code> where <code>string</code> represents another dimension, so you have an table with both rows and columns, similar to an 2D array, in other to access a single cell you need 2 indexes, one index for position in <code>vector</code> and another for position in <code>string</code>.  </p>\n\n<p>So in your case it would be <code>example[0][0]</code> to get first <code>char</code> of a string in first row, and to get one you are looking for you would need to write <code>example.at(0)[2]</code>;</p>\n"}, {"tags": [], "owner": {"reputation": 908, "user_id": 3292279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VX393.jpg?s=128&g=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/3292279/alex-johnson"}, "is_accepted": false, "score": 1, "last_activity_date": 1533753314, "last_edit_date": 1533753314, "creation_date": 1533751405, "answer_id": 51753018, "question_id": 51752818, "link": "https://stackoverflow.com/questions/51752818/how-to-select-the-nth-position-from-a-string-vector/51753018#51753018", "title": "How to select the nth position from a string vector?", "body": "<p>This should work:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n\nint main() {\n  std::vector&lt;std::string&gt; strings;\n  strings.push_back(\"1234Hi\");\n  strings.push_back(\"7890Bye\");\n  std::cout &lt;&lt; strings.at(0)[1] &lt;&lt; std::endl; // prints 2\n  std::cout &lt;&lt; strings.at(1)[1] &lt;&lt; std::endl; // prints 8\n}\n</code></pre>\n\n<p>It's sort of like a two-dimensional array: each string you push to the vector is analogous to the  first dimension, and then each character of the string is analogous to the second dimension.</p>\n\n<p>But as mentioned above, there may be better ways to do this, depending on what exactly you're trying to do.</p>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1533754610, "creation_date": 1533754610, "answer_id": 51753857, "question_id": 51752818, "link": "https://stackoverflow.com/questions/51752818/how-to-select-the-nth-position-from-a-string-vector/51753857#51753857", "title": "How to select the nth position from a string vector?", "body": "<p>Other answers show you how to access individual numbers in your strings, but they assume that the numbers are always 1 digit in length.  If you ever need to support multi-digit numbers, use <a href=\"https://en.cppreference.com/w/cpp/io/basic_istringstream\" rel=\"nofollow noreferrer\"><code>std::istringstream()</code></a> or <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/stol\" rel=\"nofollow noreferrer\"><code>std::stoi()</code></a> instead to parse the strings.</p>\n"}], "owner": {"reputation": 73, "user_id": 10187164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10f31741a80da0dd3f244fc2d16b8e95?s=128&d=identicon&r=PG&f=1", "display_name": "M.TwT", "link": "https://stackoverflow.com/users/10187164/m-twt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 795, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1533761615, "creation_date": 1533750671, "last_edit_date": 1533761615, "question_id": 51752818, "link": "https://stackoverflow.com/questions/51752818/how-to-select-the-nth-position-from-a-string-vector", "title": "How to select the nth position from a string vector?", "body": "<p>How does one find, let's say, the 2nd position from a string vector?</p>\n\n<p>Here's a string vector example:</p>\n\n<pre><code>1 2 3 4 Hi\n7 8 9 0 Bye\n2 2 5 6 World\n</code></pre>\n\n<p>If I use <code>example.at(2)</code>, it gives me the whole row <code>2 2 5 6 World</code>. </p>\n\n<p>I just want to get <code>2</code> from the 1st row instead of getting the whole line of <code>2 2 5 6 World</code>. How do I do that?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1533750526, "post_id": 51752715, "comment_id": 90465320, "body": "Depends: on class <code>OutputType</code> and the implementation details of <code>swap</code>.  With that said it&#39;s an ok way to do what you want to."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1533751172, "post_id": 51752715, "comment_id": 90465677, "body": "<i>&quot;To avoid object assignment, swap the reference&quot;</i> Swap will move-assign under the hood anyway. You can simply do <code>out = std::move(localVar);</code> instead."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1533752518, "post_id": 51752715, "comment_id": 90466416, "body": "But while you are at it, you might as well also do <code>localVar = std::move(out);</code> but then what is the point of making the local copy? There is no advantage in the sample code, you could just take a reference if you just dislike the name. But perhaps your program is reliant on the lifetime of <code>out</code>?"}, {"owner": {"reputation": 341, "user_id": 10061112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/892e89fec3f5a5073a4e61b1a7325e93?s=128&d=identicon&r=PG&f=1", "display_name": "hiimdaosui", "link": "https://stackoverflow.com/users/10061112/hiimdaosui"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1533752926, "post_id": 51752715, "comment_id": 90466615, "body": "@GemTaylor The thing is, <code>out</code> could be some high dimensional matrix represented by <code>vector</code>s. I won&#39;t know the size of it until it fetches the data inside this function. Resizing may take a lot of work, but it is handy to just initialize a new matrix."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1533753384, "post_id": 51752715, "comment_id": 90466867, "body": "@hiimdaosui One of the advantages of using an output parameter like this could be reusing the existing memory block. Replacing it via move or swap removes this advantage."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1533753556, "post_id": 51752715, "comment_id": 90466954, "body": "Ok, I guess. I had misread that you were initialising from <code>someInput</code>, anyway. You could start with <code>out = OutputType();</code> to clear your output object. The other option is to <i>return</i> your object, and let the compiler choose between return value optimisation and move assignment."}], "owner": {"reputation": 341, "user_id": 10061112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/892e89fec3f5a5073a4e61b1a7325e93?s=128&d=identicon&r=PG&f=1", "display_name": "hiimdaosui", "link": "https://stackoverflow.com/users/10061112/hiimdaosui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533750358, "creation_date": 1533750358, "question_id": 51752715, "link": "https://stackoverflow.com/questions/51752715/risk-of-swapping-output-reference-parameter-and-local-variable-in-c", "title": "Risk of swapping output reference parameter and local variable in C++", "body": "<p>A function has an output reference parameter to pass the result. Inside the function, it'd be cumbersome to reset some of the properties of the output parameter, so I want to create a new local object and initialize it in a simpler way. Then, to make it the output, I simply swap the reference of the parameter and my new local variable. Is there any risk or side effect of that? </p>\n\n<p>For example, I have some function like this</p>\n\n<pre><code>void getOutput(int someInput, OutputType&amp; out) {\n    // Create a local OutputType variable\n    OutputType localVar(someInput);\n\n    // Fetch data from other functions and set the field in localVar\n    localVar.someField = someFunction();\n\n    // ... other processing\n    localVar.someField2 = ...;\n\n    // To avoid object assignment, swap the reference\n    swap(localVar, out);\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "macros", "alias"], "answers": [{"tags": [], "owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "is_accepted": false, "score": 2, "last_activity_date": 1533751007, "last_edit_date": 1533751007, "creation_date": 1533750511, "answer_id": 51752758, "question_id": 51752643, "link": "https://stackoverflow.com/questions/51752643/macro-for-template-definitions/51752758#51752758", "title": "Macro for template definitions", "body": "<p>No, the preprocessor cannot use <code>&lt;&gt;</code> to delimit macro arguments.</p>\n\n<p>You can emulate an alias template with a class template:</p>\n\n<pre><code>template &lt;typename A, typename B&gt;\nstruct foo {\n    typedef bar&lt;A, B&gt; type;\n};\n\n// Usage: foo&lt;A, B&gt;::type\n// Generic context: typename foo&lt;A, B&gt;::type\n</code></pre>\n\n<p><a href=\"https://godbolt.org/g/SNHNzP\" rel=\"nofollow noreferrer\">Demo</a></p>\n\n<p>This would make its usage less nice, but that's unavoidable.</p>\n"}, {"comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1533750881, "post_id": 51752851, "comment_id": 90465503, "body": "This is a terrible idea for common names of <code>foo</code>, but it&#39;s actually not that bad if you are careful with your macro names: <code>#define MY_LIBRARY_FOO ::fully::qualified::bar</code> and <code>template &lt;typename A, typename B&gt; using MY_LIBRARY_FOO = bar&lt;A, B&gt;</code>"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1533750760, "creation_date": 1533750760, "answer_id": 51752851, "question_id": 51752643, "link": "https://stackoverflow.com/questions/51752643/macro-for-template-definitions/51752851#51752851", "title": "Macro for template definitions", "body": "<p>The following simpler solution works for me.</p>\n\n<pre><code>#ifdef NO_ALIAS_TEMPLATE_AVAILABLE\n    #define foo bar\n#else\n    template&lt;typename A, typename B&gt; using foo = bar&lt;A,B&gt;;\n#endif\n</code></pre>\n\n<p>Given</p>\n\n<pre><code>template &lt;typename A, typename B&gt; struct bar {};\n</code></pre>\n\n<p>the following lines work fine.</p>\n\n<pre><code>foo&lt;int, double&gt; f; // Ok.\nbar&lt;int, double&gt; b; // Ok.\n</code></pre>\n"}], "owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1533751007, "creation_date": 1533750071, "question_id": 51752643, "link": "https://stackoverflow.com/questions/51752643/macro-for-template-definitions", "title": "Macro for template definitions", "body": "<p>I have a problem with alias template, because I have a code which must be compatible with VS 2012, which does not support alias template.</p>\n\n<p>Let's say I have an alias template like:</p>\n\n<pre><code>template&lt;typename A, typename B&gt; using foo = bar&lt;A,B&gt;;\n</code></pre>\n\n<p>Then it would be very convenient to be able to do something like:</p>\n\n<pre><code>#ifdef NO_ALIAS_TEMPLATE_AVAILABLE\n    #define foo&lt;x,y&gt; bar&lt;x,y&gt;\n#else\n    template&lt;typename A, typename B&gt; using foo = bar&lt;A,B&gt;;\n#endif\n</code></pre>\n\n<p>However the best I can do is</p>\n\n<pre><code>    #define foo(x,y) bar&lt;x,y&gt;\n</code></pre>\n\n<p>And I don't want to replace all template specializations in all my code by round brackets, for code readability.</p>\n\n<p>Is there any way to have a macro with delimiters <code>&lt;&gt;</code> for its argument? Or is there no simple solution to my problem? If not, how to implement a strict equivalence to alias template?</p>\n"}, {"tags": ["c++", "visual-studio-2010", "debugging"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 3, "creation_date": 1533749555, "post_id": 51752458, "comment_id": 90464839, "body": "I&#39;d find this highly unlikely. The debugger only sees variables that are currently in scope, and to view others it has to step back through the call stack to restore content. Why in the world would you need to do this anyway? This sounds very much like an XY problem to me. I&#39;ve been writing code and stepping through it in debuggers for close to three decades now, and never once had the need to do what you&#39;re asking."}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1533750632, "post_id": 51752458, "comment_id": 90465373, "body": "To expand on @KenWhite&#39;s comment, &quot;What exactly is the problem you&#39;re trying to solve?&quot;  Looking for any int in the program&#39;s storage that contains 62 sounds suspiciously to me like it&#39;s part of trying to solve a larger problem.  Let us know what that larger problem is, maybe there&#39;s another way to attack it."}], "answers": [{"tags": [], "owner": {"reputation": 602, "user_id": 7736648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6GuvO.png?s=128&g=1", "display_name": "Larry Tang", "link": "https://stackoverflow.com/users/7736648/larry-tang"}, "is_accepted": false, "score": 0, "last_activity_date": 1533754295, "creation_date": 1533754295, "answer_id": 51753767, "question_id": 51752458, "link": "https://stackoverflow.com/questions/51752458/is-there-any-way-to-search-variable-values-in-visual-studio-2010s-debugger/51753767#51753767", "title": "Is there any way to search variable values in Visual Studio 2010&#39;s debugger?", "body": "<h3>Unfortunately, there is <strong>no way to search directly</strong> for values of variables in Visual Studio 2010's debugger, only check their values by way of logging it or dumping program memory.</h3>\n\n<p>I assume you're looking for a feature that's like the one included in VS2015's C#.NET debugger, where you can see the values of all variables in real time, however this isn't an included feature for any C++ debugger that I know of.</p>\n\n<p>It sounds like your issue can instead be solved by routinely checking the value of variables throughout your code, either by using simple printouts, or looking at raw RAM after dumping, if you're really insistent on not putting in logging. If none of this solves your issue, start a new question with the problem you're trying to solve with this question.</p>\n"}], "owner": {"reputation": 21, "user_id": 6442096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2749fdc2737db2416b25f99b99d9414?s=128&d=identicon&r=PG&f=1", "display_name": "Will H", "link": "https://stackoverflow.com/users/6442096/will-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533754295, "creation_date": 1533749369, "question_id": 51752458, "link": "https://stackoverflow.com/questions/51752458/is-there-any-way-to-search-variable-values-in-visual-studio-2010s-debugger", "title": "Is there any way to search variable values in Visual Studio 2010&#39;s debugger?", "body": "<p>Suppose I'm running a huge C++ project in Microsoft Visual Studio. I have the debugger connected and it hits a breakpoint. Is there any way to search all variables in the project to see if, say, there is an int variable with a value of 62?</p>\n"}, {"tags": ["c++", "event-handling", "wxwidgets"], "answers": [{"tags": [], "owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "is_accepted": false, "score": 0, "last_activity_date": 1533753167, "last_edit_date": 1533753167, "creation_date": 1533752602, "answer_id": 51753327, "question_id": 51752299, "link": "https://stackoverflow.com/questions/51752299/how-to-remove-focus-from-wxtextctrl-in-wxwidgets/51753327#51753327", "title": "How to remove focus from wxTextCtrl in wxWidgets", "body": "<p>Each time the control gains or looses the focus a focus event is fired, and your handler comes into action.</p>\n\n<p>There are some causes for this focus event. The most cumbersome is when the new window is created and deleted, because it may generate its own focus events, and your handler may deal with them all. There's a <em>reentrance</em> issue.</p>\n\n<p>We deal with reentrance using a flag, which tell us if we are in a reentrance case.</p>\n\n<pre><code>void MyFrame::OnPasswordTextBoxSetFocus(wxFocusEvent&amp; event)\n{\n    static bool selfFired = false; //our flag\n\n    event.Skip(); //always allows default processing for focus-events\n\n    if ( event.GetEventType() == wxEVT_KILL_FOCUS )\n    {\n         //Nothing to do. Action takes place with wxEVT_SET_FOCUS\n         return;\n    }\n\n    //Deal with re-entrance\n    if ( !selFired )\n    {\n         if (some condition)\n         {\n              selfFired = true;\n\n              //Open a new window.\n              //Pass 'this' to its ctor (or similar way) so that new window\n              //is able to SetFocus() back to this control\n              newWin = open a window...\n\n              newWin-&gt;SetFocus(); //this may be avoided if the new window gains focus on its own\n         }\n    }\n    else\n    {\n        //restore the flag\n        selfFired = false;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 9178490, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f73720385a3dfb05fb833ee4644b7e9d?s=128&d=identicon&r=PG&f=1", "display_name": "aromahola", "link": "https://stackoverflow.com/users/9178490/aromahola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 666, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533753167, "creation_date": 1533748805, "last_edit_date": 1533750290, "question_id": 51752299, "link": "https://stackoverflow.com/questions/51752299/how-to-remove-focus-from-wxtextctrl-in-wxwidgets", "title": "How to remove focus from wxTextCtrl in wxWidgets", "body": "<p>I am using <code>wxEVT_SET_FOCUS</code> for <code>wxTextCtrl</code> in <code>wxWidgets</code>. What I need to do is when user clicks textctrl I have to open a new window and remove focus from textctrl so that FocusHandler function will be executed only once. Is there any function to remove focus from <code>wxTextCtrl</code> ?</p>\n\n<pre><code>Using this connect event in constructor\n//Connect Events\nm_passwordText-&gt;Connect(wxEVT_SET_FOCUS, wxFocusEventHandler(MyFrame::OnPasswordTextBoxSetFocus), NULL, this);\n\n\n void MyFrame::OnPasswordTextBoxSetFocus(wxFocusEvent&amp; event)\n {\n       if(some condition is true)\n           //code to open a new window\n\n       event.Skip()\n       // is there any option to remove focus from password textCtrl so that once a new window opens\n       //I can remove focus from password and avoid executing this function again and again.\n       // If new window opens for the first time, I perform the operation and close it\n       // then also it opens again as control is still in password textbox. \n       //Is there any way to resolve this?\n }\n</code></pre>\n\n<p>Basically I want to stop multiple executions of handler function once the new window is opened without disconnecting the wxeVT_SET_FOCUS from wxTextCtrl.</p>\n"}, {"tags": ["c++", "c++17", "move-semantics", "string-view"], "answers": [{"comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 4, "creation_date": 1533749184, "post_id": 51752360, "comment_id": 90464630, "body": "While this is true, I&#39;d still recommend being very careful with it. You have to know the signature of the function you&#39;re calling to know that all its arguments are references in order for this to be safe. And if the author later changes an argument to be by value, this would no longer be safe. Knowing nothing about the signature of a function, <code>foo.frobnicate(*bar, std::move(bar))</code> raises a red flag."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1533749440, "post_id": 51752360, "comment_id": 90464772, "body": "The second snippet is still using <code>std::make_pair</code>, not the <code>std::pair</code> constructor directly, it&#39;s just explicitly specifying the templated types (triggering implicit construction), rather than explicitly constructing, then passing. Shouldn&#39;t that be equally unsafe? Even receiving by universal reference, it would have to construct the correct types, it&#39;s just moving the time of construction to &quot;just before call time&quot; to &quot;at call time&quot;, but either one is still unsequenced, right? There isn&#39;t a sequence point between &quot;loading&quot; arguments and converting them to the required types, is there?"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1533749740, "post_id": 51752360, "comment_id": 90464949, "body": "@ShadowRanger Oops; It doesn&#39;t make a difference though. Yes, the arguments needs to be initialized, but because they are references, there is no move happening if you ignore the body. Indeed, if you replace <code>make_pair</code> by a function with the same signature but empty body, no move will be made. There are no more sequence points, but yes, each argument is initialized and then the next one is, ... There is no interleaving or such."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1533750656, "post_id": 51752360, "comment_id": 90465383, "body": "@Rakete1111: Ah, I see my mistake. In general, when a conversion is required, receiving by reference would still require construction. But in this case, only the first argument requires conversion, not the second; it constructs the <code>string_view</code> from <code>*to_insert</code> immediately, but just passes along the <code>xvalue</code> reference to <code>to_insert</code> without emptying it; the <code>unique_ptr</code> is already the correct type. Much like <code>try_emplace</code>, the <code>string_view</code> <i>is</i> created immediately as part of calling <code>std::make_pair</code>, while the <code>unique_ptr</code> isn&#39;t move constructed until later. Thanks!"}], "tags": [], "owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "is_accepted": true, "score": 4, "last_activity_date": 1533749626, "last_edit_date": 1533749626, "creation_date": 1533749020, "answer_id": 51752360, "question_id": 51752143, "link": "https://stackoverflow.com/questions/51752143/is-stdmove-safe-in-an-arguments-list-when-the-argument-is-forwarded-not-move/51752360#51752360", "title": "Is std::move safe in an arguments list when the argument is forwarded, not move constructed?", "body": "<p>Yes, your call to <code>try_emplace</code> is perfectly safe. <code>std::move</code> actually doesn't move anything, it just casts the passed variable to an xvalue. No matter what order the arguments are initialized, nothing will ever be moved because the parameters are all references. References bind directly to objects, they do not call any constructors.</p>\n\n<p>If you look at your second snippet, you'll see that <code>std::make_pair</code> also takes its parameters by reference, so in that case too a move will not be made except in the constructor body.</p>\n\n<p>Your third snippet however does have the problem of UB. The difference is subtle, but if the arguments of <code>make_pair</code> are evaluated left-to-right, then a temporary <code>std::unique_ptr</code> object will get initialized with the moved from value of <code>to_insert</code>. This means that now, <code>to_insert</code> is null because a move actually happened because you are explicitly constructing an object that actually performs the move.</p>\n"}], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 2, "accepted_answer_id": 51752360, "answer_count": 1, "score": 5, "last_activity_date": 1533749626, "creation_date": 1533748165, "question_id": 51752143, "link": "https://stackoverflow.com/questions/51752143/is-stdmove-safe-in-an-arguments-list-when-the-argument-is-forwarded-not-move", "title": "Is std::move safe in an arguments list when the argument is forwarded, not move constructed?", "body": "<p>Trying to provide a solution to <a href=\"https://stackoverflow.com/q/51749081/364696\">std::string_view and std::string in std::unordered_set</a>, I'm playing around with replacing <code>std::unordered_set&lt;std::string&gt;</code> with <code>std::unordered_map&lt;std::string_view, std::unique_ptr&lt;std::string&gt;&gt;</code> (the value is <code>std::unique_ptr&lt;std::string&gt;</code> because the small string optimization would mean that the address of the <code>string</code>'s underlying data will not always be transferred as a result of <code>std::move</code>.</p>\n\n<p>My original test code, that seems to work, is (omitting headers):</p>\n\n<pre><code>using namespace std::literals;\n\nint main(int argc, char **argv) {\n    std::unordered_map&lt;std::string_view, std::unique_ptr&lt;std::string&gt;&gt; mymap;\n\n    for (int i = 1; i &lt; argc; ++i) {\n        auto to_insert = std::make_unique&lt;std::string&gt;(argv[i]);\n\n        mymap.try_emplace(*to_insert, std::move(to_insert));\n    }\n\n    for (auto&amp;&amp; entry : mymap) {\n        std::cout &lt;&lt; entry.first &lt;&lt; \": \" &lt;&lt; entry.second &lt;&lt; std::endl;\n    }\n\n    std::cout &lt;&lt; std::boolalpha &lt;&lt; \"\\\"this\\\" in map? \" &lt;&lt; (mymap.count(\"this\") == 1) &lt;&lt; std::endl;\n    std::cout &lt;&lt; std::boolalpha &lt;&lt; \"\\\"this\\\"s in map? \" &lt;&lt; (mymap.count(\"this\"s) == 1) &lt;&lt; std::endl;\n    std::cout &lt;&lt; std::boolalpha &lt;&lt; \"\\\"this\\\"sv in map? \" &lt;&lt; (mymap.count(\"this\"sv) == 1) &lt;&lt; std::endl;\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>I compile with <code>g++</code> 7.2.0, compile line is <code>g++ -O3 -std=c++17 -Wall -Wextra -Werror -flto -pedantic test_string_view.cpp -o test_string_view</code> receiving no warnings of any kind, then run, getting the following output:</p>\n\n<pre><code>$ test_string_view this is a test this is a second test\nsecond: second\ntest: test\na: a\nthis: this\nis: is\n\"this\" in map? true\n\"this\"s in map? true\n\"this\"sv in map? true\n</code></pre>\n\n<p>which is what I expected.</p>\n\n<p>My main concern here is whether:</p>\n\n<pre><code>        mymap.try_emplace(*to_insert, std::move(to_insert));\n</code></pre>\n\n<p>has defined behavior. The <code>*to_insert</code> relies on <code>to_insert</code> not being emptied (by move constructing the <code>std::unique_ptr</code> stored in the map) until after the <code>string_view</code> is constructed. The two definitions of <code>try_emplace</code> that would be considered are:</p>\n\n<pre><code>try_emplace(const key_type&amp; k, Args&amp;&amp;... args);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>try_emplace(key_type&amp;&amp; k, Args&amp;&amp;... args);\n</code></pre>\n\n<p>I'm not sure which would be chosen, but either way, it seems like <code>key_type</code> would be constructed as part of calling <code>try_emplace</code>, while the arguments to make the <code>mapped_type</code> (the \"value\", though maps seem to use <code>value_type</code> to refer to the combined key/value <code>pair</code>) are forwarded along, and not used immediately, which makes the code defined. Am I correct in this interpretation, or is this undefined behavior?</p>\n\n<p>My concern is that other, similar constructions that seem definitely undefined still seem to work, e.g.:</p>\n\n<pre><code>mymap.insert(std::make_pair&lt;std::string_view,\n                            std::unique_ptr&lt;std::string&gt;&gt;(*to_insert,\n                                                          std::move(to_insert)));\n</code></pre>\n\n<p>produces the expected output, while similar constructs like:</p>\n\n<pre><code>mymap.insert(std::make_pair(std::string_view(*to_insert),\n                            std::unique_ptr&lt;std::string&gt;(std::move(to_insert))));\n</code></pre>\n\n<p>trigger a <code>Segmentation fault</code> at runtime, despite none of them raising warnings of any kind, and both constructs seemingly equally unsequenced (unsequenced implicit conversions in the working <code>insert</code>, unsequenced explicit conversion in the segfaulting <code>insert</code>), so I don't want to say \"<code>try_emplace</code> worked for me, so it's okay.\"</p>\n\n<p>Note that while this question is similar to <a href=\"https://stackoverflow.com/q/25180339/364696\">C++11: std::move() call on arguments' list</a>, it's not quite a duplicate (it's what presumably makes the <code>std::make_pair</code> here unsafe, but not necessarily applicable to <code>try_emplace</code>'s forwarding based behavior); in that question, the function receiving the arguments receives <code>std::unique_ptr</code>, triggering construction immediately, while <code>try_emplace</code> is receiving arguments for forwarding, not <code>std::unique_ptr</code>, so while the <code>std::move</code> has \"occurred\" (but done nothing yet), I <em>think</em> we're safe since the <code>std::unique_ptr</code> is constructed \"later\".</p>\n"}, {"tags": ["c++", "primes", "dynamic-allocation", "bad-alloc"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533748376, "post_id": 51752135, "comment_id": 90464192, "body": "You shouldn&#39;t be able to get a <code>bad_alloc</code> unless you allocate dynamically. If you threw 80+ MB on the stack, it&#39;s almost certain to overflow, though."}, {"owner": {"reputation": 47, "user_id": 10173550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbZY.jpg?s=128&g=1", "display_name": "usercow", "link": "https://stackoverflow.com/users/10173550/usercow"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533748422, "post_id": 51752135, "comment_id": 90464210, "body": "I did allocate dynamically!"}, {"owner": {"reputation": 47, "user_id": 10173550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbZY.jpg?s=128&g=1", "display_name": "usercow", "link": "https://stackoverflow.com/users/10173550/usercow"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533748450, "post_id": 51752135, "comment_id": 90464223, "body": "I originally declared it on the stack, it caused the same problem..."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533748823, "post_id": 51752135, "comment_id": 90464422, "body": "Did you <code>int *list = new int[10000002];</code> inside a function or <code>int list [10000002];</code>? Most computers these days should be able to give you 80 GB contiguous dynamic storage and avoid the <code>bad_alloc</code>. I can&#39;t reproduce. The algorithm doesn&#39;t seem to work, but&#39;s not terminating with an allocation error."}, {"owner": {"reputation": 47, "user_id": 10173550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbZY.jpg?s=128&g=1", "display_name": "usercow", "link": "https://stackoverflow.com/users/10173550/usercow"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533748913, "post_id": 51752135, "comment_id": 90464465, "body": "It&#39;s exactly what you can see in my code - I declared it globally, outside of a function."}, {"owner": {"reputation": 3142, "user_id": 2311167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rZpVr.jpg?s=128&g=1", "display_name": "Adrian W", "link": "https://stackoverflow.com/users/2311167/adrian-w"}, "edited": false, "score": 0, "creation_date": 1533749010, "post_id": 51752135, "comment_id": 90464531, "body": "program runs fine w/ gcc 6.3.0. No <code>bad_alloc</code>s. What values did you enter for <code>mini</code> and <code>maxi</code> ?"}, {"owner": {"reputation": 47, "user_id": 10173550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbZY.jpg?s=128&g=1", "display_name": "usercow", "link": "https://stackoverflow.com/users/10173550/usercow"}, "edited": false, "score": 0, "creation_date": 1533749138, "post_id": 51752135, "comment_id": 90464594, "body": "5 for mini, 500 for maxi..."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533749306, "post_id": 51752135, "comment_id": 90464700, "body": "How much available RAM does your computer have? You&#39;re not trying to run this on an Arduino or anything like that, are you?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533749411, "post_id": 51752135, "comment_id": 90464757, "body": "What happens if you use Automatic allocation? <code>int list[1002];</code> and <code>int visited[1002];</code> Note the small size just to prove out where the problem is."}, {"owner": {"reputation": 47, "user_id": 10173550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbZY.jpg?s=128&g=1", "display_name": "usercow", "link": "https://stackoverflow.com/users/10173550/usercow"}, "edited": false, "score": 0, "creation_date": 1533749506, "post_id": 51752135, "comment_id": 90464815, "body": "it works just fine with both stack and heap allocation if I remove a couple zeroes, but it requires more space for large mini and maxi input values that are on the way... (also, my pc has 8GB ram)."}, {"owner": {"reputation": 47, "user_id": 10173550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbZY.jpg?s=128&g=1", "display_name": "usercow", "link": "https://stackoverflow.com/users/10173550/usercow"}, "edited": false, "score": 0, "creation_date": 1533749598, "post_id": 51752135, "comment_id": 90464858, "body": "Perhaps there is an out-of-bounds subscript...?"}, {"owner": {"reputation": 47, "user_id": 10173550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbZY.jpg?s=128&g=1", "display_name": "usercow", "link": "https://stackoverflow.com/users/10173550/usercow"}, "edited": false, "score": 0, "creation_date": 1533749626, "post_id": 51752135, "comment_id": 90464875, "body": "I can&#39;t find one, however... can anybody see a problem with out-of-bounds?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533749706, "post_id": 51752135, "comment_id": 90464922, "body": "Only way you should be able to get <code>bad_alloc</code> is to ask for dynamic storage that cannot be supplied. Technically out of bounds access can do anything, but I&#39;ve never seen one toss a phantom exception."}, {"owner": {"reputation": 47, "user_id": 10173550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbZY.jpg?s=128&g=1", "display_name": "usercow", "link": "https://stackoverflow.com/users/10173550/usercow"}, "edited": false, "score": 0, "creation_date": 1533749767, "post_id": 51752135, "comment_id": 90464964, "body": "this is very odd indeed that this is happening... any ideas as to why?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533749857, "post_id": 51752135, "comment_id": 90465004, "body": "If you want to test for out of bounds, use <code>std::array</code> or <code>std::vector</code> and swap the <code>[]</code>s for the <code>at</code> method. <code>at</code> bounds checks."}, {"owner": {"reputation": 47, "user_id": 10173550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbZY.jpg?s=128&g=1", "display_name": "usercow", "link": "https://stackoverflow.com/users/10173550/usercow"}, "edited": false, "score": 0, "creation_date": 1533750172, "post_id": 51752135, "comment_id": 90465158, "body": "I changed from arrays to vectors and got the exact same result... std::bad_alloc..."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533750501, "post_id": 51752135, "comment_id": 90465306, "body": "Somehow you do not have enough contiguous free memory or you have a mega-weird. Run the program through whatever debugger came with your development environment and see where the exception is thrown. What development tools are you using?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533750841, "post_id": 51752135, "comment_id": 90465481, "body": "Huh. One other possibility: Build error and you&#39;re executing stale code. Let&#39;s remove all dynamic allocation from the program. Replace <code>int *list = new int[10000002]; int *visited = new int[10000002];</code> with <code>int list[10000002]; int visited [10000002];</code>. Note that this still won&#39;t work, algorithm is broken, but if you still get <code>bad_alloc</code> when there are no dynamic allocations in the program, the problem is elsewhere."}, {"owner": {"reputation": 47, "user_id": 10173550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbZY.jpg?s=128&g=1", "display_name": "usercow", "link": "https://stackoverflow.com/users/10173550/usercow"}, "edited": false, "score": 0, "creation_date": 1533751080, "post_id": 51752135, "comment_id": 90465625, "body": "ah, yes... now it says that I am going out-of-bounds... do you know where this is happening?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533752003, "post_id": 51752135, "comment_id": 90466128, "body": "<a href=\"https://en.wikipedia.org/wiki/Debugger\" rel=\"nofollow noreferrer\">That&#39;s a job for the debugger</a>. Trust me, you want to get good at using debuggers. It&#39;s unlikely that you will encounter a better programming productivity tool, and the sooner you get good at using them, the sooner you can start getting your programs done faster."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533752140, "post_id": 51752135, "comment_id": 90466196, "body": "Plus the debugger will help you see where you&#39;re going wrong in your sieving algorithm."}], "owner": {"reputation": 47, "user_id": 10173550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbZY.jpg?s=128&g=1", "display_name": "usercow", "link": "https://stackoverflow.com/users/10173550/usercow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1533748699, "creation_date": 1533748126, "last_edit_date": 1533748699, "question_id": 51752135, "link": "https://stackoverflow.com/questions/51752135/stdbad-alloc-thrown-on-prime-number-task", "title": "std::bad_alloc thrown on prime number task", "body": "<p>I am working on a task in which I have to print out all the prime numbers between two given numbers, but which are also palindromes. The program crashes, however, throwing an std::bad_alloc. I have tried fixing this by dynamically allocating my two main arrays on the heap, but this did not fix anything. Can anybody please help me fix this error? Here is my code: </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n#include &lt;algorithm&gt;\n#include &lt;fstream&gt;\n\nusing namespace std;\n\nint mini, maxi;\nint *list = new int[10000002];\nint *visited = new int[10000002];\n\nbool is_pal(string num)\n{\n    string num2 = num;\n    reverse(num2.begin(), num2.end());\n    if (num2 == num)\n        return true;\n    return false;\n}\nint main()\n{\n    visited[4] = 1;\n    visited[6] = 1;\n    visited[8] = 1;\n    visited[9] = 1;\n    cin &gt;&gt; mini &gt;&gt; maxi;\n    for (int i = mini; i &lt;= maxi; i++)\n        list[i] = i;\n    for (int i = mini; i &lt;= maxi; i++)\n    {\n        if (visited[i] == 0)\n        {\n            for (int j = i * 2; j &lt;= maxi; j += i)\n            {\n                visited[j] = 1;\n                list[j] = -1;\n            }\n        }\n    }\n    for (int i = mini; i &lt;= maxi; i++)\n        if (visited[i] == 0 &amp;&amp; is_pal(to_string(list[i])))\n            cout &lt;&lt; list[i] &lt;&lt; \"\\n\";\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "reference", "namespaces", "undefined"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1533751509, "post_id": 51752121, "comment_id": 90465861, "body": "There isn&#39;t enough information in <code>void myVoid(){ }</code> for the compiler to tell that <code>myVoid</code> is supposed to be <code>myNamespace::myVoid</code> and not just plain old <code>myVoid</code>, so plain old <code>myVoid</code> is what goes into the compiled object file and <code>myNamespace::myVoid</code> is left unimplemented. Can&#39;t find line and verse to back this up, but someone will be along eventually with a standard quote and a real answer."}, {"owner": {"reputation": 4533, "user_id": 2504757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef5b308d33027fab8440d223828fe4c?s=128&d=identicon&r=PG", "display_name": "Robert Andrzejuk", "link": "https://stackoverflow.com/users/2504757/robert-andrzejuk"}, "edited": false, "score": 0, "creation_date": 1533753344, "post_id": 51752121, "comment_id": 90466851, "body": "What is the compile error and which line? The example doesn&#39;t show a call of <code>myFunction</code>. The example is inconsistant with the question."}], "answers": [{"tags": [], "owner": {"reputation": 1034, "user_id": 4735781, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/r78R2.jpg?s=128&g=1", "display_name": "eneski", "link": "https://stackoverflow.com/users/4735781/eneski"}, "is_accepted": true, "score": 0, "last_activity_date": 1534527393, "creation_date": 1534527393, "answer_id": 51900439, "question_id": 51752121, "link": "https://stackoverflow.com/questions/51752121/unreferenced-function-inside-a-namespace/51900439#51900439", "title": "Unreferenced function inside a namespace", "body": "<p>If you don't specify definition of <code>myVoid</code> (I mean just declaring it like you did), then the compiler can never be sure if you are implementing the function which is declared in namespace or just defining a new one. </p>\n\n<p>On the other hand, if you are defining <code>myClass::myFunction</code>, it has to be the method that is declared in the defined class.</p>\n\n<p>To make it clear, investigate the following code and take a look <a href=\"https://stackoverflow.com/q/4084972\">here (very similar question)</a></p>\n\n<pre><code>namespace Test { \n    int myVoid(void);    // declaration\n    class yourClas;      // declaration\n\n    class myClass{       // definition\n        public:\n            myClass();\n            ~myClass();\n            void myFunction(void); // declaration which belongs to defined class\n    }\n}\n\nvoid myVoid() {  \n// definition, but compiler can't be sure this is the function \n// that you mention in the namespace or a new function declaration.  \n}\n\nvoid myClass::myFunction(void){ \n// absolutely definition for the method of the corresponding class \n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8015395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d7a9736f1098ec354688aecdd52e4a2?s=128&d=identicon&r=PG&f=1", "display_name": "D Adalid", "link": "https://stackoverflow.com/users/8015395/d-adalid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 51900439, "answer_count": 1, "score": 2, "last_activity_date": 1534527393, "creation_date": 1533748072, "question_id": 51752121, "link": "https://stackoverflow.com/questions/51752121/unreferenced-function-inside-a-namespace", "title": "Unreferenced function inside a namespace", "body": "<p>I  am new at C++ language and I am trying  to understand why the next thing is happening:</p>\n\n<p>I have a header file <code>header.h</code></p>\n\n<pre><code>namespace myNamespace{\nclass myClass{\n    public:\n        myClass();\n        ~myClass();\n        void myFunction(void);\n}\n\nvoid myVoid();\n}\n</code></pre>\n\n<p>The definitions are in <code>header.cpp</code></p>\n\n<pre><code>using namespace myNamespace;\n\nvoid myClass::myFunction(void){\n//DO anything\n}\n\nvoid myVoid(){\n//Do anything\n}\n</code></pre>\n\n<p>And in the <code>main.cpp</code> I have the follow:</p>\n\n<pre><code>#include \"header.h\"\n\nmain(){\n  myVoid();\n  myNamespace::myVoid();\n}\n</code></pre>\n\n<p>Why If I try to call <code>myFunction</code> of the class <code>myClass</code> from the main I have a successful compile, and if I try to call the function as in the main file I have an undefined reference error? I can fix it if in the <code>header.h</code> moves <code>myVoid</code> out of the namespace.</p>\n\n<p>Why is this happening?  I  am trying to figure out how this works. </p>\n\n<p>Thanks in advice,</p>\n"}, {"tags": ["c++", "visual-studio", "visual-studio-2017"], "comments": [{"owner": {"reputation": 21, "user_id": 10199071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b8d76d9dda0e3b0fbde4282781998c3?s=128&d=identicon&r=PG&f=1", "display_name": "daniel keemstar", "link": "https://stackoverflow.com/users/10199071/daniel-keemstar"}, "edited": false, "score": 0, "creation_date": 1533756138, "post_id": 51752096, "comment_id": 90468048, "body": "If youre gonna downvote it, at least provide a reason, or help me"}, {"owner": {"reputation": 321, "user_id": 316480, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/65e59976b7a105df7698868290ca2225?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/316480/adrian"}, "edited": false, "score": 0, "creation_date": 1533803336, "post_id": 51752096, "comment_id": 90483320, "body": "I have the same problem, so you are not alone. I don&#39;t know why someone would downvote."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10199071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b8d76d9dda0e3b0fbde4282781998c3?s=128&d=identicon&r=PG&f=1", "display_name": "daniel keemstar", "link": "https://stackoverflow.com/users/10199071/daniel-keemstar"}, "edited": false, "score": 1, "creation_date": 1533756159, "post_id": 51752139, "comment_id": 90468054, "body": "Doubt it has anything to do with that"}, {"owner": {"reputation": 91, "user_id": 1834022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56f2803a32444a1cdd3974dd21c1d88c?s=128&d=identicon&r=PG", "display_name": "DoubleDev", "link": "https://stackoverflow.com/users/1834022/doubledev"}, "reply_to_user": {"reputation": 21, "user_id": 10199071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b8d76d9dda0e3b0fbde4282781998c3?s=128&d=identicon&r=PG&f=1", "display_name": "daniel keemstar", "link": "https://stackoverflow.com/users/10199071/daniel-keemstar"}, "edited": false, "score": 0, "creation_date": 1533859484, "post_id": 51752139, "comment_id": 90512758, "body": "I have had some weird things happen when using Visual Studio and Windows.  One of the reasons why I switched over to Linux; too many quirky things that kept happening."}], "tags": [], "owner": {"reputation": 91, "user_id": 1834022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56f2803a32444a1cdd3974dd21c1d88c?s=128&d=identicon&r=PG", "display_name": "DoubleDev", "link": "https://stackoverflow.com/users/1834022/doubledev"}, "is_accepted": false, "score": 0, "last_activity_date": 1533748153, "creation_date": 1533748153, "answer_id": 51752139, "question_id": 51752096, "link": "https://stackoverflow.com/questions/51752096/permission-denied-when-trying-to-login-in-visual-studio/51752139#51752139", "title": "&quot;Permission Denied&quot; when trying to login in Visual Studio", "body": "<p>Have you tried running this as admin?</p>\n"}, {"tags": [], "owner": {"reputation": 321, "user_id": 316480, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/65e59976b7a105df7698868290ca2225?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/316480/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1533805319, "creation_date": 1533805319, "answer_id": 51762893, "question_id": 51752096, "link": "https://stackoverflow.com/questions/51752096/permission-denied-when-trying-to-login-in-visual-studio/51762893#51762893", "title": "&quot;Permission Denied&quot; when trying to login in Visual Studio", "body": "<p>Couldn't log in, but I went to MSDN account and took the Visual Studio key and entered it. It's still not logged in, but it works.</p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1533822614, "post_id": 51768206, "comment_id": 90496280, "body": "Sounds plausible. I imagine the remote website involved just doesn&#39;t work with such an ancient browser any more (0.48% market share!) and is using JavaScript features not supported in IE9. Interestingly, though, IE9 is still technically supported by Microsoft so this is potentially a bit of a f###-up on their part."}, {"owner": {"reputation": 21, "user_id": 10199071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b8d76d9dda0e3b0fbde4282781998c3?s=128&d=identicon&r=PG&f=1", "display_name": "daniel keemstar", "link": "https://stackoverflow.com/users/10199071/daniel-keemstar"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1533824246, "post_id": 51768206, "comment_id": 90497382, "body": "Yeah I&#39;ll report it to them and hopefully the other people that possibly had this happen will finally be able to use VS"}], "tags": [], "owner": {"reputation": 21, "user_id": 10199071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b8d76d9dda0e3b0fbde4282781998c3?s=128&d=identicon&r=PG&f=1", "display_name": "daniel keemstar", "link": "https://stackoverflow.com/users/10199071/daniel-keemstar"}, "is_accepted": false, "score": 1, "last_activity_date": 1533820916, "creation_date": 1533820916, "answer_id": 51768206, "question_id": 51752096, "link": "https://stackoverflow.com/questions/51752096/permission-denied-when-trying-to-login-in-visual-studio/51768206#51768206", "title": "&quot;Permission Denied&quot; when trying to login in Visual Studio", "body": "<p>I updated my default IE9 to an IE11, turned all settings all the way down and I was able to log in!</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/help/17621/internet-explorer-downloads\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/17621/internet-explorer-downloads</a></p>\n\n<p>Don't know if this will help everyone, but it did for me</p>\n"}], "owner": {"reputation": 21, "user_id": 10199071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b8d76d9dda0e3b0fbde4282781998c3?s=128&d=identicon&r=PG&f=1", "display_name": "daniel keemstar", "link": "https://stackoverflow.com/users/10199071/daniel-keemstar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1533820916, "creation_date": 1533747986, "last_edit_date": 1533805478, "question_id": 51752096, "link": "https://stackoverflow.com/questions/51752096/permission-denied-when-trying-to-login-in-visual-studio", "title": "&quot;Permission Denied&quot; when trying to login in Visual Studio", "body": "<p>So I recently got VS on a new computer (have been using it for over 1 year) and I used it without logging in for 30 days after which it asked me to log in. When I tried, this happened:</p>\n\n<p><img src=\"https://i.stack.imgur.com/lNqXA.png\" alt=\"My error\"></p>\n\n<p>Tried reinstalling, tweaking IE settings and making it the default browser, deleting cache, deleting some files, making sure it's not blocked by the firewall, but nothing worked.</p>\n\n<p>What can I do? I really need to make it work fast.</p>\n"}, {"tags": ["c++", "qt", "opengl"], "answers": [{"tags": [], "owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "is_accepted": false, "score": 0, "last_activity_date": 1562498674, "last_edit_date": 1562498674, "creation_date": 1533749176, "answer_id": 51752411, "question_id": 51752037, "link": "https://stackoverflow.com/questions/51752037/any-solutions-for-perspective-view-opengl-qt/51752411#51752411", "title": "Any solutions for perspective view openGL qt", "body": "<p>What the window displays is a frustum, defined by six planes. Normally, these planes are parallel, as in a cube. Anything that lies outside the frustum is not displayed.</p>\n\n<p>\"Zoom\" may be interpreted, in a generic way, as \"see bigger, nearer, more detail\".</p>\n\n<p>There are several ways of achieve the zoom effect:</p>\n\n<ul>\n<li><p>Scale the objects. This works, the flaw is that objects (or parts of them) may lie before the <em>near</em> plane or behind the <em>far</em> plane of the frustum.</p></li>\n<li><p>Move the camera towards the object. Same matter with near/far planes. Also, take care of moving through the model, you can set a \"barrier\" (perhaps a box) to prevent the camera moving too deep.</p></li>\n<li><p>For an orthogonal projection, set left/right/top/bottom planes nearer to the object. This makes the frustum smaller, thus it's normal that some objects get clipped. </p></li>\n<li><p>For a perspective projection you can do the same trick as with orthogonal. This trick is just to reduce the <em>FOV</em> (field of view) angle. If objects are too far, the perspective effect may be less obvious.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": true, "score": 1, "last_activity_date": 1533749423, "creation_date": 1533749423, "answer_id": 51752477, "question_id": 51752037, "link": "https://stackoverflow.com/questions/51752037/any-solutions-for-perspective-view-opengl-qt/51752477#51752477", "title": "Any solutions for perspective view openGL qt", "body": "<p><a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glViewport.xhtml\" rel=\"nofollow noreferrer\"><code>glViewport</code></a> specifies the mapping of normalized device coordinates to window coordinates (pixels).</p>\n\n<p>If you want that the entire geometry which is inside the clip space, is mapped to the window, then it has to be:</p>\n\n<pre><code>glViewport(0, 0, width, height)\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10198944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d9fd0ebcd20fc67e714822fe77f734?s=128&d=identicon&r=PG&f=1", "display_name": "I. Plumb", "link": "https://stackoverflow.com/users/10198944/i-plumb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 1, "accepted_answer_id": 51752477, "answer_count": 2, "score": 1, "last_activity_date": 1562498674, "creation_date": 1533747783, "last_edit_date": 1562498613, "question_id": 51752037, "link": "https://stackoverflow.com/questions/51752037/any-solutions-for-perspective-view-opengl-qt", "title": "Any solutions for perspective view openGL qt", "body": "<p>I have the following problem, when I zoom in on the image. I have not been able to solve it. I am currently developing in Qt with c ++. I have a question about orthogonal projection and perspective projection. I need to zoom without traversing the image. I tried to make the <code>glViewport</code> bigger, but it does not work for me. The <code>xmin</code>, <code>xmax</code>... are the maximum and minimum values \u200b\u200bfor each axis.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void MeshViewer::resizeGL(int width, int height)\n{\n    int side = qMin(width, height);\n    if ( height == 0 )\n        height = 1;\n    glViewport(((GLint)(width - side)/2.0), (GLint)((height -side)/2.0), (GLint)side, (GLint)side);\n    glMatrixMode(GL_MODELVIEW);\n    glLoadIdentity();\n    glOrtho(xmin, xmax, ymin, ymax, zmin, zmax);\n    glMatrixMode(GL_MODELVIEW);\n    glLoadIdentity();\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 5319, "user_id": 2754173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b0a0fd9004b29fa441e5bbf6904e69?s=128&d=identicon&r=PG&f=1", "display_name": "Geezer", "link": "https://stackoverflow.com/users/2754173/geezer"}, "edited": false, "score": 0, "creation_date": 1534081249, "post_id": 51752003, "comment_id": 90573809, "body": "Hi @Blair Fonville, just out of curiosity, do you remain puzzled as to your question after reading my answer below? If so then I&#39;d be glad to try and help further."}, {"owner": {"reputation": 808, "user_id": 6073774, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v3n2C.jpg?s=128&g=1", "display_name": "Blair Fonville", "link": "https://stackoverflow.com/users/6073774/blair-fonville"}, "reply_to_user": {"reputation": 5319, "user_id": 2754173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b0a0fd9004b29fa441e5bbf6904e69?s=128&d=identicon&r=PG&f=1", "display_name": "Geezer", "link": "https://stackoverflow.com/users/2754173/geezer"}, "edited": false, "score": 0, "creation_date": 1534089237, "post_id": 51752003, "comment_id": 90575739, "body": "@SkepticalEmpiricist A little. Your answer refers to specializations, which isn\u2019t precisely relevant. Mostly though, I was just giving the question some time. Thanks for the gentle reminder."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1534090188, "post_id": 51752003, "comment_id": 90576039, "body": "@BlairFonville: What you are trying to do is simply impossible.  <b><code>std::vector</code> cannot be <code>constexpr</code></b>, ever, because its specification requires dynamic allocation.  <code>std::string</code> has a similar problem.  You should consider using <code>std::array&lt;char const* const, N&gt;</code> instead for compile-time lists of strings... a <code>std::array&lt;char const* const, N&gt;</code> concatenated with a <code>std::array&lt;char const* const, M&gt;</code> will result in a <code>std::array&lt;char const* const, N+M&gt;</code>, which the template system is more than capable of handling."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1534090335, "post_id": 51752003, "comment_id": 90576083, "body": "In addition to that, your function is very dangerous even as a non-constexpr approach, because <b>you return a reference to a temporary object</b> whose destruction is imminent... the caller will be left with a dangling reference.  Because you move the content out before the temporary dies, it works... but the type system is not helping you remember to do this."}, {"owner": {"reputation": 5319, "user_id": 2754173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b0a0fd9004b29fa441e5bbf6904e69?s=128&d=identicon&r=PG&f=1", "display_name": "Geezer", "link": "https://stackoverflow.com/users/2754173/geezer"}, "edited": false, "score": 0, "creation_date": 1534090546, "post_id": 51752003, "comment_id": 90576136, "body": "@Blair Fontville Are you sure what you&#39;re referring to as <i>specialization</i> in this case isn&#39;t just the instantiated version of <code>vect-concat()</code>? As in what the pre-compiler generates when you try to call it with some <code>std::vector</code> arguments?"}], "answers": [{"comments": [{"owner": {"reputation": 808, "user_id": 6073774, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v3n2C.jpg?s=128&g=1", "display_name": "Blair Fonville", "link": "https://stackoverflow.com/users/6073774/blair-fonville"}, "edited": false, "score": 0, "creation_date": 1533752083, "post_id": 51752173, "comment_id": 90466165, "body": "The compiler generates functions for the templates depending on how the template&#39;s types are instantiated in the code. In my case, as far as I can tell, the compiler should replace &lt;class V&gt; with std::vector&lt;std::string&gt;, and I will therefore end up with the same code as my non-template case. So, I don&#39;t see how the two are different."}, {"owner": {"reputation": 5319, "user_id": 2754173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b0a0fd9004b29fa441e5bbf6904e69?s=128&d=identicon&r=PG&f=1", "display_name": "Geezer", "link": "https://stackoverflow.com/users/2754173/geezer"}, "reply_to_user": {"reputation": 808, "user_id": 6073774, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v3n2C.jpg?s=128&g=1", "display_name": "Blair Fonville", "link": "https://stackoverflow.com/users/6073774/blair-fonville"}, "edited": false, "score": 0, "creation_date": 1533825058, "post_id": 51752173, "comment_id": 90497921, "body": "@BlairFonville I believe you are correct here -- the two are only different if you take into account a certain sub section of the standard&#39;s entry for <code>constexpr</code> regarding function templates. I have added an answer pointing it out and what I believe to be answering your final 3 questions in the OP. Hope this helps."}], "tags": [], "owner": {"reputation": 185, "user_id": 6226201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b1fe643279bcdb12775babdbfec6a8a?s=128&d=identicon&r=PG&f=1", "display_name": "Bailey Kocin", "link": "https://stackoverflow.com/users/6226201/bailey-kocin"}, "is_accepted": false, "score": 0, "last_activity_date": 1533748276, "creation_date": 1533748276, "answer_id": 51752173, "question_id": 51752003, "link": "https://stackoverflow.com/questions/51752003/constexpr-function-to-concatenate-vectors/51752173#51752173", "title": "Constexpr function to concatenate vectors", "body": "<p>Methods marked with \u201cconstexpr\u201d will only be evaluated at compile time if the parameters passed in are also compile time known. Templates are made at compile time so it knows what is being passed in therefore it allows it to work. Then, when you pass in the initializer it can construct the vector at compile time. Otherwise \u201cconstexpr\u201d methods are evaluated at runtime just like any other method.</p>\n"}, {"tags": [], "owner": {"reputation": 5319, "user_id": 2754173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b0a0fd9004b29fa441e5bbf6904e69?s=128&d=identicon&r=PG&f=1", "display_name": "Geezer", "link": "https://stackoverflow.com/users/2754173/geezer"}, "is_accepted": true, "score": 2, "last_activity_date": 1534081318, "last_edit_date": 1534081318, "creation_date": 1533822607, "answer_id": 51768829, "question_id": 51752003, "link": "https://stackoverflow.com/questions/51752003/constexpr-function-to-concatenate-vectors/51768829#51768829", "title": "Constexpr function to concatenate vectors", "body": "<ol>\n<li><strong>The difference between the two functions [that makes the template version compile ...]</strong> is defined according to the standard right here <a href=\"http://eel.is/c++draft/dcl.constexpr#6\" rel=\"nofollow noreferrer\">[dcl.constexpr], \u00a79.1.5.6</a>:</li>\n</ol>\n\n<blockquote>\n  <p>If the instantiated template specialization of a <code>constexpr</code> function\n  template or member function of a class template would fail to satisfy\n  the requirements for a <code>constexpr</code> function or <code>constexpr</code> constructor,\n  that specialization is still a <code>constexpr</code> function or <code>constexpr</code>\n  constructor, even though a call to such a function cannot appear in a\n  constant expression.</p>\n</blockquote>\n\n<ol start=\"2\">\n<li><p>As you can see from the standard, the <code>constexpr</code> isn't ignored, but when you'll try using it as a constant it shouldn't compile.</p></li>\n<li><p>As a whole i'd say this is only the answer to your original request in case your sole reason for having <code>vect_concat()</code> a <code>constexpr</code> was delivering intent in the code (A worthy cause in its own right!). But if at any point moving onward you're to try calling it as a syntactic constant it would reveal itself as missing the entire point of <code>constexpr</code> itself.</p></li>\n</ol>\n"}], "owner": {"reputation": 808, "user_id": 6073774, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v3n2C.jpg?s=128&g=1", "display_name": "Blair Fonville", "link": "https://stackoverflow.com/users/6073774/blair-fonville"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 529, "favorite_count": 0, "accepted_answer_id": 51768829, "answer_count": 2, "score": 4, "last_activity_date": 1534081318, "creation_date": 1533747667, "question_id": 51752003, "link": "https://stackoverflow.com/questions/51752003/constexpr-function-to-concatenate-vectors", "title": "Constexpr function to concatenate vectors", "body": "<p>I am trying to initialize a <code>const std::vector&lt;std::string&gt;</code> member object of a base class, with a vector comprised of compile-time strings passed up from a derived class. The derived class will define some of the strings in the vector, and the remainder of strings in the vector will be defined by subclasses of the derived class (i.e. classes derived from the derived class).</p>\n\n<p>For example:</p>\n\n<pre><code>// +----------------+\n// | ConfigBaseUnit |\n// +----------------+\nclass ConfigBaseUnit\n{\npublic:\n    ConfigBaseUnit(std::vector&lt;std::string&gt; &amp;&amp;fields);\n    virtual ~ConfigBaseUnit() = 0;\n\nprivate:\n    const std::vector&lt;std::string&gt; field_vector;\n};\n\nConfigBaseUnit::ConfigBaseUnit(std::vector&lt;std::string&gt; &amp;&amp;fields) \n    : field_vector(std::move(fields)) {\n}\nConfigBaseUnit::~ConfigBaseUnit(){}\n\n// +----------+\n// | Ioconfig |\n// +----------+\nclass Ioconfig : public ConfigBaseUnit\n{\npublic:\n    Ioconfig(std::vector&lt;std::string&gt; &amp;&amp;fields);\n    virtual ~Ioconfig() {};\n};\n\nstd::vector&lt;std::string&gt; &amp; vect_concat(\n      std::vector&lt;std::string&gt; &amp;&amp;v1,\n      std::vector&lt;std::string&gt; &amp;&amp;v2 )\n{\n    v1.insert(v1.end(), v2.begin(), v2.end());\n    return v1;\n}\n\nIoconfig::Ioconfig(std::vector&lt;std::string&gt; &amp;&amp;fields)\n    : ConfigBaseUnit( std::move(\n          vect_concat({ \"label\", \"protocol\", \"connected\" }, std::move(fields))\n      )\n    ) {\n}\n\n// +-------------------+\n// | Ioconfig_Ethernet |\n// +-------------------+\nclass Ioconfig_Ethernet : public Ioconfig\n{\npublic:\n    Ioconfig_Ethernet();\n    virtual ~Ioconfig_Ethernet() final {};\n};\n\nIoconfig_Ethernet::Ioconfig_Ethernet() \n    : Ioconfig( { \"ip\", \"port\" } ) {\n}\n</code></pre>\n\n<p><hr>\nHere, the abstract base class <code>ConfigBaseUnit</code> initializes its const <code>field_vector</code> member with its class-constructor argument.</p>\n\n<pre><code>ConfigBaseUnit::ConfigBaseUnit(std::vector&lt;std::string&gt; &amp;&amp;fields) \n    : field_vector(std::move(fields)) {\n}\n</code></pre>\n\n<p>The derived class <code>Ioconfig</code> wants the initialization of <code>field_vector</code> to always include these items:</p>\n\n<pre><code>{ \"label\", \"protocol\", \"connected\" }\n</code></pre>\n\n<p>but <code>field_vector</code> should also include the items sent up by <code>Ioconfig_Ethernet</code> (which is derived from <code>Ioconfig</code>). For instance, <code>Ioconfig_Ethernet</code> passes these forward for inclusion:</p>\n\n<pre><code>{ \"ip\", \"port\" }\n</code></pre>\n\n<p><code>Ioconfig</code> ties these together in its constructor like this:</p>\n\n<pre><code>Ioconfig::Ioconfig(std::vector&lt;std::string&gt; &amp;&amp;fields)\n    : ConfigBaseUnit{ std::move(\n          vect_concat({ \"label\", \"protocol\", \"connected\" }, std::move(fields))\n      )\n    } {\n}\n</code></pre>\n\n<p>The <code>Ioconfig</code> constructor uses function <code>vect_concat(...)</code> to merge the fields together into a final vector which it then moves to the base class.</p>\n\n<p>And <code>vect_concat</code> is just:</p>\n\n<pre><code>std::vector&lt;std::string&gt; &amp; vect_concat(\n      std::vector&lt;std::string&gt; &amp;&amp;v1,\n      std::vector&lt;std::string&gt; &amp;&amp;v2 )\n{\n    v1.insert(v1.end(), v2.begin(), v2.end());\n    return v1;\n}\n</code></pre>\n\n<p><strong>Now to the point</strong></p>\n\n<p>This works, but I would like for <code>vect_concat</code> to be a <strong><code>constexpr</code></strong> function. Ultimately, the values in <code>ConfigBaseUnit::field_vector</code> should be defined at compile time. Its contents should be inflexible, hard-coded, plain-text values, which can easily be discovered by reading the code (i.e. they will never be read in from a file, or command-line arg, etc).</p>\n\n<p>Just defining <code>vect_concat</code> as <code>constexpr</code> doesn't work, presumably because std::vector::insert is not constexpr. How can I work around this?</p>\n\n<p><hr>\n<strong>Note:</strong> After typing out the question above, I found that declaring <code>vect_concat</code> as a template allows me to make it a <code>constexpr</code> function. </p>\n\n<p>This works:</p>\n\n<pre><code>template &lt;class V&gt;\nconstexpr V &amp; vect_concat(V &amp;&amp;v1, V &amp;&amp;v2)\n{\n    v1.insert(v1.end(), v2.begin(), v2.end());\n    return v1;\n}\n</code></pre>\n\n<p>This does not:</p>\n\n<pre><code>constexpr std::vector&lt;std::string&gt; &amp; vect_concat(\n      std::vector&lt;std::string&gt; &amp;&amp;v1,\n      std::vector&lt;std::string&gt; &amp;&amp;v2 )\n{\n    v1.insert(v1.end(), v2.begin(), v2.end());\n    return v1;\n}\n</code></pre>\n\n<p>So, <strong>my questions</strong> (which, unfortunately, evolved during the course of writing this post) <strong>are:</strong></p>\n\n<ol>\n<li>What's the difference between the two functions above, that makes the template version compile and the non-template version fail? Both cases use <code>std::vector::insert</code>, which does not seem to be a constexpr function.</li>\n<li>Is the <code>constexpr</code> specifier simply ignored in the template case?</li>\n<li>And is using the template version the answer to my original question?</li>\n</ol>\n"}, {"tags": ["c++", "templates", "gcc", "visual-c++", "clang"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 0, "creation_date": 1533747199, "post_id": 51751767, "comment_id": 90463585, "body": "The problem has to do with using an array implicitly converted to a pointer as a template argument."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1533747934, "post_id": 51751767, "comment_id": 90463976, "body": "Possibly for use as template parameter MSVC requires an <code>extern</code> linkage pointer known at compile time."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1533748766, "last_edit_date": 1533748766, "creation_date": 1533748241, "answer_id": 51752161, "question_id": 51751767, "link": "https://stackoverflow.com/questions/51751767/stdfunction-of-a-value-templated-method-compiles-with-clang-and-g-but-not-wi/51752161#51752161", "title": "std::function of a value templated method compiles with clang and g++ but not with msvc", "body": "<p>FWIW, the following failed to compile using g++  6.4.0 (<code>g++ -std=c++11</code>).</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\ntemplate &lt;const char* name&gt;\nstd::string fct() {\n   return name;\n}\n\nconst char toto[] = \"toto\";\nstd::function&lt;std::string()&gt; fctptr = fct&lt;toto&gt;;\n\nint main(){\n   std::cout &lt;&lt; fctptr() &lt;&lt; std::endl;\n} \n</code></pre>\n\n<p>Here's the error message:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>socc.cc:11:43: error: the value of \u2018toto\u2019 is not usable in a constant expression\n std::function&lt;std::string()&gt; fctptr = fct&lt;toto&gt;;\n                                           ^~~~\nsocc.cc:10:12: note: \u2018toto\u2019 was not declared \u2018constexpr\u2019\n const char toto[] = \"toto\";\n</code></pre>\n\n<p>Changing the definition of <code>toto</code> to</p>\n\n<pre><code>constexpr char toto[] = \"toto\";\n</code></pre>\n\n<p>resolved the problem.</p>\n"}], "owner": {"reputation": 323, "user_id": 4154429, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZW1Fa.png?s=128&g=1", "display_name": "Infinity", "link": "https://stackoverflow.com/users/4154429/infinity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533748766, "creation_date": 1533746744, "question_id": 51751767, "link": "https://stackoverflow.com/questions/51751767/stdfunction-of-a-value-templated-method-compiles-with-clang-and-g-but-not-wi", "title": "std::function of a value templated method compiles with clang and g++ but not with msvc", "body": "<p>The following code <a href=\"http://coliru.stacked-crooked.com/a/ff4ac7c4a2de8432\" rel=\"nofollow noreferrer\">compiles with clang v5.0.0</a> and <a href=\"http://coliru.stacked-crooked.com/a/0c68940b11689d38\" rel=\"nofollow noreferrer\">g++ v8.1.0</a> but fails with visual studio (2013 and 2017):</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\ntemplate &lt;const char* name&gt;\nstd::string fct() {\n   return name;\n}\n\nconst char toto[] = \"toto\";\nstd::function&lt;std::string()&gt; fctptr = fct&lt;toto&gt;;\n\nint main(){\n   std::cout &lt;&lt; fctptr() &lt;&lt; std::endl;\n} \n</code></pre>\n\n<p>The error is the following:</p>\n\n<pre><code>main.cpp(11): error C2440: 'initializing' : cannot convert from 'std::string (__cdecl *)(void)' to 'std::function&lt;std::string (void)&gt;'\n1&gt;          No constructor could take the source type, or constructor overload resolution was ambiguous\n</code></pre>\n\n<p>I tried to replace the std::function with a typedef to a function pointer, as such:</p>\n\n<pre><code>typedef std::string(*Fctptr)();\nFctptr fctptr = fct&lt;toto&gt;;\n</code></pre>\n\n<p>However, I got the same error.</p>\n\n<p>Is it a bug with msvc compiler, or is the above code not standard compliant.</p>\n"}, {"tags": ["c++", "regex", "std"], "comments": [{"owner": {"reputation": 605, "user_id": 7128840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdNYI.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/7128840/adam"}, "edited": false, "score": 1, "creation_date": 1533747437, "post_id": 51751752, "comment_id": 90463731, "body": "does simply not catching the exception and doing nothing with it fit your requirements?"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 605, "user_id": 7128840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdNYI.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/7128840/adam"}, "edited": false, "score": 2, "creation_date": 1533747675, "post_id": 51751752, "comment_id": 90463860, "body": "@Blondie No. When exceptions are disabled, you can&#39;t just catch the exception. You literally can&#39;t even throw the exception"}, {"owner": {"reputation": 43580, "user_id": 1020526, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Scjj8.jpg?s=128&g=1", "display_name": "revo", "link": "https://stackoverflow.com/users/1020526/revo"}, "edited": false, "score": 0, "creation_date": 1533747900, "post_id": 51751752, "comment_id": 90463959, "body": "You can&#39;t parse a regex with a regex."}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1533748242, "post_id": 51751752, "comment_id": 90464128, "body": "Do you really need to use regex?"}, {"owner": {"reputation": 1218, "user_id": 3293816, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/caceacf70cd45093e9bbf8568c3bd4c4?s=128&d=identicon&r=PG&f=1", "display_name": "user99999991", "link": "https://stackoverflow.com/users/3293816/user99999991"}, "reply_to_user": {"reputation": 43580, "user_id": 1020526, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Scjj8.jpg?s=128&g=1", "display_name": "revo", "link": "https://stackoverflow.com/users/1020526/revo"}, "edited": false, "score": 0, "creation_date": 1533748800, "post_id": 51751752, "comment_id": 90464409, "body": "@revo No you can&#39;t, but you can use a regex to parse a string before I use it as a regex."}, {"owner": {"reputation": 43580, "user_id": 1020526, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Scjj8.jpg?s=128&g=1", "display_name": "revo", "link": "https://stackoverflow.com/users/1020526/revo"}, "edited": false, "score": 0, "creation_date": 1533748841, "post_id": 51751752, "comment_id": 90464431, "body": "That&#39;s the same thing I just commented on. Naming it <i>string</i> doesn&#39;t solve the problem."}, {"owner": {"reputation": 1218, "user_id": 3293816, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/caceacf70cd45093e9bbf8568c3bd4c4?s=128&d=identicon&r=PG&f=1", "display_name": "user99999991", "link": "https://stackoverflow.com/users/3293816/user99999991"}, "reply_to_user": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1533748879, "post_id": 51751752, "comment_id": 90464451, "body": "@KillzoneKid - Are there any alternatives that support expression searches that isn&#39;t a lib outside of the std? std::find is not only too simple, it&#39;s far too slow for my use case."}, {"owner": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "edited": false, "score": 1, "creation_date": 1533749088, "post_id": 51751752, "comment_id": 90464572, "body": "In the moment that you disabled exceptions, you are not using standard C++ anymore. In that case, you should probably specify your compiler and architecture. Maybe there&#39;s a compiler-specific solution, but there can&#39;t be a standard one, by definition."}, {"owner": {"reputation": 1218, "user_id": 3293816, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/caceacf70cd45093e9bbf8568c3bd4c4?s=128&d=identicon&r=PG&f=1", "display_name": "user99999991", "link": "https://stackoverflow.com/users/3293816/user99999991"}, "edited": false, "score": 0, "creation_date": 1533749470, "post_id": 51751752, "comment_id": 90464791, "body": "The source is compiled across multiple compilers and architectures, so any compiler specific solution (if one exists) would be insufficient for me sadly. =("}, {"owner": {"reputation": 1218, "user_id": 3293816, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/caceacf70cd45093e9bbf8568c3bd4c4?s=128&d=identicon&r=PG&f=1", "display_name": "user99999991", "link": "https://stackoverflow.com/users/3293816/user99999991"}, "reply_to_user": {"reputation": 43580, "user_id": 1020526, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Scjj8.jpg?s=128&g=1", "display_name": "revo", "link": "https://stackoverflow.com/users/1020526/revo"}, "edited": false, "score": 0, "creation_date": 1533749711, "post_id": 51751752, "comment_id": 90464929, "body": "@revo - I thought you misunderstood my intent. I see what you&#39;re saying now."}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1533751154, "post_id": 51751752, "comment_id": 90465663, "body": "@user99999991 <code>std::string</code> has own set of nice string manipulators, there is no reason to use generic <code>std::find</code>. But answering this without knowing exactly what you need is pointless."}, {"owner": {"reputation": 1218, "user_id": 3293816, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/caceacf70cd45093e9bbf8568c3bd4c4?s=128&d=identicon&r=PG&f=1", "display_name": "user99999991", "link": "https://stackoverflow.com/users/3293816/user99999991"}, "edited": false, "score": 0, "creation_date": 1533752081, "post_id": 51751752, "comment_id": 90466162, "body": "Like I said, expression searches. Sorry if that&#39;s not a real phrase, I mean like pattern matching, substring searches, all in one. &quot;Lorum Ipsum 1, 2, 3&quot; - match if the phrase starts with and contains &quot;Lorum * 1, 2, 3&quot; etc"}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1533752221, "post_id": 51751752, "comment_id": 90466244, "body": "Worst case scenario, you could always go the Lua way and make a &quot;dumbed down&quot; version of regex that&#39;s easier to validate by hand."}, {"owner": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "reply_to_user": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1533752780, "post_id": 51751752, "comment_id": 90466546, "body": "@SilvioMayolo if you&#39;re going to reinvent the wheel, it&#39;s much easier to simply use one of the many libraries that do it instead, such as <a href=\"https://www.boost.org/doc/libs/1_67_0/libs/regex/doc/html/index.html\" rel=\"nofollow noreferrer\">Boost.Regex</a> (which you can make exception-free by setting a flag aptly named <i>no_except</i>)"}], "answers": [{"comments": [{"owner": {"reputation": 1218, "user_id": 3293816, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/caceacf70cd45093e9bbf8568c3bd4c4?s=128&d=identicon&r=PG&f=1", "display_name": "user99999991", "link": "https://stackoverflow.com/users/3293816/user99999991"}, "edited": false, "score": 0, "creation_date": 1533760767, "post_id": 51753576, "comment_id": 90470247, "body": "After spending the day researching it, it seems like there is no way to do it indeed. I can&#39;t use libraries so that is out for me. I will have to abandon the idea, but will mark this as the answer unless someone else comes up with some black magic."}], "tags": [], "owner": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "is_accepted": true, "score": 1, "last_activity_date": 1533753546, "creation_date": 1533753546, "answer_id": 51753576, "question_id": 51751752, "link": "https://stackoverflow.com/questions/51751752/can-you-prevent-stdregex-from-throwing-exception-on-invalid-expressions/51753576#51753576", "title": "Can you prevent std::regex from throwing exception on invalid expressions?", "body": "<p>You can't. There's no standard way to do it. Exceptions are an intrinsic part of the standard library, and even interfaces that don't throw their own exceptions (such as the infamous <code>error_code</code>-based interface for <code>&lt;filesystem&gt;</code>) can throw exceptions for other operations.</p>\n\n<p>Your best bet is using a library that is designed to be exception-free, such as <a href=\"https://www.boost.org/doc/libs/1_67_0/libs/regex/doc/html/index.html\" rel=\"nofollow noreferrer\">Boost.Regex</a> with the <code>no_except</code> flag enabled. You can then check for errors after construction of a <code>boost::basic_regex</code>, using the member function <a href=\"https://www.boost.org/doc/libs/1_67_0/libs/regex/doc/html/boost_regex/ref/basic_regex.html#boost_regex.basic_regex.status\" rel=\"nofollow noreferrer\">status</a>.</p>\n"}], "owner": {"reputation": 1218, "user_id": 3293816, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/caceacf70cd45093e9bbf8568c3bd4c4?s=128&d=identicon&r=PG&f=1", "display_name": "user99999991", "link": "https://stackoverflow.com/users/3293816/user99999991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 1, "accepted_answer_id": 51753576, "answer_count": 1, "score": 3, "last_activity_date": 1533753546, "creation_date": 1533746705, "last_edit_date": 1533748677, "question_id": 51751752, "link": "https://stackoverflow.com/questions/51751752/can-you-prevent-stdregex-from-throwing-exception-on-invalid-expressions", "title": "Can you prevent std::regex from throwing exception on invalid expressions?", "body": "<pre><code>std::regex regex(\"*\", std::regex_constants::icase);\n</code></pre>\n\n<p>This will throw an exception. If I have exceptions <em>disabled</em>, it will terminate the application, and that means I <strong>cannot</strong> catch it and do nothing with it like I normally would do.</p>\n\n<p>Is there anyway to prevent invalid regex from throwing exceptions when it is constructed? Or some kind of <code>std::regex::isvalid(\"*\")</code> check that exists?</p>\n\n<p>I was thinking maybe I could come up with a separate regex that parses the input regex expression string before I attempt the constructor, but I would much prefer an alternative.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 1, "creation_date": 1533746471, "post_id": 51751673, "comment_id": 90463167, "body": "Are you looking for virtual inheritance?"}, {"owner": {"reputation": 1799, "user_id": 1137713, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iuRcY.jpg?s=128&g=1", "display_name": "iHowell", "link": "https://stackoverflow.com/users/1137713/ihowell"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1533746489, "post_id": 51751673, "comment_id": 90463181, "body": "I don&#39;t know, am I?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533746617, "post_id": 51751673, "comment_id": 90463241, "body": "@iHowell It would appear you are. Sorry about that."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1533746764, "post_id": 51751673, "comment_id": 90463324, "body": "Some helpful reading: <a href=\"https://isocpp.org/wiki/faq/multiple-inheritance\" rel=\"nofollow noreferrer\">isocpp.org/wiki/faq/multiple-inheritance</a>"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1533746775, "post_id": 51751673, "comment_id": 90463335, "body": "@iHowell Yes, you are... MyClass inherits two instances of <code>Foo</code>: one from <code>Interface</code> and one from <code>Bar</code>. If you only want a single instance in <code>MyClass</code>, both <code>Interface</code> and <code>Bar</code> need to inherit from <code>Foo</code> virtually."}, {"owner": {"reputation": 1799, "user_id": 1137713, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iuRcY.jpg?s=128&g=1", "display_name": "iHowell", "link": "https://stackoverflow.com/users/1137713/ihowell"}, "edited": false, "score": 0, "creation_date": 1533746956, "post_id": 51751673, "comment_id": 90463446, "body": "But, as I said, I don&#39;t actually have access to <code>Foo</code> or <code>Bar</code>, so what else could I do? I only have access to <code>Interface</code> and <code>MyClass</code>."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1533747120, "post_id": 51751673, "comment_id": 90463543, "body": "You might avoid <code>Interface</code> inheriting from <code>Foo</code>. Why did you do so at all?"}, {"owner": {"reputation": 1799, "user_id": 1137713, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iuRcY.jpg?s=128&g=1", "display_name": "iHowell", "link": "https://stackoverflow.com/users/1137713/ihowell"}, "edited": false, "score": 0, "creation_date": 1533747363, "post_id": 51751673, "comment_id": 90463685, "body": "So, <code>Foo</code> and <code>Bar</code> are the classes <code>QAbstractItemModel</code> and <code>QAbstractListModel</code> (from the Qt library) respectively. <code>Interface</code> needs to be a generic model, while <code>MyClass</code> should use the list model. I might just be able to make <code>MyClass</code> implement the list model though, without directly inheriting from it."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1533747830, "post_id": 51751673, "comment_id": 90463936, "body": "And you cannot entirely replace <code>Interface</code> with <code>QAbstractItemModel</code>? What does <code>Interface</code> provide as extra?"}, {"owner": {"reputation": 1799, "user_id": 1137713, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iuRcY.jpg?s=128&g=1", "display_name": "iHowell", "link": "https://stackoverflow.com/users/1137713/ihowell"}, "edited": false, "score": 0, "creation_date": 1533747903, "post_id": 51751673, "comment_id": 90463961, "body": "Interface is used as a factory type."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 1799, "user_id": 1137713, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iuRcY.jpg?s=128&g=1", "display_name": "iHowell", "link": "https://stackoverflow.com/users/1137713/ihowell"}, "edited": false, "score": 0, "creation_date": 1533748164, "post_id": 51751673, "comment_id": 90464092, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/177667/discussion-between-aconcagua-and-ihowell\">continue this discussion in chat</a>."}, {"owner": {"reputation": 109, "user_id": 8240252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cLaTl.jpg?s=128&g=1", "display_name": "anil singh butola", "link": "https://stackoverflow.com/users/8240252/anil-singh-butola"}, "edited": false, "score": 0, "creation_date": 1533748790, "post_id": 51751673, "comment_id": 90464404, "body": "@iHowell i am not getting any compiler errors so \u263aread this tutorial first you get answer  <a href=\"https://www.tutorialspoint.com/cplusplus/index.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/cplusplus/index.htm</a>"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 109, "user_id": 8240252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cLaTl.jpg?s=128&g=1", "display_name": "anil singh butola", "link": "https://stackoverflow.com/users/8240252/anil-singh-butola"}, "edited": false, "score": 0, "creation_date": 1533752675, "post_id": 51751673, "comment_id": 90466489, "body": "@anilsinghbutola It is not about a compile error, but about (unwanted!) double inheritance of Foo!"}], "answers": [{"comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 109, "user_id": 8240252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cLaTl.jpg?s=128&g=1", "display_name": "anil singh butola", "link": "https://stackoverflow.com/users/8240252/anil-singh-butola"}, "edited": false, "score": 0, "creation_date": 1533753662, "post_id": 51752867, "comment_id": 90467007, "body": "@anilsinghbutola All in all, with verifying and testing, something around 3/4 hour..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 109, "user_id": 8240252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cLaTl.jpg?s=128&g=1", "display_name": "anil singh butola", "link": "https://stackoverflow.com/users/8240252/anil-singh-butola"}, "edited": false, "score": 0, "creation_date": 1533753824, "post_id": 51752867, "comment_id": 90467087, "body": "There is one potential issue with passing <code>this</code> to parent constructor, as <code>this</code> is not yet fully constructed. According to a former <a href=\"https://stackoverflow.com/q/37724668/1312382\">question of mine</a>, this should be fine, though."}, {"owner": {"reputation": 109, "user_id": 8240252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cLaTl.jpg?s=128&g=1", "display_name": "anil singh butola", "link": "https://stackoverflow.com/users/8240252/anil-singh-butola"}, "edited": false, "score": 0, "creation_date": 1533754109, "post_id": 51752867, "comment_id": 90467219, "body": "its look fine to me also"}, {"owner": {"reputation": 1799, "user_id": 1137713, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iuRcY.jpg?s=128&g=1", "display_name": "iHowell", "link": "https://stackoverflow.com/users/1137713/ihowell"}, "edited": false, "score": 0, "creation_date": 1533754860, "post_id": 51752867, "comment_id": 90467528, "body": "@Aconcagua, I think it&#39;s fine because you&#39;re passing a reference."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 1799, "user_id": 1137713, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iuRcY.jpg?s=128&g=1", "display_name": "iHowell", "link": "https://stackoverflow.com/users/1137713/ihowell"}, "edited": false, "score": 0, "creation_date": 1533755248, "post_id": 51752867, "comment_id": 90467688, "body": "@iHowell That was consensus in answers to my question as well, posted the comment rather as confirmation than as question. It&#39;s just that standard sometimes is very strict about such matters, and although some constructions work with <i>any</i> compiler available on <i>any</i> hardware available, they still are UB. So before questions arise..."}, {"owner": {"reputation": 1799, "user_id": 1137713, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iuRcY.jpg?s=128&g=1", "display_name": "iHowell", "link": "https://stackoverflow.com/users/1137713/ihowell"}, "edited": false, "score": 0, "creation_date": 1533755766, "post_id": 51752867, "comment_id": 90467910, "body": "@Aconcagua, if I need there to be a public constructor for <code>Interface</code>, since a factory is creating instances of <code>Interface</code>, how would I provide a public constructor, since I wouldn&#39;t have the <code>Foo</code> yet?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 1799, "user_id": 1137713, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iuRcY.jpg?s=128&g=1", "display_name": "iHowell", "link": "https://stackoverflow.com/users/1137713/ihowell"}, "edited": false, "score": 0, "creation_date": 1533756159, "post_id": 51752867, "comment_id": 90468053, "body": "@iHowell You are referring to my last edit (MyFoo and MyBar)? Then you won&#39;t ever create <code>Interface</code> directly! If you need a bare Foo Interface, you&#39;d create MyFoo, if a Bar Interface, MyBar, if another Interface, MyAnother. As I mentioned already, you are losing the inheritance between MyFoo and MyBar, don&#39;t get irritated by."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 1799, "user_id": 1137713, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iuRcY.jpg?s=128&g=1", "display_name": "iHowell", "link": "https://stackoverflow.com/users/1137713/ihowell"}, "edited": false, "score": 0, "creation_date": 1533756426, "post_id": 51752867, "comment_id": 90468161, "body": "@iHowell If you still need such inheritance, you need another parallel hierarchy: <code>Interface</code>, <code>InterfaceFoo : public Interface</code>, <code>InterfaceBar : public FooInterface</code>, <code>MyFoo : public FooInterface, public Foo</code>, <code>MyBar : public BarInterface, public Bar</code>. Hm, did not try, actually, you should even be able to inherit privately from <code>Foo</code> and <code>Bar</code>, by which you could prevent a wild mix between the Interface hierarchy and the Foo/Bar one..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 1799, "user_id": 1137713, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iuRcY.jpg?s=128&g=1", "display_name": "iHowell", "link": "https://stackoverflow.com/users/1137713/ihowell"}, "edited": false, "score": 0, "creation_date": 1533757172, "post_id": 51752867, "comment_id": 90468474, "body": "@iHowell Yep, you can... But then before you can cast to <code>Foo</code>, you need to cast to <code>Interface</code> before, if you want to cast a <code>MyFoo</code> or <code>MyBar</code> (or pointer to)."}], "tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": true, "score": 1, "last_activity_date": 1533753638, "last_edit_date": 1533753638, "creation_date": 1533750825, "answer_id": 51752867, "question_id": 51751673, "link": "https://stackoverflow.com/questions/51751673/how-to-extend-an-inherited-classs-inherited-class/51752867#51752867", "title": "How to extend an inherited class&#39;s inherited class", "body": "<pre><code>class Foo\n{\npublic:\n    virtual ~Foo() { }\n    virtual void f() { std::cout &lt;&lt; \"foo!\" &lt;&lt; std::endl; }\n};\n\nclass Bar : public Foo\n{\npublic:\n    void f() override { std::cout &lt;&lt; \"bar!\" &lt;&lt; std::endl; }\n};\n</code></pre>\n\n<p>Problem now is that you cannot inherit from <code>Foo</code> in <code>Interface</code>:\nYou cannot modify <code>Bar</code>, thus you cannot make it inherit virtually, so even if <code>Interface</code> did, you'd get two instances of <code>Foo</code> in <code>MyClass</code>. So my approach is having a reference to Foo within interface and provide an explicit cast to:</p>\n\n<pre><code>class Interface\n{\n    Foo&amp; foo;\nprotected:\n    Interface(Foo&amp; foo) : foo(foo) { }\npublic:\n    operator Foo&amp;()\n    {\n        return foo;\n    }\n\n    virtual ~Interface() { }\n\n    // this actually is only a short cut - you can always\n    // access Foo's f via cast as well!\n    // (so you can drop it, if you prefer)\n    virtual void f() { foo.f(); }\n};\n\nclass MyClass : public Interface, public Bar\n{\npublic:\n    MyClass() : Interface(*static_cast&lt;Foo*&gt;(this)) { }\n    using Bar::f;\n};\n</code></pre>\n\n<p>Now you can use it as follows:</p>\n\n<pre><code>MyClass c;\nInterface* i = &amp;c;\nFoo* f = &amp;static_cast&lt;Foo&amp;&gt;(*i);\n// or, if you have not yet lost access to c, simply:\nf = &amp;static_cast&lt;Foo&amp;&gt;(c);\n</code></pre>\n\n<p>Extension: If you need to be able to instantiate <code>Interface</code> directly (not in form of a derived class), you can achieve this with some minor modifications to <code>Interface</code>:</p>\n\n<pre><code>class Interface\n{\n    Foo* foo; // raw pointer even in times of C++11 and smart pointers:\n              // need to be able to delete  c o n d i t i o n a l l y\n    bool isOwner;\nprotected:\n    Interface(Foo&amp; foo) : foo(&amp;foo), isOwner(false) { }\npublic:\n    Interface() : foo(new Foo()), isOwner(true) { }\n\n    operator Foo&amp;()\n    {\n        return *foo;\n    }\n\n    virtual ~Interface()\n    {\n        if(isOwner)\n        {\n            delete foo;\n        }\n    }\n\n    virtual void f() { foo-&gt;f(); }\n};\n</code></pre>\n\n<p><em>Edit:</em> While above would work in general, you would get in trouble if you try to delete an <code>Interface</code> (not derived) via <code>Foo</code> pointer. You can solve the issue as follows:</p>\n\n<pre><code>class Interface\n{\n    Foo&amp; foo;\nprotected:\n    Interface(Foo&amp; foo) : foo(foo) { }\npublic:\n\n    operator Foo&amp;()\n    {\n        return foo;\n    }\n\n    virtual ~Interface() { }\n\n    //virtual void f() { foo.f(); }\n};\n\nclass MyFoo : public Interface, public Foo\n{\npublic:\n    MyFoo() : Interface(*static_cast&lt;Foo*&gt;(this)) { }\n    virtual ~MyFoo() { }\n    //using Foo::f; // don't need, if dropping the short cut\n};\n\nclass MyBar : public Interface, public Bar\n{\npublic:\n    MyBar() : Interface(*static_cast&lt;Foo*&gt;(this)) { }\n    virtual ~MyBar() { }\n    //using Bar::f; // don't need, if dropping the short cut\n};\n</code></pre>\n\n<p>While now <code>Foo</code> inherits from <code>Bar</code>, <code>MyBar</code> does not from <code>MyFoo</code>, so you cannot assign a <code>MyBar</code> object to a <code>MyFoo</code> pointer. But you can both assign (via the cast) to a <code>Foo</code> pointer, which is, according to the discussion to question, your actual goal, so this should be fine...</p>\n"}], "owner": {"reputation": 1799, "user_id": 1137713, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iuRcY.jpg?s=128&g=1", "display_name": "iHowell", "link": "https://stackoverflow.com/users/1137713/ihowell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 51752867, "answer_count": 1, "score": 0, "last_activity_date": 1533753638, "creation_date": 1533746358, "question_id": 51751673, "link": "https://stackoverflow.com/questions/51751673/how-to-extend-an-inherited-classs-inherited-class", "title": "How to extend an inherited class&#39;s inherited class", "body": "<p>Suppose I have this minimal example:</p>\n\n<pre><code>class BaseClass {\n    void method1();\n};\n\nclass Foo : public BaseClass {\n    void method1();\n};\n\nclass Bar : public Foo {\n    void method1();\n}\n\nclass Interface : public Foo {\n};\n\nclass MyClass : public Interface, public Bar {\n}\n</code></pre>\n\n<p>When implementing <code>MyClass</code>, how can I tell the compiler that <code>Bar</code> is extending the <code>Foo</code> in <code>Interface</code>? I keep getting compiler errors due to the ambiguous conversion.</p>\n\n<p>Note: <code>Foo</code> and <code>Bar</code> are from a library, so I can't implement another interface just to handle this.</p>\n"}, {"tags": ["c++", "casting", "64-bit"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1533746393, "post_id": 51751516, "comment_id": 90463128, "body": "1. Does this need to be thread-safe (I&#39;m assuming reentrancy is a non-issue for localtime)? 2. Is the use of a centrally declared function an option?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533746534, "post_id": 51751516, "comment_id": 90463202, "body": "I suspect the amount of time it would take to properly fix this in the &quot;hundreds&quot; of places you state will be less than the time it will take to try and shim a an obtuse work-around. You could try and craft a <code>_USE_32BIT_TIME_T</code> solution, but it&#39;s a terrible work-around imho."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 2, "creation_date": 1533746545, "post_id": 51751516, "comment_id": 90463207, "body": "How about fixing the code? I mean, put the localtime call into a separate function, put the conversion into this function, and call this function instead of localtime at that 100 places."}, {"owner": {"reputation": 115, "user_id": 3911675, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c7ff785dade27f8c105d911b2f23558e?s=128&d=identicon&r=PG&f=1", "display_name": "printf fan", "link": "https://stackoverflow.com/users/3911675/printf-fan"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1533748654, "post_id": 51751516, "comment_id": 90464329, "body": "@MaxLanghof: yes, it needs to be thread-safe. So, no globals.  @Whoz: can&#39;t use <code>_USE_32BIT_TIME_T</code> for this 64-bit code.  @geza: yeah a separate function, as you and Max mentioned, is probably the way to go."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1533749058, "post_id": 51751516, "comment_id": 90464551, "body": "@printffan: wise choice :) Don&#39;t cast variables like this, that code most likely has undefined behavior, if <code>time_t</code> is not <code>unsigned long</code>."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 3911675, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c7ff785dade27f8c105d911b2f23558e?s=128&d=identicon&r=PG&f=1", "display_name": "printf fan", "link": "https://stackoverflow.com/users/3911675/printf-fan"}, "edited": false, "score": 0, "creation_date": 1533748712, "post_id": 51751951, "comment_id": 90464371, "body": "thanks. Yeah, the separate function (option 2) is a good way to go."}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": false, "score": 1, "last_activity_date": 1533749015, "last_edit_date": 1533749015, "creation_date": 1533747472, "answer_id": 51751951, "question_id": 51751516, "link": "https://stackoverflow.com/questions/51751516/how-to-cast-unsigned-long-to-time-t-in-64-bits/51751951#51751951", "title": "How to cast unsigned long to time_t in 64-bits", "body": "<p>The core of the issue is that we need to provide a pointer to an 8 byte sized memory location to <code>localtime</code> while the one at <code>FileData.LastAccessDateTime</code> is only 4 bytes. So, we need to grab some space elsewhere.</p>\n\n<p><strong>Option 1:</strong> The 8 byte space will be on the <strong>heap</strong>. This should do it:</p>\n\n<pre><code>localtime(std::make_unique&lt;time_t&gt;(FileData.LastAccessDateTime).get());\n</code></pre>\n\n<p>The <code>unique_ptr</code> handles the heap allocation and cleanup. This of course costs you a memory allocation every single time. Whether that's ok is for you to decide.</p>\n\n<p><strong>Option 2:</strong> The 8 byte space will be on the <strong>stack</strong>. There is no way around a function-local object here, but you can wrap it into a convenience function (which you can hopefully have available in all those 100 places):</p>\n\n<pre><code>struct tm * localtime64comp(uint32_t* timer32)\n{\n  uint64_t timer64 = timer32;\n  return localtime(timer64);\n}\n\n// ...\n\nlocaltime64comp((time_t *)&amp;FileData.LastAccessDateTime);\n</code></pre>\n\n<p>If you can't make this function available everywhere, this seems infeasible.</p>\n\n<p><strong>Option 3:</strong> Use a <strong>global</strong> (ugh) for space.</p>\n\n<pre><code>uint64_t LOCALTIME_COMP;\n\n// ...\n\nlocaltime(&amp;(LOCALTIME_COMP = FileData.LastAccessDateTime));\n</code></pre>\n\n<p>This is obviously not thread-safe (edit: you could make it thread-local I guess) and still has the same issue of availability, so I would avoid it. But it would work.</p>\n"}], "owner": {"reputation": 115, "user_id": 3911675, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c7ff785dade27f8c105d911b2f23558e?s=128&d=identicon&r=PG&f=1", "display_name": "printf fan", "link": "https://stackoverflow.com/users/3911675/printf-fan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533749015, "creation_date": 1533745696, "question_id": 51751516, "link": "https://stackoverflow.com/questions/51751516/how-to-cast-unsigned-long-to-time-t-in-64-bits", "title": "How to cast unsigned long to time_t in 64-bits", "body": "<p>I'm calling localtime in C++ like this in 32-bits with MSVC6 (Visual Studio 98):</p>\n\n<pre><code>localtime((time_t *)&amp;FileData.LastAccessDateTime)\n</code></pre>\n\n<p><code>FileData.LastAccessDateTime</code> is an unsigned long and this compiled and ran fine in 32-bits.  I'm now converting the code with VS2017.  It compiles fine in 64-bits but it crashes at runtime inside localtime b/c the upper dword passed into localtime is filled with garbage.  I know I can assign <code>FileData.LastAccessDateTime</code> to a temp time_t variable then take the address of that.  But I want to fix this without making a local temp variable because I have to fix this in 100 other places in the code.  I've tried to cast <code>FileData.LastAccessDateTime</code> to an __int64 but I get a compile error saying: '&amp;' requires lvalue.  That seems odd to me b/c <code>FileData.LastAccessDateTime</code> has a physical address in memory, I'm just changing how to view it (or so I think).</p>\n\n<p>So, how can I change this cast, on one line, to properly upcast an unsigned long to a time_t value?</p>\n"}, {"tags": ["c++", "qt", "qt5", "qabstracttablemodel", "qstyleditemdelegate"], "comments": [{"owner": {"reputation": 267, "user_id": 6385931, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9fafc2536d895b11117a6670e1f4533?s=128&d=identicon&r=PG&f=1", "display_name": "trangan", "link": "https://stackoverflow.com/users/6385931/trangan"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1533795589, "post_id": 51751453, "comment_id": 90479116, "body": "@eyllanesc: numberOfColumns is actually the columnCount of the table. Yeah you are right, I want to use drawText for each indexOfRow but it is impossible until now."}], "answers": [{"comments": [{"owner": {"reputation": 267, "user_id": 6385931, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9fafc2536d895b11117a6670e1f4533?s=128&d=identicon&r=PG&f=1", "display_name": "trangan", "link": "https://stackoverflow.com/users/6385931/trangan"}, "edited": false, "score": 0, "creation_date": 1533796249, "post_id": 51752421, "comment_id": 90479433, "body": "oops, thanks for your help. Sorry I miss a big thing in my requirement here. My problem is: when the mouse is over a cell of the table, I need to <code>change the background of that row AND the color of the text in the whole row</code>. How can I do it?"}, {"owner": {"reputation": 267, "user_id": 6385931, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9fafc2536d895b11117a6670e1f4533?s=128&d=identicon&r=PG&f=1", "display_name": "trangan", "link": "https://stackoverflow.com/users/6385931/trangan"}, "edited": false, "score": 0, "creation_date": 1533797586, "post_id": 51752421, "comment_id": 90480134, "body": "ok i am reading your solution and trying with it. Let&#39;s see how it looks :) Thanks again!"}, {"owner": {"reputation": 267, "user_id": 6385931, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9fafc2536d895b11117a6670e1f4533?s=128&d=identicon&r=PG&f=1", "display_name": "trangan", "link": "https://stackoverflow.com/users/6385931/trangan"}, "edited": false, "score": 0, "creation_date": 1533807954, "post_id": 51752421, "comment_id": 90486229, "body": "Hi, it tooks me a while to try with your solution. It did not work and I found out that setData can not be implemented succesfully because the model I used here is QAbtractTableModel which is not editable model. :((("}, {"owner": {"reputation": 267, "user_id": 6385931, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9fafc2536d895b11117a6670e1f4533?s=128&d=identicon&r=PG&f=1", "display_name": "trangan", "link": "https://stackoverflow.com/users/6385931/trangan"}, "edited": false, "score": 0, "creation_date": 1533808150, "post_id": 51752421, "comment_id": 90486358, "body": "Yeah, but when i set <code>bool result = model()-&gt;setData(model()-&gt;index(row, i), textColor, Qt::ForegroundRole);</code> then I see in debug <code>result = false</code>, which means this command was not set successfully :D"}, {"owner": {"reputation": 267, "user_id": 6385931, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9fafc2536d895b11117a6670e1f4533?s=128&d=identicon&r=PG&f=1", "display_name": "trangan", "link": "https://stackoverflow.com/users/6385931/trangan"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1533808238, "post_id": 51752421, "comment_id": 90486429, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/177711/discussion-between-htmlamateur-and-eyllanesc\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 1, "last_activity_date": 1533811367, "last_edit_date": 1533811367, "creation_date": 1533749221, "answer_id": 51752421, "question_id": 51751453, "link": "https://stackoverflow.com/questions/51751453/how-to-access-another-index-inside-paint-function-of-delegate/51752421#51752421", "title": "How to access another index inside paint() function of delegate?", "body": "<p>I understand that you want to create the effect of changing the color of the row text if the mouse is on any item in the row, I think that for this it is not necessary to use the delegate, just enable <code>mouseTracking</code> and overwrite the <code>mouseMoveEvent</code> method.</p>\n\n<pre><code>#include &lt;QApplication&gt;\n#include &lt;QMouseEvent&gt;\n#include &lt;QStandardItemModel&gt;\n#include &lt;QTableView&gt;\n\nclass TableView: public QTableView{\npublic:\n    TableView(QWidget *parent = nullptr):\n        QTableView(parent)\n    {\n        setMouseTracking(true);\n    }\nprotected:\n    void mouseMoveEvent(QMouseEvent *event)\n    {\n        QModelIndex ix = indexAt(event-&gt;pos());\n        if(mRow != ix.row()){\n            changeRowColor(mRow);\n            if(ix.isValid())\n                changeRowColor(ix.row(), Qt::green, Qt::blue);\n            mRow = ix.row();\n        }\n        QTableView::mouseMoveEvent(event);\n    }\n\n    void leaveEvent(QEvent *event)\n    {\n        changeRowColor(mRow);\n        QTableView::leaveEvent(event);\n    }\nprivate:\n    void changeRowColor(int row, const QColor &amp; textColor=Qt::black, const QColor &amp;backgroundColor=Qt::white){\n        if(!model())\n            return;\n        for(int i=0; i&lt; model()-&gt;columnCount(); i++){\n            model()-&gt;setData(model()-&gt;index(row, i), textColor, Qt::ForegroundRole);\n            model()-&gt;setData(model()-&gt;index(row, i), backgroundColor, Qt::BackgroundRole);\n        }\n    }\n    int mRow = -1;\n};\n\nint main(int argc, char *argv[])\n{\n    QApplication a(argc, argv);\n    TableView w;\n\n    QStandardItemModel model(5, 5);\n    for(int i=0; i &lt; model.rowCount(); i++){\n        for(int j=0; j &lt; model.columnCount(); j++){\n            model.setItem(i, j, new QStandardItem(QString(\"%1-%2\").arg(i).arg(j)));\n        }\n    }\n    w.setModel(&amp;model);\n    w.show();\n    return a.exec();\n}\n</code></pre>\n\n<hr>\n\n<p><strong>Update:</strong></p>\n\n<p>Since you have created your own model using <code>QAbstractTableModel</code> then you must implement the <code>setData()</code> and <code>data()</code> methods to handle the <code>Qt::ForegroundRole</code> and <code>Qt::BackgroundRole</code> roles.</p>\n\n<p>In my example, each item has the following structure:</p>\n\n<pre><code>struct Item{\n    QString text=\"\";\n    QBrush textColor=Qt::black;\n    QBrush bgColor=Qt::white;\n};\n</code></pre>\n\n<p>Then the model must save the data in a <code>QList&lt;QList&lt;Item&gt;&gt; m_items;</code>, assuming the above the methods should be as follows:</p>\n\n<pre><code>QVariant TableModel::data(const QModelIndex &amp;index, int role) const{\n    if (!index.isValid())\n        return QVariant();\n    const Item &amp; item = m_items[index.row()][index.column()];\n    if (role == Qt::DisplayRole)\n        return item.text;\n    else if (role == Qt::ForegroundRole) {\n        return item.textColor;\n    }\n    else if (role == Qt::BackgroundRole) {\n        return item.bgColor;\n    }\n    else\n        return QVariant();\n}\n\nbool TableModel::setData(const QModelIndex &amp;index,\n                         const QVariant &amp;value, int role)\n{\n    if (!index.isValid())\n        return false;\n    Item &amp; item = m_items[index.row()][index.column()];\n    if(role == Qt::EditRole || role == Qt::DisplayRole){\n        item.text = value.toString();\n    }\n    else if (role == Qt::ForegroundRole) {\n        if(value.canConvert&lt;QBrush&gt;())\n            item.textColor = value.value&lt;QBrush&gt;();\n    }\n    else if (role == Qt::BackgroundRole) {\n        if(value.canConvert&lt;QBrush&gt;())\n            item.bgColor = value.value&lt;QBrush&gt;();\n    }\n    else\n        return false;\n    emit dataChanged(index, index);\n    return true;\n}\n</code></pre>\n\n<p>The complete example can be found in the following <a href=\"https://github.com/eyllanesc/stackoverflow/tree/master/51751453\" rel=\"nofollow noreferrer\">link</a></p>\n"}], "owner": {"reputation": 267, "user_id": 6385931, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9fafc2536d895b11117a6670e1f4533?s=128&d=identicon&r=PG&f=1", "display_name": "trangan", "link": "https://stackoverflow.com/users/6385931/trangan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 51752421, "answer_count": 1, "score": 1, "last_activity_date": 1544336617, "creation_date": 1533745443, "last_edit_date": 1544336617, "question_id": 51751453, "link": "https://stackoverflow.com/questions/51751453/how-to-access-another-index-inside-paint-function-of-delegate", "title": "How to access another index inside paint() function of delegate?", "body": "<p>When mouse is over a cell of a table, I need to create an effect for the whole row of that cell. That means I need to access to another index. </p>\n\n<p>In this case I made a for loop, run from the first column to last column of the table and set effect for it. But it does not work. Off course because the command drawText does not have any input parameter as index. How can I set the effect for another index in this case? </p>\n\n<p>Another solution is also welcomed. Thanks!</p>\n\n<pre><code>void TableDelegate::paint( QPainter *painter, const QStyleOptionViewItem &amp;option, const QModelIndex &amp;index ) const\n{\n  qDebug() &lt;&lt; index.row() &lt;&lt; index.column();\n  TableDataRow::Type type = static_cast&lt;TableDataRow::Type&gt;( index.data( Qt::UserRole ).toInt() );\n\n  QString text = index.data( Qt::DisplayRole ).toString();\n  int row = index.row();\n\n  if ( option.state &amp; QStyle::State_MouseOver )\n  {\n     if ( type == TableDataRow::Type::Data )\n     {\n        painter-&gt;fillRect( QRect( 0, option.rect.topLeft().y(), option.rect.width()*numberOfColumns, option.rect.height() ), QColor( 249, 126, 18 ) );\n        for ( int i = 0; i &lt; numberOfColumns; i++ )\n        {\n           QModelIndex indexOfRow = index.sibling( row, i );\n           painter-&gt;setPen( Qt::white );\n           painter-&gt;drawText( option.rect, Qt::AlignVCenter | Qt::TextWordWrap, text );\n        }\n     }\n  }\n}\n</code></pre>\n"}, {"tags": ["c++", "gmp"], "comments": [{"owner": {"reputation": 908, "user_id": 3292279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VX393.jpg?s=128&g=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/3292279/alex-johnson"}, "edited": false, "score": 0, "creation_date": 1533745071, "post_id": 51751302, "comment_id": 90462439, "body": "What happened when you tried to reinstall the program?"}, {"owner": {"reputation": 350, "user_id": 9723461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8fd01cd442e062d643682e3ac4d3b10?s=128&d=identicon&r=PG&f=1", "display_name": "MPops", "link": "https://stackoverflow.com/users/9723461/mpops"}, "edited": false, "score": 1, "creation_date": 1533745750, "post_id": 51751302, "comment_id": 90462797, "body": "looks like you need to either find why mpir.dll is missing or actually try doing what the error message says and reinstalling the program."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1533745980, "post_id": 51751302, "comment_id": 90462926, "body": "<b><i>i cannot run gmp code because of this error</i></b> You probably did not put <code>mpir.dll</code> in one of the folders that is in your system <code>PATH</code> environment variable or add an entry for it to your <code>PATH</code>."}, {"owner": {"reputation": 1, "user_id": 10198834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0efde50edc7369f7b8337f5a334b6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Haz", "link": "https://stackoverflow.com/users/10198834/haz"}, "edited": false, "score": 0, "creation_date": 1533745990, "post_id": 51751302, "comment_id": 90462932, "body": "I already reinstall the program, but the same error happen"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1533746028, "post_id": 51751302, "comment_id": 90462955, "body": "Did you try to locate the file it is asking for? Is in in your <code>PATH</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 602, "user_id": 7736648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6GuvO.png?s=128&g=1", "display_name": "Larry Tang", "link": "https://stackoverflow.com/users/7736648/larry-tang"}, "is_accepted": false, "score": 0, "last_activity_date": 1533754551, "creation_date": 1533754551, "answer_id": 51753834, "question_id": 51751302, "link": "https://stackoverflow.com/questions/51751302/mpir-dll-was-not-found-when-try-to-run-gmp/51753834#51753834", "title": "mpir.dll was not found when try to run gmp", "body": "<p>If you're using the \"Debug\" build option in VS, simply place the \"mpir.dll\" file inside your \"Debug\" folder, next to the generated executable. This will allow the program to find it.</p>\n\n<p>Alternatively, you can place the file in a system directory/PATH, so you don't need to copy it over when creating more programs using GMP.</p>\n"}], "owner": {"reputation": 1, "user_id": 10198834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0efde50edc7369f7b8337f5a334b6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Haz", "link": "https://stackoverflow.com/users/10198834/haz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 318, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1533761551, "creation_date": 1533744945, "last_edit_date": 1533761551, "question_id": 51751302, "link": "https://stackoverflow.com/questions/51751302/mpir-dll-was-not-found-when-try-to-run-gmp", "title": "mpir.dll was not found when try to run gmp", "body": "<p>I use Visual Studio Community 2017 x64, Windows 10, for C++.</p>\n\n<p>I cannot run gmp code because of the following error: </p>\n\n<blockquote>\n  <p>the code execution cannot proceed because mpir.dll was not found. Reinstalling the program may fix this problem</p>\n</blockquote>\n\n<p>Can anyone help me?</p>\n"}, {"tags": ["c++", "csv"], "comments": [{"owner": {"reputation": 680, "user_id": 2303176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f47107aaff2c656bb305e866155258f1?s=128&d=identicon&r=PG", "display_name": "badola", "link": "https://stackoverflow.com/users/2303176/badola"}, "edited": false, "score": 0, "creation_date": 1533745031, "post_id": 51751198, "comment_id": 90462411, "body": "&quot;To get some experience with C++&quot; - I would recommend to write your own C++ solution and ask here on SO, how it could have been made better. That is a definitive way to learn C++."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533745818, "post_id": 51751198, "comment_id": 90462831, "body": "Since you&#39;re learning and probably don&#39;t want to use a library, I&#39;d start with one of the answers to  <a href=\"https://stackoverflow.com/questions/1120140/how-can-i-read-and-parse-csv-files-in-c\">How can I read and parse CSV files in C++?</a>, and discard or not record the row data you do not want. Once you haver that up and running, you&#39;ll probably spot a couple things you can do to improve on it. If not, or you suspect your code can be even better, Code Review may be right for you. 1/2"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533745935, "post_id": 51751198, "comment_id": 90462897, "body": "But first, read <a href=\"https://codereview.stackexchange.com/help/asking\">through the section on Asking Questions in their site help</a> and <a href=\"https://codereview.meta.stackexchange.com/questions/2436/how-to-get-the-best-value-out-of-code-review-asking-questions\">How to get the best value out of Code Review - Asking Questions</a>  2/2"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533745992, "post_id": 51751198, "comment_id": 90462934, "body": "More to the point, ask here if you have <i>problems</i> writing your solution. If your code <i>works</i>, but you would like feedback on it, don&#39;t ask here. <a href=\"http://codereview.stackexchange.com\">Ask <b>here</b> instead</a>."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1533746733, "post_id": 51751198, "comment_id": 90463311, "body": "Search the internet for &quot;c++ read file CSV struct&quot;.  Essentially, model the row with a class or structure.  Use a vector to contain the <i>database</i>.  Remember to overload <code>operator&gt;&gt;</code> to read the structure from an <code>std::istream</code>."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1533746817, "post_id": 51751198, "comment_id": 90463361, "body": "Speaking of <i>database</i>, you may want to research using an actual database, something like MySQL, SqlLite, or Postgres.  Also, read up on &quot;relational database theory&quot;."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1533746935, "post_id": 51751198, "comment_id": 90463425, "body": "If you don&#39;t want to access an external database, you may want to use <code>std::map</code> to create <i>index tables</i>.  The map would be <code>std::map&lt;int, int&gt;</code> where the first type is the column type you want to search and the second is the type for an index into your <code>std::vector</code> database.  This may be faster to search than a linear search (depends on the number of rows)."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1533747064, "post_id": 51751198, "comment_id": 90463503, "body": "To tie this to your question, if you model the row with a structure, you can access any field (a.k.a. column) of the structure, ignoring the other fields.  You may find that reading an entire row is more efficient that reading partial rows (the time difference should be negligible or the ignoring should be slower).  Who know, you may want to access the other columns in the future."}], "owner": {"reputation": 23, "user_id": 8803730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78777de38c2be6d0c3d65ec9b7c0b3bb?s=128&d=identicon&r=PG&f=1", "display_name": "TCLeone", "link": "https://stackoverflow.com/users/8803730/tcleone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533744702, "creation_date": 1533744521, "last_edit_date": 1533744693, "question_id": 51751198, "link": "https://stackoverflow.com/questions/51751198/extract-specific-rows-from-csv-in-c", "title": "Extract specific rows from csv in c++", "body": "<p>I have a csv with weather data and want to work with them a bit. It's only to get some expirience with c++.\nBecause I found no way to upload a attachment, here is a screenshot how it looks and I paste some lines (in the hope the look is the same if you copy&amp;paste it in a txt)</p>\n\n<p><a href=\"https://i.stack.imgur.com/Jc60x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Jc60x.png\" alt=\"csv\"></a></p>\n\n<pre>\nSTATIONS_ID;MESS_DATUM;QN_3;  FX;  FM;QN_4; RSK;RSKF; SDK;SHK_TAG;  NM; VPM;  PM; TMK; UPM; TXK; TNK; TGK;eor\n       4931;20170203;   10;   4.3;   1.3;    3;   0.2;   6;    2.133;-999;   6.4;   8.1;  961.43;    5.2;   91.88;    9.9;    2.5;   -2.7;eor\n       4931;20170204;   10;  14.6;   3.0;    3;   0.1;   6;    0.750;-999;   5.9;   6.8;  957.18;    4.6;   80.88;    8.6;   -0.5;   -4.8;eor\n       4931;20170205;   10;   8.6;   1.8;    3;   0.0;   6;    1.717;-999;   6.0;   6.4;  957.66;    3.8;   80.29;    7.7;   -1.8;   -5.4;eor\n       4931;20170206;   10;   6.2;   1.9;    3;   0.0;   0;    1.533;-999;   7.3;   6.6;  967.88;    3.7;   82.79;    6.2;    2.3;   -0.2;eor\n       4931;20170207;   10;   4.6;   1.1;    3;   0.0;   6;    4.317;-999;   7.2;   6.5;  970.54;    3.4;   83.67;    6.3;    0.7;   -3.3;eor\n       4931;20170208;   10;   6.2;   2.2;    3;   0.0;   6;    1.000;-999;   7.2;   5.9;  973.68;    2.4;   81.33;    5.5;   -1.6;   -5.5;eor\n       4931;20170209;   10;   6.7;   2.8;    3;   0.0;   0;    0.167;-999;   7.3;   4.6;  976.07;   -0.9;   79.71;    0.5;   -3.4;   -8.4;eor\n       4931;20170210;   10;   5.1;   1.8;    3;   0.0;   7;    0.433;-999;   6.8;   5.0;  972.74;   -0.2;   82.92;    2.2;   -2.9;   -7.9;eor\n       4931;20170211;   10;   5.7;   1.4;    3;   0.0;   0;    6.833;-999;   2.8;   5.6;  972.43;    1.1;   85.25;    8.5;   -5.5;   -8.9;eor\n</pre>\n\n<p>Now my question:</p>\n\n<p>Is there a, more or less, simple way to read the csv but put only the marked data in a (2-dimensional) array?</p>\n"}, {"tags": ["c++", "concatenation", "c-strings"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 4, "creation_date": 1533743932, "post_id": 51750936, "comment_id": 90461818, "body": "<code>A += B + C + D;</code> lots of temp strings.  <code>A+=B; A+=C; A+=D;</code>  less (no) temp strings."}, {"owner": {"reputation": 2041, "user_id": 7316365, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/84de9f27708456d85bf1078aa51155b2?s=128&d=identicon&r=PG&f=1", "display_name": "Vivick", "link": "https://stackoverflow.com/users/7316365/vivick"}, "edited": false, "score": 0, "creation_date": 1533743958, "post_id": 51750936, "comment_id": 90461835, "body": "The <code>operator+</code> will coerce the C strings to <code>std::string</code> and therefore leads to allocations as you said. Maybe you could consider using some C string API since these are C strings, like <code>strcat</code> or <code>strncat</code> from <code>&lt;cstring&gt;</code> ?"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "reply_to_user": {"reputation": 2041, "user_id": 7316365, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/84de9f27708456d85bf1078aa51155b2?s=128&d=identicon&r=PG&f=1", "display_name": "Vivick", "link": "https://stackoverflow.com/users/7316365/vivick"}, "edited": false, "score": 0, "creation_date": 1533744013, "post_id": 51750936, "comment_id": 90461857, "body": "@Vivick almost <code>operator+</code> is overloaded for <code>CString</code> and c-strings; the rest is fine."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 2041, "user_id": 7316365, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/84de9f27708456d85bf1078aa51155b2?s=128&d=identicon&r=PG&f=1", "display_name": "Vivick", "link": "https://stackoverflow.com/users/7316365/vivick"}, "edited": false, "score": 0, "creation_date": 1533744149, "post_id": 51750936, "comment_id": 90461935, "body": "@Vivick Or don&#39;t. Benchmark string concatenation, including dynamic memory management on your behalf, of <code>std::string</code> or <code>CString</code> vs. rolling your own and using the likes of <code>strcat</code> and/or <code>strncat</code>. <a href=\"https://www.joelonsoftware.com/2001/12/11/back-to-basics/\" rel=\"nofollow noreferrer\">There&#39;s a reason</a>, those functions are avoided : length determination."}, {"owner": {"reputation": 1115, "user_id": 1682946, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/353303acb6819f99b21ffebf16661f0c?s=128&d=identicon&r=PG", "display_name": "DanielG", "link": "https://stackoverflow.com/users/1682946/danielg"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1533744400, "post_id": 51750936, "comment_id": 90462080, "body": "@Richard Critten: Did a quick test on that, makes no difference"}, {"owner": {"reputation": 2309, "user_id": 282178, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f74864868adc7c2722827f46aed2b23b?s=128&d=identicon&r=PG", "display_name": "OldFart", "link": "https://stackoverflow.com/users/282178/oldfart"}, "edited": false, "score": 0, "creation_date": 1533755070, "post_id": 51750936, "comment_id": 90467624, "body": "The c-strings tag is probably inappropriate as the question is (presumably) about MFC/ATL CString, not c-strings."}], "answers": [{"comments": [{"owner": {"reputation": 1115, "user_id": 1682946, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/353303acb6819f99b21ffebf16661f0c?s=128&d=identicon&r=PG", "display_name": "DanielG", "link": "https://stackoverflow.com/users/1682946/danielg"}, "edited": false, "score": 0, "creation_date": 1533745631, "post_id": 51751135, "comment_id": 90462739, "body": "Will check that. Although I think I have to stick with CString in that legacy code base... or is there an easy way to convert?"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 1115, "user_id": 1682946, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/353303acb6819f99b21ffebf16661f0c?s=128&d=identicon&r=PG", "display_name": "DanielG", "link": "https://stackoverflow.com/users/1682946/danielg"}, "edited": false, "score": 1, "creation_date": 1533745789, "post_id": 51751135, "comment_id": 90462815, "body": "@DanielG You can construct a rope from two iterators, which you can obtain from your <code>CString</code>."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 4, "last_activity_date": 1533744253, "creation_date": 1533744253, "answer_id": 51751135, "question_id": 51750936, "link": "https://stackoverflow.com/questions/51750936/c-concatenation-of-huge-cstrings/51751135#51751135", "title": "C++ Concatenation of Huge CStrings", "body": "<p>For editing large strings you may like to use non-contiguous types <code>rope</code> or <a href=\"https://tzlaine.github.io/text/doc/html/boost/text/unencoded_rope.html\" rel=\"nofollow noreferrer\"><code>unencoded_rope</code></a> - <em>string types that are thread-safe, copy-on-write, or cheap to insert into the middle of</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 1115, "user_id": 1682946, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/353303acb6819f99b21ffebf16661f0c?s=128&d=identicon&r=PG", "display_name": "DanielG", "link": "https://stackoverflow.com/users/1682946/danielg"}, "edited": false, "score": 0, "creation_date": 1533797546, "post_id": 51754183, "comment_id": 90480117, "body": "thanks. that&#39;s what I was looking for. But I accept the other similar answer, since I&#39;m going with that one."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 2, "last_activity_date": 1533756105, "creation_date": 1533756105, "answer_id": 51754183, "question_id": 51750936, "link": "https://stackoverflow.com/questions/51750936/c-concatenation-of-huge-cstrings/51754183#51754183", "title": "C++ Concatenation of Huge CStrings", "body": "<p>Pre-allocate a single <code>CString</code> of the desired concatenated length, and then copy the data from the smaller strings into its internal buffer, eg:</p>\n\n<pre><code>CString Huge_CString = ...;\nLPCTSTR ss1 = TEXT(\"Some smaller String\");\nLPCTSTR ss2 = TEXT(\"Some smaller String\");\n\nint ss1_len = lstrlen(ss1);\nint huge_len = Huge_CString.GetLength();\nint ss2_len = lstrlen(ss2);\n\nint concat_len = ss1_len + huge_len + ss2_len;\n\nCString Concat_CString;\nPXSTR buffer = Concat_CString.GetBufferSetLength(concat_len);\nCString::CopyChars(buffer, ss1, ss1_len);\nbuffer += ss1_len;\nCString::CopyChars(buffer, Huge_CSString.GetBuffer(), huge_len);\nbuffer += huge_len;\nCString::CopyChars(buffer, ss2, ss2_len);\nConcat_CString.ReleaseBuffer(total_len);\n\n// use Concat_CString as needed...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1533803156, "post_id": 51754657, "comment_id": 90483238, "body": "I completely missed <code>Preallocate()</code> while going through the <code>CString</code> methods. This is definitely much nicer. And  <code>operator+=</code> works without having to call <code>GetString()</code>: <code>result += prefix; result += bigString; result += suffix;</code> This avoids having to re-count the characters, or make temp objects."}], "tags": [], "owner": {"reputation": 2309, "user_id": 282178, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f74864868adc7c2722827f46aed2b23b?s=128&d=identicon&r=PG", "display_name": "OldFart", "link": "https://stackoverflow.com/users/282178/oldfart"}, "is_accepted": true, "score": 3, "last_activity_date": 1533758138, "creation_date": 1533758138, "answer_id": 51754657, "question_id": 51750936, "link": "https://stackoverflow.com/questions/51750936/c-concatenation-of-huge-cstrings/51754657#51754657", "title": "C++ Concatenation of Huge CStrings", "body": "<p>I will suggest essentially the same thing as Remy Lebeau, but using some different functions.  I'm not sure what version of MFC/ATL introduced the CString::Preallocate function, so it is possibly you are stuck with a version of MFC/ATL that does not have this function.</p>\n\n<pre><code>    CString result(_T(\"Initial string \"));\n    CString prefix(_T(\"Prefix string:\"));\n    CString suffix(_T(\":Suffix string\"));\n    CString bigString(_T(\"This really isn't very big.\"));\n\n    auto totalLength = result.GetLength() + prefix.GetLength() + bigString.GetLength() + suffix.GetLength();\n\n    result.Preallocate(totalLength);\n\n    result += prefix.GetString();\n    result += bigString.GetString();\n    result += suffix.GetString();\n</code></pre>\n\n<p>The calls to CString::GetString may or may not be useful.  You will likely get the same allocation behavior by just appending each of the sub-strings to <code>result</code>.</p>\n"}], "owner": {"reputation": 1115, "user_id": 1682946, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/353303acb6819f99b21ffebf16661f0c?s=128&d=identicon&r=PG", "display_name": "DanielG", "link": "https://stackoverflow.com/users/1682946/danielg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 51754657, "answer_count": 3, "score": 1, "last_activity_date": 1533758138, "creation_date": 1533743677, "question_id": 51750936, "link": "https://stackoverflow.com/questions/51750936/c-concatenation-of-huge-cstrings", "title": "C++ Concatenation of Huge CStrings", "body": "<p>I got a problem with concatenation of huge CStrings in a legacy code base. The CStrings can contain base64 encoded files and so can be huge. At several points those CStrings are concatenated like this:</p>\n\n<p><code>result += CString(_T(\"Some smaller String\")) + Huge_CString + _T(\"Some smaller String\");</code></p>\n\n<p>This leads to several allocations and so we get huge memory peaks. Although this is done in parallel on multiple threads for different files. If they all come together I will finally get \"Memory Exceptions\".</p>\n\n<p>What is the best way to handle this. If I could reduce the number of allocations that would help already. Right now I'm not looking for the perfect solution, but for a way to just reduce the peaks.</p>\n"}, {"tags": ["c++", "vector", "random-access"], "comments": [{"owner": {"reputation": 1732, "user_id": 8121683, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1fnlik1dgxU/AAAAAAAAAAI/AAAAAAAAATk/MvX5UOgKBfg/photo.jpg?sz=128", "display_name": "Easton Bornemeier", "link": "https://stackoverflow.com/users/8121683/easton-bornemeier"}, "edited": false, "score": 2, "creation_date": 1533743466, "post_id": 51750823, "comment_id": 90461548, "body": "If i remember correctly, vectors allocate memory in chunks. You probably can&#39;t access a higher index. Regardless, this behavior is undefined"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1533743516, "post_id": 51750823, "comment_id": 90461580, "body": "When first working with vectors (or even other containers) use <code>at</code> instead of <code>[]</code> at first.  <code>at</code> will catch when you go out of bounds and throw an exception."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1533743562, "post_id": 51750823, "comment_id": 90461610, "body": "@NathanOliver: Although, that&#39;s at some cost, which can be material especially when working through linear algebra calculations."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1533743731, "post_id": 51750823, "comment_id": 90461709, "body": "<i>But if we do a single push_back() operation, then we can do random access there is no error:</i> -- There is an error -- you chose an element that is outside the bounds of the vector.  What is the visible results of that error is a different story."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1533743746, "post_id": 51750823, "comment_id": 90461722, "body": "@Bathsheba True but when you first start learning about vector I would think safety should trump speed, at least until you get the hang of it."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1533744665, "post_id": 51750823, "comment_id": 90462218, "body": "You are accessing out of bounds. This is Undefined Behaviour. You broke the rules of the language and <i>any</i> result is possible. Don&#39;t do that."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1533744816, "post_id": 51750823, "comment_id": 90462295, "body": "Undefined behavior means only that the language definition does not tell you what the code should do. It does not mean that something bad will happen, although that&#39;s often the result."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 2, "creation_date": 1533745357, "post_id": 51750823, "comment_id": 90462595, "body": "@PeteBecker I categorise <i>silently continuing with garbage</i> as &quot;something bad&quot;. <b>Much worse</b> than terminating unexpectedly"}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1533744167, "post_id": 51750835, "comment_id": 90461945, "body": "I can see the case for not wanting defragmentation, but I think &quot;against memory fragmentation&quot; is a bit clearer."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533745227, "post_id": 51750835, "comment_id": 90462525, "body": "Psychic debugging: Segmentation faults have a granularity of pages, and the <code>std::allocator&lt;int&gt;</code> allocated near (at?) the start of a page"}, {"owner": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 0, "creation_date": 1533745803, "post_id": 51750835, "comment_id": 90462822, "body": "Is a vector required to allocate space at all before you put something into it?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 0, "creation_date": 1533745859, "post_id": 51750835, "comment_id": 90462857, "body": "@cHao: No it isn&#39;t."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1533746768, "post_id": 51750835, "comment_id": 90463329, "body": "I might be wrong but i think vectors allocating more capacity than needed is to avoid frequent reallocations (lets say in a loop that uses <code>push_back</code>) rather than to avoid memory defragmentation. Or maybe you mean the same thing ;)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533746822, "post_id": 51750835, "comment_id": 90463365, "body": "@user463035818: Yes, yours is a better way of putting it."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 4, "last_activity_date": 1533746805, "last_edit_date": 1533746805, "creation_date": 1533743394, "answer_id": 51750835, "question_id": 51750823, "link": "https://stackoverflow.com/questions/51750823/random-access-in-vector-in-c/51750835#51750835", "title": "Random access in vector in c++", "body": "<p>The behaviour on attempting to acquire an element of a <code>std::vector</code> that's outside the <em>bounds</em> of that vector is <em>undefined</em>. <strong>Don't</strong> do it, and don't rely on any behaviour.</p>\n\n<p>Perhaps your <code>push_back</code> causes <code>std::vector</code> to grab more memory than it needs as a guard against frequent reallocation and memory defragmentation?</p>\n"}], "owner": {"reputation": 29, "user_id": 7317094, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OLonmP39G_g/AAAAAAAAAAI/AAAAAAAAAD4/ZjZ70ZexIU8/photo.jpg?sz=128", "display_name": "Rajdeep Sarkar", "link": "https://stackoverflow.com/users/7317094/rajdeep-sarkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "closed_date": 1533744632, "answer_count": 1, "score": 0, "last_activity_date": 1533746805, "creation_date": 1533743341, "question_id": 51750823, "link": "https://stackoverflow.com/questions/51750823/random-access-in-vector-in-c", "closed_reason": "Duplicate", "title": "Random access in vector in c++", "body": "<p>While trying to randomly access an empty vector in c++, there is segmentation fault.</p>\n\n<pre><code>vector&lt;int&gt; g;\ncout&lt;&lt;g[3];  //Segmentation fault\n</code></pre>\n\n<p>But if we do a single push_back() operation, then we can do random access there is no error:</p>\n\n<pre><code>vector&lt;int&gt; g;\ng.push_back(1);\ncout&lt;&lt;g[0]; //output = 1\ncout&lt;&lt;g[3]; //output = 0\n</code></pre>\n\n<p>What is the reason behind this??</p>\n"}, {"tags": ["c++", "stl"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533743557, "post_id": 51750615, "comment_id": 90461604, "body": "<code>(*it)</code> ===&gt; <code>(*it).cbegin()</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1533743563, "post_id": 51750615, "comment_id": 90461611, "body": "<code>*it</code> should give you the  first <code>vector</code> in the <code>set</code> (<code>vector&lt;int&gt; temp</code> or <code>const vector&lt;int&gt; &amp; temp</code> depending on how much copying you want to do). If you want a <code>const</code> iterator to that <code>vector</code>, use <code>it-&gt;cbegin();</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1533744996, "post_id": 51750615, "comment_id": 90462395, "body": "@WhozCraig why not <code>it-&gt;cbegin()</code>?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533745060, "post_id": 51750615, "comment_id": 90462432, "body": "@user4581301 you don&#39;t need <code>cbegin()</code>, because the vector is <code>const</code>, being the key of a <code>set</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533745289, "post_id": 51750615, "comment_id": 90462562, "body": "Good to know. Thanks."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1533745630, "post_id": 51750615, "comment_id": 90462738, "body": "@n.m. No particular reason whatsoever."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1533756952, "creation_date": 1533756952, "answer_id": 51754382, "question_id": 51750615, "link": "https://stackoverflow.com/questions/51750615/what-do-iterators-actually-point-to-in-a-container/51754382#51754382", "title": "what do iterators actually point to in a container?", "body": "<blockquote>\n  <p>I know that (it) is pointing to a vector</p>\n</blockquote>\n\n<p>No.  It refers to an element of the <code>set</code>, not to the content (a <code>vector</code>) held within that element.</p>\n\n<blockquote>\n  <p>so if i write <code>vector ::const_iterator temp=(*it)</code> , <code>temp</code> should point to first element of the vector?</p>\n</blockquote>\n\n<p>No.  When you dereference <code>it</code>, you are accessing the <code>vector</code> itself that is held within the <code>set</code> element.  You are not accessing any of the <code>vector</code>'s elements.  For that, you need to use the <code>vector</code>'s own methods, eg:</p>\n\n<pre><code>set&lt; vector&lt;int&gt; &gt; myset;\n...\nset&lt; vector&lt;int&gt; &gt;::iterator it;\nfor(it = myset.begin(); it != myset.end(); ++it)\n{\n    vector&lt;int&gt;::const_iterator temp = (*it).begin(); // or: it-&gt;begin()\n    /* which is the same as doing this:\n    vector&lt;int&gt; &amp;v = *it;\n    vector&lt;int&gt;::const_iterator temp = v.begin();\n    */\n}\n</code></pre>\n\n<blockquote>\n  <p>why is this not happening ?</p>\n</blockquote>\n\n<p>Because there is no implicit conversion from a <code>vector&amp;</code> to a <code>vector::const_iterator</code>.</p>\n\n<blockquote>\n  <p>what does a <code>iterator</code> actually point to in a container ?</p>\n</blockquote>\n\n<p>That is implementation-defined.  But in general, an iterator is a conceptual index/pointer to an element of the container.  You have to dereference the iterator to access the content of that element.</p>\n\n<blockquote>\n  <p>how will i traverse the container in such a situation ?</p>\n</blockquote>\n"}], "owner": {"reputation": 43, "user_id": 9566213, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fSl3RH4PUVA/AAAAAAAAAAI/AAAAAAAAABo/0wABioafGJQ/photo.jpg?sz=128", "display_name": "Rohit Pandit", "link": "https://stackoverflow.com/users/9566213/rohit-pandit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533756952, "creation_date": 1533742687, "last_edit_date": 1533743242, "question_id": 51750615, "link": "https://stackoverflow.com/questions/51750615/what-do-iterators-actually-point-to-in-a-container", "title": "what do iterators actually point to in a container?", "body": "<pre><code>set &lt;vector&lt;int&gt; &gt; myset;\nvector&lt;int&gt; v1= { 34,634,758,46,64 };\nvector&lt;int &gt;v2= {325, 7457, 586, 865};\nmyset.insert(v1);\nmyset.insert(v2);\nset&lt;vector&lt;int&gt; &gt; ::iterator it;\nit = myset.begin();\nfor (; it != myset.end(); it++)\n{\n    vector&lt;int&gt; ::const_iterator temp = (*it);\n\n}\n</code></pre>\n\n<p>I know that (it) is pointing to a vector so if i write vector ::const_iterator temp=(*it) , temp should point to first element of the vector? \nwhy is this not happening ? what does a iterator actually point to in a container ? how will i traverse the container in such a situation ?</p>\n"}, {"tags": ["c++", "cuda"], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 4400686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812a51d21bfa004b03873b844f146ba5?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Taw", "link": "https://stackoverflow.com/users/4400686/eric-taw"}, "edited": false, "score": 0, "creation_date": 1533747373, "post_id": 51751100, "comment_id": 90463690, "body": "Copying would mean having a duplicate array in memory, right? That could work I suppose. Would this look like <code>cudaMallocManaged(*new_variable, size); cudaMemcpy(*new_variable, *old_variable, size, cudaMemcpyHostToDevice); free(*old_variable);</code>?"}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "reply_to_user": {"reputation": 191, "user_id": 4400686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812a51d21bfa004b03873b844f146ba5?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Taw", "link": "https://stackoverflow.com/users/4400686/eric-taw"}, "edited": false, "score": 0, "creation_date": 1533753138, "post_id": 51751100, "comment_id": 90466739, "body": "approximately. <code>cudaMallocManaged(&amp;new_pointer, size); memcpy(new_pointer, old_pointer, size); free(old_pointer);</code>"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1533763814, "post_id": 51751100, "comment_id": 90471403, "body": "There can&#39;t be support for this on x86 platforms, and never can be, because it&#39;s in the essence of the platform. On Power9, the Volta GPU is integrated so as to have direct acces to system memory without going through a PCIe bus - it&#39;s a &quot;first-class citizen&quot; just like the CPU, so that all system memory is unified."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1533765059, "post_id": 51751100, "comment_id": 90471825, "body": "I wouldn&#39;t say never.  The linux HMM patch if it ever gets here, will essentially enable this sort of behavior on x86.  Yes, there are implementation differences.  But the net effect is that data allocated using a system allocator will be directly accessible to the GPU, even over PCIE.  But the linux HMM patch is not ready yet."}], "tags": [], "owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "is_accepted": true, "score": 1, "last_activity_date": 1533744115, "creation_date": 1533744115, "answer_id": 51751100, "question_id": 51750543, "link": "https://stackoverflow.com/questions/51750543/cudamallocmanaged-for-host-initiated-variable/51751100#51751100", "title": "cudaMallocManaged for host-initiated variable", "body": "<p>This can't be done, unless you copy the data from your host allocation to the managed allocation.   (Which presumably is not what you are asking about.)</p>\n\n<p>On an IBM Power9 platform, your <a href=\"https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#um-system-allocator\" rel=\"nofollow noreferrer\">host allocated data can still be accessed from device code</a>, however there is currently no corresponding method on x86 platforms.</p>\n"}], "owner": {"reputation": 191, "user_id": 4400686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812a51d21bfa004b03873b844f146ba5?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Taw", "link": "https://stackoverflow.com/users/4400686/eric-taw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "accepted_answer_id": 51751100, "answer_count": 1, "score": 0, "last_activity_date": 1533744115, "creation_date": 1533742436, "question_id": 51750543, "link": "https://stackoverflow.com/questions/51750543/cudamallocmanaged-for-host-initiated-variable", "title": "cudaMallocManaged for host-initiated variable", "body": "<p>I have an Eigen array generated by the host device, which I would like to put onto the GPU via CUDA's Unified Memory. Most examples I found first pass a pointer to <code>cudaMallocManaged</code> and allocate the memory there before initiating the array afterwards. How do I do the opposite, ie allocate the memory on the host, fill it with values, and then move it to the Unified Memory system?</p>\n"}, {"tags": ["c++", "qt", "curl", "qt5", "qprocess"], "comments": [{"owner": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "edited": false, "score": 1, "creation_date": 1533742598, "post_id": 51750422, "comment_id": 90461013, "body": "What is your question?"}, {"owner": {"reputation": 7466, "user_id": 2146682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7120fc7548c43237662da906e3c84f43?s=128&d=identicon&r=PG", "display_name": "MrEricSir", "link": "https://stackoverflow.com/users/2146682/mrericsir"}, "edited": false, "score": 0, "creation_date": 1533752940, "post_id": 51750422, "comment_id": 90466623, "body": "Any reason to rely on <code>curl</code> when Qt has a perfectly good network API built in?"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 1736541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20dc9d7918f7c29920c72d9995b4a0a8?s=128&d=identicon&r=PG", "display_name": "Sunmi", "link": "https://stackoverflow.com/users/1736541/sunmi"}, "edited": false, "score": 0, "creation_date": 1533786424, "post_id": 51753510, "comment_id": 90476271, "body": "perlProcess.readAll() don&#39;t bring data.&lt;/br&gt; When I test on terminal, Json data show on terminal. ``` yoshimi~/Music/cridb/dbpediaPlaceData$ curl -s &quot;<a href=\"http://dbpedia.org/data/Haeinsa.json\" rel=\"nofollow noreferrer\">dbpedia.org/data/Haeinsa.json</a>&quot;  | perl dbpediaPlaceData.txt &#39;Haeinsa&#39;    &quot;command&quot;: &quot;save&quot;,   &quot;record_type&quot;: &quot;thing&quot;,   &quot;data&quot;: {     &quot;lat&quot;: 35.7999992370605,     &quot;subtype&quot;: &quot;place&quot;,     &quot;name&quot;: &quot;Haeinsa&quot;,     &quot;long&quot;: 128.100006103516,     &quot;notes&quot;: &quot;wkpd-Haeinsa&quot;   } ```"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 41, "user_id": 1736541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20dc9d7918f7c29920c72d9995b4a0a8?s=128&d=identicon&r=PG", "display_name": "Sunmi", "link": "https://stackoverflow.com/users/1736541/sunmi"}, "edited": false, "score": 0, "creation_date": 1533788450, "post_id": 51753510, "comment_id": 90476754, "body": "@Sunmi try again"}, {"owner": {"reputation": 41, "user_id": 1736541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20dc9d7918f7c29920c72d9995b4a0a8?s=128&d=identicon&r=PG", "display_name": "Sunmi", "link": "https://stackoverflow.com/users/1736541/sunmi"}, "edited": false, "score": 0, "creation_date": 1533790784, "post_id": 51753510, "comment_id": 90477385, "body": "I build and but terminal don&#39;t show data. I put function on int main(int argc, char *argv[]){  } ."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 41, "user_id": 1736541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20dc9d7918f7c29920c72d9995b4a0a8?s=128&d=identicon&r=PG", "display_name": "Sunmi", "link": "https://stackoverflow.com/users/1736541/sunmi"}, "edited": false, "score": 0, "creation_date": 1533790995, "post_id": 51753510, "comment_id": 90477459, "body": "@Sunmi copy and try again please. :)"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 41, "user_id": 1736541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20dc9d7918f7c29920c72d9995b4a0a8?s=128&d=identicon&r=PG", "display_name": "Sunmi", "link": "https://stackoverflow.com/users/1736541/sunmi"}, "edited": false, "score": 0, "creation_date": 1533835263, "post_id": 51753510, "comment_id": 90504201, "body": "@Sunmi  <code>QString filename = &quot;dbpediaPlaceData.txt&quot;;</code> to <code>QString filename = &quot;&#47;full&#47;path&#47;of&#47;dbpediaPlaceData.txt&quot;</code>"}, {"owner": {"reputation": 41, "user_id": 1736541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20dc9d7918f7c29920c72d9995b4a0a8?s=128&d=identicon&r=PG", "display_name": "Sunmi", "link": "https://stackoverflow.com/users/1736541/sunmi"}, "edited": false, "score": 0, "creation_date": 1533878628, "post_id": 51753510, "comment_id": 90516671, "body": "Your answer help me lots !"}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 1, "last_activity_date": 1533788399, "last_edit_date": 1533788399, "creation_date": 1533753280, "answer_id": 51753510, "question_id": 51750422, "link": "https://stackoverflow.com/questions/51750422/send-command-to-server-using-qprocess/51753510#51753510", "title": "send command to server using QProcess", "body": "<p>From what I understand you want to implement the command using <code>QProcess</code>, so the main difficulty is to implement the pipe: <code>|</code>, in this case you must use <code>setStandardOutputProcess()</code>:</p>\n\n<pre><code>QProcess curlProcess;\nQProcess perlProcess;\nQString filename = \"/Users/yoshimi/Music/cridb/dbpediaPlaceData/dbpediaPlaceData.txt\";\ncurlProcess.setStandardOutputProcess(&amp;perlProcess);\ncurlProcess.start(\"curl\", {\"-s\", \"http://dbpedia.org/data/Haeinsa.json\"});\nif (curlProcess.waitForFinished()){\n    perlProcess.start(\"perl\", { filename, \"Haeinsa\"});\n    if(perlProcess.waitForFinished()){\n        qDebug()&lt;&lt; perlProcess.readAll();\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 1736541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20dc9d7918f7c29920c72d9995b4a0a8?s=128&d=identicon&r=PG", "display_name": "Sunmi", "link": "https://stackoverflow.com/users/1736541/sunmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "accepted_answer_id": 51753510, "answer_count": 1, "score": 1, "last_activity_date": 1550841334, "creation_date": 1533742045, "last_edit_date": 1550841334, "question_id": 51750422, "link": "https://stackoverflow.com/questions/51750422/send-command-to-server-using-qprocess", "title": "send command to server using QProcess", "body": "<p><br>I made simple example using QProcess. \n<br>Just get json value from DBpedia server. \n<br> <strong>Q.How can make command using QProcess?</strong> </p>\n\nOriginal command\n\n<pre><code>curl -s \"http://dbpedia.org/data/Haeinsa.json\"| perl dbpediaPlaceData.txt 'Haeinsa'\n</code></pre>\n\n<h3>My code</h3>\n\n1. get JSON value from DBPedia server\n\n<pre><code>#include &lt;QCoreApplication&gt;\n#include &lt;QDebug&gt;\n#include &lt;QProcess&gt;\n#include &lt;QFileInfo&gt;\n\nint main(int argc, char *argv[])\n{\n    QCoreApplication a(argc, argv);\n\n    QString command=\"curl\";\n    QProcess pro;\n    QStringList arg;\n    arg.append(\"-v\");\n    arg.append(\"--insecure\");\n    arg.append(\"GET\");\n    arg.append(\"http://dbpedia.org/data/Haeinsa.json\");\n\n    pro.execute(command,arg);\n    pro.start(command);\n    pro.waitForStarted();\n    pro.waitForReadyRead();\n    pro.waitForFinished();\n\n    QByteArray qa=pro.readAll();\n    QString reply=QString::fromUtf8(qa);\n    qDebug() &lt;&lt; reply;\n\n    return a.exec();\n}\n</code></pre>\n\n2.  perl dbpediaPlaceData.txt 'Haeinsa'\n\n<pre><code>void processPerl()\n{\n    QString command = \"perl\";\n    QString fileName =\"/Users/yoshimi/dbpediaPlaceData.txt \";\n    QString cmd = \"perl\" + fileName + \"Haeinsa\";\n\n    QProcess* process_screen = new QProcess();\n    process_screen-&gt;start(cmd);\n\n    process_screen-&gt;waitForStarted();\n    QByteArray q=process_screen-&gt;readAll();\n    QString replyB=QString::fromUtf8(q);\n    qDebug() &lt;&lt; replyB;\n\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 2, "creation_date": 1533741662, "post_id": 51750227, "comment_id": 90460360, "body": "What do you mean &quot;doesn&#39;t work&quot;?"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 2, "creation_date": 1533741728, "post_id": 51750227, "comment_id": 90460406, "body": "@SombreroChicken If it&#39;s not a header-only library, including the headers into the wrong namespace will &quot;promise&quot; to the linker that certain symbols will exist in that namespace that it won&#39;t find there. Think of mangled names."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 2, "creation_date": 1533741758, "post_id": 51750227, "comment_id": 90460433, "body": "It is not supposed to work because that library does not export names from whatever namespace you include it&#39;s header into."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1533741867, "post_id": 51750227, "comment_id": 90460526, "body": "@VTT if it seems obvious it is worth adding to the quesiton. Not everybody is that clever ;)"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533742104, "post_id": 51750227, "comment_id": 90460682, "body": "<i>&quot;I don&#39;t want to have conflicts&quot;</i> - you&#39;re authoring the remainder of the code (the standard library notwithstanding). So, don&#39;t code any conflicts. You opened your question with <i>&quot; I am trying to link to an external library&quot;</i> - did that <i>not</i> work? If not, was it specifically because of duplicate identifiers at link-time? Because if not, you&#39;re solving the wrong problem."}, {"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 1, "creation_date": 1533742359, "post_id": 51750227, "comment_id": 90460859, "body": "There is nothing in C++ like this (probably the hyped <a href=\"https://medium.com/@wrongway4you/brief-article-on-c-modules-f58287a6c64\" rel=\"nofollow noreferrer\">modules TS</a> could solve that, with some syntax to import declarations under a namespace). If you are really concerned about conflicts, the usual approach is to wrap the 3rd party API with you functions under your own namespace, etc."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1533742597, "post_id": 51750227, "comment_id": 90461012, "body": "@WhozCraig I don&#39;t like having arbitrary identifiers taken away from me (or worse, malfunctioning). There is a reason why namespaces exist, and dismissing a desire to isolate code into appropriate namespaces should not be met with &quot;just don&#39;t produce any conflicts&quot; - we wouldn&#39;t need namespaces then."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1533742788, "post_id": 51750227, "comment_id": 90461131, "body": "File a critical defect report against the library."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1533742999, "post_id": 51750227, "comment_id": 90461271, "body": "@MaxLanghof Thanks for clarifying the motivation. I concur that namespaces <i>do</i> exist for fundamental reasons, and identifier isolation is among them."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1533743258, "post_id": 51750227, "comment_id": 90461426, "body": "I really don&#39;t think there is anything you can do, unless it happens to be open source and you are able to write a patch to fix it."}], "answers": [{"comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1533743264, "post_id": 51750553, "comment_id": 90461432, "body": "Sans-header only situations, this is by far the most common method I&#39;ve used in the past for this. Important to note, to avoid identifier conflicts at <i>link</i> time, said-wrapper will have to be in its own isolated module (a DLL, a .so, choose your poison), exposing only the now-namespace-wrapped functions. If link-time conflicts are the problem, be prepared for that."}, {"owner": {"reputation": 7089, "user_id": 2852165, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JwDJG.jpg?s=128&g=1", "display_name": "SHR", "link": "https://stackoverflow.com/users/2852165/shr"}, "edited": false, "score": 0, "creation_date": 1533743437, "post_id": 51750553, "comment_id": 90461532, "body": "Another possible solution, but only for c library is described here: <a href=\"https://stackoverflow.com/questions/4350756/is-it-possible-to-add-a-c-namespace-to-all-symbols-from-a-c-library\" title=\"is it possible to add a c namespace to all symbols from a c library\">stackoverflow.com/questions/4350756/&hellip;</a>"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533743481, "post_id": 51750553, "comment_id": 90461556, "body": "@WhozCraig Makes sense. I guess  you can avoid this need by having all your own code within namespaces though (anonymous ones if need be), although I don&#39;t know if there might be a reason that you can&#39;t do that. Well, I suppose if you have <i>two</i> such abhorrent namespace-free libraries they might conflict. *shudder*"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533743828, "post_id": 51750553, "comment_id": 90461754, "body": "@MaxLanghof Heh, sure. If you can&#39;t namespace the third-party code, namespace everything else. Yeah, that would work, but whoa man. Regarding anonymous namespaces, for static per-module stuff, you&#39;re nuts not to use them. I cannot do justice to describe just how much pollution I&#39;ve cleaned out of the global namespace from years of technical debt and just-put-that-unnecessary-global-there practices in the code I work inherit at work. And they <i>still</i> do it even after being told not to. Almost can&#39;t keep up. Anyway, good answer."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1533755865, "post_id": 51750553, "comment_id": 90467948, "body": "It doesn&#39;t even work for any header-only library that includes a standard library header."}, {"owner": {"reputation": 448, "user_id": 7128430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f3450504ab39c789699001cc46f4bba?s=128&d=identicon&r=PG&f=1", "display_name": "Emile D.", "link": "https://stackoverflow.com/users/7128430/emile-d"}, "edited": false, "score": 0, "creation_date": 1534280178, "post_id": 51750553, "comment_id": 90652516, "body": "@MaxLanghof For now, you clearly have the best answer! The main drawback that refrains me from ticking the &quot;solved question&quot; icon, is that we need to duplicate the API, which can&#39;t be a long term solution. The one from jdehesa is also very promising, if the TS module would work that way. If that happen to be the magic solution for this problem, I would gladly validate it!"}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": false, "score": 10, "last_activity_date": 1533742465, "creation_date": 1533742465, "answer_id": 51750553, "question_id": 51750227, "link": "https://stackoverflow.com/questions/51750227/namespace-for-external-library-in-c/51750553#51750553", "title": "Namespace for external library in C++", "body": "<p>If you are working with a header-only library, your mentioned approach will probably work. At least I can't think of any issue right away.</p>\n\n<p>But if you have a compiled library that you have to link to, there is no way to put the library functions themselves into their own namespace (at least not without recompiling your own version of said library). That's because in the <code>.dll</code> or <code>.so</code> or what have you, each function has a mangled name that <strong>includes all namespaces</strong> (<a href=\"https://godbolt.org/g/nfvaoa\" rel=\"noreferrer\">example</a>). When you eventually link against the library, you can only \"reach\" those functions under that exact mangled name, which requires that your function calls are against that same (or, in your case, no) namespace as the compiled versions.</p>\n\n<p>The \"classic\" workaround is to write a thin wrapper around the library, where for every exposed function, you do:</p>\n\n<p><strong>wrapper.h</strong>:</p>\n\n<pre><code>namespace libraryWrapper\n{\n  void bar(int);\n}\n</code></pre>\n\n<p><strong>wrapper.cpp</strong></p>\n\n<pre><code>#include \"realLibrary.h\" // Defines bar(int)\n\nvoid libraryWrapper::bar(int x)\n{\n  ::bar(x)\n}\n</code></pre>\n\n<p><a href=\"https://godbolt.org/g/cinpMj\" rel=\"noreferrer\">Basic example</a></p>\n"}], "owner": {"reputation": 448, "user_id": 7128430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f3450504ab39c789699001cc46f4bba?s=128&d=identicon&r=PG&f=1", "display_name": "Emile D.", "link": "https://stackoverflow.com/users/7128430/emile-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3932, "favorite_count": 2, "answer_count": 1, "score": 10, "last_activity_date": 1533742465, "creation_date": 1533741424, "question_id": 51750227, "link": "https://stackoverflow.com/questions/51750227/namespace-for-external-library-in-c", "title": "Namespace for external library in C++", "body": "<p>I am trying to link to an external library, on which I have no control, that doesn't have any namespace for its functions.</p>\n\n<p>Since I don't want to have conflicts with the names defined in that library: how to include the external headers in a namespace that I would create myself?</p>\n\n<p>I know that the following code doesn't work, but the spirit of the question is there:</p>\n\n<pre><code>namespace extLib {\n  #include \"externalFolder/externalHeader.h\"\n}\n</code></pre>\n"}, {"tags": ["c++", "iomanip"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1533742902, "post_id": 51750191, "comment_id": 90461211, "body": "My go to solution would be to stringify it like you did in <code>B</code>.  Since output is slow already you might not even notice the hit."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1533743133, "post_id": 51750191, "comment_id": 90461339, "body": "@NathanOliver hum... I remember long time ago I was wondering whether I should make it my habit to write a <code>foo::toString()</code> or overload the <code>ostream::&lt;&lt;</code>, now I am starting to think it is best to have both"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1533743219, "post_id": 51750191, "comment_id": 90461397, "body": "That would be another approach.  Then if your less expensive <code>operator &lt;&lt;</code> breaks the formatting you can make the choice to call the more expensive <code>to_string</code>."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1533743259, "post_id": 51750191, "comment_id": 90461427, "body": "@NathanOliver I actually meant <code>&lt;&lt;</code> calling the <code>toString</code>, well, dont know, have to meditate over it ;)"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1533757264, "post_id": 51750191, "comment_id": 90468525, "body": "@user463035818 Things like <code>set::left</code>, <code>std::setw()</code>, etc that set flags on <code>std::ostream</code> usually only apply to the <i>next</i> invocation of <code>operator&lt;&lt;</code> on that <code>std::ostream, and then they get reset afterwards. That is why you see the alignment only being applied to </code>f.a` and not to <code>f.b</code> when using <code>out &lt;&lt; f.a &lt;&lt; f.b;</code>. This is documented behavior. If you want to format multiple values in a particular way, you have to format them yourself first, and then send the final result to <code>out</code>, like you do with <code>out &lt;&lt; ss.str();</code>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1533757534, "post_id": 51750191, "comment_id": 90468659, "body": "@RemyLebeau yeah that the argument in favour of A) my expectations are wrong. I just thought that <code>std::cout &lt;&lt; foo();</code> appears to be a single invocation of <code>operator&lt;&lt;</code> and was hoping to get formatting independent of implementation details of <code>operator&lt;&lt;(foo)</code>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1533757715, "post_id": 51750191, "comment_id": 90468733, "body": "&quot;<i>I just thought that <code>std::cout &lt;&lt; foo();</code> appears to be a single invocation of <code>operator&lt;&lt;</code></i>&quot; - only from the caller&#39;s perspective, but not from the target <code>ostream</code>&#39;s perspective. &quot;<i>was hoping to get formatting independent of implementation details of <code>operator&lt;&lt;(foo)</code></i>&quot; - nope, the implementation of <code>operator&lt;&lt;(foo)</code> needs to take the caller&#39;s active manipulators into consideration when writing <i>multiple</i> values to the target <code>ostream</code>."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1533757887, "post_id": 51750191, "comment_id": 90468803, "body": "@RemyLebeau yes, i dont disagree with anything you say, i am just a bit surprised how much more effort it is to write a <code>operator&lt;&lt;</code> that considers manipulators than i naively thought. I mean it is the caller who sets the manipulators and if I implement something stupid (as eg in my lousy answer) then the caller wont get what they expect"}], "answers": [{"tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 1, "last_activity_date": 1533743844, "creation_date": 1533743844, "answer_id": 51751004, "question_id": 51750191, "link": "https://stackoverflow.com/questions/51750191/how-to-deal-with-iomanips-in-custom-output-operators/51751004#51751004", "title": "How to deal with iomanips in custom output operators?", "body": "<p>Not necessarily idiomatic, but one possible appraoch is this:</p>\n\n<pre><code>struct foo { \n    int a,b;\n    std::string toString() {\n        std::stringstream ss;\n        ss &lt;&lt; a &lt;&lt; b;\n        return ss.str();\n    }\n};\n\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, const foo&amp; f) {\n    out &lt;&lt; a &lt;&lt; b;\n    return out;\n};\n</code></pre>\n\n<p>Now the caller may choose whether output should be as a whole or not:</p>\n\n<pre><code>std::cout &lt;&lt; std::left &lt;&lt; std::setw(20) &lt;&lt; foo().toString() &lt;&lt; \"!\"; // output as expected\nstd::cout &lt;&lt; foo();                                                 // output as expected \n                                                                    // and no unnecessary overhead\n</code></pre>\n\n<p>One might also argue that output is already slow, so a bit of additional overhead does not hurt and simply implement the output operator in terms of the stringify method:</p>\n\n<pre><code>std::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, const foo&amp; f) {\n    out &lt;&lt; f.toString();\n    return out;\n}\n</code></pre>\n\n<p>This also fixed the minor ugliness of the first approach which basically implements the same thing twice with almost identical code. </p>\n"}, {"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533756557, "post_id": 51752064, "comment_id": 90468221, "body": "uuh right, now I remember the downside of a <code>toString</code>... would like to downvote my own answer ;). Actually I was wondering if there is a way to find out what manipulators are &quot;active&quot; on a given stream"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1533757487, "post_id": 51752064, "comment_id": 90468630, "body": "@user463035818 <code>std::ostream</code> has methods for that: <code>flags()</code>, <code>precision()</code>, <code>width()</code>, <code>fill()</code>, etc.  You have to read them individually as needed."}], "tags": [], "owner": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "is_accepted": false, "score": 2, "last_activity_date": 1533747907, "creation_date": 1533747907, "answer_id": 51752064, "question_id": 51750191, "link": "https://stackoverflow.com/questions/51750191/how-to-deal-with-iomanips-in-custom-output-operators/51752064#51752064", "title": "How to deal with iomanips in custom output operators?", "body": "<p>I'm afraid there is no easy answer. Your solution is idiomatic if you only need to handle <code>std::setw</code> and <code>std::left</code>, but, for other manipulations, you have to decide the behavior of your formatter.</p>\n\n<p>Imagine, for example, if your struct had <em>floats</em> instead of ints:</p>\n\n<pre><code>struct foo { float a,b; };\n</code></pre>\n\n<p>Then, your user tries to do this:</p>\n\n<pre><code>const long double pi = std::acos(-1.L);\nstd::cout &lt;&lt; std::setprecision(10) &lt;&lt; foo{0.0f, pi} &lt;&lt; \"!\\n\"\n</code></pre>\n\n<p>This is when you have to decide: Do you want to honor the precision property of the output stream, or do you want to ignore it? Your current implementation would ignore it, since it does the actual conversion in another stream.</p>\n\n<p>To honor the precision property, you would have to copy it:</p>\n\n<pre><code>std::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, const foo&amp; f) {\n    std::stringstream ss;\n    ss.precision(out.precision());\n    ss &lt;&lt; f.a &lt;&lt; f.b;\n    out &lt;&lt; ss.str();\n    return out;\n}\n</code></pre>\n\n<p>For your case of integers, you also have to consider if you will honor <code>std::setbase</code> or not.</p>\n\n<p>The same reasoning will have to be applied for the other manipulators, such as <code>std::setfill</code>, for example.</p>\n"}], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1533747907, "creation_date": 1533741314, "question_id": 51750191, "link": "https://stackoverflow.com/questions/51750191/how-to-deal-with-iomanips-in-custom-output-operators", "title": "How to deal with iomanips in custom output operators?", "body": "<p>I just came across the problem of combining custom output operators with io-manipulators. Maybe my expectations are completely off, but if</p>\n\n<pre><code>std::cout &lt;&lt; foo() &lt;&lt; \"\\n\";\n</code></pre>\n\n<p>prints </p>\n\n<pre><code>00\n</code></pre>\n\n<p>then I would expect </p>\n\n<pre><code>std::cout &lt;&lt; std::left &lt;&lt; std::setw(20) &lt;&lt; foo() &lt;&lt; \"!\\n\"\n</code></pre>\n\n<p>to print </p>\n\n<pre><code>00                   !\n</code></pre>\n\n<p>but given this implementation</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n\nstruct foo { int a,b; };\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, const foo&amp; f) {\n    out &lt;&lt; f.a &lt;&lt; f.b;\n    return out;\n}\n\nint main() {\n    std::cout &lt;&lt; foo() &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; std::left &lt;&lt; std::setw(20) &lt;&lt;  foo() &lt;&lt; \"!\";\n}\n</code></pre>\n\n<p>what is printed on the screen is</p>\n\n<pre><code>00\n0                   0!\n</code></pre>\n\n<p>I see basically two options: A) My expectations are just wrong. B) I use this implementation instead:</p>\n\n<pre><code>std::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, const foo&amp; f) {\n    std::stringstream ss;\n    ss &lt;&lt; f.a &lt;&lt; f.b;\n    out &lt;&lt; ss.str();\n    return out;\n}\n</code></pre>\n\n<p>However, this seems like quite some overhead considering that most of the time no io manipulators are used. </p>\n\n<p><strong>What is the idiomatic way of treating io-manipulators \"correctly\" in custom output operators?</strong></p>\n"}, {"tags": ["c++", "pointers", "reference", "abstract-class"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1533741564, "post_id": 51749925, "comment_id": 90460290, "body": "Hopefully, whatever book/site you&#39;re using will get you where smart pointer (or no pointer) are the flavor of the day. That aside, yes, it&#39;s an OOP thing.  the answer below is accurate."}], "answers": [{"tags": [], "owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "is_accepted": false, "score": 4, "last_activity_date": 1533740975, "creation_date": 1533740975, "answer_id": 51750065, "question_id": 51749925, "link": "https://stackoverflow.com/questions/51749925/c-why-return-a-reference-to-a-base-abstract-class/51750065#51750065", "title": "c++ why return a reference to a base abstract class", "body": "<p>This is quite a typical thing to do in OO code.</p>\n\n<p>By returning the narrower, base class - think interface - the calling code need only know aboout that.\nYou can hide all kinds of extra gory, implementation details that way.\nOtherwise, any calling code needs to know all about <code>CompositionalModel</code>.</p>\n\n<p>Furthermore, this can change the <code>OpModel</code> to any other type of <code>CompilationUnit</code> and the calling code won't need to change.</p>\n"}], "owner": {"reputation": 65, "user_id": 10198475, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LmgbF3hGvvU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o3JyHS_BgaM_RO5GlKWGG8Pp4-Ag/mo/photo.jpg?sz=128", "display_name": "ariane cathal", "link": "https://stackoverflow.com/users/10198475/ariane-cathal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1534779196, "creation_date": 1533740540, "last_edit_date": 1534779196, "question_id": 51749925, "link": "https://stackoverflow.com/questions/51749925/c-why-return-a-reference-to-a-base-abstract-class", "title": "c++ why return a reference to a base abstract class", "body": "<p>In the class below there is a pointer <code>model_</code> of type <code>OpModel</code> which is a class. This pointer is initialized in the constructor using <code>new</code> to create an <code>OpModel</code> object. That's fine, you have a pointer to a valid object. The method <code>model()</code> deferences this pointer which access the actual <code>OpModel</code> object. But what I don't understand is that it returns a reference to <code>CompositionalModel</code> which is a different class. </p>\n\n<p>I believe that it is related to polymorphism because <code>OpModel</code> is derived from <code>CompositionalModel</code>, which is an abstract class. But why would you return a reference to the base class?</p>\n"}, {"tags": ["c++", "winapi", "com"], "comments": [{"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 1, "creation_date": 1533741598, "post_id": 51749823, "comment_id": 90460310, "body": "If you had written your server component as in-process, you could simple host it in a COM+ Application. A COM+ application can host a .DLL as an out-of-process server w/o any coding required. What&#39;s cool with COM+ applications is they are very configurable. For example you can configure it to shutdown automatically when idle. <a href=\"https://www.safaribooksonline.com/library/view/com-net/0596001037/ch01s06.html\" rel=\"nofollow noreferrer\">safaribooksonline.com/library/view/com-net/0596001037/&hellip;</a> actually, I don&#39;t quite understand why developers write out-of-process COM server (unless they have a UI, like Word or Excel)..."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1533747178, "post_id": 51749823, "comment_id": 90463574, "body": "Does the server callback to the client at all? In my COM out-of-proc servers, I keep a list of connected clients, and if communication from server to a client fails, I remove that client from the list and stop communicating with it."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1533747380, "post_id": 51749823, "comment_id": 90463693, "body": "The OS is supposed to take care of it, automatically terminating servers that have lost their client(s).  It is not something it does quickly, takes at least 10 minutes iirc.  Hard to find the doc page back."}], "owner": {"reputation": 53, "user_id": 4558747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3308f43d9a0748fa1d37c0369bc8c1b8?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan Sawant", "link": "https://stackoverflow.com/users/4558747/mohan-sawant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1533740250, "creation_date": 1533740250, "question_id": 51749823, "link": "https://stackoverflow.com/questions/51749823/how-to-close-com-server-if-client-crashes", "title": "How to close COM server if client crashes?", "body": "<p>I have a out-of-proc COM server developed in C++. Client application invokes it using CoCreateInstance. When my client crashes in between, I want my server to close.Is it possible to achieve? I can write a service to monitor both of client and server. But that will require extra deployment overhead for me. Just want to check if there's any built in mechanism in COM.</p>\n"}, {"tags": ["c++", "gcc", "language-lawyer", "c++17"], "comments": [{"owner": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "edited": false, "score": 1, "creation_date": 1533740118, "post_id": 51749675, "comment_id": 90459317, "body": "Just a note: I had to add a template type parameter to get it to compile in the onlinegdb.com compiler; it completely ignored the default. But, it didn&#39;t throw an error otherwise."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 1, "creation_date": 1533740841, "post_id": 51749675, "comment_id": 90459807, "body": "I&#39;ve added the language-lawyer tag since you&#39;re looking for an answer by the Standard."}], "answers": [{"tags": [], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": true, "score": 8, "last_activity_date": 1533743131, "last_edit_date": 1533743131, "creation_date": 1533742811, "answer_id": 51750662, "question_id": 51749675, "link": "https://stackoverflow.com/questions/51749675/static-private-function-with-templated-type-as-a-default-argument-in-c/51750662#51750662", "title": "Static private function with templated type as a default argument in C++", "body": "<p>CTAD notionally proceeds by synthesizing a set of functions and function templates (<a href=\"https://timsong-cpp.github.io/cppwp/over.match.class.deduct\" rel=\"noreferrer\">[over.match.class.deduct]p1</a>). As relevant here, the set includes\n:</p>\n\n<blockquote>\n  <p>If <code>C</code> is defined, for each constructor of <code>C</code>, a function template\n  with the following properties:</p>\n  \n  <ul>\n  <li>The template parameters are the template parameters of <code>C</code> followed by the template parameters (including default template arguments) of\n  the constructor, if any.</li>\n  <li>The types of the function parameters are those of the constructor.</li>\n  <li>The return type is the class template specialization designated by <code>C</code> and template arguments corresponding to the template parameters of <code>C</code>.</li>\n  </ul>\n</blockquote>\n\n<p>Notably, this omits default function arguments. This is almost certainly a defect. </p>\n\n<p>Unfortunately, this defect also means that nobody knows from the standard how access control works for the default function arguments of the synthesized function templates - it doesn't even permit them to exist in the first place.</p>\n\n<hr>\n\n<p>From a design perspective, I'd expect Clang's behavior to be correct.</p>\n"}], "owner": {"reputation": 1332, "user_id": 2170917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e4bde8f118dd0095d6ba07e2a5bc3aa?s=128&d=identicon&r=PG", "display_name": "Nikola Benes", "link": "https://stackoverflow.com/users/2170917/nikola-benes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 3, "accepted_answer_id": 51750662, "answer_count": 1, "score": 13, "last_activity_date": 1533743131, "creation_date": 1533739804, "last_edit_date": 1533740806, "question_id": 51749675, "link": "https://stackoverflow.com/questions/51749675/static-private-function-with-templated-type-as-a-default-argument-in-c", "title": "Static private function with templated type as a default argument in C++", "body": "<p>I have the following piece of C++17 code:</p>\n\n<pre><code>template &lt;typename Callback = void(*)()&gt;\nstruct A {\n    A(Callback c = &amp;noop) {}\nprivate:\n    static void noop() {}\n};\n\nint main() {\n    A a{};\n}\n</code></pre>\n\n<p>Clang 6 compiles this without any errors, but GCC 8.2 says:</p>\n\n<pre><code>In function \u2018A(Callback)-&gt; A&lt;Callback&gt; [with Callback = void (*)()]\u2019:\n3:24: error: \u2018static void A&lt;Callback&gt;::noop() [with Callback = void (*)()]\u2019 is private within this context\n  A(Callback c = &amp;noop) {}\n                 ^~~~~\n5:14: note: declared private here\n  static void noop() {}\n              ^~~~\n</code></pre>\n\n<p>Interestingly, if <code>Callback</code> is not a template argument but a simple type alias (i.e. if I write <code>using Callback = void (*)()</code> inside of the <code>A</code> class), both compilers are fine. Also, if instead of <code>A a{};</code> I explicitly write <code>A&lt;&gt; a{};</code>, both compilers are again fine. This leads me to think that this problem is somehow connected to the new C++17 class template deduction mechanism.</p>\n\n<p>My question is, which of the compilers is right according to the standard? Is this a GCC bug or is Clang being too permissive?</p>\n"}, {"tags": ["c++", "boost-interprocess"], "comments": [{"owner": {"reputation": 4592, "user_id": 3179492, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ZHPUJ.jpg?s=128&g=1", "display_name": "Peter VARGA", "link": "https://stackoverflow.com/users/3179492/peter-varga"}, "edited": false, "score": 0, "creation_date": 1533740639, "post_id": 51749622, "comment_id": 90459655, "body": "Why not changing <code>name_p</code> to reference?"}, {"owner": {"reputation": 1, "user_id": 6649835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca465404b16e7e417e4916aff157f26e?s=128&d=identicon&r=PG&f=1", "display_name": "Manuel H&#252;ttel", "link": "https://stackoverflow.com/users/6649835/manuel-h%c3%bcttel"}, "reply_to_user": {"reputation": 4592, "user_id": 3179492, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ZHPUJ.jpg?s=128&g=1", "display_name": "Peter VARGA", "link": "https://stackoverflow.com/users/3179492/peter-varga"}, "edited": false, "score": 0, "creation_date": 1533799500, "post_id": 51749622, "comment_id": 90481080, "body": "@AlBundy i edited my example, but it doesn&#39;t solve my problem"}, {"owner": {"reputation": 4592, "user_id": 3179492, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ZHPUJ.jpg?s=128&g=1", "display_name": "Peter VARGA", "link": "https://stackoverflow.com/users/3179492/peter-varga"}, "edited": false, "score": 0, "creation_date": 1534765485, "post_id": 51749622, "comment_id": 90809721, "body": "Really, try to provide an MCVE so we got a chance to help you."}], "owner": {"reputation": 1, "user_id": 6649835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca465404b16e7e417e4916aff157f26e?s=128&d=identicon&r=PG&f=1", "display_name": "Manuel H&#252;ttel", "link": "https://stackoverflow.com/users/6649835/manuel-h%c3%bcttel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533799428, "creation_date": 1533739653, "last_edit_date": 1533799428, "question_id": 51749622, "link": "https://stackoverflow.com/questions/51749622/boost-interprocess-build-an-memoryhandler", "title": "Boost Interprocess | build an memoryHandler", "body": "<p>I am trying to build a memoryHandler which allows me to create and manage my shared memory, e.g. I want to create a <code>managed_memory_object</code> only once. \nWhen I construct an segment I want to actually store the return pointer as a member variable in my class, so I can access it without using the find function from boost.</p>\n\n<p>Is there any way to achieve something like this or do I always have to map my shared memory and find my segment with the find function?</p>\n\n<p>thank you for you help</p>\n\n<p>Manu</p>\n\n<p>Example Class: </p>\n\n<pre><code>MemHandler::MemHandler(const char* name_p)\n{\n    size_m = 1024;\n    name_m = name_p;\n    shm_m{open_or_create, name_m, size_m};\n    sharedVar_m = shm_m.construct&lt;int&gt;(\"sharedValue\")(4711);\n\n\n}\nint* MemHandler::getSharedVar()\n{\n    return sharedVar_m;\n}\nvoid MemHandler::setSharedVar(int value)\n{\n    sharedVar_m = shm_m.construct&lt;int&gt;(\"sharedValue\")(value);\n}\n</code></pre>\n"}, {"tags": ["c++", "webrtc"], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 10071455, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-M_4DPyvsXoQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rL-cVZrYSZ3Xy8dvk3I1LkepxyUQ/mo/photo.jpg?sz=128", "display_name": "Andriy Buchynskyy", "link": "https://stackoverflow.com/users/10071455/andriy-buchynskyy"}, "is_accepted": true, "score": 0, "last_activity_date": 1533893469, "creation_date": 1533893469, "answer_id": 51783387, "question_id": 51749591, "link": "https://stackoverflow.com/questions/51749591/which-payload-type-should-i-send-to-constructor-of-webrtcpayloadrouter/51783387#51783387", "title": "Which payload type should I send to constructor of webrtc::PayloadRouter?", "body": "<p>I solved this problem by registering my payload type before creating PayloadRouter class. I called RegisterVideoSendPayload(payload_number, payload_name) in RtpRtcp object, created vector of RtpRtcp and send it while creating PayloadRouter.</p>\n\n<p>rtpModules.push_back(rtpRtcp);</p>\n\n<p>payloadRouter = new webrtc::PayloadRouter(rtpModules,payload_number);</p>\n"}], "owner": {"reputation": 55, "user_id": 10071455, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-M_4DPyvsXoQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rL-cVZrYSZ3Xy8dvk3I1LkepxyUQ/mo/photo.jpg?sz=128", "display_name": "Andriy Buchynskyy", "link": "https://stackoverflow.com/users/10071455/andriy-buchynskyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 51783387, "answer_count": 1, "score": 1, "last_activity_date": 1533893469, "creation_date": 1533739583, "last_edit_date": 1533744155, "question_id": 51749591, "link": "https://stackoverflow.com/questions/51749591/which-payload-type-should-i-send-to-constructor-of-webrtcpayloadrouter", "title": "Which payload type should I send to constructor of webrtc::PayloadRouter?", "body": "<p>I use VP8 codec and I need to send webrtc::EncodedImage. That is why I use webrtc::PayloadRouter class for that and OnEncodedImage method in it. But when I call that method I receive message that says:</p>\n\n<pre><code>[064:094] [14107] (rtp_sender.cc:353): Payload type 42 not registered.\n[064:094] [14107] (rtp_sender.cc:395): Don't send data with unknown payload type: 42.\n</code></pre>\n\n<p>I already made a loop to send different values to constructor of PayloadRouter. The same. What should I send to the payload_type value in that class? Thanks in advance </p>\n"}, {"tags": ["c++", "c++11", "templates", "variadic-templates", "template-meta-programming"], "comments": [{"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1533851072, "post_id": 51749550, "comment_id": 90510813, "body": "I don&#39;t think your code will compile: class template <code>C</code> is not defined when it&#39;s used in class template <code>Has_A</code>."}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1533851162, "post_id": 51749550, "comment_id": 90510845, "body": "What do you need this for? This looks really strange."}], "answers": [{"tags": [], "owner": {"reputation": 918, "user_id": 4936507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36df2f476a2ed16bb905fc814370f720?s=128&d=identicon&r=PG&f=1", "display_name": "Domso", "link": "https://stackoverflow.com/users/4936507/domso"}, "is_accepted": false, "score": 1, "last_activity_date": 1533742299, "last_edit_date": 1533742299, "creation_date": 1533741886, "answer_id": 51750362, "question_id": 51749550, "link": "https://stackoverflow.com/questions/51749550/sfinae-and-variadic-template-classes/51750362#51750362", "title": "SFINAE and variadic template classes", "body": "<p>I think you can do this with function-member-pointer.</p>\n\n<p><code>call_if_base</code> calls the given function-pointer only if <code>baseT</code> is the base of <code>T</code>. However all function-results are ignored and it requires at least one parameter.</p>\n\n<pre><code>template &lt;class baseT, class T, typename funcT, class ...Args&gt;\ntypename std::enable_if&lt;std::is_base_of&lt;baseT, T&gt;::value, void&gt;::type call_if_base(T&amp; obj, funcT func, Args... args) {\n    (dynamic_cast&lt;baseT&amp;&gt;(obj).*func)(args...);\n}\n\ntemplate &lt;class baseT, class T, typename funcT, class ...Args&gt;\ntypename std::enable_if&lt;!std::is_base_of&lt;baseT, T&gt;::value, void&gt;::type call_if_base(T&amp; obj, funcT func, Args... args) {\n\n}   \n\ntemplate&lt;class ...T&gt;\nclass C :\n     virtual public T...\n{\npublic:\n    void set(const int &amp;value) {\n        call_if_base&lt;A, C&gt;(*this, &amp;A::set_a, 0);\n        call_if_base&lt;B, C&gt;(*this, &amp;B::set_b, 5);\n    }\n};\n</code></pre>\n\n<p>or as member-functions</p>\n\n<pre><code>template&lt;class ...T&gt;\nclass C :\n     virtual public T...\n{       \npublic:\n    void set(const int &amp;value) {\n        call_if_base&lt;A&gt;(&amp;A::set_a, 0);\n        call_if_base&lt;B&gt;(&amp;B::set_b, 5);\n    }\nprotected:\n    template &lt;class baseT, typename funcT, class ...Args&gt;\n    typename std::enable_if&lt;std::is_base_of&lt;baseT, C&gt;::value, void&gt;::type call_if_base(funcT func, Args... args) {\n        (dynamic_cast&lt;baseT&amp;&gt;(*this).*func)(args...);\n    }\n\n    template &lt;class baseT, typename funcT, class ...Args&gt;\n    typename std::enable_if&lt;!std::is_base_of&lt;baseT, C&gt;::value, void&gt;::type call_if_base(funcT func, Args... args) {\n\n    } \n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": false, "score": 5, "last_activity_date": 1533742689, "creation_date": 1533742689, "answer_id": 51750616, "question_id": 51749550, "link": "https://stackoverflow.com/questions/51749550/sfinae-and-variadic-template-classes/51750616#51750616", "title": "SFINAE and variadic template classes", "body": "<p>In current standard, this is trivial:</p>\n\n<pre><code>void f() {\n    if constexpr(Has_A&lt;T...&gt;::value) {\n        auto a = get_a();\n    }\n    auto b = get_b();\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1533850937, "post_id": 51775334, "comment_id": 90510774, "body": "a classical TL:DR; I&#39;m afraid."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 1, "last_activity_date": 1533848465, "last_edit_date": 1533848465, "creation_date": 1533846661, "answer_id": 51775334, "question_id": 51749550, "link": "https://stackoverflow.com/questions/51749550/sfinae-and-variadic-template-classes/51775334#51775334", "title": "SFINAE and variadic template classes", "body": "<p>If you can use C++17, the bipll's solution (<code>if constexpr ()</code>) is (IMHO) the better one.</p>\n\n<p>Otherwise, C++11 or C++14, I'm not sure it's a good idea but I propose the following solution because it seems to me funny (and a little perverted).</p>\n\n<p>First of all, instead of <code>Has_A</code> I propose a more generic <code>isTypeInList</code></p>\n\n<pre><code>template &lt;typename...&gt;\nstruct isTypeInList;\n\ntemplate &lt;typename X&gt;\nstruct isTypeInList&lt;X&gt; : public std::false_type\n { };\n\ntemplate &lt;typename X, typename ... Ts&gt;\nstruct isTypeInList&lt;X, X, Ts...&gt; : public std::true_type\n { };\n\ntemplate &lt;typename X, typename T0, typename ... Ts&gt;\nstruct isTypeInList&lt;X, T0, Ts...&gt; : public isTypeInList&lt;X, Ts...&gt;\n { };\n</code></pre>\n\n<p>I also propose the use of the simple <code>indexSequence</code></p>\n\n<pre><code>template &lt;std::size_t...&gt;\nstruct indexSequence\n { };\n</code></pre>\n\n<p>that is inspired to <code>std::index_sequence</code> that (unfortunately) is available only starting from C++14.</p>\n\n<p>So, inside <code>C&lt;T...&gt;</code>, you can define the template <code>using</code></p>\n\n<pre><code>  template &lt;typename X&gt;\n  using list = typename std::conditional&lt;isTypeInList&lt;X, Ts...&gt;{},\n                                         indexSequence&lt;0u&gt;,\n                                         indexSequence&lt;&gt;&gt;::type;\n</code></pre>\n\n<p>so that <code>list&lt;A&gt;</code> is <code>indexSequence&lt;0&gt;</code> if <code>A</code> is part of the <code>T...</code> variadic list, <code>indexSequence&lt;&gt;</code> (empty sequence) otherwise.</p>\n\n<p>Now you can write <code>f()</code> that simply call an helper function <code>f_helper()</code> that receive as many <code>indexSequence</code>s as many types you need to check.</p>\n\n<p>By example: if you need to know if <code>A</code> and <code>B</code> are part of the <code>T...</code> variadic list, you have to write <code>f()</code> as follows</p>\n\n<pre><code>  void f ()\n   { f_helper(list&lt;A&gt;{}, list&lt;B&gt;{}); }\n</code></pre>\n\n<p>Now <code>f_helper()</code> can be a <code>private</code> function and can be</p>\n\n<pre><code>  template &lt;std::size_t ... As, std::size_t ... Bs&gt;\n  void f_helper (indexSequence&lt;As...&gt; const &amp;,\n                 indexSequence&lt;Bs...&gt; const &amp;)\n   {\n     using unused = int[];\n\n     int a { -1 };\n     int b { -1 };\n\n     (void)unused { 0, ((void)As, a = this-&gt;get_a())... };\n     (void)unused { 0, ((void)Bs, b = this-&gt;get_b())... };\n\n     // do something with a and b\n   }\n</code></pre>\n\n<p>The idea is that <code>As...</code> is <code>0</code> if <code>A</code> is in <code>T...</code> or empty list otherwise.</p>\n\n<p>So</p>\n\n<pre><code>int a { -1 };\n</code></pre>\n\n<p>initialize <code>a</code> with the value of your fake <code>get_a()</code>.</p>\n\n<p>With</p>\n\n<pre><code>(void)unused { 0, ((void)As, a = this-&gt;get_a())... };\n</code></pre>\n\n<p>is executed <code>a = this-&gt;get_a()</code>, only one time, iff (if and only if) <code>A</code> is in the <code>T...</code> variadic list.</p>\n\n<p>The funny part of this solution is that <code>a = this-&gt;get_a()</code> isn't a problem when <code>A</code> isn't in the variadic list. Isn't there if <code>As...</code> is an empty list.</p>\n\n<p>The following is a C++11 full working example (where I've renamed in <code>Ts...</code> the <code>T...</code> variadic sequence for <code>C</code>)</p>\n\n<pre><code>#include &lt;utility&gt;\n#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\nclass A\n {\n   private:\n      int a;\n\n   public:\n      virtual void set_a (int const &amp; value)\n       { a = value; }\n\n   protected:\n      virtual int get_a ()\n       { std::cout &lt;&lt; \"get_a()!\" &lt;&lt; std::endl; return this-&gt;a; }\n };\n\nclass B\n {\n   private:\n      int b;\n\n   public:\n      virtual void set_b (int const &amp; value)\n       { b = value; }\n\n   protected:\n      virtual int get_b ()\n       { std::cout &lt;&lt; \"get_b()!\" &lt;&lt; std::endl; return this-&gt;b; }\n };\n\ntemplate &lt;typename...&gt;\nstruct isTypeInList;\n\ntemplate &lt;typename X&gt;\nstruct isTypeInList&lt;X&gt; : public std::false_type\n { };\n\ntemplate &lt;typename X, typename ... Ts&gt;\nstruct isTypeInList&lt;X, X, Ts...&gt; : public std::true_type\n { };\n\ntemplate &lt;typename X, typename T0, typename ... Ts&gt;\nstruct isTypeInList&lt;X, T0, Ts...&gt; : public isTypeInList&lt;X, Ts...&gt;\n { };\n\ntemplate &lt;std::size_t...&gt;\nstruct indexSequence\n { };\n\ntemplate &lt;typename ... Ts&gt;\nclass C : virtual public Ts...\n {\n   private:\n      template &lt;typename X&gt;\n      using list = typename std::conditional&lt;isTypeInList&lt;X, Ts...&gt;{},\n                                             indexSequence&lt;0u&gt;,\n                                             indexSequence&lt;&gt;&gt;::type;\n\n      template &lt;std::size_t ... As, std::size_t ... Bs&gt;\n      void f_helper (indexSequence&lt;As...&gt; const &amp;,\n                     indexSequence&lt;Bs...&gt; const &amp;)\n       {\n         using unused = int[];\n\n         int a { -1 };\n         int b { -1 };\n\n         (void)unused { 0, ((void)As, a = this-&gt;get_a())... };\n         (void)unused { 0, ((void)Bs, b = this-&gt;get_b())... };\n\n         // do something with a and b\n       }\n\n   public:\n      void f ()\n       { f_helper(list&lt;A&gt;{}, list&lt;B&gt;{}); }\n };\n\n\nint main()\n {\n   C&lt;&gt;     c0;\n   C&lt;A&gt;    ca;\n   C&lt;B&gt;    cb;\n   C&lt;A, B&gt; cab;\n\n   std::cout &lt;&lt; \"--- c0.f()\" &lt;&lt; std::endl;\n   c0.f();\n   std::cout &lt;&lt; \"--- ca.f()\" &lt;&lt; std::endl;\n   ca.f();\n   std::cout &lt;&lt; \"--- cb.f()\" &lt;&lt; std::endl;\n   cb.f();\n   std::cout &lt;&lt; \"--- cab.f()\" &lt;&lt; std::endl;\n   cab.f();\n }\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9414796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1a1f28f24d80427f970cb22db636eaf?s=128&d=identicon&r=PG&f=1", "display_name": "Edwin", "link": "https://stackoverflow.com/users/9414796/edwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 51775334, "answer_count": 3, "score": 3, "last_activity_date": 1534012319, "creation_date": 1533739470, "last_edit_date": 1534012319, "question_id": 51749550, "link": "https://stackoverflow.com/questions/51749550/sfinae-and-variadic-template-classes", "title": "SFINAE and variadic template classes", "body": "<p>I'm creating a <code>class C</code> that inherits from variable amount of classes. List of those classes is defined, for example: <code>A,B</code>. In function of <code>class C</code> I need to call functions from all base classes but objects can be <code>C&lt;A,B&gt;</code> , <code>C&lt;A&gt;</code>or <code>C&lt;B&gt;</code> so if I will call functions of <code>class A</code> in <code>C&lt;B&gt;</code> I will get an error. Here is example of the classes and how I've tried to solve problem:</p>\n\n<pre><code>    class A\n    {\n        int a;\n    public:\n        virtual void set_a(const int &amp;value)\n        {\n            a = value;\n        }\n    protected:\n        virtual int get_a()\n        {\n            return this-&gt;a;\n        }\n    };\n    class B\n    {\n        int b;\n    public:\n        virtual void set_b(const int &amp;value)\n        {\n            b = value;\n        }\n    protected:\n        virtual int get_b()\n        {\n            return this-&gt;b;\n        }\n    };\n    template&lt;class ...T&gt;\n    struct Has_A\n    {\n        template&lt;class U = C&lt;T...&gt;&gt;\n        static constexpr bool value = std::is_base_of &lt; A, U &gt; ::value;\n    };\n\n    template&lt;class ...T&gt;\n    class C :\n         virtual public T...\n    {\n    public:\n    #define HAS_A Has_A&lt;T...&gt;::value\n\n        void f()\n        {\n    #if HAS_A&lt;&gt;\n            auto a = this-&gt;get_a();\n    #endif\n        auto b = this-&gt;get_b();\n        cout &lt;&lt; HAS_A&lt;&gt;;\n    }\n};\n</code></pre>\n\n<p>When I call <code>f()</code> of object <code>C&lt;A,B&gt;</code> it skips the call <code>get_a()</code> but output is <code>true</code>.</p>\n\n<p>Initially, I wrote this </p>\n\n<pre><code>template&lt;class U = C&lt;T...&gt;&gt;\ntypename std::enable_if&lt;!std::is_base_of&lt;A, U&gt;::value, int&gt;::type get_a()\n{\n    return -1;\n}\ntemplate&lt;class U = C&lt;T...&gt;&gt;\ntypename std::enable_if&lt;std::is_base_of&lt;A,U&gt;::value, int&gt;::type get_a()\n{\n    return A::get_a();\n}\n</code></pre>\n\n<p>But I don't want to rewrite this for all functions of <code>A</code> and <code>B</code>. Let's assume that <code>A</code> has 10 more functions.</p>\n\n<p>Is there any beautiful solution?</p>\n\n<p>P.S Sorry for my English. I never used SFINAE before. \nBasically I have bunch of genes and I want to write convenient wrap for them where one can configure genes that he wants organism to have.</p>\n"}, {"tags": ["c++", "dictionary", "data-sharing"], "comments": [{"owner": {"reputation": 5866, "user_id": 2102132, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8pk78.png?s=128&g=1", "display_name": "Milney", "link": "https://stackoverflow.com/users/2102132/milney"}, "edited": false, "score": 2, "creation_date": 1533739378, "post_id": 51749476, "comment_id": 90458795, "body": "err... a class?"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1533739515, "post_id": 51749476, "comment_id": 90458916, "body": "You could read the key/value pairs from a file."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533739633, "post_id": 51749476, "comment_id": 90458998, "body": "it depends on your constraints. btw &quot;The consumer has to know what keys&quot; is not true, the caller can iterate the map entries to see what keys are there"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1533739757, "post_id": 51749476, "comment_id": 90459079, "body": "btw it is tempting to use <code>operator[]</code> for queries and for inserting, but note that it is most of the time doing more than what you want, eg it will create an element if there is none already for the passed key. Only if you use <code>find</code> / <code>insert</code> you can know if there was an entry present before the call"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1533739794, "post_id": 51749476, "comment_id": 90459101, "body": "<code>std::map</code> an unordered is usually a better choice. <code>auto dataMap = GetDataAsMap();</code> copying maps around is woefully inefficient."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1533758005, "post_id": 51749476, "comment_id": 90468854, "body": "@n.m. &quot;<i>copying maps around is woefully inefficient</i>&quot; - not when using C++11 move sematics, (N)RVO, etc."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1533763134, "post_id": 51749476, "comment_id": 90471170, "body": "@RemyLebeau You have a map somewhere inside GetDataAsMap and you have a map outside GetDataAsMap. That&#39;s two maps. There&#39;s at least one copy. Well if you every time create a single-use map inside GetDataAsMap, you can avoid copying, but you waste even more resources on map creation. Lose-lose."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1533763681, "post_id": 51749476, "comment_id": 90471360, "body": "@n.m. in the example provided, (N)RVO (also known as <a href=\"https://en.cppreference.com/w/cpp/language/copy_elision\" rel=\"nofollow noreferrer\">copy elision</a>) should be optimizing the return of <code>data</code> to avoid unnecessary copies, constructing the caller&#39;s <code>dataMap</code> directly, which is especially useful when move semantics are implemented (which <code>std::map</code> does)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1533765444, "post_id": 51749476, "comment_id": 90471962, "body": "@RemyLebeau I think I understand your reasoning. RVO will only matter if you call GetDataAsMap once, otherwise you are wasting resources on map construction every time (either on copying or on building from scratch, doesn&#39;t matter). I didn&#39;t assume it is called only once."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1533766215, "post_id": 51749476, "comment_id": 90472207, "body": "@n.m. neither was I. This wasn&#39;t a question about how to create only one <code>map</code> object for the lifetime of the app (use a singleton for that). I was merely addressing your comment that &quot;<i>copying maps around is woefully inefficient</i>&quot;, which is true only if you let it be, but is not really an issue when move semantics are used."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1533767576, "post_id": 51749476, "comment_id": 90472601, "body": "@RemyLebeau Let&#39;s try again. If you don&#39;t <i>copy</i> a map every time you call a function, you create a <i>new</i> map every time you call a function, which is even worse. I don&#39;t think I can express myself any better than that."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1533767627, "post_id": 51749476, "comment_id": 90472616, "body": "@n.m. &quot;<i>Let&#39;s try again</i>&quot; - let&#39;s not"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1533767734, "post_id": 51749476, "comment_id": 90472645, "body": "@RemyLebeau great"}], "answers": [{"tags": [], "owner": {"reputation": 2174, "user_id": 3349368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c9f50cb5783614c67eef86caf63139?s=128&d=identicon&r=PG", "display_name": "Paul Belanger", "link": "https://stackoverflow.com/users/3349368/paul-belanger"}, "is_accepted": false, "score": 1, "last_activity_date": 1533739596, "creation_date": 1533739596, "answer_id": 51749599, "question_id": 51749476, "link": "https://stackoverflow.com/questions/51749476/best-way-of-sharing-key-value-pairs-in-c/51749599#51749599", "title": "Best way of sharing key value pairs in C++", "body": "<p>Take the values of the map and unpack them into a struct. Optional values can be expressed using either <a href=\"https://www.boost.org/doc/libs/1_67_0/libs/optional/doc/html/index.html\" rel=\"nofollow noreferrer\">boost::optional</a> or <a href=\"https://en.cppreference.com/w/cpp/utility/optional\" rel=\"nofollow noreferrer\">std::optional</a> in c++17.</p>\n"}], "owner": {"reputation": 46, "user_id": 3806748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed986b49df0f8380c8146cf1a3465cc5?s=128&d=identicon&r=PG&f=1", "display_name": "S. Jung", "link": "https://stackoverflow.com/users/3806748/s-jung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533739596, "creation_date": 1533739250, "question_id": 51749476, "link": "https://stackoverflow.com/questions/51749476/best-way-of-sharing-key-value-pairs-in-c", "title": "Best way of sharing key value pairs in C++", "body": "<p>When I tried passing a map of string pairs I felt like too much of my code was hard coded (strings used as keys) and not really elegant.\nThat's why I'd like to ask if there is a best practice when wishing to share a map.</p>\n\n<h1>What I've tried</h1>\n\n<h2>Map with hard coded strings</h2>\n\n<p>Creation:</p>\n\n<pre><code>std::map&lt;std::string, std::string&gt; GetDataAsMap(){\n    std::map&lt;std::string, std::string&gt; data;\n    data[\"id\"] = ReadProperty(\"id\");\n    ...\n    return data;\n}\n</code></pre>\n\n<p>Consumption:</p>\n\n<pre><code>auto dataMap = GetDataAsMap();\nint id = dataMap[\"id\"];\n</code></pre>\n\n<p>Issues:</p>\n\n<ul>\n<li>Hard coded strings</li>\n<li>Easy to introduce typos that won't be detected at compile time</li>\n<li>The consumer has to know what keys will be present (i.e. handle optional values)</li>\n</ul>\n\n<h2>Map with hard coded strings but also pass the used keys</h2>\n\n<pre><code>std::map&lt;std::string, std::string&gt; GetDataAsMap(std::set&lt;std::string&gt;&amp; keys){\n    std::map&lt;std::string, std::string&gt; data;\n    data[\"id\"] = ReadProperty(\"id\");\n    keys.insert(\"id\");\n    ...\n    return data;\n}   \n</code></pre>\n\n<p>Here I can iterate over the keys in case I only need to show the data to the user but other than that not much is won</p>\n\n<h2>Map with enum values as keys</h2>\n\n<pre><code>std::map&lt;std::string, std::string&gt; GetDataAsMap(){\n    std::map&lt;std::string, std::string&gt; data;\n    data[Keys::ID] = ReadProperty(\"id\");\n    ...\n    return data;\n}   \n</code></pre>\n\n<ul>\n<li>Fixes the issue with the typos</li>\n<li>Still has issues when some of the values are optional</li>\n<li>No elegant way (to my knowledge) to get string representation of enums i.e. to show in a table</li>\n</ul>\n\n<h2>Question</h2>\n\n<p>Is there any best practice or way to go that is better than what I've tried here?</p>\n"}, {"tags": ["c++", "qml", "vlc-qt"], "comments": [{"owner": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "edited": false, "score": 1, "creation_date": 1533739814, "post_id": 51749417, "comment_id": 90459116, "body": "Are you sure this url transmite rts?"}, {"owner": {"reputation": 365, "user_id": 9616495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91bcf4ea4e16e38ca0eb32fb3d544f8e?s=128&d=identicon&r=PG&f=1", "display_name": "Brykyz", "link": "https://stackoverflow.com/users/9616495/brykyz"}, "reply_to_user": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "edited": false, "score": 0, "creation_date": 1533740052, "post_id": 51749417, "comment_id": 90459263, "body": "@folibis I am getting audio"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1533740162, "post_id": 51749417, "comment_id": 90459340, "body": "@Brykyz  I tried to open it with rtsp with vlc and it does not work. with http it works but not with rtsp or rtp."}, {"owner": {"reputation": 365, "user_id": 9616495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91bcf4ea4e16e38ca0eb32fb3d544f8e?s=128&d=identicon&r=PG&f=1", "display_name": "Brykyz", "link": "https://stackoverflow.com/users/9616495/brykyz"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1533740668, "post_id": 51749417, "comment_id": 90459675, "body": "@eyllanesc So VLCQt doesn&#39;t support rtsp?"}, {"owner": {"reputation": 365, "user_id": 9616495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91bcf4ea4e16e38ca0eb32fb3d544f8e?s=128&d=identicon&r=PG&f=1", "display_name": "Brykyz", "link": "https://stackoverflow.com/users/9616495/brykyz"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1533741168, "post_id": 51749417, "comment_id": 90460022, "body": "@eyllanesc It&#39;s random stream found on internet, it should be streaming BigBuckBunny video, normally it can be opened with any program wich provides video playing"}, {"owner": {"reputation": 365, "user_id": 9616495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91bcf4ea4e16e38ca0eb32fb3d544f8e?s=128&d=identicon&r=PG&f=1", "display_name": "Brykyz", "link": "https://stackoverflow.com/users/9616495/brykyz"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1533741646, "post_id": 51749417, "comment_id": 90460350, "body": "@eyllanesc Sorry, i don&#39;t understand what you mean, &quot;is hidden&quot; and &quot;make it more visible&quot;"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1533741810, "post_id": 51749417, "comment_id": 90460482, "body": "@Brykyz  if this url is the one that brings you the problem then it should not be commented, that makes it little visible but you should place it directly: <code>url: &quot;rtsp:&#47;&#47;184.72.239.149&#47;vod&#47;mp4:BigBuckBunny_175k.mov&quot;</code>"}, {"owner": {"reputation": 365, "user_id": 9616495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91bcf4ea4e16e38ca0eb32fb3d544f8e?s=128&d=identicon&r=PG&f=1", "display_name": "Brykyz", "link": "https://stackoverflow.com/users/9616495/brykyz"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1533741971, "post_id": 51749417, "comment_id": 90460596, "body": "@eyllanesc Oh, ok, sorry, done"}], "answers": [{"tags": [], "owner": {"reputation": 365, "user_id": 9616495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91bcf4ea4e16e38ca0eb32fb3d544f8e?s=128&d=identicon&r=PG&f=1", "display_name": "Brykyz", "link": "https://stackoverflow.com/users/9616495/brykyz"}, "is_accepted": true, "score": 0, "last_activity_date": 1534150868, "creation_date": 1534150868, "answer_id": 51818692, "question_id": 51749417, "link": "https://stackoverflow.com/questions/51749417/play-rtsp-video-with-qt-vlc-libary-in-c/51818692#51818692", "title": "Play RTSP video with Qt VLC libary in C++", "body": "<p>So, I have solved it after some searching on <a href=\"https://vlc-qt.tano.si/reference/git/hierarchy.html\" rel=\"nofollow noreferrer\">this page</a>, I have found something like <code>VlcQmlPlayer</code>, functions are almost same as in <code>VlcQmlVideoPlayer</code>, except it's newer and it's source is subclass of <code>VlcQmlVideoOutput</code>. So I registered few types for QML:</p>\n\n<pre><code>qmlRegisterUncreatableType&lt;Vlc&gt;(\"Vlc\", 1, 1, \"Vlc\", QStringLiteral(\"Vlc cannot be instantiated directly\"));\nqmlRegisterUncreatableType&lt;VlcQmlSource&gt;(\"VlcSource\", 1, 1, \"VlcSource\", QStringLiteral(\"VlcQmlSource cannot be instantiated directly\"));\nqmlRegisterUncreatableType&lt;VlcTrackModel&gt;(\"VlcTrackModel\", 1, 1, \"VlcTrackModel\", QStringLiteral(\"VlcTrackModel cannot be instantiated directly\"));\nqmlRegisterType&lt;VlcQmlVideoOutput&gt;(\"VlcVideoOutput\", 1, 1, \"VlcVideoOutput\");\nqmlRegisterType&lt;VlcQmlPlayer&gt;(\"VlcPlayer\", 1, 1, \"VlcPlayer\");\n</code></pre>\n\n<p>and after that, I used it in QML like this</p>\n\n<pre><code>import VlcPlayer 1.1\nimport Vlc 1.1\nimport VlcVideoOutput 1.1\n\nVlcVideoOutput {\n    source:\n        VlcPlayer {\n        id: vlcPlayer\n        url: \"rtsp://184.72.239.149/vod/mp4:BigBuckBunny_175k.mov\"\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 365, "user_id": 9616495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91bcf4ea4e16e38ca0eb32fb3d544f8e?s=128&d=identicon&r=PG&f=1", "display_name": "Brykyz", "link": "https://stackoverflow.com/users/9616495/brykyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1209, "favorite_count": 1, "accepted_answer_id": 51818692, "answer_count": 1, "score": 1, "last_activity_date": 1534150868, "creation_date": 1533739119, "last_edit_date": 1533741946, "question_id": 51749417, "link": "https://stackoverflow.com/questions/51749417/play-rtsp-video-with-qt-vlc-libary-in-c", "title": "Play RTSP video with Qt VLC libary in C++", "body": "<p>I am trying to connect my <code>VlcVideoPlayer</code> from VLCQt libary to any video streamed from url with <strong>rts protocol</strong>.</p>\n\n<p>Currently, this is my code:</p>\n\n<pre><code>import QtQuick 2.0\nimport VLCQt 1.0\nVlcVideoPlayer {\n    property var first: true\n    id: vidwidget\n    anchors.fill: parent\n    objectName: \"vlcMediaPlayer\"\n    url: \"rtsp://184.72.239.149/vod/mp4:BigBuckBunny_175k.mov\" // \"http://samples.mplayerhq.hu/A-codecs/AAC/ct_faac.mp4\"\n    volume: 100\n    aspectRatio: \"16:10\"\n    autoplay: true\n}\n</code></pre>\n\n<p>It works with <em>https://</em> , but when I try to change it to <em>rtps://</em>, my console only prints out</p>\n\n<pre><code>QML debugging is enabled. Only use this in a safe environment.\nVLC-Qt \"1.1.0\" initialised\nUsing libvlc version: \"2.2.2 Weatherwax\"\nFormat: chroma: I420 width: 240 height: 162 pitches: 0 lines: 0\nYV12 3 0\nlibvlc Error: \"Track identifier not found\"\nlibvlc: Failed to change zoom\nlibvlc: Failed to set on top\nlibvlc: Failed to change source AR\n</code></pre>\n\n<p>and nothing happens - no video shows up.</p>\n\n<p>When I tried to show current time of video with <code>console.log(time)</code>, time was changing so I guess it plays video, but it doesn't show up.</p>\n\n<p>Anyone have experience with this? Where am I doing mistake?</p>\n\n<p>Thanks for your help!</p>\n\n<p>//Edit:</p>\n\n<p>I didn't notice first, but I am getting audio, but not video.</p>\n"}, {"tags": ["c++", "c++11", "types", "stdmap", "php-cpp"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533739160, "post_id": 51749381, "comment_id": 90458652, "body": "<code>map</code> is a <code>ClassMap</code> not a <code>std::map</code>, or is it just a typedef?"}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533739254, "post_id": 51749381, "comment_id": 90458719, "body": "@user463035818 Yes, see the second last code block, where I&#39;ve tried to typedef it in all sorts of ways."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533739384, "post_id": 51749381, "comment_id": 90458801, "body": "oh i see. The thing is you only have values of the same type in a map. Maybe a <code>std::variant</code> or <code>std::any</code> can help (though I never used them myself, so my suggestion might be completely off)"}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533739545, "post_id": 51749381, "comment_id": 90458932, "body": "@user463035818 I think I&#39;ve actually tried those as well, but I might be mistaken. I&#39;ll try it once more."}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533739934, "post_id": 51749381, "comment_id": 90459190, "body": "@user463035818 It appears <code>std::any</code> and <code>std::variant</code> are C++17 features, but I&#39;m using C++11. I&#39;m not sure if I could just switch to C++17. But before resorting to those, I&#39;d actually like to know if there&#39;s a less generic options available, as well."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1533739949, "post_id": 51749381, "comment_id": 90459196, "body": "Why do you need this map? It is not needed and each class is represent by different instantiation of a <code>Php::Class</code> template, so you can&#39;t create common map of it."}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1533740059, "post_id": 51749381, "comment_id": 90459266, "body": "@MarekR I need this map to refer to its values when other classes need to extend from them, as I&#39;ve explained this in my question."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1533740135, "post_id": 51749381, "comment_id": 90459328, "body": "@DecentDabbler this is XY problem. Why do you need refer to this values?"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1533740212, "post_id": 51749381, "comment_id": 90459379, "body": "Note that classes should be registered at module startup anyway. You can create a dedicated registration function (per class), but I don&#39;t see any reasons to use any of these maps."}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1533740273, "post_id": 51749381, "comment_id": 90459418, "body": "@MarekR I&#39;ve tried to explain this to you already and I&#39;ve also explained in my question. But to reiterate: the PHP-CPP library allows you to let the exported PHP classes extend other exported PHP classes. I use this map to refer to earlier created PHP classes to extends from those (without recreating new instances). Hope that clarifies it."}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1533740501, "post_id": 51749381, "comment_id": 90459567, "body": "@VTT But the template function I&#39;m using basically mimics this registration function you talk about, no? Or is that something completely different? I didn&#39;t want to hard-code such a function into the class, to keep the classes cleaner (not concerned with actual registration process)."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1533740503, "post_id": 51749381, "comment_id": 90459568, "body": "Still why do you need <code>map</code>! Do you intend find class by its name? No I don&#39;t think you need this. If you are adding items manually to map to perform registration, you can just register them immediately one by one. Or you can try use initialization of global variables to enforce magic auto registration, like for example gtest registers tests."}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1533740964, "post_id": 51749381, "comment_id": 90459891, "body": "@MarekR &quot;Do you intend find class by its name?&quot; Yes! That&#39;s exactly it! :) I mean, finding them by their class name/type would be great too, but this was the simplest I could think of, with my limited knowledge of C++. I kind of register them all at once already, inside of <code>get_module()</code>, but the whole point is to make <code>get_module()</code> less cluttered. And I don&#39;t want to use globals, particularly since <a href=\"http://www.php-cpp.com/documentation/extension-callbacks\" rel=\"nofollow noreferrer\">PHP-CPP documentation</a> advices against this."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1533741139, "post_id": 51749381, "comment_id": 90460007, "body": "If you want to &quot;keep the classes cleaner&quot; then you probably should not use PHP-CPP at all since it produces quite a code bloat. Php actually performs class registration on per-class basis rather then &quot;method by method&quot; as implemented in PHP-CPP."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1533742106, "post_id": 51749381, "comment_id": 90460683, "body": "I&#39;m still thinking that this is <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY Problem</a>. You should register class and don&#39;t do anything else it should be reachable from PHP. If you are trying find class by name in C++ layer this means that you are doing something wrong or your requirements are strange. If this is the case than this is your X problem to solve."}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1533798936, "post_id": 51749381, "comment_id": 90480808, "body": "@MarekR I appreciate you looking into this, but I don&#39;t think it&#39;s an XY problem. The PHP-CPP library requires me to register all functions, classes, interfaces, methods and class inheritances, that I actually want to export to PHP, to the extension. The documentation show examples where this is all done inside the <code>get_module()</code>, but as stated before, this could get very cluttered. So I try to do this inside the individual class files, where I define them. So, I need this <code>classMap</code> of <code>Php::Class&lt;whatever&gt;</code> &quot;objects&quot; so that I can extend from them at the appropriate place."}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1533799552, "post_id": 51749381, "comment_id": 90481117, "body": "@VTT You are probably right about the added code bloat, but the added benefit for me, as a total C++/PHP extension beginner, is that it hides away all the Zend complexities, which, at first glance, appears to make it much easier to create a PHP extension."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533803572, "post_id": 51749381, "comment_id": 90483457, "body": "You can&#39;t use a map of <code>Php::Class&lt;Something&gt;</code> to register <code>OtherThing</code>, <code>ThirdThing</code>. I doubt anything good comes of multiply registering <code>Something</code> under different names."}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533803968, "post_id": 51749381, "comment_id": 90483672, "body": "@Caleth The thing is, all my classes ultimately derive from the same base class, namely <code>Php::Base</code> (which is required by PHP-CPP, to allow export to PHP). Surely it must be possible to create a map in which derived instances of the same base class would be allowed, no? <a href=\"https://stackoverflow.com/a/8627889\">This answer</a> seems to suggest it <i>can</i> be done, by using pointers, but I haven&#39;t managed to reproduce this."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1533804606, "post_id": 51749381, "comment_id": 90484059, "body": "You do not need a collection of objects in your hierarchy, but of <i>registration objects</i>. <code>Php::Class&lt;Base&gt;</code> is entirely separate from <code>Php::Class&lt;Derived&gt;</code>"}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533805055, "post_id": 51749381, "comment_id": 90484336, "body": "@Caleth Yes, that&#39;s a really good point actually. But, it&#39;s highly likely that those <i>registration objects</i> derive from some base type themselves as well, though, no? As the internals of PHP-CPP ultimately probably deal with these objects in some sort of unified way to pass it along to the Zend internals. I&#39;ve looked at <a href=\"https://github.com/CopernicaMarketingSoftware/PHP-CPP/blob/master/include/class.h#L39\" rel=\"nofollow noreferrer\">the source code of PHP-CPP</a>, and came to <code>Php::ClassBase</code>, but that doesn&#39;t seem to work either. How could I determine the actual base type of <code>Php::Class&lt;whatever&gt;</code>, if any such exists?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533805151, "post_id": 51749381, "comment_id": 90484395, "body": "See the edit to my answer. A much simpler registration object is <code>std::function&lt;void(Php::Namespace &amp;)&gt;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "edited": false, "score": 0, "creation_date": 1533743278, "post_id": 51750293, "comment_id": 90461443, "body": "I need some time to digest your answer, because I kind of understand what you are suggesting, but not to its full extent. However, I think you probably nailed the issue: <code>Php::Class</code> is a template and not a type. Now, are you saying that there is no way to retrieve the actual template from the map again, or are you just saying that I can&#39;t access any members of the template. I&#39;m completely fine with the latter, but the former would defeat my intended purpose. Thanks."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "edited": false, "score": 0, "creation_date": 1533744358, "post_id": 51750293, "comment_id": 90462054, "body": "@DecentDabbler I&#39;m saying that a template is not a type. An <i>instantiation</i> of a template class is a type. <code>Php::Class</code> is a template, <code>Php::Class&lt;Mammal&gt;</code> is a class. You can have <code>std::map&lt;std::string, Php::Class&lt;Mammal&gt;&gt;</code>, because both type parameters have been filled with types. You can&#39;t have <code>std::map&lt;std::string, Php::Class&gt;</code>, because the second parameter is a template. You can also have <code>template&lt;typename T&gt; using ClassMap = std::map&lt;std::string, Php::Class&lt;T&gt;&gt;;</code>, which makes <code>ClassMap</code> a template, but you still can&#39;t add a <code>Php::Class&lt;Dog&gt;</code> to a <code>ClassMap&lt;Mammal&gt;</code>"}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "edited": false, "score": 0, "creation_date": 1533746482, "post_id": 51750293, "comment_id": 90463174, "body": "Okay, now I&#39;m properly confused. I think I just have to give up on C++, because it&#39;s just way too complex for me. I mean, I think I&#39;ve already tried (combinations of) what you suggest in your comment, but that gave me all sorts of errors about <code>operator= not being defined</code>, and <code>use of deleted function</code>, etc. I tried it with concrete types (my ideal goal was actually a generic base type), like you suggest (only adding <code>Php::Class&lt;Mammal&gt;</code> for instance) and with or without pointers and references, but nothing works. Thanks for your time though; I appreciate it."}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "edited": false, "score": 0, "creation_date": 1533798147, "post_id": 51750293, "comment_id": 90480398, "body": "I&#39;ve decided to give another shot, today. Would you mind reviewing the addendum I have added at the top of my question? I&#39;ve tried to simplify as much as possible the main issue I&#39;m having. Thanks."}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "edited": false, "score": 0, "creation_date": 1533805477, "post_id": 51750293, "comment_id": 90484603, "body": "I see what you are doing, but the whole point of my exercise was to pass along a map of other registration object instances that the current registration object needs to derive from, e.g.: <code>Php::Class&lt;Mammal&gt; mammal(&quot;Mammal&quot;); Php::Class&lt;Dog&gt; dog(&quot;Dog&quot;); dog.extends(mammal);</code>. I know it&#39;s convoluted, but that is how PHP-CPP requires me to extend exported PHP classes. I see no other way, if I don&#39;t want to create separate instances of the same registration objects, while still decentralizing these procedures out of <code>get_module()</code>."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "edited": false, "score": 0, "creation_date": 1533805614, "post_id": 51750293, "comment_id": 90484688, "body": "Oh that&#39;s hideous"}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "edited": false, "score": 0, "creation_date": 1533805696, "post_id": 51750293, "comment_id": 90484744, "body": "What, my intended solution, or PHP-CPP&#39;s internals? (Or both? :) )"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "edited": false, "score": 0, "creation_date": 1533806080, "post_id": 51750293, "comment_id": 90484971, "body": "PHP-CPP. There must be a way to get a previously registered class back out. I find that documentation entirely lacking. It doesn&#39;t list the members of these types, just uses some (or all?) in examples"}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "edited": false, "score": 0, "creation_date": 1533806157, "post_id": 51750293, "comment_id": 90485021, "body": "&quot;There must be a way to get a previously registered class back out.&quot; Exactly! That&#39;s what I would have expected as well, but I haven&#39;t found a way (could very well be due to my lack of C++ experience, as well)."}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 1, "last_activity_date": 1533805015, "last_edit_date": 1533805015, "creation_date": 1533741665, "answer_id": 51750293, "question_id": 51749381, "link": "https://stackoverflow.com/questions/51749381/having-extreme-difficulty-with-determining-the-correct-value-type-for-stdmap/51750293#51750293", "title": "Having extreme difficulty with determining the correct value type for std::map", "body": "<p>It looks like <code>Php::Class</code> is a template, so you <em>can't</em> have it as the <code>mapped_type</code> of a <code>std::map</code>, it <em>isn't</em> a type. </p>\n\n<p>You are going to have to have a \"register me\" function for each class you are registering, that goes into a collection.</p>\n\n<pre><code>void registerMammal(Php::Namespace &amp; ns) override \n{ \n    Php::Class&lt;Animal::Mammal&gt; cls(\"Mammal\");\n\n    cls.method&lt;&amp;Animal::Mammal::method&gt;(\"method\");\n    // ... \n\n    ns.add(std::move(cls));\n}\n\nstd::vector&lt;std::function&lt;void(Php::Extension &amp;, Php::Namespace &amp;)&gt;&gt; AnimalRegistrations{ registerMammal, ... }; \n\nPHPCPP_EXPORT void *get_module() {\n    static Php::Extension extension( \"animals\", \"0.1\" );\n\n    Php::Namespace ns( \"Animal\" );\n\n    for (auto &amp; reg : AnimalRegistrations)\n    {\n        reg(ns);\n    }\n\n    extension.add( std::move( ns ) );\n\n    return extension;\n}\n</code></pre>\n\n<p>If you have loads of namespaces to register, you may end up with a <code>std::map&lt;std::string, std::vector&lt;std::function&lt;void(Php::Namespace &amp;)&gt;&gt;&gt;</code>, matching names to that namespaces collection of registration functions.</p>\n\n<p>You'd use that like</p>\n\n<pre><code>Php::Extension extension( \"dabbler\", \"0.1\" );\n\nfor (auto &amp; pair : NamespaceMap)\n{\n    Php::Namespace ns(pair.first);\n    for (auto &amp; reg : pair.second)\n    {\n        reg(ns);\n    }\n    extension.add( std::move( ns ) );\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533805522, "post_id": 51762106, "comment_id": 90484636, "body": "The main reason that <code>[]</code> fails and <code>at</code> succeeds is that <code>[]</code> requires the type be default constructable (i.e. no parameters constructor), <code>=</code> fails because the type is explicitly blocked from being copied. That&#39;s why the examples are using <code>std::move</code>"}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533805635, "post_id": 51762106, "comment_id": 90484707, "body": "@Caleth Thanks. I really appreciate you taking the time to elaborate on these things. But, my god, C++ is complicated! :) I really have to digest your comment once more. :)"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533806517, "post_id": 51762106, "comment_id": 90485266, "body": "There&#39;s a good reason for that rule. <code>[]</code> will add a <i>new value</i> into the map if the key isn&#39;t found. <code>map[&quot;key&quot;] = value</code> does a default construction and then an assignment. <code>at</code> just throws if the key is not found."}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533812527, "post_id": 51762106, "comment_id": 90489078, "body": "@Caleth Okay, so are you saying <code>classMap[ &quot;Animal::Mammal&quot; ] = mammal;</code> creates a new instance (a clone perhaps?) of <code>Php::Class&lt;Animal::Mammal&gt;</code>. Because that surely wasn&#39;t my intention. I would preferably just like to put the original instance into the map (a reference, or a pointer then perhaps?). That was my whole purpose of the map to begin with. :) To pass around original instances in a map, in stead of creating new ones inside each <code>addToExtension()</code> function. (For retrieval, since we both concluded that that&#39;s impossible from the PHP-CPP containers themselves, right now)."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533813355, "post_id": 51762106, "comment_id": 90489611, "body": "The <code>[]</code> simply can&#39;t exist for <code>std::map&lt;..., Php::Class&lt;...&gt;&gt;</code>. Other members do, like <code>insert</code>, <code>emplace</code> and <code>at</code>. And don&#39;t worry about &quot;original instances&quot;. An object in C++ <b>is</b> the memory that it occupies. If you have an object local to a function, and want it elsewhere, there has to be two objects for as least as long as the transfer of contents."}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533814470, "post_id": 51762106, "comment_id": 90490337, "body": "@Caleth So then my whole exercise was futile? I could just as well create a new instance inside <code>addToExtension()</code>, instead of passing around a map of earlier created <i>registration objects</i>? I thought one could pass around objects by reference in C++? (Which I interpret to mean it refers to the exact same instance and any change made to the reference is reflected in the original instance)."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533814886, "post_id": 51762106, "comment_id": 90490592, "body": "What I mean is a <code>std::map&lt;..., Php::Class&lt;...&gt;&gt;</code> has some memory allocated somewhere for each <code>Php::Class&lt;...&gt;</code> object. When you <code>move</code> a value into the map, it creates it, in the the location the map allocated, by &quot;stealing&quot; the contents of the function-local object. Then the function returns and the function-local object ceases to exist."}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533815051, "post_id": 51762106, "comment_id": 90490694, "body": "@Caleth Right! Understood. But would there be a way for me to add references into the map, instead of <code>move</code>ing or the way I have gotten it to work at the moment?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533815297, "post_id": 51762106, "comment_id": 90490882, "body": "You can safely create a pointed-to <code>Php::Class&lt;...&gt;</code> and pass the pointer to a <code>std::map&lt;..., std::unique_ptr&lt;Php::Class&lt;...&gt;&gt;&gt;</code>, but if you just had a map of references, they would be referring to objects that no longer exist. (You also can&#39;t have a map of references directly, only of <code>std::reference_wrapper&lt;...&gt;</code>, mainly because you can&#39;t change which object is referred to by a reference.)"}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533815737, "post_id": 51762106, "comment_id": 90491206, "body": "@Caleth But surely the objects would keep existing for the duration of the <code>get_module()</code> function, right? So if I do <code>get_module() { create objects; put references to objects in map; call addToExtension( ext, ns, map ) multiple times; do some other stuff; }</code>. Surely the objects will keep existing for as long as I haven&#39;t exited the <code>get_module()</code> yet, no? Since <code>addToExtension()</code> are all called from within <code>get_module()</code>, synchronously? Or am I lacking basic knowledge of C++ here? Is it not synchronous at all, perhaps?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533816551, "post_id": 51762106, "comment_id": 90491775, "body": "If <code>create objects;</code> is a <code>void</code> function call, no. The locals to <i>that function</i> have ceased to exist when it returns. If it&#39;s a bunch of <code>auto var = create&lt;Php::Class&lt;...&gt;&gt;()</code> functions, it&#39;s a bit more complex. The language pretends that there is a separate object that is moved into <code>var</code>, but the actual behaviour is that the location of <code>var</code> is passed into the function, and <code>var</code> is constructed in the call."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533816931, "post_id": 51762106, "comment_id": 90492067, "body": "That&#39;s what I mean by &quot;don&#39;t worry about original instances&quot;. Lumps of memory are relatively interchangeable"}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533817272, "post_id": 51762106, "comment_id": 90492305, "body": "@Caleth O, wait, you&#39;re right of course. I totally forgot that I wanted to add objects into the map from within <code>addToExtension()</code>. But you&#39;re telling me they cease to exist after <code>addToExtension()</code> returns. That makes sense. Unless I use <code>new</code>, right? But I read that <i>that</i> calls for intricate memory management (needing <code>delete</code> and all). It&#39;s starting to make more sense now. I think I&#39;ll just try without the map and create the objects locally inside <code>addToExtension()</code>, when needed, and see where that gets me. Thanks so far for your time and patience. You&#39;ve been really helpful!"}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533817371, "post_id": 51762106, "comment_id": 90492389, "body": "And I don&#39;t think I&#39;m even allowed to use <code>new</code> with the <code>Php::Class</code> template, if I recall earlier attempts correctly."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533817532, "post_id": 51762106, "comment_id": 90492507, "body": "Importantly, <i>an</i> object with the values you setup exists. It&#39;s just generally not necessary to care whether it is <i>the same</i> object or just an equal one"}, {"owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533818381, "post_id": 51762106, "comment_id": 90493152, "body": "@Caleth Right, but surely there must be numerous occasions in C++ where you want to be sure you are always acting on the same instance, no? For the sake of data consistency/integrity. Or is that just a matter of carefully moving (copies of) objects around? Let&#39;s say <code>BankAccount.withdraw( 100, otherBackAccount );</code> is called in different scopes (and for argument&#39;s sake let&#39;s pretend there&#39;s no database backend, just an in memory balance), wouldn&#39;t it be wise to make sure you&#39;re always acting on the same instance for the consistency/integrity of the balance? (Sorry for the poor example. :))"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533818567, "post_id": 51762106, "comment_id": 90493292, "body": "That&#39;s what move-only types are for. You know that there is only one object <i>with that value</i> at any given time."}], "tags": [], "owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "is_accepted": false, "score": 0, "last_activity_date": 1533802903, "creation_date": 1533802903, "answer_id": 51762106, "question_id": 51749381, "link": "https://stackoverflow.com/questions/51749381/having-extreme-difficulty-with-determining-the-correct-value-type-for-stdmap/51762106#51762106", "title": "Having extreme difficulty with determining the correct value type for std::map", "body": "<p>Okay, after lots of trial and error, I've finally managed to put a concrete result of the template <code>Php::Class</code> into a map and retrieve it as well:</p>\n\n<pre><code>std::map&lt;std::string, Php::Class&lt;Animal::Mammal&gt;&gt; classMap;\n\nPhp::Class&lt;Animal::Mammal&gt; mammal( \"Mammal\" );\n\nclassMap.insert( std::make_pair( \"Animal::Mammal\", mammal ) );\n\nPhp::Class&lt;Animal::Mammal&gt; mammal = classMap.at( \"Animal::Mammal\" );\n</code></pre>\n\n<p>I still don't understand why putting in into the map with:</p>\n\n<pre><code>classMap[ \"Animal::Mammal\" ] = mammal;\n</code></pre>\n\n<p>and retrieving it again with:</p>\n\n<pre><code>Php::Class&lt;Animal::Mammal&gt; mammal = classMap[ \"Animal::Mammal\" ];\n</code></pre>\n\n<p>wouldn't work, though. If someone could enlighten me about these intricacies, I'd appreciate it.</p>\n\n<p>I presume it has something to do with the error messages I've shown in my question, about operators not being defined. I would have expected there to be some default behavior though, if operators are not explicitly defined, but it appears this is not the case.</p>\n"}], "owner": {"reputation": 21260, "user_id": 165154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/58a1f8e345ba2cac70d777f7084b23c8?s=128&d=identicon&r=PG", "display_name": "Decent Dabbler", "link": "https://stackoverflow.com/users/165154/decent-dabbler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1533805015, "creation_date": 1533739004, "last_edit_date": 1533799018, "question_id": 51749381, "link": "https://stackoverflow.com/questions/51749381/having-extreme-difficulty-with-determining-the-correct-value-type-for-stdmap", "title": "Having extreme difficulty with determining the correct value type for std::map", "body": "<p><sup><strong>Addendum:</strong></sup></p>\n\n<p>Let me simplify my question, to try this one step at a time, because I feel I've created too much confusion about what I'm trying to achieve.</p>\n\n<p><sup>Mind you, I'm using C++11 and I think I'm bound to using this when using the PHP-CPP library. But, as I'm a total beginner, I'm not even sure about this.</sup></p>\n\n<p>My ultimate goal would be to \"simply\" create a map that can hold <em>any</em> value that the template <code>Php::Class</code> returns. But let's just start by trying a concrete one, for instance <code>Php::Class&lt;Animal::Mammal&gt;</code>.</p>\n\n<p>First, I create a class in the namespace <code>Animal</code> called <code>Mammal</code>, which extends from <code>Php::Base</code> (when you want to export a class to PHP with PHP-CPP, it needs to extend <code>Php::Base</code>):</p>\n\n<pre><code>namespace Animal {\n  class Mammal : public Php::Base { /* left out for brevity */ }\n}\n</code></pre>\n\n<p>Then, to keep it simple, let me just try to create a map inside <code>get_module()</code> for now and just try to add an element there:</p>\n\n<pre><code>extern \"C\"\n{\n  PHPCPP_EXPORT void *get_module() {    \n    // create the map\n    std::map&lt;std::string, Php::Class&lt;Animal::Mammal&gt;&gt; classMap;\n\n    // create the thing (at this point I just don't know what the actual return type is anymore) that will be exported later on.\n    Php::Class&lt;Animal::Mammal&gt; mammal( \"Mammal\" );\n\n    // try to add this \"thing\" to the map:\n    classMap[ \"Animal::Mammal\" ] = mammal;\n\n    /* left out for brevity */\n}\n</code></pre>\n\n<p>This results in:</p>\n\n<pre><code>error: use of deleted function \u2018Php::Class&lt;Animal::Mammal&gt;&amp;\n       Php::Class&lt;Animal::Mammal&gt;::operator=(const Php::Class&lt;Animal::Mammal&gt;&amp;)\u2019\n</code></pre>\n\n<p>When I try:</p>\n\n<pre><code>// require a pointer\nstd::map&lt;std::string, Php::Class&lt;Animal::Mammal&gt;*&gt; classMap;\n\nclassMap[ \"Animal::Mammal\" ] = *mammal;\n</code></pre>\n\n<p>This results in:</p>\n\n<pre><code>error: no match for \u2018operator*\u2019 (operand type is \u2018Php::Class&lt;Animal::Mammal&gt;\u2019)\n</code></pre>\n\n<p>I've tried numerous other things as well, but nothing seem to allow me to put whatever the template <code>Php::Class</code> creates into the map. I'm pulling my hair out, at this point. What am I missing?</p>\n\n<p>Is it perhaps that the template <code>Php::Class</code> creates something that simply cannot be put in a map? How do I find out what the thing is that the template <code>Php::Class</code> actually creates?</p>\n\n<hr>\n\n<p><sup><strong>Original question:</strong></sup></p>\n\n<p>Although I have some cursory knowledge of C++, I'm new to actually programming with it.</p>\n\n<p>I'm trying to develop a PHP extension with <a href=\"http://www.php-cpp.com/\" rel=\"nofollow noreferrer\">PHP-CPP</a>. With this library you're able to define C++ classes and export them as PHP classes. <a href=\"http://www.php-cpp.com/documentation\" rel=\"nofollow noreferrer\">Their documentation</a> almost exclusively shows <a href=\"http://www.php-cpp.com/documentation/classes-and-objects\" rel=\"nofollow noreferrer\">examples</a> where you export those classes and methods inside it's main <code>get_module()</code> function.</p>\n\n<p>However, as this could get rather cluttered pretty quickly, I'd like to move this logic close to the individual classes instead. So, I've created a template function for this:</p>\n\n<pre><code>namespace Animal\n{\n  template&lt;typename T&gt;\n  void addToExtension( Php::Extension &amp;extension, Php::Namespace &amp;ns, ClassMap &amp;map ) { }\n}\n</code></pre>\n\n<p>Which I then specialize with something like:</p>\n\n<pre><code>namespace Animal\n{\n  class Mammal : public Php::Base\n  {\n  };\n\n  template&lt;&gt;\n  inline void addToExtension&lt;Mammal&gt;( Php::Extension &amp;extension, Php::Namespace &amp;ns, ClassMap &amp;map ) {\n    Php::Class&lt;Mammal&gt; clss( \"Mammal\" );\n\n    // this is where I'm having extreme difficulty with\n    map[ \"Animal::Mammal\" ] = clss;\n\n    // add class to namespace\n    ns.add( std::move( clss ) );\n  }\n}\n</code></pre>\n\n<p>...and in <code>get_module()</code> I then do this:</p>\n\n<pre><code>PHPCPP_EXPORT void *get_module() {\n  static Php::Extension extension( \"animals\", \"0.1\" );\n\n  Php::Namespace ns( \"Animal\" );\n\n  Animal::ClassMap classMap;\n\n  Animal::addToExtension&lt;Animal::Mammal&gt;( extension, ns, classMap );\n  Animal::addToExtension&lt;Animal::Dog&gt;( extension, ns, classMap );\n  Animal::addToExtension&lt;Animal::Cat&gt;( extension, ns, classMap );\netc...\n\n  extension.add( std::move( ns ) );\n\n  return extension;\n}\n</code></pre>\n\n<p>As you can see, I want to add each individual class to the <code>Animal::ClassMap</code> map as well, because I want to use these when subsequent classes need to extend from them (for the export to PHP, that is):</p>\n\n<pre><code>// for instance, something like (not sure yet, if this is actually possible)\nclss.extends( map[ \"Animal::Mammal\" ] );\n</code></pre>\n\n<p>But this is what I'm having extreme difficulties with. I've tried to define <code>Animal::ClassMap</code> in all sorts of manners:</p>\n\n<pre><code>namespace Animal\n{\n  // some examples of what I've tried:\n  typedef std::map&lt;std::string, Php::Class&gt; ClassMap;\n  typedef std::map&lt;std::string, Php::Class*&gt; ClassMap;\n  typedef std::map&lt;std::string, Php::Base&gt; ClassMap;\n  typedef std::map&lt;std::string, Php::Base*&gt; ClassMap;\n  typedef std::map&lt;std::string, Php::ClassBase&gt; ClassMap;\n  typedef std::map&lt;std::string, Php::ClassBase*&gt; ClassMap;\n  typedef std::map&lt;std::string, Php::Class&lt;Php::Base&gt;&gt; ClassMap;\n  typedef std::map&lt;std::string, Php::Class&lt;Php::Base&gt;*&gt; ClassMap;\n  typedef std::map&lt;std::string, std::shared_ptr&lt;Php::Class&gt;&gt; ClassMap;\n  // etc., etc., etc. ...\n}\n</code></pre>\n\n<p>and tried to assign to it in all sorts of manners as well:</p>\n\n<pre><code>Php::Class&lt;Mammal&gt; clss( \"Mammal\" );\n\n// some examples of what I've tried:\nmap[ \"Animal::Mammal\" ] = clss;\nmap[ \"Animal::Mammal\" ] = *clss;\nmap[ \"Animal::Mammal\" ] = &amp;clss;\nmap[ \"Animal::Mammal\" ] = std::make_shared&lt;Php::Class&gt;( clss );\nmap[ \"Animal::Mammal\" ] = std::make_shared&lt;Php::ClassBase&gt;( clss );\n\nmap.insert( std::pair&lt;std::string, Php::Class&gt;( \"Animal::Mammal\", clss ) );\n// etc., etc., etc. ...\n</code></pre>\n\n<p>but nothing compiles.</p>\n\n<p>I've gotten compile errors ranging from \"<code>operator*</code> not defined\", to \"incomplete class\" (or something to that effect), to \"template argument is invalid\".</p>\n\n<p>As you can see, I clearly lack an actual understanding of what needs to be done here.</p>\n\n<p>How do I determine what the proper value type for the map should be and how do I then properly add a \"class\" (is it even a proper class?) to the map?</p>\n\n<hr>\n\n<p><sup>PS: I'm fairly confident I've correctly included all necessary headers/files in the appropriate files. I've just omitted those in my examples for brevity.</sup></p>\n"}, {"tags": ["c++", "segmentation-fault", "qt5", "qt4", "qaction"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1533739029, "post_id": 51749340, "comment_id": 90458555, "body": "provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 86, "user_id": 5434952, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xzItvLkLBU0/AAAAAAAAAAI/AAAAAAAAAEc/HTpKmEv9lHU/photo.jpg?sz=128", "display_name": "Mullai Nathan", "link": "https://stackoverflow.com/users/5434952/mullai-nathan"}, "edited": false, "score": 1, "creation_date": 1534421143, "post_id": 51749340, "comment_id": 90704463, "body": "if((*menuItr)==NULL){..DEBUG..}"}], "owner": {"reputation": 123, "user_id": 3481696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e18f9b7a1163940f81b0ea0b6b04a61?s=128&d=identicon&r=PG&f=1", "display_name": "chinmay singh", "link": "https://stackoverflow.com/users/3481696/chinmay-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533741950, "creation_date": 1533738907, "last_edit_date": 1533741950, "question_id": 51749340, "link": "https://stackoverflow.com/questions/51749340/qactiontext-program-received-signal-sigsegv-segmentation-fault", "title": "QAction::text(), Program received signal SIGSEGV, Segmentation fault", "body": "<p>I working on migration of a product from QT4 to 5.</p>\n\n<p>I am getting this error while  backtracing it-</p>\n\n<pre><code>#0  0x00007ffff5488cd1 in QAction::text() const () from /fa/sw/registry/22851-export_qt5-04-soni-01/serverdist/dist/x86_linux/lib64/libQt5Widgets.so.5\n#1  0x0000000000c17435 in cQ_ELEMENTS_COMBOBOX::AppendItem(QString const&amp;) ()\n#2  0x00000000005441e6 in cEXPORT_FILE_PARMS::initialize(QWidget*, cQ_GRID_LAYOUT*, int, bool, char const*) ()\n#3  0x0000000000545ad3 in cEXPORT_FILE_PARMS::cEXPORT_FILE_PARMS(QWidget*, cGV_DEC_PROJECT*, ExportOutputFileParameterSet*, cQ_GRID_LAYOUT*, int, QString) ()\n</code></pre>\n\n<hr>\n\n<pre><code>asINT32 cQ_ELEMENTS_COMBOBOX::AppendItem(const QString &amp;item_name)\n{\n  //if item already exists then do not append item\n  if(GetAction(m_popup_p, item_name) == NULL) {\n    m_popup_p-&gt;addAction(item_name);\n    return 0;\n  }\n  return -1;\n}\n\nQAction* GetAction(QMenu* menu, const QString&amp; actionName){\n  QList&lt;QAction*&gt;::iterator menuItr = menu-&gt;actions().begin();\n  /*const*/ QList&lt;QAction*&gt;::iterator menuEnd = menu-&gt;actions().end();\n  while (menuItr != menuEnd)\n  {\n   if((*menuItr)-&gt;text() == actionName){\n                return *menuItr;\n   }\n\n   menuItr++;\n  }\n  return NULL;\n}\n</code></pre>\n\n<p>After giving print statements on this line program crashes - </p>\n\n<pre><code>if((*menuItr)-&gt;text() == actionName)\n</code></pre>\n\n<p>sometimes it works and sometimes it crashes, not able to see a particular pattern. Is there any workaround or any way to catch the segmentation fault beforehand.</p>\n"}, {"tags": ["c++", "pointers"], "comments": [{"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 5, "creation_date": 1533738641, "post_id": 51749221, "comment_id": 90458283, "body": "something like <code>int* newpointer = (int*)(((char*)array) + 4);</code> could work"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 1, "creation_date": 1533738971, "post_id": 51749221, "comment_id": 90458518, "body": "Is there a point  behind this question?"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 1, "creation_date": 1533739007, "post_id": 51749221, "comment_id": 90458541, "body": "This is just math. <code>f(x) = array + 4 * x</code>. You want <code>f(x) = array + 4</code>. Solve for x."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1533739361, "post_id": 51749221, "comment_id": 90458784, "body": "It is unclear what you are asking. It looks like you basically know how pointer arithmetic works."}], "answers": [{"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1533740009, "post_id": 51749369, "comment_id": 90459235, "body": "<code>accessing improperly aligned values can have large performance penalties. </code> Or rather, behaviour of the program will be undefined as far as the C++ standard is concerned. Don&#39;t be surprised if the program misbehaves on ARM."}], "tags": [], "owner": {"reputation": 2174, "user_id": 3349368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c9f50cb5783614c67eef86caf63139?s=128&d=identicon&r=PG", "display_name": "Paul Belanger", "link": "https://stackoverflow.com/users/3349368/paul-belanger"}, "is_accepted": false, "score": 1, "last_activity_date": 1533738985, "creation_date": 1533738985, "answer_id": 51749369, "question_id": 51749221, "link": "https://stackoverflow.com/questions/51749221/c-adding-4-bytes-to-pointer-address/51749369#51749369", "title": "C++ adding 4 bytes to pointer address", "body": "<p>For a pointer <code>p</code> to a type <code>T</code> with value <code>v</code>, the expression <code>p+n</code> will (on most systems anyway) result in a pointer to the address <code>v+n*sizeof(T)</code>. To get a fixed-byte offset to the pointer, you can first cast it to a character pointer, like this: </p>\n\n<pre><code>reinterpret_cast&lt;T*&gt;(reinterpret_cast&lt;char*&gt;(p) + n)\n</code></pre>\n\n<p>In c++, <code>sizeof(char)</code> is defined to be equal to 1. </p>\n\n<p>Do note that accessing improperly aligned values can have large performance penalties. </p>\n\n<p>Another thing to note is that, in general, casting pointers to different types is not allowed (called the <a href=\"https://en.cppreference.com/w/cpp/language/reinterpret_cast\" rel=\"nofollow noreferrer\">strict aliasing</a> rule), but an exception is explicitly made for casting any pointer type to <code>char*</code> and back. </p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1533740087, "last_edit_date": 1592644375, "creation_date": 1533739237, "answer_id": 51749466, "question_id": 51749221, "link": "https://stackoverflow.com/questions/51749221/c-adding-4-bytes-to-pointer-address/51749466#51749466", "title": "C++ adding 4 bytes to pointer address", "body": "<p>Consider that if you add an arbitrary number of bytes to an address of an object of type <code>T</code>, it no longer makes sense to use a pointer of type <code>T</code>, since there might not be an object of type <code>T</code> at the incremented memory address.</p>\n<p>If you want to access a particular byte of an object, you can do so using a pointer to a <code>char</code>, <code>unsigned char</code> or <code>std::byte</code>. Such objects are the size of a byte, so incrementing behaves just as you would like. Furthermore, while rules of C++ disallow accessing objects using incompatible pointers, these three types are excempt of that rule and are allowed to access objects of any type.</p>\n<p>So, given</p>\n<pre><code>int * array = ....\n</code></pre>\n<p>You can access the byte at index 4 like this:</p>\n<pre><code>auto ptr = reinterpret_cast&lt;unsigned char*&gt;(array);\nauto byte_at_index_4 = ptr + 4;\n</code></pre>\n<hr />\n<blockquote>\n<pre><code>array + 0x004\n</code></pre>\n<p>If im correct this will lead to add 4*4 (16) bytes</p>\n</blockquote>\n<p>Assuming <code>sizeof(int)</code> happens to be 4, then yes. But size of int is not guaranteed to be 4.</p>\n"}, {"tags": [], "owner": {"reputation": 918, "user_id": 4936507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36df2f476a2ed16bb905fc814370f720?s=128&d=identicon&r=PG&f=1", "display_name": "Domso", "link": "https://stackoverflow.com/users/4936507/domso"}, "is_accepted": false, "score": 0, "last_activity_date": 1533739373, "creation_date": 1533739373, "answer_id": 51749511, "question_id": 51749221, "link": "https://stackoverflow.com/questions/51749221/c-adding-4-bytes-to-pointer-address/51749511#51749511", "title": "C++ adding 4 bytes to pointer address", "body": "<p>The trick is convert the type of <code>array</code> into any pointer-type with a size of 1 Byte, or store the pointer value in an integer.</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\nint* increment_1(int* ptr) {\n    //C-Style\n    return (int*)(((char*)ptr) + 4);\n}\n\nint* increment_2(int* ptr) {\n    //C++-Style\n    char* result = reinterpret_cast&lt;char*&gt;(ptr);\n    result += 4;\n    return reinterpret_cast&lt;int*&gt;(result);\n}\n\nint* increment_3(int* ptr) {\n    //Store in integer\n    intptr_t result = reinterpret_cast&lt;intptr_t&gt;(ptr);\n    result += 4;\n    return reinterpret_cast&lt;int*&gt;(result);\n}\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 2254192, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/c03b5cf1d3abe1f40fa1b7415ca0b11e?s=128&d=identicon&r=PG", "display_name": "redigaffi", "link": "https://stackoverflow.com/users/2254192/redigaffi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2079, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1533740087, "creation_date": 1533738535, "question_id": 51749221, "link": "https://stackoverflow.com/questions/51749221/c-adding-4-bytes-to-pointer-address", "title": "C++ adding 4 bytes to pointer address", "body": "<p>I have a question about pointers, and memory addresses:</p>\n\n<p>Supposing I have the following code:</p>\n\n<pre><code>int * array = (int *) malloc(sizeof(int) * 4);\n</code></pre>\n\n<p>Now in array im storing a memory address, I know that c++ takes already care when adding +1 to this pointer it will add 4 bytes, but what If I want to add manually 4 bytes?</p>\n\n<pre><code>array + 0x004\n</code></pre>\n\n<p>If im correct this will lead to add 4*4 (16) bytes, but my Idea is to add manually those 4 bytes.</p>\n\n<p>Why? Just playing around, i've tried this and I got a totally different result from what I expected, then i've researched and i've seen that c++ takes already care when you add +1 to a pointer (it sums 4 bytes in this case).</p>\n\n<p>Any idea?</p>\n"}, {"tags": ["c++", "unsigned-char"], "comments": [{"owner": {"reputation": 4240, "user_id": 2550156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AdYzH.png?s=128&g=1", "display_name": "pergy", "link": "https://stackoverflow.com/users/2550156/pergy"}, "edited": false, "score": 0, "creation_date": 1533738611, "post_id": 51749197, "comment_id": 90458260, "body": "have u seen this warning in your compiler? <code>warning: overflow in conversion from &#39;int&#39; to &#39;char&#39; changes value from &#39;251&#39; to &#39;&#39;\\37777777773&#39;&#39; [-Woverflow]      char a=0xfb;</code> <a href=\"http://coliru.stacked-crooked.com/a/b83589f0c4bb883e\" rel=\"nofollow noreferrer\">see here</a>."}, {"owner": {"reputation": 149, "user_id": 8494948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f0cb444f4542c93a244ff19dd1c72?s=128&d=identicon&r=PG&f=1", "display_name": "Tulsi", "link": "https://stackoverflow.com/users/8494948/tulsi"}, "reply_to_user": {"reputation": 4240, "user_id": 2550156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AdYzH.png?s=128&g=1", "display_name": "pergy", "link": "https://stackoverflow.com/users/2550156/pergy"}, "edited": false, "score": 0, "creation_date": 1533739008, "post_id": 51749197, "comment_id": 90458544, "body": "My code is running without any warning &amp; giving output as 0;"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1533739246, "post_id": 51749197, "comment_id": 90458717, "body": "Try enabling warnings. The value of <code>a</code> is <code>-5</code>. The value of <code>b</code> is <code>251</code>. They are not equal."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1533739288, "post_id": 51749197, "comment_id": 90458742, "body": "@raymondChen a is -5 -&gt; a is probably -5"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1533739432, "post_id": 51749197, "comment_id": 90458840, "body": "@Bathsheba The likelihood that OP is using a ones-complement or sign-magnitude system is vanishingly small."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1533739470, "post_id": 51749197, "comment_id": 90458876, "body": "@RaymondChen: Or non-existent in C++14! But note that the conversion is still implementation defined."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1533739522, "post_id": 51749197, "comment_id": 90458920, "body": "@Bathsheba I think it&#39;s not helpful to the OP to get into language-lawyering details. Let&#39;s try to explain the observed behavior."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1533739560, "post_id": 51749197, "comment_id": 90458946, "body": "@RaymondChen: I think you can do both in this case. My answer is hardly technical, no?"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1533739970, "post_id": 51749197, "comment_id": 90459213, "body": "The number of systems where <code>CHAR_MAX</code> is not 127 and integers are not twos-complement is basically zero. No need to inject the possibility into a beginner discussion."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 2, "creation_date": 1533740096, "post_id": 51749197, "comment_id": 90459301, "body": "@RaymondChen: Rubbish. It&#39;s appropriate here to have a selection of answers. I really don&#39;t see your point. Do not (i) make assumptions about the OP and (ii) don&#39;t assume this entire page is targetted at the OP. And your comment above is ignorant. I have access to a machine where char, short, int, long, and long long are all the same size."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1533762969, "post_id": 51749197, "comment_id": 90471122, "body": "@Bathsheba: I&#39;m curious. Is it a DSP?"}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 8494948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f0cb444f4542c93a244ff19dd1c72?s=128&d=identicon&r=PG&f=1", "display_name": "Tulsi", "link": "https://stackoverflow.com/users/8494948/tulsi"}, "edited": false, "score": 0, "creation_date": 1533739177, "post_id": 51749385, "comment_id": 90458665, "body": "But at output both a and b are printing same symbol."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 149, "user_id": 8494948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f0cb444f4542c93a244ff19dd1c72?s=128&d=identicon&r=PG&f=1", "display_name": "Tulsi", "link": "https://stackoverflow.com/users/8494948/tulsi"}, "edited": false, "score": 0, "creation_date": 1533739595, "post_id": 51749385, "comment_id": 90458968, "body": "@T.g The printing mechanism for character types interprets the underlying bit pattern, not the numerical value of the variable. The representation is the same, but the values are different."}, {"owner": {"reputation": 149, "user_id": 8494948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f0cb444f4542c93a244ff19dd1c72?s=128&d=identicon&r=PG&f=1", "display_name": "Tulsi", "link": "https://stackoverflow.com/users/8494948/tulsi"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1533751296, "post_id": 51749385, "comment_id": 90465750, "body": "@molbdnilo thanks, I got it...but how the value -5 is assigned to a ..since 251 is not in range of [-128,127]"}, {"owner": {"reputation": 4240, "user_id": 2550156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AdYzH.png?s=128&g=1", "display_name": "pergy", "link": "https://stackoverflow.com/users/2550156/pergy"}, "reply_to_user": {"reputation": 149, "user_id": 8494948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f0cb444f4542c93a244ff19dd1c72?s=128&d=identicon&r=PG&f=1", "display_name": "Tulsi", "link": "https://stackoverflow.com/users/8494948/tulsi"}, "edited": false, "score": 0, "creation_date": 1533751725, "post_id": 51749385, "comment_id": 90465973, "body": "@T.g I&#39;ve just asked the same under the other answer :) take a look at this: <a href=\"https://stackoverflow.com/a/1049880/509868\">stackoverflow.com/a/1049880/509868</a>"}], "tags": [], "owner": {"reputation": 4240, "user_id": 2550156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AdYzH.png?s=128&g=1", "display_name": "pergy", "link": "https://stackoverflow.com/users/2550156/pergy"}, "is_accepted": false, "score": 4, "last_activity_date": 1533740212, "last_edit_date": 1533740212, "creation_date": 1533739020, "answer_id": 51749385, "question_id": 51749197, "link": "https://stackoverflow.com/questions/51749197/signed-and-unsigned-char/51749385#51749385", "title": "Signed and unsigned char", "body": "<ul>\n<li>Value range for (signed) <code>char</code> is <code>[-128, 127]</code>. (C++14 drops -127 as the lower range).</li>\n<li>Value range for <code>unsigned char</code> is <code>[0, 255]</code></li>\n</ul>\n\n<p>What you're trying to assign to both of the variables is <code>251</code> in decimal. Since <code>char</code> cannot hold that value you will suffer a value overflow, as the following warning tells you.</p>\n\n<blockquote>\n  <p>warning: overflow in conversion from 'int' to 'char' changes value from '251' to ''\\37777777773'' [-Woverflow]</p>\n</blockquote>\n\n<p>As a result <code>a</code> will probably hold value <code>-5</code> while <code>b</code> will be <code>251</code> and they are indeed not equal.</p>\n"}, {"comments": [{"owner": {"reputation": 4240, "user_id": 2550156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AdYzH.png?s=128&g=1", "display_name": "pergy", "link": "https://stackoverflow.com/users/2550156/pergy"}, "edited": false, "score": 0, "creation_date": 1533739478, "post_id": 51749389, "comment_id": 90458887, "body": "why -5? I calculated -3 like this: -127 + (251 - 127). Isn&#39;t that correct?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 4240, "user_id": 2550156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AdYzH.png?s=128&g=1", "display_name": "pergy", "link": "https://stackoverflow.com/users/2550156/pergy"}, "edited": false, "score": 0, "creation_date": 1533739509, "post_id": 51749389, "comment_id": 90458910, "body": "@pergy. No, 2&#39;s complement does not work that way. It&#39;s -5."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1533739617, "post_id": 51749389, "comment_id": 90458990, "body": "<a href=\"https://stackoverflow.com/a/1049880/509868\">stackoverflow.com/a/1049880/509868</a> (actually, that answer uses the value -5 as an example)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1533739643, "post_id": 51749389, "comment_id": 90459006, "body": "@anatolyg: Well you can&#39;t get much better than that!"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1533763857, "post_id": 51749389, "comment_id": 90471415, "body": "&quot;C++14 dropped 1&#39;s complement and signed magnitude signed char&quot;. I&#39;ve checked the current draft standard, and haven&#39;t found this. Is this explicitly said, or can be inferred?"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 6, "last_activity_date": 1533740577, "last_edit_date": 1533740577, "creation_date": 1533739031, "answer_id": 51749389, "question_id": 51749197, "link": "https://stackoverflow.com/questions/51749197/signed-and-unsigned-char/51749389#51749389", "title": "Signed and unsigned char", "body": "<p>The value of <code>f</code> and, in fact, the behaviour of the program, is <em>implementation-defined</em>.</p>\n\n<p>In C++14 onwards<sup>1</sup>, for a <code>signed</code> <code>char</code>, and assuming that <code>CHAR_MAX</code> is <code>127</code>, <code>a</code> will probably be <code>-5</code>. Formally speaking, if <code>char</code> is <code>signed</code> and the number does not fit into a <code>char</code>, then the conversion is implementation-defined or an implementation-defined signal is raised. </p>\n\n<p><code>b</code> is <code>251</code>.</p>\n\n<p>For the comparison <code>a == b</code> (and retaining the assumption that <code>char</code> is a narrower type than an <code>int</code>) <em>both</em> arguments are converted to <code>int</code>, with <code>-5</code> and <code>251</code> therefore retained.</p>\n\n<p>And that's <code>false</code> as the numbers are not equal.</p>\n\n<p>Finally, note that on a platform where <code>char</code>, <code>short</code>, and <code>int</code> are all the same size, the result of your code would be <code>true</code> (and the <code>==</code> would be in <code>unsigned</code> types)! The moral of the story: <strong>don't mix your types</strong>.</p>\n\n<hr>\n\n<p><sup>1</sup> C++14 dropped 1's complement and signed magnitude <code>signed char</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 8, "last_activity_date": 1533812162, "last_edit_date": 1533812162, "creation_date": 1533739267, "answer_id": 51749481, "question_id": 51749197, "link": "https://stackoverflow.com/questions/51749197/signed-and-unsigned-char/51749481#51749481", "title": "Signed and unsigned char", "body": "<p>There are no arithmetic operators that accept integers smaller than <code>int</code>. Hence, both char values get promoted to <code>int</code> first, see <a href=\"https://en.cppreference.com/w/cpp/language/implicit_conversion#Integral_promotion\" rel=\"nofollow noreferrer\">integral promotion\n</a> for full details.</p>\n\n<p><code>char</code> is signed on your platform, so <code>0xfb</code> gets promoted to <code>int(-5)</code>, whereas <code>unsigned char</code> gets promoted to <code>int(0x000000fb)</code>. These two integers do not compare equal.</p>\n\n<p>On the other hand, the standard in <a href=\"http://eel.is/c++draft/basic.fundamental#1\" rel=\"nofollow noreferrer\">[basic.fundamental]</a> requires that all char types occupy the same amount of storage and have the same alignment requirements; that is, they have the same object representation and all bits of the object representation participate in the value representation. Hence, <code>memcmp(&amp;a, &amp;b, 1) == 0</code> is <code>true</code>.</p>\n"}], "owner": {"reputation": 149, "user_id": 8494948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f0cb444f4542c93a244ff19dd1c72?s=128&d=identicon&r=PG&f=1", "display_name": "Tulsi", "link": "https://stackoverflow.com/users/8494948/tulsi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 51749481, "answer_count": 3, "score": 4, "last_activity_date": 1533812162, "creation_date": 1533738458, "last_edit_date": 1533745257, "question_id": 51749197, "link": "https://stackoverflow.com/questions/51749197/signed-and-unsigned-char", "title": "Signed and unsigned char", "body": "<p>Why are two char like <code>signed char</code> and <code>unsigned char</code> with the same value not equal?</p>\n\n<pre><code>char a = 0xfb; \nunsigned char b = 0xfb;\nbool f;\nf = (a == b); \ncout &lt;&lt; f;\n</code></pre>\n\n<p>In the above code, the value of <code>f</code> is 0.<br>\nWhy it's so when both <code>a</code> and <code>b</code> have the same value?</p>\n"}, {"tags": ["c++", "linker", "g++", "shared-libraries", "libcrypto"], "comments": [{"owner": {"reputation": 918, "user_id": 4936507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36df2f476a2ed16bb905fc814370f720?s=128&d=identicon&r=PG&f=1", "display_name": "Domso", "link": "https://stackoverflow.com/users/4936507/domso"}, "edited": false, "score": 0, "creation_date": 1533738653, "post_id": 51749149, "comment_id": 90458295, "body": "did you try to compile it with <code>-fPIC</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9448038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9zL4MbOEmZY/AAAAAAAAAAI/AAAAAAAAB3g/-tMi2S0RqwI/photo.jpg?sz=128", "display_name": "Prabhjot Singh", "link": "https://stackoverflow.com/users/9448038/prabhjot-singh"}, "edited": false, "score": 0, "creation_date": 1533739443, "post_id": 51749412, "comment_id": 90458849, "body": "and how can we compile libcrypto.a with -fPIC?"}, {"owner": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "reply_to_user": {"reputation": 11, "user_id": 9448038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9zL4MbOEmZY/AAAAAAAAAAI/AAAAAAAAB3g/-tMi2S0RqwI/photo.jpg?sz=128", "display_name": "Prabhjot Singh", "link": "https://stackoverflow.com/users/9448038/prabhjot-singh"}, "edited": false, "score": 0, "creation_date": 1533739667, "post_id": 51749412, "comment_id": 90459020, "body": "@PrabhjotSingh recompling libcrypto.a with -fPIC is only really applicable if you build libcrypto.a and can add the flag."}, {"owner": {"reputation": 11, "user_id": 9448038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9zL4MbOEmZY/AAAAAAAAAAI/AAAAAAAAB3g/-tMi2S0RqwI/photo.jpg?sz=128", "display_name": "Prabhjot Singh", "link": "https://stackoverflow.com/users/9448038/prabhjot-singh"}, "edited": false, "score": 0, "creation_date": 1533740946, "post_id": 51749412, "comment_id": 90459881, "body": "I can use the shared objects but I have to copy them everytime I run make"}], "tags": [], "owner": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "is_accepted": false, "score": 0, "last_activity_date": 1533739950, "last_edit_date": 1533739950, "creation_date": 1533739111, "answer_id": 51749412, "question_id": 51749149, "link": "https://stackoverflow.com/questions/51749149/c-linker-error-relocation-r-x86-64-32-against-rodata-str1-1-linking-cxx-sh/51749412#51749412", "title": "c++ Linker error &#39;relocation R_X86_64_32 against `.rodata.str1.1&#39; Linking CXX shared library libsrt.so", "body": "<p>what the error message is telling you is that the linking of <code>libsrt.so</code> failed because you tried to link <code>libsrt.so</code> with <code>libcrypto.a</code> but <code>libcrypto.a</code> wasn't complied with <code>-fPIC</code>.</p>\n\n<p><code>-fPIC</code> is a complier flag that changes the code generation to production position indepandent code (PIC) which is required for shared object because the linker doesn't know where the shared object will be loaded.</p>\n\n<p>to fix this issue you can:</p>\n\n<ul>\n<li>recomplie <code>libcrypto.a</code> with <code>-fPIC</code> if you complied it yourself</li>\n<li>use the shared object of libcrypto <code>libcrypto.so</code> if you received compiled binairies</li>\n</ul>\n\n<p>in your case libcrypto being part of openssl using <code>libcrypto.so</code> is much better</p>\n"}, {"tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1533745658, "creation_date": 1533745658, "answer_id": 51751505, "question_id": 51749149, "link": "https://stackoverflow.com/questions/51749149/c-linker-error-relocation-r-x86-64-32-against-rodata-str1-1-linking-cxx-sh/51751505#51751505", "title": "c++ Linker error &#39;relocation R_X86_64_32 against `.rodata.str1.1&#39; Linking CXX shared library libsrt.so", "body": "<p>You need to build a shared version of <code>libcrypto</code> - <code>libcrypto.so</code>. And link against that (the linker does that automatically when <code>.so</code> is present).</p>\n"}], "owner": {"reputation": 11, "user_id": 9448038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9zL4MbOEmZY/AAAAAAAAAAI/AAAAAAAAB3g/-tMi2S0RqwI/photo.jpg?sz=128", "display_name": "Prabhjot Singh", "link": "https://stackoverflow.com/users/9448038/prabhjot-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 517, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1533745658, "creation_date": 1533738335, "last_edit_date": 1533745252, "question_id": 51749149, "link": "https://stackoverflow.com/questions/51749149/c-linker-error-relocation-r-x86-64-32-against-rodata-str1-1-linking-cxx-sh", "title": "c++ Linker error &#39;relocation R_X86_64_32 against `.rodata.str1.1&#39; Linking CXX shared library libsrt.so", "body": "<p>I am getting this error everytime I run make.If I copy libsrt.so from another directory,then it gets compiled. Anyone has idea?   </p>\n\n<pre><code>Linking CXX shared library libsrt.so\n/usr/bin/ld: /usr/local/ssl/lib/libcrypto.a(aes_misc.o): relocation R_X86_64_32 against `.rodata.str1.1' can not be used when making a shared object; recompile with -fPIC\n/usr/local/ssl/lib/libcrypto.a: error adding symbols: Bad value\ncollect2: error: ld returned 1 exit status\nCMakeFiles/srt.dir/build.make:763: recipe for target 'libsrt.so.1.2.0' failed\n</code></pre>\n"}, {"tags": ["c++", "templates", "jniwrapper"], "answers": [{"comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 3404, "user_id": 704329, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/574fe57e68e8ad8db920677c96745306?s=128&d=identicon&r=PG", "display_name": "wl2776", "link": "https://stackoverflow.com/users/704329/wl2776"}, "edited": false, "score": 0, "creation_date": 1533749331, "post_id": 51750961, "comment_id": 90464716, "body": "Ah, sorry, I messed up how to declare the pointer const, rather than the function return type. The syntax is rather arcane"}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": true, "score": 1, "last_activity_date": 1533749436, "last_edit_date": 1533749436, "creation_date": 1533743753, "answer_id": 51750961, "question_id": 51749136, "link": "https://stackoverflow.com/questions/51749136/how-to-implement-mapping-from-type-to-object-method-call-using-c-templates/51750961#51750961", "title": "How to implement mapping from type to object method call using C++ templates?", "body": "<p>You can add pointer to members to your trait.</p>\n\n<pre><code>template &lt;&gt;\nstruct TypeToObjectType&lt;jbyteArray&gt;\n{\n    typedef jbyte type;\n    static constexpr jbyte * (JNIEnv::* const GetElements)(jbyteArray, jboolean *) = &amp;JNIEnv::GetByteArrayElements;\n    static constexpr void (JNIEnv::* const ReleaseElements)(jbyteArray, jbyte *, decltype(JNI_ABORT)) = &amp;JNIEnv::ReleaseByteArrayElements;\n};\n\ntemplate &lt;&gt;\nstruct TypeToObjectType&lt;jintArray&gt;\n{\n    typedef jint type;\n    static constexpr jint * (JNIEnv::* const GetElements)(jintArray, jboolean *) = &amp;JNIEnv::GetIntArrayElements;\n    static constexpr void (JNIEnv::* const ReleaseElements)(jintArray, jint *, decltype(JNI_ABORT)) = &amp;JNIEnv::ReleaseIntArrayElements;\n};\n</code></pre>\n\n<p>Which you call through slightly different syntax</p>\n\n<pre><code>Java_array(JNIEnv *_env, javaArrayT _array)\n    : env(_env)\n    , array(_array)\n    , array_len(-1)\n{\n    array_elements = (env-&gt;*TypeToObjectType&lt;javaArrayT&gt;::GetElements)(array, &amp;is_copy);\n}\n\n~Java_array() {\n    (env-&gt;*TypeToObjectType&lt;javaArrayT&gt;::ReleaseElements)(array, array_elements, JNI_ABORT);\n}\n</code></pre>\n"}], "owner": {"reputation": 3404, "user_id": 704329, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/574fe57e68e8ad8db920677c96745306?s=128&d=identicon&r=PG", "display_name": "wl2776", "link": "https://stackoverflow.com/users/704329/wl2776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 51750961, "answer_count": 1, "score": 1, "last_activity_date": 1533758735, "creation_date": 1533738295, "last_edit_date": 1533758735, "question_id": 51749136, "link": "https://stackoverflow.com/questions/51749136/how-to-implement-mapping-from-type-to-object-method-call-using-c-templates", "title": "How to implement mapping from type to object method call using C++ templates?", "body": "<p>I'd like to develop (yet another) wrapper for java arrays in JNI code using C++ templates. Main goal is to improve my C++ template programming skills.</p>\n\n<p>I compile the code using Android NDK (compiler is Clang 6.0.2)</p>\n\n<p>What I've managed to do so far:</p>\n\n<pre><code>#include &lt;jni.h&gt;\n\ntemplate &lt;typename T&gt;\nstruct TypeToObjectType;\n\ntemplate &lt;&gt;\nstruct TypeToObjectType&lt;jbyteArray&gt;\n{\n    typedef jbyte type;\n};\n\ntemplate &lt;&gt;\nstruct TypeToObjectType&lt;jintArray&gt;\n{\n    typedef jint type;\n};\n\ntemplate &lt;typename javaArrayT, typename nativeT&gt;\nclass Java_array{\n    JNIEnv *env;\n    jboolean is_copy;\n    jsize array_len;\n\n    javaArrayT array;\n    typename TypeToObjectType&lt;javaArrayT&gt;::type *array_elements;\n\npublic:\n    Java_array(JNIEnv *_env, javaArrayT _array)\n        : env(_env)\n        , array(_array)\n        , array_len(-1)\n    {\n        array_elements = env-&gt;GetByteArrayElements(array, &amp;is_copy);  //TODO: make it resolving automatically to other primitives\n    }\n\n    ~Java_array() {\n        env-&gt;ReleaseByteArrayElements(array, array_elements, JNI_ABORT);\n    }\n\n    jsize len(){\n        if (array_len &lt; 0)\n           array_len = env-&gt;GetArrayLength(array);\n        return array_len;\n    }\n\n    operator nativeT* () const {\n        return reinterpret_cast&lt;nativeT*&gt;(array_elements);\n    };\n};\n</code></pre>\n\n<p>This does not work for <code>int[]</code>, <code>float[]</code> and other arrays except <code>byte[]</code>, since  this class calls <code>GetByteArrayElements</code>.</p>\n\n<p>I use <code>struct TypeToObjectType</code> to establish mapping <code>jbyteArray</code> -> <code>jbyte</code>, <code>jintArray</code> -> <code>jint</code>. </p>\n\n<p>This mapping is missing part java type -> <code>JEnv</code> method calls, that is <code>jbyteArray</code> -> (<code>GetByteArrayElements</code>, <code>ReleaseByteArrayElements</code>), <code>jintArray</code> -> (<code>GetIntArrayElements</code>, <code>ReleaseIntArrayElements</code>)`</p>\n\n<p>How can I do it?</p>\n\n<p>How can I improve my code using features from C++11, C++14?</p>\n"}, {"tags": ["c++", "stl", "c++17", "unordered-set", "string-view"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1533739536, "post_id": 51749081, "comment_id": 90458926, "body": "The property you are looking for is commonly called &quot;transparent lookup&quot;, and I fear nothing has changed since that answer. :("}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1533740028, "post_id": 51749081, "comment_id": 90459248, "body": "@MaxLanghof: <a href=\"https://stackoverflow.com/q/49709548/364696\">That question</a> was limited to C++11, and covered working with a <code>char*</code> and a length. <code>std::string_view</code> is a C++17 feature, so even if there were solutions for that case, that question is unlikely to attract them. One would hope the invention of <code>string_view</code> included addressing this sort of use case (though I wouldn&#39;t be surprised if it didn&#39;t)."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1533740522, "post_id": 51749081, "comment_id": 90459578, "body": "@ShadowRanger Unless <code>std::unordered_map&#47;set</code> were specialized for a key type of <code>std::string</code>, the answer given there quite clearly says that heterogeneous lookup for these types is (and will, for the near future, be) unavailable. I concede that the former condition is not clearly stated in the duplicate, but I had no trouble finding the information I would need in order to conclude as much from simply googling the question title."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1533740930, "post_id": 51749081, "comment_id": 90459873, "body": "@ShadowRanger More to the point, the best answer I could give to the question here would be a verbatim copy of the one in the duplicate (well, its first two paragraphs)."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1533746867, "post_id": 51749081, "comment_id": 90463391, "body": "@MaxLanghof: Wait, I&#39;m confused. I thought C++14&#39;s heterogeneous lookup was designed for almost exactly this particular case? Why doesn&#39;t that work here? <a href=\"https://stackoverflow.com/questions/31923715/how-can-i-search-an-stdmap-using-a-key-of-a-different-type\" title=\"how can i search an stdmap using a key of a different type\">stackoverflow.com/questions/31923715/&hellip;</a>"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 1, "creation_date": 1533747707, "post_id": 51749081, "comment_id": 90463877, "body": "@MooingDuck I initially wrote an answer that demonstrated just that, but then I realized the question is about <b>unordered</b> (i.e. hash) maps/sets. Those do not have that feature, sadly."}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1533905891, "post_id": 51749081, "comment_id": 90531255, "body": "@ShadowRanger the fact that <code>string_view</code> is a C++17 feature is irrelevant, the other question is about heterogeneous lookup in general, not just for <code>string</code> vs <code>string_view</code>. The standard library aims for generic solutions, not adding a special case just for strings in maps. Everything that answer says is still relevant: it works for ordered maps and sets in C++14, (e.g. with <code>experimental::string_view</code> and <code>string</code>) but doesn&#39;t work with unordered containers. <code>boost::unordered_map</code> supports it, so OP doesn&#39;t need to write their own type."}], "answers": [{"comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1533750912, "post_id": 51751115, "comment_id": 90465518, "body": "Note: Having read the responses to <a href=\"https://stackoverflow.com/q/51752143/364696\">my question</a> and thought about it some more, while <code>mymap.try_emplace(*to_insert, std::move(to_insert));</code> is definitely legal/safe (thanks to <code>try_emplace</code>s eager evaluation of the key, but lazy construction of the value), <a href=\"https://stackoverflow.com/questions/51752143/is-stdmove-safe-in-an-arguments-list-when-the-argument-is-forwarded-not-move#comment90464630_51752360\">it&#39;s code smell</a>, so I&#39;d recommend using the solution that splits <code>string_view</code> conversion from <code>try_emplace</code>, even if it&#39;s trivially slower."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1533754719, "post_id": 51751115, "comment_id": 90467471, "body": "In my last comment, I suggested splitting <code>string_view</code> conversion from <code>try_emplace</code> might be &quot;trivially slower&quot;. I tested this, and it turns out the output produced by <code>g++</code> 7.2.0 for my test case was identical under <code>-Os</code>, and almost identical (to the point where I&#39;m fairly sure it would perform identically, since the modified code paths looked to be involved in exception handling and never run on success) under <code>-O3</code>. Point is, at the expense of one additional line of code, and no cost to performance, you can avoid code smell, so do it; your maintainer will thank you for it. :-)"}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 4, "last_activity_date": 1533748578, "last_edit_date": 1533748578, "creation_date": 1533744180, "answer_id": 51751115, "question_id": 51749081, "link": "https://stackoverflow.com/questions/51749081/stdstring-view-and-stdstring-in-stdunordered-set/51751115#51751115", "title": "std::string_view and std::string in std::unordered_set", "body": "<p>I don't have a nice solution, but a possible workaround with minimal custom code, at the expense of increased memory usage, would be to replace your <code>std::unordered_set&lt;std::string&gt;</code> with a <code>std::unordered_map</code> that has views for keys, and strings for values (which back the views).</p>\n\n<p>Unfortunately, thanks to the small string optimization, we can't rely on <code>std::move</code> preserving the original address of the underlying <code>string</code>'s data, so something like:</p>\n\n<pre><code>std::string to_insert(...);\nmymap.try_emplace(to_insert, std::move(to_insert));\n</code></pre>\n\n<p>isn't going to work.</p>\n\n<p>Instead, it would have to be a <code>std::unordered_map&lt;std::string_view, std::unique_ptr&lt;std::string&gt;&gt;</code> so we could preserve the unique address of the string's characters, making the code more like:</p>\n\n<pre><code>auto to_insert = std::make_unique&lt;std::string&gt;(...);\nmymap.try_emplace(*to_insert, std::move(to_insert));\n</code></pre>\n\n<p>While insertion would be kinda ugly, simple membership testing would remain simple, since <code>std::string</code> <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/operator_basic_string_view\" rel=\"nofollow noreferrer\">defines an implicit <code>operator std::string_view</code></a>, and <code>std::string_view</code> has an implicit constructor for <code>char*</code>, so membership testing remains a simple:</p>\n\n<pre><code>if (mymap.count(some_string)) { ... }\n</code></pre>\n\n<p>whether <code>some_string</code> is a <code>char*</code>, <code>std::string_view</code> or <code>std::string</code>.</p>\n\n<p>Note: I'm not going to swear the two-liner <code>try_emplace</code>-based insertion code is legal, as I'm a bit out of practice on C++, and quite leery about using a <code>unique_ptr</code> in the same expression I'm <code>move</code>ing from it; on <code>g++</code> 7.2 it seems to work, and I <em>think</em> the fact that the key argument to <code>try_emplace</code> is constructed immediately, while the arguments to construct the value are forwarded <a href=\"https://stackoverflow.com/q/51752143/364696\">makes this safe</a>, but I'll acknowledge that my understanding of C++ evaluation order (or lack thereof) is not perfect. If I'm doing something illegal, not just ugly, then fixing it would require the slightly uglier (but definitely sequenced):</p>\n\n<pre><code>auto to_insert = std::make_unique&lt;std::string&gt;(...);\nstd::string_view key{*to_insert};\nmymap.try_emplace(std::move(key), std::move(to_insert));\n</code></pre>\n\n<p>Additional note: <em>Only</em> the <code>emplace</code>/<code>emplace_hint</code>/<code>try_emplace</code> functions can be safely used to update the entries in <code>mymap</code> in this design. Using <code>mymap[key] = std::move(to_insert);</code> or <code>insert_or_assign</code> breaks if the same key is encountered twice while building the map, as the original <code>string_view</code> (referencing the original <code>string</code>'s data) would be preserved, while the value would be replaced with the new <code>string</code>, invalidating the <code>string_view</code>'s pointer. While <code>insert</code> doesn't replace values, I believe using it would require a design more like the three-liner with <code>try_emplace</code>, as making the <code>std::pair</code> to insert would be unsequenced if you tried to construct both view and <code>unique_ptr</code> as part of <code>pair</code> construction.</p>\n"}], "owner": {"reputation": 605, "user_id": 7128840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdNYI.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/7128840/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2905, "favorite_count": 1, "closed_date": 1533905959, "accepted_answer_id": 51751115, "answer_count": 1, "score": 9, "last_activity_date": 1533905575, "creation_date": 1533738122, "last_edit_date": 1533905575, "question_id": 51749081, "link": "https://stackoverflow.com/questions/51749081/stdstring-view-and-stdstring-in-stdunordered-set", "closed_reason": "Duplicate", "title": "std::string_view and std::string in std::unordered_set", "body": "<p>Let's say you have an <code>std::unordered_set&lt;std::string&gt;</code> . </p>\n\n<p>You have an <code>std::string_view</code> object that you want to search for in the container. Problem is, you don't want to create a <code>std::string</code> from your <code>std::string_view</code>, as this kind of defeats the purpose of using <code>std::string_view</code> in the first place. </p>\n\n<p>However, it seems that <code>std::string_view</code> should be usable as a key; there should be some way to compare <code>std::string_view</code> and <code>std::string</code> , as they both basically represent the same thing. But there isn't, not in the STL anyway. </p>\n\n<p>This is an impasse, am I forced to write my own comparison object for <code>std::string_view</code> and <code>std::string</code> objects to use with my <code>std::unordered_set</code> ?</p>\n\n<p>edit: This question is specific to string_view objects. The 'duplicate' question is not relevant. I received a unique answer to a unique question, as expected. </p>\n"}, {"tags": ["c++", "string"], "comments": [{"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 2, "creation_date": 1533738166, "post_id": 51749035, "comment_id": 90457888, "body": "There is <code>std::to_string</code> function. If that is what you are after. If you are looking for some kind of language reflection then you are out of luck."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1533738323, "post_id": 51749035, "comment_id": 90458015, "body": "what you want to do is only possible with some major restrictions. Consider <code>void foo(int)</code> where you cannot (inside the function) distinguish between a call <code>foo(3)</code> and <code>foo(1+2)</code> and <code>foo(x)</code> (where <code>x==3</code>). This might be fine for you, but i doubt that you can unambigously detect inside the function that the <code>Shape</code> object was created by that constructor call <code>v::Shape(224, 224, 3)</code>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533738395, "post_id": 51749035, "comment_id": 90458081, "body": "...or you enter the evil side and use macros, then (almost) anything is possible ;)"}, {"owner": {"reputation": 14371, "user_id": 321866, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/25e93a50d485eca289f887868e1bcea5?s=128&d=identicon&r=PG", "display_name": "C Johnson", "link": "https://stackoverflow.com/users/321866/c-johnson"}, "edited": false, "score": 0, "creation_date": 1533740410, "post_id": 51749035, "comment_id": 90459500, "body": "Best to just write your own custom code. Custom for each function call you want to serialize. If this was c#, reflection would make this a trivial task. Given that it&#39;s C++, you are almost out of luck."}, {"owner": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "edited": false, "score": 0, "creation_date": 1533741491, "post_id": 51749035, "comment_id": 90460227, "body": "Write a preprocessor to add this code to each function. Or look at some of the open-source RTTI libraries (like <a href=\"https://github.com/timkerchmar/tstype\" rel=\"nofollow noreferrer\">github.com/timkerchmar/tstype</a>). Or document your code (doxygen)."}], "answers": [{"tags": [], "owner": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "is_accepted": true, "score": 0, "last_activity_date": 1533739964, "last_edit_date": 1533739964, "creation_date": 1533739576, "answer_id": 51749589, "question_id": 51749035, "link": "https://stackoverflow.com/questions/51749035/c-how-to-convert-function-arguments-to-strings/51749589#51749589", "title": "c++ how to convert function arguments to strings", "body": "<p>Try this :</p>\n\n<pre><code>mv::Model::input(const Shape&amp; shape, DType dType, Order order, const string&amp; name)\n{\n    std::ostringstream ss;\n    ss &lt;&lt; \"Function [mv::Model::input]- [const Shape&amp;]\" &lt;&lt; shape.print() &lt;&lt; \" [DType]\" &lt;&lt; dType.print()&lt;&lt; \" [Order]\" &lt;&lt; order.print()&lt;&lt; \" [const string&amp;]\" &lt;&lt; name;\n    //write to file\n    std::ofstream of;\n    of.open(\"file.txt\");\n    of &lt;&lt; ss.rdbuf();\n}\n</code></pre>\n\n<p>Add print() member function for each object:</p>\n\n<pre><code>    std::string shape::print() const\n    { \n       return \"round shape\";\n    }\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 10175853, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0l0VB5YyXT4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qdCq8vE8WiSMZt3wtjs9d4OC-hxw/mo/photo.jpg?sz=128", "display_name": "pelican brady", "link": "https://stackoverflow.com/users/10175853/pelican-brady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 51749589, "answer_count": 1, "score": 1, "last_activity_date": 1533739964, "creation_date": 1533738014, "question_id": 51749035, "link": "https://stackoverflow.com/questions/51749035/c-how-to-convert-function-arguments-to-strings", "title": "c++ how to convert function arguments to strings", "body": "<p>I have a function below <code>input</code> which takes 4 arguments. Inside the function I would like to recreate the function call as a string and write it to a file. </p>\n\n<p>For example this function could be called with:</p>\n\n<pre><code>input = cm.input(mv::Shape(224, 224, 3), mv::DType::Float, mv::Order::Planar);\n</code></pre>\n\n<p>What would be the best way to convert the arguments to strings? After that I plan to concat them. </p>\n\n<p>I appreciate any advice on where to start.</p>\n\n<pre><code>mv::Model::input(const Shape&amp; shape, DType dType, Order order, const string&amp; name)\n{\n//Create string of function call\n}\n</code></pre>\n"}, {"tags": ["c++", "struct", "typedef"], "comments": [{"owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 1, "creation_date": 1533738380, "post_id": 51749016, "comment_id": 90458065, "body": "<code>int foo::*</code> represent a pointer to member syntax. It define a pointer to integer that is a foo member.  <code>foo_member m = &amp;foo::bar; </code> is storing the memory adress of the <code>foo::bar</code> member and storing in the pointer to member <code>foo_member m</code>."}, {"owner": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "reply_to_user": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 1, "creation_date": 1533738496, "post_id": 51749016, "comment_id": 90458169, "body": "@Clonk what&#39;s tripping me up is <code>foo</code> is a type, not an instance, and <code>bar</code> isn&#39;t static. If that&#39;s valid, and not just an oversight in the example, it&#39;s pretty odd."}, {"owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 0, "creation_date": 1533738657, "post_id": 51749016, "comment_id": 90458296, "body": "It&#39;s a pointer to an int member not a pointer to integer. This is how you would use it : <code>foo f; std::cout &lt;&lt; f.*m &lt;&lt; std::endl; </code>"}, {"owner": {"reputation": 522, "user_id": 153612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba347a31bc66bb2654de01850e914021?s=128&d=identicon&r=PG", "display_name": "Ta Thanh Dinh", "link": "https://stackoverflow.com/users/153612/ta-thanh-dinh"}, "reply_to_user": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 0, "creation_date": 1533738701, "post_id": 51749016, "comment_id": 90458324, "body": "@Clonk: thanks. It is a confused syntax, IMHO, <code>int foo::*</code> is a pointer to a member, but which member?. Moreover <code>&amp;foo:bar</code> is undefined? (since <code>foo</code> is a type?)"}, {"owner": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "reply_to_user": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 0, "creation_date": 1533738714, "post_id": 51749016, "comment_id": 90458338, "body": "@Clonk Yeah, I&#39;m reading the spec now. Just seems that the committee could have found a way to do that inside the struct definition. Oh, well. :)"}, {"owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 0, "creation_date": 1533738820, "post_id": 51749016, "comment_id": 90458406, "body": "<code>int foo::*</code> is a <b>type</b>. <code>&amp;foo:bar</code> is an instance of this type if you will (it has the type <code>int foo::*</code>)"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533738832, "post_id": 51749016, "comment_id": 90458413, "body": "No <code>&amp;foo::bar</code> is an object of type <code>int foo::*</code>, i.e. a &quot;pointer to int member-of-foo&quot;. The valid values of <code>int foo::*</code> are <code>&amp;foo::bar</code> and <code>&amp;foo::baz</code>"}, {"owner": {"reputation": 522, "user_id": 153612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba347a31bc66bb2654de01850e914021?s=128&d=identicon&r=PG", "display_name": "Ta Thanh Dinh", "link": "https://stackoverflow.com/users/153612/ta-thanh-dinh"}, "reply_to_user": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 0, "creation_date": 1533739029, "post_id": 51749016, "comment_id": 90458557, "body": "@Clonk: sorry <code>int foo::*</code> is a pointer type to a member (of type <code>int</code>) of <code>foo</code>."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533739169, "post_id": 51749016, "comment_id": 90458658, "body": "Consider: <code>foo_member m = (rand() % 2) ? &amp;foo::bar : &amp;foo::baz; foo f { 42, 0 }; std::cout &lt;&lt; f.*m;</code> The output depends on the choice of member"}, {"owner": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "edited": false, "score": 0, "creation_date": 1533739887, "post_id": 51749016, "comment_id": 90459165, "body": "That&#39;s pretty nifty.  Though, I&#39;d probably just add a reference <code>int&amp; getIt() { return (rand() % 2) ? bar : baz; }</code> Shrug."}], "owner": {"reputation": 522, "user_id": 153612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba347a31bc66bb2654de01850e914021?s=128&d=identicon&r=PG", "display_name": "Ta Thanh Dinh", "link": "https://stackoverflow.com/users/153612/ta-thanh-dinh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "closed_date": 1533738361, "answer_count": 0, "score": 2, "last_activity_date": 1533739644, "creation_date": 1533737964, "last_edit_date": 1533739644, "question_id": 51749016, "link": "https://stackoverflow.com/questions/51749016/pointer-to-structs-member", "closed_reason": "Duplicate", "title": "Pointer to struct&#39;s member", "body": "<p>I've found in <a href=\"https://stackoverflow.com/questions/34454095/using-pointers-to-members-and-address-spaces-in-clang\">this question</a> a strange syntax:</p>\n\n<pre><code>struct foo {\n    int bar;\n    int baz;\n};\n\ntypedef int foo::*foo_member;\nfoo_member m = &amp;foo::bar;\n</code></pre>\n\n<p>I still do not understand the type <code>foo_member</code>, what does type <code>int foo::*</code> mean? </p>\n\n<p>Even more confused, what is <code>&amp;foo::bar</code> in the initialization</p>\n\n<pre><code>foo_member m = &amp;foo::bar;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>foo AS1* f = /* ... */;\nf-&gt;*m = 4;\n</code></pre>\n\n<p>I suppose that means <code>f-&gt;bar = 4</code> (or not?), what does syntax <code>f-&gt;*_variable_</code> mean?</p>\n\n<p>Many thanks for any response.</p>\n"}, {"tags": ["c++", "pointers", "reference", "language-lawyer", "invalidation"], "comments": [{"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 1, "creation_date": 1533741507, "post_id": 51748529, "comment_id": 90460240, "body": "Is that supposed to be <code>s2[1] = &#39;B&#39;;</code> (a <code>char</code> instead of a string literal)? What you have there shouldn&#39;t compile."}, {"owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 0, "creation_date": 1533805848, "post_id": 51748529, "comment_id": 90484839, "body": "The standard only says &quot;may be invalidated&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "is_accepted": false, "score": 0, "last_activity_date": 1533737496, "last_edit_date": 1533737496, "creation_date": 1533736947, "answer_id": 51748656, "question_id": 51748529, "link": "https://stackoverflow.com/questions/51748529/what-exactly-is-invalidation-of-reference-pointer/51748656#51748656", "title": "What exactly is invalidation of reference/pointer?", "body": "<p>For example:</p>\n\n<pre><code>std::string * p_s(new ::std::string(\"abc\"));\nstd::string s2(*p_s); // shares buffer with p_s\nchar const &amp; ch1(static_cast&lt;::std::string const &amp;&gt;(*p_s)[0]);\nchar const &amp; ch2(static_cast&lt;::std::string const &amp;&gt;(s2)[0]); // same as ch1\n// CoW, ch2 becomes invalid, but is backed by p_s buffer\nchar &amp; ch(static_cast&lt;::std::string &amp;&gt;(s2)[0]); // backed by new buffer\n// both ch1 and ch2 become invalid\ndelete p_s;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1533737146, "post_id": 51748658, "comment_id": 90457191, "body": "In my example the referred to character still exists. But I can probably see your point. If <code>s</code> was destructed, then both <code>p</code> and <code>r</code> would be really invalidated even they have nothing to do with <code>s</code> by definition."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 3, "creation_date": 1533737240, "post_id": 51748658, "comment_id": 90457261, "body": "@DanielLangr You say it exists, but the implementation does not guarantee it to you. That&#39;s what invalidation means. Same as any other &quot;may be, may not be&quot; scenario in C++. You are advised to code to contract rather than to chance. It is agreed that there may be some situations where you can actually know with great certainty that an invalidated object will in reality still exist. However, such situations are generally contrived and do not guide the general case."}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1613094285, "post_id": 51748658, "comment_id": 116977392, "body": "[conv.lval] means <a href=\"https://timsong-cpp.github.io/cppwp/n4659/basic.compound#def:invalid_pointer_value\" rel=\"nofollow noreferrer\">timsong-cpp.github.io/cppwp/n4659/&hellip;</a>, exact definition, not &#171;the term ... inherited from English&#187;"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 6, "last_activity_date": 1533736960, "creation_date": 1533736960, "answer_id": 51748658, "question_id": 51748529, "link": "https://stackoverflow.com/questions/51748529/what-exactly-is-invalidation-of-reference-pointer/51748658#51748658", "title": "What exactly is invalidation of reference/pointer?", "body": "<p>There is no definition for \"invalidation\" in the standard because the term is inherited from English. It means what it means in English: an invalidated reference/pointer is no longer valid. It cannot be used.</p>\n\n<p>There are, however, places where this constraint is explicitly noted. For example, when converting a pointer lvalue to an rvalue (which happens during evaluation of an expression):</p>\n\n<blockquote>\n  <p><code>[conv.lval/2]</code> Otherwise, if the object to which the glvalue refers contains an invalid pointer value (3.7.4.2, 3.7.4.3), the behavior is implementation-defined</p>\n</blockquote>\n\n<p>I can't find the wording for references right now, but it's anyway self-explanatory that you cannot use a reference to something that no longer exists.</p>\n"}], "owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 612, "favorite_count": 0, "accepted_answer_id": 51748658, "answer_count": 2, "score": 5, "last_activity_date": 1533737496, "creation_date": 1533736516, "question_id": 51748529, "link": "https://stackoverflow.com/questions/51748529/what-exactly-is-invalidation-of-reference-pointer", "title": "What exactly is invalidation of reference/pointer?", "body": "<p>I cannot find any definition for <em>invalidation of pointers/references</em> in the Standard. I ask because I just found out that C++11 forbids copy-on-write (COW) for strings. As far as I understand, if COW was applied then <code>p</code> would be still a valid pointer and <code>r</code> a valid reference after the following commands:</p>\n\n<pre><code>std::string s(\"abc\");\nstd::string s2(s);\nchar * p = &amp;(s2[0]);\nchar &amp; r = s2[0];\ns2[1] = \"B\";\n</code></pre>\n\n<p>Just they would no longer point/refer to the first character of <code>s2</code>, but merely to the first character of <code>s</code>. </p>\n\n<p>In the C++11 Standard, it is said that non-constant <code>std::basic_string::operator[]</code> may not invalidate pointers/references (and also iterators) to string elements.</p>\n\n<p>Which rules say that the above shown example would actually invalidate <code>p</code> and <code>r</code> if COW was implemented?</p>\n"}, {"tags": ["c++", "cuda"], "comments": [{"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 1, "creation_date": 1533737476, "post_id": 51748521, "comment_id": 90457409, "body": "Providing suggestions about making something faster requires understanding how fast it is now, and you have not provided anything like enough information to know that. Can you please edit a proper <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> along with your performance measurements into your question, otherwise I doubt you will get a useful answer"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10197994, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-L8R1kPIprP4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7omJHU3gSddK13j76sG58jeYEqfqA/mo/photo.jpg?sz=128", "display_name": "helena", "link": "https://stackoverflow.com/users/10197994/helena"}, "is_accepted": false, "score": -1, "last_activity_date": 1534163068, "creation_date": 1534163068, "answer_id": 51822322, "question_id": 51748521, "link": "https://stackoverflow.com/questions/51748521/normalize-a-matrix-colwise-on-the-gpu/51822322#51822322", "title": "normalize a matrix colwise on the GPU", "body": "<p>this works best so far: </p>\n\n<pre><code>__global__ void test( float * x, int colSize )     // data of Matrix3Xf x\n{      \n    int id = blockIdx.x * blockDim.x + threadIdx.x;\n\n    if (id &lt; colSize) // stay within the limits of x\n    {\n        int col = id * 3;\n        float norm = x[col] * x[col] + x[col + 1] * x[col + 1] + x[col + 2] * x[col + 2];\n        norm = rsqrtf(norm);\n\n        x[col] = x[col] * norm;\n        x[col + 1] = x[col + 1] * norm;\n        x[col + 2] = x[col + 2] * norm;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10197994, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-L8R1kPIprP4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7omJHU3gSddK13j76sG58jeYEqfqA/mo/photo.jpg?sz=128", "display_name": "helena", "link": "https://stackoverflow.com/users/10197994/helena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1534163068, "creation_date": 1533736481, "question_id": 51748521, "link": "https://stackoverflow.com/questions/51748521/normalize-a-matrix-colwise-on-the-gpu", "title": "normalize a matrix colwise on the GPU", "body": "<p>I try to normalize a matrix colwise on the GPU with good performance. I wrote this function:</p>\n\n<pre><code>__global__ void test(float * x){      // data of Matrix3Xf x\n int id = blockIdx.x * blockDim.x + threadIdx.x;\n\nif (id &lt; colSize) // stay within the limits x\n{\n    int col = id * 3;\n    float norm = 1 / norm3df(x[col], x[col + 1], x[col + 2]);\n\n    x[col] = x[col] * norm;\n    x[col + 1] = x[col + 1] * norm;\n    x[col + 2] = x[col + 2] * norm;\n}\n</code></pre>\n\n<p>I found the data type float3 which is in the Cg Toolkit, but it's not up to date anymore (c.f. <a href=\"https://developer.nvidia.com/cg-toolkit\" rel=\"nofollow noreferrer\">https://developer.nvidia.com/cg-toolkit</a>) ... any ideas how to make it faster? My environment is Visual Studio 2017 and CUDA 9.2.</p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["c++", "c++11"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 10198080, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nvAd3HMDiOw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oBcVMuppb4WqiI5zKtIjun69Krzw/mo/photo.jpg?sz=128", "display_name": "Varthanil", "link": "https://stackoverflow.com/users/10198080/varthanil"}, "edited": false, "score": 0, "creation_date": 1533736603, "post_id": 51748526, "comment_id": 90456812, "body": "OMG. thanks boss! Im just starting and haha... funny how one lower case letter can change the whole meaning"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 9, "user_id": 10198080, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nvAd3HMDiOw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oBcVMuppb4WqiI5zKtIjun69Krzw/mo/photo.jpg?sz=128", "display_name": "Varthanil", "link": "https://stackoverflow.com/users/10198080/varthanil"}, "edited": false, "score": 0, "creation_date": 1533736644, "post_id": 51748526, "comment_id": 90456836, "body": "Easily done. With more experience you will learn how to recognise familiar error patterns and, consequently, how to very quickly spot the cause (and fix it!)"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 2, "last_activity_date": 1533736506, "creation_date": 1533736506, "answer_id": 51748526, "question_id": 51748487, "link": "https://stackoverflow.com/questions/51748487/expected-initializer-before-token-structures-and-templates/51748526#51748526", "title": "Expected initializer before &lt; token - structures and templates", "body": "<pre><code>#include &lt;iostream&gt;\ntemplate &lt;typename T&gt;\nvoid swap (T &amp;a, T &amp;b);\n</code></pre>\n\n<p>Pretty sure you meant <code>Swap</code> here.</p>\n\n<p>Without it, the subsequent specialisation cannot be compiled.</p>\n\n<p>The words <code>swap</code> and <code>Swap</code> are different because C++ is case-sensitive.</p>\n\n<p>Take care when transcribing from your book.</p>\n"}], "owner": {"reputation": 9, "user_id": 10198080, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nvAd3HMDiOw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oBcVMuppb4WqiI5zKtIjun69Krzw/mo/photo.jpg?sz=128", "display_name": "Varthanil", "link": "https://stackoverflow.com/users/10198080/varthanil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "closed_date": 1533763543, "accepted_answer_id": 51748526, "answer_count": 1, "score": -1, "last_activity_date": 1533736513, "creation_date": 1533736401, "last_edit_date": 1533736513, "question_id": 51748487, "link": "https://stackoverflow.com/questions/51748487/expected-initializer-before-token-structures-and-templates", "closed_reason": "Not suitable for this site", "title": "Expected initializer before &lt; token - structures and templates", "body": "<p>I am getting this exact error while practicing listings from one of my programming books... I have literally no clue; mb I'm blind or sth. Please help.\nI've tried various other combinations but this one below seems to be most visible for what I have to do. There is still no classes so I wonder if its somehow connected to the using namespace std.</p>\n\n<p>EDIT#1 Forgot to add on which line: 11, 22</p>\n\n<pre><code>#include &lt;iostream&gt;\ntemplate &lt;typename T&gt;\nvoid swap (T &amp;a, T &amp;b);\n\nstruct job{\n    char name[40];\n    double salary;\n    int floor;\n};\n\ntemplate &lt;&gt; void Swap&lt;job&gt;(job &amp;j1, job &amp;j2);\nvoid Show(job &amp;j);\n\nint main(){\n    using namespace std;\n    cout.precision(2);\n    cout.setf(ios::fixed, ios::floatfield);\n    int i = 10, j = 20;\n    cout &lt;&lt; \"i, j =\" &lt;&lt; i &lt;&lt; \", \" &lt;&lt; j &lt;&lt; \".\\n\";\n    cout &lt;&lt; \"Using generated by compiler function \"\n            \"changing int value:\\n\";\n    Swap(i,j);\n    cout &lt;&lt; \"Now i, j = \" &lt;&lt; i &lt;&lt; \", \" &lt;&lt; j &lt;&lt; \".\\n\";\n    job sue = {\"Susan Yaffee\", 73000.60, 7};\n    job sidney = {\"Sidney Taffee\", 78060.72, 9};\n    cout &lt;&lt; \"Before changing job structure:\\n\";\n    Show(sue);\n    Show(sidney);\n    Swap(sue, sidney);\n    cout &lt;&lt; \"After changing job structure:\\n\";\n    Show(sue);\n    Show(sidney);\n    cin.get();\n    return 0;\n}\n\ntemplate &lt;typename T&gt;\nvoid Swap(T &amp;a, T &amp;b){\n    using namespace std;\n    T temp;\n    temp = a;\n    a = b;\n    b = temp;\n}\n\ntemplate &lt;&gt; void Swap&lt;job&gt;(job &amp;j1, job &amp;j2){\n    using namespace std;\n    double t1;\n    int t2;\n    t1 = j1.salary;\n    j1.salary = j2.salary;\n    j2.salary = t1;\n    t2 = j1.floor;\n    j1.floor = j2.floor;\n    j2.floor = t2;\n}\n\nvoid Show(job &amp;j){\n    using namespace std;\n    cout &lt;&lt; j.name &lt;&lt; \": \" &lt;&lt; j.salary &lt;&lt; \"$ at floor \" &lt;&lt; j.floor &lt;&lt; endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++17"], "comments": [{"owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 5, "creation_date": 1533737284, "post_id": 51748482, "comment_id": 90457281, "body": "It depends on what you want to do. All are valid ways to initialize string. &quot;Better&quot; is relative. Better performance ? Better code lisibility ?"}], "answers": [{"comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1533745628, "post_id": 51748815, "comment_id": 90462736, "body": "This doesn&#39;t really answer the question. It should&#39;ve been a comment."}], "tags": [], "owner": {"reputation": 1199, "user_id": 2827901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a274b3f7a545e83440885b59f08792a?s=128&d=identicon&r=PG&f=1", "display_name": "cpp_enthusiast", "link": "https://stackoverflow.com/users/2827901/cpp-enthusiast"}, "is_accepted": false, "score": 0, "last_activity_date": 1533737852, "last_edit_date": 1533737852, "creation_date": 1533737449, "answer_id": 51748815, "question_id": 51748482, "link": "https://stackoverflow.com/questions/51748482/what-is-the-preferred-way-to-initialize-a-string-member-in-the-constructor/51748815#51748815", "title": "What is the preferred way to initialize a string member in the constructor?", "body": "<p>As clonk said, you need to specify what do you want exactly. Are you looking for performance or something else?</p>\n\n<p>Also you can compare this yourself using the compiler-explorer</p>\n\n<p><a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">https://godbolt.org/</a>.</p>\n\n<p>Write the code in the compiler-explorer and it will automatically generate the assemble code. Of course, you have choice of selecting the compiler.</p>\n"}, {"comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1533764993, "post_id": 51751742, "comment_id": 90471803, "body": "And the most legible is... Well, pretty much anything else ;)"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533806906, "post_id": 51751742, "comment_id": 90485520, "body": "I&#39;d leave off the <code>enable_if</code> unless it was <i>necessary</i>"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533807280, "post_id": 51751742, "comment_id": 90485767, "body": "@Caleth Without <code>enable_if</code> the constructor is going to be used for things not convertible to strings."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533807380, "post_id": 51751742, "comment_id": 90485828, "body": "No, it&#39;ll be a hard error to try. It is <i>currently</i> a hard error to try, so nothing has changed. You remove <i>one</i> level of template depth in the error message with the <code>enable_if</code>"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533808433, "post_id": 51751742, "comment_id": 90486558, "body": "@Caleth When other constructors are added this constructor is going to be chosen over the other ones. This is why it needs to be restricted on what it accepts. Watch that video to get more insight."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533808511, "post_id": 51751742, "comment_id": 90486610, "body": "That&#39;s what I meant when I said &quot;unless it was <i>necessary</i>&quot;"}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1533806470, "last_edit_date": 1533806470, "creation_date": 1533746676, "answer_id": 51751742, "question_id": 51748482, "link": "https://stackoverflow.com/questions/51748482/what-is-the-preferred-way-to-initialize-a-string-member-in-the-constructor/51751742#51751742", "title": "What is the preferred way to initialize a string member in the constructor?", "body": "<p>The most efficient way is to perfect-forward any argument convertible to <code>std::string</code>:</p>\n\n<pre><code>class MyStr {\n    std::string m_str;\n\npublic:\n    template&lt;class T,\n             class = std::enable_if_t&lt;std::is_convertible&lt;std::remove_reference_t&lt;T&gt;, std::string&gt;::value&gt;&gt;\n    MyStr(T&amp;&amp; arg)\n        : m_str(std::forward&lt;T&gt;(arg))\n    {}\n};\n</code></pre>\n\n<p>A bit of a mouthful though. The second best option is to not provide constructors at all, make data members public and initialize <code>MyStr</code> with aggregate initialization syntax.</p>\n\n<p>Full story: <a href=\"https://www.youtube.com/watch?v=PNRju6_yn3o\" rel=\"nofollow noreferrer\">CppCon 2017: Nicolai Josuttis \u201cThe Nightmare of Move Semantics for Trivial Classes\u201d</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1686, "user_id": 2615118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6c15506113bb2e6d1ebf17502d71a1c?s=128&d=identicon&r=PG", "display_name": "Julius", "link": "https://stackoverflow.com/users/2615118/julius"}, "is_accepted": false, "score": 1, "last_activity_date": 1533764811, "creation_date": 1533764811, "answer_id": 51756100, "question_id": 51748482, "link": "https://stackoverflow.com/questions/51748482/what-is-the-preferred-way-to-initialize-a-string-member-in-the-constructor/51756100#51756100", "title": "What is the preferred way to initialize a string member in the constructor?", "body": "<p>Here is a <strong>practical rule of thumb</strong> with a more general scope:</p>\n\n<blockquote>\n  <p>Pass all <em>cheaply movable</em><sup>\u2020</sup> sink arguments by value and use <code>std::move</code> whenever appropriate.</p>\n  \n  <p><sub><sup>\u2020</sup> Prime examples for types which are <strong>not</strong> <em>cheaply movable</em>: <code>std::array</code> and other types <code>T</code> where <code>sizeof(T)</code> is \"large\"</sub></p>\n</blockquote>\n\n<p>This is generally a good compromise between usability (on either side of the interface) and computational overhead. Typically, the extra work (compared to perfect forwarding) is at most one additional move construction and at most one additional deconstruction. Unless you have identified a performance bottleneck of your application, you most probably do not want to spend more programming effort.</p>\n\n<p><a href=\"http://blogs.microsoft.co.il/sasha/2014/08/21/c-sink-parameter-passing/\" rel=\"nofollow noreferrer\">This blog post on how to pass sink arguments</a> includes a longer discussion on the alternatives, and its conclusion also starts with \"stick to passing by value\" as the default.</p>\n\n<p><strong>Applied to your <code>std::string</code> member example</strong> this suggests</p>\n\n<pre><code>class MyStr {\n    std::string m_str;\n\npublic:\n    MyStr(std::string rstr) : m_str(std::move(rstr)) {}\n};\n</code></pre>\n\n<p>In addition to the general performance aspects mentioned above, note that the signature <code>MyStr::MyStr(std::string rstr)</code> implies that <code>MyStr</code> is storing a real copy of the <em>thing</em> passed as <code>rstr</code>. This may help a user to understand how <code>MyStr</code> should be used.</p>\n"}, {"tags": [], "owner": {"reputation": 1812, "user_id": 706055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59587d800e072afcecf5dfe8bc374957?s=128&d=identicon&r=PG&f=1", "display_name": "Amit G.", "link": "https://stackoverflow.com/users/706055/amit-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1533974599, "creation_date": 1533974599, "answer_id": 51797752, "question_id": 51748482, "link": "https://stackoverflow.com/questions/51748482/what-is-the-preferred-way-to-initialize-a-string-member-in-the-constructor/51797752#51797752", "title": "What is the preferred way to initialize a string member in the constructor?", "body": "<p>A full answer: <a href=\"https://www.bfilipek.com/2018/08/init-string-member.html?m=1\" rel=\"nofollow noreferrer\">Analysing the Cases</a></p>\n"}], "owner": {"reputation": 1812, "user_id": 706055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59587d800e072afcecf5dfe8bc374957?s=128&d=identicon&r=PG&f=1", "display_name": "Amit G.", "link": "https://stackoverflow.com/users/706055/amit-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 4, "accepted_answer_id": 51797752, "answer_count": 4, "score": 3, "last_activity_date": 1533974599, "creation_date": 1533736382, "last_edit_date": 1533746678, "question_id": 51748482, "link": "https://stackoverflow.com/questions/51748482/what-is-the-preferred-way-to-initialize-a-string-member-in-the-constructor", "title": "What is the preferred way to initialize a string member in the constructor?", "body": "<p>Below is a class with one string member. We\u2019d like to initialise it in the constructor:</p>\n\n<pre><code>class MyStr {\n    std::string m_str;\n\npublic:\n    MyStr(const std::string&amp; rstr) : m_str(rstr) {}\n};\n</code></pre>\n\n<p>The constructor takes const std::string&amp;.</p>\n\n<p>We could replace a constant reference with string_view:</p>\n\n<pre><code>MyStr(std::string_view strv) : m_str(strv) {}\n</code></pre>\n\n<p>Or pass a string by value and move from it:</p>\n\n<pre><code>MyStr(std::string str) : m_str(std::move(str)) {}\n</code></pre>\n\n<p>Which of the alternatives is preferred?</p>\n\n<p>3 cases:</p>\n\n<pre><code>MyStr mystro1{\"Case 1: From a string literal\"};\n\nstd::string str2 { \"Case 2: From l-value\"};\nMyStr mystro2 { str2 };\n\nstd::string str3 { \"Case 3: From r-value reference\"};\nMyStr mystro3 { std::move(str3) };\n</code></pre>\n"}, {"tags": ["c++", "windows", "visual-studio", "cng"], "comments": [{"owner": {"reputation": 861, "user_id": 743414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4865c7841b624ea4f967e6d1806bbbb0?s=128&d=identicon&r=PG", "display_name": "user743414", "link": "https://stackoverflow.com/users/743414/user743414"}, "edited": false, "score": 0, "creation_date": 1533738004, "post_id": 51748439, "comment_id": 90457776, "body": "Maybe <a href=\"https://stackoverflow.com/questions/35590105/authentication-with-bcrypt-hashed-password\" title=\"authentication with bcrypt hashed password\">stackoverflow.com/questions/35590105/&hellip;</a> helps you."}, {"owner": {"reputation": 31, "user_id": 10195659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fb260a6a884a477cfaa5386335d40e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhavok", "link": "https://stackoverflow.com/users/10195659/zhavok"}, "edited": false, "score": 0, "creation_date": 1533738536, "post_id": 51748439, "comment_id": 90458190, "body": "Thx, but no. I spent 5 days with google and forums before I asked here^^"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1533740886, "post_id": 51748439, "comment_id": 90459839, "body": "your code and your output don&#39;t match up at all...."}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 0, "creation_date": 1533741372, "post_id": 51748439, "comment_id": 90460145, "body": "You should probably add the code that <b>(a)</b> declares the variable you pass in to receive the salt; <b>(b)</b> the call to this function and <b>(c)</b> how you are printing the returned salt. If not already doing so, you should be printing the return value of this function. More importantly, unless I&#39;m reading it wrong, it looks like the above function will always have returned before it gets to <code>&#47;* Generate salt. *&#47;</code>..."}, {"owner": {"reputation": 31, "user_id": 10195659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fb260a6a884a477cfaa5386335d40e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhavok", "link": "https://stackoverflow.com/users/10195659/zhavok"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1533741895, "post_id": 51748439, "comment_id": 90460545, "body": "@UKMonkey My code is a part of the lib that i wrote above. But i can&#39;t generate a salt with lib on windows. Thats my problem^^"}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 0, "creation_date": 1533756045, "post_id": 51748439, "comment_id": 90468013, "body": "Assuming the <code>Crypt...</code> functions return true (non-zero) on success, I&#39;m pretty sure the <code>return 0</code>  shouldn&#39;t be there:  I&#39;m pretty sure it&#39;s causing the function to exit before ever generating the salt."}, {"owner": {"reputation": 31, "user_id": 10195659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fb260a6a884a477cfaa5386335d40e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhavok", "link": "https://stackoverflow.com/users/10195659/zhavok"}, "edited": false, "score": 0, "creation_date": 1533780322, "post_id": 51748439, "comment_id": 90475138, "body": "I deleted the return under if (CryptReleaseContext(hCryptProv, 0)) {. Now I get an error in bcrypt_hashpw function. So many problems... Maybe it&#39;s easier to use PBKDF2. OpenSSL is already included and could use this. What is your opinion?"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1566209386, "post_id": 51748439, "comment_id": 101571041, "body": "Windows does not have <code>&#47;dev&#47;urandom</code>; use <code>CryptGenRandom</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 1, "creation_date": 1533756270, "post_id": 51753468, "comment_id": 90468102, "body": "<b>If</b> they are null-terninated strings, and not just buffers, the correct change would almost certainly be to increase the buffer size available, not reduce the length of the buffer that you use."}, {"owner": {"reputation": 31, "user_id": 10195659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fb260a6a884a477cfaa5386335d40e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhavok", "link": "https://stackoverflow.com/users/10195659/zhavok"}, "edited": false, "score": 0, "creation_date": 1533756990, "post_id": 51753468, "comment_id": 90468397, "body": "I tried this now, but then it crashes (   assert(ret == 0);   )"}, {"owner": {"reputation": 70, "user_id": 2733837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68db816e58d0ff50f62f826d941699f?s=128&d=identicon&r=PG&f=1", "display_name": "Valeca", "link": "https://stackoverflow.com/users/2733837/valeca"}, "edited": false, "score": 0, "creation_date": 1533759680, "post_id": 51753468, "comment_id": 90469674, "body": "The function takes the length of the buffer. Decreasing or increasing should have same effect. From the code you posted it is not clear where it crashes. Do you have call stack for it?"}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 0, "creation_date": 1533828345, "post_id": 51753468, "comment_id": 90500284, "body": "&quot;<i>Decreasing or increasing should have same effect</i>&quot; except that I strongly suspect that the sizes are not arbitrary. Even if the <code>crypt_gensalt_rn()</code> routine can work with arbitrary size buffers, the system in which this is a part <i>probably</i> requires hashes of a certain size (e.g. 64/128/256 bits; not 56/120/244 bits)."}, {"owner": {"reputation": 70, "user_id": 2733837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68db816e58d0ff50f62f826d941699f?s=128&d=identicon&r=PG&f=1", "display_name": "Valeca", "link": "https://stackoverflow.com/users/2733837/valeca"}, "reply_to_user": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 0, "creation_date": 1533829880, "post_id": 51753468, "comment_id": 90501353, "body": "@TripeHound I agree, in general. But normally it should parse / verify that values are satisfied to required length."}, {"owner": {"reputation": 31, "user_id": 10195659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fb260a6a884a477cfaa5386335d40e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhavok", "link": "https://stackoverflow.com/users/10195659/zhavok"}, "edited": false, "score": 0, "creation_date": 1533938855, "post_id": 51753468, "comment_id": 90546727, "body": "Thx guys. After so many problem I decided to use PBKDF2. Should I post my PBKDF2 - snippet here as an answer?"}], "tags": [], "owner": {"reputation": 70, "user_id": 2733837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68db816e58d0ff50f62f826d941699f?s=128&d=identicon&r=PG&f=1", "display_name": "Valeca", "link": "https://stackoverflow.com/users/2733837/valeca"}, "is_accepted": false, "score": 0, "last_activity_date": 1566208200, "last_edit_date": 1566208200, "creation_date": 1533753127, "answer_id": 51753468, "question_id": 51748439, "link": "https://stackoverflow.com/questions/51748439/how-to-use-bcrypt-gensalt-with-dev-urandom-on-windows/51753468#51753468", "title": "How to use bcrypt_gensalt with /dev/urandom on Windows?", "body": "<p>In your call to:</p>\n\n<pre><code>aux = crypt_gensalt_rn(\"$2a$\", workf, input, RANDBYTES,\n                   salt, BCRYPT_HASHSIZE);\n</code></pre>\n\n<p>The values of <code>RANDBYTES</code> and <code>BCRYPT_HASHSIZE</code> need one more byte for terminated <code>\\0</code>.</p>\n\n<p>Have you tried that (using <code>RANDBYTES-1</code> and <code>BCRYPT_HASHSIZE-1</code>)?</p>\n"}], "owner": {"reputation": 31, "user_id": 10195659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fb260a6a884a477cfaa5386335d40e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhavok", "link": "https://stackoverflow.com/users/10195659/zhavok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 636, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1566209283, "creation_date": 1533736252, "last_edit_date": 1566209283, "question_id": 51748439, "link": "https://stackoverflow.com/questions/51748439/how-to-use-bcrypt-gensalt-with-dev-urandom-on-windows", "title": "How to use bcrypt_gensalt with /dev/urandom on Windows?", "body": "<p>I used this BCrypt lib to generate a hash with salt: <a href=\"https://github.com/rg3/libbcrypt\" rel=\"nofollow noreferrer\">https://github.com/rg3/libbcrypt</a></p>\n\n<p>The problem is in <code>bcrypt.c</code> (<code>int bcrypt_gensalt</code>). <code>open(\"/dev/urandom\", O_RDONLY)</code> does not work on Windows. I have tried the following:</p>\n\n<pre><code>int bcrypt_gensalt(int factor, char salt[BCRYPT_HASHSIZE]) {\n    int fd;\n    unsigned char input[RANDBYTES];\n    int workf;\n    char *aux;\n\n    HCRYPTPROV hCryptProv;\n\n    if (CryptAcquireContext(\n        &amp;hCryptProv,\n        NULL,\n        (LPCSTR)\"Microsoft Base Cryptographic Provider v1.0\",\n        PROV_RSA_FULL,\n        CRYPT_VERIFYCONTEXT)) {\n        if (CryptGenRandom(\n            hCryptProv,\n            RANDBYTES,\n            input)) {\n\n            if (CryptReleaseContext(hCryptProv, 0)) {\n                return 0;\n            }\n            else {\n                printf(\"Error during CryptReleaseContext.\\n\");\n            return 4;\n            }\n        }\n        else {\n            if (CryptReleaseContext(hCryptProv, 0)) {\n                printf(\"Error during CryptGenRandom.\\n\");\n                return 2;\n            }\n            else {\n                printf(\"Error during CryptReleaseContext.\\n\");\n                return 3;\n            }\n        }\n    }\n    else {\n        printf(\"Error during CryptAcquireContext!\\n\");\n        return 1;\n    }\n\n    /* Generate salt. */\n    workf = (factor &lt; 4 || factor &gt; 31)?12:factor;\n    aux = crypt_gensalt_rn(\"$2a$\", workf, input, RANDBYTES,\n                   salt, BCRYPT_HASHSIZE);\n    return (aux == NULL)?5:0;\n}\n</code></pre>\n\n<p>But the result is:</p>\n\n<pre><code>Generated salt:\nHashed password: *0\nTime taken: 0.000000 seconds\nFirst hash check: OK\nSecond hash check: OK\nFirst hash check with bcrypt_checkpw: OK\nTime taken: 0.060000 seconds\nSecond hash check with bcrypt_checkpw: OK\nTime taken: 0.060000 seconds\n</code></pre>\n\n<p>The salt will be not generated correctly.</p>\n"}, {"tags": ["c++", "matrix", "draw", "allegro", "allegro5"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1533736010, "post_id": 51748133, "comment_id": 90456413, "body": "what are &quot;some weird bugs&quot; ? please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and include the error messages in the question"}, {"owner": {"reputation": 25, "user_id": 8863328, "user_type": "registered", "profile_image": "https://graph.facebook.com/385472728540547/picture?type=large", "display_name": "Vid Osep", "link": "https://stackoverflow.com/users/8863328/vid-osep"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533737049, "post_id": 51748133, "comment_id": 90457112, "body": "Thank you for your feedback, I updated it and I tried to make it as good as possible."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1533737745, "post_id": 51748133, "comment_id": 90457591, "body": "You may want to use either a matrix of <code>bitset</code> or <code>uint8_t</code>.  With the memory of modern computers, there is no need to compact space.  Also, you&#39;ll waste a lot of run-time performing bit manipulation."}], "answers": [{"tags": [], "owner": {"reputation": 185, "user_id": 6226201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b1fe643279bcdb12775babdbfec6a8a?s=128&d=identicon&r=PG&f=1", "display_name": "Bailey Kocin", "link": "https://stackoverflow.com/users/6226201/bailey-kocin"}, "is_accepted": true, "score": 0, "last_activity_date": 1533737401, "creation_date": 1533737401, "answer_id": 51748796, "question_id": 51748133, "link": "https://stackoverflow.com/questions/51748133/how-to-draw-a-binary-matrix-to-the-display/51748796#51748796", "title": "How to draw a binary matrix to the display", "body": "<p>I could tell you that your matrix picture does not match the 2D array you pass into the function. The function takes an array of 10 red with 20 columns. Your picture is inverted therefore the way your screen is colored is inverted. If you want to draw what you have on the drawing just switch rows and columns so pass in an array of [20][10]</p>\n"}], "owner": {"reputation": 25, "user_id": 8863328, "user_type": "registered", "profile_image": "https://graph.facebook.com/385472728540547/picture?type=large", "display_name": "Vid Osep", "link": "https://stackoverflow.com/users/8863328/vid-osep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 0, "accepted_answer_id": 51748796, "answer_count": 1, "score": -1, "last_activity_date": 1533737401, "creation_date": 1533735397, "last_edit_date": 1533736692, "question_id": 51748133, "link": "https://stackoverflow.com/questions/51748133/how-to-draw-a-binary-matrix-to-the-display", "title": "How to draw a binary matrix to the display", "body": "<p>I'm recreating tetris in c++ for a starter project. I'm using allegro for user input and drawing to the display. Every action, move, rotation is inserted into a\n2x2 matrix. Now I got stuck at drawing the actual matrix to the screen.\nHere's my current code:</p>\n\n<pre><code>void drawGrid(int grid[10][20]) { // Draws the grid to the screen\n    for (int y = 0; y &lt; 20; y++) {\n        for (int x = 0; x &lt; 10; x++) {\n            if (grid[x][y] == 1) {\n                al_draw_filled_rectangle(x * 32 + 10, y * 32, x * 32 + 10 + 32, y * 32 + 32,\n                                     al_map_rgb(255, 255, 255)); // Draws a white square, 32x32\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>It displays the white squares rotated by 90 degrees and there are some random amounts of spaces in between parts of ones. For instance</p>\n\n<p>The grid I'm trying to print:</p>\n\n<pre><code>0011000000\n0001100000\n0000000000\n0000000000\n0000000000\n0000000000\n0000000000\n0000000000\n0000000000\n0000000000\n0000000000\n0000000000\n0000000000\n0000000000\n0000000000\n0000000000\n0000000000\n0000000000\n0000000000\n0000000000\n</code></pre>\n\n<p>The results I'm getting:<a href=\"https://i.stack.imgur.com/YyixI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YyixI.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "qt", "qml", "qt5"], "answers": [{"comments": [{"owner": {"reputation": 543, "user_id": 537130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o7LeJ.jpg?s=128&g=1", "display_name": "Alp Hanc\u0131o\u011flu", "link": "https://stackoverflow.com/users/537130/alp-hanc%c4%b1o%c4%9flu"}, "edited": false, "score": 0, "creation_date": 1533738139, "post_id": 51748351, "comment_id": 90457870, "body": "Thanks your answer is correct but I don&#39;t want to get actual qml objects. Are these objects actually javascript objects in the view? If I change their properties( defined with Q_PROPERTY) in c++ do values of objects in javascript also change?"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 543, "user_id": 537130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o7LeJ.jpg?s=128&g=1", "display_name": "Alp Hanc\u0131o\u011flu", "link": "https://stackoverflow.com/users/537130/alp-hanc%c4%b1o%c4%9flu"}, "edited": false, "score": 1, "creation_date": 1533738494, "post_id": 51748351, "comment_id": 90458166, "body": "@AlpHanc\u0131o\u011flu Obvious, if they are the same of the QML (with my code does that) if you change the property in C ++ they will be reflected in QML. In your initial code you were creating other items. I recommend you not to think that QML is js. QML uses an engine similar to js but they are not necessarily the same."}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 0, "last_activity_date": 1533735989, "creation_date": 1533735989, "answer_id": 51748351, "question_id": 51747950, "link": "https://stackoverflow.com/questions/51747950/cant-send-array-of-dynamically-created-objects-from-qml-to-c-as-method-parame/51748351#51748351", "title": "Can&#39;t send array of dynamically created objects from qml to c++ as method parameter", "body": "<p>I see you are printing:</p>\n\n<pre><code>std::cout &lt;&lt; \"size \" + list.size() &lt;&lt; std::endl;\n</code></pre>\n\n<p>but instead you must separate because probably it is considering size() as char.</p>\n\n<pre><code>std::cout &lt;&lt; \"size \"&lt;&lt; list.size() &lt;&lt; std::endl;\n</code></pre>\n\n<p>On the other hand <code>QObject</code>s are stored as a pointer, ie: <code>CustomClass *</code>, and also you are creating other <code>CustomClass *</code> not those that are in QML (I assume you want to have the same items in the view)</p>\n\n<p>The solution is the next:</p>\n\n<pre><code>Q_INVOKABLE void sendItems(const QVariantList&amp; list) {\n    std::cout &lt;&lt; \"size \"&lt;&lt; list.size() &lt;&lt; std::endl;\n    list_.clear();\n    for(const QVariant&amp; variant : list) {\n        if(variant.canConvert&lt;CustomClass *&gt;()) {\n            CustomClass* custom = variant.value&lt;CustomClass*&gt;();\n            list_.append(custom);\n            std::cout &lt;&lt; \"converted \" &lt;&lt; custom-&gt;name().toStdString() &lt;&lt; std::endl;\n        }\n    }\n}\n</code></pre>\n\n<p>You can find the test project in the following <a href=\"https://github.com/eyllanesc/stackoverflow/tree/master/51747950\" rel=\"nofollow noreferrer\">link</a></p>\n"}], "owner": {"reputation": 543, "user_id": 537130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o7LeJ.jpg?s=128&g=1", "display_name": "Alp Hanc\u0131o\u011flu", "link": "https://stackoverflow.com/users/537130/alp-hanc%c4%b1o%c4%9flu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 51748351, "answer_count": 1, "score": 0, "last_activity_date": 1533750639, "creation_date": 1533734861, "last_edit_date": 1533750639, "question_id": 51747950, "link": "https://stackoverflow.com/questions/51747950/cant-send-array-of-dynamically-created-objects-from-qml-to-c-as-method-parame", "title": "Can&#39;t send array of dynamically created objects from qml to c++ as method parameter", "body": "<p>I am creating registered qml objects and storing them in javascript array. I want to send them as <code>QVariantList</code> method parameter to c++. Below is the code. However first cout of <code>Backend::sendItems</code> method doesn't print size. Weirdly it just prints \"ze\" and nothing else like thread is interrupted halfway. What am I doing wrong? You can also suggest another way of achieving what I want.</p>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include &lt;QGuiApplication&gt;\n#include &lt;QQmlApplicationEngine&gt;\n#include \"backend.h\"\n#include \"custom_class.h\"\n\nvoid register_Qml_types() {\n  qmlRegisterType&lt;Backend&gt;(\"customApi\", 1, 0, \"Backend\");\n  qmlRegisterType&lt;CustomClass&gt;(\"customApi\", 1, 0, \"CustomClass\");\n}\n\nint main(int argc, char **argv)\n{\n  QGuiApplication app(argc, argv);\n\n  register_Qml_types();\n  QQmlApplicationEngine engine;\n  engine.load(QUrl(\"qrc:/main.qml\"));\n\n  return app.exec();\n}\n</code></pre>\n\n<p><strong>custom_class.h</strong></p>\n\n<pre><code>#ifndef CUSTOM_H\n#define CUSTOM_H\n\n#include &lt;QString&gt;\n#include &lt;QObject&gt;\n\nclass CustomClass : public QObject\n{\n  Q_OBJECT\n  Q_PROPERTY(QString name READ name WRITE setName)\n\npublic:\n  CustomClass(QObject* parent = 0)\n    : QObject(parent)\n  {}\n\n  CustomClass(QString name) {\n    name_ = name;\n  }\n\n  CustomClass(const CustomClass&amp; item) {\n    name_ = item.name_;\n  }\n\n  QString name() const {\n    return name_;\n  }\n\n  void setName(QString name) {\n    name_ = name;\n  }\n\nprivate:\n  QString name_;\n};\n\nQ_DECLARE_METATYPE(CustomClass)\n\n#endif\n</code></pre>\n\n<p><strong>backend.h</strong></p>\n\n<pre><code>#ifndef BACKEND_H\n#define BACKEND_H\n\n#include &lt;iostream&gt;\n#include &lt;typeinfo&gt;\n#include &lt;QObject&gt;\n#include &lt;QList&gt;\n#include &lt;QVariant&gt;\n#include \"custom_class.h\"\n\nclass Backend : public QObject\n{\n  Q_OBJECT\n\npublic:\n  Backend(QObject* parent = nullptr)\n    : QObject(parent)\n  {}\n\n  Q_INVOKABLE void sendItems(const QVariantList&amp; list) {\n    std::cout &lt;&lt; \"size \" + list.size() &lt;&lt; std::endl;\n    list_.clear();\n    for(const QVariant&amp; variant : list) {\n      if(variant.canConvert&lt;CustomClass&gt;()) {\n        CustomClass* custom = new CustomClass(variant.value&lt;CustomClass&gt;());\n        list_.append(custom);\n        std::cout &lt;&lt; \"converted\" &lt;&lt; std::endl;\n      }\n    }\n\n  }\n\nprivate:\n    QList&lt;CustomClass*&gt; list_;\n};\n\n#endif\n</code></pre>\n\n<p><strong>main.qml</strong></p>\n\n<pre><code>import QtQuick.Window 2.11\nimport QtQuick.Controls 1.4\nimport QtQuick 2.11\nimport customApi 1.0\n\nWindow {\n  id: root\n  visible: true\n  width: 500\n  height: 500\n\n  property var items: []\n\n  Backend {\n    id: backend\n  }\n\n  Row {\n    Button {\n      text: \"button1\"\n      onClicked: {\n        var item1 = Qt.createQmlObject(\"import customApi 1.0; CustomClass { name: \\\"first-name\\\" }\", root);\n        var item2 = Qt.createQmlObject(\"import customApi 1.0; CustomClass { name: \\\"second-name\\\" }\", root);\n        items.push(item1);\n        items.push(item2);\n      }\n    }\n    Button {\n      text: \"button2\"\n      onClicked: {\n        backend.sendItems(items);\n      }\n    }\n  }\n\n}\n</code></pre>\n"}, {"tags": ["c++", "stl"], "comments": [{"owner": {"reputation": 1830, "user_id": 1927794, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b7b26bda58eac7f333cc428421a711cd?s=128&d=identicon&r=PG", "display_name": "Arkady", "link": "https://stackoverflow.com/users/1927794/arkady"}, "edited": false, "score": 0, "creation_date": 1533736107, "post_id": 51747865, "comment_id": 90456474, "body": "I think it&#39;s useless. Idea is to implement some memory management behind the scene, but usually if you make a copy of vector, you will change it. And thus anyway you need to copy it. And if you don&#39;t plan to change it, then you use const pointers or &quot;&amp;&quot; without risk. Of you plan to do it from different threads, then copy usually is much better to avoid any race. So in the end the use case for such feature is quite rare, but it will add complexity and additional layer in the code."}, {"owner": {"reputation": 605, "user_id": 7128840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdNYI.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/7128840/adam"}, "reply_to_user": {"reputation": 1830, "user_id": 1927794, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b7b26bda58eac7f333cc428421a711cd?s=128&d=identicon&r=PG", "display_name": "Arkady", "link": "https://stackoverflow.com/users/1927794/arkady"}, "edited": false, "score": 1, "creation_date": 1533736773, "post_id": 51747865, "comment_id": 90456926, "body": "@Arkady I respectfully disagree. There is a well defined use case for _view objects. They don&#39;t work in every scenario, as you pointed out, but that does not change the fact that in certain situations they can provide great improvements."}], "answers": [{"tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": true, "score": 11, "last_activity_date": 1582664667, "last_edit_date": 1582664667, "creation_date": 1533734850, "answer_id": 51747942, "question_id": 51747865, "link": "https://stackoverflow.com/questions/51747865/stdstring-view-for-stl-containers/51747942#51747942", "title": "std::string_view for STL containers", "body": "<p>There is a proposal for <code>span</code>, which is a view over a contiguous range of objects: <a href=\"http://wg21.link/p0122\" rel=\"nofollow noreferrer\">http://wg21.link/p0122</a>. See also: <a href=\"https://stackoverflow.com/q/45723819/94687\">What is a \u201cspan\u201d and when should I use one?</a>.</p>\n\n<p>The GSL library also provides <a href=\"https://github.com/Microsoft/GSL/blob/master/include/gsl/span\" rel=\"nofollow noreferrer\"><code>gsl::span</code></a>.</p>\n\n<hr>\n\n<p>This might be stretching it, but I also proposed <code>function_ref</code>, which is basically a view over a <code>Callable</code>:  <a href=\"http://wg21.link/p0792\" rel=\"nofollow noreferrer\">http://wg21.link/p0792</a></p>\n"}], "owner": {"reputation": 605, "user_id": 7128840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdNYI.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/7128840/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 2, "accepted_answer_id": 51747942, "answer_count": 1, "score": 6, "last_activity_date": 1582664667, "creation_date": 1533734619, "question_id": 51747865, "link": "https://stackoverflow.com/questions/51747865/stdstring-view-for-stl-containers", "title": "std::string_view for STL containers", "body": "<p>Here is a great explanation of what a <a href=\"https://stackoverflow.com/questions/20803826/what-is-string-view\">string_view</a> object is.</p>\n\n<p>Are there '_view' objects for any of the STL containers besides std::string?</p>\n\n<p>Seems to me that it is an extremely useful thing to have. Imagine a <code>std::vector_view</code> class that simply stores a <code>start</code> iterator and a <code>length</code> field. Not actually owning the underlying data allows for awesome efficiency improvements. </p>\n"}, {"tags": ["c++", "debugging", "dll", "windows-10", "reverse-engineering"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1533734260, "post_id": 51747719, "comment_id": 90455222, "body": "It&#39;s undefined behavior to use a dll from vs 2008 with your compiler. That is unless the dll isolates the heap an does not use the standard library in it&#39;s interface."}, {"owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 0, "creation_date": 1533734278, "post_id": 51747719, "comment_id": 90455236, "body": "What do you mean by &quot;after the upgrade to Win10?&quot; Did you just copy / paste the compiled binaries to Win10, or did you compile your application with a different version of VS?"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1533734321, "post_id": 51747719, "comment_id": 90455259, "body": "MS does not support DLLs/EXEs from different version of VS.  Unless the interface is pure <code>C</code> and memory management is confined to each DLL"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1533734532, "post_id": 51747719, "comment_id": 90455394, "body": "It may have worked with a different OS, UB unfortunately sometimes appears to work."}, {"owner": {"reputation": 2069, "user_id": 104897, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/I78Xs.jpg?s=128&g=1", "display_name": "rnd_nr_gen", "link": "https://stackoverflow.com/users/104897/rnd-nr-gen"}, "edited": false, "score": 0, "creation_date": 1533734626, "post_id": 51747719, "comment_id": 90455451, "body": "I update the original post"}, {"owner": {"reputation": 2069, "user_id": 104897, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/I78Xs.jpg?s=128&g=1", "display_name": "rnd_nr_gen", "link": "https://stackoverflow.com/users/104897/rnd-nr-gen"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1533734920, "post_id": 51747719, "comment_id": 90455656, "body": "@drescherjm thx for advice...  I just want to collect possible cause and give feedback to unhelpful 3rd party...  heap isolation and avoid std lib are goold points."}], "owner": {"reputation": 2069, "user_id": 104897, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/I78Xs.jpg?s=128&g=1", "display_name": "rnd_nr_gen", "link": "https://stackoverflow.com/users/104897/rnd-nr-gen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 357, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1581493102, "creation_date": 1533734096, "last_edit_date": 1533734606, "question_id": 51747719, "link": "https://stackoverflow.com/questions/51747719/debug-3rd-party-dll-causing-access-violation-after-upgrading-to-windows-10", "title": "Debug 3rd party DLL causing access violation after upgrading to Windows 10", "body": "<blockquote>\n  <p>I know that mixing DLLs from different MSVC is bad and should be\n  avoided...</p>\n</blockquote>\n\n<p>I have a 3rd party DLL (XXX.dll, XXX.lib, XXX.h) which is implicitly linked in my application.</p>\n\n<p>The original setup is:</p>\n\n<ul>\n<li>My application (built with VS <strong>2015</strong>)</li>\n<li>XXX.dll (built with VS <strong>2008</strong>)</li>\n<li><strong>x64</strong></li>\n<li>Windows 7</li>\n</ul>\n\n<p>And it worked!</p>\n\n<p>However moving to <strong>Windows 10</strong>:\n(My application is re-built with VS 2015 and still with XXX.dll)</p>\n\n<p>Now the application keeps crash with access violation\n<code>Exception thrown at 0x000001EF05A2BBB9 (XXX.dll) in Application.exe: 0xC0000005: Access violation reading location 0x00000000074A3A68.</code></p>\n\n<p>Here is the call stack:</p>\n\n<pre><code>XXX.dll!000002a7eeb6bbb9()   \nuser32.dll!UserCallWinProcCheckWow()     \nuser32.dll!DispatchMessageWorker()   \nmfc90u.dll!AfxInternalPumpMessage()  \nmfc90u.dll!CWinThread::Run()     \nmfc90u.dll!_AfxThreadEntry(pParam=0x000000d5452fd890)   \nmsvcr90.dll!_callthreadstartex()     \nmsvcr90.dll!_threadstartex(ptd=0x0000000000000000)   \nkernel32.dll!BaseThreadInitThunk()   \nntdll.dll!RtlUserThreadStart()  \n</code></pre>\n\n<p>As usual, \"3rd party\" support is very unhelpful...</p>\n\n<p>What could cause this problem suddenly on Win 10?\nWhat kind of mistake could XXX.dll!000002a7eeb6bbb9() make to mess up memory?</p>\n\n<p>I was thinking about the problem mixing different CRT and it is the orignal question: \n<a href=\"https://stackoverflow.com/questions/51741014/different-behavior-when-mixing-dlls-from-different-msvc\">different behavior when mixing DLLs from different MSVC</a></p>\n"}, {"tags": ["c++", "gcc", "c-preprocessor"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1533733929, "post_id": 51747622, "comment_id": 90454986, "body": "What is the error?"}, {"owner": {"reputation": 73, "user_id": 6840601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41c5df61a01c08f7a4cca5e6e4bf3058?s=128&d=identicon&r=PG&f=1", "display_name": "addy", "link": "https://stackoverflow.com/users/6840601/addy"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1533734819, "post_id": 51747622, "comment_id": 90455583, "body": "@NathanOliver       error: expected &#39;,&#39; or &#39;;&#39; before &#39;<b>PRETTY_FUNCTION</b>&#39;      const char* s2= &quot;Prefix&quot; <b>PRETTY_FUNCTION</b>;                               ^~~~~~~~~~~~~~~~~~~"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1533735058, "post_id": 51747622, "comment_id": 90455748, "body": "@addy: I&#39;ve pasted your comment into the question, but I had to guess at the formatting. Please check. (And please do this yourself when asking your next question)"}, {"owner": {"reputation": 73, "user_id": 6840601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41c5df61a01c08f7a4cca5e6e4bf3058?s=128&d=identicon&r=PG&f=1", "display_name": "addy", "link": "https://stackoverflow.com/users/6840601/addy"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1533795668, "post_id": 51747622, "comment_id": 90479154, "body": "@MSalters Thank you"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 6840601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41c5df61a01c08f7a4cca5e6e4bf3058?s=128&d=identicon&r=PG&f=1", "display_name": "addy", "link": "https://stackoverflow.com/users/6840601/addy"}, "edited": false, "score": 1, "creation_date": 1533735368, "post_id": 51747692, "comment_id": 90455974, "body": "Thank you @GPhilo"}], "tags": [], "owner": {"reputation": 14960, "user_id": 3214872, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/NJBvG.jpg?s=128&g=1", "display_name": "GPhilo", "link": "https://stackoverflow.com/users/3214872/gphilo"}, "is_accepted": false, "score": 6, "last_activity_date": 1533734484, "last_edit_date": 1533734484, "creation_date": 1533734021, "answer_id": 51747692, "question_id": 51747622, "link": "https://stackoverflow.com/questions/51747622/c-append-pretty-function-to-c-string/51747692#51747692", "title": "C++: append __PRETTY_FUNCTION__ to c string", "body": "<p>From the GCC <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Function-Names.html\" rel=\"nofollow noreferrer\">documentation for <code>__PRETTY_FUNCTION__</code></a>:</p>\n\n<blockquote>\n  <p>[<code>__func__</code> and <code>__PRETTY_FUNCTION__</code>] are variables, not preprocessor macros, and may not be used to initialize char arrays or be concatenated with string literals.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 6840601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41c5df61a01c08f7a4cca5e6e4bf3058?s=128&d=identicon&r=PG&f=1", "display_name": "addy", "link": "https://stackoverflow.com/users/6840601/addy"}, "edited": false, "score": 0, "creation_date": 1533735324, "post_id": 51747764, "comment_id": 90455949, "body": "Thanks @Andrew Henle"}], "tags": [], "owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 2, "last_activity_date": 1533747490, "last_edit_date": 1533747490, "creation_date": 1533734266, "answer_id": 51747764, "question_id": 51747622, "link": "https://stackoverflow.com/questions/51747622/c-append-pretty-function-to-c-string/51747764#51747764", "title": "C++: append __PRETTY_FUNCTION__ to c string", "body": "<p>Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.10.8\" rel=\"nofollow noreferrer\"><strong>6.10.8.1 Mandatory macros</strong></a> of the C standard, <code>__FILE__</code> is a string literal:</p>\n\n<blockquote>\n  <p><code>__FILE__</code>\n      The presumed name of the current source file (a character string literal).</p>\n</blockquote>\n\n<p>Similar language can be found in paragraph 1 of <strong>16.8 Predefined macro names</strong> of <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4296.pdf\" rel=\"nofollow noreferrer\">the C++ standard</a>.</p>\n\n<p>whereas, per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.4.2.2p1\" rel=\"nofollow noreferrer\"><strong>6.4.2.2 Predefined identifiers</strong>, paragraph 1 of the C standard</a> <code>__func__</code> is an identifier:</p>\n\n<blockquote>\n  <p>The identifier <code>__func__</code> shall be implicitly declared by the translator\n  as if, immediately following the opening brace of each function\n  definition, the declaration</p>\n\n<pre><code>      static const char __func__[] = \"function-name\";\n</code></pre>\n</blockquote>\n\n<p>Paragraph 8 of <strong>8.4.1 General</strong> of <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4296.pdf\" rel=\"nofollow noreferrer\">the C++ standard states</a>:</p>\n\n<blockquote>\n  <p>The function-local predefined variable <code>__func__</code> is defined as if a\n  definition of the form</p>\n\n<pre><code>    static const char __func__[] = \"function-name\";\n</code></pre>\n  \n  <p>had been provided, where\n  <em>function-name</em>\n  is an implementation-defined string. It is unspecified whether such\n  a variable has an address distinct from that of any other object in the program.</p>\n</blockquote>\n\n<p>Assuming the GCC extension <code>__PRETTY_FUNCTION__</code> is implemented as the standard <code>__func__</code>, as an actual identifier it can't be concatenated with a string literal.</p>\n"}], "owner": {"reputation": 73, "user_id": 6840601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41c5df61a01c08f7a4cca5e6e4bf3058?s=128&d=identicon&r=PG&f=1", "display_name": "addy", "link": "https://stackoverflow.com/users/6840601/addy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 1, "accepted_answer_id": 51747764, "answer_count": 2, "score": 2, "last_activity_date": 1533747490, "creation_date": 1533733792, "last_edit_date": 1533734977, "question_id": 51747622, "link": "https://stackoverflow.com/questions/51747622/c-append-pretty-function-to-c-string", "title": "C++: append __PRETTY_FUNCTION__ to c string", "body": "<p>I am trying to append <code>__PRETTY_FUNCTION__</code> to the c-string prefix at compile time. But it fails to compile. Whereas if I do it with <code>__FILE__</code> then it doesn't fail.</p>\n\n<pre><code>const char* s1= \"Prefix\" __FILE__;            // works\nconst char* s2= \"Prefix\" __PRETTY_FUNCTION__; // compilation error\n\nerror: expected ',' or ';' before '__PRETTY_FUNCTION__'\nconst char* s2 = \"Prefix\" __PRETTY_FUNCTION__;\n                          ^~~~~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>I am using gcc and clang.\nAm I missing something ?</p>\n"}, {"tags": ["c++", "vtk"], "comments": [{"owner": {"reputation": 2364, "user_id": 8349252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/224zf.png?s=128&g=1", "display_name": "Kaldrr", "link": "https://stackoverflow.com/users/8349252/kaldrr"}, "edited": false, "score": 0, "creation_date": 1533733712, "post_id": 51747494, "comment_id": 90454845, "body": "This isn&#39;t a 2d array, it&#39;s 1d array with 20*30 elements."}, {"owner": {"reputation": 1292, "user_id": 8044236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b25c9e70d1b4bb2bde0254c9c82fc75e?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/8044236/user"}, "reply_to_user": {"reputation": 2364, "user_id": 8349252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/224zf.png?s=128&g=1", "display_name": "Kaldrr", "link": "https://stackoverflow.com/users/8349252/kaldrr"}, "edited": false, "score": 0, "creation_date": 1533733963, "post_id": 51747494, "comment_id": 90455010, "body": "@Kaldrr I mean I want to draw 2d rectangle on the screen and map values in this array to some colors."}], "answers": [{"comments": [{"owner": {"reputation": 1292, "user_id": 8044236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b25c9e70d1b4bb2bde0254c9c82fc75e?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/8044236/user"}, "edited": false, "score": 0, "creation_date": 1533830070, "post_id": 51754466, "comment_id": 90501465, "body": "Thank you! The case with vtkPlaneSource is exactly what I am looking for."}], "tags": [], "owner": {"reputation": 4661, "user_id": 3388962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6b4104f3002cae8e8aa88e8c34780e5?s=128&d=identicon&r=PG", "display_name": "normanius", "link": "https://stackoverflow.com/users/3388962/normanius"}, "is_accepted": true, "score": 3, "last_activity_date": 1533822530, "last_edit_date": 1533822530, "creation_date": 1533757285, "answer_id": 51754466, "question_id": 51747494, "link": "https://stackoverflow.com/questions/51747494/how-to-visualize-2d-array-of-doubles-in-vtk/51754466#51754466", "title": "How to visualize 2d array of doubles in vtk?", "body": "<p>What you probably want to do is to assign scalars to points or cells of a surface or volume mesh. VTK then can take care of the visualization. This is demonstrated in the following example: <a href=\"https://lorensen.github.io/VTKExamples/site/Cxx/Visualization/ScalarBarActor/\" rel=\"nofollow noreferrer\">ScalarBarActor</a>. For the basic usage, follow the <a href=\"https://lorensen.github.io/VTKExamples/site/Cxx/VTKConcepts/Scalars/\" rel=\"nofollow noreferrer\">Scalars</a> example. </p>\n\n<p>However, you need to provide the suitable mesh yourself to which you want to map the values. From your question, it is not entirely clear what you mean with \"how to visualize a 2d array\" of values. If you want to assign scalar values in a planar 20x30 grid, you need to first create a surface object (of type <a href=\"https://www.vtk.org/doc/nightly/html/classvtkPolyData.html\" rel=\"nofollow noreferrer\"><code>vtkPolyData</code></a>) with triangular or quadrangular cells, and then assign the values to the points of the mesh using <code>surface-&gt;GetPointData()-&gt;SetScalars()</code>, as demonstrated in the above examples.</p>\n\n<p>Convenient in this case would be the <a href=\"https://www.vtk.org/doc/nightly/html/classvtkPlaneSource.html#details\" rel=\"nofollow noreferrer\"><code>vtkPlaneSource</code></a>, look <a href=\"https://lorensen.github.io/VTKExamples/site/Cxx/GeometricObjects/Plane/\" rel=\"nofollow noreferrer\">here</a> for the corresponding example. The number of grid points you can set by using <code>SetXResolution()</code> or <code>SetYResolution()</code> respectively. (In case this is not clear: <code>vtkPlaneSource</code> inherits <a href=\"https://www.vtk.org/doc/nightly/html/classvtkPolyDataAlgorithm.html\" rel=\"nofollow noreferrer\"><code>vtkPolyDataAlgorithm</code></a>, to access the underlying <code>vtkPolyData</code> object, use the method <code>GetOutput()</code>)</p>\n\n<hr>\n\n<p><strong>Update</strong>: I added sample code that demonstrates the procedure - in python, for better readability.</p>\n\n<pre><code># This code has been written by normanius under the CC BY-SA 4.0 license.\n# License:    https://creativecommons.org/licenses/by-sa/4.0/\n# Author:     normanius: https://stackoverflow.com/users/3388962/normanius\n# Date:       August 2018\n# Reference:  https://stackoverflow.com/a/51754466/3388962\n\nimport vtk\nimport numpy as np\n\n###########################################################\n# CREATE ARRAY VALUES\n###########################################################\n# Just create some fancy looking values for z.\nn = 100\nm = 50\nxmin = -1; xmax = 1\nymin = -1; ymax = 1\nx = np.linspace(xmin, xmax, n)\ny = np.linspace(ymin, ymax, m)\nx, y = np.meshgrid(x, y)\nx, y = x.flatten(), y.flatten()\nz = (x+y)*np.exp(-3.0*(x**2+y**2))\n\n###########################################################\n# CREATE PLANE\n###########################################################\n# Create a planar mesh of quadriliterals with nxm points.\n# (SetOrigin and SetPointX only required if the extent\n# of the plane should be the same. For the mapping\n# of the scalar values, this is not required.)\nplane = vtk.vtkPlaneSource()\nplane.SetResolution(n-1,m-1)\nplane.SetOrigin([xmin,ymin,0])  # Lower left corner\nplane.SetPoint1([xmax,ymin,0])\nplane.SetPoint2([xmin,ymax,0])\nplane.Update()\n\n# Map the values to the planar mesh.\n# Assumption: same index i for scalars z[i] and mesh points\nnPoints = plane.GetOutput().GetNumberOfPoints()\nassert(nPoints == len(z))\n# VTK has its own array format. Convert the input\n# array (z) to a vtkFloatArray.\nscalars = vtk.vtkFloatArray()\nscalars.SetNumberOfValues(nPoints)\nfor i in range(nPoints):\n    scalars.SetValue(i, z[i])\n#\u00a0Assign the scalar array.\nplane.GetOutput().GetPointData().SetScalars(scalars)\n\n###########################################################\n# WRITE DATA\n###########################################################\nwriter = vtk.vtkXMLPolyDataWriter()\nwriter.SetFileName('output.vtp')\nwriter.SetInputConnection(plane.GetOutputPort())\nwriter.Write() # =&gt; Use for example ParaView to see scalars\n\n###########################################################\n# VISUALIZATION\n###########################################################\n# This is a bit annoying: ensure a proper color-lookup.\ncolorSeries = vtk.vtkColorSeries()\ncolorSeries.SetColorScheme(vtk.vtkColorSeries.BREWER_DIVERGING_SPECTRAL_10)\nlut = vtk.vtkColorTransferFunction()\nlut.SetColorSpaceToHSV()\nnColors = colorSeries.GetNumberOfColors()\nzMin = np.min(z)\nzMax = np.max(z)\nfor i in range(0, nColors):\n    color = colorSeries.GetColor(i)\n    color = [c/255.0 for c in color]\n    t = zMin + float(zMax - zMin)/(nColors - 1) * i\n    lut.AddRGBPoint(t, color[0], color[1], color[2])\n\n# Mapper.\nmapper = vtk.vtkPolyDataMapper()\nmapper.SetInputConnection(plane.GetOutputPort())\nmapper.ScalarVisibilityOn()\nmapper.SetScalarModeToUsePointData()\nmapper.SetLookupTable(lut)\nmapper.SetColorModeToMapScalars()\n# Actor.\nactor = vtk.vtkActor()\nactor.SetMapper(mapper)\n# Renderer.\nrenderer = vtk.vtkRenderer()\nrenderer.SetBackground([0.5]*3)\n# Render window and interactor.\nrenderWindow = vtk.vtkRenderWindow()\nrenderWindow.SetWindowName('Demo')\nrenderWindow.AddRenderer(renderer)\nrenderer.AddActor(actor)\ninteractor = vtk.vtkRenderWindowInteractor()\ninteractor.SetRenderWindow(renderWindow)\nrenderWindow.Render()\ninteractor.Start()\n</code></pre>\n\n<p>The result will look similar to this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8UJhf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8UJhf.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1292, "user_id": 8044236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b25c9e70d1b4bb2bde0254c9c82fc75e?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/8044236/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 786, "favorite_count": 0, "accepted_answer_id": 51754466, "answer_count": 1, "score": 0, "last_activity_date": 1533822530, "creation_date": 1533733380, "question_id": 51747494, "link": "https://stackoverflow.com/questions/51747494/how-to-visualize-2d-array-of-doubles-in-vtk", "title": "How to visualize 2d array of doubles in vtk?", "body": "<p>I have 2d array (of size 20x30) of doubles:</p>\n\n<pre><code>double a[20*30];\n</code></pre>\n\n<p>How to visualize it using VTK? It is extremely difficult to find proper documentation. The closest example which I found is <a href=\"https://lorensen.github.io/VTKExamples/site/Cxx/ImageData/ImageIteratorDemo/\" rel=\"nofollow noreferrer\">this</a>, however it uses as input 3 unsigned chars which represents color. As I understand I should use <a href=\"https://www.vtk.org/doc/nightly/html/classvtkScalarsToColors.html\" rel=\"nofollow noreferrer\">vtkScalarsToColors</a> class to somehow map scalars to colors, but I can't figure out how to put everything into single piece of code.</p>\n"}, {"tags": ["c++", "c", "sockets", "reverse-proxy", "epoll"], "answers": [{"tags": [], "owner": {"reputation": 777, "user_id": 2512648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c04945ef108aab5b093293dfe26584d?s=128&d=identicon&r=PG", "display_name": "Alexandre Pereira Nunes", "link": "https://stackoverflow.com/users/2512648/alexandre-pereira-nunes"}, "is_accepted": false, "score": 0, "last_activity_date": 1533733866, "creation_date": 1533733866, "answer_id": 51747642, "question_id": 51747311, "link": "https://stackoverflow.com/questions/51747311/epoll-reverse-proxy-stuck-while-writing-client/51747642#51747642", "title": "Epoll reverse proxy stuck while writing client", "body": "<p>Assuming your headerParse() method doesn't change buffer in a size-extending way (you'd need to update readsize, at least, not to mention the buffer full scenario), it seems like your write() path is broken.</p>\n\n<p>if the socket you're writing to is also in nonblocking mode, it's perfectly legal for write() to return -1 (and set errno to EGAIN or EWOULDBLOCK or whatever your platform has) before you wrote all data. \nIn that case, you must store the remaining data (the remainder of buffer minus what was written if one or more calls to write() succeeded), program epoll to notify the clientHandler->getFd() descriptor for writeability, if not already, and when you get subsequent \"write ready\" event, you write the data you stored. On this case, the write() can again be unable to flush all your data, so you must cycle until all data is sent.</p>\n"}], "owner": {"reputation": 1, "user_id": 10196413, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ok3EBN8YfAY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rxJGgwSsol3od9fy5DZzQmpfyx0g/mo/photo.jpg?sz=128", "display_name": "Mustafa &#199;al\u0131\u015f", "link": "https://stackoverflow.com/users/10196413/mustafa-%c3%87al%c4%b1%c5%9f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533733982, "creation_date": 1533732874, "last_edit_date": 1533733982, "question_id": 51747311, "link": "https://stackoverflow.com/questions/51747311/epoll-reverse-proxy-stuck-while-writing-client", "title": "Epoll reverse proxy stuck while writing client", "body": "<p>I am trying to write reverse proxy with nonblocking socket and epoll. That seems ok at first, but when I tried to open a big jpg file, I got stuck. \nWhen I try to write into client sometimes It may not writable and how can I handle proper way.</p>\n\n<p>Additional Notes:</p>\n\n<pre><code>this-&gt;getFd() = ProxyFd\nthis-&gt;clientHandler-&gt;getFd = clientFd\n</code></pre>\n\n<p>I am using <code>EPOLLET</code> flag both proxy and client</p>\n\n<pre><code>   if( (flag &amp; EPOLLIN) ){\n        char buffer[1025] = {'\\0'};\n        int readSize;\n        while( (readSize = read(this-&gt;getFd(),buffer,1024)) &gt; 0){\n            this-&gt;headerParse(buffer);\n            this-&gt;readSize += readSize;\n            int check = 0;\n            do{\n                check = write(this-&gt;clientHandler-&gt;getFd(),buffer,readSize);\n            }while(check &lt; 0);\n\n        }\n        if(this-&gt;headerEnd == 1 &amp;&amp; this-&gt;readSize &gt;= this-&gt;headerLenght  ){\n            close(this-&gt;clientHandler-&gt;getFd());\n            close(this-&gt;getFd());\n            delete this-&gt;clientHandler;\n            delete this;\n        } \n    }\n</code></pre>\n\n<p>Thanks for taking time to read.</p>\n"}, {"tags": ["c++", "file", "double", "precision", "fwrite"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1533732831, "post_id": 51747245, "comment_id": 90454208, "body": "Just replace <code>cout</code> in the dupe target with <code>name_of_fle_stream</code> and you&#39;re all set."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1533732844, "post_id": 51747245, "comment_id": 90454218, "body": "&quot;What should I use for writing and reading?&quot; the same size of variable for each I&#39;d have thought would be a good start"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1533745388, "post_id": 51747245, "comment_id": 90462615, "body": "What is the other program? Which programming language is it written? What is wrong with simply writing float/double as byte buffers? If the other program can interpret it, then that&#39;s the solution."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1533745914, "post_id": 51747245, "comment_id": 90462884, "body": "Another possibility is to use <code>printf(&quot;%a&quot;, num);</code> (maybe there is something similar in iostream as well)."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1533779592, "post_id": 51747245, "comment_id": 90474992, "body": "@NathanOliver - Please see edit. I guess that shows I&#39;m not all set."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1533779728, "post_id": 51747245, "comment_id": 90475015, "body": "@UKMonkey - That is what I think it should be done, and I guess it should be simple. But googling variations of the title of the OP barely brought links actually pointing at the topic, so I though there would be more to it. In the meantime, I was working on this."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1533779839, "post_id": 51747245, "comment_id": 90475032, "body": "@geza - What is the other program? Another program (I wouldn&#39;t know how else to answer this). Which programming language is it written? C++. What is wrong with simply writing float/double as byte buffers? See my answer to comment by UKMonkey."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1533780064, "post_id": 51747245, "comment_id": 90475085, "body": "@geza - <code>printf(&quot;%a&quot;, num)</code>-style is what I think should work. Definitely not the proposed dupe target."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1533794506, "post_id": 51747245, "comment_id": 90478650, "body": "If the other program is C++ as well, then a simple <code>float a = ...; fwrite(&amp;a, 1, sizeof(a), f);</code> should work. That&#39;s the fastest and simplest solution."}], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "closed_date": 1533732805, "answer_count": 0, "score": 0, "last_activity_date": 1536914401, "creation_date": 1533732662, "last_edit_date": 1536914401, "question_id": 51747245, "link": "https://stackoverflow.com/questions/51747245/c-float-double-write-to-read-from-file-exact-values", "closed_reason": "Duplicate", "title": "C++ float / double : write to / read from file &quot;exact&quot; values", "body": "<p>I have two programs written in C++, say, <code>calc1</code> and <code>calc2</code>, which produce results <code>x1</code> and <code>x2</code>, respectively. They could be <code>float</code> or <code>double</code>.</p>\n\n<p>I mean to write <code>x1</code> and <code>x2</code> to file, and read them with another program also in C++, <code>my_oper</code>, which operates with <code>x1</code> and <code>x2</code>.\nI need to keep the full precision that C++ uses for their variables, exactly as if all were done in a single program.\nI also mean not to use text files (I do not care about the files being human-readable), so as to reduce the disk space and read/write time.</p>\n\n<p><strong>What should I use for writing and reading?</strong></p>\n\n<hr>\n\n<p><strong>Question <a href=\"https://stackoverflow.com/questions/554063/how-do-i-print-a-double-value-with-full-precision-using-cout\">How do I print a double value with full precision using cout?</a> does not fully address the present OP</strong>.\n<br>\n<em>Major issue #1</em>: Solutions posted aim at human-readable forms of output, so they do not care about saving disk space. That is an essential part of the question here.\n<br>\n<em>Major issue #2</em>: It does not seem to deal with <a href=\"https://en.wikipedia.org/wiki/Double-precision_floating-point_format\" rel=\"nofollow noreferrer\">the whole range of doubles</a> (~ 2^-53 - 2^+53, plus exponents). See snippet below.\nAnd even if it did, issue 1 above already states a different purpose.</p>\n\n<p>Note that if the result from the exact arithmetic is x1=0.1 (e.g.), but the value stored is something slightly different x1* (say, in the 7th significant digit for a float), I want to write and then read x1*, I don't care about x1.</p>\n\n<p>The following snippet</p>\n\n<pre><code>int iexpbase = 0;\nfstream file;\nfile.precision(dbl::max_digits10);\nfile.precision(17);\nfile.open(\"math_precision_io.dat\", fstream::out);\nfor (iexpbase = -100 ; iexpbase &lt;= 100 ; iexpbase+=10) {\n    double d2 = pow(10, iexpbase);\n    file &lt;&lt; fixed &lt;&lt; d2 &lt;&lt; endl;\n}\nfile.close();\n</code></pre>\n\n<p>produces this output</p>\n\n<pre><code>0.00000000000000000\n0.00000000000000000\n0.00000000000000000\n0.00000000000000000\n0.00000000000000000\n0.00000000000000000\n0.00000000000000000\n0.00000000000000000\n0.00000000000000000\n0.00000000010000000\n1.00000000000000000\n10000000000.00000000000000000\n100000000000000000000.00000000000000000\n1000000000000000019884624838656.00000000000000000\n10000000000000000303786028427003666890752.00000000000000000\n100000000000000007629769841091887003294964970946560.00000000000000000\n999999999999999949387135297074018866963645011013410073083904.00000000000000000\n10000000000000002257809904681181209619930771246774403173921223738392576.00000000000000000\n100000000000000013190646323278015613777155861640004848960018902522128665705185280.00000000000000000\n1000000000000000192640537007097094236487266187713695528897613397388406395002972996141842432.00000000000000000\n10000000000000002101697803323328251387822715387464188032188166609887360023982790799717755191065313280.00000000000000000\n</code></pre>\n"}, {"tags": ["c++", "list", "fstream"], "comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 4, "creation_date": 1533733210, "post_id": 51747202, "comment_id": 90454514, "body": "If <code>BUFFER_SIZE_8_MB</code> is what is seems to be, creating an <code>std::list</code> that holds 8 megabytes of individual bytes is going to be a horror show. In general, when you read from a file you should read into a contiguous data area. <code>std::list</code> is not contiguous, and trying to jam bytes into a list will involve a huge amount of overhead (probably 16 bytes for each data byte) and a great deal of heap thrashing. Unless there&#39;s a really compelling reason for such an inefficient use of memory, don&#39;t do this."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 2, "creation_date": 1533733538, "post_id": 51747202, "comment_id": 90454723, "body": "Aside: <code>sizeof(char)</code> is <i>by definition</i> 1"}, {"owner": {"reputation": 337, "user_id": 9630578, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fQv1H54M-A0/AAAAAAAAAAI/AAAAAAAAAGM/LRzWl5qj-g0/photo.jpg?sz=128", "display_name": "super sahar", "link": "https://stackoverflow.com/users/9630578/super-sahar"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1533733587, "post_id": 51747202, "comment_id": 90454747, "body": "@PeteBecker, &quot;contiguous data area&quot; is just an array? What is this? And what best size of buffer to read from disk?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533733775, "post_id": 51747202, "comment_id": 90454890, "body": "&quot;The elements are stored contiguously, which means that elements can be accessed not only through iterators, but also using offsets to regular pointers to elements. This means that a pointer to an element of a vector may be passed to any function that expects a pointer to an element of an array.&quot; <a href=\"https://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\">std::vector</a>"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1533733823, "post_id": 51747202, "comment_id": 90454919, "body": "Yes, an array. Beyond that, it highly depends on the details of what you&#39;re trying to do."}, {"owner": {"reputation": 337, "user_id": 9630578, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fQv1H54M-A0/AAAAAAAAAAI/AAAAAAAAAGM/LRzWl5qj-g0/photo.jpg?sz=128", "display_name": "super sahar", "link": "https://stackoverflow.com/users/9630578/super-sahar"}, "edited": false, "score": 0, "creation_date": 1533733959, "post_id": 51747202, "comment_id": 90455006, "body": "So if I want to read buffer byte by byte, std::vector will be the best option?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1533738256, "post_id": 51747202, "comment_id": 90457961, "body": "A contiguous buffer (array) allows you to use <code>std::istream::read</code> to read in a block of data.  The input system will read one datum into memory, increment a pointer and read the next datum into memory.  This process can be delegated to hardware devices (such as DMA controllers and UARTs).  This process is not efficiently implemented by hardware with linked lists.  With linked list: 1) allocate node, 2) read datum into node, 3) link new node to list."}], "answers": [{"tags": [], "owner": {"reputation": 677, "user_id": 1418351, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7a7dba2123954dce6d12c48c0c74d785?s=128&d=identicon&r=PG", "display_name": "John_Sharp1318", "link": "https://stackoverflow.com/users/1418351/john-sharp1318"}, "is_accepted": false, "score": 0, "last_activity_date": 1533735644, "creation_date": 1533735644, "answer_id": 51748222, "question_id": 51747202, "link": "https://stackoverflow.com/questions/51747202/how-to-read-part-of-file-to-stdlist-buffer/51748222#51748222", "title": "How to read part of file to std::list buffer?", "body": "<p>I would to it like this:</p>\n\n<pre><code>std::list&lt;uchar&gt; lst;\n\nstd::ifstream stream(\"somefile.txt\");\n\nfor(int i=0;i&lt;8192;i++)\n{\n   uchar a=0;\n   stream.read(reinterpret_cast&lt;char*&gt;(&amp;a),sizeof(uchar));\n   lst.push_back(a);\n}\n</code></pre>\n\n<p>The issue with this approach come from the fact that you cannot make a cast later because the bytes in a linked list (no matter if it is single, double or else chained) are not contiguous in memory.\nSo if you later want to recast to another type you can do that that way:</p>\n\n<pre><code>reinterpret_cast&lt;output_type*&gt;(std::vector&lt;uchar&gt;(lst.begin(),lst.end()).data());\n</code></pre>\n\n<p>Hope it help you.</p>\n"}], "owner": {"reputation": 337, "user_id": 9630578, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fQv1H54M-A0/AAAAAAAAAAI/AAAAAAAAAGM/LRzWl5qj-g0/photo.jpg?sz=128", "display_name": "super sahar", "link": "https://stackoverflow.com/users/9630578/super-sahar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533735644, "creation_date": 1533732547, "question_id": 51747202, "link": "https://stackoverflow.com/questions/51747202/how-to-read-part-of-file-to-stdlist-buffer", "title": "How to read part of file to std::list buffer?", "body": "<p>With <code>std::vector</code> I used this:</p>\n\n<pre><code>list_buffer_bytes.resize(BUFFER_SIZE_8_MB);\nfile_source.read(&amp;vector_buffer_bytes[0], BUFFER_SIZE_8_MB * sizeof(char));\n</code></pre>\n\n<p>But I can't do that if I change type from std::vector to std::list</p>\n"}, {"tags": ["c++", "visual-studio-2010"], "comments": [{"owner": {"reputation": 14960, "user_id": 3214872, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/NJBvG.jpg?s=128&g=1", "display_name": "GPhilo", "link": "https://stackoverflow.com/users/3214872/gphilo"}, "edited": false, "score": 0, "creation_date": 1533732521, "post_id": 51747072, "comment_id": 90453997, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3924926/cannot-convert-parameter-1-from-char-to-lpcwstr\">cannot convert parameter 1 from &#39;char&#39; to &#39;LPCWSTR&#39;</a> (see the second answer, not the one marked asslution)"}, {"owner": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "edited": false, "score": 0, "creation_date": 1533732672, "post_id": 51747072, "comment_id": 90454092, "body": "Can you share code the problematic line? Without it it is hard to say anything precise."}, {"owner": {"reputation": 31, "user_id": 5920174, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5dcXGIiZumk/AAAAAAAAAAI/AAAAAAAAAqg/U0U3lR0thMI/photo.jpg?sz=128", "display_name": "pratik solanki", "link": "https://stackoverflow.com/users/5920174/pratik-solanki"}, "edited": false, "score": 0, "creation_date": 1533733016, "post_id": 51747072, "comment_id": 90454346, "body": "here problem is that my code is build successfully with same &quot;charter set&quot;: Use UNICODE set while i build code win32 but if i build code in x64 then getting above mention error"}], "answers": [{"comments": [{"owner": {"reputation": 156, "user_id": 291878, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f0e31d1768a938222f607639b0659bef?s=128&d=identicon&r=PG", "display_name": "kcris", "link": "https://stackoverflow.com/users/291878/kcris"}, "reply_to_user": {"reputation": 31, "user_id": 5920174, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5dcXGIiZumk/AAAAAAAAAAI/AAAAAAAAAqg/U0U3lR0thMI/photo.jpg?sz=128", "display_name": "pratik solanki", "link": "https://stackoverflow.com/users/5920174/pratik-solanki"}, "edited": false, "score": 0, "creation_date": 1533732874, "post_id": 51747194, "comment_id": 90454235, "body": "what is the type of CHAR? and can you show the line where you get the error?"}, {"owner": {"reputation": 31, "user_id": 5920174, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5dcXGIiZumk/AAAAAAAAAAI/AAAAAAAAAqg/U0U3lR0thMI/photo.jpg?sz=128", "display_name": "pratik solanki", "link": "https://stackoverflow.com/users/5920174/pratik-solanki"}, "edited": false, "score": 0, "creation_date": 1533733242, "post_id": 51747194, "comment_id": 90454527, "body": "I can able to build win32 successfully but while i am trying to build with x64 at that time i am facing type casting error as mention in question"}, {"owner": {"reputation": 156, "user_id": 291878, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f0e31d1768a938222f607639b0659bef?s=128&d=identicon&r=PG", "display_name": "kcris", "link": "https://stackoverflow.com/users/291878/kcris"}, "reply_to_user": {"reputation": 31, "user_id": 5920174, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5dcXGIiZumk/AAAAAAAAAAI/AAAAAAAAAqg/U0U3lR0thMI/photo.jpg?sz=128", "display_name": "pratik solanki", "link": "https://stackoverflow.com/users/5920174/pratik-solanki"}, "edited": false, "score": 0, "creation_date": 1533733382, "post_id": 51747194, "comment_id": 90454621, "body": "what is the type of CHAR? I suspect WCHAR is one type, and CHAR is another. Which just matched on 32 bit, but not on 64 bit."}, {"owner": {"reputation": 31, "user_id": 5920174, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5dcXGIiZumk/AAAAAAAAAAI/AAAAAAAAAqg/U0U3lR0thMI/photo.jpg?sz=128", "display_name": "pratik solanki", "link": "https://stackoverflow.com/users/5920174/pratik-solanki"}, "edited": false, "score": 0, "creation_date": 1533733668, "post_id": 51747194, "comment_id": 90454807, "body": "yes you are right . is it any way to solve problem without using explicit  type casting ?"}], "tags": [], "owner": {"reputation": 156, "user_id": 291878, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f0e31d1768a938222f607639b0659bef?s=128&d=identicon&r=PG", "display_name": "kcris", "link": "https://stackoverflow.com/users/291878/kcris"}, "is_accepted": false, "score": 0, "last_activity_date": 1533732514, "creation_date": 1533732514, "answer_id": 51747194, "question_id": 51747072, "link": "https://stackoverflow.com/questions/51747072/issue-while-migrate-code-from-32-bit-to-64-bit-visual-studio-2010/51747194#51747194", "title": "Issue while migrate code from 32 bit to 64 bit visual studio 2010", "body": "<p>Are you using UNICODE?\nIn that case, LPCTSTR char type is wchar_t</p>\n"}, {"tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": false, "score": 0, "last_activity_date": 1533854691, "creation_date": 1533854691, "answer_id": 51776702, "question_id": 51747072, "link": "https://stackoverflow.com/questions/51747072/issue-while-migrate-code-from-32-bit-to-64-bit-visual-studio-2010/51776702#51776702", "title": "Issue while migrate code from 32 bit to 64 bit visual studio 2010", "body": "<p>Visual Studio allows different configurations for x64 and x32, it also allows different configurations for debug and release mode. Each of these configuration can have a different character encoding. You have to manually change the configuration so that they all use the same character encoding.</p>\n\n<p>In the main menu, click Project->Properties. </p>\n\n<p>You should see <code>\"Configuration: Debug/Release\"</code>, <code>Platform: Win32/x64\"</code></p>\n\n<p>You also see <code>\"Character set: Unicode/Not-set\"</code></p>\n\n<p>Unicode is recommended. Make sure all of the 4 configurations are using </p>\n\n<pre><code>\"Character set: Unicode\"\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5920174, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5dcXGIiZumk/AAAAAAAAAAI/AAAAAAAAAqg/U0U3lR0thMI/photo.jpg?sz=128", "display_name": "pratik solanki", "link": "https://stackoverflow.com/users/5920174/pratik-solanki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 364, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1533854691, "creation_date": 1533732186, "last_edit_date": 1533733424, "question_id": 51747072, "link": "https://stackoverflow.com/questions/51747072/issue-while-migrate-code-from-32-bit-to-64-bit-visual-studio-2010", "title": "Issue while migrate code from 32 bit to 64 bit visual studio 2010", "body": "<p>I have followed below step to compile code in 64 bit. all steps also mention in <a href=\"https://stackoverflow.com/questions/1865069/how-to-compile-a-64-bit-application-using-visual-c-2010-express\">How to compile a 64-bit application using Visual C++ 2010 Express?</a>\nlink</p>\n\n<p>1) Download and install the Windows Software Development Kit version 7.1. Visual C++ 2010 Express does not include a 64 bit compiler, but the SDK does. A link to the SDK: <a href=\"http://msdn.microsoft.com/en-us/windowsserver/bb980924.aspx\" rel=\"nofollow noreferrer\">http://msdn.microsoft.com/en-us/windowsserver/bb980924.aspx</a></p>\n\n<p>2 ) Change your project configuration. Go to Properties of your project. On the top of the dialog box there will be a \"Configuration\" drop-down menu. Make sure that selects \"All Configurations.\" There will also be a \"Platform\" drop-down that will read \"Win32.\" Finally on the right there is a \"Configuration Manager\" button - press it. In the dialog that comes up, find your project, hit the Platform drop-down, select New, then select x64. Now change the \"Active solution platform\" drop-down menu to \"x64.\" When you return to the Properties dialog box, the \"Platform\" drop-down should now read \"x64.\"</p>\n\n<p>3) Finally, change your toolset. In the Properties menu of your project, under Configuration Properties | General, change Platform Toolset from \"v100\" to \"Windows7.1SDK\".</p>\n\n<p><strong>I am also compiling code in x64 mode</strong> </p>\n\n<p>Still I am getting below error</p>\n\n<p><strong>error C2664: cannot convert parameter 1 from 'LPCTSTR' to 'const CHAR *'</strong></p>\n\n<p>please help me to solve problem.</p>\n\n<p>my requirement is that need to enable character set : Use Unicode character set (project->General). so this i can't able to set character set  as NOT set.\nas mention below link\n<a href=\"https://stackoverflow.com/questions/3924926/cannot-convert-parameter-1-from-char-to-lpcwstr\">cannot convert parameter 1 from &#39;char&#39; to &#39;LPCWSTR&#39;</a></p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 5, "creation_date": 1533731608, "post_id": 51746836, "comment_id": 90453372, "body": "loop with single instruction, how this can be more compact? Empty loop?"}, {"owner": {"reputation": 359, "user_id": 8501464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFpwl.jpg?s=128&g=1", "display_name": "Yi\u011fit Aras Tunal\u0131", "link": "https://stackoverflow.com/users/8501464/yi%c4%9fit-aras-tunal%c4%b1"}, "edited": false, "score": 0, "creation_date": 1533732205, "post_id": 51746836, "comment_id": 90453809, "body": "This is as basic as it gets. It reads from <code>cin</code> input stream until <code>getline()</code> fails."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 2, "creation_date": 1533732228, "post_id": 51746836, "comment_id": 90453819, "body": "<i>Why</i> do you want it to be more compact?  What advantage does that give you?  It certainly won&#39;t make it any more readable!"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1533735027, "post_id": 51746836, "comment_id": 90455726, "body": "&quot;Compact syntax&quot; and &quot;simple code&quot; are not always (rarely?!) the same thing. So which one do you want?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1533738707, "post_id": 51746836, "comment_id": 90458330, "body": "If you want compact, use <code>std::string::reserve</code> and <code>std::cin::read</code>.  This will read the file into one large string (provided you reserved enough space), thus the data is more <i>compact</i>, leaving less holes or gaps in memory.  Also, two statements, thus being more <i>compact</i> in the source code.  Search the internet for &quot;memory mapped files&quot;, append your operating system name to the keywords."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1533738766, "post_id": 51746836, "comment_id": 90458377, "body": "For more compact, search the internet for &quot;c++ text compression&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1533732085, "post_id": 51746999, "comment_id": 90453722, "body": "More compact? And readability? We have a read function, result for comparisons of a loop and a function inside. So writing it as for/do while/while or whatever will not make the thing better!"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1533732206, "post_id": 51746999, "comment_id": 90453810, "body": "@Klaus The user doesn&#39;t want better, they want more compact"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1533732319, "post_id": 51746999, "comment_id": 90453871, "body": "Ha. I really like this. It also doesn&#39;t require a hack to deal with <code>push_back</code> being <code>void</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1533732371, "post_id": 51746999, "comment_id": 90453906, "body": "@Bathsheba Yeah.  I was thinking if using your solution then I remembered I could just do it in the increment step."}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1533732411, "post_id": 51746999, "comment_id": 90453926, "body": "Is meaning &quot;compact&quot; reducing the number of lines or number of characters? ;) Not clear requirements if your code is the solution ;)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 2, "creation_date": 1533732444, "post_id": 51746999, "comment_id": 90453945, "body": "@Klaus: There does not exist a solution to something that doesn&#39;t have a problem, such as the code that the OP presents ;-)"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 10, "last_activity_date": 1533732305, "last_edit_date": 1533732305, "creation_date": 1533731974, "answer_id": 51746999, "question_id": 51746836, "link": "https://stackoverflow.com/questions/51746836/looking-for-a-more-compact-syntax-simple-code-c/51746999#51746999", "title": "Looking for a more compact syntax (simple code) - C++", "body": "<p>You can use a for loop.  We can declare <code>Line</code> in the variable declaration part and use the condition and increment parts to read and place the line.  That gives you</p>\n\n<pre><code>for(string Line; getline(cin, Line); Text.push_back(Line));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 3, "creation_date": 1533732226, "post_id": 51747035, "comment_id": 90453818, "body": "Good example for using obscurity ;)"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1533732826, "last_edit_date": 1533732826, "creation_date": 1533732065, "answer_id": 51747035, "question_id": 51746836, "link": "https://stackoverflow.com/questions/51746836/looking-for-a-more-compact-syntax-simple-code-c/51747035#51747035", "title": "Looking for a more compact syntax (simple code) - C++", "body": "<p>Well, at the expense of some obfuscation,</p>\n\n<pre><code>while (getline(cin, Line) &amp;&amp; (Text.push_back(Line), 1));\n</code></pre>\n\n<p>would do it: note the use of the <em>expression separator operator</em> which, informally speaking, \"converts\" the <code>void</code> return type of <code>push_back</code> to an <code>int</code> so enabling its use with the short-circuiting <code>&amp;&amp;</code>.</p>\n\n<p>But as a rule of thumb, work <em>with</em> the language, not <em>against</em> it. My answer is doing the latter. The way you present the code in your question is adequate.</p>\n"}, {"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1533732158, "post_id": 51747045, "comment_id": 90453773, "body": "&quot;Loop is a single instruction&quot; what does this mean?"}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 2, "creation_date": 1533732188, "post_id": 51747045, "comment_id": 90453798, "body": "The same as in the code given by OP. Leaving the braces is typically a bad idea!"}, {"owner": {"reputation": 27, "user_id": 7178881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2977ea15ae7b00f6d8cd513691b6d28f?s=128&d=identicon&r=PG&f=1", "display_name": "Ludovic", "link": "https://stackoverflow.com/users/7178881/ludovic"}, "edited": false, "score": 0, "creation_date": 1533732235, "post_id": 51747045, "comment_id": 90453823, "body": "Sorry with and not is :) I wrote it too fast sorry."}], "tags": [], "owner": {"reputation": 27, "user_id": 7178881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2977ea15ae7b00f6d8cd513691b6d28f?s=128&d=identicon&r=PG&f=1", "display_name": "Ludovic", "link": "https://stackoverflow.com/users/7178881/ludovic"}, "is_accepted": false, "score": -3, "last_activity_date": 1533732252, "last_edit_date": 1533732252, "creation_date": 1533732111, "answer_id": 51747045, "question_id": 51746836, "link": "https://stackoverflow.com/questions/51746836/looking-for-a-more-compact-syntax-simple-code-c/51747045#51747045", "title": "Looking for a more compact syntax (simple code) - C++", "body": "<p>Loop with a single instruction. you can write it in one line but I don't recommend it</p>\n\n<pre><code>while (getline(cin, Line)) Text.push_back(Line);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 2, "last_activity_date": 1533732217, "creation_date": 1533732217, "answer_id": 51747089, "question_id": 51746836, "link": "https://stackoverflow.com/questions/51746836/looking-for-a-more-compact-syntax-simple-code-c/51747089#51747089", "title": "Looking for a more compact syntax (simple code) - C++", "body": "<blockquote>\n  <p>more or less, putting everything in the condition?</p>\n</blockquote>\n\n<p>You can do this</p>\n\n<pre><code>while (getline(cin, Line) &amp;&amp; (Text.push_back(Line),true)) {}\n</code></pre>\n\n<p>It works because <code>&amp;&amp;</code> is short-circuited and because the comma-operator evaluates the first operand, discards the result and returns the result of the second operand. </p>\n\n<p>So it is possible, but why would you want to do that? Making code as dense as possible is rarely good for readability (actually your original code is more readable <strong>and</strong> uses less characters). </p>\n"}, {"tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": false, "score": 1, "last_activity_date": 1533733880, "creation_date": 1533733880, "answer_id": 51747647, "question_id": 51746836, "link": "https://stackoverflow.com/questions/51746836/looking-for-a-more-compact-syntax-simple-code-c/51747647#51747647", "title": "Looking for a more compact syntax (simple code) - C++", "body": "<p>At the risk of \"but that is exactly OP's code!\", I would personally favor this version if this is the entire body of a scope (e.g. function that parses the text):</p>\n\n<pre><code>vector&lt;string&gt; Text;\nstring Line;\n\nwhile (getline(cin, Line))\n  Text.push_back(Line);\n</code></pre>\n\n<p>Alternatively, if part of a larger scope, I would probably group all four lines together and add empty lines before and after for visual coherence (and maybe add a short comment before it):</p>\n\n<pre><code>// [lots of other code]\n\n// Gather input from cin.\nvector&lt;string&gt; Text;\nstring Line;\nwhile (getline(cin, Line))\n  Text.push_back(Line);\n\n// [lots of other code]\n</code></pre>\n\n<p>I am aware that this introduces no clever tricks, but this is the <em>most compact and readable</em> form of the given code, at least to me.</p>\n\n<p>If you wanted compactness above all else, you could choose garbage variables, omit all unnecessary whitespace and even alias the types beforehand (since we are \"often writing\" this kind of code this is a one-off) to, say,  <code>V&lt;S&gt; t;S l;while(getline(cin,l))t.push_back(l);</code>  but nobody wants to read that.</p>\n\n<p>So clearly there is more than compactness at play. As for me, I'm looking to keep noise to a minimum while retaining intuitive readability, and I would suggest this is an agreeable goal.</p>\n\n<p>I would never use the \"throw everything into the loop condition\" suggestions because that very much breaks how I expect code to be structured: <strong>The main purpose of your loop goes into the loop body.</strong> You may disagree/have different expectations, but in my eyes everything else is just an attempt to show off your minifying skills, it does not produce good code.</p>\n\n<p>The above accomplishes just that: The braces are noise for this simple operation, and the important part stands out as the loop body. \"But is <code>getline</code> not also important?\" - It is, and I would honestly prefer a version where it is in the loop body, such as a hypothetical</p>\n\n<pre><code>vector&lt;string&gt; Text;\nwhile (cin.hasLine())\n  Text.push_back(readLine(cin));\n</code></pre>\n\n<p>This would be an ideal loop to me: The condition <em>only</em> checks for termination and the loop body is <em>only</em> the operation we want to repeat.</p>\n\n<p>Even better would be a standard algorithm, but I unaware of any that would help here (ranges or boost might provide, I don't know).</p>\n\n<hr>\n\n<p>On a more abstract level, if OP frequently writes this exact code, it should obviously be a separate function. But even if not, the \"lots of other code\" example would benefit from that abstraction too.</p>\n"}], "owner": {"reputation": 782, "user_id": 10030931, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kzp76oFZb2w/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ogXL9KxWaKfJmOrkOHZqSaF-my0g/mo/photo.jpg?sz=128", "display_name": "Andrea Bocco", "link": "https://stackoverflow.com/users/10030931/andrea-bocco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1533733880, "creation_date": 1533731458, "question_id": 51746836, "link": "https://stackoverflow.com/questions/51746836/looking-for-a-more-compact-syntax-simple-code-c", "title": "Looking for a more compact syntax (simple code) - C++", "body": "<p>I'm relearning C++ and I found myself often writing pieces of code like this:</p>\n\n<pre><code>vector&lt;string&gt; Text;\nstring Line;\n\nwhile (getline(cin, Line))\n{\n    Text.push_back(Line);\n}\n</code></pre>\n\n<p>I was wondering if there is a more compact way to write the loop using only basic features (no user-written functions, for example) - more or less, putting everything in the condition?</p>\n"}, {"tags": ["c++", "visual-studio"], "comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533732534, "post_id": 51746820, "comment_id": 90454004, "body": "Why don&#39;t you want objects of this type to have any other storage duration?"}, {"owner": {"reputation": 2756, "user_id": 5114342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725caa4188def46b8c6cf9b09eff7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Aziuth", "link": "https://stackoverflow.com/users/5114342/aziuth"}, "edited": false, "score": 0, "creation_date": 1533732599, "post_id": 51746820, "comment_id": 90454041, "body": "Have you considered a private constructor, with new instances being obtained with a static method that returns a pointer instead? Also, why exactly do you need such a class?"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 2, "creation_date": 1533732606, "post_id": 51746820, "comment_id": 90454047, "body": "<i>&quot;I am attempting to define a class which can only be instantiated on the heap &quot;</i> - I don&#39;t understand why, but what about making all the constructors private and provide a factory static member function that create instances on the heap?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1533732945, "post_id": 51746820, "comment_id": 90454280, "body": "<code>delete</code> is not an operator, and unlike when overloading actual operators, <code>delete abc</code> is not syntactic sugar for an invocation of <code>operator delete</code>. <code>operator delete</code> has a confusing name and would more appropriately be called &quot;deallocate&quot; or &quot;free&quot; or something like that, but &quot;the C++ way&quot; is to overload the meaning of existing reserved words rather than introducing new ones."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2486888"}, "is_accepted": true, "score": 2, "last_activity_date": 1533732666, "last_edit_date": 1533732666, "creation_date": 1533732192, "answer_id": 51747075, "question_id": 51746820, "link": "https://stackoverflow.com/questions/51746820/i-am-attempting-to-define-a-class-which-can-only-be-instantiated-on-the-heap/51747075#51747075", "title": "I am attempting to define a class which can only be instantiated on the heap", "body": "<p>There isn't really a \"delete operator\" for you to overload. There are:</p>\n\n<ul>\n<li><em>Delete expression</em>, as in <code>delete abc</code>; and</li>\n<li><em>Deallocation function</em> which deallocate memory, and its syntax is, confusingly, <code>operator delete</code>.</li>\n</ul>\n\n<p>In other words, you have never overloaded the non-existent \"delete operator\" or declaring it a friend. The only thing overloaded and declared a friend is the <em>deallocation function</em>.</p>\n\n<p>The <em>delete expression</em> does thing in two steps:</p>\n\n<ol>\n<li>Invoke the destructor to reduce the object back into raw memory</li>\n<li>Invoke the deallocation function to deallocate the memory</li>\n</ol>\n\n<p>Therefore, the private destructor is still considered invoked directly by <code>main</code>, which is not a friend of the class.</p>\n\n<p>We can do a little experiment to verify that:</p>\n\n<p>Code 1: Without <code>friend</code> declaration: <a href=\"https://godbolt.org/g/WVmzNP\" rel=\"nofollow noreferrer\">https://godbolt.org/g/WVmzNP</a></p>\n\n<pre><code>class HeapOnly\n{\n    int x;\n    int y;\n    ~HeapOnly() = default;\n};\n\nint main()\n{\n    HeapOnly *abc = new HeapOnly();\n    delete abc;\n}\n</code></pre>\n\n<p>Code 2: Declaring <code>main</code> as friend: <a href=\"https://godbolt.org/g/9PVZ4C\" rel=\"nofollow noreferrer\">https://godbolt.org/g/9PVZ4C</a></p>\n\n<pre><code>class HeapOnly\n{\n    int x;\n    int y;\n    ~HeapOnly() = default;\n\n    friend int main();\n};\n\nint main()\n{\n    HeapOnly *abc = new HeapOnly();\n    delete abc;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2486888"}, "reply_to_user": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "edited": false, "score": 0, "creation_date": 1533733467, "post_id": 51747278, "comment_id": 90454688, "body": "@GauravSehgal Ummm... Only allow <code>std::allocator&lt;HeapOnly&gt;</code> to call the destructor, and no one else?"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1533735558, "post_id": 51747278, "comment_id": 90456107, "body": "Only that this solution does not allow using &quot;raw&quot; pointers with <code>new</code> and <code>delete</code>. Of course better to avoid them, but we don&#39;t know whether OP needs them or not."}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "reply_to_user": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1533755259, "post_id": 51747278, "comment_id": 90467693, "body": "@DanielLangr Ermh. Well, I think I stated at the beginning, that I don&#39;t know whether/how to achieve that (raw pointers yet heap-only)."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1533756322, "post_id": 51747278, "comment_id": 90468121, "body": "your <code>friend</code> way is <i>not portable</i>, those implementations might use helper class/function."}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1533759159, "post_id": 51747278, "comment_id": 90469410, "body": "@Jarod42 I was dreading this too. But are you sure? AFAIK, <code>allocator</code> does not use helper functions. I don&#39;t know about <code>default_delete</code>, but if you can provide me with a proof (quote from the standard and/or cppreference) that would be useful."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1533764326, "post_id": 51747278, "comment_id": 90471560, "body": "Standard state the behaviour/complexity of functions, not the implementation. And using helper methods might be possible."}], "tags": [], "owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "is_accepted": false, "score": 2, "last_activity_date": 1533802034, "last_edit_date": 1533802034, "creation_date": 1533732757, "answer_id": 51747278, "question_id": 51746820, "link": "https://stackoverflow.com/questions/51746820/i-am-attempting-to-define-a-class-which-can-only-be-instantiated-on-the-heap/51747278#51747278", "title": "I am attempting to define a class which can only be instantiated on the heap", "body": "<p>As why your attempt failed, see other answers. I don't know whether, and if so how, you can achieve the general goal of a class that can only be instantiated on the heap and if this is desirable, but I doubt both.</p>\n\n<p>However, what you can do is to restrict de-allocation to go through <code>std::allocator</code> or <code>std::default_delete</code>, so that simple automatic variables are not possible:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n\nclass HeapOnly\n{\n    ~HeapOnly();\n  public:\n    bool operator &lt; (HeapOnly const&amp;) const;\n    friend class std::allocator&lt;HeapOnly&gt;;\n    friend class std::default_delete&lt;HeapOnly&gt;;\n};\n\nint main()\n{\n    std::vector&lt;HeapOnly&gt; X(10);   // okay\n    HeapOnly Y;                    // ERROR: cannot be destructed\n    std::sort(X.begin(),X.end());  // ERROR: requires automatic variables\n    std::vector&lt;std::unique_ptr&lt;HeapOnly&gt;&gt; Z(10);    // okay\n    for(auto&amp;z:Z)\n        z.reset(new HeapOnly);\n    std::sort(Z.begin(),Z.end(),[](std::unique_ptr&lt;HeapOnly&gt; const&amp;x,\n                                   std::unique_ptr&lt;HeapOnly&gt; const&amp;y)\n                                { return *x &lt; *y; }); \n}\n</code></pre>\n\n<p>Note, however, that many things rely on automatic variables, including <code>std::swap</code> and <code>std::sort</code> (befriending <code>std::sort</code> directly does not help, as it delegates the work to implementation-specific helper routines). However, you can enable <code>unique_ptr</code> (and <code>shared_ptr</code>), which appears the natural thing to do with a heap-only class, and sort the objects pointed to.</p>\n\n<p><strong>Note further</strong> that even though the code above may work with most if not all STL implementations, this is <strong>not guaranteed</strong>. <code>std::allocator&lt;&gt;::destroy()</code> may, for example, delegate the destruction to a helper function, which is an implementation detail and hence cannot be befriended.</p>\n\n<p>However, you could test for this and use SFINAE to dodge such cases.</p>\n"}], "owner": {"reputation": 17, "user_id": 5055504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f42Ul3DW-0s/AAAAAAAAAAI/AAAAAAAAAC8/PVcsTZMUypg/photo.jpg?sz=128", "display_name": "strawhatsai", "link": "https://stackoverflow.com/users/5055504/strawhatsai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 51747075, "answer_count": 2, "score": 0, "last_activity_date": 1533802034, "creation_date": 1533731419, "question_id": 51746820, "link": "https://stackoverflow.com/questions/51746820/i-am-attempting-to-define-a-class-which-can-only-be-instantiated-on-the-heap", "title": "I am attempting to define a class which can only be instantiated on the heap", "body": "<p>I am trying to achieve this by overloading the delete operator as a friend function. The code is as follows: </p>\n\n<pre><code>#include &lt;iostream&gt;\n\n\nclass HeapOnly\n{\n    int x;\n    int y;\n    ~HeapOnly()\n    {\n\n    }\npublic:\n    void friend operator delete(void* a);\n};\n\nvoid operator delete(void* p)\n{\n    delete p;\n}\n\nint main()\n{\n    HeapOnly *abc = new HeapOnly();\n    delete abc;\n}\n</code></pre>\n\n<p>The above code gives error in Visual Studio \"Error  C2248   'HeapOnly::~HeapOnly': cannot access private member declared in class 'HeapOnly\"</p>\n\n<p>I do not understand as to why it is giving error as the delete operator is overloaded as friend function hence it should be able to access the destructor which is in private. </p>\n"}, {"tags": ["c++", "intrinsics", "avx"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 1243711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe061663d09a0f3b756f2c88e5f5f867?s=128&d=identicon&r=PG", "display_name": "lds", "link": "https://stackoverflow.com/users/1243711/lds"}, "edited": false, "score": 0, "creation_date": 1533743923, "post_id": 51747443, "comment_id": 90461813, "body": "This was really clarifying. Thanks a lot for showing me some great resources too. So there shouldn&#39;t be the possibility of replicating [this code]( <a href=\"http://fastcpp.blogspot.com/2011/04/vector-cross-product-using-sse-code.html\" rel=\"nofollow noreferrer\">fastcpp.blogspot.com/2011/04/&hellip;</a> ) with __m256d with a single shuffle or permute as they won&#39;t be able to fetch the 3rd element to the second space, am I right?"}, {"owner": {"reputation": 87, "user_id": 1243711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe061663d09a0f3b756f2c88e5f5f867?s=128&d=identicon&r=PG", "display_name": "lds", "link": "https://stackoverflow.com/users/1243711/lds"}, "edited": false, "score": 0, "creation_date": 1533743927, "post_id": 51747443, "comment_id": 90461816, "body": "I&#39;ve seen there is a permute4x64 that would be able to do what I need but my processor doesn&#39;t have access to AVX2.  My solution would be to use <a href=\"https://stackoverflow.com/questions/13422747/reverse-a-avx-register-containing-doubles-using-a-single-avx-intrinsic\">this</a> to reverse the second parameter. Is there a faster, more correct solution that you would suggest?"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 87, "user_id": 1243711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe061663d09a0f3b756f2c88e5f5f867?s=128&d=identicon&r=PG", "display_name": "lds", "link": "https://stackoverflow.com/users/1243711/lds"}, "edited": false, "score": 1, "creation_date": 1533760959, "post_id": 51747443, "comment_id": 90470334, "body": "@Animamorta: Right.  Whenever possible, don&#39;t keep single 3D vectors in SIMD vectors in the first place.  See my update."}, {"owner": {"reputation": 87, "user_id": 1243711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe061663d09a0f3b756f2c88e5f5f867?s=128&d=identicon&r=PG", "display_name": "lds", "link": "https://stackoverflow.com/users/1243711/lds"}, "edited": false, "score": 0, "creation_date": 1533764395, "post_id": 51747443, "comment_id": 90471595, "body": "Thanks a lot for the help and the great resources."}], "tags": [], "owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 8, "last_activity_date": 1533760934, "last_edit_date": 1533760934, "creation_date": 1533733233, "answer_id": 51747443, "question_id": 51746720, "link": "https://stackoverflow.com/questions/51746720/how-do-the-shuffle-permute-intrinsics-work-for-256-bit-pd/51747443#51747443", "title": "How do the shuffle/permute intrinsics work for 256 bit pd?", "body": "<p><code>shufps</code> needs all 8 bits of its immediate just for 4 elements with 4 possible sources each.  So it has no room to grow for 256-bit, and the only option was to replicate the same shuffle in both lanes.</p>\n\n<p>But 128-bit <code>shufpd</code> only has 2 elements with 2 sources each, thus 2 x 1 bit.  So the AVX version uses 4 bits total, 2 for each lane.  (<strong>It's <em>not</em> lane-crossing, so it's not as powerful as 128-bit <code>shufps</code></strong>.)</p>\n\n<hr>\n\n<p><a href=\"http://felixcloutier.com/x86/SHUFPD.html\" rel=\"nofollow noreferrer\">http://felixcloutier.com/x86/SHUFPD.html</a> has full docs with a diagram, and detailed pseudocode.  Intel's intrinsics guide for <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#expand=4067,602,4787&amp;text=vshufpd\" rel=\"nofollow noreferrer\"><code>_mm256_shuffle_pd</code></a> has the same pseudo-code.</p>\n\n<p>AVX2 <a href=\"http://felixcloutier.com/x86/VPERMPD.html\" rel=\"nofollow noreferrer\">http://felixcloutier.com/x86/VPERMPD.html</a> (<code>_mm256_permute_pd</code>, aka <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#expand=4067,602,3922&amp;text=permute4x\" rel=\"nofollow noreferrer\"><code>_mm256_permute4x64_pd</code></a>) is lane-crossing, and uses its immediate exactly the way 128-bit <code>shufps</code> does: four 2-bit selectors.</p>\n\n<hr>\n\n<p>The only lane-crossing 2-source shuffle is <a href=\"http://felixcloutier.com/x86/VPERM2F128.html\" rel=\"nofollow noreferrer\"><code>vperm2f128</code> (<code>_mm256_permute2f128_pd</code>)</a>, until AVX512F introduces finer granularity <code>vpermt2pd</code> and <code>vpermt2ps</code> (and equivalent integer shuffles.</p>\n\n<p>AVX1 doesn't have <em>any</em> lane-crossing shuffles with granularity smaller than 128-bit, not even 1-source versions.  If you need one, you have to build it out of <code>vinsertf128</code> or <code>vperm2f128</code> + in-lane shuffles.</p>\n\n<hr>\n\n<p>Thus, keeping 3D vectors in SIMD vectors is even worse with AVX than it is for <code>float</code> with 128-bit vectors.  <a href=\"http://fastcpp.blogspot.com/2011/04/vector-cross-product-using-sse-code.html\" rel=\"nofollow noreferrer\">http://fastcpp.blogspot.com/2011/04/vector-cross-product-using-sse-code.html</a> might be faster than scalar, but it's much worse than you can do if you design your data layout for SIMD.</p>\n\n<p><strong>Use separate arrays of contiguous <code>x[]</code>, <code>y[]</code>, and <code>z[]</code> so you can do 4x cross products in parallel with no shuffling, and take advantage of FMA instructions.</strong>  Use SIMD to do multiple vectors in parallel, not to speed up single vectors.</p>\n\n<p>See links in <a href=\"https://stackoverflow.com/tags/sse/info\">https://stackoverflow.com/tags/sse/info</a>, especially <a href=\"https://deplinenoise.wordpress.com/2015/03/06/slides-simd-at-insomniac-games-gdc-2015/\" rel=\"nofollow noreferrer\">https://deplinenoise.wordpress.com/2015/03/06/slides-simd-at-insomniac-games-gdc-2015/</a> which explains the data-layout issue quite well, and which level of a loop to vectorize with SIMD.</p>\n"}], "owner": {"reputation": 87, "user_id": 1243711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe061663d09a0f3b756f2c88e5f5f867?s=128&d=identicon&r=PG", "display_name": "lds", "link": "https://stackoverflow.com/users/1243711/lds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1815, "favorite_count": 1, "accepted_answer_id": 51747443, "answer_count": 1, "score": 5, "last_activity_date": 1533760934, "creation_date": 1533731168, "question_id": 51746720, "link": "https://stackoverflow.com/questions/51746720/how-do-the-shuffle-permute-intrinsics-work-for-256-bit-pd", "title": "How do the shuffle/permute intrinsics work for 256 bit pd?", "body": "<p>I'm trying to wrap my head around how the _mm256_shuffle_pd and _mm256_permute_pd intrinsics work.\nI can't seem to predict what the results of one of these operations would be.</p>\n\n<p>First, for _mm_shuffle_ps all is good. The results I get are the one I expect. For example:</p>\n\n<pre><code>float b[4] = { 1.12, 2.22, 3.33, 4.44 };\n\n__m128 a = _mm_load_ps(&amp;b[0]);\na = _mm_shuffle_ps(a, a, _MM_SHUFFLE(3, 0, 1, 2));\n_mm_store_ps(&amp;b[0], a);\n// 3.33 2.22 1.12 4.44\n</code></pre>\n\n<p>So everything is right here. Now I wanted to try this with __m256d that is what I'm currently using in my code.\nFrom what I've found the _mm256_shuffle_ps/pd intrinsics works differently.</p>\n\n<p>My understanding here is that the control mask is applied two times. The first time on the first half of the 128 bit and the second on the last 128 bit.\nThe first two pairs of control bits are used to choose from the first vector ( and store the values in the first&amp;second word and in the fifth&amp;sixth word of the result vector ) while the highest bit pairs choose from the second vector.\nFor example:</p>\n\n<pre><code>float b[8] = { 1.12, 2.22, 3.33, 4.44, 5.55, 6.66, 7.77, 8.88 };\n\n__m256 a = _mm256_load_ps(&amp;b[0]);\na = _mm256_shuffle_ps(a, a, 0b00000111);\n_mm256_store_ps(&amp;b[0], a);\n// 4.44 2.22 1.12 1.12 8.88 6.66 5.55 5.55\n</code></pre>\n\n<p>Here the result I expect ( and I actually get ) is <code>{ 4.44, 2.22, 1.12, 1.12, 8.88, 6.66, 5.55, 5.55 }</code></p>\n\n<p>This should work as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/F0rjk.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/F0rjk.png\" alt=\"enter image description here\"></a></p>\n\n<p>( Sorry I'm bad at drawing ).\nAnd the same is done for the second vector ( in this case a again ) using the highest two pairs ( so 00 00 ) and filling the missing spaces.</p>\n\n<p>I thought that _mm256_shuffle_pd would work the same way. So if I wanted the first double I would have to move the 00 space and the 01 space to construct it correctly.</p>\n\n<p>For example:</p>\n\n<pre><code>__m256d a = _mm256_load_pd(&amp;b[0]);\na = _mm256_shuffle_pd(a, a, 0b01000100);\n_mm256_store_pd(&amp;b[0], a);\n// 1.12 1.12 4.44 3.33\n</code></pre>\n\n<p>I would have expected this to output { 1.12, 1.12, 3.33, 3.33 }.\nIn my head, I'm taking 00 01 ( 1.12 ) and 00 01 { 3.33 } from the first vector and the same from the second with it being the same vector and all.</p>\n\n<p>I've tried many combinations for the control mask and I just can't wrap my head around how this is used nor was I able to find somewhere where it was explained in a way I would understand.</p>\n\n<p>So my question is: How does _mm256_shuffle_pd work? And how would I get the same result as _mm_shuffle_ps(a, a, _MM_SHUFFLE(3, 0, 2, 1)) with four doubles and a shuffle ( if at all possible)?</p>\n"}, {"tags": ["c++", "arrays", "dev-c++"], "comments": [{"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 6, "creation_date": 1533729636, "post_id": 51746157, "comment_id": 90452005, "body": "You can <code>delete</code> only something that has been dynamically allocated by <code>new</code>, which is not your case."}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1533729662, "post_id": 51746157, "comment_id": 90452016, "body": "There is nothing to delete there. It\u2019s a char array which has its memory allocated in the struct and cannot be separately freed. Also why use chat arrays and not <code>std::string</code>?"}, {"owner": {"reputation": 52, "user_id": 8641697, "user_type": "registered", "profile_image": "https://graph.facebook.com/1920639804928329/picture?type=large", "display_name": "Usman Ali", "link": "https://stackoverflow.com/users/8641697/usman-ali"}, "edited": false, "score": 0, "creation_date": 1533729927, "post_id": 51746157, "comment_id": 90452199, "body": "I want to delete the data I am writting into student st[2] in case 1. I want to delete that in case 5"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 1, "creation_date": 1533730287, "post_id": 51746157, "comment_id": 90452411, "body": "What do you mean by <i>&quot;delete the data&quot;</i>?"}, {"owner": {"reputation": 3687, "user_id": 2509078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ZV5ER.jpg?s=128&g=1", "display_name": "Blacktempel", "link": "https://stackoverflow.com/users/2509078/blacktempel"}, "edited": false, "score": 1, "creation_date": 1533730533, "post_id": 51746157, "comment_id": 90452590, "body": "Use <a href=\"https://en.cppreference.com/w/cpp/string/byte/memset\" rel=\"nofollow noreferrer\"><code>memset</code></a>."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "reply_to_user": {"reputation": 3687, "user_id": 2509078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ZV5ER.jpg?s=128&g=1", "display_name": "Blacktempel", "link": "https://stackoverflow.com/users/2509078/blacktempel"}, "edited": false, "score": 0, "creation_date": 1533730751, "post_id": 51746157, "comment_id": 90452778, "body": "@Blacktempel or <a href=\"http://coliru.stacked-crooked.com/a/ce85dd52c96ec08c\" rel=\"nofollow noreferrer\"><code>std::fill(std::begin(name), std::end(name), &#39;\\0&#39;);</code></a>"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 5295, "user_id": 2513200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3d4b041c512a4e708a42494eb465b40f?s=128&d=identicon&r=PG", "display_name": "Hulk", "link": "https://stackoverflow.com/users/2513200/hulk"}, "edited": false, "score": 0, "creation_date": 1533732753, "post_id": 51746157, "comment_id": 90454153, "body": "@Hulk That is not a duplicate. They are asking quite different things."}], "answers": [{"comments": [{"owner": {"reputation": 52, "user_id": 8641697, "user_type": "registered", "profile_image": "https://graph.facebook.com/1920639804928329/picture?type=large", "display_name": "Usman Ali", "link": "https://stackoverflow.com/users/8641697/usman-ali"}, "edited": false, "score": 0, "creation_date": 1533730659, "post_id": 51746422, "comment_id": 90452705, "body": "can you please recommend me what code I should change to accomplish the task. I want to delete the data I am writting in case 1 in student st[2]."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 52, "user_id": 8641697, "user_type": "registered", "profile_image": "https://graph.facebook.com/1920639804928329/picture?type=large", "display_name": "Usman Ali", "link": "https://stackoverflow.com/users/8641697/usman-ali"}, "edited": false, "score": 1, "creation_date": 1533730957, "post_id": 51746422, "comment_id": 90452917, "body": "@UsmanAli can you please say what you mean with &quot;delete the data&quot;? The thing is <code>delete</code> has a specific meaning in C++ which is not applicable in your case. You dont need to / cannot <code>delete</code> any data (as this answer correctly explains), but maybe you want something else that can be done..."}, {"owner": {"reputation": 52, "user_id": 8641697, "user_type": "registered", "profile_image": "https://graph.facebook.com/1920639804928329/picture?type=large", "display_name": "Usman Ali", "link": "https://stackoverflow.com/users/8641697/usman-ali"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533731072, "post_id": 51746422, "comment_id": 90453013, "body": "@user463035818 I am writting data in case 1 using   cin&gt;&gt;st[count].name; and   cin&gt;&gt;st[count].id;         I basically want to delete them in case 5 if possible."}, {"owner": {"reputation": 2364, "user_id": 8349252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/224zf.png?s=128&g=1", "display_name": "Kaldrr", "link": "https://stackoverflow.com/users/8349252/kaldrr"}, "reply_to_user": {"reputation": 52, "user_id": 8641697, "user_type": "registered", "profile_image": "https://graph.facebook.com/1920639804928329/picture?type=large", "display_name": "Usman Ali", "link": "https://stackoverflow.com/users/8641697/usman-ali"}, "edited": false, "score": 2, "creation_date": 1533731083, "post_id": 51746422, "comment_id": 90453021, "body": "@UsmanAli if by &#39;delete the data&#39; you mean &#39;I want the string to be empty&#39;, when using <code>std::string</code> you can use <code>std::string::clear</code>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 52, "user_id": 8641697, "user_type": "registered", "profile_image": "https://graph.facebook.com/1920639804928329/picture?type=large", "display_name": "Usman Ali", "link": "https://stackoverflow.com/users/8641697/usman-ali"}, "edited": false, "score": 0, "creation_date": 1533731210, "post_id": 51746422, "comment_id": 90453109, "body": "@UsmanAli &quot;I basically want to delete them in case 5 if possible&quot; and what do you mean with &quot;delete them&quot; ? You want if you print the name on the screen that a blank string gets printed?"}, {"owner": {"reputation": 52, "user_id": 8641697, "user_type": "registered", "profile_image": "https://graph.facebook.com/1920639804928329/picture?type=large", "display_name": "Usman Ali", "link": "https://stackoverflow.com/users/8641697/usman-ali"}, "edited": false, "score": 0, "creation_date": 1533731267, "post_id": 51746422, "comment_id": 90453140, "body": "@Kaldrr but how do I first of all convert name and id into std::string so that I can later clear them"}, {"owner": {"reputation": 52, "user_id": 8641697, "user_type": "registered", "profile_image": "https://graph.facebook.com/1920639804928329/picture?type=large", "display_name": "Usman Ali", "link": "https://stackoverflow.com/users/8641697/usman-ali"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533731357, "post_id": 51746422, "comment_id": 90453203, "body": "@user463035818 yes after delete if I print name or id it returns an empty string"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 52, "user_id": 8641697, "user_type": "registered", "profile_image": "https://graph.facebook.com/1920639804928329/picture?type=large", "display_name": "Usman Ali", "link": "https://stackoverflow.com/users/8641697/usman-ali"}, "edited": false, "score": 0, "creation_date": 1533731872, "post_id": 51746422, "comment_id": 90453562, "body": "@UsmanAli then please dont call it delete, because you really dont need to <code>delete</code> anything, you just have to assign an empty string"}], "tags": [], "owner": {"reputation": 2364, "user_id": 8349252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/224zf.png?s=128&g=1", "display_name": "Kaldrr", "link": "https://stackoverflow.com/users/8349252/kaldrr"}, "is_accepted": false, "score": 2, "last_activity_date": 1533730274, "creation_date": 1533730274, "answer_id": 51746422, "question_id": 51746157, "link": "https://stackoverflow.com/questions/51746157/deleting-an-array-element-declared-in-struct-c/51746422#51746422", "title": "Deleting an array element declared in struct c++", "body": "<p>There are 2 main problems in your code.</p>\n\n<pre><code>cin&gt;&gt;st[count].name\n</code></pre>\n\n<p>You're filling the array with user input, but the array can only hold 20 elements (and the last one must be a null terminator), if user inputs text with more then 19 elements, your program will result in undefined behavior.</p>\n\n<p>Later, you're using</p>\n\n<pre><code>delete st[count].name\n</code></pre>\n\n<p>You're using <code>delete</code> on an array that is allocated on the stack, which is undefined behavior again, you would only need to use <code>delete</code> if you alocate an object using operator <code>new</code>, also you should use <code>delete[]</code> instead of <code>delete</code> for arrays.</p>\n\n<p>The easiest fix to your program is changing <code>char name[20]</code> to <code>std::string</code>, <code>std::string</code> will resize itself to adapt to the text that it's holding dynamicly, while also taking care of clearning memory after itself, so you don't have to worry about that, later on it also has many useful methods that you may find useful, you can read more about <code>std::string</code>.</p>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/string/basic_string\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/string/basic_string</a></p>\n"}], "owner": {"reputation": 52, "user_id": 8641697, "user_type": "registered", "profile_image": "https://graph.facebook.com/1920639804928329/picture?type=large", "display_name": "Usman Ali", "link": "https://stackoverflow.com/users/8641697/usman-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1533730274, "creation_date": 1533729510, "question_id": 51746157, "link": "https://stackoverflow.com/questions/51746157/deleting-an-array-element-declared-in-struct-c", "title": "Deleting an array element declared in struct c++", "body": "<p>I want to delete the array elements declared under student struct. I have only included parts of the code to reduce confusion.Please find the code below for the two relevant cases:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;conio.h&gt;\nusing namespace std;\nstruct student\n{\nchar name[20];\nint id;\n\n};\nstruct teacher\n{\nchar name[20];\nint id;\n\n};\n\nint main()\n{\n            case 1:\n                cout&lt;&lt;\"\\t\\t\\t*********enter record**********\"&lt;&lt;endl;\n                student st[2];\n                for(int count=0; count&lt;2;count++)\n                  {\n                    cout&lt;&lt;\"\\t\\t\\t\\tenter student \"&lt;&lt;count&lt;&lt;\" name\"&lt;&lt;endl;\n                    cin&gt;&gt;st[count].name;\n                    cout&lt;&lt;\"\\t\\t\\t\\tenter student \"&lt;&lt;count&lt;&lt;\" id\"&lt;&lt;endl;\n                    cin&gt;&gt;st[count].id;\n                  }\n                break; \n\n            case 5:\n                cout&lt;&lt;\"\\t\\t\\t*********delete record********\"&lt;&lt;endl;\n                for(int count=0;count&lt;10;count++)\n                {\n                    delete st[count].name;\n                }    \n                break;     \n\n}\n</code></pre>\n\n<p>As seen in case 5 I am trying to delete the elements within the array using delete st[count].name; </p>\n\n<p>I want to delete the elements of name and id in the delete case. However using delete st[count].name gives me a <strong>[Warning] Deleting array</strong> . And when I run the program it gives me a <strong>Program Recieved a signal SIGTRAP, trace/breakpoint trap</strong>. I am a beginner in c++ please help how I can delete the elements stored in these array. Thanks</p>\n"}, {"tags": ["c++", "templates", "casting", "void-pointers"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 3, "creation_date": 1533729607, "post_id": 51746091, "comment_id": 90451992, "body": "a <code>void*</code> is just a <code>void*</code>, even if you make a cast like in <code>void* p = (Base*)(new Derived());</code> its still a <code>void*</code>. The question in your title makes no sense. Why do you think you need to use raw void pointers in the first place? (maybe this information is somewhere in your question, but i have to admit i got lost somewhere in the middle ;)"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533729960, "post_id": 51746091, "comment_id": 90452212, "body": "btw the point where i got lost is: &quot;I need a way to cast to the base correctly. &quot; there is nothing special you have to do, you can simply <code>Base* ptr = new Derived();</code>... no need for any <code>void*</code>... I have the feeling that you got stuck in solving a problem where there maybe is no problem at all. Can you explain what you actually want to achieve by this wild casting? (see also <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">xy</a>)"}, {"owner": {"reputation": 97, "user_id": 10039628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e8e19709bdca14c3b0b0463d82958b?s=128&d=identicon&r=PG&f=1", "display_name": "Phi", "link": "https://stackoverflow.com/users/10039628/phi"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533729966, "post_id": 51746091, "comment_id": 90452218, "body": "@user463035818 yes a <code>void*</code> is a <code>void*</code>, but I know for a fact that it points to a memory location which houses a class derived from <code>Base</code>, I just don&#39;t know which derived class in particular (or not directly).  I&#39;m using raw void pointers because I need to read text files with class names and instantiate them, but don&#39;t know what the type will be at compile time, in fact the type may not exist at compile time (it&#39;s a library) it might be a derived type that is created in the program that uses this DLL.  The only type that I am aware of that can store an arbitrary class is <code>void*</code>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533730050, "post_id": 51746091, "comment_id": 90452267, "body": "if the types share the same base, then you (typically) dont need to know what is their actual type. All you need to know is that they share the same base class and access them via pointers to base"}, {"owner": {"reputation": 97, "user_id": 10039628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e8e19709bdca14c3b0b0463d82958b?s=128&d=identicon&r=PG&f=1", "display_name": "Phi", "link": "https://stackoverflow.com/users/10039628/phi"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533730292, "post_id": 51746091, "comment_id": 90452417, "body": "If it was a void* that pointed to the base, this wouldn&#39;t be an issue.  It points to the derived class, and casting directly to a <code>Base*</code> results in the vtable being misaligned"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533730483, "post_id": 51746091, "comment_id": 90452557, "body": "imho the problem is that in your question it is not clear what code is part of the problem and what is part of your solution (eg why using <code>void*</code> in the first place?). I think it needs an edit to be more clear. Maybe its just me, i mean you already got an answer..."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 3, "creation_date": 1533730786, "post_id": 51746091, "comment_id": 90452799, "body": "If you type-erase type, it seems strange to want to retrieve erased type. You probably want to do &quot;generic&quot; action on it instead which can be stored with the erasure."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1533731156, "post_id": 51746091, "comment_id": 90453072, "body": "If you put a <code>Derived *</code> in a box, you can only get a <code>Derived *</code> out of the box. Once you have the <code>Derived *</code>, you can perform whatever implicit conversion you want to get to a <code>Base *</code>"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 10039628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e8e19709bdca14c3b0b0463d82958b?s=128&d=identicon&r=PG&f=1", "display_name": "Phi", "link": "https://stackoverflow.com/users/10039628/phi"}, "edited": false, "score": 1, "creation_date": 1533730619, "post_id": 51746325, "comment_id": 90452664, "body": "I&#39;m not sure if <code>reinterpret_cast</code> is at all what I want, it seems that I likely need <code>dynamic_cast</code>.  but neither of those solve the issue.  the C style casts work fine, and none of the C++ ones use runtime information as far as I am aware?  decltype seems promising, I&#39;ll look into it and see if it will let me do what I need somehow"}, {"owner": {"reputation": 14960, "user_id": 3214872, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/NJBvG.jpg?s=128&g=1", "display_name": "GPhilo", "link": "https://stackoverflow.com/users/3214872/gphilo"}, "edited": false, "score": 0, "creation_date": 1533730637, "post_id": 51746325, "comment_id": 90452682, "body": "From the description of the expected usage, I think the OP wants something different: <i>&quot;if e.g. a user inputs &quot;Class1&quot;, a new instance of Class1 will be instantiated.&quot;</i>. Seems to me that the type resolution needs to be done at runtime, so I don&#39;t think <code>decltype</code> will help here."}, {"owner": {"reputation": 97, "user_id": 10039628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e8e19709bdca14c3b0b0463d82958b?s=128&d=identicon&r=PG&f=1", "display_name": "Phi", "link": "https://stackoverflow.com/users/10039628/phi"}, "reply_to_user": {"reputation": 14960, "user_id": 3214872, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/NJBvG.jpg?s=128&g=1", "display_name": "GPhilo", "link": "https://stackoverflow.com/users/3214872/gphilo"}, "edited": false, "score": 0, "creation_date": 1533730752, "post_id": 51746325, "comment_id": 90452782, "body": "@GPhilo,  The core problem is that casting a <code>Derived*</code> to a <code>Base*</code> changes the actual integer value of the pointer, but casting a <code>Derived*</code> to a <code>void*</code> to a <code>Base*</code> does not.  I just can&#39;t seem to get all the required information into a function at the same time."}, {"owner": {"reputation": 14960, "user_id": 3214872, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/NJBvG.jpg?s=128&g=1", "display_name": "GPhilo", "link": "https://stackoverflow.com/users/3214872/gphilo"}, "reply_to_user": {"reputation": 97, "user_id": 10039628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e8e19709bdca14c3b0b0463d82958b?s=128&d=identicon&r=PG&f=1", "display_name": "Phi", "link": "https://stackoverflow.com/users/10039628/phi"}, "edited": false, "score": 1, "creation_date": 1533731019, "post_id": 51746325, "comment_id": 90452975, "body": "@Phi tbh, given your expected use I&#39;d consider moving away from void pointers altogether and explore options like C++17 <code>std::any</code> (or its boost equivalent that you can us with older C++ versions). The problem with <code>void*</code> is that they don&#39;t carry along any information about what type they originally were, more powerful types may give you what you need."}, {"owner": {"reputation": 69264, "user_id": 256138, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ed9e8c0ff767e38f8fade11f5af00a45?s=128&d=identicon&r=PG", "display_name": "rubenvb", "link": "https://stackoverflow.com/users/256138/rubenvb"}, "reply_to_user": {"reputation": 97, "user_id": 10039628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e8e19709bdca14c3b0b0463d82958b?s=128&d=identicon&r=PG&f=1", "display_name": "Phi", "link": "https://stackoverflow.com/users/10039628/phi"}, "edited": false, "score": 0, "creation_date": 1533731273, "post_id": 51746325, "comment_id": 90453146, "body": "@Phi <code>dynamic_cast&lt;void*&gt;</code> can change the &quot;value&quot; of the pointer: the resulting pointer is guaranteed to point to the most derived object. If there is multiple inheritance involved, if say, you cast from a pointer to the second base class of the actual object to <code>void*</code>, you will change the pointer &quot;value&quot;."}, {"owner": {"reputation": 97, "user_id": 10039628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e8e19709bdca14c3b0b0463d82958b?s=128&d=identicon&r=PG&f=1", "display_name": "Phi", "link": "https://stackoverflow.com/users/10039628/phi"}, "reply_to_user": {"reputation": 69264, "user_id": 256138, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ed9e8c0ff767e38f8fade11f5af00a45?s=128&d=identicon&r=PG", "display_name": "rubenvb", "link": "https://stackoverflow.com/users/256138/rubenvb"}, "edited": false, "score": 0, "creation_date": 1533731570, "post_id": 51746325, "comment_id": 90453347, "body": "@rubenvb that&#39;s actually really useful.  is there a way to do a void* cast that instead gives the memory address of the &quot;least derived&quot; object? (I realize that doesn&#39;t always have a meaningful interpretation with multiple inheritance)"}, {"owner": {"reputation": 97, "user_id": 10039628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e8e19709bdca14c3b0b0463d82958b?s=128&d=identicon&r=PG&f=1", "display_name": "Phi", "link": "https://stackoverflow.com/users/10039628/phi"}, "reply_to_user": {"reputation": 14960, "user_id": 3214872, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/NJBvG.jpg?s=128&g=1", "display_name": "GPhilo", "link": "https://stackoverflow.com/users/3214872/gphilo"}, "edited": false, "score": 0, "creation_date": 1533731716, "post_id": 51746325, "comment_id": 90453448, "body": "@GPhilo, you&#39;re probably right.  It&#39;s just frustrating to throw away such a large section of code that does everything else I need perfectly.   I&#39;ll look into std::any,  I don&#39;t think there&#39;s a way for me to finagle decltype into  making this work."}, {"owner": {"reputation": 14960, "user_id": 3214872, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/NJBvG.jpg?s=128&g=1", "display_name": "GPhilo", "link": "https://stackoverflow.com/users/3214872/gphilo"}, "edited": false, "score": 0, "creation_date": 1533731842, "post_id": 51746325, "comment_id": 90453538, "body": "Well if you&#39;re feeling brave you can always write your own &quot;MyVoidPtr&quot; class that keeps track of what type it was when created/assigned and internally stores to void*. Then where you need to know the type, you get it from your class&#39;s instance"}, {"owner": {"reputation": 97, "user_id": 10039628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e8e19709bdca14c3b0b0463d82958b?s=128&d=identicon&r=PG&f=1", "display_name": "Phi", "link": "https://stackoverflow.com/users/10039628/phi"}, "edited": false, "score": 0, "creation_date": 1533731940, "post_id": 51746325, "comment_id": 90453595, "body": "I&#39;m gonna accept this answer because I don&#39;t think a perfect solution exists.  I have a giant mess of template factory methods, destruction methods and a bunch more,  everything else works great because for creation, destruction/deallocation, and most other things I only need the type of the object itself.  for casting I need the type of the object and the type to cast to, and the only way I can see to get it is a  virtual function template, which isn&#39;t a thing in c++.  Thanks for the help! &lt;3"}, {"owner": {"reputation": 69264, "user_id": 256138, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ed9e8c0ff767e38f8fade11f5af00a45?s=128&d=identicon&r=PG", "display_name": "rubenvb", "link": "https://stackoverflow.com/users/256138/rubenvb"}, "reply_to_user": {"reputation": 97, "user_id": 10039628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e8e19709bdca14c3b0b0463d82958b?s=128&d=identicon&r=PG&f=1", "display_name": "Phi", "link": "https://stackoverflow.com/users/10039628/phi"}, "edited": false, "score": 0, "creation_date": 1533731963, "post_id": 51746325, "comment_id": 90453618, "body": "@Phi Not if you don&#39;t know the type beforehand, because as you say, there&#39;s no definitive answer to that one so it would make little sense to pour that into a core language feature such as <code>dynamic_cast</code>. But if you know the base type you want to cast to, <code>dynamic_cast&lt;BaseType*&gt;</code> will do this job nicely. I&#39;m unsure if <code>static_cast&lt;BaseType*&gt;</code> will be sufficient (I would suppose so, but I supposed that for casting the other way down the inheritance chain and was surprised multiple inheritance got in the way so I won&#39;t state any false truths)."}, {"owner": {"reputation": 97, "user_id": 10039628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e8e19709bdca14c3b0b0463d82958b?s=128&d=identicon&r=PG&f=1", "display_name": "Phi", "link": "https://stackoverflow.com/users/10039628/phi"}, "reply_to_user": {"reputation": 14960, "user_id": 3214872, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/NJBvG.jpg?s=128&g=1", "display_name": "GPhilo", "link": "https://stackoverflow.com/users/3214872/gphilo"}, "edited": false, "score": 0, "creation_date": 1533732049, "post_id": 51746325, "comment_id": 90453686, "body": "@GPhilo I have that type of information, but its as e.g. a MyVoidPtr_Impl&lt;T&gt; and I only have a pointer to the parent class.  if I could call MyVoidPtr-&gt;Cast&lt;Base&gt;(), we&#39;d be gucci, but I don&#39;t know a way to do that"}], "tags": [], "owner": {"reputation": 8084, "user_id": 2896626, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd83959d7fe39c658d2e49cfecfe4b6?s=128&d=identicon&r=PG&f=1", "display_name": "Paul92", "link": "https://stackoverflow.com/users/2896626/paul92"}, "is_accepted": true, "score": 1, "last_activity_date": 1533731206, "last_edit_date": 1533731206, "creation_date": 1533730020, "answer_id": 51746325, "question_id": 51746091, "link": "https://stackoverflow.com/questions/51746091/how-to-correctly-cast-a-void-that-points-to-a-derived-class-to-a-void-that-poi/51746325#51746325", "title": "How to correctly cast a void* that points to a derived class to a void* that points to a base class at runtime", "body": "<p>First, I would suggest using C++ casts, rather than plain old C casts, such as <code>static_cast</code>, <code>reinterpret_cast</code>, <code>dynamic_cast</code> and <code>const_cast</code>. They are safer than the C type casts, since they do only one thing.</p>\n\n<p>Since you mention that you have a pointer to an object of the base/derived class you are trying to cast to, you can use <code>decltype</code>.</p>\n\n<p><code>decltype</code> is a C++11 specifier that yields the type of the variable passed as argument.</p>\n\n<p>So, you can use something like <code>reinterpret_cast&lt;decltype(base_pointer)&gt;(value)</code>.</p>\n\n<p>For further information, have a look at the following resources:</p>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/language/decltype\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/decltype</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/16687172/cast-a-value-using-decltype-is-it-possible\">Cast a value using decltype, is it possible?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/332030/when-should-static-cast-dynamic-cast-const-cast-and-reinterpret-cast-be-used\">When should static_cast, dynamic_cast, const_cast and reinterpret_cast be used?</a></p>\n\n<hr>\n\n<p><em>The discussions in the comments pointed that the initial question asked for a runtime approach, while <code>decltype</code> is compile time. Still, the above might be relevant, so I will add some thoughts on runtime approaches.</em></p>\n\n<p>The C++ template system and type deduction mechanisms run at compile time. If you want to handle a dynamic type system at runtime (i.e. the user input determining the types used), you have to use something like a factory method.</p>\n\n<p>However, it might be worth considering if there is a better approach to this.</p>\n"}], "owner": {"reputation": 97, "user_id": 10039628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e8e19709bdca14c3b0b0463d82958b?s=128&d=identicon&r=PG&f=1", "display_name": "Phi", "link": "https://stackoverflow.com/users/10039628/phi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 51746325, "answer_count": 1, "score": 0, "last_activity_date": 1533731206, "creation_date": 1533729307, "last_edit_date": 1533731050, "question_id": 51746091, "link": "https://stackoverflow.com/questions/51746091/how-to-correctly-cast-a-void-that-points-to-a-derived-class-to-a-void-that-poi", "title": "How to correctly cast a void* that points to a derived class to a void* that points to a base class at runtime", "body": "<p>I am currently working on some code that needs to allow semi-arbitrary c++ classes to be instantiated at runtime, meaning if e.g. a user inputs \"Class1\", a new instance of <code>Class1</code> will be instantiated.</p>\n\n<p>All of this is necessarily stored in void* form because the classes do not necessarily share any base classes (and I'd like to support primitives as well, but I'm not currently doing so)</p>\n\n<p>The void* are cast to the correct type upon use, but the issue arises in that I'm also allowing them to be used as a pointer to a base class.</p>\n\n<p>e.g.</p>\n\n<pre><code>void* p = new Derived();\n((Base*)p)-&gt;someVirtualFunction();\n</code></pre>\n\n<p>I need a way to cast to the base correctly.  obviously if I had the type easily accessible, I could just:</p>\n\n<pre><code>void* p = (Base*)(new Derived());\n((Base*)p)-&gt;someVirtualFunction();\n</code></pre>\n\n<p>and there wouldn't be an issue.</p>\n\n<p>However I don't have the type that easily accessible.</p>\n\n<p>I do have an infrastructure in place:</p>\n\n<pre><code>class Type {};\n\ntemplate&lt;typename T&gt;\nclass TypeImpl : public Type {};\n</code></pre>\n\n<p>in the actual code, these have many functions which are not relevant to the problem at hand.</p>\n\n<p>I have access to a <code>Type*</code> which points to a <code>TypeImpl&lt;Base&gt;</code> and one which points to a <code>TypeImpl&lt;Derived&gt;</code></p>\n\n<p>I'm attempting to find a way to use these to cast the pointer correctly\ne.g.</p>\n\n<pre><code>class Type {\n    void* cast(Type* type_of_p, void* p)=0;\n\n    template&lt;typename C&gt;\n    void* castTo(void* p)=0;\n};\n\ntemplate&lt;typename T&gt;\nclass TypeImpl : public Type {\n    void* cast(Type* type_of_p, void* p){\n        return type_of_p-&gt;castTo&lt;T&gt;(p);\n    }\n\n    template&lt;typename C&gt;\n    void* castTo(void* p){\n        return ((C*) ((T*) p));\n    }\n};\n</code></pre>\n\n<p>but without virtual function templates, I can't find a way to do this.</p>\n\n<p>As for other solutions, my closest thought is maybe some kind of hashmap of hashmaps of function pointers that indexes on <code>std::type_index</code> but I haven't been able to get that to work either.</p>\n\n<p>Is this possible, and if so, how might I go about it?</p>\n\n<p>EDIT TO HOPEFULLY CLARIFY:</p>\n\n<p>I have a <code>void* p</code> that points to a <code>Derived</code> I need to cast it to a <code>Base*</code>\n(e.g. <code>void* p = new Derived();</code>)</p>\n\n<p><code>(Base*)p</code> or any type of cast that does not use runtime information is not valid as the vtable is misaligned.</p>\n\n<p>I need something like:\n<code>(Base*)(Derived*)p</code> (or equivalent c++ casts) but I don't know which derived class it is.</p>\n\n<p>I'm not sure if I'm just wording this very poorly or if there's some mistake I'm making but that's the core issue.</p>\n"}, {"tags": ["python", "c++", "opencv", "raspberry-pi", "disparity-mapping"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1533739159, "post_id": 51745946, "comment_id": 90458650, "body": "Pick one language.  The <b>best way</b> may be different for the different languages.  Also, please clarify <i>best</i>: least space, highest efficiency, easiest to understand, easiest to develop and get working, easiest to maintain?  Many of these are orthogonal,  ex. see the time / space trade off in computing."}], "answers": [{"comments": [{"owner": {"reputation": 867, "user_id": 5942797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wo0xh.png?s=128&g=1", "display_name": "Scott Mudge", "link": "https://stackoverflow.com/users/5942797/scott-mudge"}, "edited": false, "score": 1, "creation_date": 1533914785, "post_id": 51746579, "comment_id": 90536667, "body": "I just saw you changed the question to require running on a Raspberri Pi. This will not be possible for any real-time applications. You will, at best, get 0.25-0.5 FPS for any CPU-based disparity calculation, and that&#39;s being generous."}, {"owner": {"reputation": 336, "user_id": 6250449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/565ada241c45a90ba84c2fea0f0d87e3?s=128&d=identicon&r=PG&f=1", "display_name": "BigZee", "link": "https://stackoverflow.com/users/6250449/bigzee"}, "edited": false, "score": 0, "creation_date": 1536514516, "post_id": 51746579, "comment_id": 91442044, "body": "thanks but i understood that i need a powerful cpu and i got a TX-1 and hopefully it will work now"}], "tags": [], "owner": {"reputation": 867, "user_id": 5942797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wo0xh.png?s=128&g=1", "display_name": "Scott Mudge", "link": "https://stackoverflow.com/users/5942797/scott-mudge"}, "is_accepted": true, "score": 2, "last_activity_date": 1533730760, "creation_date": 1533730760, "answer_id": 51746579, "question_id": 51745946, "link": "https://stackoverflow.com/questions/51745946/what-is-the-best-wayalgorithim-or-function-of-generating-a-decent-disparity-ma/51746579#51746579", "title": "What is the best way(algorithim or function) of generating a decent disparity map in c++ or python for implementation on raspberry pi?", "body": "<p>Yes, but if you want anything reasonably fast or accurate, you'll want to use semi-global matching powered by CUDA: <a href=\"https://github.com/fixstars/libSGM\" rel=\"nofollow noreferrer\">https://github.com/fixstars/libSGM</a> . Using a library like this, you can get realtime disparity maps for images of ~640x480 pixels.</p>\n\n<p>The first step will be to calibrate your imaging system/stereo camera using OpenCV. There are many, many tutorials on this, but this is a good place to start: <a href=\"https://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html\" rel=\"nofollow noreferrer\">https://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html</a></p>\n\n<p>Then once calibrated and once your rectification matrices are created, you will need to rectify your incoming images so that the they are in a rectified coordinates, and any distortion due to the lenses or other defects in the optical system will be corrected for.</p>\n\n<p>Then use your desired disparity algorithm/library to generate a disparity map from this rectified pair. This will generally be between 128 and 256 disparity levels, the latter being less common. You can then convert this disparity map to a metric depth map by using cv::reprojectImageTo3D(). From here you can fuse the depth maps using any number of fusion or SLAM libraries, KinectFusion being one of the oldest and easiest to get into. In fact, it's been integrated into PCL.</p>\n"}], "owner": {"reputation": 336, "user_id": 6250449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/565ada241c45a90ba84c2fea0f0d87e3?s=128&d=identicon&r=PG&f=1", "display_name": "BigZee", "link": "https://stackoverflow.com/users/6250449/bigzee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "closed_date": 1533730845, "accepted_answer_id": 51746579, "answer_count": 1, "score": -1, "last_activity_date": 1533780165, "creation_date": 1533728818, "last_edit_date": 1533780165, "question_id": 51745946, "link": "https://stackoverflow.com/questions/51745946/what-is-the-best-wayalgorithim-or-function-of-generating-a-decent-disparity-ma", "closed_reason": "Not suitable for this site", "title": "What is the best way(algorithim or function) of generating a decent disparity map in c++ or python for implementation on raspberry pi?", "body": "<p>I am trying to do some distance calculations using stereo videos in realtime but there is no proper documentation available for disparity mapping for opencv3 and many of the old commands from opencv2 are not working on the latest versions. Is there any other way (library or algorithm) to do disparity mapping in c++ or python.</p>\n\n<p>I am trying to implement my code on a raspberry pi and performance is an issue for me. I know that c++ is much faster and relatively less processor intensive so I might use that but any help would be appreciated in this regard.</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 1, "creation_date": 1533727516, "post_id": 51745332, "comment_id": 90450607, "body": "The model contains the data. The view is the representation."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8183713"}, "reply_to_user": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1533727910, "post_id": 51745332, "comment_id": 90450865, "body": "I meant the model class has a method data where i can set the color. Should i modify here to set the color or just use alternatingcolor call. The problem is here i want just to highlight the group items and view does not have information about it which is a groupitem"}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1533728090, "post_id": 51745332, "comment_id": 90450992, "body": "I am sorry, I can&#39;t follow. What is a <i>method data</i>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8183713"}, "reply_to_user": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1533728688, "post_id": 51745332, "comment_id": 90451392, "body": "From QAbstractItemModel::data(const QModelIndex&amp; index, int role /*= Qt::DisplayRole*/) . Here you can use the index parameter and paint the background."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1533735020, "post_id": 51745332, "comment_id": 90455724, "body": "@vinaycool  I do not see that that is handled by the model, or if you want it to be handled you will have to create your own QTreeView."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1533735113, "post_id": 51745332, "comment_id": 90455788, "body": "@vinaycool <code>setAlternatingRowColors()</code> or <code>setAlternatingColors()</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8183713"}, "edited": false, "score": 0, "creation_date": 1533737943, "post_id": 51745332, "comment_id": 90457727, "body": "The problem with using setAlternatingRowColors() is it will color all the items in alternative manner, so i wont be able to highlight the groupitem or provide different color to the groupitems."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1533738912, "post_id": 51745332, "comment_id": 90458474, "body": "@vinaycool  then the only solution is that you create a class that inherits from QTreeView and overwrite some method that you paint, the solution is not in the delegate."}], "owner": {"user_type": "does_not_exist", "display_name": "user8183713"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1533727233, "creation_date": 1533726976, "last_edit_date": 1533727233, "question_id": 51745332, "link": "https://stackoverflow.com/questions/51745332/how-to-set-background-color-to-the-groupitem-in-qtreeview", "title": "How to set background color to the GroupItem in QTreeview?", "body": "<p>I have created a tree view. Here i would like to set the background color of the group item. \nMy implementation looks like this:</p>\n\n<pre><code>if (role == Qt::BackgroundRole &amp;&amp; isCategory(index)) {\n    QBrush lightGrayColor(Qt::lightGray);\n    return lightGrayColor;\n}\n</code></pre>\n\n<p>But the background of the icon is not colored.\n<a href=\"https://i.stack.imgur.com/7TMCn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7TMCn.png\" alt=\"enter image description here\"></a></p>\n\n<p>If i use QTreeview:: setAlternatingColors(true) it is coloring properly. But I want to achieve in the model. Should i use QitemDelegate::paint method or can be achieved in the model itself. Thank you</p>\n"}, {"tags": ["c++", "string", "c++11", "printing", "printf"], "comments": [{"owner": {"reputation": 2756, "user_id": 5114342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725caa4188def46b8c6cf9b09eff7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Aziuth", "link": "https://stackoverflow.com/users/5114342/aziuth"}, "edited": false, "score": 3, "creation_date": 1533727081, "post_id": 51745330, "comment_id": 90450298, "body": "Might I ask why you do not go with <code>cout</code>?"}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 5, "creation_date": 1533727160, "post_id": 51745330, "comment_id": 90450357, "body": "<code>getMessage1</code> has undefined behavior, you&#39;re returning a pointer to the string&#39;s data but it won&#39;t survive when the function ends."}, {"owner": {"reputation": 1356, "user_id": 2287458, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/dAyBK.jpg?s=128&g=1", "display_name": "Phil-ZXX", "link": "https://stackoverflow.com/users/2287458/phil-zxx"}, "reply_to_user": {"reputation": 2756, "user_id": 5114342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725caa4188def46b8c6cf9b09eff7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Aziuth", "link": "https://stackoverflow.com/users/5114342/aziuth"}, "edited": false, "score": 0, "creation_date": 1533727328, "post_id": 51745330, "comment_id": 90450469, "body": "@Aziuth Because I usually do sth like <code>%19s</code> to align the outputs. If that&#39;s possible with <code>cout</code> I am happy to change it."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 2, "creation_date": 1533727473, "post_id": 51745330, "comment_id": 90450567, "body": "@Phil-ZXX <a href=\"http://coliru.stacked-crooked.com/a/3f595191aa0fadbd\" rel=\"nofollow noreferrer\">Something like this?</a>"}, {"owner": {"reputation": 1356, "user_id": 2287458, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/dAyBK.jpg?s=128&g=1", "display_name": "Phil-ZXX", "link": "https://stackoverflow.com/users/2287458/phil-zxx"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1533727862, "post_id": 51745330, "comment_id": 90450841, "body": "@Borgleader Ah, nice. Is there a general aversion of <code>printf</code> versus <code>cout</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1073, "user_id": 8855783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3db067b033a034c53710b8d29e2cf36?s=128&d=identicon&r=PG&f=1", "display_name": "wdudzik", "link": "https://stackoverflow.com/users/8855783/wdudzik"}, "is_accepted": true, "score": 4, "last_activity_date": 1533727303, "creation_date": 1533727303, "answer_id": 51745437, "question_id": 51745330, "link": "https://stackoverflow.com/questions/51745330/convert-stdstring-to-const-char-for-printf-consumption/51745437#51745437", "title": "Convert std::string to const char* for printf Consumption", "body": "<p>The problem with getMessage1 is that you return pointer to local variable which is deleted as soon as you leave this function giving you dangling pointer.</p>\n\n<p>The simplest solution would be to make myString static if possible so its lifetime will be as long as the program itself.</p>\n\n<pre><code>const char* getMessage1() {\n    static std::string myString = \"SomeOutput\";\n    return myString.c_str();\n}\n\nint main() {\n    printf(\"#1: %s \\n\", getMessage1());         // prints #1: SomeOutput\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/K6k7Pw\" rel=\"nofollow noreferrer\">Link to working example on ideone</a></p>\n\n<p>For some more examples see <a href=\"https://stackoverflow.com/questions/19042552/returning-a-pointer-of-a-local-variable-c\">how to return pointer of local variable</a>.</p>\n"}], "owner": {"reputation": 1356, "user_id": 2287458, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/dAyBK.jpg?s=128&g=1", "display_name": "Phil-ZXX", "link": "https://stackoverflow.com/users/2287458/phil-zxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 51745437, "answer_count": 1, "score": 0, "last_activity_date": 1533727303, "creation_date": 1533726972, "question_id": 51745330, "link": "https://stackoverflow.com/questions/51745330/convert-stdstring-to-const-char-for-printf-consumption", "title": "Convert std::string to const char* for printf Consumption", "body": "<p>Let us consider the below code example. Basically, <code>getMessage1</code> (internally) creates an <code>std::string</code> which is meant to be returned and then printed via <code>printf</code>. How do I convert/cast/manipulate variable <code>myString</code> so that the output looks like the one from <code>getMessage2</code>? </p>\n\n<p>I am aware that <code>getMessage3</code> works, but it requires me to include <code>.c_str()</code> in every <code>printf</code> statement (and I'd like to avoid this extra <em>suffix</em>).</p>\n\n<pre><code>#include &lt;string&gt;\n\nconst char* getMessage1() {\n    std::string myString = \"SomeOutput\";\n    return myString.c_str();\n}\n\nconst char* getMessage2() {\n    return \"SomeOutput\"; \n}\n\nstd::string getMessage3() {\n    std::string myString = \"SomeOutput\";\n    return myString;\n}\n\nint main() {\n    printf(\"#1: %s \\n\", getMessage1());         // prints #1: \u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u00bf\u207f9\"w\n    printf(\"#2: %s \\n\", getMessage2());         // prints #2: SomeOutput\n    printf(\"#3: %s \\n\", getMessage3().c_str()); // prints #3: SomeOutput\n\n    return 0;\n}\n</code></pre>\n"}]