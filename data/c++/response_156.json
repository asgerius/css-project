[{"tags": ["c++", "floating-point"], "comments": [{"owner": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 1, "creation_date": 1515024045, "post_id": 48086830, "comment_id": 83148672, "body": "Since floating point typess are not held precisely there will rarely  be a round-trip to string and back."}, {"owner": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 0, "creation_date": 1515024200, "post_id": 48086830, "comment_id": 83148712, "body": "You could output a byte representation as a serialized form that would round-trip, but that would not be .meaningful to humans, too."}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 1, "creation_date": 1515024313, "post_id": 48086830, "comment_id": 83148741, "body": "<code>7.63918e-313</code> is out of range.  <code>std::numeric_limits&lt;double&gt;::min() = 2.22507e-308</code>."}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1515024829, "post_id": 48086830, "comment_id": 83148871, "body": "\u201cWe have found a positive double that is smaller than what the standard library claims is the smallest double.\u201d  NO!  The double your are using is no longer <i>exactly</i> representable as a double."}, {"owner": {"reputation": 842, "user_id": 1085128, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9798134a47d85c790e2ee0da92f66a9e?s=128&d=identicon&r=PG", "display_name": "mako", "link": "https://stackoverflow.com/users/1085128/mako"}, "edited": false, "score": 0, "creation_date": 1515025137, "post_id": 48086830, "comment_id": 83148960, "body": "No, look at the updated test code. (min &gt; ad &amp;&amp; ad &gt; 0) verifies. It&#39;s not even about representation."}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1515025337, "post_id": 48086830, "comment_id": 83149007, "body": "@mako Yes, you can compare two doubles, regardless of whether they are <i>exactly</i> representable or not.  If you are really so keen on having this value back, just read it as long double and narrow it down again: <code>double d = std::stold(&quot;7.63918e-313&quot;);</code>"}, {"owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 2, "creation_date": 1515030489, "post_id": 48086830, "comment_id": 83150107, "body": "@HenriMenke: Re: \u201cThe double your are using is no longer exactly representable as a double.\u201d That does not make any sense. If you have a <code>double</code>, the value of it is exactly representable as a <code>double</code>. It is itself an exact representation of its value."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 0, "creation_date": 1515040237, "post_id": 48086830, "comment_id": 83151995, "body": "@Dragonthoughts \u2014 floating-point values <b>are</b> represented precisely. <b>Real numbers</b> are not, because there are too many of them. It\u2019s possible to write conversions from floating-point to decimal text and back that will get back the original value. This problem was first solved about 50 years ago. Going the other way, string to floating-point to string and getting the original value, is not, in general, possible."}], "answers": [{"comments": [{"owner": {"reputation": 842, "user_id": 1085128, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9798134a47d85c790e2ee0da92f66a9e?s=128&d=identicon&r=PG", "display_name": "mako", "link": "https://stackoverflow.com/users/1085128/mako"}, "edited": false, "score": 0, "creation_date": 1515024776, "post_id": 48086966, "comment_id": 83148856, "body": "While this is very helpful, it does not solve my problem, nor C++&#39;s problem. Hmm... Is it possible that the double I had popping up in my data was a result of a random, out of bounds write, or a cosmic ray, and that it shouldn&#39;t be able to pop up during normal execution?"}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "reply_to_user": {"reputation": 842, "user_id": 1085128, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9798134a47d85c790e2ee0da92f66a9e?s=128&d=identicon&r=PG", "display_name": "mako", "link": "https://stackoverflow.com/users/1085128/mako"}, "edited": false, "score": 0, "creation_date": 1515024945, "post_id": 48086966, "comment_id": 83148898, "body": "@mako Your problem is limited by machine architecture.  Switch to <code>long double</code> and hope that it&#39;s longer than <code>double</code> or use a multiprecision library."}, {"owner": {"reputation": 842, "user_id": 1085128, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9798134a47d85c790e2ee0da92f66a9e?s=128&d=identicon&r=PG", "display_name": "mako", "link": "https://stackoverflow.com/users/1085128/mako"}, "edited": false, "score": 0, "creation_date": 1515026013, "post_id": 48086966, "comment_id": 83149163, "body": "This is not the answer. Exact representability has little to do with size. The number &quot;3&quot; has no exact representation in floating point either, but you&#39;ll still be able to map it back and forth between strings because the parsers are clever. Why do you think the documentation is talking about representability in decimal string notation? It&#39;s about representability in memory, I would guess. Decimal strings have no minimums. They can be as long and as detailed as they want.  Your supposed minimum decimal representable number also cannot be parsed by stod <a href=\"https://onlinegdb.com/Hk8fIgsmG\" rel=\"nofollow noreferrer\">onlinegdb.com/Hk8fIgsmG</a>"}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "reply_to_user": {"reputation": 842, "user_id": 1085128, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9798134a47d85c790e2ee0da92f66a9e?s=128&d=identicon&r=PG", "display_name": "mako", "link": "https://stackoverflow.com/users/1085128/mako"}, "edited": false, "score": 0, "creation_date": 1515026627, "post_id": 48086966, "comment_id": 83149279, "body": "@mako You&#39;re right, the second part of my answer was not really helpful.  I edited it to show a way to parse such a number as a double anyway."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1515026749, "post_id": 48086966, "comment_id": 83149307, "body": "For the record, 3 is pretty easy to represent. It can be tricky to compute exactly though."}, {"owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 3, "creation_date": 1515027756, "post_id": 48086966, "comment_id": 83149527, "body": "<code>std::numeric_limits&lt;double&gt;::min()</code> is not the minimum representable value (actually, that is zero, but it is not the minimum representable positive value either). It is the minimum positive <b>normalized</b> value. There may be subnormal values below it. For IEEE-754 64-bit binary floating-point, the smallest positive value is about 4.94065645841247e-324."}, {"owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 842, "user_id": 1085128, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9798134a47d85c790e2ee0da92f66a9e?s=128&d=identicon&r=PG", "display_name": "mako", "link": "https://stackoverflow.com/users/1085128/mako"}, "edited": false, "score": 0, "creation_date": 1515029535, "post_id": 48086966, "comment_id": 83149903, "body": "@mako: 3 is exactly represented in IEEE-754 64-bit binary with the bits 0x4008000000000000."}, {"owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1515030303, "post_id": 48086966, "comment_id": 83150062, "body": "(I should have said that zero is the minimum in absolute value, rather than minimum value. The minimum representable value is actually -\u221e.)"}], "tags": [], "owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "is_accepted": false, "score": 2, "last_activity_date": 1515026854, "last_edit_date": 1515026854, "creation_date": 1515024626, "answer_id": 48086966, "question_id": 48086830, "link": "https://stackoverflow.com/questions/48086830/stdstod-throws-out-of-range-error-for-a-string-that-should-be-valid/48086966#48086966", "title": "std::stod throws out_of_range error for a string that should be valid", "body": "<p>The value you are trying to read as a double, <code>7.63918e-313</code>, is smaller than the minimal value that is representable by a double on your architecture.  On my architecture this is <code>2.22507e-308</code> and can be obtained using <code>std::numeric_limits&lt;double&gt;::min()</code>.</p>\n\n<p>From the standard: <a href=\"http://eel.is/c++draft/string.conversions#6\" rel=\"nofollow noreferrer\">[string.conversions]</a></p>\n\n<blockquote>\n  <p>Throws out_\u00adof_\u00adrange if <code>strtof</code>, <code>strtod</code>, or <code>strtold</code> sets <code>errno</code> to <code>ERANGE</code> or if the converted value is outside the range of representable values for the return type.</p>\n</blockquote>\n\n<p>That is to say, mapping doubles back on forth to string is possible using <code>std::to_string</code> and <code>std::stod</code> (or stringstreams) given that they are representable.</p>\n\n<hr>\n\n<p>Instead you could use <a href=\"http://www.boost.org/libs/lexical_cast/\" rel=\"nofollow noreferrer\">Boost.Lexical_Cast</a> for parsing which does not seem to have these limitations.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;boost/lexical_cast.hpp&gt;\n\nint main() {\n    double d = boost::lexical_cast&lt;double&gt;(\"7.63918e-313\");\n    std::cout &lt;&lt; d &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p><kbd><a href=\"https://wandbox.org/permlink/qPyrxqhVZMd2QhTm\" rel=\"nofollow noreferrer\">Live example</a></kbd></p>\n\n<p>Another alternative is <a href=\"https://ciere.com/cppnow15/x3_docs/\" rel=\"nofollow noreferrer\">Boost.Spirit</a>.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;boost/spirit/home/x3.hpp&gt;\n\nnamespace x3 = boost::spirit::x3;\n\nint main() {\n    double d = 0;\n    std::string input = \"7.63918e-313\";\n    x3::parse(input.begin(), input.end(), x3::double_, d);\n    std::cout &lt;&lt; d &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p><kbd><a href=\"https://wandbox.org/permlink/DvFMs8TJMdjXyXwv\" rel=\"nofollow noreferrer\">Live example</a></kbd></p>\n"}, {"tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 2, "last_activity_date": 1515030302, "last_edit_date": 1515030302, "creation_date": 1515026041, "answer_id": 48087119, "question_id": 48086830, "link": "https://stackoverflow.com/questions/48086830/stdstod-throws-out-of-range-error-for-a-string-that-should-be-valid/48087119#48087119", "title": "std::stod throws out_of_range error for a string that should be valid", "body": "<p>According to the specification of <code>strtod</code> (which is referred from the specification of <code>std::strod</code>), if the conversion <em>underflows</em>, the function is allowed, but not required to set <code>errno</code> to <code>ERANGE</code>. It is implementation-defined whether <code>errno</code> is set in this case.</p>\n\n<p>In your example the conversion does underflow. Apparently, in your implementation <code>strtod</code> sets <code>errno</code> to <code>ERANGE</code> and <code>std::stod</code> unconditionally throws <code>std::out_of_range</code> when it sees that <code>ERANGE</code> in <code>errno</code>.</p>\n\n<p>In a different implementation <code>strtod</code> might not set <code>errno</code> to <code>ERANGE</code> in this case, and <code>std::stod</code> would not throw.</p>\n\n<p>Basically, C++ standard library is not guaranteed to properly convert underflowing values. Even if <code>strtod</code> decides not to set <code>errno</code>, it is still allowed to return the smallest normalized value as a result in this case, instead of your original value.</p>\n"}, {"comments": [{"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1537394963, "post_id": 48087390, "comment_id": 91773395, "body": "I quoted your answer <a href=\"https://stackoverflow.com/a/52414829/1708801\">here</a>"}, {"owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1537402700, "post_id": 48087390, "comment_id": 91775055, "body": "@ShafikYaghmour: Sure, that is fine. When I saw that question, it rang a bell; I knew I had written this previously. But I did not have time to look it up before leaving the house. I am glad it was correctly cross-referenced."}], "tags": [], "owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 6, "last_activity_date": 1530212817, "last_edit_date": 1530212817, "creation_date": 1515028335, "answer_id": 48087390, "question_id": 48086830, "link": "https://stackoverflow.com/questions/48086830/stdstod-throws-out-of-range-error-for-a-string-that-should-be-valid/48087390#48087390", "title": "std::stod throws out_of_range error for a string that should be valid", "body": "<h1>Converting \u201c7.63918e-313\u201d</h1>\n\n<p>The C++ standard allows conversions of strings to <code>double</code> to report underflow if the result is in the subnormal range even though it is representable.</p>\n\n<p>7.63918\u202210<sup>-313</sup> is within the range of <code>double</code>, but it is in the subnormal range. The C++ standard says <code>stod</code> calls <code>strtod</code> and then defers to the C standard to define <code>strtod</code>. The C standard indicates that <code>strtod</code> may underflow, about which it says \u201cThe result underflows if the magnitude of the mathematical result is so small that the mathematical result cannot be represented, without extraordinary roundoff error, in an object of the specified type.\u201d That is awkward phrasing, but it refers to the rounding errors that occur when subnormal values are encountered. (Subnormal values are subject to larger relative errors than normal values, so their rounding errors might be said to be extraordinary.)</p>\n\n<p>Thus, a C++ implementation is allowed by the C++ standard to underflow for subnormal values even though they are representable.</p>\n\n<h1>Converting std::numeric_limits::min()</h1>\n\n<p>Regarding your observation that <code>std::numeric_limits&lt;double&gt;::min()</code> \u201ccannot be parsed\u201d either (I presume you mean it also reports underflow), this may be due to the fact that you converted <code>std::numeric_limits&lt;double&gt;::min()</code> to a string containing a decimal numeral, and that decimal numeral was not an exact representation of <code>std::numeric_limits&lt;double&gt;::min()</code>. If it was rounded down, it is slightly less than <code>min()</code>, and hence it is also in the subnormal range. Thus, attempting to convert that decimal numeral back to a <code>double</code> may correctly report it is below the normal range.</p>\n\n<h1>std::numeric_limits::min() is not the minimum double</h1>\n\n<p>Regarding your observation that <code>std::numeric_limits&lt;double&gt;::min()</code> is not the minimum <code>double</code>, that is correct. <code>std::numeric_limits&lt;double&gt;::min()</code> is specified by the C++ standard to be the minimum positive normal value. There may be subnormal values below it.</p>\n\n<h1>Normal and subnormal values</h1>\n\n<p>For IEEE-754 64-bit binary floating-point, the normal range is from 2<sup>-1022</sup> to 2<sup>1024</sup>-2<sup>971</sup>. Within this range, every number is represented with a signficand (the fraction portion of the floating-point representation) that has a leading 1 bit followed by 52 additional bits, and so the error that occurs when rounding any real number in this range to the nearest representable value is at most 2<sup>-53</sup> times the position value of the leading bit.</p>\n\n<p>In additional to this normal range, there is a subnormal range from 2<sup>-1074</sup> to 2<sup>-1022</sup>-2<sup>-1074</sup>. In this interval, the exponent part of the floating-point format has reached its smallest value and cannot be decreased any more. To represent smaller and smaller numbers in this interval, the significand is reduced below the normal minimum of 1. It starts with a 0 and is followed by 52 additional bits. In this interval, the error that occurs when rounding a real number to the nearest representable value may be larger than 2<sup>-53</sup> times the position value of the leading bit. Since the exponent cannot be decreased any further, numbers in this interval have increasing numbers of leading 0 bits as they get smaller and smaller. Thus the relative errors involved with using these numbers grows.</p>\n\n<p>For whatever reasons, the C++ has said that implementations may report underflow in this interval. (The IEEE-754 standard defines underflow in complicated ways and also allows implementations some choices.)</p>\n"}], "owner": {"reputation": 842, "user_id": 1085128, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9798134a47d85c790e2ee0da92f66a9e?s=128&d=identicon&r=PG", "display_name": "mako", "link": "https://stackoverflow.com/users/1085128/mako"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2470, "favorite_count": 0, "accepted_answer_id": 48087390, "answer_count": 3, "score": 4, "last_activity_date": 1530212817, "creation_date": 1515023734, "last_edit_date": 1515026196, "question_id": 48086830, "link": "https://stackoverflow.com/questions/48086830/stdstod-throws-out-of-range-error-for-a-string-that-should-be-valid", "title": "std::stod throws out_of_range error for a string that should be valid", "body": "<pre><code>#include &lt;iostream&gt;\n#include &lt;cmath&gt;\n#include &lt;sstream&gt;\nusing namespace std;\n\nint main(){\n    stringstream ss;\n    double ad = 7.63918e-313;\n    ss &lt;&lt; ad;\n    cout&lt;&lt;ss.str()&lt;&lt;endl;\n    //you will see that the above double is valid, and maps to the specified string\n\n    //but stod cannot map it back\n    stod(\"7.63918e-313\");\n    //terminate called after throwing an instance of 'std::out_of_range'\n}\n</code></pre>\n\n<p>Run it here: <a href=\"https://onlinegdb.com/Sy1MT1iQM\" rel=\"nofollow noreferrer\">https://onlinegdb.com/Sy1MT1iQM</a></p>\n\n<p>\"7.63918e-313\" will result from serializing a double, but stod cannot deserialize it. What's going on here? The smallest possible double is supposedly around 10^\u2212324.</p>\n\n<p>Is there a pair of functions somewhere in the stdlib that can reliably map doubles back and forth from stringification? Shouldn't there be?</p>\n\n<p>The plot thickens. We have two bizarre observations.</p>\n\n<ul>\n<li><p><code>std::numeric_limits&lt;double&gt;::min()</code> cannot be parsed by stod either.</p></li>\n<li><p><code>std::numeric_limits&lt;double&gt;::min()</code> is not the minimum double. Our double is smaller, and I find we can get smaller doubles by simply dividing min, so it's not that my double is anomalous or anything <a href=\"https://onlinegdb.com/rJvilljQz\" rel=\"nofollow noreferrer\">https://onlinegdb.com/rJvilljQz</a></p></li>\n</ul>\n\n<p>I am very concerned.</p>\n"}, {"tags": ["c++", "cuda", "race-condition"], "comments": [{"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 1, "creation_date": 1515020320, "post_id": 48086305, "comment_id": 83147663, "body": "actually for questions like this, SO expects that you provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  Read item 1 <a href=\"https://stackoverflow.com/help/on-topic\">here</a>.  Note the usage of the word &quot;must&quot;.  If your claims are correct, it shouldn&#39;t require many additional lines of code to build a complete program to demonstrate your claims."}], "answers": [{"comments": [{"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "reply_to_user": {"reputation": 955, "user_id": 7852589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57a28b0f335e39f207b3be9515336d6a?s=128&d=identicon&r=PG&f=1", "display_name": "Person.Woman.Man.Camera.TV", "link": "https://stackoverflow.com/users/7852589/person-woman-man-camera-tv"}, "edited": false, "score": 0, "creation_date": 1515083910, "post_id": 48089527, "comment_id": 83174403, "body": "Nevertheless, each threadblock in your presented code writes the entire <code>d_mat_3d</code> array.  Since each threadblock is writing different data, this is a race condition.  I&#39;m not suggesting that switching to a single threadblock is a sensible solution, I&#39;m using it to demonstrate that the results variability mostly disappears when I do that, which helps to confirm that race condition (although it is obviously evident by inspection of the code).  So the simple answer is yes, you have race conditions, and I have pointed out two of them."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "reply_to_user": {"reputation": 955, "user_id": 7852589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57a28b0f335e39f207b3be9515336d6a?s=128&d=identicon&r=PG&f=1", "display_name": "Person.Woman.Man.Camera.TV", "link": "https://stackoverflow.com/users/7852589/person-woman-man-camera-tv"}, "edited": false, "score": 0, "creation_date": 1515084255, "post_id": 48089527, "comment_id": 83174608, "body": "Beyond that, your code makes no sense, but that is a separate issue, and not the question you asked.  If your actual code is anything like your presented code in the respects I&#39;ve mentioned, it&#39;s going to  need a substantial re-write."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "reply_to_user": {"reputation": 955, "user_id": 7852589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57a28b0f335e39f207b3be9515336d6a?s=128&d=identicon&r=PG&f=1", "display_name": "Person.Woman.Man.Camera.TV", "link": "https://stackoverflow.com/users/7852589/person-woman-man-camera-tv"}, "edited": false, "score": 0, "creation_date": 1515084378, "post_id": 48089527, "comment_id": 83174684, "body": "atomic exchange won&#39;t fix it.  The order of threadblock execution will affect the order of atomic exchanges.  The last threadblock will &quot;win&quot;, and that may vary run to run.  If you did an <code>atomicAdd</code> of all threadblock results together in the final array, that might mostly remove the variability associated with the threadblock-to-global write race.  I still claim that none of this makes any sense, and it&#39;s not really clear that you understand the execution model.  How could atomic exhange do anything useful?  You&#39;d still be throwing away lots of calculated results, just as  you  are doing now."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "reply_to_user": {"reputation": 955, "user_id": 7852589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57a28b0f335e39f207b3be9515336d6a?s=128&d=identicon&r=PG&f=1", "display_name": "Person.Woman.Man.Camera.TV", "link": "https://stackoverflow.com/users/7852589/person-woman-man-camera-tv"}, "edited": false, "score": 0, "creation_date": 1515085129, "post_id": 48089527, "comment_id": 83175160, "body": "I&#39;m sure there probably is.  But I can&#39;t possibly suggest it because you&#39;ve given no description of the algorithm you&#39;d actually like to perform.  You&#39;ve pretended that the code presented is a useful description of the algorithm.  I claim it is not, for the reasons already discussed.  If you want to combine the results from multiple threadblocks into a single array, you&#39;ll have to define exactly the arithmetic you want to do, and what results will go where.  If you have a new question, I suggest you ask a new question.  Let&#39;s not clutter this one up any further."}], "tags": [], "owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "is_accepted": true, "score": 1, "last_activity_date": 1515047405, "last_edit_date": 1515047405, "creation_date": 1515045702, "answer_id": 48089527, "question_id": 48086305, "link": "https://stackoverflow.com/questions/48086305/race-condition-in-cuda-kernel/48089527#48089527", "title": "Race Condition in CUDA Kernel", "body": "<p>Yes, you have at least 2 different race conditions in your code.  </p>\n\n<ol>\n<li><p>Since you are loading the entirety of shared memory in a loop (i.e. loading it all, over and over again, in a loop), it's necessary to protect both the start and the end of the load operation with <code>__syncthreads()</code>.  Doing so will reduce the variability from run-to-run down to the 6th or 7th significant decimal digit, which is consistent with <a href=\"http://docs.nvidia.com/cuda/floating-point/index.html\" rel=\"nofollow noreferrer\">ordinary <code>float</code> variability in floating-point operations</a>, where the order of operations is not duplicated (which will generally be the case here).</p>\n\n<p>adding the following line:</p>\n\n<pre><code>  for(x=0; x&lt;SIZE; x++){\n    __syncthreads();  // add this line\n    // load mat_2d (on shared memory) using d_mat_3d (on global memory)\n    for(i=0; i&lt;SIZE*SIZE; i++){\n      mat_2d[i] = d_mat_3d[i+x*SIZE*SIZE];\n    }\n\n    // sync threads as mat_2d is on shared memory\n    __syncthreads();\n</code></pre>\n\n<p>should mostly correct the issue.  Without that, as your kernel loops in <code>x</code>, some warps can \"race ahead\" to start loading shared memory, while previous warps are still busy with the previous loop iteration in <code>x</code> (and take note of comment 2 below, which probably exacerbates this issue.)</p></li>\n<li><p>Since <em>each threadblock</em> is writing to the entirety of <code>d_mat_3d</code>, you have a race condition as each threadblock attempts to write various values.  The order of threadblock execution (undefined by CUDA) will mostly determine what ends up there, and this can easily vary run-to-run.  The only trivial way I know of to sort this out without a complete kernel re-write is to simply launch 1 threadblock (which will still populate the same regions of <code>d_mat_3d</code>).   This sort of race condition is a global memory race, and <code>cuda-memcheck</code> cannot discover this kind of race, currently.  I hesitate to read too much into this, but this code doesn't really make any sense, and either indicates a lack of concern for a sensible code, or a lack of understanding of the CUDA execution model (especially coupled with item 2 below.)</p></li>\n</ol>\n\n<p>There are a few other things I would point out.</p>\n\n<ol>\n<li><p>Your use of <code>__syncthreads()</code> is potentially illegal in the last threadblock.  This construct:</p>\n\n<pre><code>  if(n &gt;= N_ELEM)\n    return;\n</code></pre>\n\n<p>will allow some threads in the (last) threadblock to retire early, meaning they will not participate in the subsequent <code>__syncthreads()</code> statements.  This is illegal in CUDA, and the restriction is covered in <a href=\"http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#synchronization-functions\" rel=\"nofollow noreferrer\">the programming guide</a>.  This is fixable by removing the early return, and protecting the various segments of your kernel loop (except the __syncthreads() statements) with <code>if (n &lt; N_ELEM)</code> or similar.</p></li>\n<li><p>Your kernel code is generally strange, as you have pointed out in your comments already.  One example of this is that you have every thread in the block doing the exact same loads and stores to/from shared memory.  This is wasteful, performance-wise, in several ways.</p></li>\n</ol>\n\n<p>I'm not suggesting this covers every issue with the code, merely the things I noticed.  Here is a relatively complete test case that I used to verify my findings.  It includes some changes to address items I mentioned above, as well as various other changes that seemed important to me:</p>\n\n<pre><code>$ cat t268.cu\n#include &lt;cstdlib&gt;\n#include &lt;sstream&gt;\n#include &lt;cstdio&gt;\n#include &lt;cuda.h&gt;\n#include &lt;cuda_runtime_api.h&gt;\n\n#define W 7              // fix limit for loops in kernel\n#define SIZE 100         // defining matrix dimension\n#define N_ELEM 10000     // no of elements in each vector\n#define NTPB 1024        // no of threads per block\n\nusing namespace std;\n\n__device__ float d_mat_3d[SIZE*SIZE*SIZE];\n\n__global__ void cuda_kernel(float *d_A, float *d_v){\n\n  __shared__ float mat_2d[SIZE*SIZE]; // a 2D slice of 3D matrix d_mat_3d\n\n  unsigned int n = blockDim.x*blockIdx.x+threadIdx.x;\n\n\n  int x, y, z, i;\n  float r;\n  float A = d_A[n];\n  float v = d_v[n];\n\n  #pragma unroll\n  for(x=0; x&lt;SIZE; x++){\n  __syncthreads();\nif (n &lt; N_ELEM){\n    // load mat_2d (on shared memory) using d_mat_3d (on global memory)\n    for(i=0; i&lt;SIZE*SIZE; i++){\n      mat_2d[i] = d_mat_3d[i+x*SIZE*SIZE];\n    }\n}\n    // sync threads as mat_2d is on shared memory\n    __syncthreads();\nif (n &lt; N_ELEM){\n    for(y=SIZE/2; y&lt;SIZE/2+W; y++){\n      for(z=SIZE/2; z&lt;SIZE/2+W; z++){\n        r = sqrt( pow(A,2) / v );  // no need to be in these loops. I know, but for my real case, it must be.\n        atomicAdd(&amp;(mat_2d[z+y*SIZE]), r); // atomically add r\n      }\n    }\n}\n    __syncthreads();\n    // write mat_2d (shared memory) back to mat_3d (global memory)\nif (n &lt; N_ELEM){\n    for(i=0; i&lt;SIZE*SIZE; i++){\n      d_mat_3d[i+x*SIZE*SIZE] = mat_2d[i];\n    }\n}\n  }\n}\n\n// this function writes h_mat_3d to disk.\nvoid write_image(float *h_mat_3d){\n  for (int i = 0; i &lt; SIZE*SIZE; i++){\n    for (int j = 0; j &lt; SIZE; j++)\n      if (h_mat_3d[i*SIZE+j] &gt; 1.0f) printf(\"%d:%f\\n \", i*SIZE+j,  h_mat_3d[i*SIZE+j]);\n    printf(\"\\n\");}\n}\n\nint main(){\n\n  int i;\n  float *h_A = new float[N_ELEM]; // some large vector\n  float *h_v = new float[N_ELEM]; // some other large vector\n  float *h_mat_3d = new float[SIZE*SIZE*SIZE]; // will be filled w/ 0\n  float *d_A; // device variables\n  float *d_v;\n\n  for(i=0; i&lt;N_ELEM; i++){\n    h_A[i] = 0.2f+i/(float)N_ELEM; // fill out with some calculations\n    h_v[i] = 0.5f+2.f*i/(float)N_ELEM;\n  }\n  for(i=0; i&lt;SIZE*SIZE*SIZE; i++){\n    h_mat_3d[i] = 0.f; // fill h_mat_3d with 0\n  }\n\n  cudaMalloc((void **)&amp;d_A, sizeof(float)*N_ELEM); // allocate variables on device\n  cudaMalloc((void **)&amp;d_v, sizeof(float)*N_ELEM);\n\n  cudaMemcpy(d_A, h_A, sizeof(float)*N_ELEM, cudaMemcpyHostToDevice); // copy from host to device\n  cudaMemcpy(d_v, h_v, sizeof(float)*N_ELEM, cudaMemcpyHostToDevice);\n  cudaMemcpyToSymbol(d_mat_3d, h_mat_3d, sizeof(float)*SIZE*SIZE*SIZE); // copy h_mat_3d to device\n\n  cuda_kernel&lt;&lt;&lt;1,NTPB&gt;&gt;&gt;(d_A, d_v); // execute kernel\n\n  cudaMemcpyFromSymbol(h_mat_3d, d_mat_3d, sizeof(float)*SIZE*SIZE*SIZE); // write it back to h_mat_3d\n\n  write_image(h_mat_3d); // write h_mat_3d to disk for checking\n\n  cudaFree(d_A); // free memory\n  delete [] h_A;\n  delete [] h_v;\n\n  return 0;\n}\n$ nvcc -arch=sm_52 -o t268 t268.cu\n$ ./t268 &gt; out1.txt\n$ ./t268 &gt; out2.txt\n$ diff out1.txt out2.txt |more\n51,57c51,57\n&lt; 5050:330.657715\n&lt;  5051:330.657715\n&lt;  5052:330.657715\n&lt;  5053:330.657715\n&lt;  5054:330.657715\n&lt;  5055:330.657715\n&lt;  5056:330.657715\n---\n&gt; 5050:330.657654\n&gt;  5051:330.657593\n&gt;  5052:330.657593\n&gt;  5053:330.657593\n&gt;  5054:330.657593\n&gt;  5055:330.657593\n&gt;  5056:330.657593\n59,65c59,65\n&lt; 5150:330.657715\n&lt;  5151:330.657715\n&lt;  5152:330.657715\n&lt;  5153:330.657715\n&lt;  5154:330.657745\n&lt;  5155:330.657745\n&lt;  5156:330.657745\n---\n&gt; 5150:330.657593\n&gt;  5151:330.657593\n&gt;  5152:330.657593\n&gt;  5153:330.657593\n&gt;  5154:330.657593\n&gt;  5155:330.657593\n&gt;  5156:330.657593\n67,73c67,73\n&lt; 5250:330.657745\n&lt;  5251:330.657745\n&lt;  5252:330.657745\n&lt;  5253:330.657745\n&lt;  5254:330.657715\n&lt;  5255:330.657715\n&lt;  5256:330.657715\n---\n&gt; 5250:330.657593\n&gt;  5251:330.657593\n&gt;  5252:330.657623\n&gt;  5253:330.657593\n&gt;  5254:330.657593\n&gt;  5255:330.657593\n&gt;  5256:330.657593\n75,81c75,81\n&lt; 5350:330.657715\n&lt;  5351:330.657715\n&lt;  5352:330.657715\n&lt;  5353:330.657715\n&lt;  5354:330.657715\n&lt;  5355:330.657745\n&lt;  5356:330.657715\n---\n&gt; 5350:330.657593\n&gt;  5351:330.657593\n$\n</code></pre>\n\n<p>As can be seen, the remaining variation is in the 7th significant decimal digit:</p>\n\n<pre><code>51,57c51,57\n&lt; 5050:330.657715\n...\n---\n&gt; 5050:330.657654\n</code></pre>\n"}], "owner": {"reputation": 955, "user_id": 7852589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57a28b0f335e39f207b3be9515336d6a?s=128&d=identicon&r=PG&f=1", "display_name": "Person.Woman.Man.Camera.TV", "link": "https://stackoverflow.com/users/7852589/person-woman-man-camera-tv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1063, "favorite_count": 0, "accepted_answer_id": 48089527, "answer_count": 1, "score": 0, "last_activity_date": 1515083672, "creation_date": 1515019917, "last_edit_date": 1515083672, "question_id": 48086305, "link": "https://stackoverflow.com/questions/48086305/race-condition-in-cuda-kernel", "title": "Race Condition in CUDA Kernel", "body": "<p>I have a CUDA kernel that appears to have race condition and am trying to pinpoint where this race condition is coming from. I am aware of the 'racecheck' tool of cuda-memcheck, however racecheck tells me that there is no hazard when using small inputs which is actually consistent with my own investigations too. For large inputs though racecheck seems to take forever (literally) and so I can't use it.\nBriefly explaining, a 1D vector <code>d_mat_3d</code> defined as a <code>__device__</code> variable is filled with 0 and loaded in global memory. Two large arrays which are the inputs for the kernel (<code>d_A</code> and <code>d_v</code>) are also defined in <code>main</code> and passed to the kernal. A segment of array <code>d_mat_3d</code>, called <code>mat_2d</code> is cut, loaded in shared memory and some processing will be done on it. Then, <code>mat_2d</code> will be written back to <code>d_mat_3d</code> on global memory. </p>\n\n<p>As shown here, atomic operations are used as without the use of atomic operations <code>mat_2d</code> would encounter a race condition b/w different threads.</p>\n\n<p>The reason I guess I still have some sort of race condition going on is that the results of <code>mat_3d</code> is different every time. </p>\n\n<p>Any thought as to where this race condition may come from? Any steps I can take to clear that out (other than the tool racecheck)? If you think, there is no evidence for race condition, can you explain why different values are assigned to <code>d_mat_3d</code> every time I execute the kernel?</p>\n\n<p>CUDA 9.0 / NVidia Titan Black / Ubuntu 16.04</p>\n\n<pre><code>#include &lt;cstdlib&gt;\n#include &lt;sstream&gt;\n#include &lt;cstdio&gt;\n#include &lt;cuda.h&gt;\n#include &lt;cuda_runtime_api.h&gt;\n\n#define W 7              // fix limit for loops in kernel\n#define SIZE 100         // defining matrix dimension\n#define N_ELEM 10000     // no of elements in each vector\n#define NTPB 1024        // no of threads per block\n\nusing namespace std;\n\n__device__ float d_mat_3d[SIZE*SIZE*SIZE]; \n\n__global__ void cuda_kernel(float *d_A, float *d_v){\n\n  __shared__ float mat_2d[SIZE*SIZE]; // a 2D slice of 3D matrix d_mat_3d\n\n  unsigned int n = blockDim.x*blockIdx.x+threadIdx.x;\n\n  if(n &gt;= N_ELEM)\n    return;\n\n  int x, y, z, i;\n  float r;\n  float A = d_A[n];\n  float v = d_v[n];\n\n  #pragma unroll\n  for(x=0; x&lt;SIZE; x++){\n\n    // load mat_2d (on shared memory) using d_mat_3d (on global memory)\n    for(i=0; i&lt;SIZE*SIZE; i++){\n      mat_2d[i] = d_mat_3d[i+x*SIZE*SIZE];\n    }\n\n    // sync threads as mat_2d is on shared memory\n    __syncthreads();\n\n    for(y=SIZE/2; y&lt;SIZE/2+W; y++){ \n      for(z=SIZE/2; z&lt;SIZE/2+W; z++){\n        r = sqrt( pow(A,2) / v );  // no need to be in these loops. I know, but for my real case, it must be.\n        atomicAdd(&amp;mat_2d[z+y*SIZE], r); // atomically add r \n      }\n    }\n\n    __syncthreads();\n    // write mat_2d (shared memory) back to mat_3d (global memory)\n    for(i=0; i&lt;SIZE*SIZE; i++){\n      d_mat_3d[i+x*SIZE*SIZE] = mat_2d[i];\n    }\n  }\n}\n\n// this function writes h_mat_3d to disk. \nvoid write_image(float *h_mat_3d){\n  ostringstream o_addToFile;\n  o_addToFile &lt;&lt; \"mat3d.bin\";\n  FILE *pFile; \n  pFile = fopen(o_addToFile.str().c_str(), \"wb\");\n  for(int i=0; i&lt;SIZE*SIZE*SIZE; i++){ \n    fwrite(&amp;h_mat_3d[i], sizeof(float), 1, pFile);\n  }\n  fclose (pFile);\n}\n\nint main(){\n\n  int i;\n  float *h_A = new float[N_ELEM]; // some large vector\n  float *h_v = new float[N_ELEM]; // some other large vector\n  float h_mat_3d[SIZE*SIZE*SIZE]; // will be filled w/ 0\n  float *d_A; // device variables\n  float *d_v;\n\n  for(i=0; i&lt;N_ELEM; i++){\n    h_A[i] = 0.2f+(float)i/N_ELEM; // fill out with some calculations\n    h_v[i] = 0.5f+2.f*i/N_ELEM;\n  }\n  for(i=0; i&lt;SIZE*SIZE*SIZE; i++){\n    h_mat_3d[i] = 0.f; // fill h_mat_3d with 0 \n  }\n\n  cudaMalloc((void **)&amp;d_A, sizeof(float)*N_ELEM); // allocate variables on device\n  cudaMalloc((void **)&amp;d_v, sizeof(float)*N_ELEM);\n\n  cudaMemcpy(d_A, h_A, sizeof(float)*N_ELEM, cudaMemcpyHostToDevice); // copy from host to device\n  cudaMemcpy(d_v, h_v, sizeof(float)*N_ELEM, cudaMemcpyHostToDevice);\n  cudaMemcpyToSymbol(d_mat_3d, &amp;h_mat_3d, sizeof(float)*SIZE*SIZE*SIZE); // copy h_mat_3d to device\n\n  cuda_kernel&lt;&lt;&lt;(N_ELEM+NTPB-1)/NTPB,NTPB&gt;&gt;&gt;(d_A, d_v); // execute kernel\n\n  cudaMemcpyFromSymbol(h_mat_3d, d_mat_3d, sizeof(float)*SIZE*SIZE*SIZE); // write it back to h_mat_3d\n\n  write_image(h_mat_3d); // write h_mat_3d to disk for checking\n\n  cudaFree(d_A); // free memory\n  cudaFree(d_v);\n  delete [] h_A;\n  delete [] h_v;\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "struct"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 1, "creation_date": 1515018134, "post_id": 48085997, "comment_id": 83146966, "body": "<code>delete[]</code> and <code>memset</code> do totally different things. From what you have show <code>memset</code> seems like it would be right. You need to define what you mean by &quot;reset&quot;."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 1, "creation_date": 1515018169, "post_id": 48085997, "comment_id": 83146981, "body": "To hold a string, use <code>std::string</code>. To hold a constant number of items, use <code>std::array</code>. To hold a variable number of items, use <code>std::vector</code>."}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1515018298, "post_id": 48085997, "comment_id": 83147033, "body": "@Cheersandhth.-Alf for a few possible string values that would be an overkill storagewise (though for a really limited set of card types char array is likewise an overkill)."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "reply_to_user": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1515018362, "post_id": 48085997, "comment_id": 83147052, "body": "@bipll: For a few possible values use an enumeration."}, {"owner": {"reputation": 20, "user_id": 3511478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/795f0af02a3e00101aef1fb5454910f0?s=128&d=identicon&r=PG&f=1", "display_name": "NanoedStux", "link": "https://stackoverflow.com/users/3511478/nanoedstux"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1515018382, "post_id": 48085997, "comment_id": 83147055, "body": "@John3136 by reset i just mean empty the array of items and set each item in the array to 0 in preparation to be written over"}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1515018672, "post_id": 48085997, "comment_id": 83147158, "body": "@Cheersandhth.-Alf yes, exactly."}, {"owner": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "edited": false, "score": 0, "creation_date": 1515018742, "post_id": 48085997, "comment_id": 83147178, "body": "memset should work ok, but it seems weird to use in c++. How are you using it? and how do you know it doesnt work?"}, {"owner": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "edited": false, "score": 0, "creation_date": 1515020348, "post_id": 48085997, "comment_id": 83147675, "body": "To use <code>memset</code> do <code>memset(w.cards, 0, sizeof(Card) * 11);</code>, where <code>w</code> is the wallet."}], "answers": [{"comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 2, "creation_date": 1515018485, "post_id": 48086072, "comment_id": 83147096, "body": "Instead of a counting loop with a magic constant you can just use a (much safer) range based <code>for</code> loop, llike so: <code>for( Card&amp; card : wallet.cards )</code>"}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1515018586, "post_id": 48086072, "comment_id": 83147127, "body": "Sorry about the edit, I looked at the wrong array in the OP&#39;s code. But it sort of illustrates why magic numbers are bad (again, sorry). Rolled it back."}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": false, "score": 1, "last_activity_date": 1515018698, "last_edit_date": 1515018698, "creation_date": 1515018360, "answer_id": 48086072, "question_id": 48085997, "link": "https://stackoverflow.com/questions/48085997/c-reset-a-member-of-a-struct-thats-an-array-of-structs/48086072#48086072", "title": "c++ reset a member of a struct thats an array of structs", "body": "<p>There's always the simple solution.</p>\n\n<pre><code>for (int i = 0; i &lt; 11; i++) {\n  wallet.cards[i] = Card();\n}\n</code></pre>\n\n<p>Alternatively, as @Cheers notes in the comments, you can use a range-based for loop to have the compiler automatically determine the bounds. This is safer as you can't mistakenly use the wrong size for the array.</p>\n\n<pre><code>for (Card&amp; card : wallet.cards) {\n  card = Card();\n}\n</code></pre>\n\n<p>The magic happens with the ampersand <code>&amp;</code>, which makes <code>card</code> a reference. So any assignment to the variable <code>card</code> affects the original card in the array.</p>\n"}, {"tags": [], "owner": {"reputation": 3890, "user_id": 1201701, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/VCVHT.jpg?s=128&g=1", "display_name": "StPiere", "link": "https://stackoverflow.com/users/1201701/stpiere"}, "is_accepted": true, "score": 2, "last_activity_date": 1515018839, "last_edit_date": 1515018839, "creation_date": 1515018481, "answer_id": 48086100, "question_id": 48085997, "link": "https://stackoverflow.com/questions/48085997/c-reset-a-member-of-a-struct-thats-an-array-of-structs/48086100#48086100", "title": "c++ reset a member of a struct thats an array of structs", "body": "<p>you may consider using std::vector instead:</p>\n\n<pre><code>struct Wallet {\n    double money;\n    vector&lt;Card&gt; cards;\n    int cardIndex;\n};\n</code></pre>\n\n<p>You could then use clear() oder assign() methods of std::vector or simply its assignment operator.</p>\n\n<p>But if you insist using fixed size array, you could use std::fill from <code>&lt;algorithm&gt;</code> header</p>\n\n<p>for ex.</p>\n\n<pre><code>struct Wallet {\n    double money;\n    Card cards[11];\n    int cardIndex;\n    void reset() { std::fill(cards, cards+11  Card{}); }\n};\n</code></pre>\n"}], "owner": {"reputation": 20, "user_id": 3511478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/795f0af02a3e00101aef1fb5454910f0?s=128&d=identicon&r=PG&f=1", "display_name": "NanoedStux", "link": "https://stackoverflow.com/users/3511478/nanoedstux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 48086100, "answer_count": 2, "score": -3, "last_activity_date": 1515018839, "creation_date": 1515017957, "question_id": 48085997, "link": "https://stackoverflow.com/questions/48085997/c-reset-a-member-of-a-struct-thats-an-array-of-structs", "title": "c++ reset a member of a struct thats an array of structs", "body": "<p>so i have an struct that contains an array of structs, im wondering how to reset the array of structs without reseting the rest of the members of the first struct.\nthis is my code for the structs:</p>\n\n<pre><code>struct Card {\n    int value;\n    char type[10];\n};\n\nstruct Wallet {\n    double money;\n    Card cards[11];\n    int cardIndex;\n};\n</code></pre>\n\n<p>so far i have tried    <code>delete[]</code> and <code>memset</code> however both aren't seem to work. any suggestions would be greatly appreciated</p>\n"}, {"tags": ["c++", "csv", "parsing"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 3, "creation_date": 1515017490, "post_id": 48085842, "comment_id": 83146705, "body": "Why you are splitting on quotes has me puzzled . Based on what you are trying to do, I would expect <code>getline</code> without the specified delimiter to allow the system to figure out the line ending for your platform and then get a complete line before splitting the line on commas."}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1515017656, "post_id": 48085842, "comment_id": 83146754, "body": "The output is spot on, <code>getline(ss, line, &#39;,&#39;)</code> splits the input by <code>,</code> and <code>Petitioned\\n2055</code> is exactly index 22. Change <code>while(getline(file, line, &#39;&quot;&#39;)</code> to <code>while(getline(file, line)</code> and see what happens"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1515017779, "post_id": 48085842, "comment_id": 83146802, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1120140/how-can-i-read-and-parse-csv-files-in-c\">How can I read and parse CSV files in C++?</a>"}, {"owner": {"reputation": 115, "user_id": 9147090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gM0P4.jpg?s=128&g=1", "display_name": "Mr Berry", "link": "https://stackoverflow.com/users/9147090/mr-berry"}, "edited": false, "score": 0, "creation_date": 1515017884, "post_id": 48085842, "comment_id": 83146843, "body": "Removing the &#39;&quot;&#39; from the first while statement works to separate the last entry (Petitioned) from the first of the next set (2055), which is good. However doing this causes my data to no longer be separated by comma."}, {"owner": {"reputation": 115, "user_id": 9147090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gM0P4.jpg?s=128&g=1", "display_name": "Mr Berry", "link": "https://stackoverflow.com/users/9147090/mr-berry"}, "edited": false, "score": 0, "creation_date": 1515017941, "post_id": 48085842, "comment_id": 83146867, "body": "rawdata[23] = <code>2055,ANIMALIA,CHORDATA,MAMMALIA,CARNIVORA,OTARIIDAE,Arctocep&zwnj;&#8203;halus,australis,</code>"}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1515017997, "post_id": 48085842, "comment_id": 83146884, "body": "that is because of your second <code>if (getline(file, line, &#39;&quot;&#39;)) {</code>. remove it completely"}, {"owner": {"reputation": 115, "user_id": 9147090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gM0P4.jpg?s=128&g=1", "display_name": "Mr Berry", "link": "https://stackoverflow.com/users/9147090/mr-berry"}, "edited": false, "score": 0, "creation_date": 1515017998, "post_id": 48085842, "comment_id": 83146885, "body": "and thanks Barmar, I did read that thread earlier today"}, {"owner": {"reputation": 115, "user_id": 9147090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gM0P4.jpg?s=128&g=1", "display_name": "Mr Berry", "link": "https://stackoverflow.com/users/9147090/mr-berry"}, "edited": false, "score": 0, "creation_date": 1515018171, "post_id": 48085842, "comment_id": 83146983, "body": "That almost works but then it does not register the quotation marks surrounding entries with a comma inside the string"}, {"owner": {"reputation": 3890, "user_id": 1201701, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/VCVHT.jpg?s=128&g=1", "display_name": "StPiere", "link": "https://stackoverflow.com/users/1201701/stpiere"}, "edited": false, "score": 0, "creation_date": 1515018196, "post_id": 48085842, "comment_id": 83146996, "body": "do you know the encoding of your CSV-file ? what is the new line delimiter you are using when exporting the CSV ?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1515018333, "post_id": 48085842, "comment_id": 83147044, "body": "Recommendation: Get a full line and then call a function that accepts the line as a <code>string</code> and returns a <code>vector&lt;string&gt;</code> containing the split up line splits up the line. This function  needs to be quote aware, and I&#39;m not sure if a state machine or brute force with a <code>stringstream</code> (the way you are trying to parse) will suit you better."}, {"owner": {"reputation": 115, "user_id": 9147090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gM0P4.jpg?s=128&g=1", "display_name": "Mr Berry", "link": "https://stackoverflow.com/users/9147090/mr-berry"}, "edited": false, "score": 0, "creation_date": 1515018613, "post_id": 48085842, "comment_id": 83147139, "body": "I don&#39;t know the encoding I downloaded the CSV from IUCN (Animal database). After this test file I want to run large sections of the database through this parser. I&#39;ll test out that last idea."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1515019530, "post_id": 48085842, "comment_id": 83147426, "body": "This doesn&#39;t address the question, but that <code>if (file.good())</code> isn&#39;t needed. <code>std::getline</code> will simply fail if the stream state is not good."}, {"owner": {"reputation": 115, "user_id": 9147090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gM0P4.jpg?s=128&g=1", "display_name": "Mr Berry", "link": "https://stackoverflow.com/users/9147090/mr-berry"}, "edited": false, "score": 0, "creation_date": 1515020673, "post_id": 48085842, "comment_id": 83147791, "body": "Thank you, I removed it. Still working on preserving quoted entries."}, {"owner": {"reputation": 13760, "user_id": 224704, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c94b60d81fde0361f2daa910a0f9a77?s=128&d=identicon&r=PG", "display_name": "Disillusioned", "link": "https://stackoverflow.com/users/224704/disillusioned"}, "edited": false, "score": 0, "creation_date": 1515076416, "post_id": 48085842, "comment_id": 83169870, "body": "You have an answer, but something I&#39;d just like to point out. You did a decent job of getting your code near minimal for the MCVE. But bear in mind the concept applies equally to sample data. E.g. you should have been able to provide actual output and expected output for sample data along the following lines: <code>Col1,Col 2,Col3\\nVal,&quot;Quoted with, comma&quot;,With spaces no quotes</code>  .... The skill of using simpler data to demonstrate a problem makes it much easier to test and debug."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 9147090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gM0P4.jpg?s=128&g=1", "display_name": "Mr Berry", "link": "https://stackoverflow.com/users/9147090/mr-berry"}, "edited": false, "score": 0, "creation_date": 1515023376, "post_id": 48086659, "comment_id": 83148497, "body": "This one works well and actually takes care of a small error the last answer didn&#39;t account for (it cut off the last field of every set - the Petitioned value - which isn&#39;t important to me but still). I am playing with this solution as well, thanks a lot."}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "reply_to_user": {"reputation": 115, "user_id": 9147090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gM0P4.jpg?s=128&g=1", "display_name": "Mr Berry", "link": "https://stackoverflow.com/users/9147090/mr-berry"}, "edited": false, "score": 0, "creation_date": 1515024075, "post_id": 48086659, "comment_id": 83148682, "body": "@MrBerry I have just updated the code, because I completely forgot that <code>getline</code> would eat <code>,</code> Now it should be ok."}, {"owner": {"reputation": 115, "user_id": 9147090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gM0P4.jpg?s=128&g=1", "display_name": "Mr Berry", "link": "https://stackoverflow.com/users/9147090/mr-berry"}, "edited": false, "score": 1, "creation_date": 1515026639, "post_id": 48086659, "comment_id": 83149283, "body": "Great, I&#39;m using this one as I&#39;ll eventually have to run larger databases through it and it preserves all of the values."}, {"owner": {"reputation": 115, "user_id": 9147090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gM0P4.jpg?s=128&g=1", "display_name": "Mr Berry", "link": "https://stackoverflow.com/users/9147090/mr-berry"}, "edited": false, "score": 0, "creation_date": 1515042244, "post_id": 48086659, "comment_id": 83152437, "body": "It does in fact eat the commas, I&#39;m working on fixing that now."}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "reply_to_user": {"reputation": 115, "user_id": 9147090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gM0P4.jpg?s=128&g=1", "display_name": "Mr Berry", "link": "https://stackoverflow.com/users/9147090/mr-berry"}, "edited": false, "score": 0, "creation_date": 1515042371, "post_id": 48086659, "comment_id": 83152465, "body": "@MrBerry have you tried the updated code or there is some other issue?"}], "tags": [], "owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "is_accepted": true, "score": 3, "last_activity_date": 1515025473, "last_edit_date": 1515025473, "creation_date": 1515022548, "answer_id": 48086659, "question_id": 48085842, "link": "https://stackoverflow.com/questions/48085842/how-do-i-parse-a-csv-with-commas-embedded-in-quoted-fields/48086659#48086659", "title": "How do I parse a CSV with commas embedded in quoted fields?", "body": "<p>This is far from a complete CSV parser and could be made more efficient, but it does the job, parses your file correctly and deals with double quotes as well. </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n\nint main()\n{\n    std::string line;\n    std::vector&lt;std::vector&lt;std::string&gt;&gt; lines;\n    std::ifstream file(\"/Users/darla/Desktop/Programs/seals.csv\");\n\n    if (file)\n    {\n        while (std::getline(file, line))\n        {\n            size_t n = lines.size();\n            lines.resize(n + 1);\n\n            std::istringstream ss(line);\n            std::string field, push_field(\"\");\n            bool no_quotes = true;\n\n            while (std::getline(ss, field, ',')) \n            {\n                if (static_cast&lt;size_t&gt;(std::count(field.begin(), field.end(), '\"')) % 2 != 0)\n                {\n                    no_quotes = !no_quotes;\n                }\n\n                push_field += field + (no_quotes ? \"\" : \",\");\n\n                if (no_quotes)\n                {\n                    lines[n].push_back(push_field);\n                    push_field.clear();\n                }\n            }\n        }\n    }\n\n    for (auto line : lines)\n    {\n        for (auto field : line)\n        {\n            std::cout &lt;&lt; \"| \" &lt;&lt; field &lt;&lt; \" |\";\n        }\n\n        std::cout &lt;&lt; std::endl &lt;&lt; std::endl;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/KtbPi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KtbPi.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>An explanation. The program reads file lines and tries to parse each line by fields, separated by commas, then stores the results in vector of vectors. If a field with double quotes encountered and double quotes are at odd number, this means it is an open field so more fields are read in until closing field is found, then the complete filed is stored. If field contains even number of double quotes or none, it is stored straight away. Hope this helps.</p>\n"}], "owner": {"reputation": 115, "user_id": 9147090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gM0P4.jpg?s=128&g=1", "display_name": "Mr Berry", "link": "https://stackoverflow.com/users/9147090/mr-berry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1258, "favorite_count": 0, "accepted_answer_id": 48086659, "answer_count": 1, "score": 5, "last_activity_date": 1516078929, "creation_date": 1515017136, "last_edit_date": 1516078929, "question_id": 48085842, "link": "https://stackoverflow.com/questions/48085842/how-do-i-parse-a-csv-with-commas-embedded-in-quoted-fields", "title": "How do I parse a CSV with commas embedded in quoted fields?", "body": "<p>I have tried some fixes mentioned in other answers but they had no effect on my output. I was not planning on using boost spirit as I am not sure it is the best option for my needs. Also the similar post does not deal with quoted material which contains commas, which is my last issue to resolve at this point.</p>\n\n<p>This is a C++ program. I am using a CSV file as input. This file gives features of seals, there are 23 values(columns) per entry. When I output rawdata[22] I expect to see the last entry of the first set of data. Instead, I see the last entry (Petitioned) followed by the first entry (2055) of the next seal. When I open this in a hex editor I see the two words are separated by a \".\" and the hex character is 0a. I have tried setting \\r, \\n, \\r\\n, as delimiters but they do not work. I cannot use \",\" as a delimiter because it is used within strings, I tested it to see if it would work for my issue anyway and it didn't. How to separate these values?</p>\n\n<p>OUTPUT:</p>\n\n<p><code>Petitioned\n2055</code></p>\n\n<p>SAMPLE INPUT:</p>\n\n<pre>\nSpeciesID,Kingdom,Phylum,Class,Order,Family,Genus,Species,Authority,Infraspecific rank,Infraspecific name,Infraspecific authority,Stock/subpopulation,Synonyms,Common names (Eng),Common names (Fre),Common names (Spa),Red List status,Red List criteria,Red List criteria version,Year assessed,Population trend,Petitioned\n2055,ANIMALIA,CHORDATA,MAMMALIA,CARNIVORA,OTARIIDAE,Arctocephalus,australis,\"(Zimmermann, 1783)\",,,,,Arctophoca australis,South American Fur Seal,Otarie fourrure Australe,Oso Marino Austral,LC,,3.1,2016,increasing,N\n41664,ANIMALIA,CHORDATA,MAMMALIA,CARNIVORA,OTARIIDAE,Arctocephalus,forsteri,\"(Lesson, 1828)\",,,,,Arctocephalus australis subspecies forsteri|Arctophoca australis subspecies forsteri,\"New Zealand Fur Seal, Antipodean Fur Seal, Australasian Fur Seal, Black Fur Seal, Long-nosed Fur Seal, South Australian Fur Seal\",,,LC,,3.1,2015,increasing,N\n</pre>\n\n<p>my code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\nint main() {\n    string line;\n    vector&lt;string&gt; rawdata;\n    ifstream file ( \"/Users/darla/Desktop/Programs/seals.csv\" );\n    if ( file.good() )\n   {\n    while(getline(file, line, '\"')) {\n        stringstream ss(line);\n        while (getline(ss, line, ',')) {\n            rawdata.push_back(line);\n        }\n        if (getline(file, line, '\"')) {\n            rawdata.push_back(line);\n        }\n    }\n   }\n    cout &lt;&lt; rawdata[22] &lt;&lt; endl;\n\n\n    return 0;\n</code></pre>\n"}, {"tags": ["c++"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 9170211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fde49392ea98aa8bcc0e2b148a29854?s=128&d=identicon&r=PG", "display_name": "user67265", "link": "https://stackoverflow.com/users/9170211/user67265"}, "edited": false, "score": 0, "creation_date": 1515024055, "post_id": 48086058, "comment_id": 83148675, "body": "Got it. But I still don\u2019t understand the output of above code. Actually it\u2019s in this tutorial:<a href=\"https://www.tutorialspoint.com/cplusplus/cpp_files_streams.htm\" rel=\"nofollow noreferrer\">enter link description here</a>. Why doesn\u2019t age overwrite name from the beginning?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 159, "user_id": 9170211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fde49392ea98aa8bcc0e2b148a29854?s=128&d=identicon&r=PG", "display_name": "user67265", "link": "https://stackoverflow.com/users/9170211/user67265"}, "edited": false, "score": 0, "creation_date": 1515024421, "post_id": 48086058, "comment_id": 83148769, "body": "Please update the question, showing the output you&#39;re expecting and what you&#39;re getting instead."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 159, "user_id": 9170211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fde49392ea98aa8bcc0e2b148a29854?s=128&d=identicon&r=PG", "display_name": "user67265", "link": "https://stackoverflow.com/users/9170211/user67265"}, "edited": false, "score": 0, "creation_date": 1515024482, "post_id": 48086058, "comment_id": 83148783, "body": "When you do <code>infile &gt;&gt; data</code> it will only read one word from the file. So if you entered a firstname and lastname, it will just read the firstname. Use <code>infile.getline()</code> to read a whole line from the file."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 159, "user_id": 9170211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fde49392ea98aa8bcc0e2b148a29854?s=128&d=identicon&r=PG", "display_name": "user67265", "link": "https://stackoverflow.com/users/9170211/user67265"}, "edited": false, "score": 0, "creation_date": 1515025113, "post_id": 48086058, "comment_id": 83148950, "body": "I&#39;ve updated the answer. It only goes to the beginning when the file is first opened, not between each output operation."}, {"owner": {"reputation": 159, "user_id": 9170211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fde49392ea98aa8bcc0e2b148a29854?s=128&d=identicon&r=PG", "display_name": "user67265", "link": "https://stackoverflow.com/users/9170211/user67265"}, "edited": false, "score": 1, "creation_date": 1515026273, "post_id": 48086058, "comment_id": 83149205, "body": "finally understand. Thank you."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 11, "last_activity_date": 1515025093, "last_edit_date": 1515025093, "creation_date": 1515018292, "answer_id": 48086058, "question_id": 48085781, "link": "https://stackoverflow.com/questions/48085781/what-is-the-difference-among-iosapp-out-and-trunc-in-c/48086058#48086058", "title": "What is the difference among ios::app, out, and trunc in c++?", "body": "<p><code>ios::out</code> is the default mode for <code>std::ofstream</code>, it means that output operations can be used (i.e. you can write to the file).</p>\n\n<p><code>ios::app</code> (short for <em>append</em>) means that instead of overwriting the file from the beginning, all output operations are done at the end of the file. This is only meaningful if the file is also open for output.</p>\n\n<p><code>ios::trunc</code> (short for <em>truncate</em>) means that when the file is opened, the old contents are immediately removed. Again, this is only meaningful if the file is also open for output.</p>\n\n<p>Your code just uses the default <code>ios::out</code> mode. So it starts writing from the beginning of the file, but doesn't remove the old contents. So the new contents will overlay what's already there -- if the file is originally 10 bytes long, and you write 3 bytes, the result will be the 3 bytes you write followed by the remaining 7 bytes of the original contents. More concretely, if the file originally contains:</p>\n\n<pre><code>Firstname Lastname\n30\n</code></pre>\n\n<p>and you write <code>FN LN</code> and then <code>20</code> (with newlines after each), the resulting file will look like:</p>\n\n<pre><code>FN LN\n20\n Lastname\n30\n</code></pre>\n\n<p>because you only overwrite the first 9 bytes of the file (assuming Unix-style newlines).</p>\n\n<p>Once you've opened the file, all outputs to the file are written sequentially after each other, unless you use <code>outfile.seekp()</code> to go to a different location. It doesn't go back to the beginning of the file for each thing you write. <code>seekp()</code> has no effect if the <code>ios::app</code> is used; then every write goes at the end of the file.</p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 10284159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adcf2c144d9a87505141e48033d521b4?s=128&d=identicon&r=PG", "display_name": "Inot", "link": "https://stackoverflow.com/users/10284159/inot"}, "is_accepted": false, "score": 3, "last_activity_date": 1557336516, "last_edit_date": 1557336516, "creation_date": 1538418191, "answer_id": 52596774, "question_id": 48085781, "link": "https://stackoverflow.com/questions/48085781/what-is-the-difference-among-iosapp-out-and-trunc-in-c/52596774#52596774", "title": "What is the difference among ios::app, out, and trunc in c++?", "body": "<p>Just a little correction to Barmar's answer. I think that the type ofstream implies not only the ios::out, but also the ios::trunc (and I'm not sure, but the ios::out could also imply the ios::trunc).</p>\n\n<p>Here's the concrete example:</p>\n\n<pre><code>ofstream fich;\n    fich.open(\"archivo.txt\");\n    for (unsigned i = 0; i &lt; ag.n_pers &amp;&amp; !fich.fail(); ++i) {\n        escribir_persona(fich, ag.pers[i]);\n    }\n    if (fich.fail()) {\n        ok = ERROR;\n    }\n    else {\n        ok = OK;\n    }\n    fich.close();\n</code></pre>\n\n<p>When I call this function, the data of the file is completely overwrited (even if the data to write is less than that which was writen previously), and if the data to write is empty, this just deletes everything in the file.</p>\n"}], "owner": {"reputation": 159, "user_id": 9170211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fde49392ea98aa8bcc0e2b148a29854?s=128&d=identicon&r=PG", "display_name": "user67265", "link": "https://stackoverflow.com/users/9170211/user67265"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16139, "favorite_count": 2, "answer_count": 2, "score": 1, "last_activity_date": 1557336516, "creation_date": 1515016878, "last_edit_date": 1515024603, "question_id": 48085781, "link": "https://stackoverflow.com/questions/48085781/what-is-the-difference-among-iosapp-out-and-trunc-in-c", "title": "What is the difference among ios::app, out, and trunc in c++?", "body": "<p>I know that the default file open mode is <strong>out</strong>. And I think <strong>out</strong> will overwrite the data in the file, but in the following code, it <strong>age data</strong> doesn\u2019t overwrite <strong>name data</strong>.</p>\n\n<pre><code>#include &lt;fstream&gt; \n#include &lt;iostream&gt; \nusing namespace std;\n\nint main () {\n\n    char data[100];\n\n    // open a file in write mode.\n    ofstream outfile;\n    outfile.open(\"afile.dat\");\n\n    cout &lt;&lt; \"Writing to the file\" &lt;&lt; endl; \n    cout &lt;&lt; \"Enter your name: \";\n    cin.getline(data, 100);\n\n    // write inputted data into the file.\n    outfile &lt;&lt; data &lt;&lt; endl;\n\n    cout &lt;&lt; \"Enter your age: \"; \n    cin &gt;&gt; data; \n    cin.ignore();\n\n    // again write inputted data into the file.\n    outfile &lt;&lt; data &lt;&lt; endl;\n    // close the opened file.\n    outfile.close();\n\n    // open a file in read mode.\n    ifstream infile; \n    infile.open(\"afile.dat\");\n\n    cout &lt;&lt; \"Reading from the file\" &lt;&lt; endl; \n    infile &gt;&gt; data;\n\n    // write the data at the screen. \n    cout &lt;&lt; data &lt;&lt; endl;\n\n    // again read the data from the file and display it. \n    infile &gt;&gt; data; \n    cout &lt;&lt; data &lt;&lt; endl;\n\n    // close the opened file.\n    infile.close();\n\n    return 0;\n</code></pre>\n\n<p>Then I\u2019m confused about the three open mode for file \u2013 app, out, trunc.</p>\n\n<p>If for name I enter \u201cZara\u201d and age \u201c9\u201d, the output should be \u201c9ara\u201d. However, it is not. It is \u201cZara 9\u201d.</p>\n"}, {"tags": ["c++", "struct", "header-files"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 4, "creation_date": 1515016250, "post_id": 48085614, "comment_id": 83146189, "body": "Sounds like all you need to do is implement <code>BulletTransform::BulletTransform(float mX, float mY)</code> You don&#39;t need to redefine the structure to do that."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1515016434, "post_id": 48085614, "comment_id": 83146279, "body": "<code>struct BulletTransform { ...</code> has no business being in both the header and the cpp file. the latter includes the former; that should be sufficient."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1515016735, "post_id": 48085614, "comment_id": 83146409, "body": "<i>I&#39;m working on a simple game C++ game</i> -- Problem is that C++ is not a simple language.  If you&#39;re making basic errors such as this, then maybe take a step back and learn how to use the constructs properly."}], "answers": [{"comments": [{"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 2, "creation_date": 1515016438, "post_id": 48085651, "comment_id": 83146282, "body": "Why would you redefine the non-static member <code>shape</code>?"}, {"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1515017427, "post_id": 48085651, "comment_id": 83146679, "body": "My bad. Fixed it now."}], "tags": [], "owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "is_accepted": false, "score": 2, "last_activity_date": 1515017437, "last_edit_date": 1515017437, "creation_date": 1515016322, "answer_id": 48085651, "question_id": 48085614, "link": "https://stackoverflow.com/questions/48085614/c-struct-type-redefinition-error/48085651#48085651", "title": "c++ struct type redefinition error", "body": "<p>You've repeated your struct definition in your implemenation file. Don't do that. Instead, provide definitions for the individual members, like this:</p>\n\n<pre><code>#include \"Bullet.h\"\n\n\nBulletTransform::BulletTransform(float mX, float mY)\n{\n    //constructor for shape stuff\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 5437699, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c6601a8518993f41ccb8db7553c2047?s=128&d=identicon&r=PG&f=1", "display_name": "Wopsie", "link": "https://stackoverflow.com/users/5437699/wopsie"}, "edited": false, "score": 0, "creation_date": 1515017188, "post_id": 48085686, "comment_id": 83146589, "body": "Thanks a lot to all who responded! I was misunderstanding the way you should implement structs from a header and its syntax. It works now!"}], "tags": [], "owner": {"reputation": 3890, "user_id": 1201701, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/VCVHT.jpg?s=128&g=1", "display_name": "StPiere", "link": "https://stackoverflow.com/users/1201701/stpiere"}, "is_accepted": true, "score": 3, "last_activity_date": 1515016816, "last_edit_date": 1515016816, "creation_date": 1515016481, "answer_id": 48085686, "question_id": 48085614, "link": "https://stackoverflow.com/questions/48085614/c-struct-type-redefinition-error/48085686#48085686", "title": "c++ struct type redefinition error", "body": "<p>In the header file you can make the declaration. In the source file the definition - thats the rule of thumb in general. In your case for example:</p>\n\n<p>in bullet.h:</p>\n\n<pre><code>struct BulletTransform {\n    sf::RectangleShape shape;\n\n    // cntr\n    BulletTransform(float mX, float mY) ;\n\n    // other methods\n    void Function1(float x, float y, float z);\n\n\n};\n</code></pre>\n\n<p>in bullet.cpp:</p>\n\n<pre><code>BulletTransform::BulletTransform(float mX, float mY) {\n  // here goes the constructor stuff\n}\n\nvoid BulletTransform::Function1(float x, float y, float z) {\n// ... implementation details\n}\n</code></pre>\n\n<p>Normally you don't do some heavy stuff in the constructor - just the  initialization of data members for example to some default values. \nHope this helps.</p>\n"}], "owner": {"reputation": 17, "user_id": 5437699, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c6601a8518993f41ccb8db7553c2047?s=128&d=identicon&r=PG&f=1", "display_name": "Wopsie", "link": "https://stackoverflow.com/users/5437699/wopsie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2112, "favorite_count": 0, "accepted_answer_id": 48085686, "answer_count": 2, "score": 0, "last_activity_date": 1515017437, "creation_date": 1515016137, "question_id": 48085614, "link": "https://stackoverflow.com/questions/48085614/c-struct-type-redefinition-error", "title": "c++ struct type redefinition error", "body": "<p>I'm working on a simple game C++ game using the SFML library. This is one of my first endeavors with C++ and I'm running into some problems with defining structs in headers. </p>\n\n<p>Here is the bullet.h:</p>\n\n<pre><code>#pragma once\n#include &lt;SFML\\Graphics.hpp&gt;\n\nstruct BulletTransform {\n    sf::RectangleShape shape;\n    //details\n    BulletTransform(float, float);\n};\n\nclass Bullet {\n//class definition stuff, no problems here\n</code></pre>\n\n<p>then I try to create an implementation in the bullet.cpp file:</p>\n\n<pre><code>#include \"Bullet.h\"\n\nstruct BulletTransform {\n\n    sf::RectangleShape shape;\n    BulletTransform::BulletTransform(float mX, float mY)\n    {\n        //constructor for shape stuff\n    }\n};\n</code></pre>\n\n<p>Now when I try to compile it throws an error saying struct in the bullet.cpp being a type redefinition. I understand that I cannot define a struct with the same name twice, but I am also not sure how I can fix this issue. Do I somehow need to get a reference to the definition in the header? Or is my implementation simply wrong? Thanks in advance!</p>\n"}, {"tags": ["c++", "memory-management"], "comments": [{"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 2, "creation_date": 1515015930, "post_id": 48085528, "comment_id": 83146068, "body": "how can we tell you whether it&#39;s safe when we don&#39;t know in which context you&#39;re doing it? In general, <code>delete this</code> is a bad idea (indeed, exceptions where it can be OK might exist), but if in doubt, sounds like a bad (and unsafe) design decision. Maybe if you explain why you want to do that, a more definite answer can be given. (But you&#39;ll also, inevitably, hear about the cons of doing it, and honestly, I think deservedly so, because software design usually happens within the semantics of a language, and C++ was never meant to <code>delete this</code>)."}, {"owner": {"reputation": 1113, "user_id": 1788774, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/acwQG.jpg?s=128&g=1", "display_name": "excalibur1491", "link": "https://stackoverflow.com/users/1788774/excalibur1491"}, "edited": false, "score": 1, "creation_date": 1515015967, "post_id": 48085528, "comment_id": 83146088, "body": "I would not think so, I would be concerned about where the <code>vtable</code> goes afterwards. But I&#39;m interested int he answers, so I&#39;ll leave this comment"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1515016015, "post_id": 48085528, "comment_id": 83146099, "body": "Considering that COM objects implement interfaces with virtual methods, and <code>delete this</code> is almost always written in an overriden <code>IUnknown::Release()</code> method, then I would have to say yes, it is safe. Tons of Microsoft/Windows technologies depend on it."}, {"owner": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 1, "creation_date": 1515016219, "post_id": 48085528, "comment_id": 83146180, "body": "There are a lot of gotchas, but the vtable is not one of them. You should search before you post a question. Here&#39;s one <a href=\"https://stackoverflow.com/questions/3150942/is-delete-this-allowed\" title=\"is delete this allowed\">stackoverflow.com/questions/3150942/is-delete-this-allowed</a>"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1515016435, "post_id": 48085528, "comment_id": 83146280, "body": "@RemyLebeau That doesn\u2019t mean it\u2019s safe on a non-Windows system."}, {"owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 3, "creation_date": 1515016545, "post_id": 48085528, "comment_id": 83146323, "body": "Generally whether a function is virtual or not only matters when it&#39;s called, not when it returns."}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1515016600, "post_id": 48085528, "comment_id": 83146350, "body": "@RemyLebeau COM also depends extremely heavily on being able to arbitrarily switch between <code>void**</code> and <code>IWhatever**</code>, relying on the same representations for all pointer types and for the compiler to not optimise in ways that break such aliasing. (Yes, that&#39;s how MS documents it, that&#39;s not just programmer negligence. See e.g. <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ff485837(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>) Don&#39;t think &quot;COM relies on this&quot; means &quot;this is okay in standard C++&quot;. COM relies on implementation extensions."}, {"owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 1, "creation_date": 1515016823, "post_id": 48085528, "comment_id": 83146444, "body": "I&#39;d be tempted to say that asking specifically about virtual functions makes this question different than the linked duplicate. However I think we can assume that if the answers to that question don&#39;t mention virtual functions then it doesn&#39;t matter."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "reply_to_user": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 1, "creation_date": 1515017644, "post_id": 48085528, "comment_id": 83146751, "body": "@MarkRansom  I was conflicted.  Let&#39;s let it live?"}, {"owner": {"reputation": 2666, "user_id": 1698548, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jAkw5.jpg?s=128&g=1", "display_name": "Kristian Spangsege", "link": "https://stackoverflow.com/users/1698548/kristian-spangsege"}, "reply_to_user": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1515018408, "post_id": 48085528, "comment_id": 83147066, "body": "@MarcusM&#252;ller I added some info about what I am trying to do."}, {"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1515021329, "post_id": 48085528, "comment_id": 83147963, "body": "@KristianSpangsege thanks! Now, a really good question! Upvote!"}], "answers": [{"comments": [{"owner": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 9, "creation_date": 1515016371, "post_id": 48085636, "comment_id": 83146240, "body": "and make sure this was created by new"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1515016556, "post_id": 48085636, "comment_id": 83146331, "body": "And not <code>new[]</code>, but those are standard precautions necessary in order to make <code>delete this;</code> safe even for non-virtual objects."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1515018258, "post_id": 48085636, "comment_id": 83147020, "body": "Safe? Maybe, under very controlled circumstances. Good practice? probably not. Are you likely to bump into problems? Unless the code is super trivial then yes."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1515029125, "post_id": 48085636, "comment_id": 83149814, "body": "Keep in mind that in OO designs, it&#39;s pretty common for a subclass to implement its own override of the virtual method, and have its override-method &quot;call up&quot; to the superclass-method, and then do something additional after the superclass-method returns.  Most subclass-method authors are going to be very surprised if their this-object gets deleted out from underneath them during the superclass-method-call, and therefore they are likely to do something that results in undefined behavior or a crash afterwards.  So even if initially implemented correctly, &quot;delete this&quot; is a bug waiting to happen."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "reply_to_user": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1515029272, "post_id": 48085636, "comment_id": 83149847, "body": "@Jeremy - if a inherited function is going to do <code>delete this</code>, then that fact should be carefully documented.   And the derived version can only do things BEFORE calling the inherited version.  It can&#39;t do things which access the object (non-static members) after that."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1515029324, "post_id": 48085636, "comment_id": 83149861, "body": "@Peter agreed... and even then there will be a lot of developers who don&#39;t read the documentation, at least not until after they&#39;ve already been burned :)"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 15, "last_activity_date": 1515016586, "last_edit_date": 1515016586, "creation_date": 1515016252, "answer_id": 48085636, "question_id": 48085528, "link": "https://stackoverflow.com/questions/48085528/is-is-safe-to-delete-this-in-a-virtual-member-function/48085636#48085636", "title": "Is is safe to `delete this` in a virtual member function?", "body": "<p>Yes, so long as you don't use <code>this</code> afterwards, and neither does anyone else with a pointer to <code>*this</code>, and <code>this</code> was guaranteed to be allocated by <code>new</code> <em>as exactly the type you are deleting it as</em>, or possessing a virtual destructor. (ie, never as a member of another object, in a <code>std::vector</code>, as an automatic storage variable, as a static variable, as a temporary, not <code>new[]</code>, not placement <code>new</code>, etc etc etc)</p>\n\n<p>This includes calling non-virtual methods, virtual methods, member access, calling dtors, and a myriad of other things; almost anything other than <code>return;</code> on the next line and somehow every other pointer to <code>*this</code> being cleaned up <em>before</em> you <code>delete this;</code> (or deterministically never being used).</p>\n\n<p>As a general rule, the level of control you have to have over your objects lifetime is so great to make <code>delete this;</code> safe that you can refactor the lifetime management to be <em>external</em> to the class and in a smart resource owner, which maybe maintains its state as a <code>pImpl</code> which it deletes.  <a href=\"/questions/tagged/c%2b%2b\" class=\"post-tag\" title=\"show questions tagged &#39;c++&#39;\" rel=\"tag\">c++</a> adores value types, and a type that <code>delete this;</code> can never be treated as a value.</p>\n\n<p>There is nothing in the standard that makes <code>delete this;</code> extra dangerous for <code>virtual</code> objects, other than the higher tendency to inherit.</p>\n\n<p>All types that <code>delete this;</code> should have either a virtual destructor <em>or</em> be <code>final</code> to avoid inheritance issues.</p>\n"}], "owner": {"reputation": 2666, "user_id": 1698548, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jAkw5.jpg?s=128&g=1", "display_name": "Kristian Spangsege", "link": "https://stackoverflow.com/users/1698548/kristian-spangsege"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 48085636, "answer_count": 1, "score": 9, "last_activity_date": 1515059767, "creation_date": 1515015746, "last_edit_date": 1515059767, "question_id": 48085528, "link": "https://stackoverflow.com/questions/48085528/is-is-safe-to-delete-this-in-a-virtual-member-function", "title": "Is is safe to `delete this` in a virtual member function?", "body": "<p>I know already that some forms of \"suicide\" are safe (to be considered legal), but, is it specifically safe to perform <code>delete this</code> in a virtual member function?</p>\n\n<p>Note, by \"safe\", I mean whether the \"code\" generated by the compiler is able to deal with the construct.</p>\n\n<p>Note, I'm not interested in the pros and cons of doing it, just whether I can consider is safe.</p>\n\n<p><strong>Side question:</strong> Does the language standard explicitly or implicitly demand that implementations support any forms of the <code>delete this</code> idiom?</p>\n\n<p>I do not consider this a duplicate of <a href=\"https://stackoverflow.com/questions/3150942/is-delete-this-allowed\">Is delete this allowed?</a>. My question is about whether it is safe to do in a virtual member function.</p>\n\n<p>Here is an outline of what I am pursuing to do</p>\n\n<pre><code>class FooBase {\nprotected:\n    virtual void on_idle() { /* no-op by default */ }\n};\n\nclass Foo : public FooBase {\n    void on_idle() override final\n    {\n        delete this;\n    }\n};\n</code></pre>\n\n<p>Note that while <code>Foo</code> needs to be heap allocated, other subclasses possibly do not.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1515015445, "post_id": 48085451, "comment_id": 83145854, "body": "You don&#39;t need it. Why did you put it there in the first place?"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1515015508, "post_id": 48085451, "comment_id": 83145887, "body": "The example <a href=\"http://en.cppreference.com/w/cpp/iterator/ostream_iterator/operator%3D\" rel=\"nofollow noreferrer\">here</a> says it&#39;s optional. It has some examples that use it and some that don&#39;t."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1515018938, "post_id": 48085451, "comment_id": 83147232, "body": "See also the documentation for the <code>OutputIterator</code>  (of which <code>ostream_iterator</code> is an implementation). <a href=\"http://en.cppreference.com/w/cpp/concept/OutputIterator\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/concept/OutputIterator</a>"}], "answers": [{"comments": [{"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 1, "creation_date": 1515018850, "post_id": 48085501, "comment_id": 83147210, "body": "Note: The output iterator expects a call to <code>operator++</code> between each write using <code>operator*</code>. So using the <code>*i2++</code> seems like a natural way of doing it. <a href=\"http://en.cppreference.com/w/cpp/concept/OutputIterator\" rel=\"nofollow noreferrer\">doc</a> =&gt; <code>Assignment through an output iterator is expected to alternate with incrementing.</code>"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1515018966, "post_id": 48085501, "comment_id": 83147242, "body": "@LokiAstari That&#39;s what I was trying to explain in the first paragraph; I hope it was clear. Conceptually, the increment is important and makes sense, but in this special case, it&#39;s redundant."}], "tags": [], "owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "is_accepted": true, "score": 2, "last_activity_date": 1515016499, "last_edit_date": 1515016499, "creation_date": 1515015543, "answer_id": 48085501, "question_id": 48085451, "link": "https://stackoverflow.com/questions/48085451/dereferencing-and-increment-with-ostream-iterator/48085501#48085501", "title": "Dereferencing and increment with ostream_iterator", "body": "<p>Conceptually, when writing to a range, you'd want to move to the next element after writing to one. For most iterators, like e.g. a <code>std::vector::iterator</code>, that has to be done explicitly. So it kind of makes sense to include it, if only for consistency.</p>\n\n<p>In the particular case of <code>std::ostream_iterator</code>, it does not have an actual effect though, and could be left out. You cannot overwrite an \"element\" of the output range anyways, advancing is implicit (and only implicit, i.e. both the increment operators as well as derefencing are no-ops in this context).</p>\n\n<p>The important part is only the <a href=\"http://en.cppreference.com/w/cpp/iterator/ostream_iterator/operator%3D\" rel=\"nofollow noreferrer\"><code>operator =</code></a>, as explained in the relevant documentation:</p>\n\n<blockquote>\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iterator&gt;\n\nint main()\n{\n    std::ostream_iterator&lt;int&gt; i1(std::cout, \", \");\n    *i1++ = 1; // usual form, used by standard algorithms\n    *++i1 = 2;\n    i1 = 3; // neither * nor ++ are necessary\n    std::ostream_iterator&lt;double&gt; i2(std::cout);\n    i2 = 3.14;\n}\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1515015866, "creation_date": 1515015866, "answer_id": 48085558, "question_id": 48085451, "link": "https://stackoverflow.com/questions/48085451/dereferencing-and-increment-with-ostream-iterator/48085558#48085558", "title": "Dereferencing and increment with ostream_iterator", "body": "<p>The <code>++</code> operator has no effect on <code>std::ostream_iterator</code>. Assigning to <code>*i2</code> automatically advances the output stream.</p>\n\n<p>It's provided so that <code>ostream_iterator</code> can be used anywhere that an ordinary iterator is allowed, and most iterators have to be incremented explicitly.</p>\n\n<p>Even with an ordinary iterator, it's generally only necessary to increment it if you use it multiple times. In the code snippet you found, where it's used just once, incrementing is totally unnecessary. It would be more reasonable if it were inside a loop.</p>\n"}], "owner": {"reputation": 351, "user_id": 5818405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e88b8610975407be5186aa3bd55a453c?s=128&d=identicon&r=PG&f=1", "display_name": "Mathieu Gemard", "link": "https://stackoverflow.com/users/5818405/mathieu-gemard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 48085501, "answer_count": 2, "score": 2, "last_activity_date": 1518734581, "creation_date": 1515015330, "last_edit_date": 1518734581, "question_id": 48085451, "link": "https://stackoverflow.com/questions/48085451/dereferencing-and-increment-with-ostream-iterator", "title": "Dereferencing and increment with ostream_iterator", "body": "<p>I found this code from <a href=\"http://en.cppreference.com/w/cpp/iterator/ostream_iterator/ostream_iterator\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/iterator/ostream_iterator/ostream_iterator</a> :</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;iterator&gt;\n#include &lt;algorithm&gt;\nint main()\n{\n    std::ostream_iterator&lt;int&gt; i1(std::cout, \", \");\n    std::fill_n(i1, 5, -1);\n    std::ostream_iterator&lt;double&gt; i2(std::cout);\n    *i2++ = 3.14;\n}\n</code></pre>\n\n<p>Why do you need the <code>++</code> in <code>*i2++ = 3.14;</code>?</p>\n"}, {"tags": ["c++", "sdl-2", "line-drawing"], "comments": [{"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1515048148, "post_id": 48085189, "comment_id": 83154330, "body": "SDL uses accelerated rendering backend (except for software renderer). Pushing pixel-by-pixel will always be terribly slow. If you can&#39;t cache result (i.e. it is changing quickly) then I can&#39;t think of easy solution (there are always harder solutions, like using gfx api directly with some shader tricks, etc.)."}, {"owner": {"reputation": 11, "user_id": 9169683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9086a342d94ecde0b233774e5ba46d4?s=128&d=identicon&r=PG&f=1", "display_name": "MacGlory", "link": "https://stackoverflow.com/users/9169683/macglory"}, "reply_to_user": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1515058621, "post_id": 48085189, "comment_id": 83159049, "body": "I see. accelerated rendering is a new notion for me so I did some research on the net. But I can&#39;t find how to use hardware acceleration in C++ or SDL. However, it seems that some others libraries such as SFML can do it, can&#39;t they ?"}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1515068547, "post_id": 48085189, "comment_id": 83165014, "body": "HW acceleration is usually available via one of graphics APIs, e.g. opengl, d3d, vulkan, etc.. SDL2 rendering functions use one of those. When you draw line - it sends line drawing to graphics API, which is likely to be performed by video card. This is just to explain why drawing many pixels is much slower."}, {"owner": {"reputation": 11, "user_id": 9169683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9086a342d94ecde0b233774e5ba46d4?s=128&d=identicon&r=PG&f=1", "display_name": "MacGlory", "link": "https://stackoverflow.com/users/9169683/macglory"}, "reply_to_user": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1515081110, "post_id": 48085189, "comment_id": 83172673, "body": "Okay I understand. So I have to learn more about OpenGL. Thank you for the your help"}], "owner": {"reputation": 11, "user_id": 9169683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9086a342d94ecde0b233774e5ba46d4?s=128&d=identicon&r=PG&f=1", "display_name": "MacGlory", "link": "https://stackoverflow.com/users/9169683/macglory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515013888, "creation_date": 1515013888, "question_id": 48085189, "link": "https://stackoverflow.com/questions/48085189/is-there-an-efficient-xiaolin-wus-line-function-with-sdl-or-an-add-on", "title": "Is there an efficient Xiaolin Wu&#39;s line function with SDL (or an add on)?", "body": "<p>I made a program in C++ with SDL2 which draws a curve from a list of points by linking them with lines. I'm using the SDL_RenderDrawLine function, which is based on Bresenham's algorithm, I assume.</p>\n\n<p>Then I made an other function based on Xiaolin Wu's algorithm to replace the SDL one (because it's smoother). It works well, but it is much (much!) slower than the SDL function. In fact I struggle to draw more than a dozen of lines per second, wheras I can draw thousands of lines per second with SDL function without any problem.</p>\n\n<p>So I am looking for an SDL Library where Xiaolin Wu's algorithm is already implemented, because computer scientists are of course better than me. Does this Library exists ? Or do I have to do it myself ?</p>\n\n<p>If I have to do it myself, do you have tips to improve my function ? Here it is, based on Wikipedia pseudo-code :</p>\n\n<pre><code>void drawXWLine(SDL_Renderer *renderer, double x1, double y1, double x2, double y2, SDL_Color color, uint8_t a)\n{\n    double dx = x2 - x1;\n    double dy = y2 - y1;\n\n    if (abs(dx) &gt; abs(dy)) // horizontal lines\n    {\n        if (x2 &lt; x1)\n        {\n            // swap the two points\n        }\n\n        double gradient = dy / dx;\n\n        // draw the extreme points of the line\n        int xend, xpxl1, xpxl2, ypxl1, ypxl2;\n        double yend, xgap, intery;\n        xend = round(x1);\n        yend = y1 + gradient * (xend - x1);\n        xgap = 1.0 - mod(x1 + 0.5, 1.0);\n        xpxl1 = xend;\n        ypxl1 = int(yend);\n        SDL_SetRenderDrawColor(renderer, color.r, color.g, color.b, uint8_t((1.0 - mod(yend, 1.0)) * xgap * a));\n        SDL_RenderDrawPoint(renderer, xpxl1, ypxl1);\n        SDL_SetRenderDrawColor(renderer, color.r, color.g, color.b, uint8_t(mod(yend, 1.0) * xgap * a));\n        SDL_RenderDrawPoint(renderer, xpxl1, ypxl1+1);\n        intery = yend + gradient;\n\n        xend = round(x2);\n        yend = y2 + gradient * (xend - x2);\n        xgap = 1.0 - mod(x2 + 0.5, 1.0);\n        xpxl2 = xend;\n        ypxl2 = int(yend);\n        SDL_SetRenderDrawColor(renderer, color.r, color.g, color.b, uint8_t((1.0 - mod(yend, 1.0)) * xgap * a));\n        SDL_RenderDrawPoint(renderer, xpxl2, ypxl2);\n        SDL_SetRenderDrawColor(renderer, color.r, color.g, color.b, uint8_t(mod(yend, 1.0) * xgap * a));\n        SDL_RenderDrawPoint(renderer, xpxl2, ypxl2+1);\n\n        // draw the whole line\n        for(int x = xpxl1 + 1 ; x &lt; xpxl2 ; x++)\n        {\n            SDL_SetRenderDrawColor(renderer, color.r, color.g, color.b, uint8_t((1.0 - mod(intery, 1.0)) * xgap * a));\n            SDL_RenderDrawPoint(renderer, x, int(intery));\n            SDL_SetRenderDrawColor(renderer, color.r, color.g, color.b, uint8_t(mod(intery, 1.0) * xgap * a));\n            SDL_RenderDrawPoint(renderer, x, int(intery)+1);\n\n            intery += gradient;\n        }\n    }\n    else\n    {\n        // do the same with vertical lines\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "pointers"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1515013689, "post_id": 48085116, "comment_id": 83145163, "body": "Use <code>delete[]</code> with <code>new[]</code>. Not <code>delete</code>."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 2, "creation_date": 1515013727, "post_id": 48085116, "comment_id": 83145186, "body": "You did also not implement <code>operator=()</code>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1515013751, "post_id": 48085116, "comment_id": 83145194, "body": "You should read about the <a href=\"http://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">rule of 3/5/0</a>. You will run into problems due to a missing assignment operator."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1515013764, "post_id": 48085116, "comment_id": 83145201, "body": "The problem isn&#39;t really the copy-constructor, but the copy-<b><i>assignment</i></b>. I suggest you learn about <a href=\"http://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">the rules of three, five and zero</a> (of which I personally recommend the last)."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1515013771, "post_id": 48085116, "comment_id": 83145208, "body": "Consider using smart pointers rather than managing memory yourself."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1515013780, "post_id": 48085116, "comment_id": 83145214, "body": "Don&#39;t check for <code>NULL</code> before deleting, just delete."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1515013798, "post_id": 48085116, "comment_id": 83145225, "body": "@Someprogrammerdude <code>Vector a(b);</code> seems like a copy to me."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1515013821, "post_id": 48085116, "comment_id": 83145230, "body": "@Fran&#231;oisAndrieux Yes you&#39;re right, missed that. Updated my comment."}, {"owner": {"reputation": 99, "user_id": 7694900, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005888287904/picture?type=large", "display_name": "Mohammed Ait", "link": "https://stackoverflow.com/users/7694900/mohammed-ait"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1515013857, "post_id": 48085116, "comment_id": 83145249, "body": "@Fran&#231;oisAndrieux I used it. AND, I still have the problem.  Thanks"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1515013877, "post_id": 48085116, "comment_id": 83145258, "body": "@MohammedAit You are using <code>delete</code> which is not the same as <code>delete[]</code>."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1515014913, "post_id": 48085116, "comment_id": 83145628, "body": "You have edited your question, and now it&#39;s ambiguous. Is it about the crash and why it happens? Or is it about why assignment isn&#39;t the same as copy-construction? Please clarify. And please <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>."}, {"owner": {"reputation": 99, "user_id": 7694900, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005888287904/picture?type=large", "display_name": "Mohammed Ait", "link": "https://stackoverflow.com/users/7694900/mohammed-ait"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1515015155, "post_id": 48085116, "comment_id": 83145740, "body": "@Someprogrammerdude The copy constructor cout &quot;Copy constructor&quot; on the screen when it&#39;s used. And, I think the = operator should call the copy constructor on this case :  a=Vector(12); BUT, I don&#39;t see &quot;Copy constructor&quot; message on my screen.  Thanks"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1515015291, "post_id": 48085116, "comment_id": 83145796, "body": "The correct thing to do is avoid <code>new</code> and <code>delete</code> altogether and use a smart pointer like <code>unique_ptr</code>. That said, your user-provided constructor does not set the pointer to NULL so destructor exhibits undefined behavior."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1515016854, "post_id": 48085116, "comment_id": 83146456, "body": "@AndyG &quot;<i>use a smart pointer like <code>unique_ptr</code></i>&quot; - in this example, using <code>std::vector</code> would make more sense."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 7694900, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005888287904/picture?type=large", "display_name": "Mohammed Ait", "link": "https://stackoverflow.com/users/7694900/mohammed-ait"}, "edited": false, "score": 0, "creation_date": 1515016718, "post_id": 48085522, "comment_id": 83146399, "body": "YOU ARE GREAT! Please, share with me some best books you read on programming.  I read &quot;Programming for Engineers A Foundational Approach to Learning C and Matlab&quot; I like it. Thanks"}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 5, "last_activity_date": 1515016079, "last_edit_date": 1515016079, "creation_date": 1515015703, "answer_id": 48085522, "question_id": 48085116, "link": "https://stackoverflow.com/questions/48085116/double-free-error-on-a-c-copy-constructor/48085522#48085522", "title": "Double free error on a C++ copy constructor", "body": "<p>With the expression</p>\n\n<pre><code>a = Vector(12)\n</code></pre>\n\n<p>a few things are happening:</p>\n\n<ol>\n<li><p>First a new <em>temporary</em> <code>Vector</code> object is created (from <code>Vector(12)</code>). This is constructed using the <code>Vector(int)</code> constructor.</p></li>\n<li><p>The temporary object is <em>assigned</em> to <code>a</code>, using <code>a.operator=(&lt;temporary object&gt;)</code>.</p>\n\n<p>The default compiler-generated <code>operator=</code> function does a simple member-wise assignment, i.e. it basically does <code>ptr = other.ptr</code>. This means you now have <em>two</em> objects <code>ptr</code> members pointing to the same memory: The temporary object, and <code>a</code>.</p></li>\n<li><p>The temporary object is destructed once the assignment is made. This means the memory occupied by that object is passed to <code>delete</code> (which <em>really</em> should be <code>delete[]</code>).</p>\n\n<p>This of course means that <code>a.ptr</code> is no longer pointing to valid memory, and when it later goes out of scope and is destructed you try to <code>delete</code> the already deleted memory.</p></li>\n</ol>\n\n<p>There is <em>no</em> copy-construction going on here. It's all copy-assignment. Copy construction is only used on actual construction, when an object is created (temporary or not). I think you're confused because the <code>=</code> symbol can be used for copy-construction, as in</p>\n\n<pre><code>Vector a = b;  // This is a copy-construction\n               // The copy-constructor of `a` is called with\n               // a reference to `b` as argument\n               // It's equal to `Vector a(b)`\n</code></pre>\n\n<p>This is very different from assignment</p>\n\n<pre><code>a = b;  // This is a plain assignment\n        // It is equal to `a.operator=(b)`\n</code></pre>\n\n<hr>\n\n<p>The crash is solved by following one of <a href=\"http://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"noreferrer\">the rules of three, five or zero</a>.</p>\n\n<p>I also recommend you read e.g. <a href=\"http://en.cppreference.com/w/cpp/language/operators#Assignment_operator\" rel=\"noreferrer\">this canonical assignment operator reference</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1113, "user_id": 1788774, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/acwQG.jpg?s=128&g=1", "display_name": "excalibur1491", "link": "https://stackoverflow.com/users/1788774/excalibur1491"}, "is_accepted": false, "score": 0, "last_activity_date": 1515017128, "last_edit_date": 1515017128, "creation_date": 1515015828, "answer_id": 48085549, "question_id": 48085116, "link": "https://stackoverflow.com/questions/48085116/double-free-error-on-a-c-copy-constructor/48085549#48085549", "title": "Double free error on a C++ copy constructor", "body": "<p>You are creating a temporary <code>Vector</code> in the assignment <code>a = Vector(12)</code>, which is being assigned via <code>operator=</code> to <code>a</code>. The temporary <code>Vector</code> gets destroyed at the end of the assignment statement, and <code>a</code> gets destroyed at the end of the function. Both point at the same allocated array because you did not  define a copy-assignment <code>operator=</code>:</p>\n\n<p><a href=\"http://www.cplusplus.com/doc/tutorial/operators/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/doc/tutorial/operators/</a></p>\n"}], "owner": {"reputation": 99, "user_id": 7694900, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005888287904/picture?type=large", "display_name": "Mohammed Ait", "link": "https://stackoverflow.com/users/7694900/mohammed-ait"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1190, "favorite_count": 0, "accepted_answer_id": 48085522, "answer_count": 2, "score": 0, "last_activity_date": 1515017128, "creation_date": 1515013530, "last_edit_date": 1515014808, "question_id": 48085116, "link": "https://stackoverflow.com/questions/48085116/double-free-error-on-a-c-copy-constructor", "title": "Double free error on a C++ copy constructor", "body": "<p>I have a Double free or corruption (fasttop) error on this code.\nI think i missed something on the \"copy constructor\".</p>\n\n<pre><code>class Vector{\n\n    int taille;\n    int* ptr;\n\npublic:\n    Vector():taille(0), ptr(NULL){\n        ...\n    }\n\n    Vector(int n){\n        ...\n    }\n\n    //The most important one\n    Vector(const Vector&amp; source){\n        if(source.ptr != NULL){\n            taille = source.taille;\n            ptr = new int[taille];\n            for(int i=0;i&lt;taille;i++) ptr[i]=source.ptr[i];\n        }else{\n            taille=0;\n            ptr=NULL;\n        }\n        cout &lt;&lt; \"Copy constructor\" &lt;&lt; endl;\n    }\n\n    ~Vector(){\n        if(ptr!=NULL) delete ptr;\n    }\n};\n</code></pre>\n\n<p>And here's the test : </p>\n\n<pre><code>int main()\n{\n    Vector b(5);\n    Vector a(b);\n    a=Vector(12);\n    return 0;\n}\n</code></pre>\n\n<p><strong>The above = operator does not call the copy constructor. Why ?</strong></p>\n\n<p>It says : \"double free or corruption (fasttop)\"</p>\n"}, {"tags": ["c++", "visual-studio-2017"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1515014638, "post_id": 48085105, "comment_id": 83145519, "body": "There is no need to set any environment variables."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1515021968, "post_id": 48085105, "comment_id": 83148141, "body": "That is not a happy error message.  You&#39;d better check if c:\\windows\\system32\\setx.exe is still there.  If it is then you need to fix the PATH.  Ask for help with that at superuser.com"}], "answers": [{"tags": [], "owner": {"reputation": 349, "user_id": 1268239, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a630dfaab6d4db97f4741af6e4b3601c?s=128&d=identicon&r=PG&f=1", "display_name": "Suraj", "link": "https://stackoverflow.com/users/1268239/suraj"}, "is_accepted": false, "score": 0, "last_activity_date": 1515013448, "creation_date": 1515013448, "answer_id": 48085106, "question_id": 48085105, "link": "https://stackoverflow.com/questions/48085105/visual-studio-2017-command-setx-is-not-valid/48085106#48085106", "title": "Visual Studio 2017: Command &quot;setx&quot; is not valid", "body": "<p>Referring <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-options/how-to-set-environment-variables-for-the-visual-studio-command-line\" rel=\"nofollow noreferrer\">this</a> article by MS, it is clear that you need to open the <strong>Developer Command Prompt for VS 2017.</strong> Do so with administrative privileges.</p>\n\n<p>Then run above command in it to make it work.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9780706, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/2d43ffc587c3f25feb62391d880af828?s=128&d=identicon&r=PG", "display_name": "Rishabh", "link": "https://stackoverflow.com/users/9780706/rishabh"}, "is_accepted": false, "score": 0, "last_activity_date": 1526129653, "creation_date": 1526129653, "answer_id": 50306481, "question_id": 48085105, "link": "https://stackoverflow.com/questions/48085105/visual-studio-2017-command-setx-is-not-valid/50306481#50306481", "title": "Visual Studio 2017: Command &quot;setx&quot; is not valid", "body": "<p>Run command prompt as administrator\n(search cmd and when the search results are displayed, right click over the command prompt and select the \"run as administrator\" option.)</p>\n\n<p>Then just type the command and enjoy:)</p>\n"}], "owner": {"reputation": 349, "user_id": 1268239, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a630dfaab6d4db97f4741af6e4b3601c?s=128&d=identicon&r=PG&f=1", "display_name": "Suraj", "link": "https://stackoverflow.com/users/1268239/suraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 569, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1526129653, "creation_date": 1515013448, "last_edit_date": 1515018491, "question_id": 48085105, "link": "https://stackoverflow.com/questions/48085105/visual-studio-2017-command-setx-is-not-valid", "title": "Visual Studio 2017: Command &quot;setx&quot; is not valid", "body": "<p>I am trying some instructions for setting an Environment variable using visual studio for <a href=\"https://docs.opencv.org/2.4/doc/tutorials/introduction/windows_install/windows_install.html#windowssetpathandenviromentvariable\" rel=\"nofollow noreferrer\">opencv</a></p>\n\n<p>As per the instructions, I have to open the <strong>command window</strong> and run the following command in it</p>\n\n<pre><code>setx -m OPENCV_DIR D:\\OpenCV\\Build\\x64\\vc14\n</code></pre>\n\n<p>But doing so is resulting in an error as <strong>Command \"setx\" is not valid</strong></p>\n\n<p>How to proceed?</p>\n"}, {"tags": ["c++", "opengl", "glm-math", "wavefront"], "comments": [{"owner": {"reputation": 8756, "user_id": 416274, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa38a4e372afb202e6ab7eb1619372a8?s=128&d=identicon&r=PG", "display_name": "Robinson", "link": "https://stackoverflow.com/users/416274/robinson"}, "edited": false, "score": 0, "creation_date": 1515023489, "post_id": 48085087, "comment_id": 83148528, "body": "I suppose you could use the assimp library and have it do this for you.  Though I understand doing it yourself is a good learning experience."}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 1, "creation_date": 1515028073, "post_id": 48085087, "comment_id": 83149590, "body": "You need to include the relevant parts of your code in the question.  As it is, this lacks a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5930979"}, "edited": false, "score": 0, "creation_date": 1515052497, "post_id": 48085087, "comment_id": 83156080, "body": "I&amp;#39;ve literally linked the entire renderer and pointed to the revelant line shown what I want addressed. I have shown the entire rendering process. Why are half the people on this site so obnoxious?!"}], "answers": [{"tags": [], "owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "is_accepted": true, "score": -1, "last_activity_date": 1515094363, "creation_date": 1515094363, "answer_id": 48102284, "question_id": 48085087, "link": "https://stackoverflow.com/questions/48085087/calculate-indices-from-a-vector-of-vec3-objects-by-finding-duplicate-vertices/48102284#48102284", "title": "Calculate indices from a vector of vec3 objects by finding duplicate vertices", "body": "<p>Using mapped buffers (by <code>glMapBuffer</code>) does not work in your case.\n<p>For example, if you want to know if a vertex has been already mapped (a duplicate) you should read all of currently mapped vertices, which is slow.\n<br>If you want to use a sorted array (so fast binary search can be used) then many portions of that mapped buffer must be re-written during the sorting/storing process. Slow too.</p>\n\n<p><p>A better option is to build your sorted vertices array on your own, on normal RAM. Be adviced of searching issues due to numerical matters when comparing two floats.</p>\n\n<p><p>On a second pass each index is just the position of the current vertex. Same advice for numerical issues.</p>\n\n<p><p>Data can be sent to the GPU by two simple <code>glBufferSubData</code>, one for vertices (and their colors and normals and etc) and another one for the indices.</p>\n\n<p><p>If the object moves (and you prefer to update coordinates instead of use a translation matrix) then it's right to use a mapped buffer with new coordinates (as you currently do). Indices don't change, so they don't need to be updated.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5930979"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "closed_date": 1515100263, "accepted_answer_id": 48102284, "answer_count": 1, "score": 1, "last_activity_date": 1515094363, "creation_date": 1515013376, "last_edit_date": 1515013571, "question_id": 48085087, "link": "https://stackoverflow.com/questions/48085087/calculate-indices-from-a-vector-of-vec3-objects-by-finding-duplicate-vertices", "closed_reason": "Needs details or clarity", "title": "Calculate indices from a vector of vec3 objects by finding duplicate vertices", "body": "<p>I am trying to build an .obj file importer that renders said model to the screen.\nAt present I have imported the vertices and they are stored in a</p>\n\n<pre><code>std::vector&lt;vec3&gt; vertices;\n</code></pre>\n\n<p>My renderer class quite large so I'll link github instead of posting it here.</p>\n\n<p><a href=\"https://github.com/rob-DEV/OpenGL-Model-Viewer/blob/master/OpenGL-Model-Viewer/src/graphics/renderer/renderer.cpp\" rel=\"nofollow noreferrer\">https://github.com/rob-DEV/OpenGL-Model-Viewer/blob/master/OpenGL-Model-Viewer/src/graphics/renderer/renderer.cpp</a></p>\n\n<p>So at line 41 in renderer.cpp. I submit these vertexs to the renderer. Originally I just drew triangles, but I would like to take advantage of GL_ELEMENTS</p>\n\n<p>My question is how (if possible) can I calculate these indices from a list of vertices? I have tried to find duplicates and do so when the model is loaded but i don't know how to map them.</p>\n"}, {"tags": ["c++", "regex"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1515013464, "post_id": 48085025, "comment_id": 83145067, "body": "There is a saying along the lines of &quot;I have a problem. I solved it using regexes. Now I have <i>two</i> problems!&quot; While regular expressions are powerful and can be used to beautifully solve some problems, it&#39;s not a silver bullet and can&#39;t be used to solve all problems. It&#39;s also very complex to use which easily leads to more problems than before. Unless you are <i>forced</i> to use regular expressions, I suggest you try to come up with a simpler solution not using them."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1515013602, "post_id": 48085025, "comment_id": 83145123, "body": "One way to simplify things is to split the input on the newline first, into a vector of strings in the format <code>&quot;key=value&quot;</code>. This can easily be done using <a href=\"http://en.cppreference.com/w/cpp/io/basic_istringstream\" rel=\"nofollow noreferrer\"><code>std::istringstream</code></a> and <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/getline\" rel=\"nofollow noreferrer\"><code>std::getline</code></a>. Once that is done it&#39;s very easy to split that into separate <code>&quot;key&quot;</code> and <code>&quot;value&quot;</code> strings (again you could use <code>std::istringstream</code> and <code>std::getline</code>, or even a simple regular expression)."}], "owner": {"user_type": "does_not_exist", "display_name": "user8209518"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 869, "favorite_count": 0, "closed_date": 1515013347, "answer_count": 0, "score": 0, "last_activity_date": 1515013069, "creation_date": 1515013069, "question_id": 48085025, "link": "https://stackoverflow.com/questions/48085025/what-is-the-c-global-regex-expression", "closed_reason": "Duplicate", "title": "What is the C++ global regex expression?", "body": "<p>In C++, I am trying to match this string. \"CREATE=NO\\nBOB=HI\" to grab the content after the = sign and it will not grab the char . When I run my program, it will only grab the first match which is NO.</p>\n\n<blockquote>\n  <p>matches[0] = CREATE=NO</p>\n  \n  <blockquote>\n    <p>matches[1] = NO</p>\n  </blockquote>\n</blockquote>\n\n<p>But for grabbing BOB=HI, it does not even match it. Here is my code.</p>\n\n<pre><code>int main() {\nstd::string parse = \"CREATE=NO\\nBOB=HI\";\nstd::cout &lt;&lt; parse &lt;&lt; std::endl;\nstd::string regexp = \"\\\\w+=(\\\\w+)\";\nstd::smatch matches;\nstd::regex regex(regexp);\nstd::regex_search(parse, matches, regex);\nstd::cout &lt;&lt; \"The size is \" &lt;&lt; matches.size() &lt;&lt; std::endl;\nfor (unsigned int i = 0; i &lt; matches.size(); i++) {\n    std::cout &lt;&lt; \"Matches \" &lt;&lt; i &lt;&lt; \": \" &lt;&lt; matches[i] &lt;&lt; std::endl;\n}\nstd::cin.get();\n</code></pre>\n\n<p>}</p>\n\n<blockquote>\n  <p>What I'm trying to do is get NO and HI but it only grabs NO</p>\n</blockquote>\n"}, {"tags": ["c++", "linux", "file-io", "filesystems", "c++17"], "answers": [{"comments": [{"owner": {"reputation": 1376, "user_id": 5190508, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9a505583a1564c89608a5dc393580654?s=128&d=identicon&r=PG&f=1", "display_name": "S.R", "link": "https://stackoverflow.com/users/5190508/s-r"}, "edited": false, "score": 0, "creation_date": 1515014911, "post_id": 48085135, "comment_id": 83145627, "body": "Yea. I hear about <code>rename()</code> is a good solution. So u vote just for simple <code>while</code>?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1515016423, "post_id": 48085135, "comment_id": 83146273, "body": "<a href=\"https://github.com/simongeilfus/Watchdog\" rel=\"nofollow noreferrer\">github.com/simongeilfus/Watchdog</a> is a work in progress for a cross-platform solution.  But in general, watching for filesystem changes is at the intersection of async and file io that is poorly standardized."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 3, "last_activity_date": 1515015045, "last_edit_date": 1515015045, "creation_date": 1515013624, "answer_id": 48085135, "question_id": 48084932, "link": "https://stackoverflow.com/questions/48084932/wait-for-file-to-exist-and-be-not-ocupated-by-others/48085135#48085135", "title": "Wait for file to exist and be not ocupated by others", "body": "<p>There's no cross-platform way to do this. The best way to do it is to write the file to a temporary name, then rename it to the file that the application is looking for. On most operating systems the <code>rename()</code> operation is atomic. Then the reading application can simply wait for the file to exist.</p>\n\n<p>So the structure of your waiting code could be (this is pseudo-code):</p>\n\n<pre><code>while (true) {\n    if (file_exists(filename)) {\n        process the file\n        remove the file\n    }\n    sleep(wait_time);\n}\n</code></pre>\n"}], "owner": {"reputation": 1376, "user_id": 5190508, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9a505583a1564c89608a5dc393580654?s=128&d=identicon&r=PG&f=1", "display_name": "S.R", "link": "https://stackoverflow.com/users/5190508/s-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 872, "favorite_count": 0, "accepted_answer_id": 48085135, "answer_count": 1, "score": 1, "last_activity_date": 1515015045, "creation_date": 1515012601, "question_id": 48084932, "link": "https://stackoverflow.com/questions/48084932/wait-for-file-to-exist-and-be-not-ocupated-by-others", "title": "Wait for file to exist and be not ocupated by others", "body": "<h2>Question</h2>\n\n<p>How can I monitor my file system to read file just after creation. This will work on Linux based system but it would be nice if solution would be cross-platform. Important requirement is that, there shouldn't be any other file descriptor that could write to that config file.</p>\n\n<p>I have read about <a href=\"http://man7.org/linux/man-pages/man7/inotify.7.html\" rel=\"nofollow noreferrer\">inotify</a> but this isn't cross-platform and required a lot of knowledge. I am curious about new c++17 file-system module.</p>\n\n<p><em>I can do it by simple <code>while(!fileexist(fielanme)) sleep(1);</code> But I curious abut more mature solutions</em></p>\n\n<h2>Background</h2>\n\n<p>I am writing application that can be configured from API (REST). But once configured can start easy (store configuration file). </p>\n\n<p>So I think its a good way to separate this task for two:</p>\n\n<ol>\n<li>REST -> just create file with conf.</li>\n<li>Main wait for file to exist and block file to be open by other in write mode while reading configuration.</li>\n</ol>\n"}, {"tags": ["c++", "multithreading", "templates", "unordered-map"], "answers": [{"comments": [{"owner": {"reputation": 554, "user_id": 1770034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/94179b72a263c9a963250f164a4b2371?s=128&d=identicon&r=PG", "display_name": "Questionable", "link": "https://stackoverflow.com/users/1770034/questionable"}, "edited": false, "score": 0, "creation_date": 1515012603, "post_id": 48084871, "comment_id": 83144663, "body": "Would there be any benefit/disadvantage to having the signature read <code>void add(KeyType&amp;&amp; key, valueType&amp;&amp; value)</code>?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 554, "user_id": 1770034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/94179b72a263c9a963250f164a4b2371?s=128&d=identicon&r=PG", "display_name": "Questionable", "link": "https://stackoverflow.com/users/1770034/questionable"}, "edited": false, "score": 1, "creation_date": 1515012710, "post_id": 48084871, "comment_id": 83144711, "body": "@Questionable - Other than forcing a move on the caller side for all types, no. If you want to add perfect forwarding, I updated my answer."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 5, "last_activity_date": 1515012671, "last_edit_date": 1515012671, "creation_date": 1515012321, "answer_id": 48084871, "question_id": 48084801, "link": "https://stackoverflow.com/questions/48084801/stdunordered-map-doesnt-accept-stdthread-when-it-is-wrapped-in-a-class/48084871#48084871", "title": "std::unordered_map doesn&#39;t accept std::thread when it is wrapped in a class", "body": "<p>You are accepting the value type by value already. Since the function parameter is local, you may move it (and may as well move the key too)</p>\n\n<pre><code>void add(KeyType key, valueType value)\n{\n    mapper.emplace(std::move(key), std::move(value));\n}\n</code></pre>\n\n<p>There's also no need to use <code>std::make_pair</code> to emplace into the map.</p>\n\n<p>If you want to be a bit more sophisticated, you may add some perfect forwarding support to <code>add</code>, so as to avoid creating superfluous intermediate objects.</p>\n\n<pre><code>template&lt;typename... Args&gt;\nvoid add(Args&amp;&amp;... args)\n{\n    mapper.emplace(std::forward&lt;Args&gt;(args)...);\n}\n</code></pre>\n"}], "owner": {"reputation": 554, "user_id": 1770034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/94179b72a263c9a963250f164a4b2371?s=128&d=identicon&r=PG", "display_name": "Questionable", "link": "https://stackoverflow.com/users/1770034/questionable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 48084871, "answer_count": 1, "score": 2, "last_activity_date": 1515012671, "creation_date": 1515011997, "question_id": 48084801, "link": "https://stackoverflow.com/questions/48084801/stdunordered-map-doesnt-accept-stdthread-when-it-is-wrapped-in-a-class", "title": "std::unordered_map doesn&#39;t accept std::thread when it is wrapped in a class", "body": "<p>If I try to save an <code>int</code> and a <code>std::thread</code> in an <code>std::unordered_map&lt;int, std::thread&gt;</code> everything seems to work fine.</p>\n\n<p>But if I wrap the <code>std::unordered_map</code>, then I get an error in the standard library. </p>\n\n<p>The error is: <code>no matching constructor for initialization of '_Mypair'</code></p>\n\n<p>Is there a way to get around this and make it work when it is wrapped?</p>\n\n<p>This works:</p>\n\n<p><strong>Source.cpp</strong></p>\n\n<pre><code>#include &lt;thread&gt;\n#include &lt;unordered_map&gt;\n\nvoid display() {}\n\nint main()\n{\n    std::unordered_map&lt;int, std::thread&gt; map_;\n    std::thread tempThread(&amp;display);\n    map_.emplace(0, std::move(tempThread));\n\n    return 0;\n}\n</code></pre>\n\n<p>This doesn't work:</p>\n\n<p><strong>MapperWrapper.h</strong></p>\n\n<pre><code>#ifndef MAPPERWRAPPER_H\n#define MAPPERWRAPPER_H\n\n#include &lt;unordered_map&gt;\n#include &lt;utility&gt;\n\ntemplate &lt;typename KeyType, typename valueType&gt; class MapperWrapper\n{\n    public:\n        void add(KeyType key, valueType value)\n        {\n            mapper.emplace(std::make_pair(key, value));\n        }\n\n    protected:\n        std::unordered_map&lt;KeyType, valueType&gt; mapper;\n};\n#endif // MAPPERWRAPPER_H\n</code></pre>\n\n<p><strong>Source.cpp</strong></p>\n\n<pre><code>#include &lt;thread&gt;\n#include \"MapperWrapper.h\"\n\nvoid display() {}\n\nint main()\n{\n    MapperWrapper&lt;int, std::thread&gt; map_;\n    std::thread tempThread(&amp;display);\n    map_.add(0, std::move(tempThread));\n\n    return 0;\n}\n</code></pre>\n\n<p>This generates the error:</p>\n\n<pre><code>||=== Build: Debug in Testing (compiler: LLVM Clang Compiler) ===|\nC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\utility|327|error: no matching constructor for initialization of '_Mypair' (aka 'pair&lt;int, std::thread&gt;')|\nC:\\Users\\usr\\Desktop\\Project2\\Project2\\MapperWrapper.h|12|in instantiation of function template specialization 'std::make_pair&lt;int &amp;, std::thread &amp;&gt;' requested here|\nC:\\Users\\usr\\Desktop\\Project2\\Project2\\Source.cpp|12|in instantiation of member function 'MapperWrapper&lt;int, std::thread&gt;::add' requested here|\nC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\utility|96|note: candidate template ignored: requirement 'is_copy_constructible&lt;thread&gt;::value' was not satisfied [with _Uty1 = int, _Uty2 = std::thread]|\nC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\utility|107|note: candidate template ignored: requirement 'is_copy_constructible&lt;thread&gt;::value' was not satisfied [with _Uty1 = int, _Uty2 = std::thread]|\nC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\utility|167|note: candidate template ignored: requirement 'is_constructible&lt;thread, thread &amp;&gt;::value' was not satisfied [with _Other1 = int &amp;, _Other2 = std::thread &amp;]|\nC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\utility|181|note: candidate template ignored: requirement 'is_constructible&lt;thread, thread &amp;&gt;::value' was not satisfied [with _Other1 = int &amp;, _Other2 = std::thread &amp;]|\nC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\utility|85|note: candidate constructor template not viable: requires 0 arguments, but 2 were provided|\nC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\utility|121|note: candidate constructor template not viable: requires single argument '_Right', but 2 arguments were provided|\nC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\utility|132|note: candidate constructor template not viable: requires single argument '_Right', but 2 arguments were provided|\nC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\utility|150|note: candidate constructor template not viable: requires 4 arguments, but 2 were provided|\nC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\utility|157|note: candidate constructor template not viable: requires 3 arguments, but 2 were provided|\nC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\utility|195|note: candidate constructor template not viable: requires single argument '_Right', but 2 arguments were provided|\nC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\utility|209|note: candidate constructor template not viable: requires single argument '_Right', but 2 arguments were provided|\nC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\utility|112|note: candidate constructor not viable: requires 1 argument, but 2 were provided|\nC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\utility|113|note: candidate constructor not viable: requires 1 argument, but 2 were provided|\n||=== Build failed: 1 error(s), 0 warning(s) (0 minute(s), 0 second(s)) ===|\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1143, "user_id": 8759952, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d8e784fa5cd3e5a2dfe13b405fc1de1?s=128&d=identicon&r=PG&f=1", "display_name": "Liora Haydont", "link": "https://stackoverflow.com/users/8759952/liora-haydont"}, "edited": false, "score": 0, "creation_date": 1515011978, "post_id": 48084774, "comment_id": 83144371, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2872543/printf-vs-cout-in-c\">&#39;printf&#39; vs. &#39;cout&#39; in C++</a>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1515011985, "post_id": 48084774, "comment_id": 83144379, "body": "This is not a programming question. This is a question about your operating system. In general, the standard output is not a physical file but a virtual file that represents a pipe, stream or device."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1515012039, "post_id": 48084774, "comment_id": 83144401, "body": "it prints to <code>stdout</code>, whatever that happens to be when you run the program."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1515012061, "post_id": 48084774, "comment_id": 83144410, "body": "<i>It seems to me that printf does print to a file, but to what file?</i> Incorrect. The <code>f</code> of <code>printf</code> stands for &quot;formatted&quot;, not &quot;file&quot;. <code>fprintf</code> prints to a file. <code>printf</code> prints to <code>stdout</code>, same as <code>std::cout</code>. See <a href=\"http://en.cppreference.com/w/cpp/io/c/fprintf\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/io/c/fprintf</a>."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1515012426, "post_id": 48084774, "comment_id": 83144573, "body": "The output destination of <code>printf</code> is platform dependent.  Some embedded systems don&#39;t have output, so it doesn&#39;t go anywhere.  Some windowing frameworks don&#39;t display the output because there needs to be a text window to display to."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1515012815, "post_id": 48084774, "comment_id": 83144769, "body": "@Fran&#231;oisAndrieux: I disagree, it is a programming question. It&#39;s about where the output of a C++ program goes."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1515012883, "post_id": 48084774, "comment_id": 83144804, "body": "Have you <i>tried</i> something?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1515013116, "post_id": 48084774, "comment_id": 83144919, "body": "@KeithThompson I feel the answer to the question is beyond the scope of the language. It seems no different to me than if the question asked &quot;where does user input come from?&quot;. It&#39;s given to you by the operating system. The answer to this question is entirely dependent on the operating system used and nearly language agnostic."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1515013248, "post_id": 48084774, "comment_id": 83144970, "body": "@Fran&#231;oisAndrieux: it goes to <i>standard output</i>, and the C and C++ language standards have a fair amount to say about what that means."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1515013511, "post_id": 48084774, "comment_id": 83145083, "body": "After rereading the question, you may be confused by the assumption that <code>printf</code> and <code>cout</code> have distinct goals. They are both used to print to the standard output. <code>printf</code> is inherited by c++ from c where as <code>std::cout</code> was designed specifically for c++."}], "answers": [{"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 1, "last_activity_date": 1515019728, "last_edit_date": 1515019728, "creation_date": 1515013215, "answer_id": 48085056, "question_id": 48084774, "link": "https://stackoverflow.com/questions/48084774/where-does-a-c-program-print-to/48085056#48085056", "title": "Where does a c++ program print to?", "body": "<p>For some output operations, you have to specify a file/stream to which the output is to be sent. The <code>fprintf</code> function (from the C library) is an example of this. Its first argument is of type <code>FILE*</code>, and it has to refer to a file that you've opened -- or to one of the default pre-opened files. The C++-specific <code>std::cout &lt;&lt; \"hello\\n\"</code> is another example; <code>std::cout</code> is a pre-opened output stream.</p>\n\n<p>For other operations, such as <code>printf</code>, the place where the output goes is implicit. <code>printf(args...)</code> is defined to be equivalent to <code>fprintf(stdout, args...)</code>.</p>\n\n<p>The C <code>stdout</code> (which is of type <code>FILE*</code>) and the C++ <code>std::cout</code> (which is of a type derived from <code>std::basic_ostream</code>) both refer to the <em>standard output</em>. That's an output stream that's opened for you by the environment as your program starts executing.</p>\n\n<p>The actual location where output sent to <em>standard output</em> goes depends on the operating system and on how you invoked your program. Typically it will be printed to the current terminal window by default. (On older systems it might have been a text-only terminal screen or a hard-copy terminal.) And most operating systems provide ways to redirect standard output, such as:</p>\n\n<pre><code>your_program &gt; output.txt\n</code></pre>\n\n<p>or</p>\n\n<pre><code>your_program | another_program\n</code></pre>\n\n<p>or</p>\n\n<pre><code>your_program &gt; /dev/null\n</code></pre>\n\n<p>These (attempt to) send the output to a specified file, to the input of another program, or to a device that discards all input sent to it.</p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1515015241, "last_edit_date": 1592644375, "creation_date": 1515013678, "answer_id": 48085147, "question_id": 48084774, "link": "https://stackoverflow.com/questions/48084774/where-does-a-c-program-print-to/48085147#48085147", "title": "Where does a c++ program print to?", "body": "<blockquote>\n<p>but what about when you just use, for example, printf?</p>\n</blockquote>\n<p><code>printf</code> outputs to the standard output stream.</p>\n<blockquote>\n<p>Does this not print something on the command line</p>\n</blockquote>\n<p>Possibly and typically yes. The shell controls where the standard output is streamed to. Unless the output is redirected, standard output is shown on the command line.</p>\n<blockquote>\n<p>(but then this is what cout does?)</p>\n</blockquote>\n<p>Yes. <code>std::cout</code> also prints to the standard output stream.</p>\n<hr />\n<p>To understand what an input / output stream is, you can read about it from the <a href=\"http://pubs.opengroup.org/onlinepubs/7908799/xsh/stdio.html\" rel=\"nofollow noreferrer\">Single UNIX Specification</a>. UNIX is not part of C++ standard, but the C++ standard uses the same concept of standard streams.</p>\n<blockquote>\n<p>A stream is associated with an external file (which may <sup>\u2020</sup> be a physical device) ...</p>\n<p>...</p>\n<p>At program startup, three streams are predefined and need not be opened explicitly: standard input (for reading conventional input), standard output (for writing conventional output), and standard error (for writing diagnostic output) ...</p>\n</blockquote>\n<p><sup>\u2020</sup> but is not necessarily be a physical device, nor is it necessarily something that is stored on a disk.</p>\n"}], "owner": {"reputation": 291, "user_id": 5836440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b5440c34109e218b55c29d2450159ee?s=128&d=identicon&r=PG&f=1", "display_name": "Meep", "link": "https://stackoverflow.com/users/5836440/meep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1515019728, "creation_date": 1515011874, "last_edit_date": 1515012492, "question_id": 48084774, "link": "https://stackoverflow.com/questions/48084774/where-does-a-c-program-print-to", "title": "Where does a c++ program print to?", "body": "<p>You can specify the file to which values calulcated within some program are outputed using fout, but what about when you just use, for example, printf? Does this not print something on the command line (but then this is what cout does?) It seems to me that printf does print to a file, but to what file?</p>\n\n<p>Just to note that I have seen the post <a href=\"http:////%20Print%20out%20the%20state%20(x,v,Energies,J)%20in%20columns%20void%20showState%20(%20particle%20&amp;a%20,%20ostream%20&amp;fout%20)%20%7B%20%20%20for%20(%20int%20i%20=%200%20;%20i%20%3C%20D%20;%20i++%20)%20%7B%20%20%20%20%20%20fout%20%3C%3C%20%22%5Ct%22%3C%3Ca.x[i];%20%20%20%7D%20%20%20for%20(%20int%20i%20=%200%20;%20i%20%3C%20D%20;%20i++%20)%20%7B%20%20%20%20%20%20fout%20%3C%3C%20%22%5Ct%22%3C%3Ca.v[i];%20%20%20%7D%20%20%20fout%20%3C%3C%20%22%5Ct%22%20%3C%3C%20a.T%20%20%20%20%20//%20KE%20%20%20%20%20%20%20%20%3C%3C%20%22%5Ct%22%20%3C%3C%20a.V%20%20%20%20%20//%20PE%20%20%20%20%20%20%20%20%3C%3C%20%22%5Ct%22%20%3C%3C%20a.T+a.V%20//%20Total%20E%20%20%20%20%20%20%20%20%3C%3C%20%22%5Ct%22%20%3C%3C%20a.J%20%20%20%20%20//%20Angular%20momentum%20%20%20%20%20%20%20%20%3C%3C%20endl;%20%20%20fout%20%3C%3C%20%22#%22%20;%20%20%20for%20(%20int%20i%20=%200%20;%20i%20%3C%20D%20;%20i++%20)%20%7B%20%20%20%20%20%20fout%20%3C%3C%20%22%5Ctx[%22%3C%3Ci%3C%3C%22]%5Ct%22;%20%20%20%7D%20%20%20for%20(%20int%20i%20=%200%20;%20i%20%3C%20D%20;%20i++%20)%20%7B%20%20%20%20%20%20fout%20%3C%3C%20%22%5Ctv[%22%3C%3Ci%3C%3C%22]%5Ct%22;%20%20%20%7D%20%20%20fout%20%3C%3C%20%22%5CtT%5Ct%5CtV%5Ct%5CtT+V%5Ct%5CtJ%22%20;%20%20%20%20fout%20%3C%3C%20endl;%20%7D\" rel=\"nofollow noreferrer\">'printf' vs. 'cout' in C++</a> but the answers all seem to assume knowledge of what printf fundamentally <em>does</em> which is what I am having trouble understanding. </p>\n"}, {"tags": ["c++", "c++11", "sstream"], "comments": [{"owner": {"reputation": 3503, "user_id": 8918119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WBTsrNZGTro/AAAAAAAAAAI/AAAAAAAAAAA/TyVQT8y8hbc/photo.jpg?sz=128", "display_name": "Mihayl", "link": "https://stackoverflow.com/users/8918119/mihayl"}, "edited": false, "score": 1, "creation_date": 1515010874, "post_id": 48084507, "comment_id": 83143939, "body": "try to write/read the key and value separately. As @user9169574 you cannot get the size of the pair with std::string with sizeof"}, {"owner": {"reputation": 492, "user_id": 1755577, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/faf477c1a801a6b33d7f695d29b7884e?s=128&d=identicon&r=PG&f=1", "display_name": "Jishnu U Nair", "link": "https://stackoverflow.com/users/1755577/jishnu-u-nair"}, "edited": false, "score": 0, "creation_date": 1515010968, "post_id": 48084507, "comment_id": 83143973, "body": "I will try that. Thanks."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 3, "creation_date": 1515012168, "post_id": 48084507, "comment_id": 83144448, "body": "There&#39;s lots of issues here, but basically if you ever write serialization code for a generic data structure and you are not recursively calling serialize on the contained type, something is wrong. You&#39;re assuming that your keys and values are POD types; calling sizeof on a not-necessarily-pod types is code smell. Also, try not to use new and delete in such code; that is code smell too (and so is reinterpret_cast on a not-necessarily-pod type; lots of smells as you can see ;-) )."}, {"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "edited": false, "score": 0, "creation_date": 1515032376, "post_id": 48084507, "comment_id": 83150503, "body": "You should also use the default overloads for types to make them serializable: <code>template &lt;typename Key, typename T&gt; std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, const std::map&lt;Key, T&gt;&amp; map);</code>  Implement the serialization function in terms of C++ overloads. Then, any map with types that support <code>operator&lt;&lt;</code> will also be supported. It will also work for any output stream, not just stringstreams."}], "answers": [{"tags": [], "owner": {"reputation": 1940, "user_id": 2523211, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/wDa5B.jpg?s=128&g=1", "display_name": "ZivS", "link": "https://stackoverflow.com/users/2523211/zivs"}, "is_accepted": false, "score": 1, "last_activity_date": 1515283098, "creation_date": 1515283098, "answer_id": 48133112, "question_id": 48084507, "link": "https://stackoverflow.com/questions/48084507/serialize-stdmap-using-sstream/48133112#48133112", "title": "serialize std::map using sstream", "body": "<p>As @Nir Friedman mentioned, if you're implementing a serializer and not calling it recursivley on your container's elements you are probably doing something wrong.</p>\n\n<p>Making such recursive serialization means having POD types as the \"atoms\" (recursion ending condition) and the recursion step is to call the serializer on each member of a non-POD type.</p>\n\n<p>A simple way to accomplish what you want is by having a function template like:</p>\n\n<pre><code>template &lt;typename T&gt;\nuint64_t write(const T&amp; t);\n</code></pre>\n\n<p>The write function usually returns an unsigned integer of how many bytes were serialized. This templated function should be specialized for all PODs and for any non POD type you wish to serialize. So in your case in addition to <code>int</code>, <code>float</code>, <code>double</code>, <code>char</code>, etc.. you need <code>write(const std::map&lt;K,T&gt;&amp; m)</code> which goes over the map and for each key-value pair, calls <code>write</code>. Also usually for serialization,  you write a header before the actual data, so that you could deserialize the data (e.g how would you know how many elements the map contained?).</p>\n\n<p>Luckily (maybe) for you, the standard library has such a pattern (see \"decorator\" pattern) as mentioned by @ Alexander Huszagh, and that is the stream operator (<code>operator&lt;&lt;</code>) which can be called already on any POD type, so a (naive and) simple way to serialize a <code>std::map</code> would be:</p>\n\n<pre><code>template&lt;typename K, typename V&gt;\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, const std::map&lt;K,V&gt;&amp; m)\n{\n    os &lt;&lt; \"map\" &lt;&lt; '\\n';             //write the type\n    os &lt;&lt; m.size() &lt;&lt; '\\n'; //write the size of the data\n    for(auto&amp;&amp; kvp : m)\n    {\n        os &lt;&lt; \"pair\" &lt;&lt; '\\n';\n        os &lt;&lt; kvp.first &lt;&lt; '\\n';  //Recursive call here...\n        os &lt;&lt; kvp.second &lt;&lt; '\\n'; //Recursive call here...\n    }\n    return os;\n}\n</code></pre>\n\n<p>The above will be complicated to deserialize since the recursive calls might by just a number, char, or a string (with new lines) which will not have the \"header\" I added, but your code seems to assume it knows the <code>Key</code> and <code>Value</code> template arguments so it might be ok for you.</p>\n\n<p>Anyway, you should not try to write a serializer yourself, it is hard work to make it correct and generic and also an utter waste of time since there are plenty publicly available on the web.\nSince you are intersted in serializing a map, I would suggest using some JSON library.</p>\n"}], "owner": {"reputation": 492, "user_id": 1755577, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/faf477c1a801a6b33d7f695d29b7884e?s=128&d=identicon&r=PG&f=1", "display_name": "Jishnu U Nair", "link": "https://stackoverflow.com/users/1755577/jishnu-u-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 699, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515283098, "creation_date": 1515010511, "question_id": 48084507, "link": "https://stackoverflow.com/questions/48084507/serialize-stdmap-using-sstream", "title": "serialize std::map using sstream", "body": "<p>I'm working on serialising std::map using sstream in C++.\nSerialising function:</p>\n\n<pre><code>template &lt;class key, class value&gt;\nstd::string serializeMap(const std::map&lt;key, value&gt;&amp; v){\n    std::stringstream ss;\n    std::for_each(v.begin(), v.end(), [&amp;ss](const std::pair&lt;key, value&gt;&amp; s){\n            ss.write ((char*)&amp;s, sizeof(std::pair&lt;key,value&gt;));\n        });\n    return ss.str();\n}\n</code></pre>\n\n<p>And de-serialize using this:</p>\n\n<pre><code>template &lt;class key, class value&gt;\nvoid deSerializeMap(const std::string&amp; s, std::map&lt;key, value&gt;&amp; v){\n\n    std::stringstream ss1;\n\n    ss1&lt;&lt;s;\n\n    int pos = 0;\n    printf(\"\\nlen %d\\n\", s.size());\n    while(ss1){\n        char* ar = new char[sizeof(std::pair&lt;key, value&gt;)];\n        ss1.read(ar, sizeof(std::pair&lt;key, value&gt;));\n        v.insert(*(reinterpret_cast&lt;std::pair&lt;key, value&gt;*&gt;(ar)));\n        pos+=sizeof(std::pair&lt;key, value&gt;);\n        ss1.seekg(pos);\n        delete[] ar;\n    }\n\n}\n</code></pre>\n\n<p>This works as expected using <code>std::string</code>. I had to use a C function that takes <code>const char*</code> as an argument, I tried using <code>c_str()</code> and adding a \nNULL character to the char array, but <code>strlen</code> gives zero. Is there something I'm missing?</p>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1515009894, "post_id": 48084362, "comment_id": 83143543, "body": "<code>total_milk[0] == total_milk[3]</code> for example will check if <code>b_milk</code> is equal to <code>g_milk</code>"}, {"owner": {"reputation": 26796, "user_id": 4834, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6a04e124482c3750617f8dacde3388ce?s=128&d=identicon&r=PG", "display_name": "quamrana", "link": "https://stackoverflow.com/users/4834/quamrana"}, "edited": false, "score": 0, "creation_date": 1515009942, "post_id": 48084362, "comment_id": 83143571, "body": "Could you update the question with a function prototype which would give you the results you want?"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1515010544, "post_id": 48084362, "comment_id": 83143810, "body": "If <code>n = 7</code> is constant and the elements are easy to compare (like <code>int</code>), the trivial O(n**2) loop solution will probably good enough."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1515011938, "post_id": 48084362, "comment_id": 83144350, "body": "If the values are small integers then you can use a <code>std::bitset</code>. Otherwise, if the array size is fixed and small, just check each value against every other following value. Otherwise, use a <code>std::unordered_set</code>."}], "answers": [{"tags": [], "owner": {"reputation": 5867, "user_id": 9125195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75fc90d1f6de6ff28c739b85bdb82f4c?s=128&d=identicon&r=PG&f=1", "display_name": "Sid S", "link": "https://stackoverflow.com/users/9125195/sid-s"}, "is_accepted": false, "score": 5, "last_activity_date": 1515013548, "last_edit_date": 1515013548, "creation_date": 1515010220, "answer_id": 48084456, "question_id": 48084362, "link": "https://stackoverflow.com/questions/48084362/c-array-any-two-terms-are-equal/48084456#48084456", "title": "c++ array any two terms are equal", "body": "<p>Iterate over the elements in the array, adding each element to an unordered_set.</p>\n\n<p>The return value from <a href=\"http://en.cppreference.com/w/cpp/container/unordered_set/insert\" rel=\"nofollow noreferrer\">unordered_set::insert()</a> will tell you whether the element already was in the set.</p>\n"}, {"comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1515012239, "post_id": 48084571, "comment_id": 83144470, "body": "This is a good solution for a small array. The time increases as the square of the number of elements. For a large array it&#39;s therefore impractical."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1515012904, "post_id": 48084571, "comment_id": 83144818, "body": "@Cheersandhth.-Alf I agree. The <code>unordered_set::insert()</code> solution is quite elegant."}], "tags": [], "owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "is_accepted": false, "score": 3, "last_activity_date": 1515014585, "last_edit_date": 1515014585, "creation_date": 1515010846, "answer_id": 48084571, "question_id": 48084362, "link": "https://stackoverflow.com/questions/48084362/c-array-any-two-terms-are-equal/48084571#48084571", "title": "c++ array any two terms are equal", "body": "<p>Use two <a href=\"http://en.cppreference.com/w/cpp/language/for\" rel=\"nofollow noreferrer\">for loops</a> and compare each element with other elements:</p>\n\n<pre><code>bool anyTwo(total_milk a[], std::size_t n) {\n    for (std::size_t i = 0; i &lt; n - 1; i++) {\n        for (std::size_t j = i + 1; j &lt; n; j++) {\n            if (a[i] == a[j]) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\n</code></pre>\n\n<p>This assumes your overloaded the <code>==</code> operator in your class. The second <code>for</code> loop counter <code>j</code> starts from <code>i + 1</code> instead of <code>0</code> or <code>i</code> as there is no need to compare the already compared values or compare the element with itself.</p>\n"}, {"tags": [], "owner": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1549764802, "creation_date": 1549764802, "answer_id": 54612735, "question_id": 48084362, "link": "https://stackoverflow.com/questions/48084362/c-array-any-two-terms-are-equal/54612735#54612735", "title": "c++ array any two terms are equal", "body": "<p>The naive approach, which is fine for small data sets, is to simply use a comparison loop where each element is compared with every other element following it - there's no point comparing with those at or before an element since either the comparison has already been done or you will be comparing an item with itself.</p>\n\n<p>The following complete program illustrates this approach:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint milk[] = { 3, 1, 4, 1, 5, 9 };\nint main() {\n    for (size_t one = 0; one &lt; sizeof(milk) / sizeof(*milk) - 1; ++one) {\n        for (size_t two = first + 1; two &lt; sizeof(milk) / sizeof(*milk); ++two) {\n            if (milk[one] == milk[two]) {\n                std::cout &lt;&lt; \"Duplicate item: \" &lt;&lt; milk[one] &lt;&lt; '\\n';\n                return 1;\n            }\n        }\n    }\n    std::cout &lt;&lt; \"No duplicates\\n\";\n}\n</code></pre>\n\n<hr>\n\n<p>For larger data sets, you can turn to the more optimised collections provided by the C++ library, such as the sets. A set is able to hold <em>one</em> of each value and has the useful property that it will return the fact that you tried to insert a duplicate, by returning both an iterator to the inserted/original item <em>and</em> a boolean value indicating whether it was new or a duplicate.</p>\n\n<p>Like the earlier program, this one shows how you can use this method:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;unordered_set&gt;\n\nint milk[] = { 3, 1, 4, 1, 5, 9 };\nint main() {\n    std::unordered_set&lt;int&gt; checkSet;\n    for (auto val: milk) {\n        auto iterAndBool = checkSet.insert(val);\n        if (! iterAndBool.second) {\n            std::cout &lt;&lt; \"Duplicate item: \" &lt;&lt; val &lt;&lt; '\\n';\n            return 1;\n        }\n    }\n    std::cout &lt;&lt; \"No duplicates\\n\";\n}\n</code></pre>\n\n<hr>\n\n<p>A substantial improvement could be made to that using templates. This would allow it to handle arrays of <em>any</em> data type (assuming it has equality operators, of course) without have to code up specialisations for each. The code for that would be along the following lines:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;unordered_set&gt;\n\ntemplate&lt;class T&gt; T *CheckDupes(T *collection, size_t count) {\n    std::unordered_set&lt;T&gt; checkSet;\n    for (size_t idx = 0; idx &lt; count; ++idx) {\n        auto iterAndBool = checkSet.insert(collection[idx]);\n        if (! iterAndBool.second) {\n            return &amp;(collection[idx]);\n        }\n    }\n    return nullptr;\n}\n\nint milk[] = { 3, 1, 4, 1, 5, 9 };\nint main() {\n    int *dupe;\n    if ((dupe = CheckDupes&lt;int&gt;(milk, sizeof(milk) / sizeof(*milk))) != nullptr) {\n        std::cout &lt;&lt; \"Duplicate item: \" &lt;&lt; *dupe &lt;&lt; '\\n';\n        return 1;\n    }\n    std::cout &lt;&lt; \"No duplicates\\n\";\n}\n</code></pre>\n\n<p>The templated function above will either return <code>nullptr</code> (if there are no duplicates) or the address of one of the duplicates.  It's a simple matter to check that return value and act appropriately.</p>\n\n<hr>\n\n<p>I suspect <em>further</em> improvement could be made to handle other collection types (not just naked arrays) but I'll leave that as an exercise for when you've mastered simpler templates :-)</p>\n"}], "owner": {"reputation": 13, "user_id": 9048584, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Tova9iyBD8Q/AAAAAAAAAAI/AAAAAAAAAb4/_7kZ0k_HLeA/photo.jpg?sz=128", "display_name": "Jerry Xu", "link": "https://stackoverflow.com/users/9048584/jerry-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1549764844, "creation_date": 1515009759, "last_edit_date": 1549764844, "question_id": 48084362, "link": "https://stackoverflow.com/questions/48084362/c-array-any-two-terms-are-equal", "title": "c++ array any two terms are equal", "body": "<p>In an array, how do I check if any two variables are equal in something like  </p>\n\n<pre><code>total_milk[7] = { b_milk, e_milk, d_milk, g_milk, a_milk, m_milk, h_milk };\n</code></pre>\n\n<p>without using casework</p>\n"}, {"tags": ["c++", "linux", "qt", "debugging"], "comments": [{"owner": {"reputation": 3503, "user_id": 8918119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WBTsrNZGTro/AAAAAAAAAAI/AAAAAAAAAAA/TyVQT8y8hbc/photo.jpg?sz=128", "display_name": "Mihayl", "link": "https://stackoverflow.com/users/8918119/mihayl"}, "edited": false, "score": 0, "creation_date": 1515010559, "post_id": 48084335, "comment_id": 83143814, "body": "Have you tried clean, run qmake again and rebuild?"}, {"owner": {"reputation": 798, "user_id": 7926069, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/676fa367a40645d604de75ea6a7c3681?s=128&d=identicon&r=PG&f=1", "display_name": "Cobalt", "link": "https://stackoverflow.com/users/7926069/cobalt"}, "reply_to_user": {"reputation": 3503, "user_id": 8918119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WBTsrNZGTro/AAAAAAAAAAI/AAAAAAAAAAA/TyVQT8y8hbc/photo.jpg?sz=128", "display_name": "Mihayl", "link": "https://stackoverflow.com/users/8918119/mihayl"}, "edited": false, "score": 0, "creation_date": 1515010863, "post_id": 48084335, "comment_id": 83143937, "body": "@A.A yes, but it doesn&#39;t seem to make a difference"}, {"owner": {"reputation": 3503, "user_id": 8918119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WBTsrNZGTro/AAAAAAAAAAI/AAAAAAAAAAA/TyVQT8y8hbc/photo.jpg?sz=128", "display_name": "Mihayl", "link": "https://stackoverflow.com/users/8918119/mihayl"}, "edited": false, "score": 0, "creation_date": 1515011298, "post_id": 48084335, "comment_id": 83144103, "body": "It&#39;s strange that the file does not appear in the source view. And what&#39;s about these <code>projectdir</code> and <code>fullpathofprojectdir</code>? What about putting space after dir1 &quot;dir1 \\&quot;"}, {"owner": {"reputation": 798, "user_id": 7926069, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/676fa367a40645d604de75ea6a7c3681?s=128&d=identicon&r=PG&f=1", "display_name": "Cobalt", "link": "https://stackoverflow.com/users/7926069/cobalt"}, "reply_to_user": {"reputation": 3503, "user_id": 8918119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WBTsrNZGTro/AAAAAAAAAAI/AAAAAAAAAAA/TyVQT8y8hbc/photo.jpg?sz=128", "display_name": "Mihayl", "link": "https://stackoverflow.com/users/8918119/mihayl"}, "edited": false, "score": 0, "creation_date": 1515012643, "post_id": 48084335, "comment_id": 83144678, "body": "<code>projectdir</code> and <code>fullpathofprojectdir</code> are just my shorthand for where the root of the qt project is, sorry for the confusion.  I checked them with the terminal eg <code>nano projectdir&#47;dir1&#47;myclass.cpp</code> and it worked as expected. As for putting a space after dir1 in the top level .pro, there is one in the actual project but made a typo when I put it here. Good eye"}], "owner": {"reputation": 798, "user_id": 7926069, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/676fa367a40645d604de75ea6a7c3681?s=128&d=identicon&r=PG&f=1", "display_name": "Cobalt", "link": "https://stackoverflow.com/users/7926069/cobalt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 429, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515012680, "creation_date": 1515009662, "last_edit_date": 1515012680, "question_id": 48084335, "link": "https://stackoverflow.com/questions/48084335/cant-step-into-break-on-my-code-with-qt-creator", "title": "Can&#39;t step into/break on my code with qt creator", "body": "<p>I have created a project in qt creator with multiple subdirs and am deploying/running it on a beaglebone. Compiles fine, deploys fine, etc. </p>\n\n<p>My issue is that when I try to debug, the only files I can set breakpoints in or step into are those in the same subdir where main.cpp is. Just to test, I duplicated the project with a flat folder structure and can set breakpoints and step into everything. </p>\n\n<p>When the debugger starts up, the debug log tries to set the breakpoints and fails seemingly because it can't find the .cpp files:</p>\n\n<blockquote>\n  <p>\"No source file named projectdir/dir1/myclass.cpp.\\n\"\n  8045^done,bkpt={number=\"1\",type=\"breakpoint\",disp=\"keep\",enabled=\"y\",addr=\"\",pending=\"\\\"projectdir/dir1/myclass.cpp\\\":7\",times=\"0\",original-location=\"\\\"fullpathofprojectdir/dir1/myclass.cpp\\\":7\"}</p>\n</blockquote>\n\n<p>Whereas it says this for breakpoints in main:</p>\n\n<blockquote>\n  <p>8046^done,bkpt={number=\"2\",type=\"breakpoint\",disp=\"keep\",enabled=\"y\",addr=\"0x0001831c\",func=\"main(int, char**)\",file=\"projectdir/dir2/main.cpp\",fullname=\"fullpathofprojectdir/dir2/main.cpp\",line=\"27\",thread-groups=[\"i1\"],times=\"0\",original-location=\"fullpathofprojectdir/dir2/main.cpp:27\"}</p>\n</blockquote>\n\n<p>Additionally, myclass.cpp doesn't show up in the source files panes either. How can I resolve this?</p>\n\n<p>Here is the setup of my *.pro files:</p>\n\n<p>Top level project file:</p>\n\n<pre><code>TEMPLATE = subdirs\nSUBDIRS += \\\n   dir1 \\\n   dir2\n\nunix {\n    target.path = /home/debian\n    INSTALLS += target\n}\n</code></pre>\n\n<p>Project file of library (dir1, myclass.cpp, etc):</p>\n\n<pre><code>QT       -= gui\n\nTARGET = Common\nTEMPLATE = lib\n\nDEFINES += COMMON_LIBRARY\n\nSOURCES += \\\n    myclass.cpp\n\nHEADERS += \\\n    common_global.h \\ \n    myclass.h\n\nunix {\n    target.path = /home/debian/lib\n    INSTALLS += target\n}\n\nCONFIG += debug\n</code></pre>\n\n<p>Project file containing main:</p>\n\n<pre><code>QT       += core gui\n\ngreaterThan(QT_MAJOR_VERSION, 4): QT += widgets\n\nTARGET = Test\nTEMPLATE = app\n\nSOURCES += \\\n    main.cpp \n\nwin32:CONFIG(release, debug|release): LIBS += -L$$OUT_PWD/../Common/release/ \n-lCommon\nelse:win32:CONFIG(debug, debug|release): LIBS += -\nL$$OUT_PWD/../Common/debug/ -lCommon\nelse:unix: LIBS += -L$$OUT_PWD/../Common/ -lCommon\n\nINCLUDEPATH += $$PWD/../Common\nDEPENDPATH += $$PWD/../Common\n\ntarget.path = /home/debian\nINSTALLS += target\n</code></pre>\n\n<p>Let me know if there's any other relevant data I forgot to provide. Qt Creator version is 4.5.0 and I'm running it on a 64 bit VM of ubuntu 16.04 if that's relevant.</p>\n"}, {"tags": ["c++", "permutation"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1515009822, "post_id": 48084277, "comment_id": 83143514, "body": "Check permutations of vectors of indices (<code>0</code>,<code>1</code>,...,<code>n-1</code>) instead?"}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1515009911, "post_id": 48084277, "comment_id": 83143549, "body": "I suspect the confusion comes from the meaning of <b>permutation</b>.  Mathematically speaking, &quot;the set of all permutations&quot; would not have duplicates."}, {"owner": {"reputation": 109, "user_id": 5236815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d5e501e54b79ab7c38dc6b920a0659a?s=128&d=identicon&r=PG&f=1", "display_name": "jjbbss", "link": "https://stackoverflow.com/users/5236815/jjbbss"}, "edited": false, "score": 0, "creation_date": 1515010199, "post_id": 48084277, "comment_id": 83143664, "body": "Hhm, but what would I do if I need the duplicates. Because I need all result vectors to be the same size."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1515010301, "post_id": 48084277, "comment_id": 83143713, "body": "As the method uses no placement information it is only able to return the next higher permutation, otherwise it would get stuck. It would have no idea how many times to return 4555 before moving on to 5455, and again how many times to repeat. If you really want the permutations and repetitions, you could give it a vector of pointers to the sorted content, and it would permute those addresses."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1515010813, "post_id": 48084277, "comment_id": 83143917, "body": "To avoid the extra look-up with your string case, you could give it a custom comparator that used the string addresses instead of doing the text compare. Another fix might be to pre-calculate the number of repetitions yourself: R = n! for each repeated n of a key, quickly discovered by scanning the sorted list, and simply have a wrapper class with a countdown that only moves the pattern forward every R calls."}, {"owner": {"reputation": 109, "user_id": 5236815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d5e501e54b79ab7c38dc6b920a0659a?s=128&d=identicon&r=PG&f=1", "display_name": "jjbbss", "link": "https://stackoverflow.com/users/5236815/jjbbss"}, "edited": false, "score": 0, "creation_date": 1515075506, "post_id": 48084277, "comment_id": 83169297, "body": "pointer vectors worked and did exactly what i wanted. thank you"}], "answers": [{"tags": [], "owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "is_accepted": true, "score": 0, "last_activity_date": 1515009865, "creation_date": 1515009865, "answer_id": 48084390, "question_id": 48084277, "link": "https://stackoverflow.com/questions/48084277/how-to-handle-reappearing-values-with-stdnext-permutation/48084390#48084390", "title": "how to handle reappearing values with std::next_permutation", "body": "<p>Consider the four integer values 4, 5, 5, 5. The four possible permutations are 4, 5, 5, 5 and 5, 4, 5, 5 and 5, 5, 4, 5 and 5, 5, 5, 4. That's it. The three 5s have the same value, so they cannot be distinguished from each other. The algorithm doesn't keep track of which of those values originally came before the other; they're the same. The same thing applies to <code>present</code>: there are three distinct values, not four.</p>\n"}], "owner": {"reputation": 109, "user_id": 5236815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d5e501e54b79ab7c38dc6b920a0659a?s=128&d=identicon&r=PG&f=1", "display_name": "jjbbss", "link": "https://stackoverflow.com/users/5236815/jjbbss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 48084390, "answer_count": 1, "score": 0, "last_activity_date": 1515009865, "creation_date": 1515009373, "question_id": 48084277, "link": "https://stackoverflow.com/questions/48084277/how-to-handle-reappearing-values-with-stdnext-permutation", "title": "how to handle reappearing values with std::next_permutation", "body": "<p>I have a few vectors.\nI want to find all permutations of each vector.\nIt works reasonably well, when the values are unique but if there are reappearing values it messes up.</p>\n\n<p>I have the following vectors</p>\n\n<pre><code>vector&lt;string&gt; present = {\"Schaukelpferd\",\"Schaukelpferd\",\"Puppe\",\"Puppe\"};\nvector&lt;string&gt; children = {\"Jan\",\"Tim\",\"Alex\",\"Daniel\"};\nvector&lt;int&gt; houses = {4,5,5,5};\n</code></pre>\n\n<p>I am sorting the before using <code>next_permutation()</code></p>\n\n<pre><code>sort(present.begin(),present.end());\nsort(children.begin(),children.end());\nsort(houses.begin(),houses.end());\ndo {\n    present_perm.push_back(present);\n} while (next_permutation(present.begin(), present.end()));\ndo {\n    children_perm.push_back(children);\n} while (next_permutation(children.begin(), children.end()));\ndo {\n    houses_perm.push_back(houses);\n} while (next_permutation(houses.begin(), houses.end()));\n</code></pre>\n\n<p><code>children</code> works good, but present as well as houses doesn't work as expected  </p>\n\n<p>children returns <code>24</code> permutation, as expected, present returns only <code>6</code> and houses returns only <code>4</code>. I would expect all to return <code>24</code> because all vectors have <code>4</code> elements (<code>4! = 24</code>).</p>\n"}, {"tags": ["c++", "c", "pointers"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1515009459, "post_id": 48084276, "comment_id": 83143358, "body": "<code>longitud=&amp;cable1;</code> doesn&#39;t make much sense without knowing what <code>cable1</code> is."}, {"owner": {"reputation": 192, "user_id": 7002816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3zZvm.jpg?s=128&g=1", "display_name": "LosWochos", "link": "https://stackoverflow.com/users/7002816/loswochos"}, "edited": false, "score": 0, "creation_date": 1515009545, "post_id": 48084276, "comment_id": 83143404, "body": "Its basically the same what happens in the first 3 lines. The pointer longitud gets assigned with the adress of cable1, whatever cable1 might be. After that, you dereference the pointer to assign a value to cable1."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1515011294, "post_id": 48084276, "comment_id": 83144100, "body": "For strict type agreement use <code>*longitud = 40.5f ;</code> - the unadorned <code>40.5</code> is a <code>double</code> not a <code>float</code>.  Your compiler may otherwise issue warnings."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 1, "creation_date": 1515013076, "post_id": 48084276, "comment_id": 83144895, "body": "Don&#39;t edit your entire question away when it&#39;s solved. If someone answered your question you should accept their answer."}], "answers": [{"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 1, "last_activity_date": 1515011192, "creation_date": 1515011192, "answer_id": 48084638, "question_id": 48084276, "link": "https://stackoverflow.com/questions/48084276/difference-between-pointer-declaration-and-indirection/48084638#48084638", "title": "Difference between pointer declaration and indirection", "body": "<p><code>longitude</code> is a pointer to a float variable</p>\n\n<p><code>longitud=&amp;cable1</code> assigns the address of <code>cable1</code> (presumably a float?) to <code>longitud</code>, which now <em>references</em> <code>cable1</code>.</p>\n\n<p><code>*longitud=40.5</code> dereferences longitude and assign it value 40.5.  Because <code>longitud</code> references <code>cable1</code>, this assigns the value to <code>cable1</code>.  That is <code>*longitud</code> and <code>cable1</code> are the same thing.</p>\n\n<p>None of this really relates to the question title <em>\"Difference between pointer declaration and indirection\"</em> - <em>indirection</em> is a general computing concept, and <em>pointers</em> are the means by which indirection is effected in C and C++.</p>\n"}, {"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 1, "last_activity_date": 1515011371, "creation_date": 1515011371, "answer_id": 48084671, "question_id": 48084276, "link": "https://stackoverflow.com/questions/48084276/difference-between-pointer-declaration-and-indirection/48084671#48084671", "title": "Difference between pointer declaration and indirection", "body": "<p>Suppose you add one more (different) line in each section:</p>\n\n<pre><code>int m;              // m is int variable \nint *p;             // pointer p is pointing to an integer value\np = &amp;m;             // the memory address of m is assigned to p\n*p = 42;            // ADDED: assign 42 to m, where p points to\n\nfloat cable1;       // ADDED: the variable where longitud points\nfloat *longitud;    // pointer longitud is pointing to a float value\nlongitud = &amp;cable1; // the memory address of cable1 is assigned to longitud\n*longitud = 40.5f;  // assign 40.5 to cable1, where longitud points to\n</code></pre>\n\n<p>This completes the similar examples, which use different variable types.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "is_accepted": false, "score": 0, "last_activity_date": 1515012854, "last_edit_date": 1515012854, "creation_date": 1515012052, "answer_id": 48084815, "question_id": 48084276, "link": "https://stackoverflow.com/questions/48084276/difference-between-pointer-declaration-and-indirection/48084815#48084815", "title": "Difference between pointer declaration and indirection", "body": "<p>Cable1 needs to have a place memory before longitud can point to it. </p>\n\n<p>The first 3 lines do this:</p>\n\n<ol>\n<li>Set aside memory for an int.</li>\n<li>Create an int pointer.</li>\n<li>Get the int pointer to point at the int's memory address. Pointer references int.</li>\n</ol>\n\n<p>The second 3 lines do this:</p>\n\n<ol>\n<li>Create a float pointer.</li>\n<li>Get the float pointer to point to a nonexistent address.</li>\n<li>Try to assign a float value to that address.</li>\n</ol>\n\n<p>If on line 4 you wrote:</p>\n\n<pre><code>float cable1;\n</code></pre>\n\n<p>You would have set aside memory and everything would work fine.</p>\n\n<p>On the topic, you mean pointer declaration and dereferencing. I can give a short set of examples, though it mostly takes reading and practice to learn. Try these out and get a feel.</p>\n\n<pre><code>float f = 22.2f;   //sets aside memory for a float with the name \"f\", stores 22.2\nfloat *pf;         //declares a float pointer.\npf = &amp;f;           //sets pf to point to f's memory address. pf references p.\nprintf(\"%f\", *pf); //prints the value at the referenced address (22.2)\nprintf(\"%x\", pf);  //prints the memory address of the pointer itself\n*pf = 33.3f;       //changes the value at f's address to 33.3 (from 22.2)\nf = 44.4f;         //changes the value at f's address to 44.4 (from 33.3)\nfloat *pf2;\n*pf2 = 33.3        //BAD. pf2 is not assigned to an address, no value to change.\n*pf2 = f;          //BAD. pf2 has no memory address to copy the value to.\n*pf2 = pf;         //BAD. several reasons.\npf2 = pf;          //pf2 now points to f's address, too.\npf2 = &amp;f;          //redundant. Same as the last line.\n*pf2 = 55.5        //f has changed to 55.5. both pf2 and pf point to it.\n</code></pre>\n\n<p>Just think of the * as standing for \"pointer\" when you declare. When you use * later, it means \"dereference.\" Dereferencing a pointer means you want to look at/use/change the referenced value. Later on, you'll learn that pointers can point to other pointers. So the value of a (char **) type is type (char *), rather than type (char).</p>\n\n<p>If you don't have a book, I recommend C Programming - A Modern Approach 2nd Edition. It's a little dated but an excellent way to learn the fundamentals.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1515013760, "creation_date": 1515013760, "answer_id": 48085159, "question_id": 48084276, "link": "https://stackoverflow.com/questions/48084276/difference-between-pointer-declaration-and-indirection/48085159#48085159", "title": "Difference between pointer declaration and indirection", "body": "<p>After executing the lines</p>\n\n<pre><code>float cable1;       // ADDED: the variable where longitud points\nfloat *longitud;    // pointer longitud is pointing to a float value\nlongitud = &amp;cable1; // the memory address of cable1 is assigned to longitud\n</code></pre>\n\n<p>the following conditions are true:</p>\n\n<pre><code> longitude == &amp;cable1\n*longitude ==  cable1\n</code></pre>\n\n<p>IOW, the <em>expression</em> <code>*longitud</code> is equivalent to the expression <code>cable1</code>.  So when you write</p>\n\n<pre><code>*longitud = 40.5f;\n</code></pre>\n\n<p>this is equivalent to writing </p>\n\n<pre><code>cable1 = 40.5f;\n</code></pre>\n\n<p>The <code>*</code> operator <em>dereferences</em> the <code>longitud</code> pointer, such that the <em>expression</em> <code>*longitud</code> evaluates to the same thing as <code>cable1</code>.  </p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1515018781, "post_id": 48085310, "comment_id": 83147194, "body": "Overall - quite good.  <code>int* p =     &#47;&#47; &quot;p&quot; is a pointer  ... </code> (<code>p</code> looks like an <i>object</i> here.) and &quot;A <b>pointer</b> is a value.&quot; could use some clarification."}, {"owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515019905, "post_id": 48085310, "comment_id": 83147541, "body": "@chux Thanks. Let me know if the fix needs more work."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515020324, "post_id": 48085310, "comment_id": 83147664, "body": "Good luck on a potential <a href=\"https://stackoverflow.com/help/badges/95/reversal\">reversal</a>"}, {"owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515020420, "post_id": 48085310, "comment_id": 83147696, "body": "Ah, thanks. I still don\u2019t get all the tags and badges and hats and stuff."}], "tags": [], "owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "is_accepted": false, "score": 2, "last_activity_date": 1515019778, "last_edit_date": 1515019778, "creation_date": 1515014569, "answer_id": 48085310, "question_id": 48084276, "link": "https://stackoverflow.com/questions/48084276/difference-between-pointer-declaration-and-indirection/48085310#48085310", "title": "Difference between pointer declaration and indirection", "body": "<p>The concepts of <strong>value</strong>, <strong>pointer</strong>, and <strong>reference</strong> often trip people up, especially as they are often taught to look at them in terms of <em>implementation</em> and not in terms of the language.</p>\n\n<p>A <strong>value</strong> is a thing that exists and has meaning. It always has a <em>type</em> (a constraint on its meaning) like <code>int</code>, <code>float</code>, <code>char</code>, and <code>vector&lt;string&gt;</code>.</p>\n\n<p>An <strong>object</strong> is a <em>value that exists somewhere in memory</em>. (And not, say, mangled into a machine instruction code or produced on-the-fly in some way. That is, I could take out my memory chip and stick my finger on it, were my fingers nimble enough.)</p>\n\n<p>A <strong>reference</strong> is an <em>alias</em> \u2014 a name for an object. The name is convenient for us as programmers. How the compiler maintains that name does not really matter. All that matters (language perspective!) is that if you have a name, you have <em>direct access</em> to an object.</p>\n\n<p>To put that into perspective, whenever you <em>name</em> an object, you obtain a <em>direct reference</em> to that object. You can manipulate that object directly using its name.</p>\n\n<p>A <strong>pointer</strong> is a value. Its type is a location in the computer\u2019s memory of some object. With this location, I can gain access to the object\u2019s value. In other words, I can use a pointer to gain a direct reference to an object.</p>\n\n<p>Vocabulary + time = fickle understandings and encourage people to ask useless things<sup>2</sup>. Let\u2019s clean our minds up a little.</p>\n\n<ul>\n<li>First, a pointer is <em>not</em> a reference, it is an <em>indirect</em> reference. In order to get an actual, or <em>direct</em>, reference to a pointed-to object, we \u201c<em>dereference</em>\u201d the pointer. In other words, we perform a magic that transforms a pointer value to obtain a reference to an object.</li>\n</ul>\n\n<p>The mechanics of how a pointer works are typically framed in terms of how the underlying hardware does something like \u201cfollows a pointer to a value\u201d. We draw pictures with arrows and everything. We seem to forget to ask how this magic works. No one asks how variable names work either, but it is the exact same kind of magic. We simply trust when told \u201cthe compiler takes care of it\u201d.</p>\n\n<ul>\n<li>What is missed is the distinction between a (direct) reference (an alias or name for an object) and an indirect reference (a pointer or other thing that can be used to obtain a reference to an object).</li>\n</ul>\n\n<p>Before C++ the difference between direct and indirect references really only made sense in the context of a pointer, and it was easy to call a pointer \u201ca reference\u201d instead of the full phrase \u201can indirect reference\u201d, and so the vocabulary words mixed around in our heads, and we began to misunderstand the actual concepts involved.</p>\n\n<p>Enter C++, stage left. We now have things called \u201creferences\u201d in addition to pointers. In terms of the language, they are true aliases for other objects<sup>1</sup>.</p>\n\n<p>To put it to example:</p>\n\n<pre><code>int  x = 7;   // \"x\" is a reference to the integer object with value 7\nint&amp; y = x;   // \"y\" is a reference to the same integer object as \"x\".\n\nint* p =      // \"p\" is a pointer object whose value is an \n              //     indirect reference to some integer object:\n         &amp;x;  // The &amp; operator obtains an indirect reference (or pointer value) to \"x\"\n</code></pre>\n\n<p>And here is the last point. There are more than one meaning for \"&amp;\"!</p>\n\n<ul>\n<li>When attached to a type, it means that the type is a direct reference to some object</li>\n<li>When attached to an object, it means that an indirect reference to that object is obtained</li>\n</ul>\n\n<p><sub><sup>1</sup> In C++, the abstraction leaks, because the lifetime of an object is bound only to the original reference. But that\u2019s neither here nor there. There are other topics that deal with that here at SO.</sub></p>\n\n<p><sub><sup>2</sup> So, to answer everyone\u2019s favorite question: is a reference a pointer or not? The answer is, <em>it doesn\u2019t matter</em>. (Unless you are writing a compiler.) You are asking implementation details about magic used to maintain a language-level concept. So sometimes it may be an actual pointer, sometimes it may simply be another entry in the compiler\u2019s local symbol table, and it may even be something else if the compiler writer thinks it useful and appropriate.</sub></p>\n\n<p><sub><sup>3</sup>Language gets to be fuzzy. I had previously said <code>\"p\" is a pointer</code>. Technically, it is an object whose value is a pointer type. We can usually get away by just saying what type of thing an object is, though, and be well-understood. It is only when we are splitting hairs (in context) that the vocabulary needs more care, as it does here.</sub></p>\n"}], "owner": {"reputation": 1, "user_id": 9169269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b93604b4f84403e745233ab37bef36c6?s=128&d=identicon&r=PG&f=1", "display_name": "mechanicalgirl", "link": "https://stackoverflow.com/users/9169269/mechanicalgirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 1, "answer_count": 5, "score": -5, "last_activity_date": 1515019778, "creation_date": 1515009372, "last_edit_date": 1515013018, "question_id": 48084276, "link": "https://stackoverflow.com/questions/48084276/difference-between-pointer-declaration-and-indirection", "title": "Difference between pointer declaration and indirection", "body": "<p>I'm reading a book and I have doubts about what each of these syntax does. The first three lines I can understand but the following do not. Thank you very much if you help me, Julieta</p>\n\n<pre><code>int m; //m is int variable \nint *p; //Pointer p pointing to an integer value\np=&amp;m //The memory address of the variable m is assigned to p\n\nfloat *longitud;\nlongitud=&amp;cable1;\n*longitud=40.5;\n</code></pre>\n"}, {"tags": ["c++", "c", "include", "shared-libraries"], "comments": [{"owner": {"reputation": 3080, "user_id": 7590993, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/10154373026397157/picture?type=large", "display_name": "Hariom Singh", "link": "https://stackoverflow.com/users/7590993/hariom-singh"}, "edited": false, "score": 3, "creation_date": 1515008752, "post_id": 48084107, "comment_id": 83142988, "body": "yes create namespace"}, {"owner": {"reputation": 3080, "user_id": 7590993, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/10154373026397157/picture?type=large", "display_name": "Hariom Singh", "link": "https://stackoverflow.com/users/7590993/hariom-singh"}, "edited": false, "score": 0, "creation_date": 1515008813, "post_id": 48084107, "comment_id": 83143024, "body": "<a href=\"http://en.cppreference.com/w/cpp/language/namespace\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/namespace</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 3, "creation_date": 1515009041, "post_id": 48084107, "comment_id": 83143150, "body": "The solutions for this problem differ greatly between C and C++. Which is the target language?"}, {"owner": {"reputation": 1, "user_id": 7151238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8419ca18d385523eea5e0b022ce27b07?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/7151238/dan"}, "edited": false, "score": 0, "creation_date": 1515009475, "post_id": 48084107, "comment_id": 83143369, "body": "The library (solver) that I am including is itself written in C, and my code is in C++."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 3080, "user_id": 7590993, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/10154373026397157/picture?type=large", "display_name": "Hariom Singh", "link": "https://stackoverflow.com/users/7590993/hariom-singh"}, "edited": false, "score": 1, "creation_date": 1515011864, "post_id": 48084107, "comment_id": 83144323, "body": "That&#39;s that I figured. Start with @HariomSingh &#39;s suggestion. This should be as simple as wrapping just about everything in the headers and C files for the first solver in <code>namespace solver1 { code goes here }</code> and hoping that a C++ compiler will happily compile the solvers (usually does). If it works, I&#39;d also wrap the second solver for consistency."}, {"owner": {"reputation": 1, "user_id": 7151238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8419ca18d385523eea5e0b022ce27b07?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/7151238/dan"}, "edited": false, "score": 0, "creation_date": 1515014070, "post_id": 48084107, "comment_id": 83145330, "body": "I am getting &quot;unknown type name &#39;namespace&#39;&quot; when I try to compile, with or without using inline <code>extern&quot;C&quot;</code> while including the solvers. These are my cmake flags: inline <code>set(CMAKE_CXX_FLAGS &quot;-std=c++11 -Os -fno-diagnostics-color -Wall&quot;)</code>"}], "owner": {"reputation": 1, "user_id": 7151238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8419ca18d385523eea5e0b022ce27b07?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/7151238/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515008602, "creation_date": 1515008602, "question_id": 48084107, "link": "https://stackoverflow.com/questions/48084107/c-c-include-two-copies-of-the-same-library-different-code-same-method-names", "title": "C/C++ Include two copies of the same library (different code, same method names/variable names)", "body": "<p>I have two C solvers generated by CVXGEN, and I need to use them both in my code. I need to include solver.h from both of the solvers, which each contains a lot of structs and functions. It would be really hard to rename them all in all of the code (about 10k lines per solver). Is there a way to include them and use them in my code at the same time?</p>\n"}, {"tags": ["c++", "c++14", "unique-ptr"], "comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 2, "creation_date": 1515008758, "post_id": 48084097, "comment_id": 83142990, "body": "Why is <code>destroy</code> returning a <code>T*</code>?"}, {"owner": {"reputation": 1038, "user_id": 7252179, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/bkNb0.jpg?s=128&g=1", "display_name": "Th&#233;o Champion", "link": "https://stackoverflow.com/users/7252179/th%c3%a9o-champion"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1515009230, "post_id": 48084097, "comment_id": 83143239, "body": "Guess I copied and pasted the create part a bit too quickly, editing that ;)"}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1515011967, "post_id": 48084097, "comment_id": 83144363, "body": "What roll does <code>T</code> actually play here? It seems like <code>T</code> should just be <code>void</code> and this doesn&#39;t need to be a template at all?"}], "answers": [{"comments": [{"owner": {"reputation": 1038, "user_id": 7252179, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/bkNb0.jpg?s=128&g=1", "display_name": "Th&#233;o Champion", "link": "https://stackoverflow.com/users/7252179/th%c3%a9o-champion"}, "edited": false, "score": 0, "creation_date": 1515010644, "post_id": 48084279, "comment_id": 83143851, "body": "So if I were to create a vector of the resulting unique_ptr, should I include &quot;lib_unloader&quot; in the template definition like so <code>std::vector&lt;std::unique_ptr&lt; api::Module, lib_unloader &gt;&gt;</code> or not ?"}, {"owner": {"reputation": 1038, "user_id": 7252179, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/bkNb0.jpg?s=128&g=1", "display_name": "Th&#233;o Champion", "link": "https://stackoverflow.com/users/7252179/th%c3%a9o-champion"}, "edited": false, "score": 0, "creation_date": 1515010726, "post_id": 48084279, "comment_id": 83143879, "body": "About the leaking handle, is wrapping it in a unique_ptr as well so that it delete itself  when he go out of scope a good idea ?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 1038, "user_id": 7252179, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/bkNb0.jpg?s=128&g=1", "display_name": "Th&#233;o Champion", "link": "https://stackoverflow.com/users/7252179/th%c3%a9o-champion"}, "edited": false, "score": 0, "creation_date": 1515011498, "post_id": 48084279, "comment_id": 83144170, "body": "@Th&#233;oChampion Yes, that is the type of your unique ptr.  For the handle, I&#39;d write a better one.  It probably contains a <code>unique_ptr</code>.  I sketched one solution where I don&#39;t make it an object, just a <code>unique_ptr</code>."}, {"owner": {"reputation": 1038, "user_id": 7252179, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/bkNb0.jpg?s=128&g=1", "display_name": "Th&#233;o Champion", "link": "https://stackoverflow.com/users/7252179/th%c3%a9o-champion"}, "edited": false, "score": 0, "creation_date": 1515345691, "post_id": 48084279, "comment_id": 83256924, "body": "I notice in the code above, the <code>get_sym</code> return a <code>T *(**)()</code> is it normal ? I think this is causing the segfault when the <code>ptr_deleter</code> is call at the end"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 1038, "user_id": 7252179, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/bkNb0.jpg?s=128&g=1", "display_name": "Th&#233;o Champion", "link": "https://stackoverflow.com/users/7252179/th%c3%a9o-champion"}, "edited": false, "score": 0, "creation_date": 1515361282, "post_id": 48084279, "comment_id": 83261520, "body": "@thro fixed, price of not testing.  ;)"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 4, "last_activity_date": 1515361259, "last_edit_date": 1515361259, "creation_date": 1515009401, "answer_id": 48084279, "question_id": 48084097, "link": "https://stackoverflow.com/questions/48084097/factory-function-returning-unique-ptr-with-custom-deleter/48084279#48084279", "title": "Factory function returning unique_ptr with custom deleter", "body": "<p>Write a deleter type and factory.</p>\n\n<pre><code>using deleter = void();\nusing ptr_deleter = deleter*;\nstruct lib_unloader {\n  deleter* del = 0;\n  void operator()(void*)const { if (del) del(); }\n  explicit operator bool() const { return del; }\n};\nlib_unloader get_lib_unloader( void* handle, char const* destroy_name ) {\n  auto del = ptr_deleter( dlsym( handle, destroy_name ) );\n  return {del};\n}\ntemplate&lt;class T&gt;\nusing lib_up = std::unique_ptr&lt; T, lib_unloader &gt;;\n\ntemplate&lt;class T&gt;&gt;\nlib_up&lt;T&gt; openLib(const std::string &amp;lib_path,\n                       const std::string &amp;csym = \"create\",\n                       const std::string &amp;dsym = \"destroy\")\n{\n  void *handle;\n  if (!(handle = dlopen(lib_path.c_str(), RTLD_LAZY)))\n  {\n    std::cerr &lt;&lt; \"dlopen \" &lt;&lt; dlerror() &lt;&lt; std::endl;\n    return nullptr;\n  }\n  T *(*create)();\n  if (!(create = (T * (*)()) dlsym(handle, csym.c_str())))\n  {\n    std::cerr &lt;&lt; \"dlsym \" &lt;&lt; csym &lt;&lt; dlerror() &lt;&lt; std::endl;\n    return nullptr;\n  }\n  auto destroy = get_lib_unloader( handle, dsym.c_str() );\n  if (!destroy) {\n    std::cerr &lt;&lt; \"dlsym \" &lt;&lt; dsym &lt;&lt; dlerror() &lt;&lt; std::endl;\n    return nullptr;\n  }\n  return {create(), destroy};\n}\n</code></pre>\n\n<p>myself, I'd write a better handle.  Note that your code leaks dynamic library handles like crazy.</p>\n\n<pre><code>using libhandle_ptr = std::unique_ptr&lt;void, std::integral_constant&lt;int(*)(void*), dlclose&gt;&gt;;\n\nlibhandle_ptr make_libhandle(const char* filename, int flags) {\n  return libhandle_ptr( dlopen(filename, flags) );\n}\ntemplate&lt;class T&gt;\nT* get_sym( libhandle_ptr const&amp; handle, const char* symbol ) {\n  if (!handle || !symbol) return nullptr;\n  return static_cast&lt;T*&gt;( dlsym( handle.get(), symbol ) );\n}\n</code></pre>\n\n<p>now we get:</p>\n\n<pre><code>lib_unloader get_lib_unloader( libhandle const&amp; handle, char const* destroy_name ) {\n  auto del = get_sym&lt;deleter&gt;( handle, destroy_name );\n  return {del};\n}\ntemplate&lt;class T&gt;&gt;\nlib_up&lt;T&gt; openLib( libhandle_ptr const&amp; handle,\n                       const char* csym = \"create\",\n                       const char* dsym = \"destroy\")\n{\n  if (!handle)\n    return {};\n  auto create = get_sym&lt;T*()&gt;( handle, csym );\n  if (!create)\n  {\n    std::cerr &lt;&lt; \"dlsym \" &lt;&lt; csym &lt;&lt; dlerror() &lt;&lt; std::endl;\n    return {};\n  }\n  auto destroy = get_lib_unloader( handle, dsym.c_str() );\n  if (!destroy) {\n    std::cerr &lt;&lt; \"dlsym \" &lt;&lt; dsym &lt;&lt; dlerror() &lt;&lt; std::endl;\n    return {};\n  }\n  return {create(), destroy};\n}\n</code></pre>\n\n<p>where users are expected to provide a <code>libhandle_ptr</code>when they wantna symbol.</p>\n\n<p>Note that boost has a dll symbol loading library that probably does a better job.</p>\n"}], "owner": {"reputation": 1038, "user_id": 7252179, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/bkNb0.jpg?s=128&g=1", "display_name": "Th&#233;o Champion", "link": "https://stackoverflow.com/users/7252179/th%c3%a9o-champion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 0, "accepted_answer_id": 48084279, "answer_count": 1, "score": 0, "last_activity_date": 1515361259, "creation_date": 1515008522, "last_edit_date": 1515009375, "question_id": 48084097, "link": "https://stackoverflow.com/questions/48084097/factory-function-returning-unique-ptr-with-custom-deleter", "title": "Factory function returning unique_ptr with custom deleter", "body": "<p>I'm making a helper function for loading shared libs and putting the result into a <code>std::unique_ptr</code> with a custom deleter (which is the module destruction function).</p>\n\n<p>This works fine when I'm not setting custom deleter but as soon as I add them I get an error saying that the type of the custom deleter cannot be deduced (which is fair).</p>\n\n<p>The thing is, if I where to specify the deleter type when I call the function, it will end up looking very ugly.</p>\n\n<p>The question is, how can my function deduce automatically the type of the custom deleter ? And how should I declare a <code>std::vector</code> of the resulting <code>std::unique_ptr</code>s ?</p>\n\n<p>My code (I'm also open for any suggestion on the code):</p>\n\n<pre><code>template &lt;typename T, typename D&gt;\nstd::unique_ptr&lt;T, D&gt; openLib(const std::string &amp;lib_path,\n                       const std::string &amp;csym = \"create\",\n                       const std::string &amp;dsym = \"destroy\")\n{\n  void *handle;\n  if (!(handle = dlopen(lib_path.c_str(), RTLD_LAZY)))\n  {\n    std::cerr &lt;&lt; \"dlopen \" &lt;&lt; dlerror() &lt;&lt; std::endl;\n    return nullptr;\n  }\n  T *(*create)();\n  if (!(create = (T * (*)()) dlsym(handle, csym.c_str())))\n  {\n    std::cerr &lt;&lt; \"dlsym \" &lt;&lt; csym &lt;&lt; dlerror() &lt;&lt; std::endl;\n    return nullptr;\n  }\n  void (*destroy)();\n  if (!(destroy = (void (*)()) dlsym(handle, dsym.c_str())))\n  {\n    std::cerr &lt;&lt; \"dlsym \" &lt;&lt; dsym &lt;&lt; dlerror() &lt;&lt; std::endl;\n    return nullptr;\n  }\n  auto cDel = [destroy](T *lib) { destroy(); };\n  std::unique_ptr&lt;T, decltype(cDel)&gt; lib_ptr((T *)create(), cDel);\n  return lib_ptr;\n}\n</code></pre>\n"}, {"tags": ["c++", "compilation", "g++"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1515008237, "post_id": 48084025, "comment_id": 83142755, "body": "It looks like you are looking for a static library which is essentially just a pack of obj files."}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 1, "creation_date": 1515008398, "post_id": 48084025, "comment_id": 83142833, "body": "That&#39;s what makefiles and other build systems are for."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1515008452, "post_id": 48084025, "comment_id": 83142859, "body": "A single object file is create from a single <a href=\"https://en.wikipedia.org/wiki/Translation_unit_(programming)\" rel=\"nofollow noreferrer\"><i>translation unit</i></a> (basically one source file and all its included header files). You need to link with all object files. Using a build system like <code>make</code> or similar will help you handle all of that."}, {"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 3, "creation_date": 1515008519, "post_id": 48084025, "comment_id": 83142882, "body": "Have you tried <code>g++ -c -combine fileA.cpp fileB.cpp -o fileAB.o</code> ?"}, {"owner": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "reply_to_user": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 0, "creation_date": 1515008898, "post_id": 48084025, "comment_id": 83143069, "body": "@super I think this is what I am looking for. Thanks man."}], "owner": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515011414, "creation_date": 1515008123, "question_id": 48084025, "link": "https://stackoverflow.com/questions/48084025/c-compile-such-that-i-no-longer-need-to-link-sub-objects", "title": "C++: Compile such that I no longer need to link sub objects", "body": "<p>For instance, suppose I have a cpp, <code>fileB.cpp</code> which depends on <code>fileA.cpp</code>, </p>\n\n<pre><code>g++ -o fileA.o -c fileA.cpp\ng++ -o fileB.o -c fileB.cpp fileA.o\n</code></pre>\n\n<p>Now, later, I want to compile <code>fileC.cpp</code>, which depends on <code>fileB.cpp</code>.  However, I don't want to have to have all of the sub objects used to create <code>fileB.o</code>. </p>\n\n<p>When I compile with</p>\n\n<pre><code>g++ -o fileC.exe fileC.cpp fileB.o\n</code></pre>\n\n<p>I fail, but when I compile with: </p>\n\n<pre><code>g++ -o fileC.exe fileC.cpp fileB.o fileA.o\n</code></pre>\n\n<p>...I succeed.  </p>\n\n<hr>\n\n<p>There must be a way to \"seal off\" the compiled <code>fileB.o</code> object so that I no longer need to keep track of <code>fileA.o</code>...???</p>\n"}, {"tags": ["c++", "doubly-linked-list"], "comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 1, "creation_date": 1515008212, "post_id": 48083925, "comment_id": 83142742, "body": "Do you mean <code>std::list::splice</code>?  The standard library has no <code>std::splice::insert</code>."}], "answers": [{"comments": [{"owner": {"reputation": 7737, "user_id": 3410396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc26b280cedaa721d90828a80e39706?s=128&d=identicon&r=PG&f=1", "display_name": "Revolver_Ocelot", "link": "https://stackoverflow.com/users/3410396/revolver-ocelot"}, "edited": false, "score": 3, "creation_date": 1515008671, "post_id": 48084094, "comment_id": 83142952, "body": "It might worth to mention, that before C++11 it was technically possible to have splice as a free function: <code>list::size</code> was O(n) there, so it was not nessesary to cache size (and make sure it is correct) inside list itself."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 7737, "user_id": 3410396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc26b280cedaa721d90828a80e39706?s=128&d=identicon&r=PG&f=1", "display_name": "Revolver_Ocelot", "link": "https://stackoverflow.com/users/3410396/revolver-ocelot"}, "edited": false, "score": 0, "creation_date": 1515008983, "post_id": 48084094, "comment_id": 83143111, "body": "@Revolver_Ocelot I think the problem is that such a function would require a whole new category of iterators exclusive to linked list iterators. Existing iterator categories do not posses the interface required to relink elements in a list. Though I agree it seems possible."}, {"owner": {"reputation": 5196, "user_id": 4454, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bb3f204908e461a17a0efebbe8907ad8?s=128&d=identicon&r=PG", "display_name": "Eyal", "link": "https://stackoverflow.com/users/4454/eyal"}, "edited": false, "score": 0, "creation_date": 1515009249, "post_id": 48084094, "comment_id": 83143251, "body": "So is it a member function just because of size? If I splice providing begin and end iterators that don&#39;t belong to the list, how would it even know? I imagine that size would get screwed up but otherwise would it work?"}, {"owner": {"reputation": 7737, "user_id": 3410396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc26b280cedaa721d90828a80e39706?s=128&d=identicon&r=PG&f=1", "display_name": "Revolver_Ocelot", "link": "https://stackoverflow.com/users/3410396/revolver-ocelot"}, "edited": false, "score": 0, "creation_date": 1515009392, "post_id": 48084094, "comment_id": 83143326, "body": "All you need is knowledge of internal list node structure and access to it and iterator internals, which is trivial for standard library. As iterators are usually just node pointers, manipulating node data directly is easy. However, in this case we would have a free function, which only works with <code>std::list</code>. Which seems out of place."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 5196, "user_id": 4454, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bb3f204908e461a17a0efebbe8907ad8?s=128&d=identicon&r=PG", "display_name": "Eyal", "link": "https://stackoverflow.com/users/4454/eyal"}, "edited": false, "score": 0, "creation_date": 1515009975, "post_id": 48084094, "comment_id": 83143586, "body": "@Eyal You would need to put extra restrictions on <code>list::iterator</code> or pass a reference to the container for essentially no gain. And if you ignore the technical difficulties associated with a free function version of <code>std::list::splice</code>, there&#39;s still a question of style. And having a free function that either requires a reference to the container or special iterators is contrary to the style choices made for the rest of the library. Even if it were easy, it&#39;s likely that such a free function wouldn&#39;t be added to the standard library simply for consistency."}, {"owner": {"reputation": 5196, "user_id": 4454, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bb3f204908e461a17a0efebbe8907ad8?s=128&d=identicon&r=PG", "display_name": "Eyal", "link": "https://stackoverflow.com/users/4454/eyal"}, "reply_to_user": {"reputation": 7737, "user_id": 3410396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc26b280cedaa721d90828a80e39706?s=128&d=identicon&r=PG&f=1", "display_name": "Revolver_Ocelot", "link": "https://stackoverflow.com/users/3410396/revolver-ocelot"}, "edited": false, "score": 0, "creation_date": 1515010328, "post_id": 48084094, "comment_id": 83143726, "body": "@Revolver_Ocelot I tried splicing with the iterators and containers not matching up.  It worked just fine, even the size!  I don&#39;t know how.  See the code and results above."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 5196, "user_id": 4454, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bb3f204908e461a17a0efebbe8907ad8?s=128&d=identicon&r=PG", "display_name": "Eyal", "link": "https://stackoverflow.com/users/4454/eyal"}, "edited": false, "score": 1, "creation_date": 1515010474, "post_id": 48084094, "comment_id": 83143779, "body": "@Eyal That&#39;s simply undefined behavior. One common and unfortunate result of undefined behavior is appearing to give the expected results. But the behavior can change for any reason at any time."}, {"owner": {"reputation": 7737, "user_id": 3410396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc26b280cedaa721d90828a80e39706?s=128&d=identicon&r=PG&f=1", "display_name": "Revolver_Ocelot", "link": "https://stackoverflow.com/users/3410396/revolver-ocelot"}, "reply_to_user": {"reputation": 5196, "user_id": 4454, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bb3f204908e461a17a0efebbe8907ad8?s=128&d=identicon&r=PG", "display_name": "Eyal", "link": "https://stackoverflow.com/users/4454/eyal"}, "edited": false, "score": 1, "creation_date": 1515010583, "post_id": 48084094, "comment_id": 83143823, "body": "@Eyal <i>&quot;it looks like it works&quot;</i>  is the most dangerous result of executing invalid code. I have other results BTW, make sure you are using at least C++11: <a href=\"http://coliru.stacked-crooked.com/a/a39f44317b3d748c\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/a39f44317b3d748c</a>"}, {"owner": {"reputation": 5196, "user_id": 4454, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bb3f204908e461a17a0efebbe8907ad8?s=128&d=identicon&r=PG", "display_name": "Eyal", "link": "https://stackoverflow.com/users/4454/eyal"}, "reply_to_user": {"reputation": 7737, "user_id": 3410396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc26b280cedaa721d90828a80e39706?s=128&d=identicon&r=PG&f=1", "display_name": "Revolver_Ocelot", "link": "https://stackoverflow.com/users/3410396/revolver-ocelot"}, "edited": false, "score": 0, "creation_date": 1515011007, "post_id": 48084094, "comment_id": 83143983, "body": "@Revolver_Ocelot Good to note.  Does it say somewhere in a spec that the arguments must match the containers provided?  I didn&#39;t see that requirement here (though I&#39;ll admit it seems obvious): <a href=\"http://en.cppreference.com/w/cpp/container/list/splice\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/list/splice</a>"}, {"owner": {"reputation": 7737, "user_id": 3410396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc26b280cedaa721d90828a80e39706?s=128&d=identicon&r=PG&f=1", "display_name": "Revolver_Ocelot", "link": "https://stackoverflow.com/users/3410396/revolver-ocelot"}, "reply_to_user": {"reputation": 5196, "user_id": 4454, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bb3f204908e461a17a0efebbe8907ad8?s=128&d=identicon&r=PG", "display_name": "Eyal", "link": "https://stackoverflow.com/users/4454/eyal"}, "edited": false, "score": 1, "creation_date": 1515011279, "post_id": 48084094, "comment_id": 83144094, "body": "@Eyal From cppreference: <b><code>first</code>, <code>last</code></b>  -  the range of elements to transfer <b>from <code>other</code></b> to <code>*this</code>. From actual Standard: <code>void splice(const_iterator position, list&amp; x, const_iterator first, const_iterator last);</code> 11 Requires: <code>[first, last)</code> is a valid range in <code>x</code> ."}], "tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": false, "score": 5, "last_activity_date": 1515008710, "last_edit_date": 1515008710, "creation_date": 1515008493, "answer_id": 48084094, "question_id": 48083925, "link": "https://stackoverflow.com/questions/48083925/why-isnt-stdlistsplice-a-free-function/48084094#48084094", "title": "Why isn&#39;t std::list::splice a free function?", "body": "<p><a href=\"http://en.cppreference.com/w/cpp/container/list/splice\" rel=\"noreferrer\"><code>std::list::splice</code></a> modifies the size of the container. You can't use a container's iterators to modify it's size. You'll notice that there are no free functions in the standard library that can insert new elements into a range using only iterators. At best they can rearrange them.</p>\n\n<p>For example, <a href=\"http://en.cppreference.com/w/cpp/algorithm/remove\" rel=\"noreferrer\"><code>std::remove</code></a> shuffles the elements to remove at the end of the container and returns an iterator identifying the range of elements that need to be removed. It can't really remove elements from the range itself.</p>\n\n<p>There are some workarounds, such as by using <a href=\"http://en.cppreference.com/w/cpp/iterator/back_inserter\" rel=\"noreferrer\"><code>std::back_inserter</code></a>, but that works by simulating an unbound range.</p>\n"}, {"comments": [{"owner": {"reputation": 7737, "user_id": 3410396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc26b280cedaa721d90828a80e39706?s=128&d=identicon&r=PG&f=1", "display_name": "Revolver_Ocelot", "link": "https://stackoverflow.com/users/3410396/revolver-ocelot"}, "edited": false, "score": 2, "creation_date": 1515010211, "post_id": 48084340, "comment_id": 83143670, "body": "It is not that it wasteful, it is that it illegal according to C++ standard: all <code>.size</code> functions are O(1) since C++11. Before that list <code>size</code> was O(n) and implementing such function was definetly a possibility. But, you are 7 years too late for that."}], "tags": [], "owner": {"reputation": 1485, "user_id": 138264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mZr81.png?s=128&g=1", "display_name": "natersoz", "link": "https://stackoverflow.com/users/138264/natersoz"}, "is_accepted": false, "score": 0, "last_activity_date": 1515009671, "creation_date": 1515009671, "answer_id": 48084340, "question_id": 48083925, "link": "https://stackoverflow.com/questions/48083925/why-isnt-stdlistsplice-a-free-function/48084340#48084340", "title": "Why isn&#39;t std::list::splice a free function?", "body": "<p>I was looking at the std::list::splice implementation the other day.\nTypically the iterator abstracts pointers to the list node private implementation. The list nodes contain the _M_prev and _M_next pointers to their neighbor nodes - this is purely implementation dependent. For an empty list, the list contains a sentinal node which serves as both head and tail (again implementation dependent).</p>\n\n<p>So I thought I would try to implement splice using only the list nodes:</p>\n\n<pre><code>void splice(const_iterator pos, list&amp; other,\n            const_iterator first, const_iterator last)\n{\n    // Hook up last.\n    last-&gt;_M_next = pos-&gt;_M_next;\n    pos-&gt;_M_next-&gt;_M_prev = last;\n\n    // Hook up first.\n    pos-&gt;_M_next = first;\n    first-&gt;_M_prev = pos;\n}\n</code></pre>\n\n<p>I think that looks correct, but I could be wrong.</p>\n\n<p>So based on that implementation, and if size is calculated dynamically, then that would work as you said.</p>\n\n<p>However as Fran\u00e7ois Andrieux  pointed out, size being calculated dynamically would be wasteful, and so the container needs to be involved so that the internal size count can be maintained.</p>\n"}], "owner": {"reputation": 5196, "user_id": 4454, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bb3f204908e461a17a0efebbe8907ad8?s=128&d=identicon&r=PG", "display_name": "Eyal", "link": "https://stackoverflow.com/users/4454/eyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 767, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1515010606, "creation_date": 1515007703, "last_edit_date": 1515010606, "question_id": 48083925, "link": "https://stackoverflow.com/questions/48083925/why-isnt-stdlistsplice-a-free-function", "title": "Why isn&#39;t std::list::splice a free function?", "body": "<p>Splice is a member function that puts part of a linked list into another linked list in constant time.</p>\n\n<p>Why does it need to be a member function? I would expect that I can splice with just iterators into the lists with having a handle on the list itself. Why should the list to be spliced need to be an argument in addition to the start and end iterators?</p>\n\n<p>For testing, I made three lists and mixed up the containers and iterators. \n See in the splice below where the containers (empty) don't match the iterators (test0 and test1):</p>\n\n<pre><code>list&lt;int&gt; test0;\nlist&lt;int&gt; test1;\nlist&lt;int&gt; empty;\ntest0.push_back(1);\ntest0.push_back(2);\ntest0.push_back(3);\ntest1.push_back(4);\ntest1.push_back(5);\ntest1.push_back(6);\nempty.splice(test0.end(), empty, test1.begin(), test1.end());\nprintf(\"empty size: %ld\\n\", empty.size());\nprintf(\"test0 size: %ld\\n\", test0.size());\nprintf(\"test1 size: %ld\\n\", test1.size());\nfor (const auto&amp; i : test0) {\n  printf(\"%d\\n\", i);\n}\n</code></pre>\n\n<p>Surprisingly, it all worked fine, even the size!</p>\n\n<pre><code>empty size: 0\ntest0 size: 6\ntest1 size: 0\n1\n2\n3\n4\n5\n6\n</code></pre>\n\n<p>I can somewhat understand the iteration working because it just runs until next is null, without regard to the container's front/back pointers.  But how did it get the size right?  Maybe size is calculated dynamically?</p>\n\n<p><strong>Edit:</strong> Based on <a href=\"http://en.cppreference.com/w/cpp/container/list/size\" rel=\"nofollow noreferrer\">this explanation</a> of size, size <em>is</em> calculated dynamically for lists, in linear time.  So the container is really just a dummy argument.  Maybe it's only needed when adding new elements because it has the allocator for making new nodes in the list?</p>\n"}, {"tags": ["android", "c++", "c", "android-ndk"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1515007881, "post_id": 48083883, "comment_id": 83142587, "body": "Possible duplicate? <a href=\"https://stackoverflow.com/questions/270113/how-do-i-stop-sem-open-failing-with-enosys\" title=\"how do i stop sem open failing with enosys\">stackoverflow.com/questions/270113/&hellip;</a>"}, {"owner": {"reputation": 175, "user_id": 7880116, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/FjWjc.jpg?s=128&g=1", "display_name": "KoLiBer", "link": "https://stackoverflow.com/users/7880116/koliber"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1515014489, "post_id": 48083883, "comment_id": 83145471, "body": "i use semaphores in android ( elinux ) not in linux kernel base os - is there any way or another header to use semaphores on android ? or i only can use pthread mutex , cond vars for android native synchronization ?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 4, "creation_date": 1515015269, "post_id": 48083883, "comment_id": 83145788, "body": "According to a comment on this answer: <a href=\"https://stackoverflow.com/a/18606519/8513665\">stackoverflow.com/a/18606519/8513665</a> , Android does not implement <code>sem_open(3)</code> (hence the ENOSYS).  Nor does it apparently support <code>SysV semaphores</code>.  Another comment on that answer mentions using an unnamed semaphore (with <code>sem_init</code>) in shared memory, so maybe that&#39;ll work."}, {"owner": {"reputation": 175, "user_id": 7880116, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/FjWjc.jpg?s=128&g=1", "display_name": "KoLiBer", "link": "https://stackoverflow.com/users/7880116/koliber"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1524817359, "post_id": 48083883, "comment_id": 87132877, "body": "thank&#39;s , using pthread mutexes solved my problem"}], "owner": {"reputation": 175, "user_id": 7880116, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/FjWjc.jpg?s=128&g=1", "display_name": "KoLiBer", "link": "https://stackoverflow.com/users/7880116/koliber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 896, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1515007502, "creation_date": 1515007502, "question_id": 48083883, "link": "https://stackoverflow.com/questions/48083883/android-native-semaphore-not-implemented", "title": "Android Native Semaphore Not implemented", "body": "<p>When using native semaphores (semaphore.h) on android i faced with this error : </p>\n\n<p><code>Error : Function not implemented\n</code></p>\n\n<p>My native code : </p>\n\n<p><code>sem_t *sem = sem_open(name , O_CREAT | O_EXCL , 0666 , value);\n</code></p>\n\n<p>i think this error is related to <code>rt</code> library, is there any way to link <code>librt</code> to toolchain ?</p>\n"}, {"tags": ["python", "c++", "tensorflow"], "owner": {"reputation": 11, "user_id": 9051499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e4450dbb62e6cccb98d23613c1581d?s=128&d=identicon&r=PG&f=1", "display_name": "A.McIntosh", "link": "https://stackoverflow.com/users/9051499/a-mcintosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1515007412, "creation_date": 1515007412, "question_id": 48083867, "link": "https://stackoverflow.com/questions/48083867/lookupalignconvolution2d-no-object-convolution-op-attribute-error", "title": "&#39;LookupAlignConvolution2d&#39; no object &#39;_convolution_op&#39; attribute error", "body": "<p>I have been working with the project tf-lcnn (<a href=\"https://github.com/ildoonet/tf-lcnn\" rel=\"nofollow noreferrer\">https://github.com/ildoonet/tf-lcnn</a>). I have built tensorflow from sources (1.4.1) and I am using python3 to run the command <code>python3 train.py</code>. This issue is that when I run said command I get:</p>\n\n<pre><code>AttributeError: 'LookupAlignConvolution2d' object has no attribute '_convolution_op'\n</code></pre>\n\n<p>I have tried tensorflow versions(1.3 and 1.4) and nothing gets the project to work. The custom_op was linked properly and works. The instructions from the project don't state that you have to follow his instructions first then build tensorflow. He also doesn't express the configuration build that he used. </p>\n\n<p>I have tried some different approaches but I am sure there is something I am missing or doing wrong. Any help would be appreciated. I can post additional information upon request. Thanks in advance!</p>\n"}, {"tags": ["c++", "list", "iterator", "openmp"], "comments": [{"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 3, "creation_date": 1515010952, "post_id": 48083734, "comment_id": 83143967, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8691459/how-do-i-parallelize-a-for-loop-through-a-c-stdlist-using-openmp\">How do I parallelize a for loop through a C++ std::list using OpenMP?</a>"}], "owner": {"reputation": 533, "user_id": 4955934, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/11835c69a4a5444cde0da98f73e6345a?s=128&d=identicon&r=PG&f=1", "display_name": "Xalion", "link": "https://stackoverflow.com/users/4955934/xalion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 659, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1515050582, "creation_date": 1515006842, "last_edit_date": 1515050582, "question_id": 48083734, "link": "https://stackoverflow.com/questions/48083734/openmp-invalid-controlling-predicate-list-and-iterator", "title": "OpenMP, invalid controlling predicate - list and iterator", "body": "<p>I have gcc version 5.4.0 20160609. I try to parallize this loop below, but it doesn't want to work proprely. I tried to used examples from the internet, but wasn't helpful. How should it look like?</p>\n\n<pre><code>void Text::readText(){\n    std::cout&lt;&lt;\"start reading\"&lt;&lt;std::endl;\n    omp_set_num_threads(2);\n\n    #pragma omp parallel\n    {\n      std::list&lt;std::string&gt;::iterator it;\n\n     #pragma omp for\n      for (it = listOfWordsFromText.begin(); it!=listOfWordsFromText.end(); it++)\n      {\n        std::cout &lt;&lt; *it &lt;&lt; \" thread: \"&lt;&lt;omp_get_thread_num()&lt;&lt; std::endl; \n      }\n}\n}\n</code></pre>\n\n<blockquote>\n  <p>Text.cpp:41:3: error: invalid controlling predicate\n     for (it = listOfWordsFromText.begin(); it!=listOfWordsFromText.end(); it++)</p>\n</blockquote>\n\n<p>EDIT: I can use OpenMP 4.5(i think so), version 2.0 is not up-to-date</p>\n"}, {"tags": ["c++"], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1515007043, "post_id": 48083772, "comment_id": 83142214, "body": "The compiler is not <i>free</i> to preform this optimization, rather it&#39;s obligated to. See <a href=\"http://en.cppreference.com/w/cpp/language/copy_elision\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/copy_elision</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4222907"}, "edited": false, "score": 0, "creation_date": 1515008989, "post_id": 48083772, "comment_id": 83143115, "body": "So how would you force to call a move constructor in this case?"}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 1, "last_activity_date": 1515014353, "last_edit_date": 1515014353, "creation_date": 1515007007, "answer_id": 48083772, "question_id": 48083669, "link": "https://stackoverflow.com/questions/48083669/why-does-my-rvalue-copy-constructor-not-work/48083772#48083772", "title": "Why does my rvalue copy constructor not work?", "body": "<p>You're seeing a form of copy elision -- the compiler is actually required to optimize and implement <code>A a = A()</code> by initializing <code>a</code> directly with the arguments to the constructor expression (<code>()</code> in this case) rather than creating a temporary and copying it into a.  If you want to enforce an unnamed object to be copied, you need to initialize <code>a</code> with an expression that is not a simple constructor call.</p>\n\n<p>Note that even then, the compiler may elide construtor calls by the as-if rule (if the only visible side effects are in the copy/move constructors/destructors.  Your best bet to \"force\" a call to the move ctor is to use a named value and <code>std::move</code>:</p>\n\n<pre><code>A a1;\nA a2 = std::move(a1);\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4222907"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "closed_date": 1515006974, "answer_count": 1, "score": 0, "last_activity_date": 1515014353, "creation_date": 1515006521, "last_edit_date": 1515007157, "question_id": 48083669, "link": "https://stackoverflow.com/questions/48083669/why-does-my-rvalue-copy-constructor-not-work", "closed_reason": "Duplicate", "title": "Why does my rvalue copy constructor not work?", "body": "<p>I was testing my knowledge in C++ and have encountered a problem. Consider this code:</p>\n\n<pre><code>class A\n{\npublic:\n    A(int n = 0)\n            : m_n(n)\n    {\n        std::cout &lt;&lt; 'd';\n    }\n\n    A(const A&amp; a)\n            : m_n(a.m_n)\n    {\n        std::cout &lt;&lt; 'c';\n    }\n\n    A(A&amp;&amp; a){\n        std::cout&lt;&lt;'r';\n    }\n\nprivate:\n    int m_n;\n};\n\n\nint main()\n{\n    A a = A();\n    std::cout &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>Clearly, the A() constructor is an rvalue, as no permanent object has been created. So I think that first I have to see \"d\" as output. Then we are copying the rvalue to our new object, which is yet to be initialised. I have implemented a copy constructor that accepts an rvalue as an argument but I did not see the proof (no \"r\" output).</p>\n\n<p>Can someone explain why that is?</p>\n"}, {"tags": ["c++", "visual-studio", "visual-studio-2017"], "comments": [{"owner": {"reputation": 778, "user_id": 5687769, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OGS_dHjyp7s/AAAAAAAAAAI/AAAAAAAAACI/tHJG2NuXit4/photo.jpg?sz=128", "display_name": "Ankur  Jyoti Phukan", "link": "https://stackoverflow.com/users/5687769/ankur-jyoti-phukan"}, "edited": false, "score": 0, "creation_date": 1515006522, "post_id": 48083613, "comment_id": 83141969, "body": "Alternative and you don&#39;t need to depend on system command  <code>cout &lt;&lt; string(50, &#39;\\n&#39;);</code>"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1515006558, "post_id": 48083613, "comment_id": 83141992, "body": "It would have some of the same disadvantages as <a href=\"https://stackoverflow.com/questions/1107705/systempause-why-is-it-wrong\"><code>system(&quot;pause&quot;);</code></a>."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1515006582, "post_id": 48083613, "comment_id": 83142000, "body": "OT: The only use-case, where I see screen clearing to be useful, is ASCII-based console games. Apart from those: I fail to understand the need for it."}, {"owner": {"reputation": 35, "user_id": 8413139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/01606641c5af7b3f1d22e434c54edf8f?s=128&d=identicon&r=PG&f=1", "display_name": "Handge", "link": "https://stackoverflow.com/users/8413139/handge"}, "edited": false, "score": 0, "creation_date": 1515006594, "post_id": 48083613, "comment_id": 83142005, "body": "That does work, but I would prefer the text to be at the top. I am making an ASCII-based console game."}, {"owner": {"reputation": 778, "user_id": 5687769, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OGS_dHjyp7s/AAAAAAAAAAI/AAAAAAAAACI/tHJG2NuXit4/photo.jpg?sz=128", "display_name": "Ankur  Jyoti Phukan", "link": "https://stackoverflow.com/users/5687769/ankur-jyoti-phukan"}, "edited": false, "score": 0, "creation_date": 1515006754, "post_id": 48083613, "comment_id": 83142069, "body": "you can use <code>clrscr();</code> , present in <code>conio.h</code>"}, {"owner": {"reputation": 35, "user_id": 8413139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/01606641c5af7b3f1d22e434c54edf8f?s=128&d=identicon&r=PG&f=1", "display_name": "Handge", "link": "https://stackoverflow.com/users/8413139/handge"}, "edited": false, "score": 0, "creation_date": 1515006787, "post_id": 48083613, "comment_id": 83142085, "body": "Visual Studio removed <code>clrscr();</code> from <code>conio.h</code>"}, {"owner": {"reputation": 778, "user_id": 5687769, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OGS_dHjyp7s/AAAAAAAAAAI/AAAAAAAAACI/tHJG2NuXit4/photo.jpg?sz=128", "display_name": "Ankur  Jyoti Phukan", "link": "https://stackoverflow.com/users/5687769/ankur-jyoti-phukan"}, "edited": false, "score": 0, "creation_date": 1515006881, "post_id": 48083613, "comment_id": 83142131, "body": "Try this link : <a href=\"http://www.cplusplus.com/articles/4z18T05o/\" rel=\"nofollow noreferrer\">cplusplus.com/articles/4z18T05o</a>  It contains different way to achieve clear screen"}, {"owner": {"reputation": 35, "user_id": 8413139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/01606641c5af7b3f1d22e434c54edf8f?s=128&d=identicon&r=PG&f=1", "display_name": "Handge", "link": "https://stackoverflow.com/users/8413139/handge"}, "edited": false, "score": 0, "creation_date": 1515006958, "post_id": 48083613, "comment_id": 83142177, "body": "Thanks, seemed to work on there but is it alright to user <code>system(&quot;CLS&quot;);</code> once?"}], "owner": {"reputation": 35, "user_id": 8413139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/01606641c5af7b3f1d22e434c54edf8f?s=128&d=identicon&r=PG&f=1", "display_name": "Handge", "link": "https://stackoverflow.com/users/8413139/handge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 785, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1515009479, "creation_date": 1515006262, "last_edit_date": 1515009479, "question_id": 48083613, "link": "https://stackoverflow.com/questions/48083613/is-it-ok-to-use-systemcls-with-visual-studio", "title": "Is it OK to use system(&quot;CLS&quot;) with Visual Studio?", "body": "<p>I was looking around on the Microsoft forums about clearing the console in the Windows Console Application. I was looking for an alternative to <code>system(\"CLS\")</code> because I heard that it was bad to use and unportable.  </p>\n\n<p>All I found was to use <code>system(\"CLS\")</code> and there weren't any alternatives that seemed to work. </p>\n\n<p>In Visual Studio 2017 (the version I'm using) is it OK<sup>1</sup> to use <code>system(\"CLS\")</code> and <code>system(\"pause\")</code>? </p>\n\n<hr>\n\n<p><sup>1)</sup><sub><strong><em>Ok</em></strong> as in it is not bad to use.</sub></p>\n"}, {"tags": ["c++", "exception-handling", "stdinitializerlist"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1515005767, "post_id": 48083469, "comment_id": 83141628, "body": "<code>new</code> can&#39;t return <code>nullptr</code> unless you use specify nothrow. It throws <a href=\"http://en.cppreference.com/w/cpp/memory/new/bad_alloc\" rel=\"nofollow noreferrer\"><code>std::bad_alloc</code></a> on failure to allocate."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 3, "creation_date": 1515005971, "post_id": 48083469, "comment_id": 83141730, "body": "I don&#39;t think this question is really a duplicate of the indicated dupe. It&#39;s really about safe resource management when not using a smart pointer. (hint: use a smart pointer)."}, {"owner": {"reputation": 405, "user_id": 8755549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/970b4e09b08d308c71281191d628ccf4?s=128&d=identicon&r=PG&f=1", "display_name": "WonFeiHong", "link": "https://stackoverflow.com/users/8755549/wonfeihong"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1515006024, "post_id": 48083469, "comment_id": 83141753, "body": "@RichardHodges Thank you for the hint. And please add an answer."}, {"owner": {"reputation": 405, "user_id": 8755549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/970b4e09b08d308c71281191d628ccf4?s=128&d=identicon&r=PG&f=1", "display_name": "WonFeiHong", "link": "https://stackoverflow.com/users/8755549/wonfeihong"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1515006193, "post_id": 48083469, "comment_id": 83141831, "body": "@RichardHodges: I don&#39;t really know why it is closed so quickly?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1515006247, "post_id": 48083469, "comment_id": 83141852, "body": "@WonFeiHong The question was closed because a similar question has already been asked and answered. But that decision has since been reversed. The question is currently open."}, {"owner": {"reputation": 405, "user_id": 8755549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/970b4e09b08d308c71281191d628ccf4?s=128&d=identicon&r=PG&f=1", "display_name": "WonFeiHong", "link": "https://stackoverflow.com/users/8755549/wonfeihong"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1515006281, "post_id": 48083469, "comment_id": 83141862, "body": "@Fran&#231;oisAndrieux: Ok. Thank you."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1515006328, "post_id": 48083469, "comment_id": 83141884, "body": "Normally, you would use <code>std::vector</code> and avoid all of these problems. However, since you seem to be trying to implement your own vector (perhaps as a learning exercise?) then you could use <a href=\"https://stackoverflow.com/questions/16711697/is-there-any-use-for-unique-ptr-with-array\"><code>std::unique_ptr&lt;int[]&gt;</code></a> instead. In any case, you should rely on <a href=\"https://stackoverflow.com/questions/2321511/what-is-meant-by-resource-acquisition-is-initialization-raii\">RAII</a> rather than trying to catch exceptions and cleaning up manually. A class should only do that manually if that it&#39;s specific and unique job."}], "answers": [{"tags": [], "owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "is_accepted": false, "score": 1, "last_activity_date": 1515006810, "creation_date": 1515006810, "answer_id": 48083729, "question_id": 48083469, "link": "https://stackoverflow.com/questions/48083469/how-to-use-exception-handling-with-initializer-list-with-constructor/48083729#48083729", "title": "How to use exception handling with initializer-list with constructor?", "body": "<p>1) extract size validation check into a separate static method (most likely it will be reused anyway); 2) there is no need to check the value returned by <code>new</code> anymore, it should thrown an <code>std::bad_alloc</code> exception if fails. So your code can become something like this:</p>\n\n<pre><code>class CVector{\npublic:\n    CVector(const int);\n    static int Validate_Size(int const size);\nprotected:\n    int * m_pInt;\n    int m_size;\n};\n\nint CVector::Validate_Size(int const size)\n{\n   if(size &lt;= 0)\n   {\n      throw std::invalid_argument{};\n   }\n   return(size);\n}\n\nCVector::CVector(const int size)\n:  m_pInt{new int[Validate_Size(size)]}\n,  m_size{size}\n{}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": true, "score": 2, "last_activity_date": 1515007057, "creation_date": 1515007057, "answer_id": 48083785, "question_id": 48083469, "link": "https://stackoverflow.com/questions/48083469/how-to-use-exception-handling-with-initializer-list-with-constructor/48083785#48083785", "title": "How to use exception handling with initializer-list with constructor?", "body": "<p>On first view, it's not clear whether you intend CVector to responsibility for owning the dynamic of integers or not. You probably do.</p>\n\n<p>Almost without fail, you will want each class in your program to manage at most one dynamic resource (such as allocated memory). This is because the job becomes onerous when there is more than one resource.</p>\n\n<p>In your case, the resource is the int array. So let's give CVector the responsibility, and let's manage that responsibility using a <code>unique_ptr</code>:</p>\n\n<pre><code>#include &lt;memory&gt;\n#include &lt;cstddef&gt;\n#include &lt;algorithm&gt;\n\nstruct CVector\n{\n    CVector(std::size_t initial_size)\n    : data_ { std::make_unique&lt;int[]&gt;(initial_size) }\n    , size_ { initial_size }\n    {\n    }\n\n    // we will probably want the vector to be copyable\n    CVector(CVector const&amp; other)\n    : data_ { std::make_unique&lt;int[]&gt;(other.size_) }\n    , size_ { other.size_ }\n    {\n        auto first = other.data_.get();\n        auto last = first + other.size_;\n        std::copy(first, last, data_.get());\n    }\n\n    // move consruction is defaultable because it is enabled for\n    // unique_ptr\n\n    CVector(CVector&amp;&amp;) = default;\n\n    // assignment\n\n    CVector&amp; operator=(CVector const&amp; other)\n    {\n        auto temp = other;\n        swap(temp);\n        return *this;\n    }\n\n    CVector&amp; operator=(CVector&amp;&amp; other) = default;\n\n    // no need for a destructor. unique_ptr takes care of it\n\n    void swap(CVector&amp; other) noexcept\n    {\n        using std::swap;\n        swap(data_, other.data_);\n        swap(size_, other.size_);\n    }\n\nprivate:\n    // defer memory ownership to a class built for the job.\n    std::unique_ptr&lt;int[]&gt; data_;\n    std::size_t size_;\n};\n</code></pre>\n"}], "owner": {"reputation": 405, "user_id": 8755549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/970b4e09b08d308c71281191d628ccf4?s=128&d=identicon&r=PG&f=1", "display_name": "WonFeiHong", "link": "https://stackoverflow.com/users/8755549/wonfeihong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 48083785, "answer_count": 2, "score": 1, "last_activity_date": 1515007057, "creation_date": 1515005664, "question_id": 48083469, "link": "https://stackoverflow.com/questions/48083469/how-to-use-exception-handling-with-initializer-list-with-constructor", "title": "How to use exception handling with initializer-list with constructor?", "body": "<p>I used to use <code>initialization list</code> through Constructor and everything went well. But now I need some <code>exception handling</code> in my class.</p>\n\n<p>So here is some sample code:</p>\n\n<p>1- Without exception handling</p>\n\n<pre><code>class CVector{\n    public:\n        CVector(const int);\n    protected:\n        int* pInt;\n        int size;\n};\n\nCVector::CVector(const int sz) :\n    pInt{ new int[sz]}, size{ sz}{\n\n}\n</code></pre>\n\n<p>The constructor above doesn't check whether an invalid sized is passed, or <code>new</code> failed...</p>\n\n<p>Now I edited the constructor to handle exceptions:</p>\n\n<p>2- With exception handling:</p>\n\n<pre><code>CVector::CVector(const int sz){\n    size = sz;\n    if(size &lt;=0 )\n        throw; // some exception object\n\n    pInt = new int[sz];\n    if(nullptr == pInt)\n        throw; // some memory exception\n}\n</code></pre>\n\n<ul>\n<li>The problem now: Are they exclusive? - I mean How to mix exception handling with initialization-list through Constructor?</li>\n</ul>\n"}, {"tags": ["c++", "templates", "gcc", "clang", "constants"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 6, "creation_date": 1515003907, "post_id": 48083051, "comment_id": 83140626, "body": "I&#39;m not sure what a pointer-to-const-function actually means or how it differs from a non-const-pointer-to-function."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1515003956, "post_id": 48083051, "comment_id": 83140653, "body": "<a href=\"http://coliru.stacked-crooked.com/a/737529ab9de74c17\" rel=\"nofollow noreferrer\">Can reproduce on this GCC</a>"}, {"owner": {"reputation": 1040, "user_id": 4154993, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Bv8Wx.jpg?s=128&g=1", "display_name": "Valentin", "link": "https://stackoverflow.com/users/4154993/valentin"}, "edited": false, "score": 2, "creation_date": 1515004152, "post_id": 48083051, "comment_id": 83140751, "body": "Visual studio outputs &#39;B&#39;"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 3, "creation_date": 1515004581, "post_id": 48083051, "comment_id": 83140986, "body": "<a href=\"https://wandbox.org/permlink/LeH2JXzyYlitiB4k\" rel=\"nofollow noreferrer\"><code>as_const</code> is irrelevant for this example.</a>"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1515004683, "post_id": 48083051, "comment_id": 83141035, "body": "Pretty sure you can&#39;t have pointers to <code>const</code> function types. See N4141 8.3.5/6 and 8.3.1/4."}, {"owner": {"reputation": 36538, "user_id": 471164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/45d4a7ba0fb8e789356f5da87536444d?s=128&d=identicon&r=PG", "display_name": "vitaut", "link": "https://stackoverflow.com/users/471164/vitaut"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1515004792, "post_id": 48083051, "comment_id": 83141094, "body": "@VTT, good catch, I thought this is a minimal example, but apparently the difference is there even without as_const."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1515004891, "post_id": 48083051, "comment_id": 83141144, "body": "Seems like you could assign a pointer to const function to a pointer to non-const function. <code>void(*ptr)() = as_const(&amp;f);</code> seems fine. I guess the question is why there isn&#39;t an ambiguity between the <code>g</code> overloads."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1515005275, "post_id": 48083051, "comment_id": 83141330, "body": "Related, potential dupe: <a href=\"https://stackoverflow.com/q/19131309/3002139\">stackoverflow.com/q/19131309/3002139</a>"}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1515005278, "post_id": 48083051, "comment_id": 83141332, "body": "@BaummitAugen Note that if you remove the non-const <code>g</code> overload, then gcc actually fails to compile, which would be correct according to what you suggest. So I think this is just a bug in clang."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1515005455, "post_id": 48083051, "comment_id": 83141434, "body": "There is a correct answer on the dupe but it doesn&#39;t do it full justice. From my understanding of SO etiquette this question should be closed as a dupe, and Baum should post his answer citing the standard there (or even as an edit to one of the existing answers, which is basically correct)."}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1515005480, "post_id": 48083051, "comment_id": 83141450, "body": "Perhaps UB due to an ODR violation which the compilers cannot or don&#39;t bother to report because of the generic pointer argument? If you make the functions non-generic, then you get redefinition errors."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 3, "creation_date": 1515005605, "post_id": 48083051, "comment_id": 83141526, "body": "@ChristianHackl I don&#39;t undersatnd why you think that this is an ODR violation; the functions have two different signatures, and template deduction + overload rules will lead to exactly the intuitive behavior if you are working with pointers to objects (rather than to functions)."}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "reply_to_user": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1515005716, "post_id": 48083051, "comment_id": 83141592, "body": "@NirFriedman: I believe you&#39;re correct and I misplaced the <code>const</code> qualifier."}], "answers": [{"comments": [{"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1515011366, "post_id": 48083702, "comment_id": 83144132, "body": "Might be worth mentioning explicitly that gcc does in fact fail to compile that example; gcc could in principle give the non-const <code>g</code> priority, but still compile the const qualified pointer version if the other were unavailable."}], "tags": [], "owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "is_accepted": true, "score": 17, "last_activity_date": 1515375086, "last_edit_date": 1515375086, "creation_date": 1515006712, "answer_id": 48083702, "question_id": 48083051, "link": "https://stackoverflow.com/questions/48083051/different-compiler-behavior-when-applying-a-const-qualifier-to-a-template-argume/48083702#48083702", "title": "Different compiler behavior when applying a const qualifier to a template argument", "body": "<p>It appears you hit a defect in the standard which has yet to be resolved. So the answer to \"Which compiler is right?\" would be not entirely clear currently.</p>\n\n<p>The issue has been raised to and discussed by the committee:</p>\n\n<blockquote>\n  <p>It is not clear whether the following is well-formed or not:</p>\n\n<pre><code>void foo(){}\n\ntemplate&lt;class T&gt;\nvoid deduce(const T*) { }\n\nint main() {\n  deduce(foo);\n}\n</code></pre>\n  \n  <p>Implementations vary in their treatment of this example.</p>\n</blockquote>\n\n<p>see <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1584\" rel=\"noreferrer\">http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1584</a>, but the proposed resolution is not part of N4141 or N4659.</p>\n\n<p>Note that you generally cannot have pointers to <code>const</code> function types; if you consider the example I quoted ill-formed, gcc would be correct. It does reject the example and, in the OP, picks the non-const version as the only viable overload.</p>\n\n<p>If clang (which <a href=\"https://stackoverflow.com/a/19287408/3002139\">claims to implement the proposed resolution</a>) would be right otherwise, I am not sure. I guess we'd have to revisit that discussion once the committee resolved the issue with some normative wording we can use.</p>\n\n<p>However,</p>\n\n<blockquote>\n  <p>The consensus of CWG was that the cv-qualification of the argument and parameter must match, so the original example should be rejected.</p>\n</blockquote>\n\n<p>(note to said issue) seems to indicate that gcc is right and the issue will be resolved in favor of its behavior.</p>\n"}], "owner": {"reputation": 36538, "user_id": 471164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/45d4a7ba0fb8e789356f5da87536444d?s=128&d=identicon&r=PG", "display_name": "vitaut", "link": "https://stackoverflow.com/users/471164/vitaut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 9, "accepted_answer_id": 48083702, "answer_count": 1, "score": 27, "last_activity_date": 1515375086, "creation_date": 1515003754, "last_edit_date": 1515004979, "question_id": 48083051, "link": "https://stackoverflow.com/questions/48083051/different-compiler-behavior-when-applying-a-const-qualifier-to-a-template-argume", "title": "Different compiler behavior when applying a const qualifier to a template argument", "body": "<p>Consider the following example (<a href=\"https://godbolt.org/g/gzCzKi\" rel=\"noreferrer\">godbolt</a>):</p>\n\n<pre><code>#include &lt;iostream&gt;\n\ntemplate &lt;typename T&gt;\nconst T *as_const(T *p) { return p; }\n\nvoid f() {}\n\ntemplate &lt;typename T&gt;\nvoid g(T *) { std::cout &lt;&lt; \"A\"; }\n\ntemplate &lt;typename T&gt;\nvoid g(const T *) { std::cout &lt;&lt; \"B\"; }\n\nint main() {\n  g(as_const(&amp;f));\n}\n</code></pre>\n\n<p>Both GCC and Clang can compile it, but the resulting executables produce different output: the version compiled with GCC prints <code>A</code> and the one compiled with Clang prints <code>B</code>.</p>\n\n<p>Could you explain this difference?</p>\n\n<p><strong>Update</strong>: as pointed out by @VTT the same difference is observed even if <code>as_const</code> is dropped.</p>\n"}, {"tags": ["c++", "windows", "directx", "game-engine", "directx-11"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1515003265, "post_id": 48082901, "comment_id": 83140306, "body": "Did you add the folder containing this file to your linker settings? Does this file exist? Are you mixing 32 and 64 bit? Note that <code>Effects11d.lib</code> can only be used in debug builds."}, {"owner": {"reputation": 57, "user_id": 5000201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/90xA3.jpg?s=128&g=1", "display_name": "Ciaran Evans", "link": "https://stackoverflow.com/users/5000201/ciaran-evans"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1515003497, "post_id": 48082901, "comment_id": 83140431, "body": "<code>DXUT\\Core;DXUT\\Optional;C:\\Users\\Ciaran\\Desktop\\Common;%(Add&zwnj;&#8203;itionalIncludeDirect&zwnj;&#8203;ories)</code> it&#39;s there and being built in debug mode. (I can see the file in the \\Common dir)"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1515003674, "post_id": 48082901, "comment_id": 83140522, "body": "Maybe you are mixing 32 and 64 bit. You can&#39;t link a 32 bit library with a 64 bit exe or viseversa."}, {"owner": {"reputation": 57, "user_id": 5000201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/90xA3.jpg?s=128&g=1", "display_name": "Ciaran Evans", "link": "https://stackoverflow.com/users/5000201/ciaran-evans"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1515004352, "post_id": 48082901, "comment_id": 83140866, "body": "Heres the top level configuration properties: <a href=\"https://i.imgur.com/4xe9RMV.png\" rel=\"nofollow noreferrer\">image</a>"}], "answers": [{"tags": [], "owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "is_accepted": true, "score": 2, "last_activity_date": 1515014703, "creation_date": 1515014703, "answer_id": 48085338, "question_id": 48082901, "link": "https://stackoverflow.com/questions/48082901/directx11-frank-luna-error-lnk1104-cannot-open-file-effects11d-lib-particles/48085338#48085338", "title": "DirectX11 Frank Luna - Error LNK1104 cannot open file &#39;Effects11d.lib&#39; ParticleSystem", "body": "<p>You are likely missing the LIBRARY search path for his <code>Common</code> folder. This should be specified in your project properties under the Linker's <em>Additional Library Directories</em> property page.</p>\n\n<p>Note that this also assumes you are only building 32-bit (x86) versions of the code since he didn't provide a 64-bit version of the <code>Effects11?.lib</code>.</p>\n\n<p><em>Effects for Direct3D 11</em> is intended to be built by the developer rather than treated as a 'system library'. You can and should build it from source yourself. See <a href=\"https://github.com/Microsoft/FX11/wiki\" rel=\"nofollow noreferrer\">GitHub</a>. Alternatively, you can use the <a href=\"https://www.nuget.org/packages/fx11_desktop_2015/\" rel=\"nofollow noreferrer\">NuGet</a> package built for VS 2015.</p>\n\n<blockquote>\n  <p>Also be aware that Frank's book is a little outdated since it was published before the DirectX SDK itself was declared <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ee663275.aspx\" rel=\"nofollow noreferrer\">end-of-life</a>. See <a href=\"https://blogs.msdn.microsoft.com/chuckw/2014/04/07/book-recommendations/\" rel=\"nofollow noreferrer\">this blog post</a> for some notes. Also it's worth mentioning that Effects itself is \"as is\", and HLSL compiler support for the <code>fx_5_0</code> profile is itself deprecated.</p>\n</blockquote>\n"}], "owner": {"reputation": 57, "user_id": 5000201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/90xA3.jpg?s=128&g=1", "display_name": "Ciaran Evans", "link": "https://stackoverflow.com/users/5000201/ciaran-evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 0, "accepted_answer_id": 48085338, "answer_count": 1, "score": 0, "last_activity_date": 1515014703, "creation_date": 1515003111, "question_id": 48082901, "link": "https://stackoverflow.com/questions/48082901/directx11-frank-luna-error-lnk1104-cannot-open-file-effects11d-lib-particles", "title": "DirectX11 Frank Luna - Error LNK1104 cannot open file &#39;Effects11d.lib&#39; ParticleSystem", "body": "<p>Trying to get Frank Lunas <a href=\"http://www.d3dcoder.net/d3d11.htm\" rel=\"nofollow noreferrer\">http://www.d3dcoder.net/d3d11.htm</a> sample code working.</p>\n\n<p>Running the Chapter 20 Project and I'm getting:</p>\n\n<pre><code>Error   LNK1104 cannot open file 'Effects11d.lib' ParticleSystem    \n</code></pre>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1515002880, "post_id": 48082810, "comment_id": 83140111, "body": "How often do you call that code? Do you use a QTimer to call that code?"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1515002946, "post_id": 48082810, "comment_id": 83140147, "body": "What is visina and sirina?"}, {"owner": {"reputation": 6940, "user_id": 1559401, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/t9DjW.jpg?s=128&g=1", "display_name": "rbaleksandar", "link": "https://stackoverflow.com/users/1559401/rbaleksandar"}, "edited": false, "score": 0, "creation_date": 1515002976, "post_id": 48082810, "comment_id": 83140161, "body": "Please define &quot;real time&quot;. It seems you are not familiar with how computers work. On a standard PC with your standard OS realtime is something you can only dream about."}, {"owner": {"reputation": 25, "user_id": 9169388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/384b364dcb6532093545ef4b606f30fd?s=128&d=identicon&r=PG&f=1", "display_name": "Janez Poto\u010dnik", "link": "https://stackoverflow.com/users/9169388/janez-poto%c4%8dnik"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1515003028, "post_id": 48082810, "comment_id": 83140187, "body": "visina = height, sirina = width @eyllanesc"}, {"owner": {"reputation": 25, "user_id": 9169388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/384b364dcb6532093545ef4b606f30fd?s=128&d=identicon&r=PG&f=1", "display_name": "Janez Poto\u010dnik", "link": "https://stackoverflow.com/users/9169388/janez-poto%c4%8dnik"}, "reply_to_user": {"reputation": 6940, "user_id": 1559401, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/t9DjW.jpg?s=128&g=1", "display_name": "rbaleksandar", "link": "https://stackoverflow.com/users/1559401/rbaleksandar"}, "edited": false, "score": 0, "creation_date": 1515003103, "post_id": 48082810, "comment_id": 83140221, "body": "@rbaleksandar by realtime i mean when the car is supposedly going forward, not actual realtime, sorry"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1515003135, "post_id": 48082810, "comment_id": 83140240, "body": "Place a code that can be reproduced and thus observe the problem, we call that <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, the error may depend on how you call that code, do you use a QTimer to update the image?"}, {"owner": {"reputation": 192, "user_id": 7002816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3zZvm.jpg?s=128&g=1", "display_name": "LosWochos", "link": "https://stackoverflow.com/users/7002816/loswochos"}, "edited": false, "score": 0, "creation_date": 1515010006, "post_id": 48082810, "comment_id": 83143600, "body": "I dont think that you should misuse a QImage to draw pixels in a QGraphicsScene. You should have a look here: <a href=\"https://stackoverflow.com/questions/9139847/setpixel-of-qgraphicsscene-in-qt\" title=\"setpixel of qgraphicsscene in qt\">stackoverflow.com/questions/9139847/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 377, "user_id": 2151404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd247a37becf4400999c70d7fc56b084?s=128&d=identicon&r=PG", "display_name": "Andr&#233;", "link": "https://stackoverflow.com/users/2151404/andr%c3%a9"}, "is_accepted": false, "score": 0, "last_activity_date": 1515048100, "creation_date": 1515048100, "answer_id": 48089973, "question_id": 48082810, "link": "https://stackoverflow.com/questions/48082810/drawing-pixels-to-create-movement-effect-in-qt/48089973#48089973", "title": "drawing pixels to create movement effect in Qt", "body": "<p>Your approach to drawing this background is going to be extremely slow. There is no need to do pixel-level manipulations of QImage when all you want to do is draw a few dark green rectangles on a light green background or the other way around. </p>\n\n<p>It looks like this is to be included in a QGraphicsScene. If so, I'd simply subclass a QGraphicsRectItem. Reimplement its paint method to first fill the item with one color, and then draw the bands over that using the other color. Each band can be drawn as a single rectangle. The positions and sizes of the bands should be different based on some progress value that you can then animate according to the speed. With each progress change, you then call update on your graphics item for the whole item so the framework will schedule a redraw.</p>\n\n<p>If this were a QML thing, I'd say implement your own QML item and use a shader to do the drawing. That would be the fastest solution by far, and the drawing is simple enough to fully calculate in a shader. </p>\n"}], "owner": {"reputation": 25, "user_id": 9169388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/384b364dcb6532093545ef4b606f30fd?s=128&d=identicon&r=PG&f=1", "display_name": "Janez Poto\u010dnik", "link": "https://stackoverflow.com/users/9169388/janez-poto%c4%8dnik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515048100, "creation_date": 1515002650, "last_edit_date": 1515003182, "question_id": 48082810, "link": "https://stackoverflow.com/questions/48082810/drawing-pixels-to-create-movement-effect-in-qt", "title": "drawing pixels to create movement effect in Qt", "body": "<p>I'm making a drag race game in QT. I want to draw lines like</p>\n\n<p><a href=\"https://youtu.be/KkMZI5Jbf18?list=PLwPf3vved8fj9V28pxdD2aauo470UKGUz&amp;t=727\" rel=\"nofollow noreferrer\">https://youtu.be/KkMZI5Jbf18?list=PLwPf3vved8fj9V28pxdD2aauo470UKGUz&amp;t=727</a></p>\n\n<p>for the illusion of movement, but i can only draw it once with QImage, if I put it in the loop it won't even start. </p>\n\n<pre><code>QImage cesta(1200, 800, QImage::Format_RGB32);\n\nfor(int y=0; y&lt;visina/2;y++)\n{ for(int x=0; x&lt;sirina;x++)\n {\n     float perspective = (float)y / (visina /2.0);\n\n\n     float middle = 0.5;\n     float rwidth = 0.1 + perspective * 0.8; //0.6\n     float cwidth = rwidth * 0.15;\n\n     rwidth *=0.5;\n\n     int leftgrass = (middle - rwidth - cwidth) * sirina;\n     int leftclip = (middle - rwidth) * sirina;\n     int rightclip = (middle + rwidth) * sirina;\n     int rightgrass = (middle + rwidth + cwidth) * sirina;\n\n     int row = 800 / 2 +y;\n\n     QRgb grasscolor = sinf(20.0 * powf(1.0 - perspective,3) + distance * 0.1) &gt; 0.0f ?  qRgb(0, 174, 78) : qRgb(0, 111, 16);\n\n\n     if(x &gt;=0 &amp;&amp; x&lt;leftgrass)\n        {cesta.setPixel(x,row,grasscolor);\n          QPixmap pixmap = QPixmap::fromImage(cesta);}\n     if(x &gt;=leftgrass &amp;&amp; x&lt;leftclip)\n        cesta.setPixel(x,row,qRgb(255, 0, 0));\n\n     if(x &gt;=leftclip &amp;&amp; x&lt;rightclip)\n        cesta.setPixel(x,row,qRgb(55, 55, 55));\n\n     if(x &gt;=rightclip &amp;&amp; x&lt;rightgrass)\n        cesta.setPixel(x,row,qRgb(255, 0, 0));\n\n     if(x &gt;=rightgrass &amp;&amp; x&lt;sirina)\n        {cesta.setPixel(x,row,grasscolor);\n          QPixmap pixmap = QPixmap::fromImage(cesta);}\n\n }\n\n\n}\n\nQPixmap pixmap = QPixmap::fromImage(cesta);\n scene-&gt;addPixmap(pixmap);\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "thread-safety", "shared-ptr", "stdatomic"], "comments": [{"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 3, "creation_date": 1515003404, "post_id": 48082774, "comment_id": 83140389, "body": "<i>pointer to smart pointer</i> sounds like poor design. Yes, you&#39;ll need either atomics or locks to protect access to the shared resource, <code>smth_</code>."}, {"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 1, "creation_date": 1515003926, "post_id": 48082774, "comment_id": 83140632, "body": "consider the function <code>std::atomic_exchange</code> for <code>std::shared_ptr</code>, <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr/atomic\" rel=\"nofollow noreferrer\">cppreference</a>"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 0, "creation_date": 1515019449, "post_id": 48082774, "comment_id": 83147403, "body": "@vu1p3n0x: <code>shared_ptr</code> is not trivially copyable, so you can&#39;t use <code>atomic&lt;shared_ptr&gt;</code>.  The ref-count block pointed-to by a <code>shared_ptr</code> instance has atomic counters, but the <code>shared_ptr</code> itself is not thread-safe."}, {"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1515032377, "post_id": 48082774, "comment_id": 83150504, "body": "@PeterCordes I wasn&#39;t referring to <code>atomic&lt;shared_ptr&gt;</code> but the atomic operations that can be called with <code>shared_ptr</code>s that I linked"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 0, "creation_date": 1515033686, "post_id": 48082774, "comment_id": 83150758, "body": "@vu1p3n0x: thanks, I didn&#39;t realize those existed.  It&#39;s atomic but usually not lock-free: it&#39;s normally implemented with a mutex (using a hash table of mutexes, keyed by the pointer value).  Maybe m68k could be lock-free using its atomic memory-to-memory copy instruction, but most architectures don&#39;t have that.  Interestingly, C++20 is planning to deprecate it in favour of a <code>std::atomic&lt;std::shared_ptr&gt;</code> template specialization."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 0, "creation_date": 1515034255, "post_id": 48082774, "comment_id": 83150867, "body": "@vu1p3n0x: You can&#39;t <i>just</i> use <code>std::atomic_exchange</code>.  I think you have to change even the read-only accesses to use <code>atomic_load</code>, if they can happen at the same time as it&#39;s being mutated by <code>atomic_exchange</code>.  The wording in cppreference isn&#39;t 100% clear, but that&#39;s almost certainly what they mean.  You need <code>atomic_load</code> to respect the mutex that <code>atomic_exchange</code> takes while modifying the <code>shared_ptr</code> object."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 1, "creation_date": 1515039894, "post_id": 48082774, "comment_id": 83151913, "body": "Yes, the wording starting with <i>If multiple threads</i> is unclear, but I believe it means the following (disjoint) cross-thread scenarios are safe (a) all accesses are to <code>const</code>-qualified member functions or (b) all accesses are via these <code>std::atomic...</code> overloads. I don&#39;t think they mean that you can use a combination of <code>const</code>-qualified access and these atomic overloads together, safely."}], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 2207495, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/cac9d2fb99355ec43967b347fabae182?s=128&d=identicon&r=PG", "display_name": "user2207495", "link": "https://stackoverflow.com/users/2207495/user2207495"}, "edited": false, "score": 0, "creation_date": 1515004745, "post_id": 48083000, "comment_id": 83141071, "body": "Thread 2 is a periodic configuration retriever. Other threads use directly structure A. So you are suggesting that i implement in the structure B method getConfig that returns the copy of current shared_ptr directly to other threads on demand?"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "reply_to_user": {"reputation": 315, "user_id": 2207495, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/cac9d2fb99355ec43967b347fabae182?s=128&d=identicon&r=PG", "display_name": "user2207495", "link": "https://stackoverflow.com/users/2207495/user2207495"}, "edited": false, "score": 0, "creation_date": 1515005887, "post_id": 48083000, "comment_id": 83141686, "body": "@user2207495 So other threads hold pointers to the same <code>struct A</code> object? Or do they each have their own <code>struct A</code> object containing <i>copies</i> of the original <code>shared_ptr</code>?"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "reply_to_user": {"reputation": 315, "user_id": 2207495, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/cac9d2fb99355ec43967b347fabae182?s=128&d=identicon&r=PG", "display_name": "user2207495", "link": "https://stackoverflow.com/users/2207495/user2207495"}, "edited": false, "score": 0, "creation_date": 1515006033, "post_id": 48083000, "comment_id": 83141756, "body": "@user2207495 One thing to be aware of, reseating the <code>shared_ptr</code> will only reseat the <i>single</i> <code>shared_ptr</code> that you hold the reference to. All other copies of the original <code>shared_ptr</code> will remain unaffected and continue pointing to the original object."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "reply_to_user": {"reputation": 315, "user_id": 2207495, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/cac9d2fb99355ec43967b347fabae182?s=128&d=identicon&r=PG", "display_name": "user2207495", "link": "https://stackoverflow.com/users/2207495/user2207495"}, "edited": false, "score": 0, "creation_date": 1515006160, "post_id": 48083000, "comment_id": 83141816, "body": "@user2207495 My gut feeling (without really knowing your situation) is that you need to replace the pointed-to object using a (synchronized) <i>value copy</i> rather than manipulate the pointers. So every thread points to the same object using a (copied) <code>shared_ptr</code> and when it needs to change, you overwrite that object with a new copy (under synchronization)."}, {"owner": {"reputation": 315, "user_id": 2207495, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/cac9d2fb99355ec43967b347fabae182?s=128&d=identicon&r=PG", "display_name": "user2207495", "link": "https://stackoverflow.com/users/2207495/user2207495"}, "edited": false, "score": 0, "creation_date": 1515006885, "post_id": 48083000, "comment_id": 83142135, "body": "Sorry for slow response, other threads hold pointers to the same struct A object. I need to store global configuration for other threads. When a new configuration appears in the periodic thread it automatically swaps the content so that every other thread will reload the configuration. Other threads are in read only mode so there should be no real race condition what so ever in my opinion."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "reply_to_user": {"reputation": 315, "user_id": 2207495, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/cac9d2fb99355ec43967b347fabae182?s=128&d=identicon&r=PG", "display_name": "user2207495", "link": "https://stackoverflow.com/users/2207495/user2207495"}, "edited": false, "score": 0, "creation_date": 1515007349, "post_id": 48083000, "comment_id": 83142367, "body": "@user2207495 So it seems you only have <b>one</b> <code>shared_ptr</code>? It sounds to me like maybe you just need a <code>unique_ptr</code>? In that case, what you are doing should work <b>but</b> you have to synchronize the swap because you do have a race condition. When the old object is destructed, other threads could be reading from it."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "reply_to_user": {"reputation": 315, "user_id": 2207495, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/cac9d2fb99355ec43967b347fabae182?s=128&d=identicon&r=PG", "display_name": "user2207495", "link": "https://stackoverflow.com/users/2207495/user2207495"}, "edited": false, "score": 0, "creation_date": 1515007569, "post_id": 48083000, "comment_id": 83142461, "body": "@user2207495 To be more efficient you can implement read/write locking (if you have <code>C++14</code> or later) along the lines of this answer: <a href=\"https://stackoverflow.com/questions/39185420/is-there-a-shared-lock-guard-and-if-not-what-would-it-look-like/39185510#39185510\" title=\"is there a shared lock guard and if not what would it look like\">stackoverflow.com/questions/39185420/&hellip;</a>"}, {"owner": {"reputation": 315, "user_id": 2207495, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/cac9d2fb99355ec43967b347fabae182?s=128&d=identicon&r=PG", "display_name": "user2207495", "link": "https://stackoverflow.com/users/2207495/user2207495"}, "edited": false, "score": 0, "creation_date": 1515007617, "post_id": 48083000, "comment_id": 83142481, "body": "Well yes, I could use <code>unique_ptr</code> in this situation. But what do you think about this situation passing pointer to unique_ptr? Both for periodic thread and other threads?"}, {"owner": {"reputation": 315, "user_id": 2207495, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/cac9d2fb99355ec43967b347fabae182?s=128&d=identicon&r=PG", "display_name": "user2207495", "link": "https://stackoverflow.com/users/2207495/user2207495"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1515007911, "post_id": 48083000, "comment_id": 83142605, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/162452/discussion-between-user2207495-and-galik\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "is_accepted": false, "score": 1, "last_activity_date": 1515003519, "creation_date": 1515003519, "answer_id": 48083000, "question_id": 48082774, "link": "https://stackoverflow.com/questions/48082774/passing-pointer-to-shared-ptr-thread-safety/48083000#48083000", "title": "Passing pointer to shared_ptr thread safety", "body": "<p>My mind is boggling at how you might have ended up with this design choice... I hope it makes sense in your real project.</p>\n\n<p>The <em>only</em> reason your should be passing a pointer (or preferably a reference) to a <code>shared_ptr</code> is to re-seat it (as you are doing) and you don't need to synchronize the <em>swap</em> itself (<code>shared_ptr</code> is already synchronized). </p>\n\n<p>Swapping the contents, however, will cause synchronization issues with other threads that are using the object (reading or writing) at the time. So you would need to apply the same synchronization techniques you would apply if both threads were modifying the object.</p>\n\n<p>This doesn't feel to me like a robust solution to whatever your actual problem is. Maybe consider passing a new <code>std::shared_ptr</code> to the other thread and then <em>signaling</em> it so it knows to pick up the new shared pointer (by copy not pointer).</p>\n"}, {"comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1515033881, "post_id": 48086339, "comment_id": 83150794, "body": "There are <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr/atomic\" rel=\"nofollow noreferrer\">some overloads of atomic functions for <code>std::shared_ptr</code></a>, as @vu1p3n0x mentioned.  They use a hidden mutex for you to make it possible to do stuff like atomically exchange what a <code>shared_ptr</code> points to, as long as all other accesses to that <code>shared_ptr</code> use <code>atomic_load</code> and so on."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1515039678, "post_id": 48086339, "comment_id": 83151864, "body": "@PeterCordes - thanks, I didn&#39;t even know those existed!"}], "tags": [], "owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "is_accepted": false, "score": 1, "last_activity_date": 1515023694, "last_edit_date": 1515023694, "creation_date": 1515020128, "answer_id": 48086339, "question_id": 48082774, "link": "https://stackoverflow.com/questions/48082774/passing-pointer-to-shared-ptr-thread-safety/48086339#48086339", "title": "Passing pointer to shared_ptr thread safety", "body": "<p>Contrary to (some) conventional wisdom, <code>shared_ptr</code> objects are themselves <strong>not thread-safe</strong>. That is, you cannot concurrently manipulate<sup>1</sup> a single <code>shared_ptr</code> object on different threads, any more than you could concurrently manipulate a <code>std::vector</code> or <code>std::string</code> or any other standard library object with \"default\" thread-safety.</p>\n\n<p>The confusion arises because a typical <code>shared_ptr</code> does use atomic operations to manipulate its reference count - but that's only to support the scenario where <em>different</em> <code>shared_ptr</code> objects point to the same underlying object (and hence share a reference count).</p>\n\n<p>This kind of hidden sharing is the same type of thing that used to occur with COW implementations of <code>std::string</code>: you could never safely manipulate the same <code>std::string</code> objects on different threads without locking, but the COW behavior meant that without atomic operations you couldn't even manipulate two <em>different</em> <code>std::string</code> objects which happened to share the same underlying buffer on different threads, a violation of the value-semantics of <code>std::string</code> objects and the standard library thread safety guarantees. So in practice, you had atomic operations to manipulate the COW buffer reference count, but the other operations were written as usual in a not-thread-safe way.</p>\n\n<p>So the bottom line is that not only is probably a bad design to share a <code>shared_ptr</code> like this: it is explicitly not allowed since it is not thread-safe.</p>\n\n<hr>\n\n<p><sup>1</sup> Concurrently manipulate here means to access the <code>shared_ptr</code> objects on more than one thread, where at least some of the accesses are to non-<code>const</code> methods. The standard library provides a general guarantee that concurrent access that consists <em>only</em> of <code>const</code>-method access is safe (i.e., <code>const</code> serves as a flag that the operation is \"read-only\" from a threading perspective). </p>\n"}], "owner": {"reputation": 315, "user_id": 2207495, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/cac9d2fb99355ec43967b347fabae182?s=128&d=identicon&r=PG", "display_name": "user2207495", "link": "https://stackoverflow.com/users/2207495/user2207495"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1515023694, "creation_date": 1515002524, "question_id": 48082774, "link": "https://stackoverflow.com/questions/48082774/passing-pointer-to-shared-ptr-thread-safety", "title": "Passing pointer to shared_ptr thread safety", "body": "<pre><code>// Example program\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;memory&gt;\n#include &lt;atomic&gt;\n\nstruct Smth {};\n\nstruct B { //Used in thread 2\n    B(std::shared_ptr&lt;Smth&gt;* smth) : smth_(smth) {};\n    ~B();\n    void DoSomething() {\n        std::shared_ptr&lt;Smth&gt; newSmth = std::make_shared&lt;Smth&gt;();\n        smth_-&gt;swap(newSmth);\n    }\n    std::shared_ptr&lt;Smth&gt;* smth_;\n};\n\nstruct A { //Used in thread 1&amp;3\n  A() : smth_(std::make_shared&lt;Smth&gt;()), b_(&amp;smth_) {};\n  ~A();\n  std::shared_ptr&lt;Smth&gt; smth_;\n  B b_;\n};\n</code></pre>\n\n<p>So is it good practice to pass pointer to shared_ptr so that i can swap the contents of shared_ptr in the separate thread?\nThe second question is should I use the std::atomic_store to replace the shared_ptr::swap, if so how should i do that?</p>\n"}, {"tags": ["c++", "algorithm", "geometry", "computational-geometry"], "comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 2, "creation_date": 1515002227, "post_id": 48082681, "comment_id": 83139785, "body": "Do you know about <a href=\"https://math.stackexchange.com\">math.stackexchange.com</a> ?"}, {"owner": {"reputation": 608, "user_id": 3904858, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34b74f56d8756f1278d689152c004200?s=128&d=identicon&r=PG&f=1", "display_name": "philm", "link": "https://stackoverflow.com/users/3904858/philm"}, "reply_to_user": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1515002250, "post_id": 48082681, "comment_id": 83139794, "body": "Yes, I am aware of the place"}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1515003031, "post_id": 48082681, "comment_id": 83140189, "body": "You know vector CP and want to renormalize it to give it the same length as CA? Btw P is just the midpoint of AB."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1515003138, "post_id": 48082681, "comment_id": 83140244, "body": "This is a math question, not a programming question."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 4, "creation_date": 1515003326, "post_id": 48082681, "comment_id": 83140346, "body": "Seems like the vector <code>CM</code> is just the vector <code>CP</code> with it&#39;s length equal to the arc radius. <code>CM = CP &#47; |CP| * [arch radius]</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 51182, "user_id": 1468366, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2e313135581cf6ceaad355580af931f8?s=128&d=identicon&r=PG", "display_name": "MvG", "link": "https://stackoverflow.com/users/1468366/mvg"}, "is_accepted": false, "score": 0, "last_activity_date": 1515003656, "creation_date": 1515003656, "answer_id": 48083034, "question_id": 48082681, "link": "https://stackoverflow.com/questions/48082681/algorithm-for-determine-the-arc-mid-point/48083034#48083034", "title": "Algorithm for determine the Arc Mid Point", "body": "<blockquote>\n  <p>I would then get two values</p>\n</blockquote>\n\n<p>This is algebraically unavoidable.</p>\n\n<blockquote>\n  <p>and the value closest to point P would be the correct intersection point.</p>\n</blockquote>\n\n<p>Only if the arc covers less than 180\u00b0.</p>\n\n<blockquote>\n  <p>Then I would need to create special cases for when P = C</p>\n</blockquote>\n\n<p>This is indeed the most tricky case. If <em>A,\u2006B,\u2006C</em> lie on a line, you don't know which arc is the arc, and won't be able to answer the question. Unless you have some additional information to start with, e.g. know that the arc goes from <em>A</em> to <em>B</em> in a counter-clockwise direction. In this case, you know the orientation of the triangle <em>ABM</em> and can use that to decide which solition to pick, instead of using the distance.</p>\n\n<blockquote>\n  <p>and for when the line AB is horizontal and vertical</p>\n</blockquote>\n\n<p>Express a line as <em>ax + by + c = 0</em> and you can treat all slopes the same. THese are homogeneous coordinates of the line, you can compute them e.g. using the cross product <em>(a, b, c) = (Ax, Ay, 1) \u00d7 (Bx, By, 1)</em>. But more detailed questions on how best to compute these lines or intersect it with the circle should probably go to the Math Stack Exchange.</p>\n\n<blockquote>\n  <p>if there are any better methods out there that can compute this point that are simpler?</p>\n</blockquote>\n\n<p>Projective geometry and homogeneous coordinates can avoid a lot of nasty corner cases, like circles of infinite radius (also known as lines) or the intersection of parallel lines. But the problem of deciding between two solutions remains, so it probably doesn't make things as simple as you'd like them to be.</p>\n"}, {"comments": [{"owner": {"reputation": 608, "user_id": 3904858, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34b74f56d8756f1278d689152c004200?s=128&d=identicon&r=PG&f=1", "display_name": "philm", "link": "https://stackoverflow.com/users/3904858/philm"}, "edited": false, "score": 0, "creation_date": 1515013522, "post_id": 48084269, "comment_id": 83145087, "body": "So the R here, is that the radius? If so, that is a known parameter"}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "reply_to_user": {"reputation": 608, "user_id": 3904858, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34b74f56d8756f1278d689152c004200?s=128&d=identicon&r=PG&f=1", "display_name": "philm", "link": "https://stackoverflow.com/users/3904858/philm"}, "edited": false, "score": 0, "creation_date": 1515013644, "post_id": 48084269, "comment_id": 83145143, "body": "@philm Yes, R= radius. I added the note for the case you have only points (A, B, Center)"}, {"owner": {"reputation": 608, "user_id": 3904858, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34b74f56d8756f1278d689152c004200?s=128&d=identicon&r=PG&f=1", "display_name": "philm", "link": "https://stackoverflow.com/users/3904858/philm"}, "edited": false, "score": 0, "creation_date": 1515013805, "post_id": 48084269, "comment_id": 83145226, "body": "Cool thanks, So the point S in your description, is sounds like that this is point P in my diagram. If so, then this is another known parameter."}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "reply_to_user": {"reputation": 608, "user_id": 3904858, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34b74f56d8756f1278d689152c004200?s=128&d=identicon&r=PG&f=1", "display_name": "philm", "link": "https://stackoverflow.com/users/3904858/philm"}, "edited": false, "score": 0, "creation_date": 1515014375, "post_id": 48084269, "comment_id": 83145437, "body": "S != P    S is on AB segment and on CM segment. P is on CM, but may be not on AB. My solution works well with S, I don&#39;t know if it will also do with P. Read the line <i>&quot;I prefer...&quot;</i>"}, {"owner": {"reputation": 608, "user_id": 3904858, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34b74f56d8756f1278d689152c004200?s=128&d=identicon&r=PG&f=1", "display_name": "philm", "link": "https://stackoverflow.com/users/3904858/philm"}, "edited": false, "score": 0, "creation_date": 1515015723, "post_id": 48084269, "comment_id": 83145985, "body": "Point P has to be on line segment AB and CM because point P is the intersection point of line segment AB and CM which are perpendicular to each other. Either way, I will attempt both methods (when S = P and S != P) and see if it matters. But I do like this algorithm"}, {"owner": {"reputation": 608, "user_id": 3904858, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34b74f56d8756f1278d689152c004200?s=128&d=identicon&r=PG&f=1", "display_name": "philm", "link": "https://stackoverflow.com/users/3904858/philm"}, "edited": false, "score": 0, "creation_date": 1515022869, "post_id": 48084269, "comment_id": 83148383, "body": "OK, I verified that this algorithm is working! Thank you very much! This made things way simpler! Also, I coded it such that P = S and it works out fine. I also had to create some special cases for when P = C and if the slope of line AB = 0 and INF. Other then that, everything is working like a charm."}], "tags": [], "owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "is_accepted": true, "score": 3, "last_activity_date": 1515009867, "last_edit_date": 1515009867, "creation_date": 1515009346, "answer_id": 48084269, "question_id": 48082681, "link": "https://stackoverflow.com/questions/48082681/algorithm-for-determine-the-arc-mid-point/48084269#48084269", "title": "Algorithm for determine the Arc Mid Point", "body": "<p>A circumference in polar form is expressed by</p>\n\n<pre><code>x = Cx + R cos(alpha)\ny = Cy + R sin(alpha)\n</code></pre>\n\n<p>Where <code>alpha</code> is the angle from center <code>C</code> to point <code>x,y</code>. The goal now is how to get <code>alpha</code> without trigonometry.</p>\n\n<p><p> The arc-midpoint <code>M</code>, the point <code>S</code> in the middle of the segment <code>AB</code>, and your already-calculated point <code>P</code>, all of them have the same <code>alpha</code>, they are on the same line from <code>C</code>.</p>\n\n<p><p>Let's get vector <code>vx,vy</code> as <code>C</code> to <code>S</code>. Also calculate its length:</p>\n\n<pre><code>vx = Sx - Cx = (Ax + Bx)/2 - Cx\nvy = Sy - Cy = (Ay + By)/2 - Cy\nleV = sqrt(vx * vx + vy * vy)\n</code></pre>\n\n<p>I prefer <code>S</code> to <code>P</code> because we can avoid some issues like infinite CP slope or sign to apply to slope (towards M or its inverse).</p>\n\n<p><p>By defintions of <em>sin</em> and <em>cos</em> we know that:</p>\n\n<pre><code>sin(alpha) = vy / leV\ncos(alpha) = vx / leV\n</code></pre>\n\n<p>and finally we get</p>\n\n<pre><code>Mx = Cx + R * vx / leV\nMy = Cy + R * vy / leV\n</code></pre>\n\n<p><strong>Note</strong>: To calculate <code>R</code>you need another <code>sqrt</code> function, which is not quick, but it's faster than sin or cos.\n<br>For better accuracy use the average of <code>Ra= dist(AC)</code> and <code>Rb= dist(BC)</code></p>\n"}], "owner": {"reputation": 608, "user_id": 3904858, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34b74f56d8756f1278d689152c004200?s=128&d=identicon&r=PG&f=1", "display_name": "philm", "link": "https://stackoverflow.com/users/3904858/philm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 964, "favorite_count": 1, "accepted_answer_id": 48084269, "answer_count": 2, "score": 2, "last_activity_date": 1515009867, "creation_date": 1515002150, "question_id": 48082681, "link": "https://stackoverflow.com/questions/48082681/algorithm-for-determine-the-arc-mid-point", "title": "Algorithm for determine the Arc Mid Point", "body": "<p>I am currently looking to implement an algorithm that will be able to compute the arc midpoint. From here on out, I will be referring to the diagram below. What is known are the start and end nodes (A and B respectively), the center (point C) and point P which is the intersection point of the line AB and CM (I am able to find this point without knowing point M because line AB is perpendicular to line CM and thus, the slope is -1/m). I also know the arc angle and the radius of the arc. I am looking to find point M.</p>\n\n<p>I have been looking at different sources. Some suggest converting coordinates to polar, computing the mid point from the polar coordinates then reverting back to Cartesian. This involves sin and cos (and arctan) which I am a little reluctant to do since trig functions take computing time.</p>\n\n<p>I have been looking to directly computing point M by treating the arc as a circle and having Line CP as a line that intersects the circle at Point M. I would then get two values and the value closest to point P would be the correct intersection point. However, this method, the algebra becomes long and complex. Then I would need to create special cases for when P = C and for when the line AB is horizontal and vertical. This method is ok but I am wondering if there are any better methods out there that can compute this point that are simpler?</p>\n\n<p>Also, as a side note, I will be creating this algorithm in C++.</p>\n\n<p><a href=\"https://i.stack.imgur.com/HpLgl.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HpLgl.jpg\" alt=\"Arc Features\"></a></p>\n"}, {"tags": ["c++", "lua"], "comments": [{"owner": {"reputation": 64130, "user_id": 107090, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/RZVHK.png?s=128&g=1", "display_name": "lhf", "link": "https://stackoverflow.com/users/107090/lhf"}, "edited": false, "score": 2, "creation_date": 1515002430, "post_id": 48082405, "comment_id": 83139879, "body": "Why can&#39;t you use <code>lua_setfield</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 7210694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/52f897f743f36ee53b25d088f2be0640?s=128&d=identicon&r=PG&f=1", "display_name": "Settop", "link": "https://stackoverflow.com/users/7210694/settop"}, "edited": false, "score": 0, "creation_date": 1515019179, "post_id": 48082753, "comment_id": 83147312, "body": "Exactly what I was looking for. Thanks for the amazing help!"}], "tags": [], "owner": {"reputation": 64130, "user_id": 107090, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/RZVHK.png?s=128&g=1", "display_name": "lhf", "link": "https://stackoverflow.com/users/107090/lhf"}, "is_accepted": false, "score": 1, "last_activity_date": 1515014320, "last_edit_date": 1515014320, "creation_date": 1515002409, "answer_id": 48082753, "question_id": 48082405, "link": "https://stackoverflow.com/questions/48082405/any-alternative-ways-to-lua-setfield-lua-c-c/48082753#48082753", "title": "Any alternative ways to lua_setfield? (Lua C/C++)", "body": "<p>If <code>i</code> is positive (i.e., absolute), then <code>lua_setfield(L,i,k)</code> is equivalent to</p>\n\n<pre><code>lua_pushstring(L,k);\nlua_insert(L,-2);\nlua_settable(L,i);\n</code></pre>\n\n<p>If <code>i</code> is negative (i.e., relative), then <code>lua_setfield(L,i,k)</code> is equivalent to</p>\n\n<pre><code>lua_pushstring(L,k);\nlua_insert(L,-2);\nlua_settable(L,i-1);\n</code></pre>\n\n<p>The code below combines these two:</p>\n\n<pre><code>lua_pushstring(L,k);\nlua_insert(L,-2);\nlua_settable(L,i-(i&lt;0));\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 7210694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/52f897f743f36ee53b25d088f2be0640?s=128&d=identicon&r=PG&f=1", "display_name": "Settop", "link": "https://stackoverflow.com/users/7210694/settop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515014320, "creation_date": 1515001110, "question_id": 48082405, "link": "https://stackoverflow.com/questions/48082405/any-alternative-ways-to-lua-setfield-lua-c-c", "title": "Any alternative ways to lua_setfield? (Lua C/C++)", "body": "<p>I'm using lua C functions, but I can't use lua_setfield. I need something that can do basically what lua_setfield does. I can use any other lua function except for lua_setfield. Any help?</p>\n"}, {"tags": ["c++", "struct"], "comments": [{"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 6, "creation_date": 1515000806, "post_id": 48082309, "comment_id": 83139057, "body": "Sorry, I don&#39;t understand what you mean."}, {"owner": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "edited": false, "score": 1, "creation_date": 1515000846, "post_id": 48082309, "comment_id": 83139081, "body": "I might have called it a pretty good question if were able to understand what you want to achieve. How about create code with example use case of your idea?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1515000849, "post_id": 48082309, "comment_id": 83139085, "body": "Is this a C or C++ question? In C you&#39;d use an array of arrays. In C++ a <code>std::vector</code> with a <code>std::vector</code> in it."}, {"owner": {"reputation": 51, "user_id": 8936260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f8351e42cd37b63fdde09a34ec14dc?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Gupta", "link": "https://stackoverflow.com/users/8936260/darshan-gupta"}, "edited": false, "score": 0, "creation_date": 1515000879, "post_id": 48082309, "comment_id": 83139098, "body": "I am sure that I want a multidimensional structure"}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1515000917, "post_id": 48082309, "comment_id": 83139122, "body": "But we still don&#39;t know what a &quot;multidimensional structure&quot; is :-("}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1515000920, "post_id": 48082309, "comment_id": 83139125, "body": "@tadman: as the title says C++, I removed that tag."}, {"owner": {"reputation": 51, "user_id": 8936260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f8351e42cd37b63fdde09a34ec14dc?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Gupta", "link": "https://stackoverflow.com/users/8936260/darshan-gupta"}, "edited": false, "score": 0, "creation_date": 1515000924, "post_id": 48082309, "comment_id": 83139128, "body": "This is C++. Or I am fine if this feature available in C"}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1515000924, "post_id": 48082309, "comment_id": 83139129, "body": "That is not a valid C++ syntax. There are multidimensional arrays and containers of containers if you prefer."}, {"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 2, "creation_date": 1515000928, "post_id": 48082309, "comment_id": 83139132, "body": "@DarshanGupta - could you describe the semantics of a &quot;multidimensional structure?&quot; Since no such beast currently exists by the name, maybe if you tell us what it does, we could help you find a solution."}, {"owner": {"reputation": 51, "user_id": 8936260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f8351e42cd37b63fdde09a34ec14dc?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Gupta", "link": "https://stackoverflow.com/users/8936260/darshan-gupta"}, "edited": false, "score": 0, "creation_date": 1515000938, "post_id": 48082309, "comment_id": 83139139, "body": "One minute let me explain."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1515000943, "post_id": 48082309, "comment_id": 83139142, "body": "&quot;I am sure that I want a multidimensional structure &quot; - we don&#39;t understand what you mean by &quot;multidimensional structure&quot;."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 1, "creation_date": 1515000969, "post_id": 48082309, "comment_id": 83139160, "body": "Please have a look at this <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">C++ books</a> list and a very well maintained <a href=\"http://en.cppreference.com/w/\" rel=\"nofollow noreferrer\">C++ reference</a>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1515001001, "post_id": 48082309, "comment_id": 83139182, "body": "If this question is &quot;can I have a structure with a bunch of properties and then make an array of that so there&#39;s two levels to the structure&quot; then the answer is yes."}, {"owner": {"reputation": 51, "user_id": 8936260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f8351e42cd37b63fdde09a34ec14dc?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Gupta", "link": "https://stackoverflow.com/users/8936260/darshan-gupta"}, "edited": false, "score": 0, "creation_date": 1515001090, "post_id": 48082309, "comment_id": 83139238, "body": "Take an example of multidimensional array in which each row has elements of same datatype. Each column holds the data of same type. Now in the case of multidimensional structure I am asking a structure in which each row has elements of different datatype. However, each column will store same type of data"}, {"owner": {"reputation": 51, "user_id": 8936260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f8351e42cd37b63fdde09a34ec14dc?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Gupta", "link": "https://stackoverflow.com/users/8936260/darshan-gupta"}, "edited": false, "score": 0, "creation_date": 1515001138, "post_id": 48082309, "comment_id": 83139265, "body": "Hope this helps"}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 3, "creation_date": 1515001150, "post_id": 48082309, "comment_id": 83139270, "body": "Sounds like an array of struct..."}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1515001474, "post_id": 48082309, "comment_id": 83139419, "body": "<i>&quot;I am asking a structure in which each row has elements of different datatype. However, each column will store same type of data&quot;</i> Well, there are no columns in a class or at least its members aren&#39;t organized in that way. But you can declare multiple variables with the same type: <code>struct arr { int a, c, e; float b, d, f; };</code>"}, {"owner": {"reputation": 384, "user_id": 1852752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ae9674a894c9af62cd1151cda5ff2e?s=128&d=identicon&r=PG&f=1", "display_name": "Segmentation", "link": "https://stackoverflow.com/users/1852752/segmentation"}, "edited": false, "score": 0, "creation_date": 1515001512, "post_id": 48082309, "comment_id": 83139434, "body": "I believe, he wants a 2d array where the first dimension will be an <code>integer</code> and the second a <code>float</code>. Something like a <code>php</code> array where you don&#39;t need to declare the type of the variable, although in <code>cpp</code> you have to."}, {"owner": {"reputation": 51, "user_id": 8936260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f8351e42cd37b63fdde09a34ec14dc?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Gupta", "link": "https://stackoverflow.com/users/8936260/darshan-gupta"}, "reply_to_user": {"reputation": 384, "user_id": 1852752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ae9674a894c9af62cd1151cda5ff2e?s=128&d=identicon&r=PG&f=1", "display_name": "Segmentation", "link": "https://stackoverflow.com/users/1852752/segmentation"}, "edited": false, "score": 0, "creation_date": 1515001773, "post_id": 48082309, "comment_id": 83139547, "body": "I don&#39;t understand much but I believe you are right @Seg"}, {"owner": {"reputation": 51, "user_id": 8936260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f8351e42cd37b63fdde09a34ec14dc?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Gupta", "link": "https://stackoverflow.com/users/8936260/darshan-gupta"}, "edited": false, "score": 0, "creation_date": 1515001804, "post_id": 48082309, "comment_id": 83139564, "body": "I have pasted a link in my question open that image and it might help you guys"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1515001895, "post_id": 48082309, "comment_id": 83139601, "body": "You can make a struct that holds an array of ints and holds an array of chars."}, {"owner": {"reputation": 384, "user_id": 1852752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ae9674a894c9af62cd1151cda5ff2e?s=128&d=identicon&r=PG&f=1", "display_name": "Segmentation", "link": "https://stackoverflow.com/users/1852752/segmentation"}, "edited": false, "score": 0, "creation_date": 1515001960, "post_id": 48082309, "comment_id": 83139629, "body": "@DarshanGupta you want a two dimensional array that the first column will have variables of type <code>int</code> and the second of type <code>float</code>. For example: <code>array[0][0]</code> would have an <code>int</code> and <code>array[0][1]</code> would have a <code>float</code>. Am i right?"}, {"owner": {"reputation": 51, "user_id": 8936260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f8351e42cd37b63fdde09a34ec14dc?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Gupta", "link": "https://stackoverflow.com/users/8936260/darshan-gupta"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1515002075, "post_id": 48082309, "comment_id": 83139695, "body": "Yup but you should not store things like: houseno, roll number of the student, etc. informations together as they look odd, so here you must declare two-three variables @christian"}, {"owner": {"reputation": 51, "user_id": 8936260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f8351e42cd37b63fdde09a34ec14dc?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Gupta", "link": "https://stackoverflow.com/users/8936260/darshan-gupta"}, "reply_to_user": {"reputation": 384, "user_id": 1852752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ae9674a894c9af62cd1151cda5ff2e?s=128&d=identicon&r=PG&f=1", "display_name": "Segmentation", "link": "https://stackoverflow.com/users/1852752/segmentation"}, "edited": false, "score": 0, "creation_date": 1515002127, "post_id": 48082309, "comment_id": 83139721, "body": "@Segmentation yes but in the form of two dimensional structure"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1515002272, "post_id": 48082309, "comment_id": 83139804, "body": "Use an array of union instead of struct, and be very disciplined when using this thingy. ;-)"}, {"owner": {"reputation": 51, "user_id": 8936260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f8351e42cd37b63fdde09a34ec14dc?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Gupta", "link": "https://stackoverflow.com/users/8936260/darshan-gupta"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1515002355, "post_id": 48082309, "comment_id": 83139844, "body": "@alk union shares memory which I don&#39;t want."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1515002466, "post_id": 48082309, "comment_id": 83139891, "body": "I do not understand what you mean by it looking odd to group information together."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 1, "creation_date": 1515002537, "post_id": 48082309, "comment_id": 83139919, "body": "You should take a look at C++17 <code>std::variant</code>. It allows you have an array that the data type varies."}, {"owner": {"reputation": 51, "user_id": 8936260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f8351e42cd37b63fdde09a34ec14dc?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Gupta", "link": "https://stackoverflow.com/users/8936260/darshan-gupta"}, "edited": false, "score": 0, "creation_date": 1515002591, "post_id": 48082309, "comment_id": 83139951, "body": "What would you name an array which stores info like houseno, barcode_no, employee number?"}, {"owner": {"reputation": 51, "user_id": 8936260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f8351e42cd37b63fdde09a34ec14dc?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Gupta", "link": "https://stackoverflow.com/users/8936260/darshan-gupta"}, "edited": false, "score": 0, "creation_date": 1515002664, "post_id": 48082309, "comment_id": 83139997, "body": "Sorry guys I am running out of battery right now and my charger sucks, further it is night here so bye see you soon"}, {"owner": {"reputation": 384, "user_id": 1852752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ae9674a894c9af62cd1151cda5ff2e?s=128&d=identicon&r=PG&f=1", "display_name": "Segmentation", "link": "https://stackoverflow.com/users/1852752/segmentation"}, "edited": false, "score": 0, "creation_date": 1515002738, "post_id": 48082309, "comment_id": 83140038, "body": "@DarshanGupta I would call it structure."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1515002989, "post_id": 48082309, "comment_id": 83140171, "body": "This definitely feels like an XY problem.  The best I can guess is that what you really need is an array of structs, but unless you can give us more information about what it is you are actually trying to accomplish, the all we can do is guess at what you are trying to do."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8936260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f8351e42cd37b63fdde09a34ec14dc?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Gupta", "link": "https://stackoverflow.com/users/8936260/darshan-gupta"}, "edited": false, "score": 0, "creation_date": 1515001279, "post_id": 48082413, "comment_id": 83139327, "body": "Unfortunately, not sorry @Rob I know this thing"}, {"owner": {"reputation": 51, "user_id": 8936260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f8351e42cd37b63fdde09a34ec14dc?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Gupta", "link": "https://stackoverflow.com/users/8936260/darshan-gupta"}, "edited": false, "score": 0, "creation_date": 1515001307, "post_id": 48082413, "comment_id": 83139339, "body": "Wait guys I am making a word document which might help you"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1515016447, "post_id": 48082413, "comment_id": 83146284, "body": "Robs solution does exactly what you want."}, {"owner": {"reputation": 51, "user_id": 8936260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f8351e42cd37b63fdde09a34ec14dc?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Gupta", "link": "https://stackoverflow.com/users/8936260/darshan-gupta"}, "edited": false, "score": 0, "creation_date": 1515032747, "post_id": 48082413, "comment_id": 83150566, "body": "@Rob the program you gave is similar to what I want. Just print 0 (as an int) twice, once from each of the first two &quot;columns&quot;."}, {"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "reply_to_user": {"reputation": 51, "user_id": 8936260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f8351e42cd37b63fdde09a34ec14dc?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Gupta", "link": "https://stackoverflow.com/users/8936260/darshan-gupta"}, "edited": false, "score": 0, "creation_date": 1515085169, "post_id": 48082413, "comment_id": 83175186, "body": "@DarshanGupta - I&#39;ve updated my answer. Does this describe what you are looking for?"}], "tags": [], "owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "is_accepted": false, "score": 4, "last_activity_date": 1515085153, "last_edit_date": 1515085153, "creation_date": 1515001151, "answer_id": 48082413, "question_id": 48082309, "link": "https://stackoverflow.com/questions/48082309/is-multidimensional-structure-possible-in-c/48082413#48082413", "title": "Is multidimensional structure possible in C++?", "body": "<p>An array of structs seems to satisfy your request. The </p>\n\n<pre><code>#include &lt;iostream&gt;\nstatic struct { int a; float b; } arr[2] = {1, 1.5, 2, 2.5};\n\nint main () {\n    // Print the value of the first column \n    std::cout &lt;&lt; \"Column 'a': \" &lt;&lt;\n        arr[0].a &lt;&lt; \" \" &lt;&lt;\n        arr[1].a &lt;&lt; \"\\n\";\n\n    // Print the value of the first row\n    std::cout &lt;&lt; \"Row '0': \" &lt;&lt;\n        arr[0].a &lt;&lt; \" \" &lt;&lt;\n        arr[0].b &lt;&lt; \"\\n\";\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8936260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f8351e42cd37b63fdde09a34ec14dc?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Gupta", "link": "https://stackoverflow.com/users/8936260/darshan-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "closed_date": 1515001045, "answer_count": 1, "score": -6, "last_activity_date": 1515085153, "creation_date": 1515000680, "last_edit_date": 1515007910, "question_id": 48082309, "link": "https://stackoverflow.com/questions/48082309/is-multidimensional-structure-possible-in-c", "closed_reason": "Needs details or clarity", "title": "Is multidimensional structure possible in C++?", "body": "<p>Remember I am talking about multidimensional STRUCTURES and not multidimensional arrays, STRUCTURE VARIABLES, etc.\nIf yes, then what is the syntax?\nThe example will help you clear things out:</p>\n\n<pre><code>struct arr[3]{\n    int a, float b,\n    int c, float d,\n    int e, float f;\n}\n</code></pre>\n\n<p>I just used the syntax that are used for multidimensional arrays with some additional work (like semicolon after the last variable) which is not used as a syntax for multidimensional arrays. AND\nDon't think this as an actual syntax, here I am just trying to let you understand my question.\nA multidimensional structure which has two types of data in one row separated by columns. A one which can have different type of data in each rows.</p>\n\n<p><a href=\"https://i.stack.imgur.com/mWjIT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mWjIT.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "animation", "directx", "textures", "sprite-sheet"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1515001045, "post_id": 48082245, "comment_id": 83139215, "body": "There is something wrong with your code that creates and assigns textures, not with <code>GetDesc</code>."}, {"owner": {"reputation": 21, "user_id": 9159137, "user_type": "registered", "profile_image": "https://graph.facebook.com/1988874811400832/picture?type=large", "display_name": "Javier Dieguez", "link": "https://stackoverflow.com/users/9159137/javier-dieguez"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1515280727, "post_id": 48082245, "comment_id": 83242849, "body": "@VTT I&#39;ve been looking over this for a few days and still haven&#39;t found a clean way to fix it. In the edit i add the code that creates the texture"}], "owner": {"reputation": 21, "user_id": 9159137, "user_type": "registered", "profile_image": "https://graph.facebook.com/1988874811400832/picture?type=large", "display_name": "Javier Dieguez", "link": "https://stackoverflow.com/users/9159137/javier-dieguez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 317, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1515280888, "creation_date": 1515000469, "last_edit_date": 1515280888, "question_id": 48082245, "link": "https://stackoverflow.com/questions/48082245/directx-getting-texture-size-wrong", "title": "DirectX getting texture size wrong", "body": "<p>I am getting started with DirectX and struggling to render 2 animated sprites at once. I turn the spritesheets into textures and then set the frameCount for them using its aspect ratio as a guide</p>\n\n<pre><code>    D3D11_TEXTURE2D_DESC desc;\n    texture2D-&gt;GetDesc(&amp;desc);\n\n    m_width = desc.Width;\n    m_height = desc.Height;\n</code></pre>\n\n<p>These are the 2 spritesheets, as you can see, one of them has 4 frames and aspect ratio of 4:1 whereas the other one has 3 and respective aspect ratio <img src=\"https://i.stack.imgur.com/YfXH7.png\" alt=\"image\"></p>\n\n<p>Now it seems like when I assign the texture to my sprite class, my Manager assigns the correct texture (or <code>ID3D11ShaderResourceView</code>), but it gives the size values from the other one, which results in them animating the wrong way (the first one animates in 4 steps whereas the second one animates in three).</p>\n\n<p>This code gets the texture</p>\n\n<pre><code>Texture* ResourceManager::GetTextureByName(char* textureName)\n{\n    for(int i = 0; i &lt; (int)m_textures.size(); ++i)\n    {\n        ResourceTexture* resourceTexture = m_textures[i];\n        string resourceTextureName = resourceTexture-&gt;GetName();\n\n        //Bit that matters\n        if(!strcmp(textureName, resourceTextureName.c_str()))\n        {\n            return resourceTexture-&gt;GetTexture();\n        }\n    }\n\n    return NULL;\n}\n</code></pre>\n\n<p>Is <code>texture2D-&gt;GetDesc</code> not working like I intend it to? Any directions are greatly appreciated!</p>\n\n<p>Edit:</p>\n\n<p>This is how i set up the textures (right before getting their width and height)</p>\n\n<pre><code>//Just modifying the texture name to the right format\nwstring tempName(fileName);\nm_name = string(tempName.begin(), tempName.end());\n//Modifying texture name (From original loaded textures names)\nint pos = m_name.find_last_of(\"/\");\nif(pos &gt;= 0)\n{\n    m_name = m_name.substr(pos + 1, m_name.length());\n}\nm_name = m_name.substr(0, m_name.find_last_of(\".\"));\n\n//load the texture\nresult = CreateWICTextureFromFile(device, fileName, NULL, &amp;m_texture, NULL);\n</code></pre>\n"}, {"tags": ["c++", "yaml", "yaml-cpp"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515000319, "post_id": 48082178, "comment_id": 83138786, "body": "<code>strlen</code> will stop at the first null terminator. Do you have any of those? See related <a href=\"https://stackoverflow.com/questions/28028448/strlen-gives-larger-number-than-the-size-of-an-array\" title=\"strlen gives larger number than the size of an array\">stackoverflow.com/questions/28028448/&hellip;</a>"}, {"owner": {"reputation": 1482, "user_id": 558738, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/713ec8ea4b19bde109cec4be38ff8249?s=128&d=identicon&r=PG", "display_name": "Periodic Maintenance", "link": "https://stackoverflow.com/users/558738/periodic-maintenance"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515000562, "post_id": 48082178, "comment_id": 83138927, "body": "@Marc No null terminators - I get the full expected yaml as string with em.c_str(). But em.size() returns a bigger size (by 3-8 characters) causing extra characters to be copied."}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515001581, "post_id": 48082178, "comment_id": 83139474, "body": "You should probably include a full example that fails, including data being emitted."}, {"owner": {"reputation": 29797, "user_id": 112, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8cff214f16c7c8e73244a8ed8dea7e0e?s=128&d=identicon&r=PG", "display_name": "Jesse Beder", "link": "https://stackoverflow.com/users/112/jesse-beder"}, "edited": false, "score": 0, "creation_date": 1515042495, "post_id": 48082178, "comment_id": 83152496, "body": "This might be a bug in yaml-cpp. Could you file an issue on the github page with a complete example?"}, {"owner": {"reputation": 1482, "user_id": 558738, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/713ec8ea4b19bde109cec4be38ff8249?s=128&d=identicon&r=PG", "display_name": "Periodic Maintenance", "link": "https://stackoverflow.com/users/558738/periodic-maintenance"}, "edited": false, "score": 0, "creation_date": 1515054410, "post_id": 48082178, "comment_id": 83156909, "body": "I noticed that this issue happens when the yaml is relatively large (&gt; 4kbytes). For small buffers, size() matches strlen() exactly. I will try to come up with a reproducible example."}], "owner": {"reputation": 1482, "user_id": 558738, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/713ec8ea4b19bde109cec4be38ff8249?s=128&d=identicon&r=PG", "display_name": "Periodic Maintenance", "link": "https://stackoverflow.com/users/558738/periodic-maintenance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515000161, "creation_date": 1515000161, "question_id": 48082178, "link": "https://stackoverflow.com/questions/48082178/yamlemitter-size-different-from-strlenyamlemitter-c-str", "title": "YAML::Emitter.size() different from strlen(YAML::Emitter.c_str())", "body": "<p>Using YAML::Emitter I sometimes get YAML::Emitter.size() to return a bigger size than strlen(YAML::Emitter.c_str()).\ne.g.</p>\n\n<pre><code>YAML::Emitter em;\nem &lt;&lt; something;\nif (em.size() &gt; strlen(em.c_str())\n{\n    std::cout &lt;&lt; \"WOW \" &lt;&lt; em.size() &lt;&lt; \" &gt; \" &lt;&lt; strlen(em.c_str());\n}\n</code></pre>\n\n<p>This creates issues when writing the yaml text to a buffer:</p>\n\n<pre><code>char* buff = malloc(em.size());\nmemcpy(buff, em.c_str(), em.size());\n</code></pre>\n\n<p>because the extra characters at the end fail the yaml parser on the other side that reads this buffer.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "uppercase"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 4, "creation_date": 1514999880, "post_id": 48082092, "comment_id": 83138531, "body": "It is only checking the first letter"}, {"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 4, "creation_date": 1514999881, "post_id": 48082092, "comment_id": 83138532, "body": "<code>return std::all_of(begin(word), end(word), [](char c){ return isupper(c); });</code>"}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1514999946, "post_id": 48082092, "comment_id": 83138570, "body": "what if string is empty, what will the function return?"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 1, "creation_date": 1514999971, "post_id": 48082092, "comment_id": 83138585, "body": "@CoryKramer Missing cast to unsigned char. <a href=\"https://stackoverflow.com/q/21805674/3002139\">stackoverflow.com/q/21805674/3002139</a> Alternatively, make the lambda&#39;s argument explicitly unsigned."}, {"owner": {"reputation": 21, "user_id": 9169235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e2123b060e7a7d9d8d9b039433aa5f?s=128&d=identicon&r=PG&f=1", "display_name": "beastlycplus", "link": "https://stackoverflow.com/users/9169235/beastlycplus"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1514999976, "post_id": 48082092, "comment_id": 83138588, "body": "@EdHeal well, isn&#39;t it checking every word since I have a for loop that goes through each character?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1515000020, "post_id": 48082092, "comment_id": 83138614, "body": "@beastlycplus -- Your function fails to return anything if the string is empty.  Thus it is faulty and will invoke undefined behavior if the string is empty."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 2, "creation_date": 1515000023, "post_id": 48082092, "comment_id": 83138615, "body": "@beastlycplus Stepping through this code with a debugger would immediately tell you what&#39;s wrong."}, {"owner": {"reputation": 21, "user_id": 9169235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e2123b060e7a7d9d8d9b039433aa5f?s=128&d=identicon&r=PG&f=1", "display_name": "beastlycplus", "link": "https://stackoverflow.com/users/9169235/beastlycplus"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1515000076, "post_id": 48082092, "comment_id": 83138651, "body": "@CoryKramer I can&#39;t use all_of , i get an error saying <code>all of is not a member of std</code> i dont think i have the correct c++ version."}, {"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1515000105, "post_id": 48082092, "comment_id": 83138668, "body": "@beastlycplus It requires at least C++11 and to <code>#include &lt;algorithm&gt;</code>"}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1515000119, "post_id": 48082092, "comment_id": 83138677, "body": "@beastlycplus you need to <code>#include &lt;algorithm&gt;</code> for that"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1515000128, "post_id": 48082092, "comment_id": 83138680, "body": "@beastlycplus &quot;<i>well, isn&#39;t it checking every word since I have a for loop that goes through each character?</i>&quot; No, since it returns, unconditionally (both <code>if</code> branches have <code>return</code> statement), after the first check."}, {"owner": {"reputation": 21, "user_id": 9169235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e2123b060e7a7d9d8d9b039433aa5f?s=128&d=identicon&r=PG&f=1", "display_name": "beastlycplus", "link": "https://stackoverflow.com/users/9169235/beastlycplus"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1515000144, "post_id": 48082092, "comment_id": 83138691, "body": "@PaulMcKenzie i believe it doesn&#39;t need to return anything if the string is empty, as long as it is not empty it should continue the check"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 4, "creation_date": 1515000187, "post_id": 48082092, "comment_id": 83138721, "body": "@beastlycplus -- C++ does not work this way.  If your function returns <code>bool</code>, you <b>must</b> return something, regardless.  Otherwise it is undefined behavior."}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 1, "creation_date": 1515000201, "post_id": 48082092, "comment_id": 83138732, "body": "<i>&quot;I also tried using the all_of method</i>&quot; - Why don&#39;t you show us what you&#39;ve tried? <i>&quot;but I think I dont have the correct compiler version&quot;</i> - You could put that in a separate question if you cannot find out whether your compiler is new enough."}], "answers": [{"comments": [{"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1515000378, "post_id": 48082162, "comment_id": 83138815, "body": "Why not <code>static_cast</code>?"}, {"owner": {"reputation": 44162, "user_id": 752843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dfab97c10311207545414b6d7d9bde93?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/752843/richard"}, "reply_to_user": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1515000517, "post_id": 48082162, "comment_id": 83138899, "body": "@ChristianHackl: Fixed."}, {"owner": {"reputation": 44162, "user_id": 752843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dfab97c10311207545414b6d7d9bde93?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/752843/richard"}, "edited": false, "score": 0, "creation_date": 1515000593, "post_id": 48082162, "comment_id": 83138943, "body": "So there were a lot of problems with OP&#39;s code. Thanks all for helping get them ironed out."}, {"owner": {"reputation": 21, "user_id": 9169235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e2123b060e7a7d9d8d9b039433aa5f?s=128&d=identicon&r=PG&f=1", "display_name": "beastlycplus", "link": "https://stackoverflow.com/users/9169235/beastlycplus"}, "edited": false, "score": 0, "creation_date": 1515000905, "post_id": 48082162, "comment_id": 83139112, "body": "Thank you @Richard i mentioned in one of the comments that it should only return true IF the string contains ATLEAST one uppercase letter but no lowercase letter. So if the word is empty, return false."}], "tags": [], "owner": {"reputation": 44162, "user_id": 752843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dfab97c10311207545414b6d7d9bde93?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/752843/richard"}, "is_accepted": true, "score": 0, "last_activity_date": 1515001039, "last_edit_date": 1515001039, "creation_date": 1515000116, "answer_id": 48082162, "question_id": 48082092, "link": "https://stackoverflow.com/questions/48082092/c-check-if-whole-string-is-uppercase/48082162#48082162", "title": "C++ Check if whole string is uppercase", "body": "<p>You shouldn't have two return conditions inside your loop. Rather, you can use the loop to find problems and, if there are no problems, you'll escape the loop and can tell the user that everything was alright at the end.</p>\n\n<p>In the comments you say \"i believe it doesn't need to return anything if the string is empty\"; however, a function with a return type, such as this one <em>always</em> returns something. If you don't specify a return value it will give you one, whether you like it or not. Therefore, you must decide what the output should be for every conceivable input. Accordingly, I've added an if statement that emphasizes the special condition of an empty string.</p>\n\n<pre><code>#include \"UpperCaseFilter.h\"\n#include \"ReadFilteredWords.h\"\n#include \"ReadWords.h\"\n#include &lt;locale&gt;\n\nbool UpperCaseFilter::filter(const string &amp;word) {\n  if(word.empty()) //You'll need to do the right thing here\n    return true;\n\n  //Even if the right thing to do were to return true, so that\n  //the check above would be redundant, you'd want to leave a\n  //comment here pointing out that you've handled the special case\n\n  for(size_t i = 0; i &lt; word.length(); i++)\n    if(!isupper(static_cast&lt;unsigned char&gt;(word[i])))\n      return false;\n\n  return true;\n}\n</code></pre>\n\n<p>Note that your previous function signature was:</p>\n\n<pre><code>bool UpperCaseFilter::filter(string word) {\n</code></pre>\n\n<p>I've changed this to:</p>\n\n<pre><code>bool UpperCaseFilter::filter(const string &amp;word) {\n</code></pre>\n\n<p>The <code>const</code> guarantees that the function will not alter <code>word</code> and the <code>&amp;</code> symbol passes the string to the function without copying it. This makes the function faster and saves memory.</p>\n"}, {"comments": [{"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 1, "creation_date": 1515000346, "post_id": 48082179, "comment_id": 83138797, "body": "That&#39;s the C++ solution to the problem. Extra points for working around the terribly broken <code>isupper</code> interface."}, {"owner": {"reputation": 724, "user_id": 1139559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7591c3ce29ddc08c68ee882c9c8dcbd3?s=128&d=identicon&r=PG", "display_name": "fchen", "link": "https://stackoverflow.com/users/1139559/fchen"}, "edited": false, "score": 0, "creation_date": 1609370844, "post_id": 48082179, "comment_id": 115828160, "body": "C++ way (C++ is ugly without boost but including boost sometimes is annoying for lightweight code).  One comment: use !std::islower(c) if one wants to allow non-letters."}], "tags": [], "owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "is_accepted": false, "score": 8, "last_activity_date": 1515000481, "last_edit_date": 1515000481, "creation_date": 1515000161, "answer_id": 48082179, "question_id": 48082092, "link": "https://stackoverflow.com/questions/48082092/c-check-if-whole-string-is-uppercase/48082179#48082179", "title": "C++ Check if whole string is uppercase", "body": "<p>Alternatively utilize the <a href=\"http://en.cppreference.com/w/cpp/algorithm/all_any_none_of\" rel=\"noreferrer\">std::all_of</a> function in combination with <a href=\"http://en.cppreference.com/w/cpp/string/byte/isupper\" rel=\"noreferrer\">std::isupper</a> in predicate:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;algorithm&gt;\n\nint main() {\n    std::string s = \"HELLo\";\n    if (std::all_of(s.begin(), s.end(), [](unsigned char c){ return std::isupper(c); })) {\n        std::cout &lt;&lt; \"Is uppercase.\" &lt;&lt; '\\n';\n    } else {\n        std::cout &lt;&lt; \"Is not uppercase.\" &lt;&lt; '\\n';\n    }\n}\n</code></pre>\n\n<p>Used as part of a function:</p>\n\n<pre><code>bool isUpper(const std::string&amp; s) {\n    return std::all_of(s.begin(), s.end(), [](unsigned char c){ return std::isupper(c); });\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1515000237, "post_id": 48082193, "comment_id": 83138751, "body": "Possibly undefined behaviour because there&#39;s no cast to <code>unsigned char</code>."}, {"owner": {"reputation": 21, "user_id": 9169235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e2123b060e7a7d9d8d9b039433aa5f?s=128&d=identicon&r=PG&f=1", "display_name": "beastlycplus", "link": "https://stackoverflow.com/users/9169235/beastlycplus"}, "edited": false, "score": 0, "creation_date": 1515000507, "post_id": 48082193, "comment_id": 83138896, "body": "Hmm, I think if the string is empty it shouldn&#39;t be regarded as upper case. I think it should just skip it then"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 21, "user_id": 9169235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e2123b060e7a7d9d8d9b039433aa5f?s=128&d=identicon&r=PG&f=1", "display_name": "beastlycplus", "link": "https://stackoverflow.com/users/9169235/beastlycplus"}, "edited": false, "score": 0, "creation_date": 1515000569, "post_id": 48082193, "comment_id": 83138930, "body": "@beastlycplus If the string is empty, it is logically all uppercase because it does not contain a character that is not uppercase."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 21, "user_id": 9169235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e2123b060e7a7d9d8d9b039433aa5f?s=128&d=identicon&r=PG&f=1", "display_name": "beastlycplus", "link": "https://stackoverflow.com/users/9169235/beastlycplus"}, "edited": false, "score": 0, "creation_date": 1515000594, "post_id": 48082193, "comment_id": 83138944, "body": "@beastlycplus Also, what do you even mean with &quot;skip&quot; in this context?"}, {"owner": {"reputation": 21, "user_id": 9169235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e2123b060e7a7d9d8d9b039433aa5f?s=128&d=identicon&r=PG&f=1", "display_name": "beastlycplus", "link": "https://stackoverflow.com/users/9169235/beastlycplus"}, "edited": false, "score": 0, "creation_date": 1515000829, "post_id": 48082193, "comment_id": 83139073, "body": "Sorry, I should mention that it should only return true IF the string contains ATLEAST one uppercase letter but no lowercase letter."}, {"owner": {"reputation": 18808, "user_id": 924727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd2dcbbfd05a7c49cd74c7cb93e26488?s=128&d=identicon&r=PG", "display_name": "Emilio Garavaglia", "link": "https://stackoverflow.com/users/924727/emilio-garavaglia"}, "reply_to_user": {"reputation": 21, "user_id": 9169235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e2123b060e7a7d9d8d9b039433aa5f?s=128&d=identicon&r=PG&f=1", "display_name": "beastlycplus", "link": "https://stackoverflow.com/users/9169235/beastlycplus"}, "edited": false, "score": 0, "creation_date": 1515000934, "post_id": 48082193, "comment_id": 83139137, "body": "@beastlycplus: if the string is empty, the for loop does not enter... hence <code>true</code> is returned."}, {"owner": {"reputation": 18808, "user_id": 924727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd2dcbbfd05a7c49cd74c7cb93e26488?s=128&d=identicon&r=PG", "display_name": "Emilio Garavaglia", "link": "https://stackoverflow.com/users/924727/emilio-garavaglia"}, "reply_to_user": {"reputation": 21, "user_id": 9169235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e2123b060e7a7d9d8d9b039433aa5f?s=128&d=identicon&r=PG&f=1", "display_name": "beastlycplus", "link": "https://stackoverflow.com/users/9169235/beastlycplus"}, "edited": false, "score": 0, "creation_date": 1515001129, "post_id": 48082193, "comment_id": 83139259, "body": "@beastlycplus: Ok, just replace the last line with <code>return !word.empty();</code>"}], "tags": [], "owner": {"reputation": 18808, "user_id": 924727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd2dcbbfd05a7c49cd74c7cb93e26488?s=128&d=identicon&r=PG", "display_name": "Emilio Garavaglia", "link": "https://stackoverflow.com/users/924727/emilio-garavaglia"}, "is_accepted": false, "score": 5, "last_activity_date": 1515000394, "last_edit_date": 1515000394, "creation_date": 1515000207, "answer_id": 48082193, "question_id": 48082092, "link": "https://stackoverflow.com/questions/48082092/c-check-if-whole-string-is-uppercase/48082193#48082193", "title": "C++ Check if whole string is uppercase", "body": "<pre><code>bool is_all_upper(const std::string&amp; word)\n{\n    for(auto&amp; c: word) \n        if(!std::isupper(static_cast&lt;unsigned char&gt;(c))) \n            return false;\n    return true;\n}\n</code></pre>\n\n<p>I assume that, if the string is empty, it can be considered all-uppercase.</p>\n"}, {"comments": [{"owner": {"reputation": 4539, "user_id": 3276721, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/1f4Z5.png?s=128&g=1", "display_name": "Miguel Lattuada", "link": "https://stackoverflow.com/users/3276721/miguel-lattuada"}, "edited": false, "score": 0, "creation_date": 1515001982, "post_id": 48082443, "comment_id": 83139647, "body": "Consider adding comments :)"}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 1, "creation_date": 1515003679, "post_id": 48082443, "comment_id": 83140529, "body": "Unprovoked <code>using namespace std</code>, no <code>#include &lt;string&gt;</code> (= compilation fail with MSVC), reading a string without <code>std::getline</code>, an extra state variable (with a totally generic name) that makes the code harder to read and reason about, <code>flag == false</code> instead of <code>!flag</code>, no cast to <code>unsigned char</code> for <code>isupper</code>, C-ish loop condition, pre-C++11 UB for the first <code>str[i]</code>... but I think the worst thing is that it makes C++ as a language look bad because it completely ignores the existence of standard functions like <code>std::all_of</code> and lambdas, which would encapsulate all logic in a one-liner."}], "tags": [], "owner": {"reputation": 23, "user_id": 9068554, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aT5lxMiosgE/AAAAAAAAAAI/AAAAAAAAFrM/aZjzOJBGf40/photo.jpg?sz=128", "display_name": "Rohit Maharashi", "link": "https://stackoverflow.com/users/9068554/rohit-maharashi"}, "is_accepted": false, "score": -2, "last_activity_date": 1515001265, "creation_date": 1515001265, "answer_id": 48082443, "question_id": 48082092, "link": "https://stackoverflow.com/questions/48082092/c-check-if-whole-string-is-uppercase/48082443#48082443", "title": "C++ Check if whole string is uppercase", "body": "<pre><code>#include&lt;iostream&gt;\n#include&lt;cstring&gt;\nusing namespace std;\nint main()\n{\n    string str;\n    cin &gt;&gt; str;\n    bool flag = false;\n    int i = 0;\n    while(str[i])\n    {\n        if(isupper(str[i]))\n        { \n            flag = true;\n        }\n        if(!(isupper(str[i])))\n        {\n            flag = false;\n            break;\n        }\n        i++;\n    }\n    if(flag == false)\n        cout &lt;&lt; \"false\"  &lt;&lt; endl;\n    else\n        cout &lt;&lt; \"true\" &lt;&lt; endl;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 386, "user_id": 8943284, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YQPde.jpg?s=128&g=1", "display_name": "sayantan ghosh", "link": "https://stackoverflow.com/users/8943284/sayantan-ghosh"}, "is_accepted": false, "score": -1, "last_activity_date": 1515328785, "creation_date": 1515328785, "answer_id": 48137175, "question_id": 48082092, "link": "https://stackoverflow.com/questions/48082092/c-check-if-whole-string-is-uppercase/48137175#48137175", "title": "C++ Check if whole string is uppercase", "body": "<pre><code>#include \"UpperCaseFilter.h\"\n#include \"ReadFilteredWords.h\"\n#include \"ReadWords.h\"\n#include &lt;locale&gt;\n\nbool UpperCaseFilter::filter(string word) \n\n {\n    int k=0;\n    if(!word.empty()) \n     {\n        for(int i = 0; i &lt; word.length(); i++) \n          {\n            if(isupper(word[i]))\n                k++;\n\n           }\n       }\n\n   if(k==word.length())\n      return true;\n\n   else\n      return false; //this will return false even when word length is 0\n\n}\n\n\nits more simple now provided if you have done other things right this would run.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12935502, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5d2d8ab970137304af5546083a60b488?s=128&d=identicon&r=PG", "display_name": "HONGCHUN LI", "link": "https://stackoverflow.com/users/12935502/hongchun-li"}, "is_accepted": false, "score": -1, "last_activity_date": 1582240311, "creation_date": 1582240311, "answer_id": 60329917, "question_id": 48082092, "link": "https://stackoverflow.com/questions/48082092/c-check-if-whole-string-is-uppercase/60329917#60329917", "title": "C++ Check if whole string is uppercase", "body": "<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;boost/algorithm/string.hpp&gt;\nbool IsAllUpperString(string str)\n{\n    if(boost::to_upper_copy(str)== str) return true;\n    return false;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9169235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e2123b060e7a7d9d8d9b039433aa5f?s=128&d=identicon&r=PG&f=1", "display_name": "beastlycplus", "link": "https://stackoverflow.com/users/9169235/beastlycplus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7329, "favorite_count": 0, "accepted_answer_id": 48082162, "answer_count": 6, "score": 0, "last_activity_date": 1582240311, "creation_date": 1514999806, "question_id": 48082092, "link": "https://stackoverflow.com/questions/48082092/c-check-if-whole-string-is-uppercase", "title": "C++ Check if whole string is uppercase", "body": "<p>I am trying to check if the whole word is upper case, if this is true it should return true, else return false.</p>\n\n<p>My current code is:</p>\n\n<pre><code>#include \"UpperCaseFilter.h\"\n#include \"ReadFilteredWords.h\"\n#include \"ReadWords.h\"\n#include &lt;locale&gt;\n\nbool UpperCaseFilter::filter(string word) {\n    if(!word.empty()) {\n        for(int i = 0; i &lt; word.length(); i++) {\n            if(isupper(word[i])) {\n                return true;\n\n            }\n            else {\n                return false;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>The problem with this code is, if i have for example <code>HeLLO</code>, it will return true because my last character is true. How would I only return true if the whole string is true. I did it using a counter method but it is not the most efficient.</p>\n\n<p>I also tried using the <code>all_of</code> method but I think I dont have the correct compiler version because it says <code>all_of isn't defined</code> (Even with correct imports).</p>\n\n<p>I'm not sure what other approaches there are to this.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 146, "user_id": 871071, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sVi3k.png?s=128&g=1", "display_name": "The Unknown", "link": "https://stackoverflow.com/users/871071/the-unknown"}, "edited": false, "score": 1, "creation_date": 1515000433, "post_id": 48082091, "comment_id": 83138847, "body": "for example, tolower the text case <code>std::transform(text.begin(), text.end(), text.begin(), ::tolower);</code>, then compare."}, {"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "edited": false, "score": 1, "creation_date": 1515000531, "post_id": 48082091, "comment_id": 83138911, "body": "no need to transform, pass lambda and tolower that way."}], "answers": [{"tags": [], "owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "is_accepted": true, "score": 1, "last_activity_date": 1515005137, "creation_date": 1515005137, "answer_id": 48083366, "question_id": 48082091, "link": "https://stackoverflow.com/questions/48082091/stdfind-case-insensitive-checking/48083366#48083366", "title": "std::find case insensitive checking", "body": "<p>You could probably do with <code>std::equal</code> and <code>std::tolower</code> to check both <code>wstring</code>s</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;algorithm&gt;\n#include &lt;cwctype&gt;\n#include &lt;locale&gt;\n\nint main()\n{\n    std::wstring wstr1 = L\"dll\", wstr2 = L\"DLL\";\n\n    auto icompare = [](wchar_t const &amp;c1, wchar_t const &amp;c2)\n    { \n        return std::tolower(c1, std::locale()) == std::tolower(c2, std::locale());\n    };\n\n    if (std::equal(wstr1.begin(), wstr1.end(), wstr2.begin(), wstr2.end(), icompare))\n        std::cout &lt;&lt; \"equal\" &lt;&lt; std::endl;\n    else\n        std::cout &lt;&lt; \"notEqual\" &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>For example: <a href=\"https://ideone.com/I3zukI\" rel=\"nofollow noreferrer\">https://ideone.com/I3zukI</a></p>\n"}], "owner": {"reputation": 199, "user_id": 7936610, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5cc3a5257b19038cb58effb85443ed69?s=128&d=identicon&r=PG&f=1", "display_name": "778899", "link": "https://stackoverflow.com/users/7936610/778899"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1492, "favorite_count": 0, "accepted_answer_id": 48083366, "answer_count": 1, "score": 1, "last_activity_date": 1515005137, "creation_date": 1514999802, "question_id": 48082091, "link": "https://stackoverflow.com/questions/48082091/stdfind-case-insensitive-checking", "title": "std::find case insensitive checking", "body": "<pre><code>bool is_executable_file(std::wstring file) {\n    std::vector&lt;std::wstring&gt; d = get_splitpath(file);\n    // d [ 3 ] is extension of file ie .exe\n    std::vector&lt;std::wstring&gt; ext = { L\".exe\", L\".dll\", L\".cmd\", L\".msi\" };\n    if ( std::find(ext.begin() , ext.end() , d [ 3 ]) != ext.end() ) {\n        return true;\n    }\n    // do further checks\n    return false;\n}\n</code></pre>\n\n<p>In the above how can I get <code>std::find</code> to do a case insensitive check so I don't need to add all combinations ie <code>.exe</code> and <code>.EXE</code> are the same? </p>\n\n<p>Or another way to check a file extension against a list of extensions ignoring case in both the extension and list of extensions? </p>\n"}, {"tags": ["c++", "class", "inheritance"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1514999794, "post_id": 48082065, "comment_id": 83138500, "body": "<code>shared</code> is not marked as <code>virtual</code>, so why do you expect it to participate in virtual-dispatch?"}], "answers": [{"comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1514999941, "post_id": 48082085, "comment_id": 83138565, "body": "and if you want to have an implementation that must be selected explicitly then you can have pure virtual with implementation ... ohhhhhh ... I think I see why some people find C++ hard."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1515000034, "post_id": 48082085, "comment_id": 83138621, "body": "@UKMonkey: But it still remains the best general-purpose language out there by a country mile; in my opinion at least."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1515000131, "post_id": 48082085, "comment_id": 83138684, "body": "Don&#39;t disagree at all  :)"}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1515002408, "post_id": 48082085, "comment_id": 83139871, "body": "@UKMonkey: Most of the time, you still just follow a set of guidelines; just because you <i>can</i> implement a pure virtual function in C++ doesn&#39;t mean that such things often happen in real code. If you feel it&#39;s necessary to add an implementation to a pure virtual function, then perhaps you have gone too far with inheritance and virtual functions, and a <code>std::function</code> approach would be cleaner. People coming from Java or C# tend to overuse inheritance anyway."}, {"owner": {"reputation": 1251, "user_id": 2340002, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/a4aa312c9abc52b72636e9151f2d0e92?s=128&d=identicon&r=PG", "display_name": "joaocandre", "link": "https://stackoverflow.com/users/2340002/joaocandre"}, "edited": false, "score": 0, "creation_date": 1515018189, "post_id": 48082085, "comment_id": 83146994, "body": "Great answer. However, what would be the correct sintax for implementing this in separate header and cpp files? I&#39;m getting linking errors just by adding <code>virtual</code> to the base class member."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 5, "last_activity_date": 1515002046, "last_edit_date": 1515002046, "creation_date": 1514999784, "answer_id": 48082085, "question_id": 48082065, "link": "https://stackoverflow.com/questions/48082065/child-class-calls-parent-member-instead-of-its-own-member/48082085#48082085", "title": "Child class calls parent member instead of its own member", "body": "<p>Polymorphism is not switched on by default in C++ (unlike Java for example). You need to mark <code>shared</code> <code>virtual</code> in the base class:</p>\n\n<pre><code>virtual float shared(const float _val) {return 0.0;}\n</code></pre>\n\n<p>If you never require a base class implementation, then you can make it <em>pure virtual</em>:</p>\n\n<pre><code>virtual float shared(const float _val) = 0;\n</code></pre>\n\n<p>Finally, in child classes, you <em>can</em> mark the function <code>virtual</code> too, although that has no effect. From C++11 onwards you can use the <code>override</code> keyword to the function which can improve the robustness of your program as withdrawing <code>virtual</code> from the base class will cause a compilation failure:</p>\n\n<pre><code>float shared(const float _val) override {return 2.1;}\n</code></pre>\n"}], "owner": {"reputation": 1251, "user_id": 2340002, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/a4aa312c9abc52b72636e9151f2d0e92?s=128&d=identicon&r=PG", "display_name": "joaocandre", "link": "https://stackoverflow.com/users/2340002/joaocandre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515002046, "creation_date": 1514999694, "question_id": 48082065, "link": "https://stackoverflow.com/questions/48082065/child-class-calls-parent-member-instead-of-its-own-member", "title": "Child class calls parent member instead of its own member", "body": "<p>I'm trying to implement a couple of classes that share a lot of properties, by means of two classes that inherit certain members from a common parent class. In practice, what changes is how they handle a particular member, that would also be inherited, as it would be required from other members of the parent class:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass Parent{\npublic:\n    Parent();\n    Parent(const int _arg);\n    ~Parent();\n    int member1(const std::vector&lt;float&gt; _args);\n    int member2(const std::vector&lt;float&gt; _args) { std::cout &lt;&lt; shared(0.0) &lt;&lt; std::endl;};\n    int member3(const std::vector&lt;float&gt; _args);\n    float shared(const float _val) {return 0.0;}; //dummy call in order for code to be compilable\n\nprotected:\n    int protected_member1;\n    int protected_member2;\n    int protected_member3;\n};\n\nclass Child1 : public Parent {\npublic:\n    Child1(const int _arg):Parent(_arg);\n    ~Child1();\n    float shared(const float _val) {return 2.1;};\n}\n\nclass Child2 : public Parent {\npublic:\n    Child2(const int _arg):Parent(_arg);\n    ~Child2();\n    float shared(const float _val) {return 1.7;};\n}\n</code></pre>\n\n<p>In practice, <code>shared(const float _val)</code> does more complex and problem-specific stuff, I tried to simplify the code in order to illustrate the issue more clearly (and removed irrelevant parts of the code as the definition of the remaining class members). However, when I call <code>member2(const std::vector&lt;float&gt; _args)</code> from each of the child classes, what is called is the base class member <code>shared(const float _val)</code> and not the child member.  </p>\n\n<pre><code>int main(int argc, char const *argv[]){\n    Parent p;\n    Child1 c1;\n    Child2 c2;\n\n    c1.member2(std::vector&lt;float&gt; (5,1.0));\n    c2.member2(std::vector&lt;float&gt; (5,1.0));\n\n    return 0;\n}\n</code></pre>\n\n<p>What am I doing wrong? Would a different approach to the problem make more sense?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 69, "user_id": 6354511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZSW5u.jpg?s=128&g=1", "display_name": "Alexanderrost", "link": "https://stackoverflow.com/users/6354511/alexanderrost"}, "edited": false, "score": 0, "creation_date": 1514999044, "post_id": 48081887, "comment_id": 83138088, "body": "OBS! It isn&#39;t that pretty but I&#39;ve just started :) A lot of things I have to fix up and make it look more tidy!"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1514999158, "post_id": 48081887, "comment_id": 83138165, "body": "In <code>open()</code>, <code>ofstream myFile;</code> is a local variable and only exists inside the function. When the function ends, the <code>ofstream</code> destructor is called which closes the file."}, {"owner": {"reputation": 547, "user_id": 2255137, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9fcd6b31efd87f6e8e9442577ff9926c?s=128&d=identicon&r=PG", "display_name": "Maria", "link": "https://stackoverflow.com/users/2255137/maria"}, "edited": false, "score": 1, "creation_date": 1514999210, "post_id": 48081887, "comment_id": 83138189, "body": "When you type in the value that gets stored in user input do you type in &quot;aName&quot; or &quot;aName.txt&quot;?"}, {"owner": {"reputation": 69, "user_id": 6354511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZSW5u.jpg?s=128&g=1", "display_name": "Alexanderrost", "link": "https://stackoverflow.com/users/6354511/alexanderrost"}, "reply_to_user": {"reputation": 547, "user_id": 2255137, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9fcd6b31efd87f6e8e9442577ff9926c?s=128&d=identicon&r=PG", "display_name": "Maria", "link": "https://stackoverflow.com/users/2255137/maria"}, "edited": false, "score": 0, "creation_date": 1514999391, "post_id": 48081887, "comment_id": 83138276, "body": "@Maria I just write &quot;test&quot; and not &quot;test.txt&quot; and I see how that would be a solution, but i&#39;m still wondering if there isn&#39;t a coding way around having the user type &quot;.txt&quot;"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1514999553, "post_id": 48081887, "comment_id": 83138360, "body": "@Alexanderrost Did you try appending the <code>&quot;.txt&quot;</code> to the string?"}, {"owner": {"reputation": 69, "user_id": 6354511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZSW5u.jpg?s=128&g=1", "display_name": "Alexanderrost", "link": "https://stackoverflow.com/users/6354511/alexanderrost"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1514999703, "post_id": 48081887, "comment_id": 83138454, "body": "Thanks @JohnnyMopp ill be sure to fix that! I&#39;m still new to c++ so i&#39;m just full trail n error mode, Thanks :)"}], "answers": [{"tags": [], "owner": {"reputation": 547, "user_id": 2255137, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9fcd6b31efd87f6e8e9442577ff9926c?s=128&d=identicon&r=PG", "display_name": "Maria", "link": "https://stackoverflow.com/users/2255137/maria"}, "is_accepted": true, "score": 1, "last_activity_date": 1514999611, "creation_date": 1514999611, "answer_id": 48082049, "question_id": 48081887, "link": "https://stackoverflow.com/questions/48081887/turning-userinput-userinput-txt/48082049#48082049", "title": "Turning userInput --&gt; &quot;userInput.txt&quot;", "body": "<p>If you want the user to just type the name and not the file type, you should append <code>\".txt\"</code> when creating the file.</p>\n\n<pre><code>ofstream newFile(userInput + \".txt\");\n</code></pre>\n\n<p>The only issue with this is that if a user does enter the full filename with extension you'll end up with a file named <code>\"myGreatName.txt.txt\"</code>.</p>\n\n<p>If you are interested in fixing that you should look up C++ string manipulation functions (start <a href=\"http://en.cppreference.com/w/cpp/string\" rel=\"nofollow noreferrer\">here</a>) and try to see how you could find out whether the string ends in <code>\".txt\"</code> or not.</p>\n"}], "owner": {"reputation": 69, "user_id": 6354511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZSW5u.jpg?s=128&g=1", "display_name": "Alexanderrost", "link": "https://stackoverflow.com/users/6354511/alexanderrost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 48082049, "answer_count": 1, "score": -1, "last_activity_date": 1514999611, "creation_date": 1514998969, "question_id": 48081887, "link": "https://stackoverflow.com/questions/48081887/turning-userinput-userinput-txt", "title": "Turning userInput --&gt; &quot;userInput.txt&quot;", "body": "<p>i'm trying to make a simple text editor in c++ and I've come across a problem!\nWhen the user is making their new file I am not sure how to take their input and make it a .txt file.</p>\n\n<p>The problematic code is </p>\n\n<pre><code>ofstream newFile(userInput);\n</code></pre>\n\n<p>It now makes a file called \"userInput\" but I does not make a .txt file, any tips on how I would solve this?</p>\n\n<p>Here is the whole code in case it helps or if you have any tips!\n:</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nstring userInput;\nint amoutFiles = 1;\nstring files[100];\n\nvoid read();\nvoid write();\nvoid create();\nvoid listAll();\nvoid storage();\nvoid open();\n\nint main()\n{\n    cout &lt;&lt; \"Welcome to zer0's text editor\" &lt;&lt; endl;\n    cout &lt;&lt; \"Do you wish to :\" &lt;&lt; endl;\n    cout &lt;&lt; \"1: Create file\" &lt;&lt; endl;\n    cout &lt;&lt; \"2: Read Existing file\" &lt;&lt; endl; // Google getLine();\n    cout &lt;&lt; \"3: Write to file\" &lt;&lt; endl;\n    cout &lt;&lt; \"4: List all files\" &lt;&lt; endl;\n    cin &gt;&gt; userInput;\n\nif (userInput == \"1\")\n{\n    create();\n    cin &gt;&gt; userInput;\n}\nelse if (userInput == \"2\")\n{\n    open();\n    read();\n    cin &gt;&gt; userInput;\n}\nelse if (userInput == \"3\")\n{\n    open();\n    write();\n    cin &gt;&gt; userInput;\n}\nelse if (userInput == \"4\")\n{\n    listAll();\n    cin &gt;&gt; userInput;\n}\nreturn 0;\n}\n\nvoid read() //Displays text inside .txt file\n{\n\n}\nvoid write() //Prints text to exsisting file\n{\n    ofstream myFile;\n    open();\n    cout &lt;&lt; \"Enter the text you want to add:\" &lt;&lt; endl;\n    cin &gt;&gt; userInput;\n    myFile &lt;&lt; userInput &lt;&lt; endl;\n    myFile.close();\n}\nvoid create() //Creates a new file \n{\n    cout &lt;&lt; \"Please pick a name for the file\" &lt;&lt; endl;\n    cin &gt;&gt; userInput;\n    ofstream newFile(userInput);\n    files[amoutFiles] = userInput;\n    storage();\n    amoutFiles++;\n}\nvoid listAll() //Lists all files as a part of an array\n{\n    for (size_t i = 0; i &lt; amoutFiles; i++)\n    {\n        cout &lt;&lt; files[i] &lt;&lt; endl;\n    }\n}\nvoid storage()\n{\n    ofstream fileList;\n    fileList.open(\"fileList.txt\");\n    fileList &lt;&lt; userInput &lt;&lt; endl;\n}\nvoid open()\n{\n    ofstream myFile;\n    cout &lt;&lt; \"What file do you wish to open? : \" &lt;&lt; endl;\n    cin &gt;&gt; userInput;\n    myFile.open(userInput);\n}\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "winsock", "recv"], "comments": [{"owner": {"reputation": 11, "user_id": 8549260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8679ee2d64cbcff228743fc21742d22a?s=128&d=identicon&r=PG&f=1", "display_name": "TOESTER", "link": "https://stackoverflow.com/users/8549260/toester"}, "edited": false, "score": 0, "creation_date": 1515000717, "post_id": 48081841, "comment_id": 83139008, "body": "<b>UPDATE</b> - I fixed it. For anyone wondering, the sleep was messing it all up"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1515031602, "post_id": 48081841, "comment_id": 83150337, "body": "the <code>sleep</code> is not the reason for your problems. There are other, more important, problems in your code. Such as buffer overflows. Error code 10038 is <code>WSAENOTSOCK</code>. Your are not allocating your buffers correctly, so you are likely overwriting the call stack, corrupting your <code>SOCKET</code> variables. No <code>sleep</code> (or lack of) would fix that. You are not managing memory correctly, THAT is what you need to fix."}], "owner": {"reputation": 11, "user_id": 8549260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8679ee2d64cbcff228743fc21742d22a?s=128&d=identicon&r=PG&f=1", "display_name": "TOESTER", "link": "https://stackoverflow.com/users/8549260/toester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 352, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515000573, "creation_date": 1514998782, "last_edit_date": 1515000573, "question_id": 48081841, "link": "https://stackoverflow.com/questions/48081841/winsock-c-multithreaded-server-not-receiving-client-response", "title": "Winsock C++ Multithreaded Server not receiving Client response", "body": "<p>I am trying to create a multithreaded server that will create a new thread for every socket connected. I have it so everytime there is a connection, a new thread is created and a message is sent from the server to the client but I cannot get a response from the client to the server to send without getting the <code>10038 error</code>. I would like to make the thread always listening and waiting for a response until it gets one and then continuing. Is this possible to do while still accepting new connections?</p>\n\n<p>Below is the relevant portion of my code (I removed a lot of the socket set up steps).</p>\n\n<p>Server Code:</p>\n\n<pre><code>DWORD WINAPI myThread(LPVOID lpParameter){\n\nTCHAR recvBuffer[] = { 0 };\nZeroMemory(recvBuffer, sizeof(recvBuffer));\nint recvBufferLen = 4096;\nint iSendResult;\nint iResult;\nSOCKET ClientSocket1 = (SOCKET)lpParameter;\n\niResult = recv(ClientSocket1, (char*)recvBuffer, recvBufferLen, 0);\nwhile (iResult &gt; 0){\n    wprintf(L\"Bytes received Port %d -&gt; %s\\n\", iResult, recvBuffer);\n}\nwprintf(L\"Not received\\n\");\nreturn 0;\n}\n\n// Listen for connections\nint _tmain(int argc, _TCHAR* argv[])\n{\n\n    while (1){\n        ClientSocket1 = INVALID_SOCKET;\n        // Accept a Connection\n        while (ClientSocket1 == INVALID_SOCKET){\n            ClientSocket1 = accept(ListenSocket1, NULL, NULL);\n        }\n        wprintf(L\"Client Connected. \\n\");\n        DWORD myThreadID;\n        HANDLE handle = CreateThread(0, 0, myThread, (LPVOID)ClientSocket1, 0, &amp;myThreadID);\n        Sleep(10000);\n    }\nreturn 0;\n}\n</code></pre>\n\n<p>Client Code:</p>\n\n<pre><code>int _tmain(int argc, _TCHAR* argv[])\n{\n\nTCHAR recvBuffer[] = { 0 };\nint recvBufferLen = 10000;\nwchar_t sendBuf[] = { 0 };\nint iSendResult;\n// Receive Menu\n\niResult = recv(ConnectSocket1, (char*)recvBuffer, 512, 0);\nif (iResult &gt; 0){\n    wprintf(L\"%s\", recvBuffer);\n\n\n    // Send choice\n    do{\n        wprintf(L\"Please input a choice:\\n\");\n        fgetws(sendBuf, 10, stdin);\n    } while (!(_wtoi(sendBuf) &gt;= 1 &amp;&amp; _wtoi(sendBuf) &lt;= 6));\n\n    iSendResult = send(ConnectSocket1, (char*)sendBuf, 4096, 0);\n    if (iSendResult == SOCKET_ERROR){\n        wprintf(L\"Send Failed: %d\\n\", WSAGetLastError());\n        closesocket(ConnectSocket1);\n        WSACleanup();\n        getchar();\n        return 1;\n    }\n    wprintf(L\"Message Sent.\\n\");\n\n}\n}\n</code></pre>\n"}, {"tags": ["c++", "getline"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1514998867, "post_id": 48081775, "comment_id": 83137996, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7868936/read-file-line-by-line\">Read file line by line</a>"}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1514998962, "post_id": 48081775, "comment_id": 83138041, "body": "You don&#39;t have to read the entire line. What you can is to read a chunk, say 4kb and then parse it, i.e. search for <code>:</code>. Once you are done with the chunk you keep the rest of the chunk and append the next one to the end of the leftover. If you encounter EOL then you do your processing on the vector. Also whether reading whole line is inefficient actually depends on how much RAM you have and how long lines are. If each line is up to say 10Mb then I wouldn&#39;t bother with chunking algos and I would read entire thing at once. So how big are these lines?"}, {"owner": {"reputation": 329, "user_id": 5011398, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-G7XTl2M-oXk/AAAAAAAAAAI/AAAAAAAAABI/6oFIebE75kc/photo.jpg?sz=128", "display_name": "Henry Shackleton", "link": "https://stackoverflow.com/users/5011398/henry-shackleton"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1515000053, "post_id": 48081775, "comment_id": 83138638, "body": "@freakish, each line is about 1Mb. So it sounds like it&#39;s fine to just read the whole thing to a string?"}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1515000128, "post_id": 48081775, "comment_id": 83138681, "body": "@wayward_vagabound Well, I assume we are talking about Gbs of RAM available? If that&#39;s the case then yeah, it&#39;s fine. 1Mb is like nothing to modern computers."}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1515000292, "post_id": 48081775, "comment_id": 83138775, "body": "Also here&#39;s a more general advice: go for correctness in the first place. Then simplicity. And finally performance. Premature optimization is the root of all evil."}], "answers": [{"comments": [{"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 0, "creation_date": 1515001017, "post_id": 48082355, "comment_id": 83139193, "body": "std::streams should be passed by reference, otherwise you are calling a deleted function."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5293664"}, "reply_to_user": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 0, "creation_date": 1515001741, "post_id": 48082355, "comment_id": 83139533, "body": "I was just trying to show the high level thought process of breaking bigger problems into smaller pieces using abstraction, and how doing so can help piece together how to implement the small details."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5293664"}, "is_accepted": false, "score": 0, "last_activity_date": 1515001541, "last_edit_date": 1515001541, "creation_date": 1515000863, "answer_id": 48082355, "question_id": 48081775, "link": "https://stackoverflow.com/questions/48081775/c-read-in-file-element-by-element-but-executing-functions-every-line/48082355#48082355", "title": "C++ Read in file element by element, but executing functions every line", "body": "<p>When trying to plan stuff out, <strong>abstraction</strong> can be your best friend. If you break down what you want to do by abstract functionality, you can more easily decide what data types should be used and how different data types should be planned out, and often you can find some functions almost write themselves. And typically, your code will be more modular (almost by definition), which will make it easy to reuse, maintain, and adapt if future changes are needed.</p>\n\n<p>For example, it sounds like you want to <em>parse a file</em>. So that should be a function. </p>\n\n<p>To do that function, you want to <em>read in the file lines</em> then <em>process the file lines</em>. So you can make two functions, one for each of those actions, and just call the functions.</p>\n\n<p>To <em>read in file lines</em> you just want to take a file stream, and return a collection of strings for each line.</p>\n\n<p>To <em>process file lines</em> you want to take a collection of strings and for each one <em>parse the string into a triplet value</em>. So you can create a method that takes a string and breaks it into a triplet, and just use that method here.</p>\n\n<p>To <em>process a string</em> you just need to take a string and assign the first part as the row, the second part as the column, and the third part as the value.</p>\n\n<pre><code>struct TripletValue\n{\n    int Row;\n    int Col;\n    int Val;\n};\n\nstd::vector&lt;TripletValue&gt; ParseFile(std::istream&amp; inputStream)\n{\n    std::vector&lt;std::string&gt; fileLines = ReadFileLines(inputStream);\n    std::vector&lt;TripletValue&gt; parsedValues = GetValuesFromData(fileLines);\n    return parsedValues;\n}\n\nstd::vector&lt;std::string&gt; ReadFileLines(std::istream&amp; inputStream)\n{\n    std::vector&lt;std::string&gt; fileLines;\n    while (!inputStream.eof())\n    {\n        std::string fileLine;\n        getline(inputStream, fileLine);\n        fileLines.push_back(fileLine);\n    }\n    return fileLines;\n}\n\nstd::vector&lt;TripletValue&gt; GetValuesFromData(std::vector&lt;std::string&gt; data)\n{\n    std::vector&lt;TripletValue&gt; values;\n\n    for (int i = 0; i &lt; data.size(); i++)\n    {\n        TripletValue parsedValue = ParseLine(data[i]);\n        values.push_back(parsedValue);\n    }\n\n    return values;\n}\n\nTripletValue ParseLine(std::string fileLine)\n{\n    std::stringstream sstream;\n    sstream &lt;&lt; fileLine;\n\n    TripletValue parsedValue;\n\n    std::string strValue;\n    sstream &gt;&gt; strValue;\n    parsedValue.Row = stoi(strValue);\n\n    sstream &gt;&gt; strValue;\n    parsedValue.Col = stoi(strValue);\n\n    sstream &gt;&gt; strValue;\n    parsedValue.Val = stoi(strValue);\n\n    return parsedValue;\n}\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 5011398, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-G7XTl2M-oXk/AAAAAAAAAAI/AAAAAAAAABI/6oFIebE75kc/photo.jpg?sz=128", "display_name": "Henry Shackleton", "link": "https://stackoverflow.com/users/5011398/henry-shackleton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515001541, "creation_date": 1514998581, "question_id": 48081775, "link": "https://stackoverflow.com/questions/48081775/c-read-in-file-element-by-element-but-executing-functions-every-line", "title": "C++ Read in file element by element, but executing functions every line", "body": "<p>I have a file that I need to read in. Each line of the file is exceedingly long, so I'd rather not read each line to a temporary string and then manipulate those strings (unless this isn't actually inefficient - I could be wrong). Each line of the file contains a string of triplets - two numbers and a complex number, separated by a colon (as opposed to a comma, which is used in the complex number). My current code goes something like this:</p>\n\n<pre><code> while (states.eof() == 0)\n  {\n  std::istringstream complexString;\n\n  getline(states, tmp_str, ':');\n  tmp_triplet.row() = stoi(tmp_str);\n  getline(states, tmp_str, ':');\n  tmp_triplet.col() = stoi(tmp_str);\n  getline(states, tmp_str, ':');\n  complexString.str (tmp_str);\n  complexString &gt;&gt; tmp_triplet.value();\n  // Then something useful done with the triplet before moving onto the next one\n  }\n</code></pre>\n\n<p>tmp_triplet is a variable that stores these three numbers. I want some way to run a function every line (specifically, the triplets in every line are pushed into a vector, and each line in the file denotes a different vector). I'm sure there's an easy way to go about this, but I just want a way to check whether the end of the line has been reached, and to run a function when this is the case.</p>\n"}, {"tags": ["c++", "linux", "qt", "qvideowidget"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1514998642, "post_id": 48081448, "comment_id": 83137885, "body": "Do you want to capture the click event of the QMediaPlayer or do you want to place a QPushButton in front of the QMediaPlayer?"}, {"owner": {"reputation": 51, "user_id": 7921672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18a364702846028a6dd8426e1438392c?s=128&d=identicon&r=PG", "display_name": "Aar&#243;n Guti&#233;rrez", "link": "https://stackoverflow.com/users/7921672/aar%c3%b3n-guti%c3%a9rrez"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1514999502, "post_id": 48081448, "comment_id": 83138332, "body": "@eyllanesc any way is great for me , but I prefered the button in front of the video, but if you have the solution to capture the click event of the QMediaPlayer is great!"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1514999605, "post_id": 48081448, "comment_id": 83138396, "body": "Could you show a picture of how you want to see the button in front of the QMediaPlayer?"}, {"owner": {"reputation": 51, "user_id": 7921672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18a364702846028a6dd8426e1438392c?s=128&d=identicon&r=PG", "display_name": "Aar&#243;n Guti&#233;rrez", "link": "https://stackoverflow.com/users/7921672/aar%c3%b3n-guti%c3%a9rrez"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1515003587, "post_id": 48081448, "comment_id": 83140477, "body": "@eyllanesc Like this, the blackscreen is the video and the micorsoft store logo is the botton tha I want put   <a href=\"https://mega.nz/#!mxVXzLaD!PoIZgM4iclzpq7i3MKBGVKhD2dp9iB9mRgM24hRhcLc\" rel=\"nofollow noreferrer\">mega.nz/#!mxVXzLaD!PoIZgM4iclzpq7i3MKBGVKhD2dp9iB9mRgM24hRhc&zwnj;&#8203;Lc</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2064, "user_id": 3606329, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/027b912750dbb94c9c1ff89c9eb20f46?s=128&d=identicon&r=PG&f=1", "display_name": "user3606329", "link": "https://stackoverflow.com/users/3606329/user3606329"}, "edited": false, "score": 0, "creation_date": 1515020580, "post_id": 48085992, "comment_id": 83147752, "body": "<code>vw = new QVideoWidget(this);</code> overoptimized."}, {"owner": {"reputation": 51, "user_id": 7921672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18a364702846028a6dd8426e1438392c?s=128&d=identicon&r=PG", "display_name": "Aar&#243;n Guti&#233;rrez", "link": "https://stackoverflow.com/users/7921672/aar%c3%b3n-guti%c3%a9rrez"}, "edited": false, "score": 0, "creation_date": 1515104752, "post_id": 48085992, "comment_id": 83184587, "body": "Hey! I tried the code that you sended me, and the result is the same :( Do you think that is problem of Qt? when I execute a program I get this errors  <code>QStandardPaths: XDG_RUNTIME_DIR not set, defaulting to &#39;&#47;tmp&#47;runtime-root&#39; libGL error: pci id for fd 9: 8086:591b, driver (null) i965_dri.so does not support the 0x591b PCI ID. libGL error: failed to create dri screen libGL error: failed to load driver: i965 </code>  Also I downloaded the code from git, but is the same result"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1515104874, "post_id": 48085992, "comment_id": 83184629, "body": "That&#39;s a problem with your video driver, I do not have that problem."}, {"owner": {"reputation": 51, "user_id": 7921672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18a364702846028a6dd8426e1438392c?s=128&d=identicon&r=PG", "display_name": "Aar&#243;n Guti&#233;rrez", "link": "https://stackoverflow.com/users/7921672/aar%c3%b3n-guti%c3%a9rrez"}, "edited": false, "score": 0, "creation_date": 1515105789, "post_id": 48085992, "comment_id": 83184957, "body": "Thanks for your help! I will fix this problem!"}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 0, "last_activity_date": 1533183043, "last_edit_date": 1533183043, "creation_date": 1515017925, "answer_id": 48085992, "question_id": 48081448, "link": "https://stackoverflow.com/questions/48081448/add-button-to-qvideowidget/48085992#48085992", "title": "Add button to QVideoWidget", "body": "<p>One possible solution is to create a widget where the <code>QVideoWidget</code> is placed through a layout, the button is also added and we change the position through the <code>resizeEvent()</code> event.</p>\n\n<pre><code>#include &lt;QApplication&gt;\n#include &lt;QMediaPlayer&gt;\n#include &lt;QMediaPlaylist&gt;\n#include &lt;QPushButton&gt;\n#include &lt;QUrl&gt;\n#include &lt;QVBoxLayout&gt;\n#include &lt;QVideoWidget&gt;\n\n#include &lt;QDebug&gt;\n\nclass VideoWidgetButton: public QWidget{\n    QPushButton *btn;\n    QVideoWidget *vw;\n    QMediaPlayer *player;\npublic:\n    VideoWidgetButton(QWidget *parent=Q_NULLPTR):QWidget(parent){\n        setLayout(new QVBoxLayout);\n        layout()-&gt;setContentsMargins(0, 0, 0, 0);\n\n        vw = new QVideoWidget(this);\n        btn = new QPushButton(this);\n        btn-&gt;setIcon(QIcon(\":/icons/tux.jpeg\"));\n        btn-&gt;resize(QSize(128, 128));\n        btn-&gt;setIconSize(QSize(128, 128));\n\n        connect(btn, &amp;QPushButton::clicked, [](){\n            qDebug()&lt;&lt;\"clicked\";\n        });\n\n        layout()-&gt;addWidget(vw);\n\n        player = new QMediaPlayer(this);\n        player-&gt;setVideoOutput(vw);\n\n        QMediaPlaylist *playList = new QMediaPlaylist(this);\n        playList-&gt;addMedia(QUrl(\"qrc:/video/SampleVideo_1280x720_1mb.mp4\"));\n        playList-&gt;setPlaybackMode(QMediaPlaylist::Loop);\n        player-&gt;setPlaylist(playList);\n        player-&gt;play();\n\n    }\nprotected:\n    void resizeEvent(QResizeEvent *ev){\n        btn-&gt;move(rect().bottomRight()-btn-&gt;rect().bottomRight());\n        return QWidget::resizeEvent(ev);\n    }\n};\n\nint main(int argc, char *argv[])\n{\n    QApplication a(argc, argv);\n    VideoWidgetButton w;\n    w.resize(640, 480);\n    w.show();\n    return a.exec();\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/4FT8u.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4FT8u.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The complete example can be found in the following <a href=\"https://github.com/eyllanesc/stackoverflow/tree/master/48081448\" rel=\"nofollow noreferrer\">link</a>.</p>\n"}], "owner": {"reputation": 51, "user_id": 7921672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18a364702846028a6dd8426e1438392c?s=128&d=identicon&r=PG", "display_name": "Aar&#243;n Guti&#233;rrez", "link": "https://stackoverflow.com/users/7921672/aar%c3%b3n-guti%c3%a9rrez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 932, "favorite_count": 0, "accepted_answer_id": 48085992, "answer_count": 1, "score": 1, "last_activity_date": 1564217510, "creation_date": 1514997281, "last_edit_date": 1538191877, "question_id": 48081448, "link": "https://stackoverflow.com/questions/48081448/add-button-to-qvideowidget", "title": "Add button to QVideoWidget", "body": "<p><img src=\"https://i.stack.imgur.com/FhwW5.png\" alt=\"example image\"></p>\n\n<p>everyone! I try to set a click property to a QMediaPlayer Element, but I can not find the mode to make it, and if I try to put a button in front to Video, the button puts behind to video, even with </p>\n\n<pre><code>button-&gt;raise();\nvideoWidget-&gt;lower();\n</code></pre>\n\n<p>And If I put a Button to fullscreen the screen turns in black and don't shows the video</p>\n\n<p>this id the code of the video player</p>\n\n<pre><code>QMediaPlayer *player = new QMediaPlayer(this);\nQVideoWidget *vw = new QVideoWidget(this);\n\nQMediaPlaylist *PlayList = new QMediaPlaylist(this);\nPlayList-&gt;addMedia(QUrl::fromLocalFile(\"/home/user/Videos/video.mp4\"));\nPlayList-&gt;setPlaybackMode(QMediaPlaylist::Loop);\n\nQVBoxLayout *layout = new QVBoxLayout;\nlayout-&gt;addWidget(vw);\n\nplayer-&gt;setVideoOutput(vw);\nplayer-&gt;setPlaylist(PlayList);\n\nvw-&gt;setGeometry(0,0,800,480);\nvw-&gt;show();\nplayer-&gt;play();\n</code></pre>\n"}, {"tags": ["c++", "string", "c++17", "string-view"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1514997376, "post_id": 48081436, "comment_id": 83137138, "body": "My mistake, <a href=\"http://en.cppreference.com/w/cpp/string/basic_string_view/data\" rel=\"nofollow noreferrer\"><code>std::std::basic_string_view::data</code></a> does not guarantee a null terminated string."}], "answers": [{"comments": [{"owner": {"reputation": 1400, "user_id": 164958, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e798788a1233311f5eeec06bb37442a0?s=128&d=identicon&r=PG", "display_name": "Syndog", "link": "https://stackoverflow.com/users/164958/syndog"}, "edited": false, "score": 0, "creation_date": 1546351888, "post_id": 48081509, "comment_id": 94829540, "body": "The explanation for why std::string_view doesn&#39;t provide a conversion is great, but only offers a provisional answer to the question."}, {"owner": {"reputation": 3017, "user_id": 1276072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21c3f68aa381587ec5ccb2cff14ca5a1?s=128&d=identicon&r=PG", "display_name": "rems4e", "link": "https://stackoverflow.com/users/1276072/rems4e"}, "edited": false, "score": 1, "creation_date": 1582315169, "post_id": 48081509, "comment_id": 106748624, "body": "Your recommendation about <code>std::string(object).data()</code> is a bad one, because in most cases the data will point to unallocated storage."}, {"owner": {"reputation": 4200, "user_id": 2552290, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/7fT1c.gif?s=128&g=1", "display_name": "Don Hatch", "link": "https://stackoverflow.com/users/2552290/don-hatch"}, "reply_to_user": {"reputation": 3017, "user_id": 1276072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21c3f68aa381587ec5ccb2cff14ca5a1?s=128&d=identicon&r=PG", "display_name": "rems4e", "link": "https://stackoverflow.com/users/1276072/rems4e"}, "edited": false, "score": 3, "creation_date": 1585810942, "post_id": 48081509, "comment_id": 107894827, "body": "@rems4e  An alarm went off for me as well when I saw <code>std::string(object).data()</code> recommended without  the important caveat that the returned pointer is to data inside the temporary std::string object, which lasts only til the end of the largest enclosing expression."}], "tags": [], "owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "is_accepted": true, "score": 54, "last_activity_date": 1546725369, "last_edit_date": 1546725369, "creation_date": 1514997517, "answer_id": 48081509, "question_id": 48081436, "link": "https://stackoverflow.com/questions/48081436/how-you-convert-a-stdstring-view-to-a-const-char/48081509#48081509", "title": "How you convert a std::string_view to a const char*?", "body": "<p>A <code>std::string_view</code> doesn't provide a conversion to a <code>const char*</code> because <strong>it doesn't store a null-terminated string</strong>. It stores a pointer to the first element, and the length of the string, basically. That means that you cannot pass it to a function expecting a null-terminated string, like <code>foo</code> (how else are you going to get the size?) that expects a <code>const char*</code>, and so it was decided that it wasn't worth it.</p>\n\n<p>If you know for sure that you have a null-terminated string in your view, you can use <a href=\"http://en.cppreference.com/w/cpp/string/basic_string_view/data\" rel=\"noreferrer\"><code>std::string_view::data</code></a>.</p>\n\n<p>If you're not you should reconsider whether using a <code>std::string_view</code> in the first place is a good idea, since if you want a guaranteed null-terminated string <code>std::string</code> is what you want. For a one-liner you can use <code>std::string(object).data()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 122, "user_id": 9163420, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-N_1glkOW8Kc/AAAAAAAAAAI/AAAAAAAAhok/ZB7_iEl_yDE/photo.jpg?sz=128", "display_name": "Maxime Guinin", "link": "https://stackoverflow.com/users/9163420/maxime-guinin"}, "is_accepted": false, "score": 7, "last_activity_date": 1514998183, "creation_date": 1514998183, "answer_id": 48081675, "question_id": 48081436, "link": "https://stackoverflow.com/questions/48081436/how-you-convert-a-stdstring-view-to-a-const-char/48081675#48081675", "title": "How you convert a std::string_view to a const char*?", "body": "<p>You can call <code>foo(std::string(str).c_str())</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 1, "creation_date": 1517308102, "post_id": 48082010, "comment_id": 84032834, "body": "by &quot; (and clean it up at the end of the line).&quot;, I can continue use the member of that Rvalue til the end of scope that <code>std::string(string_view_object).c_str()</code> sitting, right?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 1, "creation_date": 1517322355, "post_id": 48082010, "comment_id": 84042076, "body": "@sandthorn No, until the end of the full expression, not scope."}, {"owner": {"reputation": 16677, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "reply_to_user": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 0, "creation_date": 1614154201, "post_id": 48082010, "comment_id": 117295564, "body": "@sandthorn If you want the string to stick around, you&#39;d maybe prefer <code>std::string TempVar(string_view_object);</code> then where you need it in scope, <code>TempVar.c_str()</code>."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 39, "last_activity_date": 1609194720, "last_edit_date": 1609194720, "creation_date": 1514999447, "answer_id": 48082010, "question_id": 48081436, "link": "https://stackoverflow.com/questions/48081436/how-you-convert-a-stdstring-view-to-a-const-char/48082010#48082010", "title": "How you convert a std::string_view to a const char*?", "body": "<p>Simply do a <code>std::string(string_view_object).c_str()</code> to get a guaranteed null-terminated temporary copy (and clean it up at the end of the line).</p>\n<p>This is required because string view doesn't guarantee null termination.  You can have a view into the middle of a longer buffer, for example.</p>\n<p>If this use case is expensive and you have proven it to be a bottleNeck, you can write an augmented <code>string_view</code> that tracks if it is null terminated (basically, if it was constructed from a raw <code>char const*</code>).</p>\n<p>Then you can write a helper type that takes this augmented <code>string_view</code> and either copies it to a <code>std::string</code> or stores the augmented <code>string_view</code> directly, and has an implicit cast-to-<code>char const*</code> that returns the properly null-terminated buffer.</p>\n<p>Then use that augmented helper type everywhere in your code base instead of <code>string_view</code>, possibly augmenting string view interaction with std string as well to catch the cases where you have a view that goes to the end of the std string buffer.</p>\n<p>But really, that is probably overkill.</p>\n<p>A better approach is probably rewriting the APIs that take <code>const char*</code> to take <code>string_view</code>.</p>\n"}], "owner": {"reputation": 3023, "user_id": 1691145, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b6744a17b41f3b0e5c7554a43a04094?s=128&d=identicon&r=PG", "display_name": "Justin Raymond", "link": "https://stackoverflow.com/users/1691145/justin-raymond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32111, "favorite_count": 2, "accepted_answer_id": 48081509, "answer_count": 3, "score": 37, "last_activity_date": 1609194720, "creation_date": 1514997255, "last_edit_date": 1514997342, "question_id": 48081436, "link": "https://stackoverflow.com/questions/48081436/how-you-convert-a-stdstring-view-to-a-const-char", "title": "How you convert a std::string_view to a const char*?", "body": "<p>Compiling with gcc-7.1 with the flag <code>-std=c++17</code>, the following program raises an error:</p>\n\n<pre><code>#include &lt;string_view&gt;\nvoid foo(const char* cstr) {}\nvoid bar(std::string_view str){\n    foo(str);\n}\n</code></pre>\n\n<p>The error message is</p>\n\n<pre><code>In function 'void bar(std::string_view)':\nerror: cannot convert 'std::string_view {aka std::basic_string_view&lt;char&gt;}' to 'const char*' for argument '1' to 'void foo(const char*)'\n foo(str);\n</code></pre>\n\n<p>I'm surprised there is no  conversion to <code>const char*</code> because other libraries (abseil, bde), provide similar <code>string_view</code> classes which implicitly convert to <code>const char*</code>.</p>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1514997289, "post_id": 48081427, "comment_id": 83137088, "body": "What is your question? Are you asking us to write the solution for you? SO is not a code writing service. What have you done to solve it on your own (please show those efforts)."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1514997976, "post_id": 48081427, "comment_id": 83137512, "body": "One can define a mid point of a vector as (start location + end location)/2. How do you define the mid point of two vectors?"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5413748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b48b60e742bb149cc4ae61eafafc13d?s=128&d=identicon&r=PG&f=1", "display_name": "HALO", "link": "https://stackoverflow.com/users/5413748/halo"}, "edited": false, "score": 0, "creation_date": 1514998519, "post_id": 48081532, "comment_id": 83137808, "body": "Thanks. I thought that was all that was needed. I was confused by the operator in the class which I had not seen before"}], "tags": [], "owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "is_accepted": false, "score": 2, "last_activity_date": 1514997618, "creation_date": 1514997618, "answer_id": 48081532, "question_id": 48081427, "link": "https://stackoverflow.com/questions/48081427/vector-math-functions-for-midpoint-calculation/48081532#48081532", "title": "Vector Math functions for midpoint calculation", "body": "<p>Doesn't this work ?</p>\n\n<pre><code>V3D Midpoint(const V3D&amp; A, const V3D&amp; B)\n{\nreturn (A + B) / 2.0;\n}\n</code></pre>\n\n<p>This is simply writing in code what you specified in the question.</p>\n"}], "owner": {"reputation": 51, "user_id": 5413748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b48b60e742bb149cc4ae61eafafc13d?s=128&d=identicon&r=PG&f=1", "display_name": "HALO", "link": "https://stackoverflow.com/users/5413748/halo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1514997618, "creation_date": 1514997217, "question_id": 48081427, "link": "https://stackoverflow.com/questions/48081427/vector-math-functions-for-midpoint-calculation", "title": "Vector Math functions for midpoint calculation", "body": "<p>I'm trying to find the midpoint of a two 3D vectors (A and B). I believe it should be VectorA + VectorB/2 will give the midpoint. But how would I use create a fucntion that returns the midpoint like this V3D Midpoint(V3D A, V3D B)\u037e if I have a class like this:</p>\n\n<pre><code>class V3D\n{\npublic:\n\nV3D()\u037e \nV3D(float x, float y, float z)\u037e\n~V3D()\u037e\n\nV3D operator+( const V3D&amp; V ) const\u037e \nV3D operator(const V3D&amp; V ) const\u037e \nV3D operator*( float Scale ) const\u037e \nV3D operator/( FLOAT Scale ) const\u037e \n\nfloat dot( const V3D&amp; V ) const\u037e \nV3D cross( const V3D&amp; V ) const\u037e \nV3D Normal() const\u037e // this vector's unit vector\nfloat Size() const\u037e // magnitude of this vector\n\nprivate:\nfloat X, Y, Z\u037e\n}\u037e\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1514996860, "post_id": 48081302, "comment_id": 83136828, "body": "&quot;I am not sure if [<code>calloc()</code>] will have the same behavior as new T[n]()&quot; Absolutely not. C functions know nothing about the C++ object lifetime model and are not sufficient to create valid C++ objects. IIRC, even for trivially constructable types, debate rages over whether the Standard indicates they can legally begin life via <code>malloc()</code> alone. And usually, if there has to be a debate about it, it&#39;s not safe to rely on yet."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1514996949, "post_id": 48081302, "comment_id": 83136885, "body": "&quot;<i>I know that <code>calloc()</code> will zero-initialize the memory, but I am not sure if that will have the same behavior as <code>new T[n]()</code>.</i>&quot; One thing that is different is: it won&#39;t call constructors. In fact: none of C memory allocation routines will, since, well.. C doesn&#39;t have them."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 1, "creation_date": 1514997003, "post_id": 48081302, "comment_id": 83136906, "body": "You can&#39;t implement a std::vector like class with realloc."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 2, "creation_date": 1514997123, "post_id": 48081302, "comment_id": 83136988, "body": "@Fureeish The link you provide contradicts your statement."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1514997690, "post_id": 48081302, "comment_id": 83137339, "body": "You can&#39;t use <code>realloc</code> here unless your objects are trivially copyable. It seems you are severely underestimating the difficulty of the task you set out to complete."}, {"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 0, "creation_date": 1514997786, "post_id": 48081302, "comment_id": 83137401, "body": "Agreed with other comments, but still, if you want to try it, the next thing you need to learn is: <a href=\"https://en.wikipedia.org/wiki/Placement_syntax\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Placement_syntax</a>"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1514997942, "post_id": 48081302, "comment_id": 83137489, "body": "Relevant read: <a href=\"https://stackoverflow.com/q/8003233/3002139\">stackoverflow.com/q/8003233/3002139</a>"}], "answers": [{"tags": [], "owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "is_accepted": true, "score": 3, "last_activity_date": 1514997840, "creation_date": 1514997840, "answer_id": 48081584, "question_id": 48081302, "link": "https://stackoverflow.com/questions/48081302/how-to-default-initialize-without-using-new/48081584#48081584", "title": "How to default-initialize without using new?", "body": "<p>First, no, zero-initializing memory is not the same as calling default constructors for the objects that that memory is supposed to hold. You <strong>have to</strong> call constructors. So <code>malloc</code> versus <code>calloc</code> doesn't matter in terms of correctness; so if you're going to go that route, use <code>malloc</code> -- it's faster.</p>\n\n<p>Second, <code>realloc</code> won't work directly, because it doesn't know how to copy objects. Some objects can be copied byte-by-byte, and for those types, <code>realloc</code> is okay. But for most types, copying involves additional operations, and you have to use the copy constructor or copy assignment operator to do the copy. So <code>realloc</code> can be used in special cases, but not in general.</p>\n\n<p>So, you're really limited to <code>malloc</code> and <code>free</code>, along with constructors (through placement <code>new</code>) and destructors.</p>\n"}, {"tags": [], "owner": {"reputation": 142, "user_id": 8342865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f4f01521b79271683b03905bd482df?s=128&d=identicon&r=PG", "display_name": "Pascal", "link": "https://stackoverflow.com/users/8342865/pascal"}, "is_accepted": false, "score": 0, "last_activity_date": 1514999031, "creation_date": 1514999031, "answer_id": 48081905, "question_id": 48081302, "link": "https://stackoverflow.com/questions/48081302/how-to-default-initialize-without-using-new/48081905#48081905", "title": "How to default-initialize without using new?", "body": "<p>You can call any constructor with any kind of memory using this syntax:</p>\n\n<pre><code>::new (ptr) T(...arguments go here (if any)...);\n</code></pre>\n\n<p>You may have to use </p>\n\n<pre><code>#include &lt;new&gt;\n</code></pre>\n\n<p>It will call the constructor of T for a memory allocated at ptr.\nfor an array you will have to loop:</p>\n\n<pre><code>T* ptr=(T*)malloc(sizeof(T)*n);\nfor(int i=0;i&lt;n;++i)\n   ::new(ptr+i) T();\n</code></pre>\n\n<p>But with this, DO NOT CALL delete ! You will have to explicitly call the destructor for each item and then free the memory with the correct function:</p>\n\n<pre><code>for(int i=0;i&lt;n;++i)\n   (ptr+i)-&gt;~T();\nfree(ptr);\n</code></pre>\n\n<p>In case of realloc, you must be sure that the T object can be relocated without any problem (byte-to-byte copy OK). It should be safe for struct with simple data type.</p>\n"}], "owner": {"reputation": 983, "user_id": 8772958, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/56210f0212692ed235a23c0c3ec6be25?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Smith", "link": "https://stackoverflow.com/users/8772958/michael-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 48081584, "answer_count": 2, "score": 2, "last_activity_date": 1514999031, "creation_date": 1514996774, "question_id": 48081302, "link": "https://stackoverflow.com/questions/48081302/how-to-default-initialize-without-using-new", "title": "How to default-initialize without using new?", "body": "<p>I am trying to implement my own <code>std::vector</code> container, and I am using <code>realloc()</code> to resize it, to prevent deletion and reallocation every time. With the following code:</p>\n\n<pre><code>buffer = new T[n]();\n</code></pre>\n\n<p>This would default initialize each element of the array, and allow me to start accessing them right away. However, since the standard specifies that the memory <code>must be previously allocated by malloc(), calloc() or realloc()</code> to use <code>realloc()</code>, I cannot use <code>new</code>.</p>\n\n<p>I know that <code>calloc()</code> will zero-initialize the memory, but I am not sure if that will have the same behavior as <code>new T[n]()</code>. What is the proper way to default-intialize with C style memory allocation?</p>\n"}, {"tags": ["c++", "amazon-web-services"], "answers": [{"tags": [], "owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "is_accepted": false, "score": 1, "last_activity_date": 1515028630, "creation_date": 1515028630, "answer_id": 48087418, "question_id": 48081179, "link": "https://stackoverflow.com/questions/48081179/what-has-changed-with-the-aws-signature-version-4/48087418#48087418", "title": "What has changed with the AWS Signature Version 4", "body": "<p><code>e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855</code></p>\n\n<p>This is the SHA-256 hash of an empty string (see  <a href=\"https://crypto.stackexchange.com/a/26135/25027\">https://crypto.stackexchange.com/a/26135/25027</a>).</p>\n\n<p>Signature V4 is entirely different from Signature V2.  You hash the <em>body</em> first (the HTTP request body, which does not include the headers), using the value shown when there is no request body.</p>\n\n<p>There is no part of the actual input to Signature V4 that coresponds to your <code>// input string</code>.  </p>\n\n<p>That is an example of the HTTP request that you will be sending, but it is not something that goes directly into the signing algorithm.</p>\n\n<p>The <a href=\"https://docs.aws.amazon.com/general/latest/gr/sigv4-create-canonical-request.html\" rel=\"nofollow noreferrer\">canonical request structure</a> is this:</p>\n\n<pre><code>CanonicalRequest =\n  HTTPRequestMethod + '\\n' +\n  CanonicalURI + '\\n' +\n  CanonicalQueryString + '\\n' +\n  CanonicalHeaders + '\\n' +\n  SignedHeaders + '\\n' +\n  HexEncode(Hash(RequestPayload))\n</code></pre>\n\n<p>Here, in <code>HexEncode(Hash(RequestPayload))</code>, <code>RequestPayload</code> refers <em>only</em> to the request body -- not the headers.  When there's no body, empty string is used, and the hash of an empty string is the value shown.</p>\n"}], "owner": {"reputation": 15008, "user_id": 16582, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/febff21383acf755f8b375c322e36f2b?s=128&d=identicon&r=PG", "display_name": "ravenspoint", "link": "https://stackoverflow.com/users/16582/ravenspoint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515028630, "creation_date": 1514996335, "question_id": 48081179, "link": "https://stackoverflow.com/questions/48081179/what-has-changed-with-the-aws-signature-version-4", "title": "What has changed with the AWS Signature Version 4", "body": "<p>A few years ago I wrote some C++ code to sign on to AWS ( Amazon Web Service ).  It worked fine at the time.  I haven't used it for a while, and now it does not work.</p>\n\n<pre><code>\"com.amazon.coral.service#InvalidSignatureException\"\n</code></pre>\n\n<p>I think I have narrowed it down to the hashing function.  This unit test fails:</p>\n\n<pre><code>TEST( aws_hash )\n{\n    // unit test the hashing function used for AWS authentication\n    // sample input and expected results from Signature Version 4 Test Suite\n    // https://docs.aws.amazon.com/general/latest/gr/signature-v4-test-suite.html\n    // specifically the get-vanilla-query\n    // note that this is step 1 of the signing process an does not involve the secret key.\n\n    // input string\n    std::string query =\n    \"GET / HTTP/1.1\\n\"\n    \"Host:example.amazonaws.com\\n\"\n    \"X-Amz-Date:20150830T123600Z\";\n\n    // calculate hash of input\n    SHA256 sha256;\n    std::string thehash = sha256( query );\n\n    // expected hash value from test suite\n    // ( last line of get-vanilla-query.creq )\n    std::string expected = \"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\";\n\n    // did we get the expected hash?\n    CHECK_EQUAL( expected, thehash );\n}\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>C:\\unit_test\\main.cpp(47): error: Failure in aws_hash:\nExpected e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 \nbut was 509955df496ae2f4fdc25af95ccf5406099e4a2556523b7ed80f4fab21ac1869\n</code></pre>\n\n<p>The code for the hashing function I am using can be seen at <a href=\"https://github.com/JamesBremner/sha256\" rel=\"nofollow noreferrer\">https://github.com/JamesBremner/sha256</a></p>\n\n<p>Is there some change I should be aware of?</p>\n\n<p>Is there something wrong with my unit test?</p>\n"}, {"tags": ["c++", "amazon-web-services", "amazon-s3", "aws-sdk-cpp"], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 3673564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aa6106a3a2f08789a41dfb25b9ecf4e?s=128&d=identicon&r=PG&f=1", "display_name": "demon36", "link": "https://stackoverflow.com/users/3673564/demon36"}, "edited": false, "score": 0, "creation_date": 1515156743, "post_id": 48100203, "comment_id": 83203776, "body": "but looking into the code at Executor.cpp and ThreadTask.cpp it appears that the executor just waits for finishing tasks currently being processed, but worker threads don&#39;t take any more tasks from the queue once m_continue is set to false."}, {"owner": {"reputation": 2519, "user_id": 140311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69d7765491ded8ee7f4059ce5d504d11?s=128&d=identicon&r=PG", "display_name": "Marco M.", "link": "https://stackoverflow.com/users/140311/marco-m"}, "reply_to_user": {"reputation": 177, "user_id": 3673564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aa6106a3a2f08789a41dfb25b9ecf4e?s=128&d=identicon&r=PG&f=1", "display_name": "demon36", "link": "https://stackoverflow.com/users/3673564/demon36"}, "edited": false, "score": 1, "creation_date": 1515251616, "post_id": 48100203, "comment_id": 83233994, "body": "Oh I see what you mean. Unfortunately, there\u2019s no \u201cflush\u201d operation. You should call the Callable version instead. Or use your own synchronization primitives."}], "tags": [], "owner": {"reputation": 2519, "user_id": 140311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69d7765491ded8ee7f4059ce5d504d11?s=128&d=identicon&r=PG", "display_name": "Marco M.", "link": "https://stackoverflow.com/users/140311/marco-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1515085576, "creation_date": 1515085576, "answer_id": 48100203, "question_id": 48080933, "link": "https://stackoverflow.com/questions/48080933/how-to-wait-for-pooledthreadexecutor-to-finish/48100203#48100203", "title": "How to wait for PooledThreadExecutor to finish?", "body": "<p>The destructor of the PooledThreadExecutor will join its threads. Effectively as if you would have used the Callable version and waited till the request returned before exiting. </p>\n"}], "owner": {"reputation": 177, "user_id": 3673564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aa6106a3a2f08789a41dfb25b9ecf4e?s=128&d=identicon&r=PG&f=1", "display_name": "demon36", "link": "https://stackoverflow.com/users/3673564/demon36"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515085576, "creation_date": 1514995440, "question_id": 48080933, "link": "https://stackoverflow.com/questions/48080933/how-to-wait-for-pooledthreadexecutor-to-finish", "title": "How to wait for PooledThreadExecutor to finish?", "body": "<p>Regarding the AWS c++ sdk thread pool feature, is there an elegant way to wait for PooledThreadExecutor to finish all tasks in the queue after calling -for example- getObjectAsync many times ?</p>\n\n<p>Or should I just use getObjectCallable, store references to all future objects in an array, loop the array and wait for each one.</p>\n"}, {"tags": ["c++", "windows", "certificate", "private-key", "cryptoapi"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1514995618, "post_id": 48080919, "comment_id": 83136098, "body": "Lots of reading:  <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa380255(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>    <i>&quot;CryptoAPI is intended for use by developers of Windows-based applications that will enable users to create and exchange documents and other data in a secure environment, especially over nonsecure media such as the Internet. Developers should be familiar with the C and C++ programming languages and the Windows programming environment. Although not required, an understanding of cryptography or security-related subjects is advised.&quot;</i>"}], "answers": [{"comments": [{"owner": {"reputation": 1415, "user_id": 3079834, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/l4Lgy.jpg?s=128&g=1", "display_name": "user3079834", "link": "https://stackoverflow.com/users/3079834/user3079834"}, "edited": false, "score": 0, "creation_date": 1515062855, "post_id": 48091842, "comment_id": 83161627, "body": "Thank you, I&#39;ll have a look into it."}], "tags": [], "owner": {"reputation": 31, "user_id": 5423222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0303aee51477a93dd87e5accda73faa2?s=128&d=identicon&r=PG&f=1", "display_name": "rahul k", "link": "https://stackoverflow.com/users/5423222/rahul-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1515056618, "creation_date": 1515056618, "answer_id": 48091842, "question_id": 48080919, "link": "https://stackoverflow.com/questions/48080919/c-access-trusted-root-certificates/48091842#48091842", "title": "C++ access trusted root certificates", "body": "<p>Yes it is possible to access the private key.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa376050(v=vs.85).aspx\" rel=\"nofollow noreferrer\">CertEnumCertificatesInStore</a> returns <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa377189(v=vs.85).aspx\" rel=\"nofollow noreferrer\">PCCERT_CONTEXT </a> structure which contain the encoded and decoded representations of certificates. Passing this structure to the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa379885(v=vs.85).aspx\" rel=\"nofollow noreferrer\">CryptAcquireCertificatePrivateKey</a> obtains the private key from the certificate</p>\n"}], "owner": {"reputation": 1415, "user_id": 3079834, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/l4Lgy.jpg?s=128&g=1", "display_name": "user3079834", "link": "https://stackoverflow.com/users/3079834/user3079834"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1515056618, "creation_date": 1514995402, "last_edit_date": 1515038231, "question_id": 48080919, "link": "https://stackoverflow.com/questions/48080919/c-access-trusted-root-certificates", "title": "C++ access trusted root certificates", "body": "<p>I have created a public/private key pair with openSSL and converted it into a <code>*.pfx</code> file with openSSL. I then imported this file into the <code>Windows Trusted Certificate Store</code>.</p>\n\n<p>I now would like to access the private key from this certificate via c++ code.\nIs this possible? If yes, can you please point me into a direction? I haven't found anything suitable yet.</p>\n"}, {"tags": ["c++", "boost", "number-formatting", "standard-library", "boost-lexicalcast"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1514995319, "post_id": 48080749, "comment_id": 83135924, "body": "Why is it &#39;unfortunate&#39;?"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1514997553, "post_id": 48080749, "comment_id": 83137265, "body": "@SergeyA It&#39;s unfortunate cause I can&#39;t find any documentation on the  exact behavior of <code>boost::lexical_cast</code> and because I don&#39;t want to have to further clutter by continuing to pull in <code>boost</code>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1514997796, "post_id": 48080749, "comment_id": 83137407, "body": "What is exactly the problem with using boost? Obviously project already uses it? Apparently boost lexical cast doesn&#39;t commit to a certain way of string representation, and as such, is prone to be changed across versions."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1514998093, "post_id": 48080749, "comment_id": 83137591, "body": "@SergeyA One of the <i>libraries</i> I use pulls in Boost. (Obviously I can see into the source of this library as I know it uses <code>boost::lexical_cast</code> to do this conversion.) There&#39;s an optimization opportunity for me to do this <code>double</code> to <code>string</code> conversion on my side but the resulting <code>string</code> must be consistent with the <code>string</code> that the library would have generated."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1515015081, "post_id": 48080749, "comment_id": 83145703, "body": "(Depending on the nature of the library, perhaps you can get away with formatting the numbers to string before sharing them. Of course, in many cases that wouldn&#39;t be an option)"}], "answers": [{"comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1515015007, "post_id": 48085309, "comment_id": 83145675, "body": "In the interest of complete overkill, added test cases including NaN, +Inf, -Inf, +0, -0, epsilon and M_PI that <code>assert</code>s that output of <code>mimicked(v)</code> is always identical to <code>boost::lexical_cast&lt;std::string&gt;(v)</code> under all locale combinations."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 1, "creation_date": 1515016792, "post_id": 48085309, "comment_id": 83146430, "body": "Ugh, and it took me that long to even figure out the first thing that you learned &gt;:("}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1515019509, "post_id": 48085309, "comment_id": 83147418, "body": "I made only the assumption about compile-time precision. I like my version as it clocks in &lt;30 LoC and will do exactly the same on <b>all</b> platforms and for <b>all</b> real types."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 1, "creation_date": 1515070562, "post_id": 48085309, "comment_id": 83166176, "body": "I&#39;ve accepted your answer cause it&#39;s fantastic and I wish I could give it more than one upvote. But just for my own understanding what does &quot;&lt;30 LoC&quot; stand for?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1515110554, "post_id": 48085309, "comment_id": 83186352, "body": "So, &quot;less than 30 lines of code&quot; (now that I&#39;m at home at a real keyboard). Cheers!"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 5, "last_activity_date": 1515014880, "last_edit_date": 1515014880, "creation_date": 1515014550, "answer_id": 48085309, "question_id": 48080749, "link": "https://stackoverflow.com/questions/48080749/boosts-lexical-cast-from-double-to-string-precision/48085309#48085309", "title": "Boost&#39;s lexical_cast From double to string Precision", "body": "<p>The boost code ends up here:</p>\n\n<pre><code>            bool shl_real_type(double val, char* begin) {\n                using namespace std;\n                finish = start +\n#if defined(_MSC_VER) &amp;&amp; (_MSC_VER &gt;= 1400) &amp;&amp; !defined(__SGI_STL_PORT) &amp;&amp; !defined(_STLPORT_VERSION)\n                    sprintf_s(begin, CharacterBufferSize,\n#else\n                    sprintf(begin, \n#endif\n                    \"%.*g\", static_cast&lt;int&gt;(boost::detail::lcast_get_precision&lt;double&gt;()), val);\n                return finish &gt; start;\n            }\n</code></pre>\n\n<p>You're in luck since the precision is USUALLY compile-time constant (unless boost configures <code>BOOST_LCAST_NO_COMPILE_TIME_PRECISION</code>).</p>\n\n<p>Simplifying a bit and allowing for conforming, modern standard libraries:</p>\n\n<h2>Mimicking Boost Lexicalcast</h2>\n\n<pre><code>#include &lt;cstdio&gt;\n#include &lt;limits&gt;\n#include &lt;string&gt;\n\nnamespace {\n    template &lt;class T&gt; struct lcast_precision {\n        typedef std::numeric_limits&lt;T&gt; limits;\n\n        static constexpr bool use_default_precision  = !limits::is_specialized || limits::is_exact;\n        static constexpr bool is_specialized_bin     = !use_default_precision &amp;&amp; limits::radix == 2 &amp;&amp; limits::digits &gt; 0;\n\n        static constexpr bool is_specialized_dec     = !use_default_precision &amp;&amp; limits::radix == 10 &amp;&amp; limits::digits10 &gt; 0;\n        static constexpr unsigned int precision_dec  = limits::digits10 + 1U;\n        static constexpr unsigned long precision_bin = 2UL + limits::digits * 30103UL / 100000UL;\n\n        static constexpr unsigned value = is_specialized_bin \n            ? precision_bin \n            : is_specialized_dec? precision_dec : 6;\n    };\n\n    std::string mimicked(double v) {\n        constexpr int prec = static_cast&lt;int&gt;(lcast_precision&lt;double&gt;::value);\n\n        std::string buf(prec+10, ' ');\n        buf.resize(sprintf(&amp;buf[0], \"%.*g\", prec, v));\n        return buf;\n    }\n}\n</code></pre>\n\n<h2>Regression Tests</h2>\n\n<p>To compare the results and check the assumptions:</p>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/d1216d033409d33a\" rel=\"noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;cstdio&gt;\n#include &lt;limits&gt;\n#include &lt;string&gt;\n\nnamespace {\n    template &lt;class T&gt; struct lcast_precision {\n        typedef std::numeric_limits&lt;T&gt; limits;\n\n        static constexpr bool use_default_precision  = !limits::is_specialized || limits::is_exact;\n        static constexpr bool is_specialized_bin     = !use_default_precision &amp;&amp; limits::radix == 2 &amp;&amp; limits::digits &gt; 0;\n\n        static constexpr bool is_specialized_dec     = !use_default_precision &amp;&amp; limits::radix == 10 &amp;&amp; limits::digits10 &gt; 0;\n        static constexpr unsigned int precision_dec  = limits::digits10 + 1U;\n        static constexpr unsigned long precision_bin = 2UL + limits::digits * 30103UL / 100000UL;\n\n        static constexpr unsigned value = is_specialized_bin \n            ? precision_bin \n            : is_specialized_dec? precision_dec : 6;\n    };\n\n    std::string mimicked(double v) {\n        constexpr int prec = static_cast&lt;int&gt;(lcast_precision&lt;double&gt;::value);\n\n        std::string buf(prec+10, ' ');\n        buf.resize(sprintf(&amp;buf[0], \"%.*g\", prec, v));\n        return buf;\n    }\n}\n\n#include &lt;cmath&gt;\n#include &lt;iomanip&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\n#include &lt;boost/lexical_cast.hpp&gt;\n\n#ifdef BOOST_LCAST_NO_COMPILE_TIME_PRECISION\n#error BOOM\n#endif\n\n#define TEST(x)                                                                                                        \\\n    do {                                                                                                               \\\n        std::cout &lt;&lt; std::setw(45) &lt;&lt; #x &lt;&lt; \":\\t\" &lt;&lt; (x) &lt;&lt; \"\\n\";                                                      \\\n    } while (0)\n\nstd::string use_sprintf(double v) {\n    std::string buf(32, ' ');\n    buf.resize(std::sprintf(&amp;buf[0], \"%f\", v));\n    return buf;\n}\n\nvoid tests() {\n    for (double v : {\n            std::numeric_limits&lt;double&gt;::quiet_NaN(),\n            std::numeric_limits&lt;double&gt;::infinity(),\n           -std::numeric_limits&lt;double&gt;::infinity(),\n            0.0,\n           -0.0,\n            std::numeric_limits&lt;double&gt;::epsilon(),\n            M_PI })\n    {\n        TEST(v);\n        TEST(std::to_string(v));\n        TEST(use_sprintf(v));\n        TEST(boost::lexical_cast&lt;std::string&gt;(v));\n        TEST(mimicked(v));\n\n        assert(mimicked(v) == boost::lexical_cast&lt;std::string&gt;(v));\n    }\n}\n\nstatic std::locale DE(\"de_DE.utf8\");\n\nint main() {\n\n    tests();\n\n    std::cout &lt;&lt; \"==== imbue std::cout\\n\";\n    std::cout.imbue(DE);\n\n    tests();\n\n    std::cout &lt;&lt; \"==== override global locale\\n\";\n    std::locale::global(DE);\n\n    tests();\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>                                        v:  nan\n                        std::to_string(v):  nan\n                           use_sprintf(v):  nan\n      boost::lexical_cast&lt;std::string&gt;(v):  nan\n                              mimicked(v):  nan\n                                        v:  inf\n                        std::to_string(v):  inf\n                           use_sprintf(v):  inf\n      boost::lexical_cast&lt;std::string&gt;(v):  inf\n                              mimicked(v):  inf\n                                        v:  -inf\n                        std::to_string(v):  -inf\n                           use_sprintf(v):  -inf\n      boost::lexical_cast&lt;std::string&gt;(v):  -inf\n                              mimicked(v):  -inf\n                                        v:  0\n                        std::to_string(v):  0.000000\n                           use_sprintf(v):  0.000000\n      boost::lexical_cast&lt;std::string&gt;(v):  0\n                              mimicked(v):  0\n                                        v:  -0\n                        std::to_string(v):  -0.000000\n                           use_sprintf(v):  -0.000000\n      boost::lexical_cast&lt;std::string&gt;(v):  -0\n                              mimicked(v):  -0\n                                        v:  2.22045e-16\n                        std::to_string(v):  0.000000\n                           use_sprintf(v):  0.000000\n      boost::lexical_cast&lt;std::string&gt;(v):  2.2204460492503131e-16\n                              mimicked(v):  2.2204460492503131e-16\n                                        v:  3.14159\n                        std::to_string(v):  3.141593\n                           use_sprintf(v):  3.141593\n      boost::lexical_cast&lt;std::string&gt;(v):  3.1415926535897931\n                              mimicked(v):  3.1415926535897931\n==== imbue std::cout\n                                        v:  nan\n                        std::to_string(v):  nan\n                           use_sprintf(v):  nan\n      boost::lexical_cast&lt;std::string&gt;(v):  nan\n                              mimicked(v):  nan\n                                        v:  inf\n                        std::to_string(v):  inf\n                           use_sprintf(v):  inf\n      boost::lexical_cast&lt;std::string&gt;(v):  inf\n                              mimicked(v):  inf\n                                        v:  -inf\n                        std::to_string(v):  -inf\n                           use_sprintf(v):  -inf\n      boost::lexical_cast&lt;std::string&gt;(v):  -inf\n                              mimicked(v):  -inf\n                                        v:  0\n                        std::to_string(v):  0.000000\n                           use_sprintf(v):  0.000000\n      boost::lexical_cast&lt;std::string&gt;(v):  0\n                              mimicked(v):  0\n                                        v:  -0\n                        std::to_string(v):  -0.000000\n                           use_sprintf(v):  -0.000000\n      boost::lexical_cast&lt;std::string&gt;(v):  -0\n                              mimicked(v):  -0\n                                        v:  2,22045e-16\n                        std::to_string(v):  0.000000\n                           use_sprintf(v):  0.000000\n      boost::lexical_cast&lt;std::string&gt;(v):  2.2204460492503131e-16\n                              mimicked(v):  2.2204460492503131e-16\n                                        v:  3,14159\n                        std::to_string(v):  3.141593\n                           use_sprintf(v):  3.141593\n      boost::lexical_cast&lt;std::string&gt;(v):  3.1415926535897931\n                              mimicked(v):  3.1415926535897931\n==== override global locale\n                                        v:  nan\n                        std::to_string(v):  nan\n                           use_sprintf(v):  nan\n      boost::lexical_cast&lt;std::string&gt;(v):  nan\n                              mimicked(v):  nan\n                                        v:  inf\n                        std::to_string(v):  inf\n                           use_sprintf(v):  inf\n      boost::lexical_cast&lt;std::string&gt;(v):  inf\n                              mimicked(v):  inf\n                                        v:  -inf\n                        std::to_string(v):  -inf\n                           use_sprintf(v):  -inf\n      boost::lexical_cast&lt;std::string&gt;(v):  -inf\n                              mimicked(v):  -inf\n                                        v:  0\n                        std::to_string(v):  0,000000\n                           use_sprintf(v):  0,000000\n      boost::lexical_cast&lt;std::string&gt;(v):  0\n                              mimicked(v):  0\n                                        v:  -0\n                        std::to_string(v):  -0,000000\n                           use_sprintf(v):  -0,000000\n      boost::lexical_cast&lt;std::string&gt;(v):  -0\n                              mimicked(v):  -0\n                                        v:  2,22045e-16\n                        std::to_string(v):  0,000000\n                           use_sprintf(v):  0,000000\n      boost::lexical_cast&lt;std::string&gt;(v):  2,2204460492503131e-16\n                              mimicked(v):  2,2204460492503131e-16\n                                        v:  3,14159\n                        std::to_string(v):  3,141593\n                           use_sprintf(v):  3,141593\n      boost::lexical_cast&lt;std::string&gt;(v):  3,1415926535897931\n                              mimicked(v):  3,1415926535897931\n</code></pre>\n\n<p>Note that <code>mimicked</code> and <code>boost::lexical_cast&lt;std::string&gt;(double)</code> result in exactly the same output each time.</p>\n"}, {"comments": [{"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1515016745, "post_id": 48085746, "comment_id": 83146413, "body": "Lessons learned, never use Boost, always use C++ standard functionality."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1515017741, "post_id": 48085746, "comment_id": 83146793, "body": "Yes this is a nice analysis. Have an upvote. and yes, I\u2019ll delete my answer. Although I do believe Boost has its uses: spirit is excellent, as is BLAS, and the date libraries. But yes, adopt stuff as it appears in the standard."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1515019357, "post_id": 48085746, "comment_id": 83147373, "body": "My take: Always use Boost, but don&#39;t treat it as a silver bullet. If you need to know what you&#39;re doing, make sure you know how you do it. It&#39;s always like that: companies should never outsource their core business, e.g."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1515070376, "post_id": 48085746, "comment_id": 83166057, "body": "@Bathsheba I regret to say that I agree that spirit is an exception, and apparently I need to read up on whatever BLAS is. As far as dates I&#39;d strongly suggest Howard Hinnant&#39;s library which has been propsed for addition to the standard: <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0355r4.html\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0355r4.html</a>"}], "tags": [], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "is_accepted": false, "score": 4, "last_activity_date": 1515016702, "creation_date": 1515016702, "answer_id": 48085746, "question_id": 48080749, "link": "https://stackoverflow.com/questions/48080749/boosts-lexical-cast-from-double-to-string-precision/48085746#48085746", "title": "Boost&#39;s lexical_cast From double to string Precision", "body": "<p>So after a few hours of digging around in Boost templates here's what I've learned:</p>\n\n<ol>\n<li>The actual call that does the stringifying is: <code>lexical_cast_do_cast&lt;std::string, double&gt;::lexical_cast_impl</code></li>\n<li>This uses <code>std::sprintf</code> within <code>boost::detail::lexical_stream_limited_src&lt;char, std::char_traits&lt;char&gt;, false&gt;</code></li>\n<li><code>boost::detail::lexical_stream_limited_src&lt;char, std::char_traits&lt;char&gt;, true&gt;::operator&lt;&lt;</code> will be used to insert the <code>double</code>, passing <code>begin</code>, the pointer to an allocated <code>std::string</code>'s buffer, and <code>val</code>, the input <code>double</code>, yields this call: <code>std::sprintf(begin, \"%.*g\", static_cast&lt;int&gt;(boost::detail::lcast_get_precision&lt;double&gt;()), val)</code></li>\n<li>So the precision field here comes from <code>boost::details::lcast_precision&lt;double&gt;::value</code>, which, will use <code>std::numeric_limits&lt;double&gt;</code>; if it's <code>is_specialized</code> is <code>false</code>, <code>is_exact</code> is <code>false</code>, <code>radix</code> is <code>2</code>, and <code>digits</code> is greater than <code>0</code> then <code>boost::details::lcast_precision&lt;double&gt;::value</code> will evaluate to: <code>2UL + std::numeric_limits&lt;double&gt;::digits * 30103UL / 100000UL</code></li>\n</ol>\n\n<p>Thus where <code>begin</code> is the allocated <code>string</code> and <code>val</code> is the input double, \n <code>boost::lexical_cast&lt;double&gt;</code> yields a final result the equivalent of:</p>\n\n<pre><code>std::sprintf(begin, \"%.*g\", 2UL + std::numeric_limits&lt;double&gt;::digits * 30103UL / 100000UL, val)\n</code></pre>\n\n<p>This is obviously heavily implementation dependent. But on my system this will yield the exact equivalent.</p>\n"}], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 873, "favorite_count": 1, "accepted_answer_id": 48085309, "answer_count": 2, "score": 4, "last_activity_date": 1515016702, "creation_date": 1514994784, "last_edit_date": 1515015164, "question_id": 48080749, "link": "https://stackoverflow.com/questions/48080749/boosts-lexical-cast-from-double-to-string-precision", "title": "Boost&#39;s lexical_cast From double to string Precision", "body": "<p>I'm working with a library that unfortunately uses <code>boost::lexical_cast</code> to convert from a <code>double</code> to a <code>string</code>.</p>\n\n<p>I need to be able to definitively mirror that behavior on my side, but I was hopping to do so without propagating <code>boost</code>.</p>\n\n<p>Could I be guaranteed identical behavior using <code>to_string</code>, <code>sprintf</code>, or some other function contained within the standard?</p>\n"}, {"tags": ["c++", "bmp", "fgetc"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1514994668, "post_id": 48080637, "comment_id": 83135560, "body": "Since you&#39;re using C++ it&#39;s very odd to be using the C <code>fopen</code> type methods. Streams can do everything you&#39;ve done here."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1514995407, "post_id": 48080637, "comment_id": 83135983, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/164002/why-is-fread-reaching-the-eof-early\">Why is fread reaching the EOF early?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9163538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4afa5536db8e859d5593827254253d5c?s=128&d=identicon&r=PG&f=1", "display_name": "sFyX67v7Ia1XDGFU", "link": "https://stackoverflow.com/users/9163538/sfyx67v7ia1xdgfu"}, "edited": false, "score": 0, "creation_date": 1514994832, "post_id": 48080659, "comment_id": 83135656, "body": "its always these simple, subtle mistakes that can drive you up the wall, thanks for the help. I&#39;ll accept the answer as soon as i can."}], "tags": [], "owner": {"reputation": 7970, "user_id": 4117097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lrdeC.jpg?s=128&g=1", "display_name": "Anton Malyshev", "link": "https://stackoverflow.com/users/4117097/anton-malyshev"}, "is_accepted": true, "score": 2, "last_activity_date": 1514994449, "creation_date": 1514994449, "answer_id": 48080659, "question_id": 48080637, "link": "https://stackoverflow.com/questions/48080637/c-trouble-reading-bmp-files-end-of-file-reached-earlier-than-expected/48080659#48080659", "title": "C++: Trouble reading .BMP files; end of file reached earlier than expected", "body": "<p>Change </p>\n\n<pre><code>FILE* file = fopen(\"C:/Path/to/file\", \"r\");\n</code></pre>\n\n<p>to</p>\n\n<pre><code>FILE* file = fopen(\"C:/Path/to/file\", \"rb\");\n</code></pre>\n\n<p>to read the file in binary mode. That usually helps to avoid such strange errors.</p>\n"}, {"tags": [], "owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "is_accepted": false, "score": 3, "last_activity_date": 1514995185, "last_edit_date": 1514995185, "creation_date": 1514994728, "answer_id": 48080733, "question_id": 48080637, "link": "https://stackoverflow.com/questions/48080637/c-trouble-reading-bmp-files-end-of-file-reached-earlier-than-expected/48080733#48080733", "title": "C++: Trouble reading .BMP files; end of file reached earlier than expected", "body": "<p>Reading a file in plain \"r\" mode on DOS/Windows may treat ASCII 26 (^Z) as \"end of file\". It may also convert line endings from CR LF (13 10) to LF (10), which you also don't want.</p>\n\n<p>Looking at your sample file, I do indeed see that character (it's <code>1A</code> in hex):</p>\n\n<pre><code>0000340 0c 1f 15 0e 1f 15 0e 1f 14 10 1f 14 10 21 17 10\n0000360 21 17 10 22 18 11 23 19 12 25 19 13 26[1a]14 26\n</code></pre>\n\n<p>The position is 375 octal, which is 253 decimal. Sound familiar? :)</p>\n\n<p>Use \"rb\":</p>\n\n<pre><code>FILE* file = fopen(\"C:/Path/to/file\", \"rb\");\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9163538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4afa5536db8e859d5593827254253d5c?s=128&d=identicon&r=PG&f=1", "display_name": "sFyX67v7Ia1XDGFU", "link": "https://stackoverflow.com/users/9163538/sfyx67v7ia1xdgfu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 48080659, "answer_count": 2, "score": 0, "last_activity_date": 1514995185, "creation_date": 1514994338, "question_id": 48080637, "link": "https://stackoverflow.com/questions/48080637/c-trouble-reading-bmp-files-end-of-file-reached-earlier-than-expected", "title": "C++: Trouble reading .BMP files; end of file reached earlier than expected", "body": "<p>i am currently trying to read .BMP files using C++, but somehow after reading a few bytes the end of the file is reached (<code>fgetc()</code> returns <code>-1</code>). I've reduced the problem to a minimal example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main()\n{\n    // Open file\n    FILE* file = fopen(\"C:/Path/to/file\", \"r\");\n\n    // Get and print file size in bytes\n    fseek(file, 0L, SEEK_END);\n    std::cout &lt;&lt; ftell(file) &lt;&lt; std::endl;\n    rewind(file);\n\n    int byte, i = 0;\n    do\n    {\n        // Get each byte\n        byte = fgetc(file);\n        // Print i and value of byte\n        std::cout &lt;&lt; i &lt;&lt; \", \" &lt;&lt; byte &lt;&lt; std::endl;\n        i++;\n    }\n    // Stop reading when end of file is reached\n    while (byte != EOF);\n\n    std::cin.get();\n\n    return 0;\n}\n</code></pre>\n\n<p>When using this to read .BMP files (problem does not occur on simple formats like .txt files), It reads the file length correctly, but finds the EOF way before reaching the end of the file.</p>\n\n<p>For example, using <a href=\"https://ufile.io/vq3m9\" rel=\"nofollow noreferrer\">this file</a>, it reads a file length of 120054, but <code>fgetc()</code> returns <code>-1</code> at i=253.</p>\n\n<p>What exactly am i doing wrong, and how can i fix this problem?</p>\n"}, {"tags": ["c++", "arrays", "templates", "alias"], "comments": [{"owner": {"reputation": 728, "user_id": 4628444, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-S_tKKQ1s_PY/AAAAAAAAAAI/AAAAAAAAHU8/ph4sOcIgi0w/photo.jpg?sz=128", "display_name": "JoshKisb", "link": "https://stackoverflow.com/users/4628444/joshkisb"}, "edited": false, "score": 2, "creation_date": 1514992594, "post_id": 48080120, "comment_id": 83134311, "body": "You can define x, y, z and w explicitly in the class and override the square brackets operators to return x, y, z or w depending on the number/index given"}, {"owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 0, "creation_date": 1514992680, "post_id": 48080120, "comment_id": 83134364, "body": "why not use a wrapper for the vector"}, {"owner": {"reputation": 1632, "user_id": 7462657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/da6cde7de38cf0b6686e85193273b12f?s=128&d=identicon&r=PG&f=1", "display_name": "xander", "link": "https://stackoverflow.com/users/7462657/xander"}, "reply_to_user": {"reputation": 728, "user_id": 4628444, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-S_tKKQ1s_PY/AAAAAAAAAAI/AAAAAAAAHU8/ph4sOcIgi0w/photo.jpg?sz=128", "display_name": "JoshKisb", "link": "https://stackoverflow.com/users/4628444/joshkisb"}, "edited": false, "score": 0, "creation_date": 1514992727, "post_id": 48080120, "comment_id": 83134382, "body": "@JoshKisb yes but with that trick you can&#39;t assign something to v.x and copy the value to the internal vector [0]."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1514992740, "post_id": 48080120, "comment_id": 83134395, "body": "<code>Vector&lt;int, 4&gt; v();</code> declares a function names <code>v</code> with no arguments and that returns a <code>Vector&lt;int, 4&gt;</code>."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1514992761, "post_id": 48080120, "comment_id": 83134414, "body": "The last attempt idea with the references was the right way I think, but your syntax is wrong"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1514992916, "post_id": 48080120, "comment_id": 83134508, "body": "Completely unclear what is your goal. Array access is indexed, why do you need member variable access for it?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1514993313, "post_id": 48080120, "comment_id": 83134742, "body": "If all of the clients using this code know what a <code>Vector&lt;int, 4&gt; v;</code> is, why would you introduce another unknown syntax on them to now have to learn?  They would know quite well that <code>v</code> is accessed via array indexing, not by using <code>.x</code> or <code>.y</code>, etc."}, {"owner": {"reputation": 1632, "user_id": 7462657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/da6cde7de38cf0b6686e85193273b12f?s=128&d=identicon&r=PG&f=1", "display_name": "xander", "link": "https://stackoverflow.com/users/7462657/xander"}, "edited": false, "score": 1, "creation_date": 1514993433, "post_id": 48080120, "comment_id": 83134819, "body": "I suggest you read how to emulate properties in C++ using unnamed classes (like C# property syntax): <a href=\"https://en.wikipedia.org/wiki/Property_%28programming%29#C++\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Property_%28programming%29#C++</a>"}, {"owner": {"reputation": 173, "user_id": 7997500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d276cd9d95bb7d38aec482f859ae74f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Modvig", "link": "https://stackoverflow.com/users/7997500/jens-modvig"}, "edited": false, "score": 0, "creation_date": 1514993451, "post_id": 48080120, "comment_id": 83134834, "body": "For clarity: The Vector class has nothing to do with std::vector it is a mathematical vector of fixed size that is used for performing math, I just didn&#39;t include a lot of the methods for simplicity"}, {"owner": {"reputation": 5334, "user_id": 8631381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMqAd.png?s=128&g=1", "display_name": "Massimiliano Janes", "link": "https://stackoverflow.com/users/8631381/massimiliano-janes"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 6, "creation_date": 1514993658, "post_id": 48080120, "comment_id": 83134964, "body": "@SergeyA &amp; PaulMcKenzie in some contexts (eg.math,graphics) vectors have idiomatic naming for the first few dimensions (xyzw,rgba,uvst...); when supported (eg. Eigen fixed vectors .x() accessors, glsl swizzles,...) they do improve code readability and usability over bare indices IMO ..."}, {"owner": {"reputation": 4795, "user_id": 683905, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7bc5b9f8f9c6f0e5d25b2d88e2cc1386?s=128&d=identicon&r=PG", "display_name": "Jaa-c", "link": "https://stackoverflow.com/users/683905/jaa-c"}, "edited": false, "score": 0, "creation_date": 1515002468, "post_id": 48080120, "comment_id": 83139893, "body": "You can check glm library, which does exactly that for it&#39;s glm::vec class. They have alias for xyzw, rgba, uvst... <a href=\"https://github.com/g-truc/glm/blob/master/glm/detail/type_vec4.hpp\" rel=\"nofollow noreferrer\">github.com/g-truc/glm/blob/master/glm/detail/type_vec4.hpp</a>"}], "answers": [{"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 4, "creation_date": 1514996952, "post_id": 48081339, "comment_id": 83136886, "body": "<code>return (&amp;x)[i]</code> is UB for i greater than 0. You can only use pointer arithmetic within arrays. Using a <code>switch</code> block would work though."}, {"owner": {"reputation": 930, "user_id": 8951473, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UTexO-HsNuo/AAAAAAAAAAI/AAAAAAAAAEg/tiZWCUU3W8w/photo.jpg?sz=128", "display_name": "oisyn", "link": "https://stackoverflow.com/users/8951473/oisyn"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1514998172, "post_id": 48081339, "comment_id": 83137626, "body": "@Bathsheba Are you sure? Isn&#39;t an array layout-compatible with a struct containing the same elements as different variables?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 3, "creation_date": 1514998225, "post_id": 48081339, "comment_id": 83137653, "body": "I&#39;m absolutely certain of this."}, {"owner": {"reputation": 930, "user_id": 8951473, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UTexO-HsNuo/AAAAAAAAAAI/AAAAAAAAAEg/tiZWCUU3W8w/photo.jpg?sz=128", "display_name": "oisyn", "link": "https://stackoverflow.com/users/8951473/oisyn"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1514998359, "post_id": 48081339, "comment_id": 83137729, "body": "@Bathsheba Well in that case, the code certainly isn&#39;t portible, but it&#39;ll still work on all major well-know platforms."}, {"owner": {"reputation": 173, "user_id": 7997500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d276cd9d95bb7d38aec482f859ae74f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Modvig", "link": "https://stackoverflow.com/users/7997500/jens-modvig"}, "edited": false, "score": 0, "creation_date": 1515000183, "post_id": 48081339, "comment_id": 83138718, "body": "Looking very good it just takes some time for me to implement it, if it works I  accept it :) But looking at it should!"}, {"owner": {"reputation": 930, "user_id": 8951473, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UTexO-HsNuo/AAAAAAAAAAI/AAAAAAAAAEg/tiZWCUU3W8w/photo.jpg?sz=128", "display_name": "oisyn", "link": "https://stackoverflow.com/users/8951473/oisyn"}, "reply_to_user": {"reputation": 173, "user_id": 7997500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d276cd9d95bb7d38aec482f859ae74f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Modvig", "link": "https://stackoverflow.com/users/7997500/jens-modvig"}, "edited": false, "score": 0, "creation_date": 1515002197, "post_id": 48081339, "comment_id": 83139769, "body": "@JensModvig I&#39;ve edited my post. Bathsheba is correct in pointing out that this might not work on your implementation as expected. Although I would be very surprised if you managed to find a commonly used platform on which this doesn&#39;t work, it is something to be aware of :)."}, {"owner": {"reputation": 173, "user_id": 7997500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d276cd9d95bb7d38aec482f859ae74f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Modvig", "link": "https://stackoverflow.com/users/7997500/jens-modvig"}, "edited": false, "score": 0, "creation_date": 1515002317, "post_id": 48081339, "comment_id": 83139830, "body": "@oisyn I noticed, even before you edited the code ;) But ye, it is still the best answer, not optimal but very good"}, {"owner": {"reputation": 173, "user_id": 7997500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d276cd9d95bb7d38aec482f859ae74f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Modvig", "link": "https://stackoverflow.com/users/7997500/jens-modvig"}, "edited": false, "score": 0, "creation_date": 1515020641, "post_id": 48081339, "comment_id": 83147778, "body": "@oisyn After going through about 1000 lines of code I finally got it implemented and it works like a charm, thank you very much, does exactly what I requested :)"}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 2, "creation_date": 1515079439, "post_id": 48081339, "comment_id": 83171702, "body": "&quot;In practice this is fine and doing it this way is way more performant.&quot; It is <b>not</b> fine. It might appear to work for you but it is UB and you&#39;re liable to get unwanted behaviour at some point, it might &quot;work&quot; 99% of the time but give a mysterious and hard-to-debug problem the other 1%, it might appear to work but stop working when you change compiler version, etc. Do not suggest this. It is bad."}], "tags": [], "owner": {"reputation": 930, "user_id": 8951473, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UTexO-HsNuo/AAAAAAAAAAI/AAAAAAAAAEg/tiZWCUU3W8w/photo.jpg?sz=128", "display_name": "oisyn", "link": "https://stackoverflow.com/users/8951473/oisyn"}, "is_accepted": false, "score": -3, "last_activity_date": 1515077816, "last_edit_date": 1515077816, "creation_date": 1514996906, "answer_id": 48081339, "question_id": 48080120, "link": "https://stackoverflow.com/questions/48080120/c-alias-for-an-array-element/48081339#48081339", "title": "c++ Alias for an array element", "body": "<p>You could do something like:</p>\n\n<pre><code>// General case uses an array\ntemplate&lt;class T, std::size_t N&gt;\nclass VectorData\n{\nprivate:\n    T m_data[N];\n\npublic:\n    T&amp; operator[](int i) { return m_data[i]; }\n    const T&amp; operator[](int i) const { return m_data[i]; }\n};\n\n// Specializations for various N (4 shown here)\ntemplate&lt;class T&gt;\nclass VectorData&lt;T, 4&gt;\n{\npublic:\n    T x, y, z, w;\n\n    T&amp; operator[](int i) { return (&amp;x)[i]; }  // WARNING, see note below\n    const T&amp; operator[](int i) const { return (&amp;x)[i]; }\n};\n\n\ntemplate&lt;class T, std::size_t N&gt;\nstruct Vector : public VectorData&lt;T, N&gt;\n{\n    // your other Vector stuff here\n};\n</code></pre>\n\n<p><strong>Note</strong>: As one of the commenters below correctly pointed out, this assumes that array elements are layed out in memory exactly the same as a list of variables (iow, <code>T[4]</code> and <code>struct { T x,y,z,w; }</code> are layout-compatible) for the <code>&amp;x[i]</code> part to work. The standard doesn't guarantee this, and therefore this code will yield undefined behavior. In practice this is fine and doing it this way is way more performant. If you need a portable, standard compliant implementation, you could opt to use a <code>switch</code> within <code>VectorData::operator[]</code>, as another answer suggested. The difference in code generated can be seen <a href=\"https://godbolt.org/g/Hn3bb3\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>If you really need Vector to derive from Matrix, something like this is still possible. The general idea is just that you decouple storage and functionality. You could create some generic Matrix class with all functionality, which has an extra template parameter for its storage. A Vector could then just supply its own storage type.</p>\n\n<p>Something like:</p>\n\n<pre><code>// Generic matrix storage\ntemplate&lt;class T, std::size_t N&gt;\nclass MatrixData\n{\nprivate:\n    T m_data[N];\n\npublic:\n    T&amp; operator[](int i) { return m_data[i]; }\n    const T&amp; operator[](int i) const { return m_data[i]; }\n};\n\n// Generic matrix class\ntemplate&lt;class T, std::size_t ROWS, std::size_t COLS, class Storage = MatrixData&lt;T, ROWS*COLS&gt;&gt;\nclass Matrix : public Storage\n{\n    // Matrix functionality here\n};\n\n\n\n// Specialized storage for Vectors, generic version\ntemplate&lt;class T, std::size_t N&gt;\nclass VectorData : public MatrixData&lt;T, N&gt; { };\n\n// Specialized storage for Vector&lt;T, 4&gt;\ntemplate&lt;class T&gt;\nclass VectorData&lt;T, 4&gt;\n{\npublic:\n    T x, y, z, w;\n\n    T&amp; operator[](int i) { return (&amp;x)[i]; }\n    const T&amp; operator[](int i) const { return (&amp;x)[i]; }\n};\n\ntemplate&lt;class T, std::size_t N&gt;\nstruct Vector : public Matrix&lt;T, N, 1, VectorData&lt;T, N&gt;&gt;\n{\n    // your other stuff here\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 930, "user_id": 8951473, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UTexO-HsNuo/AAAAAAAAAAI/AAAAAAAAAEg/tiZWCUU3W8w/photo.jpg?sz=128", "display_name": "oisyn", "link": "https://stackoverflow.com/users/8951473/oisyn"}, "edited": false, "score": 1, "creation_date": 1514998811, "post_id": 48081819, "comment_id": 83137965, "body": "That&#39;s basically what I suggested, but rather than using a switch I was using  some not well-defined pointer arithmetic. And in a comment on my answer someone mentions using a switch. So not sure why you said it wasn&#39;t suggested yet :)"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 930, "user_id": 8951473, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UTexO-HsNuo/AAAAAAAAAAI/AAAAAAAAAEg/tiZWCUU3W8w/photo.jpg?sz=128", "display_name": "oisyn", "link": "https://stackoverflow.com/users/8951473/oisyn"}, "edited": false, "score": 0, "creation_date": 1514999081, "post_id": 48081819, "comment_id": 83138106, "body": "@oisyn Didn&#39;t notice that comment first. :)"}], "tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": false, "score": 2, "last_activity_date": 1514999055, "last_edit_date": 1514999055, "creation_date": 1514998724, "answer_id": 48081819, "question_id": 48080120, "link": "https://stackoverflow.com/questions/48080120/c-alias-for-an-array-element/48081819#48081819", "title": "c++ Alias for an array element", "body": "<p>This:</p>\n\n<pre><code>template &lt;typename T, int D&gt; struct Vec;\n\n// You have to manually specialize for all needed sizes\ntemplate &lt;typename T&gt; struct Vec&lt;T, 4&gt;\n{\n    T x, y, z, w;\n\n    T &amp;operator[](int index)\n    {\n        switch (index)\n        {\n            default: // throw or something?\n            case 0: return x;\n            case 1: return y;\n            case 2: return z;\n            case 3: return w;\n        }\n    }\n    const T &amp;operator[](int index) const\n    {\n        switch (index)\n        {\n            default: // throw or something?\n            case 0: return x;\n            case 1: return y;\n            case 2: return z;\n            case 3: return w;\n        }\n    }\n};\n</code></pre>\n\n<p>The <code>switch</code>ing on index is not optimal, but at least it's well-defined.</p>\n\n<p>For matrices I prefer to use <code>Vec&lt;Vec&lt;T, Height&gt;, Width&gt;</code>, which makes <code>mat[x][y]</code> notation work. (Swap <code>x</code> and <code>y</code> if you want to.)</p>\n"}, {"comments": [{"owner": {"reputation": 930, "user_id": 8951473, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UTexO-HsNuo/AAAAAAAAAAI/AAAAAAAAAEg/tiZWCUU3W8w/photo.jpg?sz=128", "display_name": "oisyn", "link": "https://stackoverflow.com/users/8951473/oisyn"}, "edited": false, "score": 3, "creation_date": 1515014473, "post_id": 48083972, "comment_id": 83145462, "body": "A similar answer had been posted before (but less generic) which has already been deleted. The issue with references is that it makes the object needlessly big as every reference effectively stores a pointer. This also means that accessing such a member dereferences such a pointer. Also, it is no longer copyable by default."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 930, "user_id": 8951473, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UTexO-HsNuo/AAAAAAAAAAI/AAAAAAAAAEg/tiZWCUU3W8w/photo.jpg?sz=128", "display_name": "oisyn", "link": "https://stackoverflow.com/users/8951473/oisyn"}, "edited": false, "score": 0, "creation_date": 1515178034, "post_id": 48083972, "comment_id": 83215429, "body": "@oisyn - given the unusual problem, I don&#39;t see the bigger size of the struct or the overhead dereferencing a pointer as a great problem. I know that you have proposed a smaller (and, in a sense, intriguing, IMHO) solution; but (as far I understand) is UB so (ever IMHO) I think my solution maintain a sort of interest. Anyway you&#39;re right about the copyable part: it&#39;s a problem. I have to explain this in my answer. Thanks for pointing it."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 1, "last_activity_date": 1515009553, "last_edit_date": 1515009553, "creation_date": 1515007887, "answer_id": 48083972, "question_id": 48080120, "link": "https://stackoverflow.com/questions/48080120/c-alias-for-an-array-element/48083972#48083972", "title": "c++ Alias for an array element", "body": "<p>If you accept a C++14 solution, I propose the creation of a template indexed wrapper for <code>x</code>, <code>y</code>, <code>z</code> and <code>w</code>, referenced to <code>T</code> variables</p>\n\n<pre><code>template &lt;typename T, std::size_t&gt;\nstruct wrapper\n { wrapper (T const &amp;) {} };\n\ntemplate &lt;typename T&gt;\nstruct wrapper&lt;T, 0U&gt;\n { T &amp; x; };\n\ntemplate &lt;typename T&gt;\nstruct wrapper&lt;T, 1U&gt;\n { T &amp; y; };\n\ntemplate &lt;typename T&gt;\nstruct wrapper&lt;T, 2U&gt;\n { T &amp; z; };\n\ntemplate &lt;typename T&gt;\nstruct wrapper&lt;T, 3U&gt;\n { T &amp; w; };\n</code></pre>\n\n<p>Next an <code>std::array</code> wrapper that has to be inherited <strong>before</strong> the indexed wrappers</p>\n\n<pre><code>template &lt;typename T, std::size_t N&gt;\nstruct arrayWrp\n { std::array&lt;T, N&gt; arr {}; };\n</code></pre>\n\n<p>Now you can define an helper <code>struct VecH</code> as follows</p>\n\n<pre><code>template &lt;typename T, std::size_t ... Is&gt;\nstruct VecH&lt;T, std::index_sequence&lt;Is...&gt;&gt;\n   : public arrayWrp&lt;T, sizeof...(Is)&gt;, public wrapper&lt;T, Is&gt;...\n {\n   using arrayWrp&lt;T, sizeof...(Is)&gt;::arr;\n\n   VecH () : arrayWrp&lt;T, sizeof...(Is)&gt;{}, wrapper&lt;T, Is&gt;{ arr[Is] }...\n    { }\n\n   T &amp; operator[] (std::size_t i)\n    { return arr[i]; }\n\n   T const &amp; operator[] (std::size_t i) const\n    { return arr[i]; }\n };\n</code></pre>\n\n<p>that inherit from <code>arrayWrp</code> and from all <code>wrapper&lt;T, Is&gt;</code> needed and that link references <code>x</code>, <code>y</code>, <code>z</code> and <code>w</code> to <code>arr[0]</code>, <code>arr[1]</code>, <code>arr[2]</code> and <code>arr[3]</code> rispectively</p>\n\n<p>So <code>Vec</code> become</p>\n\n<pre><code>template &lt;typename T, std::size_t N&gt;\nstruct Vec : public VecH&lt;T, std::make_index_sequence&lt;N&gt;&gt;\n { };\n</code></pre>\n\n<p>The following is a full working example</p>\n\n<pre><code>#include &lt;array&gt;\n#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\ntemplate &lt;typename T, std::size_t&gt;\nstruct wrapper\n { wrapper (T const &amp;) {} };\n\ntemplate &lt;typename T&gt;\nstruct wrapper&lt;T, 0U&gt;\n { T &amp; x; };\n\ntemplate &lt;typename T&gt;\nstruct wrapper&lt;T, 1U&gt;\n { T &amp; y; };\n\ntemplate &lt;typename T&gt;\nstruct wrapper&lt;T, 2U&gt;\n { T &amp; z; };\n\ntemplate &lt;typename T&gt;\nstruct wrapper&lt;T, 3U&gt;\n { T &amp; w; };\n\ntemplate &lt;typename T, std::size_t N&gt;\nstruct arrayWrp\n { std::array&lt;T, N&gt; arr {}; };\n\ntemplate &lt;typename, typename&gt;\nstruct VecH;\n\ntemplate &lt;typename T, std::size_t ... Is&gt;\nstruct VecH&lt;T, std::index_sequence&lt;Is...&gt;&gt;\n   : public arrayWrp&lt;T, sizeof...(Is)&gt;, public wrapper&lt;T, Is&gt;...\n {\n   using arrayWrp&lt;T, sizeof...(Is)&gt;::arr;\n\n   VecH () : arrayWrp&lt;T, sizeof...(Is)&gt;{}, wrapper&lt;T, Is&gt;{ arr[Is] }...\n    { }\n\n   T &amp; operator[] (std::size_t i)\n    { return arr[i]; }\n\n   T const &amp; operator[] (std::size_t i) const\n    { return arr[i]; }\n };\n\ntemplate &lt;typename T, std::size_t N&gt;\nstruct Vec : public VecH&lt;T, std::make_index_sequence&lt;N&gt;&gt;\n { };\n\nint main ()\n { \n   Vec&lt;int, 4U&gt;  v4;\n\n   v4.x = 1;\n   v4.y = 2;\n   v4.z = 3;\n   v4.w = 4;\n\n   std::cout &lt;&lt; \"v4: \";\n\n   for ( auto ui = 0U ; ui &lt; 4U ; ++ui )\n      std::cout &lt;&lt; ' ' &lt;&lt; v4[ui];\n\n   std::cout &lt;&lt; std::endl;\n\n   Vec&lt;int, 5U&gt;  v5;  // also over 4\n\n   Vec&lt;int, 3U&gt;  v3;\n\n   v3.x = 10;\n   v3.y = 20;\n   v3.z = 30;\n   // v3.w = 40;  // compilation error\n\n }\n</code></pre>\n\n<p>If you don't like the use of the <code>VecH</code> helper <code>struct</code>, you can use partial specialization and a template parameter defaulted to <code>std::make_index_sequence&lt;N&gt;</code> as follows</p>\n\n<pre><code>template &lt;typename, std::size_t N, typename = std::make_index_sequence&lt;N&gt;&gt;\nstruct Vec;\n\ntemplate &lt;typename T, std::size_t N, std::size_t ... Is&gt;\nstruct Vec&lt;T, N, std::index_sequence&lt;Is...&gt;&gt;\n   : public arrayWrp&lt;T, N&gt;, public wrapper&lt;T, Is&gt;...\n {\n   using arrayWrp&lt;T, sizeof...(Is)&gt;::arr;\n\n   Vec () : arrayWrp&lt;T, sizeof...(Is)&gt;{}, wrapper&lt;T, Is&gt;{ arr[Is] }...\n    { }\n\n   T &amp; operator[] (std::size_t i)\n    { return arr[i]; }\n\n   T const &amp; operator[] (std::size_t i) const\n    { return arr[i]; }\n };\n</code></pre>\n\n<p>but I don't know if it's a good idea: someone could try to use <code>Vec</code> as follows</p>\n\n<pre><code>Vec&lt;int, 3U, std::index_sequence&lt;0, 2, 5&gt;&gt;  v;\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 7997500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d276cd9d95bb7d38aec482f859ae74f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Modvig", "link": "https://stackoverflow.com/users/7997500/jens-modvig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1684, "favorite_count": 0, "answer_count": 3, "score": 8, "last_activity_date": 1515077816, "creation_date": 1514992336, "last_edit_date": 1515011789, "question_id": 48080120, "link": "https://stackoverflow.com/questions/48080120/c-alias-for-an-array-element", "title": "c++ Alias for an array element", "body": "<p>I have a (column) Vector class which contains an array of values that can be accessed like:</p>\n\n<pre><code>Vec&lt;int, 4&gt; v();\nv[0] = -2; // &lt;- set first value to -2\nv[1] = 1; // &lt;- set second value to 1\n....\n</code></pre>\n\n<p>But here is my question: How do i create an alias for <code>v[0], v[1], v[2], v[3]</code>?. I would like to define the first 4 values as <code>v.x, v.y, v.z, v.w</code>:</p>\n\n<pre><code>Vec&lt;int, 4&gt; v();\nv.x = -2; // &lt;- set first value to -2\nv.y = 1; // &lt;- set second value to 1\nv.z = 4; // &lt;- set third value to 4\nv.w = 2; // &lt;- set fourth value to 2\n</code></pre>\n\n<p>I should be able to <strong>assign</strong> and <strong>read</strong> the values, and I don't want them to be looking like a function, so accessing the first value like:</p>\n\n<pre><code>Vec&lt;int, 4&gt; v();\nv.x() = -2; // &lt;- set first value to -2\n</code></pre>\n\n<p>Is no good. On top of that the vector class is templated and x should only be defined for <code>dimensions &gt;= 1</code>, and y only for <code>dimenions &gt;= 2</code> ... and so on... How do I achieve this?</p>\n\n<p><strong>Edit:</strong> The Vector class has nothing to do with std::vector, it is a mathematical vector resembling an array, in that it is of fixed size and its only used for mathematical operations. (renaming Vector to Vec).</p>\n\n<h1>What I have tried:</h1>\n\n<p>Matrix class:</p>\n\n<pre><code>template &lt;typename T, size_t ROWS, size_t COLS&gt;\nclass Matrix {\n\n    public:\n        T&amp; operator[] (size_t idx) {return m_matrix[idx];}\n        T operator[] (size_t idx) const {return m_matrix[idx];}\n\n    private:\n        m_matrix[ROWS * COLS]\n};\n</code></pre>\n\n<p>Vector class:</p>\n\n<pre><code>template &lt;typename T, size_t N&gt;\nclass Vec: public Matrix&lt;T, 1, N&gt;{\n\n    public:\n\n        T&amp; x() {return (*this)[0];}\n        T x() const {return (*this)[0];}\n\n        T&amp; y() {return (*this)[1];}\n        T y() const {return (*this)[1];}\n\n        T&amp; z() {return (*this)[2];}\n        T z() const {return (*this)[2];}\n\n        T&amp; w() {return (*this)[3];}\n        T w() const {return (*this)[3];}\n};\n</code></pre>\n\n<p>This works and I am easily able to use enable_if to remove the functions if it is not defined for this dimension, this however isn't syntactically pleasing. Ive tried using references:</p>\n\n<pre><code>template &lt;typename T, size_t N&gt;\nclass Vec: public Matrix&lt;T, N, 1&gt;{\n\n    public:\n\n        T&amp; x = (*this)[0];\n        T&amp; y = (*this)[1];\n        T&amp; z = (*this)[2];\n        T&amp; w = (*this)[3];\n};\n</code></pre>\n\n<p>But this doesn't work, it doesn't give me an error, but it also does not set the values correctly, when I access them after setting they are undefined.</p>\n\n<p><strong>Edit nr 2:</strong> there might just exist an even simpler solution, when my last attempt with references is compiled using Visual Studio community 2015's default compiler, then it works. But when I compile it in Code::Blocks using the GNU GCC compiler, then it doesn't. What does the standard say? Is my solution using references allowed, which compiler is wrong?</p>\n"}, {"tags": ["c++", "design-patterns"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1515008961, "post_id": 48079956, "comment_id": 83143101, "body": "<i>&quot;I have a timer that regularly checks for &quot;expired&quot; weak pointers in the m_leases map and will remove them if so. This means that at some point, multiple Widgets were destroyed&quot;</i>: As you store <code>weak_ptr</code> in the <code>map</code>, your map cleaning (removing <code>nullptr</code> <code>weak_ptr</code>)  doesn&#39;t release widget. it is just an optimization for the <code>map</code>."}], "answers": [{"comments": [{"owner": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "edited": false, "score": 0, "creation_date": 1514999113, "post_id": 48080185, "comment_id": 83138132, "body": "I like this idea, but possible unspecified behavior: <a href=\"https://stackoverflow.com/questions/41851520/weak-ptrexpired-behavior-in-the-dtor-of-the-object\" title=\"weak ptrexpired behavior in the dtor of the object\">stackoverflow.com/questions/41851520/&hellip;</a>"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "edited": false, "score": 0, "creation_date": 1514999488, "post_id": 48080185, "comment_id": 83138319, "body": "My edit shows how it will not hit this UB, since it doesn&#39;t test the weakpointer validness at all - it knows that it&#39;s not valid; so no test required"}, {"owner": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "edited": false, "score": 0, "creation_date": 1514999507, "post_id": 48080185, "comment_id": 83138337, "body": "I saw your example just now. The linked SO is relevant only because my map of leases uses weak_ptr. From within the destructor of a <code>Lease</code>, the <code>use_count()</code> of the shared_ptr needs to be 0 prior to checking <code>weak_ptr::expired()</code>, which was an extra check I was planning on doing inside your implementation of <code>removeLeaseFromMap()</code>. However after thinking of it, that&#39;s probably unnecessary since the fact that Lease destructor was invoked means ref count is 0, otherwise it wouldn&#39;t be destructed."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "edited": false, "score": 1, "creation_date": 1514999588, "post_id": 48080185, "comment_id": 83138384, "body": "exactly - the removeLeaseFromMap() doesn&#39;t need to do any checking, because it&#39;s known gone."}, {"owner": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "edited": false, "score": 0, "creation_date": 1514999669, "post_id": 48080185, "comment_id": 83138430, "body": "Perfect. Great answer. Thank you for the sample code. To summarize the discussion, I&#39;d recommend you update your code sample to show the implementation of <code>removeLeaseFromMap</code> to show that only <code>m_leases.erase(id);</code> needs to be called, and no checks on <code>weak_ptr::expired()</code>. That&#39;s for the benefit of future viewers of your answer. Thanks again!!"}], "tags": [], "owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "is_accepted": true, "score": 2, "last_activity_date": 1514999700, "last_edit_date": 1514999700, "creation_date": 1514992605, "answer_id": 48080185, "question_id": 48079956, "link": "https://stackoverflow.com/questions/48079956/design-pattern-for-factory-of-shared-objects/48080185#48080185", "title": "Design pattern for factory of shared objects", "body": "<p>I would have the lease broadcast in the destructor - the observer pattern.</p>\n\n<p>This would allow the Controller to register an observer for the deletion of the lease and remove it.  This removes your need for the timer, and introduces the concept of an event; which satisfies 2 &amp; 3.</p>\n\n<p>As for the controller being a singleton, from what you've posted, it could be nested into the Widget and made private  (or moved into the cpp file of Widget).  While this still will end up being a singleton, it's one that's much more controlled and can be easily replaced later because of the limited scope of it.</p>\n\n<p>Example of how it could be thrown together:</p>\n\n<pre><code>class Lease {\npublic:\n    struct listener {\n        virtual void leaseGone(int id) = 0;\n    }\n\n    void addListener(listener* l) {\n        listeners.push_back(l);\n    }\n\n    ~Lease() {\n        for (auto x&amp;: listeners)\n            x-&gt;leaseGone(myId);\n    }\n }\n\n\nclass Controller : Lease::listener {\n    void leaseGone(int id) {\n        m_leases.erase(id);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 2, "accepted_answer_id": 48080185, "answer_count": 1, "score": 1, "last_activity_date": 1514999700, "creation_date": 1514991744, "question_id": 48079956, "link": "https://stackoverflow.com/questions/48079956/design-pattern-for-factory-of-shared-objects", "title": "Design pattern for factory of shared objects", "body": "<p>I have a system where a singleton object is responsible for creating and sharing objects between other non-singleton classes. For example:</p>\n\n<pre><code>// One instance is shared between multiple instances\n// of Widget that have the same ID.\nclass Lease {};\n\n// For each unique Widget instance that has the same\n// value for `m_id`, the Controller will either\n// create a new Lease (if one has not already been\n// created) or it will return an existing one.\nclass Widget\n{\nprivate:\n    unsigned m_id{};\n    std::shared_ptr&lt;Lease&gt; m_lease;\n};\n\n// Singleton object that is used by all instances of\n// Widget to obtain shared instances to Lease\nclass Controller\n{\npublic:\n    std::shared_ptr&lt;Lease&gt; CreateLease(unsigned id);\n\nprivate:\n    std::map&lt;unsigned, std::weak_ptr&lt;Lease&gt;&gt; m_leases;\n};\n</code></pre>\n\n<p>This is the gist of what I have at the moment. What Controller does is create a new Lease if one does not already exist in the map for the given ID. If it does exist, it returns the existing shared object.</p>\n\n<p>I have a timer that regularly checks for \"expired\" weak pointers in the <code>m_leases</code> map and will remove them if so. This means that at some point, multiple Widgets were destroyed that subsequently released their Leases as well.</p>\n\n<p>Now that you have some background, what I think I have here is a factory (Controller) that is a little bit smarter than a normal factory: It keeps track of instances is creates and only creates new ones based on certain business rules (specifically, if a matching ID is found in the map). I'm not sure if this is the best design for what I'm trying to do (and that is: Some mechanism to share Lease instances across unique instances of Widget). A few things I don't like about this solution:</p>\n\n<ol>\n<li>A singleton is required as the point of contact for Widget instances to acquire a Lease</li>\n<li>A timer is used to manage the map: There's no event-based approach to managing removing expired leases from the map that I could think of.</li>\n<li>Follow on to #2: Because I'm using a timer to manage lease expiry in the map, there's always a small window where a lease remains in the map even after it expires, which means <code>CreateLease()</code> also has to check if a <code>weak_ptr</code> is expired, if an existing ID mapping is found, prior to returning it.</li>\n</ol>\n\n<p>This logic just feels wrong to me. I need extra sets of eyes on this idea and ideally recommendations for better patterns to solve this problem.</p>\n"}, {"tags": ["c++", "constructor", "constants"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1514991062, "post_id": 48079708, "comment_id": 83133345, "body": "Using <code>#define VIAL_COUNT 16</code> means all occurrences of <code>VIAL_COUNT</code> will be substituted by 16. You essentially wrote <code>static const int 16;</code>."}, {"owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 0, "creation_date": 1514991203, "post_id": 48079708, "comment_id": 83133411, "body": "You could in your implementation file <code>Vial_Control::VIAL_COUNT = 16</code>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1514991207, "post_id": 48079708, "comment_id": 83133413, "body": "You cannot change a <code>const</code> after it&#39;s been initialized. That&#39;s what makes it <code>const</code>. And I don&#39;t think you can portably get user input during static initialization. Either make your constant non-static and use user input to initialize it at a later time, or don&#39;t make it <code>const</code>. Maybe you could use a local static constant, which is only initialized when it&#39;s first encountered."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1514991351, "post_id": 48079708, "comment_id": 83133514, "body": "If you think you need a macro in C++, 99.99% of the time, you thought wrong."}, {"owner": {"reputation": 73, "user_id": 5957179, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-EBy6MKvHcwM/AAAAAAAAAAI/AAAAAAAAAB0/QAI8q4s_gic/photo.jpg?sz=128", "display_name": "Anthony the Kid", "link": "https://stackoverflow.com/users/5957179/anthony-the-kid"}, "reply_to_user": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 0, "creation_date": 1514991796, "post_id": 48079708, "comment_id": 83133790, "body": "@JakeFreeman - that doesn&#39;t solve the variability issue of an 8, 10 or 20-vial system.  Thanks though."}, {"owner": {"reputation": 73, "user_id": 5957179, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-EBy6MKvHcwM/AAAAAAAAAAI/AAAAAAAAAB0/QAI8q4s_gic/photo.jpg?sz=128", "display_name": "Anthony the Kid", "link": "https://stackoverflow.com/users/5957179/anthony-the-kid"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1514992059, "post_id": 48079708, "comment_id": 83133996, "body": "@Fran&#231;oisAndrieux - I wanted to do that originally.  Non-static and initialize after construction.  Maybe I&#39;m writing it wrong, but I have <code>const int VIAL_CONTROL</code> as a private variable, not initialized.  Then, <code>Vial_Control</code> constructor is made, then I use that function to initialize <code>VIAL_CONTROL</code> variable with the input variable from the user. However, it is written as an assignment. Thus I receive the following error: &quot;In constructor &#39;Vial_Control::Vial_Control()<code>, uninitialized member VIAL_COUNT with </code>const` type <code>const int</code>.&quot;  Then, the function produces an error regarding assignment."}, {"owner": {"reputation": 73, "user_id": 5957179, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-EBy6MKvHcwM/AAAAAAAAAAI/AAAAAAAAAB0/QAI8q4s_gic/photo.jpg?sz=128", "display_name": "Anthony the Kid", "link": "https://stackoverflow.com/users/5957179/anthony-the-kid"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1514992100, "post_id": 48079708, "comment_id": 83134013, "body": "@underscore_d - I wish I knew enough to agree with you, but I&#39;ll come to that road eventually."}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1514992452, "post_id": 48080137, "comment_id": 83134224, "body": "It&#39;s may be unclear exactly what you are suggesting. You should provide the modified header to better illustrate your proposed solution. The provided code is not compatible with the header in the question."}, {"owner": {"reputation": 73, "user_id": 5957179, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-EBy6MKvHcwM/AAAAAAAAAAI/AAAAAAAAAB0/QAI8q4s_gic/photo.jpg?sz=128", "display_name": "Anthony the Kid", "link": "https://stackoverflow.com/users/5957179/anthony-the-kid"}, "edited": false, "score": 1, "creation_date": 1514992708, "post_id": 48080137, "comment_id": 83134374, "body": "That&#39;s exactly right, and ironically, it would be better for there to be no input at all from the user!  This carousel unfortunately has no way of communicating that info to the system (even if I tried to make a way that is efficient to the current project and more efficient than the previous project that I&#39;m trying to better-implement.)"}, {"owner": {"reputation": 73, "user_id": 5957179, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-EBy6MKvHcwM/AAAAAAAAAAI/AAAAAAAAAB0/QAI8q4s_gic/photo.jpg?sz=128", "display_name": "Anthony the Kid", "link": "https://stackoverflow.com/users/5957179/anthony-the-kid"}, "edited": false, "score": 0, "creation_date": 1515005998, "post_id": 48080137, "comment_id": 83141738, "body": "Just to follow up, int nVials as you suggest still has not automated way of obtaining a value upon construction."}, {"owner": {"reputation": 1485, "user_id": 138264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mZr81.png?s=128&g=1", "display_name": "natersoz", "link": "https://stackoverflow.com/users/138264/natersoz"}, "edited": false, "score": 0, "creation_date": 1515006174, "post_id": 48080137, "comment_id": 83141825, "body": "I&#39;m not certain what automated means in this context. It merely allows you to assign the value to your const member variable within the constructor."}, {"owner": {"reputation": 73, "user_id": 5957179, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-EBy6MKvHcwM/AAAAAAAAAAI/AAAAAAAAAB0/QAI8q4s_gic/photo.jpg?sz=128", "display_name": "Anthony the Kid", "link": "https://stackoverflow.com/users/5957179/anthony-the-kid"}, "edited": false, "score": 0, "creation_date": 1515007687, "post_id": 48080137, "comment_id": 83142514, "body": "Automated - referencing the suggestion by natersoz about acquiring a vial count from the carousel itself...automated might not have been the best word, more just like a technology that &quot;discovers&quot; the vial count and &quot;feeds&quot; it to the Arduino software to be processed and held during the entire runtime."}, {"owner": {"reputation": 73, "user_id": 5957179, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-EBy6MKvHcwM/AAAAAAAAAAI/AAAAAAAAAB0/QAI8q4s_gic/photo.jpg?sz=128", "display_name": "Anthony the Kid", "link": "https://stackoverflow.com/users/5957179/anthony-the-kid"}, "edited": false, "score": 0, "creation_date": 1515007721, "post_id": 48080137, "comment_id": 83142530, "body": "But this is already straying far from my original issue, which, if there is an implementable solution, will be far more efficient than optimizing the carousel."}], "tags": [], "owner": {"reputation": 1485, "user_id": 138264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mZr81.png?s=128&g=1", "display_name": "natersoz", "link": "https://stackoverflow.com/users/138264/natersoz"}, "is_accepted": false, "score": 0, "last_activity_date": 1514992397, "creation_date": 1514992397, "answer_id": 48080137, "question_id": 48079708, "link": "https://stackoverflow.com/questions/48079708/how-do-define-a-constant-value-from-user-input-after-class-construction/48080137#48080137", "title": "How do define a constant value from user input after class construction", "body": "<p>This is an interesting problem. </p>\n\n<p>Is there any means by which you can obtain information from the hardware (the vial carousel) by which the device can tell you if it is a 16 vial system? If so, then you could use that in your ctor and VIAL_COUNT could be set there. Example:</p>\n\n<pre><code>Vial_Control::Vial_Control(int nVials=16): vialCount(nVials)\n{\n}\n</code></pre>\n\n<p>In this manner const members can be initialized at creation with their initial values. As I understand what you're doing, the user input is giving you the number of vials in use, and the member const int vialCount is the maximum number of vials available on the machine. (?)</p>\n"}], "owner": {"reputation": 73, "user_id": 5957179, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-EBy6MKvHcwM/AAAAAAAAAAI/AAAAAAAAAB0/QAI8q4s_gic/photo.jpg?sz=128", "display_name": "Anthony the Kid", "link": "https://stackoverflow.com/users/5957179/anthony-the-kid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514992397, "creation_date": 1514990923, "last_edit_date": 1514991098, "question_id": 48079708, "link": "https://stackoverflow.com/questions/48079708/how-do-define-a-constant-value-from-user-input-after-class-construction", "title": "How do define a constant value from user input after class construction", "body": "<p>As part of personal Arduino project, I have added an initial \"input\" stage that asks the user to enter an integer representing the number of vials in their carousel (that particular info is not relevant to the issue, I just thought I'd better mention it.) This input is received via LCD button keypad.</p>\n\n<p>This integer will be used solely in a custom class called Vial_Control.</p>\n\n<p>Currently, if I'm using a 16-vial system, I hard code the \"16\" and use the '#define' directive throughout ('const int' would also work, but not solve the problem.)</p>\n\n<p>The catch is that when I ask for user input, I have already created my global variables in my main file that represent the class constructor object for Vial_Control.</p>\n\n<pre><code>#ifndef Vial_Control_h\n#define Vial_Control_h\n#include \"Arduino.h\"\n\nclass Vial_Control\n{\n    public:\n        Vial_Control();   // constructor\n        void setSystemVialCount(int vialCount);\n        // bunch of other unrelated functions\n    private:\n        #define VIAL_COUNT 16         // I used to use this\n        static const int VIAL_COUNT;  // now I use this\n        // bunch of other...\n\n};\n\n#endif\n</code></pre>\n\n<p>now in my implementation file</p>\n\n<pre><code>Vial_Control::Vial_Control()\n{\n    // I used to assign 'static const int VIAL_COUNT' here\n    // but turned away from that.\n\n    // bunch of other...\n}\n\nvoid Vial_Control::setSystemVialCount(int vialCount)\n{\n    /* I started to do this, even prior to defining the variable\n     * as 'static'.  I added 'static' as per suggestion from the\n     * compiler, although I'm not entirely convinced that this is\n     * the best solution. */\n    VIAL_COUNT = vialCount;\n}\n</code></pre>\n\n<p>So, in my ArdProj.c file, the Vial_Control constructor is made, then in the initial stage portion (Arduino calls this <code>setup()</code>) I ask for user input, then call the function <code>setSystemVialCount(int vialCount)</code>, passing in the input.</p>\n\n<p>Is this the best solution for what I'm after?  Will the <code>static const int VIAL_COUNT</code> hold the value \"16\" for the entirety of runtime?</p>\n\n<p>I received errors when I did not add the <code>static</code>, from what I've read, due to to the variable not being initialized upon construction.  </p>\n\n<p>If anything is unclear, let me know, I'll add more.</p>\n\n<p>Thanks,\nAnthony</p>\n"}, {"tags": ["c++", "blender", "terrain", "vertices"], "comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1514991321, "post_id": 48079678, "comment_id": 83133494, "body": "Somehow <code>make less verticies</code> - so either lower resolution or smaller size -  seems too obvious?"}, {"owner": {"reputation": 531, "user_id": 3765180, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/i33Gb.jpg?s=128&g=1", "display_name": "Grim Reaper", "link": "https://stackoverflow.com/users/3765180/grim-reaper"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1514991406, "post_id": 48079678, "comment_id": 83133557, "body": "I have thought of that, but I don&#39;t want to scale my objects too much in my game engine. I&#39;m trying to keep the size in meters, not go down to centimeters :)"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1514991467, "post_id": 48079678, "comment_id": 83133596, "body": "So why can&#39;t you make multiple terrains, but each one say 50m x 50m; and then only load the ones you need for what&#39;s going on?  Solves your problem with vertex count &amp; load time"}, {"owner": {"reputation": 531, "user_id": 3765180, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/i33Gb.jpg?s=128&g=1", "display_name": "Grim Reaper", "link": "https://stackoverflow.com/users/3765180/grim-reaper"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1514991566, "post_id": 48079678, "comment_id": 83133654, "body": "Well that is exactly my question. Creating that many chunks and modeling them to make them all work together is really inefficient, since it would take a lot of time trying to make the transitions be smooth. I am looking for an alternative. :)"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1514991701, "post_id": 48079678, "comment_id": 83133725, "body": "<code>transitions be smooth</code> load the next sections earlier.  Who cares if the last little bit of the map is wrong if you can never see/use it? ;)"}, {"owner": {"reputation": 531, "user_id": 3765180, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/i33Gb.jpg?s=128&g=1", "display_name": "Grim Reaper", "link": "https://stackoverflow.com/users/3765180/grim-reaper"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1514991917, "post_id": 48079678, "comment_id": 83133891, "body": "True :) But I was talking about the difficulty of actually modeling them :)"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1514992026, "post_id": 48079678, "comment_id": 83133972, "body": "That is a modelling problem, not a coding problem :D"}, {"owner": {"reputation": 531, "user_id": 3765180, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/i33Gb.jpg?s=128&g=1", "display_name": "Grim Reaper", "link": "https://stackoverflow.com/users/3765180/grim-reaper"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1514992189, "post_id": 48079678, "comment_id": 83134067, "body": "I suppose you&#39;re right :) Thanks for sharing your ideas! :)"}, {"owner": {"reputation": 1202, "user_id": 673679, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ac5b75f2ba59f84ac69e71018275702b?s=128&d=identicon&r=PG", "display_name": "user673679", "link": "https://stackoverflow.com/users/673679/user673679"}, "edited": false, "score": 0, "creation_date": 1514999224, "post_id": 48079678, "comment_id": 83138197, "body": "Probably a question for blender.stackexchange.com."}], "answers": [{"comments": [{"owner": {"reputation": 531, "user_id": 3765180, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/i33Gb.jpg?s=128&g=1", "display_name": "Grim Reaper", "link": "https://stackoverflow.com/users/3765180/grim-reaper"}, "edited": false, "score": 0, "creation_date": 1514992036, "post_id": 48079926, "comment_id": 83133979, "body": "I <b>LOVE</b> this approach! Thank you for sharing! This is by far the best tutorial I saw on quad trees, it seems to make the most sense. The only problem being modeling the actual terrain, since it is fairly hard to do so with a huge terrain. :)"}, {"owner": {"reputation": 1202, "user_id": 673679, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ac5b75f2ba59f84ac69e71018275702b?s=128&d=identicon&r=PG", "display_name": "user673679", "link": "https://stackoverflow.com/users/673679/user673679"}, "edited": false, "score": 0, "creation_date": 1514999186, "post_id": 48079926, "comment_id": 83138180, "body": "This doesn&#39;t appear to have anything to do with the question though, which was about modelling in blender???"}, {"owner": {"reputation": 41, "user_id": 9161864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ihhng.jpg?s=128&g=1", "display_name": "Lloyd Crawley", "link": "https://stackoverflow.com/users/9161864/lloyd-crawley"}, "edited": false, "score": 1, "creation_date": 1514999450, "post_id": 48079926, "comment_id": 83138301, "body": "I would have to disagree - &quot;I am starting a new project in C++ using GLFW and GLEW&quot;. The approach outlined would allow the poster to create a model how they wish from within blender, taking the pressure from &quot;how do I make this in blender so it&#39;s usable&quot; to &quot;don&#39;t worry about the method in Blender, just worry about how to treat the exported model information in your engine/renderer&quot;"}], "tags": [], "owner": {"reputation": 41, "user_id": 9161864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ihhng.jpg?s=128&g=1", "display_name": "Lloyd Crawley", "link": "https://stackoverflow.com/users/9161864/lloyd-crawley"}, "is_accepted": false, "score": 3, "last_activity_date": 1514992303, "last_edit_date": 1514992303, "creation_date": 1514991612, "answer_id": 48079926, "question_id": 48079678, "link": "https://stackoverflow.com/questions/48079678/creating-huge-low-poly-terrain/48079926#48079926", "title": "Creating Huge Low Poly Terrain", "body": "<p>I did something similar many years ago and found this tutorial very helpful:</p>\n\n<p><a href=\"http://www.rastertek.com/tertut05.html\" rel=\"nofollow noreferrer\">http://www.rastertek.com/tertut05.html</a></p>\n\n<p>It describes creating a quad tree with specific triangles from your terrain mesh partitioned into AABBs, using frustum culling huge parts of your terrain can be culled during runtime and your application's performance should improve. As long as you are confident importing meshes exported from blender (are they in .obj ?) you should easily be able to partition the different triangles using the strategies outlined in the tutorial.</p>\n\n<p>A further optimization could be to have various LODs for nodes in your quadtree depending on the distance from the camera, i.e if a node is a set distance from the camera render a lower poly mesh by skipping certain vertices to make the smaller triangles \"collapse\" into larger ones. I'd recommend generating specific index lists to do this and use the same vertex data as opposed to having separate pre-generated chunks of mesh to save on memory.</p>\n"}, {"comments": [{"owner": {"reputation": 531, "user_id": 3765180, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/i33Gb.jpg?s=128&g=1", "display_name": "Grim Reaper", "link": "https://stackoverflow.com/users/3765180/grim-reaper"}, "edited": false, "score": 0, "creation_date": 1515028137, "post_id": 48081269, "comment_id": 83149601, "body": "Thank you so much for this amazing answer! I love the video that you linked, it really helps me understand some things alot better! Also, I will look into the tutorial you provided \ud83d\ude0a Sorry for the late response btw. Thanks again!"}], "tags": [], "owner": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "is_accepted": true, "score": 3, "last_activity_date": 1514996682, "creation_date": 1514996682, "answer_id": 48081269, "question_id": 48079678, "link": "https://stackoverflow.com/questions/48079678/creating-huge-low-poly-terrain/48081269#48081269", "title": "Creating Huge Low Poly Terrain", "body": "<p>Terrain in game engines like Unity, Unreal Engine and CryEngine is treated differently from your average static or skeletal mesh. Creation of different levels of detail are is usually done at runtime, as opposed to ordinary meshes having their LODs pre-created. Loading a mesh from a 3D program like Blender or 3DS Max as your entire terrain just isn't doable.</p>\n\n<p>The Direct3D tutorials at rastertek are very good for learning, but isn't OpenGL obviously. Here is a basic tutorial of creating a basic terrain in Java OpenGL (This doesn't go into LOD handling I don't think). </p>\n\n<p><a href=\"https://www.youtube.com/watch?v=yNYwZMmgTJk\" rel=\"nofollow noreferrer\">Java OpenGL terrain</a></p>\n\n<p>Most commonly I think I've seen a quad tree system, where you have terrain patches, and each patch is subdivided into four other patches, depending on a condition (whether distance to camera or screenspace size). </p>\n\n<p>This is what a standard quad-tree LOD system looks like, in particular for the game Kerbal Space Program.</p>\n\n<p><a href=\"https://i.stack.imgur.com/YUNiq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YUNiq.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Along the way you'll need to figure out how to solve some problems, like how to get rid of the cracks and gaps in between two terrain patches that are of different LOD levels. Kerbal Space Program solved this by treating the edge vertices differently to line up, and not allowing any two adjacent terrain patches to be more than one LOD level of difference.</p>\n\n<p>One method I tried was to upload two vertex positions for each vertex, the current LOD position and the position of the LOD vertex from one level down, and linearly interpolate between the two based on camera distance. Yet I'm pretty sure there are more elegant ways than this.</p>\n\n<p>I've posted a video from a while ago of me messing around with this stuff, it shows the basic quad tree pattern, the problem of cracks, and then the vertex interpolation method. Some people create the patches on the CPU and other on the GPU and read back any necessary info, (like for example for physics) using transform feedback. There's lots of ways of doing things, and I hope to get back into it.</p>\n\n<p><a href=\"https://drive.google.com/file/d/1u0KBS4K18Q-8NuwuaZditM8CrYZ35Fl8/view?usp=sharing\" rel=\"nofollow noreferrer\">TerrainPatches</a></p>\n"}], "owner": {"reputation": 531, "user_id": 3765180, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/i33Gb.jpg?s=128&g=1", "display_name": "Grim Reaper", "link": "https://stackoverflow.com/users/3765180/grim-reaper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1754, "favorite_count": 1, "accepted_answer_id": 48081269, "answer_count": 2, "score": 2, "last_activity_date": 1514996682, "creation_date": 1514990829, "last_edit_date": 1514996311, "question_id": 48079678, "link": "https://stackoverflow.com/questions/48079678/creating-huge-low-poly-terrain", "title": "Creating Huge Low Poly Terrain", "body": "<p>I am starting a new project in <em>C++</em> using <em>GLFW</em> and <em>GLEW</em>.</p>\n\n<p>The plan is to have a fairly big Low Poly terrain. It will <em>NOT</em> be randomly generated, I am planning on making it in Blender.</p>\n\n<p>My problem is, that I cannot create a <strong>huge</strong> Low Poly terrain in <strong>Blender</strong>, because the program becomes really slow with the amount of vertices that the terrain has. I created a 500m x 500m terrain, and subdivided it by 1000. That gave me <em>ALOT</em> of vertices, making the program not usable.</p>\n\n<p>What would be the best approach to creating a huge terrain?\nIm not sure how I would go onto creating chunks of the terrain, since I have to model them.</p>\n\n<ul>\n<li><em>How do I create a big Low Poly terrain, without having a problem with\nthe program being slow?</em></li>\n</ul>\n\n<p><em>Another</em> concern of mine is obviously loading the world into a custom game engine of mine. I suppose a big world like this would have huge problems with the load times.</p>\n"}, {"tags": ["c++", "winapi", "stdvector"], "comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1514990600, "post_id": 48079483, "comment_id": 83133047, "body": "To me, ReadFile looks ok, but PrintError seems to be not being passed a handle <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms708391(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 3, "creation_date": 1514990656, "post_id": 48079483, "comment_id": 83133082, "body": "As a side note; you may wish to consider the case where someone passes in a buffer of size 0"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1514990686, "post_id": 48079483, "comment_id": 83133099, "body": "<i>I never pass an empty buffer</i> -- Then in production, an empty buffer <i>is</i> passed.  Oops."}, {"owner": {"reputation": 2827, "user_id": 3931225, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/46nwm.gif?s=128&g=1", "display_name": "KompjoeFriek", "link": "https://stackoverflow.com/users/3931225/kompjoefriek"}, "edited": false, "score": 0, "creation_date": 1514990865, "post_id": 48079483, "comment_id": 83133217, "body": "The return value 0 (FALSE) of <code>ReadFile</code> does not indicate failure. Please see <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365467(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>"}, {"owner": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 2, "creation_date": 1514990899, "post_id": 48079483, "comment_id": 83133244, "body": "I&#39;m not seeing an overflow on the ReadFile. Maybe put a comment marking which one exactly is line 225. It&#39;s possibly overzealous reporting because you didn&#39;t actually check buffer.size(), so whether or not you pass an empty buffer isn&#39;t really relevant to whether or not this function itself is good."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 7, "creation_date": 1514990985, "post_id": 48079483, "comment_id": 83133294, "body": "The behavior is undefined if the vector is empty and you use it in ReadFile using <code>&amp;buffer[0]</code>.  Use <code>buffer.data()</code> instead."}, {"owner": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 0, "creation_date": 1514991381, "post_id": 48079483, "comment_id": 83133535, "body": "You do return an empty buffer, and Read tends to be called repeatedly."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1514992561, "post_id": 48079483, "comment_id": 83134285, "body": "@PaulMcKenzie <i>if the vector is empty</i> - <code>buffer.size()</code> will be 0 and in this case to which point <code>&amp;buffer[0]</code> irrelevant. <code>ReadFile</code> simply return true and <code>read</code> bytes will be 0"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1514992625, "post_id": 48079483, "comment_id": 83134331, "body": "@RbMm -- Do you have the source to <code>ReadFile</code>?  If not, we don&#39;t know exactly what is being done with that second parameter, regardless if nothing is read from the file.  Believe me, I have had experience with MS engineers directly with an API function, and they plainly (and rightly) state -- don&#39;t assume something will be done if it isn&#39;t documented."}, {"owner": {"reputation": 1145, "user_id": 2509099, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b943869aa8e032e04aae5d8b637d47c?s=128&d=identicon&r=PG", "display_name": "rafael gonzalez", "link": "https://stackoverflow.com/users/2509099/rafael-gonzalez"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1514992637, "post_id": 48079483, "comment_id": 83134341, "body": "@PaulMcKenzie i replaced the code with. int val = ReadFile(h, buffer.data(), buffer.size(), &amp;read, NULL); and i still get a buffer overflow error."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1514992772, "post_id": 48079483, "comment_id": 83134422, "body": "@PaulMcKenzie - src also exist in wdk and fastfat. we clear say that <code>nNumberOfBytesToRead</code> is 0. so buffere have 0 size and it will be not accessed"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1514992898, "post_id": 48079483, "comment_id": 83134497, "body": "@rafaelgonzalez -- Well, you asked for suggestions on fixing the error, and I gave one.  Otherwise we&#39;re just playing a game trying to make a tool act in the way we want it to act."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 2827, "user_id": 3931225, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/46nwm.gif?s=128&g=1", "display_name": "KompjoeFriek", "link": "https://stackoverflow.com/users/3931225/kompjoefriek"}, "edited": false, "score": 1, "creation_date": 1514993514, "post_id": 48079483, "comment_id": 83134870, "body": "@KompjoeFriek - <i>0 does not indicate failure</i> - in synchronous io case - indicate. and here used synchronous io, because <i>lpOverlapped</i> is 0 (otherwise (use 0  <i>lpOverlapped</i>  for async io) this is critical bug)"}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1514998477, "post_id": 48079483, "comment_id": 83137788, "body": "@PaulMcKenzie How is <code>buffer.data()</code> better than <code>&amp;buffer[0]</code> in preventing undefined behaviour if the vector is empty?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 1, "creation_date": 1514999749, "post_id": 48079483, "comment_id": 83138479, "body": "@zett42 -- If the vector is empty, <code>buffer[0]</code> is invalid. So you&#39;re asking for the address of something that is invalid when you state <code>&amp;buffer[0]</code>.  With <code>buffer.data()</code>, you&#39;re calling a member function that can react accordingly if the buffer is empty (in this case, will return <code>nullptr</code>)."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1515001259, "post_id": 48079483, "comment_id": 83139318, "body": "@PaulMcKenzie <a href=\"http://en.cppreference.com/w/cpp/container/vector/data\" rel=\"nofollow noreferrer\">&quot;<i>If size() is 0, data() may or may not return a null pointer.</i>&quot;</a>. Even if it would always return <code>nullptr</code>, the <code>lpBuffer</code> parameter of <code>ReadFile()</code> is not optional, so you are not allowed to pass <code>nullptr</code>."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 1, "creation_date": 1515010744, "post_id": 48079483, "comment_id": 83143892, "body": "@zett42 if the <i>nNumberOfBytesToRead</i> parameter of ReadFile() is 0 - the nullptr in place <i>lpBuffer</i> will be valid, simply because system will not access data of this buffer (it size is 0) and it is &quot;ideal&quot; aligned (for case non cached io and device require buffer align more than 1 byte). however no sense at all call <code>ReadFile</code> with 0 bytes, especially when we return number of readed bytes. can simply return 0 in this case"}], "answers": [{"comments": [{"owner": {"reputation": 24913, "user_id": 1300910, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/se92W.jpg?s=128&g=1", "display_name": "huysentruitw", "link": "https://stackoverflow.com/users/1300910/huysentruitw"}, "edited": false, "score": 2, "creation_date": 1514991934, "post_id": 48079974, "comment_id": 83133905, "body": "Not to mention the bad practice of resizing the buffer that got passed in, nobody will expect that."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1515013696, "post_id": 48079974, "comment_id": 83145167, "body": "This answer doesn&#39;t even try to explain <i>why</i> passing an empty buffer is supposed to be a problem. Sorry, that&#39;s not useful."}], "tags": [], "owner": {"reputation": 8326, "user_id": 53089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525dac0c4812e8e8753935590b40ddb6?s=128&d=identicon&r=PG", "display_name": "Rob K", "link": "https://stackoverflow.com/users/53089/rob-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1514991796, "creation_date": 1514991796, "answer_id": 48079974, "question_id": 48079483, "link": "https://stackoverflow.com/questions/48079483/how-do-i-fix-this-buffer-overflow-issue/48079974#48079974", "title": "How do i fix this buffer overflow issue?", "body": "<blockquote>\n  <p>I never pass an empty buffer</p>\n</blockquote>\n\n<p>But someone else may someday. You're making the mistake of evaluating the code inside the function with knowledge of what you do outside the function. That function <strong>can</strong> be passed an empty <code>std::vector&lt;char&gt; &amp;</code>. Someday, it <em>will</em> be. Handle that case.</p>\n"}, {"comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1515010204, "post_id": 48082784, "comment_id": 83143667, "body": "If the buffer is empty, then <code>buffer.size()==0</code>. when we pass 0 as buffer size system will not access this buffer. the value of buffer pointer will play role only in case not cached io and device require buffer align more than 1 byte"}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1515013290, "post_id": 48082784, "comment_id": 83144992, "body": "Option 1 - <code>assert()</code> is good as a debugging tool but it doesn&#39;t replace proper error handling. IMO passing a buffer size of 0 is an exceptional condition, so it should be reported as such, by throwing an exception. Now we have actual error handling for release builds too and the <code>assert()</code> can be removed as it works for debug builds aswell."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1515014485, "post_id": 48082784, "comment_id": 83145470, "body": "@zett42 - despite read 0 bytes is error by sense in most case, formal this is not error. the <code>[&amp;buffer[0], &amp;buffer[0]+buffer.size())</code>always a valid range when <code>buffer.size()==0</code>. empty range - valid range. not think need trow exception here"}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1515017372, "post_id": 48082784, "comment_id": 83146664, "body": "@RbMm Sure. But it can be assumed, if someone passes empty buffer to such function, it is a programming (logic) error. Why should someone ask for 0 bytes, it doesn&#39;t make sense. So by throwing an exception we make sure that the developer notices his error and can&#39;t ignore it."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1515019127, "post_id": 48082784, "comment_id": 83147293, "body": "@RbMm:  <code>buffer[0]</code> returns a reference to the first element in the buffer.  If that element doesn&#39;t exist, it&#39;s undefined behavior even if you don&#39;t try to read or write to that element.  The problem occurs <i>before</i> the call to ReadFile, so the fact that the size argument is 0 is irrelevant.  MS&#39;s <code>std::vector</code> implementation will assert &quot;vector subscript out of range&quot; in debug builds."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1515019423, "post_id": 48082784, "comment_id": 83147394, "body": "if this construct <code>&amp;buffer[0]</code> yourself can case exception, etc - yes (i not familiar with  std::vector), but if it return, even random value - call to <code>ReadFile</code> will be ok even with random buffer pointer, because buffer size is set to 0 (assume here not used non-cached io, and serial device not require special buffer align)."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1515019580, "post_id": 48082784, "comment_id": 83147442, "body": "i be say next - if we check for <code>buffer.empty()</code> - we can not call <code>ReadFile</code> at all in this case, simply return 0. or pass nullptr in place buffer (instead <code>&amp;trash</code>)"}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1515019866, "post_id": 48082784, "comment_id": 83147531, "body": "Yes, <code>&amp;trash</code> is being pedantic.  Passing <code>nullptr</code> would be fine.  But passing <code>buffer.data()</code> is risky, since it&#39;s also undefined if the vector is empty."}, {"owner": {"reputation": 1145, "user_id": 2509099, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b943869aa8e032e04aae5d8b637d47c?s=128&d=identicon&r=PG", "display_name": "rafael gonzalez", "link": "https://stackoverflow.com/users/2509099/rafael-gonzalez"}, "edited": false, "score": 0, "creation_date": 1515055580, "post_id": 48082784, "comment_id": 83157417, "body": "@AdrianMcCarthy I tried your suggestion the analysis tool still reports an error. I think i will just suppress it."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "reply_to_user": {"reputation": 1145, "user_id": 2509099, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b943869aa8e032e04aae5d8b637d47c?s=128&d=identicon&r=PG", "display_name": "rafael gonzalez", "link": "https://stackoverflow.com/users/2509099/rafael-gonzalez"}, "edited": false, "score": 0, "creation_date": 1515100921, "post_id": 48082784, "comment_id": 83182995, "body": "@rafael gonzalez:  Can you share which analysis tool you&#39;re using?  We&#39;re all just guessing without a way to reproduce the problem you&#39;re seeing."}, {"owner": {"reputation": 1145, "user_id": 2509099, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b943869aa8e032e04aae5d8b637d47c?s=128&d=identicon&r=PG", "display_name": "rafael gonzalez", "link": "https://stackoverflow.com/users/2509099/rafael-gonzalez"}, "edited": false, "score": 0, "creation_date": 1515106348, "post_id": 48082784, "comment_id": 83185148, "body": "@Adrian McCarthy HP fortify."}], "tags": [], "owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "is_accepted": false, "score": 0, "last_activity_date": 1515003554, "last_edit_date": 1515003554, "creation_date": 1515002560, "answer_id": 48082784, "question_id": 48079483, "link": "https://stackoverflow.com/questions/48079483/how-do-i-fix-this-buffer-overflow-issue/48082784#48082784", "title": "How do i fix this buffer overflow issue?", "body": "<p>You never pass an empty buffer, but the code scanning tool doesn't know that.  The ones I've worked with look only at individual functions, so it will assume the actual arguments can be anything.</p>\n\n<p>If the buffer is empty, then <code>&amp;buffer[0]</code> is undefined behavior.  You've tried to create a pointer to memory that doesn't exist.  That's probably what the code scanning tool is reacting to.</p>\n\n<p>Even though <code>&amp;buffer[0]</code> is an invalid pointer, you might expect nothing to go wrong because nothing will access it.  But <code>buffer[0]</code> is itself an invalid access, even though you're not reading or writing to that element.</p>\n\n<p>Although you might get away with using <code>buffer.data()</code> instead, I'd still be wary of it.  It only seems to be defined for a non-empty array.</p>\n\n<p>To fix the problem, ...</p>\n\n<p>Option 1:  Add <code>assert(!buffer.empty());</code> to the beginning of the function.</p>\n\n<p>Option 2:  Get the pointer more carefully,</p>\n\n<pre><code>DWORD read = 0;\nchar trash;\nvoid *pBuffer = buffer.empty() ? &amp;trash : buffer.data();\nint val = ReadFile(h, pBuffer, buffer.size(), &amp;read, NULL);\n</code></pre>\n\n<p>Although the tool didn't complain, I'd also make sure that <code>buffer.size()</code> (a <code>std::size_t</code>) fits into a DWORD, which might not be the case in a 64-bit build.</p>\n"}], "owner": {"reputation": 1145, "user_id": 2509099, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b943869aa8e032e04aae5d8b637d47c?s=128&d=identicon&r=PG", "display_name": "rafael gonzalez", "link": "https://stackoverflow.com/users/2509099/rafael-gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1415, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1515019926, "creation_date": 1514990175, "last_edit_date": 1515019926, "question_id": 48079483, "link": "https://stackoverflow.com/questions/48079483/how-do-i-fix-this-buffer-overflow-issue", "title": "How do i fix this buffer overflow issue?", "body": "<p>I recently ran a code scan on a project i'm working on using HP fortify.\nIt reported that I have a critical issue with ReadFile.\nI never pass an empty buffer.\nAny suggestions on how to fix the potential buffer overflow problem.</p>\n\n<p><strong>The Abstract</strong></p>\n\n<p>The function Read() in serialport.cpp might be able to write outside the bounds of allocated memory on line 225, which could corrupt data, cause the program to crash, or lead to the execution of malicious code.</p>\n\n<pre><code>DWORD serialport::Read(std::vector&lt;char&gt; &amp; buffer)\n{\n    DWORD read = 0;\n    int val = ReadFile(h, &amp;buffer[0], buffer.size(), &amp;read, NULL);\n\n    if (val == 0)\n    {\n        LPCSTR ptr = \"\";\n        PrintError(ptr);\n    }\n\n    buffer.resize(read);\n    return read;\n}\n</code></pre>\n"}, {"tags": ["c++", "winapi"], "answers": [{"comments": [{"owner": {"reputation": 521, "user_id": 5411219, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/PB2qj.png?s=128&g=1", "display_name": "rosengrenen", "link": "https://stackoverflow.com/users/5411219/rosengrenen"}, "edited": false, "score": 0, "creation_date": 1514990904, "post_id": 48079607, "comment_id": 83133249, "body": "Any reason for the <code>CW_</code> prefix of <code>CW_DEFAULT</code>? Thought it was an abbreviation of CreateWindow"}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1514990910, "post_id": 48079607, "comment_id": 83133255, "body": "That is an unfortunate similarity in names!"}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "reply_to_user": {"reputation": 521, "user_id": 5411219, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/PB2qj.png?s=128&g=1", "display_name": "rosengrenen", "link": "https://stackoverflow.com/users/5411219/rosengrenen"}, "edited": false, "score": 7, "creation_date": 1514991015, "post_id": 48079607, "comment_id": 83133313, "body": "@feareoc: according to <code>float.h</code> the &quot;CW&quot; stands for &quot;Control Word&quot;.  It&#39;s a value for a register in the 80x87 floating point coprocessor."}, {"owner": {"reputation": 521, "user_id": 5411219, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/PB2qj.png?s=128&g=1", "display_name": "rosengrenen", "link": "https://stackoverflow.com/users/5411219/rosengrenen"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1514991163, "post_id": 48079607, "comment_id": 83133394, "body": "@MichaelBurr yeah I see now, that&#39;s an unfortunate naming similarity between two very different and unrelated things, explains why it didn&#39;t work."}], "tags": [], "owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "is_accepted": true, "score": 5, "last_activity_date": 1514990581, "creation_date": 1514990581, "answer_id": 48079607, "question_id": 48079439, "link": "https://stackoverflow.com/questions/48079439/winapi-cw-usedefault-vs-cw-default/48079607#48079607", "title": "WinApi: CW_USEDEFAULT vs. CW_DEFAULT", "body": "<p><code>CW_DEFAULT</code> is defined in <code>float.h</code> and is used with functions to control the behaviour of floating point arithmetic. It has no relationship at all to <code>CreateWindow</code>.</p>\n\n<p>The use of <code>CW_USEDEFAULT</code> with <code>CreateWindow</code> is clearly documented in the documentation for <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms632679.aspx\" rel=\"noreferrer\"><code>CreateWindow</code></a>.</p>\n"}], "owner": {"reputation": 521, "user_id": 5411219, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/PB2qj.png?s=128&g=1", "display_name": "rosengrenen", "link": "https://stackoverflow.com/users/5411219/rosengrenen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2695, "favorite_count": 1, "accepted_answer_id": 48079607, "answer_count": 1, "score": 0, "last_activity_date": 1514990581, "creation_date": 1514990027, "question_id": 48079439, "link": "https://stackoverflow.com/questions/48079439/winapi-cw-usedefault-vs-cw-default", "title": "WinApi: CW_USEDEFAULT vs. CW_DEFAULT", "body": "<p>After trying to setup a new C++ WinApi project, and not getting the window to show (albeit showing an icon in the task bar), I realised that in the call to <code>CreateWindow()</code>, I was passing <code>CW_DEFAULT</code> instead of <code>CW_USEDEFAULT</code> to the position of the window (<code>x</code> and <code>y</code>, see the documentation of <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms632679(v=vs.85).aspx\" rel=\"nofollow noreferrer\">CreateWindow</a>). I've not managed to find anything about them from my google searches. My question is thus the difference between <code>CW_USEDEFAULT</code> and <code>CW_DEFAULT</code>, in regards to <code>CreateWindow</code> and its variations.</p>\n"}, {"tags": ["android", "c++", "opencv", "android-ndk"], "comments": [{"owner": {"reputation": 8388, "user_id": 5890227, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/M6Of5.png?s=128&g=1", "display_name": "Khalil Khalaf", "link": "https://stackoverflow.com/users/5890227/khalil-khalaf"}, "edited": false, "score": 0, "creation_date": 1514990298, "post_id": 48079386, "comment_id": 83132858, "body": "On which line does your error appear?"}, {"owner": {"reputation": 9770, "user_id": 888688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e1a439c266dcf5015373dbeae410ff5?s=128&d=identicon&r=PG", "display_name": "api55", "link": "https://stackoverflow.com/users/888688/api55"}, "edited": false, "score": 1, "creation_date": 1514990464, "post_id": 48079386, "comment_id": 83132954, "body": "So you convert the data to float with <code>trainOneMat.convertTo(float_data, CV_32FC1);</code> and then use the one that is not converted as your data <code>train_data.push_back(trainOneMat.reshape(1,1));</code> in this last line you should use <code>float_data</code>... Also you convert both mat to the same new matrix.... you use both times <code>float_data</code>"}, {"owner": {"reputation": 79, "user_id": 8938792, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5001fbb3f1bed68e070c179ba38b0c64?s=128&d=identicon&r=PG&f=1", "display_name": "Ber12345", "link": "https://stackoverflow.com/users/8938792/ber12345"}, "edited": false, "score": 0, "creation_date": 1514991142, "post_id": 48079386, "comment_id": 83133383, "body": "Thank you, very silly mistake."}], "owner": {"reputation": 79, "user_id": 8938792, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5001fbb3f1bed68e070c179ba38b0c64?s=128&d=identicon&r=PG&f=1", "display_name": "Ber12345", "link": "https://stackoverflow.com/users/8938792/ber12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514990049, "creation_date": 1514989847, "last_edit_date": 1514990049, "question_id": 48079386, "link": "https://stackoverflow.com/questions/48079386/error-with-training-data-and-label-format-opencv-c-ndk", "title": "Error with training data and label format OpenCV C++ NDK", "body": "<p>I am using the <strong>Android NDK, C++ OpenCV</strong> to train a knn model with 2 images as training data, and 2 labels. </p>\n\n<p>I convert the data to <strong>float and flatten</strong> the data to 1 row and create the labels as shown in the code below. </p>\n\n<p>However I get the error:</p>\n\n<pre><code>E/cv::error(): OpenCV Error: Assertion failed (samples.type() == 5 || samples.type() == 4) in void cv::ml::TrainDataImpl::setData(cv::InputArray, int, cv::InputArray,\n</code></pre>\n\n<p>I can't find any other posts containing this error as their samples.type () seem to equal different values / formats. Can anyone see where I'm going wrong? Thanks. </p>\n\n<pre><code>AAssetManager *mgr = AAssetManager_fromJava(env, assetManager);\n\n//Obtain training image 1\nAAsset *trainOne = AAssetManager_open(mgr, \"train1.jpg\", AASSET_MODE_UNKNOWN);\nlong sizeOfTrainOne = AAsset_getLength(trainOne);\nchar* bufferTrainOne = (char*)AAsset_getBuffer(trainOne);\nstd::vector&lt;char&gt; trainOneData(bufferTrainOne, bufferTrainOne + sizeOfTrainOne);\ncv::Mat trainOneMat = cv::imdecode(trainOneData, IMREAD_UNCHANGED);\n\n//Obtain training image 2\nAAsset *trainTwo = AAssetManager_open(mgr, \"train2.jpg\", AASSET_MODE_UNKNOWN);\nlong sizeOfTrainTwo = AAsset_getLength(trainTwo);\nchar* bufferTrainTwo = (char*)AAsset_getBuffer(trainTwo);\nstd::vector&lt;char&gt; trainTwoData(bufferTrainTwo, bufferTrainTwo + sizeOfTrainTwo);\n\ncv::Mat trainTwoMat = cv::imdecode(trainTwoData, IMREAD_UNCHANGED);\ntrainOneMat.convertTo(float_data, CV_32FC1);\ntrainTwoMat.convertTo(float_data, CV_32FC1);\n\n//Combine into training Mat\ntrain_data.push_back(trainOneMat.reshape(1,1));\ntrain_data.push_back(trainTwoMat.reshape(1,1));\n\nfloat labelOne = 1;\nfloat labelTwo = 2;\n\ntrain_label.push_back(labelOne);\ntrain_label.push_back(labelTwo);\n\nknn-&gt;train(train_data, ml::ROW_SAMPLE, train_label);\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "concurrency", "predicate", "condition-variable"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1514989914, "post_id": 48079257, "comment_id": 83132630, "body": "I&#39;d say you have a much worse problem, as you use <code>notify_all</code> which wakes <i>all</i> threads waiting on the condition variable. If you have many threads doing that you will have a rush and all will attempt to get the image. Instead use <code>notify_one</code> which should wake up a single &quot;random&quot; thread that will get the image."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1514996550, "post_id": 48079257, "comment_id": 83136650, "body": "I don&#39;t have time to read all that code, but your <code>bool frame_ready</code> variable sounds suspicious to me.  My immediate thought was, I probably would have an <code>int</code> variable that says <i>which</i> frame is ready (e.g., <code>newest_ready_frame_number</code>.)"}, {"owner": {"reputation": 16, "user_id": 2523101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ItbYo.jpg?s=128&g=1", "display_name": "akshatd", "link": "https://stackoverflow.com/users/2523101/akshatd"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1515033961, "post_id": 48079257, "comment_id": 83150805, "body": "Hey @Someprogrammerdude Thanks for responding! I was wondering if the threads are only copying the image data, would the all of them rushing at the same time still be a problem? there is no race condition on the image data itself!"}, {"owner": {"reputation": 16, "user_id": 2523101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ItbYo.jpg?s=128&g=1", "display_name": "akshatd", "link": "https://stackoverflow.com/users/2523101/akshatd"}, "reply_to_user": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1515036927, "post_id": 48079257, "comment_id": 83151340, "body": "@jameslarge That seems like a good solution actually! Right now, when I use <code>frame_ready</code>, The calling thread does not need to maintain any state, since it knows that if the earlier frame has not been taken, the value will be true, and false otherwise. If I do make it numbered, then the calling thread will somehow need to keep track of the last frame number it tried to retrieve. Am I making sense?"}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1515076142, "post_id": 48079257, "comment_id": 83169691, "body": "Yes.  Instead of waiting for <code>frame_ready</code> to become <code>true</code>, each thread waits for <code>newest_ready_frame_number</code> to become different from the last frame number that the thread previously knew about."}, {"owner": {"reputation": 16, "user_id": 2523101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ItbYo.jpg?s=128&g=1", "display_name": "akshatd", "link": "https://stackoverflow.com/users/2523101/akshatd"}, "reply_to_user": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1515469122, "post_id": 48079257, "comment_id": 83301684, "body": "thanks @jameslarge! I was also thinking if I could maintain a map of &lt;thread id&gt;&lt;frame_ready&gt; each thread could maintain its own state as well. Would that be less efficient in any way than just maintaining a frame number?"}], "owner": {"reputation": 16, "user_id": 2523101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ItbYo.jpg?s=128&g=1", "display_name": "akshatd", "link": "https://stackoverflow.com/users/2523101/akshatd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514989469, "creation_date": 1514989469, "question_id": 48079257, "link": "https://stackoverflow.com/questions/48079257/not-using-predicate-in-condition-variable-causing-slowdown", "title": "Not using predicate in condition variable causing slowdown", "body": "<p>I am trying to build a camera wrapper that allows other threads to retrieve a frame, while the wrapper handles all the processing in a separate thread.\nThe main purpose of using a condition variable to notify other threads of a new frame being ready is so that other threads do not get the same frame twice. In a way, this is a case of the producer-consumer problem.</p>\n\n<p>During initialization, I initialize a thread to do to the capture and processing:</p>\n\n<pre><code>int PiCamera::Init(){\n    camera_on_ = true;\n    capture_thread_ = std::thread(&amp;PiCamera::RetrieveFrames, this);\n    return 0;\n}\n</code></pre>\n\n<p>where RetrieveFrames is:</p>\n\n<pre><code>int PiCamera::RetrieveFrames1(){\nwhile(camera_on_){\n    camera_.grab();\n    frame_ready_ = true;\n    ready_condition_.notify_all(); // Notify on condition variable\n}\nreturn 0;\n}\n</code></pre>\n\n<p>Now when there is a single thread trying to get a frame, all the thread needs to call is:</p>\n\n<pre><code>int PiCamera::GetFrame1(cv::Mat &amp;image){\n    // Lock mutex\n    std::unique_lock&lt;std::mutex&gt; mutex_lock(ready_mutex_);\n    ready_condition_.wait(mutex_lock, [this](){return frame_ready_;});\n    camera_.retrieve(image);\n    frame_ready_ = false;\n    // Unlock mutex\n    mutex_lock.unlock();\n    return 0;\n}\n</code></pre>\n\n<p>Now, if two threads call the function GetFrame, each one of them will only be able to get alernate frames. However, I want any number of incoming threads to be able to get the latest frame as soon as it is available.</p>\n\n<p>Here, it seems like this is like a producer-consumer problem with multiple consumers, but all the consumers should be able to get the latest data available, and should not read the same data twice.</p>\n\n<p>Hence, I made the following changes:</p>\n\n<pre><code>int PiCamera::RetrieveFrames2(){\n    while(camera_on_){\n        camera_.grab();\n        // frame_ready_ = true;\n        ready_condition_.notify_all(); // Notify on condition variable\n    }\n    return 0;\n}\n\nint PiCamera::GetFrame2(cv::Mat &amp;image){\n    // Lock mutex\n    std::unique_lock&lt;std::mutex&gt; mutex_lock(ready_mutex_);\n    // ready_condition_.wait(mutex_lock, [this](){return frame_ready_;});\n    ready_condition_.wait(mutex_lock);\n    camera_.retrieve(image);\n    // frame_ready_ = false;\n    // Unlock mutex\n    mutex_lock.unlock();\n    return 0;\n}\n</code></pre>\n\n<p>Now I could use 2 threads to get the same frame, but I noticed some slowdowns in retrieving frames.</p>\n\n<p>The program I ran was kinda like this:</p>\n\n<pre><code>PiCamera camera();\ncamera.Init();\ncv::Point2f centroid_location;\ncv::Mat image;\nfloat time1[NFRAMES] = {};\nfloat time2[NFRAMES] = {};\nfloat time3[NFRAMES] = {};\ntimeval tstart, tend, t1, t2, t3;\n\nfor(int frame=0;frame&lt;NFRAMES;frame++){\n    gettimeofday(&amp;t1, nullptr);\n    camera-&gt;GetFrame(image);\n    gettimeofday(&amp;t2, nullptr);\n    time1[frame] = ElapsedSec(t1, t2)*1000;\n    GetCentroid(image, centroid_location);\n    // Just to increase workload\n    GetCentroid(image, centroid_location);\n    gettimeofday(&amp;t3, nullptr);\n    time2[frame] = ElapsedSec(t2, t3)*1000;\n}\n\ngettimeofday(&amp;tend, nullptr);\nfloat total_time = ElapsedSec(tstart, tend);\nfloat fps = (float)NFRAMES/total_time;\nstd::cout &lt;&lt; \"Camera took \" &lt;&lt; total_time &lt;&lt; \" seconds at \" &lt;&lt; fps &lt;&lt; \" FPS\\n\";\nstd::cout &lt;&lt; \"t1 \" &lt;&lt; ArrayMean(time1, NFRAMES) &lt;&lt; \" t2 \" &lt;&lt; ArrayMean(time2, NFRAMES) &lt;&lt; '\\n';\n</code></pre>\n\n<p>The camera is able to grab at a framerate of 120FPS, So I was hoping I would be able to process the frames at 120FPS as well.</p>\n\n<p>When I run the program using <em>RetrieveFrames1</em> and <em>GetFrames1</em>, I get this:</p>\n\n<pre><code>Camera took 8.39579 seconds at 119.107 FPS\nt1 0.367703 t2 8.02553\n</code></pre>\n\n<p>However, when I do this test using <em>RetrieveFrames2</em> and <em>GetFrames2</em>:</p>\n\n<pre><code>Camera took 13.7088 seconds at 72.946 FPS\nt1 4.74955 t2 8.95662\n</code></pre>\n\n<p>Even if i call <em>GetCentroid</em> Just once, I get the following results:</p>\n\n<pre><code>Camera took 8.29365 seconds at 120.574 FPS\nt1 3.98624 t2 4.30591\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Camera took 8.94322 seconds at 111.817 FPS\nt1 4.43984 t2 4.50159\n</code></pre>\n\n<p>Why are my threads taking so much longer to wait on the condition variable here when only thing I have done is to remove the predicate?</p>\n"}, {"tags": ["java", "c++", "reference", "shared-memory"], "comments": [{"owner": {"reputation": 378, "user_id": 7785984, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CgfJB.jpg?s=128&g=1", "display_name": "Arno C", "link": "https://stackoverflow.com/users/7785984/arno-c"}, "edited": false, "score": 0, "creation_date": 1514989841, "post_id": 48079253, "comment_id": 83132598, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/15414753/shared-memory-between-c-and-java-processes\">Shared memory between C++</a>"}, {"owner": {"reputation": 378, "user_id": 7785984, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CgfJB.jpg?s=128&g=1", "display_name": "Arno C", "link": "https://stackoverflow.com/users/7785984/arno-c"}, "edited": false, "score": 0, "creation_date": 1514989911, "post_id": 48079253, "comment_id": 83132627, "body": "and <a href=\"https://stackoverflow.com/questions/26790224/how-do-i-fetch-specific-bytes-from-a-file-knowing-the-offset-and-length\">this one</a>. I find the phrasing of your question rather abstract, so correct me if I&#39;m wrong."}, {"owner": {"reputation": 113, "user_id": 9001283, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MyH6tMA6zKo/AAAAAAAAAAI/AAAAAAAAAvM/c1XHO14_2u8/photo.jpg?sz=128", "display_name": "vagdevi pedalenka", "link": "https://stackoverflow.com/users/9001283/vagdevi-pedalenka"}, "reply_to_user": {"reputation": 378, "user_id": 7785984, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CgfJB.jpg?s=128&g=1", "display_name": "Arno C", "link": "https://stackoverflow.com/users/7785984/arno-c"}, "edited": false, "score": 0, "creation_date": 1514990883, "post_id": 48079253, "comment_id": 83133235, "body": "Thanks Arno C, my intention is to share the byte array in the memory, I don&#39;t want to load file as I am getting byte array from the remote source. writing byte array into file in c++ reading it in java makes overhead. So I am not preferring to load a file into memory"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1515008236, "post_id": 48079253, "comment_id": 83142754, "body": "I think you underestimate the file cache. &quot;Writing&quot; a file can be very cheap."}], "owner": {"reputation": 113, "user_id": 9001283, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MyH6tMA6zKo/AAAAAAAAAAI/AAAAAAAAAvM/c1XHO14_2u8/photo.jpg?sz=128", "display_name": "vagdevi pedalenka", "link": "https://stackoverflow.com/users/9001283/vagdevi-pedalenka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514989439, "creation_date": 1514989439, "question_id": 48079253, "link": "https://stackoverflow.com/questions/48079253/do-we-have-any-mechanism-in-java-to-directly-load-byte-at-specified-offset-from", "title": "Do we have any mechanism in java to directly load byte at specified offset from memory", "body": "<p>I am transferring  byte buffer data from the C++ function to java method trough the JNI. </p>\n\n<p>As I read in one article(<a href=\"https://stackoverflow.com/questions/25396664/shared-memory-between-two-jvms\">Shared Memory between two JVMs</a>). mappedByteBuffer allows to read the data from memory, but it will load the file into memory.\nI don't want to use file because byte buffer get filled in C++ from remote source, if I use file it will overhead the file reading and writing calls and degrades the performance, so eliminating the MappedByteBuffer</p>\n\n<p>My use case:\nIs there any mechanism in java to read the byte array at the particular offset?\nHow to share the memory between c++ function and java method in same process?\nor\nDo we have any mechanism to assign specified offset to the byte array variable in java</p>\n\n<p>Thanks in advance...</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1514987919, "post_id": 48078783, "comment_id": 83131544, "body": "Unrelated to your problem, but the result of the <code>sizeof</code> operator is of type <code>size_t</code> which can&#39;t be used with the <code>&quot;%d&quot;</code> format specifier. Use e.g. <code>&quot;%zu&quot;</code> instead."}, {"owner": {"reputation": 355, "user_id": 662642, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2f5a3ba131491ef1fe07de68d8e62cfc?s=128&d=identicon&r=PG", "display_name": "PatB", "link": "https://stackoverflow.com/users/662642/patb"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1514987983, "post_id": 48078783, "comment_id": 83131583, "body": "Thanks - perhaps g++ could do with a compiler warning on this."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 3, "creation_date": 1514988063, "post_id": 48078783, "comment_id": 83131625, "body": "<i>&quot;perhaps g++ could do with a compiler warning on this&quot;</i> <a href=\"https://wandbox.org/permlink/TkhBFwqvhSCLgY60\" rel=\"nofollow noreferrer\">wandbox.org/permlink/TkhBFwqvhSCLgY60</a> You have to actually enable the warnings."}, {"owner": {"reputation": 355, "user_id": 662642, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2f5a3ba131491ef1fe07de68d8e62cfc?s=128&d=identicon&r=PG", "display_name": "PatB", "link": "https://stackoverflow.com/users/662642/patb"}, "edited": false, "score": 0, "creation_date": 1514988150, "post_id": 48078783, "comment_id": 83131664, "body": "By the way, this example is boiled down from a Vector4f class which was working (in terms of aligned malloc) when compiled for windows. This problem has cropped up in the course of converting the code to run on linux."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 5, "creation_date": 1514988239, "post_id": 48078783, "comment_id": 83131714, "body": "Related: <a href=\"https://stackoverflow.com/questions/45781692/parameter-size-of-member-operator-new-in-c/45782370#45782370\" title=\"parameter size of member operator new in c\">stackoverflow.com/questions/45781692/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 4, "creation_date": 1514988555, "post_id": 48078783, "comment_id": 83131866, "body": "<i>perhaps g++ could do with a compiler warning on this</i> don&#39;t use printf, use cout."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 8, "creation_date": 1514989460, "post_id": 48078783, "comment_id": 83132370, "body": "If you are defining <code>new[]</code> but not <code>delete[]</code>, the compiler probably assumes you will never call the standard <code>delete[]</code>, because it would be UB to do so. So it doesn&#39;t add the 8 bytes it needs for bookkeeping. You probably don&#39;t want to use <code>new[]</code> anyway. Use <code>std::vector</code> with your own allocator instead. If you insist on <code>new[]</code>, round up the amount of memory you allocate so that it is divisible by the alignment, and don&#39;t use the initial portion. If you are asked to allocate e.g. <code>x=16n+8</code> bytes, allocate <code>p=aligned_alloc(x+8)</code> and return <code>p+8</code>; in <code>operator delete[]</code> call <code>free(p-8)</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1514989615, "post_id": 48078783, "comment_id": 83132457, "body": "There&#39;s also an overaligned <code>operator new</code> in C++17, you may want to use it if your compiler supports it."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1514994721, "post_id": 48078783, "comment_id": 83135592, "body": "<i>&quot;The linked answer is certainly relevant, but it does not address the problem of ensuring correct memory alignment.&quot;</i> It answers the question in your title and the 1st question in the body. Herein lies the problem of asking &#39;bonus&#39; questions later in the text."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1514995401, "post_id": 48078783, "comment_id": 83135979, "body": "Can&#39;t you just use <code>alignas(16)</code> instead of overriding new/delete?"}], "answers": [{"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1515011670, "post_id": 48081319, "comment_id": 83144244, "body": "If <code>aligned_alloc</code> returns an address that is a multiple of <code>sz_obj</code>, then what you pass to <code>free</code> must also be a multiple of <code>sz_obj</code>. So your magic number is <code>((uintptr_t)p2) % sz_obj</code>."}, {"owner": {"reputation": 355, "user_id": 662642, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2f5a3ba131491ef1fe07de68d8e62cfc?s=128&d=identicon&r=PG", "display_name": "PatB", "link": "https://stackoverflow.com/users/662642/patb"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1515012225, "post_id": 48081319, "comment_id": 83144463, "body": "I think you mean &#39;p2 - (((uint8_t)p2)%sz_obj)&#39;, which is equivalent to the expression in array_free(). You can turn on the printfs in the code to verify it."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1515012789, "post_id": 48081319, "comment_id": 83144758, "body": "no, not <code>(uint8_t)p2</code>!  <code>((uintptr_t)p2) % sz_obj</code> is the magic number. <code>(uint8_t)*p2 - ((uintptr_t)p2) % sz_obj</code> is the pointer you pass to <code>free</code>."}], "tags": [], "owner": {"reputation": 355, "user_id": 662642, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2f5a3ba131491ef1fe07de68d8e62cfc?s=128&d=identicon&r=PG", "display_name": "PatB", "link": "https://stackoverflow.com/users/662642/patb"}, "is_accepted": true, "score": 2, "last_activity_date": 1515017487, "last_edit_date": 1515017487, "creation_date": 1514996840, "answer_id": 48081319, "question_id": 48078783, "link": "https://stackoverflow.com/questions/48078783/how-do-i-allocate-memory-aligned-c-object-arrays/48081319#48081319", "title": "How do I allocate memory-aligned C++ object arrays?", "body": "<p>It looks as though this will do for me:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\ninline void *array_alloc( size_t sz_obj, size_t sz_req ) {\n    size_t r = sz_req % sz_obj;\n    size_t ofs = sz_obj - r;\n    size_t sz = sz_req + ofs;\n    void *p1 = aligned_alloc( sz_obj, sz );\n    void *p2 = (void*) (((uintptr_t ) p1) + ofs);\n  //printf( \"sz_obj: %zx, sz_req: %zx, r: %zx, ofs: %zx, sz: %zx\\np1: %p\\np2: %p\\n\\n\", sz_obj, sz_req, r, ofs, sz, p1, p2 );\n    return p2;\n}\n\ninline void array_free( size_t sz_obj, void *p2 ) {\n    void *p1 = (void*) (((uint8_t*)p2) - (((uintptr_t)p2) % sz_obj));\n  //printf( \"\\np2: %p\\np1: %p\", p2, p1 );\n    free( p1 );\n}\n\nclass W16 { public:\n\n    float w[ 16 ];\n    W16() {}\n    void *operator new( size_t sz ) { return aligned_alloc( 16, sz ); } \n    void *operator new[]( size_t sz ) { return array_alloc( sizeof( W16 ), sz ); }\n    void operator delete( void *p, size_t sz ) { free( p ); }\n    void operator delete[]( void *p, size_t sz ) { array_free( sizeof( W16 ), p ); }\n};\n\nint main( int argc, char **argv ) {\n  //printf( \"sizeof( W16 ): %zx\\n\", sizeof( W16 ));\n    W16 *q = new W16[ 16 ];\n    printf( \"&amp;q[0]: %p\\n\", &amp;q[0] );\n    delete[] q;\n}\n</code></pre>\n\n<p><strong>EDIT</strong> Thanks to n.m., this code works without a magic number.</p>\n"}], "owner": {"reputation": 355, "user_id": 662642, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2f5a3ba131491ef1fe07de68d8e62cfc?s=128&d=identicon&r=PG", "display_name": "PatB", "link": "https://stackoverflow.com/users/662642/patb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 759, "favorite_count": 0, "closed_date": 1514996887, "accepted_answer_id": 48081319, "answer_count": 1, "score": 8, "last_activity_date": 1515017487, "creation_date": 1514987567, "last_edit_date": 1514998951, "question_id": 48078783, "link": "https://stackoverflow.com/questions/48078783/how-do-i-allocate-memory-aligned-c-object-arrays", "closed_reason": "Duplicate", "title": "How do I allocate memory-aligned C++ object arrays?", "body": "<p>I am seeing a problem with operator new[]:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nclass V4 { public:\n    float v[ 4 ];\n    V4() {}\n    void *operator new( size_t sz ) { return aligned_alloc( 16, sz ); } \n    void *operator new[]( size_t sz ) { printf( \"sz: %zu\\n\", sz ); return aligned_alloc( 16, sz ); }\n    void operator delete( void *p, size_t sz ) { free( p ); }\n  //void operator delete[]( void *p, size_t sz ) { free( p ); }\n};\n\nclass W4 { public:\n    float w[ 4 ];\n    W4() {}\n    void *operator new( size_t sz ) { return aligned_alloc( 16, sz ); } \n    void *operator new[]( size_t sz ) { printf( \"sz: %zu\\n\", sz ); return aligned_alloc( 16, sz ); }\n    void operator delete( void *p, size_t sz ) { free( p ); }\n    void operator delete[]( void *p, size_t sz ) { free( p ); }\n};\n\nint main( int argc, char **argv ) { \n\n    printf( \"sizeof( V4 ): %zu\\n\", sizeof( V4 ));\n    V4 *p = new V4[ 1 ];\n    printf( \"p: %p\\n\", p );\n\n    printf( \"sizeof( W4 ): %zu\\n\", sizeof( W4 ));\n    W4 *q = new W4[ 1 ];\n    printf( \"q: %p\\n\", q );\n\n    exit(0);\n}\n</code></pre>\n\n<p>Produces:</p>\n\n<pre><code>$ g++ -Wall main.cpp &amp;&amp; ./a.out\nsizeof( V4 ): 16\nsz: 16\np: 0x55be98a10030\nsizeof( W4 ): 16\nsz: 24\nq: 0x55be98a10058\n</code></pre>\n\n<p>Why does the alloc size increase to 24 when I include the operator delete[]? This is screwing up my aligned malloc.</p>\n\n<pre><code>$ g++ --version\ng++ (Debian 7.2.0-18) 7.2.0\nCopyright (C) 2017 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n</code></pre>\n\n<p>From looking at other questions, it seems as though the extra 8 bytes may be being used to store the array size. Even if this is expected behaviour, why is it triggered by operator delete[], and what is the correct procedure for allocating memory-aligned arrays?</p>\n\n<p><strong>EDIT</strong> Thanks, the linked questions appear to be relevant. I still think the question as asked needs an answer, however. It ought to be possible to change the example code to produce memory-aligned arrays without recourse to std::vector, in my opinion. My current thinking is that it will be necessary to allocate a yet-larger block of bytes which are 16-byte aligned, and return the pointer such that the initial 8 bytes bring the rest of the block to alignment on the 16-byte boundary. The delete[] operator would then have to perform the reverse operation before calling free(). This is pretty disgusting, but I think it is required to satisfy both the calling code (C runtime?) (which requires its 8 bytes for size storage) - and the use case which is to get 16-byte aligned Vector4s.</p>\n\n<p><strong>EDIT</strong> The linked answer is certainly relevant, but it does not address the problem of ensuring correct memory alignment.</p>\n\n<p><strong>EDIT</strong> It looks like this code will do what I want, but I don't like the magic number 8 in delete[]:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nclass W16 { public:\n\n    float w[ 16 ];\n    W16() {}\n    void *operator new( size_t sz ) { return aligned_alloc( 16, sz ); } \n    void *operator new[]( size_t sz ) {\n        size_t r = sz % sizeof( W16 );\n        size_t ofs = sizeof( W16 ) - r;\n        size_t _sz = sz + ofs;\n        void *p1 = aligned_alloc( sizeof( W16 ), _sz );\n        void *p2 = ((uint8_t *) p1) + ofs;\n        printf( \"sizeof( W16 ): %zx, sz: %zx, r: %zx, ofs: %zx, _sz: %zx\\np1: %p\\np2: %p\\n\\n\", sizeof( W16 ), sz, r, ofs, _sz, p1, p2 );\n        return p2;\n    }\n    void operator delete( void *p, size_t sz ) { free( p ); }\n    void operator delete[]( void *p, size_t sz ) {\n    void *p1 = ((int8_t*) p) + 8 - sizeof( W16 );\n        printf( \"\\np2: %p\\np1: %p\", p, p1 );\n        free( p1 );\n    }\n};\n\nint main( int argc, char **argv ) {\n\n    printf( \"sizeof( W16 ): %zx\\n\", sizeof( W16 ));\n    W16 *q = new W16[ 16 ];\n    printf( \"&amp;q[0]: %p\\n\", &amp;q[0] );\n    delete[] q;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ g++ -Wall main.cpp &amp;&amp; ./a.out \nsizeof( W16 ): 40\nsizeof( W16 ): 40, sz: 408, r: 8, ofs: 38, _sz: 440\np1: 0x559876c68080\np2: 0x559876c680b8\n\n&amp;q[0]: 0x559876c680c0\n\np2: 0x559876c680b8\np1: 0x559876c68080\n</code></pre>\n\n<p><strong>EDIT</strong> Title changed from feedback in comments. I don't think this is a 'duplicate' of the linked answer anymore, though I don't know if I can get it removed.</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1514987483, "post_id": 48078718, "comment_id": 83131300, "body": "As usual when posting questions about build errors, you should tell us the errors you get. Copy (as text) the full and complete output of the compiler and/or linker, and paste it inside the question body. Since that&#39;s missing <a href=\"http://idownvotedbecau.se/itsnotworking/\" rel=\"nofollow noreferrer\">idownvotedbecau.se/itsnotworking</a>"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1514987627, "post_id": 48078718, "comment_id": 83131393, "body": "<b>TL;DR</b>: <code>typename traits::template arg&lt;1&gt;::type x = 0;</code>"}, {"owner": {"reputation": 3281, "user_id": 1624277, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Qdnwb.png?s=128&g=1", "display_name": "e271p314", "link": "https://stackoverflow.com/users/1624277/e271p314"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1514987974, "post_id": 48078718, "comment_id": 83131572, "body": "Thanks @StoryTeller for some reason, this is a c++ syntax I always forget"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1514988070, "post_id": 48078718, "comment_id": 83131627, "body": "All part of the joy of C++, for everyone, not just you. At least compilers are good at hinting. The note under the error tries to be helpful."}], "owner": {"reputation": 3281, "user_id": 1624277, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Qdnwb.png?s=128&g=1", "display_name": "e271p314", "link": "https://stackoverflow.com/users/1624277/e271p314"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "closed_date": 1514987608, "answer_count": 0, "score": 0, "last_activity_date": 1514987732, "creation_date": 1514987349, "last_edit_date": 1514987732, "question_id": 48078718, "link": "https://stackoverflow.com/questions/48078718/getting-lambda-arguments-types-inside-function-is-not-working", "closed_reason": "Duplicate", "title": "Getting lambda arguments types inside function is not working", "body": "<p>A follow up question regarding <a href=\"https://stackoverflow.com/questions/7943525/is-it-possible-to-figure-out-the-parameter-type-and-return-type-of-a-lambda\">Is it possible to figure out the parameter type and return type of a lambda?</a>. I tested the code and it works fine for me but only when I call it from <code>main()</code>, when I call the code from <code>Do</code> the code does not compile, please let me know if you can uncomment the lines in <code>Do</code> function and compile the code</p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;iostream&gt;\n#include &lt;typeinfo&gt;\n#include &lt;cxxabi.h&gt;\n#include &lt;memory&gt;\n\ntemplate &lt;class T&gt;\nstd::string GetTypeName()\n{\n  // http://stackoverflow.com/questions/23266391/find-out-the-type-of-auto/23266701#23266701\n  std::unique_ptr&lt;char, void(*)(void*)&gt; name{abi::__cxa_demangle(typeid(T).name(), 0, 0, nullptr), std::free};\n  return name.get();\n}\n\ntemplate &lt;typename T&gt;\nstruct function_traits\n    : public function_traits&lt;decltype(&amp;T::operator())&gt;\n{};\n\ntemplate &lt;typename ClassType, typename ReturnType, typename... Args&gt;\nstruct function_traits&lt;ReturnType(ClassType::*)(Args...) const&gt;\n{\n    enum { arity = sizeof...(Args) };\n\n    typedef ReturnType result_type;\n\n    template &lt;size_t i&gt;\n    struct arg\n    {\n        typedef typename std::tuple_element&lt;i, std::tuple&lt;Args...&gt;&gt;::type type;\n    };\n};\n\ntemplate &lt;typename FuncType&gt;\nvoid Do(FuncType func)\n{\n  typedef function_traits&lt;decltype(func)&gt; traits;\n  //typename traits::arg&lt;1&gt;::type x = 0;\n  std::cout &lt;&lt; GetTypeName&lt;traits&gt;() &lt;&lt; std::endl;\n  //std::cout &lt;&lt; GetTypeName&lt;traits::arg&lt;1&gt;::type&gt;() &lt;&lt; std::endl;\n}\n\nint main()\n{\n  auto func = [] (int x, float y, double z) -&gt; void { };\n  Do(func);\n  typedef function_traits&lt;decltype(func)&gt; traits;\n  traits::arg&lt;1&gt;::type x = 0;\n  std::cout &lt;&lt; GetTypeName&lt;traits&gt;() &lt;&lt; std::endl;\n  std::cout &lt;&lt; GetTypeName&lt;traits::arg&lt;1&gt;::type&gt;() &lt;&lt; std::endl;\n  return 0;\n}\n</code></pre>\n\n<p>The compilation error is</p>\n\n<pre><code>test.cpp: In function \u2018void Do(FuncType)\u2019:\ntest.cpp:37:20: error: non-template \u2018arg\u2019 used as template\n   typename traits::arg&lt;1&gt;::type x = 0;\n                    ^\ntest.cpp:37:20: note: use \u2018traits::template arg\u2019 to indicate that it is a template\ntest.cpp:37:20: error: declaration does not declare anything [-fpermissive]\n</code></pre>\n\n<p>I use <code>g++ (GCC) 5.3.1 20160406 (Red Hat 5.3.1-6)</code>, the compilation command is <code>g++ -std=c++11 test.cpp -o test</code></p>\n"}, {"tags": ["c++", "multithreading", "vector", "thread-safety"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1514987088, "post_id": 48078492, "comment_id": 83131086, "body": "I don&#39;t see any reason why such approach wouldn&#39;t work, but it may be worth to try to supply an instance of vector (containing regular <code>uint8_t</code>) for each thread and then merge the results."}, {"owner": {"reputation": 31, "user_id": 9111264, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PXUz_KZbtUo/AAAAAAAAAAI/AAAAAAAAAHM/hzOSO_hW__g/photo.jpg?sz=128", "display_name": "Ribeiro Silva", "link": "https://stackoverflow.com/users/9111264/ribeiro-silva"}, "edited": false, "score": 0, "creation_date": 1514987341, "post_id": 48078492, "comment_id": 83131224, "body": "The vector has a fixed size known only at run time."}, {"owner": {"reputation": 31, "user_id": 9111264, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PXUz_KZbtUo/AAAAAAAAAAI/AAAAAAAAAHM/hzOSO_hW__g/photo.jpg?sz=128", "display_name": "Ribeiro Silva", "link": "https://stackoverflow.com/users/9111264/ribeiro-silva"}, "edited": false, "score": 0, "creation_date": 1514987559, "post_id": 48078492, "comment_id": 83131346, "body": "I can not divide the vector between threads because it represents a geometrical bit mapping (rectangle). The threads work in different regions but at the boundary&#39;s they can share some bytes."}, {"owner": {"reputation": 1724, "user_id": 764191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tefZa.jpg?s=128&g=1", "display_name": "SChepurin", "link": "https://stackoverflow.com/users/764191/schepurin"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1514989083, "post_id": 48078492, "comment_id": 83132176, "body": "&quot;It is totally okay, to access std::vector from multiple threads, if you read objects, or if you write to different objects&quot;. As @VTT suggests in the comment above."}], "answers": [{"tags": [], "owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "is_accepted": false, "score": 3, "last_activity_date": 1514989289, "last_edit_date": 1514989289, "creation_date": 1514987507, "answer_id": 48078768, "question_id": 48078492, "link": "https://stackoverflow.com/questions/48078492/multiple-vector-writers-without-locking/48078768#48078768", "title": "Multiple vector writers without locking", "body": "<blockquote>\n  <p>It compiled with GCC without errors or warnings</p>\n</blockquote>\n\n<p>That doesn't mean anything because compilers don't perform that sort of concurrency analysis. There are dedicated static analysis tools that may do this with varying levels of success.</p>\n\n<blockquote>\n  <p>Can I use only an <code>atomic_fetch_or</code> ...</p>\n</blockquote>\n\n<p>you certainly can, and it will be safe at the level of each individual <code>std::atomic&lt;uint8_t&gt;</code>.</p>\n\n<blockquote>\n  <p>... the vector will become thread safe?</p>\n</blockquote>\n\n<p>it's not sufficient that each element is accessed safely. You specifically need to avoid any operation that invalidates iterators (swap, resize, insert, push_back etc.).</p>\n\n<p>I'd hesitate to say vector is thread-safe in this context - but you're limiting yourself to a thread-safe subset of its interface, so it will work correctly.</p>\n\n<hr>\n\n<p>Note that as VTT suggests, keeping a separate partial vector per thread is better if possible. Partly because it's easier to prove correct, and partly because it avoids false sharing between cores.</p>\n"}, {"tags": [], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "is_accepted": false, "score": 2, "last_activity_date": 1514992854, "last_edit_date": 1514992854, "creation_date": 1514987819, "answer_id": 48078846, "question_id": 48078492, "link": "https://stackoverflow.com/questions/48078492/multiple-vector-writers-without-locking/48078846#48078846", "title": "Multiple vector writers without locking", "body": "<p><strong>Yes this is guaranteed to be thread safe</strong> due to <a href=\"https://en.wikipedia.org/wiki/Linearizability\" rel=\"nofollow noreferrer\">atomic opperations</a> being guaranteed of:</p>\n\n<blockquote>\n  <p>Isolation from interrupts, signals, concurrent processes and threads</p>\n</blockquote>\n\n<p>Thus when you access an element of <code>MapVis</code> atomically you're guaranteed that any other process writing to it has already completed. And that your process will not be interrupted till it finishes writing.</p>\n\n<p>The concern if you were using non-atomic variables would be that:</p>\n\n<ol>\n<li>Thread A fetches the value of <code>MapVis[i]</code></li>\n<li>Thread B fetches the value of <code>MapVis[i]</code></li>\n<li>Thread A writes the ored value to <code>MapVis[i]</code></li>\n<li>Thread B writes the ored value to <code>MapVis[i]</code></li>\n</ol>\n\n<p>As you can see Thread B needed to wait until Thread A had finished writing otherwise it's just going to stomp Thread A's changes to <code>MapVis[i]</code>. With atomic variables the fetch and write cannot be interrupted by concurrent threads. Meaning that Thread B couldn't interrupt Thread A's read-write operations.</p>\n"}], "owner": {"reputation": 31, "user_id": 9111264, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PXUz_KZbtUo/AAAAAAAAAAI/AAAAAAAAAHM/hzOSO_hW__g/photo.jpg?sz=128", "display_name": "Ribeiro Silva", "link": "https://stackoverflow.com/users/9111264/ribeiro-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1514992854, "creation_date": 1514986431, "last_edit_date": 1514988778, "question_id": 48078492, "link": "https://stackoverflow.com/questions/48078492/multiple-vector-writers-without-locking", "title": "Multiple vector writers without locking", "body": "<p>I have a few threads writing in a vector. It's possible that different threads try to write the same byte. There is no reads. Can I use only an <code>atomic_fecth_or()</code>, like in the example, so the vector will become thread safe? It compiled with GCC without errors or warnings. </p>\n\n<pre><code>    std::vector&lt;std::atomic&lt;uint8_t&gt;&gt; MapVis(1024*1024); \n\n    void threador()\n    {\n    ...\n    std::atomic_fetch_or(&amp;MapVis[i], testor1); \n    }\n</code></pre>\n"}, {"tags": ["c++", "opencv", "neural-network", "opencv3.3"], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 5291590, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/657093137759432/picture?type=large", "display_name": "Ayush Pandey", "link": "https://stackoverflow.com/users/5291590/ayush-pandey"}, "edited": false, "score": 0, "creation_date": 1514995211, "post_id": 48078542, "comment_id": 83135859, "body": "Shouldn&#39;t the first part of the documentation I mentioend be updated then ... its kind of confusing"}], "tags": [], "owner": {"reputation": 2089, "user_id": 4766168, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xrRVf1o5oQk/AAAAAAAAAAI/AAAAAAAAAEk/Uu9PgLhfHwA/photo.jpg?sz=128", "display_name": "Dmitrii Z.", "link": "https://stackoverflow.com/users/4766168/dmitrii-z"}, "is_accepted": true, "score": 4, "last_activity_date": 1514986966, "last_edit_date": 1514986966, "creation_date": 1514986644, "answer_id": 48078542, "question_id": 48078187, "link": "https://stackoverflow.com/questions/48078187/does-opencv-initialize-weights-matrix-with-zeros-cvmlann-mlp/48078542#48078542", "title": "Does OpenCV initialize weights matrix with zeros, cv::ml::ANN_MLP", "body": "<p>Do you have any reason to doubt documentation? OpenCV is open source library, so you can see what is beneath by yourself <a href=\"https://github.com/opencv/opencv/blob/master/modules/ml/src/ann_mlp.cpp\" rel=\"nofollow noreferrer\">here</a></p>\n\n<pre><code>ANN_MLPImpl()\n{\n    clear();\n    setActivationFunction( SIGMOID_SYM, 0, 0);\n    setLayerSizes(Mat());\n    setTrainMethod(ANN_MLP::RPROP, 0.1, FLT_EPSILON);\n}\n</code></pre>\n\n<p>When you call <code>train</code> <code>init_weights()</code> may be called</p>\n\n<pre><code>bool train( const Ptr&lt;TrainData&gt;&amp; trainData, int flags )\n{\n    // Some code\n    // ... and link weights\n    if( !(flags &amp; UPDATE_WEIGHTS) )\n        init_weights();\n    // Even more code\n</code></pre>\n\n<p>And here is <code>init_weights()</code></p>\n\n<pre><code>void init_weights()\n{\n    //... More code\n        // initialize weights using Nguyen-Widrow algorithm\n        for( j = 0; j &lt; n2; j++ )\n        {\n            double s = 0;\n           // .. more initialization code\n</code></pre>\n"}], "owner": {"reputation": 505, "user_id": 5291590, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/657093137759432/picture?type=large", "display_name": "Ayush Pandey", "link": "https://stackoverflow.com/users/5291590/ayush-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 48078542, "answer_count": 1, "score": 0, "last_activity_date": 1514986966, "creation_date": 1514985446, "question_id": 48078187, "link": "https://stackoverflow.com/questions/48078187/does-opencv-initialize-weights-matrix-with-zeros-cvmlann-mlp", "title": "Does OpenCV initialize weights matrix with zeros, cv::ml::ANN_MLP", "body": "<p>Its mentioned on OpenCV docs <a href=\"https://docs.opencv.org/trunk/d0/dce/classcv_1_1ml_1_1ANN__MLP.html\" rel=\"nofollow noreferrer\">here</a></p>\n\n<blockquote>\n  <p>Artificial Neural Networks - Multi-Layer Perceptrons.</p>\n  \n  <p>Unlike many other models in ML that are constructed and trained at\n  once, in the MLP model these steps are separated. First, a network\n  with the specified topology is created using the non-default\n  constructor or the method ANN_MLP::create. <strong>All the weights are set\n  to zeros.</strong> Then, the network is trained using a set of input and\n  output vectors. The training procedure can be repeated more than once,\n  that is, the weights can be adjusted based on the new training data.</p>\n</blockquote>\n\n<p>And also it is mentioned:</p>\n\n<blockquote>\n  <p>UPDATE_WEIGHTS    </p>\n  \n  <p>Update the network weights, rather than compute them from scratch.\n  <strong>In the latter case the weights are initialized using the Nguyen-Widrow algorithm</strong>.</p>\n</blockquote>\n\n<p>So I wanted to know what happens exactly with the weight initialization when I go onto train a model. Answers related to OpenCV 3.3.1 are also appreciated</p>\n"}, {"tags": ["c++", "templates", "dll"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1514985581, "post_id": 48078186, "comment_id": 83130224, "body": "Header only libraries come to mind. Most of <code>boost</code> is header only as a matter of fact."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 2, "creation_date": 1514985767, "post_id": 48078186, "comment_id": 83130329, "body": "You can make common specializations of those templates to be imported from the dll to save size of binaries if this library is supposed to be used in many executables."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1514985953, "post_id": 48078186, "comment_id": 83130435, "body": "There&#39;s also the option of making the template itself a &quot;thin&quot; wrapper around code that is completely type unaware. Essentially, the template generates the boiler-plate on the client side, while the DLL contains the stuff that do heavy lifting."}, {"owner": {"reputation": 1595, "user_id": 1119161, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/4941b50fab94bddbe63b102f2c79d2da?s=128&d=identicon&r=PG", "display_name": "dsp_user", "link": "https://stackoverflow.com/users/1119161/dsp-user"}, "edited": false, "score": 0, "creation_date": 1514986648, "post_id": 48078186, "comment_id": 83130831, "body": "The more I think about this, the more it doesn&#39;t make sense. The code for the templates will only be generated if there&#39;s code calling it, right?"}, {"owner": {"reputation": 1595, "user_id": 1119161, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/4941b50fab94bddbe63b102f2c79d2da?s=128&d=identicon&r=PG", "display_name": "dsp_user", "link": "https://stackoverflow.com/users/1119161/dsp-user"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1514988595, "post_id": 48078186, "comment_id": 83131889, "body": "@VTT, You&#39; re right about the template specializations, though that&#39;s not really generic."}, {"owner": {"reputation": 1595, "user_id": 1119161, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/4941b50fab94bddbe63b102f2c79d2da?s=128&d=identicon&r=PG", "display_name": "dsp_user", "link": "https://stackoverflow.com/users/1119161/dsp-user"}, "edited": false, "score": 0, "creation_date": 1514988722, "post_id": 48078186, "comment_id": 83131956, "body": "I didn&#39;t mean to ask this as a trick question or anything. I&#39;m just interested in alternatives (e.g header libraries as suggested in a comment)."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1514992564, "post_id": 48078186, "comment_id": 83134287, "body": "@dsp_user Not clear what you are asking. You can put you code in DLL, but templates must be in header file. <code>GetProcAddress</code> is hard to use with C++ code as you will have to take mangling in account. And why do you need templates if you want dynamically load DLL?"}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1515000040, "post_id": 48078186, "comment_id": 83138626, "body": "<i>&quot;So, does the above mean that we can&#39;t really use templates in a dll (if they&#39;re to be used externally)?&quot;</i> - Yes. <i>&quot;And what are (if any) alternatives, apart from static libraries?&quot;</i> - Don&#39;t use a template in the DLL interface."}, {"owner": {"reputation": 1595, "user_id": 1119161, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/4941b50fab94bddbe63b102f2c79d2da?s=128&d=identicon&r=PG", "display_name": "dsp_user", "link": "https://stackoverflow.com/users/1119161/dsp-user"}, "reply_to_user": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1515011457, "post_id": 48078186, "comment_id": 83144160, "body": "@Christian Hackl Ok, I can&#39;t object to what you wrote there."}], "owner": {"reputation": 1595, "user_id": 1119161, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/4941b50fab94bddbe63b102f2c79d2da?s=128&d=identicon&r=PG", "display_name": "dsp_user", "link": "https://stackoverflow.com/users/1119161/dsp-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514999818, "creation_date": 1514985443, "last_edit_date": 1514999818, "question_id": 48078186, "link": "https://stackoverflow.com/questions/48078186/dynamic-link-libraries-and-templates", "title": "Dynamic link libraries and templates", "body": "<p>In order to support generic programming, C++ has templates. But since templates are purely a compile-time construct (much like anything else in C++), it looks like there's not much point in trying to use them in a dll.</p>\n\n<p>Let's say we want to create a math library that comprises a number of templated functions. As long as this library is statically linked with an application, we're OK. You can argue\nthat we can statically link a <code>dll</code> to an application too (provided you have access to the source/or object files) but most of the time we just want to use the dll (by loading it via <code>LoadLibrary</code> and calling a particular function with\n<code>GetProcAddress</code>)</p>\n\n<p>So, does the above mean that we can't really use templates in a dll (if they're to be used externally)? And what are (if any) alternatives, apart from static libraries? </p>\n"}, {"tags": ["c++", "c++17", "inline-variable"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1514985079, "post_id": 48077958, "comment_id": 83129955, "body": "The unnamed namespace gives everything within internal linkage... And <code>all_true_v</code> has internal linkage anyway for the very same reason @Oliv quoted on your other question (same bullet in C++14). So the two code snippets you presented aren&#39;t at all compatible."}, {"owner": {"reputation": 8741, "user_id": 125997, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sjHUr.png?s=128&g=1", "display_name": "Danra", "link": "https://stackoverflow.com/users/125997/danra"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1514998835, "post_id": 48077958, "comment_id": 83137975, "body": "@StoryTeller Of course. My mix up."}], "answers": [{"tags": [], "owner": {"reputation": 2120, "user_id": 9167702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7936df8ed092bb16463bde29df803d6e?s=128&d=identicon&r=PG&f=1", "display_name": "Tobi", "link": "https://stackoverflow.com/users/9167702/tobi"}, "is_accepted": true, "score": 2, "last_activity_date": 1514985839, "creation_date": 1514985839, "answer_id": 48078320, "question_id": 48077958, "link": "https://stackoverflow.com/questions/48077958/defining-global-constexpr-variables-in-anonymous-namespace-the-same-as-making-th/48078320#48078320", "title": "Defining global constexpr variables in anonymous namespace the same as making them inline?", "body": "<p>consider</p>\n\n<pre><code>    bool const* g_b= &amp;all_true_v&lt;true&gt;;\n</code></pre>\n\n<p>this will have the same address in every translation unit for the <code>inline constexpr</code> version, but different adresses for the <code>namespace {}</code> version.</p>\n"}, {"tags": [], "owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "is_accepted": false, "score": 1, "last_activity_date": 1514995144, "creation_date": 1514995144, "answer_id": 48080838, "question_id": 48077958, "link": "https://stackoverflow.com/questions/48077958/defining-global-constexpr-variables-in-anonymous-namespace-the-same-as-making-th/48080838#48080838", "title": "Defining global constexpr variables in anonymous namespace the same as making them inline?", "body": "<p>You do avoid the ODR violation with the anonymous namespace, as it creates a new separate set of objects in each file where it is included. The advantage of  an <code>inline</code> object is that there will only be one in total.</p>\n\n<p>However, if you only use the <code>constexpr</code> values as constants, you will not notice much of a difference. And a nice compiler might avoid storing the constants in the data area anyway.</p>\n\n<p>Passing references or pointers around and comparing addresses could make a difference, like Tobi says. But perhaps you can avoid comparing the addresses of two constant values?</p>\n"}], "owner": {"reputation": 8741, "user_id": 125997, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sjHUr.png?s=128&g=1", "display_name": "Danra", "link": "https://stackoverflow.com/users/125997/danra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "accepted_answer_id": 48078320, "answer_count": 2, "score": 0, "last_activity_date": 1514995144, "creation_date": 1514984520, "question_id": 48077958, "link": "https://stackoverflow.com/questions/48077958/defining-global-constexpr-variables-in-anonymous-namespace-the-same-as-making-th", "title": "Defining global constexpr variables in anonymous namespace the same as making them inline?", "body": "<p>Following up on <a href=\"https://stackoverflow.com/questions/48041618/why-does-cppreference-define-type-traits-xxx-v-shortcuts-as-inline-constexpr-and/48041749?noredirect=1#comment83058095_48041749\">Why does cppreference define type_traits xxx_v shortcuts as inline constexpr and not just constexpr?</a>, if I make my own type trait and want to avoid ODR violations and want it to be compatible with pre-C++17 projects, is putting the xxx_v shortcut in an anonymous namespace the same as explicitly declaring it inline?</p>\n\n<p>For example, taking <code>all_true</code> from <a href=\"https://stackoverflow.com/questions/28253399/check-traits-for-all-variadic-template-arguments\">Check traits for all variadic template arguments</a>, with C++17 I can write in my utility header:</p>\n\n<pre><code>template &lt;bool...&gt; struct bool_pack;\ntemplate &lt;bool... v&gt;\nusing all_true = std::is_same&lt;bool_pack&lt;true, v...&gt;, bool_pack&lt;v..., true&gt;&gt;;\ntemplate &lt;bool... v&gt;\ninline constexpr bool all_true_v = all_true&lt;v...&gt;::value;\n</code></pre>\n\n<p>Is that the same as writing the following code which is compatible with pre-C++17?</p>\n\n<pre><code>template &lt;bool...&gt; struct bool_pack;\ntemplate &lt;bool... v&gt;\nusing all_true = std::is_same&lt;bool_pack&lt;true, v...&gt;, bool_pack&lt;v..., true&gt;&gt;;\nnamespace {\n   template &lt;bool... v&gt;\n   constexpr bool all_true_v = all_true&lt;v...&gt;::value;\n}\n</code></pre>\n"}, {"tags": ["c++", "plugins", "maya"], "answers": [{"tags": [], "owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "is_accepted": true, "score": 1, "last_activity_date": 1514988911, "creation_date": 1514988911, "answer_id": 48079123, "question_id": 48077923, "link": "https://stackoverflow.com/questions/48077923/maya-c-api-moving-an-object/48079123#48079123", "title": "Maya c++ API, moving an object?", "body": "<p>Ah, i was doing it entirely wrong. This works:</p>\n\n<pre><code>MDagModifier dagModifier;\n\n    //Create the camera transform node.\n    MObject cameraTransformObj = dagModifier.createNode(\"transform\");\n    dagModifier.renameNode(cameraTransformObj, \"myCameraTransform\");\n\n    //Create the camera shape node as a child of the camera transform node.\n    MObject cameraShapeObj = dagModifier.createNode(\"camera\", cameraTransformObj);\n    dagModifier.renameNode(cameraShapeObj, \"myCameraShape\");\n\n    dagModifier.doIt();\n\nMFnTransform transformFn(cameraTransformObj);\ntransformFn.setTranslation(MVector(0, 5, 30), MSpace::kTransform);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11408438, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/4afd2e5b62e98e0dfd3fdd9051d9e442?s=128&d=identicon&r=PG", "display_name": "dadada", "link": "https://stackoverflow.com/users/11408438/dadada"}, "is_accepted": false, "score": 0, "last_activity_date": 1556260351, "last_edit_date": 1556260351, "creation_date": 1556163234, "answer_id": 55841437, "question_id": 48077923, "link": "https://stackoverflow.com/questions/48077923/maya-c-api-moving-an-object/55841437#55841437", "title": "Maya c++ API, moving an object?", "body": "<p>I find if you just change the space form MSpace::world to MSpace::object, the previous method you provided is ok. Maybe it is because the translate transform is a part of the final world matrix, and the transform space of this function may means the space which will add the transform matrix.</p>\n\n<p>Change:</p>\n\n<pre><code>fn.setTranslation(trans, MSpace::kWorld);\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>fn.setTranslation(trans, MSpace::kObject);\n</code></pre>\n\n<p>Sorry, I think I am wrong. Using MSpace::kWorld will return a failure because the MFnTransform object is not create by a dagPath object, and in this case use MSpace::kObject will not return failure.</p>\n"}], "owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 3, "accepted_answer_id": 48079123, "answer_count": 2, "score": 1, "last_activity_date": 1556260351, "creation_date": 1514984370, "question_id": 48077923, "link": "https://stackoverflow.com/questions/48077923/maya-c-api-moving-an-object", "title": "Maya c++ API, moving an object?", "body": "<p>I am attempting to write a Maya c++ plugin, and am having some trouble. </p>\n\n<p>I simply want to create a camera, and then move it in the viewport. I have:</p>\n\n<pre><code>    MObject camera;\n    MDagPath cameraPath;\n    // create new camera\n    MFnCamera fnCamera;\n    fnCamera.create(camera);\n    fnCamera.getPath(cameraPath);\n\n    MFnTransform fn(camera);\n    MVector trans(12, 12, 12);\n    fn.setTranslation(trans, MSpace::kWorld);\n</code></pre>\n\n<p>This  creates the camera fine, but does not move it. What am I missing to translate the created object? Thank you.</p>\n"}, {"tags": ["c++", "arrays"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4483261, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/56a6a4c5bde4921d90912385a1289c9b?s=128&d=identicon&r=PG&f=1", "display_name": "hbakan", "link": "https://stackoverflow.com/users/4483261/hbakan"}, "edited": false, "score": 0, "creation_date": 1514985936, "post_id": 48078148, "comment_id": 83130424, "body": "thank you, it solved my issue."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 17, "user_id": 4483261, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/56a6a4c5bde4921d90912385a1289c9b?s=128&d=identicon&r=PG&f=1", "display_name": "hbakan", "link": "https://stackoverflow.com/users/4483261/hbakan"}, "edited": false, "score": 0, "creation_date": 1514989405, "post_id": 48078148, "comment_id": 83132330, "body": "@hbakan If it did, then consider marking it as &quot;accepted&quot;"}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1514985299, "creation_date": 1514985299, "answer_id": 48078148, "question_id": 48077895, "link": "https://stackoverflow.com/questions/48077895/how-to-copy-array-to-file-in-c/48078148#48078148", "title": "How to copy array to file in c++", "body": "<p>The problem is that you use <code>sizeof</code> for the end \"iterator\" of the array.</p>\n\n<p>The <code>sizeof</code> operator returns the size <em>in <strong>bytes</em></strong>, not in array elements.  That means you will go way out of bounds beyond the end of the array.</p>\n\n<p>I suggest you change to use the standard <a href=\"http://en.cppreference.com/w/cpp/iterator/begin\" rel=\"nofollow noreferrer\"><code>std::begin</code></a> and <a href=\"http://en.cppreference.com/w/cpp/iterator/end\" rel=\"nofollow noreferrer\"><code>std::end</code></a> helper functions to get the \"iterators\" for the array:</p>\n\n<pre><code>std::copy(std::begin(numbers), std::end(numbers), ...);\n</code></pre>\n\n<p>For proper arrays (but not for pointers, and remember that arrays decays to pointers very easily) those functions will do the right thing.</p>\n"}], "owner": {"reputation": 17, "user_id": 4483261, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/56a6a4c5bde4921d90912385a1289c9b?s=128&d=identicon&r=PG&f=1", "display_name": "hbakan", "link": "https://stackoverflow.com/users/4483261/hbakan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 749, "favorite_count": 0, "closed_date": 1514999790, "accepted_answer_id": 48078148, "answer_count": 1, "score": -4, "last_activity_date": 1514985299, "creation_date": 1514984272, "last_edit_date": 1514984827, "question_id": 48077895, "link": "https://stackoverflow.com/questions/48077895/how-to-copy-array-to-file-in-c", "closed_reason": "Not suitable for this site", "title": "How to copy array to file in c++", "body": "<p>I read array from the text file and I want to copy this array's elements to another text file</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n\n\nusing namespace std;\n\nint main()\n\n{\n\n    const int ARRAY_SIZE = 5;\n    int numbers[ ARRAY_SIZE];\n    int count = 0;\n    cout &lt;&lt; \"1. before opening file\\n\";\n\n    ifstream inputFile;\n    inputFile.open(\"test.txt\");    \n\n    if (!inputFile)\n    {\n        cout &lt;&lt; \"error opening input file\\n\";\n        return 1;\n    }\n\n    cout &lt;&lt; \"2. after opening file\\n\";\n    cout &lt;&lt; \"3. before reading file, count = \" &lt;&lt; count &lt;&lt; '\\n';\n\n    while (count &lt; ARRAY_SIZE &amp;&amp; inputFile &gt;&gt; numbers [ count])\n        count++;\n\n    inputFile.close();\n\n    cout &lt;&lt; \"4. after reading file, count = \" &lt;&lt; count &lt;&lt; '\\n';\n    cout&lt;&lt; \"The numbers are : \";\n\n    for (int i = 0; i &lt; count; i++)\n\n        cout &lt;&lt; numbers[i] &lt;&lt; \" \";\n    cout&lt;&lt; endl;\n\n    cout &lt;&lt; \"5. Program ending\" &lt;&lt; endl;\n    return 0;\n\n}\n</code></pre>\n\n<p>I added this code but it doesn't work. How can I copy this array's elements to destination.txt file?</p>\n\n<pre><code>ofstream fstreamFile(\"destination.txt\");\n    copy(\n         numbers,\n         numbers + sizeof(numbers),\n         ostream_iterator&lt;int&gt;(fstreamFile)\n         );\n</code></pre>\n\n<p>my elements are 10,20,30,40 but in the destination.txt file, output is \"10203040160641613632767-1973944304-....\"</p>\n"}, {"tags": ["c++", "3d", "directx"], "comments": [{"owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 0, "creation_date": 1514984271, "post_id": 48077825, "comment_id": 83129498, "body": "Do you know on what z plane the point is on or any other way to determine z value? Because you need multiple points"}, {"owner": {"reputation": 1, "user_id": 9168167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91b004e5cfcf2635d93211e84e846c9?s=128&d=identicon&r=PG&f=1", "display_name": "Bob A", "link": "https://stackoverflow.com/users/9168167/bob-a"}, "reply_to_user": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 0, "creation_date": 1514984473, "post_id": 48077825, "comment_id": 83129601, "body": "@JakeFreeman I have a function returns every z value for every 3D x and y coordinate. So it&#39;s like a map."}, {"owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "edited": false, "score": 0, "creation_date": 1514984605, "post_id": 48077825, "comment_id": 83129689, "body": "See this point you need to look at lots of points at once: <a href=\"https://stackoverflow.com/questions/76134/how-do-i-reverse-project-2d-points-into-3d\" title=\"how do i reverse project 2d points into 3d\">stackoverflow.com/questions/76134/&hellip;</a>"}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 1, "creation_date": 1514986819, "post_id": 48077825, "comment_id": 83130935, "body": "A 2D point on the screen corresponds to a <i>line</i> in 3D space, passing through the camera&#39;s location. You would need to specify a Z-value to obtain a unique point."}], "answers": [{"tags": [], "owner": {"reputation": 1706, "user_id": 9005255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67457c27150ca6906c2d06b7a43fc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Freeman", "link": "https://stackoverflow.com/users/9005255/jake-freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1514985201, "creation_date": 1514985201, "answer_id": 48078116, "question_id": 48077825, "link": "https://stackoverflow.com/questions/48077825/convert-a-2d-screen-coordinate-to-a-3d-world-coordinate/48078116#48078116", "title": "Convert a 2D screen coordinate to a 3D world coordinate", "body": "<p>You could use the SolvePnP library like this:</p>\n\n<pre><code>int max = std::max(img.rows,img.cols);\nMat camMatrix = (Mat_&lt;double&gt;(3,3) &lt;&lt;\n    max_d,   0, img.cols/2.0,\n    0,   max_d, img.rows/2.0,\n    0,   0,     1.0);\n\n// 2d -&gt; 3d correspondence\nvector&lt;Point2d&gt; pts2d = ...\nvector&lt;Point3d&gt; pts3d = ...\nMat rvec,tvec;\nsolvePnP(pts3d, pts2d, camMatrix, Mat(1,4,CV_64F,0.0), rvec, tvec, false, SOLVEPNP_EPNP);\n// get 3d rot mat\nMat rotM(3, 3, CV_64F);\nRodrigues(rvec, rotM);\n\n// push tvec to transposed Mat\nMat rotMT = rotM.t();\nrotMT.push_back(tvec.reshape(1, 1));\n\n// transpose back, and multiply\ncamMatrix * rotMT.t();\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9168167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91b004e5cfcf2635d93211e84e846c9?s=128&d=identicon&r=PG&f=1", "display_name": "Bob A", "link": "https://stackoverflow.com/users/9168167/bob-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 196, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514985201, "creation_date": 1514983970, "question_id": 48077825, "link": "https://stackoverflow.com/questions/48077825/convert-a-2d-screen-coordinate-to-a-3d-world-coordinate", "title": "Convert a 2D screen coordinate to a 3D world coordinate", "body": "<p>Right now I can transform a 3D world coordinate to a 2D screen coordinate.\nI can achieve that with this:</p>\n\n<pre><code>    D3DXMATRIX viewMatrix = renderer-&gt;viewMatrix;\n    D3DXMATRIX projectionMatrix = renderer-&gt;projectionMatrix;\n    D3DXMATRIX viewProjectionMatrix = D3DXMATRIX();\n    D3DXMatrixMultiply(&amp;viewProjectionMatrix, &amp;viewMatrix, &amp;projectionMatrix);\n\n    D3DXVECTOR3 pScreen = D3DXVECTOR3(0.0f, 0.0f, 0.0f);\n    D3DXVECTOR3 pWorld(world-&gt;getX(), world-&gt;getY(), world-&gt;getZ());\n    D3DXVec3TransformCoordImpl(&amp;pScreen, &amp;pWorld, &amp;viewProjectionMatrix);\n</code></pre>\n\n<p>Now <code>pScreen</code> contains the 2D screen coordinate</p>\n\n<p>How could I reverse this to get a 3D world coordinate out of a 2D screen coordinate? I'm using this implementation of the <code>D3DXVec3TransformCoord</code> function:</p>\n\n<pre><code>D3DXVECTOR3* WINAPI D3DXVec3TransformCoordImpl(D3DXVECTOR3* pout, CONST D3DXVECTOR3* pv, CONST D3DXMATRIX* pm)\n{\n    FLOAT norm = pm-&gt;m[0][3] * pv-&gt;x + pm-&gt;m[1][3] * pv-&gt;y + pm-&gt;m[2][3] * pv-&gt;z + pm-&gt;m[3][3];\n    if (norm)\n    {\n        pout-&gt;x = (pm-&gt;m[0][0] * pv-&gt;x + pm-&gt;m[1][0] * pv-&gt;y + pm-&gt;m[2][0] * pv-&gt;z + pm-&gt;m[3][0]) / norm;\n        pout-&gt;y = (pm-&gt;m[0][1] * pv-&gt;x + pm-&gt;m[1][1] * pv-&gt;y + pm-&gt;m[2][1] * pv-&gt;z + pm-&gt;m[3][1]) / norm;\n        pout-&gt;z = (pm-&gt;m[0][2] * pv-&gt;x + pm-&gt;m[1][2] * pv-&gt;y + pm-&gt;m[2][2] * pv-&gt;z + pm-&gt;m[3][2]) / norm;\n    }\n    else\n    {\n        pout-&gt;x = 0.0f;\n        pout-&gt;y = 0.0f;\n        pout-&gt;z = 0.0f;\n    }\n    return pout;\n}\n</code></pre>\n"}, {"tags": ["c++", "opengl", "glfw", "clion", "glm-math"], "comments": [{"owner": {"reputation": 144, "user_id": 3047226, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000497727031/picture?type=large", "display_name": "NjamNjam", "link": "https://stackoverflow.com/users/3047226/njamnjam"}, "edited": false, "score": 0, "creation_date": 1514983897, "post_id": 48077769, "comment_id": 83129276, "body": "Clion, so you are using cmake?"}, {"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1514985139, "post_id": 48077769, "comment_id": 83129991, "body": "Which IDE? Which libraries?"}, {"owner": {"reputation": 161, "user_id": 5275649, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/cd850d5890518c171b39912ed1fa7e3a?s=128&d=identicon&r=PG&f=1", "display_name": "Burak Kaan Bilgehan", "link": "https://stackoverflow.com/users/5275649/burak-kaan-bilgehan"}, "edited": false, "score": 0, "creation_date": 1514986135, "post_id": 48077769, "comment_id": 83130550, "body": "the IDE is Clion, some libraries I include are glew, glfw, and jpeglib. I think I need to use cmake but I don&#39;t know how to include those libraries to compilation phase"}], "answers": [{"tags": [], "owner": {"reputation": 318, "user_id": 4285113, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-aMlICX56x3M/AAAAAAAAAAI/AAAAAAAAAAs/2edvF4C2zF4/photo.jpg?sz=128", "display_name": "Magnus Lutz", "link": "https://stackoverflow.com/users/4285113/magnus-lutz"}, "is_accepted": false, "score": -1, "last_activity_date": 1514984268, "creation_date": 1514984268, "answer_id": 48077893, "question_id": 48077769, "link": "https://stackoverflow.com/questions/48077769/c-how-to-run-programs-in-clion-when-you-need-to-include-opengl-libraries/48077893#48077893", "title": "C++ How to run programs in Clion when you need to include OpenGL libraries?", "body": "<p>I would recommend to use the CMake build tool which does the work generating Makefiles for you and is also directly supported by clion. When you open the directory containing a CMakeLists.txt (CMake Project File) with clion, it should be automatically be loaded and compiled (if not just hit build)</p>\n\n<p>A very simple example CMake project would look like this</p>\n\n<pre><code>cmake_minimum_required (VERSION 2.8.9)\nproject (OpenGl-Stuff)\n\ninclude_directories(src)\n\nadd_executable(your-binary src/your-code.c src/your-code.h)\ntarget_link_libraries(your-binary opengl) \n# target_link_libraries will search for libopengl on standard system paths, \n# maybe the library is not called libopengl, then you have to adjust the name above\n</code></pre>\n\n<p>this cmake project will generate the binary for you and link it against opengl</p>\n"}, {"tags": [], "owner": {"reputation": 144, "user_id": 3047226, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000497727031/picture?type=large", "display_name": "NjamNjam", "link": "https://stackoverflow.com/users/3047226/njamnjam"}, "is_accepted": false, "score": 0, "last_activity_date": 1514988867, "creation_date": 1514988867, "answer_id": 48079110, "question_id": 48077769, "link": "https://stackoverflow.com/questions/48077769/c-how-to-run-programs-in-clion-when-you-need-to-include-opengl-libraries/48079110#48079110", "title": "C++ How to run programs in Clion when you need to include OpenGL libraries?", "body": "<p>First make sure you installed all libraries correctly using the compiler you configured in clion/cmake. Assuminf you have a fresh CMakeLists.txt like</p>\n\n<pre><code> cmake_minimum_required(VERSION 3.3.2)\n project(MyGL CPP)\n\n add_executable(demo-run main.cpp)\n</code></pre>\n\n<p>For linking your libraries you need two things. First tell the compiler where to find the include files and second which libraries to link. You could just hard code you local installation like</p>\n\n<pre><code> target_link_libraries(demo-run path/to/glfw.lib path/to/opengl.lib path/to/jpeg.lib ...)\n target_include_directories(demo-run PRIVATE path/to/glfw/include path/to/opengl/include path/to/jpeg/include ...)\n</code></pre>\n\n<p>however this is not very portable and if you want to work with another compiler or on another machine your project file will fail. Instead you can use the package system of cmake</p>\n\n<pre><code>find_package(PkgConfig REQUIRED)\npkg_search_module(GLFW REQUIRED glfw3)\nfind_package(JPEG REQUIRED)\nfind_package(GLEW REQUIRED)\nfind_package (OpenGL REQUIRED)\nfind_package (GLM REQUIRED)\n\ntarget_link_libraries(demo-run ${GLFW_LIBRARIES} ${GLEW_LIBRARIES} ${JPEG_LIBRARIES} ${OPENGL_LIBRARIES})\ntarget_include_directories(demo-run PRIVATE ${GLFW_INCLUDE_DIRS} ${GLEW_INCLUDE_DIR} ${JPEG_INCLUDE_DIR} ${OPENGL_INCLUDE_DIR} ${GLM_INCLUDE_DIR})\n</code></pre>\n\n<p>The glfw part is a bit tricky and works only on linux i guess see <a href=\"http://www.glfw.org/docs/3.0/build.html\" rel=\"nofollow noreferrer\">http://www.glfw.org/docs/3.0/build.html</a>.</p>\n\n<p>This code is not tested at all and you may need to specify some enviroment variables so cmake can find the packages or provide additional find scripts like <a href=\"https://github.com/lighttransport/nanogi/blob/master/cmake/FindGLM.cmake\" rel=\"nofollow noreferrer\">https://github.com/lighttransport/nanogi/blob/master/cmake/FindGLM.cmake</a>.</p>\n"}], "owner": {"reputation": 161, "user_id": 5275649, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/cd850d5890518c171b39912ed1fa7e3a?s=128&d=identicon&r=PG&f=1", "display_name": "Burak Kaan Bilgehan", "link": "https://stackoverflow.com/users/5275649/burak-kaan-bilgehan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 891, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1516198265, "creation_date": 1514983755, "last_edit_date": 1516198265, "question_id": 48077769, "link": "https://stackoverflow.com/questions/48077769/c-how-to-run-programs-in-clion-when-you-need-to-include-opengl-libraries", "title": "C++ How to run programs in Clion when you need to include OpenGL libraries?", "body": "<p>Hello I need to work with OpenGL and want to create my project in Clion. But Clion cannot compile and run my projects because of the libraries I need to include. I can create my own makefile and run the program in terminal, but I want to do it in the IDE. How can I make this happen?</p>\n"}, {"tags": ["c++", "macos", "qt", "minimize"], "comments": [{"owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 0, "creation_date": 1514998996, "post_id": 48077662, "comment_id": 83138069, "body": "Are there any messages for your app on the console?"}, {"owner": {"reputation": 155, "user_id": 4012609, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a6a0e2f35efcb129b662bfab66f3fd46?s=128&d=identicon&r=PG&f=1", "display_name": "bob", "link": "https://stackoverflow.com/users/4012609/bob"}, "reply_to_user": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 0, "creation_date": 1515067844, "post_id": 48077662, "comment_id": 83164580, "body": "nothing, I&#39;m afraid."}, {"owner": {"reputation": 155, "user_id": 4012609, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a6a0e2f35efcb129b662bfab66f3fd46?s=128&d=identicon&r=PG&f=1", "display_name": "bob", "link": "https://stackoverflow.com/users/4012609/bob"}, "reply_to_user": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 0, "creation_date": 1515492178, "post_id": 48077662, "comment_id": 83310368, "body": "edited my code after I setup a testing app where I don&#39;t get any console output"}], "owner": {"reputation": 155, "user_id": 4012609, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a6a0e2f35efcb129b662bfab66f3fd46?s=128&d=identicon&r=PG&f=1", "display_name": "bob", "link": "https://stackoverflow.com/users/4012609/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515492028, "creation_date": 1514983375, "last_edit_date": 1515492028, "question_id": 48077662, "link": "https://stackoverflow.com/questions/48077662/window-minimizing-broken-after-building-qt-app-with-mac-os-high-sierra-sdk", "title": "Window minimizing broken after building QT app with Mac OS High Sierra SDK", "body": "<p>I have a frameless Qt app setup with <code>setWindowFlags (Qt::Window | Qt::FramelessWindowHint)</code> and custom minimize and close buttons.\nI'm having trouble minimizing the app by using <code>setWindowState (Qt::WindowState::WindowMinimized)</code> or <code>showMinimized()</code> and the 10.13 SDK. It worked fine on Mac with the 10.12 SDK.\nI also tested this with a new clean project with no special eventFilters or similar. Anyone else with this problem? I'm using Qt 5.10.0, this problem also appeared in Qt 5.9.1.</p>\n\n<p>I'm just doing this in my MainWindow which works with the 10.12 SDK.</p>\n\n<pre><code>MainWindow::MainWindow(QWidget *parent) : QMainWindow(parent) {\n        setWindowFlags(Qt::Window | Qt::FramelessWindowHint);\n        QPushButton* minimizeButton = new QPushButton(this);\n        minimizeButton-&gt;setText(QLatin1String(\"Minimize\"));\n        connect(minimizeButton, &amp;QPushButton::clicked, this, &amp;QMainWindow::showMinimized);\n    }\n</code></pre>\n"}, {"tags": ["c++", "c++11", "templates", "methods"], "comments": [{"owner": {"reputation": 481, "user_id": 3340316, "user_type": "registered", "profile_image": "https://graph.facebook.com/646609329/picture?type=large", "display_name": "mahdi_12167", "link": "https://stackoverflow.com/users/3340316/mahdi-12167"}, "edited": false, "score": 0, "creation_date": 1514983861, "post_id": 48077642, "comment_id": 83129253, "body": "You can use dynamic casting and check whether T is A or B, then call function of cast variable"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 481, "user_id": 3340316, "user_type": "registered", "profile_image": "https://graph.facebook.com/646609329/picture?type=large", "display_name": "mahdi_12167", "link": "https://stackoverflow.com/users/3340316/mahdi-12167"}, "edited": false, "score": 1, "creation_date": 1514983963, "post_id": 48077642, "comment_id": 83129318, "body": "@mahdi_12167 - Don&#39;t post answers in the comment section"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 481, "user_id": 3340316, "user_type": "registered", "profile_image": "https://graph.facebook.com/646609329/picture?type=large", "display_name": "mahdi_12167", "link": "https://stackoverflow.com/users/3340316/mahdi-12167"}, "edited": false, "score": 1, "creation_date": 1514983996, "post_id": 48077642, "comment_id": 83129342, "body": "@mahdi_12167 That requires <code>A</code> and <code>B</code> to be polymorphic, and negates the no-runtime-overhead benefit introduced by <code>D</code> being a template."}], "answers": [{"tags": [], "owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": false, "score": 9, "last_activity_date": 1514984023, "last_edit_date": 1514984023, "creation_date": 1514983614, "answer_id": 48077733, "question_id": 48077642, "link": "https://stackoverflow.com/questions/48077642/calling-different-methods-with-the-same-signature-using-a-template-like-mechanis/48077733#48077733", "title": "Calling different methods with the same signature using a template like mechanism", "body": "<p>You can easily do this using your own trait class:</p>\n\n<pre><code>template &lt;class T&gt;\nstruct DTraits;\n\ntemplate &lt;&gt;\nstruct DTraits&lt;A&gt; {\n  static void call(A &amp;obj, C data) { obj.write(data); }\n};\n\ntemplate &lt;&gt;\nstruct DTraits&lt;B&gt; {\n  static void call(B &amp;obj, C data) { obj.use(data); }\n};\n\ntemplate &lt;class T&gt;\nstruct D\n{\n  void myFunct(C data)\n  {\n    DTraits&lt;T&gt;::call(t, data);\n  }\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "is_accepted": true, "score": 10, "last_activity_date": 1514984516, "last_edit_date": 1514984516, "creation_date": 1514983620, "answer_id": 48077738, "question_id": 48077642, "link": "https://stackoverflow.com/questions/48077642/calling-different-methods-with-the-same-signature-using-a-template-like-mechanis/48077738#48077738", "title": "Calling different methods with the same signature using a template like mechanism", "body": "<p>You can pass a <a href=\"https://isocpp.org/wiki/faq/pointers-to-members\" rel=\"nofollow noreferrer\">pointer to member-function</a> as a second template parameter to <code>D</code>:</p>\n\n<pre><code>template &lt;class T, void (T::*fun)(C)&gt;\nstruct D\n{\n    T t;\n\n    void myFunct(C data)\n    {\n        (t.*fun)(data);\n    }\n};\n</code></pre>\n\n<p>You can then create <code>D</code> objects doing:</p>\n\n<pre><code>D&lt;A, &amp;A::write&gt; da;\nD&lt;B, &amp;B::use&gt; db;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16382, "user_id": 5507349, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IaCUb.jpg?s=128&g=1", "display_name": "Edgar Rokj\u0101n", "link": "https://stackoverflow.com/users/5507349/edgar-rokj%c4%81n"}, "is_accepted": false, "score": 2, "last_activity_date": 1514990180, "creation_date": 1514990180, "answer_id": 48079488, "question_id": 48077642, "link": "https://stackoverflow.com/questions/48077642/calling-different-methods-with-the-same-signature-using-a-template-like-mechanis/48079488#48079488", "title": "Calling different methods with the same signature using a template like mechanism", "body": "<p>Just for completeness here is another possible solution which uses <code>if constexpr</code>, type traits and requires <em>C++17</em> support:</p>\n\n<pre><code>void myFunct(C data)\n{\n   if constexpr (std::is_same_v&lt;T, A&gt;) {\n       t.write(data);\n   } else {\n       t.use(data);\n   }\n}\n</code></pre>\n\n<p><a href=\"https://godbolt.org/g/rcL45Y\" rel=\"nofollow noreferrer\"><strong>Example</strong></a></p>\n"}], "owner": {"reputation": 14372, "user_id": 654019, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/438148c9a2ac0c1bb66f92a3adbafac2?s=128&d=identicon&r=PG", "display_name": "mans", "link": "https://stackoverflow.com/users/654019/mans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 48077738, "answer_count": 3, "score": 4, "last_activity_date": 1514990180, "creation_date": 1514983293, "last_edit_date": 1514985235, "question_id": 48077642, "link": "https://stackoverflow.com/questions/48077642/calling-different-methods-with-the-same-signature-using-a-template-like-mechanis", "title": "Calling different methods with the same signature using a template like mechanism", "body": "<p>I have this code:</p>\n\n<pre><code>struct C\n{\n   int d1;\n   int d2;\n};\n\nstruct A\n{\n      void  write(C data)\n      {\n      }\n};\n\nstruct B\n{\n      void use(C data)\n      {\n      }\n};\n</code></pre>\n\n<p>Now I want to define a new class that uses <code>A</code> or <code>B</code> and call their <code>write</code> and <code>use</code> method. Something such as this:</p>\n\n<pre><code>template &lt;class T&gt;\nstruct D\n{\n     T t;\n     D(T myT) { t=myT; }\n     void myFunct(C data)\n     {\n         // t.????(data);\n     }\n};\n</code></pre>\n\n<p>As you can see if the two classes had similar method names, then it would be easy to implement <code>D</code>, but since <code>A</code> and <code>B</code> have different methods, then I need to tell compiler which method it should use. How can I do this? </p>\n\n<p>I don't want to change <code>A</code> or <code>B</code> and also I don't want to create a subclass of <code>A</code> and <code>B</code> to create a method with the same name. </p>\n\n<p>I want a way to tell the compiler which method to use as part of the template, is it possible? </p>\n"}, {"tags": ["c++", "r", "rcpp"], "comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 4, "creation_date": 1514984277, "post_id": 48077518, "comment_id": 83129501, "body": "There are some obvious bits that are probably less than fast.  <code>forbidden_days= res[i]+forbidden_space;</code> being one. But any answer will be a stab in the dark.  You should really get a profiller to measure which part is taking all the CPU time and then look into how you can fix that."}, {"owner": {"reputation": 117262, "user_id": 1412059, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MQ33X.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/1412059/roland"}, "edited": false, "score": 0, "creation_date": 1514986892, "post_id": 48077518, "comment_id": 83130979, "body": "Do both functions return the same result?"}, {"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1514986929, "post_id": 48077518, "comment_id": 83130999, "body": "Nobody said that it was impossible to write poorly performing C++ code. That is why we benchmark.  Rethink your approach, work at it and <i>likely</i> you may end up beating R code with C++ code."}, {"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "reply_to_user": {"reputation": 117262, "user_id": 1412059, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MQ33X.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/1412059/roland"}, "edited": false, "score": 0, "creation_date": 1514986971, "post_id": 48077518, "comment_id": 83131027, "body": "@Roland: They don&#39;t.  I got <code>&quot;Mean relative difference: 0.06066634&quot;</code> from <code>all.equal</code> but I don&#39;t have time to fix this for the OP."}, {"owner": {"reputation": 2764, "user_id": 2030503, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/PVJgF.jpg?s=128&g=1", "display_name": "user2030503", "link": "https://stackoverflow.com/users/2030503/user2030503"}, "reply_to_user": {"reputation": 117262, "user_id": 1412059, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MQ33X.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/1412059/roland"}, "edited": false, "score": 0, "creation_date": 1514992718, "post_id": 48077518, "comment_id": 83134380, "body": "@Roland: both implementations return correct results according to task. To my understanding as both RNGs form <code>R</code> and <code>Rccp sugar</code> are not synced, identity is not a test."}, {"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1514995720, "post_id": 48077518, "comment_id": 83136159, "body": "@user2030503 You just wrong. Try <code>set.seed(42); rnorm(3);</code> followed by <code>cppFunction(&quot;NumericVector rn(int n) { return Rcpp::rnorm(3, 0, 1); }&quot;)</code> and <code>set.seed(42); rn(3)</code>.  The numbers will be same.  That is in almost all Rcpp intros, and maybe you should do some re-reading."}], "answers": [{"comments": [{"owner": {"reputation": 2764, "user_id": 2030503, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/PVJgF.jpg?s=128&g=1", "display_name": "user2030503", "link": "https://stackoverflow.com/users/2030503/user2030503"}, "edited": false, "score": 0, "creation_date": 1515047584, "post_id": 48080909, "comment_id": 83154119, "body": "thx for your R implementation proposal. <code>sample_r2(n= 12, min_dist = 30)</code> yields an error, while <code>sample_r(n= 12, min_dist = 30)</code> works a requested. Moreover the question was more heading towards refactoring the c++ code to be faster than native R code. Thx again."}, {"owner": {"reputation": 2304, "user_id": 8442410, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6421347be0480937c5b116eee3e33a67?s=128&d=identicon&r=PG&f=1", "display_name": "JRR", "link": "https://stackoverflow.com/users/8442410/jrr"}, "reply_to_user": {"reputation": 2764, "user_id": 2030503, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/PVJgF.jpg?s=128&g=1", "display_name": "user2030503", "link": "https://stackoverflow.com/users/2030503/user2030503"}, "edited": false, "score": 0, "creation_date": 1515072756, "post_id": 48080909, "comment_id": 83167506, "body": "I know that your question was about C++. But writing a more efficient algorithm in R will help you to write an efficient C++ code as well."}], "tags": [], "owner": {"reputation": 2304, "user_id": 8442410, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6421347be0480937c5b116eee3e33a67?s=128&d=identicon&r=PG&f=1", "display_name": "JRR", "link": "https://stackoverflow.com/users/8442410/jrr"}, "is_accepted": false, "score": 0, "last_activity_date": 1514997406, "last_edit_date": 1514997406, "creation_date": 1514995380, "answer_id": 48080909, "question_id": 48077518, "link": "https://stackoverflow.com/questions/48077518/rcpp-slower-than-r-for-a-sampling-problem/48080909#48080909", "title": "Rcpp slower than R for a sampling p\u200cr\u200co\u200cb\u200cl\u200ce\u200cm", "body": "<p>You can optimize your R version by sampling the largest possible number of days in one shot.</p>\n\n<p>The following code is faster than yours. Statistically I sample the majority of the days before the loop. The remaining days are sampled in the loop but the loop is likely to run only once. Maybe twice.</p>\n\n<p>Moreover it is easy to rewrite with Rcpp.</p>\n\n<pre><code>sample_r2= function(n = 12, min_dist = 5, seed = 42)\n{\n  available_days = seq(365)\n\n  res = sort(sample(available_days, n))\n  y = diff(res)\n  res = res[y &gt;= min_dist]\n\n  while (length(res) &lt; n)\n  {\n    forbidden_days = sapply(res, function(x){ x + -(min_dist-1):(min_dist-1) } )\n    available_days = setdiff(available_days, forbidden_days)\n\n    days = sample(available_days, n - length(res))\n    res = sort(c(res, days))\n\n    y = diff(res)\n    res = res[y &gt;= min_dist]\n  }\n\n  return(res)\n}\n</code></pre>\n\n<p>Btw maybe there are some issues in my code. But I think the idea is correct.</p>\n"}], "owner": {"reputation": 2764, "user_id": 2030503, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/PVJgF.jpg?s=128&g=1", "display_name": "user2030503", "link": "https://stackoverflow.com/users/2030503/user2030503"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 417, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523249318, "creation_date": 1514982865, "last_edit_date": 1592644375, "question_id": 48077518, "link": "https://stackoverflow.com/questions/48077518/rcpp-slower-than-r-for-a-sampling-problem", "title": "Rcpp slower than R for a sampling p\u200cr\u200co\u200cb\u200cl\u200ce\u200cm", "body": "<h2>Problem setting</h2>\n<p>The problem consists of sampling out of a year of 365 days <code>n</code> days, in such a way that</p>\n<ul>\n<li>the days are drawn by uniform probability distribution</li>\n<li>the days comply to have a minimum distance given by <code>min_dist</code></li>\n<li>the result is given as numeric vector</li>\n</ul>\n<h2>Example</h2>\n<p>With <code>n= 12</code> and <code>min_dist= 20</code> a proper result might be the vector\n<code>[1]   4  43  69  97 129 161 192 215 243 285 309 343</code> as <code>diff</code> of this vector is <code>[1] 39 26 28 32 32 31 23 28 42 24 34</code>, all values larger or equal to <code>min_dist= 20</code>.</p>\n<h2>Question</h2>\n<p>I have solved this problem with</p>\n<ul>\n<li>function <code>sample_r()</code> in native <code>R</code></li>\n<li>function <code>sample_cpp()</code> in <code>c++</code> using the fantastic <code>Rcpp</code> interface package</li>\n</ul>\n<p>The <code>c++</code> solution turns out to much slower (on my Mac factor 60x). I am a <code>Rccp</code> newbie, hence my own research capabilities are limited - please forgive.\n<em><strong>What can I do to refactor the <code>c++</code> code to be faster than native <code>R</code> code ?</strong></em></p>\n<h2>Reproducible code (<code>.cpp file</code>)</h2>\n<pre><code>#include &lt;Rcpp.h&gt;\nusing namespace Rcpp;\nusing namespace std;\n// [[Rcpp::export]]\nIntegerVector sample_cpp(int n, int min_dist= 5L, int seed= 42L) {\n  \n  IntegerVector res_empty= Rcpp::rep(NA_INTEGER, n);\n  IntegerVector res;\n  IntegerVector available_days_full= Rcpp::seq(1, 365);\n  IntegerVector available_days;\n  IntegerVector forbidden_days;\n  IntegerVector forbidden_space = Rcpp::seq(-(min_dist-1), (min_dist-1));\n  bool fail;\n  Environment base(&quot;package:base&quot;);\n  Function set_seed = base[&quot;set.seed&quot;];\n  set_seed(seed);\n  do {\n    res= res_empty;\n    available_days = available_days_full;\n    fail= FALSE;\n    for(int i= 0; i &lt; n; ++i) {\n      res[i]= sample(available_days, 1, FALSE)[0];\n      forbidden_days= res[i]+forbidden_space;\n      available_days= setdiff(available_days, forbidden_days);\n      if(available_days.size() &lt;= 1){\n        fail= TRUE;\n        break;\n      }\n    }\n  }\n  while(fail== TRUE);\n  std::sort(res.begin(), res.end());\n  return res;\n}\n\n\n/*** R\n# c++ function\n(r= sample_cpp(n= 12, min_dist= 20, seed=1))\ndiff(r)\n\n\n# R function\nsample_r= function(n= 12, min_dist=5, seed= 42){\n  if(n*min_dist&gt;= 365) stop(&quot;Infeasible.&quot;)\n  set.seed(seed)\n  repeat{\n    res= numeric(n)\n    fail= FALSE\n    available_days= seq(365)\n    for(i in seq(n)){\n      if(length(available_days) &lt;= 1){\n        fail= TRUE\n        break()\n      }\n      res[i]= sample(available_days, 1)\n      forbidden_days= res[i]+(-(min_dist-1):(min_dist-1))\n      available_days= setdiff(available_days, forbidden_days)\n    }\n    if(fail== FALSE) return(sort(res))\n  }\n}\n\n(r= sample_r(n= 12, min_dist= 20, seed= 40))\ndiff(r)\n\n# Benchmark\nlibrary(rbenchmark)\nbenchmark(cpp= sample_cpp(n= 12, min_dist = 28),\n          r= sample_r(n= 12, min_dist = 28),\n          replications = 50)[,1:4]\n\n*/\n</code></pre>\n<p>Benchmark:</p>\n<pre><code>    test replications elapsed relative\n1  cpp           50  28.005   63.217\n2    r           50   0.443    1.000\n</code></pre>\n<hr />\n<h3>Edit:</h3>\n<p>OK, I tried to optimize (as far as I am capable of <code>c++</code>), still the <code>c++</code> implementation is behind, but now only marginally.</p>\n<pre><code>#include &lt;Rcpp.h&gt;\nusing namespace Rcpp;\nusing namespace std;\n// [[Rcpp::export]]\nIntegerVector sample_cpp(int n, int min_dist= 5L, int seed= 42L) {\n  \n  IntegerVector res;\n  IntegerVector available_days;\n  IntegerVector forbidden_days;\n  IntegerVector forbidden_space = Rcpp::seq(-(min_dist-1), (min_dist-1));\n  bool fail;\n  Environment base(&quot;package:base&quot;);\n  Function set_seed = base[&quot;set.seed&quot;];\n  set_seed(seed);\n  do {\n    res= Rcpp::rep(NA_INTEGER, n);\n    available_days = Rcpp::seq(1, 365);\n    fail= FALSE;\n    for(int i= 0; i &lt; n; ++i) {\n      if(available_days.size() &lt; n-i){\n          fail= TRUE;\n        break;\n      }\n      int temp= sample(available_days, 1, FALSE)[0];\n      res[i]= temp;\n      forbidden_days= unique(pmax(0, temp + forbidden_space));\n      available_days= setdiff(available_days, forbidden_days);\n    }\n  }\n  while(fail== TRUE);\n  std::sort(res.begin(), res.end());\n  return res;\n}\n\n\n/*** R\n\n# R function\nsample_r= function(n= 12, min_dist=5, seed= 42){\n  if(n*min_dist&gt;= 365) stop(&quot;Infeasible.&quot;)\n  set.seed(seed)\n  repeat{\n    res= numeric(n)\n    fail= FALSE\n    available_days= seq(365)\n    for(i in seq(n)){\n      if(length(available_days) &lt;= n-i){\n        fail= TRUE\n        break()\n      }\n      res[i]= sample(available_days, 1)\n      forbidden_days= res[i]+(-(min_dist-1):(min_dist-1))\n      available_days= setdiff(available_days, forbidden_days)\n    }\n    if(fail== FALSE) return(sort(res))\n  }\n}\n\n# Benchmark\nlibrary(rbenchmark)\nbenchmark(cpp= sample_cpp(n= 12, min_dist = 28),\n          r= sample_r(n= 12, min_dist = 28),\n          replications = 50)[,1:4]\n\n*/\n</code></pre>\n<p>Benchmark:</p>\n<pre><code>  test replications elapsed relative\n1  cpp           50   0.643    1.475\n2    r           50   0.436    1.000\n</code></pre>\n"}, {"tags": ["c++", "r"], "comments": [{"owner": {"reputation": 971, "user_id": 5645311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b201ef31bb6369582ecf0ba8c58f037?s=128&d=identicon&r=PG&f=1", "display_name": "Sixiang.Hu", "link": "https://stackoverflow.com/users/5645311/sixiang-hu"}, "edited": false, "score": 0, "creation_date": 1514982893, "post_id": 48077442, "comment_id": 83128738, "body": "have you tried <code>lapply</code> or <code>foreach</code>?"}, {"owner": {"reputation": 7333, "user_id": 2032478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/627342e0ca0cf27489b54a97a1100744?s=128&d=identicon&r=PG", "display_name": "Jan van der Laan", "link": "https://stackoverflow.com/users/2032478/jan-van-der-laan"}, "edited": false, "score": 0, "creation_date": 1514983029, "post_id": 48077442, "comment_id": 83128799, "body": "I seriously doubt that writing you loop in C++ is going to help (also using <code>lapply</code> and friends is not going to help). Please show a complete code example, so that we can give a proper advice (<a href=\"https://stackoverflow.com/questions/5963269/how-to-make-a-great-r-reproducible-example\" title=\"how to make a great r reproducible example\">stackoverflow.com/questions/5963269/&hellip;</a>). Using <code>nrow(subset(...))</code> for example, seems quite suspicious."}, {"owner": {"reputation": 183, "user_id": 8944334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/296295505d7bf37ac1164d208dcc9ddb?s=128&d=identicon&r=PG&f=1", "display_name": "Citizen", "link": "https://stackoverflow.com/users/8944334/citizen"}, "edited": false, "score": 0, "creation_date": 1514983245, "post_id": 48077442, "comment_id": 83128906, "body": "j runs through a vector and i runs through the dataframe rows, and lappy did not work well for me, but I have not tried with foreach, I do not know how that function works. Thanks."}, {"owner": {"reputation": 7333, "user_id": 2032478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/627342e0ca0cf27489b54a97a1100744?s=128&d=identicon&r=PG", "display_name": "Jan van der Laan", "link": "https://stackoverflow.com/users/2032478/jan-van-der-laan"}, "edited": false, "score": 0, "creation_date": 1514983559, "post_id": 48077442, "comment_id": 83129076, "body": "Ok, slightly better. Please look at the link I gave you, and also show us (an example) of <code>r</code> and <code>DF</code>."}, {"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1514987311, "post_id": 48077442, "comment_id": 83131200, "body": "I&#39;ll remove the Rcpp tag.  This has nothing to do with Rcpp, apart from wishing for a free pony."}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 8944334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/296295505d7bf37ac1164d208dcc9ddb?s=128&d=identicon&r=PG&f=1", "display_name": "Citizen", "link": "https://stackoverflow.com/users/8944334/citizen"}, "edited": false, "score": 1, "creation_date": 1514984300, "post_id": 48077681, "comment_id": 83129517, "body": "I could try to do the entire code in C++, but the issue is how I can translate nrow, subset, eval and parse in an easy way. Thank you."}, {"owner": {"reputation": 957, "user_id": 9123228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/197bd01668b668623b78b78d65375f9f?s=128&d=identicon&r=PG&f=1", "display_name": "txemsukr", "link": "https://stackoverflow.com/users/9123228/txemsukr"}, "reply_to_user": {"reputation": 183, "user_id": 8944334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/296295505d7bf37ac1164d208dcc9ddb?s=128&d=identicon&r=PG&f=1", "display_name": "Citizen", "link": "https://stackoverflow.com/users/8944334/citizen"}, "edited": false, "score": 0, "creation_date": 1514985159, "post_id": 48077681, "comment_id": 83130010, "body": "Added LAPACK/BLAS to my answer, maybe it can help you"}, {"owner": {"reputation": 117262, "user_id": 1412059, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MQ33X.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/1412059/roland"}, "edited": false, "score": 0, "creation_date": 1514987333, "post_id": 48077681, "comment_id": 83131216, "body": "LAPACK or BLAS are not relevant for performance if you don&#39;t do matrix algebra."}, {"owner": {"reputation": 183, "user_id": 8944334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/296295505d7bf37ac1164d208dcc9ddb?s=128&d=identicon&r=PG&f=1", "display_name": "Citizen", "link": "https://stackoverflow.com/users/8944334/citizen"}, "edited": false, "score": 0, "creation_date": 1515054125, "post_id": 48077681, "comment_id": 83156793, "body": "I am familiar with matrix algebra, but not with LAPACK/BLAS. My question is whether there is a way to do the same loop using matrix algebra. Thanks."}], "tags": [], "owner": {"reputation": 957, "user_id": 9123228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/197bd01668b668623b78b78d65375f9f?s=128&d=identicon&r=PG&f=1", "display_name": "txemsukr", "link": "https://stackoverflow.com/users/9123228/txemsukr"}, "is_accepted": false, "score": 0, "last_activity_date": 1514985130, "last_edit_date": 1514985130, "creation_date": 1514983458, "answer_id": 48077681, "question_id": 48077442, "link": "https://stackoverflow.com/questions/48077442/r-function-inside-c-loop/48077681#48077681", "title": "R function inside C++ loop", "body": "<p>I would have preferred to post this in comment as it doesn't fully answer the question but I don't have enough reputation to do so.</p>\n\n<p>R is an interpreted language whereas C is a compiled one. Loops are slow in R but your expression <code>output2[[j]][i]=nrow(subset(DF,eval(parse(text=j))))</code> represents at least 99% of the execution time. Therefore, it won't help to find a way to mix both languages. I advise you to keep both in R and find a way to speed up the process (maybe only one loop with a different expression ?) or find a way to translate your expression to a C one. I know that a lot of basic functions of R are coded in C (<a href=\"http://blog.revolutionanalytics.com/2011/08/what-language-is-r-written-in.html\" rel=\"nofollow noreferrer\" title=\"here\">as you can see here</a>), maybe it's already the case for nrow, subset and parse.</p>\n\n<p>You can also use LAPACK/BLAS library to speed up some R functions:</p>\n\n<blockquote>\n  <p>LAPACK/BLAS handles matrix math in R. If that's all you need, you can find libraries that are much faster than the vanilla ones in R (you can use some of them in R too to improve performance!).</p>\n</blockquote>\n\n<p><a href=\"https://stackoverflow.com/questions/10143485/converting-r-code-to-c-code\" title=\"stated from here\">stated from this topic from stack overflow</a></p>\n"}, {"comments": [{"owner": {"reputation": 183, "user_id": 8944334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/296295505d7bf37ac1164d208dcc9ddb?s=128&d=identicon&r=PG&f=1", "display_name": "Citizen", "link": "https://stackoverflow.com/users/8944334/citizen"}, "edited": false, "score": 0, "creation_date": 1515052922, "post_id": 48078550, "comment_id": 83156277, "body": "Thank you very much. r and DF are vector and data frame examples, so r can be bigger. If I use dplyr, I think I would have to change the code for each r, that is why I think it is not practical."}, {"owner": {"reputation": 183, "user_id": 8944334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/296295505d7bf37ac1164d208dcc9ddb?s=128&d=identicon&r=PG&f=1", "display_name": "Citizen", "link": "https://stackoverflow.com/users/8944334/citizen"}, "edited": false, "score": 0, "creation_date": 1515053781, "post_id": 48078550, "comment_id": 83156634, "body": "I have run the previous code, with length(r)=120 and dim(DF)=11540     7 , and it takes much time. That is why, I believe the fastest way could be with Rcpp."}], "tags": [], "owner": {"reputation": 7333, "user_id": 2032478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/627342e0ca0cf27489b54a97a1100744?s=128&d=identicon&r=PG", "display_name": "Jan van der Laan", "link": "https://stackoverflow.com/users/2032478/jan-van-der-laan"}, "is_accepted": true, "score": 1, "last_activity_date": 1514986679, "creation_date": 1514986679, "answer_id": 48078550, "question_id": 48077442, "link": "https://stackoverflow.com/questions/48077442/r-function-inside-c-loop/48078550#48078550", "title": "R function inside C++ loop", "body": "<p>For loops aren't necessarily slow in R. It is calling a set of functions a very large number of times, which can be slow (an with more recent versions of R, even that isn't as slow as it was). However, for loops can often be completely avoided by using vectorised code which is many times faster. </p>\n\n<p>In general using <code>eval</code> and <code>parse</code> is not needed and generally an indication that a suboptimal solution is used. In this case (without knowing the complete problem), I am not completely sure how to avoid that. However by writing the loops more efficient a speed gain of over a factor 20 can be gained without using Rcpp. </p>\n\n<p>Generate data</p>\n\n<pre><code>r &lt;- c(\"A==A[i] &amp; B==B[i]\", \"A==A[i] &amp; C==C[i] \", \"B==B[i] &amp; C==C[i] \",\n  \"A==A[i] &amp; B==B[i] &amp; C==C[i] \")\n\nDF &lt;- read.table(textConnection(\" A  B  C\n1 11 22 88\n2 11 22 47\n3  2 30 21\n4  3 30 21\"))\nDF &lt;- DF[sample(nrow(DF), 1E3, replace=TRUE), ]\n</code></pre>\n\n<p>Measure time of initial implementation</p>\n\n<pre><code>&gt; system.time({\n+   output2=list()\n+   for (j in r){\n+    for (i in 1:nrow(DF)){\n+      output2[[j]][i]=nrow(subset(DF,eval(parse(text=j))))\n+    }\n+   }\n+ })\n   user  system elapsed \n  1.120   0.007   1.127 \n</code></pre>\n\n<p>Preallocate result; doesn't help much in this case</p>\n\n<pre><code>&gt; system.time({\n+   output2=vector(length(r), mode = \"list\")\n+   names(output2) &lt;- r\n+   for (j in r){\n+     output2[[i]] &lt;- numeric(nrow(DF))\n+      for (i in 1:nrow(DF)){\n+        output2[[j]][i]=nrow(subset(DF,eval(parse(text=j))))\n+      }\n+   }\n+ })\n   user  system elapsed \n  1.116   0.000   1.116 \n</code></pre>\n\n<p>subset is not needed as we only need the number of rows. subset ceates a completely new data.frame, which generates overhead</p>\n\n<pre><code>&gt; system.time({\n+   output2=vector(length(r), mode = \"list\")\n+   names(output2) &lt;- r\n+   for (j in r){\n+     output2[[i]] &lt;- numeric(nrow(DF))\n+      for (i in 1:nrow(DF)){\n+        output2[[j]][i]=sum(eval(parse(text=j), envir = DF))\n+      }\n+   }\n+ })\n   user  system elapsed \n  0.622   0.003   0.626 \n</code></pre>\n\n<p>Parsing r takes time and is repeated nrow(DF) times, remove form inner loop</p>\n\n<pre><code>&gt; system.time({\n+   output2=vector(length(r), mode = \"list\")\n+   names(output2) &lt;- r\n+   for (j in r){\n+     output2[[i]] &lt;- numeric(nrow(DF))\n+     expr &lt;- parse(text=j)\n+      for (i in 1:nrow(DF)){\n+        output2[[j]][i]=sum(eval(expr, envir = DF))\n+      }\n+   }\n+ })\n   user  system elapsed \n  0.054   0.000   0.054 \n</code></pre>\n\n<h3>A more readable and even faster implementation using dplyr</h3>\n\n<pre><code>&gt; library(dplyr)\n&gt; system.time({\n+ output3 &lt;- DF %&gt;% group_by(A,B) %&gt;% mutate(a = n()) %&gt;%\n+   group_by(A,C) %&gt;% mutate(b = n()) %&gt;%\n+   group_by(B,C) %&gt;% mutate(c = n()) %&gt;%\n+   group_by(A,B,C) %&gt;% mutate(d = n()) \n+ })\n   user  system elapsed \n  0.010   0.000   0.009 \n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 8944334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/296295505d7bf37ac1164d208dcc9ddb?s=128&d=identicon&r=PG&f=1", "display_name": "Citizen", "link": "https://stackoverflow.com/users/8944334/citizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 48078550, "answer_count": 2, "score": -2, "last_activity_date": 1514987320, "creation_date": 1514982556, "last_edit_date": 1514987320, "question_id": 48077442, "link": "https://stackoverflow.com/questions/48077442/r-function-inside-c-loop", "title": "R function inside C++ loop", "body": "<p>I have a double loop in R. It works well, but the problem is that it runs slow with big data frames. So I would like to do the loop in C++ through the Rcpp package, but using an R function inside the loop. The  R loop is: </p>\n\n<pre><code>&gt; output2=list()\n&gt; for (j in r){\n+   for (i in 1:nrow(DF)){\n+     output2[[j]][i]=nrow(subset(DF,eval(parse(text=j))))\n+   }\n+ }\n</code></pre>\n\n<p>And the output is going to be a list.\nAn example of DF and r is:</p>\n\n<pre><code> &gt; r\n [1] \"A==A[i] &amp; B==B[i] \"           \"A==A[i] &amp; C==C[i] \"          \n [3] \"B==B[i] &amp; C==C[i] \"           \"A==A[i] &amp; B==B[i] &amp; C==C[i] \"\n &gt; DF\n    A  B  C\n 1 11 22 88\n 2 11 22 47\n 3  2 30 21\n 4  3 30 21\n</code></pre>\n\n<p>My question is how I can put the expression in the C++ code. Another question is whether this way is better than make the entire code in C++.\nI would be grateful if someone could help me with this issue.\nRegards,</p>\n"}, {"tags": ["c++", "arrays", "c++11", "pointers"], "comments": [{"owner": {"reputation": 13883, "user_id": 2883245, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/NPpPG.jpg?s=128&g=1", "display_name": "erip", "link": "https://stackoverflow.com/users/2883245/erip"}, "edited": false, "score": 1, "creation_date": 1514981630, "post_id": 48077164, "comment_id": 83128007, "body": "Don&#39;t use so many pointers."}, {"owner": {"reputation": 728, "user_id": 4628444, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-S_tKKQ1s_PY/AAAAAAAAAAI/AAAAAAAAHU8/ph4sOcIgi0w/photo.jpg?sz=128", "display_name": "JoshKisb", "link": "https://stackoverflow.com/users/4628444/joshkisb"}, "edited": false, "score": 0, "creation_date": 1514981787, "post_id": 48077164, "comment_id": 83128090, "body": "1 * for string, 2 * for string array."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1514981912, "post_id": 48077164, "comment_id": 83128162, "body": "Why do you want to take the address of the ptr_array?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1514982359, "post_id": 48077164, "comment_id": 83128420, "body": "Arrays are not pointers. Arrays of arrays, arrays of pointers, pointers to arrays, and pointers to pointers are all different. Don&#39;t use any of them. std::vector and std::string and pass by reference are your friends."}, {"owner": {"reputation": 1, "user_id": 8178737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5ac2952b5e5f11bca39be6880b763b?s=128&d=identicon&r=PG&f=1", "display_name": "user8178737", "link": "https://stackoverflow.com/users/8178737/user8178737"}, "edited": false, "score": 0, "creation_date": 1514982383, "post_id": 48077164, "comment_id": 83128433, "body": "I have to change daemon source code and pass to function with these arguments. Befor, I call program with main(int argc, char *argv[]), But, I wish assign arguments in program body."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514982883, "post_id": 48077164, "comment_id": 83128730, "body": "<code>&amp;argc, &amp;ptr_array</code> is <b>almost certainly</b> going to lead to errors. If you insist on writing C, you will have to pass correct array sizes. Do what @n.m. suggests, and re-write with idiomatic C++"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1515004654, "post_id": 48077164, "comment_id": 83141024, "body": "<a href=\"http://wiki.c2.com/?ThreeStarProgrammer\" rel=\"nofollow noreferrer\">Three star programmer detected!</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8178737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5ac2952b5e5f11bca39be6880b763b?s=128&d=identicon&r=PG&f=1", "display_name": "user8178737", "link": "https://stackoverflow.com/users/8178737/user8178737"}, "edited": false, "score": 0, "creation_date": 1514982751, "post_id": 48077362, "comment_id": 83128652, "body": "tnx alot JoshKisb for this solution!"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1514982965, "post_id": 48077362, "comment_id": 83128765, "body": "I predict that the body of <code>prac</code> will assume the length of <code>b</code> is contained in <code>*a</code>, which will <b>most likely</b> not be the case here"}], "tags": [], "owner": {"reputation": 728, "user_id": 4628444, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-S_tKKQ1s_PY/AAAAAAAAAAI/AAAAAAAAHU8/ph4sOcIgi0w/photo.jpg?sz=128", "display_name": "JoshKisb", "link": "https://stackoverflow.com/users/4628444/joshkisb"}, "is_accepted": false, "score": 1, "last_activity_date": 1514983418, "last_edit_date": 1514983418, "creation_date": 1514982271, "answer_id": 48077362, "question_id": 48077164, "link": "https://stackoverflow.com/questions/48077164/cannot-convert-char6-to-char-for-argument-2-to-void-pracint-ch/48077362#48077362", "title": "Cannot convert &#39;char*(*)[6]&#39; to &#39;char***&#39; for argument &#39;2&#39; to &#39;void prac(int*,char***)&#39;", "body": "<p><code>char *</code> is used to point to a string since only address of first char is needed because they are continous memory locations for arrays.<br>\nTherefore for and array of strings it can be an array of char pointers. aka <code>char **b</code> Only 2 not 3. or <code>char *b[]</code></p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nvoid prac(int *argc, char **b)\n{\n//body\n//\n}\n\nint main(int argc, char *argv[])\n{\n\n    char *ptr_array[] = {\"ssl\",\"0.0.0.0\",\"\",\"tcp\",\"0.0.0.0\",\"8080\"};\n    prac(&amp;argc, ptr_array);   \n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 9161864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ihhng.jpg?s=128&g=1", "display_name": "Lloyd Crawley", "link": "https://stackoverflow.com/users/9161864/lloyd-crawley"}, "is_accepted": false, "score": 1, "last_activity_date": 1515004759, "last_edit_date": 1515004759, "creation_date": 1514995836, "answer_id": 48081043, "question_id": 48077164, "link": "https://stackoverflow.com/questions/48077164/cannot-convert-char6-to-char-for-argument-2-to-void-pracint-ch/48081043#48081043", "title": "Cannot convert &#39;char*(*)[6]&#39; to &#39;char***&#39; for argument &#39;2&#39; to &#39;void prac(int*,char***)&#39;", "body": "<p>The answer is already presented for you in the arguments passed to main</p>\n\n<pre><code>int main(int argc, char* argv[])\n</code></pre>\n\n<p>As <code>char* argv[]</code> is an array of the command line arguments passed to the program. Change the argument in the prac declaration to match that like so</p>\n\n<pre><code>int prac(int* argc, char* b[])\n</code></pre>\n\n<p>Also you should be getting compilation warnings stating:</p>\n\n<blockquote>\n<pre><code>warning: ISO C++ forbids converting a string constant to \u2018char*\u2019\n</code></pre>\n</blockquote>\n\n<p>to avoid this set <code>ptr_array</code> to <code>const char*</code> and likewise for <code>const char* b[]</code> in <code>prac()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 166, "user_id": 9166558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/478cc3ab8ce513fa5e43f931f104cd7a?s=128&d=identicon&r=PG&f=1", "display_name": "T W Bennet", "link": "https://stackoverflow.com/users/9166558/t-w-bennet"}, "is_accepted": false, "score": 0, "last_activity_date": 1515095815, "creation_date": 1515095815, "answer_id": 48102627, "question_id": 48077164, "link": "https://stackoverflow.com/questions/48077164/cannot-convert-char6-to-char-for-argument-2-to-void-pracint-ch/48102627#48102627", "title": "Cannot convert &#39;char*(*)[6]&#39; to &#39;char***&#39; for argument &#39;2&#39; to &#39;void prac(int*,char***)&#39;", "body": "<p>The first answer is probably what you want.  If you really want to send the arguments as you have shown, the compiler message actually tells you how to declare the parameters:</p>\n\n<pre><code>void prac(int *argc, char *(*b)[6])\n</code></pre>\n\n<p>If you're thinking the extra layer of pointers will allow prac to change the array, it won't actually buy you much.  It lets prac change the value of argc in the main, but it can't change the actual size of the array.</p>\n"}], "owner": {"reputation": 1, "user_id": 8178737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5ac2952b5e5f11bca39be6880b763b?s=128&d=identicon&r=PG&f=1", "display_name": "user8178737", "link": "https://stackoverflow.com/users/8178737/user8178737"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1189, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1515095815, "creation_date": 1514981577, "last_edit_date": 1515016134, "question_id": 48077164, "link": "https://stackoverflow.com/questions/48077164/cannot-convert-char6-to-char-for-argument-2-to-void-pracint-ch", "title": "Cannot convert &#39;char*(*)[6]&#39; to &#39;char***&#39; for argument &#39;2&#39; to &#39;void prac(int*,char***)&#39;", "body": "<p>I see this error when compile my program:</p>\n\n<pre><code>Cannot convert 'char*(*)[6]' to 'char***' for argument '2' to 'void prac(int*,char***)'\n</code></pre>\n\n<p>How can I fix the code ? Please help me.</p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nvoid prac(int *argc, char **b[])\n{\n//body\n//\n}\n\nint main()\n{\n\n     char *ptr_array[] = {\"ssl\",\"0.0.0.0\",\"\",\"tcp\",\"0.0.0.0\",\"8080\"};\nprac(&amp;argc, &amp;ptr_array);   \n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "cppcheck"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1514981858, "post_id": 48077092, "comment_id": 83128124, "body": "Why do you want this?"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1514982169, "post_id": 48077092, "comment_id": 83128299, "body": "@HolyBlackCat That would be handy if checking consumes a lot of time. It is common practice to provide such an option. For example gcc offers <code>-Wfatal-errors</code>. Anyway, there is no reason for -3 rating for this question."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1514983644, "post_id": 48077092, "comment_id": 83129128, "body": "@VTT other than lack of research."}, {"owner": {"reputation": 7, "user_id": 9144520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/711b45e78f052813f3dac599d45b5d1d?s=128&d=identicon&r=PG", "display_name": "jonyR", "link": "https://stackoverflow.com/users/9144520/jonyr"}, "edited": false, "score": 0, "creation_date": 1514989568, "post_id": 48077092, "comment_id": 83132433, "body": "i saw this manual you put here... didn&#39;t found any help there. so i asked here... didn&#39;t know its not allowed :/"}, {"owner": {"reputation": 1415, "user_id": 3055724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZGm8W.png?s=128&g=1", "display_name": "Duloren", "link": "https://stackoverflow.com/users/3055724/duloren"}, "edited": false, "score": 0, "creation_date": 1515207803, "post_id": 48077092, "comment_id": 83224705, "body": "Here is not a platform for ask for code. Please show some effort"}], "answers": [{"tags": [], "owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "is_accepted": false, "score": 0, "last_activity_date": 1514981573, "creation_date": 1514981573, "answer_id": 48077163, "question_id": 48077092, "link": "https://stackoverflow.com/questions/48077092/how-to-make-cppcheck-stop-on-error/48077163#48077163", "title": "How to make cppcheck stop on error", "body": "<p>Looking at <a href=\"http://cppcheck.sourceforge.net/manual.pdf\" rel=\"nofollow noreferrer\">http://cppcheck.sourceforge.net/manual.pdf</a>\nThere seems to be no option to stop at first issue.  You could always contact them directly though to confirm or request the feature.</p>\n"}], "owner": {"reputation": 7, "user_id": 9144520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/711b45e78f052813f3dac599d45b5d1d?s=128&d=identicon&r=PG", "display_name": "jonyR", "link": "https://stackoverflow.com/users/9144520/jonyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1514981643, "creation_date": 1514981273, "last_edit_date": 1514981643, "question_id": 48077092, "link": "https://stackoverflow.com/questions/48077092/how-to-make-cppcheck-stop-on-error", "title": "How to make cppcheck stop on error", "body": "<p>I use cppcheck to look for errors.\nnow I'm looking for a way the stop the cppcheck run after he found the first error.</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["c++", "linux", "bash", "shell", "system"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1514980462, "post_id": 48076835, "comment_id": 83127389, "body": "What if you explicitly attempt to run <code>bash</code> with that command? The command <code>sh</code> might not be Bash, or it might be Bash without Bash extensions?"}, {"owner": {"reputation": 1110, "user_id": 3147123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5MNas.jpg?s=128&g=1", "display_name": "tomix86", "link": "https://stackoverflow.com/users/3147123/tomix86"}, "edited": false, "score": 5, "creation_date": 1514980505, "post_id": 48076835, "comment_id": 83127415, "body": "From what I see your command uses process substitution syntax <code>comm &lt;()</code>, this is a feature of <code>bash</code>, not <code>sh</code>."}, {"owner": {"reputation": 17, "user_id": 8323823, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T6Pjb9hEsYU/AAAAAAAAAAI/AAAAAAAAADE/adNhgb91SlU/photo.jpg?sz=128", "display_name": "Ashutosh Pandey", "link": "https://stackoverflow.com/users/8323823/ashutosh-pandey"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1514981060, "post_id": 48076835, "comment_id": 83127714, "body": "@Someprogrammerdude i am open terminal in ubuntu and run &quot;comm -23 &lt;(apt-mark showmanual | sort -u) &lt;(gzip -dc /var/log/installer/initial-status.gz | sed -n &#39;s/^Package: //p&#39; | sort -u) &quot;  its work but when i use system(&quot;sudo comm -23 (&lt;(apt-mark showmanual|sort -u)) (&lt;(gzip -dc /var/log/installer/initial-status.gz |sed -n &#39;s/^Package: //p&#39; |sort -u))&quot;);api its give error as subject mention."}, {"owner": {"reputation": 17, "user_id": 8323823, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T6Pjb9hEsYU/AAAAAAAAAAI/AAAAAAAAADE/adNhgb91SlU/photo.jpg?sz=128", "display_name": "Ashutosh Pandey", "link": "https://stackoverflow.com/users/8323823/ashutosh-pandey"}, "reply_to_user": {"reputation": 1110, "user_id": 3147123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5MNas.jpg?s=128&g=1", "display_name": "tomix86", "link": "https://stackoverflow.com/users/3147123/tomix86"}, "edited": false, "score": 0, "creation_date": 1514981232, "post_id": 48076835, "comment_id": 83127793, "body": "@tomix86 right but can you help me how to use it with system() API."}, {"owner": {"reputation": 1110, "user_id": 3147123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5MNas.jpg?s=128&g=1", "display_name": "tomix86", "link": "https://stackoverflow.com/users/3147123/tomix86"}, "edited": false, "score": 0, "creation_date": 1514981371, "post_id": 48076835, "comment_id": 83127887, "body": "Try (although this is a bit nasty and may need some tweaking) <code>system(&quot;&#47;bin&#47;bash -c &#39;comm -23 &lt;(apt-mark showmanual | sort -u) &lt;(gzip -dc &#47;var&#47;log&#47;installer&#47;initial-status.gz | sed -n \\&quot;s&#47;^Package: &#47;&#47;p\\&quot; | sort -u)&#39;&quot;);</code>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1514981587, "post_id": 48076835, "comment_id": 83127970, "body": "Again <code>sh</code> is not <code>bash</code>. And <code>bash</code> is not <code>sh</code>. The shell <code>sh</code> might be a minimal shell, and it might not even support all POSIX features. The <code>bash</code> shell is a very large and complex shell with many non-standard extensions. If you rely on those extension (which I guess <code>&lt;(...)</code> is) then you can&#39;t use the ordinary shell <code>sh</code>. Either you have to modify the command so plain <code>sh</code> can run it, or explicitly use <code>bash</code> (like in <code>bash -c &quot;...&quot;</code>)"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1514981625, "post_id": 48076835, "comment_id": 83128001, "body": "Also note that having <code>system(&quot;sudo ...&quot;)</code> is a security whole large as the side of a barn, just waiting to happen."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10382649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d700c25f39863b1e66e18fa312681bc0?s=128&d=identicon&r=PG&f=1", "display_name": "GGG", "link": "https://stackoverflow.com/users/10382649/ggg"}, "is_accepted": false, "score": -1, "last_activity_date": 1537309704, "creation_date": 1537309704, "answer_id": 52395430, "question_id": 48076835, "link": "https://stackoverflow.com/questions/48076835/system-returns-error-syntax-error-unexpected/52395430#52395430", "title": "system() returns error syntax error: &quot;(&quot; unexpected", "body": "<p>Just try:</p>\n\n<pre><code>system(\"bash comm -23 &lt;(apt-mark showmanual | sort -u) &lt;(gzip -dc /var/log/installer/initial-status.gz | sed -n 's/^Package: //p' | sort -u)\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "is_accepted": false, "score": 0, "last_activity_date": 1537312113, "creation_date": 1537312113, "answer_id": 52395742, "question_id": 48076835, "link": "https://stackoverflow.com/questions/48076835/system-returns-error-syntax-error-unexpected/52395742#52395742", "title": "system() returns error syntax error: &quot;(&quot; unexpected", "body": "<p>As mentioned, process substitution with <code>&lt;(...)</code> is a Bash feature that's not available in vanilla sh. As such, you'll need to explicitly invoke a Bash shell:</p>\n\n<pre><code>bash -c \"comm -23 &lt;(apt-mark showmanual | sort -u) &lt;(gzip -dc /var/log/installer/initial-status.gz | sed -n 's/^Package: //p' | sort -u)\"\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8323823, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T6Pjb9hEsYU/AAAAAAAAAAI/AAAAAAAAADE/adNhgb91SlU/photo.jpg?sz=128", "display_name": "Ashutosh Pandey", "link": "https://stackoverflow.com/users/8323823/ashutosh-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 784, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1537312113, "creation_date": 1514980268, "last_edit_date": 1514984251, "question_id": 48076835, "link": "https://stackoverflow.com/questions/48076835/system-returns-error-syntax-error-unexpected", "title": "system() returns error syntax error: &quot;(&quot; unexpected", "body": "<p>I want to use one command using the system() API in my C++ code.</p>\n\n<p>The command is:</p>\n\n<pre><code>comm -23 &lt;(apt-mark showmanual | sort -u) &lt;(gzip -dc /var/log/installer/initial-status.gz | sed -n 's/^Package: //p' | sort -u)\n</code></pre>\n\n<p>For more detail about the command, use <a href=\"https://askubuntu.com/questions/2389/generating-list-of-manually-installed-packages-and-querying-individual-packages\">this link</a>.</p>\n\n<p>This command works perfectly when I use the terminal on an Ubuntu 64-bit machine, but when I use in the <strong>system(\"above command\")</strong> API in C++ code, it shows an error, and they are below:</p>\n\n<blockquote>\n  <p>sh: 1: Syntax error: \"(\" unexpected</p>\n</blockquote>\n\n<p>I am searching on Google and find one solution (<em><a href=\"https://stackoverflow.com/questions/4077209/c-system-function-cause-error-sh-syntax-error-unexpected\">C system function causes error 'sh: Syntax error: \u201c(\u201d unexpected '</a></em>), but the accepted solution does task in another way. It's not a solution and other solution not working.</p>\n\n<p>Everyone explains about how to remove this error in the shell script (.sh file), given all solutions might be work on .sh, but they do not work for the system() API. I not able to find how to remove this error in C++ code system() API.</p>\n"}, {"tags": ["c++", "multithreading", "boost", "boost-asio"], "comments": [{"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1514980584, "post_id": 48076701, "comment_id": 83127457, "body": "Which <code>clamp</code> is being used in the code -- <a href=\"http://en.cppreference.com/w/cpp/algorithm/clamp\" rel=\"nofollow noreferrer\"><code>std::clamp</code></a>? If so, the order of the parameters appears to be incorrect.  Also, what value is returned by <code>boost::thread::physical_concurrency()</code>?"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1514980681, "post_id": 48076701, "comment_id": 83127520, "body": "What is <code>Ppm</code>? Are you sure you can modify it from different threads at the same time when calling <code>mPpm.setPixel(x, y, mForegroundColor);</code>?"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1514980966, "post_id": 48076701, "comment_id": 83127670, "body": "Try timing the thread creation loop too.  Creating threads isn&#39;t the fastest thing in the world and most thread pools tend to be long lived because of the expense in creating them."}, {"owner": {"reputation": 658, "user_id": 2372992, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/65e5b2cb3b356fe30143fe271d780f45?s=128&d=identicon&r=PG&f=1", "display_name": "amritanshu", "link": "https://stackoverflow.com/users/2372992/amritanshu"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1514981815, "post_id": 48076701, "comment_id": 83128105, "body": "I agree with @UKMonkey ... You should time only the concurrent operation even thread.wait can cause delays, use multiple runs of exe for same config to get an average result. beyond that boost&#39;s  thread CPU affinity is something that you might have to tweak through native_handle to see better results(?)"}, {"owner": {"reputation": 1, "user_id": 3118655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lJazQ.png?s=128&g=1", "display_name": "Istu7", "link": "https://stackoverflow.com/users/3118655/istu7"}, "reply_to_user": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1514982855, "post_id": 48076701, "comment_id": 83128714, "body": "@G.M. It&#39;s my own <code>clamp()</code> function and works fine. The <code>physical_concurrency()</code> returns 8 on my machine.  @VTT <code>Ppm</code> is my own image class. It&#39;s stores <code>Pixel</code>&#39;s in an <code>std::vector</code>. I&#39;ll update the question with an outline of this class.. I know that the <code>std::vector</code> is not thread safe but in this case the size of the vector does not changes, all the elements are allocated before the <code>setpixel</code> writes them and two threads does not writes the same pixel.."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 1, "creation_date": 1514983439, "post_id": 48076701, "comment_id": 83129007, "body": "I suspect your bottleneck is in dealing with the graphics subsystem. Does the graphics library have an async interface?"}, {"owner": {"reputation": 1, "user_id": 3118655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lJazQ.png?s=128&g=1", "display_name": "Istu7", "link": "https://stackoverflow.com/users/3118655/istu7"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1514983680, "post_id": 48076701, "comment_id": 83129148, "body": "@UKMonkey tried to time the thread creation and it`s around 0.05 ms for creating one thread."}, {"owner": {"reputation": 1, "user_id": 3118655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lJazQ.png?s=128&g=1", "display_name": "Istu7", "link": "https://stackoverflow.com/users/3118655/istu7"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1514984242, "post_id": 48076701, "comment_id": 83129481, "body": "@Richard Hodges there is no graphics subsystem involved. I have only one array of booleans (input data) and I iterate over this data one-by-one and modify a <code>Pixel</code> value in the <code>Ppm</code> object&#39;s vector.  There is a one-to-one correspondence between the booleans in the input and the pixels in the <code>Ppm</code> image.  So the steps is to read a value from the bool vector and depending on it&#39;s value I set the pixel to (0,0,0) or (255,255,255) in the ppm&#39;s internal vector by calling <code>setPixel</code> Thats all :)"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1514984830, "post_id": 48076701, "comment_id": 83129806, "body": "Well, if all else fails, you&#39;ll have to get the profiller out and see what it tells you is running slowly."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1514985174, "post_id": 48076701, "comment_id": 83130020, "body": "maybe unrelated, but there is a race condition between resetting the io_service and posting tasks to it. Consider using an <code>io_service::work</code> object. In the current code, it could well be that <code>run()</code> is returning in a number of the threads, meaning that the program is not as parallel as you might think."}], "answers": [{"tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": false, "score": 1, "last_activity_date": 1514988713, "creation_date": 1514988713, "answer_id": 48079074, "question_id": 48076701, "link": "https://stackoverflow.com/questions/48076701/boost-asio-io-service-mutithreading-poor-performance/48079074#48079074", "title": "Boost asio io_service mutithreading poor performance", "body": "<p>There's quite some indication that you're confused about io_service:</p>\n\n<pre><code>  boost::asio::io_service io_service;\n  boost::thread_group threads;\n  for(Size i(0); i &lt; threadCount; ++i)\n  {\n    threads.create_thread(boost::bind(&amp;boost::asio::io_service::run\n                                      , &amp;io_service));\n  }\n\n  RenderTask task(ppm, fColor);\n  io_service.reset();\n</code></pre>\n\n<p>The issues:</p>\n\n<ul>\n<li>you should not call reset() there</li>\n<li>the threads start before the io_service has any work. This means <code>run()</code> completes IMMEDIATELY, exiting the thread.</li>\n</ul>\n\n<p>So the whole thing is a giant race condition: if you're lucky some of the threads (possibly none) will not start <code>io_service::run()</code> before the first task gets enqueued, so it will all <em>seem to work</em>.</p>\n\n<p>Look at this answer for a good side-by-side of a thread-pool without using Boost Asio, and one with Boost Asio: <a href=\"https://stackoverflow.com/questions/25925256/c-work-queues-with-blocking/25928221#25928221\">c++ work queues with blocking</a></p>\n\n<blockquote>\n  <p>Note the use of <code>io_service::work</code> to avoid prematurely exiting the worker threads.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 3118655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lJazQ.png?s=128&g=1", "display_name": "Istu7", "link": "https://stackoverflow.com/users/3118655/istu7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516212425, "creation_date": 1514979751, "last_edit_date": 1516212425, "question_id": 48076701, "link": "https://stackoverflow.com/questions/48076701/boost-asio-io-service-mutithreading-poor-performance", "title": "Boost asio io_service mutithreading poor performance", "body": "<p>I'm playing with cellular automatons and trying to boost my application performance by using multi threading. But I've some interesting results. I'm not really know why this is happening and what I'm missing...</p>\n\n<p>So my aim is to process a big buffer of data as fast as I can. In my example I have a big (20000 x 20000) bool array and transforming it into an image (one bool value to one pixel). This process can be done in parallel; there isn't any dependency between the pixels. I divide the bool array into <code>threadCount</code> number of blocks, start a new thread for each block, let them run, and wait for them to finish.</p>\n\n<p>I assumed that with more threads I`ll get a bit better runtime. (I do not use an unrealistic thread count, just between one and the logical core number.)</p>\n\n<p>So I wrote this:</p>\n\n<pre><code>typedef std::size_t Size;\ntypedef std::vector&lt;bool&gt; Data;\ntypedef std::vector&lt;Data&gt; History;\n\nclass RenderTask\n{\n  public:\n    typedef void result_type;\n\n  public:\n    RenderTask(Ppm&amp; ppm,\n               const Ppm::Pixel&amp; fColor)\n      : mPpm(ppm),\n        mForegroundColor(fColor)\n    {\n    }\n\n    void operator()(const History&amp; history,\n                    const Size minIdxX,\n                    const Size countX,\n                    const Size minIdxY,\n                    const Size countY)\n    {\n      const Size maxIdxX(minIdxX + countX);\n      const Size maxIdxY(minIdxY + countY);\n      for(Size y(minIdxY); y &lt; maxIdxY; ++y)\n      {\n        for(Size x(minIdxX); x &lt; maxIdxX; ++x)\n        {\n          if(history[y][x])\n          {\n            mPpm.setPixel(x, y, mForegroundColor);\n          }\n        }\n      }\n    }\n\n  private:\n    Ppm&amp; mPpm;\n    const Ppm::Pixel mForegroundColor;\n};\n\nvoid render(const History&amp; history,\n            Ppm&amp; ppm,\n            const Ppm::Pixel&amp; fColor,\n            const Size threadCount)\n{\n  boost::asio::io_service io_service;\n  boost::thread_group threads;\n  for(Size i(0); i &lt; threadCount; ++i)\n  {\n    threads.create_thread(boost::bind(&amp;boost::asio::io_service::run,\n                                      &amp;io_service));\n  }\n\n  RenderTask task(ppm, fColor);\n  io_service.reset();\n\n  const Size count(history.size() / threadCount);\n  const Size rem(history.size() % threadCount);\n  Size minIdxY(0);\n  for(Size i(0); i &lt; threadCount; ++i)\n  {\n    const bool addRemainders(rem &amp;&amp; i == threadCount - 1);\n    io_service.post(boost::bind(task,\n                                boost::cref(history),\n                                0,\n                                history.front().size(),\n                                minIdxY,\n                                addRemainders ? count + rem : count));\n    minIdxY += count;\n  }\n\n  threads.join_all();\n}\n\nint main(int argc, char* argv[])\n{\n  const Size rule(parseNumber&lt;Size&gt;(argv[1]));\n  const Size size(parseNumber&lt;Size&gt;(argv[2]));\n  const Size iteration(parseNumber&lt;Size&gt;(argv[3]));\n  const Size threadCount(clamp(1,\n                               static_cast&lt;Size&gt;(boost::thread::physical_concurrency())\n                               parseNumber&lt;Size&gt;(argv[4])));\n  ...\n  History history(iteration, Data(size, false));\n  history.front()[size / 2] = true;\n  ...\n  process(history, rule, threadCount);\n  ...\n  Ppm ppm(history.front().size(), history.size(), Ppm::Pixel(30, 30, 30));\n  std::cout &lt;&lt; \"rendering... \";\n  t.start();\n  render(history, ppm, Ppm::Pixel(200, 200, 200),  threadCount);\n  t.stop();\n  std::cout &lt;&lt; t.ms() &lt;&lt; \" ms\" &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>But when I ran the program with different number of threads I got the following:</p>\n\n<p>I have no idea why the more cores could not result in better performance. With two cores it's a bit better, but interestingly with three cores it almost as the same as with one core... These value are averages:</p>\n\n<pre><code>ThreadingTest.exe 110 20000 20000 1 test.ppm\nrendering... 554.95 ms\n\nThreadingTest.exe 110 20000 20000 2 test.ppm\nrendering... 289.75 ms\n\nThreadingTest.exe 110 20000 20000 3 test.ppm\nrendering... 555.37 ms\n\nThreadingTest.exe 110 20000 20000 4 test.ppm\nrendering... 554.23 ms\n\nThreadingTest.exe 110 20000 20000 5 test.ppm\nrendering... 564.23 ms\n\nThreadingTest.exe 110 20000 20000 6 test.ppm\nrendering... 551.82 ms\n\nThreadingTest.exe 110 20000 20000 7 test.ppm\nrendering... 555.22 ms\n\nThreadingTest.exe 110 20000 20000 8 test.ppm\nrendering... 510.12 ms\n</code></pre>\n\n<p>What can causes this? Am I using the io_service in a wrong fashion? There is no I/O operation involved, just pure memory.</p>\n\n<p>I have eight cores in my machine with 16 GB of RAM.</p>\n\n<p>For additional details, here is the outline of the Ppm class:</p>\n\n<pre><code>class Ppm\n{\n  public:\n    struct Pixel\n    {\n      typedef unsigned char ChannelType;\n      ChannelType  mRed, mGreen, mBlue;\n      ...\n    };\n\n    typedef std::vector&lt;Pixel&gt; ImageData;\n\n    Ppm( const SizeType width\n         , const SizeType height\n         , const Pixel&amp; color = Pixel() )\n      : mWidth( width )\n      , mHeight( height )\n      , mImageData( mWidth * mHeight, color )\n    { }\n\n    void setPixel( SizeType x, SizeType y, const Pixel&amp; p )\n    {\n      mImageData[x + y * mWidth] = p;\n    }\n    ...\n  private:\n    const SizeType mWidth;\n    const SizeType mHeight;\n    ImageData mImageData;\n};\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>After your valuable comments I changed the approach a lot and wrote this:\nNow I'm using pure c++'11 stuff and there is no boost involved anymore..</p>\n\n<pre><code>class ThreadPool\n{\n  public:\n    ThreadPool(const Size threadCount);\n    ~ThreadPool();\n\n  public:\n    template&lt;class T&gt;\n    void addTask(T task);\n    void wait();\n\n  private:\n    bool mStopped;\n    Size mRunningCount;\n    std::vector&lt;std::thread&gt; mWorkers;\n    std::deque&lt;std::function&lt;void()&gt;&gt; mTasks;\n    std::mutex mMutex;\n    std::condition_variable mCondition;\n    std::condition_variable mFinishCondition;\n};\n\nThreadPool::ThreadPool(const Size threadCount)\n  : mStopped(false),\n    mRunningCount(0)\n{\n  for (Size i(0); i &lt; threadCount; ++i)\n  {\n    mWorkers.push_back(std::thread([this]()\n      {\n        std::function&lt;void()&gt; task;\n        while(true)\n        {\n          {\n            std::unique_lock&lt;std::mutex&gt; lock(this-&gt;mMutex);\n\n            this-&gt;mCondition.wait(lock, [this] { return this-&gt;mStopped ||\n                                                        !this-&gt;mTasks.empty();\n                                               });\n            if(this-&gt;mStopped)\n            {\n              return;\n            }\n\n            ++this-&gt;mRunningCount;\n            task = this-&gt;mTasks.front();\n            this-&gt;mTasks.pop_front();\n          }\n\n          task();\n\n          {\n            std::unique_lock&lt;std::mutex&gt; lock(this-&gt;mMutex);\n            --this-&gt;mRunningCount;\n          }\n\n          this-&gt;mFinishCondition.notify_all();\n      }\n    }));\n  }\n}\n\nThreadPool::~ThreadPool()\n{\n  {\n    std::unique_lock&lt;std::mutex&gt; lock(mMutex);\n    mStopped = true;\n    mCondition.notify_all();\n  }\n\n  for(auto&amp; worker : mWorkers)\n  {\n    worker.join();\n  }\n}\n\ntemplate&lt;class T&gt;\nvoid ThreadPool::addTask(T task)\n{\n  {\n    std::unique_lock&lt;std::mutex&gt; lock(mMutex);\n    mTasks.push_back(std::function&lt;void()&gt;(task));\n  }\n  mCondition.notify_one();\n}\n\nvoid ThreadPool::wait()\n{\n  std::unique_lock&lt;std::mutex&gt; lock(mMutex);\n  mFinishCondition.wait(lock, [this]()\n    {\n      return mTasks.empty() &amp;&amp; mRunningCount == 0;\n    });\n}\n</code></pre>\n\n<p>Now the performance is OK; using more threads the runtime gets faster...\nBut something is not good with the wait method. I'm using it in this way:</p>\n\n<pre><code>ThreadPool pool(threadCount);\nfor(Size i(1); i &lt; iteration; ++i)\n{\n  Size count(history.front().size() / threadCount);\n  Size rem(history.front().size() % threadCount);\n  Size minIdx(0);\n  for(Size n(0); n &lt; threadCount; ++n)\n  {\n    pool.addTask(std::bind(ECATask(rule),\n                           std::cref(history[i-1]),\n                           std::ref(history[i]),\n                           minIdx,\n                           (rem &amp;&amp; n == threadCount - 1) ?\n                             count + rem :\n                             count));\n    minIdx += count;\n  }\n  pool.wait();\n}\n</code></pre>\n\n<p>The problem with this in not clear yet, but it seems the <code>pool.wait()</code> sometimes does not wait for all the current tasks to be finished and code starts a new iteration... Can you please do a code review for me? :)</p>\n"}, {"tags": ["c++", "c", "graphics"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 4, "creation_date": 1514979417, "post_id": 48076571, "comment_id": 83126839, "body": "It&#39;s very hard to tell what you&#39;re trying to do and what it wrong. Please include a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1514979487, "post_id": 48076571, "comment_id": 83126884, "body": "And you should copy and paste error messages exactly."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 6, "creation_date": 1514979490, "post_id": 48076571, "comment_id": 83126886, "body": "Turbo C is ancient history by now. So is the <code>&quot;graphics.h&quot;</code> header file and the library. What you learn from using them will have no (or very little) practical bearing on your life later as a programmer."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1514979765, "post_id": 48076571, "comment_id": 83127027, "body": "Turbo C was discontinued ages ago. Do yourself a favor and use something else."}, {"owner": {"reputation": 60876, "user_id": 2060725, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WUKmO.png?s=128&g=1", "display_name": "nvoigt", "link": "https://stackoverflow.com/users/2060725/nvoigt"}, "edited": false, "score": 3, "creation_date": 1514979797, "post_id": 48076571, "comment_id": 83127041, "body": "I have colleagues that are younger than that compiler. Please get a book or teacher that teaches this centuries&#39; programming."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1514980074, "post_id": 48076571, "comment_id": 83127173, "body": "&quot;<i>I uploaded the picture of error on turbo C</i>&quot; <b>Don&#39;t</b> post pictures of errors: <b>copy-paste</b> them."}, {"owner": {"reputation": 61, "user_id": 9123942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ad63f6647147a3fd91e695c19385da?s=128&d=identicon&r=PG&f=1", "display_name": "KD.", "link": "https://stackoverflow.com/users/9123942/kd"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1514980103, "post_id": 48076571, "comment_id": 83127186, "body": "@Klutt turbo C discontinued but no IDE supporting graphics. h header file and to manually include it"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 2, "creation_date": 1514980205, "post_id": 48076571, "comment_id": 83127240, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/37322352/bgi-in-computer-graphics\">BGI in computer graphics</a>"}, {"owner": {"reputation": 61, "user_id": 9123942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ad63f6647147a3fd91e695c19385da?s=128&d=identicon&r=PG&f=1", "display_name": "KD.", "link": "https://stackoverflow.com/users/9123942/kd"}, "reply_to_user": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1514980496, "post_id": 48076571, "comment_id": 83127409, "body": "@david I seen that but still getting error and now saying divide error"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1514980790, "post_id": 48076571, "comment_id": 83127578, "body": "@kd vote retracted and possible answer posted."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 9123942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ad63f6647147a3fd91e695c19385da?s=128&d=identicon&r=PG&f=1", "display_name": "KD.", "link": "https://stackoverflow.com/users/9123942/kd"}, "edited": false, "score": 0, "creation_date": 1514980345, "post_id": 48076793, "comment_id": 83127317, "body": "Still getting error of &quot;divide error&quot;"}, {"owner": {"reputation": 438, "user_id": 6024572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aa06a94c677c04a72eceba9db3c10d0?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Singh", "link": "https://stackoverflow.com/users/6024572/gaurav-singh"}, "reply_to_user": {"reputation": 61, "user_id": 9123942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ad63f6647147a3fd91e695c19385da?s=128&d=identicon&r=PG&f=1", "display_name": "KD.", "link": "https://stackoverflow.com/users/9123942/kd"}, "edited": false, "score": 0, "creation_date": 1514980526, "post_id": 48076793, "comment_id": 83127432, "body": "Made sure that C:\\TURBOC3\\BGI is the address of EGAVGA.BGI file ?"}, {"owner": {"reputation": 61, "user_id": 9123942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ad63f6647147a3fd91e695c19385da?s=128&d=identicon&r=PG&f=1", "display_name": "KD.", "link": "https://stackoverflow.com/users/9123942/kd"}, "edited": false, "score": 0, "creation_date": 1514980696, "post_id": 48076793, "comment_id": 83127530, "body": "Yes sure there contains EGAVGA.BGI file at that address"}], "tags": [], "owner": {"reputation": 438, "user_id": 6024572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aa06a94c677c04a72eceba9db3c10d0?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Singh", "link": "https://stackoverflow.com/users/6024572/gaurav-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1514980117, "creation_date": 1514980117, "answer_id": 48076793, "question_id": 48076571, "link": "https://stackoverflow.com/questions/48076571/graphics-in-c-and-c/48076793#48076793", "title": "graphics in c and c++", "body": "<p>The path string should be \"C:\\\\TURBOC3\\\\BGI\" (note the double backslashes instead of single backslashes)<br>\nI hope this solves the problem. I can't see any other error in code. </p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 9123942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ad63f6647147a3fd91e695c19385da?s=128&d=identicon&r=PG&f=1", "display_name": "KD.", "link": "https://stackoverflow.com/users/9123942/kd"}, "edited": false, "score": 0, "creation_date": 1514981099, "post_id": 48076955, "comment_id": 83127738, "body": "Thanks it works now"}], "tags": [], "owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "is_accepted": true, "score": 1, "last_activity_date": 1514997597, "last_edit_date": 1514997597, "creation_date": 1514980762, "answer_id": 48076955, "question_id": 48076571, "link": "https://stackoverflow.com/questions/48076571/graphics-in-c-and-c/48076955#48076955", "title": "graphics in c and c++", "body": "<p>In addition to the backslash issue in the path, it's <em>extremely</em> unlikely that you are using a 3270 compatible display.  Why don't you pass in the address of <code>a</code> with <code>a=0</code>.  <code>ab</code> must be set to a requested mode unless you set the driver to <code>autodetect</code>, which will then select the highest available mode.  See <a href=\"https://www.cs.colorado.edu/~main/bgi/doc/initgraph.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 61, "user_id": 9123942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ad63f6647147a3fd91e695c19385da?s=128&d=identicon&r=PG&f=1", "display_name": "KD.", "link": "https://stackoverflow.com/users/9123942/kd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "closed_date": 1514984470, "accepted_answer_id": 48076955, "answer_count": 2, "score": -6, "last_activity_date": 1514997597, "creation_date": 1514979315, "last_edit_date": 1514980954, "question_id": 48076571, "link": "https://stackoverflow.com/questions/48076571/graphics-in-c-and-c", "closed_reason": "Needs details or clarity", "title": "graphics in c and c++", "body": "<p>In turbo c 3.2 I am getting   </p>\n\n<blockquote>\n  <p>Divide error</p>\n</blockquote>\n\n<p>and in code blocks IDE I getting error that </p>\n\n<blockquote>\n  <p>initgraph() and closegraph() are refrence at compile time. (I added graphics header and library file in folder of codeblocks).Please give me solution?</p>\n</blockquote>\n\n<p>the code i written is</p>\n\n<pre><code>#include&lt;graphics.h&gt;\nint main()\n{\n   int a=10,ab;\n   initgraph(&amp;a,&amp;ab,\"C:\\\\TURBOC3\\\\BGI\");\n   circle(100,200,20);\n   closegraph();\n   return 0;\n }\n</code></pre>\n"}, {"tags": ["c++", "boost", "boost-asio"], "comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1514988869, "post_id": 48076068, "comment_id": 83132039, "body": "@rafix07 please undelete your fine response, as it contains important discussion. People will now simply waste time coming up with the exact same things you already diagnosed."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1514989057, "post_id": 48076068, "comment_id": 83132162, "body": "Re: <a href=\"https://stackoverflow.com/questions/48076068/crash-terminate-called-after-throwing-an-instance-of-stdsystem-error-what#comment83129833_48076580\"><code>_thanks @ rafix07.. no crashes any more.. But, I have to do Ctrl-C on the shell of server application to exit the program.. Why does it not exit ? May be because Acceptor::close() does not get called.. How to make that happen ? Pls suggest..._</code></a> I will just suggest looking at the MANY samples online, instead of making people debug your code: <a href=\"https://stackoverflow.com/questions/46935025/boost-asio-single-tcp-server-many-clients/46935127#46935127\" title=\"boost asio single tcp server many clients\">stackoverflow.com/questions/46935025/&hellip;</a>"}, {"owner": {"reputation": 261, "user_id": 5617251, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/3676a7bfe81dd7f0127b3cbd557ad3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Sharma", "link": "https://stackoverflow.com/users/5617251/nishant-sharma"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1514992502, "post_id": 48076068, "comment_id": 83134246, "body": "@sehe .. can you run the code and let me know how to overcome the crash that I mentioned ?"}, {"owner": {"reputation": 261, "user_id": 5617251, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/3676a7bfe81dd7f0127b3cbd557ad3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Sharma", "link": "https://stackoverflow.com/users/5617251/nishant-sharma"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1514993429, "post_id": 48076068, "comment_id": 83134815, "body": "Actually @sehe ... I did look at some examples and most of them were asynchronous I/O related... What I posted above was for synchronous I/O using thread ... Request you to pls take time and help out...."}], "answers": [{"comments": [{"owner": {"reputation": 261, "user_id": 5617251, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/3676a7bfe81dd7f0127b3cbd557ad3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Sharma", "link": "https://stackoverflow.com/users/5617251/nishant-sharma"}, "edited": false, "score": 0, "creation_date": 1515022573, "post_id": 48084444, "comment_id": 83148310, "body": "Thanks @sehe  I still have 2 issues :   a) I still see that the server application when run does not end and I have to press Ctrl-C to do that.. I expect the Server app to exit cleanly...   b) Using detach() on thread is usually not a good practice.. Isn&#39;t it ? We should always join a thread at end.. So, can we get rid of that detach()  ?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 261, "user_id": 5617251, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/3676a7bfe81dd7f0127b3cbd557ad3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Sharma", "link": "https://stackoverflow.com/users/5617251/nishant-sharma"}, "edited": false, "score": 0, "creation_date": 1515029484, "post_id": 48084444, "comment_id": 83149886, "body": "The detach is not the problem (you can synchronize on the thread&#39;s completion using other methods than <code>join</code>). Having &quot;runaway&quot; threads or uncompleted threads at program exit is the problem."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 261, "user_id": 5617251, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/3676a7bfe81dd7f0127b3cbd557ad3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Sharma", "link": "https://stackoverflow.com/users/5617251/nishant-sharma"}, "edited": false, "score": 0, "creation_date": 1515029534, "post_id": 48084444, "comment_id": 83149902, "body": "About the shutdown, you don&#39;t have a way to cancel a synchronous accept. You might try (a) boost thread interruption points (don&#39;t think/know that will work) (b) connecting from the server itself to make sure the accept returns"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 261, "user_id": 5617251, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/3676a7bfe81dd7f0127b3cbd557ad3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Sharma", "link": "https://stackoverflow.com/users/5617251/nishant-sharma"}, "edited": false, "score": 0, "creation_date": 1515030407, "post_id": 48084444, "comment_id": 83150086, "body": "Here&#39;s a proof-of-concept of that last ugly workaround: <a href=\"http://coliru.stacked-crooked.com/a/ef5cc6c3b0b494dc\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/ef5cc6c3b0b494dc</a>"}, {"owner": {"reputation": 261, "user_id": 5617251, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/3676a7bfe81dd7f0127b3cbd557ad3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Sharma", "link": "https://stackoverflow.com/users/5617251/nishant-sharma"}, "edited": false, "score": 0, "creation_date": 1515041786, "post_id": 48084444, "comment_id": 83152318, "body": "The proof of concept looks good.. I like the idea of connecting to itself. The code has a problem on line 53 .. It should be under the condition of if(joinable()) because detached threads cannot be joined. Do you agree ?"}, {"owner": {"reputation": 261, "user_id": 5617251, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/3676a7bfe81dd7f0127b3cbd557ad3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Sharma", "link": "https://stackoverflow.com/users/5617251/nishant-sharma"}, "edited": false, "score": 0, "creation_date": 1515041869, "post_id": 48084444, "comment_id": 83152343, "body": "Also, @sehe, Regarding the comment &quot;The detach is not the problem (you can synchronize on the thread&#39;s completion using other methods than join). ... &quot; .... Can you please elaborate more on this  ? How to handle uncompleted threads at program exit ?"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": false, "score": 3, "last_activity_date": 1515010161, "creation_date": 1515010161, "answer_id": 48084444, "question_id": 48076068, "link": "https://stackoverflow.com/questions/48076068/crash-terminate-called-after-throwing-an-instance-of-stdsystem-error-what/48084444#48084444", "title": "Crash : terminate called after throwing an instance of &#39;std::system_error&#39; what(): Resource deadlock avoided", "body": "<blockquote>\n  <p>@sehe .. can you run the code and let me know how to overcome the crash that I mentioned ? \u2013 Nishant Sharma</p>\n</blockquote>\n\n<p>Actually, no I won't. The problem has already been analyzed: you can't <code>join</code> the current thread (it would deadlock). </p>\n\n<p>But I can do something better:</p>\n\n<p>Grabbing my crystal ball, I can guess you got this example from a particular book, named <a href=\"https://twitter.com/sehetw/status/938804901563551744\" rel=\"nofollow noreferrer\">Boost.Asio C++ Network Programming Cookbook</a>\u00b9, around page 139.</p>\n\n<p>I recognized it after a while when I added up all the code smells (<code>delete this</code> and <code>m_stop.load()</code> tipped me over the edge).</p>\n\n<p>The good news is, I reviewed that code before: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/47691801/asio-example-code-closing-socket-before-it-should\">ASIO example code closing socket before it should</a></p>\n\n<p>You can probably profit from the particular comments I made there.</p>\n\n<p>\u00b9 from packtpub: <a href=\"https://www.packtpub.com/application-development/boostasio-c-network-programming-cookbook\" rel=\"nofollow noreferrer\">https://www.packtpub.com/application-development/boostasio-c-network-programming-cookbook</a></p>\n"}], "owner": {"reputation": 261, "user_id": 5617251, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/3676a7bfe81dd7f0127b3cbd557ad3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Sharma", "link": "https://stackoverflow.com/users/5617251/nishant-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7585, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1515010161, "creation_date": 1514977391, "last_edit_date": 1514985454, "question_id": 48076068, "link": "https://stackoverflow.com/questions/48076068/crash-terminate-called-after-throwing-an-instance-of-stdsystem-error-what", "title": "Crash : terminate called after throwing an instance of &#39;std::system_error&#39; what(): Resource deadlock avoided", "body": "<p>I have a simple client /server application the code of which is mentioned below. \nPlease run the server in one shell and the client in another shell in linux. \nFirst start the server and then the client.\nWhen the server is done with it's work, it crashes with following exception:</p>\n\n<p><em>terminate called after throwing an instance of 'std::system_error'\n  what():  Resource deadlock avoided</em></p>\n\n<p>This happens from the line m_thread->join() from inside the function Service::HandleClient\nI have no clue on what's going on.. Can someone please check the code.. I just want that the server application  should also get closed correctly the way the client application got closed.</p>\n\n<p>**Server Code : **</p>\n\n<pre><code>#include &lt;boost/asio.hpp&gt;\n\n#include &lt;thread&gt;\n#include &lt;atomic&gt;\n#include &lt;memory&gt;\n#include &lt;iostream&gt;\n\nusing namespace boost;\n\nclass Service {\npublic:\n    Service(){}\n\n    void StartHandligClient(\n        std::shared_ptr&lt;asio::ip::tcp::socket&gt; sock) {\n\n        m_thread.reset(new std::thread (([this, sock]() {\n            HandleClient(sock);\n        })) );\n\n    }\n\nprivate:\n    void HandleClient(std::shared_ptr&lt;asio::ip::tcp::socket&gt; sock) {\n        while(1)\n        {\n            try {\n                asio::streambuf request;\n                std::cout &lt;&lt; \"Waiting to read \\n\";\n                asio::read_until(*sock.get(), request, '\\n');\n\n                std::string s( (std::istreambuf_iterator&lt;char&gt;(&amp;request)), std::istreambuf_iterator&lt;char&gt;() );\n                std::cout &lt;&lt; \"Server got : \" &lt;&lt; s &lt;&lt; \"\\n\";\n\n                // Emulate request processing.\n                int i = 0;\n                while (i != 1000000)\n                    i++;\n\n                std::this_thread::sleep_for(\n                        std::chrono::milliseconds(500));\n\n                // Sending response.\n                std::string response = \"Response\\n\";\n                asio::write(*sock.get(), asio::buffer(response));\n            }\n            catch (system::system_error &amp;e) {\n                boost::system::error_code ec = e.code();\n                if(ec == asio::error::eof)\n                {\n                    std::cout &lt;&lt; \"Breaking loop \\n\";\n                    break;\n                }\n                std::cout &lt;&lt; \"Error occured! Error code = \"\n                    &lt;&lt; e.code() &lt;&lt; \". Message: \"\n                    &lt;&lt; e.what();\n            }\n        }\n\n        m_thread-&gt;join();\n\n        // Clean-up.\n        delete this;\n    }\n    std::unique_ptr&lt;std::thread&gt; m_thread;\n};\n\nclass Acceptor {\npublic:\n    Acceptor(asio::io_service&amp; ios, unsigned short port_num) :\n        m_ios(ios),\n        m_acceptor(m_ios,\n        asio::ip::tcp::endpoint(\n        asio::ip::address_v4::any(),\n        port_num))\n    {\n        m_acceptor.listen();\n    }\n\n    void Accept() {\n        std::cout &lt;&lt; \"Server Accept() \\n\" &lt;&lt; std::flush;\n        std::shared_ptr&lt;asio::ip::tcp::socket&gt;\n            sock(new asio::ip::tcp::socket(m_ios));\n\n        std::cout &lt;&lt; \"BEFORE calling acceptor's accept function \\n\" &lt;&lt; std::flush;\n        m_acceptor.accept(*sock.get());\n        std::cout &lt;&lt; \"AFTER calling acceptor's accept function \\n\" &lt;&lt; std::flush;\n\n\n        (new Service)-&gt;StartHandligClient(sock);\n    }\n\n    void close()\n    {\n        std::cout &lt;&lt; \"Inside Acceptor.close() \\n\" &lt;&lt; std::flush;\n        m_acceptor.close();\n    }\n\nprivate:\n    asio::io_service&amp; m_ios;\n    asio::ip::tcp::acceptor m_acceptor;\n};\n\nclass Server {\npublic:\n    Server() : m_stop(false) {}\n\n    void Start(unsigned short port_num) {\n        m_thread.reset(new std::thread([this, port_num]() {\n            Run(port_num);\n        }));\n    }\n\n    void Stop() {\n        m_stop.store(true);\n        m_thread-&gt;join();\n    }\n\nprivate:\n    void Run(unsigned short port_num) {\n        Acceptor acc(m_ios, port_num);\n\n        while (!m_stop.load()) {\n            std::cout &lt;&lt; \"Server accept\\n\" &lt;&lt; std::flush;\n            acc.Accept();\n        }\n        acc.close();\n    }\n\n    std::unique_ptr&lt;std::thread&gt; m_thread;\n    std::atomic&lt;bool&gt; m_stop;\n    asio::io_service m_ios;\n};\n\nint main()\n{\n    unsigned short port_num = 3333;\n\n    try {\n        Server srv;\n        srv.Start(port_num);\n\n        std::this_thread::sleep_for(std::chrono::seconds(4));\n\n        srv.Stop();\n    }\n    catch (system::system_error &amp;e) {\n        std::cout &lt;&lt; \"Error occured! Error code = \"\n            &lt;&lt; e.code() &lt;&lt; \". Message: \"\n            &lt;&lt; e.what();\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>**Client Code : **</p>\n\n<pre><code>#include &lt;boost/asio.hpp&gt;\n#include &lt;iostream&gt;\n\nusing namespace boost;\n\nclass SyncTCPClient {\npublic:\n    SyncTCPClient(const std::string&amp; raw_ip_address,\n        unsigned short port_num) :\n        m_ep(asio::ip::address::from_string(raw_ip_address),\n        port_num),\n        m_sock(m_ios) {\n\n        m_sock.open(m_ep.protocol());\n    }\n\n    void connect() {\n        m_sock.connect(m_ep);\n    }\n\n    void close() {\n        m_sock.shutdown(\n            boost::asio::ip::tcp::socket::shutdown_both);\n        m_sock.close();\n    }\n\n    std::string emulateLongComputationOp(\n        unsigned int duration_sec) {\n\n        std::string request = \"EMULATE_LONG_COMP_OP \"\n            + std::to_string(duration_sec)\n            + \"\\n\";\n\n        sendRequest(request);\n        return receiveResponse();\n    };\n\nprivate:\n    void sendRequest(const std::string&amp; request)\n    {\n        std::cout &lt;&lt; \"Inside sendRequest : \" &lt;&lt; request &lt;&lt; \"\\n\";\n        asio::write(m_sock, asio::buffer(request));\n    }\n\n    std::string receiveResponse() {\n        asio::streambuf buf;\n        asio::read_until(m_sock, buf, '\\n');\n\n        std::istream input(&amp;buf);\n\n        std::string response;\n        std::getline(input, response);\n\n        return response;\n    }\n\nprivate:\n    asio::io_service m_ios;\n\n    asio::ip::tcp::endpoint m_ep;\n    asio::ip::tcp::socket m_sock;\n};\n\nint main()\n{\n    const std::string raw_ip_address = \"127.0.0.1\";\n    const unsigned short port_num = 3333;\n\n    try {\n        SyncTCPClient client(raw_ip_address, port_num);\n\n        // Sync connect.\n        client.connect();\n\n        std::cout &lt;&lt; \"Sending request to the server... \" &lt;&lt; std::endl;\n        std::string response = client.emulateLongComputationOp(10);\n\n        std::cout &lt;&lt; \"Response received: \" &lt;&lt; response &lt;&lt; std::endl;\n        sleep(2);\n\n        // Close the connection and free resources.\n        client.close();\n    }\n    catch (system::system_error &amp;e) {\n        std::cout &lt;&lt; \"Error occured! Error code = \" &lt;&lt; e.code()\n            &lt;&lt; \". Message: \" &lt;&lt; e.what();\n\n        return e.code().value();\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "stl", "singly-linked-list"], "comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1514977710, "post_id": 48075877, "comment_id": 83125898, "body": "I think you should just post your code so that we can see what you&#39;re doing."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 1, "creation_date": 1514978543, "post_id": 48075877, "comment_id": 83126375, "body": "Do you have a question?"}, {"owner": {"reputation": 201, "user_id": 1170423, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ea164583031367081bbc43d2002eaefb?s=128&d=identicon&r=PG", "display_name": "upsidedown", "link": "https://stackoverflow.com/users/1170423/upsidedown"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1515092564, "post_id": 48075877, "comment_id": 83178938, "body": "@UKMonkey Added the original code."}, {"owner": {"reputation": 201, "user_id": 1170423, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ea164583031367081bbc43d2002eaefb?s=128&d=identicon&r=PG", "display_name": "upsidedown", "link": "https://stackoverflow.com/users/1170423/upsidedown"}, "edited": false, "score": 0, "creation_date": 1515092595, "post_id": 48075877, "comment_id": 83178955, "body": "@manni66 I tried to clarify, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1514980230, "creation_date": 1514980230, "answer_id": 48076822, "question_id": 48075877, "link": "https://stackoverflow.com/questions/48075877/implementing-stable-partition-for-forward-list/48076822#48076822", "title": "Implementing stable_partition for forward_list", "body": "<p>Having to maintain the preceding iterators for <code>std::forward_list::splice_after</code> makes it a bit trickier, but still pretty short:</p>\n\n<pre><code>template&lt;class T, class UnaryPredicate&gt;\nstd::array&lt;std::forward_list&lt;T&gt;, 2&gt;\nstable_partition(std::forward_list&lt;T&gt;&amp; list, UnaryPredicate p) {\n    std::array&lt;std::forward_list&lt;T&gt;, 2&gt;  r;\n    decltype(r[0].before_begin()) pos[2] = {r[0].before_begin(), r[1].before_begin()};\n    for(auto i = list.before_begin(), ni = i, e = list.end(); ++ni != e; ni = i) {\n        bool idx = p(*ni);\n        auto&amp; p = pos[idx];\n        r[idx].splice_after(p, list, i);\n        ++p;\n    }\n    return r;\n}\n</code></pre>\n\n<p>Usage example:</p>\n\n<pre><code>template&lt;class T&gt;\nvoid print(std::forward_list&lt;T&gt; const&amp; list) {\n    for(auto const&amp; e : list)\n        std::cout &lt;&lt; e &lt;&lt; ' ';\n    std::cout &lt;&lt; '\\n';\n}\n\nint main() {\n    std::forward_list&lt;int&gt; l{0,1,2,3,4,5,6};\n    print(l);\n    // Partition into even and odd elements.\n    auto p = stable_partition(l, [](auto e) { return e % 2; });\n    print(p[0]); // Even elements.\n    print(p[1]); // Odd elements.\n}\n</code></pre>\n"}], "owner": {"reputation": 201, "user_id": 1170423, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ea164583031367081bbc43d2002eaefb?s=128&d=identicon&r=PG", "display_name": "upsidedown", "link": "https://stackoverflow.com/users/1170423/upsidedown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 1, "accepted_answer_id": 48076822, "answer_count": 1, "score": -1, "last_activity_date": 1515092482, "creation_date": 1514976588, "last_edit_date": 1515092482, "question_id": 48075877, "link": "https://stackoverflow.com/questions/48075877/implementing-stable-partition-for-forward-list", "title": "Implementing stable_partition for forward_list", "body": "<p>I want to implement something similar to std::stable_partition but for forward_list of c++11.\nThe stl version requires bidirectional iterators, however by utilizing container specific methods I believe I can get the same outcome effeciently.</p>\n\n<p>Example declaration :</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename T, typename UnaryPredicate&gt;\nvoid stable_partition(std::forward_list&lt;T&gt;&amp; list, UnaryPredicate p);\n</code></pre>\n\n<p>(while possible to add begin and end iterators, I omitted them for brevity. The same for returning the partition point ) </p>\n\n<p>I already worked out the algorithm to accomplish this on my own list type, but I have troubles implementing it in stl.</p>\n\n<p>The key method appears to be splice_after. Other methods require memory allocations and copying elements.</p>\n\n<p>Algorithm sketch :</p>\n\n<ul>\n<li>create a new empty list. It will hold all elements p returns true on.</li>\n<li>loop over the target list, add items to the true list in accordance to invoking p. </li>\n<li>concat the true list to the beginning of the target list. </li>\n</ul>\n\n<p>With proper coding this should be linear time (all operations inside the loop can be done in constant time) and without extra memory allocation or copying. </p>\n\n<p>I am trying to implement the second step using splice_after, but I end up either concating the wrong element or invalidating my iterators.</p>\n\n<p>The question:</p>\n\n<p>What is the correct use of splice_after, so that I avoid\nmixing iterators between lists and insert the correct elements?</p>\n\n<p>First Attempt (how I hoped it works):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename T, typename UnaryPredicate&gt;\nvoid stable_partition(std::forward_list&lt;T&gt;&amp; list, UnaryPredicate p)\n{\n    std::forward_list&lt;T&gt; positives;\n    auto positives_iter = positives.before_begin();\n\n    for (auto iter = list.begin(); iter != list.end(); ++iter)\n    {\n        if (p(*iter))\n            positives.splice_after(positives_iter, list, iter);\n    }\n\n    list.splice_after(list.before_begin(), positives);\n}\n</code></pre>\n\n<p>Unfortunately this has at least one major flaw: splice_after inserts after iter, and the wrong element is inserted.</p>\n\n<p>Also, when the element is moved to the other list, incrementing iter now traverses the wrong list.</p>\n"}, {"tags": ["c++", "regex"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1514976415, "post_id": 48075761, "comment_id": 83125204, "body": "You may use <code>(?=\\r?\\n|$)</code>, for example, instead of <code>$</code>."}, {"owner": {"reputation": 3, "user_id": 8899782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/821a3c00afaf32ce7afa0a437d221d4b?s=128&d=identicon&r=PG&f=1", "display_name": "mail", "link": "https://stackoverflow.com/users/8899782/mail"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1514976557, "post_id": 48075761, "comment_id": 83125280, "body": "@WiktorStribi\u017cew i do, i have not result, it&#39;s incorrect"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1514976601, "post_id": 48075761, "comment_id": 83125302, "body": "The pattern change I suggested <i>is</i> correct provided you are using the default regex flavor. Please share the whole relevant snippet to repro the issue."}, {"owner": {"reputation": 3, "user_id": 8899782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/821a3c00afaf32ce7afa0a437d221d4b?s=128&d=identicon&r=PG&f=1", "display_name": "mail", "link": "https://stackoverflow.com/users/8899782/mail"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1514977393, "post_id": 48075761, "comment_id": 83125728, "body": "@WiktorStribi\u017cew in site <a href=\"https://www.regextester.com/97722\" rel=\"nofollow noreferrer\">regextester.com/97722</a> we can set pattern and in flags section we can set flag to multiline,  this pattern in multiline flag is good and right, and my question is : how can i set multiline in c++, i search in internet but anybody tell this cann&#39;t do..."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1514977665, "post_id": 48075761, "comment_id": 83125879, "body": "It is easy to answer: there is no such an option in std::regex. Use the solution I provided in the top comment. Else, use Boost."}, {"owner": {"reputation": 3890, "user_id": 1201701, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/VCVHT.jpg?s=128&g=1", "display_name": "StPiere", "link": "https://stackoverflow.com/users/1201701/stpiere"}, "edited": false, "score": 0, "creation_date": 1514978027, "post_id": 48075761, "comment_id": 83126072, "body": "can you explain what you exactly want to achieve ? I dont see any multiline usage here ... you can always read line by line (for ex. using sstream) and regex against single line."}, {"owner": {"reputation": 3, "user_id": 8899782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/821a3c00afaf32ce7afa0a437d221d4b?s=128&d=identicon&r=PG&f=1", "display_name": "mail", "link": "https://stackoverflow.com/users/8899782/mail"}, "reply_to_user": {"reputation": 3890, "user_id": 1201701, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/VCVHT.jpg?s=128&g=1", "display_name": "StPiere", "link": "https://stackoverflow.com/users/1201701/stpiere"}, "edited": false, "score": 0, "creation_date": 1514978126, "post_id": 48075761, "comment_id": 83126128, "body": "@StPiere please study <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0014r1.html\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0014r1.html</a>"}], "owner": {"reputation": 3, "user_id": 8899782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/821a3c00afaf32ce7afa0a437d221d4b?s=128&d=identicon&r=PG&f=1", "display_name": "mail", "link": "https://stackoverflow.com/users/8899782/mail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514976135, "creation_date": 1514976135, "question_id": 48075761, "link": "https://stackoverflow.com/questions/48075761/set-multiline-in-regex-search", "title": "set multiline in regex_search", "body": "<p>I want search Pattern (\"*.txt\") and I must be use multiline for best result, and my pattern is</p>\n\n<pre><code>.*[ \\t]*\\.[ \\t]*txt[ \\t]*$\n</code></pre>\n\n<p>if add to end above pattern $ I haven't result and if I removed $ from end of pattern I have :</p>\n\n<pre><code>test.txt.log  // it not right result\nTest.txt\n</code></pre>\n\n<p>and so on.</p>\n\n<p>My code is : </p>\n\n<pre><code>std::regex_search(filename, searchPattern, std::regex_constants::match_continuous)\n</code></pre>\n\n<p>how can i fix this problem?</p>\n"}, {"tags": ["c++", "gcc"], "comments": [{"owner": {"reputation": 24802, "user_id": 232918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b5897762377de1c8ffb9a98673262e91?s=128&d=identicon&r=PG", "display_name": "doron", "link": "https://stackoverflow.com/users/232918/doron"}, "edited": false, "score": 0, "creation_date": 1514975750, "post_id": 48075584, "comment_id": 83124853, "body": "#include &lt;unistd.h&gt;"}], "answers": [{"tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": true, "score": 10, "last_activity_date": 1514976889, "last_edit_date": 1514976889, "creation_date": 1514975714, "answer_id": 48075654, "question_id": 48075584, "link": "https://stackoverflow.com/questions/48075584/unix-macro-becomes-undefined-when-compiling-with-std-c0x-flag/48075654#48075654", "title": "Unix macro becomes undefined when compiling with -std=c++0x flag", "body": "<p>From the GCC manual, <a href=\"https://gcc.gnu.org/onlinedocs/cpp/System-specific-Predefined-Macros.html\" rel=\"nofollow noreferrer\">3.7.3 System-specific Predefined Macros</a>:</p>\n\n<blockquote>\n  <p>The C standard requires that all system-specific macros be part of the <em>reserved namespace</em>. All names which begin with two underscores, or an underscore and a capital letter, are reserved for the compiler and library to use as they wish. However, historically system-specific macros have had names with no special prefix; for instance, it is common to find <code>unix</code> defined on Unix systems. For all such macros, GCC provides a parallel macro with two underscores added at the beginning and the end. If <code>unix</code> is defined, <code>__unix__</code> will be defined too. There will never be more than two underscores; the parallel of <code>_mips</code> is <code>__mips__</code>. </p>\n  \n  <p>When the <code>-ansi</code> option, or any <code>-std</code> option that requests strict conformance, is given to the compiler, all the system-specific predefined macros outside the reserved namespace are suppressed. The parallel macros, inside the reserved namespace, remain defined. </p>\n</blockquote>\n\n<p>Take note of the second paragraph, specifically.</p>\n\n<hr>\n\n<p><strong>tl;dr</strong></p>\n\n<p>The <code>unix</code> macro is not conforming to the standard, <code>__unix__</code> is. When you asked your compiler for <code>-std=c++0x</code>, it switched to \"strict conformance\" where only <code>__unix__</code> is available (and the by-default supported \"extension\" <code>unix</code> is dropped).</p>\n"}, {"comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1514976303, "post_id": 48075724, "comment_id": 83125140, "body": "I usually handle GNU compiler extensions the same way I handle post-1990 <i>Star Wars</i>: Existing, but better not mentioned. ;-) On a more serious note, <code>--std=gnu++0x</code> does the same for you as using <code>unix</code> instead of <code>__unix__</code>: Code not compliant with the standard."}], "tags": [], "owner": {"reputation": 28011, "user_id": 417292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/d3520ad50fa42c9319830bd9f0900c5d?s=128&d=identicon&r=PG", "display_name": "jcoder", "link": "https://stackoverflow.com/users/417292/jcoder"}, "is_accepted": false, "score": 3, "last_activity_date": 1514975985, "creation_date": 1514975985, "answer_id": 48075724, "question_id": 48075584, "link": "https://stackoverflow.com/questions/48075584/unix-macro-becomes-undefined-when-compiling-with-std-c0x-flag/48075724#48075724", "title": "Unix macro becomes undefined when compiling with -std=c++0x flag", "body": "<p>As others have said 'unix' is a gcc extension to the standard and by specifying <code>--std=c++0x</code> you have told it to use the standard. You can instead do <code>--std=gnu++0x</code> and it will retain the extensions (Or use <code>__unix__</code> as others suggested)</p>\n"}], "owner": {"reputation": 395, "user_id": 2092947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02ba61ff987df7f821d8790a6213e2d?s=128&d=identicon&r=PG", "display_name": "korish", "link": "https://stackoverflow.com/users/2092947/korish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 48075654, "answer_count": 2, "score": 0, "last_activity_date": 1514976889, "creation_date": 1514975429, "last_edit_date": 1514975571, "question_id": 48075584, "link": "https://stackoverflow.com/questions/48075584/unix-macro-becomes-undefined-when-compiling-with-std-c0x-flag", "title": "Unix macro becomes undefined when compiling with -std=c++0x flag", "body": "<p>When compiling the code below with <strong>-std=c++0x</strong> flag the <strong>unix</strong> macro becomes undefined and the error \"Unix is not defined!\" is shown. Is there any reason why this happens and how to fix it? Verified in gcc versions 4.7.2 and 4.8.4.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n#if !defined(unix)\n#error Unix is not defined!\n#endif\n\nint main()\n{\n    std::cout &lt;&lt; \"Hello World!\" &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "macos", "iokit", "kernel-extension", "xnu"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7256215"}, "edited": false, "score": 0, "creation_date": 1515055936, "post_id": 48085188, "comment_id": 83157585, "body": "yes, that&#39;s exactly what i was needed, after setting different value on <code>IOMatchCategory</code> for each of the drivers, they both loaded and their corresponding classes provided by <code>IOResources</code>. thanks !"}], "tags": [], "owner": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "is_accepted": true, "score": 0, "last_activity_date": 1515013887, "creation_date": 1515013887, "answer_id": 48085188, "question_id": 48075550, "link": "https://stackoverflow.com/questions/48075550/iokit-driver-is-loaded-but-not-started/48085188#48085188", "title": "IOKit driver is loaded but not started", "body": "<p>I can only take a guess because you haven't yet provided complete information - in particular, you haven't provided the complete IOKit personality dictionaries of your two drivers.</p>\n\n<p>Note that normally, only one service will successfully <em>match</em> an <code>IOService</code> to become its client. If you wish for multiple different types of client to match, they need to define distinct <em>match categories</em> through the <code>IOMatchCategory</code> key in the personality dictionary. Many drivers need to match <code>IOResources</code> specifically, so <a href=\"https://developer.apple.com/library/content/documentation/Darwin/Conceptual/KEXTConcept/Articles/infoplist_keys.html\" rel=\"nofollow noreferrer\">the rule for that case is to use the bundle identifier as match category</a>. I suspect this is what you've been missing?</p>\n\n<p>Finally, regarding your side note about having trouble with the default release kernels: the Kernel Debug Kits (KDKs) provide alternate <em>development</em> and <em>debug</em> kernels which are compiled with far less aggressive optimisation settings. You may find them helpful - check the KDK's readme documentation for details on how to enable them.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7256215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 48085188, "answer_count": 1, "score": 3, "last_activity_date": 1515053562, "creation_date": 1514975317, "last_edit_date": 1515053562, "question_id": 48075550, "link": "https://stackoverflow.com/questions/48075550/iokit-driver-is-loaded-but-not-started", "title": "IOKit driver is loaded but not started", "body": "<p>I've got IOKit base driver that is non-hardware triggered and derives from IOResources. it also provides to user-space client class using <code>IOServiceOpen</code> but I think it's irrelevant for my problem... The main driver has IOKit dependency as mentioned in the derived driver Info.plist file :</p>\n\n<pre><code>&lt;key&gt;OSBundleLibraries&lt;/key&gt;\n&lt;dict&gt;\n    ...\n    ..\n    .\n    &lt;key&gt;com.derived.driver&lt;/key&gt;\n    &lt;string&gt;1.0.0&lt;/string&gt;\n&lt;/dict&gt; \n</code></pre>\n\n<p>the other driver (identified by <code>com.derived.driver</code>) is implemented as generic kernel extension and stored in <code>/Library/Extensions</code>.</p>\n\n<p>When I load the base driver, the derived is loading automatically. since the derived driver resides in <code>/Library/Extensions</code> it can also be loaded before triggering the derived driver by <code>kextcache</code>.</p>\n\n<p>However, It stop working when I convert the derived driver from generic to IOKit format so that now both drivers <code>IOProviderClass</code> is <code>IOResources</code>.</p>\n\n<p>It seems like the derived driver simply refuse the start it's IOService based class, with no sign of errors in the output logs (I've used debugger and saw that it actually reaches <code>IOService::probeCandidates</code> but not <code>IOService::startCandidate</code>. since the kernel compiled with optimization, I couldn't put my finger for the exact flow).</p>\n\n<p>When I look at the currently loaded drivers by <code>kextstat</code> it seems that both drivers are loaded, but according to <code>ioreg</code> only the base driver have active instances (I was expecting that both drivers will share the same provider which is IOResources). </p>\n\n<p>Moreover, after a while, it seems that the higher driver simple removed from the loaded kexts (probably due to idleness) .. </p>\n\n<p>Does my design seem legal or do I also have to change the <code>IOProviderClass</code> field in base driver from <code>IOResources</code> to the derived driver IOService based class.</p>\n\n<pre><code>&lt;key&gt;IOKitPersonalities&lt;/key&gt;\n&lt;dict&gt;\n        &lt;key&gt;myDriver&lt;/key&gt;\n        &lt;dict&gt;\n                &lt;key&gt;CFBundleIdentifier&lt;/key&gt;\n                &lt;string&gt;com.base.driver&lt;/string&gt;\n                &lt;key&gt;IOClass&lt;/key&gt;\n                &lt;string&gt;com_base_driver&lt;/string&gt;\n                &lt;key&gt;IOProviderClass&lt;/key&gt;\n                &lt;string&gt;com_derived_driver&lt;/string&gt;\n</code></pre>\n\n<p>EDIT :\nI actually did it, and it worked (all instances have been initialized according to ioreg).</p>\n\n<pre><code>  +-o com_derived_driver  &lt;class com_derived_driver, id 0x10000091f, registered, matched, active, busy 0 (804415 ms), retain 6&gt;\n    +-o com_base_driver  &lt;class com_base_mng, id 0x100000920, registered, matched, active, busy 0 (0 ms), retain 9&gt;\n</code></pre>\n\n<p>but I honestly don't know why, any explanation will be highly appreciated.</p>\n\n<p>thanks ! </p>\n"}, {"tags": ["c++", "qt", "qml", "qqmlapplicationengine"], "comments": [{"owner": {"reputation": 1827, "user_id": 187998, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/003aa224fb6ca93a53bd2973a98e242e?s=128&d=identicon&r=PG", "display_name": "Clearer", "link": "https://stackoverflow.com/users/187998/clearer"}, "edited": false, "score": 0, "creation_date": 1514974712, "post_id": 48075349, "comment_id": 83124286, "body": "Could you just have two widgets and then set their visibility? That&#39;s the approach I usually take."}, {"owner": {"reputation": 1988, "user_id": 4717805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-xAnHpORfxvE/AAAAAAAAAAI/AAAAAAAAACE/QzOPrCINbew/photo.jpg?sz=128", "display_name": "Zouch", "link": "https://stackoverflow.com/users/4717805/zouch"}, "reply_to_user": {"reputation": 1827, "user_id": 187998, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/003aa224fb6ca93a53bd2973a98e242e?s=128&d=identicon&r=PG", "display_name": "Clearer", "link": "https://stackoverflow.com/users/187998/clearer"}, "edited": false, "score": 0, "creation_date": 1514974904, "post_id": 48075349, "comment_id": 83124403, "body": "I&#39;m not sure to understand what you mean, could you clarify please ?"}, {"owner": {"reputation": 1827, "user_id": 187998, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/003aa224fb6ca93a53bd2973a98e242e?s=128&d=identicon&r=PG", "display_name": "Clearer", "link": "https://stackoverflow.com/users/187998/clearer"}, "edited": false, "score": 0, "creation_date": 1514975500, "post_id": 48075349, "comment_id": 83124728, "body": "You say you want to replace  the underlying qml window -- this implies removing it from the parent and adding a new window to the parent. I&#39;m suggesting that you simply keep both windows in the parent at the same time, and simply showing the one you want and hiding the one you don&#39;t need."}, {"owner": {"reputation": 1988, "user_id": 4717805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-xAnHpORfxvE/AAAAAAAAAAI/AAAAAAAAACE/QzOPrCINbew/photo.jpg?sz=128", "display_name": "Zouch", "link": "https://stackoverflow.com/users/4717805/zouch"}, "reply_to_user": {"reputation": 1827, "user_id": 187998, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/003aa224fb6ca93a53bd2973a98e242e?s=128&d=identicon&r=PG", "display_name": "Clearer", "link": "https://stackoverflow.com/users/187998/clearer"}, "edited": false, "score": 0, "creation_date": 1514980437, "post_id": 48075349, "comment_id": 83127368, "body": "This cannot work. The problem is that what is returned by <code>QWidget::createWindowContainer</code> is in fact not a QWindow but a QWindowContainer, which is a private class"}], "owner": {"reputation": 1988, "user_id": 4717805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-xAnHpORfxvE/AAAAAAAAAAI/AAAAAAAAACE/QzOPrCINbew/photo.jpg?sz=128", "display_name": "Zouch", "link": "https://stackoverflow.com/users/4717805/zouch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 860, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514998364, "creation_date": 1514974557, "question_id": 48075349, "link": "https://stackoverflow.com/questions/48075349/replace-qt-window-embed-in-a-widget-via-qwidgetcreatewindowcontainer", "title": "Replace qt window embed in a widget via QWidget::createWindowContainer", "body": "<p>I have a QML window embed inside a <code>QWidget</code> via <code>QWidget::createWindowContainer()</code>. </p>\n\n<p>To provide some reloading capabilities without hiding the window, I would like to be able to replace the underlying (embed) qml window, without destroying and recreating the parent widget.</p>\n\n<p>What I tried so far is </p>\n\n<pre><code>QQmlApplicationEngine engine;\n\n// First time\n// Load the qml file\nengine.load(\"main.qml\");\n// Get the window\nQWindow* window = static_cast&lt;QWindow*&gt;(engine.rootObjects().last());\n// Create the window container\nQWidget* container = QWidget::createWindowContainer(qmlWindow);\n// -&gt; This works perfectly well\n\n// Other times\n// Get the old window\nQWindow* oldWindow = static_cast&lt;QWindow*&gt;(engine.rootObjects().last());\n// And its container\nQWindow* container = oldWindow-&gt;parent();\n// Close the old window\nlOldWindow-&gt;close();\n\n// Load the qml\nengine.load(\"main.qml\");\n// Get the new qml window\nQWindow* window = static_cast&lt;QWindow*&gt;(engine.rootObjects().last());\n// Reparent it to the old window's container\nlWindow-&gt;setParent(lContainer);\n// -&gt; The newly created window does not show up\n</code></pre>\n\n<p>I used to completely delete the container window and recreate it as well (with <code>createWindowContainer</code>) and this was working perfectly well, but I would like to avoid deleting the container widget over and over.\nHow can I achieve this ?</p>\n\n<p>(Please note there is no pointer checking nor error handling for code simplicity, there is no need to comment about that :) )</p>\n"}, {"tags": ["c++", "language-lawyer", "c++17"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1514974284, "post_id": 48075112, "comment_id": 83124044, "body": "My uninformed guess. You could place a char array within a larger char array, and another object within the smaller char array. The smaller array wiill then provide storage for the other object."}], "answers": [{"tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 10, "last_activity_date": 1514975002, "last_edit_date": 1514975002, "creation_date": 1514974076, "answer_id": 48075216, "question_id": 48075112, "link": "https://stackoverflow.com/questions/48075112/what-does-there-is-no-smaller-array-object-that-satisfies-these-constraints-me/48075216#48075216", "title": "What does &quot;there is no smaller array object that satisfies these constraints&quot; mean?", "body": "<p>The meaning if 3.3 is to differentiate <code>a[32]</code> from <code>b[16]</code>. The former doesn't provide storage for <code>*p</code> because the latter does. It identifies the smallest unique array object that provides the region of storage where the object resides.</p>\n\n<p>Without 3.3 the definition would be transitive. <code>a[32]</code> would provide storage for <code>*p</code> because it ultimately provides storage for <code>b[16]</code>.</p>\n\n<hr>\n\n<p>Regarding <code>*p</code> using 4 bytes. It's important to note that the region <code>[b-&gt;b + 4, b-&gt;b +8)</code>, while being the storage where <code>*p</code> resides, is not the array object providing the storage (that region isn't an array object at all). That smallest array object would be <code>b-&gt;b</code>.</p>\n"}], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 2, "accepted_answer_id": 48075216, "answer_count": 1, "score": 12, "last_activity_date": 1514975002, "creation_date": 1514973742, "last_edit_date": 1514973905, "question_id": 48075112, "link": "https://stackoverflow.com/questions/48075112/what-does-there-is-no-smaller-array-object-that-satisfies-these-constraints-me", "title": "What does &quot;there is no smaller array object that satisfies these constraints&quot; mean?", "body": "<p>The draft n4659 for C++17 describes the general principes of the language in chapter 4. In chapter 4.5, The C++ object model [intro.object], I cannot understand the meaning of one sentence (emphasize mine)</p>\n\n<blockquote>\n  <p>3 If a complete object is created (8.3.4) in storage associated with another object e of type \u201carray of N\n  unsigned char\u201d or of type \u201carray of N std::byte\u201d (21.2.1), that array provides storage for the created\n  object if:<br/>\n  (3.1) \u2014 the lifetime of e has begun and not ended, and<br/>\n  (3.2) \u2014 the storage for the new object fits entirely within e, and<br/>\n  (3.3) \u2014 <strong>there is no smaller array object that satisfies these constraints.</strong><br/></p>\n</blockquote>\n\n<p>while examples show that an array can provide storage for elements much shorter than the array:</p>\n\n<pre><code>struct A { unsigned char a[32]; };\nstruct B { unsigned char b[16]; };\nA a;\nB *b = new (a.a + 8) B; // a.a provides storage for *b\nint *p = new (b-&gt;b + 4) int; // b-&gt;b provides storage for *p\n</code></pre>\n\n<p>here <code>*p</code> uses only 4 bytes (assuming <code>sizeof(int)</code> is 4) in a 16 bytes array. So, what is the meaning of 3.3?</p>\n"}, {"tags": ["c++", "c++17"], "comments": [{"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 3, "creation_date": 1514973543, "post_id": 48075020, "comment_id": 83123639, "body": "Ain&#39;t that a bit too many C++ tags?"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 3, "creation_date": 1514973688, "post_id": 48075020, "comment_id": 83123719, "body": "Maybe a <code>std::shared_ptr</code> is what you are looking for, I guess."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514974902, "post_id": 48075020, "comment_id": 83124401, "body": "Doesn&#39;t look too convenient to me. I&#39;d explore a unique_ptr with a custom deleter. A unique_ptr with a no-op deleter is similar to a non-owning pointer."}, {"owner": {"reputation": 993, "user_id": 1147349, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7110e901c18d83cb74fe924dc39293a6?s=128&d=identicon&r=PG", "display_name": "innochenti", "link": "https://stackoverflow.com/users/1147349/innochenti"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514975375, "post_id": 48075020, "comment_id": 83124656, "body": "@n.m. good point, but I think in this case user who looks at the class will  think that Node owns the resource."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514975693, "post_id": 48075020, "comment_id": 83124822, "body": "You can typedef your custom unique_ptr to something like optionally_owning_ptr."}, {"owner": {"reputation": 993, "user_id": 1147349, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7110e901c18d83cb74fe924dc39293a6?s=128&d=identicon&r=PG", "display_name": "innochenti", "link": "https://stackoverflow.com/users/1147349/innochenti"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514975935, "post_id": 48075020, "comment_id": 83124953, "body": "@n.m. thx. I&#39;ll consider this one."}], "answers": [{"tags": [], "owner": {"reputation": 2282, "user_id": 6646408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6BakX.png?s=128&g=1", "display_name": "besc", "link": "https://stackoverflow.com/users/6646408/besc"}, "is_accepted": false, "score": 2, "last_activity_date": 1514978779, "creation_date": 1514978779, "answer_id": 48076436, "question_id": 48075020, "link": "https://stackoverflow.com/questions/48075020/using-variant-reference-wrapper-unique-ptr-to-express-idea-of-nonowning-re/48076436#48076436", "title": "Using variant + reference_wrapper + unique_ptr to express idea of (non)owning resource", "body": "<p>I don\u2019t like the <code>variant</code> In your particular example, i.e. in a simple struct with direct access to the members. Although it gives you the flexibility regarding ownership, that flexibility bleeds into each usage of <code>Node::sceneObject</code>.</p>\n\n<p>The variant is an implementation detail of your special ownership semantics. It should be decoupled from the usage of <code>sceneObject</code> because ownership is not the caller\u2019s concern. However with the <code>variant</code> solution it\u2019s tightly coupled because the caller has to do different things for owning and non-owning <code>sceneObject</code>s.</p>\n\n<p>I like the idea of @n.m. of using a <code>unique_ptr</code> with a custom deleter. It gives you both the ownership flexibility and a consistent way of accessing <code>sceneObject</code>. Add a <code>make_owning_sceneObject()</code> and a <code>make_non_owning_sceneObject()</code> function and you have a nice and simple API.\nAlso that solution seems to have the least potential for performance penalties. Access is always a simple indirection through a pointer, no <code>variant</code> machinery at all. Of course, the usual caveats about unmeasured performance speculations apply.</p>\n"}, {"comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1514998936, "post_id": 48081821, "comment_id": 83138029, "body": "Yeah, <code>std::exchange</code> is neat :)"}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 3, "last_activity_date": 1514998727, "creation_date": 1514998727, "answer_id": 48081821, "question_id": 48075020, "link": "https://stackoverflow.com/questions/48075020/using-variant-reference-wrapper-unique-ptr-to-express-idea-of-nonowning-re/48081821#48081821", "title": "Using variant + reference_wrapper + unique_ptr to express idea of (non)owning resource", "body": "<p>Don't use a variant here. You don't have different types, you have one type - but just have a property of that type. So you could just write a maybe-owning type, that's basically a <code>T*</code> and a <code>bool</code>:</p>\n\n<pre><code>template &lt;typename T&gt;\nclass maybe_owning_ptr {\n    T* ptr_;\n    bool owns_;\n\npublic:\n    maybe_owning_ptr() : ptr_(nullptr), owns_(false) { }\n    maybe_owning_ptr(T* p, bool owns) : ptr_(p), owns_(owns) { }\n    ~maybe_owning_ptr() {\n        if (owns_) delete ptr_;\n    }\n\n    maybe_owning_ptr(maybe_owning_ptr&amp;&amp; rhs) noexcept\n        : ptr_(std::exchange(rhs.ptr_, nullptr))\n        , owns_(std::exchange(rhs.owns_, false))\n    { }\n\n    maybe_owning_ptr&amp; operator=(maybe_owning_ptr&amp;&amp; rhs) noexcept\n    {\n        T* p = std::exchange(rhs.ptr_, nullptr);\n        bool o = std::exchange(rhs.owns_, false);\n\n        if (owns_) delete ptr_;\n        ptr_ = p;\n        owns_ = o;\n        return *this;\n    }\n\n    // accessors here... get(), operator*, operator-&gt;(), etc.\n};\n</code></pre>\n\n<p>Note that we can't have a copy constructor - because we wouldn't know what to do in the scenario where we do have ownership. </p>\n\n<p>Always wanted to use <a href=\"http://en.cppreference.com/w/cpp/utility/exchange\" rel=\"nofollow noreferrer\"><code>std::exchange()</code></a> for something...</p>\n"}], "owner": {"reputation": 993, "user_id": 1147349, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7110e901c18d83cb74fe924dc39293a6?s=128&d=identicon&r=PG", "display_name": "innochenti", "link": "https://stackoverflow.com/users/1147349/innochenti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 880, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1514998727, "creation_date": 1514973430, "last_edit_date": 1514973698, "question_id": 48075020, "link": "https://stackoverflow.com/questions/48075020/using-variant-reference-wrapper-unique-ptr-to-express-idea-of-nonowning-re", "title": "Using variant + reference_wrapper + unique_ptr to express idea of (non)owning resource", "body": "<p>if I need to express such an idea:\nthere is a scene node (with a transformation) that can point to (<em>do not own</em>) geometry (mesh for example),\nbut sometimes it is very convenient for the node <em>to own</em> the geometry.\nIs it OK to express this idea in this way? if not - could you give some thoughts on how to express this idea?</p>\n\n<pre><code>struct Node\n{\n    variant&lt;reference_wrapper&lt;SceneObject&gt;, unique_ptr&lt;SceneObject&gt;&gt; sceneObject{nullptr};\n};\n\nNode node1;\nnode1.sceneObject = make_unique&lt;Mesh&gt;(); // node is responsible for the life of the mesh\n\nNode node2;\nnode2.sceneObject = sceneObjectDatabase.getResource(\"myMesh\"); //the node does not own the mesh, but simply references it\n\nNode node3;\nnode3.sceneObject = nullptr; // doesn't own any geometry\n</code></pre>\n"}, {"tags": ["c++", "arduino", "interrupt-handling", "esp32"], "comments": [{"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 4, "creation_date": 1515072399, "post_id": 48074970, "comment_id": 83167281, "body": "This is a Q&amp;A site, not a blog or forum. If you have an <b>answer</b> to your <b>question</b>, write it as such and accept it (and then revert that last edit). | <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> | <a href=\"https://stackoverflow.com/questions/how-to-answer\">How to Answer</a>"}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 9018487, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LQrZmtYn09k/AAAAAAAAAAI/AAAAAAAADfY/C3A7MMlUMe8/photo.jpg?sz=128", "display_name": "Piotr P\u0142aczek", "link": "https://stackoverflow.com/users/9018487/piotr-p%c5%82aczek"}, "edited": false, "score": 0, "creation_date": 1515050348, "post_id": 48079672, "comment_id": 83155157, "body": "Thanks for reply. I was editting my ask. I have some idea, but this causes new problem. <b>@EDIT 2018/01/04 08:10</b> I add some changes to files and I have problem at GPIO_CONFIG.cpp. <code>if(&amp;isrptr[i] == &amp;gpio[i].isr()){ &#47;&#47;here is my actualy problem. how can i compare this?</code>"}], "tags": [], "owner": {"reputation": 196, "user_id": 9107312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8351988ee8446b9f066ddecc36872496?s=128&d=identicon&r=PG&f=1", "display_name": "Boggyman", "link": "https://stackoverflow.com/users/9107312/boggyman"}, "is_accepted": false, "score": 0, "last_activity_date": 1514990794, "creation_date": 1514990794, "answer_id": 48079672, "question_id": 48074970, "link": "https://stackoverflow.com/questions/48074970/arduino-how-to-count-external-interrupts-inside-array-of-objects/48079672#48079672", "title": "Arduino how to count external interrupts inside array of objects?", "body": "<p>I've looked over your code several times and can't find your ISR(s).  I know how to handle this sort of problem in simple C code:  You just define an array with one element for each interrupt pin, and increment that element from its respective ISR.  I don't know how to relate that to what you've shown.</p>\n\n<p>The part that often causes trouble is that you usually need to define variables shared between the main code and ISR as volatile.  Failing to do this can cause problems that are really hard to find, due to the compiler optimizing away things that it decides aren't changed (in the ISR or the main code).  </p>\n\n<p>Best regards,</p>\n"}], "owner": {"reputation": 131, "user_id": 9018487, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LQrZmtYn09k/AAAAAAAAAAI/AAAAAAAADfY/C3A7MMlUMe8/photo.jpg?sz=128", "display_name": "Piotr P\u0142aczek", "link": "https://stackoverflow.com/users/9018487/piotr-p%c5%82aczek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 394, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1525092748, "creation_date": 1514973245, "last_edit_date": 1525092748, "question_id": 48074970, "link": "https://stackoverflow.com/questions/48074970/arduino-how-to-count-external-interrupts-inside-array-of-objects", "title": "Arduino how to count external interrupts inside array of objects?", "body": "<h1>PROBLEM</h1>\n\n<p>I'm starting to play with Arduino IoT (ESP32). I read the GPIO configuration from a file on the SD card. I have a problem with external interrupts. I need to count the number of interrupts on a given GPIO.</p>\n\n<p>I wrote a class that stores the GPIO configuration, and put the objects of this class in a global array. How can I count interrupts on a given pin, so that the result is available by using the appropriate object method?</p>\n\n<p>I tried different solutions, but the problem lies in the ISR method, which must be static. This method has no access to object fields, so I do not know where and how to increment the counter of interrupts.</p>\n\n<p>I divided the code into several files. I attach only the necessary to solve this problem.</p>\n\n<p>This holds up my project. Please help.</p>\n\n<p>Main file:</p>\n\n<pre><code>#define GPIO_CONFIG_FILE \"cfg/gpio.txt\"\n#define WIFI_AP_CONFIG_FILE \"cfg/ap.txt\"\n#define WIFI_STA_CONFIG_FILE \"cfg/sta.txt\"\n#define AVAILABLE_GPIO_CNT 7\n#define LED_BUILTIN_OLIMEX 33\n#define BTN_BUILTIN_OLIMEX 34\n\n#include \"FS.h\"\n#include \"SD_MMC.h\"\n#include \"GPIO_CONFIG.h\"\n\nGPIO_CONFIG gpio[AVAILABLE_GPIO_CNT];\nuint32_t gpio_int_cnt[AVAILABLE_GPIO_CNT] = {0};\n\nvoid setup() {\n  if (checkSdCard()) {\n    setUpPinsFromFile(GPIO_CONFIG_FILE);\n  }\n}\n\nvoid loop() {\n}\n</code></pre>\n\n<p>GPIO_CONFIG.h</p>\n\n<pre><code>#ifndef GPIO_CONFIG_h\n#define GPIO_CONFIG_h\n\n#include \"Arduino.h\"\n#define ID_LENGTH 7\n\nclass GPIO_CONFIG {\n  public:\n    GPIO_CONFIG();\n    void setUp(const char * key);\n    void printConfig();\n    uint8_t number();\n    uint8_t mode();\n    uint16_t multiplier();\n    bool inversion();\n    char * id();\n    static void isr();\n    static uint32_t int_cnt();\n\n  private:\n    uint8_t gp_number;\n    uint8_t gp_mode;\n    uint16_t gp_multiplier;\n    uint32_t gp_init_value;\n    bool gp_inversion;\n    char gp_id[ID_LENGTH];\n    //    const uint8_t gp_mode_array[4] = {INPUT, OUTPUT, INPUT_PULLUP};\n};\n#endif\n</code></pre>\n\n<p>GPIO_CONFIG.cpp</p>\n\n<pre><code>#include \"GPIO_CONFIG.h\"\nGPIO_CONFIG::GPIO_CONFIG() {\n  gp_number = 0;\n  gp_multiplier = 1;\n  gp_inversion = false;\n  gp_init_value = 0;\n}\n\nvoid GPIO_CONFIG::setUp(const char * key) {\n  //nr|id|name|mode|multi|inv|init\n  char cfg[sizeof(key)];\n  for (uint8_t b = 0; b &lt; sizeof(key); ++b) {\n    cfg[b] = key[b];\n  }\n\n  //PIN_NUMBER\n  char * tok = strtok(cfg, \"|\");\n  gp_number = atoi(tok);\n\n  //ID\n  tok = strtok(NULL, \"|\");\n  for (int b = 0; b &lt; sizeof(tok); b++) {\n    if (b &lt; ID_LENGTH) {\n      gp_id[b] = tok[b];\n    } else {\n      break;\n    }\n  }\n  gp_id[ID_LENGTH - 1] = '\\0';\n\n  //NAME\n  strtok(NULL, \"|\");\n\n  //MODE\n  tok = strtok(NULL, \"|\");\n  gp_mode = atoi(tok);\n\n  //MULTIPLIER\n  tok = strtok(NULL, \"|\");\n  gp_multiplier = atoi(tok);\n\n  //INVERSION\n  tok = strtok(NULL, \"|\");\n  gp_inversion = (atoi(tok) &gt; 0);\n\n  //INITIAL VALUE\n  tok = strtok(NULL, \"|\");\n  gp_init_value = atoi(tok);\n\n  //0-in; 1-out; 2-int\n  if (gp_mode != 1) {\n    if (gp_inversion) { //sterowanie podstawowe przez vcc\n      pinMode(gp_number, INPUT_PULLUP);\n    } else {\n      pinMode(gp_number, INPUT);\n    }\n    if (gp_mode &gt; 2) {\n      attachInterrupt(digitalPinToInterrupt(gp_number), isr, FALLING);\n    }\n  } else {\n    pinMode(gp_number, OUTPUT);\n  }\n}\n\nvoid GPIO_CONFIG::printConfig() {\n#ifdef DEBUG\n  Serial.print(\"GPIO_CONFIG:\");\n  Serial.print(\" -no:\");\n  Serial.print(gp_number);\n  Serial.print(\" -id:\");\n  Serial.print(gp_id);\n  Serial.print(\" -mode:\");\n  Serial.print(gp_mode);\n  Serial.print(\" -multi:\");\n  Serial.print(gp_multiplier);\n  Serial.print(\" -inv:\");\n  Serial.print(gp_inversion);\n  Serial.println(\"\");\n#endif\n}\n\nuint8_t GPIO_CONFIG::number() {\n  return gp_number;\n}\n\nuint8_t GPIO_CONFIG::mode() {\n  return gp_mode;\n}\n\nuint16_t GPIO_CONFIG::multiplier() {\n  return gp_multiplier;\n}\n\nbool GPIO_CONFIG::inversion() {\n  return gp_inversion;\n}\n\nchar * GPIO_CONFIG::id() {\n  return gp_id;\n}\n\nvoid GPIO_CONFIG::isr() {\n//  gpio_int_cnt[0]++;\n}\n\nuint32_t GPIO_CONFIG::int_cnt() {\n//  return gpio_int_cnt[0];\n}\n</code></pre>\n\n<p><strong>@EDIT 2018/01/04 08:10</strong>\nI add some changes to files:</p>\n\n<p>Main .ino file</p>\n\n<pre><code>isr_ptr isrptr[AVAILABLE_GPIO_CNT];\n</code></pre>\n\n<p>GPIO_CONFIG.h</p>\n\n<pre><code>#define AVAILABLE_GPIO_CNT 7\n\nclass GPIO_CONFIG;\ntypedef /*static*/ void (*isr_ptr)();\nextern isr_ptr isrptr[AVAILABLE_GPIO_CNT];\nextern GPIO_CONFIG gpio[AVAILABLE_GPIO_CNT];\n\n(...)\n\npublic:\n  void setIndex(const uint8_t * i);\n  uint8_t index();\n\n(...)\n\nprivate:\n  uint8_t gp_index;\n  uint32_t gp_cnt_value;\n</code></pre>\n\n<p>GPIO_CONFIG.cpp</p>\n\n<pre><code>void GPIO_CONFIG::setIndex(const uint8_t * i){\n  gp_index = *i;\n  isrptr[gp_index] = &amp;isr;\n}\n\nuint8_t GPIO_CONFIG::index(){\n  return gp_index;\n}\n\nvoid GPIO_CONFIG::setUp(const char * key) {\n  (...)\n  attachInterrupt(digitalPinToInterrupt(gp_number), isrptr[gp_index], FALLING);\n  (...)\n}\n\nvoid GPIO_CONFIG::isr() {\n  for(uint8_t i=0; i&lt;AVAILABLE_GPIO_CNT; ++i){\n    if(&amp;isrptr[i] == &amp;gpio[i].isr()){ //here is my actualy problem. how can i compare this?\n      gpio[i].increment_cnt_value();\n      break;\n    }\n  }\n}\n\nuint32_t GPIO_CONFIG::int_cnt() {\n  return gp_cnt_value;\n}\n</code></pre>\n\n<hr>\n\n<h2>SOLUTION</h2>\n\n<p>Here I place short fragments which have to be modified:</p>\n\n<p>GPIO_CONFIG.cpp</p>\n\n<p>From <code>isrptr[gp_index] = &amp;isr;</code> to <code>isrptr[gp_index] = isr;</code></p>\n\n<p>From <code>if(&amp;isrptr[i] == &amp;gpio[i].isr){</code> to <code>if(isrptr[i] == gpio[i].isr){</code></p>\n"}, {"tags": ["c++", "qt", "qt5"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514973913, "post_id": 48074939, "comment_id": 83123836, "body": "Run your program under strace and see if there&#39;s any syscall it hangs within for unreasonable amount of time."}, {"owner": {"reputation": 705, "user_id": 4849439, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/049ab7c04b283ef0c73cba0046427335?s=128&d=identicon&r=PG&f=1", "display_name": "JLev", "link": "https://stackoverflow.com/users/4849439/jlev"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514983379, "post_id": 48074939, "comment_id": 83128973, "body": "Doesn&#39;t seem like it, just normal read/write, when I press a button it hangs but still on the read/write functions (I guess that they are screen related, they run when I move the cursor)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514987110, "post_id": 48074939, "comment_id": 83131095, "body": "So it&#39;s an unusually large amount of calls to read and write, right? Are all or most of them to the same file descriptor?"}, {"owner": {"reputation": 705, "user_id": 4849439, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/049ab7c04b283ef0c73cba0046427335?s=128&d=identicon&r=PG&f=1", "display_name": "JLev", "link": "https://stackoverflow.com/users/4849439/jlev"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514989190, "post_id": 48074939, "comment_id": 83132228, "body": "Take a look at my edit"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514989824, "post_id": 48074939, "comment_id": 83132583, "body": "This should&#39;t take a whole of one second, and should only be done once per run anyway! The sequence looks perfectly normal (look in user&#39;s configs, if not found, look in the system place). If this sequence is done many times for the same theme file, there&#39;s a bug in Qt. If not, the reason is elsewhere."}, {"owner": {"reputation": 705, "user_id": 4849439, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/049ab7c04b283ef0c73cba0046427335?s=128&d=identicon&r=PG&f=1", "display_name": "JLev", "link": "https://stackoverflow.com/users/4849439/jlev"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514993527, "post_id": 48074939, "comment_id": 83134879, "body": "It runs only once. But still, each press is slow..."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514993703, "post_id": 48074939, "comment_id": 83134994, "body": "So what do you see in the strace window between the moment you press a button and the moment your application reacts?"}, {"owner": {"reputation": 705, "user_id": 4849439, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/049ab7c04b283ef0c73cba0046427335?s=128&d=identicon&r=PG&f=1", "display_name": "JLev", "link": "https://stackoverflow.com/users/4849439/jlev"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514994304, "post_id": 48074939, "comment_id": 83135356, "body": "Just read and write to the same file descriptor (I can&#39;t find where the fid was opened, I assume it&#39;s the screen)"}, {"owner": {"reputation": 3209, "user_id": 5794048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Egkox.jpg?s=128&g=1", "display_name": "Murphy", "link": "https://stackoverflow.com/users/5794048/murphy"}, "edited": false, "score": 0, "creation_date": 1514994367, "post_id": 48074939, "comment_id": 83135400, "body": "A profiler is the right tool to dig into this issue."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 3209, "user_id": 5794048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Egkox.jpg?s=128&g=1", "display_name": "Murphy", "link": "https://stackoverflow.com/users/5794048/murphy"}, "edited": false, "score": 0, "creation_date": 1514995731, "post_id": 48074939, "comment_id": 83136164, "body": "@Murphy The usual profilers (callgrind, gprof) are generally not very suitable for this as they only show CPU usage, not wait time."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514995988, "post_id": 48074939, "comment_id": 83136330, "body": "You can look at /proc/&lt;pid&gt;/fd to see which file or socket it opens. I too think it&#39;s the display. Perhaps your app is running in synchronous mode for some reason."}, {"owner": {"reputation": 3209, "user_id": 5794048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Egkox.jpg?s=128&g=1", "display_name": "Murphy", "link": "https://stackoverflow.com/users/5794048/murphy"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514997212, "post_id": 48074939, "comment_id": 83137043, "body": "@n.m. This assumes that the additional time is spent in the kernel, which is yet to be proven. And there are tools like <a href=\"http://oprofile.sourceforge.net/about/\" rel=\"nofollow noreferrer\">OProfile</a> which should cover this case."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 3209, "user_id": 5794048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Egkox.jpg?s=128&g=1", "display_name": "Murphy", "link": "https://stackoverflow.com/users/5794048/murphy"}, "edited": false, "score": 0, "creation_date": 1515002767, "post_id": 48074939, "comment_id": 83140053, "body": "@Murphy The additional time is spent <i>waiting</i>. The kernel is running other processes or idling, because CPU is not working harder. Which is why I don&#39;t think OProfile is going to help either (I don&#39;t remember it measuring wait time). But one can always try..."}, {"owner": {"reputation": 705, "user_id": 4849439, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/049ab7c04b283ef0c73cba0046427335?s=128&d=identicon&r=PG&f=1", "display_name": "JLev", "link": "https://stackoverflow.com/users/4849439/jlev"}, "edited": false, "score": 0, "creation_date": 1515055446, "post_id": 48074939, "comment_id": 83157348, "body": "Checked again, only one of my widgets is slow. It&#39;s nothing special, a widget that inherits from QWidget. Not overriding of the paint/resize/any event."}], "answers": [{"tags": [], "owner": {"reputation": 705, "user_id": 4849439, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/049ab7c04b283ef0c73cba0046427335?s=128&d=identicon&r=PG&f=1", "display_name": "JLev", "link": "https://stackoverflow.com/users/4849439/jlev"}, "is_accepted": true, "score": 1, "last_activity_date": 1515341420, "creation_date": 1515341420, "answer_id": 48139014, "question_id": 48074939, "link": "https://stackoverflow.com/questions/48074939/upgrade-from-qt-5-7-to-5-10-results-in-slower-ui/48139014#48139014", "title": "Upgrade from Qt 5.7 to 5.10 results in slower UI", "body": "<p>Well, I've found a solution (more of a workaround).\nAfter looking in to it, figured out that setting a background image was causing the problems.\nThis is the code I had for it - </p>\n\n<pre><code>QPalette palette;\npalette.setBrush(this-&gt;backgroundRole(), QBrush(QImage(\"/path/to/img.jpg\").scaled(1870, 1020)));\nthis-&gt;setPalette(palette);\n</code></pre>\n\n<p>Now I change my QWidget to a QFrame, and used </p>\n\n<pre><code>setStyleSheet(\"QFrame {background-image: url(/path/to/img.bmp);}\");\n</code></pre>\n\n<p>And it works.</p>\n"}], "owner": {"reputation": 705, "user_id": 4849439, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/049ab7c04b283ef0c73cba0046427335?s=128&d=identicon&r=PG&f=1", "display_name": "JLev", "link": "https://stackoverflow.com/users/4849439/jlev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 48139014, "answer_count": 1, "score": 1, "last_activity_date": 1515341420, "creation_date": 1514973132, "last_edit_date": 1514992900, "question_id": 48074939, "link": "https://stackoverflow.com/questions/48074939/upgrade-from-qt-5-7-to-5-10-results-in-slower-ui", "title": "Upgrade from Qt 5.7 to 5.10 results in slower UI", "body": "<p>I've installed Qt 5.10 alongside 5.7, and when compiling the same project I get a very weird side-effect, my user interface is extremely slow (sometimes takes few seconds for a button push to process).\nI've looked at the cpu measurements, it doesn't look like it's working harder. Has anybody encountered such issue? Any directions to solving it / understanding the cause?\nUsing ubuntu 16.04, with GCC 7.2 for both setups.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Following an advice in the comments (thanks @n.m), ran with strace, looks like there is something different with the mouse handling, I think. While the 5.7 version finds this file \n<code>open(\"/usr/share/icons/default/index.theme\", O_RDONLY) = 11</code></p>\n\n<p>The 5.10 version is looking for it in another location, and fails. Later, it finds another file for it.\n<code>open(\"/home/innereye/.icons/DMZ-White/index.theme\", O_RDONLY) = -1 ENOENT (No such file or directory)</code></p>\n\n<p><code>open(\"/usr/share/icons/DMZ-White/cursors/xterm\", O_RDONLY) = 19</code></p>\n"}, {"tags": ["c++", "googletest", "clion"], "answers": [{"tags": [], "owner": {"reputation": 1043, "user_id": 7742987, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cda94a2733ee551a94d437561510f27?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit", "link": "https://stackoverflow.com/users/7742987/mohit"}, "is_accepted": true, "score": 0, "last_activity_date": 1514976084, "creation_date": 1514976084, "answer_id": 48075748, "question_id": 48074625, "link": "https://stackoverflow.com/questions/48074625/error-when-linking-gtest-project/48075748#48075748", "title": "Error when linking gtest project", "body": "<p>If you are using CLion then you may have a CMakeLists.txt file you should add rules to link to the libraries. To do this add the following line to your CMakeLists.txt</p>\n\n<pre><code>enable_testing()\nfind_package(GTest REQUIRED) # Find the google testing framework on your system\ninclude_directories(${GTEST_INCLUDE_DIRS})\ntarget_link_libraries(${PROJECT_NAME} ${GTEST_LIBRARIES}) # Replace ${PROJECT_NAME} with your target name\n</code></pre>\n\n<p>For more details go <a href=\"https://cmake.org/cmake/help/v3.0/module/FindGTest.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8265329"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2860, "favorite_count": 0, "accepted_answer_id": 48075748, "answer_count": 1, "score": 1, "last_activity_date": 1514976084, "creation_date": 1514971890, "last_edit_date": 1514974891, "question_id": 48074625, "link": "https://stackoverflow.com/questions/48074625/error-when-linking-gtest-project", "title": "Error when linking gtest project", "body": "<p>recently I start study unit testing , and I want test my program with gtest. I install all with this order :</p>\n\n<pre><code>$ git clone https://github.com/google/googletest \n$ cd googletest \n$ cmake -DBUILD_SHARED_LIBS=ON . \n$ make \n$ cd googlemock \n$ sudo cp ./libgmock_main.so ./gtest/libgtest.so gtest/libgtest_main.so ./libgmock.so /usr/lib/ \n$ sudo ldconfig\n</code></pre>\n\n<p>and now write code :</p>\n\n<pre><code>#include \"gtest/gtest.h\"\n\nclass Add\n{\n  private:\n     int element;\n  public:\n     Add():element(0){}\n     ~Add(){}\n     void setElement(int e){ element = e; }\n     int getElement() { return element; }\n     int adder(int e) { return element += e; }\n};\n\nclass AddTest : public ::testing::Test\n{\n  protected:\n       int abc(int a){\n            return a;\n        }\n\n     virtual void SetUp(){\n          add1.setElement(1);\n          add2.setElement(20);\n     }\n     virtual void TearDown(){}\n\nAdd add1;\nAdd add2;\n};\n\nTEST_F(AddTest, getTest)\n{\n   EXPECT_EQ(1, add1.getElement());\n   EXPECT_EQ(20, add2.getElement());\n}\n\nint main(int argc, char **argv)\n{\n   ::testing::InitGoogleTest(&amp;argc, argv);\n   return RUN_ALL_TESTS();\n}\n</code></pre>\n\n<p>end when I run test i get this error :</p>\n\n<p>CMakeFiles/mock2.dir/main.cpp.o: In function <code>AddTest_getTest_Test::TestBody()':\n/home/artem/CLionProjects/mock2/main.cpp:33: undefined reference to</code>testing::Message::Message()'\n/home/artem/CLionProjects/mock2/main.cpp:33: undefined reference to <code>testing::internal::AssertHelper::AssertHelper(testing::TestPartResult::Type, char const*, int, char const*)'\n/home/artem/CLionProjects/mock2/main.cpp:33: undefined reference to</code>testing::internal::AssertHelper::operator=(testing::Message const&amp;) const'\n/home/artem/CLionProjects/mock2/main.cpp:33: undefined reference to <code>testing::internal::AssertHelper::~AssertHelper()'\n/home/artem/CLionProjects/mock2/main.cpp:34: undefined reference to</code>testing::Message::Message()'\n/home/artem/CLionProjects/mock2/main.cpp:34: undefined reference to <code>testing::internal::AssertHelper::AssertHelper(testing::TestPartResult::Type, char const*, int, char const*)'\n/home/artem/CLionProjects/mock2/main.cpp:34: undefined reference to</code>testing::internal::AssertHelper::operator=(testing::Message const&amp;) const'\n/home/artem/CLionProjects/mock2/main.cpp:34: undefined reference to <code>testing::internal::AssertHelper::~AssertHelper()'\n/home/artem/CLionProjects/mock2/main.cpp:33: undefined reference to</code>testing::internal::AssertHelper::~AssertHelper()'\n/home/artem/CLionProjects/mock2/main.cpp:34: undefined reference to <code>testing::internal::AssertHelper::~AssertHelper()'\nCMakeFiles/mock2.dir/main.cpp.o: In function</code>main':\n/home/artem/CLionProjects/mock2/main.cpp:39: undefined reference to <code>testing::InitGoogleTest(int*, char**)'\nCMakeFiles/mock2.dir/main.cpp.o: In function</code>__static_initialization_and_destruction_0(int, int)':\n/home/artem/CLionProjects/mock2/main.cpp:31: undefined reference to <code>testing::internal::MakeAndRegisterTestInfo(char const*, char const*, char const*, char const*, testing::internal::CodeLocation, void const*, void (*)(), void (*)(), testing::internal::TestFactoryBase*)'\nCMakeFiles/mock2.dir/main.cpp.o: In function</code>RUN_ALL_TESTS()':\n/usr/local/include/gtest/gtest.h:2235: undefined reference to <code>testing::UnitTest::GetInstance()'\n/usr/local/include/gtest/gtest.h:2235: undefined reference to</code>testing::UnitTest::Run()'\nCMakeFiles/mock2.dir/main.cpp.o: In function <code>AddTest::AddTest()':\n/home/artem/CLionProjects/mock2/main.cpp:15: undefined reference to</code>testing::Test::Test()'\nCMakeFiles/mock2.dir/main.cpp.o: In function <code>AddTest::~AddTest()':\n/home/artem/CLionProjects/mock2/main.cpp:15: undefined reference to</code>testing::Test::~Test()'\nCMakeFiles/mock2.dir/main.cpp.o: In function <code>testing::internal::scoped_ptr&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt;::reset(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;*)':\n/usr/local/include/gtest/internal/gtest-port.h:1172: undefined reference to</code>testing::internal::IsTrue(bool)'\nCMakeFiles/mock2.dir/main.cpp.o: In function <code>testing::internal::scoped_ptr&lt;std::__cxx11::basic_stringstream&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt;::reset(std::__cxx11::basic_stringstream&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;*)':\n/usr/local/include/gtest/internal/gtest-port.h:1172: undefined reference to</code>testing::internal::IsTrue(bool)'\nCMakeFiles/mock2.dir/main.cpp.o: In function <code>testing::AssertionResult testing::internal::CmpHelperEQ&lt;int, int&gt;(char const*, char const*, int const&amp;, int const&amp;)':\n/usr/local/include/gtest/gtest.h:1394: undefined reference to</code>testing::AssertionSuccess()'\nCMakeFiles/mock2.dir/main.cpp.o: In function <code>testing::AssertionResult testing::internal::CmpHelperEQFailure&lt;int, int&gt;(char const*, char const*, int const&amp;, int const&amp;)':\n/usr/local/include/gtest/gtest.h:1384: undefined reference to</code>testing::internal::EqFailure(char const*, char const*, std::__cxx11::basic_string, std::allocator > const&amp;, std::__cxx11::basic_string, std::allocator > const&amp;, bool)'\nCMakeFiles/mock2.dir/main.cpp.o:(.rodata._ZTI7AddTest[_ZTI7AddTest]+0x10): undefined reference to `typeinfo for testing::Test'\ncollect2: error: ld returned 1 exit status\nCMakeFiles/mock2.dir/build.make:94: recipe for target 'mock2' failed\nmake[3]: <strong>* [mock2] Error 1\nCMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/mock2.dir/all' failed\nmake[2]: <em></strong> [CMakeFiles/mock2.dir/all] Error 2\nCMakeFiles/Makefile2:79: recipe for target 'CMakeFiles/mock2.dir/rule' failed\nmake[1]: <strong></em> [CMakeFiles/mock2.dir/rule] Error 2\nMakefile:118: recipe for target 'mock2' failed\nmake: *</strong> [mock2] Error 2</p>\n\n<p>but when use command </p>\n\n<pre><code>g++ main.cpp -o test -lgtest -lpthread\n</code></pre>\n\n<p>everytheng is good. How can I fix it and run it not in command line ?</p>\n"}, {"tags": ["c++", "qt", "qml", "qfont", "qfontmetrics"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1514971274, "post_id": 48074369, "comment_id": 83122408, "body": "Can you show how you are using Scale? your application in QML or C ++?"}, {"owner": {"reputation": 18300, "user_id": 462608, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/s9JpE.jpg?s=128&g=1", "display_name": "Aquarius_Girl", "link": "https://stackoverflow.com/users/462608/aquarius-girl"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1514971730, "post_id": 48074369, "comment_id": 83122640, "body": "@eyllanesc please see edits."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1514971898, "post_id": 48074369, "comment_id": 83122730, "body": "What Font do you want to change?"}, {"owner": {"reputation": 18300, "user_id": 462608, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/s9JpE.jpg?s=128&g=1", "display_name": "Aquarius_Girl", "link": "https://stackoverflow.com/users/462608/aquarius-girl"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1514972352, "post_id": 48074369, "comment_id": 83122953, "body": "There is a <code>paint</code>  function in the class <code>Draw_on_qimage</code>. That uses some some text. I wish to control its size. @eyllanesc"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1514972471, "post_id": 48074369, "comment_id": 83123018, "body": "Draw_on_qimage of what class it inherits, inherits from qquickpainteditem?"}, {"owner": {"reputation": 18300, "user_id": 462608, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/s9JpE.jpg?s=128&g=1", "display_name": "Aquarius_Girl", "link": "https://stackoverflow.com/users/462608/aquarius-girl"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1514972563, "post_id": 48074369, "comment_id": 83123067, "body": "Yes, QQuickPaintedItem. @eyllanesc Anything else you wish to know?"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1514974906, "post_id": 48074369, "comment_id": 83124404, "body": "Test my answer and indicate if you have a problem."}], "answers": [{"comments": [{"owner": {"reputation": 18300, "user_id": 462608, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/s9JpE.jpg?s=128&g=1", "display_name": "Aquarius_Girl", "link": "https://stackoverflow.com/users/462608/aquarius-girl"}, "edited": false, "score": 0, "creation_date": 1514977029, "post_id": 48075422, "comment_id": 83125551, "body": "Thanks for the effort. Is the aim of your example to show how to pass screen&#39;s height and width to the cpp for font adjustment?"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 18300, "user_id": 462608, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/s9JpE.jpg?s=128&g=1", "display_name": "Aquarius_Girl", "link": "https://stackoverflow.com/users/462608/aquarius-girl"}, "edited": false, "score": 0, "creation_date": 1514977106, "post_id": 48075422, "comment_id": 83125596, "body": "@Aquarius_Girl no, it is show that you can set the font size from the QML."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 18300, "user_id": 462608, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/s9JpE.jpg?s=128&g=1", "display_name": "Aquarius_Girl", "link": "https://stackoverflow.com/users/462608/aquarius-girl"}, "edited": false, "score": 0, "creation_date": 1514977269, "post_id": 48075422, "comment_id": 83125668, "body": "@Aquarius_Girl Look at the following example, if you manually change the size of the window you will see that the size of the font changes <a href=\"https://github.com/eyllanesc/stackoverflow/tree/master/48074369\" rel=\"nofollow noreferrer\">github.com/eyllanesc/stackoverflow/tree/master/48074369</a>"}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 1, "last_activity_date": 1514974836, "creation_date": 1514974836, "answer_id": 48075422, "question_id": 48074369, "link": "https://stackoverflow.com/questions/48074369/how-to-set-dynamic-qfont-size/48075422#48075422", "title": "How to set dynamic QFont size?", "body": "<p>The easiest way is to set QFont as Q_PROPERTY of your item so you can set it from QML:</p>\n\n<pre><code>#ifndef DRAWITEM_H\n#define DRAWITEM_H\n\n#include &lt;QPainter&gt;\n#include &lt;QQuickPaintedItem&gt;\n\nclass DrawItem : public QQuickPaintedItem\n{\n    Q_OBJECT\n    Q_PROPERTY(QFont font READ font WRITE setFont NOTIFY fontChanged)\npublic:\n    DrawItem(QQuickItem *parent = Q_NULLPTR):QQuickPaintedItem(parent){}\n    void paint(QPainter *painter){\n        painter-&gt;setFont(mFont);\n        painter-&gt;drawText(boundingRect(), \"Hello\");\n    }\n    QFont font() const{\n        return mFont;\n    }\n    void setFont(const QFont &amp;font){\n        if(mFont == font)\n            return;\n        mFont = font;\n        emit fontChanged();\n        update();\n    }\n\nsignals:\n    void fontChanged();\nprivate:\n    QFont mFont;\n};\n\n#endif // DRAWITEM_H\n</code></pre>\n\n<p>To set its size we use the pointSize property of QFont:</p>\n\n<pre><code>DrawItem\n{\n    id: draw_on_qimage\n    anchors.fill: parent\n    font.pointSize: some_function(head.width, head.height)\n    transform: Scale {\n        xScale: head.width / 640\n        yScale: head.height / 480\n    }\n}\n</code></pre>\n\n<p>Where some_function is the function that establishes the relationship between the font size and the size of the window.</p>\n"}], "owner": {"reputation": 18300, "user_id": 462608, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/s9JpE.jpg?s=128&g=1", "display_name": "Aquarius_Girl", "link": "https://stackoverflow.com/users/462608/aquarius-girl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1100, "favorite_count": 0, "accepted_answer_id": 48075422, "answer_count": 1, "score": 0, "last_activity_date": 1596218832, "creation_date": 1514970962, "last_edit_date": 1596218832, "question_id": 48074369, "link": "https://stackoverflow.com/questions/48074369/how-to-set-dynamic-qfont-size", "title": "How to set dynamic QFont size?", "body": "<p>I came across QFontMetrics?\n<a href=\"http://doc.qt.io/qt-5/qfontmetrics.html\" rel=\"nofollow noreferrer\">http://doc.qt.io/qt-5/qfontmetrics.html</a><br>\nThis gives the height and width of the present font.</p>\n\n<p>I need to run my application with full screen mode on on different monitors for which I am using Scale class. <a href=\"http://doc.qt.io/qt-5/qml-qtquick-scale.html\" rel=\"nofollow noreferrer\">http://doc.qt.io/qt-5/qml-qtquick-scale.html</a></p>\n\n<p>That returns the height and width of the current screen.</p>\n\n<p>Is there a way to use QFontMetrics or anything else to change the font size according to the monitor size?</p>\n\n<pre><code>ApplicationWindow\n{\n    id: head\n\n    visible: true\n\n    width:  Screen.width\n    height: Screen.height\n\n    title: \"Novus Pilot\"\n\n    property var id: 0;\n\n    Draw_on_qimage\n    {\n        id: draw_on_qimage\n        anchors.fill: parent\n        parent: image\n\n        scaleX: head.width / 640\n        scaleY: head.height / 480\n    }\n}\n</code></pre>\n\n<p><code>Draw_on_qimage</code> is a cpp class.</p>\n"}, {"tags": ["c++", "visual-c++"], "comments": [{"owner": {"reputation": 183, "user_id": 8027551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10207196789775054/picture?type=large", "display_name": "Zharios", "link": "https://stackoverflow.com/users/8027551/zharios"}, "edited": false, "score": 4, "creation_date": 1514971063, "post_id": 48074359, "comment_id": 83122311, "body": "you have while(answer = 1), must be while(answer == 1)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514971181, "post_id": 48074359, "comment_id": 83122358, "body": "You need to show, verbatim, your input, your desired output, and your actual output. &quot;Works great&quot; or &quot;is not working&quot; are no valid status reports."}, {"owner": {"reputation": 1451, "user_id": 6552776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UiuKq.jpg?s=128&g=1", "display_name": "csabinho", "link": "https://stackoverflow.com/users/6552776/csabinho"}, "edited": false, "score": 0, "creation_date": 1514971290, "post_id": 48074359, "comment_id": 83122419, "body": "You can&#39;t ask for an &#39;n&#39; if you are using cin with an int!"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1514971443, "post_id": 48074359, "comment_id": 83122506, "body": "If you actually type an <code>n</code> for <code>cin &gt;&gt; answer</code>, the stream will enter a failed state and not input anything else until the error is cleared."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1514975174, "post_id": 48074359, "comment_id": 83124562, "body": "While not directly related to your problem, can I suggest a read of <a href=\"http://en.cppreference.com/w/cpp/chrono/c/time\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/chrono/c/time</a>   -  which will do all this for you?"}, {"owner": {"reputation": 1, "user_id": 9167285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u9GIH.gif?s=128&g=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/9167285/anonymous"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514984297, "post_id": 48074359, "comment_id": 83129514, "body": "@n.m. How can I show my desired output if I am not getting it. The problem itself is that I am not getting my desired output."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514986963, "post_id": 48074359, "comment_id": 83131022, "body": "Your <i>desired</i> output is what you <i>want</i> to get. Your <i>actual</i> output is what you are getting instead (may be none, just say &quot;no output&quot; if that&#39;s the case)."}, {"owner": {"reputation": 1, "user_id": 9167285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u9GIH.gif?s=128&g=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/9167285/anonymous"}, "edited": false, "score": 0, "creation_date": 1514998319, "post_id": 48074359, "comment_id": 83137706, "body": "Ok so what I am expecting is that I take an input from the user. If he enters 1, then January should be shown. Then, the user can enter the date and then according to the If statement, the day is displayed. The user is then asked whether he really wants to quit. In the end, if the user types n or N then the code shall run again, if anything else, the code exits successfully. This is what I want help for."}], "answers": [{"tags": [], "owner": {"reputation": 5530, "user_id": 2955997, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1253a92230fbcbda896e74fb138d619e?s=128&d=identicon&r=PG&f=1", "display_name": "ibezito", "link": "https://stackoverflow.com/users/2955997/ibezito"}, "is_accepted": true, "score": 2, "last_activity_date": 1514971232, "creation_date": 1514971232, "answer_id": 48074450, "question_id": 48074359, "link": "https://stackoverflow.com/questions/48074359/why-does-my-do-loop-run-several-times-and-doesnt-ask-for-input/48074450#48074450", "title": "Why does my do loop run several times and doesn&#39;t ask for input?", "body": "<p>A few issues with your code:</p>\n\n<p>a. in the last while statement, you should use '==' operator which checks equality, instead of '=' operator which performs assignment.</p>\n\n<pre><code>while (answer == 1)\n</code></pre>\n\n<p>b. in the last switch case you should add a break command at the end of each case. Otherwise, it automatically performs default the code block under default option as well.</p>\n\n<pre><code>    switch (answer)\n    {\n        case 1:\n            answer = 1;\n            break;\n\n        case 'n':\n            answer = 1;\n            break;\n\n        default:\n            answer = 2;\n            break;\n    }\n</code></pre>\n\n<p>c. The first switch-case block currently includes one case only. Therefore, the it is not  really needed. </p>\n"}, {"tags": [], "owner": {"reputation": 1451, "user_id": 6552776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UiuKq.jpg?s=128&g=1", "display_name": "csabinho", "link": "https://stackoverflow.com/users/6552776/csabinho"}, "is_accepted": false, "score": -1, "last_activity_date": 1515507285, "last_edit_date": 1515507285, "creation_date": 1514971570, "answer_id": 48074542, "question_id": 48074359, "link": "https://stackoverflow.com/questions/48074359/why-does-my-do-loop-run-several-times-and-doesnt-ask-for-input/48074542#48074542", "title": "Why does my do loop run several times and doesn&#39;t ask for input?", "body": "<p>The reason for this behavior is that there will always be an 'n' in the keyboard buffer. <a href=\"https://stackoverflow.com/questions/10349857/how-to-handle-wrong-data-type-input\">Here</a>'s the solution for this!</p>\n\n<p>(apart from the infinite loop that already was mentioned... )</p>\n\n<p><em>I'm citing the answer I've linked:</em></p>\n\n<p>The reason the program goes into an infinite loop is because <code>std::cin</code>'s bad input flag is set due to the input failing. The thing to do is to clear that flag and discard the bad input from the input buffer.</p>\n\n<pre><code>//executes loop if the input fails (e.g., no characters were read)\nwhile (std::cout &lt;&lt; \"Enter a number\" &amp;&amp; !(std::cin &gt;&gt; num)) {\n    std::cin.clear(); //clear bad input flag\n    std::cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), '\\n'); //discard input\n    std::cout &lt;&lt; \"Invalid input; please re-enter.\\n\";\n}\n</code></pre>\n\n<p>See <a href=\"https://isocpp.org/wiki/faq/input-output#istream-and-ignore\" rel=\"nofollow noreferrer\">the C++ FAQ</a> for this, and other examples, including adding a minimum and/or maximum into the condition.</p>\n\n<p>Another way would be to get the input as a string and convert it to an integer with <code>std::stoi</code> or some other method that allows checking the conversion.</p>\n"}], "owner": {"reputation": 1, "user_id": 9167285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u9GIH.gif?s=128&g=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/9167285/anonymous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 1, "accepted_answer_id": 48074450, "answer_count": 2, "score": 0, "last_activity_date": 1515507285, "creation_date": 1514970910, "question_id": 48074359, "link": "https://stackoverflow.com/questions/48074359/why-does-my-do-loop-run-several-times-and-doesnt-ask-for-input", "title": "Why does my do loop run several times and doesn&#39;t ask for input?", "body": "<p>I use Visual Studio Community 2017 for C++ Programming. I have the following code. Here, the do while loop runs several times and doesn't stop for asking input where it is supposed to. But, in the last switch case program, if I enter 1 instead of n, the program works great. PLEASE HELP!!!</p>\n\n<pre><code>// Welcome2018.cpp : Defines the entry point for the console application.\n//\n\n#include \"stdafx.h\"\n#include&lt;iostream&gt;\n#include&lt;bitset&gt;\nusing namespace std;\n\nint main()\n{\n    string month[] = { \"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\" \"September\", \"October\", \"November\", \"December\" };\n    int m, d, answer;\n    cout &lt;&lt; \"Welcome 2018!!!\" &lt;&lt; endl;\n    do\n    {\n        cout &lt;&lt; \"Enter the number corresponding to the month you want displayed\" &lt;&lt; endl;\n        cin &gt;&gt; m;\n        switch (m)\n        {\n        case 1:\n            cout &lt;&lt; month[0] &lt;&lt; endl;\n            cout &lt;&lt; \"Enter the date to know the day it is/will be\" &lt;&lt; endl;\n            cin &gt;&gt; d;\n            if (d == 7 || d == 14 || d == 21 || d == 28)\n            {\n                cout &lt;&lt; \"The day on \" &lt;&lt; d &lt;&lt; \" January is Sunday!\" &lt;&lt; endl;\n            }\n            else if (d == 1 || d == 8 || d == 15 || d == 22 || d == 29)\n            {\n                cout &lt;&lt; \"The day on \" &lt;&lt; d &lt;&lt; \" January is Monday!\" &lt;&lt; endl;\n            }\n            else if (d == 2 || d == 9 || d == 16 || d == 23 || d == 30)\n            {\n                cout &lt;&lt; \"The day on \" &lt;&lt; d &lt;&lt; \" January is Tuesday!\" &lt;&lt; endl;\n            }\n            else if (d == 3 || d == 10 || d == 17 || d == 24 || d == 31)\n            {\n                cout &lt;&lt; \"The day on \" &lt;&lt; d &lt;&lt; \" January is Wednesday!\" &lt;&lt; endl;\n            }\n            else if (d == 4 || d == 11 || d == 18 || d == 25)\n            {\n                cout &lt;&lt; \"The day on \" &lt;&lt; d &lt;&lt; \" January is Thursday!\" &lt;&lt; endl;\n            }\n            else if (d == 5 || d == 12 || d == 19 || d == 26)\n            {\n                cout &lt;&lt; \"The day on \" &lt;&lt; d &lt;&lt; \" January is Friday!\" &lt;&lt; endl;\n            }\n            else if (d == 6 || d == 13 || d == 20 || d == 27)\n            {\n                cout &lt;&lt; \"The day on \" &lt;&lt; d &lt;&lt; \" January is Saturday!\" &lt;&lt; endl;\n            }\n        }\n        cout &lt;&lt; \"Are you sure you want to quit?\" &lt;&lt; endl;\n        cout &lt;&lt; \"Enter Y/N based on your choice:\";\n        cin &gt;&gt; answer;\n        switch (answer)\n        {\n        case 1:\n            answer = 1;\n\n        case 'n':\n            answer = 1;\n\n        default:\n            answer = 2;\n        }\n    } while (answer = 1);\n    cout &lt;&lt; \"Thank You and Come Again!!!\" &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "memory"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1514970574, "post_id": 48074235, "comment_id": 83122083, "body": "You could (on Ubuntu) use <a href=\"http://man7.org/linux/man-pages/man7/pthreads.7.html\" rel=\"nofollow noreferrer\">pthreads(7)</a>. You should read a <a href=\"https://computing.llnl.gov/tutorials/pthreads/\" rel=\"nofollow noreferrer\">pthread tutorial</a>. Use also <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">valgrind</a>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1514970591, "post_id": 48074235, "comment_id": 83122095, "body": "I think it&#39;s the usual problem of the Linux kernel not unmapping pages as you free memory. That will make it <i>seem</i> like you have a leak, but it&#39;s a false positive."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1514970638, "post_id": 48074235, "comment_id": 83122113, "body": "On another note, you have a data-race as multiple threads try to read and write to <code>a</code> simultaneously. That leads to <i>undefined behavior</i>."}, {"owner": {"reputation": 677, "user_id": 1577918, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f8b29d722473fda2e49dd959a9c5c6?s=128&d=identicon&r=PG", "display_name": "Geom", "link": "https://stackoverflow.com/users/1577918/geom"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1514971976, "post_id": 48074235, "comment_id": 83122771, "body": "@Someprogrammerdude ++a just keeps the compiler from optimizing away an empty function. I have replaced the outer for(i=0;i&lt;10;++i) loop by while(true) now: The virtual memory consumption increases step by step to 624 GB and stays stable then. I know that the kernel does not (or not immediately) unmap pages when memory is freed. But shouldn&#39;t the assigned memory pages be re-used?"}, {"owner": {"reputation": 677, "user_id": 1577918, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f8b29d722473fda2e49dd959a9c5c6?s=128&d=identicon&r=PG", "display_name": "Geom", "link": "https://stackoverflow.com/users/1577918/geom"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1514972190, "post_id": 48074235, "comment_id": 83122861, "body": "@BasileStarynkevitch The software must be portable, so pthreads is not an option. I have also used Valgrind. No leak found."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1514972309, "post_id": 48074235, "comment_id": 83122930, "body": "TinyThreads is less common and less portable than Pthreads (and internally using Pthreads on Linux). Every Linux system has Pthreads. So your &quot;portability&quot; is an illusion."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1514972534, "post_id": 48074235, "comment_id": 83123049, "body": "If portability is a concern, use <a href=\"https://en.wikipedia.org/wiki/C%2B%2B11\" rel=\"nofollow noreferrer\">C++11</a> and its <a href=\"http://en.cppreference.com/w/cpp/thread\" rel=\"nofollow noreferrer\"><code>&lt;thread&gt;</code></a> standard library. So just demand that your users have a C++11 implementation; or stick to Pthread which is available on many systems."}, {"owner": {"reputation": 677, "user_id": 1577918, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f8b29d722473fda2e49dd959a9c5c6?s=128&d=identicon&r=PG", "display_name": "Geom", "link": "https://stackoverflow.com/users/1577918/geom"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1514972962, "post_id": 48074235, "comment_id": 83123296, "body": "@BasileStarynkevitch TinyThread compiles under Windows, Linux, Mac, FreeBSD and consists of just one .h and .cpp file. No extra library to be linked. I think pthreads require an additional library under Windows."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1514973095, "post_id": 48074235, "comment_id": 83123372, "body": "So what? As I said, you should require a standard C++11 implementation; what that implementation requires is the concern of your users."}, {"owner": {"reputation": 677, "user_id": 1577918, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f8b29d722473fda2e49dd959a9c5c6?s=128&d=identicon&r=PG", "display_name": "Geom", "link": "https://stackoverflow.com/users/1577918/geom"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1514973132, "post_id": 48074235, "comment_id": 83123399, "body": "@BasileStarynkevitch C++11 is not available, I create libraries that must also run on old systems. RedHat6, CentOS6.4, VS2008, ..."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1514973188, "post_id": 48074235, "comment_id": 83123447, "body": "On old RedHat or CentOS systems, you can compile a <i>recent</i> <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a> (e.g. GCC 7 providing C++11) from its source code; and pthreads exist on them. Notice that Pthread is a POSIX standard, and C++11 an ISO one. Better base your work on standard tools. TinyThread is an extra library that your code depends on (and that most systems don&#39;t have). I never heard of it before your question, so it is not even a popular library. You could use popular frameworks like <a href=\"http://qt.io\" rel=\"nofollow noreferrer\">Qt</a> or <a href=\"http://pocoproject.org/\" rel=\"nofollow noreferrer\">POCO</a>"}, {"owner": {"reputation": 677, "user_id": 1577918, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f8b29d722473fda2e49dd959a9c5c6?s=128&d=identicon&r=PG", "display_name": "Geom", "link": "https://stackoverflow.com/users/1577918/geom"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1514973410, "post_id": 48074235, "comment_id": 83123579, "body": "@BasileStarynkevitch Software compiled with a recent GCC won&#39;t run on CentOS6.4."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1514973583, "post_id": 48074235, "comment_id": 83123666, "body": "As I said, you need to compile the recent <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a> compiler from its source code (e.g. <a href=\"ftp://ftp.gnu.org/gnu/gcc/gcc-7.2.0/gcc-7.2.0.tar.xz\" rel=\"nofollow noreferrer\">gcc-7.2.0.tar.xz</a>...) on the old Linux system. I did that in the past, it works well (even if compiling GCC takes a lot of time). Of course a binary compiled on a recent Debian/Sid won&#39;t run on an old RedHat from the previous century."}, {"owner": {"reputation": 677, "user_id": 1577918, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f8b29d722473fda2e49dd959a9c5c6?s=128&d=identicon&r=PG", "display_name": "Geom", "link": "https://stackoverflow.com/users/1577918/geom"}, "edited": false, "score": 0, "creation_date": 1514973712, "post_id": 48074235, "comment_id": 83123731, "body": "Ah, okay, that&#39;s an option. But does not solve the problem for VS2008"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1514974383, "post_id": 48074235, "comment_id": 83124101, "body": "I don&#39;t know tinythread - but it&#39;s entirely possible that somewhere in the background there it&#39;s keeping a whole load of data; and while never a detectable leak, it is data that is never released.  Even with what @Someprogrammerdude said, the pages should be at least reused.  Once you&#39;ve tried doing this with std::thread or pthread, you&#39;ll have taken the non-standard wrapping library out the equation and be in a better position.  (and remove the undefined behavior - it is after all, UB!)"}, {"owner": {"reputation": 13642, "user_id": 4013258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d423395e1033fa23d80a5561ab170fa?s=128&d=identicon&r=PG&f=1", "display_name": "Surt", "link": "https://stackoverflow.com/users/4013258/surt"}, "edited": false, "score": 2, "creation_date": 1514976555, "post_id": 48074235, "comment_id": 83125278, "body": "After a short reading of the code of timythread, it looks like it uses PThreads on Linux, so if you write the same test code with pthread and it still gives the same result bug report ubuntu, if it now doesn&#39;t behave that way bug report tinythread."}, {"owner": {"reputation": 677, "user_id": 1577918, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f8b29d722473fda2e49dd959a9c5c6?s=128&d=identicon&r=PG", "display_name": "Geom", "link": "https://stackoverflow.com/users/1577918/geom"}, "reply_to_user": {"reputation": 13642, "user_id": 4013258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d423395e1033fa23d80a5561ab170fa?s=128&d=identicon&r=PG&f=1", "display_name": "Surt", "link": "https://stackoverflow.com/users/4013258/surt"}, "edited": false, "score": 0, "creation_date": 1514991996, "post_id": 48074235, "comment_id": 83133954, "body": "@Surt You are right. I have just rewritten the minimal example: No problem when pthread is used. But it is nevertheless strange: With tinythread htop reports 624 GB virtual memory usage while the system has only 64 GB RAM and 11 GB swap space. So it CAN&#39;T be a real memory leak."}, {"owner": {"reputation": 677, "user_id": 1577918, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f8b29d722473fda2e49dd959a9c5c6?s=128&d=identicon&r=PG", "display_name": "Geom", "link": "https://stackoverflow.com/users/1577918/geom"}, "edited": false, "score": 0, "creation_date": 1514992083, "post_id": 48074235, "comment_id": 83134004, "body": "By the way, why has the question been downvoted? I think it shows effort and is not off-topic"}], "answers": [{"tags": [], "owner": {"reputation": 677, "user_id": 1577918, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f8b29d722473fda2e49dd959a9c5c6?s=128&d=identicon&r=PG", "display_name": "Geom", "link": "https://stackoverflow.com/users/1577918/geom"}, "is_accepted": false, "score": 1, "last_activity_date": 1515008695, "creation_date": 1515008695, "answer_id": 48084125, "question_id": 48074235, "link": "https://stackoverflow.com/questions/48074235/memory-issue-with-threads-tinythread-c/48084125#48084125", "title": "Memory issue with threads (tinythread, C++)", "body": "<p>I answer my own question, this may be useful for somebody later: </p>\n\n<p>Conclusion: </p>\n\n<p>1) I'd really like to keep TinyThread because C++11 is unavailable (VS2008 and old Linux Systems must be supported) and no additional library shall be linked (TinyThread consists only of an *.h and *.cpp file while Boost and other solutions I know require linking a DLL). </p>\n\n<p>2) Valgrind and the heap checker of the GooglePerformanceTools do not report memory leaks and I have looked into the code - it seems to be correct although the virtual memory consumption increases drastically in the minimal example posted above. It seems that the system does not re-use the previously assigned memory pages and I have not found an explanation for this behavior. Thus I do not blame TinyThread++ but it works when pthreads are used directly instead. </p>\n\n<p>3) The workaround: There is a C alternative called TinyCThread: <a href=\"https://tinycthread.github.io/\" rel=\"nofollow noreferrer\">https://tinycthread.github.io/</a> that works also for C++ and it does not cause the problems observed with TinyThread++. </p>\n"}], "owner": {"reputation": 677, "user_id": 1577918, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f8b29d722473fda2e49dd959a9c5c6?s=128&d=identicon&r=PG", "display_name": "Geom", "link": "https://stackoverflow.com/users/1577918/geom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515008695, "creation_date": 1514970402, "last_edit_date": 1514970681, "question_id": 48074235, "link": "https://stackoverflow.com/questions/48074235/memory-issue-with-threads-tinythread-c", "title": "Memory issue with threads (tinythread, C++)", "body": "<p>I debug a strange memory issue: When a multithreaded algorithm runs in a loop its memory consumption increases with every iteration although the heap checker of of GooglePerformanceTools says there is no leak. Finally I have made a separate minimal program that reproduces the bug. It seems that the threads are the problem:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include \"tinythread.h\"\nusing namespace std;\n\n\nint a(0);\nvoid doNothingAtAll(void*)\n{\n    ++a;\n}\n\nvoid startAndJoin100()\n{   \n    vector&lt;tthread::thread*&gt; vThreads;\n    for(int i=0;i&lt;100;++i)\n    {   \n        vThreads.push_back(new tthread::thread(doNothingAtAll,NULL));\n    }\n    while(!vThreads.empty())\n    {\n            tthread::thread* pThread(vThreads.back());\n            pThread-&gt;join();\n            delete pThread;\n            vThreads.pop_back();\n    }\n}\n\nint main()\n{       \n    for(int i=0;i&lt;10;++i)\n    {\n        cout&lt;&lt;\"calling startAndJoin100()\"&lt;&lt;endl;\n        startAndJoin100();\n        cout&lt;&lt;\"all threads joined\"&lt;&lt;endl;\n        cin.get();\n    }\n    return 0;\n}\n</code></pre>\n\n<p>main() calls 10 times startAndJoin100(). It waits for a key stroke after each iteration so that one can take the memory consumption which is (under Ubuntu 17.10, 64-bit):</p>\n\n<pre><code>VIRT\n2.1 GB\n4 GB\n5.9 GB\n7.8 GB\n9.6 GB\n11.5 GB\n13.4 GB\n15.3 GB\n17.2 GB\n19.0 GB\n</code></pre>\n\n<p>Note: C++11 can't be used and the program must compile on Linux and Windows, thus tinythread is used. Minimal test code with Makefile:\n<a href=\"http://geom.at/_downloads/testTinyThread.zip\" rel=\"nofollow noreferrer\">geom.at/_downloads/testTinyThread.zip</a></p>\n"}, {"tags": ["c++", "recursion", "set", "bitmask"], "comments": [{"owner": {"reputation": 2122, "user_id": 3460139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/827ca92157a1a57d0e8a80c492a23fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Christian W.", "link": "https://stackoverflow.com/users/3460139/christian-w"}, "edited": false, "score": 0, "creation_date": 1514971084, "post_id": 48074129, "comment_id": 83122321, "body": "How could you ever expect there to be a zero in indices <code>[0,1,2]</code>, when you first fill them with ones and then never replace them with zeroes? Or in any other position for that matter, after you reach <code>c==3</code> and continue filling the array with ones."}, {"owner": {"reputation": 11, "user_id": 8537282, "user_type": "registered", "profile_image": "https://graph.facebook.com/1669633489714602/picture?type=large", "display_name": "Petar Vitanov", "link": "https://stackoverflow.com/users/8537282/petar-vitanov"}, "reply_to_user": {"reputation": 2122, "user_id": 3460139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/827ca92157a1a57d0e8a80c492a23fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Christian W.", "link": "https://stackoverflow.com/users/3460139/christian-w"}, "edited": false, "score": 0, "creation_date": 1514971476, "post_id": 48074129, "comment_id": 83122531, "body": "Thank you very much. Added one line of code after the recursive call and now it works perfectly. You are awesome!"}, {"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1514971678, "post_id": 48074129, "comment_id": 83122618, "body": "It seems you expect a result not suitable to the task conditions. You are asked to print all possible subsets of length 3 from a set of length 5, therefore expected result must list 3-element sets, but you typed 5-element sets, that look like permutations."}], "answers": [{"tags": [], "owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "is_accepted": false, "score": 1, "last_activity_date": 1514973809, "creation_date": 1514973809, "answer_id": 48075132, "question_id": 48074129, "link": "https://stackoverflow.com/questions/48074129/recursive-function-to-display-all-subsets-of-a-set-using-bitmask-c/48075132#48075132", "title": "Recursive function to display all subsets of a set using bitmask c++", "body": "<p>You forgot to</p>\n\n<pre><code>    arr[i] = 0;\n</code></pre>\n\n<p>after the return from the recursive <code>combinations()</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 8537282, "user_type": "registered", "profile_image": "https://graph.facebook.com/1669633489714602/picture?type=large", "display_name": "Petar Vitanov", "link": "https://stackoverflow.com/users/8537282/petar-vitanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514973809, "creation_date": 1514969972, "last_edit_date": 1514971558, "question_id": 48074129, "link": "https://stackoverflow.com/questions/48074129/recursive-function-to-display-all-subsets-of-a-set-using-bitmask-c", "title": "Recursive function to display all subsets of a set using bitmask c++", "body": "<p>I am trying to write a recursive function to display all possible k-element subsets of an n-element set using bitmasks.</p>\n\n<p>So far I have this code.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nvoid combinations(int *, int, int, int,int c);\n\nint main()\n{\n    int n = 5;\n    int k = 3;\n    int bitMask[5] = {0};\n    combinations(bitMask,0,n,k,0);\n\n}\n\nvoid combinations(int* arr, int start, int n, int k,int c)\n{\n    if(c==3)\n    {\n        for(int i = 0; i &lt; n; i++)\n        {\n            cout&lt;&lt;arr[i];\n        }\n        cout&lt;&lt;endl;\n    }else\n    {\n        for(int i = start; i &lt; n; i++)\n        {\n            arr[i] = 1;\n            combinations(arr,i+1,n,k,c+1);\n\n        }\n    }\n}\n</code></pre>\n\n<p>However my output is :</p>\n\n<pre><code>11100\n11110\n11111\n11111\n11111\n11111\n11111\n11111\n11111\n11111\n</code></pre>\n\n<p>Can someone give me some guidelines on how to change the function in order to get a result like this</p>\n\n<pre><code>11100\n11010\n11001\n10110\n10101\n01110\n01101\n01011\n00111\n</code></pre>\n\n<p>Thanks in advance, I am still bad with recursion.</p>\n\n<p>The code below works perfectly. </p>\n\n<pre><code>  #include &lt;iostream&gt;\n\n    using namespace std;\n\n    void combinations(int *, int, int, int,int c);\n\n    int main()\n    {\n        int n = 5;\n        int k = 3;\n        int bitMask[5] = {0};\n        combinations(bitMask,0,n,k,0);\n\n    }\n\n    void combinations(int* arr, int start, int n, int k,int c)\n    {\n        if(c==3)\n        {\n            for(int i = 0; i &lt; n; i++)\n            {\n                cout&lt;&lt;arr[i];\n            }\n            cout&lt;&lt;endl;\n        }else\n        {\n            for(int i = start; i &lt; n; i++)\n            {\n                arr[i] = 1;\n                combinations(arr,i+1,n,k,c+1);\n                arr[i] = 0;\n            }\n        }\n    }\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 2, "creation_date": 1514969838, "post_id": 48074065, "comment_id": 83121741, "body": "There are several different ways, but none of them will be faster than <code>O(n)</code>, where <code>n</code> is the length of your input vector. So a <code>for</code> loop is pretty much the best you can hope for on the aspect of runtime performance."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1514969839, "post_id": 48074065, "comment_id": 83121742, "body": "Maybe not &quot;faster&quot; (there&#39;s no way around O(n)) but that&#39;s a perfect fit for <a href=\"http://en.cppreference.com/w/cpp/algorithm/count\" rel=\"nofollow noreferrer\"><code>std::count</code></a>."}, {"owner": {"reputation": 391, "user_id": 970909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/26b0aa8b98ecdbaa6c2e8b923f003b0e?s=128&d=identicon&r=PG", "display_name": "falopsy", "link": "https://stackoverflow.com/users/970909/falopsy"}, "edited": false, "score": 0, "creation_date": 1514979938, "post_id": 48074065, "comment_id": 83127107, "body": "std::count (or more generally std::count_if) is probably what you are looking for."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1514993034, "post_id": 48074065, "comment_id": 83134585, "body": "You should not use <code>std::vector&lt;bool&gt;</code> for this - it is broken by design. Operation you are looking for is called &quot;population count&quot; or &quot;Hamming weight&quot;. Check this: <a href=\"https://stackoverflow.com/questions/109023/how-to-count-the-number-of-set-bits-in-a-32-bit-integer\" title=\"how to count the number of set bits in a 32 bit integer\">stackoverflow.com/questions/109023/&hellip;</a>"}, {"owner": {"reputation": 70991, "user_id": 650492, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/FY7Qc.png?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/650492/johan"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1609322765, "post_id": 48074065, "comment_id": 115810453, "body": "@StaceyGirl, which is exactly what <code>std::count</code> does for a <code>std::vector&lt;bool&gt;</code>."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "reply_to_user": {"reputation": 70991, "user_id": 650492, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/FY7Qc.png?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/650492/johan"}, "edited": false, "score": 0, "creation_date": 1609331602, "post_id": 48074065, "comment_id": 115813649, "body": "@Johan In a horribly inefficient way, yes."}, {"owner": {"reputation": 70991, "user_id": 650492, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/FY7Qc.png?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/650492/johan"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1609343675, "post_id": 48074065, "comment_id": 115818614, "body": "@StaceyGirl, nope, it&#39;s as efficient as could possibly be: <code>... for (; __n &gt;= __bits_per_word; ++__first.__seg_, __n -= __bits_per_word)         __r += _VSTD::__libcpp_popcount(*__first.__seg_); ...</code>."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "reply_to_user": {"reputation": 70991, "user_id": 650492, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/FY7Qc.png?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/650492/johan"}, "edited": false, "score": 0, "creation_date": 1609344694, "post_id": 48074065, "comment_id": 115819086, "body": "@Johan My assembly for both GCC and Clang says otherwise."}, {"owner": {"reputation": 70991, "user_id": 650492, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/FY7Qc.png?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/650492/johan"}, "reply_to_user": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1609346858, "post_id": 48074065, "comment_id": 115820088, "body": "@StaceyGirl, you need to tell the compiler that popcnt is availble: &quot;-march=nehalem&quot; or newer and the latest version of clang 12.0.0. Then it works."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "reply_to_user": {"reputation": 70991, "user_id": 650492, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/FY7Qc.png?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/650492/johan"}, "edited": false, "score": 0, "creation_date": 1609347146, "post_id": 48074065, "comment_id": 115820204, "body": "@Johan I don&#39;t t know where you took that source code, but mine implementation of <code>std::count</code> doesn&#39;t do that. I suspect you took the code from <code>std::bitset::count</code> instead."}, {"owner": {"reputation": 70991, "user_id": 650492, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/FY7Qc.png?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/650492/johan"}, "edited": false, "score": 0, "creation_date": 1609347671, "post_id": 48074065, "comment_id": 115820408, "body": "Nope, did not. It&#39;s from clang 12.0.0 on the mac, also with this clang it produces popcnt in the assembly. right click, goto def on <code>std::vector&lt;bool&gt; test(16000, false); const auto a = std::count(test.begin(), test.end(), true);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 2, "creation_date": 1514977887, "post_id": 48074194, "comment_id": 83125995, "body": "Technically, std::count will return <code>ptrdiff_t</code> (or, more precisely, std::vector&lt;bool&gt;::iterator::difference_type which in practise will be <code>ptrdiff_t</code>.  That will be a signed type (which is crazy - std::count should return an unsigned value), but it may not be int.  This can all be avoided with <code>auto count</code>."}], "tags": [], "owner": {"reputation": 1835, "user_id": 3195314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiMED.png?s=128&g=1", "display_name": "alseether", "link": "https://stackoverflow.com/users/3195314/alseether"}, "is_accepted": false, "score": 10, "last_activity_date": 1615544407, "last_edit_date": 1615544407, "creation_date": 1514970230, "answer_id": 48074194, "question_id": 48074065, "link": "https://stackoverflow.com/questions/48074065/is-there-built-in-function-return-the-number-of-true-value-in-a-boolean-vector/48074194#48074194", "title": "Is there built-in function return &quot; the number of true value in a boolean vector &quot;?", "body": "<p><code>std::count(b.begin(), b.end(), true);</code></p>\n<p>Might be a good idea. More detailed if you want to try:</p>\n<h2>Code</h2>\n<pre><code>#include &lt;vector&gt;     // std::vector\n#include &lt;algorithm&gt;  // std::count\n#include &lt;iostream&gt;   // std::cout, std::endl\n\nint main(){\n\n    std::vector&lt;bool&gt; b = { true, true, false, true, false, true };\n\n    auto count = std::count(b.begin(), b.end(), true);\n\n    std::cout &lt;&lt; &quot;Count = &quot; &lt;&lt; count &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n<h2>Output</h2>\n<blockquote>\n<p>Count = 4</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 1, "creation_date": 1514978011, "post_id": 48076200, "comment_id": 83126061, "body": "Given that <code>m</code> is a constant for a particular implementation, it&#39;s not merely a <i>postulate</i> that O(n/m) is O(n), it&#39;s a fact (implied by the definition of O(n)).  Of course, constant factors can be (very) important."}, {"owner": {"reputation": 70991, "user_id": 650492, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/FY7Qc.png?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/650492/johan"}, "edited": false, "score": 0, "creation_date": 1609322620, "post_id": 48076200, "comment_id": 115810399, "body": "<code>std::count</code> uses the CPUs popcount internally for <code>vector&lt;bool&gt;</code> so you&#39;re not going to get that * m speedup by writing your own non-portable code."}, {"owner": {"reputation": 13642, "user_id": 4013258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d423395e1033fa23d80a5561ab170fa?s=128&d=identicon&r=PG&f=1", "display_name": "Surt", "link": "https://stackoverflow.com/users/4013258/surt"}, "edited": false, "score": 0, "creation_date": 1609349177, "post_id": 48076200, "comment_id": 115821003, "body": "That requires that your implementation has that specialization, which is not guaranteed."}, {"owner": {"reputation": 353, "user_id": 459714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e59f21d658a1acad31a7687d9e11933?s=128&d=identicon&r=PG", "display_name": "Seth", "link": "https://stackoverflow.com/users/459714/seth"}, "reply_to_user": {"reputation": 70991, "user_id": 650492, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/FY7Qc.png?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/650492/johan"}, "edited": false, "score": 0, "creation_date": 1616495248, "post_id": 48076200, "comment_id": 118013643, "body": "@Johan I don&#39;t think std::count uses popcount, see <a href=\"https://stackoverflow.com/a/57310059/459714\">stackoverflow.com/a/57310059/459714</a>"}, {"owner": {"reputation": 70991, "user_id": 650492, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/FY7Qc.png?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/650492/johan"}, "edited": false, "score": 0, "creation_date": 1616596044, "post_id": 48076200, "comment_id": 118052231, "body": "The c++20 implementation does, earlier versions do not."}], "tags": [], "owner": {"reputation": 13642, "user_id": 4013258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d423395e1033fa23d80a5561ab170fa?s=128&d=identicon&r=PG&f=1", "display_name": "Surt", "link": "https://stackoverflow.com/users/4013258/surt"}, "is_accepted": false, "score": 0, "last_activity_date": 1515070101, "last_edit_date": 1515070101, "creation_date": 1514977884, "answer_id": 48076200, "question_id": 48074065, "link": "https://stackoverflow.com/questions/48074065/is-there-built-in-function-return-the-number-of-true-value-in-a-boolean-vector/48076200#48076200", "title": "Is there built-in function return &quot; the number of true value in a boolean vector &quot;?", "body": "<p>The space saving implementation of <code>std::vector&lt;bool&gt;</code> is ... <em>implementation defined</em>, so there is no <em>portable</em> way of doing it.</p>\n\n<p>But if you really really need to be fast here and don't mind rewriting your program each time a new patch/version of your compiler, cpu, OS comes out, there is a way for most implementation.</p>\n\n<p>Most implementations will probably implement it as an array of some type of int, if you can get access to that array you can use your cpu's popcount/simd instructions to count it in potentially O(n/m) instead of O(n), where m is the max wordlength that can be popcounted on your cpu. </p>\n\n<p>Evil minds will postulate that O(n/m) is O(n) but that speed up can be significant.</p>\n\n<p>Edit: I forgot there is another possibility, namely std::bitset if you don't really need a vector of bool. std::bitset has a count, but again its implementation defined how count is done.</p>\n"}], "owner": {"reputation": 61, "user_id": 9167216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39000023972ed5cda1c26f0bd4aafa63?s=128&d=identicon&r=PG&f=1", "display_name": "sinoky", "link": "https://stackoverflow.com/users/9167216/sinoky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1771, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1615544407, "creation_date": 1514969673, "question_id": 48074065, "link": "https://stackoverflow.com/questions/48074065/is-there-built-in-function-return-the-number-of-true-value-in-a-boolean-vector", "title": "Is there built-in function return &quot; the number of true value in a boolean vector &quot;?", "body": "<p>For example: </p>\n\n<p>b = [T T F F T F], then the function return 3 .</p>\n\n<p>I can do that by a for-loop program. But, is there function return \" the number of true value in a boolean vector \" to do that faster than for-loop program ?</p>\n\n<p>Thanks. </p>\n"}, {"tags": ["java", "c++", "java-native-interface"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1514970902, "post_id": 48074053, "comment_id": 83122238, "body": "Have you considered adding any error checking to your code?"}, {"owner": {"reputation": 103, "user_id": 1234249, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/47d44afa13af4165d4f2c32fd7462308?s=128&d=identicon&r=PG", "display_name": "Ghost", "link": "https://stackoverflow.com/users/1234249/ghost"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1514972229, "post_id": 48074053, "comment_id": 83122885, "body": "To determine which line is failing? I did that, I just deleted here as I thought it would be taking up space. The line that is failing is the GetMethodID line. The code runs to there and crashes with that message."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1516409552, "post_id": 48074053, "comment_id": 83689813, "body": "It transpires that the line which is really failing is the <code>FindClass()</code> call, which is returning a zero. <i>Proper</i> error-checking would have detected that."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 1234249, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/47d44afa13af4165d4f2c32fd7462308?s=128&d=identicon&r=PG", "display_name": "Ghost", "link": "https://stackoverflow.com/users/1234249/ghost"}, "edited": false, "score": 0, "creation_date": 1514971961, "post_id": 48074534, "comment_id": 83122763, "body": "No, the problem is on the GetMethodID line."}, {"owner": {"reputation": 64564, "user_id": 302139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ea13e6d50c94ba30296c4e5326e1634?s=128&d=identicon&r=PG", "display_name": "Edwin Buck", "link": "https://stackoverflow.com/users/302139/edwin-buck"}, "reply_to_user": {"reputation": 103, "user_id": 1234249, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/47d44afa13af4165d4f2c32fd7462308?s=128&d=identicon&r=PG", "display_name": "Ghost", "link": "https://stackoverflow.com/users/1234249/ghost"}, "edited": false, "score": 1, "creation_date": 1514972525, "post_id": 48074534, "comment_id": 83123044, "body": "@Ghost If <code>c</code> contains null, then the problem would be reported when you use <code>c</code>, not when you set <code>c</code> to a valid value of <code>null</code> because you couldn&#39;t find the class in the lookup.   Did you actually verify the contents of variable <code>c</code>, or are you just going by line number of the crash?  If <code>c</code> has a non-zero integer value, odds are it is a good value."}, {"owner": {"reputation": 103, "user_id": 1234249, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/47d44afa13af4165d4f2c32fd7462308?s=128&d=identicon&r=PG", "display_name": "Ghost", "link": "https://stackoverflow.com/users/1234249/ghost"}, "edited": false, "score": 0, "creation_date": 1514973289, "post_id": 48074534, "comment_id": 83123499, "body": "My god I can&#39;t believe I made that mistake again. The problem was I didn&#39;t take into account the layout of the package structure. It was &quot;main/ConstructorObject&quot; not &quot;ConstructorObject&quot; otherwise the reference was null. Thanks for that."}], "tags": [], "owner": {"reputation": 64564, "user_id": 302139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ea13e6d50c94ba30296c4e5326e1634?s=128&d=identicon&r=PG", "display_name": "Edwin Buck", "link": "https://stackoverflow.com/users/302139/edwin-buck"}, "is_accepted": false, "score": 4, "last_activity_date": 1514971558, "creation_date": 1514971558, "answer_id": 48074534, "question_id": 48074053, "link": "https://stackoverflow.com/questions/48074053/creating-new-objects-in-jni/48074534#48074534", "title": "Creating new objects in JNI", "body": "<p>Was your class lookup successful?  Did you see that the value of <code>c</code> contained something other than NULL?</p>\n"}, {"tags": [], "owner": {"reputation": 28, "user_id": 5103546, "user_type": "registered", "profile_image": "https://graph.facebook.com/745175891/picture?type=large", "display_name": "Levant Alejandro", "link": "https://stackoverflow.com/users/5103546/levant-alejandro"}, "is_accepted": false, "score": 1, "last_activity_date": 1603896005, "last_edit_date": 1603896005, "creation_date": 1580524775, "answer_id": 60013539, "question_id": 48074053, "link": "https://stackoverflow.com/questions/48074053/creating-new-objects-in-jni/60013539#60013539", "title": "Creating new objects in JNI", "body": "<p>Not sure if this helps, I had a problem on the line of constructor fetching, I had something like this:</p>\n<pre><code>jmethodID mid = e-&gt;GetMethodID(c, &quot;&lt;init&gt;&quot;, &quot;()V&quot;);\n</code></pre>\n<p>I changed it for</p>\n<pre><code>jmethodID mid = e-&gt;GetMethodID(c, &quot;&lt;init&gt;&quot;, &quot;void(V)&quot;);\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 1234249, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/47d44afa13af4165d4f2c32fd7462308?s=128&d=identicon&r=PG", "display_name": "Ghost", "link": "https://stackoverflow.com/users/1234249/ghost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 924, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1603896005, "creation_date": 1514969624, "last_edit_date": 1514970455, "question_id": 48074053, "link": "https://stackoverflow.com/questions/48074053/creating-new-objects-in-jni", "title": "Creating new objects in JNI", "body": "<p>I've been creating some code in JNI and most of it is working fine but I haven't been able to create an instance of a Java object from C++ as my Java IDE gives me the following error:</p>\n\n<blockquote>\n  <p>A fatal error has been detected by the Java Runtime Environment:</p>\n  \n  <p>EXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x0000000070e1e0d2, pid=10100, tid=0x0000000000000d90</p>\n  \n  <p>JRE version: Java(TM) SE Runtime Environment (8.0_101-b13) (build 1.8.0_101-b13)\n  Java VM: Java HotSpot(TM) 64-Bit Server VM (25.101-b13 mixed mode windows-amd64 compressed oops)\n  Problematic frame:\n  V  [jvm.dll+0x15e0d2]</p>\n  \n  <p>Failed to write core dump. Minidumps are not enabled by default on client versions of Windows</p>\n  \n  <p>An error report file with more information is saved as:\n  C:\\Users\\Alienware\\Documents\\Netbeans Projects\\NativeTest\\hs_err_pid10100.log</p>\n  \n  <p>If you would like to submit a bug report, please visit:\n  <a href=\"http://bugreport.java.com/bugreport/crash.jsp\" rel=\"nofollow noreferrer\">http://bugreport.java.com/bugreport/crash.jsp</a></p>\n</blockquote>\n\n<p>The Java object I'm trying to create is:</p>\n\n<pre><code>public class ConstructorObject {    \n    public ConstructorObject() {\n        System.out.println(\"Hello World!\");\n    }\n}\n</code></pre>\n\n<p>and the native class is:</p>\n\n<pre><code>public class NativeNewObject\n{\n    static {\n        System.loadLibrary(\"NativeLibrary\");\n    }\n\n    private native void callConstructorObject0();\n\n    public void callConstrtuctorObject() {\n        callConstructorObject0();\n    }\n}\n</code></pre>\n\n<p>The C++ code is:</p>\n\n<pre><code>JNIEXPORT void JNICALL Java_main_NativeNewObject_callConstructorObject0(JNIEnv *e, jobject obj) {\n    jclass c = e-&gt;FindClass(\"ConstructorObject\");\n    jmethodID mid = e-&gt;GetMethodID(c, \"&lt;init&gt;\", \"()V\");\n    jobject newObj = e-&gt;NewObject(c, mid);\n}\n</code></pre>\n\n<p>Thanks.</p>\n"}]